[
    {
        "content": "<p>Hi all,<br>\nMy team is building a SMART on FHIR  web app and we're leveraging the fhir-client.js library (<a href=\"https://github.com/smart-on-fhir/client-js\">https://github.com/smart-on-fhir/client-js</a>). We understand the fhir-client does not support PKCE, and therefore we cannot securely authenticate and exchange tokens as a public client. My question is: How best can we use the FHIR client library to authenticate as a confidential client. Does that mean that all OAuth calls and FHIR resource calls will made in  backend? Is there away to do FHIR.oauth2.authorize() from the backend and let the fontend make fhir calls on FHIR.ready()</p>",
        "id": 225755779,
        "sender_full_name": "Timothy Akampa",
        "timestamp": 1612904080
    },
    {
        "content": "<blockquote>\n<p>We understand the fhir-client does not support PKCE, and therefore we cannot securely authenticate and exchange tokens as a public client</p>\n</blockquote>\n<p>The current SMART specification does not require PKCE, so if you're talking to a SMARTv1 server, this statement shouldn't apply.</p>",
        "id": 225758030,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1612905107
    },
    {
        "content": "<p>(We have forward looking work on a SMARTv2 spec, but it'd be a year at minimum before that makes it through the HL7 and follow-on regulatory process.)</p>",
        "id": 225758157,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1612905158
    },
    {
        "content": "<p>At a higher level: If your app has a server-side component, we'd definitely recommend using that and building a confidential client. If your app doesn't have or need a server-side component, then I'd look at building a public client.</p>",
        "id": 225758260,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1612905204
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179170-smart/topic/Public.20vs.20Confidencial.20Client/near/225758260\">said</a>:</p>\n<blockquote>\n<p>At a higher level: If your app has a server-side component, we'd definitely recommend using that and building a confidential client. If your app doesn't have or need a server-side component, then I'd look at building a public client.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> Thank you for your timely response. Right now the app does not have a server-side component, but talks to an OAuth authorization server that requires public clients to use PKCE. I would really appreciate it if you could share an open source reference implementation that  uses the fhir-client.js library and implements a confidential client flow.</p>",
        "id": 225763245,
        "sender_full_name": "Timothy Akampa",
        "timestamp": 1612907448
    },
    {
        "content": "<p>What you're describing is server behavior outside the SMART spec. So you may not find a SMART library that supports this. <span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> nevertheless this would be a good feature;is there a reason you wouldn't want to include it?</p>",
        "id": 225763817,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1612907739
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179170-smart/topic/Public.20vs.20Confidencial.20Client/near/225763817\">said</a>:</p>\n<blockquote>\n<p>What you're describing is server behavior outside the SMART spec. So you may not find a SMART library that supports this. <span class=\"user-mention silent\" data-user-id=\"193731\">Vladimir Ignatov</span> nevertheless this would be a good feature;is there a reason you wouldn't want to include it?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> We would really appreciate it if you could add PKCE support to the fhir-client.js. This will secure our apps against Authorization Code Interception Attack. In the meantime does anyone have a sample code that uses the fhir-client.js library and implements a confidential client flow?</p>",
        "id": 225772727,
        "sender_full_name": "Timothy Akampa",
        "timestamp": 1612913031
    },
    {
        "content": "<p><a href=\"https://github.com/t-zhao/client-js\">https://github.com/t-zhao/client-js</a> is a fork with PKCE support FWIW <span class=\"user-mention\" data-user-id=\"380771\">@Timothy Akampa</span></p>",
        "id": 225774707,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1612914214
    },
    {
        "content": "<p>Frankly, I didn't know that PKCE is coming to SMART so soon. In this case consider it being in my todo list.</p>\n<p>There was this issue that I closed declining to add PKCE, but that was just temporary. The question was am I<br>\ngoing to add it soon, or should they use their existing fork. Since the fork exists and I know won't be able to <br>\ndedicate enough time in the next few moths, I had to let them know that they shouldn't rely on that just yet.</p>\n<p>I just released new version (<a href=\"https://github.com/smart-on-fhir/client-js/releases/tag/v2.3.11\">https://github.com/smart-on-fhir/client-js/releases/tag/v2.3.11</a>) and won't be able<br>\nto spare much time to this project for a while, but once I get back to it I plan to give PKCE a try.</p>",
        "id": 225879234,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1612979422
    }
]