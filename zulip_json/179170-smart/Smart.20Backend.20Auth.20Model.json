[
    {
        "content": "<p>Hi All,</p>\n<p>I was hoping you could provide some input to a question we currently have regarding 2B Authentication and Authorization for access to a set of FHIR API’s</p>\n<p>We currently have a design that calls for multiple external organisations to both authenticate themselves and be authenticated at an organisation level authorization, however when each organisation accesses or supplies information via the API’s they need to provide the identity of the individual this is on behalf of (note the identity of the individual is not part of the authentication or authorization flow, it is used as part of an audit log)</p>\n<p>We would like to use the smart framework, however, have found two approaches to this being:</p>\n<p>a)  The approach described at: <a href=\"https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md\" target=\"_blank\" title=\"https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md\">https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md</a><br>\nThis approach would likely be simpler for system implementers as they would have a single token for all transactions however may provide some scalability limitations.<br>\nb)  The approach described at <a href=\"https://github.com/smart-on-fhir/smart-on-fhir.github.io/wiki/cross-organizational-auth\" target=\"_blank\" title=\"https://github.com/smart-on-fhir/smart-on-fhir.github.io/wiki/cross-organizational-auth\">https://github.com/smart-on-fhir/smart-on-fhir.github.io/wiki/cross-organizational-auth</a><br>\nThis seems to provide a tighter level of identity control by tying a token to org+provider+patient however may prove a more complex to implement owing to the multiple token management and deprecation involved.</p>\n<p>Does anybody have any suggestions on approaches to this? <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <span class=\"user-mention\" data-user-id=\"191333\">@Reuben Daniels</span> <span class=\"user-mention\" data-user-id=\"193760\">@Shovan Roy</span> <span class=\"user-mention\" data-user-id=\"191368\">@Brett Esler</span> <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span> </p>\n<p>As an aside we will not be requiring clients to obtain a client-to-client digital certificate as we will be leverage the exiting PKI infrastructure for health care authentication in place in Australia.</p>\n<p>Thanks,<br>\nNichol</p>",
        "id": 165024555,
        "sender_full_name": "Nichol Hill",
        "timestamp": 1557181650
    },
    {
        "content": "<p>First, context: The first guide that you mentioned has received substantially more attention and review -- It is in the process of being balloted through HL7. The second guide is a draft treated a few years ago that has not received significant attention or review.</p>",
        "id": 165025075,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1557182095
    },
    {
        "content": "<p>If all you really need is to pass along some information for audit logging, have you worked out requirements like non-repudiation on these?</p>",
        "id": 165025109,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1557182138
    },
    {
        "content": "<p>(also the language about digital certificates is an error in the specification that will be corrected during this ballot round; The only requirement is that the client registers a public key with the server, which then got to associated with its client ID in that server.)</p>",
        "id": 165025169,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1557182176
    },
    {
        "content": "<p>Thanks  <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> ,</p>\n<p>Given this information it looks like the most appropriate option would be the fist. In any case we are doing a POC first and can adjust from learnings as required.</p>\n<p>There may be some requirment for authorization to be applied based on the details of the individual suppied however authentication would still only be at the orginisational level. Our approach would bb to use the first approach to deliver the org level authentication and authorization then implement individual authentication( token validation) and authorization (check the permissions of the user in context) in the API layer - does this seem resoanable to you?</p>",
        "id": 165035336,
        "sender_full_name": "Nichol Hill",
        "timestamp": 1557194354
    },
    {
        "content": "<p>If I'm following, then I think so -- but I'm not totally sure what you mean abut these two levels (\"first approach\" and \"then individual authentication\".</p>",
        "id": 165036202,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1557195722
    },
    {
        "content": "<p>Ok, thanks <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> ,</p>\n<p>Basically the token would be generated for an orginisation and at the time of token generation we would validate the orginisations identity and authenticate then as a valid client to our systems. We would also ensure they are authorised for the scope they ask for and then issue a token. - this would be using the approach described at <a href=\"https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md\" target=\"_blank\" title=\"https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md\">https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md</a></p>\n<p>On a FHIR put, post or get they would include details of the individual that the request is on behalf of. we will not authenticate this individual but trus the authenticated org to correctly identify them. we will in the api layer validate that the individual has approprite authority for the exchange.</p>",
        "id": 165040278,
        "sender_full_name": "Nichol Hill",
        "timestamp": 1557201515
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"196785\">@Nichol Hill</span> the access token can be whatever you want - including a JWT. If you have a centralized service that handles authorization, you can include details of the individual on a JWT, sign it, and have all the decentralized nodes trust a public key from the AuthZ service.</p>",
        "id": 165073399,
        "sender_full_name": "Nick Hatt",
        "timestamp": 1557237864
    },
    {
        "content": "<p>including <span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span> in this discussion.</p>",
        "id": 187182704,
        "sender_full_name": "Shovan Roy",
        "timestamp": 1580602978
    }
]