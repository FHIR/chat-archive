[
    {
        "content": "<p>Reviewing the <a href=\"http://www.hl7.org/fhir/smart-app-launch/conformance/index.html#well-known-uri-registry\" target=\"_blank\" title=\"http://www.hl7.org/fhir/smart-app-launch/conformance/index.html#well-known-uri-registry\">SMART spec's conformance</a> <code>.well-known/smart-configuration</code> core capabilities feature, I read <a href=\"https://tools.ietf.org/html/rfc5785#section-5.1\" target=\"_blank\" title=\"https://tools.ietf.org/html/rfc5785#section-5.1\">RFC 5785</a> and <a href=\"https://mailarchive.ietf.org/arch/browse/wellknown-uri-review/?q=smart-configuration\" target=\"_blank\" title=\"https://mailarchive.ietf.org/arch/browse/wellknown-uri-review/?q=smart-configuration\">wasn't able to find evidence</a> that we'd registered this .well-known uri with the IETF. Does anyone know if we did register with IETF or know a reason why we wouldn't? If not, I'm happy to do the legwork.</p>",
        "id": 166305056,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1558556010
    },
    {
        "content": "<p>I don't think we have, but it'd be good</p>",
        "id": 166305085,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1558556042
    },
    {
        "content": "<p>So, our request to add the <code>.well-known/smart-configuration</code> URI to the IETF registry was <a href=\"https://mailarchive.ietf.org/arch/browse/wellknown-uri-review/?q=smart-configuration\" target=\"_blank\" title=\"https://mailarchive.ietf.org/arch/browse/wellknown-uri-review/?q=smart-configuration\">rejected</a> because it's intended to be placed on the FHIR base url which is not necessarily the root of server. <span aria-label=\"disappointed\" class=\"emoji emoji-1f61e\" role=\"img\" title=\"disappointed\">:disappointed:</span></p>",
        "id": 171644035,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1564002992
    },
    {
        "content": "<p>The reviewer suggested that if we remove this sentence from <a href=\"http://www.hl7.org/fhir/smart-app-launch/conformance/index.html#using-well-known\" target=\"_blank\" title=\"http://www.hl7.org/fhir/smart-app-launch/conformance/index.html#using-well-known\">the spec</a>: </p>\n<blockquote>\n<p>\"\"\"Contrary to RFC5785 Appendix B.4, the .well-known path component may be appended even if the FHIR endpoint already contains a path component.\"\"\"</p>\n</blockquote>\n<p>They will reconsider, but also recommended a name change from <code>smart-configuration</code> to <code>hl7-smart-configuration</code>.</p>",
        "id": 171644037,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1564002995
    },
    {
        "content": "<p>Thoughts?</p>",
        "id": 171644042,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1564002999
    },
    {
        "content": "<p>Can /.well-known/hl7-smart-configuration contain content for more than one FHIR server (on the same host)?</p>",
        "id": 171645960,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1564004721
    },
    {
        "content": "<p>That's a good line of thought, Paul. </p>\n<p>The <code>.well-known/*hl7-*smart-configuration</code> describes the capabilities (and location!) of the authorization server associated with the FHIR server on whose base url it resides. </p>\n<p>If we had multiple FHIR servers on the same host, but only a single smart-configuration file, we'd need to reference each FHIR server and repeat the <a href=\"http://www.hl7.org/fhir/smart-app-launch/conformance/index.html#metadata\" target=\"_blank\" title=\"http://www.hl7.org/fhir/smart-app-launch/conformance/index.html#metadata\">metadata json object</a>.  </p>\n<p>It would definitely ugly up the current structure, for no obvious technical benefit.</p>",
        "id": 171646660,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1564005312
    },
    {
        "content": "<p>That is unfortunate. Do we care more about utility (placing it at the FHIR base URL is where it makes most sense since _everything_ is relative to that) or about showing up in the IETF registry?</p>",
        "id": 171715451,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1564079737
    },
    {
        "content": "<p>Would we want to think about defining a new <code>.well-known</code> configuration that is intended to be placed at FHIR server roots that points to the available base URLs?</p>",
        "id": 171715879,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1564080015
    },
    {
        "content": "<p>I think that whatever URL the SMART spec publishes will be \"well known\".  The main point I see of being in the IETF registry is to avoid collisions between different web applications using the same \"well known\" URL for different purposes, which in the context of a FHIR server seems pretty low.</p>",
        "id": 171721699,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1564084207
    },
    {
        "content": "<p>so IETF are saying that they only support one authorization server per server? really? Or have I mis-understood&gt;?</p>",
        "id": 171764537,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1564138495
    },
    {
        "content": "<blockquote>\n<p>IETF are saying that they only support one authorization server per server?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - IETF is saying that there can be only one .well-known/smart-config per server. That smart-config file could describe multiple authorization servers.</p>",
        "id": 171788196,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1564159215
    },
    {
        "content": "<blockquote>\n<p>Do we care more about utility (placing it at the FHIR base URL is where it makes most sense since _everything_ is relative to that) or about showing up in the IETF registry?</p>\n</blockquote>\n<p>I think we should care more about utility / developer experience than appearing in the IETF registry. One small change that both follows IETF's recommendations and helps us avoid potential .well-known naming collision would be to change the name of <code>smart-configuration</code> to <code>hl7-smart-configuration</code>.</p>\n<p>Do you guys think that .well-known/smart-configuration is well implemented yet, such that a rename would cause real problems?</p>",
        "id": 171788366,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1564159369
    },
    {
        "content": "<p>I'd like the answer to be yes, but suspect it is no. If we only have one per server, than we need to change it around anyway? And while in principle I agree about utility/experience more, I also know from our history that ignoring the IETF on this while weigh heavily on us. (see the experience with mime types)</p>",
        "id": 171807108,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1564172418
    },
    {
        "content": "<p>I'm also:<br>\n- assuming that adoption is low so far so a rename is still possible<br>\n- prefer to keep utility and place <code>.well-known</code> at the FHIR server base URL</p>",
        "id": 171815707,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1564179921
    },
    {
        "content": "<p>is that utility or just legacy? is it better to have to know the sub-path to find it?</p>",
        "id": 171821342,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1564187135
    },
    {
        "content": "<p>I'd say it's utility since most of the time you know the FHIR base URL, not just the host. And you want to know the auth endpoint for that particular base URL, so having the <code>.well-known</code> at the sub-path is ideal. An endpoint discovery <code>.well-known</code> would be neat, however! We'd just need to avoid name collisions since the base URL could be at the root.</p>",
        "id": 171992966,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1564443388
    },
    {
        "content": "<p>I think we could introduce another alias to this configuration file prefixed with <code>hl7-</code> but it is probably only worthwhile if we also wanted to follow their other recommendation.</p>",
        "id": 172002628,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1564458060
    },
    {
        "content": "<p>(i.e. limit ourselves to a single endpoint per hostname/port).</p>",
        "id": 172002641,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1564458083
    },
    {
        "content": "<p>And frankly that seems to put unreasonable limits on the way that a server is laid out; it's a pretty deep restriction on server behavior just to get our URL listed in an IETF registry.</p>",
        "id": 172002687,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1564458124
    },
    {
        "content": "<p>Hi all, </p>\n<p>We are seeing an inconsistency in the docs.  Is this something that can be cleaned up?  We would prefer the \"/.well-known/smart-configuration\" if possible.</p>\n<p><a href=\"http://hl7.org/fhir/smart-app-launch/index.html\" target=\"_blank\" title=\"http://hl7.org/fhir/smart-app-launch/index.html\">http://hl7.org/fhir/smart-app-launch/index.html</a> uses \".well-known/smart-configuration.json\"</p>\n<p><a href=\"http://hl7.org/fhir/smart-app-launch/conformance/index.html#using-well-known\" target=\"_blank\" title=\"http://hl7.org/fhir/smart-app-launch/conformance/index.html#using-well-known\">http://hl7.org/fhir/smart-app-launch/conformance/index.html#using-well-known</a> uses \"/.well-known/smart-configuration\"</p>\n<p>Thanks!<br>\nTravis</p>",
        "id": 173409064,
        "sender_full_name": "Travis Cummings",
        "timestamp": 1565991104
    },
    {
        "content": "<p>Indeed the index.html page is wrong (in an example and explanatory text) ; The correct value is on the conformance page. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> This might be something to consider for a technical correction on SMART, unless you warn me away from trying :-)</p>",
        "id": 173409255,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1565991259
    },
    {
        "content": "<p>I don't see any reason to warn you away from that</p>",
        "id": 173409387,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1565991372
    },
    {
        "content": "<p>Bugger, This one just caught me! <span aria-label=\"cry\" class=\"emoji emoji-1f622\" role=\"img\" title=\"cry\">:cry:</span> <br>\nI had implemented <code>.well-known/smart-configuration</code> saw the text on the front and thought I had it wrong, when and changed all 4 of my implementations to do <code>.well-known/smart-configuration.json</code> only to discover this when I was going to report that it was inconsistent.</p>\n<p>On the plus side, the first time I found it was when I ran the Growth Chart sample app with the debugger open to get a screenshot of the traffic, and noticed that it was working as it failed back to the metadata way of doing things, and not making the call I was expecting...<br>\nThe connectathon approach works <span aria-label=\"stuck out tongue wink\" class=\"emoji emoji-1f61c\" role=\"img\" title=\"stuck out tongue wink\">:stuck_out_tongue_wink:</span></p>\n<p>(at least it's in the current build version - I guess I should be checking against that now)</p>",
        "id": 234621283,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1618466340
    },
    {
        "content": "<p>To give another use case, I'm working on a project that will upgrade our current SaaS for FHIR, our system currently has 800 tenants. I can see us putting a tiered service option, which will allow for a Read only FHIR service, a tier 2 that allows for select resources to be updateable and Tier 3 Full Service FHIR.</p>",
        "id": 235178606,
        "sender_full_name": "Brian Beatty",
        "timestamp": 1618838350
    },
    {
        "content": "<p>Is this message in the right thread? Can you clarify what this is a use case for?</p>",
        "id": 235181999,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1618839754
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179170-smart/topic/.2Ewell-known.2Fsmart-configuration.20registered.20with.20IETF.3F/near/235181999\">said</a>:</p>\n<blockquote>\n<p>Is this message in the right thread? Can you clarify what this is a use case for?</p>\n</blockquote>\n<p>I have approx. 800-1000 tenants. We are just getting started with FHIR, so this may be the wrong thread. <br>\nSome tenants will want to have FHIR that is read only. Some will want to have FHIR editable, but not every resource, and other will want to have every resource editable. So, each tenant could have, in theory a different .well-known/smart-configuration file and Capabilities Statement.</p>\n<p>How should I setup the FHIR server, so that it's multi-tenant so that the same person/patient could be editable if it's for tenant A, but not if it's for tenant B?</p>",
        "id": 235399642,
        "sender_full_name": "Brian Beatty",
        "timestamp": 1618946297
    },
    {
        "content": "<p>Are you thinking about exposing different FHIR endpoints for each tenant? (that'd be the typical thing.)</p>",
        "id": 235403600,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1618947934
    },
    {
        "content": "<p>(If so, then each FHIR endpoint would have its own smart-configuration file.)</p>",
        "id": 235403707,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1618947968
    }
]