[
    {
        "content": "<p>Has anyone defined auditEvent profiles for the smart activities? Do OAuth implementations record these events in a local text log, what does that log look like?</p>",
        "id": 168206810,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560603142
    },
    {
        "content": "<p>I do, if that's worth anything.</p>",
        "id": 168206813,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560603164
    },
    {
        "content": "<p>That is worth solid gold... Can you share?</p>",
        "id": 168210767,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560610394
    },
    {
        "content": "<p>ok. login:</p>",
        "id": 168218433,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560623684
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"p\">{</span>\n  <span class=\"nt\">&quot;resourceType&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;AuditEvent&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;text&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;status&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;generated&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;div&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;snip!&quot;</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">&quot;type&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://nema.org/dicom/dcid&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;code&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;110114&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;display&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;User Authentication&quot;</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">&quot;subtype&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://nema.org/dicom/dcid&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;code&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;110144&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;display&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;Login&quot;</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">],</span>\n  <span class=\"nt\">&quot;action&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;E&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;recorded&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;2019-06-15T18:31:56.891Z&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;outcome&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;0&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;agent&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;who&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;identifier&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n          <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;value&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;141&quot;</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">},</span>\n      <span class=\"nt\">&quot;altId&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;g&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;name&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;g (unknown)&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;requestor&quot;</span> <span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;network&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;address&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;127.0.0.1&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;type&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;4&quot;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">],</span>\n  <span class=\"nt\">&quot;source&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;site&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://local.fhir.org&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;observer&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;identifier&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;urn:ietf:rfc:3986&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;value&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">},</span>\n    <span class=\"nt\">&quot;type&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://hl7.org/fhir/security-source-type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;code&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;3&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;display&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;Web Server&quot;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre></div>",
        "id": 168218488,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560623767
    },
    {
        "content": "<p>a22611cd-0cb4-4cba-a7a4-23052e2909af is the internal identifier for this system</p>",
        "id": 168218491,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560623777
    },
    {
        "content": "<p>logout:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"p\">{</span>\n  <span class=\"nt\">&quot;resourceType&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;AuditEvent&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;text&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;status&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;generated&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;div&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;snip!&quot;</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">&quot;type&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://nema.org/dicom/dcid&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;code&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;110114&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;display&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;User Authentication&quot;</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">&quot;subtype&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://nema.org/dicom/dcid&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;code&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;110123&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;display&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;Logout&quot;</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">],</span>\n  <span class=\"nt\">&quot;action&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;E&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;recorded&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;2019-06-15T18:33:20.333Z&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;outcome&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;0&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;agent&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;who&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;identifier&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n          <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;value&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;141&quot;</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">},</span>\n      <span class=\"nt\">&quot;altId&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;g&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;name&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;g (unknown)&quot;</span>\n    <span class=\"p\">},</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;network&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;address&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;127.0.0.1&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;type&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;2&quot;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">],</span>\n  <span class=\"nt\">&quot;source&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;site&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;Health Intersections&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;observer&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;identifier&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;urn:ietf:rfc:3986&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;value&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">},</span>\n    <span class=\"nt\">&quot;type&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://hl7.org/fhir/security-source-type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;code&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;3&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;display&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;Web Server&quot;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre></div>",
        "id": 168218494,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560623811
    },
    {
        "content": "<p>Those are just the login and out events. Not really the OAuth events.  In using the lifecycle diagram from <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> presentations I was expecting some audit events at each point: 1. Register of an ID, 2. Launch + Discovery, 3. Authorize grant_type, 4. Query, and 5 Refresh.<br>\nThe logging of various CRUDE are done, but not specific enough to how the same auditEvent holds references to the token. Should be variations of these CRUDE that show a SMART token use? Seems it should be minimally the opaque token, leaving the details to the ( 3 ) Authorize grant_type auditEvent...</p>",
        "id": 168305968,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560775076
    },
    {
        "content": "<p><a href=\"https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g5b4e43b18c_0_97\" target=\"_blank\" title=\"https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g5b4e43b18c_0_97\">https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g5b4e43b18c_0_97</a></p>",
        "id": 168306047,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560775120
    },
    {
        "content": "<p>In IHE we define the AuditEvent for various events... then in the IUA profile (The IHE profile of OAuth) we express how the presence of an IUA  token used to authorize ANY transaction or activity will augment that (ANY) transaction AuditEvent by adding an AuditEvent.agent. Thus the AuditEvent recorded for activity XYZ is the combination of the auditEvent pattern from activity XYZ + an AuditEvent.agent that expresses the security token used. This way activity XYZ (e.g. the CRUDE AuditEvent patterms given in FHIR) don't mention security, as security layer just augments the AuditEvent. This enables many security layer posibilities with consistency of AuditEvent for activity XYZ.</p>",
        "id": 168306526,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560775467
    },
    {
        "content": "<p>We record only login in our system. We generate a session ID (GUID) that links the login event to the corresponding following CRUD events. It goes in a custom extension in AuditEvent</p>",
        "id": 168309367,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1560777512
    },
    {
        "content": "<p>why do you think you need a custom extension? What is the definition so that we can consider it a core or core-extension?</p>",
        "id": 168312509,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560779936
    },
    {
        "content": "<p>I think it would be good to have a session id in AuditEvent. I don't audit the selection of scopes, and should. In fact, I should only log the login once the scopes are selected because it's not functional till then</p>",
        "id": 168331126,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560793413
    }
]