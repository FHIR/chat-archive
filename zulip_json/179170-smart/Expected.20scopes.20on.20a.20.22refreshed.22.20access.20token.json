[
    {
        "content": "<p>In the section about <a href=\"http://www.hl7.org/fhir/smart-app-launch/app-launch.html#response-7\">refresh access tokens</a>, the spec has this blurb in the Response sub-section:</p>\n<div class=\"codehilite\"><pre><span></span><code>scope - Scope of access authorized. Note that this will be the same as the scope of the original access token,\nand it can be different from the scopes requested by the app.\n</code></pre></div>\n<p>Of specific interest is the bit about the scope being the same as the original access token.  For the FHIR resource scopes, there isn't anything unexpected.  My question is about openid and fhirUser scopes.  Was the intent that the scope of a refresh access token include scopes like openid and fhirUser?  And if the scopes are provided, then presumably the associated claims should be too.   id_token is explicitly mentioned in the response object for the initial access token, but is omitted in the object for the refresh access token.  Was the intentional or not?  </p>\n<p>Related question:  do we think sending an id_token in the refresh access token response object is useful?  Would that be interpreted as re-asserting user identity?  Since there isn't user interaction, a re-assertion of identity is really more of an inference than an assertion.</p>",
        "id": 274619119,
        "sender_full_name": "Cooper Thompson",
        "timestamp": 1646779770
    },
    {
        "content": "<blockquote>\n<p>My question is about openid and fhirUser scopes.</p>\n</blockquote>\n<p>I think the intent was your access to FHIR data should be the same; the authentication context wouldn't necessarily be.</p>",
        "id": 274619582,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1646780044
    },
    {
        "content": "<p>(We don't have conformance language around this, FWIW ;-))</p>",
        "id": 274619591,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1646780055
    },
    {
        "content": "<blockquote>\n<p>do we think sending an id_token in the refresh access token response object is useful? </p>\n</blockquote>\n<p>No, if you haven't re-authenticated the patient (and there's no place in the refresh token workflow to do that) it doesn't even make sense to me at first glance. Surely the OIDC spec has something to say about this...</p>",
        "id": 274619649,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1646780095
    },
    {
        "content": "<p><a href=\"https://openid.net/specs/openid-connect-core-1_0.html#RefreshTokenResponse\">https://openid.net/specs/openid-connect-core-1_0.html#RefreshTokenResponse</a></p>",
        "id": 274619701,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1646780136
    },
    {
        "content": "<blockquote>\n<p>Upon successful validation of the Refresh Token, the response body is the Token Response of Section 3.1.3.3 except that it might not contain an id_token.</p>\n</blockquote>",
        "id": 274619711,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1646780145
    },
    {
        "content": "<p>So, from the OIDC spec perspective, including an <code>id_token</code> in a refresh token response is allowed and could be useful, but it's also OK to omit.</p>",
        "id": 274619798,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1646780191
    },
    {
        "content": "<p>Does the SMART App Launch Guide (or OAuth 2.0) provide any guarantees to the client about the scope of the refreshed access token, in relation to the original access token?  The Inferno team had interpreted the line \"..this will be the same as the scope of the original access token' to literally mean that <code>scope</code> parameter provided on the token refresh response will include the same scopes as were provided along with the original access token.</p>",
        "id": 274898234,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1646948217
    },
    {
        "content": "<p>You may have already answered that question by stating that the authorization context may not necessarily be the same, but I just want to be clear that you are also referring to the content of the <code>scope</code> parameter and not just the inclusion of the <code>id_token</code> parameter.</p>",
        "id": 274899176,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1646948667
    },
    {
        "content": "<p>The <code>fhirUser</code> and <code>openid</code> scopes might well be excluded; but any <code>patient/</code> or <code>user/</code> scopes (FHIR data access scopes) from the original token scopes should be there</p>",
        "id": 274916498,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1646958685
    }
]