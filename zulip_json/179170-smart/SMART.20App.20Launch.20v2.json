[
    {
        "content": "<p>Connectathon 27 Track -&gt; <a href=\"https://confluence.hl7.org/display/FHIR/2021-05+SMART+App+Launch+v2\">SMART App Launch v2</a><br>\nThis is a place to discuss \"SMART v2\" in general.</p>",
        "id": 236249285,
        "sender_full_name": "Travis Rotz",
        "timestamp": 1619473161
    },
    {
        "content": "<p>For the upcoming 2021-05 SMART App Launch v2 Connectathon Track, are there any participating servers or SMART Apps planning to test with EHR Launch? That is from within an existing EHR session and encounter context.</p>",
        "id": 237159647,
        "sender_full_name": "Chuck Feltner",
        "timestamp": 1620048224
    },
    {
        "content": "<h2>Welcome to our Connectathon #27 Kickoff! I'll share links here for key resources.</h2>",
        "id": 238797177,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621011610
    },
    {
        "content": "<ul>\n<li><a href=\"https://confluence.hl7.org/display/FHIR/2021-05+SMART+App+Launch+v2\">Track Overview Page with Scenarios</a></li>\n<li><a href=\"https://build.fhir.org/ig/HL7/smart-app-launch/\">SMART App Launch v2 Spec (CI)</a></li>\n<li><a href=\"https://docs.google.com/spreadsheets/d/10j4a0juCrlZPDtrvOQaNNgSNPUU5MK9Hm7reCg1RF6A/edit#gid=0\">Sign-up Spreadsheet with Server + Client Links</a></li>\n<li><a href=\"https://smart.argo.run/?auth_error=&amp;fhir_version_1=r4&amp;fhir_version_2=r4&amp;iss=&amp;launch_ehr=1&amp;launch_url=&amp;patient=&amp;prov_skip_auth=1&amp;provider=&amp;pt_skip_auth=1&amp;public_key=&amp;sb=&amp;sde=&amp;sim_ehr=1&amp;token_lifetime=15&amp;user_pt=\">SMARTv2 Launcher</a></li>\n</ul>",
        "id": 238797437,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621011710
    },
    {
        "content": "<p>SMART Launcher: <a href=\"https://github.com/smart-on-fhir/smart-launcher\">https://github.com/smart-on-fhir/smart-launcher</a></p>",
        "id": 238801343,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621013356
    },
    {
        "content": "<p>Fork of launcher with v2 features: <a href=\"https://github.com/microsoft-healthcare-madison/smart-launcher\">https://github.com/microsoft-healthcare-madison/smart-launcher</a></p>",
        "id": 238801364,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621013372
    },
    {
        "content": "<p>Can the smart granular test client be use the smart launch rather than standalone?</p>",
        "id": 239233701,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1621335607
    },
    {
        "content": "<p>Also, wondering if the URL of the fhir server changes for each session, would others find that strange?<br>\nA smart client we're building uses the base URL,  and now that's likely to cause me some grief :(</p>",
        "id": 239234185,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1621335864
    },
    {
        "content": "<p>Hey everyone on SMARTv2 Connectathon -- we'll have our <a href=\"https://hl7-org.zoom.us/j/96463166857?pwd=OU92WncxTDFjTWtVZjVxSUlOdGo2Zz09\">check-in/welcome call</a> in 5min!</p>",
        "id": 239267476,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621349690
    },
    {
        "content": "<blockquote>\n<p>Brian Postlethwaite: Can the smart granular test client be use the smart launch rather than standalone?</p>\n</blockquote>\n<p>You mean the EHR Launch? I think it's not currently set up for that; it'd  be a good feature, though it leaves open the question of how/where you'd want to set the additional params (e.g., use pkce? use POST-based authz, etc?) Can be hard-coded in the app, or the app could \"capture\" the launch and wait while the user chose settings to proceed...</p>",
        "id": 239267795,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621349788
    },
    {
        "content": "<blockquote>\n<p>smart client we're building uses the base URL, and now that's likely to cause me some grief :(</p>\n</blockquote>\n<p>Uses base URL of what? I'm not yet following (and not sure if this is a spec issue, or just something about the behavior of our sample app and/or demo server).</p>",
        "id": 239267912,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621349842
    },
    {
        "content": "<p>We'll have our wrap-up call in just under 2 hours -- it has been a quiet chat here. Would appreciate if folks could add feedback and wrap-up notes to Column G of <a href=\"https://docs.google.com/spreadsheets/d/10j4a0juCrlZPDtrvOQaNNgSNPUU5MK9Hm7reCg1RF6A/edit#gid=0\">https://docs.google.com/spreadsheets/d/10j4a0juCrlZPDtrvOQaNNgSNPUU5MK9Hm7reCg1RF6A/edit#gid=0</a> based on your experience. Just a quick summary of how the event went, plus highlights, comments or questions. I'll use this for the wrap-up report.</p>",
        "id": 239443110,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621437550
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> I see you mentioned a \"register\" endpoint at <a href=\"https://launch.smarthealthit.org/\">https://launch.smarthealthit.org/</a>. Where is that endpoint listed? I'm not seeing it in the <code>.well-known/smart-configuration</code></p>",
        "id": 239447598,
        "sender_full_name": "Keith Carlson",
        "timestamp": 1621438830
    },
    {
        "content": "<p>I don't think it's a dynreg-compliant endpoint, so it wouldn't make sense to list there in current state; it's hosted at <code>/register</code>. If you want, you can use the UI at <a href=\"https://bulk-data.smarthealthit.org/\">https://bulk-data.smarthealthit.org/</a> to see this in action, and the client_ids generated by that tool should be usable at <a href=\"https://smart.argo.run/\">https://smart.argo.run/</a></p>",
        "id": 239453772,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621441024
    },
    {
        "content": "<p>An example invocation is:</p>\n<div class=\"codehilite\"><pre><span></span><code>$ curl &#39;https://bulk-data.smarthealthit.org/auth/register&#39;   -H &#39;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#39;   --data-raw &#39;jwks=%7B%22keys%22%3A%5B%7B%22kty%22%3A%22EC%22%2C%22crv%22%3A%22P-384%22%2C%22x%22%3A%22lSG-9XHZcN6XdUXE6sCnvnGYHClZ1odZLUrLou3kgyMQuwd612Yr--wb8btsVAXf%22%2C%22y%22%3A%22oCsstCTa8NGZ6ou1GOB8mJhdn_gAzeTlHtINFrF1_VG9k0JxFnE9aHyi2qgoW9vx%22%2C%22key_ops%22%3A%5B%22verify%22%5D%2C%22ext%22%3Atrue%2C%22kid%22%3A%2235fbeb4493b0569fb6983a35f06aa5b9%22%2C%22alg%22%3A%22ES384%22%7D%2C%7B%22kty%22%3A%22EC%22%2C%22crv%22%3A%22P-384%22%2C%22d%22%3A%22KozncWMn_lo6nBa2nou5HM2hPgnAcp73B5sQl3_vt61O9wxTG_s4xgjDAO8ipNkg%22%2C%22x%22%3A%22lSG-9XHZcN6XdUXE6sCnvnGYHClZ1odZLUrLou3kgyMQuwd612Yr--wb8btsVAXf%22%2C%22y%22%3A%22oCsstCTa8NGZ6ou1GOB8mJhdn_gAzeTlHtINFrF1_VG9k0JxFnE9aHyi2qgoW9vx%22%2C%22key_ops%22%3A%5B%22sign%22%5D%2C%22ext%22%3Atrue%2C%22kid%22%3A%2235fbeb4493b0569fb6983a35f06aa5b9%22%2C%22alg%22%3A%22ES384%22%7D%5D%7D&amp;dur=15&#39;\n\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6InJlZ2lzdHJhdGlvbi10b2tlbiJ9.eyJqd2tzIjp7ImtleXMiOlt7Imt0eSI6IkVDIiwiY3J2IjoiUC0zODQiLCJ4IjoibFNHLTlYSFpjTjZYZFVYRTZzQ252bkdZSENsWjFvZFpMVXJMb3Uza2d5TVF1d2Q2MTJZci0td2I4YnRzVkFYZiIsInkiOiJvQ3NzdENUYThOR1o2b3UxR09COG1KaGRuX2dBemVUbEh0SU5GckYxX1ZHOWswSnhGbkU5YUh5aTJxZ29XOXZ4Iiwia2V5X29wcyI6WyJ2ZXJpZnkiXSwiZXh0Ijp0cnVlLCJraWQiOiIzNWZiZWI0NDkzYjA1NjlmYjY5ODNhMzVmMDZhYTViOSIsImFsZyI6IkVTMzg0In0seyJrdHkiOiJFQyIsImNydiI6IlAtMzg0IiwiZCI6Iktvem5jV01uX2xvNm5CYTJub3U1SE0yaFBnbkFjcDczQjVzUWwzX3Z0NjFPOXd4VEdfczR4Z2pEQU84aXBOa2ciLCJ4IjoibFNHLTlYSFpjTjZYZFVYRTZzQ252bkdZSENsWjFvZFpMVXJMb3Uza2d5TVF1d2Q2MTJZci0td2I4YnRzVkFYZiIsInkiOiJvQ3NzdENUYThOR1o2b3UxR09COG1KaGRuX2dBemVUbEh0SU5GckYxX1ZHOWswSnhGbkU5YUh5aTJxZ29XOXZ4Iiwia2V5X29wcyI6WyJzaWduIl0sImV4dCI6dHJ1ZSwia2lkIjoiMzVmYmViNDQ5M2IwNTY5ZmI2OTgzYTM1ZjA2YWE1YjkiLCJhbGciOiJFUzM4NCJ9XX0sImFjY2Vzc1Rva2Vuc0V4cGlyZUluIjoxNSwiaWF0IjoxNjIxNDQxMDk1fQ.b3Jx59dv_-hnRWapq99So7Plv58pS90CzmY4auWTLCA\n</code></pre></div>\n<p>... but it's probably easiest to interact with this via the UI.</p>",
        "id": 239453978,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621441120
    },
    {
        "content": "<p>(Digging in here, there's clearly more work for this to be testable; there are internal design choices bleeding through when they shouldn't.)</p>",
        "id": 239454736,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621441423
    },
    {
        "content": "<p>In the track, scenario 2 specifies using the rather lengthy scope</p>\n<div class=\"codehilite\"><pre><span></span><code>patient/Observation.rs?category=http://terminology.hl7.org/CodeSystem/observation-category|vital-signs\n</code></pre></div>\n<p>Is this equivalent to</p>\n<div class=\"codehilite\"><pre><span></span><code>patient/Observation.rs?category=vital-signs\n</code></pre></div>\n<p>Currently the <a href=\"http://smart.argo.run\">smart.argo.run</a> test tool requires the scope to match with the category syntax of the resource request (i.e., system specified or not). I guess FHIR servers are expected to interpret the finer grained scopes so that either category syntax in the actual resource request is allowed?</p>",
        "id": 239458114,
        "sender_full_name": "Chuck Feltner",
        "timestamp": 1621442753
    },
    {
        "content": "<p><a href=\"https://hl7-org.zoom.us/s/96463166857?pwd=OU92WncxTDFjTWtVZjVxSUlOdGo2Zz09\">Wrap-up call</a> in 30min -- quick reminder to fill out <a href=\"https://docs.google.com/spreadsheets/d/10j4a0juCrlZPDtrvOQaNNgSNPUU5MK9Hm7reCg1RF6A/edit#gid=0\">notes and questions in Column G</a> beforehand.</p>",
        "id": 239460482,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621443688
    },
    {
        "content": "<p>Technically speaking,</p>\n<div class=\"codehilite\"><pre><span></span><code>patient/Observation.rs?category=http://terminology.hl7.org/CodeSystem/observation-category|vital-signs\n</code></pre></div>\n\n<p>is narrower than</p>\n<div class=\"codehilite\"><pre><span></span><code>patient/Observation.rs?category=vital-signs\n</code></pre></div>\n\n<p>... because the former only matches Observations with the FHIR-recommended system, and the latter matches Observations with <em>any</em> system (which isn't what we really want).</p>",
        "id": 239460636,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621443736
    },
    {
        "content": "<p>Based on discussions in the argonaut calls, we want to encourage use of specific systems when restricting by Coding, when that's the intention (and in this case of category-based observations, it's definitely the intention).</p>",
        "id": 239460745,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621443780
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> Is the source code for the test harness SMART app at <a href=\"https://smart.argo.run/granular/\">https://smart.argo.run/granular/</a> available by any chance? I was looking for it at <a href=\"https://github.com/smart-on-fhir\">https://github.com/smart-on-fhir</a> but no luck...</p>",
        "id": 240766201,
        "sender_full_name": "Nikolai Schwertner",
        "timestamp": 1622396338
    },
    {
        "content": "<p><a href=\"https://github.com/smart-on-fhir/smart-launcher/pull/47\">https://github.com/smart-on-fhir/smart-launcher/pull/47</a> is the PR with draft be functionality, as deployed at <a href=\"http://smart.argo.run\">smart.argo.run</a></p>",
        "id": 240767017,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1622397665
    },
    {
        "content": "<p>Thank you very much <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span><br>\nNice work, <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span>!</p>",
        "id": 240776704,
        "sender_full_name": "Nikolai Schwertner",
        "timestamp": 1622412773
    },
    {
        "content": "<p>In reviewing the example response from the spec here<br>\n<a href=\"http://build.fhir.org/ig/HL7/smart-app-launch/conformance.html#sample-response\">http://build.fhir.org/ig/HL7/smart-app-launch/conformance.html#sample-response</a></p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  ...\n  &quot;scopes_supported&quot;: [&quot;openid&quot;, &quot;profile&quot;, &quot;launch&quot;, &quot;launch/patient&quot;, &quot;patient/*.rs&quot;, &quot;user/*.rs&quot;, &quot;offline_access&quot;],\n  &quot;response_types_supported&quot;: [&quot;code&quot;, &quot;code id_token&quot;, &quot;id_token&quot;, &quot;refresh_token&quot;],\n  &quot;management_endpoint&quot;: &quot;https://ehr.example.com/user/manage&quot;,\n  ...\n}\n</code></pre></div>\n<p>I note that the response_types_supported has an example value of <code>\"code token\"</code> and the 2 values as seperate <code>code</code> and <code>token</code>. Is that meant to imply that the combinations supported should be included?<br>\n<span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> ?</p>",
        "id": 243728162,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1624492728
    },
    {
        "content": "<p>Do you mean <code>\"code id_token\"</code> ? This isn't something we particularly profile in SMART, but if you read the OIDC Core spec, <a href=\"https://openid.net/specs/openid-connect-core-1_0.html#HybridAuthRequest\">https://openid.net/specs/openid-connect-core-1_0.html#HybridAuthRequest</a> defines this behavior. But it's perhaps a confusing example for us to include here</p>",
        "id": 243731115,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1624495990
    },
    {
        "content": "<p>Isn't it really just saying that they are space delimited, rather than the combination is required to be pre-declared?</p>",
        "id": 243732088,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1624497183
    },
    {
        "content": "<p>No this is a specific hybrid flow that gives you back an ID token and an authorization code as two separate artifacts</p>",
        "id": 243732215,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1624497338
    },
    {
        "content": "<p>It's the <code>code id_token</code> flow.</p>",
        "id": 243732224,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1624497356
    },
    {
        "content": "<p>Hybrid flow in OIDC is pretty in the weeds though; I wouldn't bother with it in the context of SMART app launch use cases.</p>",
        "id": 243732301,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1624497432
    },
    {
        "content": "<p>Ah, so <code>code</code> for code exchange (via the token endpoint)<br>\nor <code>code id-token</code> to get code (to exchange for bearer at token endpoint) and also id_token at the same time</p>",
        "id": 243732389,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1624497543
    },
    {
        "content": "<p>I get what you mean, I've only done the code flow.</p>",
        "id": 243732391,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1624497559
    },
    {
        "content": "<p>Yeah, code is all that SMART requires (as long as you support scopes that allow you to request an ID token as part of the access token response). <a href=\"https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata\">https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata</a> goes into more definitional detail though if you are interested.</p>",
        "id": 243732455,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1624497626
    },
    {
        "content": "<p>Thanks, I'll leave that part as just having code in the Australian profile to keep it simple...</p>",
        "id": 243732635,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1624497881
    },
    {
        "content": "<p>id-token can come back from the code exchange anyway through the scope <code>openid fhirUser</code> right?</p>",
        "id": 243732819,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1624498099
    },
    {
        "content": "<p>With code flow, you can get an id token back in the access token response, when you trade in your authorization code at the token endpoint. (With the hybrid flow, you can get an id_token back at the same time you receive the code, as a URL param.)</p>",
        "id": 243737337,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1624504556
    },
    {
        "content": "<p>In the metadata scopes defined, there is a note that additional scopes MAY be supported, but there isn't a note, that not all clients will have access to all scopes listed too - is this a reasonable thing to have added?<br>\n<a href=\"http://build.fhir.org/ig/HL7/smart-app-launch/conformance.html#metadata\">http://build.fhir.org/ig/HL7/smart-app-launch/conformance.html#metadata</a></p>",
        "id": 244369406,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625017911
    },
    {
        "content": "<p>Also the link in that section points to a docs.smarthealthit page, and not to the scopes page in the spec - log this?</p>",
        "id": 244369486,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625018007
    },
    {
        "content": "<p>When a client requests a scope via the permission-v1 format, is there any guidance or expectation that the auth server should return v1 permissions, or could it return v2 permissions instead?<br>\nSorry, just found the line that specifically points this out. (I missread the semantics mapping)</p>",
        "id": 244369847,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625018424
    },
    {
        "content": "<p>Re: \"not all clients will have access to all scopes\" -- we really don't say anything about client registration. if there's specific language you'd like to see, definitely do submit an issue. </p>\n<p>And yeah, issue for the incorrect link would be great. Thanks!</p>",
        "id": 244371131,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1625020116
    }
]