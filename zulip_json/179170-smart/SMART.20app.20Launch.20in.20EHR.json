[
    {
        "content": "<p>Hi...!!! We are trying to implement the Launch EHR Sequence and need clarity to confusion on the Launch URL in terms of Launch context parameter using JWT:</p>\n<p>When we are using the JWT encoding under the launch parameter then do we also need to send the specific parameter of user and patient for setting the context:<br>\nE.g.  A EHR User already has a session active and the same user is launching the app under EHR instance:<br>\n{<br>\n  \"alg\": \"HS256\",<br>\n  \"typ\": \"JWT\"<br>\n}<br>\n{<br>\n  \"iss\": \"<a href=\"http://ehr.example.com\">http://ehr.example.com</a>\",<br>\n  \"ctx\": {\"user\": \"87a339d0-8cae-418e-89c7-8651e6aab3c6\"},<br>\n  \"scope\": \"launch \"<br>\n}<br>\nNow which of the following launch URL is correct for app launch:<br>\nhttps%3A%2F%2FFHIRBaseURL%2Flaunch.html?iss=http%3A%2F%2Fehr.example.com&amp;launch=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vZWhyLmV4YW1wbGUuY29tIiwiY3R4Ijp7InVzZXIiOiI4N2EzMzlkMC04Y2FlLTQxOGUtODljNy04NjUxZTZhYWIzYzYifSwic2NvcGUiOiJsYXVuY2gifQ.gZer_vNGXDuR63A6QzrPG7IbDDD67jhWybS1A4UJbXI</p>\n<p>OR </p>\n<p>https%3A%2F%2FFHIRBaseURL%2Flaunch.html?iss=http%3A%2F%2Fehr.example.com&amp;launch=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vZWhyLmV4YW1wbGUuY29tIiwiY3R4Ijp7InVzZXIiOiI4N2EzMzlkMC04Y2FlLTQxOGUtODljNy04NjUxZTZhYWIzYzYifSwic2NvcGUiOiJsYXVuY2gifQ.gZer_vNGXDuR63A6QzrPG7IbDDD67jhWybS1A4UJbXI&amp;user=87a339d0-8cae-418e-89c7-8651e6aab3c6</p>\n<p>Please suggest...Thanks in advance!!!</p>",
        "id": 244525882,
        "sender_full_name": "Nihar",
        "timestamp": 1625122684
    },
    {
        "content": "<p>From what I've seen the first call is a more common one. You give the client the <code>iss</code> and <code>launch</code> parameters. The client then passes the <code>launch</code> parameter back when asking for a token, that's how your EHR can identify the context (the user and the patient). If the client wishes to know the user, it should add the either the <code>openid</code> or the <code>fhirUser</code> scope in the token request (<a href=\"http://www.hl7.org/fhir/smart-app-launch/#step-3-app-exchanges-authorization-code-for-access-token\">http://www.hl7.org/fhir/smart-app-launch/#step-3-app-exchanges-authorization-code-for-access-token</a>), and would then get the <code>id_token</code> object with the info of the user.</p>",
        "id": 244560311,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1625144015
    },
    {
        "content": "<p>Yes, first one</p>",
        "id": 244560599,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1625144134
    },
    {
        "content": "<p>And this is regardless of whether you use JWT or not. The launch parameter should be just an opaque string to the client, the client should not even try to parse it.</p>",
        "id": 244561028,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1625144316
    }
]