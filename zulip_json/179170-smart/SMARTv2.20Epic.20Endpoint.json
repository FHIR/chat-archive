[
    {
        "content": "<p>When I authorize my client requesting <code>patient/Observation.rs</code>, I get:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;scope&quot;: &quot;Epic.Security.OAuth2.Introspect patient/Observation.c?category=vital-signs patient/Patient.r fhirUser openid&quot;,\n</code></pre></div>\n\n<p>... which has some surprising things:</p>\n<ol>\n<li>I didn't ask for \"create\" permissions, but I got them</li>\n<li>I asked for \"search\" permissions, but I didn't get them</li>\n<li>Even though I don't have \"search\" permissions, I can still successfully search for vital signs</li>\n</ol>\n<p>I think (1) and (2) are because Epic's server only looks at scopes the client is <em>registered for</em> rather than what is <em>requested</em>. (3) is more mysterious.</p>",
        "id": 222780749,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1610656838
    },
    {
        "content": "<p>When I try to call <code>https://connectathon.epic.com/Interconnect-Fhir-OAuth/oauth2/introspect</code> I get \"Service is disabled or unsupported by security policy\" -- I'm guessing this is related to <a href=\"https://docs.google.com/document/d/1bTJBmqYwePzjoYwvLq08puODUaHcuV1I9cScoGo2DF8/edit\">this note</a></p>\n<blockquote>\n<p>We require Bearer token auth for the token introspection on this server.</p>\n</blockquote>\n<p>Does this mean I'm supposed to put the same token in a header and in the body before I can this call?</p>",
        "id": 222780967,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1610656933
    },
    {
        "content": "<p>(This feels like jumping through a hoop without clear benefit -- but I think I get it because in general the client calling the introspection endpoint may not be the client to whom the access token is issued, and you are managing authorization for that endpoint distinctly.)</p>",
        "id": 222781000,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1610656951
    },
    {
        "content": "<p>Yeah - it is actually configurable by each Epic site how they want to handle authentication for each service/endpoint. We have it set up to require Bearer auth in this environment for the reasons you guessed I believe.</p>",
        "id": 222782360,
        "sender_full_name": "Jake Fisher",
        "timestamp": 1610657604
    },
    {
        "content": "<p>You're correct that the scopes returned are those that are statically registered, though now (as you may have seen) patients can choose which ones they want to allow the app to access. </p>\n<p>That said, you should be getting create, search and read permissions for Observations?category=vital-signs for that app (or none of them if the patient doesn't want you to access vital-signs). </p>\n<p>I'll take a look at what's going on there. We retooled how we inform the app of their scopes as part of the \"patient selectable scopes\" project and you're testing against dev that is not 100% through the dev+testing process so there could still be some quirks.</p>",
        "id": 222782745,
        "sender_full_name": "Jake Fisher",
        "timestamp": 1610657771
    },
    {
        "content": "<p>Thanks for this info, and for looking into it</p>",
        "id": 222782796,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1610657806
    },
    {
        "content": "<p>The test patient portal login here seems to be broken, I'm getting a <code>You have reached the maximum failed login attempts</code> error. Can you reset the account <span class=\"user-mention\" data-user-id=\"279701\">@Jake Fisher</span> ?</p>",
        "id": 222867140,
        "sender_full_name": "Keith Carlson",
        "timestamp": 1610722425
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"308473\">@Keith Carlson</span> what happens if you try clearing cookies? I can look into it more need be, but if it's failed logins that might be a quick fix</p>",
        "id": 222878798,
        "sender_full_name": "adam strickland",
        "timestamp": 1610726557
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"308473\">@Keith Carlson</span> The account needed to be reset. It works again now.</p>",
        "id": 222879180,
        "sender_full_name": "Jake Fisher",
        "timestamp": 1610726681
    },
    {
        "content": "<p>Does this server support PKCE with a patient facing app? It is currently not working for me</p>",
        "id": 222915125,
        "sender_full_name": "Keith Carlson",
        "timestamp": 1610740249
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 222918404,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1610741510
    },
    {
        "content": "<p>My bad; I think I used the wrong client ID; deleted my comment above :)</p>",
        "id": 222918557,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1610741561
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"308473\">@Keith Carlson</span>  - yes it works for me: <br>\n<a href=\"/user_uploads/10155/D7RHsBrDMBoudaKtpXFqSJCn/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/D7RHsBrDMBoudaKtpXFqSJCn/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/D7RHsBrDMBoudaKtpXFqSJCn/image.png\"></a></div>",
        "id": 222918656,
        "sender_full_name": "Jake Fisher",
        "timestamp": 1610741612
    },
    {
        "content": "<p>Hi ,<br>\nIam want to access <a href=\"http://patient.read\">patient.read</a> api in fhir<br>\nusing Access token Iam going to access only <a href=\"http://patient.search\">patient.search</a> .I not able to access <a href=\"http://patient.read\">patient.read</a> and other API<br>\nplease help me, In the body field will we set scope for what are all api Iam going to access<br>\nif yes please say the format for scope for accessing <a href=\"http://patient.read\">patient.read</a> and <a href=\"http://observation.read\">observation.read</a> Api</p>\n<p>David Pyke: This channel is for social discussions. Technical discussions should be in #implementers</p>",
        "id": 247202417,
        "sender_full_name": "Gowtham",
        "timestamp": 1627306324
    },
    {
        "content": "<p>What sort of error are you getting?</p>",
        "id": 247209737,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627309770
    },
    {
        "content": "<p>What is your client ID? Do you have both <a href=\"http://patient.read\">patient.read</a> and <a href=\"http://patient.search\">patient.search</a> APIs registered for your  client?</p>",
        "id": 247231099,
        "sender_full_name": "Cooper Thompson",
        "timestamp": 1627318992
    }
]