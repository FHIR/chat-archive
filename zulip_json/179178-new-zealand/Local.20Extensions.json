[
    {
        "content": "<p>HL7 New Zealand and partners are interested in identifying the current and proposed use of FHIR extensions in NZ. All implementers  of Kiwi-based FHIR solutions on this thread are invited to contribute... <span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> , <span class=\"user-mention\" data-user-id=\"195365\">@Daniel Thomson</span> , <span class=\"user-mention\" data-user-id=\"191683\">@David Moorhouse</span> , <span class=\"user-mention\" data-user-id=\"191773\">@David Fallas</span> , <span class=\"user-mention\" data-user-id=\"194931\">@Alastair Kenworthy</span> , <span class=\"user-mention\" data-user-id=\"195034\">@Abdul Rauf</span> , <span class=\"user-mention\" data-user-id=\"193920\">@Graeme Hibbert</span> , <span class=\"user-mention\" data-user-id=\"192240\">@Nate Walker</span> , <span class=\"user-mention\" data-user-id=\"195045\">@John Carter</span> , <span class=\"user-mention\" data-user-id=\"193428\">@Dan Lord</span> , <span class=\"user-mention\" data-user-id=\"193463\">@Ben Gray</span> , <span class=\"user-mention\" data-user-id=\"192525\">@Chandan Datta</span> , <span class=\"user-mention\" data-user-id=\"191420\">@Koray Atalag</span> , <span class=\"user-mention\" data-user-id=\"191459\">@Ray Murakami</span> , <span class=\"user-mention\" data-user-id=\"194577\">@Martin Entwistle</span> , <span class=\"user-mention\" data-user-id=\"193335\">@Chris Hilder</span> , <span class=\"user-mention\" data-user-id=\"191709\">@David Teirney</span> , <span class=\"user-mention\" data-user-id=\"195018\">@Jason Marshall</span>   ... and others including, of course, our friends from over 'The Ditch'.</p>",
        "id": 153995073,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1536546489
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> , how can i find what extensions have been identified so far? I'm looking for extensions for Ethnicity, Quintile and Domicile DHB</p>",
        "id": 166606652,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1558929920
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"193759\">@Mohannad Hammadeh</span> - <span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> who is working on a FHIR API for the NHI is probably best placed to answer this question. I would definitely expect to see an 'official' extension for NZ Ethnicity to be part of that work. I'd be interested to know what project requires Quintile and Domicile DHB to be transferred as they can be calculated from addresses (certainly by all the primary care systems).</p>",
        "id": 166610089,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1558935783
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> is working on it! Awesome, I should check clinfhir then.</p>",
        "id": 166666364,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1558994341
    },
    {
        "content": "<p>Hi Mo! The work is documented at <a href=\"http://nz.clinfhir.com/\" target=\"_blank\" title=\"http://nz.clinfhir.com/\">http://nz.clinfhir.com/</a> and you're right - I'm using clinFhir to model this. Feel free to comment - it's all draft at this stage...</p>\n<p>BTW - this work will be a focus at the upcoming HL7 NZ Connectathon (<a href=\"https://sites.google.com/a/hl7.org.nz/hl7-new-zealand/news/hl7nzmid-yearseminar\" target=\"_blank\" title=\"https://sites.google.com/a/hl7.org.nz/hl7-new-zealand/news/hl7nzmid-yearseminar\">https://sites.google.com/a/hl7.org.nz/hl7-new-zealand/news/hl7nzmid-yearseminar</a>) - would be great to see you (and anyone else interested in this stuff) there! It will be deeply technical, and we'll have the MOH folk there to engage in discussion about what should be in - or out - of the queries...</p>",
        "id": 166671063,
        "sender_full_name": "David Hay",
        "timestamp": 1558999538
    },
    {
        "content": "<p>Hi Dr Hay! That is almost exactly what we're after. Thank you. I think you covered all the extensions that we need in that profile, but I've got a couple of questions.<br>\n1. Patient.address.suburb - is that a fhir element? i dont see it under <a href=\"https://www.hl7.org/fhir/STU3/datatypes.html#Address\" target=\"_blank\" title=\"https://www.hl7.org/fhir/STU3/datatypes.html#Address\">https://www.hl7.org/fhir/STU3/datatypes.html#Address</a><br>\n2. The elements under the geoCode extension, say for example deprivationQuintile, would the URL be <a href=\"http://hl7.org.nz/fhir/StructureDefinition/nzGeoCode#deprivationQuintile\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/nzGeoCode#deprivationQuintile\">http://hl7.org.nz/fhir/StructureDefinition/nzGeoCode#deprivationQuintile</a> ?<br>\nWill have to double check about the connectathon ;)</p>",
        "id": 166672604,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1559002017
    },
    {
        "content": "<p>excellent! - Just remember that most of these are proposed though. Plan is to put them out for comment, so be prepared to change :)</p>",
        "id": 166674984,
        "sender_full_name": "David Hay",
        "timestamp": 1559005928
    },
    {
        "content": "<p>You're right about suburb - my bad...</p>",
        "id": 166674987,
        "sender_full_name": "David Hay",
        "timestamp": 1559005943
    },
    {
        "content": "<p>wrt quintile, the url to the complex extension would just  be <a href=\"http://hl7.org.nz/fhir/StructureDefinition/nzGeoCode\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/nzGeoCode\">http://hl7.org.nz/fhir/StructureDefinition/nzGeoCode</a>. The child elements are (will be) defined within that SD...  Fingers Xed that you can make the connectathon - be very good to have an Orion person there...</p>",
        "id": 166675053,
        "sender_full_name": "David Hay",
        "timestamp": 1559006081
    },
    {
        "content": "<p>BTW - working on some samples to help validate the models. See</p>\n<p>home.clinfhir.com:8054/baseR4/Patient/patient2<br>\nhome.clinfhir.com:8054/baseR4/Practitioner/practitioner1<br>\nhome.clinfhir.com:8054/baseR4/Organization/organization1<br>\nhome.clinfhir.com:8054/baseR4/Location/location1</p>\n<p>Usual disclaimer!  Also - none of the extension definitions are built yet. Would like to agree on the naming conventions first...</p>",
        "id": 166675334,
        "sender_full_name": "David Hay",
        "timestamp": 1559006580
    },
    {
        "content": "<p>Yes i did think they were proposed at this stage. Is there a way we can get them reviewed and finalised relatively soon? I'd like to get the project team to use something standard instead of coming up with their own.</p>",
        "id": 166676885,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1559009273
    },
    {
        "content": "<p>Those samples are looking good! Is there anywhere we can collaborate/provide feedback on them?</p>",
        "id": 166677171,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1559009721
    },
    {
        "content": "<p>Always interested in collaborators :) - what kind of feedback were you thinking of? You could just make comments here if you like - or to my email, whatever works best for you...</p>",
        "id": 166678688,
        "sender_full_name": "David Hay",
        "timestamp": 1559012225
    },
    {
        "content": "<p>I think that it would be preferable if discussions about national FHIR extensions took place in an open forum, such as this.  I'd also suggest that implementers make the base URL a configurable property for the time being, until a final decision has been reached on this.</p>",
        "id": 166679835,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1559014123
    },
    {
        "content": "<p>The urls will be agreed before any production deployment I would imagine - indeed, I'd hope to have that done sooner rather than later...</p>\n<p>The current urls are visible in the models at <a href=\"http://nz.clinfhir.com\" target=\"_blank\" title=\"http://nz.clinfhir.com\">nz.clinfhir.com</a> (as will, of course, the 'real' fhir IGs that will be generated from them). Of course, it's all draft at this point, but anyone can comment either against the models, in this forum or privately (if that is what they want - not everyone is comfortable posting in an open forum!). But any proposed artefacts will always be publicly available... </p>\n<p>I'm working on getting some summary views of the extension /valueset / codesystem urls available to make it easier to review them - I'll upload and paste a link here when that's done</p>\n<p>I'm hoping that the upcoming connectathon will be the impetus to get the community involved in this...</p>",
        "id": 166683603,
        "sender_full_name": "David Hay",
        "timestamp": 1559020175
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> it's a bit tricky for the extensions to be made configurable as it's not only the URLs that would have to be configurable but also the structure and position of the extension. Also if we go into production with temporary extensions and various applications end up consuming them it would make it difficult to standardise the extensions in the future.</p>",
        "id": 166763893,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1559080897
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> do we have a date for when we'd expect production deployments?</p>",
        "id": 166763974,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1559080957
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> one bit of feedback about the naming of extensions is that fhir seems to follow the naming pattern of &lt;resource&gt;-&lt;extensionName&gt;, for example: (from <a href=\"https://www.hl7.org/fhir/R4/patient-profiles.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/R4/patient-profiles.html\">https://www.hl7.org/fhir/R4/patient-profiles.html</a>)<br>\n- patient-adoptionInfo  <br>\n- patient-animal    <br>\n- patient-birthPlace    <br>\n- patient-birthTime <br>\n- patient-cadavericDonor</p>\n<p>Should we follow that pattern for the nz extensions? so <br>\n<a href=\"http://hl7.org.nz/fhir/StructureDefinition/nzDhb\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/nzDhb\">http://hl7.org.nz/fhir/StructureDefinition/nzDhb</a> -&gt; <a href=\"http://hl7.org.nz/fhir/StructureDefinition/patient-nzDhb\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/patient-nzDhb\">http://hl7.org.nz/fhir/StructureDefinition/patient-nzDhb</a><br>\n<a href=\"http://hl7.org.nz/fhir/StructureDefinition/nzethnicity\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/nzethnicity\">http://hl7.org.nz/fhir/StructureDefinition/nzethnicity</a> -&gt; <a href=\"http://hl7.org.nz/fhir/StructureDefinition/patient-nzEthnicity\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/patient-nzEthnicity\">http://hl7.org.nz/fhir/StructureDefinition/patient-nzEthnicity</a></p>",
        "id": 166764565,
        "sender_full_name": "Mohannad Hammadeh",
        "timestamp": 1559081475
    },
    {
        "content": "<p>That's certainly one of the questions that would be good to get input on. It does assume that a single extension is only used in a single resource though (at least from a naming perspective)... </p>\n<p>Given the the current stuff I'm working on is specifically an interface to NHI/HPI, I've started using that as the prefix - eg <a href=\"http://hl7.org.nz/fhir/StructureDefinition/hpiPractitionerRegistration\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/hpiPractitionerRegistration\">http://hl7.org.nz/fhir/StructureDefinition/hpiPractitionerRegistration</a> for the HPI registration extension.</p>\n<p>I don't have a strong opinion - but would be great to get others thoughts!  </p>\n<p>(btw - if you want to see all the extensions in a model, go to the 'analysis' tab, then 'Extensions'. You'll get a display of all extensions in a model, hyperlinked to the element definition)</p>",
        "id": 166765657,
        "sender_full_name": "David Hay",
        "timestamp": 1559082370
    },
    {
        "content": "<p>Domicile DHB and Deprivation Quintile are not direct patient attributes - they are attributes of an (NZ) address, calculated according to non-immutable criteria (e.g. DQs are re-calculated after each census and I doubt if the current structure of 20 DHBs will exist for too much longer). I find it hard to envisage any future national HIE project based on FHIR that will require these. Certainly the National Enrolment Service performs the calculations internally (i.e. no longer requires general practices to send it as part of the patient register  for CBF payment purposes- and then deal with thousands of errors!) and, for obvious reasons, these fields will never be part of the GP2GP Data Model.</p>",
        "id": 166766721,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1559083293
    },
    {
        "content": "<p>Well that's true - but the address is an attribute of patient, which is why they are modelled as extensions on address (you could argue that the name could reflect that better). As to whether they should be included at all? well, that's really a matter for the MOH team to decide (in this case) - there are many different users of the NHI service, and it may be that supplying this data in the response, rather than requiring them to look it up themselves is useful...</p>",
        "id": 166767564,
        "sender_full_name": "David Hay",
        "timestamp": 1559083973
    },
    {
        "content": "<p>Agree that any extensions based on address should be named accordingly. Most NZ healthcare facilities do address mapping , querying and validation via eSAM Web Services... <a href=\"https://www.health.govt.nz/system/files/documents/pages/hip_address_services_integration_guide_v8.0.pdf\" target=\"_blank\" title=\"https://www.health.govt.nz/system/files/documents/pages/hip_address_services_integration_guide_v8.0.pdf\">https://www.health.govt.nz/system/files/documents/pages/hip_address_services_integration_guide_v8.0.pdf</a><br>\nThese return DQs, DHB district, etc.</p>",
        "id": 166767987,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1559084302
    },
    {
        "content": "<p>A person's DHB is determined by where they usually reside and  generally that can be derived from the address. However, sometimes an actual address is not available (eg person has no fixed abode, their address is new and not in any reference data yet, person resides overseas).   Putting DHB as an attribute of  patient means that the NHI can manage all those exception rules and reduce effort on the part of the integrator.  I think it fits better on the patient than the address because a patient may have multiple addresses (residential, mailing, temporary address) but they only have one DHB.</p>",
        "id": 166769526,
        "sender_full_name": "Anne Goodwin",
        "timestamp": 1559085759
    },
    {
        "content": "<p>Interesting, what determines which DHB a patient is linked to if they have no address or multiple addresses?</p>",
        "id": 166771082,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1559087349
    },
    {
        "content": "<p>So there's 2 extensions on address - geocode, and notValidated reason. how about:<br>\n<a href=\"http://hl7.org.nz/fhir/StructureDefinition/patient-address-geoCode\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/patient-address-geoCode\">http://hl7.org.nz/fhir/StructureDefinition/patient-address-geoCode</a> or just <a href=\"http://hl7.org.nz/fhir/StructureDefinition/address-geoCode\" target=\"_blank\" title=\"http://hl7.org.nz/fhir/StructureDefinition/address-geoCode\">http://hl7.org.nz/fhir/StructureDefinition/address-geoCode</a> ?</p>",
        "id": 166771086,
        "sender_full_name": "David Hay",
        "timestamp": 1559087359
    },
    {
        "content": "<p>Prefer the later as the address might be be used by resources other than Patient, e.g. Location.</p>",
        "id": 166771256,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1559087514
    },
    {
        "content": "<p><a href=\"http://hl7.org/fhir/StructureDefinition/geolocation\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/geolocation\">http://hl7.org/fhir/StructureDefinition/geolocation</a></p>",
        "id": 166771345,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559087605
    },
    {
        "content": "<p>Hmm. missed that...</p>",
        "id": 166777568,
        "sender_full_name": "David Hay",
        "timestamp": 1559096214
    },
    {
        "content": "<p>The eSAM address service used by MoH returns lat longs using the New Zealand Geodetic Datum 2000 (NZGD2000) :<br>\n<a href=\"https://www.health.govt.nz/system/files/documents/pages/hip_address_services_integration_guide_v8.0.pdf\" target=\"_blank\" title=\"https://www.health.govt.nz/system/files/documents/pages/hip_address_services_integration_guide_v8.0.pdf\">https://www.health.govt.nz/system/files/documents/pages/hip_address_services_integration_guide_v8.0.pdf</a></p>\n<p><a href=\"http://hl7.org/fhir/StructureDefinition/geolocation\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/geolocation\">http://hl7.org/fhir/StructureDefinition/geolocation</a> uses  the  WGS84  datum used by GoogleMaps.  I think these are very similar but not identical. We might want an extension to allow us to be specifc about the datum</p>",
        "id": 166780892,
        "sender_full_name": "Patrick Ryan",
        "timestamp": 1559101280
    },
    {
        "content": "<p>That's a very good bit of information, and maybe that's the difference to what is in your extension, so if folks want to use the standard one, they can perform the co-ordinate system conversion.</p>",
        "id": 167182488,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1559564083
    },
    {
        "content": "<p>If it's possible to convert between the 2 algorithmically, then would it be better that the NHI service perform the conversion and use the standard extension?  Or - should the datum be added to the standard extension?</p>",
        "id": 167221032,
        "sender_full_name": "David Hay",
        "timestamp": 1559588824
    },
    {
        "content": "<p>I personally would prefer not to have to check the datum value too.<br>\n(lazy programmer)</p>",
        "id": 167246922,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1559610346
    },
    {
        "content": "<p>But - if I understand the issue - doesn't that mean that the datum is implicit? (lazy = efficient!)</p>",
        "id": 167257490,
        "sender_full_name": "David Hay",
        "timestamp": 1559625383
    },
    {
        "content": "<p>Those extensions are implicitly that datum. Which is also the same one used in many major maps providers.</p>",
        "id": 167258471,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1559626726
    },
    {
        "content": "<p>So we (NZ) have our own datum? Bother. That suggests that either we convert when using the extension, extend the extension or create another one...</p>",
        "id": 167259006,
        "sender_full_name": "David Hay",
        "timestamp": 1559627152
    }
]