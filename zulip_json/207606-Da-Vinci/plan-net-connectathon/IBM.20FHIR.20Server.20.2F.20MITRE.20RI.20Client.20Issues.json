[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191676\">@Lee Surprenant</span> <br>\nThis query runs well:<br>\n<a href=\"https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID030000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Location&amp;_revinclude=OrganizationAffiliation:location\">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID030000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Location&amp;_revinclude=OrganizationAffiliation:location</a></p>\n<p>The same query returns an error code when run against the IBM Server.   Not sure about the error.  Can you say whether it is justified?<br>\n<a href=\"https://cluster1-573846-250babbbe4c3000e15508cd07c1d282b-0000.us-east.containers.appdomain.cloud/open/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID030000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Location&amp;_revinclude=OrganizationAffiliation:location\">https://cluster1-573846-250babbbe4c3000e15508cd07c1d282b-0000.us-east.containers.appdomain.cloud/open/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID030000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Location&amp;_revinclude=OrganizationAffiliation:location</a></p>\n<p>returns:<br>\n{<br>\n    \"resourceType\": \"OperationOutcome\",<br>\n    \"id\": \"ac-11-3d-8a-2eaf5074-2bf2-4e63-a3e6-b5623bc58e41\",<br>\n    \"issue\": [<br>\n        {<br>\n            \"severity\": \"fatal\",<br>\n            \"code\": \"invalid\",<br>\n            \"details\": {<br>\n                \"text\": \"Search parameter '_has' for resource type 'Location' was not found.\"<br>\n            },<br>\n            \"expression\": [<br>\n                \"&lt;empty&gt;\"<br>\n            ]<br>\n        }<br>\n    ]<br>\n}</p>",
        "id": 209717255,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1599776656
    },
    {
        "content": "<p>yeah, the query is fine. we just don't support <code>_has</code> yet</p>",
        "id": 209717296,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599776690
    },
    {
        "content": "<p>let me see if can rework the query with forward chaining only</p>",
        "id": 209770789,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1599825274
    },
    {
        "content": "<p>i havn't even checked in the capabilitystatement yet about whether reverse chaining (_has) is required to support or not.  we do plan to add it sometime soon (but sadly its a bigger lift than i could accomplish during connectathon)</p>",
        "id": 209773515,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599827194
    },
    {
        "content": "<p>do CapabilityStatements + SearchParameter definitions even have the ability to capture which reverse chaining parameters are required?!</p>",
        "id": 209776008,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599828620
    },
    {
        "content": "<p>I see <a href=\"https://www.hl7.org/fhir/searchparameter-definitions.html#SearchParameter.chain\">https://www.hl7.org/fhir/searchparameter-definitions.html#SearchParameter.chain</a> but nothing about reverse chaining</p>",
        "id": 209776044,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599828642
    },
    {
        "content": "<p>I was wondering the same thing.   I've consulted my CapStmt experts, and one of them tells me that it can be stated.    Will be looking into it.</p>",
        "id": 209783328,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1599832418
    },
    {
        "content": "<p>Queries can't easily be rewritten with forward chaining.   Queries need to use Location as focal resource in order to have server do filtering by location. If I rewrite the queries with OrganizationAffiliation as focal resource, and constrain to those having a location that is geographically appropriate, and include location, the query returns all of the locations associated with the organizationAffiliation. That will impose a burden on both server and client.</p>\n<p>This is how the query would look:<br>\n<a href=\"https://davinci-plan-net-ri.logicahealth.org/fhir/OrganizationAffiliation?network=plannet-network-HPID030000&amp;role=pharmacy&amp;specialty=3336C0003X&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-OrganizationAffiliation&amp;_include=OrganizationAffiliation:location&amp;location.address=06040,06074,06043,06118,06041\">https://davinci-plan-net-ri.logicahealth.org/fhir/OrganizationAffiliation?network=plannet-network-HPID030000&amp;role=pharmacy&amp;specialty=3336C0003X&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-OrganizationAffiliation&amp;_include=OrganizationAffiliation:location&amp;location.address=06040,06074,06043,06118,06041</a></p>\n<p>The current query looks like:<br>\n<a href=\"https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID030000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_has:OrganizationAffiliation:location:specialty=3336C0003X&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Location&amp;_revinclude=OrganizationAffiliation:location&amp;address=06040,06074,06043,06118,06041\">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID030000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_has:OrganizationAffiliation:location:specialty=3336C0003X&amp;_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Location&amp;_revinclude=OrganizationAffiliation:location&amp;address=06040,06074,06043,06118,06041</a></p>",
        "id": 209798169,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1599839320
    },
    {
        "content": "<blockquote>\n<p>I was wondering the same thing. I've consulted my CapStmt experts, and one of them tells me that it can be stated. Will be looking into it.</p>\n</blockquote>\n<p>Well i looked for a while and couldn't find it, so do share if you find it :-)</p>",
        "id": 209799519,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599839948
    },
    {
        "content": "<p>Actually, my expert was confused, and recanted.    Only way to state it appears to be in the narrative.</p>",
        "id": 209799898,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1599840108
    },
    {
        "content": "<p>Should we open a JIRA to have them add it somewhere?</p>",
        "id": 209804170,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599842083
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"215604\">@Saul Kravitz</span> can you include this one in the track report-out?</p>",
        "id": 209820990,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599850617
    },
    {
        "content": "<p>and let me know if you'd like me to open a ticket for it</p>",
        "id": 209821034,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1599850643
    },
    {
        "content": "<p>I'll add some narrative in the CapStmt.   Can't recall whether it made it into the report out, but my todo list are the issues in zulip.</p>",
        "id": 210029728,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1600100794
    },
    {
        "content": "<p>To me, the issue would be for fhir core, so that (maybe for R5?) there is a machine-readable way to:</p>\n<ol>\n<li>specify whether servers are required to support reverse chaining or not (via CapabilityStatement shipped in the IG); and</li>\n<li>specify whether a given implement supports reverse chaining or not</li>\n</ol>\n<p>In either case, a \"first cut\" could be whether it supports it in general (e.g. by listing \"_has\" as a search parameter), but in the end I'd expect it to be more like SearchParameter.chain which specifies chained fields support chaining and which do not.  Maybe it is even implied that anywhere forward chaining is supported, the corresponding reverse chain should be supported as well?</p>",
        "id": 210031455,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1600101699
    },
    {
        "content": "<p>I went ahead and opened <a href=\"http://jira.hl7.org/browse/FHIR-28534\">FHIR#28534</a> for that part of it (independent from updating the narrative in the plannet IG I think)</p>",
        "id": 210035493,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1600103664
    }
]