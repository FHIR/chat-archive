[
    {
        "content": "<p>example:<br>\n<code>QPD|IHE PDQ Query|20220215130712|@PID.5.2^fname~@PID.7.1^20220202~@PID.8^M|||||^^^IHEFACILITY&amp;1.3.6.1.4.1.21367.3000.1.6&amp;ISO~^^^IHEBLUE&amp;1.3.6.1.4.1.21367.13.20.3000&amp;ISO</code></p>\n<p>Is this valid from what I understand <code>QPD-3</code> is not repeatable.</p>\n<p>if you wanted to provide multiple <code>QPD-3</code> would that mean you should include multiple <code>QPD</code> segments?</p>\n<p><span class=\"user-mention\" data-user-id=\"191549\">@Frank Oemig</span>  or others?</p>",
        "id": 272097443,
        "sender_full_name": "Jake Aitchison",
        "timestamp": 1645007140
    },
    {
        "content": "<p>I will admit to not knowing much about the IHE specs, but in general, it appears that QPD-3 (and subsequent fields) can be defined as repeating in a query profile (from Chapter 5 of v2.9):<br>\nThe client data is presented as a sequence of HL7 fields. <strong>Beginning at QPD-3-User parameters, the remaining fields of the QPD segment carry user parameter data</strong>.  Each QPD user parameter field corresponds to one parameter defined in the Query Profile, <strong>where each name, type, optionality, and repetition of each parameter has been specified</strong></p>\n<p>So it appears that in a query profile, the parameter can be defined as repeating.</p>\n<p>IHE seems to do something completely different (at least in the spec I found at <a href=\"https://profiles.ihe.net/ITI/TF/Volume2/ITI-22.html#3.22\">https://profiles.ihe.net/ITI/TF/Volume2/ITI-22.html#3.22</a>). They seem to put all of their parameters into a repeating instance of QPD-3 (as opposed to different parameters per QPD field):<br>\n QPD-3-Demographics and Visit-Related Fields consists of <strong>one or more repetitions</strong>, each of which contains two components that together contain the name and value of a distinct parameter to the query.</p>\n<p>The only other QPD profile I've seen is from Immunizations where they are more in line with what the base standard says. They do define QPD-3 as the patient ID and allow it to repeat. But that profile is built specifically for their use case(s).</p>",
        "id": 272114543,
        "sender_full_name": "Craig Newman",
        "timestamp": 1645017854
    },
    {
        "content": "<p>QPD-3 and higher (by design) offer total flexibility - as such the IHE usage is perfectly OK.</p>",
        "id": 272115434,
        "sender_full_name": "René Spronk",
        "timestamp": 1645018315
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192758\">@Craig Newman</span> , <span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span> Thank you, it wasn't super obvious as the usual tables which normally indicate repeatability having nothing.</p>\n<p>I saw this also, which suggests cardinality of  [0..1].</p>\n<p><a href=\"http://www.hl7.eu/refactored/segQPD.html\">http://www.hl7.eu/refactored/segQPD.html</a><br>\n<a href=\"/user_uploads/10155/jhqoxzHbLtV7p1t1ckBBfVs3/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/jhqoxzHbLtV7p1t1ckBBfVs3/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/jhqoxzHbLtV7p1t1ckBBfVs3/image.png\"></a></div>",
        "id": 272115847,
        "sender_full_name": "Jake Aitchison",
        "timestamp": 1645018525
    },
    {
        "content": "<p>I'll argue that because the base standard says \" Each QPD user parameter field corresponds to one parameter defined in the Query Profile\" that the IHE approach is a bit off standard, but does offer a lot of flexibility in terms of sending data (don't have to specify a field for each parameter), but it doesn't have limitations in terms of sending multiple patient ids and such as you can't link occurrences in QPD-3 into groups of related values (ie, the ID and the assigning authority) if you send multiple of a single parameter type.</p>",
        "id": 272116029,
        "sender_full_name": "Craig Newman",
        "timestamp": 1645018619
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"353190\">@Jake Aitchison</span>  I think that site inherits that information from the v2.9 standard, where the RP/# column isn't populated (so it defaults to a max cardinality of 1), but given the text for QPD-3, I think the intent was that it could potentially be defined as repeating in the Query profile.</p>",
        "id": 272116245,
        "sender_full_name": "Craig Newman",
        "timestamp": 1645018726
    },
    {
        "content": "<p>Agree that this is probably a glitch in the publication of v2.x</p>",
        "id": 272116320,
        "sender_full_name": "René Spronk",
        "timestamp": 1645018776
    },
    {
        "content": "<p>Remember: the word version of HL7 v2 is authoritative/normative, any other v2 publications are derived/informative only.</p>",
        "id": 272116676,
        "sender_full_name": "René Spronk",
        "timestamp": 1645018971
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192758\">@Craig Newman</span>  <span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span>  maybe the hl7 access database which was probably used to generate those tables should be updated to have cardinality of [0..0] or whatever represents 0 or more maybe its [0..]</p>\n<p><span class=\"user-mention\" data-user-id=\"191549\">@Frank Oemig</span>  does this feel like a possible mdb amendment?</p>",
        "id": 272120375,
        "sender_full_name": "Jake Aitchison",
        "timestamp": 1645020644
    },
    {
        "content": "<p>Well, QPD-3 does not repeat. Instead the field \"repeats\", i.e. it occurs as QPD-3, -4, -5 etc.<br>\nIn the db the segment is marked as \"last field repeats\".<br>\nTechnically the question arises how an XML Schema should look like? Do we want to generate a few more fields?...</p>",
        "id": 272141689,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1645029808
    },
    {
        "content": "<p>Btw, a few segments have this behavior.</p>",
        "id": 272141802,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1645029860
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191549\">@Frank Oemig</span> what do you make of the text \"Each QPD user parameter field corresponds to one parameter defined in the Query Profile, where each name, type, optionality, and repetition of each parameter has been specified\". To me this implies that the fields from QPD-3 on, can be defined as repeating, otherwise \"repetition\" would need to be included in this list if it was constrained to 1 occurrence.</p>",
        "id": 272161365,
        "sender_full_name": "Craig Newman",
        "timestamp": 1645037751
    },
    {
        "content": "<p>QPD-3 is one parameter, QPD-4 another, etc. Repetitions does not make sense if there is no specification how to combine them: and, or, ..</p>",
        "id": 272163204,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1645038545
    },
    {
        "content": "<p>Base standard seems to default to \"and\" with a caveat:<br>\n\"While these parameters are understood to be usually \"anded\" together, the user SHALL inspect the required Query Profile to properly understand each. \"</p>",
        "id": 272171423,
        "sender_full_name": "Craig Newman",
        "timestamp": 1645042058
    },
    {
        "content": "<p>The spirit of QPD-3 etc. is 'do as you please' in derived profiles. IHE has a use-case whereby they don't know at design time how many parameters, and what parameters, will be used. The use of a repeating QPD-3 is a good solution to their use case.</p>",
        "id": 272222467,
        "sender_full_name": "René Spronk",
        "timestamp": 1645083050
    },
    {
        "content": "<p>What's the closest to \"official\" answer then? <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> <br>\nIf it is \"do as you please\" should the cardinality be updated to 0 or more? that would seem to suggest the flexibility of \"do as you please\"</p>",
        "id": 272227497,
        "sender_full_name": "Jake Aitchison",
        "timestamp": 1645086800
    },
    {
        "content": "<p>Given that some of the HL7v2 'old-hands' disagree, this'll need to go to the InM committee within HL7, for them to resolve this, and amend the standard to clarify. <span class=\"user-mention\" data-user-id=\"191749\">@Anthony(Tony) Julian</span> <span class=\"user-mention\" data-user-id=\"430122\">@Nick Radov</span> <span class=\"user-mention\" data-user-id=\"220686\">@Nick Radov</span></p>",
        "id": 272264245,
        "sender_full_name": "René Spronk",
        "timestamp": 1645107082
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191372\">René Spronk</span> <a href=\"#narrow/stream/229447-V2/topic/QPD-3.20Segment/near/272264245\">said</a>:</p>\n<blockquote>\n<p>Given that some of the HL7v2 'old-hands' disagree, this'll need to go to the InM committee within HL7, for them to resolve this, and amend the standard to clarify. <span class=\"user-mention silent\" data-user-id=\"191749\">Anthony(Tony) Julian</span> <span class=\"user-mention silent\" data-user-id=\"430122\">Nick Radov</span> <span class=\"user-mention silent\" data-user-id=\"220686\">Nick Radov</span></p>\n</blockquote>\n<p>I think there are actually defects in both HL7 V2 Chapter 5 and IHE ITI-22. My interpretation is that QPD-3 should be a repeating field in order to align with the narrative definition because a Query Profile can allow repetitions for a user parameter field. So I created new Jira issue <a href=\"https://jira.hl7.org/browse/V2-25343\">V2-25343</a> to fix that. <span class=\"user-mention\" data-user-id=\"191749\">@Anthony(Tony) Julian</span> could you add that to the next InM conference call agenda?</p>\n<p>However, each QPD-3, 4, ..., <em>n</em> field is only supposed to be used for a <strong>single</strong> user parameter field. It appears that IHE has misunderstood the specification and jammed multiple different user parameter fields together all in QPD-3 repetitions. That was not appropriate. I am no longer actively involved in IHE so can someone else submit a formal <a href=\"https://gazelle.ihe.net/IHE_Change_Proposals\">Change Proposal</a> to fix that?</p>",
        "id": 272284485,
        "sender_full_name": "Nick Radov",
        "timestamp": 1645115232
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191549\">Frank Oemig</span> <a href=\"#narrow/stream/229447-V2/topic/QPD-3.20Segment/near/272141689\">said</a>:</p>\n<blockquote>\n<p>Well, QPD-3 does not repeat. Instead the field \"repeats\", i.e. it occurs as QPD-3, -4, -5 etc.<br>\nIn the db the segment is marked as \"last field repeats\".<br>\nTechnically the question arises how an XML Schema should look like? Do we want to generate a few more fields?...</p>\n</blockquote>\n<p>For the HL7 V2 XML encoding I don't think we can reasonably accommodate a variable number of QPD fields within the informative XML Schema files. Instead we should just set the expectation that Query Profile authors need to define their own custom QPD XML Schema based on the number and type of user parameter fields they want to support. As a practical matter I'm not aware of any implementers who are actually using that segment with the XML encoding, so it might be a moot issue.</p>",
        "id": 272290650,
        "sender_full_name": "Nick Radov",
        "timestamp": 1645117827
    },
    {
        "content": "<p>Riki?</p>\n<p>Tony Julian</p>",
        "id": 272316801,
        "sender_full_name": "Anthony(Tony) Julian",
        "timestamp": 1645128924
    },
    {
        "content": "<blockquote>\n<p>However, each QPD-3, 4, ..., n field is only supposed to be used for a <strong>single</strong> user parameter field.</p>\n</blockquote>\n<p>And when that single user parameter field is \"patient demographics\", and it is defined as repeating field, and the data type is QIP, what exactly is there to change?</p>",
        "id": 272335014,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1645137716
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192685\">Vassil Peytchev</span> <a href=\"#narrow/stream/229447-V2/topic/QPD-3.20Segment/near/272335014\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>However, each QPD-3, 4, ..., n field is only supposed to be used for a <strong>single</strong> user parameter field.</p>\n</blockquote>\n<p>And when that single user parameter field is \"patient demographics\", and it is defined as repeating field, and the data type is QIP, what exactly is there to change?</p>\n</blockquote>\n<p>The way I interpret the intent of HL7 V2 chapter 5 it's not really ideal for all patient demographics to be in a single user parameter field. It seems like each patient demographic data element ought to be a separate parameter. But the specification is ambiguous on that point.</p>",
        "id": 272338612,
        "sender_full_name": "Nick Radov",
        "timestamp": 1645140097
    },
    {
        "content": "<p>Hi,</p>\n<p>I have evaluated this also with IHE tools and it is successful with repeatable QPD-3 as you can see here:<br>\n<a href=\"https://gazelle.ihe.net/EVSClient/hl7v2Result.seam?&amp;oid=1.3.6.1.4.1.12559.11.1.2.1.4.1664549\">https://gazelle.ihe.net/EVSClient/hl7v2Result.seam?&amp;oid=1.3.6.1.4.1.12559.11.1.2.1.4.1664549</a></p>\n<p>Also, based on the IHE TF (<a href=\"https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Rev10.0_Vol2a_FT_2013-09-27.pdf\">https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Rev10.0_Vol2a_FT_2013-09-27.pdf</a>) it should be. It defines for ITI-21 transaction that:<br>\n\"Field QPD-3-Demographics Fields consists of one or more repetitions, each of which contains<br>\ntwo components that together contain the name and value of a distinct parameter to the query. \"</p>",
        "id": 272369122,
        "sender_full_name": "Ioannis Petrakis",
        "timestamp": 1645169293
    },
    {
        "content": "<p>InM Invites all interested parties to the next teleconference scheduled for <a href=\"https://www.hl7.org/concalls/CallDetails.cfm?concall=59466\">March 8, 2022 at 11:00 Eastern</a>. <a href=\"https://hl7-org.zoom.us/j/3910526094?pwd=QzVuZTJYc2s2S0dUcVpWR3VLNm9tQT09\">https://hl7-org.zoom.us/j/3910526094?pwd=QzVuZTJYc2s2S0dUcVpWR3VLNm9tQT09</a></p>",
        "id": 273674609,
        "sender_full_name": "Anthony(Tony) Julian",
        "timestamp": 1646154466
    },
    {
        "content": "<p>I have a conflicting meeting, allow me to state my position on this forum:</p>\n<p>In the 'Query By Simple Parameter' variation of v2 queries (see section 5.2.5), each parameter is assigned to a different field in QPD (QPD 3,4, etc). These parameters express a logical AND between the various parameters. However, there is a common use case for ANDing parameters whilst (ORing parameter values per parameter), as is also reflected by FHIR e.g. supporting Observation?code=123,765,222&amp;patient.name=Smith,Jones. Allowing QPD-3,4,etc. to repeat would support this logic.</p>\n<p>This has the side effect of formally allowing what IHE is doing in its 'QSC-variant' query.</p>",
        "id": 274090953,
        "sender_full_name": "René Spronk",
        "timestamp": 1646379277
    },
    {
        "content": "<p>So the ORing has a stronger relationship, as being in patenthesis</p>",
        "id": 274184942,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1646425929
    },
    {
        "content": "<p>If one has a repeating QPD-x field, the intent will probably be that these values should be ORed (if we were to look at the FHIR searches as an example). But this can be left to a query conformance statement, it could define whether AND or OR logic should apply to repeating values.</p>",
        "id": 274240550,
        "sender_full_name": "René Spronk",
        "timestamp": 1646483129
    },
    {
        "content": "<p>Noted:  Will be discussed march 8, 2022 at 11:00 Eastern. <br>\nAbove comments have been added to <a href=\"https://confluence.hl7.org/pages/viewpage.action?pageId=94634524\">https://confluence.hl7.org/pages/viewpage.action?pageId=94634524</a>.</p>",
        "id": 274400342,
        "sender_full_name": "Anthony(Tony) Julian",
        "timestamp": 1646664063
    },
    {
        "content": "<p>The image depicts the first change relative to this to be proposed for v2+<br>\n<a href=\"/user_uploads/10155/xQgumI1LP9_1SA2eq8z172P8/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/xQgumI1LP9_1SA2eq8z172P8/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/xQgumI1LP9_1SA2eq8z172P8/image.png\"></a></div>",
        "id": 274568463,
        "sender_full_name": "Anthony(Tony) Julian",
        "timestamp": 1646758013
    },
    {
        "content": "<p>Vassil will craft a further explanation of the use cases - approx 12Apr2022</p>",
        "id": 274568572,
        "sender_full_name": "Anthony(Tony) Julian",
        "timestamp": 1646758064
    }
]