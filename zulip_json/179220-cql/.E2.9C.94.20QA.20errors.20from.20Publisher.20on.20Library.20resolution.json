[
    {
        "content": "<p>Hi folks. I'm seeing a common QA error from Publisher in my Library resources. The FSH generating the Library resources doen't specify relatedArtifacts directly though I can do so if it solves this. (Also, does anyone understand the error for  machine processing?)<br>\n<a href=\"/user_uploads/10155/1NzSMhIZIiyOOI5LMy2870D3/Screen-Shot-2021-07-20-at-12.22.59.png\">Screen-Shot-2021-07-20-at-12.22.59.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/1NzSMhIZIiyOOI5LMy2870D3/Screen-Shot-2021-07-20-at-12.22.59.png\" title=\"Screen-Shot-2021-07-20-at-12.22.59.png\"><img src=\"/user_uploads/10155/1NzSMhIZIiyOOI5LMy2870D3/Screen-Shot-2021-07-20-at-12.22.59.png\"></a></div>",
        "id": 246615053,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1626798331
    },
    {
        "content": "<p>The \"name\" element of a canonical resource should be a code-friendly name (alphanumeric, doesn't start with a number, etc).</p>",
        "id": 246616897,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626799193
    },
    {
        "content": "<p>The ModelInfo and FHIRHelpers issues are because those libraries are supposed to be in the base, but they aren't yet present (R4B added them, but isn't published yet, and to really take advantage of it you'd have to base your IG on R4B). There's also not another IG that actually has them published officially anywhere, working on that but that's another story. So what I typically do is actually copy them in locally. You can see an example of that here: <a href=\"https://github.com/cqframework/cqf-ccc/tree/master/input/resources/library\">https://github.com/cqframework/cqf-ccc/tree/master/input/resources/library</a></p>",
        "id": 246617618,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626799528
    },
    {
        "content": "<p>It's not a great solution, but once the actual solution is in place, it will be easy to refactor to incorporate.</p>",
        "id": 246617648,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626799553
    },
    {
        "content": "<p>Is there any reason I can't use FHIRCommon.json in another IG, as it's url is for ccc: \"<a href=\"http://fhir.org/guides/cqf/ccc/Library/FHIRCommon\">http://fhir.org/guides/cqf/ccc/Library/FHIRCommon</a>\"?</p>",
        "id": 246620349,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1626800818
    },
    {
        "content": "<p>If you include a copy in your IG, update the URL to match your IG's base canonical.</p>",
        "id": 246622028,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626801618
    },
    {
        "content": "<p>Hmm. I still see the \"Canonical URL '<a href=\"http://hl7.org/fhir/Library/FHIRHelpers|4.0.1\">http://hl7.org/fhir/Library/FHIRHelpers|4.0.1</a>' does not resolve\" error and some errors are multiplying. Where does Publisher insist on using \"<a href=\"http://hl7.org/fhir/\">http://hl7.org/fhir/</a>\" as the base canonical? It's not setup that way in my IG.</p>",
        "id": 246633693,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1626807370
    },
    {
        "content": "<p>So, are you using the publisher to do the CQL translation?</p>",
        "id": 246636711,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626808963
    },
    {
        "content": "<p>Yes, indeed.</p>",
        "id": 246641028,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1626810997
    },
    {
        "content": "<p>Okay, the translator has had some fixes recently to address this issue and the publisher hasn't been updated yet. Use the CQF Tooling to build (which will also refresh generated content in libraries and measures and plandefinitions, and package all your artifacts into the bundles directory, and other goodies).</p>",
        "id": 246657253,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818820
    },
    {
        "content": "<p>We're working on getting all that in to the publisher, but it's not there yet.</p>",
        "id": 246657279,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818853
    },
    {
        "content": "<p>So... follow the pattern in sample-content-ig:</p>",
        "id": 246657293,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818863
    },
    {
        "content": "<p><a href=\"https://github.com/cqframework/sample-content-ig\">https://github.com/cqframework/sample-content-ig</a></p>",
        "id": 246657296,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818868
    },
    {
        "content": "<p>Specifically, the _updateCQFTooling scripts</p>",
        "id": 246657301,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818875
    },
    {
        "content": "<p>And the _refresh scripts</p>",
        "id": 246657303,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818879
    },
    {
        "content": "<p>Same pattern as the publisher, _updateCQFTooling to download the latest, _refresh to refresh the generated content.</p>",
        "id": 246657362,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818896
    },
    {
        "content": "<p>Then run _genonce to build with the updated content.</p>",
        "id": 246657385,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818917
    },
    {
        "content": "<p>So, I'm not sure how that plays with SUSHI though.</p>",
        "id": 246657392,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818926
    },
    {
        "content": "<p>Do you run sushi as a separate step, or is it part of the _genonce call?</p>",
        "id": 246657410,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626818939
    },
    {
        "content": "<p>And if you use the CQF Tooling to do the translation, you have to tell the publisher not to, comment out the input/cql path:</p>",
        "id": 246658102,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626819498
    },
    {
        "content": "<p><a href=\"https://github.com/cqframework/sample-content-ig/blob/master/input/mycontentig.xml#L119\">https://github.com/cqframework/sample-content-ig/blob/master/input/mycontentig.xml#L119</a></p>",
        "id": 246658116,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1626819514
    },
    {
        "content": "<p>Ok thanks. I use sushi separately but also in publisher. I’ll have a try!</p>",
        "id": 246660467,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1626821592
    },
    {
        "content": "<p>By default, if the publisher detects an <code>input/fsh</code> folder, it will run SUSHI as part of the build.  You can turn this off by passing a <code>-no-sushi</code> flag when you run <code>_genonce</code>.</p>",
        "id": 246666900,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1626827473
    },
    {
        "content": "<p>Ok thanks, did not know that. Yeah, my goal has been a true fsh-cql-measure IG pipeline.</p>",
        "id": 246668684,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1626829350
    },
    {
        "content": "<p>By way of update, I've tried many iterations of getting a CQL-FSH pipeline to build correctly and there are errors in each attempt that are different depending on the approach. I'll surface this here in case someone wants to try on their own IG and work through it.</p>",
        "id": 256265370,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633447324
    },
    {
        "content": "<p>Would you mind creating a couple dummy IGs in a repo you can share to show the different approaches you've tried?</p>",
        "id": 256283530,
        "sender_full_name": "JP",
        "timestamp": 1633454049
    },
    {
        "content": "<p>Hi, thanks <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> . Here's the sample content IG, but using sushi-config to build the IG itself, and a simple FSH/CQL setup. <a href=\"https://github.com/citizenrich/sample-content-ig\">https://github.com/citizenrich/sample-content-ig</a> The methods I've tried are 1) do everything in fsh-generated/resources, which means creating folders for libary and measure after the fact and moving them over, or 2) do everything in input/resources which means moving stuff generated by sushi into that folder (also library and measure folders in addition), but then _genonce without sushi fails because it complains it can't find anything. It's not an exact copy of my work but hopefully a minimal non-working example.</p>",
        "id": 256317978,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633467539
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194178\">@JP</span> I'll be looking at this more today if you have a few minutes to check it out.</p>",
        "id": 256543419,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633596454
    },
    {
        "content": "<p>I won't have a chance to look at it today. Do you have some time early next week we can discuss?</p>",
        "id": 256632146,
        "sender_full_name": "JP",
        "timestamp": 1633633461
    },
    {
        "content": "<p>Absolutely. I'll have another go at it as well before then.</p>",
        "id": 256733098,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633696762
    },
    {
        "content": "<p>So, I had another go this morning and can now generate Library resources with CQL using _refresh that don't show the 'can't resolve fhir helpers' etc errors in qa.html. The issue seems to be avoiding the use of Sushi for the IG resource itself, and instead use the usual XML. The steps I followed:</p>\n<ul>\n<li>use xml ig not sushi</li>\n<li>use includes/menu.xml not sushi</li>\n<li>comment out input/cql binary stuff in xml</li>\n<li>fshonly - true in sushi</li>\n<li>mv Library templates created by Sushi to input/resources or publisher errors with duplicate resources.<br>\nThen:</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>mv fsh-generated/resources/Library-* input/resources/\nbash _refresh.sh\nbash _genonce.sh -no-sushi\n</code></pre></div>\n<p>The result is attached in screen shot. Still errors, but closer. If you can have a go at this, that would be great.<br>\n<a href=\"/user_uploads/10155/X9k8cKuEeTXqVBHcRsJM80DO/Screen-Shot-2021-10-11-at-10.49.45.png\">Screen-Shot-2021-10-11-at-10.49.45.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/X9k8cKuEeTXqVBHcRsJM80DO/Screen-Shot-2021-10-11-at-10.49.45.png\" title=\"Screen-Shot-2021-10-11-at-10.49.45.png\"><img src=\"/user_uploads/10155/X9k8cKuEeTXqVBHcRsJM80DO/Screen-Shot-2021-10-11-at-10.49.45.png\"></a></div>",
        "id": 257034593,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633943285
    },
    {
        "content": "<p>There are also errors from $measure-evaluate if folks have a hint how to troubleshoot:<br>\n\"Failed to call access method: java.lang.NullPointerException: Cannot invoke \\\"org.opencds.cqf.cql.evaluator.measure.common.PopulationDef.getCriteriaExpression()\\\" because \\\"inclusionDef\\\" is null\"<br>\nand<br>\n\"Failed to call access method: java.lang.NullPointerException: Cannot invoke \\\"String.contains(java.lang.CharSequence)\\\" because \\\"date\\\" is null\"</p>",
        "id": 257056342,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633955102
    },
    {
        "content": "<p>Are those $evaluat-measure errors from that same IG?</p>",
        "id": 257072399,
        "sender_full_name": "JP",
        "timestamp": 1633962691
    },
    {
        "content": "<p>They should be, but I'm testing two in parallel. Update: I had some help from Bryn this morning and have squashed many of the IG errors, so in a bit I'll rerun the $measure-evaluate stuff.</p>",
        "id": 257073174,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633963001
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194178\">@JP</span> I see the error \"ParameterDefinition.type: minimum required = 1, but only found 0 (from <a href=\"http://hl7.org/fhir/StructureDefinition/ParameterDefinition\">http://hl7.org/fhir/StructureDefinition/ParameterDefinition</a>)\". The CQL snippet is:</p>\n<div class=\"codehilite\"><pre><span></span><code>library Test version &#39;0.1.0&#39;\n\nusing FHIR version &#39;4.0.1&#39;\n\ninclude FHIRHelpers version &#39;4.0.1&#39;\n\ninclude AgeRanges version &#39;0.1.0&#39; called AR\n\ncontext Patient\n\ndefine &quot;Gender&quot;:\n  Patient.gender\n...\n</code></pre></div>\n<p>In the Library generated by CQF tooling, however, gender is missing a type:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;name&quot;: &quot;Gender&quot;,\n  &quot;use&quot;: &quot;out&quot;,\n  &quot;min&quot;: 0,\n  &quot;max&quot;: &quot;1&quot;\n},\n</code></pre></div>\n<p>I can log an issue in GitHub, but any suggestions on how this could be broken of my own design first?</p>",
        "id": 257091362,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1633971712
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> So, the repo <a href=\"https://github.com/citizenrich/sample-content-ig\">https://github.com/citizenrich/sample-content-ig</a> has the exact steps in the readme to reproduce the two errors I'm encountering. One is just above, where Patient.gender has no type in the Library after running CQF tooling. The second, and blocker (I have a demo tomorrow :) is this: Failed to call access method: java.lang.NullPointerException: Cannot invoke \\\"String.contains(java.lang.CharSequence)\\\" because \\\"date\\\" is null\". FYI <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span></p>",
        "id": 257176758,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634032410
    },
    {
        "content": "<p>Looking at the null pointer now.</p>",
        "id": 257230095,
        "sender_full_name": "JP",
        "timestamp": 1634055564
    },
    {
        "content": "<p>$evaluate-measure is actually a GET request rather than a POST request. Try this:</p>\n<p>curl GET  '<a href=\"http://localhost:8080/cqf-ruler-r4/fhir/Measure/SimpleAgeGroup/$evaluate-measure?periodStart=1970&amp;periodEnd=2021\">http://localhost:8080/cqf-ruler-r4/fhir/Measure/SimpleAgeGroup/$evaluate-measure?periodStart=1970&amp;periodEnd=2021</a>' | jq</p>",
        "id": 257241306,
        "sender_full_name": "JP",
        "timestamp": 1634059886
    },
    {
        "content": "<p>There's another issue which is that the CQL has a \"Measurement Period\" of type \"Date\" and it should be \"DateTime\"</p>",
        "id": 257241932,
        "sender_full_name": "JP",
        "timestamp": 1634060146
    },
    {
        "content": "<p>Ok. I'll make those changes and try again in just a bit.</p>",
        "id": 257243736,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634060877
    },
    {
        "content": "<p>One more issue is that the generated Measure resource isn't quite right:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>  <span class=\"nt\">\"group\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cohort\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://somewhere.org/fhir/uv/mycontentig/CodeSystem/OpenHIE\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cohort\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n      <span class=\"p\">},</span>\n      <span class=\"nt\">\"population\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"description\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Initial Population\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n              <span class=\"p\">{</span>\n                <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"initial-population\"</span><span class=\"p\">,</span>\n                <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://terminology.hl7.org/CodeSystem/measure-population\"</span>\n              <span class=\"p\">}</span>\n            <span class=\"p\">]</span>\n          <span class=\"p\">},</span>\n          <span class=\"nt\">\"criteria\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Initial Population\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">],</span>\n      <span class=\"nt\">\"stratifier\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"criteria\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Age Group\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cohort\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://somewhere.org/fhir/uv/mycontentig/CodeSystem/OpenHIE\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cohort\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n      <span class=\"p\">},</span>\n      <span class=\"nt\">\"population\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"description\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Denominator\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n              <span class=\"p\">{</span>\n                <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"denominator\"</span><span class=\"p\">,</span>\n                <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://terminology.hl7.org/CodeSystem/measure-population\"</span>\n              <span class=\"p\">}</span>\n            <span class=\"p\">]</span>\n          <span class=\"p\">},</span>\n          <span class=\"nt\">\"criteria\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Denominator\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">],</span>\n      <span class=\"nt\">\"stratifier\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"criteria\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Age Group\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cohort\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://somewhere.org/fhir/uv/mycontentig/CodeSystem/OpenHIE\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"cohort\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n      <span class=\"p\">},</span>\n      <span class=\"nt\">\"population\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"description\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Numerator\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n              <span class=\"p\">{</span>\n                <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"numerator\"</span><span class=\"p\">,</span>\n                <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://terminology.hl7.org/CodeSystem/measure-population\"</span>\n              <span class=\"p\">}</span>\n            <span class=\"p\">]</span>\n          <span class=\"p\">},</span>\n          <span class=\"nt\">\"criteria\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Numerator\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">],</span>\n      <span class=\"nt\">\"stratifier\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"criteria\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Age Group\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">]</span>\n</code></pre></div>",
        "id": 257244236,
        "sender_full_name": "JP",
        "timestamp": 1634061047
    },
    {
        "content": "<p>That's three different groups each with a different population. It should be one group with 3 populations.</p>",
        "id": 257244360,
        "sender_full_name": "JP",
        "timestamp": 1634061092
    },
    {
        "content": "<p>I think your Measure definition should look like:</p>\n<div class=\"codehilite\" data-code-language=\"fsh\"><pre><span></span><code>Alias: $OpenHIE = http://somewhere.org/fhir/uv/mycontentig/CodeSystem/OpenHIE\n\nCodeSystem: OpenHIE\nId: OpenHIE\nTitle: \"OpenHIE CodeSystem\"\nDescription: \"OpenHIE CodeSystem\"\n* ^url = $OpenHIE\n* #cohort \"cohort\"\n\nAlias: $measure-scoring = http://terminology.hl7.org/CodeSystem/measure-scoring\nAlias: $measure-population = http://terminology.hl7.org/CodeSystem/measure-population\n\nInstance: SimpleAgeGroup\nInstanceOf: Measure\nTitle: \"SimpleAgeGroup\"\nDescription: \"SimpleAgeGroup\"\n* identifier.system = \"http://somewhere.org/fhir/uv/mycontentig/Measure\"\n* version = \"0.0.0\"\n* status = #draft\n* experimental = true\n* date = \"2021-07-01\"\n* publisher = \"OpenHIE\"\n* library[+] = Canonical(Test)\n* name = \"SimpleAgeGroup\"\n* url = \"http://somewhere.org/fhir/uv/mycontentig/Measure/SimpleAgeGroup\"\n* identifier.value = \"SimpleAgeGroup\"\n* scoring = $measure-scoring#proportion\n* group[+]\n  * code = $OpenHIE#cohort \"cohort\"\n  * population[+]\n    * description = \"Initial Population\"\n    * code = $measure-population#initial-population\n    * criteria.language = #text/cql\n    * criteria.expression = \"Initial Population\"\n  * population[+]\n    * description = \"Denominator\"\n    * code = $measure-population#denominator\n    * criteria.language = #text/cql\n    * criteria.expression = \"Denominator\"\n  * population[+]\n    * description = \"Numerator\"\n    * code = $measure-population#numerator\n    * criteria.language = #text/cql\n    * criteria.expression = \"Numerator\"\n  * stratifier[0].criteria.language = #text/cql\n  * stratifier[=].criteria.expression = \"Age Group\"\n</code></pre></div>",
        "id": 257244639,
        "sender_full_name": "JP",
        "timestamp": 1634061216
    },
    {
        "content": "<p>We should add validation to the ruler to catch things like that. <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 257244746,
        "sender_full_name": "JP",
        "timestamp": 1634061254
    },
    {
        "content": "<p>With those 3 changes:</p>\n<ol>\n<li>GET instead of POST</li>\n<li>DateTime instead of Date for MeasurementPeriod</li>\n<li>Reworked Measure resource</li>\n</ol>\n<p>I get a successful eval.</p>",
        "id": 257245171,
        "sender_full_name": "JP",
        "timestamp": 1634061437
    },
    {
        "content": "<p>And &lt;100ms when it's warmed up. ~4ms per patient. <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>\n<p>You've got a branch with additional performance enhancements. Don't tell anyone.</p>",
        "id": 257245525,
        "sender_full_name": "JP",
        "timestamp": 1634061575
    },
    {
        "content": "<p>Thanks very much <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> the corrections worked.</p>",
        "id": 257249822,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634063280
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194178\">@JP</span> Quick follow-up. I'm seeing an error: \"Failed to call access method: org.opencds.cqf.cql.engine.exception.InvalidOperatorArgument: Expected CalculateAgeInYearsAt(Date, Date), CalculateAgeInYearsAt(DateTime, DateTime)... Found CalculateAgeInYearsAt(org.opencds.cqf.cql.engine.runtime.Date, org.opencds.cqf.cql.engine.runtime.DateTime)\"</p>",
        "id": 257348667,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634124309
    },
    {
        "content": "<p>The line in question is in two files but is the same:</p>\n<div class=\"codehilite\"><pre><span></span><code>parameter &quot;Measurement Period&quot; Interval&lt;DateTime&gt; default Interval[@2020-01-01T, @2020-12-31T]\n</code></pre></div>\n<p>I added the T at the end per <a href=\"https://cql.hl7.org/02-authorsguide.html#simple-values\">https://cql.hl7.org/02-authorsguide.html#simple-values</a></p>",
        "id": 257349133,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634124580
    },
    {
        "content": "<p>Also, is it possible to map the $evaluate-measure periodStart/End to this parameter in some way, and if so, where does it live? <span class=\"user-mention\" data-user-id=\"197470\">@Alexander Kiel</span></p>",
        "id": 257352421,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634126383
    },
    {
        "content": "<p>The $evaluate-measure implementation in HAPI maps periodStart/End to the Measurement Period parameter, are you seeing different behavior there?</p>",
        "id": 257364921,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1634131762
    },
    {
        "content": "<p>As Bryn mentioned, the periodStart and End are mapped to that CQL parameter. That’s done internally as part of the $evaluate-measure implementation.</p>\n<p>Did you delete the generated Libraries and refresh them after making that change to the CQL?</p>",
        "id": 257383632,
        "sender_full_name": "JP",
        "timestamp": 1634138295
    },
    {
        "content": "<p>Bryn: I'm trying to understand the behavior. Ok, so the default will be overridden by the $evaluate-measure operation. Got it.<br>\nJP: I issue PUTs so it should override the existing stuff. But, I'll try blowing away the cqf-ruler db.</p>",
        "id": 257390268,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634140626
    },
    {
        "content": "<p>So yes, removing the DB worked. Thanks <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> and <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> I hope you won't mind a quick follow-up. This is an error I'm getting from $evaluate-measure: Cannot invoke \\\"org.opencds.cqf.cql.evaluator.measure.common.PopulationDef.getCriteriaExpression()\\\" because \\\"inclusionDef\\\" is null\". Is this indicating an error with a Measure resource or the CQL?</p>",
        "id": 257559443,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634227105
    },
    {
        "content": "<p>That’s an issue with the Measure resource. A proportion Measure requires at least Initial Population, Denominator, and Numerator.</p>",
        "id": 257560372,
        "sender_full_name": "JP",
        "timestamp": 1634227438
    },
    {
        "content": "<p>If they are specified incorrectly in the Measure resource you’ll get that exception.</p>",
        "id": 257560468,
        "sender_full_name": "JP",
        "timestamp": 1634227463
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> Stratifiers are successfully reported out for combinations such as:</p>\n<div class=\"codehilite\"><pre><span></span><code>define &quot;Age Group/Sex&quot;:\n  &quot;Age Group&quot;.code + &#39;:&#39; + &quot;Sex&quot;\n</code></pre></div>\n<p>But I'm not getting Location to be reported out as a stratifier. My goal is Age Group * Sex * Encounter.Last(Location). Location is required to be a codeableconcept for supplementary data, but is that the same for stratifiers?</p>",
        "id": 257732755,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634318108
    },
    {
        "content": "<p>Yes, it needs to be a codeableconcept or string.</p>",
        "id": 257733890,
        "sender_full_name": "JP",
        "timestamp": 1634318581
    },
    {
        "content": "<p>Ok, I'm getting successful CQL evaluations, such as for this example provided by Bryn, but it doesn't appear in the measure report.</p>\n<div class=\"codehilite\"><pre><span></span><code>define &quot;Location&quot;:\n  First([Encounter] E\n    return &quot;GetLocation&quot;(First(E.location).location)\n  )\n\ndefine &quot;Most Recent Encounter Location Reference&quot;:\n  Last([Encounter] E\n    return First(E.location L\n      return L.location\n    )\n      //sort by start of period\n  )\n\n// works with cql not evaluate-measure\ndefine &quot;Location Code Revised&quot;:\n  singleton from (\n    [Location] L\n      let identifier: singleton from (L.identifier I)\n      // let identifier: singleton from (L.identifier I where I.system = &#39;https://github.com/synthetichealth/synthea&#39;)\n      where L.id = Last(Split(&quot;Most Recent Encounter Location Reference&quot;.reference, &#39;/&#39;))\n      return CodeableConcept {\n        coding: {\n          Coding {\n            code: code { value: identifier.value },\n            system: identifier.system\n          }\n        }\n      }\n  )\n</code></pre></div>",
        "id": 257737014,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634319896
    },
    {
        "content": "<p>Hmm... Mind giving the full example? Is it in that same repo from before?</p>",
        "id": 257739853,
        "sender_full_name": "JP",
        "timestamp": 1634321048
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194178\">@JP</span>, thanks, the repo is: <a href=\"https://github.com/intrahealth/simple-hiv-ig\">https://github.com/intrahealth/simple-hiv-ig</a> I've tried to simplify to the minimal working/non-working examples with stratifiers. The attempts at location are in the measure.fsh and kitchensink.cql.</p>",
        "id": 257935544,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634492476
    },
    {
        "content": "<p>Bit swamped at the moment but I asked colleague <span class=\"user-mention\" data-user-id=\"409302\">@Zack Austin</span> to take a look.</p>",
        "id": 258105324,
        "sender_full_name": "JP",
        "timestamp": 1634593349
    },
    {
        "content": "<p>thanks <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> and <span class=\"user-mention\" data-user-id=\"409302\">@Zack Austin</span> There's a lot of hacks to try to make it work, but no success. There are a couple of simple bundles for tests in the repo so you can see what evaluates with CQL.</p>",
        "id": 258109235,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634595293
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194178\">@JP</span> <span class=\"user-mention\" data-user-id=\"409302\">@Zack Austin</span>  I've updated the repo so that if you have a minute to look it is should be easier to identify any problems. Essentially, stratifiers are working with cqf-ruler-r4 for age groups and gender/sex (and I expect in general!). </p>\n<p>However, I cannot get one to work for Encounter.Location. The attempts start here:<br>\n<a href=\"https://github.com/intrahealth/simple-hiv-ig/blob/4d20b7841325e42b5854217626add81a6152d7f8/input/cql/KitchenSink.cql#L145\">https://github.com/intrahealth/simple-hiv-ig/blob/4d20b7841325e42b5854217626add81a6152d7f8/input/cql/KitchenSink.cql#L145</a><br>\nMeasures are all defined in /input/fsh/measure.fsh. Examples of Measure Reports are in /measurereports. There are two tests for the KitchenSink which show that some of the methods I've tried should evaluate to either a code or a string for Encounter.Location but the stratifiers don't show up in $evaluate-measure ops.</p>",
        "id": 258353822,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634730922
    },
    {
        "content": "<p>I've simplified the CQL expressions to try to get to the root of the issue. These expressions pass CQL evaluation but stratifiers using them are dropped at some point in the $evaluate-measure operation. I've extended the periodStart/End to try to ensure the test cases capture them, used fhirpath to ensure they are correct, tried different variations, and done some other troubleshooting but must still be missing something.</p>\n<div class=\"codehilite\"><pre><span></span><code>// Bundle.entry.resource.ofType(Encounter)[0].serviceProvider.reference\ndefine &quot;serviceProvider&quot;:\n  Last([Encounter]).serviceProvider.reference.value\n\ndefine &quot;assert serviceProvider is string&quot;:\n  &quot;serviceProvider&quot; is String\n\n// Bundle.entry.resource.ofType(Encounter)[0].location[0].location.reference\ndefine &quot;Naive Location&quot;:\n  Last([Encounter]).location[0].location.reference.value\n  // sort by start of period\n  // where E.period overlaps AR.&quot;Measurement Period&quot;\n\ndefine &quot;assert Naive Location is string&quot;:\n  &quot;Naive Location&quot; is String\n</code></pre></div>\n<p>Result from CQL evaluation:</p>\n<div class=\"codehilite\"><pre><span></span><code>serviceProvider=Organization/Organization-HIVSimple\nassert serviceProvider is string=true\nNaive Location=Location/Location-HIVSimple\nassert Naive Location is string=true\n</code></pre></div>",
        "id": 258685464,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634894768
    },
    {
        "content": "<p>I'm not getting stratifiers with latest CQFRuler with JustGender.</p>",
        "id": 258767163,
        "sender_full_name": "Rob Reynolds",
        "timestamp": 1634933297
    },
    {
        "content": "<p>I was wondering if the \"/\" in Naive Location was causing a problem so I tried removing it.  It didn't fix the issue (still no stratifier) so I tried JustGender to make sure it was a valid repro and I got no stratifiers for that either.</p>",
        "id": 258767441,
        "sender_full_name": "Rob Reynolds",
        "timestamp": 1634933413
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"217210\">@Rob Reynolds</span>  It's not merged into main I think. Make sure you're on the feature-stratification branch, e.g.:</p>\n<div class=\"codehilite\"><pre><span></span><code>git checkout feature-stratification\nmvn jetty:run -am --projects cqf-ruler-r4\n</code></pre></div>\n<p>Please share the results. I have successful results for age group, gender, group*gender, just not location. The _runcqf bash script has all of the fun to reproduce. Note that the script uses a Python-based bulk data generator based on FSH, so you may want to just run it selectively and is designed for *nix systems.</p>",
        "id": 258876453,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1635078461
    },
    {
        "content": "<p>That might be it. I’ll check later today.</p>\n<p>Rob</p>",
        "id": 258880322,
        "sender_full_name": "Rob Reynolds",
        "timestamp": 1635084147
    },
    {
        "content": "<p>Have you pushed that branch?</p>\n<p>I thought I had looked for other branches, but wondered if I had maybe missed something.</p>\n<p>But in double-checking, the only branch I see is gh-pages and it's pretty stale (last updated 2 months ago).</p>\n<p><a href=\"/user_uploads/10155/dd1u2IaTdH2iMk7EXxzN2cRM/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/dd1u2IaTdH2iMk7EXxzN2cRM/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/dd1u2IaTdH2iMk7EXxzN2cRM/image.png\"></a></div>",
        "id": 258881069,
        "sender_full_name": "Rob Reynolds",
        "timestamp": 1635085434
    },
    {
        "content": "<p>Wait.  You mean I need to run a different branch of CQF Ruler.  (thanks Bryn!)</p>",
        "id": 258896706,
        "sender_full_name": "Rob Reynolds",
        "timestamp": 1635107347
    },
    {
        "content": "<p>I'll look into that.   (sorry, I thought you were saying I needed to use a different branch of simple-hiv-ig) .</p>",
        "id": 258896753,
        "sender_full_name": "Rob Reynolds",
        "timestamp": 1635107396
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"217210\">@Rob Reynolds</span> yeah, sorry for the confusion, I meant the feature-stratification branch of cqf-ruler.</p>",
        "id": 258937879,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1635155970
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194192\">@Richard Stanley</span> , I was able to get back values for both the JustLocation and AgeGroupGenderLocation Measures on latest for the rulers feature-stratification branch.</p>\n<p><a href=\"/user_uploads/10155/CPzDjKjwhEtoDJi0CfbC2s3P/MR-AgeGroupGenderLocation.PNG\">MR-AgeGroupGenderLocation.PNG</a><br>\n<a href=\"/user_uploads/10155/4VQCh-QOMYZVB8Wi1Eq8OWYs/MR-JustLocation.PNG\">MR-JustLocation.PNG</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/CPzDjKjwhEtoDJi0CfbC2s3P/MR-AgeGroupGenderLocation.PNG\" title=\"MR-AgeGroupGenderLocation.PNG\"><img src=\"/user_uploads/10155/CPzDjKjwhEtoDJi0CfbC2s3P/MR-AgeGroupGenderLocation.PNG\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/10155/4VQCh-QOMYZVB8Wi1Eq8OWYs/MR-JustLocation.PNG\" title=\"MR-JustLocation.PNG\"><img src=\"/user_uploads/10155/4VQCh-QOMYZVB8Wi1Eq8OWYs/MR-JustLocation.PNG\"></a></div><p>Do these values look correct to you?</p>\n<p>I used the Patient-HIVSimple Test Case for these results.</p>",
        "id": 259465966,
        "sender_full_name": "Zack Austin",
        "timestamp": 1635464022
    },
    {
        "content": "<p>That's fantastic and exactly what I expected <span class=\"user-mention\" data-user-id=\"409302\">@Zack Austin</span> If you have any hints on what I'm doing wrong, please do share. Also, if you can share the postman collections I can try to reproduce. Did you have to change anything in a Library or Measure?</p>",
        "id": 259504622,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1635502093
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"194192\">@Richard Stanley</span> , I did run the knowledge artifacts for your Measures and Libraries through the cqf-tooling project's IG Refresh operation: <a href=\"https://github.com/cqframework/cqf-tooling\">https://github.com/cqframework/cqf-tooling</a></p>\n<p>The IGRefresh operator will update and generate any knowledge artifact resources in input/resources/library and input/resources/measure and can potentially ease the development burden of some of this work.</p>\n<p>An example of the command: -RefreshIG -root-dir=\"D:\\src\\code\\intrahealth\\simple-hiv-ig\" -rp=\"D:\\src\\code\\intrahealth\\simple-hiv-ig\\input\\resources\" -ip=\"input/simple-hiv-ig.xml\" -t -d -p -fs=http://localhost:8080/cqf-ruler-r4/fhir/</p>\n<p>Would result in updated fhir resources for your measures and libraries: </p>\n<p><a href=\"/user_uploads/10155/Eb4REvltV72l0sylC4h99ySX/Capture-Process-1.PNG\">Capture-Process-1.PNG</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/Eb4REvltV72l0sylC4h99ySX/Capture-Process-1.PNG\" title=\"Capture-Process-1.PNG\"><img src=\"/user_uploads/10155/Eb4REvltV72l0sylC4h99ySX/Capture-Process-1.PNG\"></a></div><p>As well as updated measure bundles:</p>\n<p><a href=\"/user_uploads/10155/GLMAYehcUbQqgv76LIi5Adr9/Capture-Process-2.PNG\">Capture-Process-2.PNG</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/GLMAYehcUbQqgv76LIi5Adr9/Capture-Process-2.PNG\" title=\"Capture-Process-2.PNG\"><img src=\"/user_uploads/10155/GLMAYehcUbQqgv76LIi5Adr9/Capture-Process-2.PNG\"></a></div><p>Another thing I did was modify your Patient Test Case bundle for Patient-HIVSimple from POSTs to PUTs:</p>\n<p><a href=\"/user_uploads/10155/4mmnEm4Lb2h6q4ODkvfDjBJy/Capture-Process-3.PNG\">Capture-Process-3.PNG</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/4mmnEm4Lb2h6q4ODkvfDjBJy/Capture-Process-3.PNG\" title=\"Capture-Process-3.PNG\"><img src=\"/user_uploads/10155/4mmnEm4Lb2h6q4ODkvfDjBJy/Capture-Process-3.PNG\"></a></div><p>Doing POSTs instead would actually change the resource IDs of your test cases in the cqf-ruler:</p>\n<p><a href=\"/user_uploads/10155/qM6jXs9VTW8Ya5sfHl_2I5VZ/Capture-Process-POST.PNG\">Capture-Process-POST.PNG</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/qM6jXs9VTW8Ya5sfHl_2I5VZ/Capture-Process-POST.PNG\" title=\"Capture-Process-POST.PNG\"><img src=\"/user_uploads/10155/qM6jXs9VTW8Ya5sfHl_2I5VZ/Capture-Process-POST.PNG\"></a></div><p>At a first glance that seems like a bug to me and may need to be fixed in the ruler -- and may of been what was tripping you up.</p>",
        "id": 259584997,
        "sender_full_name": "Zack Austin",
        "timestamp": 1635542562
    },
    {
        "content": "<p>Here is the postman collection that I used in the examples:</p>\n<p><a href=\"/user_uploads/10155/kWSrNgsK-GadEYBrWCON2oOa/Intrahealth.postman_collection.json\">Intrahealth.postman_collection.json</a></p>",
        "id": 259585341,
        "sender_full_name": "Zack Austin",
        "timestamp": 1635542771
    },
    {
        "content": "<p><code>POST</code> generates a new id while <code>PUT</code> uses the Id you pass in:</p>\n<p><a href=\"https://www.hl7.org/fhir/http.html#create\">https://www.hl7.org/fhir/http.html#create</a><br>\n(server SHALL ignore the Id)</p>\n<p><a href=\"https://www.hl7.org/fhir/http.html#update\">https://www.hl7.org/fhir/http.html#update</a></p>",
        "id": 259807859,
        "sender_full_name": "JP",
        "timestamp": 1635713629
    },
    {
        "content": "<p>Sorry for my self-instantiated errors. Thanks so very much <span class=\"user-mention\" data-user-id=\"409302\">@Zack Austin</span> and <span class=\"user-mention\" data-user-id=\"194178\">@JP</span>.</p>",
        "id": 260044564,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1635880808
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"194192\">Richard Stanley</span> has marked this topic as resolved.</p>",
        "id": 260044583,
        "sender_full_name": "Notification Bot",
        "timestamp": 1635880816
    }
]