[
    {
        "content": "<p>I've enjoyed using the CQL packages for the Atom editor in the past. Our team has recently upgraded our compiler to accept FHIR 4.0.1. However, the Atom CQL package doesn't seem to recognize this FHIR version. Does anyone know of any plans to update the CQL packages in Atom to support FHIR 4.0.1? Or am I missing some updates from somewhere?</p>\n<p>I've also tried the plugins for VSCode. In my setup, they tend to spew NPEs into the output tab and don't show errors in the problems tab. It could be that there's something wrong with my setup.</p>\n<p>So are there any working editor environments for CQL using FHIR 4.0.1 right now? If not, are there any plans to get them to a working state? Or am I doing something wrong?</p>",
        "id": 264280186,
        "sender_full_name": "Frank Adrian",
        "timestamp": 1639044994
    },
    {
        "content": "<p>Atom should support 4.0.1. All of the Measures in the ecqm-content-r4 ig <a href=\"https://github.com/cqframework/ecqm-content-r4/blob/master/input/cql\">here</a> were authored using Atom/VS Code. Do you have a repro? I'm happy to take a look.</p>\n<p>Same goes for VS Code. Where are you seeing the NPEs?</p>",
        "id": 264334881,
        "sender_full_name": "JP",
        "timestamp": 1639070532
    },
    {
        "content": "<p>Thanks, JP. I started with a vanilla Atom editor. I added the packages  language-cql 2.10.1 and language-preview-cql 0.0.8. As far as I know these are the most recent versions. When I load a library using FHIR version 4.0.1, I get an error that says:<br>\n\"Could not resolve model info provider for model FHIR, version 4.0.1.\"</p>\n<p>Similarly in VSCode, I installed the Clinical Quality Language v0.1.1 extension. I am now getting NPEs on hover:</p>\n<p>[Error - 10:42:59 AM] Request textDocument/hover failed.<br>\n  Message: Internal error.<br>\n  Code: -32603 <br>\njava.util.concurrent.CompletionException: java.lang.NullPointerException<br>\n    at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332)<br>\n    at java.base/java.util.concurrent.CompletableFuture.uniAcceptNow(CompletableFuture.java:747)<br>\n    at java.base/java.util.concurrent.CompletableFuture.uniAcceptStage(CompletableFuture.java:735)<br>\n    at java.base/java.util.concurrent.CompletableFuture.thenAccept(CompletableFuture.java:2182)<br>\n    at org.eclipse.lsp4j.jsonrpc.RemoteEndpoint.handleRequest(RemoteEndpoint.java:279)<br>\n    at org.eclipse.lsp4j.jsonrpc.RemoteEndpoint.consume(RemoteEndpoint.java:190)<br>\n    at org.eclipse.lsp4j.jsonrpc.json.StreamMessageProducer.handleMessage(StreamMessageProducer.java:194)<br>\n    at org.eclipse.lsp4j.jsonrpc.json.StreamMessageProducer.listen(StreamMessageProducer.java:94)<br>\n    at org.eclipse.lsp4j.jsonrpc.json.ConcurrentMessageProcessor.run(ConcurrentMessageProcessor.java:113)<br>\n    at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)<br>\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)<br>\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)<br>\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)<br>\n    at java.base/java.lang.Thread.run(Thread.java:833)<br>\nCaused by: java.lang.NullPointerException</p>\n<p>as well as:</p>\n<p>Dec 10, 2021 10:43:12 AM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation<br>\nWARNING: Unmatched cancel notification for request id 6400</p>\n<p>That's basically what's going on. PM me if you need more info.</p>",
        "id": 264493733,
        "sender_full_name": "Frank Adrian",
        "timestamp": 1639163180
    },
    {
        "content": "<p>Try uninstalling language-preview-cql 0.0.8. Those two extensions may be conflicting.</p>",
        "id": 264501047,
        "sender_full_name": "JP",
        "timestamp": 1639166856
    },
    {
        "content": "<p>Perfect! Thanks for your help. I had no idea that those packages interfered with each other.<br>\nAny idea about VSCode (which is my preferred editor these days).</p>",
        "id": 264563918,
        "sender_full_name": "Frank Adrian",
        "timestamp": 1639230828
    },
    {
        "content": "<p>Nothing offhand. Iâ€™ll take a look this weekend and see if I can repro the issue.</p>",
        "id": 264576210,
        "sender_full_name": "JP",
        "timestamp": 1639246352
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"336710\">@Frank Adrian</span> - Messed with it a bit and the VS Code plugin seems to be working as expected for the igs I tried. Do you have a couple CQL files that I can use to attempt to repro?</p>",
        "id": 264585423,
        "sender_full_name": "JP",
        "timestamp": 1639257632
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"194178\">JP</span> <a href=\"#narrow/stream/179220-cql/topic/Editor.20packages/near/264585423\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"336710\">Frank Adrian</span> - Messed with it a bit and the VS Code plugin seems to be working as expected for the igs I tried. Do you have a couple CQL files that I can use to attempt to repro?</p>\n</blockquote>\n<p>Unfortunately, nothing I can share. Oddly enough, I do not get the errors on the NCQA digital measures I have checked. I'll do a bit more digging from my side.</p>",
        "id": 264712327,
        "sender_full_name": "Frank Adrian",
        "timestamp": 1639405342
    },
    {
        "content": "<p>By the way, JP, I don't seem to be getting warning messages out of the Atom package. I used to get warnings like this one:<br>\n\"Warning:[459:12, 459:28] List-valued expression was demoted to a singleton.\", but I haven't seen any from the latest CQL package. Is there some configuration setting I'm overlooking?</p>",
        "id": 264957593,
        "sender_full_name": "Frank Adrian",
        "timestamp": 1639535216
    },
    {
        "content": "<p>Are you still getting any warnings at all? Or just not that specific one?</p>",
        "id": 265087541,
        "sender_full_name": "JP",
        "timestamp": 1639608637
    },
    {
        "content": "<p>Hi JP. I'm not getting any, but then that's sort of hard to tell because it's hard to tell the absence of something. I know that I get the demotion warnings on another CQL-&gt;ELM translator setup, and I don't have any other ones coming out of it, so I figure there are no other ones there.</p>",
        "id": 265320915,
        "sender_full_name": "Frank Adrian",
        "timestamp": 1639757902
    },
    {
        "content": "<p>Gave Atom a whirl and it seems to be working ok. Not sure how to best help resolve your issues without some type of repro of the issue. <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span></p>",
        "id": 265351737,
        "sender_full_name": "JP",
        "timestamp": 1639770664
    }
]