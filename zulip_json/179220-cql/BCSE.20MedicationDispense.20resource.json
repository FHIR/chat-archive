[
    {
        "content": "<p>Hello, I am testing the BCSE measure. The problem is that <code>Dementia Medications In Year Before or During Measurement Period</code> always returns <code>false</code> unless I set <code>[MedicationDispense]</code> instead of <code>[MedicationDispense: \"Dementia Medications\"]</code>. I have checked <code>vsac_cache/valueset-db.json</code> file and yes <code>314214</code> exists there. I am wondering what could be a problem. My Bandle? Please help!<br>\nI am using <code>cql-execution</code> library. Everything worked fine unless I started to test <code>MedicationDispense</code>. I am not sure how the <code>type.conding</code> list works here.<br>\nHere we have a piece of cql code:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>library BCSe version <span class=\"s1\">'0.0.1'</span>\nusing FHIR version <span class=\"s1\">'4.0.1'</span>\n\nvalueset <span class=\"s2\">\"Dementia Medications\"</span>: <span class=\"s1\">'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.196.12.1510'</span>\nparameter <span class=\"s2\">\"Measurement Period\"</span> Interval&lt;DateTime&gt;\n\ndefine <span class=\"s2\">\"Dementia Medications In Year Before or During Measurement Period\"</span>:\n  exists <span class=\"o\">([</span>MedicationDispense: <span class=\"s2\">\"Dementia Medications\"</span><span class=\"o\">])</span>\n</code></pre></div>\n<p>I am trying to construct Patient bundle file like that:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"o\">{</span>\n  <span class=\"s2\">\"resourceType\"</span>: <span class=\"s2\">\"Bundle\"</span>,\n  <span class=\"s2\">\"entry\"</span>: <span class=\"o\">[</span>\n    <span class=\"o\">{</span>\n      <span class=\"s2\">\"resource\"</span>: <span class=\"o\">{</span>\n        <span class=\"s2\">\"resourceType\"</span>: <span class=\"s2\">\"Patient\"</span>,\n        <span class=\"s2\">\"id\"</span>: <span class=\"s2\">\"97373\"</span>,\n        <span class=\"s2\">\"gender\"</span>: <span class=\"s2\">\"female\"</span>,\n        <span class=\"s2\">\"birthDate\"</span>: <span class=\"s2\">\"1952-01-20\"</span>\n      <span class=\"o\">}</span>\n    <span class=\"o\">}</span>,\n    <span class=\"o\">{</span>\n      <span class=\"s2\">\"resource\"</span>: <span class=\"o\">{</span>\n        <span class=\"s2\">\"resourceType\"</span>: <span class=\"s2\">\"MedicationDispense\"</span>,\n        <span class=\"s2\">\"id\"</span>: <span class=\"s2\">\"286b7c84-60d6-4ab5-ad7f-571fa1f93051\"</span>,\n        <span class=\"s2\">\"type\"</span>: <span class=\"o\">{</span>\n          <span class=\"s2\">\"coding\"</span>: <span class=\"o\">[</span>\n            <span class=\"o\">{</span>\n              <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n              <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"314214\"</span>\n            <span class=\"o\">}</span>\n          <span class=\"o\">]</span>\n        <span class=\"o\">}</span>,\n        <span class=\"s2\">\"subject\"</span>: <span class=\"o\">{</span>\n          <span class=\"s2\">\"reference\"</span>: <span class=\"s2\">\"Patient/97373\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"s2\">\"whenHandedOver\"</span>: <span class=\"s2\">\"2020-04-11\"</span>\n      <span class=\"o\">}</span>\n    <span class=\"o\">}</span>\n  <span class=\"o\">]</span>\n<span class=\"o\">}</span>\n</code></pre></div>",
        "id": 242771865,
        "sender_full_name": "Vasyl Herman",
        "timestamp": 1623779163
    },
    {
        "content": "<p>Here is my <code>vsac_cache/valueset-db.json</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"o\">{</span>\n  <span class=\"s2\">\"2.16.840.1.113883.3.464.1003.196.12.1510\"</span>: <span class=\"o\">{</span>\n    <span class=\"s2\">\"Latest\"</span>: <span class=\"o\">{</span>\n      <span class=\"s2\">\"oid\"</span>: <span class=\"s2\">\"2.16.840.1.113883.3.464.1003.196.12.1510\"</span>,\n      <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"Latest\"</span>,\n      <span class=\"s2\">\"codes\"</span>: <span class=\"o\">[</span>\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"1100184\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"1308569\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"1599803\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"1599805\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"1805420\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"1805425\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"310436\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"310437\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"312835\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"312836\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"314214\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"314215\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"579148\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"725021\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"725023\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"860695\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"860707\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"860715\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"860901\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"996561\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"996571\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"996594\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"996603\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"996609\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"996615\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"996740\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"997220\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"997223\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"997226\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>,\n        <span class=\"o\">{</span>\n          <span class=\"s2\">\"code\"</span>: <span class=\"s2\">\"997229\"</span>,\n          <span class=\"s2\">\"system\"</span>: <span class=\"s2\">\"http://www.nlm.nih.gov/research/umls/rxnorm\"</span>,\n          <span class=\"s2\">\"version\"</span>: <span class=\"s2\">\"2021-05\"</span>\n        <span class=\"o\">}</span>\n      <span class=\"o\">]</span>\n    <span class=\"o\">}</span>\n  <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n</code></pre></div>",
        "id": 242780256,
        "sender_full_name": "Vasyl Herman",
        "timestamp": 1623782665
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 242867228,
        "sender_full_name": "Michael Ryan",
        "timestamp": 1623843116
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"376706\">@Vasyl Herman</span> , I suspect the problem is that the MedicationDispense has a choice type for the primary code path. Can you try putting an explicit code path in the retrieve:</p>\n<div class=\"codehilite\"><pre><span></span><code>[MedicationDispense: medication in &quot;Dementia Medications&quot;]\n</code></pre></div>",
        "id": 242949089,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1623880968
    },
    {
        "content": "<p>Thanks, it worked out!<br>\nCould you please give me a clue how can I check what is default code path?</p>",
        "id": 243050054,
        "sender_full_name": "Vasyl Herman",
        "timestamp": 1623949288
    },
    {
        "content": "<p>There is documentation here: <a href=\"https://github.com/cqframework/clinical_quality_language/wiki/FHIRModelInfo#retrievable-types-r4\">https://github.com/cqframework/clinical_quality_language/wiki/FHIRModelInfo#retrievable-types-r4</a></p>",
        "id": 243064451,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1623955309
    }
]