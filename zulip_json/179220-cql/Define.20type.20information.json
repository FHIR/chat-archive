[
    {
        "content": "<p>My team has been poking around trying to figure out how to extract the return type information for a define from the CQL/ELM. At the point of translation, the type information is available in the ExpressionDef. This is how the Atom plugin/cql-language-server exposes this information. When we load that library up in the CQL Engine, however, the ExpressionDef no longer carries the type information. There is a getResultTypeName() property, but it always returns null. <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> / <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> can you provide some context here? There are two different object hierarchies in play (org.hl7.elm.r1.ExpressionDef vs. org.cqframework.cql.elm.execution.ExpressionDef), so I get that there can be differences, but it would be useful to us to have the type information at the point of execution. Specifically, we want it to build the schema for a Spark dataset that we are outputting that contains the results of the CQL evaluation.</p>",
        "id": 253608922,
        "sender_full_name": "Corey Sanders",
        "timestamp": 1631809466
    },
    {
        "content": "<p>including type information in the ELM is an option on the CQL translator when generating ELM. The Atom plugin essentially uses a set of options that includes a lot of information for editor support.</p>\n<p><a href=\"https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/cql-to-elm/OVERVIEW.md#usage\">https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/cql-to-elm/OVERVIEW.md#usage</a></p>\n<p>You're looking for the \"result-types\" option.</p>",
        "id": 253609374,
        "sender_full_name": "JP",
        "timestamp": 1631809659
    },
    {
        "content": "<p>And if it's helpful for your team, here's a PoC app running the CQL Engine on Spark:<br>\n<a href=\"https://github.com/DBCG/spark-cql-fhir\">https://github.com/DBCG/spark-cql-fhir</a></p>",
        "id": 253610379,
        "sender_full_name": "JP",
        "timestamp": 1631810019
    },
    {
        "content": "<p>Thanks, <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> I looked at the translator options before asking, but I completely missed it. Appreciate the link to the spark POC. We'll have a look.</p>",
        "id": 253615236,
        "sender_full_name": "Corey Sanders",
        "timestamp": 1631811855
    }
]