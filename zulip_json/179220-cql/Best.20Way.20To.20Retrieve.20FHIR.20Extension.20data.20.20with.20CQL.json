[
    {
        "content": "<p>What would be the best approach to pull extension data like race/ethnicity from a US-Core Patient FHIR Resource definition like in this example here? <a href=\"https://www.hl7.org/fhir/us/core/Patient-example.json.html\">https://www.hl7.org/fhir/us/core/Patient-example.json.html</a></p>",
        "id": 260283555,
        "sender_full_name": "Michael Riley",
        "timestamp": 1636038592
    },
    {
        "content": "<p>There are some examples on how to do this in the SupplementalDataElements library here - <a href=\"https://github.com/DBCG/connectathon/blob/master/fhir401/input/pagecontent/cql/SupplementalDataElements-2.0.0.cql\">https://github.com/DBCG/connectathon/blob/master/fhir401/input/pagecontent/cql/SupplementalDataElements-2.0.0.cql</a></p>",
        "id": 260320719,
        "sender_full_name": "Corey Sanders",
        "timestamp": 1636053488
    },
    {
        "content": "<p>There is a FHIRCommon library <a href=\"https://build.fhir.org/ig/cqframework/cqf/Library-FHIRCommon.html\">here</a> that defines Extension functions for this purpose.</p>",
        "id": 260341634,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1636063839
    },
    {
        "content": "<p>They are based on the Extension functions used in the eCQM content, but trying to get a base common FHIR library that defines them once and gets reused.</p>",
        "id": 260341688,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1636063874
    },
    {
        "content": "<p>Also note that in 1.5, we are starting to use fluent functions to enable access to extensions like this <a href=\"https://build.fhir.org/ig/HL7/fhir-qi-core/Library-QICoreElements.html\">QICoreElements</a></p>",
        "id": 260341833,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1636063935
    },
    {
        "content": "<p>thank you Bryn, what's the best way to use the FHIRCommons library in cqf-ruler? We're trying to load FHIRCommons in a script but the engine can't find the source library..</p>",
        "id": 260425831,
        "sender_full_name": "Michael Riley",
        "timestamp": 1636128411
    },
    {
        "content": "<p>Is the <a href=\"https://build.fhir.org/ig/cqframework/cqf/Library-FHIRCommon.html\">FHIRCommon</a> library loaded in the ruler?</p>",
        "id": 260530194,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1636225177
    },
    {
        "content": "<p>Sorry for the late response Bryn, yes we have FHIRCommons as a library within CQF-Ruler. name: \"FHIRCommon\", title\" \"FHIR Commons\". Is that all we need for cql-engine to reference the library?</p>",
        "id": 261045739,
        "sender_full_name": "Michael Riley",
        "timestamp": 1636574277
    },
    {
        "content": "<p>Yes, that should do it. Are you running a Library/$evaluate?</p>",
        "id": 261070204,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1636586211
    },
    {
        "content": "<p>Yes, we're running Library/&lt;id&gt;/$evaulate with an embedded dataendpoint like so:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;resourceType&quot;: &quot;Parameters&quot;,\n    &quot;parameter&quot;: [{\n            &quot;name&quot;: &quot;patientId&quot;,\n            &quot;valueString&quot;: &quot;11364&quot;\n        },\n        {\n            &quot;name&quot;: &quot;context&quot;,\n            &quot;valueString&quot;: &quot;Patient&quot;\n        },\n        {\n            &quot;name&quot;: &quot;dataEndpoint&quot;,\n            &quot;valueEndpoint&quot;: {\n                &quot;resourceType&quot;: &quot;Endpoint&quot;,\n                &quot;id&quot;: &quot;428&quot;,\n                &quot;meta&quot;: {\n                    &quot;versionId&quot;: &quot;1&quot;,\n                    &quot;lastUpdated&quot;: &quot;2021-10-20T13:53:15.805+00:00&quot;,\n                    &quot;source&quot;: &quot;#5cb4405b-5cad-41&quot;\n                },\n                &quot;identifier&quot;: [{\n                    &quot;system&quot;: &quot;http://example.org/enpoint-identifier&quot;,\n                    &quot;value&quot;: &quot;omopv53onfhir4&quot;\n                }],\n                &quot;status&quot;: &quot;active&quot;,\n                &quot;connectionType&quot;: {\n                    &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/endpoint-connection-type&quot;,\n                    &quot;code&quot;: &quot;hl7-fhir-rest&quot;\n                },\n                &quot;name&quot;: &quot;OMOPonFHIR v5.3.1 on R4&quot;,\n                &quot;payloadType&quot;: [{\n                    &quot;coding&quot;: [{\n                        &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/endpoint-payload-type&quot;,\n                        &quot;code&quot;: &quot;any&quot;\n                    }]\n                }],\n                &quot;address&quot;: &quot;https://OMMITINGENDPOINT/fhir/&quot;,\n                &quot;header&quot;: [&quot;Basic OMMITINGCREDENTIALS&quot;]\n            }\n        }\n    ]\n}\n</code></pre></div>",
        "id": 261175890,
        "sender_full_name": "Michael Riley",
        "timestamp": 1636659221
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> I wanted to follow up on this again, we also wanted to have a common library of helper function for internal uses that we can refer to in other libraries, how exactly should the library be referenced in the CQL? We've tried <code>include FHIRCommon version 4.0.1</code> but that didn't work</p>",
        "id": 264338403,
        "sender_full_name": "Andy Stevens",
        "timestamp": 1639071962
    },
    {
        "content": "<p>There's an explanation of how to do it here: <a href=\"https://fhir.org/guides/cqf/common/#contents\">https://fhir.org/guides/cqf/common/#contents</a></p>",
        "id": 264759490,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1639424664
    },
    {
        "content": "<p>Note that we are working on NPM resolution in the atom and vs code plugins, so while the approach described at that link works for the refresh tooling (and the publisher if you're using the pub;isher to do CQL translation directly), it will give errors in the Atom and VS Code plugins until next release.</p>",
        "id": 264759621,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1639424740
    },
    {
        "content": "<p>Is there a more direct approach we can use in CQF ruler itself? We do need the common libraries hosted in the IG, but we have a few utilities we wrote ourselves that we want to host in CQF ruler and use as well.</p>",
        "id": 264763277,
        "sender_full_name": "Michael Riley",
        "timestamp": 1639426338
    },
    {
        "content": "<p>Is there an issue that prevents you from loading a FHIR Library with your utilities in it to the cqf-ruler?</p>",
        "id": 264772671,
        "sender_full_name": "JP",
        "timestamp": 1639431037
    },
    {
        "content": "<p>So we can load libraries into cqf ruler fine, our main question is how do we refer to them in other scripts. For example, the link Bryn included says to have a line for <code>include fhir.cqf.common.FHIRCommon</code> to use functions in there. If we had a CQL Library named \"ObservationHelperFunctions\", how would we refer to it (what would the namespace be) in another script to use those functions defined in the file?</p>",
        "id": 265308641,
        "sender_full_name": "Andy Stevens",
        "timestamp": 1639754159
    },
    {
        "content": "<p>The cqf-ruler currently doesn't support namespaces or loading referenced IGs, so if you placed the same file on the server the include would be:</p>\n<p><code>include FHIRCommon</code></p>\n<p>I thought we had an issue tracking that but we did not so I added one:<br>\n<a href=\"https://github.com/DBCG/cqf-ruler/issues/406\">https://github.com/DBCG/cqf-ruler/issues/406</a></p>",
        "id": 265352453,
        "sender_full_name": "JP",
        "timestamp": 1639771023
    }
]