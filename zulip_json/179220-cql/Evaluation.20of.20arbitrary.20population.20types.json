[
    {
        "content": "<p>I'm looking at measures that have populations that aren't very <em>typical</em>... I'm finding that the logic in HAPI for measure evaluation would have problems processing logic for non-standard populations. For example, I see:</p>\n<div class=\"codehilite\"><pre><span></span><code>switch (populationType) {\n  case INITIALPOPULATION:\n    ...\n  case NUMERATOR:\n    ...\n}\n</code></pre></div>\n<p>Which would be a problem for a measure that doesn't have a population type of INITIALPOPULATION, NUMERATOR, DENOMINATOR, etc.<br>\nAre there any plans to broaden this logic to support arbitrary population types?</p>",
        "id": 234908257,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618601361
    },
    {
        "content": "<p>Are there any plans to support stratifiers?</p>",
        "id": 234908794,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618601609
    },
    {
        "content": "<p>And, lastly (I think), is there any documentation on how the hapi-fhir-jpaserver-cql module evaluates a given Measure? Seems like there's lots of logic/decisions in the code, and I'm trying to figure out how best to share that logic (requirements?) with an analyst responsible for developing a measure that can be evaluated using HAPI.</p>",
        "id": 234909174,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618601795
    },
    {
        "content": "<p>Hi Sean, the populationType code system in the base specification is based on the standard population types from specifications currently in use, but we specifically made the binding extensible to support other calculation methodologies (FHIR-Saner has already defined some of these in their implementation guide). The HAPI server evaluation logic understands the population types in the base spec, so would have to be extended to support additional ones.</p>",
        "id": 234920981,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1618607046
    },
    {
        "content": "<p>For stratifier calculation, that is something we are in the process of adding, we'll be testing that in the upcoming connectathon.</p>",
        "id": 234921624,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1618607257
    },
    {
        "content": "<p>And for communicating requirements, there's been quite a bit of work in that space recently, take a look at some of the examples in the May ballot of the QM IG: <a href=\"http://build.fhir.org/ig/HL7/cqf-measures/Measure-measure-exm125-FHIR.html\">http://build.fhir.org/ig/HL7/cqf-measures/Measure-measure-exm125-FHIR.html</a></p>",
        "id": 234921995,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1618607362
    },
    {
        "content": "<p>We're working on refining the presentation, but the information is there for what would be the human readable content of the measure. Does that help?</p>",
        "id": 234923199,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1618607765
    },
    {
        "content": "<p>Thanks for that info <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>! Saner is one of the measures that I had in mind... Saner, for example, creates different populations for each calculable metric. For example, a population for the # of total patients with COVID, another population for the # of total patients with COVID on a ventilator, etc. If we developed another measure that behaved similarly with the use of populations but for fundamentally different calculations than SANER, I get the impression we would have to coordinate with you to add support for those populations..??</p>",
        "id": 234934100,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618614598
    },
    {
        "content": "<p>Got a chance to check out that link <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> ... that's not quite what I had in mind. That's per-measure documentation. What I had in mind was more-so <em>system</em> documentation describing how HAPI processes a measure/CQL.</p>",
        "id": 235199373,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618845659
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> , unfortunately there's not a lot of documentation there. At the highest level, it works by switching on the scoring type and evaluating the population criteria appropriate for that population type, patient-at-a-time, aggregating results if it's a summary request. So handling new scoring types/population types would be a matter of introducing new cases in that switch. Note that there is some refactoring going on in this layer right now and that should be done pretty soon, it might make sense to wait for the result of that and see how to apply in that newly refactored evaluation logic?</p>",
        "id": 235729295,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1619117456
    },
    {
        "content": "<p>No worries. After discussing with Rick for a bit, I think the proper way of handling this would actually be to create a separate <code>Measure.group</code> for each data element, each with a population of <code>initial-population</code>. So, rather than abstracting at <code>Measure.group.population</code>, abstracting at <code>Measure.group</code>.</p>",
        "id": 235751279,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1619126905
    },
    {
        "content": "<p>Regardless, you're probably right, it makes sense to hold off until your refactoring is done.</p>",
        "id": 235751301,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1619126918
    },
    {
        "content": "<p>With all of that said, I'd love to see more documentation on <em>how</em> this module of HAPI processes a given Measure.</p>",
        "id": 235751354,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1619126947
    }
]