[
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> <span class=\"user-mention\" data-user-id=\"194178\">@JP</span> Per our conversation earlier, I'm trying to make the CQFTooling work with FSH. Here are (roughly) the steps I'm following to use CQFTooling with FSH.</p>\n<ul>\n<li>copy in the _refresh and _updateCQFTooling scripts to the IG.</li>\n<li>run _update <code>bash _updateCQFTooling.sh</code></li>\n<li>change the vars in refresh script:</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code># resources_path=$PWD/input/resources\nresources_path=$PWD/fsh-generated/resources\n# ig_resource_path=./input/anc-cds.xml\nig_resource_path=./fsh-generated/resources/ImplementationGuide-simple.hiv.ig.json\n</code></pre></div>\n<p>FYI, FHIR Helpers, Common and Model-Info are all in CQL format.</p>\n<p>Process:</p>\n<ul>\n<li>run sushi</li>\n<li>try refresh...</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code>&lt;output of _refresh&gt;\nNo paths found for the Directory /Users/richard/src/github.com/intrahealth/simple-hiv-ig/input/tests/measure/KitchenSink:\njava.lang.NullPointerException\n    at java.base/java.util.Objects.requireNonNull(Objects.java:208)\n    at java.base/sun.nio.fs.UnixFileSystem.getPath(UnixFileSystem.java:260)\n    at java.base/java.nio.file.Path.of(Path.java:147)\n    at java.base/java.nio.file.Paths.get(Paths.java:69)\n    at org.opencds.cqf.tooling.utilities.IOUtils.copyFile(IOUtils.java:164)\n    at org.opencds.cqf.tooling.measure.MeasureProcessor.bundleFiles(MeasureProcessor.java:193)\n    at org.opencds.cqf.tooling.measure.MeasureProcessor.bundleMeasures(MeasureProcessor.java:142)\n    at org.opencds.cqf.tooling.processor.IGBundleProcessor.bundleIg(IGBundleProcessor.java:25)\n    at org.opencds.cqf.tooling.processor.IGProcessor.publishIG(IGProcessor.java:79)\n    at org.opencds.cqf.tooling.operation.RefreshIGOperation.execute(RefreshIGOperation.java:34)\n    at org.opencds.cqf.tooling.Main.main(Main.java:208)\n</code></pre></div>\n<p>The tooling seems to expect some stuff in resources/tests/measure/MeasureName whereas the Atom plugin is fine with tests/MeasureName</p>",
        "id": 251245721,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1630336879
    },
    {
        "content": "<p>If I put copy tests over into a measure/ dir, then the next error is that it cant find FHIR Helpers.</p>\n<div class=\"codehilite\"><pre><span></span><code>java.lang.RuntimeException: /Users/richard/src/github.com/intrahealth/simple-hiv-ig/fsh-generated/resources/FHIRHelpers.json (No such file or directory)\n    at org.opencds.cqf.tooling.utilities.IOUtils.readResource(IOUtils.java:240)\n    at org.opencds.cqf.tooling.utilities.IOUtils.readResource(IOUtils.java:203)\n    at org.opencds.cqf.tooling.utilities.ResourceUtils.getR4DepLibraryResources(ResourceUtils.java:219)\n    at org.opencds.cqf.tooling.utilities.ResourceUtils.getDepLibraryResources(ResourceUtils.java:136)\n    at org.opencds.cqf.tooling.library.LibraryProcessor.bundleLibraryDependencies(LibraryProcessor.java:67)\n    at org.opencds.cqf.tooling.measure.MeasureProcessor.bundleMeasures(MeasureProcessor.java:124)\n    at org.opencds.cqf.tooling.processor.IGBundleProcessor.bundleIg(IGBundleProcessor.java:25)\n    at org.opencds.cqf.tooling.processor.IGProcessor.publishIG(IGProcessor.java:79)\n    at org.opencds.cqf.tooling.operation.RefreshIGOperation.execute(RefreshIGOperation.java:34)\n    at org.opencds.cqf.tooling.Main.main(Main.java:208)\n11:30:15.713 [main] WARN  o.o.cqf.tooling.utilities.LogUtils - Measure will not be bundled because Library Dependency bundling failed.\n</code></pre></div>",
        "id": 251247240,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1630337482
    },
    {
        "content": "<p>This is because FSH prefixes files with their resource, type, ie. <code>Library-FHIRHelpers</code></p>",
        "id": 251247387,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1630337525
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195840\">@David Winters</span> put together something pretty cool here using FSH to make PlanDefinitions and ActivityDefinitions for this Cervical Cancer CDS use case: <a href=\"https://github.com/ccsm-cds-tools/ccsm-cds-with-tests\">https://github.com/ccsm-cds-tools/ccsm-cds-with-tests</a></p>\n<p>It would be neat to turn this into a template for making CPGs. Right now I feel like the CQF-tooling does making spreadsheets and CQL into CPGs, but making PlanDefinitions and ActivityDefinitions requires a lot of manual work, which can be handled more easily by FSH. It would be great to get this on the CQF Github, once the templates are made</p>",
        "id": 258627718,
        "sender_full_name": "Alex Goel",
        "timestamp": 1634855491
    },
    {
        "content": "<p>I think this is a great idea and it isn't something that occurred to <span class=\"user-mention\" data-user-id=\"324272\">@Michael O'Hanlon</span> and I when we started <a href=\"https://github.com/ccsm-cds-tools\">ccsm-cds-with-tests</a>.  If there was a community template for making CPGs with FSH we would transition over to using it.</p>",
        "id": 258706469,
        "sender_full_name": "David Winters",
        "timestamp": 1634906893
    },
    {
        "content": "<p>I think CCSM is a good place to start making the template. Take a PD and an AD then strip out the CCSM stuff.</p>",
        "id": 258709378,
        "sender_full_name": "Alex Goel",
        "timestamp": 1634908378
    },
    {
        "content": "<p>The more challenging part is what <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  pointed out with the CQF-Tooling/publisher needing updates to accomodate FSH</p>",
        "id": 258709420,
        "sender_full_name": "Alex Goel",
        "timestamp": 1634908409
    },
    {
        "content": "<p>FWIW, my method to doing FSH-&gt;CQL right now is:</p>\n<div class=\"codehilite\"><pre><span></span><code># remove these from a previous run or you&#39;ll get a dupe error\n# the rm -rf approach is a bit harsh, check your IG to make sure you don&#39;t have ones that FSH doesn&#39;t generate\nrm -rf input/resources/Library-* input/resources/library-*\n# sushi as usual but with FSHOnly: true\nsushi\nmv fsh-generated/resources/Library-* input/resources/\n# now use the cqf tooling script\nbash _refresh.sh\nbash _genonce.sh -no-sushi\n</code></pre></div>\n<p>The only limitation is that the publisher needs to use the XML template for IGs (input/my-ig.xml), meaning that Sushi can't be used for creating the IG. Or, at least I couldn't make it work. IIRC, the issue is that you need Publisher to use sushi or it can't find all of the IG resources.</p>",
        "id": 258711674,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1634909494
    }
]