[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"241729\">@Kyle Brew</span>  I've registered a client app and am attempting to login. The authorize redirect seems ok, but neither username/password from <a href=\"https://1up.health/dev/doc/smart-on-fhir\">https://1up.health/dev/doc/smart-on-fhir</a> is working for me.</p>",
        "id": 209663050,
        "sender_full_name": "Amy Ballard",
        "timestamp": 1599751439
    },
    {
        "content": "<p>...same here</p>",
        "id": 209669480,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599753936
    },
    {
        "content": "<p>Hey Amy and Michele, what error are you receiving when attempting to use either credential?</p>",
        "id": 209680792,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599758907
    },
    {
        "content": "<p>Invalid user name or password</p>",
        "id": 209682708,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599759782
    },
    {
        "content": "<p>and you are hitting '<a href=\"https://1up.health/auth/heart.com/authorize?response_type=code&amp;aud=https://api.1up.health/fhir/r4&amp;client_id={client_id}\">https://1up.health/auth/heart.com/authorize?response_type=code&amp;aud=https://api.1up.health/fhir/r4&amp;client_id={client_id}</a><br>\n&amp;state=${state}&amp;redirect_uri=${app_redirect_uri}' with updated redirect, client id and state? I just tried this out with a few different testing applications and both logins worked for me. If you share your application names with me I can look and see if I can figure out if something went wrong somewhere</p>",
        "id": 209687262,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599761741
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"340998\">@Liam O'Toole</span>  The authorize endpoint found at <a href=\"https://api.1up.health/fhir/r4/metadata\">https://api.1up.health/fhir/r4/metadata</a> is <a href=\"https://1up.health/auth/authorize\">https://1up.health/auth/authorize</a></p>",
        "id": 209690931,
        "sender_full_name": "Amy Ballard",
        "timestamp": 1599763380
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"216906\">@Amy Ballard</span>  yeah sorry for the confusion there, I will talk to the other engineers about fixing this. For now, I would follow the exact steps at <a href=\"https://1up.health/dev/doc/smart-on-fhir\">https://1up.health/dev/doc/smart-on-fhir</a></p>",
        "id": 209691197,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599763496
    },
    {
        "content": "<p>Is the token URL different as well?</p>",
        "id": 209691523,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599763642
    },
    {
        "content": "<p>nope! only the authorize url is different, everything else in the metadata endpoint should be accurate</p>",
        "id": 209691592,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599763676
    },
    {
        "content": "<p>Also when I drop the full authorize redirect into Chrome, I get the login page. When I try Safari, I am immediately redirected to the callback URL</p>",
        "id": 209691894,
        "sender_full_name": "Amy Ballard",
        "timestamp": 1599763814
    },
    {
        "content": "<p>However, the authorize redirect on my mobile  (using Safari) does bring up the login</p>",
        "id": 209692041,
        "sender_full_name": "Amy Ballard",
        "timestamp": 1599763895
    },
    {
        "content": "<p>The token URL in the metadata is <code>https://zwiuchaef2.execute-api.us-west-2.amazonaws.com/prod/oauth2/token</code>, but that host name does not resolve</p>",
        "id": 209692454,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599764078
    },
    {
        "content": "<p>ah okay, seems like the meta data endpoint is all messed up.. ill send a list of urls one second, sorry about that!</p>",
        "id": 209693000,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599764306
    },
    {
        "content": "<p>token url: <a href=\"https://api.1up.health/fhir/oauth2/token\">https://api.1up.health/fhir/oauth2/token</a><br>\nresource_url for r4: <a href=\"https://api.1up.health/fhir/r4\">https://api.1up.health/fhir/r4</a></p>",
        "id": 209693282,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599764400
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"216906\">@Amy Ballard</span> interesting, thank you for pointing that out, I will do some testing with safari and see if I can recreate that issue</p>",
        "id": 209693481,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599764449
    },
    {
        "content": "<p>Getting a 503 BadGateway error from that token url</p>",
        "id": 209694784,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599765032
    },
    {
        "content": "<p>The new authorize redirect works in Safari, but displays a little funny on mobile.</p>",
        "id": 209694800,
        "sender_full_name": "Amy Ballard",
        "timestamp": 1599765037
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span>  what are you posting in the body? it should look like this <br>\n curl -X POST '<a href=\"https://api.1up.health/fhir/oauth2/token\">https://api.1up.health/fhir/oauth2/token</a>' \\<br>\n  -d \"client_id=\" \\<br>\n  -d \"client_secret=\" \\<br>\n  -d \"code=\" \\<br>\n  -d \"grant_type=authorization_code\"</p>",
        "id": 209699416,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599767083
    },
    {
        "content": "<p>You don't support client id and secret in the Authorization header ?</p>",
        "id": 209701169,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599767860
    },
    {
        "content": "<p>OK, that was it - switched to client id and secret in the post body and it worked....</p>",
        "id": 209701575,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599768053
    },
    {
        "content": "<p>except that we do not get back the patient id, this is the token response:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;refresh_token&quot;: &quot;9cc80eea4bfe420e8264c23da0a1a71a&quot;,\n    &quot;token_type&quot;: &quot;bearer&quot;,\n    &quot;access_token&quot;: &quot;2e9a66ae6dc8466bbcbd11f2dd8e110c&quot;,\n    &quot;expires_in&quot;: 7200,\n    &quot;scope&quot;: &quot;patient/*.read launch/patient offline_access&quot;\n}\n</code></pre></div>",
        "id": 209701660,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599768098
    },
    {
        "content": "<p>Not yet we are working on supporting it in the authorization header though... if you hit <a href=\"https://api.1up.health/fhir/r4/Patient\">https://api.1up.health/fhir/r4/Patient</a> with the bearer token authorization, you will get the list of patients returned and can extract the ids from there</p>",
        "id": 209703671,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599769153
    },
    {
        "content": "<p>Tying that but I cannot get the conformance: <code>GET https://api.1up.health/fhir/r4/metadata</code> fails with a 406: </p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n    &quot;id&quot;: &quot;bsoys13f9eb&quot;,\n    &quot;issue&quot;: [\n        {\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;code&quot;: &quot;value&quot;,\n            &quot;details&quot;: {\n                &quot;text&quot;: &quot;this accept header is not supported application/fhir+json;charset=utf-8&quot;\n            }\n        }\n    ]\n}\n</code></pre></div>",
        "id": 209707516,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599771166
    },
    {
        "content": "<p>are you setting some headers? I just did a get to '<a href=\"https://api.1up.health/fhir/r4/metadata\">https://api.1up.health/fhir/r4/metadata</a>' without any headers set and it worked fine.. I imagine there must be something being passed that the endpoint did not like</p>",
        "id": 209709526,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599772159
    },
    {
        "content": "<p>Yes, the client is setting the Accept header to <code>application/fhir+json;charset=utf-8</code> - that is the standard FHIR one</p>",
        "id": 209709697,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599772242
    },
    {
        "content": "<p>yup just talked to the lead api engineer, he found a bug with charset.. should work without it for now, a fix should be out shortly though</p>",
        "id": 209709939,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599772345
    },
    {
        "content": "<p>the fix for the token url is out as well so once charset is fixed it should be good to go</p>",
        "id": 209710091,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599772431
    },
    {
        "content": "<p>OK, thanks, let me know when I can test again</p>",
        "id": 209710271,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599772532
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> it should be working now</p>",
        "id": 209780885,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599831146
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"340998\">@Liam O'Toole</span> I can get the metadata, but no luck trying to get the patient - <code>GET GET https://api.1up.health/fhir/r4/Patient</code> fails with a 403:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n    &quot;id&quot;: &quot;29nwa07fydi&quot;,\n    &quot;issue&quot;: [\n        {\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;code&quot;: &quot;value&quot;,\n            &quot;details&quot;: {\n                &quot;text&quot;: &quot;scope provided does not have access to perform this operation&quot;\n            }\n        }\n    ]\n}\n</code></pre></div>",
        "id": 209801940,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599841019
    },
    {
        "content": "<p>tried to switch to <code>user/*.read</code> instead of <code>patient/*.read</code> but got same error</p>",
        "id": 209802176,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599841110
    },
    {
        "content": "<p>huh, a scope of user/*.read should work fine... if theres only synthetic data under the user you could share the token and I could look into it more. Either way I will test a few things out to see if I can figure out what might be happening</p>",
        "id": 209804898,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599842474
    },
    {
        "content": "<p>The token is <code>2365f55f1d8c48a08109b108d3c9f04e</code></p>",
        "id": 209805265,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599842654
    },
    {
        "content": "<p>looking into a bug with how we are enforcing read only access... could you try with <code>user/*.*</code> to see if it works? Will hopefully have a fix to *.read soon</p>",
        "id": 209807407,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599843772
    },
    {
        "content": "<p>Yes, that worked</p>",
        "id": 209807613,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599843877
    },
    {
        "content": "<p>Got no data back though</p>",
        "id": 209807675,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599843912
    },
    {
        "content": "<p><code>GET https://api.1up.health/fhir/r4/ExplanationOfBenefit?patient=24514bbe8198</code> returned</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;resourceType&quot;: &quot;Bundle&quot;,\n    &quot;type&quot;: &quot;searchset&quot;,\n    &quot;total&quot;: 0,\n    &quot;entry&quot;: []\n}\n</code></pre></div>",
        "id": 209807723,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599843944
    },
    {
        "content": "<p>I am not sure why that is happening either (you are becoming our bug finder lol).. If you just hit the endpoint without <code>patient=id</code> you should get the EOB's back.. also looking into why the query string isn't working</p>",
        "id": 209810441,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599845235
    },
    {
        "content": "<p>My client cannot  not pass a patient ID...</p>",
        "id": 209810717,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599845375
    },
    {
        "content": "<p>can you try again? It seems to be fixed in my testing</p>",
        "id": 209813050,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599846568
    },
    {
        "content": "<p>No, same thing</p>",
        "id": 209815867,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599847956
    },
    {
        "content": "<p>hm, requests with either <code>patient=</code> and <code>patient-reference=</code> are working for me... Ill keep trying to recreate your problem though</p>",
        "id": 209819188,
        "sender_full_name": "Liam O'Toole",
        "timestamp": 1599849658
    },
    {
        "content": "<p>out of curiosity where does the patient-reference parameter come from?</p>",
        "id": 209819688,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1599849949
    },
    {
        "content": "<p>If it helps the request is: <code>x-amzn-requestid :  a3dc5730-c0ef-4699-8a82-a2ff297dd796</code></p>",
        "id": 209820557,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599850415
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"192132\">@Amol Vyas</span> <span class=\"user-mention\" data-user-id=\"238353\">@Mark Roberts</span> Hi Rob,  I’ve been working on the terminologies on the CARIN for BB IG.  Happy to chat with you.</p>",
        "id": 210195541,
        "sender_full_name": "Pat Taylor",
        "timestamp": 1600206578
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243554\">@Pat Taylor</span> Hi, Pat.  It was good to have you and Lenel on the UTG call yesterday.  And I'm happy to look for a time to chat with you (and anyone).</p>",
        "id": 210251847,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1600258239
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"193300\">@Lenel James</span> Hi Rob, sounds good.  Adding Lenel.</p>",
        "id": 210747815,
        "sender_full_name": "Pat Taylor",
        "timestamp": 1600697967
    },
    {
        "content": "<p>Do we have slot(s) to look at this during the rest of the week?</p>",
        "id": 210814639,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1600732439
    }
]