[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"379108\">@Alex Hackett</span> : getting a <code>{\"message\":\"this is the authorization app homepage visit 1uphealth api develper guide to learn more\"}</code> after authentication on 1up server as 1up / iscool</p>",
        "id": 222862749,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610720443
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> What url are you using? It's likely that you are hitting the root url and not using the right parameters. Check out the docs here for more information: <a href=\"https://1up.health/docs/start/smart-on-fhir\">https://1up.health/docs/start/smart-on-fhir</a></p>",
        "id": 222864354,
        "sender_full_name": "Alex Hackett",
        "timestamp": 1610721143
    },
    {
        "content": "<p>Ah yes, I was using the authorization URL for from the last connectathon<br>\nBut using the new one (<a href=\"https://authv2.1uphealthdev.com/connect/testplan\">https://authv2.1uphealthdev.com/connect/testplan</a>) I get <code>{\"success\":false,\"errorMessage\":\"could not find client_id for this access_token or access_token may be expired (3)\"}</code> - do I need to re-register our app ?</p>",
        "id": 222865457,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610721657
    },
    {
        "content": "<p>Also, the auth and token url retuned in the capability statement (<a href=\"https://auth.1up.health/auth/app/authorize\">https://auth.1up.health/auth/app/authorize</a> <a href=\"https://auth.1up.health/oauth2/token\">https://auth.1up.health/oauth2/token</a>\") are different from those listed in the documentation</p>",
        "id": 222865743,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610721783
    },
    {
        "content": "<p>OK, I registered our app again and now I can login</p>",
        "id": 222866676,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610722223
    },
    {
        "content": "<p>But I cannot get data: <code>GET https://api.1up.health/fhir/r4/Patient/1d5e078b47ba</code> fails with a 401</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;error&quot;: &quot;invalid_token&quot;,\n    &quot;error_description&quot;: &quot;Invalid token: access token is invalid&quot;\n}\n</code></pre></div>",
        "id": 222867142,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610722426
    },
    {
        "content": "<p>Both passing the original token and also trying to do a token refresh and using that new token</p>",
        "id": 222867282,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610722467
    },
    {
        "content": "<p>Can you send the curl request you are using</p>",
        "id": 222868489,
        "sender_full_name": "Alex Hackett",
        "timestamp": 1610722859
    },
    {
        "content": "<p>I am not using curl, it is the request coming from our app</p>",
        "id": 222868774,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610722939
    },
    {
        "content": "<p>Ok, and where did you get that patient_id</p>",
        "id": 222869117,
        "sender_full_name": "Alex Hackett",
        "timestamp": 1610723050
    },
    {
        "content": "<p>From the token response</p>",
        "id": 222869495,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610723187
    },
    {
        "content": "<p>Using launch/patient</p>",
        "id": 222869522,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610723197
    },
    {
        "content": "<p>From our log:</p>\n<div class=\"codehilite\"><pre><span></span><code>When :  1/15/2021 9:51:37 AM -05:00\nRequest :  POST https://authv2.1uphealthdev.com/oauth2/token\n Request headers\nRequest :  grant_type=authorization_code&amp;redirect_uri=https%3A%2F%2Fmyfhr.careevolution.com%2Fcfhrprovideraccounts%2Fredirecttarget&amp;code=6d0dc0a66481f0aa66124b5a4940b149cc1605bc&amp;client_id=77647a264bfa13c1cf06ebe1e15aac46&amp;client_secret=457a777b662f23256cb8b4cd3dcdae5b\nResponse status code :  200\n Response headers\nResponse :\n{\n    &quot;access_token&quot;: &quot;41d37dbbccf9be293946858d90e858d10cb3dcc8&quot;,\n    &quot;token_type&quot;: &quot;Bearer&quot;,\n    &quot;expires_in&quot;: 7199,\n    &quot;refresh_token&quot;: &quot;b26485a6b10e813feaf985cdfb463a7b424fb6fc&quot;,\n    &quot;scope&quot;: &quot;patient/*.read launch/patient offline_access&quot;,\n    &quot;patient&quot;: &quot;1d5e078b47ba&quot;\n}\n</code></pre></div>",
        "id": 222869902,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610723337
    },
    {
        "content": "<p>Are you able to try without using the scope patient/*.read?</p>",
        "id": 222871949,
        "sender_full_name": "Alex Hackett",
        "timestamp": 1610723919
    },
    {
        "content": "<p>Yes</p>",
        "id": 222872863,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610724209
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> - we're currently supporting <code>user/*.read</code>, not <code>patient/*.read</code></p>",
        "id": 222874979,
        "sender_full_name": "Kyle Brew",
        "timestamp": 1610725057
    },
    {
        "content": "<p>Same error with <code>user/*.read</code></p>",
        "id": 222875180,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610725144
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>When :  1/15/2021 10:38:35 AM -05:00\nRequest :  POST https://authv2.1uphealthdev.com/oauth2/token\nRequest :  grant_type=refresh_token&amp;refresh_token=ec888b362233a88466fe8a34a5bc352d3ec40130&amp;client_id=77647a264bfa13c1cf06ebe1e15aac46&amp;client_secret=457a777b662f23256cb8b4cd3dcdae5b\nResponse status code :  200\nResponse :\n{\n    &quot;access_token&quot;: &quot;bfc124a9e262fff0938935c5f25297168a7ceeee&quot;,\n    &quot;token_type&quot;: &quot;Bearer&quot;,\n    &quot;expires_in&quot;: 7199,\n    &quot;refresh_token&quot;: &quot;a4cf422bbf830b09f0bdfabe7adb0a75471a8407&quot;,\n    &quot;scope&quot;: &quot;user/*.read launch/patient&quot;,\n    &quot;patient&quot;: &quot;1d5e078b47ba&quot;\n}\n</code></pre></div>",
        "id": 222875425,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610725245
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>When :  1/15/2021 10:38:35 AM -05:00\nResource :  Patient\nRequest :  GET https://api.1up.health/fhir/r4/Patient/1d5e078b47ba\nResponse status code :  401\nResponse :\n{\n    &quot;error&quot;: &quot;invalid_token&quot;,\n    &quot;error_description&quot;: &quot;Invalid token: access token is invalid&quot;\n}\n</code></pre></div>",
        "id": 222875469,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610725265
    },
    {
        "content": "<p>Try using launch/patient and openid also</p>",
        "id": 222878691,
        "sender_full_name": "Alex Hackett",
        "timestamp": 1610726520
    },
    {
        "content": "<p>Those are the other scopes that are currently supported</p>",
        "id": 222878760,
        "sender_full_name": "Alex Hackett",
        "timestamp": 1610726533
    },
    {
        "content": "<p><code>patient/*.read</code> is what the specs say it should work - please fix your server</p>",
        "id": 222879305,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610726733
    },
    {
        "content": "<p>I'll re-test when it is fixed</p>",
        "id": 222879348,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610726749
    },
    {
        "content": "<p>yes it does - the resource url is <a href=\"https://api.1uphealthdev.com/r4/Patient/1d5e078b47ba\">https://api.1uphealthdev.com/r4/Patient/1d5e078b47ba</a> <br>\nnot <a href=\"https://api.1up.health\">https://api.1up.health</a></p>",
        "id": 222879366,
        "sender_full_name": "Kyle Brew",
        "timestamp": 1610726760
    },
    {
        "content": "<p>you can see our resource url here - <a href=\"https://api.1uphealthdev.com/r4/metadata\">https://api.1uphealthdev.com/r4/metadata</a></p>",
        "id": 222879480,
        "sender_full_name": "Kyle Brew",
        "timestamp": 1610726798
    },
    {
        "content": "<p>But will work on <code>patient/*.read</code> for future connectathons</p>",
        "id": 222879748,
        "sender_full_name": "Kyle Brew",
        "timestamp": 1610726895
    },
    {
        "content": "<p>Ah yes - I can get the patient on that endpoint!<br>\nBut nothing else:</p>\n<div class=\"codehilite\"><pre><span></span><code>When :  1/15/2021 11:08:28 AM -05:00\nResource :  Encounter\nRequest :  GET https://api.1uphealthdev.com/r4/Encounter?patient=1d5e078b47ba\nResponse status code :  403\n Response headers\nResponse :\n{\n    &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n    &quot;id&quot;: &quot;3sggrbi76wb&quot;,\n    &quot;issue&quot;: [\n        {\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;code&quot;: &quot;value&quot;,\n            &quot;details&quot;: {\n                &quot;text&quot;: &quot;scope provided does not have access to perform this operation&quot;\n            }\n        }\n    ]\n}\n</code></pre></div>",
        "id": 222880146,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610727039
    },
    {
        "content": "<p>Using <code>patient/*.read</code></p>",
        "id": 222880176,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610727050
    },
    {
        "content": "<p>Same with <code>user/*.read</code></p>",
        "id": 222880434,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610727158
    },
    {
        "content": "<p>Looking into this. Would it be possible for you to DM me your access token value for when you try with <code>user/*.read</code> or email (<a href=\"mailto:kyle@1up.health\">kyle@1up.health</a>)?</p>",
        "id": 222896191,
        "sender_full_name": "Kyle Brew",
        "timestamp": 1610732896
    },
    {
        "content": "<p>No, my error, I was still using <code>patient/*.read</code>- now actually switched to <code>user/*.read</code> and it works!</p>",
        "id": 222897992,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610733614
    },
    {
        "content": "<p>The only error are 404 on Organization (referenced by ExplanationOfBenefit):</p>\n<div class=\"codehilite\"><pre><span></span><code>When :  1/15/2021 12:59:03 PM -05:00\nResource :  Organization\nRequest :  GET https://api.1uphealthdev.com/r4/Organization/3e3ede0c779b\nResponse status code :  404\n Response headers\nResponse :\n{\n    &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n    &quot;id&quot;: &quot;9ap0vfqxgnd&quot;,\n    &quot;issue&quot;: [\n        {\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;code&quot;: &quot;not found&quot;,\n            &quot;details&quot;: {\n                &quot;text&quot;: &quot;Resource not found&quot;\n            }\n        }\n    ]\n}\n</code></pre></div>",
        "id": 222898355,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1610733744
    },
    {
        "content": "<p>Good catch <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> ! We loaded a Org resource for that ID to the environment</p>",
        "id": 222909356,
        "sender_full_name": "Kyle Brew",
        "timestamp": 1610737910
    }
]