[
    {
        "content": "<p>Cannot connect because getting the conformance fails with a 401 unauthorized error (<a href=\"https://p-hi2.digitaledge.cigna.com/ConsumerAccess/v1-devportal/metadata\">https://p-hi2.digitaledge.cigna.com/ConsumerAccess/v1-devportal/metadata</a>)</p>",
        "id": 217153355,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605714770
    },
    {
        "content": "<p>Can you try requesting with a username &amp; password?  In the meantime, will take a look at my end to see why capabilitystatement isn't open</p>",
        "id": 217153677,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605714881
    },
    {
        "content": "<p>I can work around it hard-wiring the OAuth2 URL (so that our client does not need to read the capability statement to start the sequence)</p>",
        "id": 217153857,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605714957
    },
    {
        "content": "<p>...but then I hit another problem: after I login and authorize sharing the app gets an auth error: the authorization server redirects back to <code>https://myfhr.careevolution.dev/cfhrprovideraccounts/redirectcallback?error=access_denied&amp;error_description=FBTOAU218E%20The%20user%20supplied%20an%20invalid%20state.&amp;state=oauth-redirect%7CMyFHR-QA%7Ca0407c44105742199888a205e375f6e9</code></p>",
        "id": 217154746,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605715248
    },
    {
        "content": "<p>Interesting.  what user did you use?</p>",
        "id": 217155324,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605715439
    },
    {
        "content": "<p>Looked into the capabilityStatement, need a token to hit it.  Our team is working on a fix. Probably won't be ready before end of the event.</p>",
        "id": 217155577,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605715513
    },
    {
        "content": "<p>Logged in as <code>syntheticuser01</code></p>",
        "id": 217155636,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605715530
    },
    {
        "content": "<p>Looking into the issue</p>",
        "id": 217155928,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605715625
    },
    {
        "content": "<p>Looks like the issue is with the state being passed.</p>",
        "id": 217158794,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605716591
    },
    {
        "content": "<p>What's the problem with it?</p>",
        "id": 217162956,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605718181
    },
    {
        "content": "<p>We are looking on our side.  What did you pass so we can confirm?</p>",
        "id": 217164752,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605718912
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"365372\">@Ian King</span> Here is the PDF: <a href=\"/user_uploads/10155/wSyc9uBRcESsBA3tEyV49-RM/Cigna-Developer-Sandbox.pdf\">Cigna-Developer-Sandbox.pdf</a></p>",
        "id": 217165174,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605719075
    },
    {
        "content": "<p>State passed: <code>oauth-redirect|MyFHR-QA|6af70be2990443a899649a4cd0304fd9</code></p>",
        "id": 217165455,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605719174
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191912\">Michele Mottini</span> <a href=\"#narrow/stream/204607-CARIN-IG.20for.20Blue.20Button.C2.AE/topic/11.2F18-19.20CARIN.20Connectathon.20-.20Cigna.20server/near/217165455\">said</a>:</p>\n<blockquote>\n<p>State passed: <code>oauth-redirect|MyFHR-QA|6af70be2990443a899649a4cd0304fd9</code></p>\n</blockquote>\n<p>We are not seeing any issues with the value itself.  <br>\nJust to confirm, you can login with sythenticuser01; give authorization to share data with CE's app; then when redirecting, there is an error. Is this correct?</p>",
        "id": 217166515,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605719643
    },
    {
        "content": "<p>Yes, that is what happen</p>",
        "id": 217166649,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605719685
    },
    {
        "content": "<p>We are replaying the calls on our side to see what is happening.</p>",
        "id": 217166946,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605719801
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197108\">Jason Teeple</span> <a href=\"#narrow/stream/204607-CARIN-IG.20for.20Blue.20Button.C2.AE/topic/11.2F18-19.20CARIN.20Connectathon.20-.20Cigna.20server/near/217165174\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"365372\">Ian King</span> Here is the PDF: <a href=\"/user_uploads/10155/wSyc9uBRcESsBA3tEyV49-RM/Cigna-Developer-Sandbox.pdf\">Cigna-Developer-Sandbox.pdf</a></p>\n</blockquote>\n<p>Check your Private Messages - need confirmation from your team.</p>",
        "id": 217168664,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605720498
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> <br>\ncan you pass nonce?  We are validating for nonce as part of the consent post back.</p>",
        "id": 217168810,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605720590
    },
    {
        "content": "<p>Mhh, no? Don't think that is required by the specs</p>",
        "id": 217169443,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605720849
    },
    {
        "content": "<p>I have asked our team to stop validating.  Will take about 15 mins for the change.</p>",
        "id": 217170281,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605721249
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> can you retry?</p>",
        "id": 217171250,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605721642
    },
    {
        "content": "<p>Yep, authentication worked, thanks!</p>",
        "id": 217171463,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605721738
    },
    {
        "content": "<p>...but cannot get data because we are still trying to get the capability statement without authorization</p>",
        "id": 217171522,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605721762
    },
    {
        "content": "<p>ah, that one we may not be able to solve today</p>",
        "id": 217171784,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605721863
    },
    {
        "content": "<p>Working on a fix now.  will let you know when it is good to go.</p>",
        "id": 217179476,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605725428
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> we fixed the capStatement, but it may not matter. We do not have the auth endpoints in there.<br>\n<a href=\"https://r-hi2.cigna.com/mga/sps/oauth/oauth20/token\">https://r-hi2.cigna.com/mga/sps/oauth/oauth20/token</a><br>\n<a href=\"https://r-hi2.cigna.com/mga/sps/oauth/oauth20/authorize\">https://r-hi2.cigna.com/mga/sps/oauth/oauth20/authorize</a></p>",
        "id": 217185701,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605728173
    },
    {
        "content": "<p>Thaks <span class=\"user-mention\" data-user-id=\"197108\">@Jason Teeple</span> - I can work around that hard coding the auth end points, but I get a 404 now trying to get the cap statement</p>",
        "id": 217187022,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605728768
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;issue&quot;: [\n        {\n            &quot;code&quot;: &quot;processing&quot;,\n            &quot;diagnostics&quot;: &quot;Cache miss: cap_statement:ConsumerAccess&quot;,\n            &quot;severity&quot;: &quot;error&quot;\n        }\n    ],\n    &quot;resourceType&quot;: &quot;OperationOutcome&quot;\n}\n</code></pre></div>",
        "id": 217187040,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605728783
    },
    {
        "content": "<p>should be good now, needed to clean up some cache</p>",
        "id": 217189663,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605730046
    },
    {
        "content": "<p>We added the endpoints to our capStatement - would appreciate feedback</p>",
        "id": 217193739,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605732037
    },
    {
        "content": "<p>Thanks, I'll test again in a little bit</p>",
        "id": 217194847,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605732686
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197108\">@Jason Teeple</span> : tested again: endpoints in the capability statement worked ok, login works ok but getting the data still fails - some issue with the capability statement, looking into it</p>",
        "id": 217197000,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605733717
    },
    {
        "content": "<p>Oh yes - the <code>rest</code> element (an array) should contain a single element describing the server, not two</p>",
        "id": 217197344,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605733904
    },
    {
        "content": "<p>We made an update</p>",
        "id": 217200079,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605735475
    },
    {
        "content": "<p>Hi Jason, just tried testing again, getting the following error: <br>\n{\"type\":2,\"code\":2001,\"error\":\"invalid_client\",\"errorDescription\":\"FBTOAU204E An invalid secret was provided for the client with identifier: [{0}].\",\"errorUri\":\"\"}<br>\nAny idea what might be causing that?</p>",
        "id": 217201680,
        "sender_full_name": "James Kizer",
        "timestamp": 1605736431
    },
    {
        "content": "<p>No, capability statement appears to be bad: <code>Type checking the data: Encountered unknown element 'mode' at location 'Resource.rest[0].security[0].mode[0]' while parsing</code></p>",
        "id": 217201956,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605736596
    },
    {
        "content": "<p>We are in the process of fixing the issue. We noticed that we have the mode, security, and resource at the wrong levels.</p>",
        "id": 217202028,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605736642
    },
    {
        "content": "<p>OK, thanks Jason, let me know when you want me to test again</p>",
        "id": 217202312,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605736785
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"365368\">James Kizer</span> <a href=\"#narrow/stream/204607-CARIN-IG.20for.20Blue.20Button.C2.AE/topic/11.2F18-19.20CARIN.20Connectathon.20-.20Cigna.20server/near/217201680\">said</a>:</p>\n<blockquote>\n<p>Hi Jason, just tried testing again, getting the following error: <br>\n{\"type\":2,\"code\":2001,\"error\":\"invalid_client\",\"errorDescription\":\"FBTOAU204E An invalid secret was provided for the client with identifier: [{0}].\",\"errorUri\":\"\"}<br>\nAny idea what might be causing that?</p>\n</blockquote>\n<p>Did your auth client change?</p>",
        "id": 217202668,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605736972
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197108\">@Jason Teeple</span> No, still the same as what you sent earlier today</p>",
        "id": 217204030,
        "sender_full_name": "James Kizer",
        "timestamp": 1605737694
    },
    {
        "content": "<p>hmmm...<br>\nLet me see if we can find an issue on our side</p>",
        "id": 217204678,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605738006
    },
    {
        "content": "<p>Try getting a refresh token.<br>\nEdited: Don't get a refresh token.</p>\n<p>Issue was on our side. Should be fixed now.</p>",
        "id": 217205840,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605738651
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"197108\">@Jason Teeple</span> That seemed to work, but now we're getting a 502 error from the server when requesting the patient resource via <a href=\"https://p-hi2.digitaledge.cigna.com/ConsumerAccess/v1-devportal/Patient/A00000000000005\">https://p-hi2.digitaledge.cigna.com/ConsumerAccess/v1-devportal/Patient/A00000000000005</a></p>",
        "id": 217215722,
        "sender_full_name": "James Kizer",
        "timestamp": 1605745755
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"365368\">@James Kizer</span> We ran into an issue with our gateway,  We are hoping it will be back up later this morning.</p>",
        "id": 217253629,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605783202
    },
    {
        "content": "<p>We have resolved our 502 error. Should be good to go now.</p>",
        "id": 217274936,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605795607
    },
    {
        "content": "<p>Connected successfully and got data, here is on our app:</p>\n<p><a href=\"/user_uploads/10155/lVswgnB9vATnSU386uQ5bHrs/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/lVswgnB9vATnSU386uQ5bHrs/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/lVswgnB9vATnSU386uQ5bHrs/image.png\"></a></div>",
        "id": 217299411,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605805371
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197108\">@Jason Teeple</span> : there is a mismatch in the ids though:</p>\n<p><a href=\"/user_uploads/10155/RdVKyPQkknLxUJWyeg2KL9zF/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/RdVKyPQkknLxUJWyeg2KL9zF/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/RdVKyPQkknLxUJWyeg2KL9zF/image.png\"></a></div>",
        "id": 217301551,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605806268
    },
    {
        "content": "<p>We add a slug when there are multiple backend FHIR servers</p>",
        "id": 217303258,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605806999
    },
    {
        "content": "<p>Is the slug causing validation issues on your side?</p>",
        "id": 217303329,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605807016
    },
    {
        "content": "<p>It is not valid FHIR...</p>",
        "id": 217304623,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605807609
    },
    {
        "content": "<p>(and causes our client to read all the encounters twice, because we cache them but they cannot be found under their ids)</p>",
        "id": 217304747,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605807667
    },
    {
        "content": "<p>Let me take a look.</p>",
        "id": 217305561,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605808028
    },
    {
        "content": "<p>I will have to work with the team and see how they can resolve.  Thanks for the feedback.</p>",
        "id": 217307010,
        "sender_full_name": "Jason Teeple",
        "timestamp": 1605808679
    }
]