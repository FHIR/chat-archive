[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"335936\">@Daniel Venton</span>  The Optum CapabilityStatement, <a href=\"https://flexdev-eastus.optum.com/R4/metadata\">https://flexdev-eastus.optum.com/R4/metadata</a>, doesn't include the OAuth endpoint URLs. Alternatively, there is also no .well-known/smart-configuration link.</p>",
        "id": 209674335,
        "sender_full_name": "Amy Ballard",
        "timestamp": 1599756018
    },
    {
        "content": "<p>Apparently Optum server requires PKCE to connect, but if I am not mistaken that's now what the SMART standard (that CARIN BB compliant server should support) require</p>",
        "id": 209702445,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599768472
    },
    {
        "content": "<p>PKCE is only for apps which can't maintain a client_secret. The smart flow is pretty vague about what to do for public apps in the token step: <a href=\"http://hl7.org/fhir/smart-app-launch/index.html#step-3-app-exchanges-authorization-code-for-access-token\">http://hl7.org/fhir/smart-app-launch/index.html#step-3-app-exchanges-authorization-code-for-access-token</a></p>",
        "id": 209705900,
        "sender_full_name": "Benjamin Langley",
        "timestamp": 1599770345
    },
    {
        "content": "<p>...our is not a public app, we have a server where we keep the secrets</p>",
        "id": 209706293,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599770546
    },
    {
        "content": "<blockquote>\n<p>smart flow is pretty vague about what to do for public apps in the token step</p>\n</blockquote>\n<p>I don't think the spec is vague: we say \"For public apps, authentication is not possible (and thus not required)\".</p>",
        "id": 209706356,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599770586
    },
    {
        "content": "<p>Public clients can't and don't authenticate when trading and authorization code for a token.</p>",
        "id": 209706389,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599770604
    },
    {
        "content": "<p>So is requiring PKCE for all client non-compliant?</p>",
        "id": 209706559,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599770689
    },
    {
        "content": "<p>Requiring PKCE wouldn't be compliant, because clients following the SMART App Launch IG wouldn't be able to get a token; I'd recommend using <a href=\"https://inferno.healthit.gov/\">https://inferno.healthit.gov/</a> supports testing the SMART App Launch spec.</p>",
        "id": 209706830,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599770810
    },
    {
        "content": "<p>You could add PKCE as an option for clients to opt into.</p>",
        "id": 209706953,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599770881
    },
    {
        "content": "<p>(In general, you can also get relevant protections on mobile platforms with app-claimed URLs.)</p>",
        "id": 209707302,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599771041
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"238353\">@Mark Roberts</span> <span class=\"user-mention\" data-user-id=\"192132\">@Amol Vyas</span>   Optum is not an EHR (we represent Payers) and we are implementing the CARIN BB IG for CMS interoperability and patient access API. What exact conformance statement in the IG prevents us from requiring PKCE to authenticate? PKCE can be implemented in the client app, if they choose to do so. Our institutional policy dictates usage of PKCE for access to PHI. We feel that PKCE is a suitable implementation of the secret requirement. From the SMART App Launch Framework IG section 1, \"This profile does not dictate the institutional policies that are implemented in the authorization server.\"</p>",
        "id": 209713311,
        "sender_full_name": "Daniel Venton",
        "timestamp": 1599774103
    },
    {
        "content": "<p>To be clear, if you want to be compatible with the SMART App Launch IG, you'll want to make sure your server works according to the specification and passes the test suite. Requiring additional parameters means breaking clients that conform to the IG.</p>",
        "id": 209736817,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599793366
    },
    {
        "content": "<p>You can allow clients to opt into PKCE, but that's different from breaking clients that don't use PKCE.</p>",
        "id": 209736833,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599793425
    },
    {
        "content": "<p>The SMART App Launch IG is a requirement from CMS (they refer to specific standards adopted by ONC, including SMART).</p>\n<p>The requirement to support SMART should also be spelled out in the CARIN Blue Button IG, to avoid any confusion.</p>",
        "id": 209736945,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1599793584
    },
    {
        "content": "<p>It is: 'Client applications and systems of record SHALL support the standalone launch sequence of the SMART App Launch framework' (from <a href=\"http://build.fhir.org/ig/HL7/carin-bb/Authorization_Authentication_and_Registration.html#smart-on-fhir-application-launch\">http://build.fhir.org/ig/HL7/carin-bb/Authorization_Authentication_and_Registration.html#smart-on-fhir-application-launch</a>)</p>",
        "id": 209772945,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599826878
    },
    {
        "content": "<p>we want to modify this slightly to also call out a SHALL requirement for launch/Patient scope and a MAY requirement for User scope.</p>",
        "id": 209783769,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1599832655
    }
]