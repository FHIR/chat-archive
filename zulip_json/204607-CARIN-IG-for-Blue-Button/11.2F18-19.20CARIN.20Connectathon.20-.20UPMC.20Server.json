[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246928\">@josh lamb</span> could you register our client on your server? Name CareEvolution, redirect URLs <br>\n<a href=\"https://myfhr.careevolution.com/cfhrprovideraccounts/redirecttarget\">https://myfhr.careevolution.com/cfhrprovideraccounts/redirecttarget</a><br>\n<a href=\"http://localhost/WebClientTest.Adapter1.WebClient/cfhrprovideraccounts/redirecttarget\">http://localhost/WebClientTest.Adapter1.WebClient/cfhrprovideraccounts/redirecttarget</a> ?</p>",
        "id": 217141501,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605709991
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> will you be sending a client_secret or will you be sending a code challenge (PKCE)?</p>",
        "id": 217142250,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605710323
    },
    {
        "content": "<p>Client secret</p>",
        "id": 217142594,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605710465
    },
    {
        "content": "<p>Got it, will PM you shortly when application is registered.</p>",
        "id": 217143081,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605710676
    },
    {
        "content": "<p>Registered and can login, but then I got a 500 trying to retrieve the token</p>",
        "id": 217146450,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605712071
    },
    {
        "content": "<p>The response body is </p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;message&quot;: &quot;Unknown error. Please contact your system administrator&quot;,\n    &quot;errors&quot;: []\n}\n</code></pre></div>",
        "id": 217146554,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605712100
    },
    {
        "content": "<p>can you send me your post command to the token endpoint, with the body?</p>",
        "id": 217146613,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605712132
    },
    {
        "content": "<p>Response headers: <br>\nRequest-Context :  appId=cid-v1:5d6547b3-3149-424f-9022-ae624cd65780<br>\ntracestate :  cid-v1:5d6547b3-3149-424f-9022-ae624cd65780</p>",
        "id": 217146639,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605712145
    },
    {
        "content": "<p>Here is the body:</p>\n<div class=\"codehilite\"><pre><span></span><code>grant_type=authorization_code&amp;redirect_uri=https%3A%2F%2Fmyfhr.careevolution.com%2Fcfhrprovideraccounts%2Fredirecttarget&amp;code=eyJraWQiOiJUcE4taldPZ216VWMxTjB5OHY2b3Rqa25lNlRGdlJ1Sm9nazB1akJwUmtFIiwidmVyIjoiMS4wIiwiemlwIjoiRGVmbGF0ZSIsInNlciI6IjEuMCJ9.Axfo5Hr08-rfSScujBJdXBKUn021enX02y353Oogae6tQXFX9NBSQEUZQQSVFdBitazEjNNs6KQnLy7Odvv2zO5eztaCjkcDGd1D_9hMz61e5dhI5E_moww6gTmrBu34gf5J33SGqAo-Sf34eb-NX9fz2XQ9v174Yb-tqK5Jybr8InWAOXObFiRDg-G0lxfouICMN5IGh6TA3yhRjnklGJ3eoQ2YsQmjjLcLmGwli-ps8Or0QAjY5DGClVjM5druxsFphD7gM8qjlXUaMKn3MjHpONjqpqhsPHcWOCokJ9qD8QVOgms9WemE7IWW-UAL-JZzcCX_fFNb_tsiBg4c5A.k5AveE3B6XV4Qx0a.mTaM2gVO4v9M4nr7GQkvMIz6DtbXyBYaL56ZGYq4nhtqrzbXHpooS4kd7ytjjuKTd5mCeocj43eIfntIPyPoDgyfxIKJC419a2FrPni0HDgFZme3Qd3yKyI7Ibx74yvIyVfpD7b7UlfQAkYY_rKDcZPHKQ5YfnBYFTZUdNvcxCpQXSJJeFZUDyZflwW8BWttjQ34cuhT8OGOTqhKeBX-j9lkfjnAJnIswfMGlbPLenX6qC9vK8uxJZEqW2ozuVfnxPRoEBsdlPkUuH3hB21normgYZye7QXsiLhcCliaZQL4CDLBm3PJ8mH217lD6PJcQn-xQLtZhW70F5pXgYorpF_B0SW0v8Dl6tIXvY-lK8JiSjVoHHvtU-CmRvaS-0aWl1vifSFA17tnQaNsyqIYrcz8uVvQJDwtCt6SKWhS9wUF8yo8dsymGukeILfLMLUnkpPg8LfvhNSGK2MGLIzo8MllC5Z3gpWyQkpWXAvmJ27QD1zALmCX7OWW_bWFuxgsEYGn6hjyFYEocEVPVPoMUbFIW8_BHUTG4EN1DP0IskQya0BTpMw5z-ovB-c4KxdJkjj-8TvcWpyvxpfhzYTgFcMuvCB7urUMY7hSvxa0HbzxD8UDIszDfLcoEudteHMpDdFbL5QSoxoPdqgOg79VP41zn-GVLgOwZ8_ENkCX1JXJYSs3MgTrfUNSLiFGWE9Un-4LNydqrGRYF8-vtcte4L22YbDmCY7327_ZiCK32n9nbenGM2maRQeb2vvIJdE6rnE7V1oWMyrl85TTshrbjdTRE4an7MScs0kCvEoLMUcJD1S3BtStMZwwLnnpCY92LSoNRCOSnIEq8ITLUUZkXgZybPgP5fP8GzQtV6SuKtT-EHaAH9stSi1wwHlJJ7UT8UQgVLboo8HuQLLSIow.En0EKtWYLr-rHbg2bG9b5Q\n</code></pre></div>",
        "id": 217146699,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605712172
    },
    {
        "content": "<p>I am expecting a basic auth header of a base64 encoded string that will have this format \"{client_Id}:{client_secret}\" if you are including the client secret as part of the auth header. I do not see the secret in the body you posted.</p>",
        "id": 217147166,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605712357
    },
    {
        "content": "<p>Here are the request headers:</p>\n<div class=\"codehilite\"><pre><span></span><code>Accept :  application/json\nAuthorization :  Basic NzExMTVkYmUtNWMwYS00Zjk1LTg4OGYtZGFiM2Q0Yzc3ODJmOjk1NzhuOUJmd2ZRNk03fm52a1N+d01LWTVCcC14fi5Xflo=\nContent-Type :  application/x-www-form-urlencoded\nContent-Length :  1549\n</code></pre></div>",
        "id": 217147318,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605712429
    },
    {
        "content": "<p>I was expecting the client_id to also be included in the post body. Is this not standard? I can pull this from the auth header when present instead...</p>",
        "id": 217148034,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605712722
    },
    {
        "content": "<p>Don't believe that's standard, but I have a setting for that on our client</p>",
        "id": 217148856,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605713034
    },
    {
        "content": "<p>Okay, let me know if that works. I will add logic to account for client_id in header.</p>",
        "id": 217149066,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605713118
    },
    {
        "content": "<p>Yes, I can connect now with the client id in the body. Getting errors on the data, looking into that</p>",
        "id": 217151186,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605713899
    },
    {
        "content": "<p>Coverage resources contain an invalid beneficiary reference:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;beneficiary&quot;: {\n    &quot;reference&quot;: &quot;88800307601&quot;\n  },\n</code></pre></div>",
        "id": 217151890,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605714187
    },
    {
        "content": "<p>Good catch, fix for both of the issues you identified are now live in Sandbox <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span></p>",
        "id": 217153508,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605714827
    },
    {
        "content": "<p>OK, it works now, but there are three missing Practitioner: ExamplePractitioner1, ExamplePractitioner2, ExamplePractitioner4</p>",
        "id": 217160818,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605717398
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191912\">Michele Mottini</span> <a href=\"#narrow/stream/204607-CARIN-IG.20for.20Blue.20Button.C2.AE/topic/11.2F18-19.20CARIN.20Connectathon.20-.20UPMC.20Server/near/217148856\">said</a>:</p>\n<blockquote>\n<p>Don't believe that's standard, but I have a setting for that on our client</p>\n</blockquote>\n<p><a href=\"https://tools.ietf.org/html/rfc6749\">https://tools.ietf.org/html/rfc6749</a></p>\n<p>2.3.1.  Client Password</p>\n<p>Clients in possession of a client password MAY use the HTTP Basic<br>\n   authentication scheme as defined in [RFC2617] to authenticate with<br>\n   the authorization server.  The client identifier is encoded using the<br>\n   \"application/x-www-form-urlencoded\" encoding algorithm per<br>\n   Appendix B, and the encoded value is used as the username; the client<br>\n   password is encoded using the same algorithm and used as the<br>\n   password.  The authorization server MUST support the HTTP Basic<br>\n   authentication scheme for authenticating clients that were issued a<br>\n   client password.</p>\n<p>For example (with extra line breaks for display purposes only):</p>\n<div class=\"codehilite\"><pre><span></span><code> Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3\n</code></pre></div>\n\n<p>Alternatively, the authorization server MAY support including the<br>\n   client credentials in the request-body using the following<br>\n   parameters:</p>\n<p>client_id<br>\n         REQUIRED.  The client identifier issued to the client during<br>\n         the registration process described by Section 2.2.</p>\n<p>client_secret<br>\n         REQUIRED.  The client secret.  The client MAY omit the<br>\n         parameter if the client secret is an empty string.</p>\n<hr>\n<p>So in the auth header is standard, with being in the body is optional.</p>\n<p><span class=\"user-mention\" data-user-id=\"246928\">@josh lamb</span>  <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span></p>",
        "id": 217161075,
        "sender_full_name": "Ryan Conley",
        "timestamp": 1605717493
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191912\">Michele Mottini</span> <a href=\"#narrow/stream/204607-CARIN-IG.20for.20Blue.20Button.C2.AE/topic/11.2F18-19.20CARIN.20Connectathon.20-.20UPMC.20Server/near/217160818\">said</a>:</p>\n<blockquote>\n<p>OK, it works now, but there are three missing Practitioner: ExamplePractitioner1, ExamplePractitioner2, ExamplePractitioner4</p>\n</blockquote>\n<p>What includes did you run, \"*\" or care-team?</p>",
        "id": 217162972,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605718190
    },
    {
        "content": "<p>No includes, I am looking at the references in the resources and go get them individually</p>",
        "id": 217163585,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605718430
    },
    {
        "content": "<p>Got it, we found issue. Fix is incoming.</p>",
        "id": 217164718,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605718898
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191912\">Michele Mottini</span> <a href=\"#narrow/stream/204607-CARIN-IG.20for.20Blue.20Button.C2.AE/topic/11.2F18-19.20CARIN.20Connectathon.20-.20UPMC.20Server/near/217163585\">said</a>:</p>\n<blockquote>\n<p>No includes, I am looking at the references in the resources and go get them individually</p>\n</blockquote>\n<p>Sorry about that and thanks for bringing it to our attention. A fix is currently deploying, so it should be rectified in our sandbox in 15 minutes or so.</p>\n<p>Edit: Fix is live.</p>",
        "id": 217170702,
        "sender_full_name": "Ryan Conley",
        "timestamp": 1605721410
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246928\">@josh lamb</span> do you have the reference to the includes \"*\" in the FHIR spec? It seems not all servers are supporting this?</p>",
        "id": 217188044,
        "sender_full_name": "Tone Southerland",
        "timestamp": 1605729298
    },
    {
        "content": "<p><a href=\"https://build.fhir.org/ig/HL7/carin-bb/branches/v0.1.11/CapabilityStatement-c4bb.html#resource--details\">https://build.fhir.org/ig/HL7/carin-bb/branches/v0.1.11/CapabilityStatement-c4bb.html#resource--details</a> the table will list the includes and searches that are in scope for CARIN IG. I have interpreted \"*\" to indicate that all references should be resolvable within the bundle.</p>",
        "id": 217190016,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605730214
    },
    {
        "content": "<p>Re: client_id, SMART is specific and prescriptive here beyond what the base OAuth spec says: <a href=\"http://hl7.org/fhir/smart-app-launch/#step-3-app-exchanges-authorization-code-for-access-token\">http://hl7.org/fhir/smart-app-launch/#step-3-app-exchanges-authorization-code-for-access-token</a></p>\n<blockquote>\n<p>Required [as a POST body param] for public apps. Omit for confidential apps</p>\n</blockquote>",
        "id": 217190794,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1605730611
    },
    {
        "content": "<p>Hey, thanks for the feedback <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> .</p>",
        "id": 217192528,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605731424
    },
    {
        "content": "<p>Tried again and it worked nicely, here is the data in our app:</p>\n<p><a href=\"/user_uploads/10155/bN7_1ZHqUEvBFFT0q5hHOo_-/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/bN7_1ZHqUEvBFFT0q5hHOo_-/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/bN7_1ZHqUEvBFFT0q5hHOo_-/image.png\"></a></div>",
        "id": 217198417,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605734542
    },
    {
        "content": "<p>Attempt to refresh the access token failed with a 500 though. Request body:</p>\n<div class=\"codehilite\"><pre><span></span><code>grant_type=refresh_token&amp;refresh_token=eyJraWQiOiJUcE4taldPZ216VWMxTjB5OHY2b3Rqa25lNlRGdlJ1Sm9nazB1akJwUmtFIiwidmVyIjoiMS4wIiwiemlwIjoiRGVmbGF0ZSIsInNlciI6IjEuMCJ9.j7_08kqZNZ4RbHMsMlCk2U8ms1xzM3PWA54qtNTFEqbL3iqnKO0rZc4OP1VZmkYE3vVqjPWfB7osM_-4hsAPpKugmyD3kARnwbUI1uy7KMvbvYGDvSQz0vYGTr1dqo6FYVkG1pfsE8C_1bp34dfClN92zZumfCVpqRKvwXEu1S4B1jzVoDHAo5UphciaJ9MwJJkzlK4nLo9P8ZzZR9C79-dEXVmTFn5Riwv2Tt9ukTGxP7pblKjhhzCrdFAEoYMY3ZBCxT7J9SlySVTC9UEQRoWKNyMv0KOeJT3xiuQW9ezEYqVGkMZb7bwDz-wpL95wyLZoKe91xeh8LU6CJsWcBg.8YcpQhz7Ggeq3GjF.MJs-a-UnBH3b1NowOYKrwaBO5pw5j2DJK5qGeQubGR_qfK_83hD0IcWsMyJ50RlGN5NFs-dv1QVBwjztWvuHsOSGktERRiaKXQTx5JBl766tiFRPGyYvQiVFvZDYa5v0UJ9H7G-hMGptiWku9FZTBFPVm8yqSzwCcMtdQe16NsOFHuRrHToJOLigxRo1hVmd3ftnkyTgGoAVqfMl2WXprC5XKvTkSV5f-Ut0uquhuqyGwdcUKqkzjVZfH7s4qBHhticx2C8Pv8ayLUEcu_8eMyECGRIH2_s_UOx_qixXDbSXGxAgmSFxyGrqhEhDBq8uF4akskUDnE1ImIJ6agSi7L7mmh29-Bea5_SglM2zri933WaSLr9M73PYNI0PkoN4qKqQ6AfmaAblcIUt1oSmDJZEl3E6gI2_Sfc_CZ3B8GrbkI4f_JAWQ7G44J4TFa_DpkFVg4ymBL2yN4KDTs6aSub0JFVml1X8tlVmSwpwT-H7XAQ6V2J4okGcPpASXNnTl5gktKOBl1Gc8GliTfHcuqg-22zLGMKRudMYlPTrJ9QJAtPvqaDjUwJt4wn_reG1jm5LY27IVrNFyKmIWjfvsa9Gei9cpzBdJMQoSzUaDGYDZ9S0KNniXyvPaKjSEczRVWLK5mWd3sdgzxrF60pG3CK1ekyrzqIoOvHPWDzfCfDHQutyOXUBG78yVk5dh7Kh-zL_fb8xnOiR2PVr9yZl8t40UOPudnwY4ejTEX4zyGo5vEfMQrtTpwBpiQPRXZ5Wl51KGsBlrNGAJPf2P9OpG_iauXu4MVyIIGyCmOKYSHIsLnLq5BYtcerGWtzyZUzFXrTSMrvR0IPTqcjca3GW30UGC6GGuMXrzWWWCbPYk_gpnklYaNd0WS6FveLNEkz-_zCqNoOoTGtA9SjyGwzC2ADEs_ojrEw5s1c.WMIof8sFmdJTwnjlr8NnBw\n</code></pre></div>",
        "id": 217198668,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605734656
    },
    {
        "content": "<p>Headers:<br>\nAccept :  application/json<br>\nAuthorization :  Basic NzExMTVkYmUtNWMwYS00Zjk1LTg4OGYtZGFiM2Q0Yzc3ODJmOjk1NzhuOUJmd2ZRNk03JTdlbnZrUyU3ZXdNS1k1QnAteCU3ZS5XJTdlWg==<br>\nContent-Type :  application/x-www-form-urlencoded<br>\nContent-Length :  1478</p>",
        "id": 217198693,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605734669
    },
    {
        "content": "<p>Response body:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;message&quot;: &quot;Unknown error. Please contact your system administrator&quot;,\n    &quot;errors&quot;: []\n}\n</code></pre></div>",
        "id": 217198724,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605734688
    },
    {
        "content": "<p>Possibly because there is no client_id in the body?</p>",
        "id": 217198812,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605734734
    },
    {
        "content": "<p>Can anyone join the breakout channel as an application developer so that we can see how the UPMC Health Plan sandbox data displays?</p>",
        "id": 217198860,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605734759
    },
    {
        "content": "<p>I am joining (or trying to)</p>",
        "id": 217199214,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605734947
    },
    {
        "content": "<p>CareEvolution production app: <a href=\"https://myfhr.careevolution.com\">https://myfhr.careevolution.com</a> - or look for 'MyFHR' in Apple Store or Google Play</p>",
        "id": 217200459,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605735706
    },
    {
        "content": "<p>And yes, there is a problem on our side: we did non import correctly the amounts, so they are not displayed</p>",
        "id": 217201676,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605736428
    },
    {
        "content": "<p>Hello, Would anyone like to jump into room 3 to connect with UPMC?</p>",
        "id": 217283597,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1605799249
    },
    {
        "content": "<p>...if the token request has the wrong client secret the server returns a 500 - should return a 400 with some error description in the body (see OAuth2 specs)</p>",
        "id": 217335027,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1605822451
    },
    {
        "content": "<p>Alignment with OAuth2 Http Status Codes and error details will be available at next Connectathon. </p>\n<p>Regarding the issue with the token refresh, it appears that the provided authorization header is not encoded correctly: </p>\n<p>What you provided above is encoded as: <br>\n71115dbe-5c0a-4f95-888f-dab3d4c7782f:9578n9BfwfQ6M7%7envkS%7ewMKY5Bp-x%7e.W%7eZ<br>\nWe are expecting: <br>\n71115dbe-5c0a-4f95-888f-dab3d4c7782f:9578n9BfwfQ6M7~nvkS~wMKY5Bp-x~.W~Z<br>\n('~' is showing as '%7e')</p>\n<p>Thanks <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span></p>",
        "id": 217805426,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1606247722
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246928\">@josh lamb</span> encoding the secret is correct: 'The client identifier is encoded using the<br>\n   \"application/x-www-form-urlencoded\" encoding algorithm per<br>\n   Appendix B, and the encoded value is used as the username; the client<br>\n   password is encoded using the same algorithm and used as the<br>\n   password. ' <a href=\"https://tools.ietf.org/html/rfc6749#section-2.3.1\">https://tools.ietf.org/html/rfc6749#section-2.3.1</a></p>",
        "id": 217815748,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1606253224
    }
]