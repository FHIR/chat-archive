[
    {
        "content": "<p>Right now we hold on to built branches forever; we replace a built branch whenever new content is committed to that branch on github. I want to make sure we don't run out of storage; for now I'll just increase our storage so we have headroom. But in general, what requirements do folks have for retaining old builds, and what should we try to do here?</p>",
        "id": 210402816,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600355050
    },
    {
        "content": "<p>I'd like to have a policy for IG builds similar to core FHIR builds -- where we delete builds for branches that have been inactive for &gt;XX days, where \"XX\" is some window we agree on (e.g., 90).</p>",
        "id": 210402890,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600355098
    },
    {
        "content": "<p>90 days for \"my\" branches seems good. Do you want to add a way to force stale branches to be kept?</p>",
        "id": 210403339,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1600355288
    },
    {
        "content": "<p>Re: indefinite retention, I kind  of don't mind having some friction here (like, maybe <a href=\"http://build.fhir.org\">build.fhir.org</a> is the wrong place if you need indefinite retention for some builds, and there are other options like Github pages, etc). Would like to hear if folks here would find this overly constraining, though.</p>",
        "id": 210404162,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600355636
    },
    {
        "content": "<p>I'm not sure why we would need infinite retention on Build.  If you haven't STU'd it in a year, it gets archived.  If you want it back up, push a change.</p>",
        "id": 210404556,
        "sender_full_name": "David Pyke",
        "timestamp": 1600355730
    },
    {
        "content": "<p>I can imagine that some branches are not picked up within that time, and this would be a way to say \"we are stiiiiiill working on it, see lates t branch there\"...</p>",
        "id": 210406747,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1600356636
    },
    {
        "content": "<p>If you've not updated or STU'd in a year then \"still working on it\" is a misnomer</p>",
        "id": 210407008,
        "sender_full_name": "David Pyke",
        "timestamp": 1600356777
    },
    {
        "content": "<p>(i was thinking of 90 days - for me it's a fine deadline, but time not being a linear concept esp. in pandemic season...)</p>",
        "id": 210407184,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1600356866
    },
    {
        "content": "<p>So... maybe a 365-day window?</p>",
        "id": 210407202,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600356876
    },
    {
        "content": "<p>THat's my thought</p>",
        "id": 210407218,
        "sender_full_name": "David Pyke",
        "timestamp": 1600356885
    },
    {
        "content": "<p>Anyway, I just mentioned the possible stale branches as an edge case. I'm happy with 90 or 365 days</p>",
        "id": 210407298,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1600356934
    },
    {
        "content": "<p>It's always possible to re-trigger / reset the retention window with a trivial commit on the branch</p>",
        "id": 210407517,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600357027
    },
    {
        "content": "<p>Right, but inactivity for 365 gets it archived.  Did we want to do it at the branch level or just for whole projects?</p>",
        "id": 210407635,
        "sender_full_name": "David Pyke",
        "timestamp": 1600357076
    },
    {
        "content": "<p>I think people would be more comfortable with a shorter timeframe if there was an emailed warning of impending expiry.  However, agree w/ David that if you want semi-permanent hosted content, <a href=\"http://build.fhir.org\">build.fhir.org</a> shouldn't be your solution.</p>",
        "id": 210407786,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1600357130
    },
    {
        "content": "<p>Branch level makes sense to me in terms of storage requirements; active projects might have hundreds of branches over the course of a year, each of which takes up hundreds of megs for output storage.</p>",
        "id": 210408595,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600357454
    },
    {
        "content": "<p>Maybe we do branches at 90 days, projects at 365?</p>",
        "id": 210408714,
        "sender_full_name": "David Pyke",
        "timestamp": 1600357507
    },
    {
        "content": "<p>I kinda like that</p>",
        "id": 210408736,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600357520
    },
    {
        "content": "<p>I had thought that it was  90 days.. I recall builds being flushed, was that last year? things change so fast   90 seems shortest possible, 365 does not feel too long. so anywhere in between seems right</p>",
        "id": 210461488,
        "sender_full_name": "John Moehrke",
        "timestamp": 1600383468
    },
    {
        "content": "<p>when this flush happens, a note to the committers/notifications would be 'nice'</p>",
        "id": 210461545,
        "sender_full_name": "John Moehrke",
        "timestamp": 1600383499
    },
    {
        "content": "<p>I wonder if 14  day pre-flush notification might be useful... giving people a chance to quickly grab it before it is gone</p>",
        "id": 210461572,
        "sender_full_name": "John Moehrke",
        "timestamp": 1600383535
    },
    {
        "content": "<p>We do clean up branches for the core fhr specification, but we don't clean up the branches for implementation guide builds. (We only started building branches for implementation guides relatively recently; before that only the master branch was auto-built for IG repositories.)0</p>",
        "id": 210470445,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600392177
    },
    {
        "content": "<p>It would be nice to have a consistent policy for the core build as well as IGs, just so editors participating in both camps don't have to keep different models in their heads</p>",
        "id": 210470463,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1600392215
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> - Sorry if missed another update, but I happened upon this old thread. Was an automated clean up of old/stale branches for IGs ever implemented? For our <a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/branches/\">IG</a>, we have several old branches still hanging around.</p>",
        "id": 257778458,
        "sender_full_name": "Kevin Power",
        "timestamp": 1634339018
    },
    {
        "content": "<p>No, I haven't pulled the trigger on this. (If this is causing an issue and you want me to manually delete anything just let me know.)</p>",
        "id": 257779709,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1634339795
    },
    {
        "content": "<p>No specific issues right now, just wanting to help eliminate possible confusion down the road (if someone mistakenly looks like the old branch without realizing it). Let me ask around on my side and see if we want to do a manual delete at some point. Thanks <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span></p>",
        "id": 257780921,
        "sender_full_name": "Kevin Power",
        "timestamp": 1634340714
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> - If you don't mind, can you delete the following from <a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/branches/\">http://build.fhir.org/ig/HL7/genomics-reporting/branches/</a> :<br>\njrj-jira-pending<br>\nkp-improve-names<br>\nkp-loinc-copyright<br>\nkp-qa<br>\nkp-simple-updates<br>\nkp-task-category-changes<br>\nkpower_SomaticImplication</p>",
        "id": 258095635,
        "sender_full_name": "Kevin Power",
        "timestamp": 1634589317
    },
    {
        "content": "<p>Done</p>",
        "id": 258098014,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1634590265
    },
    {
        "content": "<p>Thanks Josh</p>",
        "id": 258098522,
        "sender_full_name": "Kevin Power",
        "timestamp": 1634590468
    },
    {
        "content": "<p>Per discussion here, I'm going to start enforcing \"IG branches &gt;90 days old will be cleared from the build server\".</p>",
        "id": 269880479,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643481126
    },
    {
        "content": "<p>Any new commits will revive them...</p>",
        "id": 269880486,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643481137
    },
    {
        "content": "<p>did this cleanup kill things like templates -- ihe.fhir.template -- that really don't change much?</p>",
        "id": 269887713,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643489167
    },
    {
        "content": "<p>If they're on the build server in stale branches, yes. That \"shouldn't\" cause problems, but if it did we can:</p>\n<ol>\n<li>\n<p>Trigger a build on any of this content via <a href=\"https://fhir.github.io/auto-ig-builder/builds.html\">https://fhir.github.io/auto-ig-builder/builds.html</a> (looks like you may have already done so for IHE templates</p>\n</li>\n<li>\n<p>Figure out a process to ensure this server isn't used for dependencies in the future (Grahame I <em>think</em> has a way to use his package server for dependencies, instead of <a href=\"http://build.fhir.org\">build.fhir.org</a>)</p>\n</li>\n</ol>",
        "id": 269890366,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643492164
    },
    {
        "content": "<p>I rebuilt the template, then rebuilt my IG... all better now.</p>",
        "id": 269897044,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643500804
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> , is that \"all branches will be cleared,\" or all except main/master?</p>",
        "id": 269906965,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1643513475
    },
    {
        "content": "<p>All branches; the expectation is that the CI server is a place to review active work (whether \"main\" or otherwise) -- but of course we can revisit this.</p>",
        "id": 269972911,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643595985
    },
    {
        "content": "<p>I think that the main/master branch should always remain.  We link to it as the CI-build from the archive pages.  We don't want that to go 'poof'.  The only time we <em>might</em> consider removing those is if we retire the spec.</p>",
        "id": 269974916,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643598438
    },
    {
        "content": "<p>I think some main/master branches are experiments, and not formal projects. Somehow we need to identify the formal ci-builds, or give experimenters a way to tell us that they want their experiment to be removed.</p>",
        "id": 270029241,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643635189
    },
    {
        "content": "<p>There's a long tail of experiments indeed.</p>",
        "id": 270036651,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643638252
    },
    {
        "content": "<p>I also thought about some of my experiments were to point out an issue with IG builder or templating. Needed them to build on ci-build to be visible, but they certainly don't need to live forever. (Presumably fragments become validation examples for IG builder).</p>",
        "id": 270036857,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643638330
    },
    {
        "content": "<blockquote>\n<p>I think that the main/master branch should always remain.  We link to it as the CI-build from the archive pages.  We don't want that to go 'poof'.  The only time we <em>might</em> consider removing those is if we retire the spec.</p>\n</blockquote>\n<p>Maybe this applies to HL7 published specs? We could perhaps have a query to a package server to fetch a list of those. Even so, if a spec is not under active development, the \"continuously\" integration doesn't have much meaning</p>",
        "id": 270036900,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643638349
    },
    {
        "content": "<p>it also applies to others (IHE for sure)</p>",
        "id": 270036939,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643638368
    },
    {
        "content": "<p>maybe the auto-ig-builder dashboard just needs a \"delete\" button? hmm, the only danger is someone deletes a ci-build that is needed, for which that ci-build gets rebuilt by someone in-the-know.</p>",
        "id": 270037103,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643638443
    },
    {
        "content": "<p>yeah, bad idea for a security co-chair to be recommending that solution.</p>",
        "id": 270037154,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643638457
    },
    {
        "content": "<p>So maybe it applies to published specs; again this takes us back to the discussion about dependencies on CI: we'd need a  formal mapping from package names to GitHub projects (e.g., in the package server -- do we population <code>repository</code> in package.json?) ( the CI system can't \"trust\" values it sees in repos, since anyone could create them.. )</p>",
        "id": 270037273,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643638528
    },
    {
        "content": "<p>so the simplifier registry should have that</p>",
        "id": 270037418,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643638586
    },
    {
        "content": "<p>I'd like to discuss whether a well crafted 404 page on <a href=\"http://build.fhir.org\">build.fhir.org</a> could help us avoid perceived requirements here. We csn take this up in FMG this week perhaps?</p>",
        "id": 270037550,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1643638648
    },
    {
        "content": "<p>drat, there is no linkage. I thought that the repo ended up in the published IG json.</p>",
        "id": 270038169,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643638886
    },
    {
        "content": "<p>it is somewhat indirectly recorded in the IHE IGs, as we use the somewhat undocumented input/data/features.yaml to enable github based issue submission.</p>",
        "id": 270038320,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643638937
    },
    {
        "content": "<p>I would expect there would be some github repo homes that we could itemize like HL7 and IHE? I would suspect in those there is no throwaway examples of important?</p>",
        "id": 270041158,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643640028
    }
]