[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> the build seems to have failed completely right now, and it's a big problem. There are two problems:</p>\n<ul>\n<li>US-Core-R4 has been rebuilt plenty recently, but the summary page shows it's last rebuild as more than a month ago</li>\n<li>the build started failing completely overnight. It doesn't look to me like it's my part</li>\n</ul>",
        "id": 168537232,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560971756
    },
    {
        "content": "<p>here's a log:</p>",
        "id": 168537234,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560971758
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>INFO:root:about to clone!\nDEBUG:root:running: git clone --recursive https://github.com/esource-consortium/fhir-clinical-research --branch master repo\nDEBUG:root:Time to deadline 1679.996293 seconds\nCloning into &#39;repo&#39;...\nDEBUG:root:running: wget -q https://github.com/FHIR/latest-ig-publisher/raw/master/org.hl7.fhir.publisher.jar -O publisher.jar\nDEBUG:root:Time to deadline 1678.774739 seconds\nDEBUG:root:running: java -Xms4550m -Xmx4550m -jar ../publisher.jar -ig ig.json -auto-ig-build -target https://build.fhir.org/ig/esource-consortium/fhir-clinical-research/ -out /scratch/ig-build-temp-NS3CM8/repo\nDEBUG:root:Time to deadline 1676.84361 seconds\nFHIR Implementation Guide Publisher Version 0.9.37-SNAPSHOT - Built 2019-06-19T22:13:33.882+10:00 - Git c8dbdc48a05f\nDetected Java version: 12.0.1 from /usr/java/openjdk-12 on amd64 (64bit). 4398MB available\nRun time = Wednesday, June 19, 2019 at 4:59:40 PM Coordinated Universal Time\n[/scratch/ig-build-temp-NS3CM8/repo] -ig ig.json -auto-ig-build -target https://build.fhir.org/ig/esource-consortium/fhir-clinical-research/ -out /scratch/ig-build-temp-NS3CM8/repo\nPackage Cache: var/lib/.fhir/packages\nLoad Configuration from /scratch/ig-build-temp-NS3CM8/repo/ig.json               (00.0038sec)\nRedirecting to Configuration from /scratch/ig-build-temp-NS3CM8/repo/src-generated/cr-core-ig.json (00.0057sec)\nPublishing Content Failed: /scratch/ig-build-temp-NS3CM8/repo/src-generated/cr-core-ig.json (No such file or directory) (00.0057sec)\n                                                                                 (00.0057sec)\nUse -? to get command line help                                                  (00.0057sec)\n                                                                                 (00.0057sec)\nStack Dump (for debugging):                                                      (00.0058sec)\njava.io.FileNotFoundException: /scratch/ig-build-temp-NS3CM8/repo/src-generated/cr-core-ig.json (No such file or directory)\n    at java.base/java.io.FileInputStream.open0(Native Method)\n    at java.base/java.io.FileInputStream.open(FileInputStream.java:213)\n    at java.base/java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:155)\n    at org.hl7.fhir.utilities.TextFile.fileToString(TextFile.java:153)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser.parseJsonFile(JsonTrackingParser.java:362)\n    at org.hl7.fhir.igtools.publisher.Publisher.initializeFromJson(Publisher.java:1464)\n    at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1119)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:603)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6115)\nException in thread &quot;main&quot; java.lang.NullPointerException\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6125)\n</pre></div>",
        "id": 168537310,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560971819
    },
    {
        "content": "<p>I'm at the airport but have some bandwidth to debug. Let's leave aside the IG Build summary page for now -- doesn't seem urgent unless you think it'd somehow related</p>",
        "id": 168537312,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560971820
    },
    {
        "content": "<p>no the second is more urgent.</p>",
        "id": 168537327,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560971833
    },
    {
        "content": "<p>Okay. My first debugging step will be to see if I get the same issue when I run the IG build docker container locally. Does that sound right?</p>",
        "id": 168537428,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560971900
    },
    {
        "content": "<p>no that might actually be  genuine error.</p>",
        "id": 168537456,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560971925
    },
    {
        "content": "<p>I get that one locally</p>",
        "id": 168537466,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560971935
    },
    {
        "content": "<p>ok sorry. The first 3 build failures I picked were all the one guide and it's that guide that's failing</p>",
        "id": 168537562,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560972006
    },
    {
        "content": "<p>the other guides are failing because of me. I am investigating...</p>",
        "id": 168537582,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560972023
    },
    {
        "content": "<p>so back to the first issue - the status file being out of date - thanks</p>",
        "id": 168537592,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560972035
    },
    {
        "content": "<p>OK -- status file out-of-date isn't shocking given the changes we made for supporting multiple branches. Is it just happening for US-Core-R4 ?</p>",
        "id": 168537622,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560972073
    },
    {
        "content": "<p>no looks selective, if you cross-compare the notifications channel with the status file</p>",
        "id": 168537719,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560972134
    },
    {
        "content": "<p>Just put in a fix -- it's rendering a timestamp from an older branch instead of the master branch.</p>",
        "id": 168538212,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560972541
    },
    {
        "content": "<p>(Still fixing, actually ;-))</p>",
        "id": 168538312,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560972622
    },
    {
        "content": "<p>Anyway, no urgent issues in the build itself, right <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  ?</p>",
        "id": 168538514,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560972785
    },
    {
        "content": "<p>(Date issue in <a href=\"https://fhir.github.io/auto-ig-builder/builds.html\" target=\"_blank\" title=\"https://fhir.github.io/auto-ig-builder/builds.html\">https://fhir.github.io/auto-ig-builder/builds.html</a> is fixed now:</p>\n<p><a href=\"/user_uploads/10155/M-mEY1cNyu-oG2L1UgDztr67/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/M-mEY1cNyu-oG2L1UgDztr67/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/M-mEY1cNyu-oG2L1UgDztr67/pasted_image.png\"></a></div><p><a href=\"https://github.com/FHIR/auto-ig-builder/commit/fb835a17ea6892962bd798a86b6d99de3ea5e673\" target=\"_blank\" title=\"https://github.com/FHIR/auto-ig-builder/commit/fb835a17ea6892962bd798a86b6d99de3ea5e673\">https://github.com/FHIR/auto-ig-builder/commit/fb835a17ea6892962bd798a86b6d99de3ea5e673</a> for details)</p>",
        "id": 168538561,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560972827
    },
    {
        "content": "<p>it's still broken for me in Chrome :-(</p>",
        "id": 168538653,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560972881
    },
    {
        "content": "<p>do you see failing guides listed? there's a bunch of davinci guides I'm not seeing listed at all because their last build failed</p>",
        "id": 168538683,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560972906
    },
    {
        "content": "<p>I'm also using Chrome; can you try ctrl-shift-reload? If that fails, try again in a bit -- GH Pages uses a CDN that can take time to propagate changes.</p>",
        "id": 168538686,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560972909
    },
    {
        "content": "<p>working now, but not seeing the failing builds</p>",
        "id": 168538736,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560972959
    },
    {
        "content": "<p>Ooh, interesting -- no, I'm not seeing failed DaVinci guides. that's a separate (not a new as of 2 minutes ago) issue, right?</p>",
        "id": 168538795,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560972982
    },
    {
        "content": "<p>I hadn't seen it before but don't know when it became a problem</p>",
        "id": 168538842,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560973022
    },
    {
        "content": "<p>OK -- will look at that next.</p>",
        "id": 168538979,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560973107
    },
    {
        "content": "<p>When builds fail, we have to go parsing through the build.log to figure out things like when, and which version. It looks like the format of  files like <a href=\"https://build.fhir.org/ig/HL7/davinci-pdex-formulary/branches/master/build.log\" target=\"_blank\" title=\"https://build.fhir.org/ig/HL7/davinci-pdex-formulary/branches/master/build.log\">https://build.fhir.org/ig/HL7/davinci-pdex-formulary/branches/master/build.log</a> has changed at som point, so dates are written like</p>\n<div class=\"codehilite\"><pre><span></span>Run time = Wednesday, June 19, 2019 at 6:16:19 PM Coordinated Universal Time\n</pre></div>\n\n\n<p>which doesn't match the parsing logic (\" @ {{ISO-8601 date}}}\")</p>",
        "id": 168541282,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560974932
    },
    {
        "content": "<p>That's part of the issue at least.</p>",
        "id": 168541307,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560974958
    },
    {
        "content": "<p>I've added a bit of defense against this, so the failed guides now show up (again) -- but they won't have a proper date attached to them.</p>",
        "id": 168542007,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560975544
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> so this is ok:</p>\n<p><code> Run time = Thursday, 20 June 2019 6:28:39 AM AEST (@2019-06-20T06:28:39+10:00)</code></p>",
        "id": 168542866,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560976165
    },
    {
        "content": "<p>?</p>",
        "id": 168542871,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560976168
    },
    {
        "content": "<p>Technically you want <code> @ </code> (that is, spaces around the at symbol), per my fragile parsing code ;-)</p>",
        "id": 168545944,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560978419
    },
    {
        "content": "<p>Obviously I should fix that</p>",
        "id": 168545973,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560978452
    },
    {
        "content": "<p>ok </p>\n<p><code>Run time = Thursday, 20 June 2019 7:07:25 AM AEST ( @ 2019-06-20T07:07:25+10:00)</code></p>",
        "id": 168545976,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560978457
    },
    {
        "content": "<p>I'll release that now</p>",
        "id": 168545983,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560978459
    },
    {
        "content": "<p>Then we can try rebuilding the davinci guides.</p>",
        "id": 168546174,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560978582
    },
    {
        "content": "<p>And they should get dates (or more likely, I can debug why they don't)</p>",
        "id": 168546200,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560978600
    },
    {
        "content": "<p>ok released</p>",
        "id": 168546890,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560979177
    }
]