[
    {
        "content": "<p>I'm getting this error while applying some changes for R5:</p>\n<div class=\"codehilite\"><pre><span></span><code>Exception in thread &quot;main&quot; java.lang.Error: no value for null on DeviceDefinitionProductionIdentifierInUDI\n        at org.hl7.fhir.definitions.generators.xsd.XSDGenerator.encodeType(XSDGenerator.java:418)\n        at org.hl7.fhir.definitions.generators.xsd.XSDGenerator.generateElement(XSDGenerator.java:325)\n        at org.hl7.fhir.definitions.generators.xsd.XSDGenerator.generateType(XSDGenerator.java:211)\n        at org.hl7.fhir.definitions.generators.xsd.XSDGenerator.generate(XSDGenerator.java:123)\n</code></pre></div>\n<p>Can anyone tell me what is missing?</p>",
        "id": 264003614,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638885140
    },
    {
        "content": "<p>on this branch: <a href=\"https://github.com/HL7/fhir/commits/costateixeira-oo\">https://github.com/HL7/fhir/commits/costateixeira-oo</a></p>",
        "id": 264003736,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638885198
    },
    {
        "content": "<p>I can't reproduce?</p>",
        "id": 264051189,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638902405
    },
    {
        "content": "<p>ok, i guess i need to clean first</p>",
        "id": 264053841,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638903420
    },
    {
        "content": "<p>still broken on my end</p>",
        "id": 264054572,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638903669
    },
    {
        "content": "<p>what is this code supposed to check?</p>\n<div class=\"codehilite\" data-code-language=\"Java\"><pre><span></span><code>    <span class=\"kd\">private</span> <span class=\"n\">String</span> <span class=\"nf\">encodeType</span><span class=\"p\">(</span><span class=\"n\">ElementDefn</span> <span class=\"n\">e</span><span class=\"p\">,</span> <span class=\"n\">TypeRef</span> <span class=\"n\">type</span><span class=\"p\">,</span> <span class=\"kt\">boolean</span> <span class=\"n\">params</span><span class=\"p\">)</span> <span class=\"kd\">throws</span> <span class=\"n\">Exception</span> <span class=\"p\">{</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">type</span><span class=\"p\">.</span><span class=\"na\">isResourceReference</span><span class=\"p\">())</span>\n      <span class=\"k\">return</span> <span class=\"s\">\"Reference\"</span><span class=\"p\">;</span>\n    <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">type</span><span class=\"p\">.</span><span class=\"na\">isCanonical</span><span class=\"p\">())</span>\n      <span class=\"k\">return</span> <span class=\"s\">\"canonical\"</span><span class=\"p\">;</span>\n    <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">type</span><span class=\"p\">.</span><span class=\"na\">isCodeableReference</span><span class=\"p\">())</span>\n      <span class=\"k\">return</span> <span class=\"s\">\"CodeableReference\"</span><span class=\"p\">;</span>\n        <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">type</span><span class=\"p\">.</span><span class=\"na\">getName</span><span class=\"p\">().</span><span class=\"na\">equals</span><span class=\"p\">(</span><span class=\"s\">\"code\"</span><span class=\"p\">))</span> <span class=\"p\">{</span>\n            <span class=\"n\">String</span> <span class=\"n\">en</span> <span class=\"o\">=</span> <span class=\"kc\">null</span><span class=\"p\">;</span>\n            <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">e</span><span class=\"p\">.</span><span class=\"na\">hasBinding</span><span class=\"p\">())</span> <span class=\"p\">{</span>\n                <span class=\"n\">BindingSpecification</span> <span class=\"n\">cd</span> <span class=\"o\">=</span> <span class=\"n\">e</span><span class=\"p\">.</span><span class=\"na\">getBinding</span><span class=\"p\">();</span>\n                <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">cd</span> <span class=\"o\">!=</span> <span class=\"kc\">null</span> <span class=\"o\">&amp;&amp;</span> <span class=\"n\">isEnum</span><span class=\"p\">(</span><span class=\"n\">cd</span><span class=\"p\">))</span> <span class=\"p\">{</span>\n                  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">cd</span><span class=\"p\">.</span><span class=\"na\">getValueSet</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"kc\">null</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                    <span class=\"k\">throw</span> <span class=\"k\">new</span> <span class=\"n\">Error</span><span class=\"p\">(</span><span class=\"s\">\"no value for \"</span><span class=\"o\">+</span><span class=\"n\">cd</span><span class=\"p\">.</span><span class=\"na\">getUri</span><span class=\"p\">()</span><span class=\"o\">+</span><span class=\"s\">\" on \"</span><span class=\"o\">+</span><span class=\"n\">cd</span><span class=\"p\">.</span><span class=\"na\">getName</span><span class=\"p\">());</span>\n                  <span class=\"p\">}</span>\n</code></pre></div>",
        "id": 264054824,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638903743
    },
    {
        "content": "<p>getting the type name for something. Do you get this with a new checkout ?</p>",
        "id": 264055019,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638903830
    },
    {
        "content": "<p>no, I'm using the branch <a href=\"https://github.com/HL7/fhir/tree/costateixeira-oo\">https://github.com/HL7/fhir/tree/costateixeira-oo</a></p>",
        "id": 264056116,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638904284
    },
    {
        "content": "<p>well, looking at that, the value set for the element DeviceDefinition.productionIdentifierInUDI is not defined</p>",
        "id": 264060961,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638906400
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>      <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"code\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/type&gt;</span>\n      <span class=\"nt\">&lt;binding&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName\"</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;valueString</span> <span class=\"na\">value=</span><span class=\"s\">\"DeviceProductionIdentifierInUDI\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n        <span class=\"nt\">&lt;strength</span> <span class=\"na\">value=</span><span class=\"s\">\"required\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">\"The production identifier(s) that are expected to appear in the UDI carrier.\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;valueSet</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/ValueSet/device-productidentifierinudi\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/binding&gt;</span>\n</code></pre></div>",
        "id": 264070335,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638910610
    },
    {
        "content": "<p>the VS is defined</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code><span class=\"cp\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>\n\n<span class=\"nt\">&lt;ValueSet</span> <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"device-productidentifierinudi\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;meta&gt;</span>\n    <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/StructureDefinition/shareablevalueset\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/meta&gt;</span>\n  <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"http://hl7.org/fhir/StructureDefinition/structuredefinition-wg\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">\"oo\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/extension&gt;</span>\n  <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/ValueSet/device-productidentifierinudi\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"4.6.0\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"DeviceProductionIdentifierInUDI\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">\"Device Production Identifier in UDI\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;compose&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/device-productidentifierinudi\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n  <span class=\"nt\">&lt;/compose&gt;</span>\n<span class=\"nt\">&lt;/ValueSet&gt;</span><span class=\"cp\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>\n\n<span class=\"nt\">&lt;ValueSet</span> <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"device-productidentifierinudi\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/ValueSet/device-productidentifierinudi\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"4.6.0\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"DeviceProductionIdentifierInUDI\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">\"Device Production Identifier in UDI\"</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;compose&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/device-productidentifierinudi\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n  <span class=\"nt\">&lt;/compose&gt;</span>\n<span class=\"nt\">&lt;/ValueSet&gt;</span>\n</code></pre></div>",
        "id": 264070596,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638910726
    },
    {
        "content": "<p>and the codesystem is defined too</p>",
        "id": 264070611,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638910734
    },
    {
        "content": "<p>you have named the valueset and the codesystem the same</p>",
        "id": 264073496,
        "sender_full_name": "John Moehrke",
        "timestamp": 1638911924
    },
    {
        "content": "<p>but are they loaded - what would make them load?</p>",
        "id": 264073596,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638911984
    },
    {
        "content": "<p>I looked at other resources , where I saw that VS and CS having the same id would be OK</p>",
        "id": 264076166,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638913068
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> what does \"make them load\" mean? Isn't it sufficient to define the VS and the CS as XMLs, and set the right references? elementDefinition --binding--&gt; ValueSet --compose.include--&gt; CodeSystem</p>",
        "id": 264076555,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638913222
    },
    {
        "content": "<p>well they are not exactly named the same thing</p>",
        "id": 264076863,
        "sender_full_name": "John Moehrke",
        "timestamp": 1638913347
    },
    {
        "content": "<p>the valueset sometimes is \"production\", where the codesystem is always \"product\"</p>",
        "id": 264076899,
        "sender_full_name": "John Moehrke",
        "timestamp": 1638913368
    },
    {
        "content": "<p>Ah i see. I have a name mismatch</p>",
        "id": 264077510,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638913675
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> I would not have noticed that ever</p>",
        "id": 264078353,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1638914030
    },
    {
        "content": "<p>did you get it working?</p>",
        "id": 264078503,
        "sender_full_name": "John Moehrke",
        "timestamp": 1638914076
    }
]