[
    {
        "content": "<p>hey <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> - check <a href=\"http://build.fhir.org/ig/HL7/UTG/branches/master/build.log\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/UTG/branches/master/build.log\">http://build.fhir.org/ig/HL7/UTG/branches/master/build.log</a> - what is the timeout limit for a IG build on the ci-build?</p>",
        "id": 175022156,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567724058
    },
    {
        "content": "<p><a href=\"https://github.com/FHIR/auto-ig-builder/blob/master/triggers/ig-commit-trigger/job.json#L11\" target=\"_blank\" title=\"https://github.com/FHIR/auto-ig-builder/blob/master/triggers/ig-commit-trigger/job.json#L11\">https://github.com/FHIR/auto-ig-builder/blob/master/triggers/ig-commit-trigger/job.json#L11</a></p>",
        "id": 175023686,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567726053
    },
    {
        "content": "<p>Looks like 30min</p>",
        "id": 175023691,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567726063
    },
    {
        "content": "<p>hmmm but the log seems to be about 11 min... I'm investigating</p>",
        "id": 175024478,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567727034
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> so I fixed something up, and committed it back to the repo, which should have kicked off another build.. but it did not. is there any way I can investigate why nothing happened?</p>",
        "id": 175027914,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567731864
    },
    {
        "content": "<p>well, it didn't appear in the notification stream here, but it did try ,and the log is here: <a href=\"https://build.fhir.org/ig/HL7/UTG/branches/master/build.log\" target=\"_blank\" title=\"https://build.fhir.org/ig/HL7/UTG/branches/master/build.log\">https://build.fhir.org/ig/HL7/UTG/branches/master/build.log</a></p>",
        "id": 175029300,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567734346
    },
    {
        "content": "<p>there's something off about it - I cut the build time in half, but it still timed out....</p>",
        "id": 175029351,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567734388
    },
    {
        "content": "<p>It seems to have actually taken &gt;30min and been killed, per the time limit. Is there a reason to think something else happened?</p>",
        "id": 175079597,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567786617
    },
    {
        "content": "<p>That's what I saw, too.  Do we just extend the time limit?  Currently the UTG CI build is still failed.</p>",
        "id": 175083757,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1567789730
    },
    {
        "content": "<p>well, we didn't get notification in the committers channel. that's the first issue. The second is what's going on, I'll investigate. but can we get notification?</p>",
        "id": 175098122,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567799742
    },
    {
        "content": "<p>Notifications: yes, this is doable but requires a bit of a re-write. I won't get to it this weekend unless someone thinks it's urgent.</p>",
        "id": 175107240,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567807130
    },
    {
        "content": "<p>Re: time limit, sure I'll update to 1h now.</p>",
        "id": 175107254,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567807170
    },
    {
        "content": "<p>Just updated at <a href=\"https://github.com/FHIR/auto-ig-builder/commit/1c341475da149452395eba71718b7d9f9248af92\" target=\"_blank\" title=\"https://github.com/FHIR/auto-ig-builder/commit/1c341475da149452395eba71718b7d9f9248af92\">https://github.com/FHIR/auto-ig-builder/commit/1c341475da149452395eba71718b7d9f9248af92</a></p>",
        "id": 175107426,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567807346
    },
    {
        "content": "<p>ok thanks</p>",
        "id": 175107434,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567807357
    },
    {
        "content": "<p>... and kicked off a build job for  UTG.</p>",
        "id": 175107447,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567807383
    },
    {
        "content": "<p>thx. 12 min for me. I just added late logging so I can see where it's going wrong</p>",
        "id": 175107930,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567807913
    },
    {
        "content": "<p>Hmm, that's a big difference in build times.</p>",
        "id": 175108117,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567808072
    },
    {
        "content": "<p>12 vs &gt;30.</p>",
        "id": 175108123,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567808077
    },
    {
        "content": "<p>y</p>",
        "id": 175108143,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567808102
    },
    {
        "content": "<p>Let's see about throwing some faster CPUs at it.</p>",
        "id": 175108481,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567808463
    },
    {
        "content": "<p>Just added a new node pool and over the weekend will switch over to it.</p>",
        "id": 175108502,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567808492
    },
    {
        "content": "<p>ok thanks. btw, I just learnt something.... maven will happily release a snapshot when it doesn't compile...</p>",
        "id": 175108575,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567808549
    },
    {
        "content": "<p>Oh, that's delightful.</p>",
        "id": 175108581,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567808575
    },
    {
        "content": "<p>this log from running UTG: </p>\n<div class=\"codehilite\"><pre><span></span>Connect to Terminology Server at http://tx.fhir.org                              (00:30.0066)\nLoad Content                                                                     (00:30.0577)\nException in thread &quot;main&quot; java.lang.Error: Unresolved compilation problems:\n    The method Log(String) is undefined for the type Publisher\n    The method Log(String) is undefined for the type Publisher\n\n    at org.hl7.fhir.igtools.publisher.Publisher.load(Publisher.java:2541)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:716)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:609)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6398)\n</pre></div>",
        "id": 175108597,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567808613
    },
    {
        "content": "<p>can we make more memory available?</p>",
        "id": 175112442,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567812194
    },
    {
        "content": "<p>ok I have a log now. It runs ok for 15 min or so, and then it runs out of RAM and slows down to a crawl (managing memory). Now that you've extended the time out to 60 minutes, it finally runs out of heap space at 45 minutes. On the ci-build it has 4GB, but I'm running it locally with 7GB</p>",
        "id": 175113093,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567812729
    },
    {
        "content": "<p>you might ask whether we need all of that RAM... I'll consider that, but it would be a major rework to change that</p>",
        "id": 175113105,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567812748
    },
    {
        "content": "<p>I've been running UTG locally with 8GB (6GB seemed not quite enough) - and that was before Ted made his latest updates</p>",
        "id": 175113290,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1567812951
    },
    {
        "content": "<p>When I added the value sets for CDA (&gt;325 of them) it slowed down on my local build very considerably.  My laptop howls and can do little else for about 25 minutes until finished.  I have a 4 core i9 with 32Gb of RAM.   If we cannot get this working over the weekend, I will update the CDA content manifest to only include a few dozen value sets and see if that will run to completion.  Or if it will help to debug, I can do that tonight.</p>",
        "id": 175113779,
        "sender_full_name": "Ted Klein",
        "timestamp": 1567813536
    },
    {
        "content": "<p>I'm still running in 12 min with all the CDA value sets. And the build is about 1/2 that speed until it his the RAM wall</p>",
        "id": 175116163,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567816093
    },
    {
        "content": "<p>I can give it as much RAM as we want.. will have a go at quadrupling RAM tomorrow.</p>",
        "id": 175118006,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567818553
    },
    {
        "content": "<p>wooah thanks</p>",
        "id": 175121084,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567824356
    },
    {
        "content": "<p>built successfully in 19 min with 8GB RAM</p>",
        "id": 175121451,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1567825184
    },
    {
        "content": "<p>Okay, with 20GB RAM on the latest cascade lake CPU, builds in 13min (that includes the time for the cluster manager to notice that it needed to boot a new VM, and boot it).</p>\n<p><a href=\"#narrow/stream/179297-committers.2Fnotification/topic/ig-build/near/175146721\" title=\"#narrow/stream/179297-committers.2Fnotification/topic/ig-build/near/175146721\">success notice</a></p>",
        "id": 175146995,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567874217
    },
    {
        "content": "<p>(Er, 11 min when I actually set the right machine type, of which 9 are actual container running time.)</p>",
        "id": 175147589,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567875257
    }
]