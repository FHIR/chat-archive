[
    {
        "content": "<p>I committed changes to Consent and ran a push (which works locally) and got this:<br>\n2022-03-11T14:41:10.1530495Z Candidate for CodeableReference: [ClinicalImpression.prognosis]<br>\n2022-03-11T14:41:10.4530536Z This was a Full Build                                                       1.18  36sec 4956MB<br>\n2022-03-11T14:41:10.5530140Z FHIR build failure @ Fri, Mar 11, 2022 14:41+0000                          0.109  36sec 4956MB<br>\n2022-03-11T14:41:10.5531468Z Error: null<br>\n2022-03-11T14:41:10.5533191Z java.lang.NullPointerException<br>\n2022-03-11T14:41:10.5534377Z    at java.util.ResourceBundle.containsKey(ResourceBundle.java:1821)<br>\n2022-03-11T14:41:10.5535441Z    at org.hl7.fhir.utilities.i18n.I18nBase.messageExistsForLocale(I18nBase.java:50)<br>\n2022-03-11T14:41:10.5536610Z    at org.hl7.fhir.utilities.i18n.I18nBase.formatMessage(I18nBase.java:67)<br>\n2022-03-11T14:41:10.5538091Z    at org.hl7.fhir.validation.BaseValidator.ruleHtml(BaseValidator.java:427)<br>\n2022-03-11T14:41:10.5539190Z    at org.hl7.fhir.definitions.validation.ResourceValidator.rule(ResourceValidator.java:124)<br>\n2022-03-11T14:41:10.5540363Z    at org.hl7.fhir.definitions.validation.ResourceValidator.checkSearchParams(ResourceValidator.java:383)<br>\n2022-03-11T14:41:10.5541525Z    at org.hl7.fhir.definitions.validation.ResourceValidator.check(ResourceValidator.java:217)<br>\n2022-03-11T14:41:10.5543059Z    at org.hl7.fhir.definitions.validation.ResourceValidator.check(ResourceValidator.java:594)<br>\n2022-03-11T14:41:10.5544182Z    at org.hl7.fhir.tools.publisher.Publisher.validate(Publisher.java:1886)<br>\n2022-03-11T14:41:10.5545175Z    at org.hl7.fhir.tools.publisher.Publisher.execute(Publisher.java:702)<br>\n2022-03-11T14:41:10.5546183Z    at org.hl7.fhir.tools.publisher.Publisher.main(Publisher.java:487)</p>",
        "id": 274988574,
        "sender_full_name": "David Pyke",
        "timestamp": 1647011819
    },
    {
        "content": "<p>What should I do?</p>",
        "id": 274988582,
        "sender_full_name": "David Pyke",
        "timestamp": 1647011823
    },
    {
        "content": "<p>Full log: <a href=\"https://dev.azure.com/fhir-pipelines/af4e28d8-13e5-41ea-9d9f-f6c9e34fb19f/_apis/build/builds/6370/logs/16\">https://dev.azure.com/fhir-pipelines/af4e28d8-13e5-41ea-9d9f-f6c9e34fb19f/_apis/build/builds/6370/logs/16</a></p>",
        "id": 274988607,
        "sender_full_name": "David Pyke",
        "timestamp": 1647011836
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 274990088,
        "sender_full_name": "David Pyke",
        "timestamp": 1647012558
    },
    {
        "content": "<p>well, you have many warnings, and warnings can't be there if you want FMM3</p>",
        "id": 274992801,
        "sender_full_name": "John Moehrke",
        "timestamp": 1647013970
    },
    {
        "content": "<p>Thank you, but that doesn't fix the error</p>",
        "id": 274992819,
        "sender_full_name": "David Pyke",
        "timestamp": 1647013984
    },
    {
        "content": "<p>are you sure? I was getting this same crazy error yesterday until I eliminated by build warnings</p>",
        "id": 274992889,
        "sender_full_name": "John Moehrke",
        "timestamp": 1647014036
    },
    {
        "content": "<p>It's a null pointer exception. That's a flaw in the publisher code.</p>",
        "id": 274992977,
        "sender_full_name": "David Pyke",
        "timestamp": 1647014063
    },
    {
        "content": "<p>you are thinking that the final failure is not caused by the well handled warnings?</p>",
        "id": 274993064,
        "sender_full_name": "John Moehrke",
        "timestamp": 1647014111
    },
    {
        "content": "<p>no question the build should handle this better</p>\n<blockquote>\n<p>ERROR @ Consent: Cannot invoke \"org.hl7.fhir.definitions.model.ElementDefn.getTypes()\" because \"e\" is null (src = ResourceValidator)</p>\n</blockquote>",
        "id": 274993298,
        "sender_full_name": "John Moehrke",
        "timestamp": 1647014223
    },
    {
        "content": "<p>Can you have a look at the code and see if you can find the bug? I'm sure they'd appreciate the extra eyes</p>",
        "id": 274994081,
        "sender_full_name": "David Pyke",
        "timestamp": 1647014449
    },
    {
        "content": "<p>The error is actually being caused by a validation rule being fired - so yes, getting rid of all validation issues would get rid of the problem (if you could figure out what the validation issue was that was triggering the problem).  However, this is definitely a publisher bug that needs to be fixed.</p>",
        "id": 275001003,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1647017659
    },
    {
        "content": "<p>I looked at the code and it indicates that something really funky is going on inside ResourceBundle, which is Java internal stuff.  The cause seems to be that an exception is being triggered when running SearchParameter validation logic on SearchParameters with type 'Reference' or 'uri' and the message being passed into the rules engine is the exception message - which doesn't have a translation and the translation process is then choking.  <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> will need to chase why.  (Hopefully knowing the type of search parameter that's causing the problem will help you narrow down the issue .</p>",
        "id": 275011251,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1647022068
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span></p>",
        "id": 275024987,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1647028144
    },
    {
        "content": "<p>David will look into this.</p>",
        "id": 275025010,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1647028155
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> <span class=\"user-mention\" data-user-id=\"192587\">@David Pyke</span> Looking into it.</p>",
        "id": 275035439,
        "sender_full_name": "David Otasek",
        "timestamp": 1647033754
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192587\">@David Pyke</span> It looks like the root cause of this is the search parameter<code>Consent.policy.uri</code> </p>\n<p>This element doesn't appear to exist. Here's a screenshot of elements that DO exist when the publisher reaches this point:</p>\n<p><a href=\"/user_uploads/10155/ksE6GsnUVtvx4rilN5RtxaOY/Screen-Shot-2022-03-11-at-5.05.54-PM.png\">Screen-Shot-2022-03-11-at-5.05.54-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/ksE6GsnUVtvx4rilN5RtxaOY/Screen-Shot-2022-03-11-at-5.05.54-PM.png\" title=\"Screen-Shot-2022-03-11-at-5.05.54-PM.png\"><img src=\"/user_uploads/10155/ksE6GsnUVtvx4rilN5RtxaOY/Screen-Shot-2022-03-11-at-5.05.54-PM.png\"></a></div>",
        "id": 275040770,
        "sender_full_name": "David Otasek",
        "timestamp": 1647036516
    },
    {
        "content": "<p>Do we understand why we get an NPE rather than a useful message?</p>",
        "id": 275062278,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1647041581
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> yes. I'm in the process of adding a better message now, but am having some odd IDE difficulties trying to test my changes.</p>",
        "id": 275063629,
        "sender_full_name": "David Otasek",
        "timestamp": 1647042672
    },
    {
        "content": "<p>Thanks!  I've fixed it.</p>",
        "id": 275099841,
        "sender_full_name": "David Pyke",
        "timestamp": 1647095547
    }
]