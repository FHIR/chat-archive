[
    {
        "content": "<p>I am getting an error profile validation error, on a profile that works with an old version of the validator (4.1.44) but not the latest (5.0.7-SNAPSHOT, but still with the -version 4.0 setting).</p>\n<p>It now complains that the extension is not allowed at this point. I have no context element on the extension, so it should be allowed anywhere I thought.</p>\n<p>If I add a context element it then says this, but the incorrect location it states seems to be correct (other than the \"x:\"):</p>\n<div class=\"codehilite\"><pre><span></span><code>*FAILURE* validating examples\\MATest-create-r401(forR5validator).xml:  error:1 warn:3 info:0\n  Error @ MedicinalProductAuthorization (line 3, col60) : The extension http://ema.europa.eu/fhir/extension/targetSpecies\nis not allowed to be used at this point (allowed = x:MedicinalProductAuthorization;\nthis element is [[MedicinalProductAuthorization])\n</code></pre></div>",
        "id": 206740588,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1597261137
    },
    {
        "content": "<p>how to reproduce this?</p>",
        "id": 206775512,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597286285
    },
    {
        "content": "<blockquote>\n<p>I am getting an error profile validation error, on a profile that works with an old version of the validator (4.1.44) but not the latest (5.0.7-SNAPSHOT, but still with the -version 4.0 setting).</p>\n</blockquote>\n<p>The <a href=\"#narrow/stream/217600-tooling.2Freleases/topic/Validator/near/206828798\">latest validator is 5.1.1</a>, isn't it?</p>",
        "id": 206833197,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1597333952
    },
    {
        "content": "<p>profile is:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;StructureDefinition xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;url value=&quot;http://hl7.org/fhir/StructureDefinition/MAProfileTest-Create&quot;/&gt;\n   &lt;fhirVersion value=&quot;4.0.1&quot;/&gt;\n   &lt;kind value=&quot;resource&quot;/&gt;\n   &lt;abstract value=&quot;false&quot;/&gt;\n   &lt;type value=&quot;MedicinalProductAuthorization&quot;/&gt;\n   &lt;baseDefinition value=&quot;http://hl7.org/fhir/StructureDefinition/MedicinalProductAuthorization&quot;/&gt;\n   &lt;derivation value=&quot;constraint&quot;/&gt;\n   &lt;differential&gt;\n      &lt;element id=&quot;MedicinalProductAuthorization.extension:targetSpecies&quot;&gt;\n         &lt;path value=&quot;MedicinalProductAuthorization.extension&quot;/&gt;\n         &lt;sliceName value=&quot;targetSpecies&quot;/&gt;\n         &lt;min value=&quot;1&quot;/&gt;\n         &lt;max value=&quot;*&quot;/&gt;\n         &lt;type&gt;\n            &lt;code value=&quot;Extension&quot;/&gt;\n            &lt;profile value=&quot;http://ema.europa.eu/fhir/extension/targetSpecies&quot;/&gt;\n         &lt;/type&gt;\n      &lt;/element&gt;\n   &lt;/differential&gt;\n&lt;/StructureDefinition&gt;\n</code></pre></div>\n\n\n<p>extension is:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;StructureDefinition xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;id value=&quot;EMATargetSpecies&quot;/&gt;\n   &lt;url value=&quot;http://ema.europa.eu/fhir/extension/targetSpecies&quot;/&gt;\n   &lt;name value=&quot;EMATargetSpecies&quot;/&gt;\n   &lt;status value=&quot;draft&quot;/&gt;\n   &lt;kind value=&quot;complex-type&quot;/&gt;\n   &lt;abstract value=&quot;false&quot;/&gt;\n   &lt;!-- originally this context was not present. but the profile doesnt work with new validator (extention context is not recognised),\n        so I have added this to try to force it. It didnt help but the error message is now a little clearer --&gt;\n   &lt;context&gt;\n      &lt;type value=&quot;extension&quot;/&gt;\n      &lt;expression value=&quot;MarketingAuthorization&quot;/&gt;\n   &lt;/context&gt;\n   &lt;type value=&quot;Extension&quot;/&gt;\n   &lt;baseDefinition value=&quot;http://hl7.org/fhir/StructureDefinition/Extension&quot;/&gt;\n   &lt;derivation value=&quot;constraint&quot;/&gt;\n   &lt;differential&gt;\n      &lt;element id=&quot;Extension.url&quot;&gt;\n         &lt;path value=&quot;Extension.url&quot;/&gt;\n         &lt;fixedUri value=&quot;http://ema.europa.eu/fhir/extension/targetSpecies&quot;/&gt;\n      &lt;/element&gt;\n   &lt;/differential&gt;\n&lt;/StructureDefinition&gt;\n</code></pre></div>\n\n\n<p>example that fails is:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;MedicinalProductAuthorization xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n    &lt;extension url=&quot;http://ema.europa.eu/fhir/extension/targetSpecies&quot;&gt;\n        &lt;valueString value=&quot;dog&quot;/&gt;\n    &lt;/extension&gt;\n&lt;/MedicinalProductAuthorization&gt;\n</code></pre></div>",
        "id": 206849196,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1597341961
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192685\">@Vassil Peytchev</span> maybe but this is the one at <a href=\"http://build.fhir.org\">build.fhir.org</a> today and in both the R5 preview 1 and preview 2 releases, so I went for stability. I didn't get if direct from github.</p>",
        "id": 206849707,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1597342238
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> - I am not sure if this is an issue or not, but the CI build seems to not be tracking the updates to the validator</p>",
        "id": 206855840,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1597345300
    },
    {
        "content": "<p>That sounds like an issue!</p>",
        "id": 206862966,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1597348815
    },
    {
        "content": "<p>Which validator? Can you point me to a built IG with this issue so we can look at the build log and see where/how it (wrongly) fetched the validator?</p>",
        "id": 206863045,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1597348851
    },
    {
        "content": "<p>It's on my todo list today to update the build to the latest validator / core</p>",
        "id": 206863765,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597349198
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> it's the ivy.xml, but updating it has many consequences I have to work through, and I finally have a clean build based on the current release</p>",
        "id": 206863836,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597349235
    },
    {
        "content": "<p>OK, thanks for the clarification!</p>",
        "id": 206864689,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1597349612
    },
    {
        "content": "<p>the new validator still shows the same issue I was getting. A profile that works in older validator no longer does. Don't know it is a validator or structure definition issue.</p>",
        "id": 209576203,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1599690410
    },
    {
        "content": "<p>how do I reproduce this?</p>",
        "id": 209967263,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1600062700
    },
    {
        "content": "<p>I gave the XML that reproduces it earlier in this thread</p>",
        "id": 209988346,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1600080438
    }
]