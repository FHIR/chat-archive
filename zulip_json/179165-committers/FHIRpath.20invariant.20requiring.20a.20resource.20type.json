[
    {
        "content": "<p>I'm trying to set an invariant that say the following and my FHIRpath knowledge is sadly lacking: <br>\nIf Patient.scope=privacy, Patient.subject must be a Patient resource.  <br>\nIf you can point me to an example that shows how that's done, I'd appreciate it.</p>",
        "id": 192908946,
        "sender_full_name": "David Pyke",
        "timestamp": 1586008872
    },
    {
        "content": "<p><code>scope = 'privacy' implies subject.type = 'Patient'</code><br>\nI think.  (I'm far from an expert...</p>",
        "id": 192910149,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1586010524
    },
    {
        "content": "<p>I'll see what it says...</p>",
        "id": 192915530,
        "sender_full_name": "David Pyke",
        "timestamp": 1586017678
    },
    {
        "content": "<blockquote>\n<p>scope = 'privacy' implies subject.type = 'Patient'</p>\n</blockquote>\n<p>requires the subject have a specified type of 'Patient'. If you want to say that what it points to must be a patient (which is what you said, and what the invariant should say):</p>\n<p><code>(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient)</code></p>",
        "id": 192924577,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1586030601
    },
    {
        "content": "<p>Now the fun of teaching myself enough to do it in XPath.  (no, don't give me the answer yet)</p>",
        "id": 192958662,
        "sender_full_name": "David Pyke",
        "timestamp": 1586092064
    },
    {
        "content": "<p>I get this error:<br>\n     [java] ERROR @ Consent: Expression '(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient)<br>\n     [java] (scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient' has illegal path (Error in ?? at 2, 1: Premature ExpressionNode termination at unexpected token \"(\") (src = Publisher)</p>",
        "id": 192959840,
        "sender_full_name": "David Pyke",
        "timestamp": 1586093627
    },
    {
        "content": "<p>Does this mean it doesn't like the opening right parentheses?</p>",
        "id": 192959920,
        "sender_full_name": "David Pyke",
        "timestamp": 1586093742
    },
    {
        "content": "<p>I'm confused - both of those have different quotation marks - I can't tell which is the real problem</p>",
        "id": 192960844,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1586095194
    },
    {
        "content": "<p>Here, have the file...<br>\n<a href=\"/user_uploads/10155/JZiIf5QT3v3rnFxzoTWEJmqX/consent-spreadsheet.xml\" title=\"consent-spreadsheet.xml\">consent-spreadsheet.xml</a></p>",
        "id": 192962101,
        "sender_full_name": "David Pyke",
        "timestamp": 1586097031
    },
    {
        "content": "<p>why do your have the expression there twice? </p>\n<blockquote>\n<p>(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient)&#10;(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient</p>\n</blockquote>",
        "id": 192976758,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1586118680
    },
    {
        "content": "<p>I must have pasted twice by mistake.  Well, I'm dumb.</p>",
        "id": 192986885,
        "sender_full_name": "David Pyke",
        "timestamp": 1586135426
    },
    {
        "content": "<p>Wait, when I open it, I only see it once in the spreadsheet.  Where are you seeing it twice?<br>\n<a href=\"/user_uploads/10155/ZWrxK_XSZclEoZB0JygJkVBP/image.png\" title=\"image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/ZWrxK_XSZclEoZB0JygJkVBP/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/ZWrxK_XSZclEoZB0JygJkVBP/image.png\"></a></div>",
        "id": 192987066,
        "sender_full_name": "David Pyke",
        "timestamp": 1586135702
    },
    {
        "content": "<p>in the source. it's on the second line so you might not see it easily in excel</p>",
        "id": 192987158,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1586135803
    },
    {
        "content": "<p>Ah, okay, I had to expand the input line to see it.  Thank you</p>",
        "id": 192987174,
        "sender_full_name": "David Pyke",
        "timestamp": 1586135859
    }
]