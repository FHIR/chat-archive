[
    {
        "content": "<p>I'm experiencing an error round-tripping the example json resources (parse, then encode to string, then parse again), that seems to be to do with xml entities in the narrative:</p>\n<p>code: <a href=\"https://pastebin.com/raw/PWETu8v5\" target=\"_blank\" title=\"https://pastebin.com/raw/PWETu8v5\">https://pastebin.com/raw/PWETu8v5</a><br>\nerror: <a href=\"https://pastebin.com/raw/CRDN9JWD\" target=\"_blank\" title=\"https://pastebin.com/raw/CRDN9JWD\">https://pastebin.com/raw/CRDN9JWD</a></p>\n<p>There's a literal unicode <code>Â©</code> character in the original, which is converted to a <code>&amp;copy</code> entity on the initial parse.  That entity is then written out when encoding, and causes the error on the second parse.</p>\n<p>The problem appears to have been introduced between 3.0.0 and 3.1.0.</p>",
        "id": 153942040,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1520168025
    },
    {
        "content": "<p>Guessing this is relevant?</p>\n<div class=\"codehilite\"><pre><span></span>/**\n * Note that as of HAPI FHIR 3.1.0, this method no longer uses\n * the StAX XMLEvent type as the XML representation, and uses a\n * String instead. If you need to work with XML as StAX events, you\n * can use the {@link XmlUtil#parse(String)} and {@link XmlUtil#encode(List)}\n * methods to do so.\n */\n</pre></div>",
        "id": 153942041,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1520168593
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"193659\">@Ben Spencer</span>, StAX is still used for validation but possibly that is related. I notice in your stack trace that it's using Xerces. The first thing I would try it adding Woodstox to your classpath- Xerces is just awful as an XML provider. You should see a line similar to the following when HAPI first starts:</p>\n<div class=\"codehilite\"><pre><span></span>09:39:05.201 [main] INFO  ca.uhn.fhir.util.XmlUtil [DependencyLogImpl.java:75] - FHIR XML procesing will use StAX implementation &#39;Woodstox XML-processor&#39; version &#39;4.4.1&#39;\n</pre></div>",
        "id": 153942054,
        "sender_full_name": "James Agnew",
        "timestamp": 1520174519
    },
    {
        "content": "<p>hi <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> , that seems to have fixed it, thanks</p>",
        "id": 153942055,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1520174718
    }
]