[
    {
        "content": "<p>Hello, I'm having a trouble in FHIR json parser issue.<br>\nHere is java code what I couldn't run:</p>\n<div class=\"codehilite\"><pre><span></span><code>log.debug(fhirContext.newJsonParser().setPrettyPrint(true)\n                    .encodeResourceToString(patient));\n</code></pre></div>\n\n\n<p>I've attached the error log file and sample code file <a href=\"/user_uploads/10155/r6OIyT5bmKkZczWWx3d-Imn8/error.txt\">error.txt</a> <a href=\"/user_uploads/10155/rqfOVzgNKjNaCp7Mxe-DpJD0/FhirPatientServiceImpl.java\">FhirPatientServiceImpl.java</a></p>\n<p>Is there anyone who can help me?</p>",
        "id": 205367477,
        "sender_full_name": "vladimir matryshov",
        "timestamp": 1596034510
    },
    {
        "content": "<p>It looks like you are trying to parse json as xml</p>",
        "id": 205367712,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1596034596
    },
    {
        "content": "<p>code:</p>\n<div class=\"codehilite\"><pre><span></span><code>log.debug(&quot;FHIR Patient:&quot;);\nlog.debug(fhirContext.newXmlParser().setPrettyPrint(true)\n                    .encodeResourceToString(patient));\nlog.debug(fhirContext.newJsonParser().setPrettyPrint(true)\n                    .encodeResourceToString(patient));\n</code></pre></div>\n\n\n<p>Log</p>\n<div class=\"codehilite\"><pre><span></span><code>2020-07-29 17:18:00.154 DEBUG 10124 --- [http-nio-8461-exec-5] g.s.c.u.s.fhir.FhirPatientServiceImpl    : FHIR Patient:\n2020-07-29 17:18:00.156 DEBUG 10124 --- [http-nio-8461-exec-5] g.s.c.u.s.fhir.FhirPatientServiceImpl    : &lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;id value=&quot;C2S-DEV-0PN6EK&quot;/&gt;\n   &lt;identifier&gt;\n      &lt;use value=&quot;official&quot;/&gt;\n      &lt;system value=&quot;https://bhits.github.io/consent2share&quot;/&gt;\n      &lt;value value=&quot;C2S-DEV-0PN6EK&quot;/&gt;\n   &lt;/identifier&gt;\n   &lt;active value=&quot;true&quot;/&gt;\n   &lt;name&gt;\n      &lt;family value=&quot;Test&quot;/&gt;\n      &lt;given value=&quot;Test&quot;/&gt;\n   &lt;/name&gt;\n   &lt;telecom&gt;\n      &lt;system value=&quot;email&quot;/&gt;\n      &lt;value value=&quot;test@test.com&quot;/&gt;\n      &lt;use value=&quot;home&quot;/&gt;\n   &lt;/telecom&gt;\n   &lt;gender value=&quot;male&quot;/&gt;\n   &lt;birthDate value=&quot;2020-07-01&quot;/&gt;\n&lt;/Patient&gt;\n2020-07-29 17:18:00.162 ERROR 10124 --- [http-nio-8461-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Handler dispatch failed; nested exception is java.lang.NoClassDefFoundError: Could not initialize class ca.uhn.fhir.parser.json.jackson.JacksonStructure] with root cause\n\njava.lang.NoClassDefFoundError: Could not initialize class ca.uhn.fhir.parser.json.jackson.JacksonStructure\n    at ca.uhn.fhir.parser.JsonParser.createJsonWriter(JsonParser.java:166) ~[hapi-fhir-base-5.0.2.jar:na]\n    at ca.uhn.fhir.parser.JsonParser.doEncodeResourceToWriter(JsonParser.java:183) ~[hapi-fhir-base-5.0.2.jar:na]\n    at ca.uhn.fhir.parser.BaseParser.encodeResourceToWriter(BaseParser.java:419) ~[hapi-fhir-base-5.0.2.jar:na]\n    at ca.uhn.fhir.parser.BaseParser.encodeResourceToWriter(BaseParser.java:403) ~[hapi-fhir-base-5.0.2.jar:na]\n    at ca.uhn.fhir.parser.BaseParser.encodeResourceToString(BaseParser.java:392) ~[hapi-fhir-base-5.0.2.jar:na]\n    at gov.samhsa.c2s.ums.service.fhir.FhirPatientServiceImpl.publishFhirPatient(FhirPatientServiceImpl.java:101) ~[classes/:na]\n    at gov.samhsa.c2s.ums.service.UserServiceImpl.registerUser(UserServiceImpl.java:179) ~[classes/:na]\n    at gov.samhsa.c2s.ums.service.UserServiceImpl$$FastClassBySpringCGLIB$$3f457b5d.invoke(&lt;generated&gt;) ~[classes/:na]\n</code></pre></div>",
        "id": 205368257,
        "sender_full_name": "vladimir matryshov",
        "timestamp": 1596034807
    },
    {
        "content": "<p>It seems to be working for XML parsing but not working on JSON parsing.</p>",
        "id": 205368481,
        "sender_full_name": "vladimir matryshov",
        "timestamp": 1596034920
    },
    {
        "content": "<p>I've tried to run it on hapi-fhir-base 5.0.1 and I got the different error.</p>\n<div class=\"codehilite\"><pre><span></span><code>2020-07-29 18:10:53.430 DEBUG 19980 --- [http-nio-8461-exec-2] g.s.c.u.s.fhir.FhirPatientServiceImpl    : FHIR Patient:\n2020-07-29 18:10:54.372 DEBUG 19980 --- [http-nio-8461-exec-2] g.s.c.u.s.fhir.FhirPatientServiceImpl    : &lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;id value=&quot;C2S-DEV-BTN33I&quot;/&gt;\n   &lt;identifier&gt;\n      &lt;use value=&quot;official&quot;/&gt;\n      &lt;system value=&quot;https://bhits.github.io/consent2share&quot;/&gt;\n      &lt;value value=&quot;C2S-DEV-BTN33I&quot;/&gt;\n   &lt;/identifier&gt;\n   &lt;active value=&quot;true&quot;/&gt;\n   &lt;name&gt;\n      &lt;family value=&quot;Test&quot;/&gt;\n      &lt;given value=&quot;Test&quot;/&gt;\n   &lt;/name&gt;\n   &lt;telecom&gt;\n      &lt;system value=&quot;email&quot;/&gt;\n      &lt;value value=&quot;test@test.com&quot;/&gt;\n      &lt;use value=&quot;home&quot;/&gt;\n   &lt;/telecom&gt;\n   &lt;gender value=&quot;male&quot;/&gt;\n   &lt;birthDate value=&quot;2020-07-01&quot;/&gt;\n&lt;/Patient&gt;\n2020-07-29 18:10:54.392 ERROR 19980 --- [http-nio-8461-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Handler dispatch failed; nested exception is java.lang.NoSuchFieldError: FAIL_ON_TRAILING_TOKENS] with root cause\n\njava.lang.NoSuchFieldError: FAIL_ON_TRAILING_TOKENS\n    at ca.uhn.fhir.parser.json.jackson.JacksonStructure.createObjectMapper(JacksonStructure.java:384) ~[hapi-fhir-base-5.0.1.jar:na]\n    at ca.uhn.fhir.parser.json.jackson.JacksonStructure.&lt;clinit&gt;(JacksonStructure.java:55) ~[hapi-fhir-base-5.0.1.jar:na]\n    at ca.uhn.fhir.parser.JsonParser.createJsonWriter(JsonParser.java:166) ~[hapi-fhir-base-5.0.1.jar:na]\n    at ca.uhn.fhir.parser.JsonParser.doEncodeResourceToWriter(JsonParser.java:183) ~[hapi-fhir-base-5.0.1.jar:na]\n    at ca.uhn.fhir.parser.BaseParser.encodeResourceToWriter(BaseParser.java:419) ~[hapi-fhir-base-5.0.1.jar:na]\n    at ca.uhn.fhir.parser.BaseParser.encodeResourceToWriter(BaseParser.java:403) ~[hapi-fhir-base-5.0.1.jar:na]\n    at ca.uhn.fhir.parser.BaseParser.encodeResourceToString(BaseParser.java:392) ~[hapi-fhir-base-5.0.1.jar:na]\n    at gov.samhsa.c2s.ums.service.fhir.FhirPatientServiceImpl.publishFhirPatient(FhirPatientServiceImpl.java:101) ~[classes/:na]\n    at gov.samhsa.c2s.ums.service.UserServiceImpl.registerUser(UserServiceImpl.java:179) ~[classes/:na]\n    at gov.samhsa.c2s.ums.service.UserServiceImpl$$FastClassBySpringCGLIB$$3f457b5d.invoke(&lt;generated&gt;) ~[classes/:na]\n    at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) ~[spring-core-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:738) ~[spring-aop-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) ~[spring-aop-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99) ~[spring-tx-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:282) ~[spring-tx-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96) ~[spring-tx-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) ~[spring-aop-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:673) ~[spring-aop-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at gov.samhsa.c2s.ums.service.UserServiceImpl$$EnhancerBySpringCGLIB$$cb29ba66.registerUser(&lt;generated&gt;) ~[classes/:na]\n    at gov.samhsa.c2s.ums.web.UserRestController.registerUser(UserRestController.java:42) ~[classes/:na]\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_251]\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_251]\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_251]\n    at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_251]\n    at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:661) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846) ~[spring-webmvc-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:742) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) ~[tomcat-embed-websocket-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55) ~[spring-boot-1.5.6.RELEASE.jar:1.5.6.RELEASE]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:110) ~[spring-boot-actuator-1.5.6.RELEASE.jar:1.5.6.RELEASE]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208) ~[spring-security-web-4.2.3.RELEASE.jar:4.2.3.RELEASE]\n    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177) ~[spring-security-web-4.2.3.RELEASE.jar:4.2.3.RELEASE]\n    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:105) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.10.RELEASE.jar:4.3.10.RELEASE]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-8.5.16.jar:8.5.16]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:\n</code></pre></div>",
        "id": 205370575,
        "sender_full_name": "vladimir matryshov",
        "timestamp": 1596035715
    },
    {
        "content": "<p>The noclassdeffound tells me that there are issues on your classpath</p>",
        "id": 205370679,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1596035734
    },
    {
        "content": "<p>How can I solve the issue?</p>",
        "id": 205370788,
        "sender_full_name": "vladimir matryshov",
        "timestamp": 1596035764
    },
    {
        "content": "<p>Here is pom file.<br>\n<a href=\"user_uploads/10155/OIujj_GC4mCDUnDfPCXDNrgE/pom.xml\">pom.xml</a></p>",
        "id": 205370968,
        "sender_full_name": "vladimir matryshov",
        "timestamp": 1596035842
    },
    {
        "content": "<p>1) I recommend sticking with version 5.0.2<br>\n2) did you provide the full stack trace?<br>\n3) the jackson deps that you get when using spring-boot-starter-parent/1.5.6.RELEASE brings jackson version 2.8.9 whereas HAPI brings 2.10.0. I don't know if that could be the cause</p>",
        "id": 205407298,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1596053332
    }
]