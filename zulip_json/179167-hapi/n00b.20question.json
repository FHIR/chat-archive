[
    {
        "content": "<p>Hi. I'm trying to run hapi on docker using this<br>\n<code>docker run -p 8080:8080 -e hapi.fhir.default_encoding=json  -v c:/temp/hapi:/configs -e \"--spring.config.location=file:///configs/kl.yml\" hapiproject/hapi:latest</code> <br>\nbut I get a </p>\n<div class=\"codehilite\"><pre><span></span><code>ERROR o.s.boot.SpringApplication [SpringApplication.java:858] Application run failed\njava.lang.IllegalStateException: Attempted to load Config resource &#39;file [/configs/kl.yml]&#39; via location &#39;file:///configs/kl.yml&#39; but snakeyaml was not found on the classpath\n</code></pre></div>",
        "id": 239570684,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1621508371
    },
    {
        "content": "<p>Can someone advise on what I'm missing?</p>",
        "id": 239570708,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1621508393
    },
    {
        "content": "<p>I'm on docker on win10. A colleague says it works on WSL</p>",
        "id": 239570844,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1621508432
    },
    {
        "content": "<p>I got the same error and parsed the application.yaml for errors. Seems like it's the indentation and an extra space in front of <code>cors:</code> caused this. Removing the space got it running again for me.</p>\n<div class=\"codehilite\"><pre><span></span><code>    cors:\n       allow_Credentials: true\n</code></pre></div>",
        "id": 239603373,
        "sender_full_name": "Julian Sass",
        "timestamp": 1621521774
    },
    {
        "content": "<p>Please make an issue or PR</p>",
        "id": 239611144,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1621524510
    },
    {
        "content": "<p>Nevermind ... already fixed with <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/28c91893757c75a7eb92d1d4973c86f49821a119\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/28c91893757c75a7eb92d1d4973c86f49821a119</a></p>",
        "id": 239617215,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1621526809
    },
    {
        "content": "<p>Thank you!</p>",
        "id": 239670626,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1621550797
    },
    {
        "content": "<p>I really meant the noob part, though. since I am using a docker image I believe I am supposed to wait for this to be in the latest image, right? (I just downloaded the docker image again, the error seems to persist but I may be doing something wrong)</p>",
        "id": 239670663,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1621550823
    },
    {
        "content": "<p>HAPI Docker images are not always predictably updated on Docker Hub. I would use tags (and generally one should use tagged images). Try hapiproject/hapi:v5.3.0</p>",
        "id": 239670902,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1621550955
    },
    {
        "content": "<p>The problem here was the supplied config - not the Docker image FYI</p>",
        "id": 239700796,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1621577066
    },
    {
        "content": "<p>So... trying to use the docker v5.4.0 tag that was based on the 5.4.0 tag in GitHub of <code>hapi-fhir-jpaserver-starter</code>. Running the docker image by itself with no custom config, I am getting the same error about snakeyaml. I checked out the 5.4.0 tag from github and fixed the indentation on the <code>cors</code> element, rebuilt the image, and am still getting the same snakeyaml error. I have no idea how fixing the indentation on <code>cors</code> fixed it for others...</p>",
        "id": 241658200,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622930585
    },
    {
        "content": "<p>Online posts seem to indicate that it is missing a dependency to snakeyaml, which makes sense to me given the error message being given. So, my next attempt is to add</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.yaml&lt;/groupId&gt;\n    &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;\n    &lt;version&gt;1.28&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></div>\n<p>to the <code>pom.xml</code> and re-build the image</p>",
        "id": 241658277,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622930674
    },
    {
        "content": "<p>That resolved the problem...</p>",
        "id": 241658516,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622931014
    },
    {
        "content": "<p>I could push the tag to docker hub... but I'm hesitant to push a docker tag that does not align with the github tag</p>",
        "id": 241658523,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622931044
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> any thoughts?</p>",
        "id": 241658526,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622931049
    },
    {
        "content": "<p>or <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span></p>",
        "id": 241658537,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622931081
    },
    {
        "content": "<p>I had to add the dependency to snakeyaml to make it work in my own fork.</p>",
        "id": 241658586,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1622931154
    },
    {
        "content": "<p>I think maybe the better solution would be to update <code>master</code> with a fix to the <code>cors</code> tabbing and adding the snakeyaml dependency to <code>pom.xml</code>, then re-tag 5.4.0 at the master HEAD in github, which would cause docker hub to re-build the v5.4.0 tag</p>",
        "id": 241658600,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622931206
    },
    {
        "content": "<p>Yeah, that might make sense.</p>",
        "id": 241658648,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1622931263
    },
    {
        "content": "<p>Or does that need to be 5.4.1?</p>",
        "id": 241658659,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1622931309
    },
    {
        "content": "<p>yah... not really sure</p>",
        "id": 241659812,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622933412
    },
    {
        "content": "<p>will leave that up to <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> and or <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> <br>\nI have created a PR for the dependency and explained what my intention is here: <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/pull/248\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/pull/248</a><br>\nJust want them to agree/approve.</p>",
        "id": 241659822,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622933460
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> snakeyaml was added with <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/787a1b8d0f872e08c6e21c3aa139cc547564db5a\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/787a1b8d0f872e08c6e21c3aa139cc547564db5a</a> (16 days ago) so it is already there</p>",
        "id": 241679759,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1622967112
    },
    {
        "content": "<p>I've answered your PR on github</p>",
        "id": 241680276,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1622967846
    },
    {
        "content": "<p>So, what should we do about the 5.4.0 tag then <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> ? seems like 5.4.0 is broken/invalid</p>",
        "id": 241697896,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622995038
    },
    {
        "content": "<p>nm... reading the github PR comments. the answers are there</p>",
        "id": 241697911,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622995078
    },
    {
        "content": "<p>with one exception...</p>",
        "id": 241697983,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622995178
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> , you say \"feel free to publish a new docker image\". those docker images are based on github tags. do you want me to delete and re-create the tag? or do you want me to create a new 5.4.1 tag?</p>",
        "id": 241698038,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1622995218
    },
    {
        "content": "<p>Wouldn't a new tag be the most proper thing to do?</p>",
        "id": 241698055,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1622995272
    },
    {
        "content": "<p>I mean that is the easiest thing to explain</p>",
        "id": 241698120,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1622995376
    },
    {
        "content": "<p>Agreed. Done</p>",
        "id": 241717112,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1623024185
    },
    {
        "content": "<p>Ok. There is now a 5.4.1 image on docker hub that includes these changes/fixes</p>",
        "id": 241732535,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1623045928
    }
]