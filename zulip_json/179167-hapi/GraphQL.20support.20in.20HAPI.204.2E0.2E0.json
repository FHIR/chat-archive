[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> It's exciting that HAPI 4.0 comes with so many new features. We briefly checked on the GraphQL feature but wasn't able to find much HAPI-specific documentation on that. It would help if you could help clarify a few things:<br>\n(1) First of all, how would you characterize the maturity of HAPI's GraphQL support - I understand this is the first full roll out.<br>\n(2) Overall, would any of the operations be faster with GraphQL than with the standard search API, I would think not but would like to hear your view.<br>\n(3) HAPI's response to graphql does not seem to have the \"wrapper\" with a \"data\" element, is it intentional?<br>\nA couple of minor/detailed issues we noticed:<br>\nHAPI does not appear to support GET with graphql, is that the case (which isn't necessarily an issue)?<br>\nWith a query like \"{Patient(id:xx-123){id,name{given,family}}}\", HAPI does not seem to like the dash in the id, which is a valid id character?<br>\nThanks!<br>\n<span class=\"user-mention\" data-user-id=\"193152\">@Ye Wang</span> <span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span></p>",
        "id": 173407776,
        "sender_full_name": "Xiaocheng Luan",
        "timestamp": 1565989790
    },
    {
        "content": "<p>(1) and (3) are for me, and on my list. I'll leave it to James to comment on (2)</p>",
        "id": 173407922,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1565989914
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"195343\">@Xiaocheng Luan</span> </p>\n<blockquote>\n<p>(1) First of all, how would you characterize the maturity of HAPI's GraphQL support</p>\n</blockquote>\n<p>Definitely immature at this time. I very much doubt this feature has been heavily tested or brought into production by anyone yet. I am confident in the quality of the code and I certainly wouldn't call it a prototype or anything like that, but I'm also sure we'll find a few issues in the next little while as people start to use it.</p>\n<blockquote>\n<p>(2) Overall, would any of the operations be faster with GraphQL than with the standard search API, I would think not but would like to hear your view.</p>\n</blockquote>\n<p>The only difference I would expect is a savings due to the number of bytes going over the wire (which can be a significant savings in many cases). There are no specific database optimizations (yet) but there aren't any thing that would be slower there either.</p>\n<blockquote>\n<p>(3) HAPI's response to graphql does not seem to have the \"wrapper\" with a \"data\" element, is it intentional?</p>\n</blockquote>\n<p>Wow, well there's our first bug report. :) You are correct, we are missing that and it's not intentional. Will fix this.</p>\n<blockquote>\n<p>HAPI does not appear to support GET with graphql, is that the case (which isn't necessarily an issue)?</p>\n</blockquote>\n<p>I'm guessing you mean support for searching? That's coming very soon.</p>",
        "id": 173408525,
        "sender_full_name": "James Agnew",
        "timestamp": 1565990474
    },
    {
        "content": "<p>(oops, didn't see Grahame's reply when I wrote mine)</p>",
        "id": 173408544,
        "sender_full_name": "James Agnew",
        "timestamp": 1565990520
    },
    {
        "content": "<p>on (2)... you can make a massive request with graphQL - potentially covering 1000s of resources. The request could take a long time to process - but it's still faster than making the requests individually, and including the latency as well</p>",
        "id": 173408620,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1565990592
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> - on 3 - I didn't update the java implementation for the tests - see</p>",
        "id": 173408633,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1565990614
    },
    {
        "content": "<p>[hapi-core]\\org.hl7.fhir.r5\\src\\test\\resources\\graphql\\server-tests.json</p>",
        "id": 173408712,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1565990702
    },
    {
        "content": "<p>Thanks for the quick and detailed response, <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> </p>\n<div class=\"codehilite\"><pre><span></span>&gt; HAPI does not appear to support GET with graphql, is that the case (which isn&#39;t necessarily an issue)?\nI&#39;m guessing you mean support for searching? That&#39;s coming very soon.\n</pre></div>\n\n\n<p>I meant for a simple query like {name{family}}, POST works, but \"graphql?query={name{family}}\" does not :). Given the format of GraphQL I would think real code should use POST but GET may be handy for testing/examples.</p>",
        "id": 173409653,
        "sender_full_name": "Xiaocheng Luan",
        "timestamp": 1565991520
    },
    {
        "content": "<blockquote>\n<p>on (2)... you can make a massive request with graphQL - potentially covering 1000s of resources. The request could take a long time to process - but it's still faster than making the requests individually, and including the latency as well</p>\n</blockquote>\n<p>Thanks for the insight <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 173409704,
        "sender_full_name": "Xiaocheng Luan",
        "timestamp": 1565991568
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"195343\">@Xiaocheng Luan</span> - What do you mean by POST working but not GET? As far as I can see doing a get works fine.. e.g. <a href=\"http://hapi.fhir.org/baseR4/Patient/cf-1558990251926/$graphql?query={name{text,given,family}}\" target=\"_blank\" title=\"http://hapi.fhir.org/baseR4/Patient/cf-1558990251926/$graphql?query={name{text,given,family}}\">http://hapi.fhir.org/baseR4/Patient/cf-1558990251926/$graphql?query={name{text,given,family}}</a></p>",
        "id": 173490611,
        "sender_full_name": "James Agnew",
        "timestamp": 1566141233
    },
    {
        "content": "<p>I do notice that we seem to be showing the wrong content type on that specific response.. but i think that's just the syntax highlighter getting it wrong.</p>",
        "id": 173490659,
        "sender_full_name": "James Agnew",
        "timestamp": 1566141280
    },
    {
        "content": "<p>Interestingly, the link above works fine when I type it in a browser (or just click on the link) but get a status 500 with an empty OO when using PostMan...</p>",
        "id": 173567242,
        "sender_full_name": "David Hay",
        "timestamp": 1566239518
    },
    {
        "content": "<p>Might help to trace... in PostMan it works if you set the Accept header to text/html.  Fails with everything else.</p>",
        "id": 173568664,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1566240635
    },
    {
        "content": "<p>Ah, just replicated this. I'll push up a fix in the next day or so. Thanks for the heads up!</p>",
        "id": 173582967,
        "sender_full_name": "James Agnew",
        "timestamp": 1566251725
    },
    {
        "content": "<p>So should HAPI GraphQL work with POST? Everything I try seems to result in:<br>\n{<br>\n  \"resourceType\": \"OperationOutcome\",<br>\n  \"text\": {<br>\n    \"status\": \"generated\",<br>\n    \"div\": \"&lt;div xmlns=\\\"http://www.w3.org/1999/xhtml\\\"&gt;&lt;h1&gt;Operation Outcome&lt;/h1&gt;&lt;table border=\\\"0\\\"&gt;&lt;tr&gt;&lt;td style=\\\"font-weight: bold;\\\"&gt;ERROR&lt;/td&gt;&lt;td&gt;[]&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Unable to parse GraphQL Expression: java.lang.NullPointerException&lt;/pre&gt;&lt;/td&gt;\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t&lt;/tr&gt;\\n\\t\\t&lt;/table&gt;\\n\\t&lt;/div&gt;\"<br>\n  },<br>\n  \"issue\": [<br>\n    {<br>\n      \"severity\": \"error\",<br>\n      \"code\": \"processing\",<br>\n      \"diagnostics\": \"Unable to parse GraphQL Expression: java.lang.NullPointerException\"<br>\n    }<br>\n  ]<br>\n}</p>\n<p>... However GET seems to be working...</p>",
        "id": 177155068,
        "sender_full_name": "Toni Vaa",
        "timestamp": 1570026571
    },
    {
        "content": "<p>Hmm... Yeah, that's almost certainly a HAPI bug. Can you file a ticket?</p>",
        "id": 177155616,
        "sender_full_name": "James Agnew",
        "timestamp": 1570026926
    },
    {
        "content": "<p>I created this to GitHub: <a href=\"https://github.com/jamesagnew/hapi-fhir/issues/1523\" target=\"_blank\" title=\"https://github.com/jamesagnew/hapi-fhir/issues/1523\">https://github.com/jamesagnew/hapi-fhir/issues/1523</a>. Will it suffice?</p>",
        "id": 177223178,
        "sender_full_name": "Toni Vaa",
        "timestamp": 1570090282
    },
    {
        "content": "<p>Does the new HAPI support GraphQL queries on system level without an ID? I would like to use GraphQL for quering all observations from a specific patient, e.g. query={Observation{id,subject{reference,resource(type:Patient(id:1))}}} ?</p>",
        "id": 178469822,
        "sender_full_name": "Hannes Ulrich",
        "timestamp": 1571402872
    },
    {
        "content": "<p>Is there any documentation on GraphQL to see how HAPI 4.0 supports it ?</p>",
        "id": 186153621,
        "sender_full_name": "dsh",
        "timestamp": 1579582863
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191783\">@Daya Sharma</span> unfortunately not much.. This is where you enable it though: <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/hapi.properties#L58\" target=\"_blank\" title=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/hapi.properties#L58\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/hapi.properties#L58</a></p>\n<p>Highly recommended to use 4.1.0 if you're using GraphQL, lots of fixes happened btween the 4.0.0 and 4.1.0 releases.</p>",
        "id": 186533593,
        "sender_full_name": "James Agnew",
        "timestamp": 1579899743
    },
    {
        "content": "<p>thanks <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span></p>",
        "id": 186539577,
        "sender_full_name": "dsh",
        "timestamp": 1579904081
    },
    {
        "content": "<p>Tried to run a graphQL query on the hapi r4 server (R4 Endpoint: <a href=\"http://hapi.fhir.org/baseR4\" target=\"_blank\" title=\"http://hapi.fhir.org/baseR4\">http://hapi.fhir.org/baseR4</a>) with the following query parameter </p>\n<div class=\"codehilite\"><pre><span></span>{&#39;query&#39;: &#39;{ObservationList(subject:example){id,valueQuantity{value,unit},effectivePeriod{start}}}&#39;}\n</pre></div>\n\n\n<p>and got the following error:</p>\n<div class=\"codehilite\"><pre><span></span>Response\nStatus Code = 500\n{&#39;resourceType&#39;: &#39;OperationOutcome&#39;, &#39;text&#39;: {&#39;status&#39;: &#39;generated&#39;, &#39;div&#39;: &#39;\nOperation Outcome\n\nERROR   []\nUnable to execute GraphQL Expression: Encountered a selection set on a scalar field type\n</pre></div>\n\n\n<p>note that that this query parameter:</p>\n<div class=\"codehilite\"><pre><span></span>{&#39;query&#39;: &#39;{ObservationList(subject:example){id,valueQuantity{value,unit},effectivePeriod}}&#39;}\n</pre></div>\n\n\n<p>is successful despite the fact that the effectivePeriod is a complex element.</p>",
        "id": 190934331,
        "sender_full_name": "Eric Haas",
        "timestamp": 1584499252
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 190934580,
        "sender_full_name": "Eric Haas",
        "timestamp": 1584499643
    }
]