[
    {
        "content": "<p>Hi we have HAPI v4.1 running in Docker on AWS Fargate (no shell access), so I am wondering what steps I need to take to upgrade to 5.3</p>",
        "id": 233372408,
        "sender_full_name": "dsh",
        "timestamp": 1617736175
    },
    {
        "content": "<p>From the documentation  <a href=\"https://hapifhir.io/hapi-fhir/docs/server_jpa/upgrading.html\">https://hapifhir.io/hapi-fhir/docs/server_jpa/upgrading.html</a> running the <code>hapi-fhir-cli</code>will not be possible (bcoz of Fargate) unless either I change the docker container start command or deploy the 5.x outside docker to access and run <code>hapi-fhir-cli</code>  for data migration and then deploy the 5.x version in docker/fargate</p>",
        "id": 233372923,
        "sender_full_name": "dsh",
        "timestamp": 1617736429
    },
    {
        "content": "<p>any insight or verification of the steps will be mucho appreciated</p>",
        "id": 233376712,
        "sender_full_name": "dsh",
        "timestamp": 1617738083
    },
    {
        "content": "<p>Our database is 190GB so I am assuming its going to take some time to migrate all of that, but any ball park idea on how much time??</p>",
        "id": 233376986,
        "sender_full_name": "dsh",
        "timestamp": 1617738204
    },
    {
        "content": "<p>Where is docker image of <a href=\"https://hub.docker.com/r/hapiproject/hapi/tags?page=1&amp;ordering=last_updated\">HAPI v5.3 on dockerhub</a>? I can see 5.4 release on docker but there is no corresponding <code>hapi-fhir-cli</code> for 5.4? So is <a href=\"https://hub.docker.com/r/hapiproject/hapi/tags?page=1&amp;ordering=last_updated\">hapiproject/hapi:v5.4.0</a> tagged mistakenly?</p>\n<p>If I use <code>hapi-fhir-cli</code> of 5.3 on 5.4 will it cause problems?</p>",
        "id": 234231165,
        "sender_full_name": "dsh",
        "timestamp": 1618261635
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> any idea on the missing docker image for 5.3?</p>",
        "id": 234231914,
        "sender_full_name": "dsh",
        "timestamp": 1618261826
    },
    {
        "content": "<p>Unfortunately I'm not sure - I didn't set up the dockerhub integration and TBH I don't really understand how it works.</p>\n<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> any ideas?</p>",
        "id": 234235174,
        "sender_full_name": "James Agnew",
        "timestamp": 1618263467
    },
    {
        "content": "<p>The CLI jar does not get bundle in the Docker image, so you will want to build a separate docker image with just the CLI put on it that you can run in interactive mode that has access to the database</p>",
        "id": 234236458,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264219
    },
    {
        "content": "<p>Really, the CLI's primary (sole?) purpose is to upgrade the database schema/data</p>",
        "id": 234236481,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264232
    },
    {
        "content": "<p>So, you could theoretically run the CLI on <em>any</em> VM or machine that has access to the database</p>",
        "id": 234236502,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264250
    },
    {
        "content": "<p>(it doesn't necessarily have to be run through docker)</p>",
        "id": 234236525,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264270
    },
    {
        "content": "<p>besides that, I don't think you would want to start the 5.2 docker service before upgrading the database schema with the CLI</p>",
        "id": 234236621,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264335
    },
    {
        "content": "<p>so, even if the CLI were packaged with the docker image that runs the HAPI service, you wouldn't want it to run right away...</p>",
        "id": 234236669,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264371
    },
    {
        "content": "<p>really, I think best to take down the docker stack, run the cli on a machine that has access to the database, and then start the new stack with 5.2</p>",
        "id": 234236710,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264402
    },
    {
        "content": "<p>hope that helps and makes sense</p>",
        "id": 234236717,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618264406
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> thanks for the reply. So I am running cli from 5.3 right now, so I am assuming I will be on 5.3 database wise...but  I am not sure if I can run HAPI 5.4 against schema of 5.3</p>",
        "id": 234238695,
        "sender_full_name": "dsh",
        "timestamp": 1618265624
    },
    {
        "content": "<p>on another note, the migrate I just started on a 2.7GB database has  been running for over 30 min now and I don't know how long will it run</p>",
        "id": 234238783,
        "sender_full_name": "dsh",
        "timestamp": 1618265669
    },
    {
        "content": "<p>so based on 2.7GB migrate taking over 30 minutes I am assuming 190GB production database will take over 24 hours if not more <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span> <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span></p>",
        "id": 234238871,
        "sender_full_name": "dsh",
        "timestamp": 1618265736
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span>  <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> where is the Dockerfile used to create the <a href=\"https://hub.docker.com/layers/hapiproject/hapi/v5.4.0/images/sha256-c1aeaef66181769e8962cfd5d756c04664b653c2d1fcbf427407823cc9291267?context=explore\">5.4 image</a></p>\n<p>perhaps I can use that to create an image for HAPI 5.3</p>",
        "id": 234239193,
        "sender_full_name": "dsh",
        "timestamp": 1618265964
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191783\">Daya Sharma</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20to.205.2Ex.20HAPI.20in.20Docker/near/234239193\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span>  <span class=\"user-mention silent\" data-user-id=\"191427\">Jens Villadsen</span> where is the Dockerfile used to create the <a href=\"https://hub.docker.com/layers/hapiproject/hapi/v5.4.0/images/sha256-c1aeaef66181769e8962cfd5d756c04664b653c2d1fcbf427407823cc9291267?context=explore\">5.4 image</a></p>\n<p>perhaps I can use that to create an image for HAPI 5.3</p>\n</blockquote>\n<p>never mind I think I found it <a href=\"https://github.com/hms-dbmi/hapi-fhir-docker/blob/master/Dockerfile\">https://github.com/hms-dbmi/hapi-fhir-docker/blob/master/Dockerfile</a></p>",
        "id": 234239566,
        "sender_full_name": "dsh",
        "timestamp": 1618266177
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191783\">Daya Sharma</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20to.205.2Ex.20HAPI.20in.20Docker/near/234238871\">said</a>:</p>\n<blockquote>\n<p>so based on 2.7GB migrate taking over 30 minutes I am assuming 190GB production database will take over 24 hours if not more <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span> <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span></p>\n</blockquote>\n<p>This is the slowest migration I have ever seen ... its updating 10K rows in 10 min<br>\n<code>2021-04-12 22:23:33.924 [worker--2] INFO  c.u.f.j.m.t.BaseColumnCalculatorTask 5_0_0.20200501.3: Updated 10000 rows on HFJ_SPIDX_DATE in 00:10:22</code></p>",
        "id": 234240954,
        "sender_full_name": "dsh",
        "timestamp": 1618267072
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191783\">Daya Sharma</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20to.205.2Ex.20HAPI.20in.20Docker/near/234239566\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191783\">Daya Sharma</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20to.205.2Ex.20HAPI.20in.20Docker/near/234239193\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span>  <span class=\"user-mention silent\" data-user-id=\"191427\">Jens Villadsen</span> where is the Dockerfile used to create the <a href=\"https://hub.docker.com/layers/hapiproject/hapi/v5.4.0/images/sha256-c1aeaef66181769e8962cfd5d756c04664b653c2d1fcbf427407823cc9291267?context=explore\">5.4 image</a></p>\n<p>perhaps I can use that to create an image for HAPI 5.3</p>\n</blockquote>\n<p>never mind I think I found it <a href=\"https://github.com/hms-dbmi/hapi-fhir-docker/blob/master/Dockerfile\">https://github.com/hms-dbmi/hapi-fhir-docker/blob/master/Dockerfile</a></p>\n</blockquote>\n<p>hmm I was mistaken that Dockerfile is not the right one. <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> could you please point me to someone who can share that Dockerfile source and someone who can comment on the slowness of the <code>./hapi-fhir-cli migrate-database</code> as mentioned above ^^</p>",
        "id": 234241522,
        "sender_full_name": "dsh",
        "timestamp": 1618267506
    },
    {
        "content": "<p>Is this the one <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/Dockerfile\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/Dockerfile</a> ?</p>",
        "id": 234242180,
        "sender_full_name": "dsh",
        "timestamp": 1618267948
    },
    {
        "content": "<p>its now 2 hours and counting for 3GB database migration <span aria-label=\"worried\" class=\"emoji emoji-1f61f\" role=\"img\" title=\"worried\">:worried:</span></p>",
        "id": 234245526,
        "sender_full_name": "dsh",
        "timestamp": 1618270069
    },
    {
        "content": "<p>ok it finally finished in 2 hours and 14 min, the most time taken by was by task <code> c.u.f.j.m.t.BaseColumnCalculatorTask</code> approx  2 hours</p>",
        "id": 234246164,
        "sender_full_name": "dsh",
        "timestamp": 1618270472
    },
    {
        "content": "<p>Further progress and hurdles...</p>\n<p>Creating Docker image for 5.3 after unzipping source code from <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/releases/tag/v5.3.0\">release tagged 5.3</a></p>\n<div class=\"codehilite\"><pre><span></span><code>[ec2-user@ip-xxxxxx hapi-fhir-jpaserver-starter-5.3.0]$ docker build -t hapi-fhir-jpaserver-start:5.3.0 .\nSending build context to Docker daemon  10.98MB\nStep 1/11 : FROM maven:3.6.3-jdk-11-slim as build-hapi\n ---&gt; 0627c0e38d77\nStep 2/11 : WORKDIR /tmp/hapi-fhir-jpaserver-starter\n ---&gt; Using cache\n ---&gt; f70b7367b352\nStep 3/11 : COPY pom.xml .\n ---&gt; Using cache\n ---&gt; 433846491b8e\nStep 4/11 : RUN mvn -e -ntp dependency:go-offline\n ---&gt; Running in cc1b3bd0e402\n[INFO] Error stacktraces are turned on.\n[INFO] Scanning for projects...\n[WARNING] The project ca.uhn.hapi.fhir:hapi-fhir-jpaserver-starter:war:5.3.0 uses prerequisites which is only intended for maven-plugin projects but not for non maven-plugin projects. For such purposes you should use the maven-enforcer-plugin. See https://maven.apache.org/enforcer/enforcer-rules/requireMavenVersion.html\n[INFO]\n[INFO] ------------&lt; ca.uhn.hapi.fhir:hapi-fhir-jpaserver-starter &gt;------------\n[INFO] Building HAPI FHIR JPA Server - Starter Project 5.3.0\n[INFO] --------------------------------[ war ]---------------------------------\n[INFO]\n[INFO] --- maven-dependency-plugin:3.1.2:go-offline (default-cli) @ hapi-fhir-jpaserver-starter ---\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD FAILURE\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  23.450 s\n[INFO] Finished at: 2021-04-13T00:07:24Z\n[INFO] ------------------------------------------------------------------------\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-dependency-plugin:3.1.2:go-offline (default-cli) on project hapi-fhir-jpaserver-starter: org.eclipse.aether.resolution.DependencyResolutionException: Could not find artifact ca.uhn.hapi.fhir:hapi-fhir-testpage-overlay:jar:5.3.0 in oss-snapshots (https://oss.sonatype.org/content/repositories/snapshots/) -&gt; [Help 1]\norg.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.apache.maven.plugins:maven-dependency-plugin:3.1.2:go-offline (default-cli) on project hapi-fhir-jpaserver-starter: org.eclipse.aether.resolution.DependencyResolutionException: Could not find artifact ca.uhn.hapi.fhir:hapi-fhir-testpage-overlay:jar:5.3.0 in oss-snapshots (https://oss.sonatype.org/content/repositories/snapshots/)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:215)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:156)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:148)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:117)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:81)\n    at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build (SingleThreadedBuilder.java:56)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute (LifecycleStarter.java:128)\n    at org.apache.maven.DefaultMaven.doExecute (DefaultMaven.java:305)\n    at org.apache.maven.DefaultMaven.doExecute (DefaultMaven.java:192)\n    at org.apache.maven.DefaultMaven.execute (DefaultMaven.java:105)\n    at org.apache.maven.cli.MavenCli.execute (MavenCli.java:957)\n    at org.apache.maven.cli.MavenCli.doMain (MavenCli.java:289)\n    at org.apache.maven.cli.MavenCli.main (MavenCli.java:193)\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0 (Native Method)\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke (NativeMethodAccessorImpl.java:62)\n    at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke (DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke (Method.java:566)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced (Launcher.java:282)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launch (Launcher.java:225)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode (Launcher.java:406)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.main (Launcher.java:347)\nCaused by: org.apache.maven.plugin.MojoExecutionException: org.eclipse.aether.resolution.DependencyResolutionException: Could not find artifact ca.uhn.hapi.fhir:hapi-fhir-testpage-overlay:jar:5.3.0 in oss-snapshots (https://oss.sonatype.org/content/repositories/snapshots/)\n    at org.apache.maven.plugins.dependency.resolvers.GoOfflineMojo.doExecute (GoOfflineMojo.java:88)\n    at org.apache.maven.plugins.dependency.AbstractDependencyMojo.execute (AbstractDependencyMojo.java:144)\n    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo (DefaultBuildPluginManager.java:137)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:210)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:156)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:148)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:117)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:81)\n    at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build (SingleThreadedBuilder.java:56)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute (LifecycleStarter.java:128)\n    at org.apache.maven.DefaultMaven.doExecute (DefaultMaven.java:305)\n    at org.apache.maven.DefaultMaven.doExecute (DefaultMaven.java:192)\n    at org.apache.maven.DefaultMaven.execute (DefaultMaven.java:105)\n    at org.apache.maven.cli.MavenCli.execute (MavenCli.java:957)\n    at org.apache.maven.cli.MavenCli.doMain (MavenCli.java:289)\n    at org.apache.maven.cli.MavenCli.main (MavenCli.java:193)\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0 (Native Method)\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke (NativeMethodAccessorImpl.java:62)\n    at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke (DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke (Method.java:566)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced (Launcher.java:282)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launch (Launcher.java:225)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode (Launcher.java:406)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.main (Launcher.java:347)\nCaused by: org.apache.maven.shared.transfer.dependencies.resolve.internal.Maven31DependencyResolverException: org.eclipse.aether.resolution.DependencyResolutionException: Could not find artifact ca.uhn.hapi.fhir:hapi-fhir-testpage-overlay:jar:5.3.0 in oss-snapshots (https://oss.sonatype.org/content/repositories/snapshots/)\n    at org.apache.maven.shared.transfer.dependencies.resolve.internal.Maven31DependencyResolver.resolveDependencies (Maven31DependencyResolver.java:251)\n    at org.apache.maven.shared.transfer.dependencies.resolve.internal.Maven31DependencyResolver.resolveDependencies (Maven31DependencyResolver.java:90)\n    at org.apache.maven.shared.transfer.dependencies.resolve.internal.DefaultDependencyResolver.resolveDependencies (DefaultDependencyResolver.java:85)\n    at org.apache.maven.plugins.dependency.resolvers.GoOfflineMojo.resolveDependableCoordinate (GoOfflineMojo.java:125)\n    at org.apache.maven.plugins.dependency.resolvers.GoOfflineMojo.resolveDependencyArtifacts (GoOfflineMojo.java:112)\n    at org.apache.maven.plugins.dependency.resolvers.GoOfflineMojo.doExecute (GoOfflineMojo.java:68)\n    at org.apache.maven.plugins.dependency.AbstractDependencyMojo.execute (AbstractDependencyMojo.java:144)\n    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo (DefaultBuildPluginManager.java:137)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:210)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:156)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:148)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:117)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:81)\n    at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build (SingleThreadedBuilder.java:56)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute (LifecycleStarter.java:128)\n    at org.apache.maven.DefaultMaven.doExecute (DefaultMaven.java:305)\n    at org.apache.maven.DefaultMaven.doExecute (DefaultMaven.java:192)\n    at org.apache.maven.DefaultMaven.execute (DefaultMaven.java:105)\n    at org.apache.maven.cli.MavenCli.execute (MavenCli.java:957)\n    at org.apache.maven.cli.MavenCli.doMain (MavenCli.java:289)\n    at org.apache.maven.cli.MavenCli.main (MavenCli.java:193)\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0 (Native Method)\n    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke (NativeMethodAccessorImpl.java:62)\n    at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke (DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke (Method.java:566)\n</code></pre></div>\n<p>Basically it boils down to **Could not find artifact ca.uhn.hapi.fhir:hapi-fhir-testpage-overlay:jar:5.3.0 in oss-snapshots (<a href=\"https://oss.sonatype.org/content/repositories/snapshots/\">https://oss.sonatype.org/content/repositories/snapshots/</a>)<br>\n**<br>\nComplete logs <a href=\"https://gist.github.com/8b37418d9b3cd6fd4cead7249f646dc3\">are here</a></p>\n<p>Any idea what the problem might be? Is this the reason why 5.3 docker image was never released? If not then can someone <strong>please </strong> guide me how I can solve the above problem?</p>",
        "id": 234247923,
        "sender_full_name": "dsh",
        "timestamp": 1618271788
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  any help here ^ is much appreciated</p>",
        "id": 234248061,
        "sender_full_name": "dsh",
        "timestamp": 1618271887
    },
    {
        "content": "<p>as I am not a Java guy</p>",
        "id": 234248073,
        "sender_full_name": "dsh",
        "timestamp": 1618271896
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>   ^ any idea? seems this problem was also mentioned about 2 months ago <a href=\"https://groups.google.com/g/hapi-fhir/c/obU2xqJ4eBs\">here</a></p>",
        "id": 234249721,
        "sender_full_name": "dsh",
        "timestamp": 1618272966
    },
    {
        "content": "<p>on further digging I found this in Nexus <a href=\"https://i.imgur.com/VC5T2fm.png\">https://i.imgur.com/VC5T2fm.png</a> not sure if that's the jar dependency not found by maven ?</p>\n<div class=\"message_inline_image\"><a href=\"https://i.imgur.com/VC5T2fm.png\"><img src=\"https://i.imgur.com/VC5T2fm.png\"></a></div>",
        "id": 234249917,
        "sender_full_name": "dsh",
        "timestamp": 1618273189
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191783\">@dsh</span> The <code>Dockerfile</code> for that project is here: <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/Dockerfile\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/Dockerfile</a></p>\n<p>I have had similar problems building the 5.3 branch for a long time. I haven't tried in quite a while. I had hoped it would have been resolved by now, but it appears maybe not... Would have to lean on <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> to address why dependency resolution is failing for the testpgae-overlay:5.3</p>\n<p>My main idea for why the CLI would be running slowly is related to the location of the CLI compared to the database server... Maybe try running the CLI from a machine that is sitting <em>very close</em> to the DB, if it's not already? Otherwise, again, would have to defer to James.</p>",
        "id": 234274277,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295014
    },
    {
        "content": "<p>With that said.. I don't see a <code>rel_5_3_0</code> branch, yet. But, <code>master</code> seems to indicate that it is 5.3.0. So I'm altering the CI build on Docker Hub to build the <code>master</code> branch as <code>latest</code>, which currently happens to be 5.3.0</p>",
        "id": 234274938,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295521
    },
    {
        "content": "<p>Guessing James &amp; company are getting ready to release 5.3.0 of the <code>hapi-fhir-jpaserver-starter</code> project and haven't yet wrapped it all up? which would explain why <code>rel_5_3_0</code> doesn't exist yet?</p>",
        "id": 234275022,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295569
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span>  I thought <code>master</code> branch was 5.4.0, no ?</p>",
        "id": 234275095,
        "sender_full_name": "dsh",
        "timestamp": 1618295615
    },
    {
        "content": "<p>Not according to <code>pom.xml</code> here: <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/pom.xml\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/pom.xml</a></p>",
        "id": 234275202,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295659
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>    &lt;parent&gt;\n        &lt;groupId&gt;ca.uhn.hapi.fhir&lt;/groupId&gt;\n        &lt;artifactId&gt;hapi-fhir&lt;/artifactId&gt;\n        &lt;!-- FIMXME KBD Change this to 5.3.0 BEFORE merging this code to master !  --&gt;\n        &lt;version&gt;5.3.0&lt;/version&gt;\n    &lt;/parent&gt;\n</code></pre></div>",
        "id": 234275212,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295669
    },
    {
        "content": "<p>so then the docker tagging is wrong?</p>",
        "id": 234275303,
        "sender_full_name": "dsh",
        "timestamp": 1618295753
    },
    {
        "content": "<p>Anyways... <code>:latest</code> is building now on docker hub. We'll see if it succeeds.<br>\n<a href=\"https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/2fef2357-efaf-4777-86a7-d9fcae294ed2\">https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/2fef2357-efaf-4777-86a7-d9fcae294ed2</a><br>\nBut, I gotta go to bed for now. I'll check in on it in the AM.</p>",
        "id": 234275350,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295769
    },
    {
        "content": "<p>\"the docker tag is wrong\"...<br>\nnot sure which one you're referring to</p>",
        "id": 234275393,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295816
    },
    {
        "content": "<p>I don't see 5.3.0 on <a href=\"https://hub.docker.com/repository/docker/hapiproject/hapi/tags?page=1&amp;ordering=last_updated\">https://hub.docker.com/repository/docker/hapiproject/hapi/tags?page=1&amp;ordering=last_updated</a></p>",
        "id": 234275410,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295836
    },
    {
        "content": "<p>this one <a href=\"https://hub.docker.com/layers/hapiproject/hapi/v5.4.0/images/sha256-c1aeaef66181769e8962cfd5d756c04664b653c2d1fcbf427407823cc9291267?context=explore\">https://hub.docker.com/layers/hapiproject/hapi/v5.4.0/images/sha256-c1aeaef66181769e8962cfd5d756c04664b653c2d1fcbf427407823cc9291267?context=explore</a></p>",
        "id": 234275412,
        "sender_full_name": "dsh",
        "timestamp": 1618295839
    },
    {
        "content": "<p>there should not be 5.4.0 on docker hub</p>",
        "id": 234275434,
        "sender_full_name": "dsh",
        "timestamp": 1618295858
    },
    {
        "content": "<p>Oh, I see</p>",
        "id": 234275448,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295878
    },
    {
        "content": "<p>yah, I agree, it's weird</p>",
        "id": 234275453,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295880
    },
    {
        "content": "<p>another <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  question</p>",
        "id": 234275489,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295885
    },
    {
        "content": "<p>I'm not sure why they created <code>rel_5_4_0</code> without there being a <code>rel_5_3_0</code></p>",
        "id": 234275512,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295900
    },
    {
        "content": "<p>I suspect it may have been done in error</p>",
        "id": 234275514,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295905
    },
    {
        "content": "<p>but, maybe not... the <code>pom.xml</code> in <code>rel_5_4_0</code> has:</p>\n<div class=\"codehilite\"><pre><span></span><code>    &lt;parent&gt;\n        &lt;groupId&gt;ca.uhn.hapi.fhir&lt;/groupId&gt;\n        &lt;artifactId&gt;hapi-fhir&lt;/artifactId&gt;\n        &lt;!-- FIMXME KBD Change this to 5.3.0 BEFORE merging this code to master !  --&gt;\n        &lt;version&gt;5.4.0-PRE2-SNAPSHOT&lt;/version&gt;\n    &lt;/parent&gt;\n</code></pre></div>",
        "id": 234275542,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295942
    },
    {
        "content": "<p>So, that seems intentional</p>",
        "id": 234275545,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295946
    },
    {
        "content": "<p>So, I guess I just can't explain why there is <code>rel_5_4_0</code> but no <code>rel_5_3_0</code></p>",
        "id": 234275569,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295973
    },
    {
        "content": "<p>so it seems 5.3.0 was skipped and that bring me to the question that if I should be using 5.4.0 then where is the corresponding <code>hapi-fhir-cli</code> of 5.4.0</p>",
        "id": 234275592,
        "sender_full_name": "dsh",
        "timestamp": 1618295994
    },
    {
        "content": "<p>yes</p>",
        "id": 234275597,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618295998
    },
    {
        "content": "<p>agreed.. skipped, as far as I can tell</p>",
        "id": 234275624,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296004
    },
    {
        "content": "<p>according to the pom.xml, 5.4.0 is still PRE2-SNAPSHOT</p>",
        "id": 234275657,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296024
    },
    {
        "content": "<p>but 5.4.0 is not production ready yet, and there is no 5.3.0</p>",
        "id": 234275666,
        "sender_full_name": "dsh",
        "timestamp": 1618296027
    },
    {
        "content": "<p>yah</p>",
        "id": 234275672,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296031
    },
    {
        "content": "<p>I think you need to get <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> to tell you what happened to <code>rel_5_3_0</code></p>",
        "id": 234275686,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296043
    },
    {
        "content": "<p>as soon as it exists, the Docker Hub CI will build a tag for <code>:v5.3.0</code></p>",
        "id": 234275695,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296056
    },
    {
        "content": "<p>thanks <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span></p>",
        "id": 234275702,
        "sender_full_name": "dsh",
        "timestamp": 1618296063
    },
    {
        "content": "<p>np</p>",
        "id": 234275705,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296066
    },
    {
        "content": "<p>FYI, <code>master</code> just finished building as <code>:latest</code></p>",
        "id": 234275741,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296107
    },
    {
        "content": "<p>so, you could play around with using that until you get answers from James</p>",
        "id": 234275767,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296123
    },
    {
        "content": "<p>if you wanted</p>",
        "id": 234275799,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296126
    },
    {
        "content": "<p>thanks that helps</p>",
        "id": 234275826,
        "sender_full_name": "dsh",
        "timestamp": 1618296146
    },
    {
        "content": "<p>the answer may be to just create a tag/branch of <code>master</code> as <code>rel_5_3_0</code></p>",
        "id": 234275841,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296157
    },
    {
        "content": "<p><em>shrug</em></p>",
        "id": 234275845,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296160
    },
    {
        "content": "<p>anyways... really gotta go to bed. :) g'nite!</p>",
        "id": 234275857,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618296169
    },
    {
        "content": "<p>On another note if I wanted to inject my own source for Spring integration in 5.3.0 then should I just start that docker image ? if not then I need to resolve teh above mentioned <code>maven</code> errors</p>",
        "id": 234275907,
        "sender_full_name": "dsh",
        "timestamp": 1618296207
    },
    {
        "content": "<p>good night</p>",
        "id": 234275914,
        "sender_full_name": "dsh",
        "timestamp": 1618296217
    },
    {
        "content": "<p>I have a hard time identifiying the problem here. Is there actually a problem?</p>",
        "id": 234286203,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618301832
    },
    {
        "content": "<p>Yes there are multiple problems</p>\n<p>5.3.0 docker image was missing, seems like it was skipped by mistake instead it was tagged 5.4.0 caused confusion since 5.4.0 is  not production ready.</p>",
        "id": 234286601,
        "sender_full_name": "dsh",
        "timestamp": 1618302038
    },
    {
        "content": "<p>That indeed sounds like a problem, yes. Is that the only problem?</p>",
        "id": 234286693,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618302094
    },
    {
        "content": "<p>plus there are bunch of maven problems trying to compile source tagged 5.3.0<br>\n<span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>  ^</p>",
        "id": 234286695,
        "sender_full_name": "dsh",
        "timestamp": 1618302096
    },
    {
        "content": "<p>But that maven resolution-thing was covered by <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/214\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/214</a></p>",
        "id": 234286859,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618302187
    },
    {
        "content": "<p>seems like the fix was after  5.3.0 source tag was created</p>",
        "id": 234286940,
        "sender_full_name": "dsh",
        "timestamp": 1618302234
    },
    {
        "content": "<p>well .. we can retag the 5.3.0 ... - thats an option</p>",
        "id": 234288335,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618302918
    },
    {
        "content": "<p>its just a tag</p>",
        "id": 234288373,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618302937
    },
    {
        "content": "<p>so u mean the current master is at 5.3.0 ? or you saying source tagged 5.3.0 will be built and docker image released</p>",
        "id": 234288609,
        "sender_full_name": "dsh",
        "timestamp": 1618303045
    },
    {
        "content": "<p>that wasn't what I said. I said we can make a new git tag</p>",
        "id": 234288660,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618303081
    },
    {
        "content": "<p>ok. what about the 5.3.0 docker image will that be recreated too from source tag 5.3.0 ? or from master ?</p>",
        "id": 234288812,
        "sender_full_name": "dsh",
        "timestamp": 1618303152
    },
    {
        "content": "<p>can't say ... I don't currenlt have the time to go into it ... check with <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> or <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> if they have the time to look into it.</p>",
        "id": 234289005,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618303239
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> - I believe retagging 'authorization' would best be placed at you</p>",
        "id": 234290595,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618304023
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20to.205.2Ex.20HAPI.20in.20Docker/near/234275350\">said</a>:</p>\n<blockquote>\n<p>Anyways... <code>:latest</code> is building now on docker hub. We'll see if it succeeds.<br>\n<a href=\"https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/2fef2357-efaf-4777-86a7-d9fcae294ed2\">https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/2fef2357-efaf-4777-86a7-d9fcae294ed2</a><br>\nBut, I gotta go to bed for now. I'll check in on it in the AM.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> is the latest docker image built off of <a href=\"https://github.com/hapifhir/hapi-fhir/releases/tag/v5.3.0\">https://github.com/hapifhir/hapi-fhir/releases/tag/v5.3.0</a> ?? or is it built off of master?</p>\n<p>The reason I ask I am upgrading HAPI JPA Server Starter from 4.1 to 5.3 but when I run latest against DB migrated by 5.3.0 <code>hapi-fhir-cli</code> I get so many errors related DDL statements</p>\n<div class=\"codehilite\"><pre><span></span><code>2021-04-13 17:16:22.025 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl [ExceptionHandlerLoggedImpl.java:27] GenerationTarget encountered exception accepting command : Error executing DDL &quot;create sequence seq_blkexcol_pid start 1 increment 50&quot; via JDBC Statement\norg.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL &quot;create sequence seq_blkexcol_pid start 1 increment 50&quot; via JDBC Statement\n</code></pre></div>",
        "id": 234368553,
        "sender_full_name": "dsh",
        "timestamp": 1618335038
    },
    {
        "content": "<p><code>:latest</code> -&gt; <code>master</code></p>",
        "id": 234369493,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335376
    },
    {
        "content": "<p>I defer to James for guidance on upgrades. I've <em>never</em> successfully upgraded my MySQL schemas using the CLI. I get similar errors to you.<br>\nOne thought: you're jumping a number of versions/updates between 4.1 and 5.3... Consider running the CLI for 4.2, then 4.3, then 5.0, then 5.1, etc.</p>",
        "id": 234369733,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335481
    },
    {
        "content": "<p>until you get to the version you want</p>",
        "id": 234369781,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335486
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> would someone be able to do a docker release of 5.3.0 from <a href=\"https://github.com/hapifhir/hapi-fhir/releases/tag/v5.3.0\">https://github.com/hapifhir/hapi-fhir/releases/tag/v5.3.0</a> ? just to avoid any problems</p>",
        "id": 234369834,
        "sender_full_name": "dsh",
        "timestamp": 1618335506
    },
    {
        "content": "<p>sure I'll try to do that</p>",
        "id": 234369867,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335521
    },
    {
        "content": "<p>one sec</p>",
        "id": 234369868,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335522
    },
    {
        "content": "<p>I <em>had</em> been basing Docker tags on GitHub branches</p>",
        "id": 234369919,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335541
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234369733\">said</a>:</p>\n<blockquote>\n<p>I defer to James for guidance on upgrades. I've <em>never</em> successfully upgraded my MySQL schemas using the CLI. I get similar errors to you.<br>\nOne thought: you're jumping a number of versions/updates between 4.1 and 5.3... Consider running the CLI for 4.2, then 4.3, then 5.0, then 5.1, etc.</p>\n</blockquote>\n<p>You are right that I am jumping the versions but in my findings so far the CLI was smart to upgrade database schema from 4.1-&gt;4.2.... to 5.3, so all I had to do was run it once</p>",
        "id": 234369973,
        "sender_full_name": "dsh",
        "timestamp": 1618335563
    },
    {
        "content": "<p>because that's how James&amp;Company had been doing releases</p>",
        "id": 234369975,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335565
    },
    {
        "content": "<p><code>:v5.3.0</code> is building based on github tag <code>v5.3.0</code> now</p>",
        "id": 234370265,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335677
    },
    {
        "content": "<p><a href=\"https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/f14236d8-9bca-47e1-b25a-3e3d980c6863\">https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/f14236d8-9bca-47e1-b25a-3e3d980c6863</a></p>",
        "id": 234370289,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618335687
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191783\">dsh</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234368553\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20to.205.2Ex.20HAPI.20in.20Docker/near/234275350\">said</a>:</p>\n<p>&gt; </p>\n<p>2021-04-13 17:16:22.025 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl [ExceptionHandlerLoggedImpl.java:27] GenerationTarget encountered exception accepting command : Error executing DDL \"create sequence seq_blkexcol_pid start 1 increment 50\" via JDBC Statement<br>\norg.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL \"create sequence seq_blkexcol_pid start 1 increment 50\" via JDBC Statement</p>\n<div class=\"codehilite\"><pre><span></span><code>````\nNow I am getting these error related to log stream\n</code></pre></div>\n<p>2021-04-13 17:45:12.629 [main] ERROR c.u.f.jpa.searchparam.retry.Retrier [Retrier.java:79] Retry failure 15/60: org.springframework.orm.jpa.JpaSystemException: Unable to access lob stream; nested exception is org.hibernate.HibernateException: Unable to access lob stream</p>\n<p><div class=\"codehilite\"><pre><span></span><code>Any ideas on how to fix them?\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 234370923,
        "sender_full_name": "dsh",
        "timestamp": 1618335930
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234370289\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/f14236d8-9bca-47e1-b25a-3e3d980c6863\">https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/f14236d8-9bca-47e1-b25a-3e3d980c6863</a></p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> could you please check the status of that build as I don't see 5.3.0 in docker hub at all. I cannot access that build URL</p>",
        "id": 234378410,
        "sender_full_name": "dsh",
        "timestamp": 1618338906
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> could you please confirm if using <a href=\"https://hub.docker.com/repository/registry-1.docker.io/hapiproject/hapi/builds/f14236d8-9bca-47e1-b25a-3e3d980c6863\">docker latest</a> is the right way to run JPA Starter 5.3.0 ??</p>",
        "id": 234381357,
        "sender_full_name": "dsh",
        "timestamp": 1618340164
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> ^ please let me know if I am on the right track?</p>",
        "id": 234381739,
        "sender_full_name": "dsh",
        "timestamp": 1618340329
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> latest is now 5.3.0</p>",
        "id": 234384224,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618341240
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191783\">@dsh</span> next time the project is tagged, the GH action on <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/.github/workflows/build-images.yaml\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/.github/workflows/build-images.yaml</a> is automatically run</p>",
        "id": 234384630,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618341406
    },
    {
        "content": "<p>Credit goes to <a href=\"https://github.com/chgl\">https://github.com/chgl</a></p>",
        "id": 234384716,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618341435
    },
    {
        "content": "<p>meaning that the push is done automatically</p>",
        "id": 234384752,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1618341451
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191783\">@dsh</span> that's because the v5.3.0 tag failed to build on docker hub:<br>\n<code>Could not find artifact ca.uhn.hapi.fhir:hapi-fhir-testpage-overlay:jar:5.3.0 in oss-snapshots</code><br>\nJust the same as you and I both previously got</p>",
        "id": 234387687,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618342683
    },
    {
        "content": "<p>Need <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> or someone to push <code>hapi-fhir-testpage-overlay:jar:5.3.0</code> to OSS</p>",
        "id": 234387750,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618342705
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> Thanks.</p>\n<p>Assuming <code>master</code> branch maps to <code>hapiproject/hapi:latest</code> I am unable to run JPA server on it <a href=\"#narrow/stream/179166-implementers/topic/HibernateException/near/234373419\">I get this error </a> </p>\n<div class=\"codehilite\"><pre><span></span><code>2021-04-13 19:05:21.598 [main] ERROR c.u.f.jpa.searchparam.retry.Retrier [Retrier.java:79] Retry failure 5/60: org.springframework.orm.jpa.JpaSystemException: Unable to access lob stream; nested exception is org.hibernate.HibernateException: Unable to access lob stream\n</code></pre></div>\n<p>any idea if <code>master</code> branch for Docker is even usable at the moment?</p>",
        "id": 234388846,
        "sender_full_name": "dsh",
        "timestamp": 1618343200
    },
    {
        "content": "<p>GIven that's an exception stemming from Hibernate, I suspect that has something to do with database connectivity?</p>",
        "id": 234388933,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618343239
    },
    {
        "content": "<p>Just a guess, though</p>",
        "id": 234388966,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618343247
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234387750\">said</a>:</p>\n<blockquote>\n<p>Need <span class=\"user-mention silent\" data-user-id=\"191319\">James Agnew</span> or someone to push <code>hapi-fhir-testpage-overlay:jar:5.3.0</code> to OSS</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> could you or someone please push <code>hapi-fhir-testpage-overlay:jar:5.3.0</code> to OSS <a href=\"https://i.imgur.com/VC5T2fm.png\">https://i.imgur.com/VC5T2fm.png</a></p>\n<div class=\"message_inline_image\"><a href=\"https://i.imgur.com/VC5T2fm.png\"><img src=\"https://i.imgur.com/VC5T2fm.png\"></a></div>",
        "id": 234390141,
        "sender_full_name": "dsh",
        "timestamp": 1618343712
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> to circle back on this ^ issue I just found the workaround <a href=\"https://github.com/openmrs/openmrs-contrib-plm-fhir-server/commit/5cd3dfe1d281a058ab1af6b8db163cb9d3e776ca\">https://github.com/openmrs/openmrs-contrib-plm-fhir-server/commit/5cd3dfe1d281a058ab1af6b8db163cb9d3e776ca</a></p>\n<p>Any idea why that PR has not been merged in the main branch ?</p>\n<p>BTW the workaround works!!! <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 234398249,
        "sender_full_name": "dsh",
        "timestamp": 1618347004
    },
    {
        "content": "<p>Couldn't tell you, to be honest. I only occasionally contribute to this repository :) So, not sure what has or has not been approved from PRs.</p>",
        "id": 234402529,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618348249
    },
    {
        "content": "<p>About all I can do right now is tell you how the docker builds work and modify the CI builds for Docker Hub :/</p>",
        "id": 234402660,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618348288
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> I understand. And thanks for your help. Now that I am able to build the release for 5.3.0, could you  help me with this server start error</p>\n<div class=\"codehilite\"><pre><span></span><code>2021-04-13 21:10:56.691 [main] ERROR c.u.f.jpa.searchparam.retry.Retrier [Retrier.java:79] Retry failure 5/60: org.springframework.orm.jpa.JpaSystemException: Unable to access lob stream; nested exception is org.hibernate.HibernateException: Unable to access lob stream\n</code></pre></div>\n<p>or pls let me know who can best help here</p>",
        "id": 234402910,
        "sender_full_name": "dsh",
        "timestamp": 1618348360
    },
    {
        "content": "<p>Finally I got past that error by running this PLSQL function on Large Objects in my Postgres 12.6 on AWS RDS</p>\n<div class=\"codehilite\"><pre><span></span><code>CREATE OR REPLACE FUNCTION public.grant_select_on_large_objects()\n RETURNS text\n LANGUAGE plpgsql\nAS $function$\n\n    DECLARE\n        REC BIGINT;\n\n    begin\n\n        FOR REC in   SELECT OID FROM pg_catalog.pg_largeobject_metadata\n        loop\n\n            execute &#39;grant select on LARGE OBJECT &#39; || REC || &#39; to caringly_db_master&#39;;\n\n--          select &#39;LOBID is &#39; || REC.oid;\n\n        END LOOP;\n\n        return &#39;DONE&#39;;\n    END;\n$function$\n;\n</code></pre></div>\n<p>but now I am facing another issue ... details here <a href=\"https://gist.github.com/f0249e5ce6fb5c3e6c376e59454268a2\">https://gist.github.com/f0249e5ce6fb5c3e6c376e59454268a2</a></p>\n<p>in short <strong> org.springframework.batch.core.JobParametersInvalidException: There must be a valid number for readChunkSize, which is at least 1. You must include [resourceTypes] as a Job Parameter</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>2021-04-14 07:28:34.139 [main] INFO  com.zaxxer.hikari.HikariDataSource [HikariDataSource.java:347] HikariPool-1 - Shutdown initiated...\n2021-04-14 07:28:34.140 [main] INFO  com.zaxxer.hikari.pool.HikariPool [HikariPool.java:204] HikariPool-1 - Close initiated...\n2021-04-14 07:28:34.159 [main] INFO  com.zaxxer.hikari.pool.HikariPool [HikariPool.java:238] HikariPool-1 - Closed.\n2021-04-14 07:28:34.160 [main] INFO  com.zaxxer.hikari.HikariDataSource [HikariDataSource.java:349] HikariPool-1 - Shutdown completed.\n14-Apr-2021 07:28:34.161 SEVERE [main] org.apache.catalina.startup.HostConfig.deployWAR Error deploying web application archive [/usr/local/tomcat/webapps/ROOT.war]\n    java.lang.IllegalStateException: Error starting child\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:720)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:690)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:706)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:978)\n        at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1848)\n        at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\n        at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:473)\n    Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]]\n        at org.apache.catalina.util.LifecycleBase.handleSubClassException(LifecycleBase.java:440)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:198)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:717)\n        ... 37 more\n    Caused by: java.lang.IllegalStateException: Failed to execute ApplicationRunner\n        at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)\n        at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:785)\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:333)\n        at org.springframework.boot.web.servlet.support.SpringBootServletInitializer.run(SpringBootServletInitializer.java:173)\n        at org.springframework.boot.web.servlet.support.SpringBootServletInitializer.createRootApplicationContext(SpringBootServletInitializer.java:153)\n        at org.springframework.boot.web.servlet.support.SpringBootServletInitializer.onStartup(SpringBootServletInitializer.java:95)\n        at org.springframework.web.SpringServletContainerInitializer.onStartup(SpringServletConta\ninerInitializer.java:174)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5128)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183)\n        ... 38 more\n    Caused by: org.springframework.batch.core.JobParametersInvalidException: There must be a valid number for readChunkSize, which is at least 1. You must include [resourceTypes] as a Job Parameter\n        at ca.uhn.fhir.jpa.bulk.job.BulkExportJobParameterValidator.validate(BulkExportJobParameterValidator.java:92)\n        at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:129)\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)\n        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)\n        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)\n        at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:127)\n        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)\n        at com.sun.proxy.$Proxy214.run(Unknown Source)\n        at org.springframework.boot.autoconfigure.batch.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:199)\n        at org.springframework.boot.autoconfigure.batch.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:173)\n        at org.springframework.boot.autoconfigure.batch.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:160)\n        at org.springframework.boot.autoconfigure.batch.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:155)\n        at org.springframework.boot.autoconfigure.batch.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:150)\n        at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:795)\n        ... 46 more\n14-Apr-2021 07:28:34.167 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/usr/local/tomcat/webapps/ROOT.war] has finished in [35,076] ms\n14-Apr-2021 07:28:34.177 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [&quot;http-nio-8080&quot;]\n14-Apr-2021 07:28:34.202 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in [35209] milliseconds\n</code></pre></div>",
        "id": 234455203,
        "sender_full_name": "dsh",
        "timestamp": 1618386196
    },
    {
        "content": "<p>Finally got the JPA server running but I don't see any of my previous data at all ... even though the CLI reported success <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>\n<p>I wonder if starting server with <code>hibernate.hbm2ddl.auto: create-drop</code> caused the data to be wiped out ?</p>",
        "id": 234460690,
        "sender_full_name": "dsh",
        "timestamp": 1618388880
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  could you please help here ?</p>",
        "id": 234518386,
        "sender_full_name": "dsh",
        "timestamp": 1618413474
    },
    {
        "content": "<p>If you set the DDL mode to <code>create-drop</code> that does drop the data when the system shuts down. These values are itemized here: <a href=\"https://stackoverflow.com/questions/438146/what-are-the-possible-values-of-the-hibernate-hbm2ddl-auto-configuration-and-wha\">https://stackoverflow.com/questions/438146/what-are-the-possible-values-of-the-hibernate-hbm2ddl-auto-configuration-and-wha</a></p>",
        "id": 234529530,
        "sender_full_name": "James Agnew",
        "timestamp": 1618417244
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  changing the value to <code>hibernate.hbm2ddl.auto: update</code> helped and I was start JPA normally and  see the data only if JDBC (postgresql) user is super user with DDL rights. <strong>However if the user is a regular user with DML rights then I get these kinds of errors</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>Hibernate: create sequence SEQ_VALUESET_PID start 1 increment 50\n2021-04-14 17:45:12.719 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl [ExceptionHandlerLoggedImpl.java:27] GenerationTarget encountered exception accepting command : Error executing DDL &quot;create sequence SEQ_VALUESET_PID start 1 increment 50&quot; via JDBC Statement\norg.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL &quot;create sequence SEQ_VALUESET_PID start 1 increment 50&quot; via JDBC Statement\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>Caused by: org.postgresql.util.PSQLException: ERROR: permission denied for table hfj_resource\n    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2505)\n    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2241)\n    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:310)\n    at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:447)\n    at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:368)\n    at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:158)\n    at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:108)\n    at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)\n    at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)\n    at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)\n    ... 111 common frames omitted\n2021-04-14 17:48:26.025 [main] ERROR c.u.f.jpa.searchparam.retry.Retrier [Retrier.java:79] Retry failure 10/60: ca.uhn.fhir.rest.server.exceptions.InternalErrorException: could not extract ResultSet\n</code></pre></div>",
        "id": 234544188,
        "sender_full_name": "dsh",
        "timestamp": 1618422565
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234402529\">said</a>:</p>\n<blockquote>\n<p>Couldn't tell you, to be honest. I only occasionally contribute to this repository :) So, not sure what has or has not been approved from PRs.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> I got past the error related to <code>hapi-fhir-testpage-overlay:jar:5.3.0</code> not found by maven by including this in <code>pom.xml</code></p>\n<div class=\"codehilite\"><pre><span></span><code>       &lt;pluginManagement&gt;\n          &lt;plugins&gt;\n              &lt;!--\n              There is a bug in 3.1.2 that prevents go-offline from working\n              Reported here:\n              https://issues.apache.org/jira/browse/MDEP-739\n              --&gt;\n              &lt;plugin&gt;\n                  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                  &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;\n                  &lt;version&gt;3.1.1&lt;/version&gt;\n              &lt;/plugin&gt;\n          &lt;/plugins&gt;\n      &lt;/pluginManagement&gt;\n</code></pre></div>\n<p>So with the above change could you please do  5.3.0 docker release ?</p>",
        "id": 234722884,
        "sender_full_name": "dsh",
        "timestamp": 1618509066
    },
    {
        "content": "<p>So, where is this change? I'm not seeing it in github anywhere...</p>",
        "id": 234725001,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618509918
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191783\">@dsh</span></p>",
        "id": 234725090,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618509962
    },
    {
        "content": "<p>here <a href=\"https://github.com/openmrs/openmrs-contrib-plm-fhir-server/commit/5cd3dfe1d281a058ab1af6b8db163cb9d3e776ca\">https://github.com/openmrs/openmrs-contrib-plm-fhir-server/commit/5cd3dfe1d281a058ab1af6b8db163cb9d3e776ca</a> referred in this issue <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/214\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/214</a></p>",
        "id": 234742725,
        "sender_full_name": "dsh",
        "timestamp": 1618516780
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span></p>",
        "id": 234742735,
        "sender_full_name": "dsh",
        "timestamp": 1618516783
    },
    {
        "content": "<p>so, that's in a different fork of hapi-fhir-jpaserer-starter</p>",
        "id": 234744765,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517542
    },
    {
        "content": "<p>docker hub is based on hapifhir/hapi-fhir-jpaserver-starter</p>",
        "id": 234744800,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517558
    },
    {
        "content": "<p>but the fix was referenced in the issue #214</p>",
        "id": 234744830,
        "sender_full_name": "dsh",
        "timestamp": 1618517571
    },
    {
        "content": "<p>and the fix works</p>",
        "id": 234744844,
        "sender_full_name": "dsh",
        "timestamp": 1618517580
    },
    {
        "content": "<p>it may be referenced in issue #214, but it's not incorporated in hapifhir/hapi-fhir-jpaserver-starter as far as I can tell</p>",
        "id": 234744888,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517599
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> ^</p>",
        "id": 234744891,
        "sender_full_name": "dsh",
        "timestamp": 1618517600
    },
    {
        "content": "<p>we need a commit on <code>hapifhir/hapi-fhir-jpaserver-starter</code> that applies a similar fix</p>",
        "id": 234744930,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517621
    },
    {
        "content": "<p>so if I do a pull request will you be able to merge it ?</p>",
        "id": 234745059,
        "sender_full_name": "dsh",
        "timestamp": 1618517664
    },
    {
        "content": "<p>I'm not sure where to merge it <em>to</em></p>",
        "id": 234745392,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517798
    },
    {
        "content": "<p>master...</p>",
        "id": 234745393,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517802
    },
    {
        "content": "<p>a new rel_5_3_0 branch?</p>",
        "id": 234745397,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517807
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> this was merged in master <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/12c19eff576a8b93eb26f922d46d988377c22f80#diff-9c5fb3d1b7e3b0f54bc5c4182965c4fe1f9023d449017cece3005d3f90e8e4d8\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/12c19eff576a8b93eb26f922d46d988377c22f80#diff-9c5fb3d1b7e3b0f54bc5c4182965c4fe1f9023d449017cece3005d3f90e8e4d8</a></p>",
        "id": 234745402,
        "sender_full_name": "dsh",
        "timestamp": 1618517809
    },
    {
        "content": "<p>ah!</p>",
        "id": 234745451,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517830
    },
    {
        "content": "<p>ok... so, master = 5.3.0</p>",
        "id": 234745460,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517835
    },
    {
        "content": "<p>and works</p>",
        "id": 234745468,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517839
    },
    {
        "content": "<p>?</p>",
        "id": 234745469,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517840
    },
    {
        "content": "<p>and I don't think <code>master</code> currently maps to <code>5.3.0</code></p>",
        "id": 234745477,
        "sender_full_name": "dsh",
        "timestamp": 1618517842
    },
    {
        "content": "<p>hm</p>",
        "id": 234745511,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517865
    },
    {
        "content": "<p>since 5.3.0 tag doesn't contain that fix</p>",
        "id": 234745517,
        "sender_full_name": "dsh",
        "timestamp": 1618517868
    },
    {
        "content": "<p>I think probably need to remove the 5.3.0 tag and re-create it based on master now</p>",
        "id": 234745557,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517883
    },
    {
        "content": "<p>I'm going to do that, since v5.3.0 tag doesn't currently build anyways</p>",
        "id": 234745658,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517921
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> is it safe to recreate 5.3.0 tag ?</p>",
        "id": 234745664,
        "sender_full_name": "dsh",
        "timestamp": 1618517923
    },
    {
        "content": "<p>hopefully that is the right decision and <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> doesn't get mad at me</p>",
        "id": 234745685,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517932
    },
    {
        "content": "<p>lol</p>",
        "id": 234745687,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517933
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span>  I think master may be 5.4.0 snapshot</p>",
        "id": 234745713,
        "sender_full_name": "dsh",
        "timestamp": 1618517946
    },
    {
        "content": "<p>not according to pom.xml in master</p>",
        "id": 234745775,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517971
    },
    {
        "content": "<p>pom.xml in master says 5.3.0</p>",
        "id": 234745782,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517976
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>    &lt;parent&gt;\n        &lt;groupId&gt;ca.uhn.hapi.fhir&lt;/groupId&gt;\n        &lt;artifactId&gt;hapi-fhir&lt;/artifactId&gt;\n        &lt;!-- FIMXME KBD Change this to 5.3.0 BEFORE merging this code to master !  --&gt;\n        &lt;version&gt;5.3.0&lt;/version&gt;\n    &lt;/parent&gt;\n</code></pre></div>",
        "id": 234745806,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618517987
    },
    {
        "content": "<p><a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/pom.xml#L18\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/pom.xml#L18</a></p>",
        "id": 234745908,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518011
    },
    {
        "content": "<p>on another front could you please help me with this problem in upgrade <a href=\"#narrow/stream/179167-hapi/topic/Migrating.20existing.20resources.20to.20use.20Profiles/near/234743410\">https://chat.fhir.org/#narrow/stream/179167-hapi/topic/Migrating.20existing.20resources.20to.20use.20Profiles/near/234743410</a></p>\n<p>or point me to the right folks</p>",
        "id": 234745965,
        "sender_full_name": "dsh",
        "timestamp": 1618518032
    },
    {
        "content": "<p>github tag v5.3.0 currently points to this commit: <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/46e0f8f37de97ed8823c5f7190218a3b2e66f165\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/46e0f8f37de97ed8823c5f7190218a3b2e66f165</a><br>\nI'm removing that tag, and re-creating it from master right now, which currently builds OK, includes the fix mentioned above, and points to HAPI core libraries v5.3.0</p>",
        "id": 234746097,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518092
    },
    {
        "content": "<p>done</p>",
        "id": 234746289,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518177
    },
    {
        "content": "<p>docker hub detected the tag change, and is re-building the docker image</p>",
        "id": 234746313,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518188
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191783\">dsh</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234745965\">said</a>:</p>\n<blockquote>\n<p>on another front could you please help me with this problem in upgrade <a href=\"#narrow/stream/179167-hapi/topic/Migrating.20existing.20resources.20to.20use.20Profiles/near/234743410\">https://chat.fhir.org/#narrow/stream/179167-hapi/topic/Migrating.20existing.20resources.20to.20use.20Profiles/near/234743410</a></p>\n<p>or point me to the right folks</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span>  any idea on how I can move forward on this last step in the upgrade process</p>",
        "id": 234746495,
        "sender_full_name": "dsh",
        "timestamp": 1618518266
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191505\">Sean McIlvenna</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234744930\">said</a>:</p>\n<blockquote>\n<p>we need a commit on <code>hapifhir/hapi-fhir-jpaserver-starter</code> that applies a similar fix</p>\n</blockquote>\n<p>That's actually <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commit/12c19eff576a8b93eb26f922d46d988377c22f80\">this commit</a>, which should be present in 5.3.0 already.</p>",
        "id": 234746531,
        "sender_full_name": "Ian Bacher",
        "timestamp": 1618518282
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"259065\">@Ian Bacher</span> you are right... however, the tag for v5.3.0 was created before the commit</p>",
        "id": 234746850,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518400
    },
    {
        "content": "<p>so, building from the tag was still broken</p>",
        "id": 234746884,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518413
    },
    {
        "content": "<p>that's why I had to move the tag</p>",
        "id": 234746892,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518416
    },
    {
        "content": "<p>Oh, I see! I'm the maintainer of the fork... we've really just made a very small number of changes and use an GitHub bot to keep up-to-date, so I was surprised by the implication that there was a commit in our repo that wasn't in master.</p>",
        "id": 234747023,
        "sender_full_name": "Ian Bacher",
        "timestamp": 1618518476
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> : I use R4 of the 5.4.0 Pre5 and I cannot find the ReferralRequest class, I think it is replaced by another class or it is not support by current version of HAPI, if it is not support by current HAPI version could you give me an advice what class can be used for keep Transfer Patient Information (maybe ServiceRequest)? Thanks for your support</p>",
        "id": 234808792,
        "sender_full_name": "Jame Dang",
        "timestamp": 1618558738
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399592\">@Jame Dang</span> There's nothing HAPI-specific about it. In R4, ReferralRequest and ProcedureRequest were merged into ServiceRequest. Note that the usual way to store intra-facilitiy or intra-organisational transfers is to track it via the Encounter.</p>",
        "id": 234858990,
        "sender_full_name": "Ian Bacher",
        "timestamp": 1618582036
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"259065\">@Ian Bacher</span> : I'm using ServiceRequest now, thank you for your confirmation</p>",
        "id": 234859299,
        "sender_full_name": "Jame Dang",
        "timestamp": 1618582137
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191783\">dsh</span> <a href=\"#narrow/stream/179167-hapi/topic/Upgrading.20from.204.2E1.20HAPI.20JPA.20.20to.205.2E3.20in.20Docker/near/234544188\">said</a>:</p>\n<blockquote>\n<p>Thanks <span class=\"user-mention silent\" data-user-id=\"191319\">James Agnew</span>  changing the value to <code>hibernate.hbm2ddl.auto: update</code> helped and I was able to start JPA normally and  see the data only if JDBC (postgresql) user is super user with DDL rights. <strong>However if the user is a regular user with DML rights then I get these kinds of errors</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>Hibernate: create sequence SEQ_VALUESET_PID start 1 increment 50\n2021-04-14 17:45:12.719 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl [ExceptionHandlerLoggedImpl.java:27] GenerationTarget encountered exception accepting command : Error executing DDL &quot;create sequence SEQ_VALUESET_PID start 1 increment 50&quot; via JDBC Statement\norg.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL &quot;create sequence SEQ_VALUESET_PID start 1 increment 50&quot; via JDBC Statement\n</code></pre></div>\n<p><div class=\"codehilite\"><pre><span></span><code>Caused by: org.postgresql.util.PSQLException: ERROR: relation &quot;seq_spidx_quantity_nrml&quot; already exists\n    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2505)\n    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2241)\n    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:310)\n    at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:447)\n    at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:368)\n    at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:309)\n    at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:295)\n    at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:272)\n    at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:267)\n    at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:98)\n    at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)\n    at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:54)```\n````\n@**James Agnew** or @**Ian Bacher**  any pointers here ^ ?\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 234866893,
        "sender_full_name": "dsh",
        "timestamp": 1618584880
    },
    {
        "content": "<p>sounds like you need to give the user more privileges</p>",
        "id": 234875451,
        "sender_full_name": "James Agnew",
        "timestamp": 1618587482
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> since the <code>\"seq_spidx_quantity_nrml\"</code> relation already exists any idea on why its need to be recreated? and the surprising thing is its no impacting any resource creation logic ... but may this will bite when <strong>write</strong> load is heavy</p>",
        "id": 234877799,
        "sender_full_name": "dsh",
        "timestamp": 1618588363
    },
    {
        "content": "<p>For those facing the same problem I was able to cross this hurdle by executing the output of this statement in psql shell</p>\n<div class=\"codehilite\"><pre><span></span><code>select &#39;ALTER TABLE &#39; || sequence_name || &#39; OWNER TO hapi_user;&#39; from information_schema.sequences where sequence_schema = &#39;public&#39;;\n</code></pre></div>\n<p>change <strong>hapi_user</strong> to whatever your username is</p>",
        "id": 234879513,
        "sender_full_name": "dsh",
        "timestamp": 1618588938
    }
]