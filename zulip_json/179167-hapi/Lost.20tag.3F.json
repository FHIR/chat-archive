[
    {
        "content": "<p>When I POST an Observation with a tag to <a href=\"http://hapi.fhir.org/baseR4/Observation\" target=\"_blank\" title=\"http://hapi.fhir.org/baseR4/Observation\">http://hapi.fhir.org/baseR4/Observation</a>, the creation succeeds, but the tag is dropped.  Are there some rules around what tags HAPI FHIR accepts?  The WildFHIR server keeps the tag when I post it there.  Here's an Observation for my test case:</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;resourceType&quot;: &quot;Observation&quot;,\n  &quot;status&quot;: &quot;final&quot;,\n  &quot;code&quot;: {\n    &quot;coding&quot;: [\n      {\n        &quot;system&quot;: &quot;http://loinc.org&quot;,\n        &quot;code&quot;: &quot;29463-7&quot;,\n        &quot;display&quot;: &quot;Weight&quot;\n      }\n    ],\n    &quot;text&quot;: &quot;Weight&quot;\n  },\n  &quot;meta&quot;: {\n    &quot;tag&quot;: [\n      {\n        &quot;display&quot;: &quot;lformsVersion: 22.0.0&quot;\n      }\n    ]\n  },\n  &quot;valueQuantity&quot;: {\n    &quot;value&quot;: &quot;42&quot;,\n    &quot;code&quot;: &quot;kg&quot;,\n    &quot;system&quot;: &quot;http://unitsofmeasure.org&quot;\n  },\n  &quot;effectiveDateTime&quot;: &quot;2020-03-19T15:12:25.585Z&quot;,\n  &quot;issued&quot;: &quot;2020-03-19T15:12:25.585Z&quot;\n}\n</pre></div>",
        "id": 191169439,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1584649001
    },
    {
        "content": "<p>HAPI requires tags to have at least a system or a value, so it ignores tags that are only a display name</p>",
        "id": 191170384,
        "sender_full_name": "James Agnew",
        "timestamp": 1584649522
    },
    {
        "content": "<p>Is that correct behavior?  In a coding, \"code\" is not required, and I think the only use of coding without a code would be to have an uncoded \"display\".</p>",
        "id": 191173463,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1584651023
    },
    {
        "content": "<p>It's definitely not behaviour that is mandated by the spec or anything like that.. but it is definitely how the current design works. Kind of like HAPI's requirement out of the box that client-assigned IDs be non-numbers</p>",
        "id": 191177170,
        "sender_full_name": "James Agnew",
        "timestamp": 1584652977
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> I am not sure if you are saying that this is a known issue with HAPI which, time permitting, will eventually be addressed (very understandable) or that you think it is okay for a server to place additional restrictions on resources beyond what FHIR specifies.  The latter, unless done through profiling, causes problems for interoperability, doesn't it?   (This is more of a theoretical question; it is not hard for me to add a code to my tag.)</p>",
        "id": 191239542,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1584709586
    },
    {
        "content": "<p>I guess I'm characterizing it as \"sub-optimal behaviour that will hopefully either be fixed completely or be made configurable in the future, but that isn't currently being worked on\". I am sure that every FHIR server out there has a few gremlins like this one that are based on their particular design. :)</p>\n<p>A bigger priority for me is that HAPI's tagging system does have some concurrency issues- creating a brand new (never before used) tag on two resources at the exact same time can lead to an optimistic lock failure, and this seems to burn a surprising number of people... Perhaps this issue would get fixed as a part of the fix for that one.</p>",
        "id": 191241813,
        "sender_full_name": "James Agnew",
        "timestamp": 1584710808
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191319\">James Agnew</span> <a href=\"#narrow/stream/179167-hapi/topic/Lost.20tag.3F/near/191241813\" title=\"#narrow/stream/179167-hapi/topic/Lost.20tag.3F/near/191241813\">said</a>:</p>\n<blockquote>\n<p>I am sure that every FHIR server out there has a few gremlins like this one that are based on their particular design. :)</p>\n</blockquote>\n<p>And the clients, too.  <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 191242091,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1584710945
    }
]