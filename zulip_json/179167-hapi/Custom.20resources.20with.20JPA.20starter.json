[
    {
        "content": "<p>Hi all,</p>\n<p>I'm currently working on a PoC with the JPA starter, but I can't seem to figure out the necessary pieces to get everything fully wired together.</p>\n<p>What I have:</p>\n<ul>\n<li>I've created the resource class <code>FavouriteCookie</code> and have registered it with <code>context.registerCustomTypes(...)</code><ul>\n<li>I followed the example here: <a href=\"https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#custom-resource-structure\">https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#custom-resource-structure</a></li>\n</ul>\n</li>\n<li>I've created <code>FavouriteCookieProvider</code> (patterned after <code>PatientResourceProvider</code>) and have <em>tried</em> to connect it up (example below)</li>\n</ul>\n<p>Customizations added in <code>JpaRestfulServer.java</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Java\"><pre><span></span><code><span class=\"n\">BaseHapiFhirResourceDao</span><span class=\"o\">&lt;</span><span class=\"n\">FavouriteCookie</span><span class=\"o\">&gt;</span> <span class=\"n\">myDao</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"n\">JpaResourceDao</span><span class=\"o\">&lt;&gt;</span><span class=\"p\">();</span>\n<span class=\"n\">myDao</span><span class=\"p\">.</span><span class=\"na\">setResourceType</span><span class=\"p\">(</span><span class=\"n\">FavouriteCookie</span><span class=\"p\">.</span><span class=\"na\">class</span><span class=\"p\">);</span>\n<span class=\"n\">myDao</span><span class=\"p\">.</span><span class=\"na\">setContext</span><span class=\"p\">(</span><span class=\"n\">fhirSystemDao</span><span class=\"p\">.</span><span class=\"na\">getContext</span><span class=\"p\">());</span>\n<span class=\"n\">daoRegistry</span><span class=\"p\">.</span><span class=\"na\">register</span><span class=\"p\">(</span><span class=\"n\">myDao</span><span class=\"p\">);</span>\n\n<span class=\"n\">JpaResourceProviderR4</span><span class=\"o\">&lt;</span><span class=\"n\">FavouriteCookie</span><span class=\"o\">&gt;</span> <span class=\"n\">favouriteCookieProvider</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"n\">FavouriteCookieProvider</span><span class=\"p\">();</span>\n<span class=\"n\">favouriteCookieProvider</span><span class=\"p\">.</span><span class=\"na\">setDao</span><span class=\"p\">(</span><span class=\"n\">myDao</span><span class=\"p\">);</span>\n<span class=\"n\">favouriteCookieProvider</span><span class=\"p\">.</span><span class=\"na\">setContext</span><span class=\"p\">(</span><span class=\"n\">ctx</span><span class=\"p\">);</span>\n<span class=\"n\">registerProviders</span><span class=\"p\">(</span><span class=\"n\">favouriteCookieProvider</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>What I'm missing:</p>\n<ul>\n<li>An example of how to get my custom resource fully connected up so I can interact with it on <code>/fhir/FavouriteCookie</code><ul>\n<li>It recognizes that it's a resource, but I get an NPE when the search is called:<ul>\n<li><code>Caused by: java.lang.NullPointerException: null at ca.uhn.fhir.jpa.dao.BaseHapiFhirResourceDao.search(BaseHapiFhirResourceDao.java:1398)</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>I'm having some trouble tracking down when/where everything is created, so I'm assuming there's some piece I'm missing. The only examples I've seen in the docs seem to implement search or ID as a newly instantiated object that's returned immediately, rather than showing anything on how to connect it up to the DB. I'm obviously missing something, but I can't see what it is.</p>\n<p>Is anyone able to provide some guidance?</p>",
        "id": 259425307,
        "sender_full_name": "David Young",
        "timestamp": 1635442757
    },
    {
        "content": "<p>See <a href=\"https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#extending-fhir-resource-classes\">https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#extending-fhir-resource-classes</a></p>",
        "id": 259427157,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1635443589
    },
    {
        "content": "<p>Sorry, I'm not sure I see the connection between that section and what I'm trying to do. I'm not looking to add an extension to an existing resource, I'm trying to create an entirely new resource.</p>",
        "id": 259433980,
        "sender_full_name": "David Young",
        "timestamp": 1635446656
    },
    {
        "content": "<p>It more seems like you are trying to create a new resource type</p>",
        "id": 259434207,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1635446771
    },
    {
        "content": "<p>Is that not the same thing as a custom resource? Admittedly, I'm pretty new to FHIR, so I may not be using the correct terminology.</p>",
        "id": 259435121,
        "sender_full_name": "David Young",
        "timestamp": 1635447069
    },
    {
        "content": "<p>Adding extensions to the Basic resource is the recommended mechanism for defining a custom data structure conformant with the FHIR spec.<br>\n<a href=\"http://hl7.org/fhir/basic.html\">http://hl7.org/fhir/basic.html</a></p>\n<p>Notably,</p>\n<blockquote>\n<p>use of 'custom' resources is <strong>NOT</strong> considered to be conformant with FHIR</p>\n</blockquote>",
        "id": 259699754,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1635553482
    }
]