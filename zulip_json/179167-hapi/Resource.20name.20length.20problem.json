[
    {
        "content": "<p>I can't POST data for the MedicinalProductContraindication resource, because HAPI doesn't like names over 30 chars. </p>\n<p>I know there is name limit but this resource name is ok in the R4 build. </p>\n<p>On console I get \"A truncation error was encountered trying to shrink VARCHAR 'MedicinalProductContraindication' to length 30.</p>",
        "id": 176485300,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1569345565
    },
    {
        "content": "<p>Yeah, this bug just got fixed in 4.1.0-SNAPSHOT.. Never expected a resource name &gt; 30 chars, but that was a bad assumption. The limit has been bumped up to 100 chars</p>\n<p>Feel free to manually increase the length of that column on an existing DB, even without upgrading your HAPI library. It won't cause any issues.</p>",
        "id": 176497559,
        "sender_full_name": "James Agnew",
        "timestamp": 1569353494
    },
    {
        "content": "<p>I wonder if we should discuss this and find some limit - there's a couple of places where the length can be a problem</p>",
        "id": 176510625,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1569362337
    },
    {
        "content": "<p>Presuming it should be representable by a <code>string</code>, there is a handy limit of  1024*1024 characters already built in.  Seems reasonable to me  <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 176511717,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1569363134
    },
    {
        "content": "<p>tgz package file format starts to have issues when the length gets over 23.</p>",
        "id": 176514391,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1569365258
    },
    {
        "content": "<p>There is a limit in the build already. I have hit it in the past and had to shorten the name. Can't recall the number but it's more than 30.</p>",
        "id": 176545336,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1569401580
    },
    {
        "content": "<p>on the new version of HAPI I get a different error \"Value too long for column \"RES_TYPE\" VARCHAR(30)\"\" - which makes sense. But how can I access my jetty db to increase that? The jetty database is created on the fly I think, so is it possible for me to change the column width?</p>",
        "id": 176547325,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1569403321
    },
    {
        "content": "<p>Ah that's harder... How are you running the server? With the HAPI FHIR CLI? Or the jpaserver starter?</p>",
        "id": 176549336,
        "sender_full_name": "James Agnew",
        "timestamp": 1569405112
    },
    {
        "content": "<p>it's jpaserver starter</p>",
        "id": 176586964,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1569432283
    },
    {
        "content": "<p>in that case- easiest thing is to build from the <code>rel_4_1_0</code> branch of that project. That will have the fix already included.</p>",
        "id": 176594290,
        "sender_full_name": "James Agnew",
        "timestamp": 1569437069
    },
    {
        "content": "<p>thanks James. When I look here <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/branches\" target=\"_blank\" title=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/branches\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/branches</a> I see 4 branches but no rel_4_1_0. Where should I be looking please?</p>",
        "id": 176598832,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1569440421
    },
    {
        "content": "<p>Whoops... that branch was not yet pushed. Can you try again?</p>",
        "id": 176694623,
        "sender_full_name": "James Agnew",
        "timestamp": 1569529853
    },
    {
        "content": "<p>thanks. Have tried that build but it seems the same (\"Value too long\"). When I look here <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commits/rel_4_1_0\" target=\"_blank\" title=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commits/rel_4_1_0\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/commits/rel_4_1_0</a>, I see no commits since August 14. Am I in the right place?</p>",
        "id": 176727333,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1569572596
    },
    {
        "content": "<p>Can you do a pull on that branch and try again? (Note that you'll need to start fresh with no database directory in place too.. such are the joys of using an embedded database)</p>",
        "id": 176965667,
        "sender_full_name": "James Agnew",
        "timestamp": 1569872029
    },
    {
        "content": "<p>thanks James. I've pulled that branch into a clean folder and done mvn jetty:run. I still get the same error inserting that resource. I assumed that within this folder it is using a brand new jetty database, but is it finding the old one outside of the local folder? That would explain it but I don't know how to refresh my database. I have not altered hapi.properties.</p>",
        "id": 177135995,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1570010202
    },
    {
        "content": "<p>Hmm, very weird.. I'm assuming you had done a <code>mvn clean</code> first?</p>",
        "id": 177136871,
        "sender_full_name": "James Agnew",
        "timestamp": 1570011131
    },
    {
        "content": "<p>no. It was a brand new folder so I didnt think to clean it...</p>",
        "id": 177137775,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1570012077
    },
    {
        "content": "<p>now tried mvn clean and then mvn jetty:run again, same issue, hasn't expanded the column</p>",
        "id": 177137943,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1570012232
    },
    {
        "content": "<p>ok- one last ditch effort, can you try running it with:</p>\n<p><code>mvn -U clean jetty:run</code></p>\n<p>If that doesn't fix it, clearly this is a different issue than I thought it was... in that case can you share the resource you're trying to upload and I'll see if I can replicate?</p>",
        "id": 177138282,
        "sender_full_name": "James Agnew",
        "timestamp": 1570012596
    },
    {
        "content": "<p>same issue after that. This is enough to trigger it:<br>\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;<br>\n&lt;MedicinalProductContraindication xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n&lt;/MedicinalProductContraindication&gt;</p>",
        "id": 177139202,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1570013676
    },
    {
        "content": "<p>Ok, I see it too. Pushing a fix now...</p>",
        "id": 177152519,
        "sender_full_name": "James Agnew",
        "timestamp": 1570024884
    },
    {
        "content": "<p>That's pushed. If you could try again with <code>mvn -U clean jetty:run</code> I sure hope this will be fixed now. :)</p>",
        "id": 177155021,
        "sender_full_name": "James Agnew",
        "timestamp": 1570026533
    },
    {
        "content": "<p>is it pushed yet? last commit shows as 2 days ago</p>",
        "id": 177162670,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1570030996
    },
    {
        "content": "<p>It's a fix to the main hapi library, so the <code>-U</code> should pull in the latest snapshot</p>",
        "id": 177163952,
        "sender_full_name": "James Agnew",
        "timestamp": 1570031832
    }
]