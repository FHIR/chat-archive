[
    {
        "content": "<p>We want to capture <strong>AuditEvent</strong> using HAPI FHIR in our environment. We could able to up and run the HAPI FHIR as Docker container in our environment. Following is the URL that we are trying to capture the AuditEvents.</p>\n<p><code>http://localhost:8080/hapi-fhir-jpaserver-example/baseDstu2/AuditEvent?_pretty=true</code></p>\n<p>But always what I'm getting is something similar to below</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;Bundle&quot;,\n  &quot;id&quot;: &quot;f8214d9d-0514-4a81-ad67-c3f29b7614a7&quot;,\n  &quot;meta&quot;: {\n    &quot;lastUpdated&quot;: &quot;2020-07-23T06:39:46.825+00:00&quot;\n  },\n  &quot;type&quot;: &quot;searchset&quot;,\n  &quot;total&quot;: 0,\n  &quot;link&quot;: [\n    {\n      &quot;relation&quot;: &quot;self&quot;,\n      &quot;url&quot;: &quot;http://localhost:8080/hapi-fhir-jpaserver-example/baseDstu2/AuditEvent&quot;\n    }\n  ]\n}\n</code></pre></div>\n\n\n<ul>\n<li>Am I not capturing any audit events?</li>\n<li>Is auditing not properly working?</li>\n<li>Why always total=0 ?</li>\n</ul>",
        "id": 204765531,
        "sender_full_name": "AnujAroshA",
        "timestamp": 1595487427
    },
    {
        "content": "<p>I suspect nothing is recording AuditEvents. You likely need to debug why code that you think is recording an AuditEvent is not succeeding.</p>",
        "id": 204792481,
        "sender_full_name": "John Moehrke",
        "timestamp": 1595508957
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> I have debug the JAVA plugin that we are using to send an AuditEvent. To capture audit event, we are using  <a href=\"https://hub.docker.com/r/polyakov/hapi-fhir-jpaserver-example/\">polyakov/hapi-fhir-jpaserver-example</a> which runs as a Docker container.</p>\n<p>Docker compose file looks like below</p>\n<div class=\"codehilite\"><pre><span></span><code>version: &#39;3.5&#39;\nservices:\n  fhir:\n    image: polyakov/hapi-fhir-jpaserver-example\n    container_name: hapi-fhir\n    ports:\n      - 8080:8080\n</code></pre></div>\n\n\n<p>In the JAVA plugin we are having a code like below to send the Audit Event to the above mentioned service.</p>\n<div class=\"codehilite\"><pre><span></span><code>    try {\n      MethodOutcome outcome = client.sendAuditEvent(auditEvent);\n      if (outcome != null &amp;&amp; outcome.getId() != null) {\n        log.debug(&quot;Successfully sent audit event to audit server, with ID {}&quot;, outcome.getId().getValue());\n      } else {\n        throw new DipsAuditLoggerException(ErrorCode.SERVER_ERROR, &quot;The audit event was not properly created on the audit server side&quot;);\n      }\n    } catch (BaseServerResponseException ae) {\n      log.error(&quot;Request to audit service failed. Response body is {}&quot;, ae.getResponseBody());\n      throw new DipsAuditLoggerException(ErrorCode.SERVER_ERROR, &quot;Error while talking to DIPS Audit service&quot;, ae);\n    }\n</code></pre></div>\n\n\n<p>It hits <strong><em>BaseServerResponseException</em></strong> and it gives <strong>HTTP Status 404 error</strong>. </p>\n<p>So, I think from the JAVA plugin, it creates the Audit Event properly and send to the audit service as well.</p>\n<p>Do you know any way that we can inspect the server hits on polyakov/hapi-fhir-jpaserver-example where I can investigate more or do you have any other opinion?</p>\n<p>Thank you very much</p>",
        "id": 205084494,
        "sender_full_name": "AnujAroshA",
        "timestamp": 1595830259
    },
    {
        "content": "<p>not I, I only can help with the standard, not a system.  did you look at the content of the http response body? Did you look at the OperationOutcome? Most platforms put really helpful things in the response body.</p>",
        "id": 205107746,
        "sender_full_name": "John Moehrke",
        "timestamp": 1595851038
    }
]