[
    {
        "content": "<p>Hi everyone.</p>\n<p>according to <a href=\"https://www.hl7.org/fhir/searchparameter-registry.html\">https://www.hl7.org/fhir/searchparameter-registry.html</a> Section Appointment the path (expression) for parameter <em>practitioner</em> is   <em>Appointment.​participant.​actor.​where(resolve() is Practitioner)</em></p>\n<p>Now i want to build one for relatedPersons as well.</p>\n<p>My custom Parameter looks like this</p>\n<div class=\"codehilite\"><pre><span></span><code>            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">addBase</span><span class=\"p\">(</span><span class=\"s\">&quot;Appointment&quot;</span><span class=\"p\">)</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">code</span> <span class=\"p\">=</span> <span class=\"s\">&quot;participatingRelatives&quot;</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">type</span> <span class=\"p\">=</span> <span class=\"n\">Enumerations</span><span class=\"p\">.</span><span class=\"n\">SearchParamType</span><span class=\"p\">.</span><span class=\"n\">REFERENCE</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">title</span> <span class=\"p\">=</span> <span class=\"s\">&quot;Appointment participating relatives&quot;</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">expression</span> <span class=\"p\">=</span> <span class=\"s\">&quot;participant.actor.where(resolve() is RelatedPerson)&quot;</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">xpathUsage</span> <span class=\"p\">=</span> <span class=\"n\">SearchParameter</span><span class=\"p\">.</span><span class=\"n\">XPathUsageType</span><span class=\"p\">.</span><span class=\"n\">NORMAL</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">status</span> <span class=\"p\">=</span> <span class=\"n\">Enumerations</span><span class=\"p\">.</span><span class=\"n\">PublicationStatus</span><span class=\"p\">.</span><span class=\"n\">DRAFT</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">addComparator</span><span class=\"p\">(</span><span class=\"n\">SearchParameter</span><span class=\"p\">.</span><span class=\"n\">SearchComparator</span><span class=\"p\">.</span><span class=\"n\">EQ</span><span class=\"p\">)</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">addModifier</span><span class=\"p\">(</span><span class=\"n\">SearchParameter</span><span class=\"p\">.</span><span class=\"n\">SearchModifierCode</span><span class=\"p\">.</span><span class=\"n\">CONTAINS</span><span class=\"p\">)</span>\n</code></pre></div>\n\n\n<p>This one can be created and used without error message, but it does not work as wanted.</p>\n<p>My first intention was to set the expression at the xpath parameter</p>\n<div class=\"codehilite\"><pre><span></span><code>            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">xpath</span> <span class=\"p\">=</span> <span class=\"s\">&quot;participant.actor.where(resolve() is RelatedPerson)&quot;</span>\n</code></pre></div>\n\n\n<p>My next idea is to set a reference to parameter actor and use chained search parameters from here</p>\n<div class=\"codehilite\"><pre><span></span><code>            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">type</span> <span class=\"p\">=</span> <span class=\"n\">Enumerations</span><span class=\"p\">.</span><span class=\"n\">SearchParamType</span><span class=\"p\">.</span><span class=\"n\">REFERENCE</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">expression</span> <span class=\"p\">=</span> <span class=\"s\">&quot;participant.actor&quot;</span>\n</code></pre></div>\n\n\n<p>Unfortunately my approaches do not work, where am I wrong?</p>",
        "id": 206034760,
        "sender_full_name": "Marian Hummel",
        "timestamp": 1596640543
    },
    {
        "content": "<p>Now i went for</p>\n<div class=\"codehilite\"><pre><span></span><code>            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">type</span> <span class=\"p\">=</span> <span class=\"n\">Enumerations</span><span class=\"p\">.</span><span class=\"n\">SearchParamType</span><span class=\"p\">.</span><span class=\"n\">TOKEN</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">xpath</span> <span class=\"p\">=</span> <span class=\"s\">&quot;participant.actor&quot;</span>\n            <span class=\"n\">participantsSearchParameter</span><span class=\"p\">.</span><span class=\"n\">expression</span> <span class=\"p\">=</span> <span class=\"s\">&quot;Appointment.actor&quot;</span>\n</code></pre></div>\n\n\n<p>i can now search for general participants, but i cannot distinguish by type (Patient, Practitioner, RelatedPersons)</p>\n<p>Its not ideal, but it would work. Any other ideas?</p>",
        "id": 206122341,
        "sender_full_name": "Marian Hummel",
        "timestamp": 1596707870
    }
]