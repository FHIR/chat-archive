[
    {
        "content": "<p>Also posted in implementers<br>\nHAPI FHIR Version 5.4.0 on Mac/Linux</p>\n<p>I'm using the following SearchParameter to eliminate duplicate Identifiers for a Patient resource.  It works fine until I try to update that resource using the identifier as part of the PUT command with URL <a href=\"http://localhost:3111/myfhir/Patient?identifier=urn:uuid:555|26828F0386673\">http://localhost:3111/myfhir/Patient?identifier=urn:uuid:555|26828F0386673</a>. An error is returned</p>\n<p>Can not create resource of type Patient as it would create a duplicate unique index matching query: Patient?identifier=urn%3Auuid%3A555%7C26828F0386673 (existing index belongs to Patient/391494aa-0cba-4e88-85c8-7539a5e9506f, new unique index created by SearchParameter/11d73d9c-b13a-4f70-9e7d-a7a916d80765)</p>\n<p>If I use the id for the patient directly the update of the resource  works fine. <a href=\"http://localhost:3111/myfhir/Patient/391494aa-0cba-4e88-85c8-7539a5e9506f\">http://localhost:3111/myfhir/Patient/391494aa-0cba-4e88-85c8-7539a5e9506f</a>.</p>\n<p>Once I use a SearchParameter does that mean I can't use the identifier for the update?  What am I missing?</p>\n<p>It's worth noting that in the HFJ_IDX_CMP_STRING_UNIQ table the IDX_STRING column always has an entry like Patient?identifier=urn%3Auuid%3A555%7C26828F0386673 no matter if the SearchParameter expression is Patient.identifier or Patient.identifer.value</p>\n<p>Thanks.</p>\n<p>The SearchParameter looks like:<br>\n{<br>\n\"resourceType\": \"SearchParameter\",<br>\n\"meta\": {<br>\n\"lastUpdated\": \"2021-05-02T10:43:02.162-04:00\",<br>\n\"tag\": [ {<br>\n\"system\": \"<a href=\"https://my.health.com/x/Onc1C\">https://my.health.com/x/Onc1C</a>\",<br>\n\"code\": \"34a800fa-bba9-4cb9-77ed-0aa4d0eecef2\",<br>\n\"display\": \"FHIR Implementation Team\"<br>\n} ]<br>\n},<br>\n\"extension\": [<br>\n{<br>\n\"url\": \"<a href=\"http://hapifhir.io/fhir/StructureDefinition/sp-unique\">http://hapifhir.io/fhir/StructureDefinition/sp-unique</a>\",<br>\n\"valueBoolean\": true<br>\n}<br>\n],<br>\n\"url\": \"<a href=\"http://health.com/fhir/SearchParameter/uniq-patient-identifier\">http://health.com/fhir/SearchParameter/uniq-patient-identifier</a>\",<br>\n\"name\": \"unique-patient-identifier\",<br>\n\"status\": \"active\",<br>\n\"description\": \"A unique patient identifier\",<br>\n\"code\": \"unique-patient-identifier\",<br>\n\"base\": [<br>\n\"Patient\"<br>\n],<br>\n\"type\": \"token\",<br>\n\"expression\": \"Patient\",<br>\n\"component\": [<br>\n{<br>\n\"definition\": \"<a href=\"http://hl7.org/fhir/SearchParameter/patient-identifier\">http://hl7.org/fhir/SearchParameter/patient-identifier</a>\",<br>\n\"expression\": \"Patient.identifier\"<br>\n}<br>\n]<br>\n}</p>",
        "id": 270615679,
        "sender_full_name": "Joe Atterberry",
        "timestamp": 1643921489
    },
    {
        "content": "<p>I've fixed my FHIR base URL, but I'm still getting \"Failed to fetch API definition\". This is a fresh HAPI deployment... can anyone help? <a href=\"/user_uploads/10155/cDf0h33v74zGzYQkDxtx0mpo/Screen-Shot-2022-02-03-at-4.22.46-PM.png\">Screen-Shot-2022-02-03-at-4.22.46-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/cDf0h33v74zGzYQkDxtx0mpo/Screen-Shot-2022-02-03-at-4.22.46-PM.png\" title=\"Screen-Shot-2022-02-03-at-4.22.46-PM.png\"><img src=\"/user_uploads/10155/cDf0h33v74zGzYQkDxtx0mpo/Screen-Shot-2022-02-03-at-4.22.46-PM.png\"></a></div>",
        "id": 270619788,
        "sender_full_name": "Joe Flack",
        "timestamp": 1643923431
    },
    {
        "content": "<p><a href=\"http://20.119.216.32:8080/fhir/swagger-ui/\">http://20.119.216.32:8080/fhir/swagger-ui/</a></p>",
        "id": 270619845,
        "sender_full_name": "Joe Flack",
        "timestamp": 1643923444
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"423941\">@Joe Flack</span> Not sure what swagger has to with my SearchParameter question</p>",
        "id": 270745328,
        "sender_full_name": "Joe Atterberry",
        "timestamp": 1643995261
    },
    {
        "content": "<p>Nothing. I'm just not that familiar with Zulip. I didn't mean to reply to your thread.</p>",
        "id": 270861165,
        "sender_full_name": "Joe Flack",
        "timestamp": 1644111969
    },
    {
        "content": "<p>FWIW I am not able to reproduce this on <a href=\"http://hapi.fhir.org\">hapi.fhir.org</a>, so I'm assuming this is an issue that's already fixed in 5.7.0-SNAPSHOT</p>",
        "id": 270901446,
        "sender_full_name": "James Agnew",
        "timestamp": 1644169238
    }
]