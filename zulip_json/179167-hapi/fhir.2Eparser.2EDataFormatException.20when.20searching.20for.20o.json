[
    {
        "content": "<p>For Fhir 2.2, DSTU2<br>\nWe have a named query returning a bundle of Patient and WalkInQueueItems. WalkInQueueItem is our own FHIR domain resources, and not a dstu2-ressource (surprise...).</p>\n<p>In end-2-end test we test this by calling:<br>\n        FhirContext ctx = FhirContext.forDstu2();<br>\n        ctx.setParserErrorHandler(new NoLoggingErrorHandler());<br>\n        client = ctx.newRestfulGenericClient(\"http://\" + getUrl());<br>\n        client.search()<br>\n              .byUrl(\"Patient?_query=activeQueueItems\")<br>\n              .where(&lt;someClientParam))<br>\n              .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)<br>\n              .execute();<br>\n(we are not happy about the byUrl-part, would have loved a \"withQuery(String)\"-possibility)</p>\n<p>This results in the following error:<br>\nCaused by: ca.uhn.fhir.parser.DataFormatException: DataFormatException at [[row,col {unknown-source}]: [1,893]]: Unknown resource name \"WalkInQueueItem\" (this name is not known in FHIR version \"DSTU2\")<br>\n    at ca.uhn.fhir.parser.XmlParser.doXmlLoop(XmlParser.java:277)<br>\n    at ca.uhn.fhir.parser.XmlParser.parseResource(XmlParser.java:1051)<br>\n    at ca.uhn.fhir.parser.XmlParser.doParseResource(XmlParser.java:188)<br>\n    at ca.uhn.fhir.parser.BaseParser.parseResource(BaseParser.java:644)<br>\n    at ca.uhn.fhir.rest.client.BaseClient$ResourceResponseHandler.invokeClient(BaseClient.java:488)<br>\n    at ca.uhn.fhir.rest.client.BaseClient$ResourceResponseHandler.invokeClient(BaseClient.java:440)<br>\n    at ca.uhn.fhir.rest.client.BaseClient.invokeClient(BaseClient.java:320)<br>\n    ... 33 more</p>\n<p>I have tried with a extension of a DSTU2-ressource(location) in stead of WalkInQueueItem: same error<br>\nI have tried with a standard DSTU2-ressource (appointment) in stead of WalkInQueueItem: no error</p>\n<p>Seems to be a bug? Any workarounds?</p>",
        "id": 153867544,
        "sender_full_name": "Allan Bro Hansen",
        "timestamp": 1484573774
    },
    {
        "content": "<p>Most of the samples on <a href=\"http://hapifhir.io/doc_extensions.html\" target=\"_blank\" title=\"http://hapifhir.io/doc_extensions.html\">http://hapifhir.io/doc_extensions.html</a> assumes that the extended resource is defined as a class that is registered in the context using annotations. Is your server exposed somewhere?</p>",
        "id": 153868012,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1484731260
    },
    {
        "content": "<p>We extend the dstu2 hapi classes.<br>\nE.g extending Location:<br>\n@ResourceDef(name = \"ArrivalLocation\")<br>\npublic class FhirArrivalLocation extends Location<br>\nEg. extending baseResource:<br>\n@ResourceDef(name = \"WalkInQueueItem\")<br>\npublic class FhirWalkInQueueItem extends BaseResource</p>",
        "id": 153868013,
        "sender_full_name": "Allan Bro Hansen",
        "timestamp": 1484732401
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> : any input on this?</p>",
        "id": 153868014,
        "sender_full_name": "Allan Bro Hansen",
        "timestamp": 1484732967
    },
    {
        "content": "<p>Hi<br>\nI needed to register the ressources: <br>\nctx.registerCustomTypes(Arrays.asList(FhirWalkInQueueItem.class));<br>\nand it works :-)</p>",
        "id": 153868106,
        "sender_full_name": "Allan Bro Hansen",
        "timestamp": 1484757488
    },
    {
        "content": "<p>Great ;)</p>",
        "id": 153868352,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1484818672
    }
]