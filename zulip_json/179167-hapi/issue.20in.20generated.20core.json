[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>, a question about our generated code:</p>",
        "id": 153840082,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1469051516
    },
    {
        "content": "<div class=\"codehilite\"><pre>        <span class=\"kd\">public</span> <span class=\"n\">Reference</span> <span class=\"nf\">getSourceReference</span><span class=\"o\">()</span> <span class=\"kd\">throws</span> <span class=\"n\">FHIRException</span> <span class=\"o\">{</span> \n          <span class=\"k\">if</span> <span class=\"o\">(!(</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">source</span> <span class=\"k\">instanceof</span> <span class=\"n\">Reference</span><span class=\"o\">))</span>\n            <span class=\"k\">throw</span> <span class=\"k\">new</span> <span class=\"nf\">FHIRException</span><span class=\"o\">(</span><span class=\"s\">&quot;Type mismatch: the type Reference was expected, but &quot;</span><span class=\"o\">+</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">source</span><span class=\"o\">.</span><span class=\"na\">getClass</span><span class=\"o\">().</span><span class=\"na\">getName</span><span class=\"o\">()+</span><span class=\"s\">&quot; was encountered&quot;</span><span class=\"o\">);</span>\n          <span class=\"k\">return</span> <span class=\"o\">(</span><span class=\"n\">Reference</span><span class=\"o\">)</span> <span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">source</span><span class=\"o\">;</span>\n        <span class=\"o\">}</span>\n</pre></div>",
        "id": 153840083,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1469051528
    },
    {
        "content": "<p>this will result in an NPE if this.source == null, which is obviously no good. </p>",
        "id": 153840084,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1469051559
    },
    {
        "content": "<p>but what should it do in that case?</p>",
        "id": 153840085,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1469051570
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  - ping on this subject...</p>",
        "id": 153840804,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1469401180
    },
    {
        "content": "<p>Sorry! Hopelessly behind on messages right now... Agreed that seems like a bug. We should probably have something like</p>\n<div class=\"codehilite\"><pre><span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">source</span> <span class=\"o\">!=</span> <span class=\"kc\">null</span> <span class=\"o\">&amp;&amp;</span> <span class=\"o\">!(</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">source</span> <span class=\"k\">instanceof</span> <span class=\"n\">Reference</span><span class=\"o\">))</span> <span class=\"o\">{</span>\n</pre></div>",
        "id": 153840808,
        "sender_full_name": "James Agnew",
        "timestamp": 1469401782
    },
    {
        "content": "<p>I think returning <code>null</code> is sensible behaviour in that case. </p>",
        "id": 153840809,
        "sender_full_name": "James Agnew",
        "timestamp": 1469401811
    },
    {
        "content": "<p>ok will do. </p>",
        "id": 153840810,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1469401838
    },
    {
        "content": "<p>thanks</p>",
        "id": 153840811,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1469401868
    }
]