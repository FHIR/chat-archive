[
    {
        "content": "<p>Hi all, After about a year of experience with the FHIR REST-API I would now like to know more about the Operations (and hopefully not too much Development) side of HAPI FHIR. Yesterday I managed to get the hapi-fhir-jpa-server running in a local Docker container within a very short amount of time: great! Next step is that I want to do some partitioning-configuration on it. The documentation clearly definessome methods (<a href=\"https://hapifhir.io/hapi-fhir/docs/server_jpa_partitioning/enabling_in_hapi_fhir.html\">https://hapifhir.io/hapi-fhir/docs/server_jpa_partitioning/enabling_in_hapi_fhir.html</a>) but I still don’t get it. How can I call configuration methods of a hapi-fhir-jpa-server running in Docker? It could be that my problem is caused by my lack of recent Java knowledge. But maybe there is still someone out there that wants to help this newbie out.</p>",
        "id": 252885477,
        "sender_full_name": "Jorrit",
        "timestamp": 1631339785
    },
    {
        "content": "<p>You will need to dig into some Java development if you need to use partitions on the jpa-starter project  - and probably add some stuff around here: <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/java/ca/uhn/fhir/jpa/starter/BaseJpaRestfulServer.java\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/java/ca/uhn/fhir/jpa/starter/BaseJpaRestfulServer.java</a></p>",
        "id": 252893489,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1631349064
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> for the reply. I was hoping there was a way to edit the configuration post-compilation. I understand now that configuration has to be done in the source code. It would be great if I can call the configuration-methods from within the initialize()-function of the BaseJpaRestfulServer-class. So my next step will be to install a Java JDK and get my hands dirty. I always knew that that Java-class on university back in 1999 would come in handy someday ;-).</p>",
        "id": 252964553,
        "sender_full_name": "Jorrit",
        "timestamp": 1631429082
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"390795\">@Jorrit</span> are you trying to get partitions working using docker or something more complex? It’s possible to get them working at least the basics.</p>",
        "id": 252978907,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1631445103
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194192\">@Richard Stanley</span> I want to do a couple of configurations. First I’d like to enable partitioning to create a single instance multi tenant fhir server. Second I’d like to do some OAuth/SMART-configurations to connect the fhir server to an external OAuth-server.</p>",
        "id": 252979118,
        "sender_full_name": "Jorrit",
        "timestamp": 1631445328
    },
    {
        "content": "<p>Ok, for the first task, here's what has worked for me, in a docker-compose...</p>\n<div class=\"codehilite\"><pre><span></span><code>  fhir:\n    container_name: hapi-fhir\n    image: hapiproject/hapi:latest\n    ports:\n      - &quot;8080:8080&quot;\n    restart: always\n    depends_on:\n      - redis\n    environment:\n      - hapi.fhir.partitioning.enabled=true\n      - hapi.fhir.partitioning.allow_references_across_partitions=false\n      - hapi.fhir.partitioning.partitioning_include_in_search_hashes=false\n</code></pre></div>\n<p>The <code>hapi.fhir.partitioning.enabled=true</code> is not clear in the default application.yaml, but it is still picked up as a config. Ignore the redis line. See also:<br>\n<a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/227#issuecomment-879253206\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/227#issuecomment-879253206</a><br>\nHope that helps. I don't know how to do the second task.</p>",
        "id": 252981506,
        "sender_full_name": "Richard Stanley",
        "timestamp": 1631448024
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194192\">@Richard Stanley</span> - from what I know (from <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/15923edfd53980101ba73c517ea91e63fc3e47b1/src/main/java/ca/uhn/fhir/jpa/starter/FhirServerConfigCommon.java#L133\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/15923edfd53980101ba73c517ea91e63fc3e47b1/src/main/java/ca/uhn/fhir/jpa/starter/FhirServerConfigCommon.java#L133</a>) - setting <code>hapi.fhir.partitioning.enabled=true</code> does nothing. Setting eg. <code>api.fhir.partitioning.allow_references_across_partitions=false</code> enables partitioning.</p>",
        "id": 252982574,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1631449230
    },
    {
        "content": "<p>the point is that when you enable the details of partitioning - it automatically enables partitioning</p>",
        "id": 252982723,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1631449437
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"194192\">@Richard Stanley</span> and <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>. I'm happy that I only have to edit hapi-fhir-jpaserver-starter/src/main/resources/application.yaml to enable partitioning, instead of actually editing one or more Java-classes.</p>",
        "id": 253066215,
        "sender_full_name": "Jorrit",
        "timestamp": 1631528462
    }
]