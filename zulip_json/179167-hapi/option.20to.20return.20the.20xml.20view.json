[
    {
        "content": "<p>Hi James.   Is there a way to return the raw xml instead of the html?  My use case may be unique but I'm interested in seeing the narrative view right on the browser when I fetch a resource.</p>",
        "id": 153832215,
        "sender_full_name": "Eric Haas",
        "timestamp": 1465506623
    },
    {
        "content": "<p>append _format=xml to the url</p>",
        "id": 153832216,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1465506683
    },
    {
        "content": "<p>doesn't work- still return the html view</p>",
        "id": 153832217,
        "sender_full_name": "Eric Haas",
        "timestamp": 1465506973
    },
    {
        "content": "<p>ahh oops</p>",
        "id": 153832218,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1465507049
    },
    {
        "content": "<p>When HAPI detects that your request is coming from a browser it serves you up HTML instead of just the raw payload. There are two ways around this:</p>\n<ul>\n<li>HAPI supports a non standard parameter <code>_raw=true</code> which forces this to not happen</li>\n<li>If what you actually want though is to just see the HTML of the narrative, you should be able to do this: <a href=\"http://fhirtest.uhn.ca/baseDstu3/Appointment/98975?_format=html\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Appointment/98975?_format=html\">http://fhirtest.uhn.ca/baseDstu3/Appointment/98975?_format=html</a></li>\n</ul>\n<p>That second one appears to not be working though. Weird. I need to investigate that.</p>",
        "id": 153832233,
        "sender_full_name": "James Agnew",
        "timestamp": 1465516968
    },
    {
        "content": "<p>Would it be better for <code>_format=xml</code> to just force raw XML instead of HTML-ifying it? I know that's how Grahame's server works and I can see the logic in it.. but that means there's no way of specifying that you explicitly want the pretty HTML version of JSON or XML, which at least I do all the time..</p>",
        "id": 153832234,
        "sender_full_name": "James Agnew",
        "timestamp": 1465517055
    },
    {
        "content": "<p>Actually, on closer inspection I guess <code>_format=html</code> is intended to force the rendered HTML view you're trying to avoid. Nevermind that part.</p>",
        "id": 153832247,
        "sender_full_name": "James Agnew",
        "timestamp": 1465523730
    },
    {
        "content": "<p>_format=xml should force raw xml in accordance with the spec. you could use _format=html/xml for htmlised xml or json. i could do that too</p>",
        "id": 153832250,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1465526280
    },
    {
        "content": "<p>what's with getXFirstRep? is this on any repeating element?</p>",
        "id": 153832251,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1465526321
    },
    {
        "content": "<p>Hmm, yeah, that's not a bad idea to do something like <code>html/xml</code> and <code>html/json</code>.  I'll make that change and try it out...</p>\n<p>Yeah. getFooFirstRep() just returns the first repetition of a repeating field, creating it if it doesn't already exist. Semantic sugar.</p>",
        "id": 153832252,
        "sender_full_name": "James Agnew",
        "timestamp": 1465527043
    },
    {
        "content": "<p>ok thanks. I'll add support for html/xml and html/json too at some stage</p>",
        "id": 153832254,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1465528077
    }
]