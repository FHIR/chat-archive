[
    {
        "content": "<p>Hi all,</p>\n<p>I'm trying to author a search parameter that searches for the value of a reference within an extension that could be present at the root level of any resource (in my case, I have an organisation resource, which is referenced by all of the resources which are governed by it).</p>\n<p>I've had a look in the docs for SearchParameters, and it suggests that it's possible to have a search parameter that has a scope of multiple resource types, and to do so you set the base to 'DomainResource'.   It doesn't say what the expression should be set to though, and when I try to upload it without an expression, I get an error from HAPI saying that it's missing.</p>\n<p>I'm uploading to HAPI 2.5-snapshot, and my resource looks like this, however when I perform a search like this, I get an error back saying the search parameter does not exist:<br>\n[base]/Basic?annotation=Basic/2</p>\n<p>&lt;SearchParameter xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n    &lt;name value=\"Annotation\"/&gt;<br>\n    &lt;status value=\"active\"/&gt;<br>\n    &lt;code value=\"annotation\"/&gt;<br>\n    &lt;base value=\"DomainResource\"/&gt;<br>\n    &lt;type value=\"reference\"/&gt;<br>\n    &lt;xpath value=\"f:DocumentReference/f:extension[@url='http://www.elabdev.org/StructureDefinition/AnnotationRef']\"/&gt; <br>\n    &lt;xpathUsage value=\"normal\"/&gt;<br>\n &lt;/SearchParameter&gt;</p>\n<p>If I change the search parameter to look like this, the same search works and returns the expected resources:</p>\n<p>&lt;SearchParameter xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n    &lt;name value=\"Annotation\"/&gt;<br>\n    &lt;status value=\"active\"/&gt;<br>\n    &lt;code value=\"annotation\"/&gt;<br>\n    &lt;base value=\"Basic\"/&gt;<br>\n    &lt;type value=\"reference\"/&gt;<br>\n    &lt;expression value=\"DocumentReference.extension('http://www.elabdev.org/StructureDefinition/AnnotationRef')\"/&gt;<br>\n    &lt;xpathUsage value=\"normal\"/&gt;<br>\n &lt;/SearchParameter&gt;</p>\n<p>However as expected I then cannot use this same search parameter to search for Patients which have the same extension in them.</p>\n<p>Any ideas?</p>",
        "id": 153901696,
        "sender_full_name": "Andrew Broadbent",
        "timestamp": 1502389219
    }
]