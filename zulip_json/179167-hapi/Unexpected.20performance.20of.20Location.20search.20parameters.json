[
    {
        "content": "<p>Three searches, one using Location:address, and two variants on  Location:address-postalcode.   <br>\nThe first runs 20x faster than the other.   Thoughts?<br>\n<strong>Fast:</strong><br>\n<a href=\"https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address:contains=06040\">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address:contains=06040</a></p>\n<p><strong>Slow</strong><br>\n<a href=\"https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode=06040\">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode=06040</a></p>\n<p><strong>Fast</strong><br>\n<a href=\"https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode:contains=06040\">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode:contains=06040</a></p>",
        "id": 214892503,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1603916428
    },
    {
        "content": "<p>Check the indexes that might be used.  Different query parameters might result in different optimization decisions being used by the query optimizer.  That kind of speed difference is typically a result of indexing choices, and/or query optimization planning choices.</p>",
        "id": 214908430,
        "sender_full_name": "Keith Boone",
        "timestamp": 1603926287
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191387\">@Keith Boone</span> -- dumb question, are those HAPI configuration options?</p>",
        "id": 214916844,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1603934226
    },
    {
        "content": "<p>Even dumber answer: I don't know, but I suspect that <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  might be able to point you in the right direction.</p>",
        "id": 215642404,
        "sender_full_name": "Keith Boone",
        "timestamp": 1604524571
    },
    {
        "content": "<p>For what it's worth, the HAPI JPA Server does (or can) log the queries it is using if I remember correctly, and that might provide more insight.</p>",
        "id": 215642558,
        "sender_full_name": "Keith Boone",
        "timestamp": 1604524658
    },
    {
        "content": "<p>I'm noticing that the two \"fast\" queries are both using <code>:contains</code>, which makes me think that the difference here is that the <code>:contains</code> queries are hitting the Lucene index  (which is used for full-text search and can be quite a bit faster), but I'm not really familiar enough with the JPA server search internals to be sure about that.</p>",
        "id": 215719179,
        "sender_full_name": "Ian Bacher",
        "timestamp": 1604586919
    }
]