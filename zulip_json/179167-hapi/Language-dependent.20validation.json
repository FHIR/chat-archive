[
    {
        "content": "<p>Hi HAPI people <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> We are writing a validation module with HAPI FHIR 5.2 for use during data ingestion. In particular, we want to validate QuestionnaireResponse instances against the corresponding Questionnaires. Each Questionnaire could potentially exist in different versions. In addition, since we are working in a cross-country setting, each version of a given questionnaire exists in multiple languages. We now want to match the incoming QuestionnaireResponses to the right Questionnaire based on all this, i.e.</p>\n<ol>\n<li>Questionnaire canonical (<code>QuestionnaireResponse.questionnaire</code>/<code>Questionnaire.url</code>)</li>\n<li>Questionnaire version (<code>QuestionnaireResponse.questionnaire</code> as versioned canonical URL/<code>Questionnaire.version</code>)</li>\n<li>Language l (<code>QuestionnaireResponse.language</code>/<code>Questionnaire.language</code>)</li>\n</ol>\n<p>We would like to simply load all the different variations of the the Questionnaires and then automatically validate against the right one. For URL and version, we got it working by writing our own implementation of <a href=\"https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-base/undefined/ca/uhn/fhir/context/support/IValidationSupport.html\">IValidationSupport</a>. It overrides <code>fetchResource()</code> to return the questionnaires that matches the (possibly versioned) canonical passed, e.g. if we get  the URL <code>http://example.com/myQ|1.2.3</code>, we return version 1.2.3 of the questionnaire with canonical <code>http://example.com/myQ</code>.</p>\n<p>However, we cannot see how to return the right Questionnaire based on <em>language</em>. The <code>IValidationSupport#fetchResource</code> method takes only a URI as parameter, which (AFAIK) does not leave any room for passing the required language. Can it be dynamically set (at runtime) somewhere else? I see that the embedded <a href=\"https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-base/undefined/ca/uhn/fhir/context/support/IValidationSupport.ConceptDesignation.html\">ConceptDesignation class</a> has a <code>getLanguage()</code> method, but I'm not sure if/how that is set &amp; whether it makes the core validation code do the right thing.</p>",
        "id": 219961178,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1608028972
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195340\">@Erik Nielsen</span></p>",
        "id": 219961901,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1608029407
    }
]