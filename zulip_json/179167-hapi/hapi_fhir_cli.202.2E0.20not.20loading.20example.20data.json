[
    {
        "content": "<p>I run <code>hapi-fhir-cli upload-examples -t http://localhost:8080/baseDstu2 -c</code> and all messages indicate it succeeded, but querying for any resource type always returns 0 results. </p>\n<p>This are the last lines of the output</p>\n<div class=\"codehilite\"><pre>11:30:54 INFO  ca.uhn.fhir.cli.ExampleDataUploader - Discarding unknown reference: ValueSet/v2-0371\n11:30:54 INFO  ca.uhn.fhir.cli.ExampleDataUploader - Discarding unknown reference: ValueSet/v3-PurposeOfUse\n11:30:54 INFO  ca.uhn.fhir.cli.ExampleDataUploader - Discarding unknown reference: ValueSet/v3-ActCode\n11:30:54 INFO  ca.uhn.fhir.cli.ExampleDataUploader - 2326 good references\n11:30:54 INFO  ca.uhn.fhir.cli.ExampleDataUploader - Final bundle: 1162 entries\n11:30:54 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 362 remaining\n11:30:55 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 351 remaining\n11:30:55 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 340 remaining\n11:30:55 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 329 remaining\n11:30:56 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 318 remaining\n11:30:56 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 307 remaining\n11:30:56 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 296 remaining\n11:30:56 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 285 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 274 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 263 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 252 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 241 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 230 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 219 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 208 remaining\n11:30:57 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 197 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 186 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 175 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 164 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 153 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 142 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 131 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 120 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 109 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 98 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 87 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 76 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 65 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 54 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 43 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 32 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 21 remaining\n11:30:58 INFO  ca.uhn.fhir.cli.ExampleDataUploader - About to upload 11 examples in a transaction, 10 remaining\n</pre></div>\n\n\n<p>Does this look correct?<br>\n<code>About to upload 11 examples</code> looks a bit weird to me.</p>\n<p><code>hapi-fhir-cli upload-definitions -t http://localhost:8080/baseDstu2</code><br>\nproduces about 30 warnings like<br>\n<code>11:47:33 WARN  c.u.fhir.cli.ValidationDataUploader - Failed to upload StructureDefinition/VisionPrescription - HTTP 400 Bad Request: Resource contains external reference to URL \"http://hl7.org/fhir/ValueSet/vision-product\" but this server is not configured to allow external referenc</code><br>\nbut gets 1067 <code>ValueSet</code>s and 35 <code>StructureDefinition</code>s loaded.</p>\n<p>I also tried with 1.6 with the same results.</p>\n<p>Any hint?</p>",
        "id": 153850887,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1474980700
    },
    {
        "content": "<p>I got a hint about a possible bug in the implementers stream where I first posted this question <a href=\"https://chat.fhir.org/#narrow/stream/implementers/topic/FHIR.20test.20server.20on.20Linux\" target=\"_blank\" title=\"https://chat.fhir.org/#narrow/stream/implementers/topic/FHIR.20test.20server.20on.20Linux\">https://chat.fhir.org/#narrow/stream/implementers/topic/FHIR.20test.20server.20on.20Linux</a></p>",
        "id": 153850906,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1474984919
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> for your attention</p>",
        "id": 153850915,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1474988474
    },
    {
        "content": "<p>also <a href=\"https://fhirtest.uhn.ca/\" target=\"_blank\" title=\"https://fhirtest.uhn.ca/\">https://fhirtest.uhn.ca/</a> isn't working since a few hours (at least for me) </p>\n<blockquote>\n<p>Warning!<br>\nFailed to load conformance statement, ...</p>\n</blockquote>",
        "id": 153850917,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1474989362
    },
    {
        "content": "<p>The server was down - it's up now...</p>",
        "id": 153850934,
        "sender_full_name": "David Hay",
        "timestamp": 1475002866
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192526\">@Günter Zöchbauer</span> ,</p>\n<p>Try starting the CLI server with the following argument: <code>--allow-external-refs</code></p>\n<p>By default the CLI server blocks external references, but you can turn this off via command line argument (and the examples use lots of external refs so you need to do that if you want to upload them)</p>",
        "id": 153850948,
        "sender_full_name": "James Agnew",
        "timestamp": 1475012839
    },
    {
        "content": "<p>Hi James - is there a list of these switches?</p>",
        "id": 153850952,
        "sender_full_name": "David Hay",
        "timestamp": 1475018193
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> thanks for your support!<br>\nI now get 1067 <code>ValueSet</code>s and 160 <code>StructureDefinition</code>s from <code>upload-definitions</code> but <code>upload-examples</code> still doesn't result in any records being shown  in the browser view</p>\n<p><a href=\"/user_uploads/10155/a7pVSI45qj2tQNIpJ7FdHa64/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/a7pVSI45qj2tQNIpJ7FdHa64/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/a7pVSI45qj2tQNIpJ7FdHa64/pasted_image.png\"></a></div>",
        "id": 153851000,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475042738
    },
    {
        "content": "<div class=\"codehilite\"><pre>------------------------------------------------------------\n? HAPI FHIR 2.0 - Command Line Tool\n------------------------------------------------------------\nMax configured JVM memory (Xmx): 3.5GB\nDetected Java version: 1.8.0_102\n------------------------------------------------------------\n08:08:12 INFO  ca.uhn.fhir.cli.RunServerCommand - Server is configured to allow external references\n08:08:12 INFO  ca.uhn.fhir.context.FhirContext - Creating new FHIR context for FHIR version [DSTU2]\n08:08:12 INFO  ca.uhn.fhir.cli.RunServerCommand - Preparing HAPI FHIR JPA server on port 8080\n08:08:12 INFO  ca.uhn.fhir.cli.RunServerCommand - Starting HAPI FHIR JPA server in DSTU2 mode\n08:08:19 INFO  ca.uhn.fhir.context.FhirContext - Creating new FHIR context for FHIR version [DSTU2]\n08:08:20 INFO  ca.uhn.fhir.context.FhirContext - Creating new FHIR context for FHIR version [DSTU1]\n08:08:20 INFO  ca.uhn.fhir.context.FhirContext - Creating new FHIR context for FHIR version [DSTU2_HL7ORG]\n08:08:20 INFO  ca.uhn.fhir.context.FhirContext - Creating new FHIR context for FHIR version [DSTU3]\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Warning Code: 10000, SQLState: 01J01\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Warning Code: 10000, SQLState: 01J01\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Warning Code: 10000, SQLState: 01J01\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - Database &#39;directory:target/jpaserver_derby_files&#39; not created, connection made to existing database instead.\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - Database &#39;directory:target/jpaserver_derby_files&#39; not created, connection made to existing database instead.\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - Database &#39;directory:target/jpaserver_derby_files&#39; not created, connection made to existing database instead.\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Warning Code: 10000, SQLState: 01J01\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - Database &#39;directory:target/jpaserver_derby_files&#39; not created, connection made to existing database instead.\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Warning Code: 10000, SQLState: 01J01\n08:08:23 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - Database &#39;directory:target/jpaserver_derby_files&#39; not created, connection made to existing database instead.\n08:08:23 INFO  ca.uhn.fhir.cli.RunServerCommand - Server started on port 8080\n08:08:23 INFO  ca.uhn.fhir.cli.RunServerCommand - Web Testing UI : http://localhost:8080/\n08:08:23 INFO  ca.uhn.fhir.cli.RunServerCommand - Server Base URL: http://localhost:8080/baseDstu2/\n</pre></div>",
        "id": 153851001,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475042947
    },
    {
        "content": "<p>@DavidHay  I was wondering as well</p>",
        "id": 153851012,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475047955
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> I can normally use the server and storing resources using the REST API but <code>upload-examples</code> doesn't actually load any examples. </p>",
        "id": 153851103,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475089080
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192526\">@Günter Zöchbauer</span>- It seems like there may be a bug in the 2.0 CLI :( </p>\n<p>Do you mind to try using a 2.1 snapshot build and see if it works for you there? You can download a copy here: <a href=\"https://fileportal.uhn.ca/download.aspx?ID=582f20b8-baa5-4bb6-ae1d-b35ed130b7b2\" target=\"_blank\" title=\"https://fileportal.uhn.ca/download.aspx?ID=582f20b8-baa5-4bb6-ae1d-b35ed130b7b2\">https://fileportal.uhn.ca/download.aspx?ID=582f20b8-baa5-4bb6-ae1d-b35ed130b7b2</a></p>",
        "id": 153851124,
        "sender_full_name": "James Agnew",
        "timestamp": 1475097467
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> with 2.1 I get <br>\n- 25 Observation<br>\n- 23 Medication<br>\n- 22 ConceptMap<br>\n- ...</p>\n<p>I don't know if this are the expected numbers but there is now at least one record <br>\nexcept for Bundle,  DataElement, OperationDefinition, OperationOutcome, SearchParameter, Subscription, SupportingDocumentation, Test and User</p>",
        "id": 153851234,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475139525
    },
    {
        "content": "<p>Is there a way to way to specify a port for<br>\nhapi-fhir-cli run-server<br>\nI run it in a Docker container and mapped to port 8080 to a different outside port but that breaks the WebUI</p>\n<p><a href=\"/user_uploads/10155/PAJh8Fx8cigHcqiZfEiLtgxg/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/PAJh8Fx8cigHcqiZfEiLtgxg/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\"><img src=\"/user_uploads/10155/PAJh8Fx8cigHcqiZfEiLtgxg/pasted_image.png\"></a></div>",
        "id": 153851235,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475139735
    },
    {
        "content": "<p>Re. the upload- Yup that sounds about right. The types you mentioned that you don't see (Bundle, DataElement, etc) don't get uploaded because I found that the samples all failed some rule within HAPI that prevented them from being uploaded so the uploader skips them.</p>\n<p>For example HAPI's server has a rule that Subscription needs to use the websocket transport (because that's all it supports), SearchParameter needs to map to an existing parameter, etc.</p>\n<p>Re. the docker thing that is weird! The WebUI makes its FHIR requests via a normal HTTP FHIR call, but the call originates on the server (i.e. not from the browser- it's server-to-server). Based on the UI presumably you've got it running on port 5555, which means that the server is trying to talk to itself on port 5555. I don't see any obvious reason why this shouldn't work, as it's all happening within the container. Then again, I'm not a docker export by any means...</p>",
        "id": 153851244,
        "sender_full_name": "James Agnew",
        "timestamp": 1475156841
    },
    {
        "content": "<p>I guess I'm also confused by your actual question :) Yes, it is possible to set the port for the server, e.g.:<br>\n<code>./hapi-fhir-cli run-server -p 5555</code></p>\n<p>But presumably you're already doing that, if the Web UI is trying to hit that port?</p>",
        "id": 153851245,
        "sender_full_name": "James Agnew",
        "timestamp": 1475156945
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> Thanks a lot!<br>\nI wasn't worried about the types that didn't get examples loaded, but just hoped for the confirmation that this is normal behavior.</p>\n<p>The server runs on 8080 inside Docker (because I didn't know the <code>-p</code> parameter) and Docker binds to 5555 on the outside and maps requests to the internal port (8080).<br>\nI can run it with <code>-p 5555</code> inside Docker and it should be fine. <br>\nA disadvantage is that the Docker images needs to be updated every time someone wants to use it with a different port (no big deal though but unexpected).</p>\n<p>Is there a way to get all supported options from <code>hapi-fhir-cli</code>?</p>",
        "id": 153851248,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475159755
    },
    {
        "content": "<p>Yup: <code>./hapi-fhir-cli help run-server</code></p>\n<p>(Admittedly not very intuitive syntax... we need something better imo)</p>",
        "id": 153851252,
        "sender_full_name": "James Agnew",
        "timestamp": 1475160737
    },
    {
        "content": "<p>nice<br>\nActually I don't think it's not intuitive, but the default help doesn't list the <code>help</code> command</p>",
        "id": 153851253,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475162092
    },
    {
        "content": "<p>oh, it <strong>is</strong> there but not as highlighted as the other options and therefore I missed it</p>",
        "id": 153851254,
        "sender_full_name": "Günter Zöchbauer",
        "timestamp": 1475162239
    }
]