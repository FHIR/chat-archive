[
    {
        "content": "<p>I've been looking at the profile validation in HAPI FHIR 2.3, with a view to incorporating it in various projects. The interface modelling team here makes extensive use of slicing so validating those would be a useful capability. Immediate interest is in DSTU2, with STU3 at some point in the future.</p>\n<p>We have essentially two options - either wait until the HAPI FHIR developers introduce slice validation, or work on the code and add it ourselves to contribute back into the community. What I don't know is the priority this has amongst the HAPI developers, and how close the code is to including slice validation anyway.</p>\n<p>So:<br>\n1. Is this a high priority for anybody (else)<br>\n2. Is it likely to appear soon</p>\n<p>and if the answer to those  resolved to \"no\", is there interest in a volunteer to add it ?</p>",
        "id": 153891326,
        "sender_full_name": "Damian Murphy",
        "timestamp": 1495749029
    },
    {
        "content": "<p>the FHIR team is putting all the work into the current build validator. It is able to validate version 1.0.2, 1.4, 3.0, and current. It is very good at slice validation. <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> - need to work on moving HAPI to use the current build validator</p>",
        "id": 153891409,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1495832804
    },
    {
        "content": "<p>Thanks - that should save a bunch of effort. Is this the one from the HL7 FHIR site, or in the HAPI Maven repository ? (The precise relationship between HAPI and the official validator is something I'm a little unclear on since the newer validator from the HL7 site includes HAPI classes).</p>",
        "id": 153891762,
        "sender_full_name": "Damian Murphy",
        "timestamp": 1496220233
    },
    {
        "content": "<p>HAPI uses code from the build. In order to get the code from the build to integrate into HAPI properly, some of the HAPI infrastructure is in the build, but only supporting code - it's not HAPI itself. </p>",
        "id": 153891829,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496262755
    },
    {
        "content": "<p>what we usually say to people is: if you're doing implementations, you should use HAPI, not the code in the build (though you can, and people do) - but code from the build is not, e.g. distributed via Maven - we do that through HAPI</p>",
        "id": 153891830,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496262823
    },
    {
        "content": "<p>Just taken a look at the validator.zip from the HL7 FHIR site. That removes some of the abrupt user feedback from the current sources on GitHub (throw new Error) but it isn't clear that it is actually validating slices (InstanceValidator.getValueForDiscriminator(), at least in all cases: for example returning null and valueMatches() always returning false - I did those sorts of things myself). It looks like there is a route through the code where it is validating for url discriminators, but in some cases the profiles I'm looking at use a coding system as discriminator. </p>",
        "id": 153892098,
        "sender_full_name": "Damian Murphy",
        "timestamp": 1496404219
    },
    {
        "content": "<p>can you provide a profile and instance for testing? I'm working on unit tests for the validator at the moment</p>",
        "id": 153892185,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496443894
    },
    {
        "content": "<p>Yes, I'll dig some out. They're the ones from the NHS UK \"Care Connect\" API on github.</p>",
        "id": 153892293,
        "sender_full_name": "Damian Murphy",
        "timestamp": 1496669419
    },
    {
        "content": "<p>Sorry about the wait. Line 661 of the structure definition has a slice with a system as discriminator (patient ids using national or local identifiers). Plus an example.,<a href=\"/user_uploads/10155/yr5dmW200_-s5Zn2uT7SZ719/SD_ADW-Patient-1-0-Ex01.xml\" target=\"_blank\" title=\"SD_ADW-Patient-1-0-Ex01.xml\">SD_ADW-Patient-1-0-Ex01.xml</a> <a href=\"/user_uploads/10155/4W-MYDzytsYjC17ObPxZKPm-/EX_ADW-Patient-1-0-Ex01.xml\" target=\"_blank\" title=\"EX_ADW-Patient-1-0-Ex01.xml\">EX_ADW-Patient-1-0-Ex01.xml</a> </p>",
        "id": 153892327,
        "sender_full_name": "Damian Murphy",
        "timestamp": 1496699228
    },
    {
        "content": "<p>which profile - I didn't find the patient profile in any branch? (or I looked in the wrong repository)</p>",
        "id": 153892596,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496799234
    },
    {
        "content": "<p>They're in the attached files. Those were made for me for testing validation (basically small enough for debugging easily) and I don't think they're in any repo.</p>",
        "id": 153892701,
        "sender_full_name": "Damian Murphy",
        "timestamp": 1496862573
    },
    {
        "content": "<p>oops. so they are. I'll need the extension definitions too</p>",
        "id": 153892775,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496878132
    }
]