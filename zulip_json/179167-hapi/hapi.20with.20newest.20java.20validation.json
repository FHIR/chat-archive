[
    {
        "content": "<p>The current hapi master branch uses fhir.core 5.1.0. This version doesn't support slicing by pattern on name and address (what we are doing in the german base profiles). This was fixed in fhir.core 5.1.10+</p>",
        "id": 214554752,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603706914
    },
    {
        "content": "<p>I tried updating the fhir.core version for hapi (whole core, and only validation) with 5.10 and 5.16 without success.</p>",
        "id": 214554816,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603706953
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Caused by: java.lang.reflect.InvocationTargetException: null\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n        at ca.uhn.fhir.rest.server.method.BaseMethodBinding.invokeServerMethod(BaseMethodBinding.java:245)\n        ... 54 common frames omitted\nCaused by: java.lang.NoSuchMethodError: org.hl7.fhir.r5.elementmodel.Element.hasParentForValidator()Z\n        at org.hl7.fhir.validation.instance.InstanceValidator.setParents(InstanceValidator.java:5096)\n        at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:697)\n        at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:553)\n        at org.hl7.fhir.common.hapi.validation.validator.ValidatorWrapper.validate(ValidatorWrapper.java:165)\n        at org.hl7.fhir.common.hapi.validation.validator.FhirInstanceValidator.validate(FhirInstanceValidator.java:211)\n        at org.hl7.fhir.common.hapi.validation.validator.BaseValidatorBridge.doValidate(BaseValidatorBridge.java:22)\n        at org.hl7.fhir.common.hapi.validation.validator.BaseValidatorBridge.validateResource(BaseValidatorBridge.java:45)\n        at org.hl7.fhir.common.hapi.validation.validator.FhirInstanceValidator.validateResource(FhirInstanceValidator.java:29)\n        at ca.uhn.fhir.validation.FhirValidator.validateWithResult(FhirValidator.java:245)\n</code></pre></div>",
        "id": 214554839,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603706970
    },
    {
        "content": "<p>The structure of the methods in the java validator aren't fitting anymore. Did anyone else tried the same, or started a branch with a newer fhir.core which i didn't see?</p>",
        "id": 214554997,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603707031
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> : I have our validator working with the combo hapi 5.2.0-snapshot and fhir.core.version 5.1.15, later is not yet possible due to class name changes, see <a href=\"https://github.com/ahdis/hapi-fhir-jpaserver-validator/releases/tag/v1.1.0\">https://github.com/ahdis/hapi-fhir-jpaserver-validator/releases/tag/v1.1.0</a> if interested.</p>",
        "id": 214556487,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1603707940
    },
    {
        "content": "<p>Wow, very helpful. Thank you <span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span></p>",
        "id": 214556577,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603707979
    },
    {
        "content": "<p>Wondering why i got errors wit 5.1.10. Have you tried validating an jnstance against a profile with patternSlicing on name or address? This triggers the reflection nullpointer in my case</p>",
        "id": 214556669,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603708057
    },
    {
        "content": "<p>Ok tried to apply your pom changes to the current jpa starter:</p>\n<ul>\n<li>hapi snapshot 5.2.0 is currently broken, tried 5.1.0</li>\n<li>upped *core to 5.1.15</li>\n<li>hapi can't resolve datatype strucdefs which have been posted to the server during validation. I then added the data type profiles via ig -&gt; kind of works</li>\n<li>now the validator returns:         </li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code>{\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;code&quot;: &quot;processing&quot;,\n            &quot;diagnostics&quot;: &quot;Expected 0 but found 2 prefix elements&quot;,\n            &quot;location&quot;: [\n                &quot;Patient.name[0]&quot;,\n                &quot;Line 24, Col 6&quot;\n            ]\n        },\n        {\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;code&quot;: &quot;processing&quot;,\n            &quot;diagnostics&quot;: &quot;Expected 0 but found 2 suffix elements&quot;,\n            &quot;location&quot;: [\n                &quot;Patient.name[0]&quot;,\n                &quot;Line 24, Col 6&quot;\n            ]\n        }\n</code></pre></div>",
        "id": 214564981,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603714234
    },
    {
        "content": "<p>The patient example i'm validating doesn't include any name prefis or suffix elements...</p>",
        "id": 214565024,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603714270
    },
    {
        "content": "<p>no sorry, I don't think i have patternSlicing on name or address in our ig's</p>",
        "id": 214565531,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1603714661
    },
    {
        "content": "<p>no worries, thanks again for your response!</p>",
        "id": 214566043,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603715122
    },
    {
        "content": "<p>In the java validator everything just works.. will try to get the core dependency to a up to date version in the hapi project.</p>",
        "id": 214566149,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1603715179
    },
    {
        "content": "<p>Hello everyone, were facing a similar response when trying to validate our patient resource against the mii kds person profile. The <a href=\"https://simplifier.net/MedizininformatikInitiative-ModulPerson/PatientIn/~overview\">Structure definition file</a> looks fine imo, so i guess its an hapi related issue. were using 5.2.0 numbat version.</p>\n<p>example: </p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;address&quot;: [\n{\n&quot;type&quot;: &quot;both&quot;,\n&quot;line&quot;: [\n  &quot;Musterstr. 1&quot;\n],\n  &quot;city&quot;: &quot;Darmstadt&quot;,\n  &quot;postalCode&quot;: &quot;64283&quot;,\n  &quot;country&quot;: &quot;DE&quot;\n }\n]\n</code></pre></div>\n<p>results in:</p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;severity&quot;: &quot;error&quot;,\n&quot;code&quot;: &quot;processing&quot;,\n&quot;diagnostics&quot;: &quot;Expected 0 but found 1 line elements&quot;,\n&quot;location&quot;: [\n&quot;Patient.address[0]&quot;,\n&quot;Line 36, Col 10&quot;\n]\n}\n</code></pre></div>\n<p>If you omit the line, however, the validator then also complains (which is correct): </p>\n<div class=\"codehilite\"><pre><span></span><code>{\n&quot;severity&quot;: &quot;error&quot;,\n&quot;code&quot;: &quot;processing&quot;,\n&quot;diagnostics&quot;: &quot;Patient.address:Strassenanschrift.line: minimum required = 1, but only found 0 (from https://www.medizininformatik-initiative.de/fhir/core/modul-person/StructureDefinition/Patient)&quot;,\n&quot;location&quot;: [\n&quot;Patient.address[0]&quot;,\n&quot;Line 36, Col 10&quot;\n] }\n</code></pre></div>\n<p>If u need further information, just let me know pls. thx so far.</p>",
        "id": 226803720,
        "sender_full_name": "David Meyers",
        "timestamp": 1613652036
    },
    {
        "content": "<p>We have just checked if the problem is also present in version 5.3.0 -&gt; unfortunately it is.</p>",
        "id": 228558205,
        "sender_full_name": "David Meyers",
        "timestamp": 1614762345
    },
    {
        "content": "<p>its a bug. I already added a PR here: <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/424\">https://github.com/hapifhir/org.hl7.fhir.core/pull/424</a><br>\nI will add Changelog and Testcase this week, so this bug will be fixed soon.</p>",
        "id": 229259529,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1615189913
    }
]