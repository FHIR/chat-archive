[
    {
        "content": "<p>Hi.</p>\n<p>I've been creating an R4-endpoint for our resource server and I noticed while testing profile validation that the R4 version (and R5 version it would seem) of the IWorkerContext.ValidationResult isOk-method has been changed.</p>\n<p>In DSTU3 this method would check if the ValidationResults ConceptDefinitionComponent was not null.<br>\nIn R4 this method checks if the IssueSeverity of ValidationResult is either null, Information or Warning.</p>\n<p>This would give us different error responses in stu3 and r4 endpoints while validating ValueSets with codes from not present code systems (for example LOINC).</p>\n<p>In DSTU3 a code system not being present would result in a ValidationResult with isOk returning false.<br>\nIn R4 a code system not being present would result in a ValidationResult with isOk returning true.</p>\n<p>Is this an intended change? And if it is, can you tell why?</p>\n<p>I'm pretty new to HAPI so bear with me here.</p>",
        "id": 177908666,
        "sender_full_name": "Juuso Oksanen",
        "timestamp": 1570802118
    },
    {
        "content": "<p>I believe I changed that. And I changed it because validation tests were failing. However... the only validation infrastructure I support is the R5 infrastructure, which will validate R2-R5. Have you looked at that?</p>",
        "id": 177924756,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1570811773
    },
    {
        "content": "<p>This is probably more of an Hapi question, we are currently looking at supporting both STU3 and R4, why we noticed this difference. It seems that depending on the FHIRContext we have (FhirContext.forDstu3() for example) it seems to pick the corresponding InstanceValidator. Should we use Hapi in different way to have only R5 validation?</p>",
        "id": 178080673,
        "sender_full_name": "Eeva Turkka",
        "timestamp": 1571039242
    },
    {
        "content": "<p>that's a question for <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>.</p>",
        "id": 178083030,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1571041458
    },
    {
        "content": "<blockquote>\n<p>This is probably more of an Hapi question, we are currently looking at supporting both STU3 and R4, why we noticed this difference. It seems that depending on the FHIRContext we have (FhirContext.forDstu3() for example) it seems to pick the corresponding InstanceValidator. Should we use Hapi in different way to have only R5 validation?</p>\n</blockquote>\n<p>The R5-version of InstanceValidator is being used in both STU3 and R4 endpoints. This is because the InstanceValidator is wrapped by FhirInstanceValidator which we have registered as a validator module in the FhirValidator, correct?</p>",
        "id": 178086312,
        "sender_full_name": "Juuso Oksanen",
        "timestamp": 1571044247
    },
    {
        "content": "<p>Notable changes from STU3 to R4 is that:<br>\n-FhirValidator is given the R4 FhirContext instead of STU3 (FhirContext.newValidator())<br>\n-FhirInstanceValidator is R4-version instead of STU3 and is given the corresponding ValidationSupportChain</p>",
        "id": 178086767,
        "sender_full_name": "Juuso Oksanen",
        "timestamp": 1571044756
    }
]