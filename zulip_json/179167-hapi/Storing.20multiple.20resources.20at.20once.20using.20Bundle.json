[
    {
        "content": "<p>I'm having some trouble trying to store multiple resources in a single request. If I understand correctly the best way to do this would be using a batch or transaction. Here is some Kotlin code I've been trying with Hapi (both server and client at version 3.8.0). </p>\n<div class=\"codehilite\"><pre><span></span>val bundle = Bundle()\nbundle.type = Bundle.BundleType.BATCH\n\nconditions.forEach { condition -&gt;\n    bundle.addEntry()\n            .setResource(condition)\n            .request\n                    .setUrl(&quot;Condition&quot;)\n                    .setMethod(Bundle.HTTPVerb.POST)\n}\n\nclient.transaction().withBundle(bundle).execute()\n</pre></div>\n\n\n<p>Unfortunately the server is giving me the following error:</p>\n<div class=\"codehilite\"><pre><span></span>HTTP 400 : This is the base URL of FHIR server. Unable to handle this request, as it does not contain a resource type or operation name.\n</pre></div>\n\n\n<p>I've tried with <code>Bundle.BundleType.TRANSACTION</code> and with <code>client.transaction().withResources(conditions).execute()</code> as well but both give the same error.</p>\n<p>If I don't use my own Hapi server but the one on <code>https://fhirtest.uhn.ca/</code> it does seem to work. Here I've pasted the generated XML in the \"transaction\" box on the home page. Is there something I need to configure on my Hapi server to make this work?</p>",
        "id": 182962414,
        "sender_full_name": "Pelle Wielinga",
        "timestamp": 1575903293
    },
    {
        "content": "<p>you have to use a transaction bundle and send it against the base url of the FHIR server.</p>",
        "id": 182963594,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1575904036
    },
    {
        "content": "<p><code>client.transaction().withBundle(bundle).execute()</code>would be the correct one for sending a transaction bundle to the server.</p>",
        "id": 182963829,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1575904144
    },
    {
        "content": "<p>Well, this is what I'm doing. This is what I am doing to create the client:</p>\n<div class=\"codehilite\"><pre><span></span>        val context = FhirContext.forR4().restfulClientFactory\n        val tokenInterceptor = BearerTokenAuthInterceptor(token)\n\n        client = context.newGenericClient(&quot;http://localhost:8080/fhir&quot;)\n        client.registerInterceptor(tokenInterceptor)\n</pre></div>\n\n\n<p>I can see a request to <code>http://localhost:8080/fhir</code> with the bundle as an xml body.</p>",
        "id": 182965063,
        "sender_full_name": "Pelle Wielinga",
        "timestamp": 1575904827
    }
]