[
    {
        "content": "<p>I've got a HAPI FHIR JPA server started (fresh checkout from HAPI-FHIR-JpaServer-Starter</p>\n<p>After asking on the google groups mailing list, I learned that I can specify an NPM package to include an implementation guide.</p>\n<p>Now, I've already got QI-Core validation working in a Plain Server, but was looking for the most straight-forward way to set this up in a JpaServer.</p>\n<p>The server starts, and the structure definitions are loaded. However, the validation isn't actually happening when I create a Patient resource.</p>\n<p>I'm testing this by creating a Patient without <a href=\"http://name.family\">name.family</a> (which is required by QI-Core, but not required by base FHIR R4 )</p>\n<p>Any suggestions for what I can look for to see if I have something setup incorrectly? Or.. should is the expected behavior different from what I'm expecting?</p>",
        "id": 265213704,
        "sender_full_name": "Greg A",
        "timestamp": 1639685973
    },
    {
        "content": "<p>There are multiple places where your validation can kick in. The JPA starter uses the RepositoryValidationInterceptors as default. See more here: <a href=\"https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/java/ca/uhn/fhir/jpa/starter/RepositoryValidationInterceptorFactoryR4.java\">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/java/ca/uhn/fhir/jpa/starter/RepositoryValidationInterceptorFactoryR4.java</a></p>",
        "id": 265213972,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639686104
    },
    {
        "content": "<p>Thanks for the hint Jens.  </p>\n<p>So looking at the BaseJpaRestfulServer, it appears that the instance of factory that should be Autowired to  a RepositoryValidationInterceptors is null</p>\n<p>I'm guessing that it's simply because of this @ConditionalOnProperty(prefix = \"hapi.fhir\", name = \"enable_repository_validating_interceptor\", havingValue = \"true\")</p>\n<p>and in application.yaml</p>\n<div class=\"codehilite\"><pre><span></span><code>#    enable_repository_validating_interceptor: false\n</code></pre></div>\n\n<p>I haven't used \"ConditionalOnProperty\" before, but if I explicitly set it to true, then the interceptor factory registers and the Resources are validates as I expected.</p>",
        "id": 265233225,
        "sender_full_name": "Greg A",
        "timestamp": 1639696217
    }
]