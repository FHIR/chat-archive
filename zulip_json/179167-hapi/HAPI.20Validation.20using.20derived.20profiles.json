[
    {
        "content": "<p>Does HAPI work with derived profiles? </p>\n<p>FHIR Validator works fine, as does hapi with <a href=\"https://fhir.nhs.uk/R4/StructureDefinition/UKCore-PractitionerRole\">https://fhir.nhs.uk/R4/StructureDefinition/UKCore-PractitionerRole</a>. <br>\nbut <a href=\"https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole\">https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole</a> which is a derived profile returns <br>\n<a href=\"https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole\">https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole</a></p>\n<p>I can see the StructureDefinition being returned in the valiation chain. (I'm still debugging)</p>",
        "id": 201353844,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592544539
    },
    {
        "content": "<p>This is getting weird. It's finding resources that are not in supplied packages but in ones I unofficially released using IG Publisher.</p>",
        "id": 201356072,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592547365
    },
    {
        "content": "<p>note that the core HAPI validator is the same is the FHIR Validator, but the context it runs in is much more complicated than the FHIR validation because the context management gives you - the system integrator using HAPI - much more control, as befits an application library. </p>\n<p>Also, which version of FHIR are you using? the package subsystem was re-written in HAPI 5</p>",
        "id": 201356175,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592547518
    },
    {
        "content": "<p>on HAPI 5 but did have this working on earlier versions. I think I need to clear my cache - suspect I've got it looking there.</p>",
        "id": 201357006,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592548616
    },
    {
        "content": "<p>Need to investigate more. It does seem the (simplifier) packages I'm using are be ignored for another source of packages somewhere in the process.</p>",
        "id": 201359380,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592551492
    },
    {
        "content": "<p>snapshot?</p>",
        "id": 201403385,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592579615
    },
    {
        "content": "<p>And the problem was the new person on the team not creating a snapshot profiles in the IG......</p>\n<p>No names</p>",
        "id": 201405676,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592580679
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> not sure if itâ€™s a requirement for packages but issue above was caused by lack of snapshot in profile.</p>",
        "id": 201433780,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592596587
    },
    {
        "content": "<p>the validator should just automatically populate the snapshot. So I would like to know why that's a problem</p>",
        "id": 201434027,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592596771
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194909\">@Kevin Mayfield</span> Also, it's not a requirement yet, but we are moving there to prevent other tools needing to generate it.</p>",
        "id": 201436628,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1592598514
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I'm going to look into that, that's my preferred option. The packages look fine and I think I just need a step to create the snapshot during load (which I think is a step the FHIR Validator does).</p>",
        "id": 201459980,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592624768
    },
    {
        "content": "<p>well, I think that the HAPI context should sort that out</p>",
        "id": 201459988,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592624798
    },
    {
        "content": "<p>It might be how I've created profiles. They are on top of UK Core profiles not base.</p>",
        "id": 201460054,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592624900
    },
    {
        "content": "<p>shouldn't matter. my view is that the HAPI context should sort that out</p>",
        "id": 201460072,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592624973
    },
    {
        "content": "<p>TERMINOLOGY  -  I think its my validationSupport at fault. It needs to expand ValueSets and create Snapshots. Looking at <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/BaseWorkerContext.java\">https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/BaseWorkerContext.java</a> some of this is done there. I think my fetchResource needs to do this.</p>\n<p>The HAPI RemoteTerminologyServiceValidationSupport seems to behave differently to BaseWorkerContext around SNOMED.</p>",
        "id": 201518751,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592718426
    },
    {
        "content": "<p>SNAPSHOT - It appears the validation worker context would do that but I can't find a link to that in HAPI. <br>\nI should be calling something like  ProfileUtilities in org.hl7.fhir.r4.conformance to generate the context.</p>",
        "id": 201521729,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592724171
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> I think the context should look after snapshot generation automatically. Java user shouldn't have to think about this</p>",
        "id": 201527275,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592733252
    },
    {
        "content": "<p>ProfileUtilities.generateSnapshot  worked for me. <br>\nI roughly followed this <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/blob/463a5574027473db99df732859c1b408e11f0423/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/SimpleWorkerContext.java#L582\">https://github.com/hapifhir/org.hl7.fhir.core/blob/463a5574027473db99df732859c1b408e11f0423/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/SimpleWorkerContext.java#L582</a></p>",
        "id": 201548699,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1592766721
    }
]