[
    {
        "content": "<p>In an AuditEvent, it is important that References to resources are versioned. However, the default behaviour of HAPI's serialisation is to strip version references and thus the values of <code>AuditEvent.entity.what</code> are serialised without the version component of the reference.<br>\nFrom inspection of <code>streamResponseAsResource</code>, it appears that even with the use of interceptors (<span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  ;-), there is no simple way to tell HAPI to retain the version references?</p>",
        "id": 259159759,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1635281793
    },
    {
        "content": "<p>You should be able to call <code>setDontStripVersionsFromReferencesAtPaths</code> on either the parser (if you're serializing manually) or on the <code>FhirContext#getParserOptions()</code> object (if you want it to apply globally)</p>",
        "id": 259184118,
        "sender_full_name": "James Agnew",
        "timestamp": 1635298987
    },
    {
        "content": "<p>The challenge I have is that I only want it set when returning the AuditEvent, and I can't get to the parser that's created by streamResponseAsResource to call it there and I really don't want to have to replicate all the other logic going on in there.</p>",
        "id": 259296041,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1635363910
    }
]