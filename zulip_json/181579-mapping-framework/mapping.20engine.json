[
    {
        "content": "<p>Has anyone got a mapping engine (free or not) available that can execute maps in the mapping language?</p>",
        "id": 159240013,
        "sender_full_name": "David Hay",
        "timestamp": 1550946455
    },
    {
        "content": "<p>there's a java version in the reference implementation</p>",
        "id": 159246993,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1550958435
    },
    {
        "content": "<p>Is there a description of the parameters to use?</p>",
        "id": 159284058,
        "sender_full_name": "David Hay",
        "timestamp": 1551029522
    },
    {
        "content": "<p>I don't think I've documented it well. I'll add it to my todo list</p>",
        "id": 159305208,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551056900
    },
    {
        "content": "<p>Just a simple list of the parameters would be fine - like you had in your blog when you announced it a couple of years back - it's just I got an error using those ones, so not sure what to use...</p>",
        "id": 159306717,
        "sender_full_name": "David Hay",
        "timestamp": 1551059719
    },
    {
        "content": "<p>what was the error?</p>",
        "id": 159311052,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551067403
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> I use the following parameters to execute a transform with the java validator:<br>\n java -jar ./org.hl7.fhir.validation.cli.jar ./qrebida.1.json -ig ./map/qr2pat1.map -transform <a href=\"http://ahdis.ch/fhir/mappingtutorial/qr2pat1\" target=\"_blank\" title=\"http://ahdis.ch/fhir/mappingtutorial/qr2pat1\">http://ahdis.ch/fhir/mappingtutorial/qr2pat1</a> -output ./mapres1.xml -log ./test.log</p>",
        "id": 159317431,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1551078004
    },
    {
        "content": "<p>Thanks Oliver - I'll give that a go!</p>",
        "id": 159354515,
        "sender_full_name": "David Hay",
        "timestamp": 1551115114
    },
    {
        "content": "<p><a href=\"http://wiki.hl7.org/index.php?title=Using_the_FHIR_Mapping_Language\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=Using_the_FHIR_Mapping_Language\">http://wiki.hl7.org/index.php?title=Using_the_FHIR_Mapping_Language</a></p>",
        "id": 159867021,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551650938
    },
    {
        "content": "<p>for the version parameter, are the options STU3, R4 &amp; R5 the correct ones?</p>",
        "id": 159868427,
        "sender_full_name": "David Hay",
        "timestamp": 1551653288
    },
    {
        "content": "<p>no. updated the doco</p>",
        "id": 159870689,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551657195
    },
    {
        "content": "<p>do I need to specify the map file in the command line (as per the tutorial in the spec - <a href=\"http://hl7.org/fhir/mapping-tutorial.html\" target=\"_blank\" title=\"http://hl7.org/fhir/mapping-tutorial.html\">http://hl7.org/fhir/mapping-tutorial.html</a>)? Or will it find it if it is in the folder specified by -ig? It's just a text file - right? ie it's not an instance of StructureMap..</p>",
        "id": 159875125,
        "sender_full_name": "David Hay",
        "timestamp": 1551664677
    },
    {
        "content": "<p>Also getting errors: Content is not allowed in prolog - but not telling me which file has the issues...</p>",
        "id": 159875176,
        "sender_full_name": "David Hay",
        "timestamp": 1551664717
    },
    {
        "content": "<p>it has to be loaded from an -ig parameter</p>",
        "id": 159875190,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551664761
    },
    {
        "content": "<p>can you give me the stack for Content is not allowed in prolog</p>",
        "id": 159875193,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551664786
    },
    {
        "content": "<p>FHIR Validation tool Version 3.7.5-SNAPSHOT - Built 2019-02-08T17:54:37.739+11:00 - Git f5c592fbadf9<br>\nArguments: ./patient.json -output ./myPatient.json -transform <a href=\"http://hl7.org/fhir/StructureMap/tutorial\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/tutorial\">http://hl7.org/fhir/StructureMap/tutorial</a> -version 3.0.1 -ig ./defs -log ./out.log<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n  .. definitions from hl7.fhir.core#3.0.1<br>\n    (v3.0.1)<br>\n+  .. load IG from ./defs<br>\n[Fatal Error] :1:1: Content is not allowed in prolog.<br>\n[Fatal Error] :1:1: Content is not allowed in prolog.<br>\nException in thread \"main\" java.lang.Error: Unable to find map <a href=\"http://hl7.org/fhir/StructureMap/tutorial\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/tutorial\">http://hl7.org/fhir/StructureMap/tutorial</a><br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.transform(ValidationEngine.java:955)<br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.transform(ValidationEngine.java:943)<br>\n    at org.hl7.fhir.r4.validation.Validator.main(Validator.java:390)</p>",
        "id": 159875282,
        "sender_full_name": "David Hay",
        "timestamp": 1551664912
    },
    {
        "content": "<p>'defs' folder has the StructureDefinition for Patient (Xml) and a textfile that has the map (pretty much a copy of the one in the tutorial)</p>",
        "id": 159875348,
        "sender_full_name": "David Hay",
        "timestamp": 1551664983
    },
    {
        "content": "<p>patient.json is a Patient instance in the same folder where I invoke the mapping from...</p>",
        "id": 159875361,
        "sender_full_name": "David Hay",
        "timestamp": 1551665021
    },
    {
        "content": "<p>what's the file name of the map?</p>",
        "id": 159875437,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551665158
    },
    {
        "content": "<p>patientmap.txt</p>",
        "id": 159875501,
        "sender_full_name": "David Hay",
        "timestamp": 1551665239
    },
    {
        "content": "<p>the tool expects *.map not *.txt. but it will be loaded anyway - it's just trying XML first</p>",
        "id": 159875568,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551665397
    },
    {
        "content": "<p>I released a new validator - download the new one and try again - you'll get a more useful error message</p>",
        "id": 159876200,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551666439
    },
    {
        "content": "<p>from the r4 site?</p>",
        "id": 159876274,
        "sender_full_name": "David Hay",
        "timestamp": 1551666556
    },
    {
        "content": "<p>or continuous build..</p>",
        "id": 159876280,
        "sender_full_name": "David Hay",
        "timestamp": 1551666574
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/validator.zip\" target=\"_blank\" title=\"http://build.fhir.org/validator.zip\">http://build.fhir.org/validator.zip</a>  is a 404 - I'll try again in a couple of mins...</p>",
        "id": 159876422,
        "sender_full_name": "David Hay",
        "timestamp": 1551666731
    },
    {
        "content": "<p>from the link in the documentation on that wiki page</p>",
        "id": 159876423,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551666753
    },
    {
        "content": "<p>oh Do'h!</p>",
        "id": 159876430,
        "sender_full_name": "David Hay",
        "timestamp": 1551666776
    },
    {
        "content": "<p>this is super wierd. </p>\n<p>It seems to think the mapping file has a .txt extension - but here's the folder contents:</p>\n<p>davids-MacBook-Pro:defs davidhay$ ls -al<br>\ntotal 272<br>\ndrwxr-xr-x@  5 davidhay  staff     160  4 Mar 15:27 .<br>\ndrwxr-xr-x@ 10 davidhay  staff     320  4 Mar 15:36 ..<br>\n-rw-r--r--@  1 davidhay  staff    6148  4 Mar 14:45 .DS_Store<br>\n-rw-r--r--@  1 davidhay  staff     318  4 Mar 14:08 mappatient.map<br>\n-rw-r--r--@  1 davidhay  staff  123876  4 Mar 14:52 patientDef.xml</p>\n<p>(I tried renaming the map file from the command line and it still thinks it's a .txt)</p>\n<p>Error:</p>\n<p>FHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-11T12:49:16.829-05:00 - Git 7a8671008476<br>\nArguments: ./patient.json -output ./myPatient.json -transform <a href=\"http://hl7.org/fhir/StructureMap/tutorial\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/tutorial\">http://hl7.org/fhir/StructureMap/tutorial</a> -version 3.0.1 -ig ./defs -log ./out.log<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n  .. definitions from hl7.fhir.core#3.0.1<br>\n    (v3.0.1)<br>\n+  .. load IG from ./defs<br>\n[Fatal Error] :1:1: Content is not allowed in prolog.<br>\nException in thread \"main\" java.lang.Exception: Error parsing mappatient.txt: Unsupported format for mappatient.txt<br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.loadIg(ValidationEngine.java:692)<br>\n    at org.hl7.fhir.r4.validation.Validator.main(Validator.java:373)<br>\nCaused by: java.lang.Exception: Unsupported format for mappatient.txt<br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.loadIg(ValidationEngine.java:658)</p>",
        "id": 159876806,
        "sender_full_name": "David Hay",
        "timestamp": 1551667517
    },
    {
        "content": "<p>Think I'll go and have a cup of tea...</p>",
        "id": 159876814,
        "sender_full_name": "David Hay",
        "timestamp": 1551667543
    },
    {
        "content": "<p>tried changing the definitions folder - still the same error.      reads a .map file, but thinks it's a .txt file.   If I specify the file name for -ig then I still get the parsing error, but don't get the prolog error...</p>",
        "id": 159878525,
        "sender_full_name": "David Hay",
        "timestamp": 1551670374
    },
    {
        "content": "<p>I don't understand how it can be confused about the file name</p>",
        "id": 159884561,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551671596
    },
    {
        "content": "<p>me neither...  but even when I change the filename - and try a different folder - and specify the name in the command line - it still comes back as .txt. Are there any other options to specify the mapping file?</p>",
        "id": 159884733,
        "sender_full_name": "David Hay",
        "timestamp": 1551671901
    },
    {
        "content": "<p>ok I see what's happening. Will issue a new version shortly</p>",
        "id": 159885002,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551672299
    },
    {
        "content": "<p>excellent!</p>",
        "id": 159886021,
        "sender_full_name": "David Hay",
        "timestamp": 1551673775
    },
    {
        "content": "<p>ok try again</p>",
        "id": 159886585,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551674530
    },
    {
        "content": "<p>sorry: Exception in thread \"main\" org.hl7.fhir.dstu3.utils.client.EFhirClientException: Error sending Http Request: Connect to tx.fhir.org:80 timed out</p>",
        "id": 159887603,
        "sender_full_name": "David Hay",
        "timestamp": 1551676162
    },
    {
        "content": "<p>Ping works OK</p>",
        "id": 159887608,
        "sender_full_name": "David Hay",
        "timestamp": 1551676201
    },
    {
        "content": "<p>its rebooting.</p>",
        "id": 159887664,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551676244
    },
    {
        "content": "<p>Sorry: FHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-11T12:49:16.829-05:00 - Git 7a8671008476<br>\nArguments: ./patient.json -output ./myPatient.json -transform <a href=\"http://hl7.org/fhir/StructureMap/tutorial\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/tutorial\">http://hl7.org/fhir/StructureMap/tutorial</a> -version 3.0.1 -ig ./definition<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n  .. definitions from hl7.fhir.core#3.0.1<br>\n    (v3.0.1)<br>\n+  .. load IG from ./definition<br>\nException in thread \"main\" java.lang.Exception: Error parsing mp.txt: Unsupported format for mp.txt</p>",
        "id": 159887746,
        "sender_full_name": "David Hay",
        "timestamp": 1551676395
    },
    {
        "content": "<p>still there I'm afraid:</p>\n<p>FHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-11T12:49:16.829-05:00 - Git 7a8671008476<br>\nArguments: ./patient.json -output ./myPatient.json -transform <a href=\"http://hl7.org/fhir/StructureMap/tutorial\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/tutorial\">http://hl7.org/fhir/StructureMap/tutorial</a> -version 3.0.1 -ig ./defs<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n  .. definitions from hl7.fhir.core#3.0.1<br>\n    (v3.0.1)<br>\n+  .. load IG from ./defs<br>\n[Fatal Error] :1:1: Content is not allowed in prolog.<br>\nException in thread \"main\" java.lang.Exception: Error parsing map.txt: Unsupported format for map.txt<br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.loadIg(ValidationEngine.java:692)<br>\n    at org.hl7.fhir.r4.validation.Validator.main(Validator.java:373)<br>\nCaused by: java.lang.Exception: Unsupported format for map.txt<br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.loadIg(ValidationEngine.java:658)</p>",
        "id": 159887811,
        "sender_full_name": "David Hay",
        "timestamp": 1551676530
    },
    {
        "content": "<p>defs folder:<br>\ndavids-MacBook-Pro:mapping davidhay$ cd defs<br>\ndavids-MacBook-Pro:defs davidhay$ ls -al<br>\ntotal 272<br>\ndrwxr-xr-x@  5 davidhay  staff     160  4 Mar 15:43 .<br>\ndrwxr-xr-x@ 11 davidhay  staff     352  4 Mar 18:07 ..<br>\n-rw-r--r--@  1 davidhay  staff    6148  4 Mar 14:45 .DS_Store<br>\n-rw-r--r--@  1 davidhay  staff     318  4 Mar 14:08 map.map<br>\n-rw-r--r--@  1 davidhay  staff  123876  4 Mar 14:52 patientDef.xml</p>",
        "id": 159887819,
        "sender_full_name": "David Hay",
        "timestamp": 1551676551
    },
    {
        "content": "<p>btw the build date on the .jar seems old...</p>",
        "id": 159887881,
        "sender_full_name": "David Hay",
        "timestamp": 1551676645
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> where does 3.8.0 come from? Where does the build date come from?</p>",
        "id": 159887936,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551676692
    },
    {
        "content": "<p>it really looks like not the latest version to me</p>",
        "id": 159887951,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551676757
    },
    {
        "content": "<p>and the file size is exactly the same...<br>\nbummer...</p>",
        "id": 159888029,
        "sender_full_name": "David Hay",
        "timestamp": 1551676908
    },
    {
        "content": "<p>Any update?</p>",
        "id": 160116296,
        "sender_full_name": "David Hay",
        "timestamp": 1551893631
    },
    {
        "content": "<p>have you tried again? I was left unsure which version you were using.</p>",
        "id": 160125443,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551899775
    },
    {
        "content": "<p>Yep - same error (unsupported format) - doesn't seem to be recognizing the map.map file...</p>\n<p>output from execution:<br>\nFHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-11T12:49:16.829-05:00 - Git 7a8671008476<br>\nArguments: ./patient.json -output ./myPatient.json -transform <a href=\"http://hl7.org/fhir/StructureMap/tutorial\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/tutorial\">http://hl7.org/fhir/StructureMap/tutorial</a> -version 3.0.1 -ig ./defs<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n  .. definitions from hl7.fhir.core#3.0.1<br>\n    (v3.0.1)<br>\n+  .. load IG from ./defs<br>\n[Fatal Error] :1:1: Content is not allowed in prolog.<br>\nException in thread \"main\" java.lang.Exception: Error parsing map.txt: Unsupported format for map.txt</p>\n<p>mapping file is map.map in defs subfolder</p>\n<p>(Note that after you updated the file, I downloaded from the link on the documentation page in the wiki - but filesize was unchanged...)</p>",
        "id": 160132637,
        "sender_full_name": "David Hay",
        "timestamp": 1551904924
    }
]