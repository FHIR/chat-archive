[
    {
        "content": "<p>Yesterday during the FHIR-I teleconf, we discussed <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21642\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21642\">GF#21642</a>, asking for the addition of a \"const\" or \"let\" to the mapping language, so you can define, say, a named constant for an often-used extension url in your mapping.</p>\n<p>like so:</p>\n<div class=\"codehilite\"><pre><span></span>let TariffFormExtensionUrl = &#39;http://uk-koeln.de/fhir/StructureDefinition/Extension/nNGM/pkvTarifform/0.1&#39;\n</pre></div>\n\n\n<p>We have several things we want to discuss before we decide on adding this:</p>\n<ul>\n<li>Where do we allow a let?  Just at the top of the mapping file with a global scope?  Inside each group or nested set of dependent rules?</li>\n<li>The <code>let</code> would just define a read-only label, you cannot re-assign another value to it later on.  </li>\n<li>It would need to be defined at the beginning of a group, it makes no sense to insert a let between rules.</li>\n<li>Would this only work with constant values?  E.g. should we let the right hand side of the let contain function calls? Or refer to variables/aliases defined in the parent scope of the <code>let</code>?</li>\n<li>If a constant, shall we call it 'const'?</li>\n</ul>\n<p>Currently, my engine supports constant values only, and they need to be included just before the first group in a map.  When serialized to a StructureMap, I emit an extension:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;StructureMap xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n    &lt;extension url=&quot;http://hl7.org/fhir/5.0/StructureDefinition/extension-StructureMap.let&quot;&gt;\n        &lt;extension url=&quot;name&quot;&gt;\n            &lt;valueString value=&quot;TariffFormExtensionUrl&quot; /&gt;\n        &lt;/extension&gt;\n        &lt;extension url=&quot;value&quot;&gt;\n            &lt;valueString value=&quot;http://uk-koeln.de/fhir/StructureDefinition/Extension/nNGM/pkvTarifform/0.1&quot; /&gt;\n        &lt;/extension&gt;\n    &lt;/extension&gt;\n    &lt;url value=&quot;http://fire.ly/tests/AllFeatures&quot; /&gt;\n</pre></div>",
        "id": 173672638,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1566318297
    },
    {
        "content": "<p>what type can it have? primitive only?</p>",
        "id": 173824401,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1566415437
    },
    {
        "content": "<p>can it be defined at group scope?</p>",
        "id": 173824450,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1566415443
    },
    {
        "content": "<p>right hand side should allow at least the function uuid().<br>\nWhen your target is a Bundle, you may want to assign fullUrls to your entries that you can later use within different grous to link your resources together.</p>",
        "id": 175819321,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1568645438
    },
    {
        "content": "<p>global scope would mean that they could all go at the top of the mapping file, making them easier to see. Would also support use across different groups...</p>",
        "id": 182629590,
        "sender_full_name": "David Hay",
        "timestamp": 1575524369
    }
]