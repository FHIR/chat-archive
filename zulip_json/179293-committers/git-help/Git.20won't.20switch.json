[
    {
        "content": "<p>My ongoing journey of mutual antagonism with git is reaching new highs. or lows. Or whatever.</p>",
        "id": 154007916,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237469
    },
    {
        "content": "<p>I have a huge set of changes I've made and I'm trying to switch between branches so I can commit them piecemeal.</p>",
        "id": 154007917,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237504
    },
    {
        "content": "<p>if I just switch between new branches, the new branches seem to aggregate the changes across them (check out <a href=\"https://github.com/HL7/fhir/pull/72\" target=\"_blank\" title=\"https://github.com/HL7/fhir/pull/72\">https://github.com/HL7/fhir/pull/72</a> and then <a href=\"https://github.com/HL7/fhir/pull/73\" target=\"_blank\" title=\"https://github.com/HL7/fhir/pull/73\">https://github.com/HL7/fhir/pull/73</a></p>",
        "id": 154007918,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237567
    },
    {
        "content": "<p>so I decide to switch back to master between commits. Though I HATE doing that because git will take it upon itself to 'remove' files from my workspace that it decides (on my behalf) I no longer need . but what else can I do?</p>",
        "id": 154007919,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237637
    },
    {
        "content": "<p>but it won't let me switch back to master because I have a conflict. I must commit or stash. Well, I don't want to do either of those things. I want to know what the hell has changed before I try to figure it out. In fact, I don't want to do either of those. I want to merge my changes maybe. I don't know why the hell it thinks there's a clash anyway. I'm the only one making changes right now. Guess they're more manufactured clashes.</p>",
        "id": 154007920,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237734
    },
    {
        "content": "<p>anyway, after reading, I see that I should do git.exe checkout --merge master --</p>",
        "id": 154007921,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237748
    },
    {
        "content": "<p>ok. so then I get</p>",
        "id": 154007922,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237752
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>M   implementations/java/org.hl7.fhir.r4/src/org/hl7/fhir/r4/terminologies/CodeSystemUtilities.java\nM   implementations/java/org.hl7.fhir.r4/src/org/hl7/fhir/r4/utils/NarrativeGenerator.java\nM   implementations/java/org.hl7.fhir.r4/src/org/hl7/fhir/r4/utils/ToolingExtensions.java\nM   source/codesystem/codesystem-extensions-spreadsheet.xml\nM   source/codesystem/codesystem-notes.xml\nM   source/snomed/snomed.xml\nM   source/valueset/valueset-designation-use.xml\nM   tools/java/org.hl7.fhir.tools.core/src/org/hl7/fhir/tools/converters/ValueSetImporterV3.java\nM   tools/java/org.hl7.fhir.tools.core/src/org/hl7/fhir/tools/publisher/Publisher.java\nM   vscache/ucum.cache\nYour branch is behind &#39;origin/master&#39; by 4 commits, and can be fast-forwarded.\n(use &quot;git pull&quot; to update your local branch)\nSwitched to branch &#39;master&#39;\nHas merge conflict\n</pre></div>",
        "id": 154007923,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237762
    },
    {
        "content": "<blockquote>\n<p>Has merge conflict</p>\n</blockquote>",
        "id": 154007924,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237771
    },
    {
        "content": "<p>thank you for telling me where the merge conflict is...</p>",
        "id": 154007925,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237783
    },
    {
        "content": "<p>could this experience be any worse?</p>",
        "id": 154007926,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539237796
    },
    {
        "content": "<blockquote>\n<p>error: Your local changes to the following files would be overwritten by merge</p>\n</blockquote>",
        "id": 154007928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539238055
    },
    {
        "content": "<p>could you just let me know what those changes might be so I can make decisions about them? How the hell is this supposed to work?</p>",
        "id": 154007929,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539238075
    },
    {
        "content": "<p>I give up. commit everything for the sake of my sanity.</p>",
        "id": 154007933,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539238242
    },
    {
        "content": "<p>really, it's very simple, what I want to do:</p>\n<ul>\n<li>create a new branch off master</li>\n<li>cherry pick a few files out of my working directory and commit them to the new branch</li>\n<li>then push that up to the origin, and do a PR up on the origin</li>\n<li>and to do all that without touching any files in my directory. </li>\n</ul>\n<p>And while this sounds simple, GIT instead offers a myriad of workflow choices for not quite doing that list, because all the options come back to the one hard fact: it will change the files in my local directory whatever I try and do. Which is the one thing I <em>do not want to happen</em></p>",
        "id": 154007947,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539241789
    },
    {
        "content": "<p>What client are you using?</p>",
        "id": 154008009,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1539267036
    },
    {
        "content": "<p>maybe try <code>git checkout --merge</code></p>",
        "id": 154008035,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1539269389
    },
    {
        "content": "<p>I'd be careful with \"checkout --merge master\" because it'll get you out of alignment with the master branch at the origin.</p>",
        "id": 154008044,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1539269759
    },
    {
        "content": "<p>Fundamentally the ability to change branches without changing your working tree isn't something that's going to make you happy in git. There are ways to do various pieces of this (e.g., <a href=\"https://stackoverflow.com/a/15993574\" target=\"_blank\" title=\"https://stackoverflow.com/a/15993574\">https://stackoverflow.com/a/15993574</a>) but if you're not following all of the implications, you're pretty likely to get mixed up.</p>",
        "id": 154008047,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1539270107
    },
    {
        "content": "<p>I'd recommend just creating a new directory next to your main checkout (and probably \"git remote add mainwork ../path/to/main/work\"). Then you can  \"git fetch mainwork\" and cherry pick as needed.</p>",
        "id": 154008048,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1539270228
    },
    {
        "content": "<p>Except that in the FHIR source, files are organized into 150+ sub-folders.  Are you saying to create a clone of the whole FHIR source that only contains your changes?</p>",
        "id": 154008051,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539270339
    },
    {
        "content": "<p>A clone is a whole directory, containing the repo. Is this a concern for some reason?</p>",
        "id": 154008057,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1539270647
    },
    {
        "content": "<p>Having 2 full copies of the repository and sometimes working in one, sometimes working in the other doesn't sound like a recipe for good things</p>",
        "id": 154008058,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539270739
    },
    {
        "content": "<p>To be clear, I'm describing a workflow for Grahame -- not recommending this as a general practice.</p>",
        "id": 154008062,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1539271740
    },
    {
        "content": "<p>And with the ability to fetch from a local clone using the git primitives, it's possible to manage this pretty well (just like working with any other remote).</p>",
        "id": 154008063,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1539271781
    },
    {
        "content": "<blockquote>\n<p>Is this a concern for some reason</p>\n</blockquote>\n<p>it feels wrong. it's prone to introduce it's own mistakes. And it takes time and disk space. But it looks like the least worst option. </p>\n<blockquote>\n<p>if you're not following all of the implications, you're pretty likely to get mixed up</p>\n</blockquote>\n<p>The current workflow mixes me up. Once I commit something for a PR, i can either </p>\n<ul>\n<li>not do anything else until the PR is merged and I can switch back to master and get my code when I update from the master</li>\n<li>lose the code while I work on something else</li>\n</ul>\n<p>Maybe git works for people who just don't do more than one thing at a time, I don't know. but I can't manage the workflow at the moment.</p>",
        "id": 154008104,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539276402
    },
    {
        "content": "<p>I think I'm just going to commit only from a clone of the directory that I don't use. When I heard of this idea, I though it was astonishingly bad. But apparently this counts as state of the art in version control</p>",
        "id": 154008105,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539276402
    },
    {
        "content": "<p>using a clone directory is worse. you gradually build up a long list of changed files, and git doesn't know that they're actually committed. I ended up reverting everything. after going through with a toothpick to make sure I had committed everything from the clone directory.</p>",
        "id": 154008474,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539321948
    },
    {
        "content": "<p>my conclusion is that I'm not clever enough to be able to use git with branching to support my standard workflow. It seems to me that I have to expect a 30-40% hit on my upper throughput from now on</p>",
        "id": 154008475,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539322271
    },
    {
        "content": "<p>and also say good by to granular commits that match the scope of an individual task</p>",
        "id": 154008476,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539322294
    },
    {
        "content": "<p>maybe i do want to go back to svn. these are mighty big impacts to deal with</p>",
        "id": 154008477,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539322321
    },
    {
        "content": "<p>or maybe I'd like to stick with git but not use branching. And not have a checked build :-(</p>",
        "id": 154008478,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539324181
    },
    {
        "content": "<blockquote>\n<p>say good by to granular commits that match the scope of an individual task</p>\n</blockquote>",
        "id": 154008489,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539341990
    },
    {
        "content": "<p>no. I investigated that further. git gives me this on commit: 3bc7e30d09</p>",
        "id": 154008490,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539342013
    },
    {
        "content": "<p>and this works: <a href=\"https://github.com/HL7/fhir/commit/3bc7e30d09\" target=\"_blank\" title=\"https://github.com/HL7/fhir/commit/3bc7e30d09\">https://github.com/HL7/fhir/commit/3bc7e30d09</a></p>",
        "id": 154008491,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539342021
    },
    {
        "content": "<p>Does the \"one branch per user\" solution not work?</p>",
        "id": 154008527,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539353159
    },
    {
        "content": "<p>That should let you commit what you like, push it and merge it in discrete build.  It means you can't do a local commit until you're ready to push something to the server, but that's not different from how we'd behave under SVN.</p>",
        "id": 154008528,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539353210
    },
    {
        "content": "<p>well, I'll give it a go and see</p>",
        "id": 154008590,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539368757
    },
    {
        "content": "<p>well, ok. so i'm working in my branch, and I have a bunch of things going on... how do I sync with the master?</p>",
        "id": 154008681,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539403022
    },
    {
        "content": "<p>Do a merge.   You can select \"master\" as the remote branch to merge in.</p>",
        "id": 154008748,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539440040
    },
    {
        "content": "<p>If you've updated your local master branch (typically by doing <code>git pull</code> when you've checked out master, which will fast-forward update it if you've kept it \"clean\"), then when you've checked out and switched back to your working branch you can do <code>git merge master</code> (as Lloyd says).  You might occasionally have a conflict with that if someone else has made changes in the same file(s) you are working on, but usually it should merge cleanly.</p>",
        "id": 154008766,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1539440750
    },
    {
        "content": "<p>You can't update your local master branch if you don't want to switch out of your changes branch.</p>",
        "id": 154008767,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539440787
    },
    {
        "content": "<p>But you can merge remote/master directly into your changes branch</p>",
        "id": 154008768,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539440821
    },
    {
        "content": "<p>Yes, I agree.  If you haven't first pulled to your local master then you'll have to merge from the upstream master.  I think that may get trickier in the long run.  But if we're talking about a \"one branch\" workflow where you do all of your work in a single local branch and you never use multiple feature branches, then you would obviously do that.  What I'm suggesting is that if you do use multiple branches, then I think it will be best to always pull from the upstream master into only one of the local branches (and a clean master may be the easiest choice).  But, as we've already heard, there are many \"right\" (or at least not wrong) ways to do this.</p>",
        "id": 154008771,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1539441376
    },
    {
        "content": "<p>Grahame's work process doesn't seem to lend itself to multiple branches.  So we need to answer based on what the recommended path is for Grahame - which is one branch where he does all his work from - and he never bothers to switch to his local master.  In fact, he should never need to switch at all.</p>",
        "id": 154008783,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539455315
    },
    {
        "content": "<p>(after he's in his \"grahame\" branch)</p>",
        "id": 154008784,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539455339
    },
    {
        "content": "<p>ok so check <a href=\"https://github.com/HL7/fhir/pull/98\" target=\"_blank\" title=\"https://github.com/HL7/fhir/pull/98\">https://github.com/HL7/fhir/pull/98</a></p>",
        "id": 154008961,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539553109
    },
    {
        "content": "<p>you'll see that the pull request lists a list of commits... about 2/3 of those commits were in my previous PR, and are not committed. So my long running branch is going to get ever more diverted..</p>",
        "id": 154008962,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539553156
    },
    {
        "content": "<p>Have you merged remote master into your local branch?</p>",
        "id": 154008963,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1539554193
    },
    {
        "content": "<p>yes</p>",
        "id": 154008964,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539554238
    }
]