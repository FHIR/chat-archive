[
    {
        "content": "<p>I'm having the same issue in <a href=\"https://github.com/HL7/fhir/pull/335\" target=\"_blank\" title=\"https://github.com/HL7/fhir/pull/335\">https://github.com/HL7/fhir/pull/335</a> and <a href=\"https://github.com/HL7/fhir/pull/334\" target=\"_blank\" title=\"https://github.com/HL7/fhir/pull/334\">https://github.com/HL7/fhir/pull/334</a> - I can't move a money element around, it fails on casting:</p>\n<div class=\"codehilite\"><pre><span></span>org.hl7.fhir.exceptions.FHIRException: Unable to convert a org.hl7.fhir.r4.elementmodel.Element to an Money\n    at org.hl7.fhir.r4.model.Base.castToMoney(Base.java:508)\n    at org.hl7.fhir.r4.model.ExplanationOfBenefit$TotalComponent.setProperty(ExplanationOfBenefit.java:10501)\n    at org.hl7.fhir.r4.utils.StructureMapUtilities.processTarget(StructureMapUtilities.java:1809)\n</pre></div>\n\n\n<p>I've looked into it, <code>Base.java</code> <code>public Money castToMoney(Base b)</code> is failing and doesn't think <code>b</code> is an instanceOf <code>Money</code> even though <code>b.toString()</code> says <code>totalCost=Money[3 children]</code></p>",
        "id": 154022343,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1543732747
    },
    {
        "content": "<p>Given that Money was reworked I'm guessing this is the sideeffect</p>",
        "id": 154022344,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1543732763
    },
    {
        "content": "<p>hmm. I'll have a look at it</p>",
        "id": 154022557,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1543863152
    },
    {
        "content": "<p>OK let me know. I have a couple of maps that are stuck on this</p>",
        "id": 154022696,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1543908905
    },
    {
        "content": "<p>ok:</p>\n<div class=\"codehilite\"><pre><span></span>group ExplanationOfBenefitTotalCost(source src, target tgt) extends BackboneElement {\n  // src.category -&gt; tgt.category;\n  src as vs -&gt; tgt.amount as vt then Money(vs, vt);\n}\n</pre></div>",
        "id": 154022842,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1543948913
    },
    {
        "content": "<p>why is category commented out?</p>",
        "id": 154022843,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1543948921
    },
    {
        "content": "<p>I fixed the mapping. well, I changed it to what works. In general, I would not expect what you currently have to work except for primitives</p>",
        "id": 154022845,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1543948964
    },
    {
        "content": "<p>Like the PR said with the [WIP], it was still a work in progress <span class=\"emoji emoji-1f609\" title=\"wink\">:wink:</span></p>",
        "id": 154022846,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1543949018
    },
    {
        "content": "<p>ok</p>",
        "id": 154022847,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1543949027
    },
    {
        "content": "<p>thanks, I'll finish it up and the other one as well</p>",
        "id": 154022848,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1543949039
    },
    {
        "content": "<p>I forgot about the simple/vs complex, now it makes sense</p>",
        "id": 154022849,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1543949049
    }
]