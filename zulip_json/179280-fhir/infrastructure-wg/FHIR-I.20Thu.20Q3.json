[
    {
        "content": "<p><a href=\"https://docs.google.com/document/d/1MNt7N-PPbhUJBS9YA5sfqwVKSro7p77iA7L_wLuGlVc/edit?usp=sharing\" target=\"_blank\" title=\"https://docs.google.com/document/d/1MNt7N-PPbhUJBS9YA5sfqwVKSro7p77iA7L_wLuGlVc/edit?usp=sharing\">SMART Ballot Publication Request: draft</a></p>",
        "id": 154005920,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538675561
    },
    {
        "content": "<p>Updated SMART spec with MUST -&gt; SHALL, fixed a typo at: <a href=\"https://build.fhir.org/ig/HL7/smart-app-launch/scopes-and-launch-context/index.html\" target=\"_blank\" title=\"https://build.fhir.org/ig/HL7/smart-app-launch/scopes-and-launch-context/index.html\">https://build.fhir.org/ig/HL7/smart-app-launch/scopes-and-launch-context/index.html</a></p>\n<p>(<a href=\"https://github.com/HL7/smart-app-launch/commit/094635ddeec25272b050db45bedfde58fe06e430\" target=\"_blank\" title=\"https://github.com/HL7/smart-app-launch/commit/094635ddeec25272b050db45bedfde58fe06e430\">this commit</a> is what changed).</p>\n<p>Also see this PR for one way to call attention to OIDC \"Mandatory to Implement\" without adding our own \"SHALL\" language: <a href=\"https://github.com/HL7/smart-app-launch/pull/284/files?short_path=ce47c6e#diff-ce47c6efdc1a32047e3daf6df7b30c2a\" target=\"_blank\" title=\"https://github.com/HL7/smart-app-launch/pull/284/files?short_path=ce47c6e#diff-ce47c6efdc1a32047e3daf6df7b30c2a\">https://github.com/HL7/smart-app-launch/pull/284/files?short_path=ce47c6e#diff-ce47c6efdc1a32047e3daf6df7b30c2a</a></p>",
        "id": 154005945,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538677634
    },
    {
        "content": "<p>I think I remember now the discussion we had about this before.</p>",
        "id": 154005947,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538677728
    },
    {
        "content": "<p>discussion reflected in our SMART spec, or something we missed in incorporating changes?</p>",
        "id": 154005948,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538677752
    },
    {
        "content": "<p>Are those things already mandatory in the OIDC spec? And SMART is just calling attention to what's already required by OIDC?</p>",
        "id": 154005949,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538677760
    },
    {
        "content": "<p>Correct.</p>",
        "id": 154005950,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538677772
    },
    {
        "content": "<p>technically \"Mandatory to implement\" is what OIDC says.</p>",
        "id": 154005951,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538677787
    },
    {
        "content": "<p>So our options (including unpalatable or very challenging ones) are:<br>\n1. Don't use OIDC at all. <br>\n2. Use OIDC as is.  If someone doesn't implement those mandatory features, they are not compliant with OIDC.  And a SMART implementer who says they do OIDC and who doesn't do those things is technically not compliant with SMART either, since they're saying they do OIDC when they don't really.<br>\n3. SMART says \"OIDC says this is mandatory, but we say you MAY do it.\"  The SMART spec technically conflicts with the OIDC spec, since it says you can do OIDC without doing things OIDC requires. <br>\n4. We change the OIDC spec.</p>",
        "id": 154005956,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538677964
    },
    {
        "content": "<p>5) or, in SMART, clarify some of the arguably ambiguous language from OIDC</p>",
        "id": 154005959,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1538678023
    },
    {
        "content": "<p>Are you saying that your interpretation of OIDC is different from Josh's?</p>",
        "id": 154005964,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538678088
    },
    {
        "content": "<p>For example:</p>\n<blockquote>\n<p>OPs MUST support the prompt parameter, as defined in Section 3.1.2, including the specified user interface behaviors such as none and login.<br>\n<a href=\"https://openid.net/specs/openid-connect-core-1_0.html#ServerMTI\" target=\"_blank\" title=\"https://openid.net/specs/openid-connect-core-1_0.html#ServerMTI\">OIDC 15.1</a></p>\n</blockquote>",
        "id": 154005967,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1538678107
    },
    {
        "content": "<p>For (3), I wouldn't call this a conflict -- we say you can do OIDC, and we point out what OIDC says (see my proposed <a href=\"https://github.com/HL7/smart-app-launch/pull/284/files\" target=\"_blank\" title=\"https://github.com/HL7/smart-app-launch/pull/284/files\">very tiny tweak</a></p>",
        "id": 154005968,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538678152
    },
    {
        "content": "<p>Hmmm.</p>",
        "id": 154005977,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538678259
    },
    {
        "content": "<p>OIDC defines <a href=\"https://openid.net/specs/openid-connect-core-1_0.html#AuthorizationEndpoint\" target=\"_blank\" title=\"https://openid.net/specs/openid-connect-core-1_0.html#AuthorizationEndpoint\">4 possible values for prompt</a>. Which of these is required? Just none and login?</p>",
        "id": 154005979,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1538678269
    },
    {
        "content": "<p>A big part of SMART's value is that it profiles OAuth, just the important parts, please. That's missing here.</p>",
        "id": 154005980,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1538678328
    },
    {
        "content": "<p>(And re: \"prompt,\" the OIDC spec describes 4 values, and the minimum behavior on my reading would allow a server to return an error for each.)</p>",
        "id": 154005987,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538678404
    },
    {
        "content": "<p>To be clear, OIDC and OAuth are different beasts: OIDC  defines is a complete login protocol, whereas OAuth is a protocol.</p>",
        "id": 154005990,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538678430
    },
    {
        "content": "<p>In profiling, we only ever add constraints, extensions, etc -- we never take away requirements from a base spec.</p>",
        "id": 154005993,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538678451
    },
    {
        "content": "<p>I'm not disputing that over time, we'll learn more and can write nice guidance to help developers understand and implement OIDC better; the question is what should we do right now?</p>",
        "id": 154005998,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538678485
    },
    {
        "content": "<blockquote>\n<p>the minimum behavior on my reading would allow a server to return an error for each.)</p>\n</blockquote>\n<p>Josh, would it be reasonable to add a tiny tweak to better set app developer expectations that this is reasonable behavior? I don't see how that's a necessary conclustion from reading the referenced OIDC sections.</p>",
        "id": 154006001,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1538678519
    },
    {
        "content": "<p>For 3, I was thinking of something in the vein of</p>\n<ul>\n<li>you can do these parts of OIDC</li>\n<li>and <strong>say</strong> you do sso-openid-connect</li>\n<li>and <strong>not</strong> do these things OIDC says you have to</li>\n<li>and you'll be compliant with SMART even though you aren't compliant with OIDC.</li>\n</ul>",
        "id": 154006002,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538678520
    },
    {
        "content": "<p>I'm not saying that's what we should do.  I'm saying it's on the list of options (along with terrible ones like \"don't do OIDC at all\").</p>",
        "id": 154006004,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538678552
    },
    {
        "content": "<p>Sure, it's on a list of options -- but OIDC is a strong security protocol for sign-in that has seen wide review + implementation, and I'm not comfortable just hacking bits off.</p>",
        "id": 154006012,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538678745
    },
    {
        "content": "<p>I hear you.</p>",
        "id": 154006013,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538678754
    },
    {
        "content": "<p>Yeah, me too, really! <br>\nInstead of hacking things off, can we guide both EHR and app developers to better understand which features are required and which can be expected?</p>",
        "id": 154006015,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1538678869
    },
    {
        "content": "<p>Tell me more about what this would look like? In other words, do you mean we should include \"tutorial\" type material in our spec to bring developers up to speed with OIDC?</p>",
        "id": 154006017,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538679108
    },
    {
        "content": "<p>In addition to <a href=\"https://github.com/HL7/smart-app-launch/pull/284/files\" target=\"_blank\" title=\"https://github.com/HL7/smart-app-launch/pull/284/files\">https://github.com/HL7/smart-app-launch/pull/284/files</a> we could say something like <br>\n<code>The EHR SHALL return an OIDC error for any mandatory OIDC features it does not support</code></p>",
        "id": 154006033,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538679529
    },
    {
        "content": "<p>That's a little clunky</p>",
        "id": 154006034,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538679547
    },
    {
        "content": "<p>But something along those lines.</p>",
        "id": 154006036,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538679552
    },
    {
        "content": "<p>I'm sure that's okay for <code>prompt</code>. For <code>display</code>, better to just ignore it, which seems like a valid way to \"implement\" it, per the OIDC spec (which says, \"Note that the minimum level of support required for this parameter is simply that its use must not result in an error.\"). For Signing ID Tokens with RSA SHA-256 ... this is pretty fundamental!</p>\n<p>Preferred locales: also \"minimum level of support required for these parameters is simply to have their use not result in errors\"</p>",
        "id": 154006046,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1538679923
    },
    {
        "content": "<p>Isaac, which are the ones that really matter to us?</p>",
        "id": 154006052,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1538680088
    }
]