[
    {
        "content": "<p>I have an urgent request from IHE to FHIR-I. We would like to understand why Messaging can't utalize the Bundle.entry.request and Bundle.entry.response? See #FHIR-26359</p>",
        "id": 188592693,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582151314
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span>    Why is it urgent?  <a href=\"http://jira.hl7.org/browse/FHIR-26359\" target=\"_blank\" title=\"http://jira.hl7.org/browse/FHIR-26359\">J#26359</a></p>",
        "id": 188593319,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582151729
    },
    {
        "content": "<p>because we have an Implementation Guide that assumed we could use it, and that is going to EU Connectathon soon.  So we need to 'hack' using alternative A vs B.. where A is create an extension that is just like .request and .response because we know that R5 will allow it, or B encapsulate a Batch transaction within our message.</p>",
        "id": 188593474,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582151854
    },
    {
        "content": "<p>Wait, how does your hacked extension actually embed resource content like <code>Bundle.entry.response.outcome</code>?</p>",
        "id": 188593568,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1582151909
    },
    {
        "content": "<p>extensions are an amazing thing</p>",
        "id": 188593580,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582151926
    },
    {
        "content": "<p>why would messaging use .request and .response</p>",
        "id": 188593634,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582151971
    },
    {
        "content": "<p>Not _that_ amazing ;-) What extension type are you using? Or are you just stringifying the <code>Bundle.entry.response.outcome</code>?</p>",
        "id": 188593635,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1582151972
    },
    {
        "content": "<p>more specifically.. all we care about is .request.method with POST, PUT, DELETE</p>",
        "id": 188593642,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582151978
    },
    {
        "content": "<p>ahh</p>",
        "id": 188593645,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1582151982
    },
    {
        "content": "<p>we have a FHIR based equivilant to ADT...</p>",
        "id": 188593741,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152028
    },
    {
        "content": "<p>Why did you choose a message and not just a transaction bundle ?  ( which version of subscription are you using?)</p>",
        "id": 188593760,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582152040
    },
    {
        "content": "<p>because one can Subscribe to a message... you can't subscribe to a batch</p>",
        "id": 188593782,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152061
    },
    {
        "content": "<p>and messaging has nice functions for routing and source attribution</p>",
        "id": 188593802,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152076
    },
    {
        "content": "<p>messaging has its role in the world.</p>",
        "id": 188593816,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152095
    },
    {
        "content": "<p>which version Sub?</p>",
        "id": 188593835,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582152112
    },
    {
        "content": "<p>Do you have a link to the IG?</p>",
        "id": 188593883,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1582152123
    },
    {
        "content": "<p>I provided it in the Jira ticket</p>",
        "id": 188593889,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152131
    },
    {
        "content": "<p>NOTE: It is an IHE Profile, so it is not published using the HL7 IG publisher</p>",
        "id": 188593912,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152150
    },
    {
        "content": "<p>Thanks! (<a href=\"https://wiki.ihe.net/index.php/Patient_Master_Identity_Registry_(PMIR)\" target=\"_blank\" title=\"https://wiki.ihe.net/index.php/Patient_Master_Identity_Registry_(PMIR)\">https://wiki.ihe.net/index.php/Patient_Master_Identity_Registry_(PMIR)</a>)</p>",
        "id": 188593922,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1582152164
    },
    {
        "content": "<p>What si the reason to forbid this in a message?</p>",
        "id": 188593948,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152186
    },
    {
        "content": "<p>R4 subscriptions, <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> .</p>",
        "id": 188594068,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1582152260
    },
    {
        "content": "<p>yes, we know that if we had been using IG Publisher, that we would have found this problem long ago by examples not validating... Yes.. we know.</p>",
        "id": 188594088,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582152283
    },
    {
        "content": "<p>Where is a reference to the Batch behaviour trying to replicate  ? ( assuming V2 chapter)</p>",
        "id": 188594395,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582152525
    },
    {
        "content": "<p>What I don't understand is this </p>\n<blockquote>\n<p>Messaging while needing to Create, Update, or Delete; like can be done in a Batch.</p>\n</blockquote>\n<p>Its been a while for me, but in V2 isn't that all done with the event code?   and wouldn't  that be true for FHR using  MessageHeader. event for each <br>\n Message Bundle in the Bundle of Bundle?</p>",
        "id": 188595771,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582153714
    },
    {
        "content": "<p>Yes I hate the option of using the Batch Bundle enclosed within the Messaging Bundle.... but creative minds will do creative things</p>",
        "id": 188596452,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582154460
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191401\">Eric Haas</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188595771\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188595771\">said</a>:</p>\n<blockquote>\n<p>What I don't understand is this </p>\n<blockquote>\n<p>Messaging while needing to Create, Update, or Delete; like can be done in a Batch.</p>\n</blockquote>\n<p>Its been a while for me, but in V2 isn't that all done with the event code?   and wouldn't  that be true for FHR using  MessageHeader. event for each <br>\n Message Bundle in the Bundle of Bundle?</p>\n</blockquote>\n<p>a message only has one MessageHeader.event... we want to have one Message that contains creates, updates, and deletes... like a batch can</p>",
        "id": 188596550,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582154567
    },
    {
        "content": "<p>My leaning would be for your message payload to be a transaction Bundle.  Transaction semantics are not part of message and I'm not comfortable with the notion of trying to have messages use those structures directly.</p>",
        "id": 188596924,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582155041
    },
    {
        "content": "<p>I.e. MessageHeader.focus would itself be a Bundle - which would be your transaction.</p>",
        "id": 188596951,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582155088
    },
    {
        "content": "<p>That said, I'd be leery about introducing messaging unless you really have to.  If you can come up with a RESTful solution, that's nearly always better and more interoperable.</p>",
        "id": 188597010,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582155135
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188596951\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188596951\">said</a>:</p>\n<blockquote>\n<p>I.e. MessageHeader.focus would itself be a Bundle - which would be your transaction.</p>\n</blockquote>\n<p>Yes that is alternative B... (using Batch, not Transaction)</p>",
        "id": 188597014,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582155151
    },
    {
        "content": "<p>Lots of systems will support 'transaction'.  No-one supports your new custom message</p>",
        "id": 188597015,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582155152
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188597015\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188597015\">said</a>:</p>\n<blockquote>\n<p>Lots of systems will support 'transaction'.  No-one supports your new custom message</p>\n</blockquote>\n<p>The solution has plenty of ways for REST to be used... this is JUST a function for those that want to be notified</p>",
        "id": 188597036,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582155180
    },
    {
        "content": "<blockquote>\n<p>a message only has one MessageHeader.event... we want to have one Message that contains creates, updates, and deletes... like a batch can</p>\n</blockquote>\n<p>What about the MH.header focus 1..* MessageBundles?</p>",
        "id": 188597067,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582155225
    },
    {
        "content": "<p>is that how you are trying to emulate Batching</p>",
        "id": 188597153,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582155284
    },
    {
        "content": "<p>Anyway I mentioned Transaction too and generally agree with Lloyd  :-)</p>",
        "id": 188597193,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582155330
    },
    {
        "content": "<p>Being notified is quite different from processing a transaction</p>",
        "id": 188597312,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582155452
    },
    {
        "content": "<p>If you receive a transaction, you're being told to make those changes <em>on your system</em>.  If you're being notified, if anything, you'd want to transmit a copy of the transaction response - i.e. \"here's what happened\".</p>",
        "id": 188597381,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582155493
    },
    {
        "content": "<p>In this case, yes you have agreed to follow the changes</p>",
        "id": 188598365,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582156448
    },
    {
        "content": "<p>and it is a batch, so that you have the ability to ignore 0..* of the content without error</p>",
        "id": 188598377,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582156472
    },
    {
        "content": "<p>I am still unclear on why this is forbidden in a message</p>",
        "id": 188598392,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582156501
    },
    {
        "content": "<p>because 3 reasons:</p>\n<ul>\n<li>there's potentially very bad interplay between the message semantics, and the interaction semantics in request/response</li>\n<li>v2 messaging never had or needed anything like that</li>\n<li>no one has asked for it</li>\n</ul>",
        "id": 188599185,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582157233
    },
    {
        "content": "<p>well, because no one has asked for it... is reason to FORBID? that seems extreme. We are now asking for it. Not just me but a group of people trying to create an Implementation Guide on patient identity management</p>",
        "id": 188603516,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582162905
    },
    {
        "content": "<p>if that was the only reason, no.</p>",
        "id": 188603595,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163018
    },
    {
        "content": "<p>Unclear how the interpay problem is made better by a solution that puts the CUD actions in a enclosed Batch Bundle within the Message Bundle... How is that better? Can you explain the interplay problem? I don't see it</p>",
        "id": 188603597,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163029
    },
    {
        "content": "<p>I think v2 can do what we are trying to do...</p>",
        "id": 188603642,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163062
    },
    {
        "content": "<p>so.. am I completely non-persuasive? If so, then we will work up a solution with bundled bundles...</p>",
        "id": 188603652,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163095
    },
    {
        "content": "<p>lets say I took the typical content of a ADT_A01 message, and then inserted CUD instructions onto each of the segments... what would that mean? That would work at total cross purposes to the established purpose of the message</p>",
        "id": 188603658,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163107
    },
    {
        "content": "<p>I didn't say it was made better by a  nested bundle, though it may help.</p>",
        "id": 188603661,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163128
    },
    {
        "content": "<p>how does v2 do it then?</p>",
        "id": 188603670,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163141
    },
    {
        "content": "<p>I've never see create/update/delete instructions in a v2 message. Not even master files</p>",
        "id": 188603714,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163176
    },
    {
        "content": "<p>well delete is not worth discussing... and ADT is always Update with a create if not found... right?</p>",
        "id": 188603721,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163218
    },
    {
        "content": "<p>I am looking for solutions. not looking for a fight</p>",
        "id": 188603727,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163244
    },
    {
        "content": "<p>delete is worth discussing ;-) My point is, the create/update/delete semantics are explicit in the definition of the event. Adding them explicitly would make a mess of the definition of the event.</p>",
        "id": 188603858,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163444
    },
    {
        "content": "<p>so if it can be done in v2, with out being explicit in the message, why is it necessary in FHIR?</p>",
        "id": 188603864,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163463
    },
    {
        "content": "<p>a possible response is: it probably is, but we're a long way down the path, and don't want to reset now.</p>",
        "id": 188603870,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163482
    },
    {
        "content": "<p>or: no, there's some reason why it can't be done without it.... and presumably can't be done with v2?</p>",
        "id": 188603878,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163519
    },
    {
        "content": "<p>I would be opposed to re-setting.  The process for message handling has <em>always</em> been that you look at the event code.  Throwing REST behaviors into the mix adds considerable complexity.  There should also be a clear dividing line between REST vs. messaging behavior.  Mixing the two is going to breed confusion.  If you want to use message routing and have the purpose of the message be \"Execute this REST batch\", then a contained Bundle is a simple, clean way of structuring that.  You've got the message and you've got the batch.  You toss the contained batch to any RESTful engine and it knows what to do.</p>",
        "id": 188604010,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582163736
    },
    {
        "content": "<p>As a side point, Batch is normative, so changing these invariants would be tricky at best.</p>",
        "id": 188604022,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582163761
    },
    {
        "content": "<p>relaxing invariants is technically ok</p>",
        "id": 188604063,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163788
    },
    {
        "content": "<p>but the event code is sigular for the whole content of the message. I want to be able to mix some updates with some creates and some deletes</p>",
        "id": 188604082,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163831
    },
    {
        "content": "<p>I never asked for all of REST. Just create, update, and delete</p>",
        "id": 188604104,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163874
    },
    {
        "content": "<p>what i don't understand is how you know which resources are creates, updates, and deletes</p>",
        "id": 188604106,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163877
    },
    {
        "content": "<p>Look at all the fun I miss when skipping the ITI committee meetings :-)<br>\nHere is how I understand the basic structure of the profile, and a possible solution:</p>\n<ol>\n<li>There is a subscription for patient-level events (add/update/merge/delete)</li>\n<li>The notification for the event is a message<br>\nWhy can't the message event code relay the action to be taken on the patient?</li>\n</ol>",
        "id": 188604157,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582163897
    },
    {
        "content": "<p>The equivalent of 'action codes' in v2 would be Task in FHIR.  Having the message point at Tasks indicating what actions are to occur is a possibility if you don't want a contained Batch.</p>",
        "id": 188604159,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582163898
    },
    {
        "content": "<p>the sender knows what has happened within their system, they are an authority</p>",
        "id": 188604160,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582163898
    },
    {
        "content": "<p>ok so here's the clear difference: you know what happened in the source system. You cannot know what is the right thing to do in the destination system. The .request is an instruction to the destination system</p>",
        "id": 188604189,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163987
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192685\">Vassil Peytchev</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604157\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604157\">said</a>:</p>\n<blockquote>\n<p>Look at all the fun I miss when skipping the ITI committee meetings :-)<br>\nHere is how I understand the basic structure of the profile, and a possible solution:</p>\n<ol>\n<li>There is a subscription for patient-level events (add/update/merge/delete)</li>\n<li>The notification for the event is a message<br>\nWhy can't the message event code relay the action to be taken on the patient?</li>\n</ol>\n</blockquote>\n<p>because the event is singular for the whole message and we want to include Creates, Updates, Merges, and Deletes within one message</p>",
        "id": 188604234,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164006
    },
    {
        "content": "<p>Why do you want to mix them?</p>",
        "id": 188604244,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582164031
    },
    {
        "content": "<p>technically, this is a message that includes a history bundle</p>",
        "id": 188604246,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164033
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604189\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604189\">said</a>:</p>\n<blockquote>\n<p>ok so here's the clear difference: you know what happened in the source system. You cannot know what is the right thing to do in the destination system. The .request is an instruction to the destination system</p>\n</blockquote>\n<p>yes, the recipient of the message is free to act as approrpiate to them.</p>",
        "id": 188604255,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164056
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604246\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604246\">said</a>:</p>\n<blockquote>\n<p>technically, this is a message that includes a history bundle</p>\n</blockquote>\n<p>Exactly</p>",
        "id": 188604256,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582164062
    },
    {
        "content": "<p>yes. does that get us to a solution?</p>",
        "id": 188604269,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164082
    },
    {
        "content": "<p>well, we think it does</p>",
        "id": 188604273,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164093
    },
    {
        "content": "<p>It's still a bundle within the message</p>",
        "id": 188604283,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582164111
    },
    {
        "content": "<p>so that is the bundle within the message bundle... right?</p>",
        "id": 188604326,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164127
    },
    {
        "content": "<p>yes. a history bundle inside the message bundle - so the message bundle wraps the existing defined history bundle with messaging semantics</p>",
        "id": 188604337,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164157
    },
    {
        "content": "<p>we can go that direction. It was a possibility. We just wanted to check one more time to see if these prohibitions were intentional or accidental</p>",
        "id": 188604405,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164255
    },
    {
        "content": "<p>intentional. And my conclusion is: they're a good thing.</p>",
        "id": 188604489,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164372
    },
    {
        "content": "<p>The history bundle seems to indicate that we must include 'all' which is not what we are wanting, we only want to include those that have changed in a period since the last notificaiton.</p>",
        "id": 188604491,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164373
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/http.html#history\" target=\"_blank\" title=\"http://build.fhir.org/http.html#history\">http://build.fhir.org/http.html#history</a></p>",
        "id": 188604492,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164375
    },
    {
        "content": "<p>I still don't see how that fixes the issue of mixing and matching CUD within the message?</p>",
        "id": 188604496,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164391
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191401\">Eric Haas</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604496\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604496\">said</a>:</p>\n<blockquote>\n<p>I still don't see how that fixes the issue of mixing and matching CUD within the message?</p>\n</blockquote>\n<p>:-) it seems like a hack to me... get around a prohibition by encapuslation of that problem</p>",
        "id": 188604519,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164445
    },
    {
        "content": "<p>I actually do see it now. but I think transaction is what you need</p>",
        "id": 188604568,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164492
    },
    {
        "content": "<p>I don't think it is a hack. the semantics are clear: here's a message informing you of my transaction history</p>",
        "id": 188604575,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164503
    },
    {
        "content": "<blockquote>\n<p>history bundle seems to indicate that we must include 'all' which is not what we are wanting</p>\n</blockquote>\n<p>I'm not finding language that suggests that</p>",
        "id": 188604581,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164526
    },
    {
        "content": "<p>instead of history...</p>",
        "id": 188604583,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164534
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191401\">Eric Haas</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604568\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604568\">said</a>:</p>\n<blockquote>\n<p>I actually do see it now. but I think transaction is what you need</p>\n</blockquote>\n<p>That would require a change to Subscription to allow us to subscribe to a transaction.</p>",
        "id": 188604585,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164540
    },
    {
        "content": "<p>transaction within the message</p>",
        "id": 188604605,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582164573
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604581\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604581\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>history bundle seems to indicate that we must include 'all' which is not what we are wanting</p>\n</blockquote>\n<p>I'm not finding language that suggests that</p>\n</blockquote>\n<p>The very first line of the history description \"The history interaction retrieves the history of either a particular resource, all resources of a given type, or all resources supported by the system.\"</p>",
        "id": 188604610,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164585
    },
    {
        "content": "<p>nah you wouldn't have to do that. can still put a transaction in a message. but given what you've said - the recipient decides how to handle the record of waht happened on the server - it's not a transction</p>",
        "id": 188604615,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164601
    },
    {
        "content": "<p>then why make a request?</p>",
        "id": 188604666,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164632
    },
    {
        "content": "<p>that language isn't meant to mean that it's  comprehensive. Particularly given that one of the parameters is :</p>\n<blockquote>\n<p><code>_since : instant</code> Only include resource versions that were created at or after the given instant in time</p>\n</blockquote>",
        "id": 188604673,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164654
    },
    {
        "content": "<p>with History</p>",
        "id": 188604676,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164657
    },
    {
        "content": "<p>okay we can use history with the _since parameter</p>",
        "id": 188604753,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164686
    },
    {
        "content": "<p>Eric I don't know what you are stating or asking and to whom</p>",
        "id": 188604760,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164705
    },
    {
        "content": "<p>umm. the _since parameter is on the request. I thought you were pushing the history, not making a request ?</p>",
        "id": 188604761,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164713
    },
    {
        "content": "<p>yes we are pushing the history</p>",
        "id": 188604798,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164724
    },
    {
        "content": "<p>Loosen up Bundle.entry.request to allow for messaging  is how this thread started.</p>",
        "id": 188604808,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164754
    },
    {
        "content": "<p>so, presumably the push message includes the lastUpdated somewhere?</p>",
        "id": 188604819,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164791
    },
    {
        "content": "<p>So I assume you want to use Bundle.entry.request to instruct how to process the history bundles</p>",
        "id": 188604820,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164796
    },
    {
        "content": "<p>the message covers times from x to y, right?</p>",
        "id": 188604821,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164799
    },
    {
        "content": "<p>you have both times in the message?</p>",
        "id": 188604822,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164814
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191401\">Eric Haas</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604820\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604820\">said</a>:</p>\n<blockquote>\n<p>So I assume you want to use Bundle.entry.request to instruct how to process the history bundles</p>\n</blockquote>\n<p>No, we are past that</p>",
        "id": 188604829,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582164826
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191401\">Eric Haas</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604820\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604820\">said</a>:</p>\n<blockquote>\n<p>So I assume you want to use Bundle.entry.request to instruct how to process the history bundles</p>\n</blockquote>\n<p>when the bundle is a message...</p>",
        "id": 188604833,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164835
    },
    {
        "content": "<p>OK I missed that bit thanks <span class=\"user-mention\" data-user-id=\"192685\">@Vassil Peytchev</span></p>",
        "id": 188604875,
        "sender_full_name": "Eric Haas",
        "timestamp": 1582164848
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192685\">Vassil Peytchev</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604829\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604829\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191401\">Eric Haas</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604820\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604820\">said</a>:</p>\n<blockquote>\n<p>So I assume you want to use Bundle.entry.request to instruct how to process the history bundles</p>\n</blockquote>\n<p>No, we are past that</p>\n</blockquote>\n<p>im willing to have advocates for my desire</p>",
        "id": 188604876,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582164858
    },
    {
        "content": "<p>The self link on the history should indicate what the '_since' value was, I believe?</p>",
        "id": 188604878,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582164866
    },
    {
        "content": "<blockquote>\n<p>im willing to have advocates for my desire</p>\n</blockquote>\n<p>I believe the original intended use of message to be an abomination, so lets not go back there :-) I apologize for not  paying<br>\n attention.</p>",
        "id": 188604952,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582164978
    },
    {
        "content": "<p>so, I think I hear consensus that we continue to use a Message, but it has one entry which is a History Bundle carrying what we are trying to carry today. Right?</p>",
        "id": 188604980,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165055
    },
    {
        "content": "<p>we get around the history instance on all of a type because the messageHeader sets the context of what all because all is not all of that type (Patient) within the sender</p>",
        "id": 188605029,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165099
    },
    {
        "content": "<p>Since the profile stated you can have multiple patients, it is a History Bundle per patient</p>",
        "id": 188605032,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582165109
    },
    {
        "content": "<p>reasonable approach... I think.. and similar to an alternative we worked up today</p>",
        "id": 188605037,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165124
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192685\">Vassil Peytchev</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605032\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605032\">said</a>:</p>\n<blockquote>\n<p>Since the profile stated you can have multiple patients, it is a History Bundle per patient</p>\n</blockquote>\n<p>will you be at the face-to-face thursday? We looked for you today.</p>",
        "id": 188605063,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165157
    },
    {
        "content": "<p>Already gone, but I can dial in</p>",
        "id": 188605077,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582165178
    },
    {
        "content": "<blockquote>\n<p>we continue to use a Message, but it has one entry which is a History Bundle carrying what we are trying to carry today</p>\n</blockquote>\n<p>yes</p>",
        "id": 188605084,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165198
    },
    {
        "content": "<p>okay. I don't know when or if we do it on friday. so Ill let you know</p>",
        "id": 188605109,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165205
    },
    {
        "content": "<blockquote>\n<p>we get around the history instance on all of a type because the messageHeader sets the context of what all because all is not all of that type (Patient) within the sender</p>\n</blockquote>\n<p>I have no idea what this sentence means</p>",
        "id": 188605129,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165213
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605129\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605129\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>we get around the history instance on all of a type because the messageHeader sets the context of what all because all is not all of that type (Patient) within the sender</p>\n</blockquote>\n<p>I have no idea what this sentence means</p>\n</blockquote>\n<p>3.1.0.12 history <br>\nThe history interaction retrieves the history of either a particular resource, all resources of a given type, or all resources supported by the system.</p>",
        "id": 188605138,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165244
    },
    {
        "content": "<p>the \"all\" part of that is problematic if read strictly</p>",
        "id": 188605148,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165275
    },
    {
        "content": "<p>But that is why you have a history per patient resource</p>",
        "id": 188605153,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582165295
    },
    {
        "content": "<p>you gave the solution of using the timeframe indicated in the message header</p>",
        "id": 188605156,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165301
    },
    {
        "content": "<p>so I think you're confused between the interaction that fetches the history. and the rules for a history bundle</p>",
        "id": 188605161,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165317
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192685\">Vassil Peytchev</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605153\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605153\">said</a>:</p>\n<blockquote>\n<p>But that is why you have a history per patient resource</p>\n</blockquote>\n<p>are you meaning we can only have ONE patient per message?</p>",
        "id": 188605200,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165332
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605161\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605161\">said</a>:</p>\n<blockquote>\n<p>so I think you're confused between the interaction that fetches the history. and the rules for a history bundle</p>\n</blockquote>\n<p>Im reading the FHIR spec</p>",
        "id": 188605204,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165351
    },
    {
        "content": "<p>No, you have multiple history bundles, each per patient</p>",
        "id": 188605209,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582165361
    },
    {
        "content": "<p>you can build an arbitrary history bundle that has any combination of history entries that you want. There's no way to ask a server for that combination using REST, but that doesn't mean you can't specify for it to be built some other way</p>",
        "id": 188605243,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165397
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192685\">Vassil Peytchev</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605209\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605209\">said</a>:</p>\n<blockquote>\n<p>No, you have multiple history bundles, each per patient</p>\n</blockquote>\n<p>really? that is even more ugly... wrapping each patient in their own bundle?</p>",
        "id": 188605262,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165426
    },
    {
        "content": "<p>you don't need to do that.</p>",
        "id": 188605268,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165435
    },
    {
        "content": "<blockquote>\n<p>sorted with oldest versions last, and including deleted resources</p>\n</blockquote>",
        "id": 188605270,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165437
    },
    {
        "content": "<p>those rules apply to the bundle, I think</p>",
        "id": 188605314,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165446
    },
    {
        "content": "<p>RIght now, MessgeHeader.focus is 1..* Patient. I was thinking you can just change the reference to bundle, but reading Grahame's reply, you don't have to.</p>",
        "id": 188605333,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582165474
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605243\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605243\">said</a>:</p>\n<blockquote>\n<p>you can build an arbitrary history bundle that has any combination of history entries that you want. There's no way to ask a server for that combination using REST, but that doesn't mean you can't specify for it to be built some other way</p>\n</blockquote>\n<p>Ill put a footnote to the reader that I am sure will complain about \"all\"</p>",
        "id": 188605342,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165491
    },
    {
        "content": "<p>MessageHeader.focus will have to Bundle, yes</p>",
        "id": 188605344,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165500
    },
    {
        "content": "<p>One History Bundle that may contain 1..* different Patients... right?</p>",
        "id": 188605356,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165530
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605344\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188605344\">said</a>:</p>\n<blockquote>\n<p>MessageHeader.focus will have to Bundle, yes</p>\n</blockquote>\n<p>Single Bundle, magically built to contain histories of multiple patients (which is OK).</p>",
        "id": 188605409,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582165578
    },
    {
        "content": "<blockquote>\n<p>One History Bundle that may contain 1..* different Patients... right?</p>\n</blockquote>\n<p>yes</p>",
        "id": 188605436,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582165661
    },
    {
        "content": "<p>Vassil are you suggesting that we should also allow replication at the message set of bundles? So many patients might be many history bundles with each only one patient, or could be one history bundle with many patients ... is this because you percieve one imlementation as easier?</p>",
        "id": 188605484,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165699
    },
    {
        "content": "<p>Im all for easier... but multiple levels of replication is harder on the recipient</p>",
        "id": 188605489,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165734
    },
    {
        "content": "<p>IHE we like to choose ONE</p>",
        "id": 188605495,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165750
    },
    {
        "content": "<p>Not at all, I am simply restating Grahame's suggestion, with the focus on that certain person who will complain about the \"all\".</p>",
        "id": 188605551,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1582165836
    },
    {
        "content": "<p>ah.. I have the zulip URL to include in the footnote</p>",
        "id": 188605564,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165865
    },
    {
        "content": "<p>:-)</p>",
        "id": 188605566,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165867
    },
    {
        "content": "<p>thanks... we will look again in the morning to see if you all change your mind</p>",
        "id": 188605622,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582165950
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191404\">John Moehrke</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604585\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604585\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191401\">Eric Haas</span> <a href=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604568\" title=\"#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Message.20forbids.20entry.2Erequest.20and.20entry.2Eresponse/near/188604568\">said</a>:</p>\n<blockquote>\n<p>I actually do see it now. but I think transaction is what you need</p>\n</blockquote>\n<p>That would require a change to Subscription to allow us to subscribe to a transaction.</p>\n</blockquote>\n<p>FYI, there are a lot of changes to Subscription in progress.  This should be possible in the new version.<br>\nAlso of note, there is a lot of discussion around what the notification bundle will be (specifically, the current plan is a new bundle type - I believe the FHIR-I call on Monday will have some discussion around that vs. messaging).</p>",
        "id": 188651785,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1582214894
    }
]