[
    {
        "content": "<p>I think there may be an issue with the invariants for capability statements which is causing the FHIR validator to give errors as mentioned below</p>\n<p><span class=\"user-mention silent\" data-user-id=\"433872\">Sahil Malhotra</span> <a href=\"#narrow/stream/179239-tooling/topic/FHIR.20Validator.20bug.20for.20capability.20statements/near/262369820\">said</a>:</p>\n<blockquote>\n<p>I'm having some issues with the validator relating to capability statements. The capability statement that is returned is of kind \"instance\" and has both the software and implementation fields set, however despite that I see the below errors complaining about the kind field. The validator is being used in a JAVA springboot server and is loaded from import ca.uhn.fhir.validation.FhirValidator. I didn't use to have this issue before, it just started popping up and is now causing my test cases to fail. Any thoughts or advice on how to fix this?</p>\n<div class=\"codehilite\"><pre><span></span><code>[SingleValidationMessage[col=-1,row=-1,locationString=CapabilityStatement,message=[error] in /*:CapabilityStatement[namespace-uri()=&#39;http://hl7.org/fhir&#39;][1] @ CapabilityStatement cpb-16: If kind = requirements, implementation and software must be absent Test=not(f:kind/@value=&#39;instance&#39;) or (not(exists(f:implementation)) and not(exists(f:software))),severity=error]\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>SingleValidationMessage[col=-1,row=-1,locationString=CapabilityStatement,message=[error] in /*:CapabilityStatement[namespace-uri()=&#39;http://hl7.org/fhir&#39;][1] @ CapabilityStatement cpb-15: If kind = capability, implementation must be absent, software must be present Test=not(f:kind/@value=&#39;instance&#39;) or (not(exists(f:implementation)) and exists(f:software)),severity=error]]\n</code></pre></div>\n<p>Edit: I think the tests being run for the validation and need to be changes as follows</p>\n<div class=\"codehilite\"><pre><span></span><code>Test=not(f:kind/@value=&#39;instance&#39;) or (not(exists(f:implementation)) and not(exists(f:software)))  ---&gt;  Test=(f:kind/@value=&#39;requirements&#39;) and (not(exists(f:implementation)) and not(exists(f:software)))\n</code></pre></div>\n<p><div class=\"codehilite\"><pre><span></span><code>Test=not(f:kind/@value=&#39;instance&#39;) or (not(exists(f:implementation)) and exists(f:software))  ---&gt;  Test=(f:kind/@value=&#39;capability&#39;) and (not(exists(f:implementation)) and exists(f:software))\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 262466380,
        "sender_full_name": "Sahil Malhotra",
        "timestamp": 1637679395
    }
]