[
    {
        "content": "<p>So at this time, it's not possible to put a contained code system inside a value set.</p>",
        "id": 153976922,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123480
    },
    {
        "content": "<p>I think that this is a problem - it should be possible to do that.</p>",
        "id": 153976923,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123495
    },
    {
        "content": "<p>the reason is because there's no trackable internal reference from the value set to the code system.</p>",
        "id": 153976924,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123512
    },
    {
        "content": "<p>the issue is this invariant:</p>",
        "id": 153976925,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123522
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>contained.where(((&#39;#&#39;+id in (\n  %resource.descendants().reference |\n  %resource.descendants().as(canonical))) or\n  descendants().where(reference = &#39;#&#39;).exists() or\n  descendants().where(as(canonical) = &#39;#&#39;\n).exists()).not()).trace(&#39;unmatched&#39;, id).empty())\n</pre></div>",
        "id": 153976926,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123545
    },
    {
        "content": "<p>so I think that this invariant should say:</p>",
        "id": 153976927,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123660
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>contained.where(((&#39;#&#39;+id in (\n  %resource.descendants().reference |\n  %resource.descendants().as(canonical) |\n  %resource.descendants().as(uri) |\n  %resource.descendants().as(url))\n ) or  descendants().where(reference = &#39;#&#39;).exists()\n).exists()).not()).trace(&#39;unmatched&#39;, id).empty())\n</pre></div>",
        "id": 153976928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123711
    },
    {
        "content": "<p>two changes: there's no reason to look for a canonical reference of # to the containing resource. I just can't see how that would be valid</p>",
        "id": 153976929,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123738
    },
    {
        "content": "<p>and the other case is to allow a contained resource referenced by uri or url - e.g. a code system or a binary in a document reference</p>",
        "id": 153976930,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532123758
    },
    {
        "content": "<p>Canonical reference of # to the containing reference - code system pointing to its definitional value set?</p>",
        "id": 153976946,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1532130772
    },
    {
        "content": "<p>the code system is not referred to by it's definitional value set that contains it?</p>",
        "id": 153976949,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532131713
    },
    {
        "content": "<p>It would be, but the Code System would refer to the ValueSet too.</p>",
        "id": 153976959,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1532132334
    },
    {
        "content": "<p>so the question is not, 'what is valid?', but 'what satisfies the contained resource requirement?'</p>",
        "id": 153976960,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532132781
    },
    {
        "content": "<p>A contained resource pointing to the container by canonical would meet the requirement.  Perhaps a Concept map contained within a ValueSet?</p>",
        "id": 153976963,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1532133892
    },
    {
        "content": "<p>(on the grounds that the two must be maintained together and managed in sync)</p>",
        "id": 153976964,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1532133933
    },
    {
        "content": "<p>this, it turns out, is <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17330\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17330\">GF#17330</a></p>",
        "id": 153976969,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532159536
    }
]