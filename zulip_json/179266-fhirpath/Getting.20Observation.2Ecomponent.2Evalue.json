[
    {
        "content": "<p>Kindly new here. So I want to write FHIRPath to get Observation.component.value for certain code. For example, only get Diastolic blood pressure. I am not sure if this is correct</p>\n<div class=\"codehilite\"><pre><span></span><code>Observation.component.where(code.coding.code = &#39;8462-4&#39;).value\n</code></pre></div>\n<p>I am not sure <code>code.coding.code='8462-4'</code> means any coding has code 8462-4 or the first coding has code 8462-4</p>\n<p>Thanks!</p>",
        "id": 264073545,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1638911957
    },
    {
        "content": "<p>It means any of the codings equal that value.  (To be safe, you should always check system too.)</p>",
        "id": 264074959,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1638912571
    },
    {
        "content": "<p>And needs to have a where on the code.coding.where() as nerds to be restricted at each collection point.<br>\nWill try getting the exact expression when I get to my desk.</p>",
        "id": 264075431,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1638912731
    },
    {
        "content": "<p>Hi everybody! i'm quite new to the topic of FHIR Path. I'm having a similar problem with Patient resource.<br>\nI used <code>identifier.where(type.coding.code='MR').value</code> to find the identifier, it works fine if there is only one <code>coding</code> inside <code>type</code>. However if there are more <code>coding</code>s exist in <code>type</code>, the FHIR Path returns null. <br>\nCan someone please help? Thanks!</p>",
        "id": 267045603,
        "sender_full_name": "Yuan Peng",
        "timestamp": 1641464903
    },
    {
        "content": "<p>maybe try something like this?  <code>identifier.where(type.coding.where(code='MR')).value</code></p>",
        "id": 267068684,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1641480579
    },
    {
        "content": "<p>I've tried that, but somehow it's still not working.</p>",
        "id": 267157159,
        "sender_full_name": "Yuan Peng",
        "timestamp": 1641538733
    },
    {
        "content": "<p>What engine are you using?</p>",
        "id": 267221877,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1641578976
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179266-fhirpath/topic/Getting.20Observation.2Ecomponent.2Evalue/near/267221877\">said</a>:</p>\n<blockquote>\n<p>What engine are you using?</p>\n</blockquote>\n<p>I'm using the FHIR Path in a Java application. In the application we use the newest versions of  <code>ca.uhn.fhir.fhirpath.IFhirPath</code> and <code>org.hl7.fhir.r4.hapi.fluentpath.FhirPathR4</code> packages. We defined a FHIR Path as String and then use the method <code>evaluate(org.hl7.fhir.instance.model.api.IBase theInput, String thePath, Class&lt;T&gt; theReturnType)</code>.</p>",
        "id": 267402800,
        "sender_full_name": "Yuan Peng",
        "timestamp": 1641799547
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span></p>",
        "id": 267456240,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1641829885
    },
    {
        "content": "<p>The path expression you gave above works for me. See:</p>\n<p><a href=\"http://hapi.fhir.org/baseR4/Observation/1574881?_fhirpath=Observation.component.where(code.coding.code%20=%20%278462-4%27).value\">http://hapi.fhir.org/baseR4/Observation/1574881?_fhirpath=Observation.component.where(code.coding.code%20=%20%278462-4%27).value</a></p>",
        "id": 267457380,
        "sender_full_name": "James Agnew",
        "timestamp": 1641830274
    },
    {
        "content": "<p>If this isn't working, can you post your data to the HAPI FHIR server and produce a link similar to mine to show the non-working FP expression? It's nice and easy to troubleshoot that way</p>",
        "id": 267457755,
        "sender_full_name": "James Agnew",
        "timestamp": 1641830406
    },
    {
        "content": "<p>Is _fhirpath a HAPI-only thing, or is it defined in an IG somewhere?  It looks really useful.</p>",
        "id": 267458563,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1641830643
    },
    {
        "content": "<p>It's just a HAPI FHIR thing. There is an interceptor you can add that layers on this functionality... Agree it's super useful :)</p>",
        "id": 267460913,
        "sender_full_name": "James Agnew",
        "timestamp": 1641831560
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> Just saw the operation for the first time, immediately want to implement it in Firely Server. Pretty cool.</p>",
        "id": 267468817,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1641834540
    },
    {
        "content": "<p>In the Telstra server it's called <a href=\"https://sqlonfhir-r4.azurewebsites.net/fhir/Patient/example/$extract?expression=name.first()\">https://sqlonfhir-r4.azurewebsites.net/fhir/Patient/example/$extract?expression=name.first()</a><br>\n(though I'm no longer happy with the operation name as it clashes now)</p>",
        "id": 267494920,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641846382
    },
    {
        "content": "<p>Funny that we both returned a parameters object!</p>",
        "id": 267495044,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641846458
    },
    {
        "content": "<p>Sorry if it's too off-topic for the current thread... would there be interest in defining it as a core operation?</p>",
        "id": 267496321,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1641847134
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191319\">James Agnew</span> <a href=\"#narrow/stream/179266-fhirpath/topic/Getting.20Observation.2Ecomponent.2Evalue/near/267457755\">said</a>:</p>\n<blockquote>\n<p>If this isn't working, can you post your data to the HAPI FHIR server and produce a link similar to mine to show the non-working FP expression? It's nice and easy to troubleshoot that way</p>\n</blockquote>\n<p>I've tried it with my 'problematic' Patient resource, and it did not working:<br>\n<a href=\"https://hapi.fhir.org/baseR4/Patient/2782733?_fhirpath=Patient.identifier.where(type.coding.where(code=%27MR%27)).value\">https://hapi.fhir.org/baseR4/Patient/2782733?_fhirpath=Patient.identifier.where(type.coding.where(code=%27MR%27)).value</a><br>\n<a href=\"https://hapi.fhir.org/baseR4/Patient/2782733?_fhirpath=Patient.identifier.where(type.coding.code=%27MR%27).value\">https://hapi.fhir.org/baseR4/Patient/2782733?_fhirpath=Patient.identifier.where(type.coding.code=%27MR%27).value</a></p>",
        "id": 267831643,
        "sender_full_name": "Yuan Peng",
        "timestamp": 1642058067
    },
    {
        "content": "<p>That query looks good to me, and works on the fhirpathtester, and if I was doing that, you probably should also include the system too.<br>\n<a href=\"/user_uploads/10155/FTS_icQyoAppViztF14BOvtf/image.png\">image.png</a> <br>\nMaybe an issue with the java fhirpath implementation?</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/FTS_icQyoAppViztF14BOvtf/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/FTS_icQyoAppViztF14BOvtf/image.png\"></a></div>",
        "id": 267959691,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1642126364
    },
    {
        "content": "<p>To make this work with the HAPI engine, try this one:<br>\n<a href=\"https://hapi.fhir.org/baseR4/Patient/2782733?_fhirpath=Patient.identifier.where(type.coding.where(code=%27MR%27).exists()).value\">https://hapi.fhir.org/baseR4/Patient/2782733?_fhirpath=Patient.identifier.where(type.coding.where(code=%27MR%27).exists()).value</a><br>\nthe inclusion of the .exists() on the check for the coding seems to make that work nicely.</p>",
        "id": 267959733,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1642126423
    },
    {
        "content": "<p>It works! Thanks a lot! <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span></p>",
        "id": 267984565,
        "sender_full_name": "Yuan Peng",
        "timestamp": 1642149235
    }
]