[
    {
        "content": "<p>I'm trying to use a FHIRPath expression in a Measure to produce something more than just a calculation in a MeasureReport. How much of this is possible within the FHIR spec itself? For example:</p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;item.item.where(linkId.contains(&#39;/attention&#39;)).answer.valueCoding.extension.value.aggregate($this + $total, 0).iif($this &gt;= 7, $this.toString() + &#39;;high;Impairment&#39;, $this.toString() + &#39;;low&#39;)&quot;\n</code></pre></div>\n<p>This is just what I'm working with for now. So I have my QuestionnaireResponse, I evaluate it using the above expression, I should get something like</p>\n<div class=\"codehilite\"><pre><span></span><code>[&#39;9;high;Impairment&#39;]\n</code></pre></div>\n<p>I then have pre-defined rules on what to do with that response, and it creates part of a MeasureReport that looks kind of like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>        {\n          &quot;stratum&quot;: [\n            {\n              &quot;value&quot;: { &quot;text&quot;: &quot;Attention&quot; },\n              &quot;component&quot;: [\n                {\n                  &quot;code&quot;: {\n                    &quot;coding&quot;: [{ &quot;code&quot;: &quot;Impairment&quot;, &quot;display&quot;: &quot;Impairment&quot; }]\n                  },\n                  &quot;value&quot;: {\n                    &quot;coding&quot;: [\n                      {\n                        &quot;system&quot;: &quot;mayjuun.com/fhir/ValueSet/low_medium_high_risk&quot;,\n                        &quot;code&quot;: &quot;high-risk&quot;,\n                        &quot;display&quot;: &quot;high risk&quot;\n                      }\n                    ]\n                  }\n                }\n              ],\n              &quot;measureScore&quot;: { &quot;value&quot;: &quot;9&quot; }\n            }\n          ]\n        }\n</code></pre></div>\n<p>But that whole pre-defined rules section isn't represented anywhere in FHIR. Is there a way to do something similar to what I'm trying to do?</p>",
        "id": 253613532,
        "sender_full_name": "Grey Faulkenberry",
        "timestamp": 1631811261
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"235060\">@Grey Faulkenberry</span> , I'm not sure I understand the question? What do you mean by \"pre-defined rules\"? It looks like you are trying to do stratification of the results by risk level, is that right?</p>",
        "id": 253743775,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1631886226
    },
    {
        "content": "<p>Yes, exactly. But I'm also trying to pass in specific text along with it. Currently the results is a semi-colon delimited string, of the format:</p>\n<div class=\"codehilite\"><pre><span></span><code>score;risk-level;Any other text you want to display with the result\n</code></pre></div>",
        "id": 253744035,
        "sender_full_name": "Grey Faulkenberry",
        "timestamp": 1631886329
    },
    {
        "content": "<p>For instance</p>\n<div class=\"codehilite\"><pre><span></span><code>22;low;22 still seems like a pretty high score to be considered low-risk\n</code></pre></div>",
        "id": 253744140,
        "sender_full_name": "Grey Faulkenberry",
        "timestamp": 1631886363
    },
    {
        "content": "<p>I was trying to figure out if there was a way in FHIR, to specify that that string should be divided up to produce the stratum in a MeasureReport as above</p>",
        "id": 253744339,
        "sender_full_name": "Grey Faulkenberry",
        "timestamp": 1631886442
    },
    {
        "content": "<p>(also, to make sure that the stratum as I've displayed it makes sense)</p>",
        "id": 253744502,
        "sender_full_name": "Grey Faulkenberry",
        "timestamp": 1631886512
    },
    {
        "content": "<p>You can use components to specify the stratifier, though I'm not 100% sure that's what you're after. I thought I was following until the bit about \"Any other text you want to display\". Would that text be expected to be different per score/risk-level combination?</p>",
        "id": 253750771,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1631888951
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> , yeah, I'm not explaining it very well.<br>\nEach stratum will have a score, so the measureScore is just a number, that's straight forward.<br>\nEach stratum will also have a low, medium, or high risk associated with it.<br>\nHowever, there will be other text associated that will differ depending on what score it is. So for one score that text may be \"Impairment\", another one may have text that says \"More discussion is needed\", and another says \"Needs immediate Attention\".</p>\n<p>For end-user display purposes, my plan is to create a MeasureReport display with a different line for each stratum. The line will have the title (stratum.value.text), the score (stratum.measureScore.value), and then some display text that differs (stratum.component.code.coding[0].display). And they would be different colors based on the low, medium or high risk.</p>\n<p>So to the end user they might see...</p>\n<div class=\"codehilite\"><pre><span></span><code>Attention: Score 3: No follow-up needed // green color\nHyperactivity: Score 25: Needs further assessment //red color\nOverall Health: Score 15: Generally healthy but needs some followup //yellow color\n</code></pre></div>",
        "id": 253777925,
        "sender_full_name": "Grey Faulkenberry",
        "timestamp": 1631899822
    }
]