[
    {
        "content": "<p>If you have a patient resource, FHIRPath allows you to write either \"Patient.name.given\" or simply \"name.given\".   In the first case, if I understand correctly, the FHIRPath interpreter checks to make sure the data object from which \"name\" is being pulled really is a Patient.  My question is, what is special about the string \"Patient\" that signals the interpreter to assert that data.resourceType == Patient, as opposed to thinking that \"Patient\" is the name of a property of whichever resource is in the \"data\" object?   Is it the fact that Patient starts with an uppercase letter?  Or does a FHIRPath interpreter have a list of all the FHIR resource names?</p>",
        "id": 153976931,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1532124260
    },
    {
        "content": "<p>only at the root, and that the first name corresponds to the type</p>",
        "id": 153976935,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532125196
    },
    {
        "content": "<p>Then... what if someone has a resource type named \"X\", with a property named \"Patient\".  If the root is of type \"X\", and the expression is \"Patient.name.given\", do you interpret that as \"X.Patient.name.given\", or do you return nothing because the type is X and the expression started with \"Patient\"?</p>",
        "id": 153976940,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1532126653
    },
    {
        "content": "<p>that's a good question</p>",
        "id": 153976979,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532171772
    },
    {
        "content": "<p>there's nothing in the spec to address this.</p>",
        "id": 153976980,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532171907
    },
    {
        "content": "<p>Well, we do talk about models here: <a href=\"http://hl7.org/fhirpath/2018May/#models\" target=\"_blank\" title=\"http://hl7.org/fhirpath/2018May/#models\">http://hl7.org/fhirpath/2018May/#models</a></p>",
        "id": 153977016,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532208855
    },
    {
        "content": "<p>We say the context provides the model.</p>",
        "id": 153977017,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532208863
    },
    {
        "content": "<p>And that type resolution is performed by searching through the model types first, then the system types.</p>",
        "id": 153977018,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532208878
    },
    {
        "content": "<p>So if you want to write FHIRPath expressions against something called X, then the context needs to define what X means.</p>",
        "id": 153977019,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532208902
    },
    {
        "content": "<p>but it ambiguous if there's a property also called \"X\" on the base object. is \"X\" the type name or the property name?</p>",
        "id": 153977020,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532208944
    },
    {
        "content": "<p>Yes, that needs clarification. It's only in the special case of the root of an expression that we allow the reference to the type name though, so that's a proposed clarification.</p>",
        "id": 153977021,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532209100
    },
    {
        "content": "<p>what would the clarification be?</p>",
        "id": 153977022,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532209147
    },
    {
        "content": "<p>That when resolving an identifier that is also the root of a FHIRPath expression, it is resolved as a type name first, and if it resolves to a type, it must resolve to the type of the context (or a supertype). Otherwise, it is resolved as a path on the context.</p>",
        "id": 153977024,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532209439
    },
    {
        "content": "<p>We something close to that already in the second paragraph here: <a href=\"http://hl7.org/fhirpath/2018May/#path-selection\" target=\"_blank\" title=\"http://hl7.org/fhirpath/2018May/#path-selection\">http://hl7.org/fhirpath/2018May/#path-selection</a></p>",
        "id": 153977025,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532209543
    },
    {
        "content": "<p>not close enough</p>",
        "id": 153977026,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532210017
    },
    {
        "content": "<p>Agreed: <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17533\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17533\">GF#17533</a></p>",
        "id": 153977032,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532211493
    },
    {
        "content": "<p>This is also related: <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17271\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17271\">GF#17271</a></p>",
        "id": 153977034,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532211604
    },
    {
        "content": "<p>This also wouldn't be a problem in FHIR as the casing would prevent it.<br>\nPatient != patient</p>",
        "id": 153977178,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1532327700
    },
    {
        "content": "<p>The fhirpath spec says that case sensitivity depends on the models, however the fhirpath page doesn't say anything about it.<br>\nSo I guess we haven't even covered that (I was expecting it to be case sensitive)</p>",
        "id": 153977181,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1532327807
    },
    {
        "content": "<p>yes not a problem in FHIR itself, but potentially a problem in other models that don't keep type and element names apart....</p>",
        "id": 153977182,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532327946
    },
    {
        "content": "<p>except that we have the type 'code'...</p>",
        "id": 153977183,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532327962
    },
    {
        "content": "<p>I gather from this discussion and from <a href=\"http://hl7.org/fhirpath/2018May/#models\" target=\"_blank\" title=\"http://hl7.org/fhirpath/2018May/#models\">http://hl7.org/fhirpath/2018May/#models</a> that the context provides the FHIRPath interpreter with a list of known resource names (and perhaps a good bit more about resource).  Is that correct?</p>",
        "id": 153977305,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1532357238
    },
    {
        "content": "<p>Yes, the environment provides that information to the engine so that it knows what types are available, as well as what they look like.</p>",
        "id": 153977309,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532357670
    },
    {
        "content": "<p>Is there somewhere an XML or JSON list of the known FHIR resources?  If that is supposed to be in the context, then I guess at least my test code will need to be passing that into the interpreter/engine.  I suppose I could try to pull the information from the FHIR website (entering it by hand?) but I am guessing it must live somewhere in a format that can be processed.</p>",
        "id": 153977379,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1532378091
    },
    {
        "content": "<p>profiles-resources.json and profiles-types.json from whatever release you're implementing</p>",
        "id": 153977383,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1532379153
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span> FHIRpath is full of implicit references to FHIR meta-data, so we need compact representation of it in interpreter. I will add it to project.</p>",
        "id": 153977506,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1532422311
    },
    {
        "content": "<p>CQL tooling uses this representation: <a href=\"https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/quick/src/main/resources/org/hl7/fhir/fhir-modelinfo-3.0.0.xml\" target=\"_blank\" title=\"https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/quick/src/main/resources/org/hl7/fhir/fhir-modelinfo-3.0.0.xml\">https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/quick/src/main/resources/org/hl7/fhir/fhir-modelinfo-3.0.0.xml</a></p>",
        "id": 153977670,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1532449338
    }
]