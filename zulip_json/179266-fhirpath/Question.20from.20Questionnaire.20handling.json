[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span> has a question (see <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19530\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19530\">GF#19530</a>) about the correct way to refer to variables defined in questionnaires in FHIRPath statements in expressions found in the Questionnaire.</p>",
        "id": 159657818,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551392269
    },
    {
        "content": "<p>the intent is that the expressions can use the defined variables as values .</p>",
        "id": 159657877,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551392291
    },
    {
        "content": "<p>Paul has implemented using %[var-name], where as I dropped the %, so that you just used the variable name, and it's known object in the FHIRPath engine.</p>",
        "id": 159657925,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551392332
    },
    {
        "content": "<p>On the basis that %[x] is used for global constants.</p>",
        "id": 159657941,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551392348
    },
    {
        "content": "<p>Paul points out that questionnaire variables are behaving like global constants anyway</p>",
        "id": 159657969,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551392370
    },
    {
        "content": "<p>there'd be a 3rd option - use something like questionnaireVariables().[var-name]</p>",
        "id": 159658064,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551392414
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span>  do you have style opinions on this?</p>",
        "id": 159658088,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551392433
    },
    {
        "content": "<p>I would prefer without the %, since with the percent it may collide with environment variable names.</p>",
        "id": 159663580,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1551397272
    },
    {
        "content": "<p>Without the % it may collide with resource names, but that's a more understandable situation I think (and easier to resolve).</p>",
        "id": 159663597,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1551397293
    },
    {
        "content": "<p>it may also collide with property names. which sounds more serious...</p>",
        "id": 159668451,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551402014
    },
    {
        "content": "<p>vars() or some variant is the least likely to collide with something</p>",
        "id": 159668461,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551402030
    },
    {
        "content": "<p><code>vars(\"varname\")</code> would work<br>\nI was ok with env variables.</p>",
        "id": 159676258,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1551412175
    },
    {
        "content": "<p>I think that with %, colliding with environment variables is okay.  If someone names a variable \"resource\", and then writes FHIRPath using %resource, it should probably refer to their variable.  If they didn't mean to do that, they can just change the variable name, because these are variables defined inside the same Questionnaire that has the FHIRPath.  (At least, that it the one use case of which I am aware.)</p>",
        "id": 159720644,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1551452497
    },
    {
        "content": "<p>I am also reluctant to introduce a second kind of variable.  The API for the FHIRPath engine then needs to take two hashes of variables, one for environment variables, and one for \"other\" variables.  (I am not sure how to explain \"other\" variables, in the fhirpath.js API.  What would I call them?  Non-environment variables?)  I'll grant that there could be a need for a second kind of variable, but in this Questionnaire space I am familiar with, I don't see it.</p>",
        "id": 159721674,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1551453183
    },
    {
        "content": "<p>which other <em>variables</em> get addressed through %[name]?</p>",
        "id": 159740121,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551467366
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Sorry for the long delay in replying-- I was out for a few days.  I am not sure I've understood your question.  We currently have \"environment variables\" accessed through %[name], and I am in favor of using the same syntax for variables created by extensions like questionnaire-calculatedExpression.  When I said \"second kind of variable above\" I was arguing against introducing a separate syntax for referencing (within FHIRPath) variables introduced by those extensions.</p>",
        "id": 160209847,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1551974265
    }
]