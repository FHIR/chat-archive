[
    {
        "content": "<p><a href=\"#narrow/stream/179166-implementers/topic/FHITPath.20.2Ematches.28.29.20with.20linebreaks/near/238528297\">(previously posted in <a class=\"stream\" data-stream-id=\"179166\" href=\"/#narrow/stream/179166-implementers\">#implementers</a> )</a>:<br>\nHi,<br>\nI'm trying to use the <code>.matches()</code> FHIRPath function to check if the <code>StructureDefintion.purpose</code> text is properly populated in some of our profiles. This works as long as I don't include linebreaks in the <code>.purpose</code> field. If I do, I get inconsistent results. Take the following synthetic example:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>  -- snip --\n  <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">\"An anatomical location specifies the location (e.g. foot) and laterality (e.g. links) of a bodypart.\"</span> <span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;purpose</span> <span class=\"na\">value=</span><span class=\"s\">\"A&amp;#xD;&amp;#xA;B\"</span> <span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;fhirVersion</span> <span class=\"na\">value=</span><span class=\"s\">\"4.0.1\"</span> <span class=\"nt\">/&gt;</span>\n  -- snip --\n</code></pre></div>\n<p>Yields:</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>HL7 Validator</th>\n<th>FHIRPath Tester</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>StructureDefinition.purpose.matches('A.*')</code></td>\n<td>false</td>\n<td>true</td>\n</tr>\n<tr>\n<td><code>StructureDefinition.purpose.matches('A.*B')</code></td>\n<td>false</td>\n<td>false</td>\n</tr>\n</tbody>\n</table>\n<p>However, the specification states that regexes in <code>matches()</code> are considered to use single-line mode, suggesting that a dot should match newlines. Could anybody help out?</p>",
        "id": 238725037,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1620974268
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 238772898,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1621001490
    },
    {
        "content": "<p>I think the issue is actually an omission in the implementations. I just raised an issue for the FHIR Validator.</p>",
        "id": 238777023,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1621003082
    },
    {
        "content": "<p>the test cases are here: <a href=\"https://github.com/FHIR/fhir-test-cases/blob/master/r5/fhirpath/tests-fhir-r5.xml\">https://github.com/FHIR/fhir-test-cases/blob/master/r5/fhirpath/tests-fhir-r5.xml</a>. Do you want to add a test case that fails?</p>",
        "id": 238830631,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1621026777
    },
    {
        "content": "<p>Thanks for the pointer, I'll add the test case.</p>",
        "id": 239041822,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1621234579
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I'm not very familiar with Maven, but I believe I managed to add a test case for this issue (not pushed yet). Do you want me to add other test cases for <code>matches()</code> as well while I'm at it?</p>",
        "id": 239072966,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1621251573
    },
    {
        "content": "<p>sure. the more the better</p>",
        "id": 239148056,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1621280516
    },
    {
        "content": "<p>Ok, created a pull request</p>",
        "id": 239206527,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1621320974
    }
]