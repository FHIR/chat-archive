[
    {
        "content": "<p>Hi,<br>\nI'm trying to create a FHIRPath expression for checking if a Location is part of another location of a specific phsysical type.<br>\nIf found this hint to comparing codeable-concepts wit <code>~</code> <a href=\"https://www.hl7.org/fhir/fhirpath.html#changes\">https://www.hl7.org/fhir/fhirpath.html#changes</a><br>\nBut I don't know how to \"create\" the value for comparison.<br>\nWhat I have so far:<br>\n<code>partOf.exists() and partOf.resolve().physicalType ~ &lt;missing part for system=http://terminology.hl7.org/CodeSystem/location-physical-type + code=wa&gt;</code><br>\nCan anyone point me to the right direction please?</p>",
        "id": 233795669,
        "sender_full_name": "Christian Nau",
        "timestamp": 1617962513
    },
    {
        "content": "<p><code>partOf.resolve().physicalType.where(system='http://terminology.hl7.org/CodeSystem/location-physical-type' and code='wa').exists()</code> should work</p>",
        "id": 233817028,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1617973581
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Thanks for your answer. I tested it within a Profile. When validating a new instance of a location against this profile it fails for this constraint. But I double checked this referenced location exists and has the correct coding for physical-type. What could be the issue?</p>",
        "id": 233826775,
        "sender_full_name": "Christian Nau",
        "timestamp": 1617977267
    },
    {
        "content": "<p>Ah, missed the coding.  Try:<br>\n<code>partOf.resolve().physicalType.coding.where(system='http://terminology.hl7.org/CodeSystem/location-physical-type' and code='wa').exists() </code></p>",
        "id": 233854216,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1617986394
    },
    {
        "content": "<p>This didn't work for me. I don't know the reason. <br>\nBut I have found another solution to my problem (kudos to <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> ): using a constraint on <code>partOf</code> to only be a reference to my other Location-profile.<br>\nFor anyone interested: <br>\nExpressed in <code>fsh</code> notation:</p>\n<div class=\"codehilite\"><pre><span></span><code>Profile:    MyWard\nParent:     Location\n* physicalType 1..1 MS\n* physicalType = http://terminology.hl7.org/CodeSystem/location-physical-type#wa\n\n\nProfile:    MyBed\nParent:     Location\nDescription: &quot;A bed as part of a ward of a hospital.&quot;\n* partOf 1..1 MS\n* partOf only Reference(MyWard)\n</code></pre></div>",
        "id": 234629125,
        "sender_full_name": "Christian Nau",
        "timestamp": 1618471286
    }
]