[
    {
        "content": "<p>I continue to work my way through the FHIRPath test suite: I am wondering whether test cases 'testPrecedence3' and 'testPrecedence4' are correct? They are '1 &gt; 2 is Boolean' with expected result true, and '1 | 1 is Integer' with expected result true. But 'is' has higher precedence than '&gt;' and '|'. In my mind the proper outcome of the first expression is thus a failure, since it basically evaluates to '1 &gt; false'. The outcome of the second one should be '[1, true]', as '1 is Integer' equals true. Or am I mistaken?</p>",
        "id": 267315566,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641675975
    },
    {
        "content": "<p>The dotnet engine gives &gt; a higher precedence than is (just tested it here)</p>",
        "id": 267316542,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641676781
    },
    {
        "content": "<p>However I think you're right based on the spec. I'll check the code and grammar to compare.</p>",
        "id": 267316588,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641676811
    },
    {
        "content": "<p>I'm looking at this spec: <a href=\"http://hl7.org/fhirpath/#operator-precedence\">http://hl7.org/fhirpath/#operator-precedence</a></p>",
        "id": 267316601,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641676854
    },
    {
        "content": "<p>Did you test the Java or fhirpathjs implementation?</p>",
        "id": 267316611,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641676870
    },
    {
        "content": "<p>not yet, I'm contributing to <span class=\"user-mention\" data-user-id=\"235060\">@Grey Faulkenberry</span> 's Dart version.</p>",
        "id": 267316631,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641676915
    },
    {
        "content": "<p>I assume you have the tests file and walking through that yeah?</p>",
        "id": 267316682,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641676960
    },
    {
        "content": "<p>exactly. Very helpful in general, but a very small number of test cases leave me with some doubts.</p>",
        "id": 267316708,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641677031
    },
    {
        "content": "<p>The fhirpath.js is also doing the precedence as expected in the test suite and not as in the spec.</p>",
        "id": 267316789,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641677110
    },
    {
        "content": "<p>The grammar file is consistent with spec</p>",
        "id": 267316935,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641677332
    },
    {
        "content": "<p>Do you know what the procedure is to give feedback on the test suite? Similar as with SDC, where one files a JIRA issue? I just found the next test case that should signal an error according to the spec, but the test suite expects it to pass.</p>",
        "id": 267317096,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641677590
    },
    {
        "content": "<p>Just jira the same.</p>",
        "id": 267317109,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641677617
    },
    {
        "content": "<p>(might not be an offical artifact, but makes sense to track in the same way)</p>",
        "id": 267317153,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641677645
    },
    {
        "content": "<p>(and also here too for discussion like this)</p>",
        "id": 267317178,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641677719
    },
    {
        "content": "<p>Actually, the grammar used by the fhirpathjs is different to the official one on the site...</p>",
        "id": 267317246,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641677778
    },
    {
        "content": "<p>Same here, there was no good ANTLR for Dart, so it is based on Petite Parser. Tries to get the spec correctly implemented, but cannot use the grammar file.</p>",
        "id": 267317281,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641677857
    },
    {
        "content": "<p>This is what is in the fhirpathjs implementation...<br>\n<a href=\"https://github.com/HL7/fhirpath.js/blob/master/src/parser/FHIRPath.g4\">https://github.com/HL7/fhirpath.js/blob/master/src/parser/FHIRPath.g4</a><br>\nAnd that moved the precedence of the is down below &gt; and |</p>",
        "id": 267317376,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641677998
    },
    {
        "content": "<p>Thus different to <a href=\"https://hl7.org/fhirpath/grammar.html\">https://hl7.org/fhirpath/grammar.html</a></p>",
        "id": 267317419,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641678013
    },
    {
        "content": "<p>(still trying to locate the specific part of the .net code that does this)</p>",
        "id": 267317433,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641678050
    },
    {
        "content": "<p>Looks like the dotnet parser does the same as the fhirpathjs there too (precedence wise)<br>\n<a href=\"https://github.com/FirelyTeam/firely-net-common/blob/7c6f7fb726f41f5a6645a9bc9239af9ca4ec9f82/src/Hl7.FhirPath/FhirPath/Parser/Grammar.cs#L134\">https://github.com/FirelyTeam/firely-net-common/blob/7c6f7fb726f41f5a6645a9bc9239af9ca4ec9f82/src/Hl7.FhirPath/FhirPath/Parser/Grammar.cs#L134</a></p>",
        "id": 267317574,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641678294
    },
    {
        "content": "<p>I think from a common sense perspective the lower precedence for 'is' makes sense. But I guess it would be hard to argue against a released ANSI standard...</p>",
        "id": 267317676,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1641678465
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 267317805,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1641678618
    }
]