[
    {
        "content": "<p>Someone recently asked me how you would use FHIRPath to describe an invariant that says \"for a given coding, if the coding contains a certain code A, it has to also contain a second code B, where B is not in a certain valueset S.\"   My attempt at this was:</p>\n<div class=\"codehilite\"><pre><span></span><code>x.coding.where(system = &#39;http://loinc.org&#39; and code = &#39;12345&#39;).exists() implies x.coding.where(system != &#39;http://loinc.org&#39; and code != &#39;12345&#39; and $this.memberOf(&#39;http://myvaluesets.org/ABC&#39;).not()).exists()\n</code></pre></div>\n<p>I think that's right, but correct me if I'm wrong!  Anyway, that's not the point.  The thing I realized is that it could be cleaned up if FHIRPath had a literal syntax for a concept (system, code, optional display).  FHIR Shorthand has one that might work out really well here.  If it was employed, then the above would be rewritten as:</p>\n<div class=\"codehilite\"><pre><span></span><code>x.coding.where($this ~ http://loinc.org#12345).exists() implies x.coding.where($this !~ http://loinc.org#12345 and $this.memberOf(&#39;http://myvaluesets.org/ABC&#39;).not()).exists()\n</code></pre></div>\n<p>Have we given any thought to supporting a literal representation of CQL's <code>Concept</code>?</p>",
        "id": 219878544,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1607968848
    },
    {
        "content": "<p>So... I guess that's a no. ;-). Well then, maybe we should consider it?</p>",
        "id": 221259729,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1609375916
    },
    {
        "content": "<p>Might suggest the pipe convention for concatenating a system + code, since FHIR uses that elsewhere.</p>",
        "id": 221545471,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1609777716
    },
    {
        "content": "<p>I hadn't thought of this before, but FHIR also uses <code>|</code> for <code>canonical</code>.  So <code>http://foo.org|bar</code> means different things depending on the context of its use.  I don't love that.  (But I guess the same might be said for <code>http://foo.org#bar</code>).</p>",
        "id": 221555933,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1609782297
    },
    {
        "content": "<p>Regardless of whether it's a <code>|</code> or a <code>#</code>, it seems like it would need delimiters in order to be added to FHIRPath, since many of the symbols allowed in URLs are already part of other production rules in the grammar. Maybe it's a <code>#</code> followed by the FHIR URL syntax for a code? So <code>#http://foo.org|bar</code>? And you could potentially generalize that to a \"uri\" literal and use it for both codes and canonicals...</p>",
        "id": 222186621,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1610222212
    },
    {
        "content": "<p>it does have many problems</p>",
        "id": 222754832,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1610646599
    }
]