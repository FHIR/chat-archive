[
    {
        "content": "<p>Looking at some of the IPS profiles, I think many of the slicing on extensions is wrong. For example, in MedicationStatement:</p>\n<div class=\"codehilite\"><pre><span></span><code>      {\n        &quot;id&quot; : &quot;MedicationStatement.effective[x]&quot;,\n        &quot;path&quot; : &quot;MedicationStatement.effective[x]&quot;,\n        &quot;min&quot; : 1,\n        &quot;max&quot; : &quot;1&quot;,\n        &quot;mustSupport&quot; : true\n      },\n      {\n        &quot;id&quot; : &quot;MedicationStatement.effective[x].extension&quot;,\n        &quot;path&quot; : &quot;MedicationStatement.effective[x].extension&quot;,\n        &quot;short&quot; : &quot;effective[x] absence reason&quot;,\n        &quot;definition&quot; : &quot;Provides a reason why the effectiveTime is missing.&quot;,\n        &quot;max&quot; : &quot;1&quot;,\n        &quot;type&quot; : [\n          {\n            &quot;code&quot; : &quot;Extension&quot;,\n            &quot;profile&quot; : [\n              &quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;\n            ]\n          }\n        ],\n        &quot;mustSupport&quot; : true\n      },\n</code></pre></div>\n<p>To me, this says \"the only permitted extension on effective[x] is DAR, and only one occurrence is permitted.\"</p>\n<p>Compare this to AllergyIntolerance, which because of the slice, says  \"there shall be at most one extension of type DAR\":</p>\n<div class=\"codehilite\"><pre><span></span><code>      {\n        &quot;id&quot; : &quot;AllergyIntolerance.extension:abatement-datetime&quot;,\n        &quot;path&quot; : &quot;AllergyIntolerance.extension&quot;,\n        &quot;sliceName&quot; : &quot;abatement-datetime&quot;,\n        &quot;short&quot; : &quot;Abatement datetime&quot;,\n        &quot;definition&quot; : &quot;The date or estimated date that the condition resolved or went into remission.&quot;,\n        &quot;max&quot; : &quot;1&quot;,\n        &quot;type&quot; : [\n          {\n            &quot;code&quot; : &quot;Extension&quot;,\n            &quot;profile&quot; : [\n              &quot;http://hl7.org/fhir/uv/ips/StructureDefinition/abatement-dateTime-uv-ips&quot;\n            ]\n          }\n        ],\n        &quot;mustSupport&quot; : true\n      },\n</code></pre></div>\n<p>Am I misreading this?</p>",
        "id": 261834822,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1637177127
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span>  any thoughts?</p>",
        "id": 262020746,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1637289785
    },
    {
        "content": "<p>HI, <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span>.  I've looked at this, and yes, I think your analysis is correct.  That's a great pickup - thanks!  I finally located the relevant documentation in <a href=\"http://hl7.org/fhir/profiling.html#using-extensions\">5.1.0.15.1 Using Extensions in Profiles</a>: </p>\n<blockquote>\n<p>To prescribe the use of an extension in an instance, the extension list on the resource needs to be sliced.</p>\n</blockquote>\n<p>I will fix this instance, and will look for any others that may be like it.  If you or anyone else are already aware of other instances, let me know.</p>",
        "id": 262085162,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1637337378
    },
    {
        "content": "<p>In IPS master:</p>\n<ul>\n<li>MedicationRequest.dispenseRequest.validityPeriod.extension</li>\n</ul>\n<p>However, I'm not sure if we need to include the discriminator definition or if that is inherited. If we need it, then it is missing from:</p>\n<ul>\n<li>AllergyIntolerance.extension:abatement-datetime</li>\n<li>DeviceUseStatement.timing[x]:data-absent-reason</li>\n<li>DiagnosticReport.effective[x]:data-absent-reason</li>\n<li>Immunization.occurrence[x]:data-absent-reason</li>\n<li>MedicationRequest.dispenseRequest.validityPeriod.extension</li>\n<li>MedicationStatement.effective[x]:data-absent-reason</li>\n<li>Observation.effective[x]:data-absent-reason (all profiles)</li>\n<li>Procedure.performed[x]:data-absent-reason</li>\n</ul>\n<p>(i.e., all extensions except Coding.display.extension)</p>",
        "id": 262096737,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1637341818
    },
    {
        "content": "<p>Thanks for that.  Yes.  I think the the discriminator is implicit as the url for slicing on 'extension'.  But I don't know if that it is documented (or for certain if it's actually true).</p>",
        "id": 262112971,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1637348397
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191405\">Rob Hausam</span> <a href=\"#narrow/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F/near/262112971\">said</a>:</p>\n<blockquote>\n<p>But I don't know if that it is documented (or for certain if it's actually true).</p>\n</blockquote>\n<p>That was my question too.</p>",
        "id": 262113891,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1637348742
    }
]