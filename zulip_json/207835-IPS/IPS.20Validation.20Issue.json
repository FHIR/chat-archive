[
    {
        "content": "<p>if you validate the IPS document at <a href=\"https://github.com/grahamegrieve/IPSviewer/blob/main/samples/connectathon_samples/NZ_Peter_Jordan_AAA1234.json\">https://github.com/grahamegrieve/IPSviewer/blob/main/samples/connectathon_samples/NZ_Peter_Jordan_AAA1234.json</a> against the validator, you get this error reported:</p>",
        "id": 256481324,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553097
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Error @ Bundle (line 1, col2) : Bundle.entry:medication: minimum required = 1, but only found 0 (from http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-uv-ips)\n</code></pre></div>",
        "id": 256481410,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553114
    },
    {
        "content": "<p>on casual inspection, a typical user (both <span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> and I) will look at that and say, that's wrong, there is a medication: <a href=\"https://github.com/grahamegrieve/IPSviewer/blob/main/samples/connectathon_samples/NZ_Peter_Jordan_AAA1234.json#L453\">https://github.com/grahamegrieve/IPSviewer/blob/main/samples/connectathon_samples/NZ_Peter_Jordan_AAA1234.json#L453</a></p>",
        "id": 256481748,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553189
    },
    {
        "content": "<p>well.... there's a medication but it's not valid against the IPS medication statement:</p>",
        "id": 256482006,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553296
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>    slice info: Bundle.entry[0].resource.section[2].entry[0]: Bundle.entry[8].resource: MedicationStatement.effective[x]: minimum required = 1, but only found 0 (from http://hl7.org/fhir/uv/ips/StructureDefinition/MedicationStatement-uv-ips)\n</code></pre></div>",
        "id": 256482020,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553302
    },
    {
        "content": "<p>the thing is, this information is not normally reported by the validator. That's because the discriminator on the bundle entries is the profile itself:</p>",
        "id": 256482194,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553376
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/hpQ2g9zrSpGNTwkhdXs3CLdP/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/hpQ2g9zrSpGNTwkhdXs3CLdP/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/hpQ2g9zrSpGNTwkhdXs3CLdP/image.png\"></a></div>",
        "id": 256482299,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553405
    },
    {
        "content": "<p>so the error about Medication.effective[x] just turns into 'this is a reason why this entry doesn't meet this slice', rather than a validation failure - because the slicing is open. So all the validator can tell you is that it found a bunch of resources, but not an IPS medication</p>",
        "id": 256482478,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553490
    },
    {
        "content": "<p>it tells you this four times, in the information that everyone ignores:</p>",
        "id": 256482509,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553505
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>  Information @ Bundle.entry[8] (line 452, col10) : This element does not match any known slice defined in the profile http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-uv-ips\n</code></pre></div>",
        "id": 256483567,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553914
    },
    {
        "content": "<p>it also tells you this when validating the composition:</p>",
        "id": 256483595,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553929
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>  Information @ Bundle.entry[0].resource.section[2].entry[0] (line 147, col30) : This element does not match any known slice defined in the profile http://hl7.org/fhir/uv/ips/StructureDefinition/Composition-uv-ips\n</code></pre></div>",
        "id": 256483615,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553940
    },
    {
        "content": "<p>finally, there's a mode where the validator can tell you what it's reasoning is, when matching discriminators. We don't usually do that because a lot of it's pretty straight forward and very verbose.</p>",
        "id": 256483718,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633553988
    },
    {
        "content": "<p>running with <code>-verbose</code> gives you this information:</p>",
        "id": 256483878,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633554028
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>  Information @ Bundle.entry[8] (line 452, col10) : This element does not match any known slice defined in the profile http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-uv-ips\n    slice info: Bundle.entry[8]: Does not match slice &#39;composition&#39;\n    slice info: Bundle.entry[8]: Bundle.entry[8].resource: Specified profile type was &#39;CompositionUvIps&#39;, but found type &#39;MedicationStatement&#39;\n    slice info: Bundle.entry[8]: Does not match slice &#39;problem&#39;\n    slice info: Bundle.entry[8]: Bundle.entry[8].resource: Specified profile type was &#39;ConditionUvIps&#39;, but found type &#39;MedicationStatement&#39;\n    slice info: Bundle.entry[8]: Does not match slice &#39;allergy&#39;\n    slice info: Bundle.entry[8]: Bundle.entry[8].resource: Specified profile type was &#39;AllergyIntoleranceUvIps&#39;, but found type &#39;MedicationStatement&#39;\n    slice info: Bundle.entry[8]: Does not match slice &#39;medication&#39;\n    slice info: Bundle.entry[8]: Bundle.entry[8].resource: MedicationStatement.effective[x]: minimum required = 1, but only found 0 (from http://hl7.org/fhir/uv/ips/StructureDefinition/MedicationStatement-uv-ips)\n</code></pre></div>",
        "id": 256484127,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633554126
    },
    {
        "content": "<p>you see both the actual error, and all the verbose 'duh' stuff. But the validator can't know what you think is 'duh' and what is 'oh dear'</p>",
        "id": 256484338,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633554215
    },
    {
        "content": "<p>this behavior is inherent in slicing by profile, so I'm going to see if I can show this logic always on a slicing by profile, but that's pretty tricky - <code>-verbose</code> operates far away from the slicing resolution</p>",
        "id": 256484518,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633554283
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197651\">@Reece Adamson</span> this implies that for now, at least, the inferno validator needs to support an equivalent to the <code>-verbose</code> parameter</p>",
        "id": 256486824,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633555247
    },
    {
        "content": "<p>Thanks for the heads up! I'll work on enabling that.</p>",
        "id": 256503948,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1633565508
    },
    {
        "content": "<p>Validating an IPS Instance using the latest version of the validator from the command line doesn't return any of the structural issues (i.e. missing  entry elements) still returned by the Dev version of Inferno. The relevant argument that I'm passing is...<br>\n-profile <a href=\"http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-cross-border-uv-ips\">http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-cross-border-uv-ips</a> <br>\nand I've also got the same results with passing <br>\n-ig hl7.fhir.uv.ips<br>\n<span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> , <span class=\"user-mention\" data-user-id=\"197651\">@Reece Adamson</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 256903987,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1633818765
    },
    {
        "content": "<p>the one released this morning?</p>",
        "id": 256905934,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633820956
    },
    {
        "content": "<p>Version 5.5.4 - but just grabbed v 5.5.6 from GitHub. - same results.<br>\nWondering if the version of ATC on <a href=\"http://tx.fhir.org\">tx.fhir.org</a> needs to be updated as I'm getting errors on 3 valid ATC codes (C09AA08, H02AB07 and A11CC05 - which all validate against <a href=\"https://www.whocc.no/atc_ddd_index/?code=\">https://www.whocc.no/atc_ddd_index/?code=</a>).<br>\nAlso looks as if the IPS Cross-Border Medications Profile doesn't like multiple codings in Medication.code, although it's a codeable concept.<br>\nCan't find  <a href=\"http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-cross-border-uv-ips\">http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-cross-border-uv-ips</a> now</p>",
        "id": 256910598,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1633825709
    },
    {
        "content": "<p>did you try the<code>-ips</code> parameter? then you don't need others</p>",
        "id": 256921051,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633837280
    },
    {
        "content": "<p>and yes, ATC is an issue we're working on right now</p>",
        "id": 256921061,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633837290
    },
    {
        "content": "<p>Just tried using the -ips parameter, but it failed... \"The file name you passed in,  '-ips',  doesn't exist on the local file system\".</p>",
        "id": 256921970,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1633838386
    },
    {
        "content": "<p>and you're using 5.5.6?</p>",
        "id": 256929652,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633846872
    },
    {
        "content": "<p>Yes</p>",
        "id": 256929889,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1633847133
    },
    {
        "content": "<p>sigh. the code in question didn't make it into 5.5.6</p>",
        "id": 256930006,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633847271
    },
    {
        "content": "<p>I'm getting to working on updating ATC - too many things going on, but I think I can (finally) do that tonight.</p>",
        "id": 256986329,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1633901567
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> try 5.5.7 release</p>",
        "id": 256997285,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633912538
    },
    {
        "content": "<p>Ran 5.5.7 release - it downloaded and installed the IPS Package ok<br>\nUsed the 'plain' xx-uv-ips profiles, as opposed to the xx-cross-border-uv-ips ones<br>\nNo errors reported against my instance, but a ton of information messages mostly these for every single entry in the Bundle...<br>\n&lt;issue&gt;<br>\n    &lt;extension url=\"<a href=\"http://hl7.org/fhir/StructureDefinition/operationoutcome-issue-line\">http://hl7.org/fhir/StructureDefinition/operationoutcome-issue-line</a>\"&gt;<br>\n      &lt;valueInteger value=\"226\"/&gt;<br>\n    &lt;/extension&gt;<br>\n    &lt;extension url=\"<a href=\"http://hl7.org/fhir/StructureDefinition/operationoutcome-issue-col\">http://hl7.org/fhir/StructureDefinition/operationoutcome-issue-col</a>\"&gt;<br>\n      &lt;valueInteger value=\"28\"/&gt;<br>\n    &lt;/extension&gt;<br>\n    &lt;extension url=\"<a href=\"http://hl7.org/fhir/StructureDefinition/operationoutcome-issue-source\">http://hl7.org/fhir/StructureDefinition/operationoutcome-issue-source</a>\"&gt;<br>\n      &lt;valueCode value=\"InstanceValidator\"/&gt;<br>\n    &lt;/extension&gt;<br>\n    &lt;severity value=\"information\"/&gt;<br>\n    &lt;code value=\"informational\"/&gt;<br>\n    &lt;details&gt;<br>\n      &lt;text value=\"This element does not match any known slice defined in the profile http://hl7.org/fhir/uv/ips/StructureDefinition/Composition-uv-ips\"/&gt;<br>\n    &lt;/details&gt;<br>\n    &lt;expression value=\"Bundle.entry[0].resource.section[2].entry[1]\"/&gt;<br>\n  &lt;/issue&gt;</p>",
        "id": 256998667,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1633913986
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 256999334,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1633914614
    },
    {
        "content": "<p>every entry?</p>",
        "id": 257006999,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633922862
    },
    {
        "content": "<p>Every entry and it would be good to look at this one as well...<br>\nUnknown Code System <a href=\"http://hl7.org/fhir/uv/ips/CodeSystem/absent-unknown-uv-ips\">http://hl7.org/fhir/uv/ips/CodeSystem/absent-unknown-uv-ips</a></p>",
        "id": 257008968,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1633924912
    },
    {
        "content": "<p>We haven't previously been having issues with the absent-unknown cs.</p>",
        "id": 257009115,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1633925033
    },
    {
        "content": "<p>I'll look - but I'm working on ATC at the moment.</p>",
        "id": 257009222,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1633925094
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span>  I think that there might be an error in the Bundle Profile  here as the entry:All slices doesn't include an element for Resource<br>\n<a href=\"http://build.fhir.org/ig/HL7/fhir-ips/branches/connectathon-2/StructureDefinition-Bundle-uv-ips.html\">http://build.fhir.org/ig/HL7/fhir-ips/branches/connectathon-2/StructureDefinition-Bundle-uv-ips.html</a><br>\nIn comparison this Bundle Profile does have that element on entry: All slices<br>\n<a href=\"http://build.fhir.org/ig/HL7/fhir-ips/branches/connectathon-2/StructureDefinition-Bundle-cross-border-uv-ips.html\">http://build.fhir.org/ig/HL7/fhir-ips/branches/connectathon-2/StructureDefinition-Bundle-cross-border-uv-ips.html</a><br>\nThat could explain why the Validator is reporting an information issue for every Entry other than Composition.</p>",
        "id": 257141877,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1634006662
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> I'll check that out.  At least I agree that it would make sense to be consistent - I think that sparse differentials are <strong>supposed</strong> to work now, but we do need to verify.</p>",
        "id": 257205097,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1634046309
    },
    {
        "content": "<blockquote>\n<p>for every entry: This element does not match any known slice defined in the profile</p>\n</blockquote>\n<p>What example are you validating?</p>",
        "id": 257253693,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634064894
    },
    {
        "content": "<p>I'm validating 'my' IPS instance (with no extensions and only receives a couple of terminology-related info messages from 'plain' validator calls)</p>\n<p>I'd like to be able to validate directly against the x-border Bundle profile , but its defining URL doesn't resolve...<br>\n<a href=\"http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-cross-border-uv-ips\">http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-cross-border-uv-ips</a></p>\n<p>The -ips validator argument uses the other IPS bundle profile...<br>\n<a href=\"http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-uv-ips\">http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-uv-ips</a></p>",
        "id": 257263205,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1634068859
    },
    {
        "content": "<p>I think that at least some of this may be addressed by ImplementationGuid.global.profile.  I'm going to check that out further tonight and we will plan to discuss it on the IPS call tomorrow (that's not at a good time for you, <span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span>, but happy to look at it further and get more input before that).</p>",
        "id": 257282874,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1634078476
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span>  - I think that the issue may be in the snapshot (must support) version of the Bundle Profile in <a href=\"http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-uv-ips\">http://hl7.org/fhir/uv/ips/StructureDefinition/Bundle-uv-ips</a>.<br>\n<span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> same issues with the example Bundles in the IPS IG except that it doesn't report information messages regarding these at these specific Entry-&gt;Resource locations...<br>\nComposition [0] <br>\nCondition[4]<br>\nMedicationStatement [5] <br>\nThat behavior is common to all instances that I've validated.</p>",
        "id": 257286770,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1634080915
    }
]