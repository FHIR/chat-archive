[
    {
        "content": "<p>I'm working with ObservationDefinition. Several comments:</p>\n<ul>\n<li>the documentation is silent on what seems like an important question to me: how do you tell if an Observation is related to an ObservationDefinition? By Observation.code = ObservationDefinition.code? If an Observation has multiple codes, it could be related to more than one definition?</li>\n<li>alternatively, why can it only have one code? What should you do if you have an observation that has LOINC + SNOMED CT codes + more? </li>\n<li>what is the relationship  between an ObservationDefinition.category and the Observation.category for a matching Observation?</li>\n<li>it should be a MetadataResource (as in, it should inherit from that)</li>\n<li>it should have a name (computer generatable version of the title)</li>\n<li>it should follow the order of elements in MetadataResource</li>\n</ul>\n<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> <span class=\"user-mention\" data-user-id=\"191689\">@Hans Buitendijk</span> <span class=\"user-mention\" data-user-id=\"191408\">@Lorraine Constable</span></p>",
        "id": 201818070,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592983548
    },
    {
        "content": "<blockquote>\n<p>the documentation is silent on what seems like an important question to me: how do you tell if an Observation is related to an ObservationDefinition? By Observation.code = ObservationDefinition.code?</p>\n</blockquote>\n<p>use the Observation extension:  <a href=\"http://hl7.org/fhir/StructureDefinition/workflow-instantiatesCanonical\">http://hl7.org/fhir/StructureDefinition/workflow-instantiatesCanonical</a></p>\n<p>but I agree should be made clear in the doco</p>",
        "id": 201859771,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593011198
    },
    {
        "content": "<blockquote>\n<p>what is the relationship between an ObservationDefinition.category and the Observation.category for a matching Observation?</p>\n</blockquote>\n<p>my assumption was that the category and code should match for the Observation to be an instance of the definition.</p>",
        "id": 201860034,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593011311
    },
    {
        "content": "<blockquote>\n<p>it should be a MetadataResource (as in, it should inherit from that)  </p>\n</blockquote>\n<p>it follows the  a definitional pattern and are you saying all definitional resources should inherit from metadata ? That was not clear <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  ( like <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span>  Topic)</p>",
        "id": 201860722,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593011644
    },
    {
        "content": "<blockquote>\n<p>use the Observation extension</p>\n</blockquote>\n<p>I hope that this is not the only way. I agree that this would make it explicit, but is there any expectation that there's a link by code?</p>",
        "id": 201897209,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593029344
    },
    {
        "content": "<blockquote>\n<p>my assumption was that the category and code should match for the Observation to be an instance of the definition.</p>\n</blockquote>\n<p>I think that makes sense but it would good to say explicitly that this is the expectation</p>",
        "id": 201897240,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593029365
    },
    {
        "content": "<blockquote>\n<p>all definitional resources should inherit from metadata</p>\n</blockquote>\n<p>In general, yes. But more specifically: any resource with a canonical URL must inherit from CanonicalResource</p>",
        "id": 201897313,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593029402
    },
    {
        "content": "<p>but since ObservationDefinition has all the properties of MetadataResource, it should inherit from that too</p>",
        "id": 201897433,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593029442
    },
    {
        "content": "<p>I don't understand the Observation.subject as a 'type' when it refers to a group?</p>",
        "id": 202051483,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593145269
    },
    {
        "content": "<p>All the *valueSet properties should be canonical, not Reference().</p>",
        "id": 202052676,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593147026
    },
    {
        "content": "<p>you want Jira's for all these?</p>",
        "id": 202052679,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593147034
    },
    {
        "content": "<p>I don't understand the units bit at all:</p>\n<ul>\n<li>what is UCUM the \"customary unit\"? is that the custom unit? or something different?</li>\n<li>if both UCUM and SI are given, which is the 'right' one?</li>\n<li>how does both SI and customary units have the same binding?</li>\n</ul>",
        "id": 202054163,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593149375
    },
    {
        "content": "<p>this pseudo code... does it make sense?</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">def</span> <span class=\"nf\">makeObservationFromDefinition</span>\n  <span class=\"n\">Observation</span> <span class=\"n\">obs</span> <span class=\"o\">=</span> <span class=\"n\">make</span> <span class=\"n\">Observation</span><span class=\"p\">;</span>\n  <span class=\"n\">obs</span><span class=\"o\">.</span><span class=\"n\">code</span> <span class=\"o\">=</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">code</span><span class=\"p\">;</span>\n  <span class=\"n\">obs</span><span class=\"o\">.</span><span class=\"n\">category</span><span class=\"o\">.</span><span class=\"n\">addAll</span><span class=\"p\">(</span><span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">category</span><span class=\"p\">);</span>\n  <span class=\"k\">if</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">bodySite</span>\n    <span class=\"n\">obs</span><span class=\"o\">.</span><span class=\"n\">bodySite</span> <span class=\"o\">=</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">bodySite</span><span class=\"p\">;</span>\n  <span class=\"k\">if</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">method</span>\n    <span class=\"n\">obs</span><span class=\"o\">.</span><span class=\"n\">method</span> <span class=\"o\">=</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">method</span><span class=\"p\">;</span>\n  <span class=\"k\">if</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">permittedDataType</span><span class=\"o\">.</span><span class=\"n\">has</span><span class=\"p\">(</span><span class=\"n\">quantity</span><span class=\"p\">)</span> <span class=\"ow\">and</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">quantitativeDetails</span><span class=\"o\">.</span><span class=\"n\">unit</span><span class=\"p\">()</span> <span class=\"o\">||</span>\n      <span class=\"ow\">and</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">quantitativeDetails</span><span class=\"o\">.</span><span class=\"n\">unit</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">hasSystem</span><span class=\"p\">(</span><span class=\"s2\">&quot;http://unitsofmeasure.org&quot;</span>\n    <span class=\"k\">with</span> <span class=\"n\">obs</span><span class=\"o\">.</span><span class=\"n\">valueQuantity</span>\n      <span class=\"o\">.</span><span class=\"n\">system</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;http://unitsofmeasure.org&quot;</span>\n      <span class=\"o\">.</span><span class=\"n\">code</span> <span class=\"o\">=</span> <span class=\"n\">def</span><span class=\"o\">.</span><span class=\"n\">quantitativeDetails</span><span class=\"o\">.</span><span class=\"n\">unit</span><span class=\"o\">.</span><span class=\"n\">getCode</span><span class=\"p\">(</span><span class=\"s2\">&quot;http://unitsofmeasure.org&quot;</span><span class=\"p\">)</span>\n  <span class=\"o\">//</span> <span class=\"n\">todo</span><span class=\"p\">:</span> <span class=\"nb\">set</span> <span class=\"n\">up</span> <span class=\"n\">reference</span> <span class=\"n\">ranges</span>\n  <span class=\"k\">return</span> <span class=\"n\">obs</span><span class=\"p\">;</span>\n</code></pre></div>",
        "id": 202054471,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593149832
    },
    {
        "content": "<p>Yes, the pseudo code makes sense.<br>\nGoing back to your initial question <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  we built ObservationDefinition with the purpose of generating Observation out of it, as  this pseudo code does. However we did not capture the other way round use case : \"From which ObservationDefinition was this particular Observation generated?\" .  I agree that it seems a valid use case if we don't want folks and programs to mess around by building hybrid Observation instances borrowing from multiple ObservationDefinition instances or  adopting off-the-spot characteristics distinct from those written in the Definition.</p>\n<ul>\n<li>Therefore I agree we should explicitly state this single parent inheritance in ObservationDefinition spec, and in particular state that all Code.coding elements from the Definition should appear in the Observation, likewise for category.</li>\n<li>customaryUnit and unit: In many countries clinical labs frequently report their quantitative results expressed in two unit systems. For instance fast gluccose 7.2 mmol/L or 1.3 g/L. customaryUnit would be g/L and unit would be mmol/L. This habit has been spread out in Europe's CDA lab reports feeding national PHRs (Austria, France, Switzerland, ...) taking advantage of the PQ.translation feature of V3. In FHIR the same ptractice will end up with two component Observation instances conveying the result, one with the SI units and one with the customary. (If folks think \"custom\" is clearer than \"customary\" we coould change that).  This is a case where we generate two slightly distinct Observation from a single ObservationDefinition.</li>\n<li>More generally, various kinds of Observation may be generated from a single ObservationDefinition, each one picking one of the premittedDataType for its value. </li>\n<li>computable name. We missed it. Should be there.  ObservationDefinition silently applies the definition pattern, which does not have a computable name. We need to state this  definition pattern explicitly in the resource, unless someone speaks against ObservationDefinition being related to the definition pattern.</li>\n<li>canonical versus reference. This goes beyond my current knowledge. I take your word on it.</li>\n<li>Metadata resource. I don't understand what this means.<br>\nIn conclusion, there are some changes to bring to ObservationDefinition. Who makes the trackers?</li>\n</ul>",
        "id": 202062093,
        "sender_full_name": "François Macary",
        "timestamp": 1593158552
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179256-Orders-and.20Observation.20WG/topic/ObservationDefinition.20Questions/near/202051483\">said</a>:</p>\n<blockquote>\n<p>I don't understand the Observation.subject as a 'type' when it refers to a group?</p>\n</blockquote>\n<p>That is to be able to have multiple types of subjects.  I'm not sure or plumb forget why not 0..* code instead?</p>",
        "id": 202110800,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593188125
    },
    {
        "content": "<blockquote>\n<p>customaryUnit and unit: In many countries clinical labs frequently report their quantitative results expressed in two unit systems. For instance fast gluccose 7.2 mmol/L or 1.3 g/L. customaryUnit would be g/L and unit would be mmol/L. This habit has been spread out in Europe's CDA lab reports feeding national PHRs (Austria, France, Switzerland, ...) taking advantage of the PQ.translation feature of V3. In FHIR the same ptractice will end up with two component Observation instances conveying the result, one with the SI units and one with the customary. (If folks think \"custom\" is clearer than \"customary\" we coould change that). This is a case where we generate two slightly distinct Observation from a single ObservationDefinition.</p>\n</blockquote>\n<p>There is a translation extension for that we should use for that.  I'll need to dig it up....</p>",
        "id": 202111422,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593188433
    },
    {
        "content": "<p>We have a similar pattern here around units here in Australia but I don't think that it's the same. Not that I follow anyway. g/L and mmol?L are both SI and Ucum units; what makes one customary and one not? I think the definitions and the documentation needs some work here.</p>",
        "id": 202213977,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593308179
    },
    {
        "content": "<p>I think that the extension that Eric referenced above serves the purpose fine for explicitly linking to an observation definition. I think that should be an extension. And I expect that there'll generally be situations where an observation definition collection contains multiple competing definitions for a particular observation - I'm interested in what we should say about implied relationships in this kind of case</p>",
        "id": 202214064,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593308362
    },
    {
        "content": "<p>All units are in UCUM. And yes g/L and mmol/L are both SI.  The current good practice  dispensed in many medical schools for that kind of parameter is to use substance concentration rather than mass concentration. However, some old school physicians are used to mass concentration ans stick to it. So the intent of \"customary unit\" is to accommodate old school representation.</p>",
        "id": 202307450,
        "sender_full_name": "François Macary",
        "timestamp": 1593436837
    },
    {
        "content": "<p>so I think these need better documentation, since that's very jurisdiction specific- and also a question specific to concentrations</p>",
        "id": 202358136,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593459422
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> and <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>  I've checked the existing unresolved tickets on ObservationDefinition, complemented some of them, and added new ones. With that, hopefully, all the concerns expressed in this chat are taken care of. And thanks for these concerns. ObservationDefinition really needs improvements.<br>\nThe tickets are:  <br>\n<a href=\"https://jira.hl7.org/browse/FHIR-26921\">26921</a>, <a href=\"https://jira.hl7.org/browse/FHIR-28097\">28097</a>, <a href=\"https://jira.hl7.org/browse/FHIR-28096\">28096</a>, <a href=\"https://jira.hl7.org/browse/FHIR-26603\">26603</a>, <a href=\"https://jira.hl7.org/browse/FHIR-28608\">28608</a>, <a href=\"https://jira.hl7.org/browse/FHIR-28609\">28609</a>,  <a href=\"https://jira.hl7.org/browse/FHIR-28613\">28613</a>.</p>",
        "id": 211242220,
        "sender_full_name": "François Macary",
        "timestamp": 1601030676
    },
    {
        "content": "<p>Originally Grahame was asking for the following:<br>\nwhy can it only have one code? What should you do if you have an observation that has LOINC + SNOMED CT codes + more?<br>\nI still see on the R5 Draft  a code 1..1<br>\nSo how do we profile if there are multiple codes for the ObservationDefinition? I also didn't find a JIRA issue addressing this point.</p>",
        "id": 260653281,
        "sender_full_name": "Diana_Ovelgoenne",
        "timestamp": 1636376506
    },
    {
        "content": "<p>Are you asking about the Observation Definition that would be used in Service/Lab Catalog or reporting on the instance results with Observation (like a culture mapped to LOINC and an organism mapped to SCT?)</p>",
        "id": 265881988,
        "sender_full_name": "Andrea Pitkus, PhD, MLS(ASCP)CM, CSM",
        "timestamp": 1640232891
    }
]