[
    {
        "content": "<p>Hi all, starting a thread here for considering the CoordinateSystem ValueSet in our Variant profile, currently the internal textual set: \"Interval | Variant method | Alignment method\". See <a href=\"http://hl7.org/fhir/uv/genomics-reporting/2018May/ValueSet-genetic-coordinate-system.json\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/genomics-reporting/2018May/ValueSet-genetic-coordinate-system.json\">http://hl7.org/fhir/uv/genomics-reporting/2018May/ValueSet-genetic-coordinate-system.json</a>, <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19938\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19938\">GF#19938</a>, and the textual description from Bret: </p>\n<p><em>\"Base number of coordinate system either 0-based, with inclusive start and exclusive end (called interval), or 1-based, with inclusive start and end. However, two versions of 1-based are in common use.These systems are HGVS 1-based (called variant method) and VCF 1-based (called alignment method). In general, HGVS recommends right-justification and VCF recommends left-justification. However, these systems further address questions such as wheather or not to place an insertion before or after the nucleotide, and, if always placed before the nucleotide, how to handle insertion after the end of the sequence. Additionally, the systems deal with handling boundary effects of numbers between features. For more details see the HGVS and VCF guides.\"</em></p>\n<p>The goal is to iron out the contents of this set and get it to Clem/LOINC for inclusion.</p>",
        "id": 157539864,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1549301494
    },
    {
        "content": "<p>See also <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16244\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16244\">GF#16244</a>, <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19835\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19835\">GF#19835</a>, and <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19836\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19836\">GF#19836</a>. It seems <span class=\"user-mention\" data-user-id=\"191916\">@ Bob Milius</span> had some great links about this topic that may be useful, if someone can find them (I tried but could not).</p>",
        "id": 157542364,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1549303621
    },
    {
        "content": "<p>It seems this description doesn't quite match with the table we give on <a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/genetic-coordinate-system.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/genomics-reporting/genetic-coordinate-system.html\">http://build.fhir.org/ig/HL7/genomics-reporting/genetic-coordinate-system.html</a></p>",
        "id": 157553168,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1549311200
    },
    {
        "content": "<p>Can you point out the specifics? I wrote both, so in theory there should be consistency</p>",
        "id": 157615507,
        "sender_full_name": "Bret H",
        "timestamp": 1549381353
    },
    {
        "content": "<p>I think I am confused by the last entry in the table, which uses the words \"Variant Method\" to define the Alignment Method:<br>\n<code>Alignment method | 1-based [inclusive start, inclusive end] - with Variant Method (HGVS-like)</code></p>",
        "id": 157621246,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1549386184
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192123\">@Bret H</span>  - I think this will be a topic on Monday.  Will you have a chance to respond here or be available to discuss Monday?</p>",
        "id": 157903252,
        "sender_full_name": "Kevin Power",
        "timestamp": 1549669308
    },
    {
        "content": "<p>Yep. That extra text is misplaced. <span class=\"user-mention\" data-user-id=\"196553\">@James Jones</span> with removing  \"with variant method...\" to the end, see any other problems?</p>\n<p>Still looking for Bob's references.</p>",
        "id": 157941558,
        "sender_full_name": "Bret H",
        "timestamp": 1549739118
    },
    {
        "content": "<p>Bret, I don't understand why alignment method, right vs. left justification, etc, are part of the definition of coordinate system. Isn't the main objective to just know that when I'm referring to, say, position 7-8 in the string 'ACTGGCATAG', which base(s) I'm referring to?</p>",
        "id": 157987234,
        "sender_full_name": "Bob Dolin",
        "timestamp": 1549826452
    },
    {
        "content": "<p>From: Bob Milius &lt;<a href=\"mailto:bmilius@NMDP.ORG\" title=\"mailto:bmilius@NMDP.ORG\">bmilius@NMDP.ORG</a>&gt; <br>\nSent: Monday, November 19, 2018 10:33 AM<br>\nTo: Bret Heale &lt;<a href=\"mailto:Heale@imail.org\" title=\"mailto:Heale@imail.org\">Heale@imail.org</a>&gt;; McDonald, Clem (NIH/NLM/LHC) [E] &lt;<a href=\"mailto:clemmcdonald@mail.nih.gov\" title=\"mailto:clemmcdonald@mail.nih.gov\">clemmcdonald@mail.nih.gov</a>&gt;; Amos, Liz (NIH/NLM) [E] &lt;<a href=\"mailto:liz.amos@nih.gov\" title=\"mailto:liz.amos@nih.gov\">liz.amos@nih.gov</a>&gt;; Power,Kevin M. &lt;<a href=\"mailto:Kevin.Power@Cerner.com\" title=\"mailto:Kevin.Power@Cerner.com\">Kevin.Power@Cerner.com</a>&gt;<br>\nSubject: Re: Question re: 16244</p>\n<p>Brett,</p>\n<p>No, both are inclusive, and the coordinates of the sequences themselves remain the same.</p>\n<p>So, you could just use two coordinate systems for describing just the coordinates (1-based, inclusive start and end; 0-based, inclusive start, exclusive end, aka interval)</p>\n<p>But the 1-based systems differ when describing variants.</p>\n<p>When you described an insertion with a 1-based system, do you put the insertion before or after the nucleotide?</p>\n<p>If you decide it's always before the nucleotide, how to handle an insertion after the end of the sequence?</p>\n<p>How do you handle boundary effects of numbers between features?</p>\n<p>HGVS recommends right-justified, and VCF recommends left-justified.</p>\n<p>There was a great discussion on this that Larry Babb pointed me to, but the link appears to be dead now. I've asked Larry if it's been moved.</p>\n<p>Here's figure from that now dead link which describes how variants are described in the three system.</p>\n<p>ttp://datamodel.clinicalgenome.org/development/images/variant_numbering_examples.png</p>\n<p>Re changing the IG, there should be a QA period where we can make corrections.</p>\n<p>Bob M</p>",
        "id": 158027834,
        "sender_full_name": "Bret H",
        "timestamp": 1549889633
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/XfC84ZGwJo40m6dwhkv_PG_0/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/XfC84ZGwJo40m6dwhkv_PG_0/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/XfC84ZGwJo40m6dwhkv_PG_0/pasted_image.png\"></a></div>",
        "id": 158027902,
        "sender_full_name": "Bret H",
        "timestamp": 1549889675
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193751\">@Bob Dolin</span> I added the email from Bob Milius. The figure describes the difference. My role was to take the information from Bob M as agreed by Clem et al. We should discuss the differences in the call. My preference is to use only Zero, with explicitly stated inclusive start and exclusive end.  The machines on either end can convert to a whatever numbering system is desired. But an explicit definition seems necessary to satisfy all people.   Very much related to the need for using conical SPDI in HGVS. folks are too creative...</p>",
        "id": 158028616,
        "sender_full_name": "Bret H",
        "timestamp": 1549890405
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192123\">@Bret H</span> Sorry, still not understanding. In the figure, both Alignment Format and Variant Format are 1-based fully closed (<a href=\"https://plastid.readthedocs.io/en/latest/concepts/coordinates.html\" target=\"_blank\" title=\"https://plastid.readthedocs.io/en/latest/concepts/coordinates.html\">https://plastid.readthedocs.io/en/latest/concepts/coordinates.html</a>). The differences aren't due to choice of coordinate system, but rather, choice of alignment and variant representation. About 2% of simple variants in 1000 Genomes VCF files have redundant (non-normalized) representation, but we can still say that the VCF files are 1-based fully closed.  Wouldn't alignment method be a separate field?</p>",
        "id": 158033064,
        "sender_full_name": "Bob Dolin",
        "timestamp": 1549894727
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193751\">@Bob Dolin</span>  not sure what you mean. Look at the row in the figure for 2delT. The numbering for the two 1-based options does not come out the same. Can you talk me through that example?</p>\n<p>side-bar:  Also, you'll note in your example that the authors of plastid choose, and describe, a specific numbering/alignment method. Again, my vote would be for a single-representation. The benefits include a consistent expectation for coordinate system. Unless reporting a method or wanting to describe metadata about a repository, when is it a problem to report everything with zero-base inclusive end (PS half-open, open, inclusive, exclusive are all terms that different authors have chosen, there is not a standard just practice). You've been working on conversion from VCF and BAM more recently than I. I look forward to your comments.</p>",
        "id": 158040643,
        "sender_full_name": "Bret H",
        "timestamp": 1549900511
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193751\">@Bob Dolin</span>  pps: that's a well written resource.</p>",
        "id": 158040920,
        "sender_full_name": "Bret H",
        "timestamp": 1549900754
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"196622\">@Larry Babb</span> <span class=\"user-mention\" data-user-id=\"191916\">@ Bob Milius</span>  we talked about this on the call today. In the past you both made important contributions. will you be available to review the final disposition? many thanks!</p>",
        "id": 158045369,
        "sender_full_name": "Bret H",
        "timestamp": 1549903958
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192123\">@Bret H</span>  I'm all for a single coordinate system, although I kinda recall in prior committee discussions that it would be a hard sell.</p>\n<p>Regarding your 2delT question - In the figure, 2delT is represented in: [1] Alignment format (1-based): 1..2 AT A; and [2] Variant Format (1-based): 2..2 T -. Note that in both cases, the \"T\" is at position 2. What's different is that the Alignment method doesn't want null's in the Alt allele, so begins the Ref allele with the position before the deletion. </p>\n<p>I'm not an expert on alignment methods, but have seen some references describing a VCF approach (<a href=\"https://academic.oup.com/bioinformatics/article/31/13/2202/196142\" target=\"_blank\" title=\"https://academic.oup.com/bioinformatics/article/31/13/2202/196142\">https://academic.oup.com/bioinformatics/article/31/13/2202/196142</a>) and the NCBI SPDI approach (<a href=\"https://www.biorxiv.org/content/biorxiv/early/2019/02/05/537449.full.pdf\" target=\"_blank\" title=\"https://www.biorxiv.org/content/biorxiv/early/2019/02/05/537449.full.pdf\">https://www.biorxiv.org/content/biorxiv/early/2019/02/05/537449.full.pdf</a>). I'm okay with deferring on a LOINC code for alignment method at this time, because as you mentioned on the call, it's not clear anyone has a compelling need for it.</p>\n<p>As for Coordinate system, here's a draft definition and value set: </p>\n<p>A genomic coordinate is a position along a sequence. Coordinate systems can start counting from 1 ('1-based') or from 0 ('0-based'). HGVS, GFF, SAM, VCF, UCSC genome browser, and other applications employ a 1-based system. In a 1-based system, the end is \"fully-closed\", meaning that the end coordinate of an interval's range is the last position IN the range. BAM files, BED files, NCBI SPDI, UCSC database tables, and other applications employ a 0-based system. In a 0-based system, the end is \"half-open\", meaning that the end coordinate of an interval's range is the first position NOT IN in the range. For example, assume we have the sequence 'ACGTAGTC'. Interval range 2..4 in a 1-based coordinate system refers to the bases 'CGT', whereas interval range 2..4 in a 0-based coordinate system refers to the bases 'GT'.</p>",
        "id": 158070531,
        "sender_full_name": "Bob Dolin",
        "timestamp": 1549923152
    },
    {
        "content": "<p>need a definition for interval range</p>",
        "id": 159349532,
        "sender_full_name": "Bret H",
        "timestamp": 1551111402
    },
    {
        "content": "<p>FWIW, the authoritative write-up on this topic, which we did for ClinGen, is here: <a href=\"http://dataexchange.clinicalgenome.org/allele/discussion/\" target=\"_blank\" title=\"http://dataexchange.clinicalgenome.org/allele/discussion/\">http://dataexchange.clinicalgenome.org/allele/discussion/</a></p>",
        "id": 160125579,
        "sender_full_name": "Bob Freimuth",
        "timestamp": 1551899901
    },
    {
        "content": "<p>I'm restarting this thread to draw attention to the fact that the MolecularSequence.coordinateSystem does not use the same value set as the CG Variant profile component for coordinate-system (<a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/obs-variant-definitions.html#Observation.component:coordinate-system\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/genomics-reporting/obs-variant-definitions.html#Observation.component:coordinate-system\">http://build.fhir.org/ig/HL7/genomics-reporting/obs-variant-definitions.html#Observation.component:coordinate-system</a>). </p>\n<p>It appears as if the thread above helped produce a good value set for the ObsVariant profile component, but there is no harmonization with the same concept in the MolecularSequence.coordinateSystem.</p>\n<p>Should we have a gforge item to make sure this gets corrected?</p>",
        "id": 175678774,
        "sender_full_name": "Larry Babb",
        "timestamp": 1568426632
    },
    {
        "content": "<p>Yes that would be nice. MolecularSequence didn‘t get much love recently. There also was a discussion at some point if we still need it or if we can replace it by the IG/ profiled Observation. I‘d like to continue the discussion soon.</p>",
        "id": 175679706,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1568428136
    },
    {
        "content": "<p>i don't think its reasonable to replace it with the obsVariant profile. In the eMERGE pilot we've come to the recent conclusion that the MolecularSequence is the most computationally sound representation of genomic variation. Since there is no \"definitional\" representations of genomic structures, variants and otherwise, we are going to depend on it to provide the build, chr, refseqId, ref, alt, start, end information that is the closest to the standards coming out of the GA4GH VR work. </p>\n<p>I do think it would be helpful to implementers if there was a single path for dealing with computationally precise variation for use in either case level or variant level assertion models.</p>\n<p>to be clear, I think having the profiles that use componentized sets of LOINC codes to create codeableconcept attributes for things like start/end ranges and their dependency on a specific sequence (be it protein, transcript or genomic) and the loose coupling of other components that may or may not contribute to the 'definition' of a variant is not what I think is a clinically reliable and sound computational form of sharing genetic variation data. </p>\n<p>While I get the flexibility and consideration to allow the various groups around the world to share whatever sets of attributes they use either for human convenience or dare I say \"computational identifiers\", I view these profiles as a first shot at trying to solve two issues with one \"bag\" of attributes in a semi-reasonable shape of variation. It may start the ball rolling to allow folks to \"find a place\" to pass their favorite piece of variant information but it does not rise to the level of a computationally sound standard that I would want my health information to be represented in. I most definitely wouldn't want any CDS algorithms to rely on it.</p>",
        "id": 175716717,
        "sender_full_name": "Larry Babb",
        "timestamp": 1568492569
    }
]