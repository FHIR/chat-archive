[
    {
        "content": "<p>CIMPL 6.8.0 has just been released.  See the release notes for a full list of changes:<br>\n<a href=\"https://github.com/standardhealth/shr-cli/releases/tag/v6.8.0\" target=\"_blank\" title=\"https://github.com/standardhealth/shr-cli/releases/tag/v6.8.0\">https://github.com/standardhealth/shr-cli/releases/tag/v6.8.0</a></p>",
        "id": 176230276,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1569013440
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> <br>\nI have been doing a lot of refactoring of the breast radiology to reflect comments from the ballot, and I am seeing some issues<br>\nI am using 6.8.0.<br>\nSo I am not using Objective Fhir, but have created my own Fhir base classes.<br>\nThinking of calling 'em Direct Fhir :-)<br>\nAnyways my first issue is that I am getting items in the StructureDef.Differential that I didnt change.</p>\n<p>So, I created a (r4) DiagnosticReport entry (see attached), and I derived a class \"BreastRadiologyReport.txt\" from it.<br>\nWhen I run shr-cli, there is an entry in the differential for DiagnosticReport.basedOn (amoung others) that I didnt change.<br>\nIn the spirit of outputting a clean ig, it would be best if entries only showed up in the differential if they arr actual changes.<br>\nIs this something I did wrong?</p>\n<p>This is still in the same repository <a href=\"https://github.com/applicadia/Fhir-BreastRadiologyReport\" target=\"_blank\" title=\"https://github.com/applicadia/Fhir-BreastRadiologyReport\">https://github.com/applicadia/Fhir-BreastRadiologyReport</a>, development branch. Execute R4.BuildProfiles.bat to run shr-cli. <a href=\"/user_uploads/10155/dj5-78jSazdsYfVYcgNYcXcI/DiagnosticReport.txt\" target=\"_blank\" title=\"DiagnosticReport.txt\">DiagnosticReport.txt</a> <a href=\"/user_uploads/10155/CgoK_E4w_sD4ez2MG_IUkE7m/DiagnosticReport_map_r4.txt\" target=\"_blank\" title=\"DiagnosticReport_map_r4.txt\">DiagnosticReport_map_r4.txt</a> <a href=\"/user_uploads/10155/kJT19DPSGES5aN3lcop4W7Oz/BreastRadiologyReport.txt\" target=\"_blank\" title=\"BreastRadiologyReport.txt\">BreastRadiologyReport.txt</a></p>",
        "id": 176564149,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1569418124
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192611\">@Kurt Allen</span> -- I'll try to take a look at this later...  But you are correct; things should only show up in differential if something changed (or if one of its children changed, since IG publisher doesn't deal well with \"sparse\" differentials).</p>\n<p>Occasionally something <em>has</em> changed but it's not rendered in the differential view of the profile page in the IG.  Have you looked at the actual JSON profile definition to see what it includes in the differential for that element?</p>",
        "id": 176564898,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1569418632
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span>  (sorry to dump on you today, getting back to work on this stuff and finding stuff...)<br>\nin BreastRadiologyObservation<br>\nI added the following lines<br>\n    HasMember<br>\n    includes BreastRadiologyObservationPatientHistory 0..1</p>\n<p>and I get the error:<br>\nERROR 12018:  'Cannot constrain element BreastRadiologyObservationPatientHistory to fhir.observation.HasMember since it is an invalid sub-type'<br>\n    During:         Model Expansion<br>\n    Class:          BreastRadiologyObservation<br>\n    Suggested Fix:  Element has to be based on or otherwise a child of sub-type.</p>\n<p>Observation.HasMember is defined as:<br>\n// Entry definition of Observation.hasMember<br>\nElement: HasMember <br>\nValue: fhir.observation.Observation<br>\n      or fhir.questionnaireresponse.QuestionnaireResponse<br>\n      or fhir.molecularsequence.MolecularSequence </p>\n<p>BreastRadiologyObservationPatientHistory is derived from fhir.observation.Observation.</p>\n<p>Is this an issue with my code?</p>",
        "id": 176565001,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1569418692
    },
    {
        "content": "<p>Yo <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> <br>\nI looked both in the output structure def profile resource and the ig. It was included in both places.<br>\nThis is from the BreastRadiologyReport differential:<br>\n      {<br>\n        \"id\": \"DiagnosticReport.basedOn\",<br>\n        \"path\": \"DiagnosticReport.basedOn\",<br>\n        \"type\": [<br>\n          {<br>\n            \"code\": \"Reference\",<br>\n            \"targetProfile\": [<br>\n              \"<a href=\"http://hl7.org/fhir/StructureDefinition/CarePlan\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/CarePlan\">http://hl7.org/fhir/StructureDefinition/CarePlan</a>\",<br>\n              \"<a href=\"http://hl7.org/fhir/StructureDefinition/ImmunizationRecommendation\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/ImmunizationRecommendation\">http://hl7.org/fhir/StructureDefinition/ImmunizationRecommendation</a>\",<br>\n              \"<a href=\"http://hl7.org/fhir/StructureDefinition/MedicationRequest\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/MedicationRequest\">http://hl7.org/fhir/StructureDefinition/MedicationRequest</a>\",<br>\n              \"<a href=\"http://hl7.org/fhir/StructureDefinition/NutritionOrder\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/NutritionOrder\">http://hl7.org/fhir/StructureDefinition/NutritionOrder</a>\",<br>\n              \"<a href=\"http://hl7.org/fhir/StructureDefinition/ServiceRequest\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/ServiceRequest\">http://hl7.org/fhir/StructureDefinition/ServiceRequest</a>\"<br>\n            ]<br>\n          }<br>\n        ]<br>\n      },</p>\n<p>I attached the DiagnosticReport and BreastRadiologyReport structure definitions<br>\n<a href=\"/user_uploads/10155/9TluwAjG8kGrNuousYUIX7Tv/structuredefinition-fhir-diagnosticreport-DiagnosticReport.json\" target=\"_blank\" title=\"structuredefinition-fhir-diagnosticreport-DiagnosticReport.json\">structuredefinition-fhir-diagnosticreport-DiagnosticReport.json</a> <a href=\"/user_uploads/10155/4ylb7Orq60OYESzhdFtdK7tl/structuredefinition-brr-BreastRadiologyReport.json\" target=\"_blank\" title=\"structuredefinition-brr-BreastRadiologyReport.json\">structuredefinition-brr-BreastRadiologyReport.json</a></p>",
        "id": 176565436,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1569418981
    },
    {
        "content": "<p>Thanks! (and welcome back :-))</p>",
        "id": 176565493,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1569419010
    },
    {
        "content": "<p>When you use <code>includes</code>, the thing on the left (<code>HasMember</code>) needs to be a supertype of the thing on the right (<code>BreastRadiologyObservationPatientHistory</code>).  That's not the case in your example above -- so that's why it's not working. </p>\n<p>Since it is <code>HasMember</code> that repeats (<code>0..*</code>) and not it's <code>Value</code>, you can't simply do <code>HasMember.Value includes...</code> though.  There might need to be some refactoring of the model to support this.  Have you looked at how Mark models it in obf?</p>",
        "id": 176565701,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1569419130
    },
    {
        "content": "<p>Regarding the DiagnosticReport and basedOn, we'll have to take a look at that more closely... I agree that the differential seems entirely unnecessary.</p>",
        "id": 176566006,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1569419351
    },
    {
        "content": "<p>My bad.. Thanks!</p>",
        "id": 176566513,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1569419690
    }
]