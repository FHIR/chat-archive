[
    {
        "content": "<p>I am getting output that doesn't look right. I don't know if it is a bug or a CIMPL user error (:-)).<br>\nI derived a class from Composition and am slicing on Section</p>\n<p>Entry: BreastRadiologyReport<br>\nParent: Composition<br>\n        Section<br>\n        includes PatientHistory 0..1<br>\n                ...</p>\n<p>Group: PatientHistory<br>\nDescription:    \"Patient History\"<br>\nParent: Section<br>\n            Code[concept] = LOINC#34117-2</p>\n<p>When I look at the output StructureDefinition, I don't see any reference to PatientHistory, no slices, nothing.<br>\nIs this my error or a possible bug?<br>\nI have included the original CIMPL file and the output StructureDefinition json file.</p>\n<p>Thanks in advance,<br>\nKurt A.</p>\n<p><a href=\"/user_uploads/10155/gHcjZyukI2WsI4xrVO3kuZso/structuredefinition-xxyyz-BreastRadiologyReport.json\" target=\"_blank\" title=\"structuredefinition-xxyyz-BreastRadiologyReport.json\">structuredefinition-xxyyz-BreastRadiologyReport.json</a> <a href=\"/user_uploads/10155/f0OL6dZq57NkRQ1mFgR-Ehhk/BreastRad.txt\" target=\"_blank\" title=\"BreastRad.txt\">BreastRad.txt</a></p>",
        "id": 168868380,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1561397548
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192611\">@Kurt Allen</span>.  Thanks for sending along these details.  I think this is an issue with the FHIR mappings for Composition in OBF.  I think that the mapping <code>Section maps to section</code> needs a slicing directive.  I haven't had a chance to test it, but try modifying the file <code>obf_foundation_map_r4.txt</code>.   Find this line in the <code>Composition</code> mapping:</p>\n<div class=\"codehilite\"><pre><span></span>Section maps to section\n</pre></div>\n\n\n<p>and change it to:</p>\n<div class=\"codehilite\"><pre><span></span>Section maps to section (slice on = code)\n</pre></div>\n\n\n<p>I <em>think</em> that should work, but would appreciate your confirmation (or denial) if you get a chance to try it!</p>",
        "id": 168869995,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1561398717
    },
    {
        "content": "<p>Yo <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> <br>\nThanks for the info.  I added the slice on code to foundation, and now it adds the slicing discriminator definition to the structure def, but still no references to the actual slices (PatientHistory et all).<br>\nI have included the output StructDef.<br>\nGettin' closer!<br>\nKurt A</p>\n<p><a href=\"/user_uploads/10155/AzY3-8qPX70utcxpODD2zPyS/BreastRad.txt\" target=\"_blank\" title=\"BreastRad.txt\">BreastRad.txt</a> <a href=\"/user_uploads/10155/w1N99fLYWW1ofmbIWo676LU_/obf_foundation_map_r4.txt\" target=\"_blank\" title=\"obf_foundation_map_r4.txt\">obf_foundation_map_r4.txt</a> <a href=\"/user_uploads/10155/gcqjYkYthDvMSHyOhAmaqRaM/structuredefinition-xxyyz-BreastRadiologyReport.json\" target=\"_blank\" title=\"structuredefinition-xxyyz-BreastRadiologyReport.json\">structuredefinition-xxyyz-BreastRadiologyReport.json</a></p>",
        "id": 168875359,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1561402339
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192611\">@Kurt Allen</span>.  Oh, right.  I forgot that since <code>Section</code> uses the <code>includes</code> constraint, you actually need:</p>\n<div class=\"codehilite\"><pre><span></span>Section maps to section (slice on = code; slice strategy = includes)\n</pre></div>\n\n\n<p>Again, I <em>think</em> that should work. Sorry I'm unable to test it myself right now...  If the above doesn't work, I'll try to get a chance to dig deeper tomorrow.</p>\n<p>In future versions of CIMPL, I hope to make stuff like this a lot simpler (and hopefully automagic).  But we're not quite there yet.</p>",
        "id": 168876456,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1561403149
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> . That did it! Thanks.</p>",
        "id": 168878218,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1561404733
    },
    {
        "content": "<p>Great!  <span class=\"user-mention\" data-user-id=\"191447\">@Mark Kramer</span> -- can you update the mapping for OBF <code>Composition</code> per the above conversation?  I think that Kurt is using composition in the expected way for multiple sections, right?</p>",
        "id": 168879524,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1561405821
    },
    {
        "content": "<p>Yes, I can. I'll ping the list when it is promoted to master.</p>",
        "id": 168881167,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1561407028
    },
    {
        "content": "<p>Here's the PR: <a href=\"https://github.com/standardhealth/shr_spec/pull/308\" target=\"_blank\" title=\"https://github.com/standardhealth/shr_spec/pull/308\">https://github.com/standardhealth/shr_spec/pull/308</a>. <span class=\"user-mention\" data-user-id=\"192611\">@Kurt Allen</span> can you review the PR and merge it if it seems correct? (this will be a landmark as the first commit at least reviewed by a non-MITRE person...  we truly become open source project). On second thought, I'm not sure you have commit rights.  Let me know.</p>",
        "id": 168883946,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1561409314
    },
    {
        "content": "<p>Kurt would need to have write access to the project in order to accept and merge a PR.  He does not have that.  The best he can do is comment on the PR to confirm that he approves it.  I think that's the normal model for project consumers to indicate their support of a PR anyway.  Then someone on the CIMPL team can merge it.</p>",
        "id": 168888176,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1561413080
    },
    {
        "content": "<p>Hello <span class=\"user-mention\" data-user-id=\"191447\">@Mark Kramer</span> and <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> :  I downloaded #308 and ran a build of the R4 mappings with my code and all seamed well. The R3 and R2 looked good, but all they got was a visual inspection. Thanks for the quick turnaround...</p>",
        "id": 168893750,
        "sender_full_name": "Kurt Allen",
        "timestamp": 1561418543
    }
]