[
    {
        "content": "<p>(Sorry, I posted this previously on the implementer's stream, being unaware of the IHE-stream, so I'll c&amp;p from there to here)<br>\nI've been reading the MHD Spec (<a href=\"http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_MHD.pdf\" target=\"_blank\" title=\"http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_MHD.pdf\">http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_MHD.pdf</a>) but I couldn't figure out, what Bundle.type this is supposed to be.<br>\nDefinitely not \"document\", even though the spec mentiones the <code>Document Bundle</code>a lot. The spec also talks a lot about \"transactions\" but then again, that's just IHE-speak for \"interaction\" in general.<br>\nIn chapter \"3.65.4.1.3 Expected Actions\" it is detailed that </p>\n<blockquote>\n<p>The Document Recipient shall process the bundle atomically, analogous to both the Provide and<br>\nRegister Document Set-b [ITI-41] transaction and FHIR “transaction” as specified in<br>\n<a href=\"http://hl7.org/fhir/STU3/http.html#transaction\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/http.html#transaction\">http://hl7.org/fhir/STU3/http.html#transaction</a> .</p>\n</blockquote>\n<p>Which is a pretty clear indication towards transaction type bundles. However that's a pretty rough guess, as this chapter deals with server processing logic and not with client responsibilities. In case of transaction type bundles I'd expect to find some guidance for client implementers on how to populate the <code>request</code>section for the entries, which I couldn't find anywhere. The RESTful interactions only detailed for the Bundle as a whole, but not for the entries.<br>\nAm I missing something? Where can I find an example for a Document submission Bundle?</p>",
        "id": 153916690,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1509349144
    },
    {
        "content": "<p>Speaking of examples: Just to prevent confusion for potential MHD implementers: I think it would be helpful to put a clearly visible \"DEPRECATED\" note on the atom feed example at the top of this page: <a href=\"https://wiki.ihe.net/index.php/MHD_Implementation_Guide\" target=\"_blank\" title=\"https://wiki.ihe.net/index.php/MHD_Implementation_Guide\">https://wiki.ihe.net/index.php/MHD_Implementation_Guide</a> . There is a Bundle example further down, but since people usually start reading from the top, I'm not sure if they haven't already thrown their hands up in desperation, before they reach the Bundle part ;-) <br>\nAlso, the Bundle example on that page doesn't populate the Bundle.type (1..1), making it therefore an <em>invalid</em> (DSTU2/STU3/R4-)Bundle.</p>",
        "id": 153916691,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1509349172
    },
    {
        "content": "<p>In case of transaction type bundles, there's also the Bundle.entry.request part missing, which is mandatory in the spec (enforced through invariant bdl-3).<br>\nIn any case, Bundle.entry.fullUrl must be populated, whenever Bundle.entry.resource is populated (enforced through invariant bdl-6).</p>",
        "id": 153916693,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1509351264
    },
    {
        "content": "<p>Hi Simone, Glad to get your feedback.   I updated that old wiki page.</p>",
        "id": 153916766,
        "sender_full_name": "John Moehrke",
        "timestamp": 1509369682
    },
    {
        "content": "<p>As to the bundle type. You should look to the \"Message Encoding\" section (3.65.4.1.2) for how the message should be encoded. We are using a FHIR \"Transaction\", and I tried to make that clear with plenty of references to the link into the specitication.</p>",
        "id": 153916767,
        "sender_full_name": "John Moehrke",
        "timestamp": 1509369744
    },
    {
        "content": "<p>The Document Source shall initiate a FHIR “transaction” using a “create” action by sending an HTTP POST request methods composed of a FHIR Bundle Resource containing the DocumentManifest resource, one or more DocumentReference Resources, zero or more List Resources, and zero or more Binary Resources to the Document Recipient. Refer to ITI TF-3: 4.5.1 for details on the FHIR Resources and how Document Sharing metadata attributes are mapped.<br>\nThe media type of the HTTP body shall be either application/fhir+json or application/fhir+xml.<br>\nSee <a href=\"http://hl7.org/fhir/STU3/http.html#transaction\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/http.html#transaction\">http://hl7.org/fhir/STU3/http.html#transaction</a> for complete requirements of a transaction. See <a href=\"http://hl7.org/fhir/STU3/bundle-transaction.html\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/bundle-transaction.html\">http://hl7.org/fhir/STU3/bundle-transaction.html</a> for example of a transaction bundle.</p>",
        "id": 153916769,
        "sender_full_name": "John Moehrke",
        "timestamp": 1509369767
    },
    {
        "content": "<p>This bundle should likely be described... is that done in a StructureDefinition? I got starter StructureDefinitions for DocumentReference, DocumentManifest, and List... but not yet for the Provide transaction.... hmmm</p>",
        "id": 153916771,
        "sender_full_name": "John Moehrke",
        "timestamp": 1509370186
    },
    {
        "content": "<p>I think there should be a StructureDefinition for the bundle with fixed value of \"transaction\" for type, to make sure, nobody choses \"document\" by mistake (as that might be an obvious choice for any FHIR-newbie). <br>\nAlso, create individual slices for earch permitted entry:<br>\nset entry.fullUrl to 1..1 and entry-request to 1..1, fix values for entry.request.method to \"POST\" (though this requirement is not clearly stated in the PDF, might be \"PUT\" for Document updates???), fix entry.request.url to the ResourceType, depending on slice...<br>\nfix entry.resource to 1..1<br>\nThat should prevent people from making rookie mistakes and increase the quality and adherence to the profile of the implementations...</p>",
        "id": 153916772,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1509370738
    }
]