[
    {
        "content": "<p>Hi, I am using the <a href=\"http://docs.smarthealthit.org/client-js/\">SMART JS Client Library</a>. The current situation is that the SMART app is launching from a CDS card, at which point the EHR opens a new window where the authorization flow begins. After SMART.authorize complete, the app runs into a 'This content cannot be displayed in a frame'.<br>\nI found this <a href=\"https://github.com/smart-on-fhir/client-js/issues/33\">GitHub issue</a> describing this issue which says the solution is the <a href=\"http://docs.smarthealthit.org/client-js/api.html#advanced-options\">advanced options</a>.<br>\nI believe the issue is with the header 'X-Frame-Options', but I'm not clear on what the value should be.<br>\nThe <a href=\"http://documentation\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</a> mentions two values, DENY or SAMEORIGIN, and it doesn't seem like DENY is the answer so then assuming the 'X-Frame-Options' is present, the app should be able to launch/run from a new window?<br>\nI have tried the app with <br>\n<code>{completeInTarget: true, target: '_self'}</code><br>\n<code>{completeInTarget: true, target: '_blank'}</code><br>\n<code>{completeInTarget: true, target: 'popup'}</code><br>\n<code>{completeInTarget: true, target: '_top'}</code><br>\nbut none of these made any difference.<br>\nMight anyone know if advanced options for the SMART client is the correct direction to look, and what the correct configuration of the advanced options might be?<br>\n<span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> Could I get your comment on this issue?</p>",
        "id": 262066238,
        "sender_full_name": "Corey Wen",
        "timestamp": 1637328692
    },
    {
        "content": "<p>Giving the way that browser cookie policies have evolved (qnd the underlying security and privacy concerns that led to these changes) there are reasons to make sure that a login step does not need to happen inside of an iframe during a smart app launch. This is something we should take into account with the Smart launcher as well as with the JavaScript client libraries.</p>\n<p>And by the way, what CDS hooks environment are you launching and up from? Sandbox or a real life implantation?</p>",
        "id": 262068532,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1637330055
    },
    {
        "content": "<p>As you said, \"the EHR opens a new window where the authorization flow begins\". At this point I assume their expectation is that your app will authorize and render in that same popup, and those advanced options have nothing to do with that (meaning that it should work with the default options). I feel like the reason is indeed in the <code>X-Frame-Options</code> header. Can you check which server is sending that header? If it is under your control, try removing the <code>X-Frame-Options</code> header.</p>",
        "id": 262076105,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1637333697
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window/near/262068532\">said</a>:</p>\n<blockquote>\n<p>Giving the way that browser cookie policies have evolved (qnd the underlying security and privacy concerns that led to these changes) there are reasons to make sure that a login step does not need to happen inside of an iframe during a smart app launch. This is something we should take into account with the Smart launcher as well as with the JavaScript client libraries.</p>\n<p>And by the way, what CDS hooks environment are you launching and up from? Sandbox or a real life implantation?</p>\n</blockquote>\n<p>The app is being launched from a BPA from an Epic sandbox.</p>",
        "id": 262080366,
        "sender_full_name": "Corey Wen",
        "timestamp": 1637335344
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> <br>\nDoes the <a href=\"https://github.com/smart-on-fhir/client-js\">SMART client</a> attach <code>X-Frame-Options: SAMEORIGIN</code> automatically? If it does, is there a way to disable it?</p>",
        "id": 263333468,
        "sender_full_name": "Corey Wen",
        "timestamp": 1638382629
    },
    {
        "content": "<p>That is a response header, thus it is \"attached\" by the server that renders the app. The client has nothing to do with that.</p>",
        "id": 263456755,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1638460003
    }
]