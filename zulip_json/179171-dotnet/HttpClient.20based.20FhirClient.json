[
    {
        "content": "<p>We're working on the updated FhirClient that uses HttpClient underneath, which means that the OnBeforeEvent and OnAfterEvents need to be replaced.<br>\nHow do others feel about code along the lines of this:</p>\n<div class=\"codehilite\"><pre><span></span><code>var handler = new AuthorizationMessageHandler();\nhandler.Authorization = new AuthenticationHeaderValue(&quot;Bearer&quot;, bearerToken);\nvar server = new HttpFhirClient(handler);\n</code></pre></div>\n\n\n<p>And this class could be something as simple as this:</p>\n<div class=\"codehilite\"><pre><span></span><code>public class AuthorizationMessageHandler : HttpClientHandler\n{\n    public System.Net.Http.Headers.AuthenticationHeaderValue Authorization { get; set; }\n    protected async override Task&lt;HttpResponseMessage&gt; SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)\n    {\n        if (Authorization != null)\n            request.Headers.Authorization = Authorization;\n        return await base.SendAsync(request, cancellationToken);\n    }\n}\n</code></pre></div>",
        "id": 202967277,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1594026441
    },
    {
        "content": "<p>If you need to look at the raw response before the FHIR client processes it, you could do something similar to the above, but process the content returned from the base.SendAsync before returning from the handler</p>",
        "id": 202967531,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1594026643
    },
    {
        "content": "<p>Curious did anyone implemented USCore compatibility validation in their application. Did you use Firely Nuget package?</p>",
        "id": 203122312,
        "sender_full_name": "Sandhya",
        "timestamp": 1594137671
    },
    {
        "content": "<p>would it be useful to provide a default handler so it doesn't need to be implemented in all solutions, but could be if neessary?</p>",
        "id": 203318659,
        "sender_full_name": "Jeremy Chapman",
        "timestamp": 1594240196
    },
    {
        "content": "<p>This is the super simple version, but more likely you'll want to get the auth token from somewhere, and handle when it needs to be refreshed, and when you get 401s etc.</p>",
        "id": 208512361,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1598835610
    },
    {
        "content": "<p>I've done a quick fake fhir client that roughly emulates the FhirClient but using the HttpClient under the hood<br>\n<a href=\"https://www.nuget.org/packages/brianpos.Fhir.R4.httpclient\">https://www.nuget.org/packages/brianpos.Fhir.R4.httpclient</a><br>\nReason I did it was in Azure function apps under high load the existing client will consume all sockets and start causing failures.<br>\nIn other projects I just went back to raw doing it, but thought was time to at least do some effort.<br>\nMay only be usefull till the v2 fhirclient comes out of alpha and into the sunlight <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 210458345,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1600381026
    },
    {
        "content": "<p>The 2.0 .NET API beta2 is nearly there - we're publishing it this week!</p>",
        "id": 210782053,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1600713361
    },
    {
        "content": "<p>Awesome!</p>",
        "id": 210835897,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1600759948
    },
    {
        "content": "<p>Mine was only to get over a prod hurdle.</p>",
        "id": 210835906,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1600759961
    },
    {
        "content": "<p>And for those who want 1.9.0 compatibility</p>",
        "id": 210835937,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1600759980
    },
    {
        "content": "<p>The 2.0 .NET API beta2 is now released. See <a href=\"https://github.com/FirelyTeam/fhir-net-api/releases\">https://github.com/FirelyTeam/fhir-net-api/releases</a> for source code and for the NuGet Packages: <a href=\"https://www.nuget.org/packages?q=hl7.fhir\">https://www.nuget.org/packages?q=hl7.fhir</a></p>",
        "id": 210875111,
        "sender_full_name": "Marco Visser",
        "timestamp": 1600783859
    }
]