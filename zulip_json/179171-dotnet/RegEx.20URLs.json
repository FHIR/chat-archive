[
    {
        "content": "<p>Hi,</p>\n<p>Looking at the RESTURI_PATTERN in the following file I'm wondering if it is correct as there seems to be a space after the http (&amp; before the https) and the http:// - / chars are not escaped \\/.</p>\n<p><a href=\"https://github.com/ewoutkramer/fhir-net-api/blob/9c5f262cbab8200f0e82fffe3f0949a6e7120bc8/src/Hl7.Fhir.Core/Rest/HttpUtil.cs\" target=\"_blank\" title=\"https://github.com/ewoutkramer/fhir-net-api/blob/9c5f262cbab8200f0e82fffe3f0949a6e7120bc8/src/Hl7.Fhir.Core/Rest/HttpUtil.cs\">https://github.com/ewoutkramer/fhir-net-api/blob/9c5f262cbab8200f0e82fffe3f0949a6e7120bc8/src/Hl7.Fhir.Core/Rest/HttpUtil.cs</a></p>\n<p>As I was trying to use the WebResolver I think it is failing at the URL IsRestResourceIdentity conformance check. I've checked this by playing around with the generated regex value in an online tester and noticed those errors. Does this look correct?</p>\n<p>Thanks,<br>\nStephen</p>",
        "id": 153973809,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1530808549
    },
    {
        "content": "<p>I use the WebResolver against <a href=\"https://fhir.nhs.uk/\" target=\"_blank\" title=\"https://fhir.nhs.uk/\">https://fhir.nhs.uk/</a> and <a href=\"https://fhir.hl7.org.uk/\" target=\"_blank\" title=\"https://fhir.hl7.org.uk/\">https://fhir.hl7.org.uk/</a> and it works OK for me. What is the URL that you are attempting to use?</p>",
        "id": 153973972,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1530863323
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191362\">@Richard Kavanagh</span> <br>\nI'm trying to use <a href=\"http://purl.org/elab/StructureDefinition/ProjectIdentifer\" target=\"_blank\" title=\"http://purl.org/elab/StructureDefinition/ProjectIdentifer\">http://purl.org/elab/StructureDefinition/ProjectIdentifer</a> as an extension on our endpoint (local install of Vonk atm), the client connects but the use of a webresolver always returns nothing. Even if I use <br>\n  resolver.AddSource(new WebResolver(id =&gt; new Hl7.Fhir.Rest.FhirClient(\"<a href=\"http://localhost:4080/administration\" target=\"_blank\" title=\"http://localhost:4080/administration\">http://localhost:4080/administration</a>\")));<br>\n   var temp = resolver.ResolveByUri(\"<a href=\"http://purl.org/elab/StructureDefinition/ProjectIdentifer\" target=\"_blank\" title=\"http://purl.org/elab/StructureDefinition/ProjectIdentifer\">http://purl.org/elab/StructureDefinition/ProjectIdentifer</a>\");<br>\nit returns null (even ResolveByCanonicalUrl) when using either baseUrl or the admin  endpoints in Vonk. When checking through the code in github I did notice the regex check and thought I'd manually test it to see if that was what was stopping resolution of the extension.</p>",
        "id": 153973975,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1530867137
    },
    {
        "content": "<p>It does look like it works if I use a standard WebResolver and not one with a supplied FhirClient at the moment. Using the NHS profile to test </p>\n<div class=\"codehilite\"><pre><span></span>  WebResolver resolver = new WebResolver(/*id =&gt; new Hl7.Fhir.Rest.FhirClient(&quot;https://fhir.nhs.uk/&quot;)*/);\n   var temp = resolver.ResolveByUri(&quot;https://fhir.nhs.uk/STU3/StructureDefinition/Extension-CareConnect-GPC-AllergyIntoleranceEnd-1&quot;);\n</pre></div>\n\n\n<p>it works, but if I specify the FhirClient it does not.</p>",
        "id": 153973994,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1530873432
    },
    {
        "content": "<p>If I supply:<br>\nFhirClient client = new FhirClient(\"<a href=\"http://localhost:4080/administration/\" target=\"_blank\" title=\"http://localhost:4080/administration/\">http://localhost:4080/administration/</a>\");<br>\nWebResolver webResolver = new WebResolver(id =&gt; client);<br>\n..and try to search for<br>\nvar yyy = webResolver.ResolveByUri(\"<a href=\"http://purl.org/StructureDefinition/Author\" target=\"_blank\" title=\"http://purl.org/StructureDefinition/Author\">http://purl.org/StructureDefinition/Author</a>\");</p>\n<p>This gets generated in the FhirClient.cs ReadAsync(~~)</p>\n<p>&lt;Bundle xmlns=\\\"<a href=\"http://hl7.org/fhir\\\" target=\"_blank\" title=\"http://hl7.org/fhir\\\">http://hl7.org/fhir\\</a>\"&gt;<br>\n    &lt;type value=\\\"batch\\\" /&gt;<br>\n    &lt;entry&gt;<br>\n        &lt;request&gt;<br>\n            &lt;method value=\\\"GET\\\" /&gt;<br>\n            &lt;url value=\\\"<a href=\"http://localhost:4080/administration/StructureDefinition/Author\\\" target=\"_blank\" title=\"http://localhost:4080/administration/StructureDefinition/Author\\\">http://localhost:4080/administration/StructureDefinition/Author\\</a>\" /&gt;<br>\n        &lt;/request&gt;<br>\n    &lt;/entry&gt;<br>\n&lt;/Bundle&gt;</p>\n<p>It looks like it might be changing the domain to match the client (but I need to double-check this) and I get no body in the response. If I try to perform the same request on the public Firely server (manually using Postman) with either URL I get:</p>\n<p>\"system\": \"<a href=\"http://hl7.org/fhir/dotnet-api-operation-outcome\" target=\"_blank\" title=\"http://hl7.org/fhir/dotnet-api-operation-outcome\">http://hl7.org/fhir/dotnet-api-operation-outcome</a>\",<br>\n                                    \"code\": \"5005\"<br>\n                                }<br>\n                            ],<br>\n                            \"text\": \"Interaction GET <a href=\"http://purl.org/StructureDefinition/Author\" target=\"_blank\" title=\"http://purl.org/StructureDefinition/Author\">http://purl.org/StructureDefinition/Author</a> in entry  is not implemented.\"</p>\n<p>Although in the Firely server test I have not uploaded the extension first.</p>",
        "id": 153974327,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1531148210
    },
    {
        "content": "<p>This however works with the public Vonk server (even though supplying the full URL doesn't)<br>\n&lt;Bundle xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n    &lt;type value=\"batch\" /&gt;<br>\n&lt;entry&gt;<br>\n&lt;request&gt;<br>\n            &lt;method value=\"GET\" /&gt;<br>\n            &lt;url value=\"/StructureDefinition?url=http://purl.org/StructureDefinition/Author\" /&gt;<br>\n        &lt;/request&gt;<br>\n    &lt;/entry&gt;<br>\n&lt;/Bundle&gt;</p>",
        "id": 153974335,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1531151470
    },
    {
        "content": "<p>In the last request you query by the <em>canonical url</em> of the StructureDefinition (indexed with the search parameter 'url').<br>\nYou can have the WebResolver do the same with the method ResolveByCanonicalUrl.</p>",
        "id": 153974660,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1531319822
    }
]