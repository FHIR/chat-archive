[
    {
        "content": "<p>Hi,<br>\nThis error is related to .net firely API. <br>\nWhen I tried to run <a href=\"http://Template-model.tt\">Template-model.tt</a> file it gave me error that \"Microsoft.VisualStudio.Shell.10.0\" is not found. After I changed the version from 10.0 to 15.0 I am getting error that</p>\n<p>\"An exception was thrown while trying to compile the transformation code. The following Exception was thrown:<br>\nSystem.IO.FileNotFoundException: Could not find file 'C:\\WINDOWS\\system32\\Microsoft.VisualStudio.Shell.Interop'.<br>\nFile name: 'C:\\WINDOWS\\system32\\Microsoft.VisualStudio.Shell.Interop'<br>\n   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)<br>\n   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost)<br>\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share)<br>\n   at Roslyn.Utilities.FileUtilities.OpenFileStream(String path)<br>\n   at Microsoft.CodeAnalysis.MetadataReference.CreateFromFile(String path, MetadataReferenceProperties properties, DocumentationProvider documentation)<br>\n   at Microsoft.VisualStudio.TextTemplating.CompilerBridge.&lt;&gt;c.&lt;.ctor&gt;b__15_0(String x)<br>\n   at System.Linq.Enumerable.WhereSelectListIterator<code>2.MoveNext()\n   at System.Linq.Enumerable.&lt;UnionIterator&gt;d__67</code>1.MoveNext()<br>\n   at System.Linq.Enumerable.&lt;UnionIterator&gt;d__67<code>1.MoveNext()\n   at System.Linq.Buffer</code>1..ctor(IEnumerable<code>1 source)\n   at System.Linq.Enumerable.ToArray[TSource](IEnumerable</code>1 source)<br>\n   at System.Collections.Immutable.ImmutableArray.CreateRange<a href=\"http://IEnumerable1%20items)\n%20%20%20at%20Microsoft.CodeAnalysis.ImmutableArrayExtensions.AsImmutableOrEmpty[T](IEnumerable1%20items\">T</a><br>\n   at Microsoft.CodeAnalysis.Compilation.ValidateReferences<a href=\"http://IEnumerable1%20references)\n%20%20%20at%20Microsoft.CodeAnalysis.CSharp.CSharpCompilation.WithReferences(IEnumerable1%20references\">T</a><br>\n   at Microsoft.CodeAnalysis.CSharp.CSharpCompilation.CommonWithReferences(IEnumerable<code>1 newReferences)\n   at Microsoft.VisualStudio.TextTemplating.CompilerBridge.PrepareNewCompilation()\n   at Microsoft.VisualStudio.TextTemplating.CompilerBridge.Compile()\n   at Microsoft.VisualStudio.TextTemplating.TransformationRunner.Compile(String source, String inputFile, IEnumerable</code>1 references, Boolean debug, SupportedLanguage language, String compilerOptions)  Hl7.Fhir.Core       1   <br>\n\"</p>\n<p>I tried to download the dll` and place it but I still get the same error. Can anyone help in running the template file. I am using Visual Studio 2019.</p>\n<p>Thanks in advance</p>",
        "id": 204206755,
        "sender_full_name": "PS",
        "timestamp": 1594993244
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span>  Any idea why I might be getting this error?<br>\nThanks</p>",
        "id": 204381555,
        "sender_full_name": "PS",
        "timestamp": 1595212495
    },
    {
        "content": "<p>Yes, I had the problem myself. It seems to be connected with a recent VS upgrade.</p>",
        "id": 204403779,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1595238543
    },
    {
        "content": "<p>I fixed it in our develop branch. Let me check what I did.</p>",
        "id": 204403793,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1595238555
    },
    {
        "content": "<p>In fhir-net-api\\src\\Hl7.Fhir.Core\\Model\\Generated\\TemplateFileManagerV2.1.ttinclude I changed the line</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;#@ assembly name=&quot;Microsoft.VisualStudio.Shell.10.0&quot;#&gt;\n</code></pre></div>\n\n\n<p>to</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;#@ assembly name=&quot;Microsoft.VisualStudio.Shell.15.0&quot;#&gt;\n</code></pre></div>\n\n\n<p>That fixed it for me.</p>",
        "id": 204404093,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1595238785
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span>  Thanks for the reply. I  already did that but now I am getting new error which I have mentioned in the original question. Did you face this issue ? I googled a bit but didn't find any solution. Any other changes which are required to fix this?<br>\nTIA</p>",
        "id": 204511144,
        "sender_full_name": "PS",
        "timestamp": 1595305070
    },
    {
        "content": "<p>Which branch are you building against?  Can you try <code>develop</code>?</p>",
        "id": 204518581,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1595316527
    },
    {
        "content": "<p>I am using developer branch.  Visual Studio Version is 2019.</p>",
        "id": 204552404,
        "sender_full_name": "PS",
        "timestamp": 1595340808
    },
    {
        "content": "<p>Better question is why are you running the tt templates? Are you trying to change how things are generated, trying to do your own?<br>\nTrying to update the latest R5 code branch?</p>",
        "id": 204635491,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1595401176
    },
    {
        "content": "<p>(message deleted)</p>",
        "id": 204637482,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1595403263
    },
    {
        "content": "<p>I was trying to change structure definitions and see how models will  be generated.</p>",
        "id": 205076123,
        "sender_full_name": "PS",
        "timestamp": 1595814486
    },
    {
        "content": "<p>Changing the core specification?</p>",
        "id": 205096824,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1595842676
    },
    {
        "content": "<p>Yes, to check if some new properties are added to resources models how will be behavior of parser and serializer.</p>",
        "id": 205325977,
        "sender_full_name": "PS",
        "timestamp": 1596007966
    }
]