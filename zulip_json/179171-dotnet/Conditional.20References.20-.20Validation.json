[
    {
        "content": "<p>Hi,<br>\nI'm just wondering if a)I've misunderstood something or b) there's something amiss with the validator output? I have a conditional reference to a resource that exists (and is searchable using these values) but I get an error from the validator when try to validate the transaction bundle with only this entry in it:</p>\n<p>&lt;AllergyIntolerance&gt;<br>\n    &lt;clinicalStatus value=\"resolved\" /&gt;<br>\n    &lt;verificationStatus value=\"confirmed\" /&gt;<br>\n    &lt;type value=\"allergy\" /&gt;<br>\n    &lt;category value=\"food\" /&gt;<br>\n    &lt;patient&gt;<br>\n            &lt;reference value=\"Patient?identifier=https://project/patientIDs|4\" /&gt;<br>\n    &lt;/patient&gt;<br>\n    &lt;assertedDate value=\"2017-10-25T23:00:00Z\" /&gt;   <br>\n&lt;/AllergyIntolerance&gt;</p>\n<p>response is Error - Invalid with the following reason:<br>\n \"text\": \"Encountered an unparseable reference (Patient?identifier=https://project/patientIDs|4)\"</p>\n<p>This however seems to have worked fine (existing resource referenced correctly) in the Vonk test server, is there a parsing error that anyone happens to know about in the validator is is my understanding at fault?</p>\n<p>Thanks,<br>\nStephen</p>",
        "id": 153967113,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1528214835
    },
    {
        "content": "<p>This seems to validate if I URL encode the | character but that fails at the Bundle upload stage with \"The search criteria matched no entries\"</p>",
        "id": 153967115,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1528215536
    },
    {
        "content": "<p>Hi Stephen, I think this is a bug in the validator - I can fully imagine I have not considered that I could encounter these conditional references in the wild.  Can you please file a bug report here: <a href=\"https://github.com/ewoutkramer/fhir-net-api/issues\" target=\"_blank\" title=\"https://github.com/ewoutkramer/fhir-net-api/issues\">https://github.com/ewoutkramer/fhir-net-api/issues</a> ?</p>",
        "id": 153967386,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1528298107
    },
    {
        "content": "<p>Hi Ewout, <br>\nThanks for the response and I will do as requested.<br>\nRegards Stephen</p>",
        "id": 153967449,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1528299500
    },
    {
        "content": "<p>Happy to see Vonk sorted this out. <br>\nFor anyone trying this on a local instance of Vonk, a little warning: Vonk also has an option to validate every resource that is created or updated (Validation.ValidateIncomingResources in the appsettings). If this is set to true, this case will be rejected by the Vonk as well, since it uses the same validator. <br>\nOn the public <a href=\"http://vonk.fire.ly\" target=\"_blank\" title=\"http://vonk.fire.ly\">vonk.fire.ly</a>, this setting is set to false, hence everything is fine.</p>",
        "id": 153968602,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1528778137
    }
]