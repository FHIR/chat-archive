[
    {
        "content": "<p>Hook subscriptions are a bear to configure because of firewalls, routers, and what have you. So if there is anyone with a 4.0.0 server supporting websockets subscriptions please let me know! Hopefully you will be at the connectathon this Saturday.</p>",
        "id": 164580938,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556662057
    },
    {
        "content": "<p>I am working on one now - I'll have something working at the cthon but very very (very) rough</p>",
        "id": 164582247,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556663278
    },
    {
        "content": "<p>Can you use ws: or you need wss: ?</p>",
        "id": 164582763,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556663720
    },
    {
        "content": "<blockquote>\n<p>I am working on one now - I'll have something working at the cthon but very very (very) rough</p>\n</blockquote>\n<p>I suppose I can use either! I too am working on something and it will be really rough. My main interest is to upload PHD data following the PHD IG, exercise the new Device resource, and subscribe to the data. The former I am well versed in ... the latter I am a total greenhorn!</p>\n<p>Do you have a URL for upload (transaction bundles) and a subscription websocket address? I know in the end I will need to get that from the caps statement but this gives me a head start.</p>",
        "id": 164587556,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556668598
    },
    {
        "content": "<p>Don't have anything publicly accessible yet (and our R4 server supports only Patient and Encounter so far)</p>",
        "id": 164623808,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556718102
    },
    {
        "content": "<blockquote>\n<p>Don't have anything publicly accessible yet (and our R4 server supports only Patient and Encounter so far)</p>\n</blockquote>\n<p>Add Observation and Device and that's all I need ... oh transaction Bundle for uploading. The last might be difficult. We also use conditional create transactions to avoid data duplication (then we filter once we get server logicial ids). Personal Health Device can be very bad about uploading old data repeatedly.</p>",
        "id": 164626245,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556720133
    },
    {
        "content": "<p>We do support transactions</p>",
        "id": 164626389,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556720233
    },
    {
        "content": "<p>We have Observation and Device (to a certain extent) for DSTU2 and STU3</p>",
        "id": 164626410,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556720253
    },
    {
        "content": "<p>Our server is up at <a href=\"https://b3-notify-3900-consumers-notify.b3-deploys.com/notify.Adapter1.WebClient/api/fhir\" target=\"_blank\" title=\"https://b3-notify-3900-consumers-notify.b3-deploys.com/notify.Adapter1.WebClient/api/fhir\">https://b3-notify-3900-consumers-notify.b3-deploys.com/notify.Adapter1.WebClient/api/fhir</a><br>\n(still working on some kinks on subscriptions)</p>",
        "id": 164720812,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556813111
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192228\">@Brian Reinhold</span> I can give you a login / register an app for you - or are you going to use backend auth ?</p>",
        "id": 164720854,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556813153
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"192228\">Brian Reinhold</span> I can give you a login / register an app for you - or are you going to use backend auth ?</p>\n</blockquote>\n<p>I can support client credentials or username/password grants. I cam also support a scope parameter and separate endpoints for the token server versus the fhir server.</p>",
        "id": 164734575,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556822973
    },
    {
        "content": "<p>You should have received an invitation to activate your login</p>",
        "id": 164735644,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556823824
    },
    {
        "content": "<blockquote>\n<p>You should have received an invitation to activate your login</p>\n</blockquote>\n<p>Got it and created a user ... I think.<br>\nShould I use the username and password in the oAuth2 resource owner grant request?</p>",
        "id": 164736250,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556824215
    },
    {
        "content": "<blockquote>\n<p>You should have received an invitation to activate your login</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span>   Okay, I tried. I got an oAuth error that I am not authorized to access the resource. I assumed the oAuth2 token server had the same endpoint address as the FHIR server. It took a very long time to type in that URL on my little mobile phone!!!</p>\n<p>I assumed you are using my username and password as resource owner credentials (a username-password grant)</p>",
        "id": 164739297,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556826585
    },
    {
        "content": "<p>The OAuth urls are in the FHIR conformance<br>\nUse client ID 'FHIR' - no client secret</p>",
        "id": 164743654,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556829789
    },
    {
        "content": "<p>And yes, use your user name and password</p>",
        "id": 164743677,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556829826
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span>  </p>\n<p>Oh.. So I need to parse the capability statement for the oauth URIs. That will take a while to write that code. Can you give me the url so I can just enter (and test) it at this time?</p>\n<p>I am a little confused. When using resource owner credentials I pass a body in the oAuth request containing the password type of grant. Something like this:<br>\n<code>grant_type=password&amp;username=BrianReinhold&amp;password=myPassword</code></p>\n<p>If I am using client credentials then the body only has <br>\n<code>grant_type=client_credentials</code><br>\nand the basic authorization header has the client credential and secret (base64 rncoded)<br>\n<code>clientCredential/secret</code></p>\n<p>Usually both are not done at once. Do you want me to enter BOTH the resource owner credentials AND the basic authorization header 'FHIR' ?</p>",
        "id": 164744992,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556830856
    },
    {
        "content": "<p>Yes, you need to send also '&amp;client_id=FHIR' (I have not setup a client secret, so that's enough, no auth header)</p>",
        "id": 164761101,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556848316
    },
    {
        "content": "<p>The token  URI is <a href=\"https://b3-notify-3900-consumers-notify.b3-deploys.com/notify.Adapter1.WebClient/identityserver/connect/token\" target=\"_blank\" title=\"https://b3-notify-3900-consumers-notify.b3-deploys.com/notify.Adapter1.WebClient/identityserver/connect/token\">https://b3-notify-3900-consumers-notify.b3-deploys.com/notify.Adapter1.WebClient/identityserver/connect/token</a> (you do not need to write the code to parse the capability statement .... you can just look at it)</p>",
        "id": 164761233,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556848482
    },
    {
        "content": "<blockquote>\n<p>Yes, you need to send also '&amp;client_id=FHIR' (I have not setup a client secret, so that's enough, no auth header)</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> I send the client credentials in the Basic Authorization header so it would look like this</p>\n<p>Authorization: Basic FHIR  (the 'FHIR' gets Base64 encoded of course)<br>\nSo I am still a little confused as to what is being required</p>\n<p>Using client credentials I would have the HTTP Basic Authorization header as above and in the body<br>\ngrant_type=client_credentials</p>\n<p>There would be no use of my user name and password</p>\n<p>Using resource owner credentials I could have a either no Basic Authorization header but the body would be the password grant<br>\ngrant_type=password&amp;username=johndoe&amp;password=A3ddj3w</p>\n<p>So you want me to put the password grant in the body and the client credential in the Basic Authorization header? Shall that client_id be '&amp;client_id=FHIR'?<br>\nDoing either approach gives me an invalid client_id response. It would help if you can sketch out what the HTTP request would look like,  Basic Authorization and body as I am confused as to the type of grant being requested.</p>\n<p>Maybe I should clarify:<br>\nI can only support the <br>\nResource Owner Password Credentials Grant (4.3 in the oAuth2 standard RFC6749)<br>\nor <br>\nClient Credentials Grant (4.4 in the oAuth2 standard RFC6749)</p>\n<p>I cant do the authorization code grant (4.1) or implicit grant (4.2)</p>",
        "id": 164778670,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556874226
    },
    {
        "content": "<p><a href=\"http://test.fhir.org\" target=\"_blank\" title=\"http://test.fhir.org\">test.fhir.org</a> supports web socket subscriptions on /r4</p>",
        "id": 164781099,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556876707
    },
    {
        "content": "<p>POST <code>grant_type=password&amp;username=BrianReinhold&amp;password=myPassword&amp;client_id=FHIR</code></p>",
        "id": 164786872,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556883565
    },
    {
        "content": "<p>The websockets section in the spec says \"Client sends a bind :id message over the socket (using the logical id of the subscription). For example, the client might issue: bind 123).\" - looks like that example should say \"bind :123\"? I haven't tested yet to see which the server actually expects.</p>",
        "id": 164874840,
        "sender_full_name": "Paul Church",
        "timestamp": 1556985052
    },
    {
        "content": "<p>The way I read it <code>:id</code> is the id  - the colon tells you that is not literal</p>",
        "id": 164874921,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556985209
    },
    {
        "content": "<p>(We expect / use <code>bind 123</code>, <code>bound 123</code>, <code>ping 123</code>)</p>",
        "id": 164874967,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556985255
    },
    {
        "content": "<p>yes that's how I implement it on my server</p>",
        "id": 164874968,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556985256
    },
    {
        "content": "<p>To clarify, can someone put the exact string that needs to be sent given that I have obtained the subscription id from the server.</p>",
        "id": 164913908,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1557053407
    }
]