[
    {
        "content": "<p>How should the R5 SubscriptionTopic look like for a List?  In specific, suppose the List has a few different types contained in it, say ImagingStudy, DiagnosticReport, Observation and ServiceRequest.  How would one create a single topic that allowed one to get add/remove notifications from the list for specific items.  That is, I'd like to see something like the notification from <a href=\"https://build.fhir.org/notification-id-only.json.html\">https://build.fhir.org/notification-id-only.json.html</a> but with enough information in it to tell what item is being affected, and whether it is getting added, removed or updated.</p>\n<p>One option is to just have four subscriptions/topics, but that explodes quickly as the number of referenced types increases, and the topic should be on the List, rather than being on the child objects.</p>\n<p>Another option is to allow the notification to include the id of the parent element, but also the id of the referenced element to be monitored, as a \"subTopic\".  The subTopic names would correspond to particular id's in the resourceTrigger (which would become a multi-valued element)<br>\nAlso, the resource trigger would need to add a new type beyond create, update, remove, which would be of type \"include\" or \"revInclude\".</p>\n<div class=\"codehilite\"><pre><span></span><code>    &quot;topic&quot;: &quot;http://example.org/FHIR/R5/SubscriptionTopic/admission&quot;,\n</code></pre></div>\n\n\n<p><strong>      \"subTopic\": [\"listAdd\", \"remove\"]</strong><br>\n      }<br>\n    },<br>\n    {<br>\n      \"fullUrl\": \"<a href=\"https://example.org/FHIR/R5/List/2\">https://example.org/FHIR/R5/List/2</a>\",<br>\n      \"request\": {<br>\n        \"method\": \"PUT\",<br>\n        \"url\": \"List/2\",<br>\n       \"subTopic\": [{  RESOURCES_FOR_ADDED_ITEM - as ID or as full item }]<br>\n      },<br>\n      \"response\": {<br>\n        \"status\": \"201\"<br>\n      }</p>\n<p>Lets see if there is any interest in this first before it gets further fleshed out, but having some way to monitor general lists of references in objects seems like a useful approach, and being about to add multiple identified resource triggers as a \"subTopic\" seems to be one way to accomplish this.  I'm not sure this is quite right yet, but having some way to get the include/revInclude changes seems fairly important, and this mechanism also gives a way to distinguish between  create/add/delete events when multiple ones get listed.  Sometimes that doesn't matter, but it can be important if you want to distinguish those.</p>",
        "id": 201025846,
        "sender_full_name": "Bill Wallace",
        "timestamp": 1592318783
    },
    {
        "content": "<p>Hi Bill, I've been mulling this over to make sure I understand the use case and the workflow proposed.  Largely, I am struggling with how much of this belongs in the subscription specs.</p>\n<p>For example, if a subscription topic is for <code>update</code> on <code>List</code>, every change to that list would be sent to the client, who could compare the 'last' known version with the current version of the list and process from there.  This is far simpler for the server, and only marginally harder for the client.</p>\n<p>Alternatively, there could be an IG for this, which could define an extension on Subscription to add the additional information.  E.g., use the same <code>update</code> on <code>List</code>, but only when the <code>List.entry</code> meets additional criteria.</p>\n<p>Overall, I'd like to think on this a bit more (DevDays is using a lot of mental bandwidth this week), but also wanted to respond.  My gut reaction is that this feels heavy for something that appears to be a narrow use.  I'm not opposed to being convinced, I'm just not there yet.</p>",
        "id": 201167329,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1592411956
    },
    {
        "content": "<p>Yeah, my take has been: if we can get Topics working in R5, we'll be off to a good start. I'd push off a serious discussion of sub-topics until we get some experience with Topics.</p>",
        "id": 201168232,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1592412369
    }
]