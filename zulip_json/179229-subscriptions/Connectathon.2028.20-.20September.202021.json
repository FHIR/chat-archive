[
    {
        "content": "<p>Just starting the September Connectathon Stream, hope to see you all there!</p>",
        "id": 246869025,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1626970449
    },
    {
        "content": "<p>Hi all, just wanted to post here that I have starting recording content for the Connectathon.  So far, I have a <a href=\"https://youtu.be/aF95Vpqsp9s\">Subscriptions Overview</a> (high-level walkthrough of the mechanisms and parts) and a <a href=\"https://youtu.be/aF95Vpqsp9s\">spec walkthrough</a> of the R4 versions.</p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"aF95Vpqsp9s\" href=\"https://youtu.be/aF95Vpqsp9s\"><img src=\"https://uploads.zulipusercontent.net/9057c71cbbe801edd581eb332219880e69f0ab7e/68747470733a2f2f692e7974696d672e636f6d2f76692f61463935567071737039732f64656661756c742e6a7067\"></a></div><p>I'll keep this <a href=\"https://github.com/GinoCanessa/FhirDevVideoNotes/blob/main/Connectathon-28/README.md\">GitHub page</a> up to date and post here as I do more.  Next up will be a walkthrough of the reference implementation, and then I'll jump into some coding examples.</p>\n<p>Cheers!</p>",
        "id": 249880768,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1629306442
    },
    {
        "content": "<p>@Gino can we add the following subscription topics to the reference implementation to support notifications:</p>\n<p>encounter-end<br>\nencounter-transfer</p>\n<p>let me know if you need more information</p>",
        "id": 251271744,
        "sender_full_name": "Eric Haas",
        "timestamp": 1630347774
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> , we likely won't have support for programmatic subscription <strong>creation</strong> ready for the Connectathon, and are focusing on the notification and query-event support right now. To that end, I was wondering if we could have a dedicated scenario for just testing communications/error-handling with $status/$events, that doesn't have the precondition of the create fhir subscription scenario.</p>\n<p>I can write up the scenario, and I'm working on updates to the reference implementation that include a sort of state-machine capturing how clients should react to certain subscriptionStatus payloads. To separate that scenario from the fhir subscription create, I'm planning to update the client and client-host (may need help there) to BYO client-host URL, so that we can hook up one subscription client and have many client-ui instances interact with it.</p>\n<p>Let me know what you think!</p>",
        "id": 251915103,
        "sender_full_name": "adam strickland",
        "timestamp": 1630689960
    },
    {
        "content": "<p>Looking forward to this connectathon.  To prepare I tried to test with <a href=\"http://subscriptions.argo.run\">subscriptions.argo.run</a>, R5, and I can't tell if it's working.  I get \"Failed to connect to FHIR server\" and a 404 on <a href=\"https://server.subscriptions.argo.run/r5/metadata\">https://server.subscriptions.argo.run/r5/metadata</a> in the browser console.   If anyone has any suggestions, let me know.</p>",
        "id": 251947432,
        "sender_full_name": "Dan Tripp",
        "timestamp": 1630706301
    },
    {
        "content": "<p>Awesome <span class=\"user-mention\" data-user-id=\"437700\">@Dan Tripp</span>! (Thanks for the bug report with the R5 endpoint. And just to make sure you've seen them, keep in mind that our <a href=\"https://confluence.hl7.org/display/FHIR/2021-09+Subscriptions#id-202109Subscriptions-SystemRoles\">connectathon scenarios</a> will be focused on on R4 + \"Subscriptions backport\" rather than R5.)</p>",
        "id": 251949445,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1630707684
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"372206\">@adam strickland</span>  I'm fine with having something written up, but I believe it's a bit late to change the official scenarios for the connectathon.  That said, I'm happy to help flesh out the scenario and see what can be done (next week =).</p>\n<p><span class=\"user-mention\" data-user-id=\"437700\">@Dan Tripp</span> Thanks for bringing it up!  As Josh mentioned, we're focusing primarily on R4 but I do want to ensure that R5 is up and running.  I'll look into the error either over the weekend or early next week.</p>\n<p>Cheers!</p>",
        "id": 251950807,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1630708646
    },
    {
        "content": "<p>Very good - I'll focus on the backport.  Great videos, <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span></p>",
        "id": 252328995,
        "sender_full_name": "Dan Tripp",
        "timestamp": 1631030764
    },
    {
        "content": "<p>I was working on the backport today and had some success, then hit a snag.  It looks like I get a handshake okay, but then no notifications.  I've attached a curl session of what I did.  I welcome any advice, as it would put me in a better position for the start of the connectathon.</p>\n<p>Naturally my server side doesn't show up in this curl transcript.  But I saw in my server logs that I got a handshake.  I configured my server to return a 200 status for it and an empty response body.</p>\n<p><a href=\"/user_uploads/10155/XyJSzcxaAzOJDdyvYrrpA9Sc/curl-session.txt\">curl-session.txt</a></p>",
        "id": 252379002,
        "sender_full_name": "Dan Tripp",
        "timestamp": 1631052784
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"437700\">@Dan Tripp</span> , just wanted to ping here since investigation is taking longer than I expected (was hoping to just post 'done' =).  On the plus side, I found a gap in tooling that I'm working on right now.  Once that's done, I assume it will be fairly quick to diagnose.</p>\n<p>Just wanted to post something so you knew I was working on it.</p>",
        "id": 252472656,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631112311
    },
    {
        "content": "<p>Great!  Keep me posted.</p>",
        "id": 252505314,
        "sender_full_name": "Dan Tripp",
        "timestamp": 1631124073
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"437700\">@Dan Tripp</span> , I <em>think</em> I've sorted it.  The issue I found was unrelated to anything you were doing specifically - there was a problem with the encounter:subscription notification matching when subscriptions were deleted.  When it ran into that issue, notifications for any subscription 'behind' the deleted one would never be sent.  I believe this matches the behavior you were seeing (e.g., some number of notifications would come through, then no more).</p>\n<p>I'm continuing to test here, but please let me know if this has you unblocked.  Thanks!</p>",
        "id": 252538680,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631137666
    },
    {
        "content": "<p>I tried it again just now and I got some notifications.  Thank you.</p>",
        "id": 252556192,
        "sender_full_name": "Dan Tripp",
        "timestamp": 1631149342
    },
    {
        "content": "<p>As a note, I'll be pushing out another update shortly - a similar behavior can occur with an active subscription that's not responding.</p>",
        "id": 252636356,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631198111
    },
    {
        "content": "<p>Hi everyone. What was the name of that Da Vinci session we were talking about as a breakout in the last meeting? Looking to join at the Connectathon.</p>",
        "id": 252697819,
        "sender_full_name": "adam strickland",
        "timestamp": 1631222347
    },
    {
        "content": "<p>The schedule is up in <a href=\"https://whova.com/portal/webapp/hlsfh_202109/\">Whova</a> (<a href=\"https://whova.com/portal/webapp/hlsfh_202109/Agenda/1910405/\">direct link to that meeting</a>), but it's 11:00 AM - 12:00 PM US Eastern time on Wednesday the 15th.</p>\n<p>We've also added a breakout with FHIRcast after that (12:00 PM US Eastern) (<a href=\"https://whova.com/portal/webapp/hlsfh_202109/Agenda/1933663\">direct link</a>).</p>\n<p>Cheers!</p>",
        "id": 252702950,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631224889
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> you have raised the damn bar ... these videos are fantastic!</p>",
        "id": 252722326,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631239646
    },
    {
        "content": "<p>I am unable to connect to my webhook endpoint here :  \"<a href=\"https://flask-pubsub-endpoint.healthedata1.co/webhook\">https://flask-pubsub-endpoint.healthedata1.co/webhook</a>\"  from <a href=\"https://subscriptions.argo.run/\">https://subscriptions.argo.run/</a> </p>\n<p>The  console error is :</p>\n<blockquote>\n<p>Access to fetch at '<a href=\"https://flask-pubsub-endpoint.healthedata1.co/webhook/api/Clients/\">https://flask-pubsub-endpoint.healthedata1.co/webhook/api/Clients/</a>' from origin '<a href=\"https://subscriptions.argo.run\">https://subscriptions.argo.run</a>' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource. If an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled.<br>\n<a href=\"http://flask-pubsub-endpoint.healthedata1.co/webhook/api/Clients/:1\">flask-pubsub-endpoint.healthedata1.co/webhook/api/Clients/:1</a> Failed to load resource: net::ERR_FAILED</p>\n</blockquote>",
        "id": 252748860,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631261552
    },
    {
        "content": "<p>Based on the error, I'd assume that you don't have CORS configured on your endpoint to allow requests from another host.  I'm adding it to my list of videos to go over, but in the meantime:</p>\n<ul>\n<li>MDN has a great detailed overview of <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS</a></li>\n<li>TLDR: for testing, it is simplest to set your service to allow any origin, any method, and any headers.<ul>\n<li>I believe you use Flask, so <a href=\"https://github.com/corydolphin/flask-cors\">Flask-CORS</a> is probably the simplest</li>\n</ul>\n</li>\n</ul>",
        "id": 252790262,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631282073
    },
    {
        "content": "<p>Still no success and looking at the console message I am  confused.... </p>\n<p>I have a REST-Hook endpoint  at <a href=\"https://flask-pubsub-endpoint.healthedata1.co/webhook\">https://flask-pubsub-endpoint.healthedata1.co/webhook</a> which can be POSTED to successfully using POSTMAN.   </p>\n<p>but the console message above refers to  a <a href=\"https://flask-pubsub-endpoint.healthedata1.co/webhook/api/Clients/\">https://flask-pubsub-endpoint.healthedata1.co/webhook/api/Clients/</a>' .  There is no ~/api/Clients endpoint.  and when I check the logs on my end:</p>\n<p>.....\"GET /webhook/api/Clients/ HTTP/1.1\" 404 232 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36\" \"24.5.96.202\" response-time=0.001</p>\n<p>What are the expectations for an externally hosted endpoint using the demo app?</p>",
        "id": 252868076,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631319685
    },
    {
        "content": "<p>Alright <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> , I figured out what is happening.  You have been putting your endpoint URL into the client-host setting field (that field is used for internal configuration - it's only present in case someone has cloned the repos and is running it somewhere else).<br>\nSo, I just pushed up a new version.</p>\n<ul>\n<li>moved that configuration field to 'advanced settings'</li>\n<li>added a new tab 'Patient+REST Endpoint' specifically for testing a new endpoint in the scenario.  I'll try to record a walkthrough of the changes tomorrow, but it just asks for your endpoint URL when adding the subscription.</li>\n</ul>\n<p>It doesn't have anything in the way of validation yet, but I plan to work on it more tomorrow.</p>\n<p>Otherwise, you can also setup a subscription with <code>External REST Hook</code> in the <code>Playground</code> tab to work with your endpoint.  The main test area can't work with external endpoints since it won't have any idea if the notifications are happening.  I <em>may</em> try to add more of that type of info tomorrow as well (e.g., by querying the subscription status and displaying that), but this should provide a nice path in the meantime.</p>\n<p>Hope this helps, cheers!</p>",
        "id": 253023576,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631494160
    },
    {
        "content": "<p>the Playground works but I get this for the Patient + REST Server tab...</p>",
        "id": 253130381,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631554919
    },
    {
        "content": "<p>\"invalid endpoint URL... must start with http:// or https:// ...\"</p>",
        "id": 253131243,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555284
    },
    {
        "content": "<p>my endpoint is<code>https://flask-pubsub-endpoint.healthedata1.co/webhook</code></p>",
        "id": 253131279,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555307
    },
    {
        "content": "<p>when I click on the Create Subscription button...</p>",
        "id": 253131345,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555342
    },
    {
        "content": "<p>Odd - that is working for me.  You need to be in the <code>Patient+REST Endpoint</code> tab (I believe you are, since that's the only place you can see that error).  Then you need to put your endpoint url in the top text box of the <code>Request a Subscription on the FHIR Server</code> card.</p>",
        "id": 253131570,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631555432
    },
    {
        "content": "<p>The workflow I remember and what I was going for was:<br>\n to searching for the subscriptions available: </p>\n<p><a href=\"/user_uploads/10155/eKSFo5pp5BYurOFx8lG0MC2l/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/eKSFo5pp5BYurOFx8lG0MC2l/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/eKSFo5pp5BYurOFx8lG0MC2l/image.png\"></a></div>",
        "id": 253131724,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555513
    },
    {
        "content": "<p>.. and then suscribe from an external app...</p>\n<p><a href=\"/user_uploads/10155/1Z7Q2TaMAJaI7jUk3mEP-M_T/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/1Z7Q2TaMAJaI7jUk3mEP-M_T/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/1Z7Q2TaMAJaI7jUk3mEP-M_T/image.png\"></a></div>",
        "id": 253131878,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555570
    },
    {
        "content": "<p>then set up argo run rest endpoint to send the notification to external endpoint....</p>\n<p><a href=\"/user_uploads/10155/jloXKLPe31ieeYMoEYoqiCbS/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/jloXKLPe31ieeYMoEYoqiCbS/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/jloXKLPe31ieeYMoEYoqiCbS/image.png\"></a></div>",
        "id": 253132001,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555638
    },
    {
        "content": "<p>I swear this worked in May and before...???</p>",
        "id": 253132089,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555661
    },
    {
        "content": "<p>Do you want to hop on a quick call?</p>",
        "id": 253132116,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631555674
    },
    {
        "content": "<p>sure</p>",
        "id": 253132161,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631555694
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> , I've added the ability to search for an existing subscription in both <code>Patient+REST Endpoint</code> and the <code>Playground</code> tabs.  I'm continuing to work on the actual subscription search, but it should let you unblock and keep working for now.</p>\n<p>For example, to use the search in <code>Patient+REST Endpoint</code>, just skip down to the <code>Search</code> button in the <code>Request a Subscription on the FHIR Server</code> card.  It will bring up an overlay to search in (right now the server doesn't advertise any search parameters on Subscription, so the dropdown is empty and it looks odd), click <code>Search</code> in the overlay to show a list of subscriptions on the server, select one and click <code>Use Selected Subscription</code>.  From there, you should be able to post Encounters and have them show up at your endpoint.</p>\n<p>I'm adding search advertising to the server next so that the dropdown will have values and allow quick searching on ID / endpoint / etc., but not sure how long that will take.</p>\n<p>Please test and let me know.  Cheers!</p>",
        "id": 253154951,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631564852
    },
    {
        "content": "<p>As a note, I've restarted the proxy server, so any existing subscriptions will have been wiped.  It's updated to include some search parameters on Subscription and a fix for R5.</p>",
        "id": 253169839,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631571763
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"222054\">Gino Canessa</span> <a href=\"#narrow/stream/179229-subscriptions/topic/Connectathon.2028.20-.20September.202021/near/253169839\">said</a>:</p>\n<blockquote>\n<p>As a note, I've restarted the proxy server, so any existing subscriptions will have been wiped.  It's updated to include some search parameters on Subscription and a fix for R5.</p>\n</blockquote>\n<p>So that's why my subscription disappeared between 18:21:19 and 18:22:33 today!</p>",
        "id": 253178475,
        "sender_full_name": "Dan Tripp",
        "timestamp": 1631577462
    },
    {
        "content": "<p>need to change title in pop up to say \"Search and Select Subscripion\"</p>\n<p><a href=\"/user_uploads/10155/Dgl0-lLvgS4MbdrpZymGQWxX/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/Dgl0-lLvgS4MbdrpZymGQWxX/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/Dgl0-lLvgS4MbdrpZymGQWxX/image.png\"></a></div>",
        "id": 253204553,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631601338
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span>  works as advertised and thanks,</p>\n<p><a href=\"/user_uploads/10155/L2w3uM_5ojjUwOlu4f0aGdZl/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/L2w3uM_5ojjUwOlu4f0aGdZl/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/L2w3uM_5ojjUwOlu4f0aGdZl/image.png\"></a></div>",
        "id": 253207044,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631603170
    },
    {
        "content": "<p>Would be nice to be able to tap into the FHIR reference servers to search for patients  :-)</p>",
        "id": 253207308,
        "sender_full_name": "Eric Haas",
        "timestamp": 1631603362
    },
    {
        "content": "<p>Great! We can post whatever patients we want.  And given that the reference servers are down, I think it was worth the effort to move away from them. <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 253237978,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631620908
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span>  We are trying to connect to <a href=\"https://subscriptions.argo.run/\">https://subscriptions.argo.run/</a>, and we get handshake failure as response, is there any certificate missing for the same???</p>",
        "id": 253369794,
        "sender_full_name": "Aravind Raghunath",
        "timestamp": 1631688355
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"197721\">@Aravind Raghunath</span> , could you provide a bit more information about the error you are seeing?</p>",
        "id": 253423763,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631716265
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span>  <a href=\"/user_uploads/10155/kGbZei5SjK2IYqLzig9BI-dr/logs.txt\">logs.txt</a> <br>\nPlease find attached the log file that we were able to capture for the handshake failure</p>",
        "id": 253442604,
        "sender_full_name": "Aravind Raghunath",
        "timestamp": 1631722746
    },
    {
        "content": "<p>Ahh, <a href=\"https://subscriptions.argo.run\">https://subscriptions.argo.run</a> is the URL for a web UI to interact with a system.  If you want a REST endpoint to test against, you can:</p>\n<ul>\n<li>go to that web page</li>\n<li>navigate to the <code>Playground</code> tab</li>\n<li>On the <code>Client / Host - REST Endpoint Interactions</code> card, click <code>Create New REST Endpoint</code></li>\n</ul>\n<p>The URL in the Info box (last line, will start with <a href=\"https://client.subscriptions.argo.run/\">https://client.subscriptions.argo.run/</a>...) is a REST Endpoint you can post notifications to.  Received notifications will appear in the first box of the page (<code>Subscription Notifications</code>).</p>\n<p>edit: or, if you are trying to talk to a FHIR server with subscriptions implemented, you can connect to <a href=\"https://server.subscriptions.argo.run/r4\">https://server.subscriptions.argo.run/r4</a> or <a href=\"https://server.subscriptions.argo.run/r5\">https://server.subscriptions.argo.run/r5</a> .</p>",
        "id": 253463794,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631730270
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> , I was facing the same issue when doing the Notifications. Overall, we did attempted few use cases, I'm attaching details if you may want to use it for tracking...Session were really helpful, we will try to polish our implementation with whatever we collected from this gathering.</p>",
        "id": 253495404,
        "sender_full_name": "Anurag Dongre",
        "timestamp": 1631743644
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/xoQ62VpZhRPZzir-zPPI2zKI/Connectathon_Subscription_Exercise.docx\">Connectathon_Subscription_Exercise.docx</a></p>",
        "id": 253495540,
        "sender_full_name": "Anurag Dongre",
        "timestamp": 1631743693
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"439743\">@Anurag Dongre</span> !  I appreciate all the effort.  If you need anything else, please don't hesitate to reach out.</p>",
        "id": 253496454,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1631744204
    }
]