[
    {
        "content": "<p>@<strong>Brian Postlethwaite (new)</strong> , <span class=\"user-mention\" data-user-id=\"191375\">@Alexander Henket</span> , <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span>, <span class=\"user-mention\" data-user-id=\"191914\">@Danielle Friend</span>, <span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span>   - We talked about starting a connectathon track for FHIR subscriptions in Sept. Connectathon tracks should be submitted by next Wednesday. The rough proposal below limits us to only creating the resource and only sending/receiving a full FHIR resource (instead of a ping). </p>\n<p>What do you think? Are you still interested / available in working on this? Who else would be interested?</p>\n<p>Expected Participants:</p>\n<ul>\n<li>Brian Postlethwaite</li>\n<li>Alexander Henket</li>\n<li>Christiaan Knapp</li>\n<li>Ewout Kramer?</li>\n<li>?</li>\n</ul>\n<p>Roles:</p>\n<ul>\n<li>\n<p>FHIR Subscriptions server<br>\n** The FHIR Server supports the Subscription resource and pushing relevant FHIR resources to client.</p>\n</li>\n<li>\n<p>FHIR Subscribing client<br>\n** Subscribes to FHIR server and gets updates.</p>\n</li>\n</ul>\n<p>Scenarios:</p>\n<ul>\n<li>\n<p>Create FHIR Subscription<br>\n** Action: Support Subscription resource writes. <br>\n** Precondition: n/a<br>\n** Success Criteria:  Client POSTs new subscription resource to FHIR server. FHIR server persists active subscription resource.<br>\n** Bonus Point: FHIR server support searching and reading Subscription resources.</p>\n</li>\n<li>\n<p>REST Hook with payload of \"payload\": \"application/fhir+json\"<br>\n** Action: Support pushing FHIR resources.<br>\n** Precondition: n/a<br>\n** Success Criteria: FHIR server pushes FHIR payload of relevant resource using REST Hook.<br>\n** Bonus point: n/a</p>\n</li>\n</ul>",
        "id": 153891705,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496174441
    },
    {
        "content": "<p>I am an expected participant. </p>",
        "id": 153891738,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496193185
    },
    {
        "content": "<p>thanks.</p>",
        "id": 153891739,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496193188
    },
    {
        "content": "<p>however this is just purely testing existing functionality, right? </p>",
        "id": 153891740,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496194132
    },
    {
        "content": "<p>I'd like to test event based subscriptions, rather than the current search based subscription</p>",
        "id": 153891741,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496194150
    },
    {
        "content": "<p>Thanks for the mention. I intend to have Vonk do this as well. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> : what do you mean by event based subscriptions? Are you referring to the Messaging part of Subscription (<a href=\"http://www.hl7.org/implement/standards/fhir/subscription.html#2.46.6.4\" target=\"_blank\" title=\"http://www.hl7.org/implement/standards/fhir/subscription.html#2.46.6.4\">http://www.hl7.org/implement/standards/fhir/subscription.html#2.46.6.4</a>) ?</p>",
        "id": 153891786,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1496239832
    },
    {
        "content": "<p>I am also interested to see whether longer running subscriptions are useful without means of communicating that a resource has 'left' the criteria because it was deleted or updated in a way that it no longer matches the criteria. I bring this up because adding this to the handling of subscriptions might complicate the implementation. Is anyone interested in trying to make this work (not sure we have enough time to do so).</p>",
        "id": 153891787,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1496240002
    },
    {
        "content": "<p>in Madrid, we spoke about changing the way the criteria from 'when a search set changes' - which has the problem you just identified, and other implementation issues, to an event based approach where you write some criteria (fhirpath, probably) against previous + current in order to define which events you want to know about </p>",
        "id": 153891826,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496262612
    },
    {
        "content": "<p>I'd like to implement that, using an extension on the Subscription resource</p>",
        "id": 153891827,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496262632
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span> <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span> <span class=\"user-mention\" data-user-id=\"191914\">@Danielle Friend</span> <span class=\"user-mention\" data-user-id=\"191375\">@Alexander Henket</span> <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> any one has any specific proposals for connectathon scenarios?</p>",
        "id": 153892715,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496867304
    },
    {
        "content": "<p>Grahame - I'm working on somenow now (at the last minute). </p>\n<p>An extension to the Subscription resource that supports events/topics could look like this: </p>\n<p>\"criteria\": \"Patient/123\",<br>\n\"extension\": {[<br>\n    \"url\": \"<a href=\"http://hl7.org/fhir/subscription/topics\" target=\"_blank\" title=\"http://hl7.org/fhir/subscription/topics\">http://hl7.org/fhir/subscription/topics</a>\",<br>\n    \"valueCode\": {<br>\n        \"value\": \"admit\",<br>\n        \"display\": \"patient admitted\",<br>\n        \"system\" : \"<a href=\"https://www.hl7.org/fhir/subscriptions/topics\" target=\"_blank\" title=\"https://www.hl7.org/fhir/subscriptions/topics\">https://www.hl7.org/fhir/subscriptions/topics</a>\"<br>\n    }<br>\n]<br>\n}</p>",
        "id": 153892762,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496872549
    },
    {
        "content": "<p>I think that it would be important for the FHIR server to inform the subscribing client of the event/topic that occurred, so I'm not sure that an empty POST message would be enough. The full payload method would be straightforward, though.</p>",
        "id": 153892763,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496872692
    },
    {
        "content": "<p>I think it would be a full payload, yes</p>",
        "id": 153892781,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496878797
    },
    {
        "content": "<p>but I have no idea what your fragment above does</p>",
        "id": 153892782,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496878810
    },
    {
        "content": "<p>Grahame, what would your extension look like? <br>\nMy understanding of Isaac's is that it would allow for servers and clients to subscribe to a known list of discrete events very simply and direct, because it has more structure. Yours would be less structured and would allow for any event/change that you could dream up. <br>\nDoes that seem like an accurate comparison? In Isaac's example of an event=admit, Grahame, how would you represent such a request to subscribe to patient admissions?</p>\n<p>All that to say, this seems like a really interesting track, and a good place to see both approaches in action.</p>",
        "id": 153892783,
        "sender_full_name": "Danielle Friend",
        "timestamp": 1496878870
    },
    {
        "content": "<p>so the logic is implicit in Isaac's proposal? that has both advantages and disadvantages. </p>",
        "id": 153892784,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496879066
    },
    {
        "content": "<p>as far as subscribing to patient admissions, what does that actually mean? Once we have figured out what that actually means, then I would be able to think about how I would represent that. </p>",
        "id": 153892785,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496879173
    },
    {
        "content": "<p>does it mean 'let me know about all inpatient episode changes'?</p>",
        "id": 153892786,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496879188
    },
    {
        "content": "<p>&lt;didn't reply in the right place!&gt;<br>\nSure, I think a maybe more common example would be - let me know when a patient is admitted to this department.<br>\nSuch as the ED department</p>",
        "id": 153892789,
        "sender_full_name": "Danielle Friend",
        "timestamp": 1496879546
    },
    {
        "content": "<p>Right. I think that we should make events very discrete and the FHIR server simply describes the list of events that it supports.  </p>\n<p>Here's the above extension fragment in a full FHIR subscription resource:</p>\n<p>Example subscription resource with proposed extension:<br>\n{<br>\n  \"resourceType\": \"Subscription\",<br>\n  \"criteria\": \"Patient/123\",<br>\n  \"extension\": {[<br>\n\"url\": \"<a href=\"http://hl7.org/fhir/subscription/topics\" target=\"_blank\" title=\"http://hl7.org/fhir/subscription/topics\">http://hl7.org/fhir/subscription/topics</a>\",<br>\n\"valueCode\": {<br>\n\"value\": \"admit\",<br>\n\"display\": \"patient admitted\",<br>\n\"system\" : \"<a href=\"https://www.hl7.org/fhir/subscriptions/topics\" target=\"_blank\" title=\"https://www.hl7.org/fhir/subscriptions/topics\">https://www.hl7.org/fhir/subscriptions/topics</a>\"<br>\n}<br>\n     ]<br>\n  }<br>\n  \"channel\": {<br>\n    \"type\": \"rest-hook\",<br>\n    \"endpoint\": \"<a href=\"https://biliwatch.com/customers/mount-auburn-miu/on-result\" target=\"_blank\" title=\"https://biliwatch.com/customers/mount-auburn-miu/on-result\">https://biliwatch.com/customers/mount-auburn-miu/on-result</a>\",<br>\n    \"payload\": \"application/fhir+json\"<br>\n  }<br>\n}</p>",
        "id": 153892791,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496879685
    },
    {
        "content": "<p>well, here's the explicit version: </p>",
        "id": 153892792,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496879928
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>{\n  &quot;resourceType&quot;: &quot;Subscription&quot;,\n  &quot;id&quot;: &quot;example&quot;,\n  &quot;status&quot;: &quot;requested&quot;,\n  &quot;reason&quot;: &quot;Monitor all admissions to Emergency&quot;,\n  &quot;criteria&quot;: &quot;Encounter?&quot;,\n  &quot;extension&quot; : [{\n    &quot;url&quot; : &quot;http://healthintersections.com.au/fhir/subscription-event-filter&quot;,\n    &quot;valueString&quot; : &quot;(current | previous).location.where(location = &quot;Location/emergency&quot; and status in [&#39;active&#39;, &#39;completed&#39;] ).exists()&quot;\n  }]\n  &quot;channel&quot;: {\n    &quot;type&quot;: &quot;rest-hook&quot;,\n    &quot;endpoint&quot;: &quot;https://biliwatch.com/customers/mount-auburn-miu/on-result&quot;,\n    &quot;payload&quot;: &quot;application/fhir+json&quot;,\n    &quot;header&quot;: [\n      &quot;Authorization: Bearer secret-token-abc-123&quot;\n    ]\n  }\n}\n</pre></div>",
        "id": 153892793,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496879928
    },
    {
        "content": "<p>making the events very discrete, so the server can limit what it offers makes for less work on the server, but restricts the client's capabilities greatly</p>",
        "id": 153892794,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496879986
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> does CQL have a suitable resource for defining a set of event triggers so that we can have our cake and eat it too? or do we need an EventDefinition resource?</p>",
        "id": 153892796,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496880444
    },
    {
        "content": "<p>Hey Grahame, your FHIRPath extension seems to be modeling a search criteria more than an event. I think that an event is a name for a thing that happens in the world, or at least in a user's workflow.</p>\n<p>The FHIRPath approach is, at best, a language for modeling events.</p>\n<p>No doubt you're right that not giving the client a flexible language for defining eventsrestricts their abilities, but it's too large of a burden on the server. In practice, we'd have to severely limit the FHIRPath that we supported to map to a set of pre-defined clinical events. Exposing the actual events, in a standard way is more transparent to the client.</p>",
        "id": 153892798,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496882241
    },
    {
        "content": "<p>'more transparent'? how? </p>",
        "id": 153892799,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496882347
    },
    {
        "content": "<p>though I agree with the impact on the server. Except that for me, the FHIRPath way is easier ;-) </p>",
        "id": 153892800,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496882387
    },
    {
        "content": "<p>and no, my approach is not a search criteria - it's something that fires on changes to encounter, and evaluates before and after</p>",
        "id": 153892801,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496882517
    },
    {
        "content": "<blockquote>\n<p>Except that for me, the FHIRPath way is easier ;-)</p>\n</blockquote>\n<p>Yeah, I caught that. :)</p>\n<p>An ED admit (or transfer or discharge) is an important thing that happens in the real world. Is this:</p>\n<blockquote>\n<p>\"valueString\" : \"(current | previous).location.where(location = \"Location/emergency\" and status in ['active', 'completed'] ).exists()\"</p>\n</blockquote>\n<p>how we should model this well known event?</p>",
        "id": 153892802,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496882726
    },
    {
        "content": "<p>well strictly, this is 'notify me of changes to encounter where the location is or was emergency, and the encounter is a real encounter (e.g. not just a plan)'</p>",
        "id": 153892803,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496882798
    },
    {
        "content": "<p>Also, I think that your approach, assumes that a clinical system is a database of FHIR resources, which isn't the case outside of middle-ware, reference implementations and other specialized HIT software.</p>",
        "id": 153892804,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496882810
    },
    {
        "content": "<p>I don't think my approach assumes that, just that there's a translation layer somewhere.</p>",
        "id": 153892805,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496882833
    },
    {
        "content": "<p>the middle ground, that there's a formal definition you can refer to, allows that translation layer to be a human</p>",
        "id": 153892806,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496882854
    },
    {
        "content": "<p>the classic v2 approach is to use hand-wavy narrative like 'An ED admit (or transfer or discharge)' and then let all the systems interpret that slightly differently, so that implementations are actually all unsafe</p>",
        "id": 153892807,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496882895
    },
    {
        "content": "<p>That's kind of compelling, but doesn't make it easy for me at all.</p>\n<p>Do you think that the same point applies to this: <a href=\"https://github.com/cds-hooks/docs/wiki/Proposed-Hooks\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/wiki/Proposed-Hooks\">https://github.com/cds-hooks/docs/wiki/Proposed-Hooks</a> ?</p>",
        "id": 153892808,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496883034
    },
    {
        "content": "<p>well, I think they need formal definitions. but it's possibly less important there because there's a human in the picture, and they are believed to be able to check the system. Back end subscriptions, you don't have  chance to find out what you don't know</p>",
        "id": 153892809,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883113
    },
    {
        "content": "<p>but inasmuch as that isn't a characteristic of many users ('the system is god') then more formal definitions will be necessary</p>",
        "id": 153892810,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883140
    },
    {
        "content": "<p>I guess I'd say that we've spend a bunch of time refining our definitions of the hand-wavy industry events for all kinds of reasons (including the support of HL7v2) and now have a pretty decent implementation.</p>",
        "id": 153892811,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496883165
    },
    {
        "content": "<p>you do. But your business rules probably differ from anyone else</p>",
        "id": 153892812,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883193
    },
    {
        "content": "<p>looking at the hook definitions, most the -view stuff is pretty straight forward. The change ones are much more challenging</p>",
        "id": 153892813,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883235
    },
    {
        "content": "<p>I was thinking that one of the use-cases for subscriptions might be \"application synchronization\", such that an event could be defined, similar to cds hooks, but on the backend. I think that a FHIRPath approach would preclude that.</p>",
        "id": 153892814,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496883355
    },
    {
        "content": "<p>why would it preclude that? </p>",
        "id": 153892815,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883378
    },
    {
        "content": "<p>Using FHIRPath assumes that the FHIR server's resources are accurately modeling the events that the FHIR subscription server is pushing to clients. For \"workflow\" type events (e.g. user opens a patient's chart), I don't see how a FHIR client could learn that such an event happened by simply performing reads against the server.</p>",
        "id": 153892816,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496883504
    },
    {
        "content": "<p>AuditEvent. If you surface that, that is</p>",
        "id": 153892817,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883531
    },
    {
        "content": "<p>but what I am proposing specifically is that we have a list of events, back them with a formal definition, an d then servers are free to use the formal definition directly if they can, else they implement, but conformance would be tested against the formal definition</p>",
        "id": 153892818,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883604
    },
    {
        "content": "<p>Okay. </p>\n<p>What does the FHIR client specify when creating the subscription? </p>",
        "id": 153892819,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496883664
    },
    {
        "content": "<p>reference to the definition, or maybe include the definition as a contained resource? Need to talk to Bryn to see if there is already something existing? but I don't think there is. Just some infrastructure. That would mean creating an EventDefinition resource to refer to, and then we could consider doing formal definitions for the cds-hooks events as well</p>",
        "id": 153892821,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883824
    },
    {
        "content": "<p>Alright. I can eventually implement that. </p>\n<p>What are the next steps for a connectathon track? I'd like to keep the goals as simple and pragmatic as possible.</p>",
        "id": 153892822,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496883941
    },
    {
        "content": "<p>and for the connectation, you'd have:</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;resourceType&quot;: &quot;Subscription&quot;,\n  &quot;criteria&quot;: &quot;n/a&quot;,\n  &quot;extension&quot;: {[\n    &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/subscription-event&quot;,\n    &quot;valueUri&quot;: &quot;http://hl7.org/fhir/EventDefinition/admit&quot;\n  }],\n  &quot;channel&quot;: {\n    &quot;type&quot;: &quot;rest-hook&quot;,\n    &quot;endpoint&quot;: &quot;https://biliwatch.com/customers/mount-auburn-miu/on-result&quot;,\n    &quot;payload&quot;: &quot;application/fhir+json&quot;\n  }\n}\n</pre></div>",
        "id": 153892823,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496883963
    },
    {
        "content": "<p>if we liked it after the connectathon, I'd propose making event a normal property of Subscription. </p>",
        "id": 153892824,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884024
    },
    {
        "content": "<p>Yes, definitely.</p>",
        "id": 153892825,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884047
    },
    {
        "content": "<p>let's see what I come up with Bryn before we decide which way to go</p>",
        "id": 153892826,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884092
    },
    {
        "content": "<p>though the formal deadline for connectathon proposals was today, we only had about half of them so we extended</p>",
        "id": 153892827,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884119
    },
    {
        "content": "<p>Oh good. </p>",
        "id": 153892828,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884132
    },
    {
        "content": "<p>Till when?</p>",
        "id": 153892829,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884137
    },
    {
        "content": "<p>forget. Another week? not sure</p>",
        "id": 153892830,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884148
    },
    {
        "content": "<p>I talk to Bryn fairly often, I can ask him about his thoughts on an EventDefinition resource, modify the track proposal and post it here by ... Monday.</p>",
        "id": 153892831,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884203
    },
    {
        "content": "<p>ok great</p>",
        "id": 153892832,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884213
    },
    {
        "content": "<p>thanks, Grahame.</p>",
        "id": 153892833,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884228
    },
    {
        "content": "<p>I think it would find wider use -  from MessageDefinition, from CapabilityStatement, for cds-hooks, and in the security stuff maybe. Unless all those are pushed into Subscription</p>",
        "id": 153892834,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884303
    },
    {
        "content": "<p>I see subscriptions as FHIR's backend pub sub model and CDS Hooks as limited and very targeted remote, user-facing, real-time, cds. </p>",
        "id": 153892835,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884391
    },
    {
        "content": "<p>it might not possible to use the same language to describe the front end hooks. but I suspect some formal language will be required</p>",
        "id": 153892836,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884443
    },
    {
        "content": "<p>mapping the ad-hoc, CDS Hooks defined hooks into an EventDefinition resource would be a elegant way to formalize the definitions of these hooks for systems/people that needed/wanted that formalization if it didn't impact the straightforward usabilility of the CDS Hooks spec.</p>",
        "id": 153892837,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884592
    },
    {
        "content": "<p>we certainly don't want to impact that. But getting the hook definitions and implementation consistent will inevitably be a tax on the implementers, in that they will actually have to get it right. </p>",
        "id": 153892838,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884652
    },
    {
        "content": "<p>this is the sort of thing that the spec can't drive, though - it can make it possible to correctly know what implementing a hook correctly means, but only the market can make it worth while actually getting it right</p>",
        "id": 153892839,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884702
    },
    {
        "content": "<p>Yeah, i think this issue is making your point about consistency and accuracy: <a href=\"https://github.com/cds-hooks/docs/issues/39\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/39\">https://github.com/cds-hooks/docs/issues/39</a></p>",
        "id": 153892840,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1496884785
    },
    {
        "content": "<p>y</p>",
        "id": 153892841,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496884982
    },
    {
        "content": "<p>We used to have a TriggerDefinition data type, but we only used it one place (in PlanDefinition), so we collapsed back to just an element there. But I've often thought that the Subscription could make use of the same information.</p>",
        "id": 153892846,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888138
    },
    {
        "content": "<p>It would be pretty easy to take the TriggerDefinition components and turn that into a datatype and then a resource that could use it.</p>",
        "id": 153892847,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888176
    },
    {
        "content": "<p>it's already a data type</p>",
        "id": 153892848,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496888226
    },
    {
        "content": "<p>but the definition is very weak. we'd have to beef it up considerably</p>",
        "id": 153892849,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496888237
    },
    {
        "content": "<p>the event timin part - is that relevant for a subscription? </p>",
        "id": 153892850,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496888274
    },
    {
        "content": "<p>and you can only filer by codes or date?</p>",
        "id": 153892851,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496888304
    },
    {
        "content": "<p>Yes, it's intentionally restricted to simplify implementation.</p>",
        "id": 153892852,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888325
    },
    {
        "content": "<p>It basically maps to a B-Tree for codes and dates.</p>",
        "id": 153892853,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888336
    },
    {
        "content": "<p>You can express anything you need to on top of that with a query, but by restricting the requirement to that, you simplify the implementation.</p>",
        "id": 153892854,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888369
    },
    {
        "content": "<p>That's the data access layer for a CQL engine.</p>",
        "id": 153892855,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888383
    },
    {
        "content": "<p>that simplification doesn't work for subscription, though</p>",
        "id": 153892856,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496888417
    },
    {
        "content": "<p>Not sure about the timing part, it'd be cool, I guess, you could effectively turn any FHIR server into a scheduling service :)</p>",
        "id": 153892857,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888449
    },
    {
        "content": "<p>I agree it doesn't give you as formal a description as your wanting for the events (in terms of detecting a change), you'd have to provide that in addition, or maybe as another kind of trigger?</p>",
        "id": 153892858,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888536
    },
    {
        "content": "<p>anyway, where we stand is, there isn't an existing resource for the task, but there is an existing data type that is useful, but not complete for the prupose</p>",
        "id": 153892859,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496888539
    },
    {
        "content": "<p>So should I put together an EventDefinition resource proposal that covers the current plus this more complete use case (fully formal description of the event)?</p>",
        "id": 153892860,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1496888862
    },
    {
        "content": "<p>sure, why not? we can argue about that...</p>",
        "id": 153892864,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1496889203
    },
    {
        "content": "<p>Not sure how many '...Definition' resource types we should create. And that made me think about what we actually want to reuse. <br>\nAs for DataRequirement: Would it be possible to capture the dateFilter and codeFilter of DataRequirement in fhirpath as well? <br>\nAnd if so, I was thinking of a way to do reuse with fhirpath expressions, that can have a name (or probably a uri). </p>\n<p>These named fhirpath expressions could then be used for:<br>\n- defining triggers<br>\n- maybe defining _elements, or parts of a GraphDefinition<br>\n- expressing support for events in a CapabilityStatement (e.g. Isaac will support the event with the fhirpath named 'patient admittance')<br>\n- optimizing implementation (e.g. for triggers or searches that happen very often)</p>\n<p>Generic fhir servers like Grahame's, HAPI and Vonk will probably use the expression that goes with the name, but fhir interfaces on specific systems could just use the name and implement it 'hard coded' based on the meaning (that is still defined by the expression). </p>",
        "id": 153893253,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1497270001
    },
    {
        "content": "<blockquote>\n<p>Not sure how many '...Definition' resource types we should create. And that made me think about what we actually want to reuse.</p>\n</blockquote>\n<p>Hey <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> , Totally agree that there are a number of uses for eventdefinitions.  </p>",
        "id": 153893270,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1497280393
    },
    {
        "content": "<p>How are they created?<br>\n1) For heavily prototyped use-cases, we should publish implementation guides around  standardly named events and standardly defined fhirpath statements.  </p>\n<p>2) A subscription client should be able to create a new EventDefinition on the server (if the server supports that) and then subscribe to that recently defined event.</p>\n<p>3) A subscriptions FHIR server should publish the EventDefinitions that it supports. </p>",
        "id": 153893271,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1497280404
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , All, </p>\n<p>Given an EventDefinition resource as discussed by Bryn and Grahame, here's a sample Subscription resource with an extension that points to an event:</p>\n<p>Example subscription resource with proposed extension:<br>\n{<br>\n  \"resourceType\": \"Subscription\",<br>\n  \"criteria\": \"Patient/123\",<br>\n  \"extension\": {[<br>\n    \"url\": \"<a href=\"http://hl7.org/fhir/subscription/topics\" target=\"_blank\" title=\"http://hl7.org/fhir/subscription/topics\">http://hl7.org/fhir/subscription/topics</a>\",<br>\n    \"valueReference\": {<br>\n        \"reference\": \"<a href=\"https://example.com/EventDefinition/123\" target=\"_blank\" title=\"https://example.com/EventDefinition/123\">https://example.com/EventDefinition/123</a>\",<br>\n        \"display\": \"patient admitted\",<br>\n    }<br>\n     ]<br>\n  }<br>\n  \"channel\": {<br>\n    \"type\": \"rest-hook\",<br>\n    \"endpoint\": \"<a href=\"https://biliwatch.com/customers/mount-auburn-miu/on-result\" target=\"_blank\" title=\"https://biliwatch.com/customers/mount-auburn-miu/on-result\">https://biliwatch.com/customers/mount-auburn-miu/on-result</a>\",<br>\n    \"payload\": \"application/fhir+json\"<br>\n  }<br>\n}</p>",
        "id": 153893276,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1497289449
    },
    {
        "content": "<p>And a connectrathon track proposal: </p>\n<p>Submitting WG/Project/Implementor Group<br>\n    • FHIR-I</p>\n<p>Justification<br>\nThe current FHIR Subscriptions spec is based around the idea that a clinical system uses FHIR resources as its native database format and executes subscribed FHIR queries against every resource as it's created or modified. This would work well for custom built middleware and FHIR reference implementations, but generally not for systems that implement clinical workflow.</p>\n<p>I think that most clinical systems, mine included, are event-based. An implementable subscription criteria would rather be based on an event and then narrowed to specific attributes/criteria.</p>\n<p>The subscription pub/sub pattern enables FHIR clients to retrieve data from a server without performing a more expensive periodic polling queries. This model also enables workflow event-based notifications that could keep two applications data in sync, but also synchronize their context. There's no lightweight, widely implemented CCOW-type application synchronization standards available to developers. There's some interest within the RIS/PACS community to identify a common standard.</p>\n<p>This track will attempt to prototype this event-based concept on top of the existing FHIR Subscription REST hook and criteria element. Further, as a stretch goal, this connectathon will attempt to prototype this workflow synchronization using FHIR Subscriptions.</p>\n<p>Expected Participants:</p>\n<ul>\n<li>Brian Postlethwaite</li>\n<li>Alexander Henket</li>\n<li>Christiaan Knapp</li>\n<li>Grahame Grieve</li>\n<li>Will Maethner</li>\n<li>TBD PACS developers</li>\n</ul>\n<p>Roles:<br>\n    1) FHIR Subscriptions server<br>\n        a. The FHIR Server supports the Subscription resource and pushing relevant FHIR resources to client.<br>\n    2) FHIR Subscribing client<br>\n        a. Subscribes to FHIR server and gets updates.</p>\n<p>Scenarios:<br>\n1) Create FHIR Subscription<br>\n        a. Action: Support Subscription resource writes using the topic extension, as illustrated, below. <br>\n        b. Precondition: n/a<br>\n        c. Success Criteria:  Client POSTs new subscription resource to FHIR server. FHIR server persists active subscription resource.<br>\n        d. Bonus Point: FHIR server support searching and reading Subscription resources. </p>\n<p>2) REST Hook with payload of \"payload\": \"application/fhir+json\"<br>\n        a. Action: Support pushing FHIR resources.<br>\n        b. Precondition: n/a<br>\n        c. Success Criteria: FHIR server pushes FHIR payload of relevant resource using REST Hook when the subscribed event occurs in the FHIR server.<br>\n        d. Bonus point: n/a</p>\n<p>3) Subscribe to a REST Hook of \"patientchartopen\"<br>\n        a. Action: Subscribing app creates Subscription with an extended topic that means that a patient chart was opened in the EHR FHIR server in a specific Location. FHIR Server notifies app of the patient chart that was opened.<br>\n        b. Precondition: Subscription resource support.<br>\n        c. Success Criteria: Subscribing app is notified of the event.<br>\n        d. Bonus point: FHIR server has a prototyped EventDefinition resource that defines a patient chart being opened.</p>",
        "id": 153893277,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1497289495
    },
    {
        "content": "<p>I don't follow the CCOW reference - how's that relevant? </p>",
        "id": 153893316,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497324635
    },
    {
        "content": "<p>my server is also event based even though it's natively FHIR internally btw</p>",
        "id": 153893318,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497324667
    },
    {
        "content": "<p>I'm good with the rest of the stream description - can we move it to the wiki? </p>",
        "id": 153893320,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497324719
    },
    {
        "content": "<p>and thanks</p>",
        "id": 153893321,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497324723
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> - FHIRPath is a nice way to say some things, but it's really hard to reverse engineer into 'do this to produce the right stuff' - so we should not use it where we can avoid it </p>",
        "id": 153893323,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497324769
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  - OK, so we settle for EventDefinition for now, without FHIRPath.<br>\nTrack proposal looks good. Only thing I don't know is how I would recognize that 'a patient chart was opened in the EHR' in a generic FHIR server. Does that result in an AuditEvent? In other words: on what criteria would I then send a notification? Or should I ignore this one, since Vonk is not an EHR?</p>",
        "id": 153893343,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1497341457
    },
    {
        "content": "<p>As for CCOW: that was designed for tracking and syncing <em>state</em>, whereas I see subscription being designed for tracking and syncing <em>data</em>. Track part 3) seems also to be about syncing <em>state</em>. It may turn out to be confusing to have these two concepts supported by one solution (Subscriptions), if we even manage to make it work.</p>",
        "id": 153893344,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1497341882
    },
    {
        "content": "<p>Actually, we were thinking of an EventDefinition that used FHIRPath, just not exclusively. So a named event, but that has an expression as a FHIRPath change detection.</p>",
        "id": 153893577,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1497384672
    },
    {
        "content": "<p>At least, that's the EventDefinition I'm currently building.</p>",
        "id": 153893578,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1497384722
    },
    {
        "content": "<p>I think that makes sense. Say what you can say in a structured form, and say the rest using an expression</p>",
        "id": 153893622,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497394072
    },
    {
        "content": "<p>that's my preference. </p>",
        "id": 153893623,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497394077
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> , yes, we can represent a \"openpatientchart\" even with an AuditEvent. </p>",
        "id": 153893878,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1497477330
    },
    {
        "content": "<p>I'll remove the CCOW reference from the justification and try to get it posted on the connectathon wiki page (just asked webmaster@hl7 for a login).</p>",
        "id": 153893879,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1497477380
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span> let me know if there isn't a timely response on thta </p>",
        "id": 153893890,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497479082
    },
    {
        "content": "<p>This is awesome! Is there a proposed way to say \"on chart open for <em>any</em> patient\"? Would you just say \"criteria: Patient\" instead of \"criteria: Patient/123\"? Also is there an example of what an EventDefiniton would look like? I'm a little lost on that. </p>",
        "id": 153893924,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1497486448
    },
    {
        "content": "<p>we haven't put that together yet. </p>",
        "id": 153893928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1497490640
    },
    {
        "content": "<p>Here's the above example rendered in a draft EventDefinition resource: <a href=\"http://build.fhir.org/eventdefinition-example.xml.html\" target=\"_blank\" title=\"http://build.fhir.org/eventdefinition-example.xml.html\">http://build.fhir.org/eventdefinition-example.xml.html</a></p>",
        "id": 153895768,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498781849
    },
    {
        "content": "<p>it's not clear to me why the definition of an event has a time period - does the event somehow change outside that period?</p>",
        "id": 153895814,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498819837
    },
    {
        "content": "<p>I don't follow why contributers. What would it mean to be a contributer</p>",
        "id": 153895815,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498819896
    },
    {
        "content": "<p>I don't follow the use case for relatedArtifact</p>",
        "id": 153895816,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498819934
    },
    {
        "content": "<p>I don't understand the interplay between event timing and data requirement date elements</p>",
        "id": 153895817,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498820058
    },
    {
        "content": "<p>shouldn't eventCondition.language be a code bound to mime type?</p>",
        "id": 153895818,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498820079
    },
    {
        "content": "<p>that's what we've done elsehwere</p>",
        "id": 153895819,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498820087
    },
    {
        "content": "<p>what kind of languages do we anticipate here?</p>",
        "id": 153895820,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498820185
    },
    {
        "content": "<p>effectivePeriod, contributors, and relatedArtifacts are because those are common fields for knowledge resources. I questioned whether they would be applicable here or not (there's a TODO on them), but left them in for discussion. It may be that an EventDefinition is a simple enough resource that it would never need/require the types of governance and management typically associated with knowledge management.</p>",
        "id": 153895878,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498859683
    },
    {
        "content": "<p>As far as the interplay between event timing and data requirements, the eventTiming element is only used for Periodic events, and the dataRequirements element is only used for Data-Added/updated/removed events.</p>",
        "id": 153895879,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498859750
    },
    {
        "content": "<p>Yes, eventCondition.language should be bound to a mime type, I'll make that change throughout.</p>",
        "id": 153895880,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498859812
    },
    {
        "content": "<p>As far as language, we currently expect FHIRPath and CQL, but you could probably use XPath too.</p>",
        "id": 153895881,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498859827
    },
    {
        "content": "<p>I think there's a little more to say about the language. In particular, there's the idea of the delta between current and previous versions being meaningful in this context</p>",
        "id": 153895882,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498860129
    },
    {
        "content": "<p>critical, in fact</p>",
        "id": 153895883,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498860136
    },
    {
        "content": "<p>I'm not sure I have my head around periodic events. What's an example of that?</p>",
        "id": 153895884,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498860156
    },
    {
        "content": "<p>Agree on establishing that delta is available, it's effectively a data-updated event, we've just also named it, which makes me question the usefulness of the type discriminator.</p>",
        "id": 153895887,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498861268
    },
    {
        "content": "<p>For periodic events, the idea is to support scheduled items, such as \"check this lab result daily\"</p>",
        "id": 153895888,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498861313
    },
    {
        "content": "<p>I think I'm troubled by the different between the definition of what an event is, and the application of asking for event notifications. this resource seems to mix these things </p>",
        "id": 153895890,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1498862085
    },
    {
        "content": "<p>I see the Subscription resource as the one that asks for event notifications, where EventDefinition only describes what an event is. What aspects of EventDefinition are troubling?</p>",
        "id": 153895916,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1498972095
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> , All,</p>\n<p><span class=\"user-mention\" data-user-id=\"194360\">@Niklas Svenzén</span> and team spent some time at Epic, with myself and <span class=\"user-mention\" data-user-id=\"194356\">@Will Maethner</span> , last week to successfully prototype a PACS&lt;-&gt; EHR context synchronization using FHIR Subscriptions. We're continuing this testing next week and at the connectathon. </p>\n<p>We started with AuditEvent for  modeling context sync events, such as \"patient chart opened\", but quickly exceeded it. We spec'd out a new resource, UserSession, which defines a user interacting with an application, its status and the primary context for their session. This UserSession resource enables context synchronization within the existing FHIR Subscription specification. </p>\n<p>We think that this new resource , used within FHIR Subscriptions, is the best approach for a context synchronization specification in FHIR and there's active interest in making this happen.</p>\n<p>Can you guide us on the draft resource, below, and how to move forward, in general?</p>",
        "id": 153904317,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504276164
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/RyQJ-uZqYVkOUu3HdrUxsOYL/pasted-image.png\" target=\"_blank\" title=\"pasted-image.png\">pasted-image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/RyQJ-uZqYVkOUu3HdrUxsOYL/pasted-image.png\" target=\"_blank\" title=\"pasted-image.png\"><img src=\"/user_uploads/10155/RyQJ-uZqYVkOUu3HdrUxsOYL/pasted-image.png\"></a></div>",
        "id": 153904318,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504276253
    },
    {
        "content": "<p>To do more CCOW-ish user synchronization you would need a 2-phase commit / accept to change context. Is that something anyone has considered?</p>",
        "id": 153904730,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1504731539
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> , a strict CCOW context synchronization in FHIR would also require an independent context manager. It seems like a <em>relatively</em> simple post of a changed event fits into the existing subscriptions spec fairly well. </p>\n<p>I thought that your description yesterday of how outbound events could be ordered, and I think guaranteed as well applies here. What do you think?</p>",
        "id": 153904733,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504731803
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span> not sure I'm following ... my desc. from yesterday described a guaranteed ordered event stream from the server to the client which could be used to signal that (in a true CCOW-FHIR-like setup) a client would like to do something about the context</p>",
        "id": 153904735,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1504732134
    },
    {
        "content": "<p>now following a ccow setup, other clients also subscribing on the usersession would all need to somehow signal to the manager (POSTing) their acceptance and only after all had accepted the context could be changed</p>",
        "id": 153904737,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1504732282
    },
    {
        "content": "<p>Yeah, you're right. Unlike CCOW, using FHIR Subscriptions for context sync would be a dictatorship instead of democractic model.</p>\n<p>The problems with the democratic model is that the entire integration is held back to the performance of the slowest app.</p>\n<p>In practice, in our experience at least, CCOW isn't as widely implemented by a large number of similar, proprietary context sync specs. Supporting context sync functionality becaomes a massive task when we have to support many proprietary specs. </p>\n<p>We think that there's room for a simple, re-usable context synchronization specification ... perhaps even without all the features of CCOW.</p>",
        "id": 153904738,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504732540
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span> guaranteed order is not part of the existing subscription resource AFAIK. As the connection from the server to the client using a simple rest-hook is not 'dedicated/reserved/statefull' order is not necessarily guaranteed. Using a web socket or server sent events you are at least guaranteed that there will only be a single channel for you as a client that you need to look into</p>",
        "id": 153904739,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1504732554
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span> right ... dictating instead of democratizing - ... I get it. Its a more simple model which could work in a lot of cases.</p>",
        "id": 153904740,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1504732714
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span> sorry finally getting to this - I've been on the road all week travelling.</p>",
        "id": 153904935,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504841359
    },
    {
        "content": "<p>I think it's a very interesting idea, and I think that the requirements are valid</p>",
        "id": 153904936,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504841380
    },
    {
        "content": "<p>but I worry that the solution is actually out of scope for FHIR</p>",
        "id": 153904937,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504841390
    },
    {
        "content": "<p>how would you use this outside the context of synchronising a session? What's it's relationship with AuditEvent?</p>",
        "id": 153904939,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504841724
    },
    {
        "content": "<p>also, user may not correspond to a known FHIR entity. It makes us really need a User resource, which we've always avoided as truly out of scope</p>",
        "id": 153904940,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504841767
    },
    {
        "content": "<p>Good Morning Everybody!</p>\n<p>The FHIR Subscriptions table is up front, come join us if you're interested.</p>\n<p>We're having  a breakout session right after general announcements in Palatine A.</p>",
        "id": 153905158,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504973596
    },
    {
        "content": "<p>Hey Everybody, you can create a Subscription FHIR resource on Epic's prtotype here: <a href=\"https://connectathon.epic.com/Interconnect-Fhir-Basic/api/FHIR/STU3/Subscription\" target=\"_blank\" title=\"https://connectathon.epic.com/Interconnect-Fhir-Basic/api/FHIR/STU3/Subscription\">https://connectathon.epic.com/Interconnect-Fhir-Basic/api/FHIR/STU3/Subscription</a></p>\n<p>You need to authenticate with HTTP Basic auth, here's the username: \"emp$1685477\" and password \"epic77\", so a successfully HTTP Header, looks like this:</p>\n<p>User-Agent: Fiddler<br>\nContent-type: application/fhir+json<br>\nHost: <a href=\"http://connectathon.epic.com\" target=\"_blank\" title=\"http://connectathon.epic.com\">connectathon.epic.com</a><br>\nAuthorization: Basic ZW1wJDE2ODU0Nzc6ZXBpYzc3<br>\nContent-Length: 357</p>",
        "id": 153905362,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504983962
    },
    {
        "content": "<p>what topics can you use?</p>",
        "id": 153905364,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504984006
    },
    {
        "content": "<p>Here's a sample Subscription resource, that's still got some dummy content:</p>\n<p>{<br>\n    \"resourceType\": \"Subscription\",<br>\n    \"criteria\": \"Patient/123\",<br>\n    \"channel\": {<br>\n        \"type\": \"rest-hook\",<br>\n        \"endpoint\": \"<a href=\"https://biliwatch.com/customers/mount-auburn-miu/on-result\" target=\"_blank\" title=\"https://biliwatch.com/customers/mount-auburn-miu/on-result\">https://biliwatch.com/customers/mount-auburn-miu/on-result</a>\",<br>\n        \"payload\": \"application/fhir+json\"<br>\n    },<br>\n    \"id\": \"00000000007C2DCBF35FA1921026459D\",<br>\n    \"extension\": [{<br>\n        \"valueReference\": {<br>\n            \"reference\": \"<a href=\"https://example.com/EventDefinition/123\" target=\"_blank\" title=\"https://example.com/EventDefinition/123\">https://example.com/EventDefinition/123</a>\",<br>\n            \"display\": \"patient admitted\"<br>\n        },<br>\n        \"url\": \"<a href=\"http://hl7.org/fhir/subscription/topics\" target=\"_blank\" title=\"http://hl7.org/fhir/subscription/topics\">http://hl7.org/fhir/subscription/topics</a>\"<br>\n    }]<br>\n}</p>",
        "id": 153905368,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504984125
    },
    {
        "content": "<p>How about just using <a href=\"https://example.com/EventDefinition/123\" target=\"_blank\" title=\"https://example.com/EventDefinition/123\">https://example.com/EventDefinition/123</a> as the topic, for now.</p>",
        "id": 153905369,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1504984193
    },
    {
        "content": "<p>Hi all - redox is accepting new subscriptions at POST <a href=\"https://ab6b2d27.ngrok.io/fhir/Subscription/new\" target=\"_blank\" title=\"https://ab6b2d27.ngrok.io/fhir/Subscription/new\">https://ab6b2d27.ngrok.io/fhir/Subscription/new</a> <br>\nnot picky about what the topic is<br>\nAuthentication - add a <code>verification-token</code> header with a value of <code>redox</code></p>",
        "id": 153905439,
        "sender_full_name": "Nick Hatt",
        "timestamp": 1504989811
    },
    {
        "content": "<p><code>GET</code> <code>https://ab6b2d27.ngrok.io/fhir/EventDefinition</code> now works too!</p>",
        "id": 153905494,
        "sender_full_name": "Nick Hatt",
        "timestamp": 1504995275
    },
    {
        "content": "<p>yay, after several hours investigating the wrong problem, I've found the simple misconfiguration issue, and my R4 server is up at <a href=\"http://test.fhir.org/r4\" target=\"_blank\" title=\"http://test.fhir.org/r4\">http://test.fhir.org/r4</a></p>",
        "id": 153905526,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504997539
    },
    {
        "content": "<p>it does subscriptions completely (I think)</p>",
        "id": 153905527,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504997551
    },
    {
        "content": "<blockquote>\n<p>it does subscriptions completely (I think)</p>\n</blockquote>\n<p>Having trouble adding a subscription to your server.  Getting this error:</p>\n<p>\"Unable to read Document - starts with &quot;testing&quot; at Row 1 column 8\"</p>\n<p>Seems like it's expecting XML.  I'm POSTing the JSON below, with a header of Content-Type: application/json+fhir</p>\n<p>{<br>\n  \"resourceType\": \"Subscription\",<br>\n  \"meta\": {<br>\n    \"versionId\": \"agatha-1\",<br>\n    \"lastUpdated\": \"2017-06-30T14:58:58.041+00:00\"<br>\n  },<br>\n  \"text\": {<br>\n    \"status\": \"generated\",<br>\n    \"div\": \"testing\"<br>\n  },<br>\n  \"criteria\": \"Patient?family=SMITH\",<br>\n  \"reason\": \"Test subscription for Sept connectathon\",<br>\n  \"status\": \"requested\",<br>\n  \"extension\": [<br>\n    {<br>\n      \"url\": \"<a href=\"http://hl7.org/fhir/subscription/topics\" target=\"_blank\" title=\"http://hl7.org/fhir/subscription/topics\">http://hl7.org/fhir/subscription/topics</a>\",<br>\n      \"valueReference\": {<br>\n        \"reference\": \"<a href=\"https://example.com/EventDefinition/123\" target=\"_blank\" title=\"https://example.com/EventDefinition/123\">https://example.com/EventDefinition/123</a>\",<br>\n        \"display\": \"patient admitted\"<br>\n      }<br>\n    }<br>\n  ],<br>\n  \"channel\": {<br>\n    \"type\": \"rest-hook\",<br>\n    \"endpoint\": \"<a href=\"http://pinc-fhir.us-east-1.elasticbeanstalk.com/agatha/payload/patient\" target=\"_blank\" title=\"http://pinc-fhir.us-east-1.elasticbeanstalk.com/agatha/payload/patient\">http://pinc-fhir.us-east-1.elasticbeanstalk.com/agatha/payload/patient</a>\",<br>\n    \"payload\": \"application/json\",<br>\n    \"header\": \"Authorization: Bearer secret-token-abc-123\"<br>\n  }<br>\n}</p>",
        "id": 153905851,
        "sender_full_name": "Bill Harty",
        "timestamp": 1505063361
    },
    {
        "content": "<p>oops, maybe a probelm with my DIV.  let me fix that</p>",
        "id": 153905852,
        "sender_full_name": "Bill Harty",
        "timestamp": 1505063419
    },
    {
        "content": "<p>You can test Vonk's subscription feature by POSTing a subscription to <a href=\"http://vonk.furore.com/administration/Subscription\" target=\"_blank\" title=\"http://vonk.furore.com/administration/Subscription\">http://vonk.furore.com/administration/Subscription</a>. Afterwards, you can send a create/update matching the subscription to the regular FHIR endpoint at <a href=\"http://vonk.furore.com\" target=\"_blank\" title=\"http://vonk.furore.com\">http://vonk.furore.com</a> (without the /administration)</p>",
        "id": 153905853,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1505063437
    },
    {
        "content": "<p>Hey Will, here is the UserSession I just sent you:</p>\n<p>{\"resourceType\":\"UserSession\",\"id\":\"0000000000F7AE2BF35FA1921026459D\",\"action\":\"R\",\"recorded\":\"2017-08-22T19:08:18Z\",\"agent\":[{\"requestor\":\"true\",\"network\":{\"address\":\"172.17.72.98\"}}],\"source\":{\"identifier\":{\"value\":\"Epic\"}},\"entity\":[{\"identifier\":{\"value\":\"6116494\"},\"type\":{\"system\":\"http://hl7.org/fhir/resource-types\",\"code\":\"Patient\"}}]}</p>",
        "id": 153905854,
        "sender_full_name": "Niklas Svenzén",
        "timestamp": 1505063498
    },
    {
        "content": "<p>this works:</p>",
        "id": 153905861,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505063964
    },
    {
        "content": "<p>{<br>\n\"resourceType\": \"Subscription\",<br>\n\"meta\": {<br>\n\"versionId\": \"agatha-1\",<br>\n\"lastUpdated\": \"2017-06-30T14:58:58.041+00:00\"<br>\n},<br>\n\"text\": {<br>\n\"status\": \"generated\",<br>\n\"div\": \"&lt;div xmlns=\\\"http://www.w3.org/1999/xhtml\\\"&gt;testing&lt;/div&gt;\"<br>\n},<br>\n\"criteria\": \"Patient?family=SMITH\",<br>\n\"reason\": \"Test subscription for Sept connectathon\",<br>\n\"status\": \"requested\",<br>\n\"extension\": [<br>\n{<br>\n\"url\": \"<a href=\"http://hl7.org/fhir/subscription/topics\" target=\"_blank\" title=\"http://hl7.org/fhir/subscription/topics\">http://hl7.org/fhir/subscription/topics</a>\",<br>\n\"valueReference\": {<br>\n\"reference\": \"<a href=\"https://example.com/EventDefinition/123\" target=\"_blank\" title=\"https://example.com/EventDefinition/123\">https://example.com/EventDefinition/123</a>\",<br>\n\"display\": \"patient admitted\"<br>\n}<br>\n}<br>\n],<br>\n\"channel\": {<br>\n\"type\": \"rest-hook\",<br>\n\"endpoint\": \"<a href=\"http://pinc-fhir.us-east-1.elasticbeanstalk.com/agatha/payload/patient\" target=\"_blank\" title=\"http://pinc-fhir.us-east-1.elasticbeanstalk.com/agatha/payload/patient\">http://pinc-fhir.us-east-1.elasticbeanstalk.com/agatha/payload/patient</a>\",<br>\n\"payload\": \"application/json\",<br>\n\"header\": [\"Authorization: Bearer secret-token-abc-123\"]<br>\n}<br>\n}</p>",
        "id": 153905862,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505063964
    },
    {
        "content": "<p>Hey Everybody - I'm putting together our track presentation. If you're not at the table in the front and worked on FHIR Subscriptions -- will you pm me or come talk to me?</p>",
        "id": 153905870,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1505065028
    },
    {
        "content": "<blockquote>\n<p>You can test Vonk's subscription feature by POSTing a subscription to <a href=\"http://vonk.furore.com/administration/Subscription\" target=\"_blank\" title=\"http://vonk.furore.com/administration/Subscription\">http://vonk.furore.com/administration/Subscription</a>. Afterwards, you can send a create/update matching the subscription to the regular FHIR endpoint at <a href=\"http://vonk.furore.com\" target=\"_blank\" title=\"http://vonk.furore.com\">http://vonk.furore.com</a> (without the /administration)</p>\n</blockquote>\n<p>patient id = 015ce2b1-f03d-431e-a0af-473723fdd6c3</p>",
        "id": 153905886,
        "sender_full_name": "Bill Harty",
        "timestamp": 1505067086
    },
    {
        "content": "<p>Hey Everybody - you can see our Sept connectathon track presentation here: <a href=\"https://drive.google.com/open?id=0B3gH07JzlFotSDhnM1pHamlRRlU\" target=\"_blank\" title=\"https://drive.google.com/open?id=0B3gH07JzlFotSDhnM1pHamlRRlU\">https://drive.google.com/open?id=0B3gH07JzlFotSDhnM1pHamlRRlU</a></p>\n<p>Great work this weekend!</p>",
        "id": 153905963,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1505071181
    }
]