[
    {
        "content": "<p>When converting an observation from a V2 message to a FHIR resource would the Provenance resource to record what happened be something like this:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;Provenance xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n    &lt;target&gt;\n        &lt;reference value=&quot;Observation/theObservationFromMessage&quot;/&gt;\n    &lt;/target&gt;\n    &lt;recorded value=&quot;2019-03-27T21:11:24+00:00&quot;/&gt;\n    &lt;activity&gt;\n        &lt;coding&gt;\n            &lt;system value=&quot;http://terminology.hl7.org/CodeSystem/v3-DataOperation&quot;/&gt;\n            &lt;code value=&quot;CREATE&quot;/&gt;\n        &lt;/coding&gt;\n    &lt;/activity&gt;\n    &lt;agent&gt;\n        &lt;type&gt;\n            &lt;coding&gt;\n                &lt;system value=&quot;http://terminology.hl7.org/CodeSystem/provenance-participant-type&quot;/&gt;\n                &lt;code value=&quot;assembler&quot;/&gt;\n            &lt;/coding&gt;\n        &lt;/type&gt;\n        &lt;who&gt;\n            &lt;reference value=&quot;Device/theSoftwareThatConverted&quot;/&gt;\n        &lt;/who&gt;\n    &lt;/agent&gt;\n    &lt;entity&gt;\n        &lt;role value=&quot;source&quot;/&gt;\n        &lt;what&gt;\n            &lt;reference value=&quot;DocumentReference/theOriginalFile&quot;/&gt;\n        &lt;/what&gt;\n    &lt;/entity&gt;\n&lt;/Provenance&gt;\n</pre></div>\n\n\n<p>Note the use of agent.type = \"assembler\". <br>\nThis <a href=\"http://hl7.org/fhir/provenance.html#6.3.4.5\" target=\"_blank\" title=\"http://hl7.org/fhir/provenance.html#6.3.4.5\">http://hl7.org/fhir/provenance.html#6.3.4.5</a><br>\nsays to use agent.<em>role</em> of assembler, but that seems to be a value from the value set used by agent.type not agent.role.</p>\n<p>(This does relate to the recent thread <a href=\"#narrow/stream/179188-v2-\" title=\"#narrow/stream/179188-v2-\">https://chat.fhir.org/#narrow/stream/179188-v2-</a><br>\nto.20FHIR/topic/v2.20version.20in.20a.20FHIR.20resource<br>\nbut that was getting a bit muddled)</p>",
        "id": 161903521,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1553723398
    },
    {
        "content": "<p>I documented some of that discussion and my own (amateur) thoughts at <a href=\"https://confluence.hl7.org/display/OO/v2-to-FHIR+Provenance\" target=\"_blank\" title=\"https://confluence.hl7.org/display/OO/v2-to-FHIR+Provenance\">https://confluence.hl7.org/display/OO/v2-to-FHIR+Provenance</a> but they look pretty close to what you came up with. I was thinking a single \"genera transformation\" Provenance resource for the whole transform of a v2 message to a FHIR bundle, so I had .target pointing to all the resources in the bundle (although I suppose it could be the Bundle itself). I'm not sure exactly what you are doing, so just pointing to the Observation resource might work if you're picking pieces from the message. I didn't propose a value for .activity because I didn't really like any of the values for a transformation. I suppose we could extend the value set with something that better indicates a format change. Finally, I thought .agent.who might either be a Device or an Organization I think both could make sense (the Organization might be more useful to a human looking at the resource).</p>",
        "id": 161948721,
        "sender_full_name": "Craig Newman",
        "timestamp": 1553777604
    },
    {
        "content": "<p>I think .target should point at ALL of the resources that are created or updated. Some might argue that it should also point at those that were extracted and found to already exist in that current form.<br>\nHow about \"Derivation\" for the activity?  -- this is what I used in IHE for creating FHIR resources from decomposing of CDA.  <a href=\"https://github.com/IHE/fhir/blob/master/StructureDefinition/IHE_QEDm_Provenance.xml\" target=\"_blank\" title=\"https://github.com/IHE/fhir/blob/master/StructureDefinition/IHE_QEDm_Provenance.xml\">https://github.com/IHE/fhir/blob/master/StructureDefinition/IHE_QEDm_Provenance.xml</a></p>",
        "id": 161967611,
        "sender_full_name": "John Moehrke",
        "timestamp": 1553789503
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191651\">@Rik Smithies</span> can you enter a CR to fix the Provenance text in 6.3.4.5?  Indeed I think what you are doing here should be specifically mentioned in that section. It was originally written in 'theory'. We now have more to leverage. I would very much like to point at this V2 to FHIR profile in that section on the Provenance page. So would also welcome a CR to make that happen.</p>",
        "id": 161967995,
        "sender_full_name": "John Moehrke",
        "timestamp": 1553789763
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192758\">@Craig Newman</span> <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span>  thanks guys. Yes I did intend to have \"target\" point to all the converted resources. In fact my original had that - I just wanted the example to be nice and small. I found the role \"assembler\" to be strange and unintuitive, but don't have a big problem with it (I assume some precedent to it). The resources are being Created, albeit as a conversion of or derivation from  something else, so CREATE does seem right. The presence of the \"source\" entity implies its a conversion, though it's a little hard to work that out.</p>",
        "id": 162287254,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1554159776
    },
    {
        "content": "<p>John, yes I will add that CR</p>",
        "id": 162287273,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1554159792
    },
    {
        "content": "<p>Interesting point about \"refreshing\" a resource that already exists in the same form. There is no actual change in that record, but there is some provenance nevertheless, that it was again found to be the correct state (according to the new data). I think that is worth preserving.</p>",
        "id": 162287470,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1554159973
    },
    {
        "content": "<p>I've encountered an interesting case where someone processing v2 messages wanted to be able to represent an update (e.g. to patient demographic data or admission status) that was received out of order when other messages had already made it moot, so there was no update. It could be valuable information to record that the system did receive and process the message - whether that's recorded in a provenance, or resource history, or some out of band mechanism could be a tricky decision.</p>",
        "id": 162293133,
        "sender_full_name": "Paul Church",
        "timestamp": 1554166175
    },
    {
        "content": "<p>added CR <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20663\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20663\">GF#20663</a></p>",
        "id": 162471775,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1554327174
    }
]