[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192054\">@Viet Nguyen</span> <span class=\"user-mention\" data-user-id=\"196982\">@Sreekanth Puram</span> <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <span class=\"user-mention\" data-user-id=\"198783\">@Larry Decelles</span> </p>\n<p>Hi Team,</p>\n<p>We are trying to setup the RI for the Prior Authorization use case and followed the instruction provided in the attached PDF (from github) and cloned the required source codes :</p>\n<ol>\n<li>CRD Server (Java gradle).</li>\n<li>Test-EHR FHIR server(Java Gradle).</li>\n<li>Keycloak Identity Management – v9.0.3</li>\n<li>SMART on FHIR – DTR(React JS)</li>\n<li>PAS – Prior-Auth(Java gradle)</li>\n<li>CRD-Request-Generator.(React JS)</li>\n</ol>\n<p>On selecting the patient and their corresponding Device/Medication/Service requests from the available list in crd-request-generator and on submitting the request, the CRD server responses back a set of Cards.<br>\nAnd on clicking the cards, smart on fhir redirection happens and then failed in loading keycloak authentication page, because of invalid parameter in the redirect uri. Following URL is the Redirected URL generated from DTR:</p>\n<p><a href=\"http://localhost:8080/test-ehr/auth?response_type=code&amp;client_id=app-login&amp;scope=launch%20user%2FObservation.read%20user%2FPatient.read%20patient%2FObservation.read%20patient%2FPatient.read%20patient%2FCoverage.read%20patient%2FCondition.read%20user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;launch=338b46e3-b72f-4ca2-98f3-39e72dc6bc1e&amp;state=36357282\">http://localhost:8080/test-ehr/auth?response_type=code&amp;client_id=app-login&amp;scope=launch%20user%2FObservation.read%20user%2FPatient.read%20patient%2FObservation.read%20patient%2FPatient.read%20patient%2FCoverage.read%20patient%2FCondition.read%20user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;launch=338b46e3-b72f-4ca2-98f3-39e72dc6bc1e&amp;state=36357282</a></p>\n<p>I have attached the steps and error screenshot as well. Can someone please help us on this.</p>\n<p>Regards,<br>\nAritra<br>\n<a href=\"/user_uploads/10155/MD566nzochvz2rIbEd48QCEh/Setting-up-CRD_DTR_PAS-2.pdf\">Setting-up-CRD_DTR_PAS-2.pdf</a><br>\n<a href=\"/user_uploads/10155/VnZ7N3mgpfmJ137MfTD7BVqa/Steps-followed.png\">Steps-followed.png</a> <a href=\"/user_uploads/10155/bGx5yXEw3t9kywT4tzfMhrCJ/Order-Form-screen.jpg\">Order-Form-screen.jpg</a> <a href=\"/user_uploads/10155/739f67bhvj894UH70ppOaOYC/Error-Screen.jpg\">Error-Screen.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/VnZ7N3mgpfmJ137MfTD7BVqa/Steps-followed.png\" title=\"Steps-followed.png\"><img src=\"/user_uploads/10155/VnZ7N3mgpfmJ137MfTD7BVqa/Steps-followed.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/10155/bGx5yXEw3t9kywT4tzfMhrCJ/Order-Form-screen.jpg\" title=\"Order-Form-screen.jpg\"><img src=\"/user_uploads/10155/bGx5yXEw3t9kywT4tzfMhrCJ/Order-Form-screen.jpg\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/10155/739f67bhvj894UH70ppOaOYC/Error-Screen.jpg\" title=\"Error-Screen.jpg\"><img src=\"/user_uploads/10155/739f67bhvj894UH70ppOaOYC/Error-Screen.jpg\"></a></div>",
        "id": 237471582,
        "sender_full_name": "Aritra Kundu",
        "timestamp": 1620210031
    },
    {
        "content": "<p>That's a strange error.  There might be a more descriptive log of what went wrong in the keycloak logs/console output.  The redirect URI looks fine, so unless the “valid redirect URI” property was changed in the app-login client in keycloak it should work.  The easiest way to debug this would be to:</p>\n<p>1) Send any errors in the keycloak log<br>\n2) Send the EHR console output for the login attempt, specifically the chunk that starts with “redirectUrl:”</p>",
        "id": 237516473,
        "sender_full_name": "Keeyan Ghoreshi",
        "timestamp": 1620228808
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"247235\">Aritra Kundu</span> <a href=\"#narrow/stream/259713-Da-Vinci.20Burden.20Reduction.20interoperability/topic/Prior.20Authorization.20RI.20setup.20error/near/237471582\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"192054\">Viet Nguyen</span> <span class=\"user-mention silent\" data-user-id=\"196982\">Sreekanth Puram</span> <span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <span class=\"user-mention silent\" data-user-id=\"198783\">Larry Decelles</span> </p>\n<p>Hi Team,</p>\n<p>We are trying to setup the RI for the Prior Authorization use case and followed the instruction provided in the attached PDF (from github) and cloned the required source codes :</p>\n<ol>\n<li>CRD Server (Java gradle).</li>\n<li>Test-EHR FHIR server(Java Gradle).</li>\n<li>Keycloak Identity Management – v9.0.3</li>\n<li>SMART on FHIR – DTR(React JS)</li>\n<li>PAS – Prior-Auth(Java gradle)</li>\n<li>CRD-Request-Generator.(React JS)</li>\n</ol>\n<p>On selecting the patient and their corresponding Device/Medication/Service requests from the available list in crd-request-generator and on submitting the request, the CRD server responses back a set of Cards.<br>\nAnd on clicking the cards, smart on fhir redirection happens and then failed in loading keycloak authentication page, because of invalid parameter in the redirect uri. Following URL is the Redirected URL generated from DTR:</p>\n<p><a href=\"http://localhost:8080/test-ehr/auth?response_type=code&amp;client_id=app-login&amp;scope=launch%20user%2FObservation.read%20user%2FPatient.read%20patient%2FObservation.read%20patient%2FPatient.read%20patient%2FCoverage.read%20patient%2FCondition.read%20user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;launch=338b46e3-b72f-4ca2-98f3-39e72dc6bc1e&amp;state=36357282\">http://localhost:8080/test-ehr/auth?response_type=code&amp;client_id=app-login&amp;scope=launch%20user%2FObservation.read%20user%2FPatient.read%20patient%2FObservation.read%20patient%2FPatient.read%20patient%2FCoverage.read%20patient%2FCondition.read%20user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;launch=338b46e3-b72f-4ca2-98f3-39e72dc6bc1e&amp;state=36357282</a></p>\n<p>I have attached the steps and error screenshot as well. Can someone please help us on this.</p>\n<p>Regards,<br>\nAritra<br>\n<a href=\"/user_uploads/10155/MD566nzochvz2rIbEd48QCEh/Setting-up-CRD_DTR_PAS-2.pdf\">Setting-up-CRD_DTR_PAS-2.pdf</a><br>\n<a href=\"/user_uploads/10155/VnZ7N3mgpfmJ137MfTD7BVqa/Steps-followed.png\">Steps-followed.png</a> <a href=\"/user_uploads/10155/bGx5yXEw3t9kywT4tzfMhrCJ/Order-Form-screen.jpg\">Order-Form-screen.jpg</a> <a href=\"/user_uploads/10155/739f67bhvj894UH70ppOaOYC/Error-Screen.jpg\">Error-Screen.jpg</a></p>\n</blockquote>\n<p>Hi Aritra,</p>",
        "id": 237536760,
        "sender_full_name": "Sreekanth Puram",
        "timestamp": 1620236658
    },
    {
        "content": "<p>Hi Aritra, This is the reference implementation from Mitre. I think they will be able to help you on it. If you need general help on CRD, DTR, PAS please let me know.</p>",
        "id": 237536944,
        "sender_full_name": "Sreekanth Puram",
        "timestamp": 1620236730
    },
    {
        "content": "<p>Hello <span class=\"user-mention\" data-user-id=\"247235\">@Aritra Kundu</span>, I was curious where you received the install PDF. Is this something someone from MITRE sent to you?</p>",
        "id": 237695106,
        "sender_full_name": "Larry Decelles",
        "timestamp": 1620321054
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"198783\">Larry Decelles</span> <a href=\"#narrow/stream/259713-Da-Vinci.20Burden.20Reduction.20interoperability/topic/Prior.20Authorization.20RI.20setup.20error/near/237695106\">said</a>:</p>\n<blockquote>\n<p>Hello <span class=\"user-mention silent\" data-user-id=\"247235\">Aritra Kundu</span>, I was curious where you received the install PDF. Is this something someone from MITRE sent to you?</p>\n</blockquote>\n<p>Hi Larry,</p>\n<p>I got the same from the Confluence: <a href=\"https://confluence.hl7.org/pages/viewpage.action?pageId=97459110\">https://confluence.hl7.org/pages/viewpage.action?pageId=97459110</a>. Also followed the video tutorial: <a href=\"https://youtu.be/OrRG3RhFbts\">https://youtu.be/OrRG3RhFbts</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"OrRG3RhFbts\" href=\"https://youtu.be/OrRG3RhFbts\"><img src=\"https://uploads.zulipusercontent.net/c01aa5f2f9df21f6ef421abf0010ca22f0081826/68747470733a2f2f692e7974696d672e636f6d2f76692f4f725247335268466274732f64656661756c742e6a7067\"></a></div><p>Regards,<br>\nAritra</p>",
        "id": 237705097,
        "sender_full_name": "Aritra Kundu",
        "timestamp": 1620325111
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"196310\">Keeyan Ghoreshi</span> <a href=\"#narrow/stream/259713-Da-Vinci.20Burden.20Reduction.20interoperability/topic/Prior.20Authorization.20RI.20setup.20error/near/237516473\">said</a>:</p>\n<blockquote>\n<p>That's a strange error.  There might be a more descriptive log of what went wrong in the keycloak logs/console output.  The redirect URI looks fine, so unless the “valid redirect URI” property was changed in the app-login client in keycloak it should work.  The easiest way to debug this would be to:</p>\n<p>1) Send any errors in the keycloak log<br>\n2) Send the EHR console output for the login attempt, specifically the chunk that starts with “redirectUrl:”</p>\n</blockquote>\n<p>Hi Keeyan,</p>\n<p>I will check the log and share the same with you.</p>\n<p>Regards,<br>\nAritra</p>",
        "id": 237705231,
        "sender_full_name": "Aritra Kundu",
        "timestamp": 1620325174
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"247235\">Aritra Kundu</span> <a href=\"#narrow/stream/259713-Da-Vinci.20Burden.20Reduction.20interoperability/topic/Prior.20Authorization.20RI.20setup.20error/near/237705231\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"196310\">Keeyan Ghoreshi</span> <a href=\"#narrow/stream/259713-Da-Vinci.20Burden.20Reduction.20interoperability/topic/Prior.20Authorization.20RI.20setup.20error/near/237516473\">said</a>:</p>\n<blockquote>\n<p>That's a strange error.  There might be a more descriptive log of what went wrong in the keycloak logs/console output.  The redirect URI looks fine, so unless the “valid redirect URI” property was changed in the app-login client in keycloak it should work.  The easiest way to debug this would be to:</p>\n<p>1) Send any errors in the keycloak log<br>\n2) Send the EHR console output for the login attempt, specifically the chunk that starts with “redirectUrl:”</p>\n</blockquote>\n<p>Hi Keeyan,</p>\n<p>I will check the log and share the same with you.</p>\n<p>Regards,<br>\nAritra</p>\n</blockquote>\n<p>Hi Keeyan,</p>\n<p>Apologies for the delay in response. Please find the log details below and guide us on the next steps:</p>\n<p><strong>Keycloak : -</strong></p>\n<p>WARN  [org.keycloak.events] (default task-9) type=LOGIN_ERROR, realmId=ClientFhirServer, clientId=app-login, userId=null, ipAddress=127.0.0.1, error=invalid_redirect_uri, redirect_uri=http://0:0:0:0:0:0:0:1:8080/test-ehr/_auth/ee0d357e-4651-4f98-9452-cee54b911a88?redirect_uri=http://localhost:3005/index</p>\n<p><strong>EHR Console :-</strong></p>\n<p>[http-nio-8080-exec-8] INFO  fhirtest.access [LoggingInterceptor.java:175] Path[/r4] Source[] Operation[metadata  ] UA[Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 OPR/75.0.3969.243] Params[?_format=json] ResponseEncoding[JSON]</p>\n<p>[http-nio-8080-exec-6] INFO  o.h.d.e.authproxy.PayloadDAOImpl [PayloadDAOImpl.java:88] Updated Record with ID = b8de4927-d028-4741-8e8d-1fff897a8e6c</p>\n<p>[http-nio-8080-exec-6] INFO  o.h.d.ehrserver.authproxy.AuthProxy [AuthProxy.java:52] parms: ?response_type=code&amp;client_id=app-login&amp;scope=launch+user%2FObservation.read+user%2FPatient.read+patient%2FObservation.read+patient%2FPatient.read+patient%2FCoverage.read+patient%2FCondition.read+user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2F0%3A0%3A0%3A0%3A0%3A0%3A0%3A1%3A8080%2Ftest-ehr%2F_auth%2Fb8de4927-d028-4741-8e8d-1fff897a8e6c%3Fredirect_uri%3Dhttp%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;state=36665690&amp;launch=b8de4927-d028-4741-8e8d-1fff897a8e6c</p>\n<p>[http-nio-8080-exec-6] INFO  o.h.d.ehrserver.authproxy.AuthProxy [AuthProxy.java:55] redirectUrl: </p>\n<p><a href=\"http://localhost:8180/auth/realms/ClientFhirServer/protocol/openid-connect/auth?response_type=code&amp;client_id=app-login&amp;scope=launch+user%2FObservation.read+user%2FPatient.read+patient%2FObservation.read+patient%2FPatient.read+patient%2FCoverage.read+patient%2FCondition.read+user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2F0%3A0%3A0%3A0%3A0%3A0%3A0%3A1%3A8080%2Ftest-ehr%2F_auth%2Fb8de4927-d028-4741-8e8d-1fff897a8e6c%3Fredirect_uri%3Dhttp%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;state=36665690&amp;launch=b8de4927-d028-4741-8e8d-1fff897a8e6c\">http://localhost:8180/auth/realms/ClientFhirServer/protocol/openid-connect/auth?response_type=code&amp;client_id=app-login&amp;scope=launch+user%2FObservation.read+user%2FPatient.read+patient%2FObservation.read+patient%2FPatient.read+patient%2FCoverage.read+patient%2FCondition.read+user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2F0%3A0%3A0%3A0%3A0%3A0%3A0%3A1%3A8080%2Ftest-ehr%2F_auth%2Fb8de4927-d028-4741-8e8d-1fff897a8e6c%3Fredirect_uri%3Dhttp%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;state=36665690&amp;launch=b8de4927-d028-4741-8e8d-1fff897a8e6c</a></p>\n<p>Regards,<br>\nAritra</p>",
        "id": 238158490,
        "sender_full_name": "Aritra Kundu",
        "timestamp": 1620659513
    },
    {
        "content": "<p>Hi,</p>\n<p>I am getting an error while trying to launch the reference implementation DTR App. I followed the instructions in the github link for CRD and DTR and set up the crd-request-generator, Test EHR, CRD RI Service, Keycloak and Smart on FHIR DTR App. Below is the error I am getting in Keycloak logs</p>\n<p>19:32:48,471 ERROR [org.keycloak.services] (default task-8) KC-SERVICES0093: Invalid parameter value for: scope<br>\n19:32:48,472 WARN  [org.keycloak.events] (default task-8) type=LOGIN_ERROR, realmId=ClientFhirServer, clientId=app-login, userId=null, ipAddress=127.0.0.1, error=invalid_request, response_type=code, redirect_uri=http://localhost:8080/test-ehr/_auth/cde0c239-ace7-40bf-b264-c3210cc19f99?redirect_uri=http://localhost:3005/index, response_mode=query</p>\n<p>Below is the redirect URL<br>\n<a href=\"http://localhost:8180/auth/realms/ClientFhirServer/protocol/openid-connect/auth?response_type=code&amp;client_id=app-login&amp;scope=launch+user%2FObservation.read+user%2FPatient.read+patient%2FObservation.read+patient%2FPatient.read+patient%2FCoverage.read+patient%2FCondition.read+user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2F_auth%2F2328e281-501f-4bef-9f62-6578e635cc95%3Fredirect_uri%3Dhttp%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;state=53914306&amp;launch=2328e281-501f-4bef-9f62-657\">http://localhost:8180/auth/realms/ClientFhirServer/protocol/openid-connect/auth?response_type=code&amp;client_id=app-login&amp;scope=launch+user%2FObservation.read+user%2FPatient.read+patient%2FObservation.read+patient%2FPatient.read+patient%2FCoverage.read+patient%2FCondition.read+user%2FPractitioner.read&amp;redirect_uri=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2F_auth%2F2328e281-501f-4bef-9f62-6578e635cc95%3Fredirect_uri%3Dhttp%3A%2F%2Flocalhost%3A3005%2Findex&amp;aud=http%3A%2F%2Flocalhost%3A8080%2Ftest-ehr%2Fr4&amp;state=53914306&amp;launch=2328e281-501f-4bef-9f62-657</a></p>\n<p>Please let me know if I am missing something</p>",
        "id": 248851191,
        "sender_full_name": "Sundar",
        "timestamp": 1628518100
    }
]