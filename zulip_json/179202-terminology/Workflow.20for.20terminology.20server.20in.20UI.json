[
    {
        "content": "<p>This question is related to what <span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span> and I were talking about during the connectathon...<br>\nIn the scenario I imagine, if I load a Questionnaire and generate a UI for it... a value set is represented as a type-ahead/drop-down. I struggle with how best to get the FHIR ValueSet resource with its &lt;expansion&gt;. I talked about possibly using a separate terminology server to provide the &lt;expansion&gt;, but that has some complications. <span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span> , you mentioned you thought instead that you could get a pre-expanded value set, and then upload that to the primary FHIR server where the questionnaire gets loaded. However, if you are only supposed to return &lt;expansion&gt; as a result of the $expand operation, then how would I load the expanded ValueSet on the server and then GET the expansion back out, without it having $expand implemented (which I suspect will primarily be implemented by terminology servers, not core/resource FHIR servers)?</p>",
        "id": 153933842,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517347127
    },
    {
        "content": "<p>... I think this has application to far more than just my questionnaire scenario, too, btw.</p>",
        "id": 153933843,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517347190
    },
    {
        "content": "<p>\" I talked about possibly using a separate terminology server to provide the &lt;expansion&gt;, but that has some complications\".. which are...?</p>",
        "id": 153933861,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517348358
    },
    {
        "content": "<p>the big one: as it stands, most terminology servers don't yet implement POST ValueSet/$expand</p>",
        "id": 153933999,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517356630
    },
    {
        "content": "<p>so, if the terminology server <em>doesn't</em> support POST ValueSet/$expand, then what?</p>",
        "id": 153934000,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517356647
    },
    {
        "content": "<p>Switch to one that does ;)</p>",
        "id": 153934001,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517356658
    },
    {
        "content": "<p>POST the ValueSet (with &lt;compose&gt;) to their server and GET ValueSet/[id]/$expand</p>",
        "id": 153934002,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517356666
    },
    {
        "content": "<p>?</p>",
        "id": 153934003,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517356671
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> , yah... and in lieu of that?</p>",
        "id": 153934005,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517356730
    },
    {
        "content": "<p>If by \"in lieu of that\", you're suggesting there aren't any, I'd beg to differ. I'd be interested to see the answer to Grahame's question, what are the complications? Data privacy?</p>",
        "id": 153934006,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517356798
    },
    {
        "content": "<p>1) i'd love to get my hands on terminology servers that <em>do</em> support POST $expand... so, please send me any you are aware of. maybe I'm just unlucky... but the handlful that I played with during the connectathon had varying levels of support for POST $expand<br>\n2) I'm really trying to figure out if there are alternative workflows to this scenario.<br>\n3) I'm wondering what someone would do if they had limited access to terminology servers, and just had their own FHIR resource server</p>",
        "id": 153934008,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517357037
    },
    {
        "content": "<p>In #3's case, maybe they got their hands on a ValueSet that had an &lt;expansion&gt;, and they wanted to use it... what would be the proper way of doing that.</p>",
        "id": 153934009,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517357064
    },
    {
        "content": "<p><a href=\"https://ontoserver.csiro.au/stu3-latest\" target=\"_blank\" title=\"https://ontoserver.csiro.au/stu3-latest\">https://ontoserver.csiro.au/stu3-latest</a> (demo server for <a href=\"https://ontoserver.csiro.au\" target=\"_blank\" title=\"https://ontoserver.csiro.au\">https://ontoserver.csiro.au</a>)</p>",
        "id": 153934010,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517357065
    },
    {
        "content": "<p>if any</p>",
        "id": 153934011,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517357067
    },
    {
        "content": "<p>I'm a little surprised that others don't support it. It really shouldn't be any more difficult than instance expand. Putting pressure on vendors of those servers might lead them to add support for it..</p>\n<p>As for alternative workflows, either precalculating an expansion and using it client-side, or creating the ValueSet on a server and using instance expand do seem like the alternatives (albeit with disadvantages)</p>",
        "id": 153934012,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517357311
    },
    {
        "content": "<p>Be aware, too, that the terminology server's performance is pretty important if you're doing typeahead/dropdown completion, especially on large and/or complex ValueSets</p>",
        "id": 153934013,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517357393
    },
    {
        "content": "<p>(Disclaimer: I work for the company that makes Ontoserver. I'm not pretending to be impartial here)</p>",
        "id": 153934014,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517357450
    },
    {
        "content": "<p>Thanks Jim. Yes, I agree with your first point. And especially considering it is such a critical use-case (in my opinion, at least).<br>\nRegarding alternative workflows... can you expand on \"pre-calculating an expression\"</p>",
        "id": 153934018,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517361304
    },
    {
        "content": "<p>expansion</p>",
        "id": 153934019,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517361326
    },
    {
        "content": "<p>At dev time, just calculate the expansion of the ValueSet, and do the searching client-side. Its probably less efficient (provided your terminology server is performant), and it means you don't get updates (new versions of code systems, etc)</p>",
        "id": 153934020,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517361415
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> if you think my server doesn't fully support the spec, please let me know how</p>",
        "id": 153934037,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517366205
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> it does :) supports it well. but, looking for variety, as well.</p>",
        "id": 153934094,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517375412
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> , your \"pre-calc\" scenario brings us fully back around to my original question:<br>\nif I pre-calc a value set, how do I access it in a FHIR way? I can't just POST the expansion with the value set, because expansion isn't supposed to be returned unless $expand is requested. so, where does the expansion for the value set go that I can retrieve it again in my app? are we just relying on a proprietary solution?</p>",
        "id": 153934096,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517375683
    },
    {
        "content": "<p>Yes, at that point you're just pretty much relying on a proprietary solution. The best you can do is swap out the retrieval of the JSON (retrieve it statically rather than from a server, but then access the JSON structure the same way).</p>\n<p>I'm not presenting this as a good alternative. The good option is to use a terminology server that supports POST-style invocation, like Grahame's server, or Ontoserver (or others)</p>",
        "id": 153934097,
        "sender_full_name": "Jim Steel",
        "timestamp": 1517376235
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> it's not wrong to post expansions, and the server returns what it has when you just access the value set</p>",
        "id": 153934112,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517400574
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , what do you do when you have multiple calculations/expansions of a value set that you need to access?</p>",
        "id": 153934118,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517404363
    },
    {
        "content": "<p>then you can't; this is why sharing definitions is way more useful and safe than sharing particular expansions. But whole legacy eco-systems depend on sharing expansions not definitions, and there are occasionally use cases where it's actually useful</p>",
        "id": 153934120,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517404639
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , would it be worth considering some changes to allow POST/PUTing multiple expansions, and providing a mechanism of returning the expansion desired?</p>",
        "id": 153934133,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517407844
    },
    {
        "content": "<p>I don't think so - you can post multiple expansions as different resources; anything beyond that is private business of the srver</p>",
        "id": 153934139,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517410935
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> Our server support POST VaueSet/$expand. If you need access, please let me know.</p>",
        "id": 153934140,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1517411215
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  what \"other\" resources are you thinking of?</p>",
        "id": 153934149,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517411857
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> , yes, that would be great</p>",
        "id": 153934150,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517411881
    },
    {
        "content": "<p>different instances of value set</p>",
        "id": 153934153,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517411967
    },
    {
        "content": "<p>gotcha</p>",
        "id": 153934155,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517411993
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> it would be interested to see an example of an SCT ValueSet that you wish to POST as a parameter to an $expansion operation request. Although my server is only an exemplar, free to use and (to date) read-only by design; if someone can show me that there are use cases relating to SCT that can only be implemented by this (bearing in mind that ECL expressions can now be passed as filters) I'll review my policy.</p>",
        "id": 153934189,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1517413748
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> , to be clear...  POST ValueSet/$expand does not involve storing the ValueSet being POST'd on the server. It is sending the ValueSet to the server to have the expansion calculated and immediately returned. It is up the server to decide if it should store the ValueSet in the POST or not.</p>",
        "id": 153934192,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517414219
    },
    {
        "content": "<p>Fully understand that <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span>, but what are the use cases for SCT-based value sets now that ECL expressions can be passed as filters?</p>",
        "id": 153934196,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1517414441
    },
    {
        "content": "<p>because you have one defined that way, the way that no one currently supports. You have a value set defined any old way. Or even that you have a value set defined that way, but you don't know whether or not the value set is defined on the server, since you sourced it from somewhere else, and you don't want to have to have the security clearance to register value sets on the server with all the associated curation responsibilities. You just have a value set from a profile or a quetsionnaire that you need to have expanded correctly</p>",
        "id": 153934200,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517414616
    },
    {
        "content": "<p>Hit me up in person later and I'll explain my scenario... a bit long winded to type while taking minutes in this meeting :)</p>",
        "id": 153934201,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1517414623
    },
    {
        "content": "<p>Will do <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span>. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - doesn't your R4 server support ECL filters? I'm sure that Ontoserver will, given their existing capability. My implementation is still limited and I need to fix a bug that I discovered yesterday.</p>",
        "id": 153934210,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1517415060
    },
    {
        "content": "<p>no I don't support ECL.</p>",
        "id": 153934214,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517415219
    },
    {
        "content": "<p>can't do everything....</p>",
        "id": 153934215,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517415226
    },
    {
        "content": "<p>maybe one day</p>",
        "id": 153934216,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1517415229
    },
    {
        "content": "<p>Understand, although servers will need to support ECL if passed as filters within intensional value set definitions POSTed to an expansion request.</p>",
        "id": 153934225,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1517415948
    },
    {
        "content": "<p>FWIW <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> , the suite of terminology clients we have written (browser: <a href=\"http://ontoserver.csiro.au/shrimp\" target=\"_blank\" title=\"http://ontoserver.csiro.au/shrimp\">http://ontoserver.csiro.au/shrimp</a>, and simple authoring <a href=\"http://ontoserver.csiro.au/snapper2-dev\" target=\"_blank\" title=\"http://ontoserver.csiro.au/snapper2-dev\">http://ontoserver.csiro.au/snapper2-dev</a>) make extensive use of ValueSets provided via POST to $expand (and using ECL).  The tools themselves can be pointed at other FHIR terminology servers, but as you observe, many are incomplete and thus successful results vary.</p>",
        "id": 153934444,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1517442634
    },
    {
        "content": "<p>The sandbox endpoint <span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> mentioned is freely available (<a href=\"http://ontoserver.csiro.au/stu3-latest\" target=\"_blank\" title=\"http://ontoserver.csiro.au/stu3-latest\">http://ontoserver.csiro.au/stu3-latest</a>) for you to experiment with.  From what you've described here I don't think there's anything it won't handle.</p>",
        "id": 153934445,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1517442807
    }
]