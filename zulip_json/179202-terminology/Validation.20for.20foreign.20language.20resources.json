[
    {
        "content": "<p>As discussed during the inoffical break-out-session at the WGM: <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16586\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16586\">GF#16586</a></p>\n<blockquote>\n<p>When validating a resource/code validators currently match both code and - if present - display.</p>\n<p>However, assuming that an english server has ValueSet expansions with english display values and a french server has ValueSet expansions with french display values, validation will fail as soon as resources are exchanged between english and french systems.</p>\n<p>To resolve this, following a discussion with Rob Hausam, Ewout Kramer, Richard Ettema, Patrick Werner and me, the proposed solution is that any server should validate display values only if the value of Resource.meta.language matches it's own configuration. If not, the validator should only validate the codes and disregard the display values.</p>\n<p>Open for discussion: what's the impact - if any - on $validate-code?</p>\n</blockquote>",
        "id": 153958531,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526137316
    },
    {
        "content": "<p>I don't agree with that particular solution</p>",
        "id": 153958549,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526137899
    },
    {
        "content": "<p>the validate-code operation can take a display language parameter - that should take priority</p>",
        "id": 153958550,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526137924
    },
    {
        "content": "<p>if there is none, and no expansion profile (which can also specify this)</p>",
        "id": 153958552,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526137939
    },
    {
        "content": "<p>then ok, which Resource.meta.language?</p>",
        "id": 153958553,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526137952
    },
    {
        "content": "<p>\"If not, the validator should only validate the codes and disregard the display values.\" I don't agree with that because if server return true in such situation, the client would assume the display text in the request is correct. If the server cannot validate the correctness of display text, the server should return false with error message that display text could not be validated.</p>",
        "id": 153958572,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1526139091
    },
    {
        "content": "<p>so, the server is validating in a language from this cascade:<br>\n- specified language parameter<br>\n- language specified in expansion profile<br>\n- language specified in value set</p>",
        "id": 153958581,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526141301
    },
    {
        "content": "<p>but what's the relationship between that and specified language displays in the value set itself?</p>",
        "id": 153958582,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526141342
    },
    {
        "content": "<p>note that ValueSet.compose.concept.display is a designation in ValueSet.language</p>",
        "id": 153958584,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526141356
    },
    {
        "content": "<p>it's a harder question when the server can't validate the display</p>",
        "id": 153958585,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526141434
    },
    {
        "content": "<p>Yes, I think the genesis of the original issue is that in a particular instance Coding.display is a German description that is valid in the code system, but the validator is rejecting it because by default it expects that Coding.display is an English term.</p>",
        "id": 153958588,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1526141896
    },
    {
        "content": "<p>it was gold that it's in german? is it my validator?</p>",
        "id": 153958590,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526142003
    },
    {
        "content": "<p>I don't think that we can expect servers to have ValueSet designations in all possible languages, just in case they receive a foreign resource. So how should a spanish server decide wether a chinese display code is correct? Isn't it the purpose of having codes in the first place, that we can have the same understanding of concept, regardless of language?</p>",
        "id": 153958591,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526142039
    },
    {
        "content": "<p>yes that's why I don't make it an error, just a warning</p>",
        "id": 153958592,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526142332
    },
    {
        "content": "<blockquote>\n<p>so, the server is validating in a language from this cascade:<br>\n- specified language parameter<br>\n- language specified in expansion profile<br>\n- language specified in value set</p>\n</blockquote>\n<p>How does the language of the instance (meta.language) influence the behaviour of the validator?</p>",
        "id": 153958598,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526143184
    },
    {
        "content": "<p>Sorry, it's Resource.language, not Resource.meta.language....</p>",
        "id": 153958602,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526144007
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/N2SNirQYwFJyP4iEaFG1Elrb/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> <br>\nHere's our problem</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/N2SNirQYwFJyP4iEaFG1Elrb/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/N2SNirQYwFJyP4iEaFG1Elrb/pasted_image.png\"></a></div>",
        "id": 153958605,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526147539
    },
    {
        "content": "<p>I think a validator should only enforce matching display values, if the resource is in a language it supports (= has the appropriate expansions for).  Or should mismatching display values alway be warnings regardless of language?</p>",
        "id": 153958606,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526148054
    },
    {
        "content": "<p>ok so the language here is a bit confusing between the validation engine and the terminology server. I was talking about the terminology server where the resource.language is not known. The validation engine should pass the language of the resource as a parameter to the $validate-code operation</p>",
        "id": 153958843,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526157853
    },
    {
        "content": "<p>In the light of this: Does it make sense to enforce language in national profiles ?</p>",
        "id": 153958844,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526157973
    },
    {
        "content": "<p>that's a difficult question indeed. Enforcing language is problematic, I think.</p>",
        "id": 153958846,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526158040
    },
    {
        "content": "<p>(as is also not enforcing it)</p>",
        "id": 153958847,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526158053
    },
    {
        "content": "<p>where do you see problems?</p>",
        "id": 153958856,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1526158601
    },
    {
        "content": "<p>well, if you enforce language in the national profile - all resources must be in de-DE - is that really something you can enforce? that all use of FHIR in DE must be in de-DE? what about cross-border stuff? I think that would just create a giant administrative headache for everyone</p>",
        "id": 153959292,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526190125
    },
    {
        "content": "<p>further, are all code systems available in german language? what happens if they're not?</p>",
        "id": 153959293,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526190154
    },
    {
        "content": "<p>As we've interpreted the <code>$validate-code</code> specification, a display value that is not any of the designations for the code results in <code>result=false</code><br>\nThere is no clear guidance on this in the spec (AFAICT) beyond \"result = true if the concept details supplied are valid\"; ie no details on what \"valid\" means</p>",
        "id": 153962908,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1526518140
    },
    {
        "content": "<p>guess we should settle on this - can you create a task?</p>",
        "id": 153962923,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526531161
    },
    {
        "content": "<p><a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17218\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17218\">GF#17218</a></p>",
        "id": 153962932,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1526533723
    },
    {
        "content": "<p>Thanks, Michael.</p>",
        "id": 153962934,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1526533778
    },
    {
        "content": "<p>I used to think that if display is provided, it must be validated. But after reading the spec again, no where says so.</p>",
        "id": 153963360,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1526597450
    },
    {
        "content": "<p>yes. doesn't say you can't. because in practice, it's tricky. In the spec validation, it has to be correct. In other contexts, I let the user specify</p>",
        "id": 153963367,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526614132
    }
]