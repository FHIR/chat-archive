[
    {
        "content": "<p>We are currently looking for a way to capture money and point values for billable codes. <br>\nHowever we found that concept.property.value[x] doesn't allow for Quantity.<br>\nIs that a legitimate Change Request or is this too far out of scope?</p>",
        "id": 153919065,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510413079
    },
    {
        "content": "<p>don't know. I think we'd need to understand more about the use case and other use cases - has this come up in the catalog project? <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> <span class=\"user-mention\" data-user-id=\"191408\">@Lorraine Constable</span></p>",
        "id": 153919103,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1510471047
    },
    {
        "content": "<p>We've looked at the Catalog and CatalogItem Resource proposals, but they seem a bit overkill for our rather simple useCase.<br>\nAlso, they don't seem to support prices either at this point.<br>\nWe basically just need to be able to look up the price information for ChargeItem.code in order to create the Invoice.<br>\nSince CodeSystem already provides the $lookup operation that returns the properties, CodeSystem looks like a really good fit here without much hazzle.<br>\n...except for the missing Quantity option...</p>",
        "id": 153919110,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510487069
    },
    {
        "content": "<p>I wasn't necessarily saying to use catalog output - just that we should understand the uses cases and their thoughts</p>",
        "id": 153919139,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1510517245
    },
    {
        "content": "<p>which leads me to a question on the expand operation. should that be returning any extensions on the concepts it is expanding?</p>",
        "id": 153919155,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1510524271
    },
    {
        "content": "<p>we haven't said - and it would depend on the extensions.</p>",
        "id": 153919156,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1510524783
    },
    {
        "content": "<p>Thought it would help with Simone's case, as she could put the extension on the concepts, and they could expand through</p>",
        "id": 153919157,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1510526010
    },
    {
        "content": "<p>(my server does this already)</p>",
        "id": 153919158,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1510526023
    },
    {
        "content": "<p>Yes, I think this should be an extension.  And if the extension can be returned by $lookup (which I'm assuming isn't likely to be the default), then that should meet Simone's use case.</p>",
        "id": 153919160,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1510549146
    },
    {
        "content": "<p>and $expand</p>",
        "id": 153919161,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1510550941
    },
    {
        "content": "<p>At this point, I can't say for sure, whether we'd need to have the prices in the ValueSet extensions as well, I think it would be sufficient to be able to $lookup them in the CodeSystem. Maybe <span class=\"user-mention\" data-user-id=\"193158\">@Udo Siefker</span> can weigh in?</p>",
        "id": 153919198,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510561939
    },
    {
        "content": "<p>I would assume that the reason why the concept.property has been designed as key-value-pairs in the first place, was to allow capturing all kinds of properties without having to use extensions. Why not allow valueQuantity here? The inconsistency of having to put half of the properties in value[x] and the other half in extensions feels wrong to me.<br>\nAgree that it has to be an Extension for STU3, but I would like to see it as core in R4.<br>\nThere may be other useCases where valueQuantity might be useful, aside from prices.</p>",
        "id": 153919199,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510562475
    },
    {
        "content": "<p>e.g. some diagnosis codes might have a minAge property indicating that they only apply to grownups.</p>",
        "id": 153919200,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510562606
    },
    {
        "content": "<p>I agree with you on that, Simone.  Since we have valueInteger, I can't see a reason not to also allow valueQuantity.  The other aspect to consider, though, is whether these properties are intended to be only for those that are defined by the code system itself (which pricing isn't), or also for any other properties that someone may what to define and associate with a code.  I think it might make a lot of sense to allow the broader usage (similar to the HealthLanguage notion of \"facets\"), but I think we probably will also want a way to clearly distinguish which is which - possibly they could be handled as a separate top-level property, or we could add an additional flag (property.type currently isn't sufficient and we probably don't want to overload it).</p>",
        "id": 153919225,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1510576726
    },
    {
        "content": "<p>I would even go so far to say that the prices are indeed part of the CodeSystems in the use cases we have been discussing. In the first, the codes are billing codes for services, in the second we have internal order-codes for materials. In both cases, the prices are part of the original data structures we are creating the CodeSystems from, however, we might argue over whether these are still \"CodeSystems\" or something else altogether. :)</p>",
        "id": 153919228,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510579534
    },
    {
        "content": "<p>As soon as you start to put time ranges on your prices, using CodeSystem starts to fall down.  I think the pricing data is associated with the code system, but I'm not sure it should live there</p>",
        "id": 153919233,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510582150
    },
    {
        "content": "<p>Same concern's as Lloyd and surprised by Rob's response.  I think this is an attribute on Catalog entry or some other pricing structure.  <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span>  why isn't there any pricing information on catalog entry?</p>",
        "id": 153919284,
        "sender_full_name": "Eric Haas",
        "timestamp": 1510586459
    },
    {
        "content": "<p>The billing codes in our case are published quarterly, each constituting a new CodeSystem version, the prices don't change outside these publications. But changing prices might be a problem for the use case of internal order codes.</p>",
        "id": 153919288,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510586731
    },
    {
        "content": "<p>Makes sense</p>",
        "id": 153919293,
        "sender_full_name": "Eric Haas",
        "timestamp": 1510587129
    },
    {
        "content": "<p>I don't think pricing has anything to do with catalogues.  Pricing data is just pricing data.  I'd expect there to be a resource called something like BillableItem that linked a particular procedure or product code to a price with a time-range, tax information, and potentially other information about what circumstances the price was valid for.  That information might or might not find its way into catalogues, but it would certainly be used in lots of non-catalogue use-cases too.</p>",
        "id": 153919302,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510588732
    },
    {
        "content": "<p>Yes, that would also be what chargeItem.definition should point at, I guess...</p>",
        "id": 153919303,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510589509
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>, and everyone, I think we should keep CodeSystem generally and CodeSysytem.property, in particular, for information that is specific to and is defined as part of the code system.  If folks feel that for whatever reason they need to or want to attach non-code system defined \"properties\" or other such information that is associated with a code, then this should be in extension space (at least for now).  I think it's a bit unusual (I don't recall having encountered it anywhere else before), but it sounds like Simone is making the case that for their billing codes the price actually <strong>is</strong> defined and published as a part of the code system.  The spec states that \"Each concept defined by the code system may have one more values for each property <strong>defined by the code system</strong>\".  So if Simone's case actually does fit that (and the possibility of changing prices isn't an issue), then I imagine it's reasonable to allow for valueQuantity so it can be represented.   But something like BillableItem probably would be a better place for this kind of information to reside, and if that works both in this case and more broadly then we wouldn't need to be changing or extending CodeSystem to accommodate it.</p>",
        "id": 153919305,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1510590958
    },
    {
        "content": "<p>I agree that BillableItem makes sense when we want to walk the extra mile (although that's <em>a lot</em> of miles actually) and also capture the complete set of rules that apply to the code in a billing context, e.g. when a code is only applicable to females or newborns, may not be used in combination with certain other codes, applies only once per encounter etc. Plus all the rules for when discounts or surcharges apply, tax rules as Lloyd mentioned... I guess the BillingItem is going to become a pretty fancy monster, when I think about it. So there may be situations (like ours) where this is just too much overhead. Especially when the CodeSystem has frequent releases and needs to be distributed among many systems.</p>",
        "id": 153919315,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510597030
    },
    {
        "content": "<p>Though I'm actually quite intrigued by the BillingItem. Both ChargeItem and Account could have Operations, that check the viability of a code in their respective context by checking all the rules defined in the BillableItem...</p>",
        "id": 153919316,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1510597287
    },
    {
        "content": "<p>We have code systems for medications, locations, devices and a lot of other things - but we <em>don't</em> typically model things like drug strength or device manufacturer or location assets in the code system.  Instead we use the code as a link to the appropriate resource for that data (Medication, Location, Device, etc.)  I think pricing information ought to be handled the same way.  (There's actually a section in the notes on CodeSystem.)</p>",
        "id": 153919331,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510601755
    },
    {
        "content": "<p>BillableItems would also be specific to the organization that does billing - different organizations might use the same \"billing codes\" or product codes, but price things differently.</p>",
        "id": 153919332,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510601816
    },
    {
        "content": "<p>Maybe we can provide some input to the discussion by describing the business problem that we face:<br>\nIn many countries there are legally defined billing catalogs like the EBM catalog in Germany, the Tarmed in Switzerland, or DRG catalogs. They are published on a regular basis, often quarterly. <br>\n[see the picture below as illustration, sorry it’s only in German. In the appendix 2 of the EBM catalog (xls) the procedure codes and their mapping to service codes for surgery, anesthesia etc. can be found. For service code 31351 the EBM catalog item is shown below with its description, exclusion rules and also the price in Euro]<a href=\"/user_uploads/10155/9VxOMlCt13PKPOoSvHf1cuaW/EBM_catalog_Example.png\" target=\"_blank\" title=\"EBM_catalog_Example.png\">EBM_catalog_Example.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/9VxOMlCt13PKPOoSvHf1cuaW/EBM_catalog_Example.png\" target=\"_blank\" title=\"EBM_catalog_Example.png\"><img src=\"/user_uploads/10155/9VxOMlCt13PKPOoSvHf1cuaW/EBM_catalog_Example.png\"></a></div>",
        "id": 153919707,
        "sender_full_name": "Bettina Lieske",
        "timestamp": 1510750879
    },
    {
        "content": "<p>In our understanding, a ChargeItem documents the provisioning of such a catalog item for a given patient which is then later on invoiced via an account.<br>\nThe catalog item covers attributes like charge types (e.g. Departmental per Diem, Flat Rate Charges for Psychiatry), gender constraints, and prices. </p>\n<p>These prices are actually base prices (there are possibly several base prices depending on the type of service provisioning e.g. when provided by a GP in contrast to a hospital physician)<br>\nBased on those, surcharges or discounts would be applied depending on the patient’s coverage and insurance information. This would then result in items on the final invoice. <br>\nIn official catalogs price changes are handled through catalog versioning, but of course customers also define their own catalogs e.g. for wellness treatments not covered by the public healthcare system. In those customer-specific catalogs time-dependent prices are commonly used to reduce the catalog maintenance effort.</p>\n<p>We had a look at catalog and catalog entry. Obviously they are in an early stage and seemed to address another problem. That’s why we then evaluated CodeSystem which seems to be well suited. We only missed the type Quantity as property value and the possibility of modeling time-dependent attributes.</p>\n<p>We do not have enough FHIR expertise to decide whether the usage of codeSystem would be correct, we simply are looking for a solution for the described business problem.<br>\nTherefore we reach out to you for a better proposal if the codeSystem is not appropriate from your perspective.</p>\n<p>Note: As far as we understood the BillingItem it is supposed to cover detailed pricing rules and further terms and conditions. This would rather be an internal resource for a Billing/Accounting module that receives ChargeItems as input and produces invoices as output.</p>",
        "id": 153919708,
        "sender_full_name": "Bettina Lieske",
        "timestamp": 1510750932
    },
    {
        "content": "<p>It sounds like you are creating a price list which would include multiple elements, some of which would be codes, another element would be the prices (Money). This would not itself be a codeset or valueset - it would be more like a catalogue.  The 'part number' or 'billing code' or 'medication number' is clearly a code as it is a singular 'tag' for a concept or thing which is resused as needed and typically survives over time. A parts (or billing, or medication) price list will list that code plus other values such as  points, body site of use, active ingredient and then will include the price as a single value, a quantity purchase grid or series of costing components. The price record is a complex object and may be part of a list of complex objects but not a codeset itself - in part because there may exist multiple price lists all of which are in play at the same time and which include different prices for the same part, billing item, packaged drug etc.</p>",
        "id": 153920063,
        "sender_full_name": "Paul Knapp",
        "timestamp": 1510855109
    },
    {
        "content": "<p>Pricing data may vary in time and in other dimensions.  Also, they're not a definitional part/property of the code itself.  I had imagined that ConceptMap might be used to capture this kind of information</p>",
        "id": 153920486,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1511239723
    },
    {
        "content": "<p>how?</p>",
        "id": 153920487,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1511239968
    },
    {
        "content": "<p>I was imagining that target.product could be used, but looking more closely I see that it's not quite what I wanted. OTOH, with a well-known code system for +ve decimals you could still do it.</p>",
        "id": 153920935,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1511333038
    },
    {
        "content": "<p>I feel as though the fact that the prices are time limited really means that these are not properties of the codes</p>",
        "id": 153920947,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1511336285
    },
    {
        "content": "<p>In the real world however, prices are often published with the codes in a catalog (like in my picture above). What would you suggest in terms of modelling approach instead?</p>",
        "id": 153920989,
        "sender_full_name": "Bettina Lieske",
        "timestamp": 1511347083
    },
    {
        "content": "<p>I think we havee to distinguish two use cases:<br>\n1) the prices are loosely linked to the codes and may vary over time or from Organization to Organization. In that case, I absolutely agree that they are not part of the code system. <br>\n2) the CodeSystem <em>is</em> a billing code system and the prices are published with the codes and the time during which the prices are valid are identical with the validity of the codes. In this case the codes are used for no other purpose than billing (e.g. in ChargeItem.code).<br>\nFor the latter I believe that handling the prices as property of the code isn't that far out of line...</p>",
        "id": 153920991,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1511347345
    },
    {
        "content": "<p>In any case however I still like the Idea of defining a \"BillableItem\" or \"BillingRules\" Resource, that could be used to not only capture the prices for a particular code but also the time ranges for their validity and the rules under which discounts of surcharges may apply.</p>",
        "id": 153920992,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1511347463
    },
    {
        "content": "<p>Even in Simone's #2 case, the pricing data still seems additional to and independent from the properties of the code system itself.  So my thought is still +1 for the \"BillableItem\" or \"BillingRules\" resource (or something similar).</p>",
        "id": 153920997,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1511349460
    },
    {
        "content": "<p>About that: I'm having difficulties to wrap my head around where and how such a resource would be referenced.<br>\nThe only place I can think of would be ChargeItem.definition. Should  CodeSystem.concept.properties point at BillableSomething, too?</p>",
        "id": 153921009,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1511354195
    },
    {
        "content": "<p>In the real world, drug ingredients, location addresses, device characteristics and lots of other things are published with codes too.  We have a pattern for dealing with such things that does NOT involve moving data that we have resources to address into code systems: <a href=\"http://build.fhir.org/codesystem.html#detailed-metadata\" target=\"_blank\" title=\"http://build.fhir.org/codesystem.html#detailed-metadata\">http://build.fhir.org/codesystem.html#detailed-metadata</a></p>",
        "id": 153921063,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1511373413
    },
    {
        "content": "<p>Cost feels like something that should be handled in the same way.  Cost information isn't necessarily associated with codes and can often be maintained separately from the code system that defines the thing being costed - If you're using RxNorm for drug codes, you certainly won't be embedding your prices in RxNorm.  Having a supplemental resource that represents the time (and often client/location/etc.)-based costing information will work consistently regardless of the source of the codes describing what's costed.</p>",
        "id": 153921064,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1511373513
    },
    {
        "content": "<p>The pattern is good, but how does it address arbitrary / ad-hoc details?  That is, the pattern seems to require a pre-existing detail resource type - is Basic the starting point for these cases?  If so, then how do you reference back to the code because Basic.code does not seem appropriate and Basic.subject is a Reference - so Basic.subject.identifier ?</p>",
        "id": 153921209,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1511402513
    },
    {
        "content": "<p>Ad-hoc things can be handled as code system properties.  But if the information seems like it might be a candidate for a resource, that should be explored.  I think there are lots of uses for a \"cost\" resource other than just a catalogue.</p>",
        "id": 153921225,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1511410015
    },
    {
        "content": "<p>I have submitted a resource proposal for a ChargeItemDefinition<br>\n<a href=\"http://wiki.hl7.org/index.php?title=ChargeItemDefinition_FHIR_Resource_Proposal\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=ChargeItemDefinition_FHIR_Resource_Proposal\">http://wiki.hl7.org/index.php?title=ChargeItemDefinition_FHIR_Resource_Proposal</a><br>\nplease comment!</p>",
        "id": 153923354,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1512651612
    },
    {
        "content": "<p>I'll take a look at the proposal but agree with Lloyd that code system properties should be things that are mostly static, ie: stay the same for that concept over time. A code system resource is where you associate things that change but are associated with a code. There are other uses of a code system resource (such as frequency of use) but pricing is a classic case.</p>",
        "id": 153923359,
        "sender_full_name": "Robert McClure",
        "timestamp": 1512653175
    },
    {
        "content": "<p>So you propose an all-purpose CodeDefinition resource rather than an accouting specific \"ChargeItemDefinition\"? <br>\nWe created a resource proposal that would be generic enough (it's mostily key-value-pair stuff). We could add a type code to allow for different usage scenarios, such as accounting, statistics etc. <br>\nThe resource would definitely require profiling to be useful in either scenario. But we consider accounting as extremely codesystem-/realm-/domain-specific, so we decided that having something very abstract and flexible is the best way to go forward.</p>",
        "id": 153923376,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1512659366
    },
    {
        "content": "<p>I think the proposed ChargeItemDefinition resource makes sense for this - it seems consistent with the \"Code systems with detailed metadata\" guidance that Lloyd referenced above.</p>",
        "id": 153923407,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1512663636
    },
    {
        "content": "<p>Thanks, Rob. On second thought I don't thik it's a good idea to mix CodeStatistics with Billing Details. They should be seperate resource, especially because I think that Statistics is something that can be universally agreed upon with a very concise structure, whereas billing information will have very little common ground across domains.</p>",
        "id": 153923440,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1512671569
    },
    {
        "content": "<p>I think that I agree with you about the statistics.</p>",
        "id": 153923463,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1512677087
    },
    {
        "content": "<p>I agree. We have same situation here! To understand clearly, if prices changes means... should I create new version of the CodeSystem?</p>",
        "id": 172543868,
        "sender_full_name": "Marcelo Cabello",
        "timestamp": 1565043979
    },
    {
        "content": "<p>This is an old thread but pricing should be represented as a code system resource with <a href=\"https://www.hl7.org/fhir/codesystem-definitions.html#CodeSystem.content\" target=\"_blank\" title=\"https://www.hl7.org/fhir/codesystem-definitions.html#CodeSystem.content\">CodeSystem.content</a> = \"Supplement\"</p>",
        "id": 173235576,
        "sender_full_name": "Robert McClure",
        "timestamp": 1565811991
    },
    {
        "content": "<p>(yes, using properties)</p>",
        "id": 173240583,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1565815467
    },
    {
        "content": "<p>Or maintained separately using ChargeItemDefinition</p>",
        "id": 173652810,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1566304284
    }
]