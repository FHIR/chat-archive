[
    {
        "content": "<p>FHIR has a good number of places where required terminology plays a role. This terminology may or may not map well to/from the actual systems. AllergyIntolerance.criticality is one such example. We define ConceptMaps to explain how FHIR terminology and system terminology connect. So far so good.</p>\n<p>For the past 5-6 years we have also used an extension called \"<a href=\"https://simplifier.net/resolve?target=simplifier&amp;canonical=http://nictiz.nl/fhir/StructureDefinition/code-specification\">code-specification</a>\" which is a simple CodeableConcept. This extension is situated under the FHIR element with required terminology (usually of type <em>code</em>) and aims to communicate the actual system value for the given element.</p>\n<p>Now obviously only systems that implemented our IG would be able to process this extension and understand it, but those that do have more chances of being interoperable without loss of original nuance in meaning that comes from mapping.</p>\n<p>Question: is this a mechanism worth bringing to the international table? It sure seems generic enough to define this extension at international level.</p>\n<p>Example:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code><span class=\"nt\">&lt;AllergyIntolerance</span> <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;clinicalStatus</span> <span class=\"na\">value=</span><span class=\"s\">\"active\"</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"http://nictiz.nl/fhir/StructureDefinition/code-specification\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/v3/ActStatus\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"active\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Active\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/clinicalStatus&gt;</span>\n    <span class=\"nt\">&lt;verificationStatus</span> <span class=\"na\">value=</span><span class=\"s\">\"confirmed\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;category</span> <span class=\"na\">value=</span><span class=\"s\">\"environment\"</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"http://nictiz.nl/fhir/StructureDefinition/code-specification\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"419199007\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Allergy to substance (finding)\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/category&gt;</span>\n    <span class=\"nt\">&lt;criticality</span> <span class=\"na\">value=</span><span class=\"s\">\"high\"</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"http://nictiz.nl/fhir/StructureDefinition/code-specification\"</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n                <span class=\"nt\">&lt;coding&gt;</span>\n                    <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://snomed.info/sct\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"24484000\"</span><span class=\"nt\">/&gt;</span>\n                    <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"severe (qualifier)\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;/extension&gt;</span>\n    <span class=\"nt\">&lt;/criticality&gt;</span>\n    ...\n<span class=\"nt\">&lt;/AllergyIntolerance&gt;</span>\n</code></pre></div>",
        "id": 236459626,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1619593247
    },
    {
        "content": "<p>I think that the mechanism for (effectively) creating a translation to a code data type is a good idea which I'd certainly be happy to use for some of our CDA to FHIR mappings in NZ. I couldn't see any binding to a particular Value Set in the Structure Definition, I'm assuming that it's quite a large Value Set with entries from quite a few Code Systems?</p>\n<p>Not so sure about the examples here (e.g. conflating severity and criticality), but I guess that's not the salient point!</p>",
        "id": 236464601,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1619596023
    },
    {
        "content": "<p>Hi Peter. The extension itself does not have any binding on purpose. We apply the binding in context where we use the extension. Example: <a href=\"https://simplifier.net/resolve?target=simplifier&amp;canonical=http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance\">AllergyIntolerance profile</a>.</p>",
        "id": 236480576,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1619604157
    },
    {
        "content": "<p>You will also find that AllergyIntolerance.verificationStatus does not have a specified relationship with code-specification because we do not have any functional element mapping at all. That's why we specified it is perfectly fine to use extension data-absent-reason here.</p>",
        "id": 236481126,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1619604381
    },
    {
        "content": "<p>As for the exact terminology in the example, I can only say that this came from functional people that include MDs and the SNOMED NRC, so I have to trust that part. But you are also right that the exact SNOMED CT concepts were not the gist of the example. For your curiosity, <a href=\"https://zibs.nl/wiki/AllergyIntolerance-v3.2(2017EN)#CriticalExtentCodelist\">CriticalExtentCodelist</a> is for AllergyIntolerance.criticality and <a href=\"https://zibs.nl/wiki/AllergyIntolerance-v3.2(2017EN)#SeverityCodelist\">SeverityCodelist</a> is for AllergyIntolerance.reaction.severity. As you can see those have the same SNOMED CT contents, except for 1 concept extra in criticality (<a href=\"https://terminologie.nictiz.nl/art-decor/snomed-ct?conceptId=399166001\">399166001 | fatal (qualifier)|</a>)</p>",
        "id": 236481946,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1619604806
    },
    {
        "content": "<p>I think it's fine to propose a generic extension on 'code' that does this (with usage notes that it's only for use on 'bare' code elements, not when code appears as part of Coding.  It's probably also worth noting in the description of the extension that you must still have a code value from the originally bound value set - the extension can't ever appear in place of the code.</p>",
        "id": 236514934,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1619619648
    },
    {
        "content": "<p>The v2-to-FHIR project was going to submit a Jira ticket for basically the same extension. We've identified a few places where we need to include the \"original value\" from a v2 message to either a code or Coding element (where Coding has a required value set) where the required value set doesn't translate particularly well. We think this meshes well with this use case. We're not sure \"code-specification\" is the clearest name for a base extension, but we definitely support the concept and agree with Lloyd's suggestion clarify that it's in addition to the value from the bound value set.</p>",
        "id": 236698778,
        "sender_full_name": "Craig Newman",
        "timestamp": 1619711647
    },
    {
        "content": "<p>I would suggest to use \"originalCodeableConcept\" to align with already existing \"originalString\" extension.  IF the intent is the same as Alexander's these names would be more clear.</p>",
        "id": 236701719,
        "sender_full_name": "Hans Buitendijk",
        "timestamp": 1619712764
    },
    {
        "content": "<p>I'm a bit confused as to why it's \"originalCodeableConcept\" rather than \"originalCoding\"?</p>",
        "id": 236702383,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1619713023
    },
    {
        "content": "<p>Interesting to hear that <span class=\"user-mention\" data-user-id=\"192758\">@Craig Newman</span>, and agreed that \"code-specification\" maybe isn't the best name. The FHIR spec sometimes uses the term \"local code\", but maybe that's not exactly correct for your use case.</p>",
        "id": 236799399,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1619769627
    },
    {
        "content": "<p>Regarding the earlier remark of <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>. If the element is a <em>CodeableConcept</em> than the preferred way to communicate the additional code is by using a second <em>coding</em>, correct? The same is true for elements of type <em>coding</em>, but this only works if it is a repeating element.</p>",
        "id": 236799916,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1619769891
    },
    {
        "content": "<p>If you have a CodeableConcept, you can always convey the original coding as just another coding.  You'd only need the extension if you were mapping to a 'code' or 'Coding'.  If you had multiple translations and were converting to 'code' or 'Coding', presumably the only Coding you'd need to convey as 'original' is the one you used for the translation?</p>",
        "id": 236834298,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1619789585
    }
]