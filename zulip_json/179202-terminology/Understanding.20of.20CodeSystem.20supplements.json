[
    {
        "content": "<p>Assuming you have got a publicly accessible CodeSystems <code>A</code> (like LOINC) and for a specific use case you have to use a set of concepts of <code>A</code>, hence creating ValueSet <code>A_subset_vs</code>. If you need additional properties for these concepts for your use case, what would be the recommended way to go?</p>\n<ul>\n<li>Create a supplement of CodeSystem <code>A</code>, i.e. <code>A_supp</code> and add the attributes there. Subsequently base the ValueSet on <code>A_supp</code>, i.e. <code>A_supp_vs</code>.</li>\n<li>Or is there a way to add the attributes directly to the ValueSet <code>A_subset_vs</code>?</li>\n</ul>",
        "id": 265126174,
        "sender_full_name": "Gabriel Kleinoscheg",
        "timestamp": 1639644555
    },
    {
        "content": "<p>Furthermore, I'm interested in the current status of <a href=\"http://www.hl7.org/fhir/codesystem.html#supplements\">http://www.hl7.org/fhir/codesystem.html#supplements</a> especially regarding impact of Code System supplements on value set expansion. Currently, the IG Publisher adds the information that an expansion (e.g. for <code>A_subset_vs</code>) is not yet supported.</p>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 265177457,
        "sender_full_name": "Gabriel Kleinoscheg",
        "timestamp": 1639670656
    },
    {
        "content": "<p>you do need a code system supplement. They are partially supported, and it's a todo for me</p>",
        "id": 265189740,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639675850
    },
    {
        "content": "<p>Would it also be possible to use ValueSet's designations to add attributes to concepts within a ValueSet?</p>",
        "id": 267450924,
        "sender_full_name": "Gabriel Kleinoscheg",
        "timestamp": 1641827554
    },
    {
        "content": "<p>Designations are not properties.</p>",
        "id": 267457958,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1641830454
    },
    {
        "content": "<p>What may designations (apart from other language representation) be used for? In the last paragraph of <a href=\"http://www.hl7.org/fhir/valueset.html#designations\">http://www.hl7.org/fhir/valueset.html#designations</a> it says that \"designations can provide additional displays for other languages, as well as designations for other purposes\".  According to <a href=\"http://www.hl7.org/fhir/valueset-designation-use.html\">http://www.hl7.org/fhir/valueset-designation-use.html</a> this may be synonyms or fully specified name. What \"other purposes\" would be possible?</p>",
        "id": 267604383,
        "sender_full_name": "Gabriel Kleinoscheg",
        "timestamp": 1641917545
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"376049\">Gabriel Kleinoscheg</span> <a href=\"#narrow/stream/179202-terminology/topic/Understanding.20of.20CodeSystem.20supplements/near/265126174\">said</a>:</p>\n<blockquote>\n<p>Assuming you have got a publicly accessible CodeSystems <code>A</code> (like LOINC) and for a specific use case you have to use a set of concepts of <code>A</code>, hence creating ValueSet <code>A_subset_vs</code>. If you need additional properties for these concepts for your use case, what would be the recommended way to go?</p>\n<ul>\n<li>Create a supplement of CodeSystem <code>A</code>, i.e. <code>A_supp</code> and add the attributes there. Subsequently base the ValueSet on <code>A_supp</code>, i.e. <code>A_supp_vs</code>.</li>\n<li>Or is there a way to add the attributes directly to the ValueSet <code>A_subset_vs</code>?</li>\n</ul>\n</blockquote>\n<p>I have an additional question regarding the supplement CodeSystem <code>A_supp</code>:</p>\n<p>Let's say CodeSystem <code>A</code> has got 100 concepts, in the supplement CodeSystem <code>A_supp</code> I add properties for 10 of the concepts. These are those 10 concepts which I also want in my ValueSet <code>A_supp_vs</code>. </p>\n<p>Do I have to explicitly state which concepts (the 10 I want to have in my ValueSet) go into <code>A_supp_vs</code> with <code>ValueSet.compose.include.concept</code>? Or would it be possible to simply say <code>ValueSet.compose.include.system=A_supp</code> without any <code>ValueSet.compose.include.concept</code>?</p>\n<p>I fear that with the latter I would include <strong>all</strong> concepts from <code>A</code>.</p>",
        "id": 267705564,
        "sender_full_name": "Gabriel Kleinoscheg",
        "timestamp": 1641982953
    },
    {
        "content": "<blockquote>\n<p>What \"other purposes\" would be possible?</p>\n</blockquote>\n<p>pictures is one obvious case. Photos or diagrams, or even videos, for some code systems. Another is other kinds of text representations, the most important of which is consumer friendly display names, or other kinds of display names - the designation use value set has an extensible bindings because we know of many code systems that have purpose specific designations</p>",
        "id": 267959212,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642125928
    },
    {
        "content": "<blockquote>\n<p>Or would it be possible to simply say ValueSet.compose.include.system=A_supp without any ValueSet.compose.include.concept?</p>\n</blockquote>\n<p>no. You have to say that the value set takes concepts from A and define them directly. You can say that the value set interpretation depends on A_supp and make the compose an intensional one that includes all codes with a property value = x where the property values are defined in A_supp</p>",
        "id": 267959361,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642126065
    },
    {
        "content": "<blockquote>\n<p>Do I have to explicitly state which concepts (the 10 I want to have in my ValueSet) go into A_supp_vs with ValueSet.compose.include.concept? Or would it be possible to simply say ValueSet.compose.include.system=A_supp without any ValueSet.compose.include.concept?</p>\n</blockquote>\n<p>You can explicitly include the 10 concepts you want in the value set expansion. </p>\n<p>You can also, I believe, craft a filter that looks for the existence of \"any value\" for the properties your supplement has added to the concepts and since the only concepts with supplemented properties, are those you want, the expansion should be limited to those. <strong>But,</strong> we need some guidance on how to specify the use of the supplement in defining the value set. <span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> or <span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span>  - have you all defined value sets dependent on supplement content?</p>",
        "id": 268084236,
        "sender_full_name": "Robert McClure",
        "timestamp": 1642200668
    },
    {
        "content": "<p>well, you can explicitly indicate that correct processing of a value set depends on a code system supplement - there's an extension for that. Is that the guidance you're referring to?</p>",
        "id": 268153435,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642289875
    },
    {
        "content": "<p>The <a href=\"http://hl7.org/fhir/extension-valueset-supplement.html\">valueset-supplement extension</a> doesn't appear to facilitate defining a value set according to the contents of a supplement, only its existence. <span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span>, I'm assuming that your use case is for properties held in supplemtns, rather than designations.</p>",
        "id": 268155210,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1642292674
    },
    {
        "content": "<p>I was assuming that you can define the members of a value set - use as a filter - values (or the simple existence of) items (properties, relations?) defined as part of a code system supplement. Is that not true? If not, why not?</p>",
        "id": 268205155,
        "sender_full_name": "Robert McClure",
        "timestamp": 1642365032
    },
    {
        "content": "<blockquote>\n<p>The valueset-supplement extension doesn't appear to facilitate defining a value set according to the contents of a supplement, only its existence.</p>\n</blockquote>\n<p>Not quite - not just 'existence' but 'availability'. But Yes, it doesn't say anything about the definition - that you have to do by some kind of intensional definition using properties</p>",
        "id": 268207332,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642367804
    },
    {
        "content": "<blockquote>\n<p>I was assuming that you can define the members of a value set - use as a filter - values (or the simple existence of) items (properties, relations?) defined as part of a code system supplement</p>\n</blockquote>\n<p>Yes, you can. And the logic works whether or not the value set references the code system or not. The extension exists so that the value set can ensure that it exists (and bind to a version of it)</p>",
        "id": 268207391,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642367888
    },
    {
        "content": "<p>Sure. Imagine your supplement defines a new property <code>price</code>, then the ValueSet may have a <code>ValueSet.compose.include</code> filter for <code>price &lt; 100</code> (as well as the extension that links to your supplement). Then, expansion of the ValueSet would (additionally) use the property values from the linked supplement to evaluate the <code>ValueSet.compose</code></p>",
        "id": 268623659,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1642637943
    },
    {
        "content": "<p>As a real-world example, Canada defines a supplement to LOINC that identifies certain codes as being 'orderable'.  We then have value sets that filter to only include orderable codes when making lab ServiceRequests.</p>",
        "id": 268632485,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1642645608
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span> wrt</p>\n<blockquote>\n<p>craft a filter that looks for the existence of \"any value\" for the properties your supplement has added to the concepts</p>\n</blockquote>\n<p>the answer should be yes.  For <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> 's example of adding an <code>orderable</code>property, the appropriate filter would be:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"filter\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"property\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"orderable\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"op\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"exists\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"value\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"true\"</span><span class=\"w\"></span>\n<span class=\"p\">}]</span><span class=\"w\"></span>\n</code></pre></div>\n<p>i.e., match all concepts that have a value defined for the <code>orderable</code> property.</p>",
        "id": 269064071,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1643005154
    },
    {
        "content": "<p>In <a href=\"http://hl7.org/fhir/R4/codesystem-definitions.html#CodeSystem.supplements\">Codesystem.supplements</a> I want to use a code system with version, \"http://loinc.org|2.71\". The validator complains  with <code>CodeSystem http://loinc.org|2.71 cannot be found, so cant check if concepts are valid</code>. I believe that Ontoserver expects a version number. Is there a way to make both happy?<br>\n<span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 275321084,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1647309642
    },
    {
        "content": "<p>The IGPublisher does not display, for a <a href=\"http://hl7.org/fhir/R4/valueset.html\">ValueSet</a>, information about use of the extension <a href=\"http://hl7.org/fhir/StructureDefinition/valueset-supplement\">http://hl7.org/fhir/StructureDefinition/valueset-supplement</a> ?</p>\n<p>It would be nice if it listed the supplement in the metadata table and included the relevant parts of the supplement in the expansion.</p>",
        "id": 275321887,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1647310403
    },
    {
        "content": "<p><code>CodeSystem.supplements</code> is a canonical so a version should be supported by the validator.<br>\nDoes the validator have access to that specific version of LOINC?</p>",
        "id": 275330074,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1647320456
    },
    {
        "content": "<p>I believe so: <a href=\"https://tx.fhir.org/loinc/en-US\">https://tx.fhir.org/loinc/en-US</a></p>",
        "id": 275334845,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1647326567
    },
    {
        "content": "<p>This shows me LOINC is supported: <a href=\"http://tx.fhir.org/r4/metadata?mode=terminology&amp;_format=json\">http://tx.fhir.org/r4/metadata?mode=terminology&amp;_format=json</a><br>\nBut doesn't indicate any version information.</p>\n<p>This gives no results: <a href=\"http://tx.fhir.org/r4/CodeSystem?url=http://loinc.org&amp;_format=json\">http://tx.fhir.org/r4/CodeSystem?url=http://loinc.org&amp;_format=json</a></p>\n<p>Fortunately this does help: <a href=\"http://tx.fhir.org/r4/ValueSet/$expand?url=http://loinc.org/vs&amp;count=1&amp;_format=json\">http://tx.fhir.org/r4/ValueSet/$expand?url=http://loinc.org/vs&amp;count=1&amp;_format=json</a></p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"resourceType\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"ValueSet\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"language\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"en\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"version\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2.71\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"LOINC Value Set - all LOINC codes\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"status\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"active\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"date\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2022-03-15T08:31:21.348Z\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"expansion\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nt\">\"identifier\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"urn:uuid:bdeef301-5117-4a7d-bab5-2c7544bcf6d4\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nt\">\"timestamp\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2022-03-15T08:31:21.348Z\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nt\">\"parameter\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"nt\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"version\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"nt\">\"valueUri\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://loinc.org|2.71\"</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"p\">],</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nt\">\"contains\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"nt\">\"system\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"http://loinc.org\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"nt\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"1-8\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"nt\">\"display\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Acyclovir [Susceptibility]\"</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>So that looks like a bug in the validator</p>",
        "id": 275342335,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1647333213
    }
]