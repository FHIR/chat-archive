[
    {
        "content": "<p>I would like to specify a way to define am implicit value set in UCUM. The implicit value sets would equate to \"all units compatible with this canonical unit\" e.g. all units that have a canonical unit of m for length, or s for time, mol/L for concentration etc. </p>\n<p>We would also define one based on dimension, but I think that most real world units will be more complex than dimension. </p>\n<p>Right now, we can do this in a value set:</p>\n<div class=\"codehilite\"><pre><span></span><code>  <span class=\"nt\">&lt;compose&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://unitsofmeasure.org&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;filter&gt;</span>\n       <span class=\"nt\">&lt;property</span> <span class=\"na\">value=</span><span class=\"s\">&quot;canonical&quot;</span><span class=\"nt\">/&gt;</span>\n       <span class=\"nt\">&lt;op</span> <span class=\"na\">value=</span><span class=\"s\">&quot;=&quot;</span><span class=\"nt\">/&gt;</span>\n       <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;mmol/L&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/filter&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n  <span class=\"nt\">&lt;/compose&gt;</span>\n</code></pre></div>",
        "id": 198260035,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590010485
    },
    {
        "content": "<p>something like <code>http://unitsofmeasure.org/vs?canonical=mmol/L</code></p>",
        "id": 198260129,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590010535
    },
    {
        "content": "<p>Why constrain it to canonical units?</p>",
        "id": 198273528,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590020395
    },
    {
        "content": "<p>I'm not sure what you mean</p>",
        "id": 198277771,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590025190
    },
    {
        "content": "<p>I want to constrain to all units compatible with a unit. What other value sets do you think would be useful?</p>",
        "id": 198277825,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590025220
    },
    {
        "content": "<p>oh. scratch all this. I didn't read far enough. This is already defined</p>",
        "id": 198277837,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590025256
    },
    {
        "content": "<p>okay. where can I find the definition? I was just trying to suggest: ...equate to \"all units compatible with this <del>canonical</del> unit\" e.g. all units that have <del>a</del> the same canonical unit \"</p>",
        "id": 198305905,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590056754
    },
    {
        "content": "<p>so if I have one unit, say inch, and I want to check if it is commensurable with another unit, say mm, I would just check if mm is in the said value set for inch (or vice versa). No need to find their common canonical unit beforehand.</p>",
        "id": 198306141,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590056912
    },
    {
        "content": "<p>well, in practice, that's what it means, yes. <a href=\"https://www.hl7.org/fhir/ucum.html#4.3.4.5\">https://www.hl7.org/fhir/ucum.html#4.3.4.5</a></p>",
        "id": 198307826,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590058252
    },
    {
        "content": "<p>except that the definition is wrong. It should be</p>",
        "id": 198307841,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590058280
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">&lt;ValueSet</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;text&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">&quot;generated&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;div</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class=\"nt\">&gt;</span>\n      [some html that identifies that this value set\n      includes all UCUM expressions that are comparable to the provided expression]\n    <span class=\"nt\">&lt;/div&gt;</span>\n  <span class=\"nt\">&lt;/text&gt;</span>\n  <span class=\"nt\">&lt;identifier</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://unitsofmeasure.org/vs/[expression]&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">&quot;[optional - but recommended - UCUM version]&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Ucum Expressions comparable to [expression]&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Ucum Expressions comparable to [expression]&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">&quot;active&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;date</span> <span class=\"na\">value=</span><span class=\"s\">&quot;[optional date of UCUM release]&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;compose&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://unitsofmeasure.org&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;filter&gt;</span>\n        <span class=\"nt\">&lt;property</span> <span class=\"na\">value=</span><span class=\"s\">&quot;canonical&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;op</span> <span class=\"na\">value=</span><span class=\"s\">&quot;=&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;[expression]&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/filter&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n  <span class=\"nt\">&lt;/compose&gt;</span>\n<span class=\"nt\">&lt;/ValueSet&gt;</span>\n</code></pre></div>",
        "id": 198307859,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590058302
    },
    {
        "content": "<p>Thanks. Still not clear to me, why the term 'canonical' is used here. In the given context, 'comparable' could be more appropriate here.</p>\n<p>Actually, looking at this documentation, I have another issue: It states that \"Display: There is no defined display; the UCUM <strong>code is used directly for the display</strong>\". I wouldn't agree, and we are actually having discussions on this in the European eHDSI project. UCUM is a code, it is not always correct to display the code verbatim. Instead, the correct 'displayable representation' should be derived from the rules in the ISO 80000 series. There is some ongoing collaboration between ISO/TC 215 and ISO/TC 12 on the issue, cf. Mike Glickman. (And in addition to that, people are also requesting a multilingual 'textual representation' like 'millimetros' in Spanish...)</p>",
        "id": 198309762,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590059918
    },
    {
        "content": "<p>I agree that comparable would be clearer, but we'd have to change the definition of the filter instead of changing the definition of the implicit value set. I'm not sure whether anyone has used this... since I haven't and I don't think any tooling supports it, it might be safe to change</p>",
        "id": 198309872,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590060010
    },
    {
        "content": "<p>with regard to the display.. I'm not so sure on that. We can't point to advice that doesn't exist... we can look at it once it does</p>",
        "id": 198309898,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590060040
    },
    {
        "content": "<p>I agree, there is no solution ready to use now. But to directly display the code is not correct, and might even be considered a safety issue. More so if it this rule is also applied to the dreaded {annotations}!</p>",
        "id": 198310091,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590060208
    },
    {
        "content": "<p>But I am leaving the topic of this thread, sorry.</p>",
        "id": 198310197,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590060314
    },
    {
        "content": "<p>My solution is to work on a vaue set level, using ValueSet.compose.include.concept.designation with appropriate values in concept.designation.use. I believe this is one case where \"The system that defines the code or expression doesn't provide a display for this code\", as described in 4.9.6. on <a href=\"https://www.hl7.org/fhir/valueset.html\">https://www.hl7.org/fhir/valueset.html</a></p>",
        "id": 198310935,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590060995
    },
    {
        "content": "<p>Safety example: In UCUM '10*3' means 1000 - and not 30. You don't want to display this to human readers.</p>",
        "id": 198311223,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1590061315
    },
    {
        "content": "<p>no. though in FHIR, you're talking about Quantity where we wouldn't use the display anyway</p>",
        "id": 198311784,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590061790
    }
]