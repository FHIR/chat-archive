[
    {
        "content": "<p>I'm still learning about FHIR and CodeSystem. I haven't been able to find a clear description or an example for how to capture multiple inheritance in a CodeSystem. One parent can be captured by nesting \"concept\"s. Should the additional parenthood relationships be represented with duplicate \"concept\" entries under the other parents, or is the \"codesystem-subsumes\" extension meant for capturing this?</p>",
        "id": 171792248,
        "sender_full_name": "Shahim Essaid",
        "timestamp": 1564162361
    },
    {
        "content": "<p>\"Some code systems define concepts that have multiple parents. If a code system has concepts like this (typically, concepts that are subsumed by more than one other concept), the code system SHOULD NOT be represented using the hierarchy structure in the Code System resource, and the relationships between concepts should be defined using properties. If the hierarchy is used, implementers SHALL use a property to indicate additional parents that are not represented in the structural (nested concepts) hierarchy.\" (<a href=\"http://build.fhir.org/codesystem.html#hierarchy\" target=\"_blank\" title=\"http://build.fhir.org/codesystem.html#hierarchy\">http://build.fhir.org/codesystem.html#hierarchy</a>)</p>",
        "id": 171794993,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1564164381
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"223326\">@Shahim Essaid</span> The best way to represent multi-parentage via the FHIR <a href=\"http://hl7.org/fhir/codesystem.html\" target=\"_blank\" title=\"http://hl7.org/fhir/codesystem.html\">code system</a> resource is to define a <a href=\"http://hl7.org/fhir/codesystem-definitions.html#CodeSystem.property\" target=\"_blank\" title=\"http://hl7.org/fhir/codesystem-definitions.html#CodeSystem.property\">property</a> that is used to define the parentage relationship. For example you could make a property called \"has_parent\" that would be type=code because this property would link the child concept to each of it's parent concepts whereby the parent code would be the value of the property attached to the child concept. BTW, \"has_parent\" would also be a concept in your code system. Make sense?</p>",
        "id": 171946964,
        "sender_full_name": "Robert McClure",
        "timestamp": 1564408368
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span>  <span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span>   thank you both for your help!  I neglected to state in my post that I was working with STU3. The R4 link you provided has more details and I was able to relate it to STU3.  The \"parent\" and \"child\" codes from the \"concept-properties\" coding system is what I was looking for.</p>",
        "id": 172073379,
        "sender_full_name": "Shahim Essaid",
        "timestamp": 1564518412
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span> The actual property to use for this is \"parent\" -- it is already there as a well-known property name</p>",
        "id": 172090398,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1564535060
    },
    {
        "content": "<p>Hi everybody, we would like to create a FHIR representation of the polyhierarchy (multiple parents) of the HPO. Is it best to create a flat list (i.e., no nesting of XML code elements) and represent all parents with properties? Or should we represent as much of the hierarchy as possible with XML nesting and add properties for the rest? Is there an example anywhere to learn from?</p>",
        "id": 217667658,
        "sender_full_name": "Peter Robinson",
        "timestamp": 1606157625
    },
    {
        "content": "<p>v3 ActCode is a polyheirarchy that we represent as a heirarchy with additional properties.</p>",
        "id": 217668390,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606157973
    },
    {
        "content": "<p>I think which is best depends on how many multiple parents there are. ActCode has only a few</p>",
        "id": 217668478,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606158009
    },
    {
        "content": "<p>Will a FHIR server recognize the additional \"parent\" relationships declared through a property? Specifically, in a ValueSet filter that includes based on the \"is-a\" property, will this work for some specific CodeSystem property?</p>",
        "id": 217668585,
        "sender_full_name": "Shahim Essaid",
        "timestamp": 1606158079
    },
    {
        "content": "<p>For example, we (<span class=\"user-mention\" data-user-id=\"361275\">@Peter Robinson</span>  and I) have a ValueSet defined like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>    &lt;include&gt;\n      &lt;system value=&quot;http://github.com/phenopackets/core-ig/CodeSystem/hpo&quot; /&gt;\n      &lt;filter&gt;\n        &lt;property value=&quot;concept&quot; /&gt;\n        &lt;op value=&quot;is-a&quot; /&gt;\n        &lt;value value=&quot;HP:0000118&quot;&gt;&lt;/value&gt;\n      &lt;/filter&gt;\n    &lt;/include&gt;\n</code></pre></div>\n<p>And it gets expanded properly based on the is-a and the concept nesting in the CodeSystem. Does the FHIR specification have a specific property that will add to this expansion if that property is used  to declare HP:0000118 as a parent even if the concept is not nested under HP:0000118? Is this part of the spec or is it up to an implementation to decide if it wants to implement this behavior?</p>\n<p>I'm trying to find the ValueSet that has a couple of properties and if I remember correctly it had a \"parent\" property.</p>",
        "id": 217669255,
        "sender_full_name": "Shahim Essaid",
        "timestamp": 1606158395
    },
    {
        "content": "<p>technically, it should be recognised by the property URLs <a href=\"http://hl7.org/fhir/concept-properties#parent\">http://hl7.org/fhir/concept-properties#parent</a> and <a href=\"http://hl7.org/fhir/concept-properties#child\">http://hl7.org/fhir/concept-properties#child</a></p>",
        "id": 217671623,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606159534
    },
    {
        "content": "<p>I can't say whether existing servers do actually do this correctly</p>",
        "id": 217671641,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606159546
    },
    {
        "content": "<p>So then would it be a good strategy to represent as much as we can in the XML structure (because existing servers may not do the right thing) and add extra parents with properties (this affects about 5% of HPO terms) -- and we can hope that at least some servers will do the right thing?</p>",
        "id": 217761320,
        "sender_full_name": "Peter Robinson",
        "timestamp": 1606228515
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"361275\">@Peter Robinson</span> When there is a polyhierarchy (multiple parents), I think the decision would depend on whether the most important consideration is to get the maximum available representation of the hierarchy on the maximum number of servers, even if in some cases that representation might not actually be complete (using a \"mixed\" approach with both nesting and the parent/child properties), or if it's more important to ensure that if the hierarchy is represented at all that it is a complete representation (using the parent/child properties only).  I think my general inclination, when possible, would be to test my server(s) to ensure that they do handle the parent/child properties and then use that approach consistently.  Mixing the two approaches seems to me a bit messy and potentially confusing and error-prone.  But other practical considerations still might end up making that the preferred option in some cases.</p>",
        "id": 217766569,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1606230807
    },
    {
        "content": "<p>Ontoserver does polyhierarchy using parent and child. HPO is one of our biggest examples of it</p>",
        "id": 218239643,
        "sender_full_name": "Jim Steel",
        "timestamp": 1606697963
    },
    {
        "content": "<p>We (and our clients using HPO) use a different URL for HPO though. <span class=\"user-mention\" data-user-id=\"191345\">@Alejandro Metke</span> is the guy to talk to about it.</p>",
        "id": 218239707,
        "sender_full_name": "Jim Steel",
        "timestamp": 1606698027
    },
    {
        "content": "<p>I agree with <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> and think that mixing both approaches might be confusing. I would just use the parent property.</p>",
        "id": 218240826,
        "sender_full_name": "Alejandro Metke",
        "timestamp": 1606699847
    },
    {
        "content": "<p>Simplicity would be good.</p>",
        "id": 218248345,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1606711305
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"361275\">@Peter Robinson</span> <span class=\"user-mention\" data-user-id=\"223326\">@Shahim Essaid</span> Please note that if you are building an HL7 FHIR IG that includes references to an external code system you <strong>MUST</strong> contact HTA (<span class=\"user-mention\" data-user-id=\"235766\">@Julie James</span> <span class=\"user-mention\" data-user-id=\"195036\">@Carol Macumber</span>) to register the external code system and confirm the correct canonical uri. <span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> , what url do you have and did you get it from the HPO authority?</p>",
        "id": 218371559,
        "sender_full_name": "Robert McClure",
        "timestamp": 1606787116
    },
    {
        "content": "<p>I'll have to defer to <span class=\"user-mention\" data-user-id=\"191345\">@Alejandro Metke</span> on that, I'm afraid.</p>",
        "id": 218371848,
        "sender_full_name": "Jim Steel",
        "timestamp": 1606787402
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span>, the HPO code system we use is generated with the <a href=\"https://github.com/aehrc/fhir-owl\">FHIR OWL</a> application, which by default uses the source OWL ontology IRI as the code system URL. In this case, this is <em>http://purl.obolibrary.org/obo/hp.owl</em>.</p>",
        "id": 218372199,
        "sender_full_name": "Alejandro Metke",
        "timestamp": 1606787777
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"361275\">@Peter Robinson</span> meet <span class=\"user-mention\" data-user-id=\"235766\">@Julie James</span> &amp; <span class=\"user-mention\" data-user-id=\"195036\">@Carol Macumber</span> :-)<br>\nIt would be great to have HTA &amp; HPO confirmation that the URI from the HPO OWL <code>http://purl.obolibrary.org/obo/hp.owl</code> is the appropriate URI to use for the FHIR CodeSystem (this would seem non-controversial), but furthermore have agreement on the CodeSystem version (the OWL uses, AFAIK, a URI that has a varying date of the form YYYY-MM-DD).  It would help implementers if the FHIR version used a simple datestamp like YYYYMMDD. Finally, we also need an agreed URI for the \"all codes\" ValueSet.</p>\n<p>Ultimately, I think we'll want an HPO-specific page in the FHIR spec. and address the issue of cross-code system hierarchy (i.e., the parent properties being Coding-typed, not code-typed).</p>",
        "id": 218386430,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1606806300
    },
    {
        "content": "<p><a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7153051/\">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7153051/</a></p>",
        "id": 218386446,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1606806334
    },
    {
        "content": "<p>We (HTA) have the HPO page <a href=\"https://confluence.hl7.org/display/TA/HPO+The+Human+Phenotype+Ontology\">https://confluence.hl7.org/display/TA/HPO+The+Human+Phenotype+Ontology</a> but sadly no official URI (yet).  The Phenopackets team for the Connectathon may be able to help here....We should reach out to <span class=\"user-mention\" data-user-id=\"340004\">@Davera Gabriel</span> as I think she is probably the terminology link for this</p>",
        "id": 218414566,
        "sender_full_name": "Julie James",
        "timestamp": 1606825594
    },
    {
        "content": "<p>Yes:  will be working with <span class=\"user-mention\" data-user-id=\"361275\">@Peter Robinson</span> and the folks at JaxLab to update the HTA records thus.  We have a meeting Thursday with Peter &amp; his team this week and can, at a minimum, discuss plans the HPO URI then.  <span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span>  we cannot have the HTA records indicate a URI which resolves to an .owl file.  We have this issue with another terminology in the HTA records and are in discussion with them to similarly have that changed.  As such <span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> I think it is safe to assume that the purl you indicate above will not be resolved URI in the HTA records.  Nonetheless as HPO will be needed to support the January Connectathon, resolution will not be ongoing nor open-ended.  Please stand-by as we work through the solution, and I am happy to collect information / comments on this issue and bring these to the HTA for review, or assist in any way I can.</p>",
        "id": 218438252,
        "sender_full_name": "Davera Gabriel",
        "timestamp": 1606837257
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span> <span class=\"user-mention\" data-user-id=\"223326\">@Shahim Essaid</span> <span class=\"user-mention\" data-user-id=\"191345\">@Alejandro Metke</span> please also note my comments above (I'm not sure if you will be notified by Zulip...)</p>",
        "id": 218438568,
        "sender_full_name": "Davera Gabriel",
        "timestamp": 1606837394
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179202-terminology/topic/How.20to.20represent.20multiple.20inheritance.20in.20a.20CodeSystem/near/217671623\">said</a>:</p>\n<blockquote>\n<p>technically, it should be recognised by the property URLs <a href=\"http://hl7.org/fhir/concept-properties#parent\">http://hl7.org/fhir/concept-properties#parent</a> and <a href=\"http://hl7.org/fhir/concept-properties#child\">http://hl7.org/fhir/concept-properties#child</a></p>\n</blockquote>\n<p>Does the publisher recognize these parent/child properties? I'm unable to get this to work for the publisher itself.</p>\n<p>For example, I have the following in a test CodeSystem and one implicitly defined ValueSet that should include the code added with the parent/child.</p>\n<p>In the CodeSystem:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &lt;property&gt;\n    &lt;code value=&quot;parent&quot;/&gt;\n    &lt;uri value=&quot; http://hl7.org/fhir/concept-properties#parent&quot;/&gt;\n    &lt;type value=&quot;code&quot;/&gt;\n  &lt;/property&gt;\n  &lt;property&gt;\n    &lt;code value=&quot;child&quot;/&gt;\n    &lt;uri value=&quot; http://hl7.org/fhir/concept-properties#child&quot;/&gt;\n    &lt;type value=&quot;code&quot;/&gt;\n  &lt;/property&gt;\n</code></pre></div>\n<p>A child:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &lt;concept&gt;\n    &lt;code value=&quot;HP:0032223&quot; /&gt;\n    &lt;display value=&quot;Blood group&quot; /&gt;\n    &lt;property&gt;\n      &lt;code value=&quot;parent&quot; /&gt;\n      &lt;valueCode value=&quot;HP:0000118&quot;/&gt;\n    &lt;/property&gt;\n  &lt;/concept&gt;\n</code></pre></div>\n<p>The parent:</p>\n<div class=\"codehilite\"><pre><span></span><code>    &lt;concept&gt;\n      &lt;code value=&quot;HP:0000118&quot; /&gt;\n      &lt;display value=&quot;Phenotypic abnormality&quot; /&gt;\n\n      &lt;property&gt;\n        &lt;code value=&quot;child&quot;/&gt;\n        &lt;valueCode value=&quot;HP:0032223&quot;/&gt;\n      &lt;/property&gt;\n</code></pre></div>\n<p>Is the above the correct way to define/declare a parent/child relationship?</p>\n<p>If it is, the publisher is not recognizing this.  It doesn't' show the child as a child in the web page built for the CodeSystem (in the indented table and the \"Lvl\" value), and the ValueSet that is implicitly defined to include all the children of that parent is not showing this example child in the built expansions.</p>\n<p>One basic use case that is dependent on the publisher (as opposed to servers) is for data entry apps to be able to retrieve the latest expansions of various ValueSets defined in the IG and those expansions depend on the hierarchy.  Here is an example of this idea: <a href=\"http://phenopackets.org/core-ig/master/ValueSet-phenotypic-severity.html\">http://phenopackets.org/core-ig/master/ValueSet-phenotypic-severity.html</a> This ValueSet expands the concept to all the children, excluding the top parent, and it does work with nested concept declarations but it doesn't seem to work for a parent/child based hierarchy.</p>",
        "id": 218457857,
        "sender_full_name": "Shahim Essaid",
        "timestamp": 1606845241
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"340004\">@Davera Gabriel</span> can you explain further why it matters what the URI resolves to?  It is a URI(dentifier), not a URL(ocation) in both the FHIR CodeSystem and the OWL Ontology identifier use cases.<br>\nIf it is desired that something human-readable can be returned _if_ someone treats it as a URL, then the Accept header can be used to return HTML or something else other than OWL (XML, RDF, functional syntax, ???) as a request response.</p>",
        "id": 218497023,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1606865399
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> It matters because the code system is not an owl file, it happens that one representation of it is in owl, but not all representations. HTA is correct in deciding that a format-specific uri will not be allowed. And if all the url/uri loving folks <em>really</em> didn't care what the words meant in the canonical FHIR url, then we could have saved us all <strong>immeasurable grief</strong> by continuing to use OIDs. This ship has sailed, time to get on.</p>",
        "id": 218499138,
        "sender_full_name": "Robert McClure",
        "timestamp": 1606867097
    },
    {
        "content": "<p>Well we can have a discussion about whether 'format' has any meaning at all in the context of a URI -- it is purely convention that .xxx is interpreted as format xxx, and further that OWL is not even a format but rather a model with many renderings (much like FHIR).<br>\n<em>If</em> HPO has decided that the identifier for the terminology happens to end in .owl, then who are we / HTA to argue?  But HTA insisting on a URI that is different to an already established URI (as currently used in the OWL file) creates work and potential confusion for all implementers and consumers that seems entirely and otherwise unnecessary.</p>",
        "id": 218517694,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1606887947
    },
    {
        "content": "<p>If HPO says they want .owl to mean the code system after presenting the issue, then I suspect HTA will accept that. But honestly, this cognitive dissonance on part of the uri having meaning and part not is confusing at best.</p>",
        "id": 218553379,
        "sender_full_name": "Robert McClure",
        "timestamp": 1606914804
    },
    {
        "content": "<p>Dear everybody, we are moving forward with the HPO code system. I was wondering if there is any advice about the easiest way to code this -- is there a class in HAPI that helps with this or should we use some general XML library? I could not find anything in the documentation. Also, where should the codesystem live? Is it sufficient for the FHIR community of the code lives as a file on the HPO site with a standard ULR (PURL)?</p>",
        "id": 234190566,
        "sender_full_name": "Peter Robinson",
        "timestamp": 1618245442
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"361275\">@Peter Robinson</span>. I've replied with some advice directly in your GitHub repo (see <a href=\"https://github.com/monarch-initiative/phenol/issues/310#issuecomment-731096310\">https://github.com/monarch-initiative/phenol/issues/310#issuecomment-731096310</a>). Defintively better to use HAPI instead of a general XML or JSON library. There is documentation about working with the FHIR model here: <a href=\"https://hapifhir.io/hapi-fhir/docs/model/working_with_resources.html\">https://hapifhir.io/hapi-fhir/docs/model/working_with_resources.html</a>. The other documentation you will need to look at is the CodeSystem resource page here: <a href=\"https://www.hl7.org/fhir/codesystem.html\">https://www.hl7.org/fhir/codesystem.html</a>.</p>",
        "id": 234252587,
        "sender_full_name": "Alejandro Metke",
        "timestamp": 1618275348
    },
    {
        "content": "<p>Thanks, Alejandro, this is working now. We want to move to making the FHIR version part of the HPO build. Is it correct that we should not add all of the data about each term (definition, comment, synomym, alt_id, etc etc) to this because it will mainly be used to check for validity?</p>",
        "id": 234371400,
        "sender_full_name": "Peter Robinson",
        "timestamp": 1618336123
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"361275\">@Peter Robinson</span>  Nice to meet you again here.<span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span><br>\nIMO, a more complete version would be better.  A partial version might limit some potential use case(s).</p>",
        "id": 234485942,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1618401725
    },
    {
        "content": "<p>Hi everybody, I have created a small app based on your feedback. <a href=\"https://github.com/monarch-initiative/pyrophen\">https://github.com/monarch-initiative/pyrophen</a> The app created a FHIR CodeSystem from the HPO</p>",
        "id": 235007866,
        "sender_full_name": "Peter Robinson",
        "timestamp": 1618683884
    }
]