[
    {
        "content": "<p>I'm getting ready to upgrade the terminology server, and I've done quite a bit of work under the hood around quality, consistency, and reliability. As part of that, I've found and fixed a bug around the use of ATC. The server is now reporting that this code is an error:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://www.whocc.no/atc\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"N02AA\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Barbiturates and derivatives\"</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 213869069,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603160412
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> do you remember what the source for ATC is?</p>",
        "id": 213869080,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603160436
    },
    {
        "content": "<p>(I mean, what did we use?)</p>",
        "id": 213869086,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603160453
    },
    {
        "content": "<p>does anyone know whether that's actually a valid code or not?</p>",
        "id": 213869095,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603160464
    },
    {
        "content": "<p>All of the ATC codes that we have were obtained and verified from the WHO ATC browser.  It's another one where we do have a source for the complete set of codes.  But the ones that we do have should definitely be correct.  I'll check that one.</p>",
        "id": 213869252,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603160661
    },
    {
        "content": "<p>OK.  That's a valid code, but it's definitely the wrong description - it should be \"Natural opium alkaloids\".  I'll check the source.</p>",
        "id": 213869343,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603160795
    },
    {
        "content": "<p>UMLS Concept: [C3653996]  Natural opium alkaloid analgesics</p>\n<p>Natural opium alkaloids [A22730921/ATC/PT/N02AA]</p>",
        "id": 213869626,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603161222
    },
    {
        "content": "<p>The info above is copied from NLM UTS</p>",
        "id": 213869673,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603161257
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> is right.</p>",
        "id": 213869693,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603161303
    },
    {
        "content": "<p>That code isn't in the fhir.tx.support.r4/packages/CodeSystem-atc.json source file.  Neither is a code with the description \"Barbiturates and derivatives\" (which is the description for the code 'N03AA').  A $lookup on <a href=\"http://tx.fhir.org\">tx.fhir.org</a> returns \"Unable to find code\" for both of those codes - which is as I expected.</p>",
        "id": 213869764,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603161379
    },
    {
        "content": "<p>indeed that'll happen since you just referred to the master</p>",
        "id": 213869781,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603161410
    },
    {
        "content": "<p>UMLS Concept: [C3653617]  Barbiturates and derivatives</p>\n<p>Barbiturates and derivatives [A22728581/ATC/PT/N03AA]</p>",
        "id": 213869794,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603161431
    },
    {
        "content": "<p>OK.  Maybe I jumped in the middle and don't even know what the question is?  But I do know that 'N02AA' and \"Barbiturates and derivatives\" don't match, as well as the other details that Lin and I've confirmed.</p>",
        "id": 213869877,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603161531
    },
    {
        "content": "<p>well, I suspected that the atc source wasn't correct, and you've confirmed that. So the question then becomes, can we make it correct?</p>",
        "id": 213869899,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603161587
    },
    {
        "content": "<p>Use NLM UTS as a source for this?</p>",
        "id": 213869954,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603161657
    },
    {
        "content": "<p>I think we prefer not to use UTS as a primary source for any of the things that feed it</p>",
        "id": 213869970,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603161684
    },
    {
        "content": "<p>Understood</p>",
        "id": 213869977,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603161703
    },
    {
        "content": "<p>ATC does have a pretty wide adoption but it's not a good code system.</p>",
        "id": 213870062,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603161805
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  So, by that I'm assuming that you mean that there is another source for ATC codes other than the package?  It's not included in fhirserver.ini.</p>",
        "id": 213870151,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603161939
    },
    {
        "content": "<p>well, not a FHIR source. Only would be WHOCC itself, or UMLS if necessary</p>",
        "id": 213870221,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603162015
    },
    {
        "content": "<p>So I'm obviously still confused.  I don't know what ATC source isn't correct.  The one that we have in the FHIR package json file <strong>is</strong> indeed correct.</p>",
        "id": 213870249,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603162081
    },
    {
        "content": "<p>is it? It doesn't have N02AA in it?</p>",
        "id": 213870295,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603162108
    },
    {
        "content": "<p>No, it doesn't have that code - and that's why it's not found when you do a $lookup on <a href=\"http://tx.fhir.org/r4\">tx.fhir.org/r4</a> for it (I didn't actually check r3).</p>",
        "id": 213870314,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603162183
    },
    {
        "content": "<p>right. So, i'm asking how we update it.</p>",
        "id": 213870350,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603162202
    },
    {
        "content": "<p>Ultimate authoritative  source should be WHO</p>",
        "id": 213870377,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603162245
    },
    {
        "content": "<p>I can easily add it to the package.  So far I've done that manually as I've had requests, and just added what has been asked for - with all of them verified in the WHO browser.  But we only have a very limited number of codes right now.</p>",
        "id": 213870394,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603162290
    },
    {
        "content": "<p>But it's not open.</p>",
        "id": 213870396,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603162292
    },
    {
        "content": "<p>Correct, <span class=\"user-mention\" data-user-id=\"192103\">@Lin Zhang</span>.  That's why I've been doing it one by one from the WHO browser. :(</p>",
        "id": 213870454,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603162351
    },
    {
        "content": "<p>If so, regardless its license, atc could be extracted from UMLS automatically by some tools from UMLS and/or Github.</p>",
        "id": 213870686,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603162705
    },
    {
        "content": "<p>And I think maybe I finally understand <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>'s original issue. :)  The data instance that you posted to start this returns an error because the server doesn't support the 'N02AA' code.  Plus, if the server <strong>did</strong> support the 'N02AA'  code then it would also return an error because the \"Barbiturates and derivatives\" description is incorrect for that code.  The two issues were being mixed together (at least in my mind).</p>",
        "id": 213870720,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603162781
    },
    {
        "content": "<p>Agree.</p>",
        "id": 213870776,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603162815
    },
    {
        "content": "<p>To <span class=\"user-mention\" data-user-id=\"192103\">@Lin Zhang</span>'s point.  In the absence of any known source by any of us (at least one that's freely available), should we, in this case, consider obtaining this content via the UMLS?  And the next question is, if we did that would we be violating licensing terms from the WHO (and particularly the WHO Collaborating Centre for Drug Statistics Methodology, run by the Norwegian Institute of Public Health, who manages it)?  I suspect that probably that would violate license terms, but we could try to verify.  It's far safer, although also far less satisfactory, to include the codes one by one as obtained from the publicly available Web search app.</p>",
        "id": 213871059,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603163190
    },
    {
        "content": "<p>I see.  What I said is just a \"what-if\".</p>",
        "id": 213871161,
        "sender_full_name": "Lin Zhang",
        "timestamp": 1603163336
    },
    {
        "content": "<p>In the meantime, since we're discussing it and I have it open, and I was hoping to do some work on the terminology content tonight anyway, I can just go ahead and add those two codes (plus the content in the surrounding hierarchy) to the others that we already have in the package.</p>",
        "id": 213871252,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603163466
    },
    {
        "content": "<p>sure. and  commit it</p>",
        "id": 213871837,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603164341
    },
    {
        "content": "<p>Yes.</p>",
        "id": 213871971,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603164381
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  ATC package updates committed and pushed.</p>",
        "id": 213874469,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603168257
    },
    {
        "content": "<p>Just pushed another update with minor fixes for a validation error and warning.</p>",
        "id": 213875964,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1603170529
    },
    {
        "content": "<p>ok published</p>",
        "id": 213877270,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1603172728
    }
]