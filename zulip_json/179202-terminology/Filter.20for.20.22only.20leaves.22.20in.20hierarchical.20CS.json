[
    {
        "content": "<p>I need some help from the terminology experts <span aria-label=\"smile\" class=\"emoji emoji-263a\" role=\"img\" title=\"smile\">:smile:</span> <br>\nHow do I define a filter to create a ValueSet expansion on a hierarchichal CodeSystem, that only contains the leaves (aka only concepts that have no child concept)...?</p>",
        "id": 203684817,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594625214
    },
    {
        "content": "<p>You could use a filter on 'child' with operator exists and value false</p>",
        "id": 203686208,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594626439
    },
    {
        "content": "<p>Ooof. It's so obvious!<br>\nI must have been looking through the operator codes without seeing the \"exists\" value <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span> <br>\n...need more coffee...<br>\nThanks!</p>",
        "id": 203687887,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594627826
    },
    {
        "content": "<p>But hold on. <br>\nAre filters <em>not</em> machine readable? I'd have expected a FHIRPath expression somewhere in there...</p>\n<p>So in my case the filter would be something like</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">&lt;filter&gt;</span>\n   <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;has-no-children&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">&quot;allows selection of concepts without child concepts&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;operator</span> <span class=\"na\">value=</span><span class=\"s\">&quot;exists&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;false&quot;</span><span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;filter&gt;</span>\n</code></pre></div>\n\n\n<p>But the information that this needs to be applied to the CodeSystem.concept.descentants().concept path is not part of the filter definition? Is that correct? How would the system know how to use the filter? Is that just business logic?</p>",
        "id": 203688801,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594628531
    },
    {
        "content": "<p>The other thing I don't understand:<br>\nWhy am I required to fix the value of the filter in the CodeSystem, when the ValueSet has the option to apply a value to the filter...?<br>\nIn the above example I would have expected to be able to just say the filter \"checks for child concepts\" and leave it to the valueset <em>using</em> the filter to decide whether the value should be true or false...</p>",
        "id": 203689096,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594628729
    },
    {
        "content": "<p>I don't understand that response. The code system defines what filters you can use, and the value set uses them. Michael was proposing a value set filter</p>",
        "id": 203690731,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594630005
    },
    {
        "content": "<p>But the ValueSet filter can use either a property or a filter of the CodeSystem, since child concept is not a property, i assumed I needed to define a filter on the CodeSystem first, before a ValueSet can use it, no?</p>",
        "id": 203694699,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594632957
    },
    {
        "content": "<p>All properties also manifest as filters</p>",
        "id": 203698055,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594635441
    },
    {
        "content": "<p>parent and child are well-known properties defined implicitly for any CodeSystem with hierarchy and thus also available as filters.</p>",
        "id": 203698147,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594635508
    },
    {
        "content": "<p>You would thus use them in the ValueSet definition.</p>",
        "id": 203698186,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594635556
    },
    {
        "content": "<p>Ok, so no Filter definition needed on the CodeSystem?<br>\nIs this correct for the ValueSet filter?</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">&lt;filter&gt;</span>\n  <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;concept&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;op</span> <span class=\"na\">value=</span><span class=\"s\">&quot;exists&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;false&quot;</span><span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;filter&gt;</span>\n</code></pre></div>\n\n\n<p>And the Terminology server would know that the code \"concept\" refers to the child element <code>concept</code> of CodeSystem.concept?<br>\nThis seems a bit \"magical\" to me... But it makes sense that the default path for every property and filter would always be CodeSystem.concept...</p>",
        "id": 203703359,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594639578
    },
    {
        "content": "<p>The value for code would be child: '&lt;code value=\"child\" /&gt;'</p>",
        "id": 203703557,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594639756
    },
    {
        "content": "<p>It's saying match a concept if the concept's child property does not exist.</p>",
        "id": 203703646,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594639826
    },
    {
        "content": "<p>I think you're getting tripped up thinking about Fhirpath - there is no fhirpath here</p>",
        "id": 203703696,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594639883
    },
    {
        "content": "<p>But yes. The filters are applied relative to each concept, and the filter that references the concept itself is 'concept' (rather than say 'self' or 'this').</p>",
        "id": 203704489,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594640536
    },
    {
        "content": "<p>Where is defined what \"child\" means...?I feel like I'm missing something...<br>\nIt's not an element, nor a SearchParameter. How can it be \"well known\"?</p>",
        "id": 203705041,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594641009
    },
    {
        "content": "<p>Oh is it this <a href=\"http://hl7.org/fhir/concept-properties#child\">http://hl7.org/fhir/concept-properties#child</a> : code<br>\nin <a href=\"http://hl7.org/fhir/codesystem.html#status\">http://hl7.org/fhir/codesystem.html#status</a> !?</p>",
        "id": 203705115,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594641072
    },
    {
        "content": "<p>Oh well. It's obvious, if you know what you're looking for <span aria-label=\"smirk\" class=\"emoji emoji-1f60f\" role=\"img\" title=\"smirk\">:smirk:</span></p>",
        "id": 203705189,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594641134
    },
    {
        "content": "<p>I somehow didn't expect that bit of information under the \"Status\" heading <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span> <br>\nI actually found it by using a full text search on \"child\" on that page...</p>",
        "id": 203705349,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1594641272
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span>  perhaps we might have a discussion on searching for leaf nodes in tomorrow's SNOMED on FHIR call?</p>",
        "id": 203779377,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1594679395
    },
    {
        "content": "<p>it's on my agenda to clarify the use of properties in general, and specifically for filters, in R5</p>",
        "id": 203779624,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594679542
    },
    {
        "content": "<p>Yes, <a href=\"http://hl7.org/fhir/codesystem.html#properties\">http://hl7.org/fhir/codesystem.html#properties</a> should really mention the standard / well-known properties and filters.<br>\nI wonder whether there should also be some kind of (extensible) binding for CodeSystem.property.code etc to further document this?</p>",
        "id": 203791293,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594690871
    },
    {
        "content": "<p>Re leaf nodes and SNOMED, sure.  Because of SNOMED's ECL there are other ways to express this too.</p>",
        "id": 203791386,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594690979
    },
    {
        "content": "<p>I'll note also that this example is badly out of date <a href=\"http://hl7.org/fhir/codesystem-snomedct.html\">http://hl7.org/fhir/codesystem-snomedct.html</a> -- the property code values are wrong</p>",
        "id": 203791485,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594691091
    }
]