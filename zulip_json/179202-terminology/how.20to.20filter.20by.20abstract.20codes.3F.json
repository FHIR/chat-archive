[
    {
        "content": "<blockquote>\n<p>the CLD for the value set \"all non-abstract codes\" </p>\n</blockquote>\n<p>I don't know how to do this.  I looked and did not see a way.</p>",
        "id": 203868934,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594751101
    },
    {
        "content": "<p>is it .contains.abstract false?</p>",
        "id": 203870896,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594752047
    },
    {
        "content": "<p>Its some filter </p>\n<div class=\"codehilite\"><pre><span></span><code> &lt;include&gt;  &lt;!-- 1..* Include one or more codes from a code system or other value set(s) --&gt;\n   &lt;system value=&quot;[uri]&quot;/&gt;&lt;!-- ?? 0..1 The system the codes come from --&gt;\n   &lt;filter&gt;  &lt;!-- ?? 0..* Select codes/concepts by their properties (including relationships) --&gt;\n    &lt;property value=&quot;[code]&quot;/&gt;&lt;!-- 1..1 A property/filter defined by the code system --&gt;\n    &lt;op value=&quot;[code]&quot;/&gt;&lt;!-- 1..1 = | is-a | descendent-of | is-not-a | regex | in | not-in | generalizes | exists --&gt;\n    &lt;value value=&quot;[string]&quot;/&gt;&lt;!-- 1..1 Code from the system, or regex criteria, or boolean value for exists --&gt;\n   &lt;/filter&gt;\n&lt;/include\n</code></pre></div>",
        "id": 203875421,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594754496
    },
    {
        "content": "<p>Moehrke Research (<span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> and <span class=\"user-mention\" data-user-id=\"237342\">@ryan moehrke</span> ) have failed, trying all kinds of .filter mechanics.</p>",
        "id": 203881392,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594757490
    },
    {
        "content": "<p>so the first thing to do is to make sure that the code system actually defines what is abstract or not. Here's what's required, for Eric's code system of focus:</p>",
        "id": 203883261,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594758423
    },
    {
        "content": "<p><a href=\"https://github.com/FHIR/packages/commit/04d4796595f55769756e6e36ebcffda514e4d909\">https://github.com/FHIR/packages/commit/04d4796595f55769756e6e36ebcffda514e4d909</a></p>",
        "id": 203883281,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594758437
    },
    {
        "content": "<p>having done that, then you write a filter based on the notSelectable property:</p>",
        "id": 203883511,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594758524
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">&lt;filter&gt;</span>\n  <span class=\"nt\">&lt;property</span> <span class=\"na\">value=</span><span class=\"s\">&quot;abstract&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;op</span> <span class=\"na\">value=</span><span class=\"s\">&quot;=&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;false&quot;</span><span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;/filter&gt;</span>\n</code></pre></div>",
        "id": 203883656,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594758598
    },
    {
        "content": "<p>I tried that</p>",
        "id": 203884588,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594758965
    },
    {
        "content": "<p>which according to <a href=\"http://build.fhir.org/codesystem.html#filters\">http://build.fhir.org/codesystem.html#filters</a> we should not need to add that filter as all properties magically include the \"=\" and \"in\"... but I tried it anyway</p>",
        "id": 203885050,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594759181
    },
    {
        "content": "<p>I have also tried including the codeSystem, and then exclude the codeSystem with filter of notSelectable.. got nothing expanded at all</p>",
        "id": 203885650,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594759469
    },
    {
        "content": "<blockquote>\n<p>according to <a href=\"http://build.fhir.org/codesystem.html#filters\">http://build.fhir.org/codesystem.html#filters</a> we should not need to add that filter as all properties magically include the \"=\" and \"in\"...</p>\n</blockquote>\n<p>I have no idea what that means</p>",
        "id": 203885722,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594759517
    },
    {
        "content": "<p>well, I didn't trust that statement in the FHIR spec either.. hence why I tried it explicitly.</p>",
        "id": 203892146,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594762959
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> did yo get this working? I have tried other things still not working.</p>",
        "id": 203993641,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594837529
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> can you help me? when I use any filter I get no expansion. I have even tried to include and exclude. My repo is <a href=\"https://github.com/IHE/FormatCode\">https://github.com/IHE/FormatCode</a></p>",
        "id": 204093531,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594910813
    },
    {
        "content": "<p>It is not working for me either</p>",
        "id": 204146684,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594935554
    },
    {
        "content": "<p>It means that for every property, there is an (implicit) filter with (at least) those two operators</p>",
        "id": 204147375,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594935945
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> does it work if you use a different terminology server?</p>",
        "id": 204147544,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594936024
    },
    {
        "content": "<p>I don't know how to do that</p>",
        "id": 204148905,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594936814
    },
    {
        "content": "<p>You can call the igpublisher with -tx and the URL for another tx server.  Eg <a href=\"https://r4.ontoserver.csiro.au/fhir\">https://r4.ontoserver.csiro.au/fhir</a></p>",
        "id": 204149024,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1594936908
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span>  what have you tried? Have you cleaned out the cache?</p>",
        "id": 204172617,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594964701
    },
    {
        "content": "<p>I have not tried cleaning the cache, which cache shall I clean with what detergent?</p>",
        "id": 204194148,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594984438
    },
    {
        "content": "<p>you have a txCache. Delete the files in there</p>",
        "id": 204194350,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594984623
    },
    {
        "content": "<p>oh. I know why you mightn't be seeing that. I'll have to debug</p>",
        "id": 204194372,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594984645
    },
    {
        "content": "<p>is what you have committed to master?</p>",
        "id": 204194388,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594984664
    },
    {
        "content": "<p>yes</p>",
        "id": 204194677,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594984876
    },
    {
        "content": "<p>ok I'll look tomorrow</p>",
        "id": 204195306,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594985399
    },
    {
        "content": "<p>cleaning the txCache did not help</p>",
        "id": 204195581,
        "sender_full_name": "John Moehrke",
        "timestamp": 1594985633
    },
    {
        "content": "<p>This is what I see the in txcache (when using Ontoserver):</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"p\">{</span><span class=\"nt\">&quot;hierarchical&quot;</span> <span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">,</span> <span class=\"nt\">&quot;valueSet&quot;</span> <span class=\"p\">:{</span>\n  <span class=\"nt\">&quot;resourceType&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;ValueSet&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;compose&quot;</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;include&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n      <span class=\"nt\">&quot;system&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode&quot;</span><span class=\"p\">,</span>\n      <span class=\"nt\">&quot;filter&quot;</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n        <span class=\"nt\">&quot;property&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;notSelectable&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;op&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;value&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;false&quot;</span>\n      <span class=\"p\">}]</span>\n    <span class=\"p\">}]</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}}</span><span class=\"err\">####</span>\n<span class=\"err\">e:</span> <span class=\"p\">{</span>\n  <span class=\"nt\">&quot;error&quot;</span> <span class=\"p\">:</span> <span class=\"s2\">&quot;Error from server: Error:org.hl7.fhir.r5.model.CodeableConcept@a357c3e\\r\\n&quot;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n\n<p>the default  Tx has the error text as:<br>\n<code>  \"error\" : \"Error from server: Unable to provide support for code system http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode\"\n</code></p>",
        "id": 204266304,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1595024429
    },
    {
        "content": "<p>it's an issue in the publisher's mini terminology server</p>",
        "id": 204281762,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1595043577
    },
    {
        "content": "<p>fixed next release</p>",
        "id": 204491164,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1595283861
    },
    {
        "content": "<p>I don't think this is working yet.   <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> did you get yours working?</p>",
        "id": 205150165,
        "sender_full_name": "John Moehrke",
        "timestamp": 1595873700
    },
    {
        "content": "<p>not yet</p>",
        "id": 205297759,
        "sender_full_name": "Eric Haas",
        "timestamp": 1595974956
    },
    {
        "content": "<p>the code is certainly working ...</p>",
        "id": 205297798,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1595974988
    },
    {
        "content": "<p>teach me</p>",
        "id": 205355272,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596029059
    },
    {
        "content": "<p>You <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  have full access to my FormatCode IG.</p>",
        "id": 205355337,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596029099
    },
    {
        "content": "<p>here is my ValueSet\"</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;ValueSet xmlns=&quot;http://hl7.org/fhir&quot; xmlns:xhtml=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\n  &lt;id value=&quot;us-core-provider-specialty&quot;/&gt;\n  &lt;url value=&quot;http://hl7.org/fhir/us/core/ValueSet/us-core-provider-specialty&quot;/&gt;\n  &lt;version value=&quot;1.0.1&quot;/&gt;\n  &lt;name value=&quot;USCoreProviderSpecialityNucc&quot;/&gt;\n  &lt;title value=&quot;US Core Provider Speciality (NUCC)&quot;/&gt;\n  &lt;status value=&quot;active&quot;/&gt;\n  &lt;date value=&quot;2019-05-21&quot;/&gt;\n  &lt;publisher value=&quot;HL7 US Realm Steering Committee&quot;/&gt;\n  &lt;contact&gt;\n    &lt;telecom&gt;\n      &lt;system value=&quot;other&quot;/&gt;\n      &lt;value value=&quot;http://hl7.org/fhir&quot;/&gt;\n    &lt;/telecom&gt;\n  &lt;/contact&gt;\n  &lt;description value=&quot;Provider speciality roles codes which are composed of the NUCC Health Care Provider Taxonomy Code Set for providers&quot;/&gt;\n  &lt;copyright value=&quot;This value set includes content from NUCC Health Care Provider Taxonomy Code Set for providers which is copyright Â© 2016+ American Medical Association.  For commercial use, including sales or licensing, a license must be obtained.&quot;/&gt;\n  &lt;compose&gt;\n    &lt;include&gt;\n      &lt;system value=&quot;http://nucc.org/provider-taxonomy&quot;/&gt;\n      &lt;filter&gt;\n        &lt;property value=&quot;abstract&quot;/&gt;\n        &lt;op value=&quot;=&quot;/&gt;\n        &lt;value value=&quot;false&quot;/&gt;\n      &lt;/filter&gt;\n    &lt;/include&gt;\n  &lt;/compose&gt;\n&lt;/ValueSet&gt;\n</code></pre></div>\n\n\n<p>this results in the following error:<code>Error from server: The filter \"abstract = false\" was not understood in the context of http://nucc.org/provider-taxonomy</code></p>\n<p>IF is  not the code is it a problem with the codesystem properties?</p>",
        "id": 205954133,
        "sender_full_name": "Eric Haas",
        "timestamp": 1596571719
    },
    {
        "content": "<p>is this in an IG where I can reproduce?</p>",
        "id": 205962220,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596575936
    },
    {
        "content": "<p>US Core CI Build:  <a href=\"https://build.fhir.org/ig/HL7/US-Core/ValueSet-us-core-provider-specialty.html\">https://build.fhir.org/ig/HL7/US-Core/ValueSet-us-core-provider-specialty.html</a></p>",
        "id": 205972890,
        "sender_full_name": "Eric Haas",
        "timestamp": 1596583341
    },
    {
        "content": "<p>Since <code>abstract</code> is not a pre-defined property (see <a href=\"https://www.hl7.org/fhir/codesystem.html#status\">https://www.hl7.org/fhir/codesystem.html#status</a>), it would need to be declared in the CodeSystem</p>",
        "id": 205975688,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1596585933
    },
    {
        "content": "<p>But I don't even see properties on the codes in the CodeSystem that indicate abstractness in the <a href=\"http://nucc.org/provider-taxonomy\">http://nucc.org/provider-taxonomy</a> CodeSystem, so I wouldn't expect this filter do be doing anything.</p>",
        "id": 205975884,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1596586106
    },
    {
        "content": "<p>note the newer IG publisher did work for me</p>",
        "id": 205979646,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596590948
    },
    {
        "content": "<p>Is working for me as well</p>",
        "id": 206027843,
        "sender_full_name": "Eric Haas",
        "timestamp": 1596637430
    },
    {
        "content": "<p>yes I think it's resolved.</p>",
        "id": 206100944,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596683723
    }
]