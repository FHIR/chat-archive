[
    {
        "content": "<p>I'm trying to retrieve the definition of a concept from a code system</p>\n<div class=\"codehilite\"><pre><span></span>{{url}}/CodeSystem/$lookup?system=http://acme.co.uk/data1&amp;code=T1636\n</pre></div>\n\n\n<p>does not return it, nor does</p>\n<div class=\"codehilite\"><pre><span></span>{{url}}/CodeSystem/$lookup?system=http://acme.co.uk/data1&amp;code=T1636&amp;property=definition\n</pre></div>\n\n\n<p>How should I request this?</p>",
        "id": 188101903,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1581597480
    },
    {
        "content": "<p>those look ok but the server has to know the code system. you don't say what the response actually is</p>",
        "id": 188101996,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581597538
    },
    {
        "content": "<p>The response is an empty parameter resource <a href=\"/user_uploads/10155/NpEy5XyDDwNHe7T-dMcG_bhA/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/NpEy5XyDDwNHe7T-dMcG_bhA/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/NpEy5XyDDwNHe7T-dMcG_bhA/pasted_image.png\"></a></div>",
        "id": 188102128,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1581597636
    },
    {
        "content": "<p>wooah. which server? I sure hope it's not mine ;-)</p>",
        "id": 188102142,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581597654
    },
    {
        "content": "<p>Nope - not yours. :-)</p>",
        "id": 188102179,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1581597686
    },
    {
        "content": "<p>well, whichever one it is, it has a bug, because that's not a valid response</p>",
        "id": 188102295,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581597779
    },
    {
        "content": "<p>Should we require Parameters resource having at least one parameter in it? Empty Parameters resource does not make any sense.</p>",
        "id": 188110544,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1581604095
    },
    {
        "content": "<p>There's a base constraint that an empty resource of <em>any</em> type is not permitted.  You always have to have at least one element that has a value</p>",
        "id": 188113817,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581606138
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> where is that defined? I don't find it in Resource page.</p>",
        "id": 188136293,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1581619288
    },
    {
        "content": "<p>It's defined on Element (holds for Resource and everything in it.  Look here and search for ele-1: view-source:<a href=\"http://hl7.org/fhir/element.html\" target=\"_blank\" title=\"http://hl7.org/fhir/element.html\">hl7.org/fhir/element.html</a></p>",
        "id": 188147714,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581626132
    },
    {
        "content": "<p>In this case, it appears to be a defect. It has been logged and I'm sure it will be addressed in due course.</p>",
        "id": 188158831,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1581632544
    },
    {
        "content": "<p>defined on element doesn't mean defined on Resource</p>",
        "id": 188159624,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581633131
    },
    {
        "content": "<p>Interesting.  I'm wondering what a server should return in the case that only a single property has been requested and the code does not have a value for that property.  I don't believe a 400-series error is warranted , so what should the Parameters contain?  (I know an OperationOutcome is a possibility, but I expect many (most?) clients are not written to expect that option.)</p>",
        "id": 188159625,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1581633132
    },
    {
        "content": "<p>I think a not found is warranted</p>",
        "id": 188159648,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581633149
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> you're right.  So it seems we don't have any rule that prohibits having a totally empty resource.  Shouldn't we?  Should ele-1 get moved up to 'Base'?</p>",
        "id": 188163551,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581636297
    },
    {
        "content": "<p>Looking at <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> 's server with this example: {{url}}/CodeSystem/$lookup?system=http://hl7.org/fhir/CodeSystem/example&amp;code=chol-mmol&amp;_format=json&amp;property=definition<br>\nit appears to not support the property <code>definition</code> and instead returns just the code system name and version.</p>",
        "id": 188170936,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1581644000
    },
    {
        "content": "<blockquote>\n<p>Shouldn't we? Should ele-1 get moved up to 'Base'?</p>\n</blockquote>\n<p>No, there are circumstances where you can have an empty Parameters resource</p>",
        "id": 188172374,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581646127
    },
    {
        "content": "<blockquote>\n<p>appears to not support the property definition</p>\n</blockquote>\n<p>hmm. I'll test...</p>",
        "id": 188172390,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581646167
    },
    {
        "content": "<p>Just to clear up details regarding the empty Parameters resource being invalid in this case (for the $lookup result), this is because the operation defines mandatory parameters (\"name\" and \"display\") in the result</p>",
        "id": 188173096,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1581647328
    },
    {
        "content": "<p>y. which is why not found = 404</p>",
        "id": 188175874,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581652054
    },
    {
        "content": "<p>We've opted to always return name &amp; display now, so 404 only when code or system is not found.</p>",
        "id": 188182872,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1581663477
    },
    {
        "content": "<p>On the topic of empty Resources, every Resource schematron that is generated includes a <code>global-1</code> constraint that looks like this:</p>\n<div class=\"codehilite\"><pre><span></span>  &lt;sch:pattern&gt;\n    &lt;sch:title&gt;Global 1&lt;/sch:title&gt;\n    &lt;sch:rule context=&quot;f:*&quot;&gt;\n      &lt;sch:assert test=&quot;@value|f:*|h:div&quot;&gt;global-1: All FHIR elements must have a @value or children&lt;/sch:assert&gt;\n    &lt;/sch:rule&gt;\n  &lt;/sch:pattern&gt;\n</pre></div>\n\n\n<p>Context is <code>f:*</code> which I think means \"any element (in the FHIR namespace)\"<br>\nApplying that to the root element of a FHIR XML payload, it is looking for one of:<br>\n<code>@value</code>, <code>f:*</code>, or <code>h:div</code> which I think means:<br>\nan attribute named \"value\", any sub-element (in the FHIR namespace) , or a div tag for the narrative block XHTML subset.</p>\n<p>I'm wondering if this particular constraint allows for an empty resource as suggested above.</p>",
        "id": 190328714,
        "sender_full_name": "John Timm",
        "timestamp": 1583959068
    },
    {
        "content": "<p>well, it doesn't, and the schematron is actually wrong. <span aria-label=\"unamused\" class=\"emoji emoji-1f612\" role=\"img\" title=\"unamused\">:unamused:</span></p>",
        "id": 190329602,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583959631
    },
    {
        "content": "<p>Shall I create a ticket?</p>",
        "id": 190329634,
        "sender_full_name": "John Timm",
        "timestamp": 1583959664
    },
    {
        "content": "<p>yes I suppose. that particular schematron is going to unpleasant when it exempts resources from the rules</p>",
        "id": 190331453,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583960740
    },
    {
        "content": "<p><a href=\"https://jira.hl7.org/projects/FHIR/issues/FHIR-26565\" target=\"_blank\" title=\"https://jira.hl7.org/projects/FHIR/issues/FHIR-26565\">https://jira.hl7.org/projects/FHIR/issues/FHIR-26565</a></p>",
        "id": 190401079,
        "sender_full_name": "John Timm",
        "timestamp": 1584026007
    }
]