[
    {
        "content": "<p>Hi -</p>\n<p>First post, please be kind :)</p>\n<p>I'm working to populate CDS Hook Card attributes from the results of executing CQL.</p>\n<p>See: <a href=\"https://cds-hooks.hl7.org/1.0/#card-attributes\">https://cds-hooks.hl7.org/1.0/#card-attributes</a></p>\n<p>Some of these attributes are Strings, and they populate back into the Card structure in the calling PlanDefinition resource easily from the executed CQL (e.g. summary, detail, indicator).</p>\n<p>However, CDS Hook Card attributes include other attributes that are <em>not</em> strings, i.e. source, suggestions, and links.  We would like to be able to populate these from the executing CQL as well, but our understanding is that there is no way to pass complex data structures such as these back to populate the Card structure in the calling PlanDefinition resource.</p>\n<p>Does anyone know how we can pass these other fields back?</p>\n<p>Please let me know if any of that doesn't make sense and I'll try to explain better.</p>\n<p>Thanks -</p>\n<p>Matt</p>",
        "id": 223436720,
        "sender_full_name": "Matt Storer",
        "timestamp": 1611177369
    },
    {
        "content": "<p>We are using extensions for this, but we also want to embed a Questionnaire in the cards so I have a similar question as <span class=\"user-mention\" data-user-id=\"250428\">@Matt Storer</span> . What is the right syntax for this? We want to use valueResource as field. the valueReference field doesn't support in place resources if I understand the spec correctly (<a href=\"https://www.hl7.org/fhir/references.html\">https://www.hl7.org/fhir/references.html</a>)</p>\n<p><a href=\"user_uploads/10155/yGfW_37jZ2VX3vv_89FhyjA4/2021-01-21_07h48_52.png\">2021-01-21_07h48_52.png</a></p>\n<div class=\"message_inline_image\"><a href=\"user_uploads/10155/yGfW_37jZ2VX3vv_89FhyjA4/2021-01-21_07h48_52.png\" title=\"2021-01-21_07h48_52.png\"><img src=\"user_uploads/10155/yGfW_37jZ2VX3vv_89FhyjA4/2021-01-21_07h48_52.png\"></a></div>",
        "id": 223474953,
        "sender_full_name": "Paul Swarts",
        "timestamp": 1611211765
    },
    {
        "content": "<p>Hey Paul, as you've identified, there isn't really a method for returning a Questionnaire in a CDS Hooks card. Practically, the method to represent a form to the clinician is through a SMART app link.</p>",
        "id": 224143198,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1611726875
    },
    {
        "content": "<p>Matt, it would be great to better understand (and improve!) any obstacles for a CQL/Clinical Reasoning backend returning CDS Hooks card. Your question is pretty generic, and focused on json vs fhir data types. Are you asking for a mapping between CDS Hooks' json data types and FHIR's PlanDefinition fields? Does this help at all: <a href=\"https://www.hl7.org/fhir/clinicalreasoning-cds-on-fhir.html#:~:text=2.1%20Representing%20Hooks%20in%20FHIR,current%20activity%20in%20the%20system\">https://www.hl7.org/fhir/clinicalreasoning-cds-on-fhir.html#:~:text=2.1%20Representing%20Hooks%20in%20FHIR,current%20activity%20in%20the%20system</a>.</p>",
        "id": 224143324,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1611727081
    },
    {
        "content": "<p>Hey Isaac, we also offer a SMART app link card with our UI to answer the Questionnaires. However we have customers (CDSM client's) that want to implement their own forms of the Questionnaire. Therefore we offer both ways. Do you have an idea how we can return this Questionnaire?</p>",
        "id": 224144933,
        "sender_full_name": "Paul Swarts",
        "timestamp": 1611729022
    },
    {
        "content": "<p>CRD's solution is to return a card seeking the creation of a Task asking for the Questionnaire to be completed.  (Part of the reason is there isn't necessarily an expectation that the Questionnaire would be filled out immediately, as the card is typically saying \"You'll need to fill this out to seek prior authorization\", and that's not necessarily done by the clinician, nor done at the time of ordering.</p>",
        "id": 224193448,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1611759810
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191864\">Isaac Vetter</span> <a href=\"#narrow/stream/179159-cds-hooks/topic/how.20can.20I.20pass.20non-String.20data.20from.20CQL.20to.20populate.20Cards.3F/near/224143324\">said</a>:</p>\n<blockquote>\n<p>Matt, it would be great to better understand (and improve!) any obstacles for a CQL/Clinical Reasoning backend returning CDS Hooks card. Your question is pretty generic, and focused on json vs fhir data types. Are you asking for a mapping between CDS Hooks' json data types and FHIR's PlanDefinition fields? Does this help at all: <a href=\"https://www.hl7.org/fhir/clinicalreasoning-cds-on-fhir.html#:~:text=2.1%20Representing%20Hooks%20in%20FHIR,current%20activity%20in%20the%20system\">https://www.hl7.org/fhir/clinicalreasoning-cds-on-fhir.html#:~:text=2.1%20Representing%20Hooks%20in%20FHIR,current%20activity%20in%20the%20system</a>.</p>\n</blockquote>\n<p>Hi <span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span>  -</p>\n<p>Thanks for the reply, and yes that link does help, at least insofar as understanding where things are coming from and where they go.</p>\n<p>Basically, we are trying to construct more complete Cards from the results of CQL execution.  Right now, we can populate summary, detail, and indicator (action.title, action.description, and action.extension, respectively) from the CQL through the \"dynamicValue\" object list.   We would also like to be able to populate source, suggestions, selectionBehavior, and links from the CQL, but I haven't seen a way to do this.</p>\n<p>Do you know if there's a way?</p>\n<p>Alternatively, we're considering glomming all of these things into exiting text fields that we know we <em>can</em> populate (such as in the Rationale / Response.card.detail / action.description field), with appropriate delimiters and whatnot, and then parse that stuff out on the application side.  That's sort of an ugly workaround though, but based on my current understanding, that may be the only way to get stuff to work the way we want.</p>\n<p>Does that make sense?  I'm trying to describe what we're trying to do without pasting loads of code and hundreds of lines of stuff.</p>\n<p>Appreciate your assistance,</p>\n<p>Matt</p>",
        "id": 224380919,
        "sender_full_name": "Matt Storer",
        "timestamp": 1611862525
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"250428\">@Matt Storer</span> , my CQL/Clinical Reasoning knowledge is limited and I rely upon Bryn Rhodes a lot. The \"CQL Hooks\" pattern does appear to have a number of implementers.</p>",
        "id": 224389665,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1611866465
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  - do you have clinical reasoning servers that support CDS Hooks and support suggestions / links?</p>",
        "id": 224389671,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1611866467
    },
    {
        "content": "<p>Matt - just curious -- Are you working on integrating the guidance via CDS Hooks into your organization's EHR?</p>",
        "id": 224389763,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1611866521
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"250428\">@Matt Storer</span> , we were testing this exact behavior in the most recent connectathon, we used an ActivityDefinition to define the resource to be created and referenced it via the defintionCanonical in the PlanDefinition: <a href=\"https://github.com/cqframework/opioid-cds-r4/blob/99fa38d37ea895c3dfeba7a49aaac68056feb8e0/input/resources/plandefinition/plandefinition-OpioidCDSREC10PatientView.xml#L132\">https://github.com/cqframework/opioid-cds-r4/blob/99fa38d37ea895c3dfeba7a49aaac68056feb8e0/input/resources/plandefinition/plandefinition-OpioidCDSREC10PatientView.xml#L132</a></p>",
        "id": 224596279,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1612028561
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192522\">@Paul Swarts</span> , for questionnaires, we have been using a Task resource with a reference to the Questionnaire, but for the purposes of the response, you could put it in the contained of the Task. There's an ActivityDefinition example of this <a href=\"http://build.fhir.org/ig/HL7/cqf-recommendations/examples/activities/activities.html#collect-information\">here</a></p>",
        "id": 224597252,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1612029934
    }
]