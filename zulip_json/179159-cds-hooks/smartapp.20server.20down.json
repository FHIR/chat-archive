[
    {
        "content": "<p><a href=\"https://launch.smarthealthit.org/v/r2/fhir\">https://launch.smarthealthit.org/v/r2/fhir</a> seems to be unavailable (which is interfering with the CDS Hooks demo site)<br>\n<span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span></p>",
        "id": 235286325,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618893390
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> may have insight here.</p>",
        "id": 235366812,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1618933594
    },
    {
        "content": "<p><a href=\"https://launch.smarthealthit.org/v/r2/fhir\">https://launch.smarthealthit.org/v/r2/fhir</a> seems up to me though (e.g., <a href=\"https://launch.smarthealthit.org/v/r2/fhir/metadata\">https://launch.smarthealthit.org/v/r2/fhir/metadata</a> or <a href=\"https://launch.smarthealthit.org/v/r2/fhir/Patient\">https://launch.smarthealthit.org/v/r2/fhir/Patient</a> are returning data)</p>",
        "id": 235366985,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1618933660
    },
    {
        "content": "<p>It looks like maybe the issue is that the default patient for the CDS Hook sandbox (<a href=\"http://sandbox.cds-hooks.org/\">http://sandbox.cds-hooks.org/</a>) is ttps://launch.smarthealthit.org/v/r2/fhir/Patient/smart-1288992, which doesn't currently exist (appears deleted)</p>",
        "id": 235367219,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1618933754
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> is this expected to re-appear after a nightly reset?</p>",
        "id": 235367397,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1618933832
    },
    {
        "content": "<p>Yes the servers are up but I am currently updating the patient data. The patients are getting older over time which is an issue for some apps so I had to shift all dates in the dataset... Everything is updated, except for the DSTU-2 smart patients, which are causing some weird HAPI-specific issues during the nightly reset.  Might be fixed tomorrow but may also take longer. If you can, try using other patients until that is fixed.</p>",
        "id": 235368561,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1618934273
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span>  - aging of patient data on test/demo servers - a common problem when FHIR test data is hosted on a FHIR server.  How do you deal with this?  Do you 'clear out the DB' and reload all the patient data?    How do you update all the patient data's date information, e.g. Observation.effectiveDateTime, etc.?    We've done something like this for small test data sets using scripting to update the dates in a relative time way, e.g. \"today - 200 days\".</p>",
        "id": 235491654,
        "sender_full_name": "John Silva",
        "timestamp": 1619003669
    },
    {
        "content": "<p>We have a nightly reset script that uses HAPI-specific procedures (e.g. $expunge) to copy data from a private server to the public one, thus overwriting any changes that people may have made during the day. As for the time manipulation, I ended up writing a script that can shift all dates in a given data set (a folder of FHIR bundles) - <a href=\"https://github.com/smart-on-fhir/timeshift\">https://github.com/smart-on-fhir/timeshift</a></p>\n<p>Feel free to try it if you need something like that, just keep in mind that it is currently only configured to handle the data that we have on the SMART sandbox. For other datasets more paths may have to be added to the <code>config.js</code> file which simply defines all the paths that MAY exist and contain a date-like value.</p>",
        "id": 235538552,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1619021593
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span>  - thanks.   Does the HAPI $expunge have to be done one resource at a time or is it 'global', removing all resources?</p>\n<p>I'd like to take a look at that timeshift script but it seems to require access to the Github repo.    I've got a simple script using node.js and the moment library to update date-related fields.   The script has a list of which date-related fields it updates.   I don't have it working on updating date fields that are within arrays (JSON).</p>",
        "id": 235570270,
        "sender_full_name": "John Silva",
        "timestamp": 1619034494
    },
    {
        "content": "<p>Yes, sorry. The <code>timeshift</code> repo is now public. It uses a double dot notation to dive into arrays. As for the expunge, see  <a href=\"https://smilecdr.com/docs/fhir_repository/deleting_data.html#expunge\">https://smilecdr.com/docs/fhir_repository/deleting_data.html#expunge</a></p>",
        "id": 235577704,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1619037813
    }
]