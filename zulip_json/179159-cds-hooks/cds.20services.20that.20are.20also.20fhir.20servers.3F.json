[
    {
        "content": "<p>What are the use cases for having a single \"FHIR server\" that can respond to CDS hooks and <strong>also</strong> expose  the FHIR API (with CRUD on clinical/infrastructure resources)? I understand that all other things being equal <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> would build both kinds of functionality into his test server. But what is the real use case? What do we stand to gain by having both kinds of functionality co-located in a single server?</p>",
        "id": 153817965,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458860605
    },
    {
        "content": "<p>Push a bunch of clinical records to the CDS server, then ask for an opinion. </p>",
        "id": 153817967,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860754
    },
    {
        "content": "<p>Enhance a clinical record system - say a lab system - to offer interpretive comments on lab results as well</p>",
        "id": 153817969,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860805
    },
    {
        "content": "<p>mediccaion</p>",
        "id": 153817970,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860814
    },
    {
        "content": "<p>But for both of these use cases, you could have a standalone CDS server (receiving data via preFetch, or requesting it from the source system as necessary)</p>",
        "id": 153817971,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458860840
    },
    {
        "content": "<p>medication management system that provides workflow and also prescription advice,</p>",
        "id": 153817972,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860854
    },
    {
        "content": "<p>yes. You could always do that. You just increase the deplore</p>",
        "id": 153817973,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860869
    },
    {
        "content": "<p>But again, what is the gain from hosting them in one binary, at one FHIR endpoint?</p>",
        "id": 153817974,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458860874
    },
    {
        "content": "<p>Deplore?</p>",
        "id": 153817975,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458860879
    },
    {
        "content": "<p>Simplicity?</p>",
        "id": 153817976,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1458860956
    },
    {
        "content": "<p>deployment surface, and the configuration and security space</p>",
        "id": 153817977,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860968
    },
    {
        "content": "<p>and if you start managing the metadata properly, then it will be a server of some kind anyway,</p>",
        "id": 153817978,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860974
    },
    {
        "content": "<p>with all the same considerations as a FHIR server</p>",
        "id": 153817979,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458860974
    },
    {
        "content": "<p>Is it \"simple\" though? In the \"<a href=\"http://www.infoq.com/presentations/Simple-Made-Easy\" target=\"_blank\" title=\"http://www.infoq.com/presentations/Simple-Made-Easy\">http://www.infoq.com/presentations/Simple-Made-Easy</a>\" sense, combining these use cases  intertwines two kinds of functionality into a single \"complex\" entity.</p>",
        "id": 153817980,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458861019
    },
    {
        "content": "<p>Anyway, I'm trying to explore this space to understand what problem we're really solving here.</p>",
        "id": 153817981,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458861031
    },
    {
        "content": "<p>Thanks for  the feedback.</p>",
        "id": 153817982,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458861045
    },
    {
        "content": "<p>I think the summary here is \"if you already are building a FHIR server, then using FHIR to manage CDS hooks seems natural\".</p>",
        "id": 153817987,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458861217
    },
    {
        "content": "<p>Yes. And if you start trying to reproduce all the definitional infrastructure to do CDs hooks properly, then it will start to look the same....</p>",
        "id": 153817990,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458861276
    },
    {
        "content": "<p>Well, that's fair -- but just because something might \"start to look [like FHIR]\" doesn't mean it needs to <strong>become</strong> FHIR.</p>",
        "id": 153817992,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458861380
    },
    {
        "content": "<p>Of course. But since it's already doing lots of FHIR content, the advantages of using the FHIR definitional layer are obvious. As are the long term advantages for when more formal standardisation is appropriate</p>",
        "id": 153817996,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458861534
    },
    {
        "content": "<p>I would also want to be considering how to scale this stuff out and distribute responsibilities too (and yes we can do bus style routing behind the fhir door)</p>",
        "id": 153818011,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1458865363
    },
    {
        "content": "<p>Yes. Being able to scale services independently is part of the reason I'm thinking hard about this. </p>",
        "id": 153818012,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458865826
    },
    {
        "content": "<p>(assumed you were, but wanted to ensure it was explicit to others)</p>",
        "id": 153818013,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1458865866
    },
    {
        "content": "<p>We want it to be easy to  deploy  services that can auto-scale behind a reverse proxy. </p>",
        "id": 153818014,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458865871
    },
    {
        "content": "<p>And the way we're using the  FHIR operations framework is a bit cumbersome in that regard. Tacking an operation onto a custom resource would help (/CdsService/med-pricing/$invoke), or adding a path parameter to operations (/$cds-service/med-pricing), to make different services easy to route/scale by path. </p>",
        "id": 153818015,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458866034
    },
    {
        "content": "<p>(Right now the issue  is we define just one operation, $cds-hook.) </p>",
        "id": 153818016,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458866091
    },
    {
        "content": "<p>Have we considered a notion of doing this with other operations too?<br>\ni.e. [fhir-base]/OperationDefinition/PatientMatch/$invoke<br>\nNow that I write it, loses the context of the ResourceType, or Instance</p>",
        "id": 153818017,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1458866343
    },
    {
        "content": "<p>Right - if you have resource or instance context, you're in better shape there. </p>",
        "id": 153818018,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458866413
    },
    {
        "content": "<p>Well, I think that the custom resource pathway is the best so far identified. You might want to not miss fmg calls for the next few weeks then. Difficult discussion about custom resources there yesterday </p>",
        "id": 153818021,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458869949
    },
    {
        "content": "<p>Yes, good point! (Yesterday was AMIA in SF.) </p>",
        "id": 153818024,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1458880888
    },
    {
        "content": "<p>My opinion and views on this are that mature/experienced organizations will likely not conflate a FHIR server and CDS service into a single deployment. I do not think this will be common deplyoment/management scenario so while I certainly wouldn't want to preclude someone from going down this path, I wouldn't want this to be primary driver/influencer behind design decisions.</p>\n<p>By mature/experienced organization, I'm referring to:<br>\n- Large organizations (eg, enterprise)<br>\n- Teams/companies who experienced with building/deploying/managing services (eg, they likely already have services deployed today)</p>\n<p>With many organizations embracing the architectural pattern of microservices (<a href=\"http://martinfowler.com/articles/microservices.html\" target=\"_blank\" title=\"http://martinfowler.com/articles/microservices.html\">http://martinfowler.com/articles/microservices.html</a>), separating the FHIR server and the CDS service would be a very natural course of action for them. Microservices are certainly buzzy right now (so I don't use the term lightly), but a microservice design has very real benefits.</p>",
        "id": 153818061,
        "sender_full_name": "Kevin Shekleton",
        "timestamp": 1458907544
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191355\">@Kevin Shekleton</span>  +1</p>",
        "id": 153818113,
        "sender_full_name": "Jason Walonoski",
        "timestamp": 1458927496
    },
    {
        "content": "<p>I also think that most CDS services will not be from the same company as the fhir service.</p>",
        "id": 153818210,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1458974296
    },
    {
        "content": "<p>I think you are confused between \"fhir service\" and \"patient data provider\"</p>",
        "id": 153818214,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1458977802
    },
    {
        "content": "<p>Just for clarity in my case was referring to that there are likely 3 components taking place, the FHIR data server, a user interface application (cds consumer) and CDS services (that are hooked together)<br>\nAs is in the cds demo.<br>\nI think this will be quite normal that all 3 can and will come from different vendors/systems.</p>",
        "id": 153818215,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1458977966
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span>!  And after discussing with <span class=\"user-mention\" data-user-id=\"191355\">@Kevin Shekleton</span> I'm convinced that this special case (a FHIR server that also exposes CDS Hooks) is unduly influencing our design thinking. </p>\n<p>Of course some servers may want to  (e.g. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>'s server) but it's probably unusual outside the  FHIR echo chamber.</p>",
        "id": 153818241,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1459003287
    }
]