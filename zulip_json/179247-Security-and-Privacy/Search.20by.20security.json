[
    {
        "content": "<p>I'm thinking about examples that illustrate the concept of structured scopes, as part of a (not super directly related) DevDays session next week. I was trying to write an example that said \"Meds and Labs are fine, but not sensitive labs\" and wanted to write something like the following (recognizing it's probably not easy or practical to support, but just exploring syntax and semantics a bit):</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;terms&quot; [\n    {&quot;allow&quot;: &quot;MedicationStatement?patient=$patient&quot;},\n    {&quot;allow&quot;: &quot;Observation?patient=$patient&amp;category=laboratory&quot;},\n    {&quot;deny&quot;: &quot;_security:below=http://terminology.hl7.org/CodeSystem/v3-Confidentiality|R&quot;}\n  ]\n}\n</pre></div>\n\n\n<p>When I did this, I realized that in the <a href=\"https://www.hl7.org/fhir/v3/ConfidentialityClassification/vs.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/v3/ConfidentialityClassification/vs.html\">confidentiality classification</a>, <code>V</code> (\"Very Restricted\") is not modeled as a sub-concept of <code>R</code> (\"Restricted\"), so the <code>:below</code> query in my <code>deny</code> example would block access to \"Restricted\" content, but would fail to block access to \"Very Restricted\" Content.  <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> do you know why <code>V</code> is not modeled as a sub-concept of <code>R</code>?</p>",
        "id": 167428558,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559767431
    },
    {
        "content": "<p>the codes in confidentialityCode are non-overlapping risk evaluation. So they are not sub-concepts.  So it seems :below is speaking of hierarchy. This seems logical for most codes.... To make this work with confidentialityCode we would need to have each value to be a sub-concept of the other.</p>",
        "id": 167429245,
        "sender_full_name": "John Moehrke",
        "timestamp": 1559767939
    },
    {
        "content": "<p>I guess the question is, would you want to do this? I think it'd be nice to express the semantics in the hierarchy, personally (because it makes it easy to do things like \"no more than moderately sensitive\"</p>",
        "id": 167432502,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559770680
    },
    {
        "content": "<p>Given that there are only 6 values confidentiality code values, it is usually done by just listing each value allowed.<br>\nThis below concept might be more valuable with PurposeOfUse which is a hierarchy -- <a href=\"http://build.fhir.org/v3/SecurityPolicy/vs.html\" target=\"_blank\" title=\"http://build.fhir.org/v3/SecurityPolicy/vs.html\">http://build.fhir.org/v3/SecurityPolicy/vs.html</a></p>",
        "id": 167434520,
        "sender_full_name": "John Moehrke",
        "timestamp": 1559772560
    },
    {
        "content": "<p>Fair enough. I'll update my example to just list multiple codes. Thanks!</p>",
        "id": 167434569,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559773270
    },
    {
        "content": "<p>on that note <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span>, is that a teaser for the next generation of SMART scopes? If yes, please tell more! :-)</p>",
        "id": 167435000,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1559773869
    },
    {
        "content": "<p>It really wasn't -- more like, I'm trying to describe a spectrum of \"scope expressiveness\" to talk about tradeoffs</p>",
        "id": 167448638,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559791395
    },
    {
        "content": "<p>Draft deck for the devdays talk is at <a href=\"https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/edit\" target=\"_blank\" title=\"https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/edit\">https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/edit</a>?</p>",
        "id": 167448688,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559791447
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> this would be a search by value set. But the Ian McNicoll thinks that ordering in code systems is more widespread than we admit, and this is one that is clearly ordered.</p>",
        "id": 167544977,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559880319
    },
    {
        "content": "<p>we might allow gt[code] in a future version...</p>",
        "id": 167544982,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559880333
    },
    {
        "content": "<p>Search by value-set meaning ... ? Is my example wrong?</p>\n<div class=\"codehilite\"><pre><span></span>_security=http://terminology.hl7.org/CodeSystem/v3-Confidentiality|R\n</pre></div>",
        "id": 167583625,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559919172
    },
    {
        "content": "<p>I checked with <span class=\"user-mention\" data-user-id=\"199026\">@k connor</span> and she confirmed that this value set was intended from the outset to be a 'total order' as the following: <br>\n<code>V &gt; R &gt; N &gt; M &gt; L &gt; U</code> Adding the subsumption to the vocabulary definition might be worth it if there are no undesirable consequences.<br>\nIn our demos I have always followed what John suggested above since the number of codes is small and \"not belonging to a range\" can be turned into a conjunction of negations against specific codes.<br>\nBut this only applies to confidentiality labels and not for instance to sensitivity labels which are covered  by the same query parameter.</p>",
        "id": 167590418,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1559924042
    },
    {
        "content": "<p>order is not subsumption.</p>",
        "id": 167603407,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559933702
    },
    {
        "content": "<p>Josh: _security:in=http://my-value-set </p>\n<p>where my-value-set specifies the values you care about.</p>",
        "id": 167603447,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559933730
    },
    {
        "content": "<p>though</p>",
        "id": 167603449,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559933733
    },
    {
        "content": "<p>_security=R,X</p>",
        "id": 167603461,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559933749
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  The subsumption relationship on the confidentiality codes set is a \"total order\" in the algebraic sense of \"order.\" Order is not subsumption but the subsumption relationship orders a set of codes. That's what I meant in the above. Has \"order\" been defined in a different sense in this context? If it has, Kathleen and I will revise to clarify and avoid confusion.</p>",
        "id": 167606227,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1559935787
    },
    {
        "content": "<blockquote>\n<p>Josh: _security:in=http://my-value-set </p>\n<p>where my-value-set specifies the values you care about.</p>\n</blockquote>\n<p>Is this to suggest that I should define a new valueset containing just R and X and then get servers to recognize it? The latter option (supplying values directly) seems more staightforward.</p>",
        "id": 167608688,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559937452
    },
    {
        "content": "<p>for a few values, the second approach is clearly better, but once you have enough values, it's not practical anymore</p>",
        "id": 167609354,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1559937936
    },
    {
        "content": "<p>Agreed. Here it's a short list at least. And obviously <code>geR</code>(\"Restricted or greater\") would be even more convenient.</p>",
        "id": 167609720,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1559938198
    },
    {
        "content": "<p>Good to see confirmation of my approach... Note that I would expect that an organization would create a valueSet of the sensitivity codes that they consider Restricted... (where organization could be a large domain of organizations). Related to that would be a set of valueSet(s) of loinc/snomed codes that they consider are indicators of each of the sensitivity codes, something for a Security-Labeling-Service (SLS) to operate on. The SLS also is expected to use all the power of a CDS to mark as sensitive, data that has inference to a sensitivity... Thus we (security/privacy) want to engage the good works of CDS and vocabulary to tell us what is (and is not) sensitive, we will be happy to leverage that in access control decisions and enforcement. We engage a SLS which engages CDS... because security geeks are not good at figuring out what is sensitive...</p>",
        "id": 167654046,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560005427
    },
    {
        "content": "<p>My take is that \"sensitive\" tends to be extremely personal, cultural, and other flavors of contextual -- by place, time, political alignment. I'm all for trying to find some low hanging fruit, but I'm skeptical that institutions can make these kinds of determinations on behalf of individual patients/consumers.</p>",
        "id": 167654172,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560005687
    },
    {
        "content": "<p>There are multiple sides of sensitive. It does NOT address all vectors. I was only speaking of the data classification found in the sensitive valueset.  <a href=\"http://build.fhir.org/v3/InformationSensitivityPolicy/vs.html\" target=\"_blank\" title=\"http://build.fhir.org/v3/InformationSensitivityPolicy/vs.html\">http://build.fhir.org/v3/InformationSensitivityPolicy/vs.html</a>  There are people that find 'sensitive' things beyond this vocabulary, but it is there as a vocabulary to use. This does not mean it is the only thing that can be sensitive. There are clearly not things on the list that have not yet been discovered or deemed sensitive. A locally managed valueset can more quickly adjust to these 'norms', that was my point. Yes a person will have an episode they want marked sensitive, timerange often works well.</p>",
        "id": 167654398,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560006006
    },
    {
        "content": "<p>The patient can/should be allowed to manually mark data. There is legitimate concern for how this can e done in an informed way, or at scale.  Further concern is that a crafty malicious (e.g. drug seeking person) can use this to hide information that would prevent them from some goal (e.g. getting more narcotics).  Logging, and review of actions is likely an effective defense against this, but does require comprehensive logging and system of continual evaluation.</p>",
        "id": 167654800,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560006645
    },
    {
        "content": "<p>I think we should make a distinction between <em>sensitive</em> data in the colloquial sense (which is deeply subjective and personal) and sensitivity as defined by the sensitivity vocabulary. I think the intention of the vocabulary was to identify any category of information which has been singled out for additional protections by the existing laws and regulations. This is clearly jurisdiction-dependent and also changes with time. For example, I have heard some people questioning whether Sickle Cell anemia is still a sensitive condition although it is a protected category by the law. <br>\nThen there is the issue of categories of information which are personally sensitive to a patient but not singled out by the law. For example, a knee injury could be considered very sensitive information for a high profile athlete. In these cases, I think the patient or someone on their behalf can directly assign a confidentiality label to that information where overarching policies enable them to do so. For example the resources related to the knee injury can be marked as <code>R</code> by the patient or by the clinician.<br>\nAlso, determining the sensitivity labels by the SLS can be more complicated than a simple list of SNOMED or LOINC codes although that's a good place to start as we have shown in our demos. Aside from the complexities resulting from the use of unstructured text and use of NLP, even in structured information, there are issues around inference and related resources which cannot be addressed with simple codes; for example one case we encountered was when antibiotics prescriptions which are not sensitive per se, would have to be marked as HIV-sensitive if other information in the patient's information could be indicative of HIV. So, supporting basic conjunction and disjunction seemed necessary alongside having a list of LOINC and SNOMED codes in order to be able to assign sensitivity codes with less false positives and false negatives. As soon as we had to consider AND/OR rules, we realized that there are probably cases which call for more complicated rules or where non-rule-based and learning-based methods would be applicable.</p>",
        "id": 167724391,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560127290
    },
    {
        "content": "<p>Should a patient be able to tag a resource with a patient confidentiality without claiming that this is the overall confidentiality? RIght now, they can't, but this discussion seems to imply that they should be able to. Seems like a missing security label to me?</p>",
        "id": 167753851,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560168939
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> what part of FHIR keeps them from being able to do that?</p>",
        "id": 167757710,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560172491
    },
    {
        "content": "<p>well, how would they do that? putting a security label on a resource? what kind of label?</p>",
        "id": 167757830,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560172577
    },
    {
        "content": "<p>This seems in line with what we discussed last week, <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> <span class=\"user-mention\" data-user-id=\"192587\">@David Pyke</span> : a resource that describes the permission including the scope of that permission. That scope can be for many dimensions : only some content, or some categories of data, or some parties or some purposes...</p>",
        "id": 167758280,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560172937
    },
    {
        "content": "<p>I think the initial topic is about some categories of data, and I agree classification is not something we can completely standardize.</p>",
        "id": 167758483,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560173083
    },
    {
        "content": "<blockquote>\n<p>well, how would they do that? putting a security label on a resource? what kind of label?</p>\n</blockquote>\n<p>They would be using some tool that understands the policies and organization (aka patient portal), and it offers a vocabulary for this purpose. It might be a standards vocabulary (TABOO), or it might be a local vocabulary.</p>",
        "id": 167758485,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173085
    },
    {
        "content": "<p>so they put TABOO on there - is that different in meaning than if a clinician puts TABOO on there?</p>",
        "id": 167758667,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560173173
    },
    {
        "content": "<p>I'm asking for a standard vocab approach....</p>",
        "id": 167758705,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560173203
    },
    {
        "content": "<p>is loinc 1234 different if a patient puts it in vs provider?</p>",
        "id": 167758718,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173213
    },
    {
        "content": "<p>vocabulary are vocabulary... right?</p>",
        "id": 167758722,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173220
    },
    {
        "content": "<p>I don't think so, no. But I think there is a difference in this use case.</p>",
        "id": 167758744,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560173235
    },
    {
        "content": "<p>why?</p>",
        "id": 167758755,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173248
    },
    {
        "content": "<p>Do the same rules apply in all contexts for the same term in the vocabulary?</p>",
        "id": 167758771,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560173263
    },
    {
        "content": "<p>note that I did preferece that a authorized app is doinging the marking.. this is not a patient twiddeling bits</p>",
        "id": 167758778,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173273
    },
    {
        "content": "<p>More likely they just list the specific FHIR objects by .id and put them in a Consent.provision with provision.type==DENY and provision.data.reference listing all those things they want hidden</p>",
        "id": 167758876,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173351
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> you know that the world is full of too many variations on privacy policy to think that there is one policy that rules them all...</p>",
        "id": 167758916,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173394
    },
    {
        "content": "<p>but, yes I do expect that the definitions that a vocabulary has been given by a standards organization is universally understood as having THAT definition</p>",
        "id": 167759034,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173455
    },
    {
        "content": "<p>and, I totally expect that some messed-up organization will not follow those definitions.. nothing any vocabulary organization can do to prevent idiots from using their vocabulary improperly.  but we don't design to this abuse... right?</p>",
        "id": 167759179,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173527
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> ok i don't mind the notion of using Consent, but which consent? I don't believe that there's a way to know what Consent resource applies</p>",
        "id": 167759335,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560173652
    },
    {
        "content": "<p>what&gt;?</p>",
        "id": 167759393,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173730
    },
    {
        "content": "<p>In the simplest of environment, there is only ONE...In a slightly more complex one, they are likely based on PurposeOfUse... in a more complex environment, they better explain their complexity.</p>",
        "id": 167759550,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560173856
    },
    {
        "content": "<p>The application(s) responsible for supporting updating of consent must recognize previous, likely offer that set of terms, and offer changes. The resulting update of Consent replaces the previous.  If you have more than one consent, and they appear to conflict, then there is some consent application problem.</p>",
        "id": 167760259,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560174378
    },
    {
        "content": "<p>so you think this should be said in the core? I was hoping it would be the kind of thing that an IG would say... Seems core should not include a policy statement like this (there shall be only one).  If so, please make a CR; as your CR will carry more emphasis than one I might enter...</p>",
        "id": 167760484,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560174570
    },
    {
        "content": "<p>I'm not sure how much core should say. but I expect that a patient will have multiple different consent arrangements applicable to the control of the information, made at different times, for different purposes, with different parts of a provider organization. Is there some expectation that a consumer will only have one? If there's more than one, how are they supposed to differentiate them? would they differentiate by category?</p>\n<p>Also, If a consent agreement is subject to control, it doesn't seem like it's easy add some random resource id to it - that's a process question</p>",
        "id": 167761703,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560175478
    },
    {
        "content": "<p>I think it's not realistic to assume that there will only be a single applicable consent at any given time. It's an integrity rule that's hard to enforce when multiple systems are involved. Especially where the patient can use multiple consent management systems to file a consent, it's practically inevitable to have conflicting consents ending up in the system. <br>\nIt's matter of policy and configuration to handle such cases, for example, \"most recent consent overrides\" or \"the one filed in the EHR's own consent management system overrides\", etc.</p>",
        "id": 167769558,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560181048
    },
    {
        "content": "<p>so that's the problem  I'm concerned about. How can this be manageable from the consumer point of view? WHat's a consumer App to do? (specially if we don't let the consumer tag resources as confidential)</p>",
        "id": 167769713,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560181191
    },
    {
        "content": "<p>so in the core... we do allow resources to be individually tagged... but a more realistic solution is to have consent that targets the data by id, type, timeframe, or the other vectors found in .provisions. These vectors are in the model, because they are the vectors that consent use-cases brought to us needed. It is hard to model something that no-one brings forward a realistic example.</p>",
        "id": 167770233,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181572
    },
    {
        "content": "<p>I don't feel as though that is more realistic given the discussion here</p>",
        "id": 167770254,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560181593
    },
    {
        "content": "<p>as to the question of ONE or MANY.. this is a domain choice. There are definitely domains that have indeed chosen that there shall be only ONE.</p>",
        "id": 167770261,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181599
    },
    {
        "content": "<blockquote>\n<p>I don't feel as though that is more realistic given the discussion here</p>\n</blockquote>\n<p>and I am trying to understand why you don't 'feel' this</p>",
        "id": 167770291,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181625
    },
    {
        "content": "<p>yet, somehow you think it is easier to support access-control rules that allow for CHANGING EHR data?  touching the .meta element of Resources inside the EHR.</p>",
        "id": 167770332,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181671
    },
    {
        "content": "<p>because you can't know which consent to do that in</p>",
        "id": 167770335,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560181672
    },
    {
        "content": "<p>In any given domain... yes I can.</p>",
        "id": 167770395,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181690
    },
    {
        "content": "<p>because any given reality based domain will need to answer the questino you find unanswered</p>",
        "id": 167770415,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181707
    },
    {
        "content": "<p>For example, In the VA there is only ONE consent on file at any time. Any updates can be done at any time, but result in replacing the existing consent with a new one.</p>",
        "id": 167770462,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181744
    },
    {
        "content": "<p>This has been the model in multiple HIE based on XDS and XCA using BPPC and now APPC.</p>",
        "id": 167770503,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181768
    },
    {
        "content": "<p>at some point, rubber hits the road, and a policy model must be chosen.</p>",
        "id": 167770523,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181783
    },
    {
        "content": "<p>I can confidently say that they all start with 'there can be only ONE'.</p>",
        "id": 167770698,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560181881
    },
    {
        "content": "<p>well... there can be only one Privacy Consent.</p>",
        "id": 167770961,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560182050
    },
    {
        "content": "<p>All of the implementations I have worked with have a single registry with all records tied to the patient MRN/eMPI with specific exceptions.  I'm not aware of a system that would allow multiple records to affect a single patient for the same context</p>",
        "id": 167770977,
        "sender_full_name": "David Pyke",
        "timestamp": 1560182064
    },
    {
        "content": "<p>I think that we need some special query to fetch the consents applicable to the interface like</p>\n<p>[base]/Consent?list=$applicable</p>",
        "id": 167771217,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560182229
    },
    {
        "content": "<p>which returns all consent resources that have bearing on requests made through the interface (though policy would dictate whether they are all actually visible or not)</p>",
        "id": 167771278,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560182280
    },
    {
        "content": "<p>That's a privacy violation as that would show that such information exists.</p>",
        "id": 167771717,
        "sender_full_name": "David Pyke",
        "timestamp": 1560182535
    },
    {
        "content": "<p>Having the ability to fish for consent policies is a terrible idea</p>",
        "id": 167771995,
        "sender_full_name": "David Pyke",
        "timestamp": 1560182726
    },
    {
        "content": "<p>John and I have worked out possible pseudo code for searches.  Comments are requested:</p>\n<p>1. Request one or more Consent where status=active by Consent.scope (with patient(s), if none specified, get all)<br>\n2. Locally inspect Consent.provision for base policy acceptance/denial with Consent.policyRule<br>\n    If failure mode for policyRule not understandable, refer to Privacy Office <br>\n3. Locally inspect Consent.provision for contexts as above<br>\n4. Inspect Consent.provision.provision (<a href=\"http://et.al\" target=\"_blank\" title=\"http://et.al\">et.al</a>) for exceptions<br>\nNote: server required to filter based on Consent.provision.period for only active consents.</p>",
        "id": 167775527,
        "sender_full_name": "David Pyke",
        "timestamp": 1560185679
    },
    {
        "content": "<p>Contexts aren't above, they're:<br>\nWho - The patient<br>\nWhat - The data - specific resources are listed, empty list means all data covered by the consent.<br>\nWhere - The organization- what is the location boundary and authority boundary of this consent<br>\nWhen - The issued or captured<br>\nWhen - The timeframe for which the Consent applies<br>\nHow - The actions covered. (such as purposes of use that are covered)<br>\nWhom - The  actor who is/are are grantees by the consent.</p>",
        "id": 167776306,
        "sender_full_name": "David Pyke",
        "timestamp": 1560186244
    },
    {
        "content": "<p>How does this relate to the discussion we had 1 week ago, about consent!=permission? I think the above reads well as if consent actually means permission, whether given by the subject or by the law</p>",
        "id": 167776614,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560186522
    },
    {
        "content": "<p>It fits with our discussion</p>",
        "id": 167777791,
        "sender_full_name": "David Pyke",
        "timestamp": 1560187440
    },
    {
        "content": "<p>Hope so. I will work on what we agreed</p>",
        "id": 167778395,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560187867
    },
    {
        "content": "<p>I don't understand why providing a query where the server figures out what is valid is a privacy violation. Is it a privacy violation to propose that the server knows what consents are relevant for the interface?</p>",
        "id": 167778417,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560187890
    },
    {
        "content": "<p>No, we just need to make sure that the query has to provide proof they are authorized to know consents (like a consent management server).  I just am paranoid that it would be used to find out if patient X has hidden information</p>",
        "id": 167778731,
        "sender_full_name": "David Pyke",
        "timestamp": 1560188142
    },
    {
        "content": "<p>well, we always take it for granted that the server has to check access control. What the search I proposed does is not short circuit access control but short circuit error prone logic on the part of the client trying to figure out which consents it has access to are relevant for the interface it is working with</p>",
        "id": 167778973,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560188286
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192587\">@David Pyke</span> I think we should not conflate defining a query at the API level with authorizing the ability to run that query to clients.</p>",
        "id": 167779004,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560188314
    },
    {
        "content": "<p>RE finding applicable consent, here is an excerpt from our demo report from 2017:<br>\n<em>In this demo, we simply used a query mechanism to find the patient to whose FHIR Compartment the requested resource belongs. To find a patient’s applicable consent, we relied on a Consent Discovery component within the Consent Handler module. A simple instantiation of this component was used in the original demo which accepts the URI for a number of FHIR repositories where it can look for a patient’s consents by a simple FHIR search query based on that patient’s identifier assumed to be uniquely identifying a patient across different consent repositories (not to be confused with local FHIR server id for the patient resource). Moreover, this component will also look for Consents filed by others (e.g. a legal guardian) on behalf of the patient in question. In general, this mechanism can be expanded to include more sophisticated forms of consent lookup, such as direct Consent push by the requester in which the Client provides a copy of the patient’s consent as an evidence for proving it has earned the patient’s approval for the requested access.</em></p>",
        "id": 167779342,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560188576
    },
    {
        "content": "<p>ouch. I want to move that load from the client to the server</p>",
        "id": 167779449,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560188644
    },
    {
        "content": "<p>This was not implemented in the client; it was implemented in the \"authorization service\" protecting the FHIR server. At the time it was implemented as a Servlet Interceptor inside HAPI. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 167779511,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560188713
    },
    {
        "content": "<p>\"In general, this mechanism can be expanded to include more sophisticated forms of consent lookup, such as direct Consent push by the requester in which the Client provides a copy of the patient’s consent as an evidence for proving it has earned the patient’s approval for the requested access.\"</p>\n<p>We are discussing this aspect via an X-Consent header</p>",
        "id": 167779540,
        "sender_full_name": "David Pyke",
        "timestamp": 1560188744
    },
    {
        "content": "<p>could there be more than one such header?</p>",
        "id": 167779601,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560188774
    },
    {
        "content": "<p>What is the use case for more than one?</p>",
        "id": 167779687,
        "sender_full_name": "David Pyke",
        "timestamp": 1560188866
    },
    {
        "content": "<p>if more than one was involved in earning the patient's approval</p>",
        "id": 167779818,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560188907
    },
    {
        "content": "<p>X-Consent header was not a thing at the time but we <em>did</em> consider something like a subscription service to ensure the authorization service receives regular updates on Consent resources to sync up.</p>",
        "id": 167779876,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560188954
    },
    {
        "content": "<p>They would all be attached to the Consent resource under Consent.source referred to by the X-Consent header</p>",
        "id": 167779898,
        "sender_full_name": "David Pyke",
        "timestamp": 1560188973
    },
    {
        "content": "<blockquote>\n<p>could there be more than one such header?</p>\n</blockquote>\n<p>hard to think of a use-case where that's a requirement because the idea of X-Consent is primarily based on the use-case in which the client has confidence that it has <em>the</em> consent which authorizes the request.</p>",
        "id": 167780027,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560189056
    },
    {
        "content": "<p>it might not though. And David's response inplies that it creates a new one that quotes other ones that it inlines?</p>",
        "id": 167780144,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560189145
    },
    {
        "content": "<p>Yes, you can attach Consent resources as Consent.source.  But I was assuming that you meant signed documents, not resources.</p>",
        "id": 167780218,
        "sender_full_name": "David Pyke",
        "timestamp": 1560189227
    },
    {
        "content": "<p>I think we are getting close to helping the audience understand realistic situations... I don't think we need to get sidetracked by theory of two client side consents... not saying we won't address it, but rather asking that we get the realistic situation down first</p>",
        "id": 167780289,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189250
    },
    {
        "content": "<p>it's not realistic?</p>",
        "id": 167780314,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560189268
    },
    {
        "content": "<p>I don't think so... do you have example?</p>",
        "id": 167780332,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189284
    },
    {
        "content": "<p>What do systems do today? what happens in the paper world today? I really don't think multiple client side consents to enable access to a single patient record is realistic.</p>",
        "id": 167780437,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189359
    },
    {
        "content": "<p>if the client doesn't know what the consents the server will offer - it just gathers the ones it has an hopes for the best... seems realistic to me...</p>",
        "id": 167780492,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560189371
    },
    {
        "content": "<p>why would a client do that?</p>",
        "id": 167780510,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189388
    },
    {
        "content": "<p>in what way does a server ever 'offer' a consent&gt;?</p>",
        "id": 167780536,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189415
    },
    {
        "content": "<p>offer : I meant honor</p>",
        "id": 167780582,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560189452
    },
    {
        "content": "<p>I think this is a side project, and want the basics worked out first.... But I think you are asking about the situation where a client could get a point-of-care consent, and it just doesn't know which of a small set of them that it knows how to execute on, would satisfy the server... right?</p>",
        "id": 167780732,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189555
    },
    {
        "content": "<p>We have not addressed that in FHIR... in XCA we addressed it through error processing... as in the initial query was consentless, and got a specific error indicating that the request was mostly okay, but was lacking a consent... and in that error package was a list of policy identifiers that could satisfy the server.</p>",
        "id": 167780847,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189620
    },
    {
        "content": "<p>In this way the client knows that it is not being told to go away completely, but is given the list of policy identifiers that it can then use to determine which of the point of care consents it will interact wiht the patient to achieve. Once it has that, recorded somewhere. If that somewhere is not on the target server, then it could use the x-consent header to point at it.</p>",
        "id": 167780954,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189703
    },
    {
        "content": "<p>is that the workflow you are asking about?</p>",
        "id": 167780963,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189709
    },
    {
        "content": "<p>note that the list of policy identifiers returned by the server might be trimmed based on the client context... and the acceptance (honoring) of the x-header may also be based on the client context and server context... so no guarantee, but it is a process.</p>",
        "id": 167781145,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189807
    },
    {
        "content": "<p>In the context of FHIR consent the policy identifier would be the Consent.policyRule value.</p>",
        "id": 167781246,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560189850
    },
    {
        "content": "<p>I'm just not sure what a practical argonaut level consent api looks like, how it's framed. Any discussion turns so complicated - I want something as simple as posible for patient apps</p>",
        "id": 167782010,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560190372
    },
    {
        "content": "<p>Do we have a good write-up on when we'd favor consent-via-OAuth (with some kind of scopes v2) vs when we'd favor consent-via-explicit-FHIR-Consent-Resource?</p>",
        "id": 167782194,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560190483
    },
    {
        "content": "<p>that's for discussion this afternoon for me. I think of smart on fhir authorization as a connection specific consent, that would best build on top of the general patient consent</p>",
        "id": 167782277,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560190543
    },
    {
        "content": "<p>In other words, I think this is saying \"the venn diagram of use cases for OAuth vs. FHIR Consent Resource is highly overlapping\" -- in fact, maybe the OAuth use cases are entirely subsumed by FHIR Consent Resource use cases. But we might still like the OAuth approach for the subset where it applies, because we like something about the UX or consistency with other web workflows?</p>",
        "id": 167782454,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560190656
    },
    {
        "content": "<blockquote>\n<p>Do we have a good write-up on when we'd favor consent-via-OAuth (with some kind of scopes v2) vs when we'd favor consent-via-explicit-FHIR-Consent-Resource?</p>\n</blockquote>\n<p>that i what HEART supports... so, when is tied up in lots of deployment and trust issues</p>",
        "id": 167782457,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560190658
    },
    {
        "content": "<p>OAuth scopes are just maps into a consent resource, for me - a simple facade to it</p>",
        "id": 167782576,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560190731
    },
    {
        "content": "<blockquote>\n<p>In other words, I think this is saying \"the venn diagram of use cases for OAuth vs. FHIR Consent Resource is highly overlapping\" -- in fact, maybe the OAuth use cases are entirely subsumed by FHIR Consent Resource use cases. But we might still like the OAuth approach for the subset where it applies, because we like something about the UX or consistency with other web workflows?</p>\n</blockquote>\n<p>I think that the consent rules should not be duplicated in a normal SMART scope. The scope authorizes based on app/user/role... and the server enforces that, and addes consent enforcement.</p>",
        "id": 167782582,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560190737
    },
    {
        "content": "<p>trying to move the complexity of the consent rules into scopes adds no value</p>",
        "id": 167782608,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560190756
    },
    {
        "content": "<p>unless you are creating a third party consent service.. like HEART... and if you are doing that, then use HEART</p>",
        "id": 167782631,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560190777
    },
    {
        "content": "<p>all the scopes <em>are</em> in consent. I don't think we should try squeezing everything into scopes but we need to do more</p>",
        "id": 167782653,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560190789
    },
    {
        "content": "<blockquote>\n<p>Do we have a good write-up on when we'd favor consent-via-OAuth (with some kind of scopes v2) vs when we'd favor consent-via-explicit-FHIR-Consent-Resource?</p>\n</blockquote>\n<p>we have also demo-ed a hybrid approach, i.e. an OAuth server that issues tokens based on the consents stored in a (potentially separate) FHIR server.</p>",
        "id": 167782741,
        "sender_full_name": "Mohammad Jafari",
        "timestamp": 1560190811
    },
    {
        "content": "<p>why? What is the value of passing something from the authorization server to the resource server through the client... when the resource server MUST check again</p>",
        "id": 167782775,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560190836
    },
    {
        "content": "<blockquote>\n<p>OAuth scopes are just maps into a consent resource,</p>\n</blockquote>\n<p>I'm more interested in when we'd deploy an OAuth flow, though (because that's a consumer-facing workflow). How the details are modeled under the hood (mapped into Consent or whatever) is an implementation detail. (And on the flip side: when/where do we advocate for pre-sepcified Consents that authorize a diverse set of downstream access? When/where do consumers go through the workflow to establish this, review, etc?)</p>",
        "id": 167782854,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560190887
    },
    {
        "content": "<p>unless you are doing the configuration that HEART is targetting.... and if you are doing that, then look to HEART; and have no FHIR Consent resources.</p>",
        "id": 167782860,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560190892
    },
    {
        "content": "<p>I don't understand this question:</p>\n<blockquote>\n<p>why? What is the value of passing something from the authorization server to the resource server through the client... when the resource server MUST check again</p>\n</blockquote>",
        "id": 167782964,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560190935
    },
    {
        "content": "<p>SMART binds closely the authorization server with the resource server... right?</p>",
        "id": 167782993,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560190959
    },
    {
        "content": "<p>it doesn't bind it. It say nothing about it. in practice, that means bound yes</p>",
        "id": 167783169,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191064
    },
    {
        "content": "<p>If you want to encode the power of consent into OAuth scopes.. then this is what HEART tried to address. Not saying they have everything solved, but it is what they focused on. In their case they kept the consent rules as a propritary responsibility of the design of the authZ server, and only defined scope values for permissions allowed.  This is a different design decision than we addrssed with the FHIR Consent, where we focused on how to encode the rules, and left as an implemention detail how to decide and enforce.</p>",
        "id": 167783241,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560191131
    },
    {
        "content": "<p>I didn't say I wanted to do that. All I said was: the existing smart on fhir scopes are a connection specific consent that can be represented as a consent resource</p>",
        "id": 167783394,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191251
    },
    {
        "content": "<p>\"Can be represented as a consent resource\" is true, but not super interesting yet: I mean, the Consent resource is super flexible right now, so sure anything can be mapped.</p>",
        "id": 167783662,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191417
    },
    {
        "content": "<p>Do we have use cases where we want consumers to create proactive Consent policies and manage them centrally (within an org? across orgs? worldwide?) Where/how should these be used by third parties? It'd be good to spell these out. Maybe this has already been done?</p>",
        "id": 167783666,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191420
    },
    {
        "content": "<p>I can parse your statement at least two different ways, one that I am worried about....    FHIR scopes could stop at what the app/user is authorized by Role/Organization to do leaving Privacy/Consent rules to be applied later at the server... Or we could improve FHIR scopes so that they can do THAT and also encoee Privacy/Consent restrictions... But we should not assume that because we have addressed the first, that it automatically has addresed th esecond</p>",
        "id": 167783692,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560191448
    },
    {
        "content": "<p>yes very much we have use cases. The Australian national program is drifting that way</p>",
        "id": 167783697,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191456
    },
    {
        "content": "<p>Cool -- is there a write-up of the use case, who'll participate, etc?</p>",
        "id": 167783771,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191503
    },
    {
        "content": "<p>me too.</p>",
        "id": 167783781,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560191514
    },
    {
        "content": "<p>John the scopes need to get more useful. I don't know how much complexity that means. But we need to give the patient a useful language to say what they want to say to control sharing on a particular connection</p>",
        "id": 167783853,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191543
    },
    {
        "content": "<p>the only publish write up is:</p>",
        "id": 167783887,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191574
    },
    {
        "content": "<p><a href=\"http://www.healthintersections.com.au/?p=2868\" target=\"_blank\" title=\"http://www.healthintersections.com.au/?p=2868\">http://www.healthintersections.com.au/?p=2868</a></p>",
        "id": 167783925,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191601
    },
    {
        "content": "<p>analysis is going to give slightly different details, of course</p>",
        "id": 167783953,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191625
    },
    {
        "content": "<blockquote>\n<p>A consumer’s consent choices might look something like:<br>\n[√] Share my records between organisations that provide care for me<br>\n[  ] Share my records with [choose organisation]<br>\n[√] Only share my records if I set up the connection<br>\n[  ] Register all my care providers in [choose record location service]<br>\n[√] Keep a copy of my health records in [choose repository]<br>\n[  ] My care plan is found [choose care plan repository]<br>\n[√] My advance care directive is [choose repository+document]<br>\n[  ] Approve all/de-identified research use | check with me when research use is requested</p>\n</blockquote>\n<p>This is super interesting. A lot of these don't seem obviously tied to Consent for me, but they're certainly relevant consumer-centric system behaviors (like requesting records be forwarded to a specific repository, or setting up an advance care directive).</p>",
        "id": 167784107,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191711
    },
    {
        "content": "<p>The idea here is that once a Consent repository is in place, the national system will do some kind of system-level authorization that's backed by these policies (like, it'd have a bunch of clients allowed to connect, on behalf of certain care providers, and then the central system would compute a graph of patient/provider relations to enforce policies like \"Share my records between organisations that provide care for me\"?</p>",
        "id": 167784252,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191805
    },
    {
        "content": "<p>the relationship between \"consent (information sharing permissions)\" and \"information sharing instructions\" is slippery and not useful for us to draw</p>",
        "id": 167784268,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191815
    },
    {
        "content": "<p>the idea is that the clinical systems trust the central consent server and ask it what the patient choices are</p>",
        "id": 167784329,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191853
    },
    {
        "content": "<p>Oh, so the data aren't actually centralized here, just the consent?</p>",
        "id": 167784349,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191867
    },
    {
        "content": "<p>the central system doesn't do no computing</p>",
        "id": 167784352,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191869
    },
    {
        "content": "<p>right</p>",
        "id": 167784358,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191871
    },
    {
        "content": "<p>And how does System A determine that System B is providing care for Patient 123?</p>",
        "id": 167784420,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191886
    },
    {
        "content": "<p>(In order to act on Patient 123's centralized Consent that says \"Share my records between organisations that provide care for me\" -- which System A can read.)</p>",
        "id": 167784446,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191908
    },
    {
        "content": "<p>I expected that this would be based on the existing connection points established by referrals in the system</p>",
        "id": 167784504,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191950
    },
    {
        "content": "<p>that leaves some gaps that I did not address</p>",
        "id": 167784520,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560191968
    },
    {
        "content": "<p>Sure. So \"out of scope\" for now; that's fair.</p>",
        "id": 167784544,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560191988
    },
    {
        "content": "<p>MIHIN are aggressively collecting and collating the Patient's careteam to enable consent agreements framed like that (among other things)</p>",
        "id": 167784647,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192033
    },
    {
        "content": "<p>To be clear, in this framework if I write:</p>\n<blockquote>\n<p>[√] Keep a copy of my health records in [\"Apple Health\"]</p>\n</blockquote>\n<p>... this is where the scope obviously overlaps with our existing workflows.</p>",
        "id": 167784678,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560192062
    },
    {
        "content": "<p>yes. In this case, I would imagine that the OAuth login for a healthcare service for apple would work like this:</p>\n<ul>\n<li>connect to Provider RS end-point, get redirected to Provider  AS</li>\n<li>provider AS redirects you to national authentication server</li>\n<li>that returns you to provider AS, which looks at the consent registry (and sees Apple is already consented)</li>\n<li>it preselects \"yes\" to selection and asks user to confirm</li>\n<li>user decides \"yes\" and then gets token etc</li>\n</ul>",
        "id": 167784834,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192171
    },
    {
        "content": "<p>so the consent repository could be implemented as a 'there shall be only one' system. which simplifies everything at run-time. pushes the complexity at user-giving-their-consent time.</p>",
        "id": 167784863,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192199
    },
    {
        "content": "<p>Only one per Consent.scope</p>",
        "id": 167784899,
        "sender_full_name": "David Pyke",
        "timestamp": 1560192240
    },
    {
        "content": "<p>It's not my intent that there is only one consent repository</p>",
        "id": 167784965,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192265
    },
    {
        "content": "<p>the idea of 'preferences' has not come up yet.. (dealt with it elsewhere, where it is a special case of Privacy Consent that simply has no custodian or performer</p>",
        "id": 167784980,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192281
    },
    {
        "content": "<p>Hmm, so:</p>\n<blockquote>\n<p>user decides \"yes\" and then gets token etc</p>\n</blockquote>\n<p>suggests the national registry is really just a kind of hint, and that it has no direct effect without the user taking action on the bilateral (Apply / Provider 123) authorization step.</p>",
        "id": 167784982,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1560192283
    },
    {
        "content": "<p>Then there would be only one per repository and you'd need very specific requirements for conflict resolution</p>",
        "id": 167785072,
        "sender_full_name": "David Pyke",
        "timestamp": 1560192363
    },
    {
        "content": "<blockquote>\n<p>It's not my intent that there is only one consent repository</p>\n</blockquote>\n<p>so there might be multiple consent repositories... and multiple consents at each?   sounds like an NP problem</p>",
        "id": 167785115,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192374
    },
    {
        "content": "<p>fill out each repository with conflicting consents and watch the system tip over</p>",
        "id": 167785153,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192413
    },
    {
        "content": "<p>there's always that, but I think it's inevitaable - which is why we need to be clear about how to find the applicable consents</p>",
        "id": 167785155,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192414
    },
    {
        "content": "<p>multiple repositories doesn't seem too bad, but there should be a rule that any patient can only have their consents managed by ONE of them..</p>",
        "id": 167785214,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192459
    },
    {
        "content": "<p>Or you end up needing a central query responder that queries all the repositories and gives back the aggregated reply</p>",
        "id": 167785284,
        "sender_full_name": "David Pyke",
        "timestamp": 1560192498
    },
    {
        "content": "<blockquote>\n<p>fill out each repository with conflicting consents and watch the system tip over</p>\n</blockquote>\n<p>repeat</p>",
        "id": 167785359,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192563
    },
    {
        "content": "<blockquote>\n<p>there should be a rule that any patient can only have their consents managed by ONE of them</p>\n</blockquote>\n<p>Seems unlikely to me</p>",
        "id": 167785363,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192567
    },
    {
        "content": "<blockquote>\n<p>fill out each repository with conflicting consents and watch the system tip over</p>\n</blockquote>\n<p>repeat</p>",
        "id": 167785403,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192590
    },
    {
        "content": "<p>I would have consents centrally and then make very specific consents with my actual health services</p>",
        "id": 167785406,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192590
    },
    {
        "content": "<p>but that doesn't keep me  from putting 'specific to each health service' conflicting consents in the various consent repositories... and watching the system tip over</p>",
        "id": 167785560,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192663
    },
    {
        "content": "<p>why would the system let you do that?</p>",
        "id": 167785599,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192688
    },
    {
        "content": "<p>push the complexity to the consent-capturing time... so that real-time is clean</p>",
        "id": 167785605,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192696
    },
    {
        "content": "<blockquote>\n<p>why would the system let you do that?</p>\n</blockquote>\n<p>I would hope it wouldn't... but it seems every solution I have offered has been rejected... so clearly there is nothing preventing it</p>",
        "id": 167785690,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192738
    },
    {
        "content": "<p>I missed it if you offered a solution. National (or HIE) consents for general agrements overriden by local consent agreements - is that unreasonable ?</p>",
        "id": 167785741,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560192788
    },
    {
        "content": "<p>so then in this central consent repository is only one per patient... right?</p>",
        "id": 167785776,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192828
    },
    {
        "content": "<p>where the local are... local to the custodian of that data... local</p>",
        "id": 167785847,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192849
    },
    {
        "content": "<p>Not at all, the central consent repository is the HIE for consents across organizations and consents that only impact local users are managed locally.</p>",
        "id": 167785882,
        "sender_full_name": "David Pyke",
        "timestamp": 1560192878
    },
    {
        "content": "<p>not at all? I think we just said the same thing</p>",
        "id": 167785931,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560192920
    },
    {
        "content": "<p>so I think the pseudocode that Dave and I worked up should work for this central consent repository. That pseudocode does not assume consents are managed in the same place anything else is managed... However the software doing this pseudocode should be a consent service, as it needs authorization to do a potentially sensitive query... and it should only expose appropriate results... and it is the results that I think we have been discussiong mostly all day.. is the results a OAuth scope? Is the results a pointer to a FHIR Consent? Is the results a XACML policyset ID? etc... what is the result.. There is not a good solution yet, because we are not there yet.</p>",
        "id": 167786482,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193290
    },
    {
        "content": "<p>ok so we have 2 different use cases: </p>\n<ul>\n<li>a central consent repository which stores all the consents for the inter-system</li>\n<li>a central consent rspository that stores the consent arrangements pertinent to the inter-system</li>\n</ul>",
        "id": 167786489,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560193296
    },
    {
        "content": "<p>im not sure I understand what a consent arrangements pertinent means</p>",
        "id": 167786581,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193348
    },
    {
        "content": "<p>well, consent about the central store, and default consent arrangements for the inter-system, but maybe overridden in the systems</p>",
        "id": 167786657,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560193424
    },
    {
        "content": "<p>are you trying to apply consent rules to accessing of consent rules? I don't think that is needed. The service that does the consent management and the service that does the consent decision are privileged enough to access consents (tends to not be privileged to access anything else).</p>",
        "id": 167786793,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193527
    },
    {
        "content": "<p>no I said nothing about that</p>",
        "id": 167786870,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560193581
    },
    {
        "content": "<p>whew... well then what is \"consent about the centeral store\" mean?</p>",
        "id": 167786897,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193615
    },
    {
        "content": "<p>cosent about the health records stored in the central store (e.g. an HIE)</p>",
        "id": 167787091,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560193746
    },
    {
        "content": "<p>clinical repository service?</p>",
        "id": 167787127,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193780
    },
    {
        "content": "<p>we don't usually use that term but yes</p>",
        "id": 167787190,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1560193804
    },
    {
        "content": "<p>you used it on your blog article, so I was confused</p>",
        "id": 167787214,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193823
    },
    {
        "content": "<p>YES, you must have a policy for \"what should happen if the patient as ZERO consents\"</p>",
        "id": 167787249,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193860
    },
    {
        "content": "<p>I will say that there could be a design criteria that indicates that for any one patient they only have one Privacy Consent... thus a business rule that means a patient must pick a consent repository, or have a way to move their rules from one consent repository to another.</p>",
        "id": 167787360,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560193944
    },
    {
        "content": "<p>and then one FHIR Consent can have provisions sighting the rules for each clinical repository, possibly for each requesting organization, for each PurposeOfUse, for each type of data, for various timeframes within that repository... One big massive Consent. Assured as consistent by the consent management UI before it commits that Consent..</p>",
        "id": 167787484,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560194047
    },
    {
        "content": "<p>or it could work harder, and have a different Consent for each clinical repository...   or different Consents for each PurposeOfUse... or different Consents for each requesting organization... and make sure that they are always not conflicting prior to saving them.</p>",
        "id": 167787547,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560194115
    },
    {
        "content": "<p>Patient may have expressed no consent (which is most likely) but patient will have many permissions defined by policy.</p>",
        "id": 167788419,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560194772
    },
    {
        "content": "<blockquote>\n<p>YES, you must have a policy for \"what should happen if the patient as ZERO consents\"</p>\n</blockquote>\n<p>I think that is what I said here...  right?</p>",
        "id": 167788585,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560194885
    },
    {
        "content": "<p>Imo a patient might not \"pick\" a consent. The permissions applicable are selected for the patient.</p>",
        "id": 167788618,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560194914
    },
    {
        "content": "<blockquote>\n<blockquote>\n<p>YES, you must have a policy for \"what should happen if the patient as ZERO consents\"</p>\n</blockquote>\n<p>I think that is what I said here...  right?</p>\n</blockquote>\n<p>Yes, and that policy should be linked to the patient's data, and be expressed as a Permission or something</p>",
        "id": 167788782,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560195016
    },
    {
        "content": "<p>That policy is a statement of rules and situations that are authorized (permissions) when no consent is found for the patient. The lack of a Patient specific Consent is what activates this default policy.</p>",
        "id": 167788927,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195146
    },
    {
        "content": "<p>If a patient enters a ER there may not be any consent. Just a legal policy that applies to the patient's data, some of which applies whether the patient consents or not.</p>",
        "id": 167789021,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560195223
    },
    {
        "content": "<p>yes. that default policy is a hard thing to write... and does need to concern itself with safety of the patient, safety of the care-givers, etc... Yup, very hard to write</p>",
        "id": 167789110,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195269
    },
    {
        "content": "<p>that default policy needs to deal with physical actions as well... so it is beyond the domain of FHIR.</p>",
        "id": 167789153,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195311
    },
    {
        "content": "<p>True and my concern here is not how hard it is, but how is it transmitted in a computable way</p>",
        "id": 167789166,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560195322
    },
    {
        "content": "<p>why does it need to be transmitted?</p>",
        "id": 167789184,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195340
    },
    {
        "content": "<p>We will soon work on a couple of use cases for this incl GDPR.</p>",
        "id": 167789260,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560195384
    },
    {
        "content": "<p>Then what do you search? What metadata do you obtain that says \"hey CPOE, here is what you can do with this data\"?</p>",
        "id": 167789311,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560195447
    },
    {
        "content": "<p>I agree that many people spend hours with lawyers and clinicians writing these default policies.. I just don't know of why they need to be encoded in an interoperable. There is no CPOE today that can read a defult policy and self-configure. That is a dream that is 50 years out.</p>",
        "id": 167789396,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195504
    },
    {
        "content": "<p>CPOE is configured by hand, with legal text from the lawyers in hand... hopefully the legal and clinician people test that it got configured properly.</p>",
        "id": 167789443,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195546
    },
    {
        "content": "<p>most important is that the default policy includes many physical access rules, many rules accessing systems that are not FHIR, and more... so to have a rules language that is that generic is to re-invent good rules languages such as XACML.</p>",
        "id": 167789584,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195628
    },
    {
        "content": "<p>default policy is hard enough to write in human readable language safactory to lawyers and clinicians.</p>",
        "id": 167789661,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195700
    },
    {
        "content": "<p>I will look at the use cases. In any case, if we set some clarity between patient-expressed-consent and permission-to-operate-with-data that would be a step forward, i think</p>",
        "id": 167789772,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1560195756
    },
    {
        "content": "<p>note that the same is true of what \"Permit HIE access for Treatment\"... this short form is built upon a large document (e.g. DURSA) that expreses what HIE is, what 'access' is, what 'for' means, what 'Treatment' is and is not...</p>",
        "id": 167789796,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560195776
    },
    {
        "content": "<p>RE Sensitive clinical information.  SAMHSA registered a set of condition, procedure, observation, medication and Lab codes that map to some of the HL7 Sensitivity codes in VSAC. These were drawn from sensitive clinical code value sets used by 42 CFR Part 2 facilities, and mental health and HIV as sensitive categories to accommodate state and local consent requirements. As I understand it, some are from the VA for Title 38 Section 7332 protected conditions such as sickle cell anemia, substance use disorders, and HIV/AIDS.  To access, use your UMLS account.  Search for SAMHSA stewarded value sets.</p>",
        "id": 167792451,
        "sender_full_name": "k connor",
        "timestamp": 1560197727
    }
]