[
    {
        "content": "<p>Hi folks - I know nothing about security issues except in the most generic terms, but:</p>\n<p>I just ran into this February report, which, if valid, seems pretty appalling. <a href=\"https://www.beckershospitalreview.com/cybersecurity/30-popular-mobile-health-apps-vulnerable-to-cyberattacks-phi-exposure.html\">https://www.beckershospitalreview.com/cybersecurity/30-popular-mobile-health-apps-vulnerable-to-cyberattacks-phi-exposure.html</a></p>\n<p>Holy crap, hard-coding security keys?? And things like that. And a vulnerability where a hacker can just replay a FaceID session to reactivate the authentication and play around? Etc etc.</p>\n<p>Or am I falling prey to a bogus press release? I know the project was funded by Approov, who makes a product that claims to remove the vulnerabilities; that's a separate question from: are these vulnerabilities truly there?</p>",
        "id": 240132762,
        "sender_full_name": "Dave deBronkart",
        "timestamp": 1621905472
    },
    {
        "content": "<p>I am not surprised at all. In fact most SMART-on-FHIR apps likely have their client_id password hard coded.   Security is hard, idiots are powerful.</p>",
        "id": 240166573,
        "sender_full_name": "John Moehrke",
        "timestamp": 1621937694
    },
    {
        "content": "<p>I agree with John - I feel like this is pretty much expected and normal in software.  And is not a healthcare specific problem.  As long as there are mortal humans building things, the outcomes reported in that article will remain true.  Giving more parties access to patient data was always a decision that involved pros and cons.  I think we both agree that the pros far outweigh the cons, but you've discovered one of the cons:  the more parties that have patient data, the more opportunities there are for that data to be stolen and misused by bad actors.</p>",
        "id": 240188993,
        "sender_full_name": "Cooper Thompson",
        "timestamp": 1621950208
    },
    {
        "content": "<p>which is one of the reasons given by healthcare providers for data-blocking... The patient could not be trusted with protecting the data, therefore they should not be given a copy...</p>",
        "id": 240228213,
        "sender_full_name": "John Moehrke",
        "timestamp": 1621966335
    },
    {
        "content": "<p>Holy crap.</p>",
        "id": 240231698,
        "sender_full_name": "Dave deBronkart",
        "timestamp": 1621967899
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> what do you make of this??  Isn't it a bit nuts for the norm to be this weak??</p>",
        "id": 240231951,
        "sender_full_name": "Dave deBronkart",
        "timestamp": 1621968016
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191764\">Cooper Thompson</span> <a href=\"#narrow/stream/179247-Security-and.20Privacy/topic/Feb.20report.20on.20health.20app.20vulnerabilities/near/240188993\">said</a>:</p>\n<blockquote>\n<p>As long as there are mortal humans building things, the outcomes reported in that article will remain true.  </p>\n</blockquote>\n<p>But holy crap, isn't that why there are laws and regulations (and standards to adhere to)??</p>",
        "id": 240232056,
        "sender_full_name": "Dave deBronkart",
        "timestamp": 1621968078
    },
    {
        "content": "<p>Honestly I'm having a hard time keeping my vocabulary dignified. Anyone who wants to be in the business of gratuitously offering to move patient data around had damn well better be responsible about what happens while it's in their custody!</p>",
        "id": 240232227,
        "sender_full_name": "Dave deBronkart",
        "timestamp": 1621968155
    },
    {
        "content": "<p>Hi there,  joining and thought I'd introduce myself.  I'm Andrea, a BRCA Community advocate, security researcher, and cofounder of The Light Collective.  (<a href=\"http://lightcollective.org\">lightcollective.org</a>)</p>",
        "id": 240232718,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1621968391
    },
    {
        "content": "<p>To be clear, the problem here isn't the patient being \"trusted with their data.\"  It's basic security standards for FHIR API's.   I'm currently on ONC Steering Committee for FHIR Factories and working to get this research in the hands of the right stakeholders at ONC.  FHIR vulnerabilities are fixable problems, and pretty basic when developing secure API's.  For example BOLA is a very common and fixable vulnerability found in 100% of the FHIR API's tested in this attached report.  I wouldn't expect patients to know the first thing about this.  Rather, I'd expect Health IT professional to know how to secure their FHIR  API's.  This is all new and we'll get there ( :  <a href=\"/user_uploads/10155/gdvRUKw9vvCc5scYkxGK2NRI/FHIR-hacking-mhealth-apps-with-apis.pdf\">FHIR-hacking-mhealth-apps-with-apis.pdf</a></p>",
        "id": 240232734,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1621968401
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"379458\">Andrea Downing</span> <a href=\"#narrow/stream/179247-Security-and.20Privacy/topic/Feb.20report.20on.20health.20app.20vulnerabilities/near/240232734\">said</a>:</p>\n<blockquote>\n<p>Rather, I'd expect Health IT professional to know how to secure their FHIR  API's. </p>\n</blockquote>\n<p>+1000</p>",
        "id": 240232811,
        "sender_full_name": "Dave deBronkart",
        "timestamp": 1621968474
    },
    {
        "content": "<p>For those who don't know BOLA, it's basically this:   In the example in <a href=\"https://www.epatientdave.com/2020/05/18/a-glimpse-of-how-fhir-works-for-people-whove-fought-to-get-their-data/\">my post a year ago</a> for FHIR total-newbies, once you're in, just change the yellow highlighted stuff in the URL, and presto, you get stuff the patient may not have meant to release.  <br>\n<a href=\"/user_uploads/10155/zIq5WmtJ0BVFjh6Q016q5Jvm/image.png\">image.png</a><br>\nIs this okay with us??  I'd think not.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/zIq5WmtJ0BVFjh6Q016q5Jvm/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/zIq5WmtJ0BVFjh6Q016q5Jvm/image.png\"></a></div>",
        "id": 240233403,
        "sender_full_name": "Dave deBronkart",
        "timestamp": 1621968755
    },
    {
        "content": "<p>That's perfectly fine - if your authorized to look at multiple patients and multiple types of records - which may well be the case for the providers, and with constraints, even for patients (e.g. a patient might be authorized to access records of a minor child, etc.)  However, the system should absolutely not honor a query you don't have the right to execute.  It should assume everyone knows how to formulate a valid query.</p>",
        "id": 240234024,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1621969084
    },
    {
        "content": "<p>For BOLA, that sounds like it's talking about servers, not clients? I think the ecosystem of servers is a different problem than the ecosystem of client apps. Servers are not something chosen by the patient, so there should be more accountability.</p>\n<p>Regardless, the statement \"Out of the API endpoints tested, 100% were vulnerable\" is difficult to believe. It would indicate that no one enforces access control successfully.</p>",
        "id": 240245738,
        "sender_full_name": "Paul Church",
        "timestamp": 1621974507
    },
    {
        "content": "<p>I'm not seeing what the issue issue is in the inset image above; a client is authorized with certain scopes of access up-front; the client can then issue many potentially different queries (e.g., with different query parameters), and it's the server's job to ensure the client only sees data it was authorized to see. Asking about different LOINC codes in different queries is generally fine, when this is consistent with the authorized scope of access.</p>",
        "id": 240246514,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621974911
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179247-Security-and.20Privacy/topic/Feb.20report.20on.20health.20app.20vulnerabilities/near/240246514\">said</a>:</p>\n<blockquote>\n<p>I'm not seeing what the issue issue is in the inset image above; a client is authorized with certain scopes of access up-front; the client can then issue many potentially different queries (e.g., with different query parameters), and it's the server's job to ensure the client only sees data it was authorized to see. Asking about different LOINC codes in different queries is generally fine, when this is consistent with the authorized scope of access.</p>\n</blockquote>\n<p>Hey Josh et all:  Please read the full report I linked to summarizing Alissa Knight's research:   FHIR-hacking-mhealth-apps-with-apis.pdf</p>",
        "id": 240247247,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1621975313
    },
    {
        "content": "<p>Here is the link again:  <br>\n<a href=\"/user_uploads/10155/817BOEwIGcEgxm-xZULLAK2v/FHIR-hacking-mhealth-apps-with-apis.pdf\">FHIR-hacking-mhealth-apps-with-apis.pdf</a></p>",
        "id": 240247325,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1621975344
    },
    {
        "content": "<p>To be clear, I'm not talking about queries where access is authorized.  Alissa was able to look at entire record sets of patients admitted to a hospital.  Here is one example of many.   I'd be happy to connect anyone w/ her or set up a call if there are questions. My takeaway:  there's some pretty basic things that can be done to harden the security of FHIR API's and standards are lacking.   <a href=\"/user_uploads/10155/seHsepQz0Ej3mNr_18L0if9O/Screen-Shot-2021-05-25-at-1.41.13-PM.png\">Screen-Shot-2021-05-25-at-1.41.13-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/seHsepQz0Ej3mNr_18L0if9O/Screen-Shot-2021-05-25-at-1.41.13-PM.png\" title=\"Screen-Shot-2021-05-25-at-1.41.13-PM.png\"><img src=\"/user_uploads/10155/seHsepQz0Ej3mNr_18L0if9O/Screen-Shot-2021-05-25-at-1.41.13-PM.png\"></a></div>",
        "id": 240247809,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1621975567
    },
    {
        "content": "<p>Right now I'm working to get Alissa connected w/ the right stakeholders.  For example, call later with some of the good folks at H-ISAC and Bio-ISAC.  Meeting w/ ONC stakeholders next week.  So if it helps I'd be happy to set up a call with her <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> so you can speak with Alissa directly to ask questions about the security research she is coordinating.  Also I know I'm new here so very nice to meet everyone ( :</p>",
        "id": 240248695,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1621976063
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"379458\">@Andrea Downing</span>! I'd be very happy to meet with Alissa -- from the description above, this sounds like a critical vulnerability. I know how challenging these can be to report and track (e.g., <a href=\"https://smarthealthit.org/2014/04/case-study-security-vulnerabilities-in-ccda/smarthealthit.org/2014/04/ehr-security-vulnerability-reporting/\">this blog post documents my experience</a> reporting across multiple vendors in 2014)</p>",
        "id": 240249340,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621976401
    },
    {
        "content": "<p>Ok, I read through the report more carefully and the vulnerable APIs aren't the EHRs (which is what gave me pause about \"100% vulnerable\", I'm pretty sure some of the EHRs have successfully implemented access control) - it's the server backends of the mHealth apps.</p>",
        "id": 240250458,
        "sender_full_name": "Paul Church",
        "timestamp": 1621976945
    },
    {
        "content": "<p>I just looked at the screenshot stating \"BOLA vulnerability found allowing me to see all patients admitted into the hospital\". I know I should be reading the article but haven't gotten around to it yet; if it wasn't an EHR vulnerability, what system <em>was</em> storing/leaking these data?</p>",
        "id": 240252569,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621978063
    },
    {
        "content": "<p>I can see from the screenshots though that this isn't a FHIR API. I don't recognize what kind of API this is.</p>",
        "id": 240252733,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621978191
    },
    {
        "content": "<p>It's the mobile app's server backend.</p>",
        "id": 240253310,
        "sender_full_name": "Paul Church",
        "timestamp": 1621978574
    },
    {
        "content": "<p>So the scope of what you can compromise is presumably people who have their data in that app, not \"the hospital\".</p>",
        "id": 240253357,
        "sender_full_name": "Paul Church",
        "timestamp": 1621978609
    },
    {
        "content": "<p>OK, that's a misleading description unless the mobile app is \"the mobile app for all clinicians at this hospital\"?</p>",
        "id": 240253500,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621978715
    },
    {
        "content": "<p>In any case, I agree with John's first point (security is hard); these notes aren't FHIR-specific though and from what I can tell none of the findings involve FHIR.</p>",
        "id": 240253622,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621978805
    },
    {
        "content": "<p>I'm not seeing, from the document, where there were documented access problems in real clinical systems using Smart on FHIR here. BOLA would imply some predictability around the random numbers in the access tokens. I haven't worked with any implementation that wasn't using UUIDs for those (I haven't worked that many real ones...)</p>",
        "id": 240262257,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1621984646
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> to be clear some of the vulnerabilities found do directly impact the hospital.   Not all is published in this report and will be disclosed in June.  How about:  let's take conversation to DM and coordinate a call w/ Alissa.   My goal is to figure out who the coordinating body for this would be (ONC?) so there are some basic security standards / patches before the July deadline.  Thx!</p>",
        "id": 240267044,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1621989184
    },
    {
        "content": "<p>Happy to chat!</p>",
        "id": 240276837,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1622001188
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179247-Security-and.20Privacy/topic/Feb.20report.20on.20health.20app.20vulnerabilities/near/240249340\">said</a>:</p>\n<blockquote>\n<p>Thanks <span class=\"user-mention silent\" data-user-id=\"379458\">Andrea Downing</span>! I'd be very happy to meet with Alissa -- from the description above, this sounds like a critical vulnerability. I know how challenging these can be to report and track (e.g., <a href=\"https://smarthealthit.org/2014/04/case-study-security-vulnerabilities-in-ccda/smarthealthit.org/2014/04/ehr-security-vulnerability-reporting/\">this blog post documents my experience</a> reporting across multiple vendors in 2014)</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> While there may be a larger discussion going on on the vulnerabilities. I want to take this opportunity to seek guidance on what does FHIR or SMART say about securing documents/imageURLs like you stated in your post <code>&lt;img src=\"http://hack.me/leaked-from-image.png\"&gt;&lt;/img&gt;</code>. The custom scopes are at resource level, and the resource endpoints are protected by them. But there can be a case where even a server can leak these URIs/URLs, leaving them vulnerable and hard to track the origination of leak. Since these are free form URLs they don't follow a resource model. How can they be protected in a shared model like FHIR ?</p>",
        "id": 240570305,
        "sender_full_name": "Venu Gopal",
        "timestamp": 1622187131
    },
    {
        "content": "<p>It's important to consider specific threats here. Are you worried about clinical data leaking inadvertently from a document to a third party? Intentional tracking by the documents author (\"phone home\")? EHR session compromise when a maliciously authored document is displayed?</p>",
        "id": 240613913,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1622213098
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span>  I am seeking in general. If I take a look at the Attachment data type <a href=\"http://hl7.org/fhir/datatypes.html\">http://hl7.org/fhir/datatypes.html#</a> Attachment or a Reference (Any) <a href=\"http://hl7.org/fhir/references.html#Reference\">http://hl7.org/fhir/references.html#Reference</a> that could be used. The attachment could be anything, it could be the photo of a patient, practitioner, a pdf from a previous enocunter/episode of care/medication that is attached to an Appointment. These have URLs/URIs, that can be of free form. Assuming these are passed on along with 'a Resource' that is exchanged, it could be two standalone apps that are out of network. The receiving server could then leak a URL/URI. What is a recommended mechanism to safeguard these URLs ?</p>",
        "id": 240831598,
        "sender_full_name": "Venu Gopal",
        "timestamp": 1622466529
    },
    {
        "content": "<p>I'd recommend starting by listing out some specific threats: who is doing what to whom, and who should be in the position to prevent it?</p>",
        "id": 240842053,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1622472518
    },
    {
        "content": "<p>Yes, perhaps ask the requester to present a token and do an introspection along with rules based on ROLE and or consent ?  Or make the requester create a login account with the sender and force login before providing access. How would a SMART app in general access these type of links ?</p>",
        "id": 240897071,
        "sender_full_name": "Venu Gopal",
        "timestamp": 1622526233
    },
    {
        "content": "<p>In the general case, clinical documents are part of a record and can be shared. Documents can include links. That's not inherently a problem. If dereferencing a link would <em>unintentionally leak</em> information, then document authors should avoid creating links like that. But in general, document receivers should also be cautious about when/where to dereference a link. For an analogy: in GMail, I have \"do not show images\" enabled by default, which prevents a lot of tracking; email authors know this is a common setting, so they directly embed most visually important images to ensure they can work locally.</p>",
        "id": 240958120,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1622560803
    },
    {
        "content": "<p>Yeah I am okay with handling links at clients, because most likely the UI controls the rendering, prevent download, stop screen grab, not use webview and so on. Perhaps it should be dealt at compliance. Thank you for your views</p>",
        "id": 240959860,
        "sender_full_name": "Venu Gopal",
        "timestamp": 1622561494
    },
    {
        "content": "<p>First rule of Access Control --- when there is not full confidence in the receiver being able to do the right thing, then don't release the data. This is true of ALL things, not just REST or Documents.</p>",
        "id": 240960896,
        "sender_full_name": "John Moehrke",
        "timestamp": 1622561921
    },
    {
        "content": "<p>In the case of releasing data that has embedded URLs certainly does not remove the responsibility for the client to be careful getting the content at that URL, or proper security of that URL. It is not uncommon for Access Control being needed to access those URLs. The case of a style-sheet or images supporting a style-sheet; is likely a case where the GET will not encounter any access control. although the links should still be https, and be confirmed as coming from a trusted server.</p>",
        "id": 240961279,
        "sender_full_name": "John Moehrke",
        "timestamp": 1622562097
    },
    {
        "content": "<p>There will be other cases where embedded URLs are to protected resources. Examples might be a DocumentReference.content.attachment.url pointing at a clinical document; or an ImagingStudy pointing at a DICOM server. In these cases there will (hopefully) be access control that likely builds upon the SMART-on-FHIR access control model. In the case of use of DocumentReference, there is Implementation Guides from IHE that address a Health Information Exchange environment. In the case of ImagingStudy there are implementation guides from DICOM and some being worked on in IHE.</p>",
        "id": 240961668,
        "sender_full_name": "John Moehrke",
        "timestamp": 1622562246
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191404\">John Moehrke</span> <a href=\"#narrow/stream/179247-Security-and.20Privacy/topic/Feb.20report.20on.20health.20app.20vulnerabilities/near/240961668\">said</a>:</p>\n<blockquote>\n<p>There will be other cases where embedded URLs are to protected resources. Examples might be a DocumentReference.content.attachment.url pointing at a clinical document; or an ImagingStudy pointing at a DICOM server. In these cases there will (hopefully) be access control that likely builds upon the SMART-on-FHIR access control model. In the case of use of DocumentReference, there is Implementation Guides from IHE that address a Health Information Exchange environment. In the case of ImagingStudy there are implementation guides from DICOM and some being worked on in IHE.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> yes this is a scenario where I am getting at, in a few months from now. If I am not wrong, DICOM viewing needs login based on the vendor ?</p>",
        "id": 240963091,
        "sender_full_name": "Venu Gopal",
        "timestamp": 1622562855
    },
    {
        "content": "<p>and that is where it is helpful to keep in mind other standards organizations. IHE is a good organization to look to for implementation guides that span multiple standards. HL7 tends to be very focused on HL7.   -- This said, there is not much yet on the Imaging front as there has not been much demand.   I would very much like to encourage you to speak to your PACS vendors.</p>",
        "id": 240963831,
        "sender_full_name": "John Moehrke",
        "timestamp": 1622563143
    },
    {
        "content": "<p>Hi All - reviving this thread to give a shoutout to <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> for being amazing!!  I'm sure you guys have seen this but just really glad to see this has come full circle.  This is so awesome.  cc:  <span class=\"user-mention\" data-user-id=\"197491\">@Dave deBronkart</span> <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> <a href=\"https://podcasts.apple.com/us/podcast/conversation-alissa-knight-john-moehrke-ins-outs-fhir/id1533468758?i=1000530851279\">https://podcasts.apple.com/us/podcast/conversation-alissa-knight-john-moehrke-ins-outs-fhir/id1533468758?i=1000530851279</a></p>",
        "id": 248274887,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1628021957
    },
    {
        "content": "<p><a href=\"https://healthcaresecprivacy.blogspot.com/2021/08/inscope-podcast-fhir-security.html\">https://healthcaresecprivacy.blogspot.com/2021/08/inscope-podcast-fhir-security.html</a></p>",
        "id": 248280069,
        "sender_full_name": "John Moehrke",
        "timestamp": 1628024370
    },
    {
        "content": "<p>Will share / tweet.  Also if anyone here is interested, Defcon is this weekend!  Here's the lineup of speakers for the Biohacking Village, which focuses on healthcare, device security, DNA, etc.:  <a href=\"https://www.villageb.io/speakers2021\">https://www.villageb.io/speakers2021</a></p>",
        "id": 248301111,
        "sender_full_name": "Andrea Downing",
        "timestamp": 1628039557
    }
]