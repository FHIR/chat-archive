[
    {
        "content": "<p>Is this a cut and paste error? I cannot find any reference to \"CommitmentTypeIndication\" element in JWS. I suspect it is an xml thing. </p>\n<p><a href=\"/user_uploads/10155/AG5uehiqtnqW4If1w7n5NeFL/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/AG5uehiqtnqW4If1w7n5NeFL/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/AG5uehiqtnqW4If1w7n5NeFL/image.png\"></a></div><p>(<a href=\"http://hl7.org/fhir/datatypes.html#JSON\">http://hl7.org/fhir/datatypes.html#JSON</a>)</p>",
        "id": 271222879,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644373831
    },
    {
        "content": "<p>Should it be instead the  \"KeyUsage\" ?  (these do not match CommitmentTypeIndication values )</p>",
        "id": 271223045,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644374011
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span></p>",
        "id": 271223543,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644374542
    },
    {
        "content": "<p>I agree that there is no CommittmentTypeIndication in JWS... so what is the element name in JWS that indicates \"What is the meaning of this signature\"? And would be the indication that this is a author-signature, this is a counter-signature, this is a co-signature, etc?</p>",
        "id": 271273915,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644412369
    },
    {
        "content": "<p>This 'mistake' is indeed a copy from XML-Signature where this is clear... it is sitting here waiting for someone to notice and file a CR... good evidence that no one uses digital-signatures.</p>",
        "id": 271274024,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644412431
    },
    {
        "content": "<p>Good evidence that nobody is using <em>FHIR's Signature datatype</em>. (I'm saying something that's so obvious to you John it's not worth mentioning, but for others reading along here... of course digital signatures are widely used with FHIR, including in projects like <a href=\"https://spec.smarthealth.cards\">https://spec.smarthealth.cards</a>)</p>",
        "id": 271293340,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644420014
    },
    {
        "content": "<p>so then... has that project provided CR improvement opportunities for the Signature datatype and background?</p>",
        "id": 271330111,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433221
    },
    {
        "content": "<p>such as... where does the purpose of the signature go?</p>",
        "id": 271330159,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433238
    },
    {
        "content": "<p>I did submit several change requests for loosening the data requirements on provenance and signature.</p>",
        "id": 271330185,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644433250
    },
    {
        "content": "<p>In the contact of that work, the purpose of the signature is not explicitly modeled; it is external context known to participants in exchange</p>",
        "id": 271330223,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644433264
    },
    {
        "content": "<p>if it is understood.. then what is the use of the signature</p>",
        "id": 271330272,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433293
    },
    {
        "content": "<p>just kidding.</p>",
        "id": 271330277,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433296
    },
    {
        "content": "<p>but a signature purpose is an important element of a digital signature.</p>",
        "id": 271330312,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433314
    },
    {
        "content": "<p>overall... yes, i am fishing for feedback. yes Josh did provide some feedback already.</p>",
        "id": 271330430,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433345
    },
    {
        "content": "<p>that said... the XML-Siganture profiling is based on XaDES.. There is now a JaDES for json digital signatures. I have not looked deeply at it (mostly no spare time). It should give us the same kind of profiling as we used for XML-Signature -- <a href=\"https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf\">https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf</a></p>",
        "id": 271331520,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433853
    },
    {
        "content": "<p>page 55</p>",
        "id": 271331587,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433892
    },
    {
        "content": "<p>shows that the JAdES equivialnt of the XAdES CommitmentTypeIndication is ..... \"srCms\"</p>",
        "id": 271331631,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644433918
    },
    {
        "content": "<p>I logged <a href=\"https://jira.hl7.org/browse/FHIR-36000\">https://jira.hl7.org/browse/FHIR-36000</a></p>",
        "id": 271332051,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644434102
    },
    {
        "content": "<p>would appreciate  feedback on a use of JAdES.. It would not be mandated, just recommended... much like the xml-signature recommends XAdES. These are profiles of the raw digital signature standards for use, and these are refered to often in regulations/laws.</p>",
        "id": 271332217,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644434178
    },
    {
        "content": "<p>Josh brought up a lot of good points btw in his Jira tickects, nevertheless here is what we did for CDEX where we do  follow the guidance for the FHIR signature data type - I assumed \"KeyUsage\"  is the closest analog to \"CommitmentTypeIndication\" :</p>\n<p><a href=\"http://build.fhir.org/ig/HL7/davinci-ecdx/signatures.html\">http://build.fhir.org/ig/HL7/davinci-ecdx/signatures.html</a></p>",
        "id": 271341180,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644437849
    },
    {
        "content": "<p>We did not look at JAdES</p>",
        "id": 271341317,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644437910
    },
    {
        "content": "<p>Do you have a reference implementation of this scheme? I'm not seeing the implementation of canonicalization in the example at <a href=\"https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Digsig_Searchset_Bundle_Example.ipynb\">https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Digsig_Searchset_Bundle_Example.ipynb</a></p>",
        "id": 271342971,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644438707
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>canonical_bundle = dumps(search_bundle, sort_keys=True,separators=(&#39;,&#39;, &#39;:&#39;))\n</code></pre></div>\n\n<p>I don't think that's going be compatible with the FHIR requirements</p>",
        "id": 271343100,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644438756
    },
    {
        "content": "<p>(I'm only being difficult here because I don't know that the FHI requirements have ever been fully implemented, and I'm concerned that they are a significant risk here. Using attached signatures avoids this risk, or using a well standardized canonicalization algorithm like the IETF JSON canonical spec defines would be another way to mitigate that risk)</p>",
        "id": 271343222,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644438807
    },
    {
        "content": "<blockquote>\n<p>I don't know that the FHI requirements have ever been fully implemented, and I'm concerned that they are a significant risk here. </p>\n</blockquote>\n<p>I agree and that is why when I could not find any prior example (except for Healths Cards) , I set out to walk through and document it step by step.</p>\n<p>For a simple example the Python json dumps module gets the job done based upon what is documented for FHIR . That does not mean it would work  for  narratives and complex markdown fields.   I agree that canonicalization is tricky subject and it is not fully fleshed out in CDEX.  but then again the base definition is no better IMO.</p>\n<p>What do you mean by a reference implementation of this scheme?  (besides the Jupyter file .... no)</p>",
        "id": 271367725,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644451995
    },
    {
        "content": "<p>I could go back and use a json canonicalization module instead.  </p>\n<p>The <a href=\"https://datatracker.ietf.org/doc/html/rfc8785\">RFC8785</a> points to : <a href=\"https://github.com/cyberphone/json-canonicalization/tree/master/python3\">https://github.com/cyberphone/json-canonicalization/tree/master/python3</a></p>",
        "id": 271367981,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644452154
    },
    {
        "content": "<p>I am not sure if it is compatible with what is documented in FHIR, but are you suggesting CDEX promote ETF JSON canonical spec  (RFC 8785)?  which I am reading now.   Would this be a FHIR tracker too?</p>",
        "id": 271368926,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644452502
    },
    {
        "content": "<p>Seems reasonable to capture this question in a tracker; just want to avoid our publishing an IG requiring an approach that has never been tested. Better to leave the details out than to include wrong details in our list of requirements</p>",
        "id": 271375281,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644457028
    },
    {
        "content": "<p>In the proverbial cart before the horse scenario.   DaVinci project has CDEX RI and there are plans in the works to implement signatures.</p>",
        "id": 271378786,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644460315
    },
    {
        "content": "<p>I created examples using the methods outlined so proof of concept and not entirely made up out of whole cloth.</p>",
        "id": 271379020,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644460558
    },
    {
        "content": "<p>IF you don't think that it should be published as STU then can bring it up on cdex call or when we trot it out to FMG.</p>",
        "id": 271379088,
        "sender_full_name": "Eric Haas",
        "timestamp": 1644460616
    },
    {
        "content": "<p>Unlikely I'll have bandwidth to engage proactively on CDEX specs, but don't hesitate to ping me with any questions.</p>",
        "id": 271381124,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644462749
    },
    {
        "content": "<p>I am not at all understanding the concern about putting untested things into an IG. That is the whole purpose of an IG, to transition thru STU phase. I encourage this. I just ask that the 'lessons learned' be brought back to the specification for improvement... Much like ALL THE OTHER lessons learned about FHIR.</p>",
        "id": 271435433,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644502024
    },
    {
        "content": "<p>I'd recommend documenting the things that have been tested, and documenting uncertainty about things that haven't. And giving leeway for implementers to still be \"compliant\" if they only support the stuff that is known to work well. This is particularly critical for IGs aspiring to regulatory adoption, which I believe is the case for the work Eric is pointing out.</p>",
        "id": 271448500,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644507441
    },
    {
        "content": "<p>we have a confluence page linked to the signature datatype for this purpose. Please do so.</p>",
        "id": 271448866,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644507603
    },
    {
        "content": "<p><a href=\"https://hl7.org/fhir/signatures.html\">https://hl7.org/fhir/signatures.html</a></p>",
        "id": 271449005,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644507659
    },
    {
        "content": "<p><a href=\"https://confluence.hl7.org/display/FHIR/Digital+Signatures\">https://confluence.hl7.org/display/FHIR/Digital+Signatures</a></p>",
        "id": 271449059,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644507684
    },
    {
        "content": "<p>I have specified and documented  the canonicalization.  We going to publish CDEX with this as Draft and reballot in May.</p>",
        "id": 273522634,
        "sender_full_name": "Eric Haas",
        "timestamp": 1646068477
    }
]