[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191366\">@Stephen Royce</span> <span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span> I have subscribed you to this new channel for the r2:r3 mapping work</p>",
        "id": 153863545,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481766357
    },
    {
        "content": "<p>Thanks.</p>",
        "id": 153863546,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1481766388
    },
    {
        "content": "<p>today, my plan is to commit the following:<br>\n- candidate maps for R2/R3 in both directions<br>\n- a test application that executes all of the maps to test them<br>\n- extend the build to publish the maps along with their status</p>",
        "id": 153863547,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481766406
    },
    {
        "content": "<p>ok. maps are all generated, and added</p>",
        "id": 153863594,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481781871
    },
    {
        "content": "<p>see, for example: </p>",
        "id": 153863595,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481781873
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/allergyintolerance-version-maps.html\" target=\"_blank\" title=\"http://build.fhir.org/allergyintolerance-version-maps.html\">http://build.fhir.org/allergyintolerance-version-maps.html</a></p>",
        "id": 153863596,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481781882
    },
    {
        "content": "<p>there's a set of JUnit test cases that test them all. They all fail. just committing that now</p>",
        "id": 153863597,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481781927
    },
    {
        "content": "<p>Suite! :)<br>\nI assume you're good for me to get into this after Christmas?</p>",
        "id": 153863602,
        "sender_full_name": "Stephen Royce",
        "timestamp": 1481782100
    },
    {
        "content": "<p>sure</p>",
        "id": 153863608,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481783109
    },
    {
        "content": "<p>thx!</p>",
        "id": 153863609,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1481785366
    },
    {
        "content": "<p>ok, so, maps are committed for all the conversions I've been maintaining. A JUnit test case exists that tries to convert every r2 example to it's r3 equivalent using the map. Then it validates them. So far, 558 of the 729 examples fail - about what I expected.  </p>",
        "id": 153863675,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481866353
    },
    {
        "content": "<p>then the build picks up the maps and the outcome of the tests, and publishes them</p>",
        "id": 153863676,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481866371
    },
    {
        "content": "<p>see, for example: <a href=\"http://build.fhir.org/flag-version-maps.html\" target=\"_blank\" title=\"http://build.fhir.org/flag-version-maps.html\">http://build.fhir.org/flag-version-maps.html</a></p>",
        "id": 153863677,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481866425
    },
    {
        "content": "<p>I now need to convert them back to R2, and check that they round trip ok. That will increase the number of failures. </p>",
        "id": 153863678,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481866459
    },
    {
        "content": "<p>once I've done that, our task, between us, is to :<br>\n- run the JUnit test<br>\n- pick a resource that is failing, and edit the script so it succeeds. </p>",
        "id": 153863679,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481866512
    },
    {
        "content": "<p>I think the place to start is with running the JUnit tests. Are you all confortable running them from in eclipse? that will save me lots of work packaging the JUnit tests a different way</p>",
        "id": 153863680,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481866542
    },
    {
        "content": "<p>i'm comfortable running org/hl7/fhir/conversion/tests/R2R3ConversionTests.java  within eclipse, however I'm oxs based, so the path are nor the same, attached a patch which shoudl work on both (not verified on windows)<a href=\"/user_uploads/10155/6Lwg2SJPRrJ0GTjEAnx6O-wY/R2R3ConversionTestsPatch.patch\" target=\"_blank\" title=\"R2R3ConversionTestsPatch.patch\">R2R3ConversionTestsPatch.patch</a> </p>",
        "id": 153863692,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1481879194
    },
    {
        "content": "<p>adopted a variant of your patch. When you run the tests, you have to set the working directory to the build folder. </p>",
        "id": 153863773,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481921361
    },
    {
        "content": "<p>and also, you have to do a full build locally before running the tests. see </p>",
        "id": 153863774,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481921375
    },
    {
        "content": "<p><a href=\"http://wiki.hl7.org/index.php?title=FHIR_Build_Process\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=FHIR_Build_Process\">http://wiki.hl7.org/index.php?title=FHIR_Build_Process</a></p>",
        "id": 153863775,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1481921418
    },
    {
        "content": "<p>ok, just committed full working stack, with Flag passing all tests</p>",
        "id": 153863890,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1482004525
    },
    {
        "content": "<p>we're now good to go. Your rough process is :<br>\n- update from svn<br>\n- run a full build<br>\n- run the R2R3ConversionTests java class from Eclipse (Run as a JUnit Application), and make sure the default directory is {build})<br>\n- now consult {build}\\implementations\\r2maps\\management.txt to help choose a resource type to work on<br>\n- look in {build}\\implementations\\r2maps\\outcomes.json to see what errors there are with the resource<br>\n- look in {build}\\implementations\\r2maps\\test-output, and use some diff tool to compare the before/after on the round trips<br>\n- make adjustments to the mapping script<br>\n- rerun the tests and back to comparisons<br>\n- update management.txt, and commit along with updated script</p>",
        "id": 153863892,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1482004781
    },
    {
        "content": "<p>when running R2R3ConverstionTests, you can pass it a command line parameter to limit it to a particular resource type (e.g. -Dresource=X)</p>",
        "id": 153863896,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1482006123
    },
    {
        "content": "<p>a couple of other notes:<br>\n- the before/after comparison is on canonical XML and ignores comments. So you might see text differences in the before/after that the test says is ok<br>\n- order presently matters in the R3 -&gt; R3 conversions. I'll have to fix that </p>",
        "id": 153863899,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1482008861
    },
    {
        "content": "<p>hmm, I've got concept map and value set round tripping working  - but both caused some deep revisions to the mapping language. I'll let you know when I've updated the tutorial</p>",
        "id": 153864722,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1482370238
    },
    {
        "content": "<p>found them in the spec - way cool!</p>",
        "id": 153864724,
        "sender_full_name": "David Hay",
        "timestamp": 1482370375
    },
    {
        "content": "<p>Thx</p>",
        "id": 153864725,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1482370401
    },
    {
        "content": "<p>ok. doco is updated, order problem is fixed. I have round-tripping working for the hardest resources (ValueSet, ConceptMap, StructureDefinition - mostly, CapabilityStatement). All good to go for the simpler stuff</p>",
        "id": 153864834,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1482442463
    },
    {
        "content": "<p>well. So I got into gear and got the process of doing resource maps down to 5-10 min per type. So I decided to just do all the resources.</p>",
        "id": 153865550,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1483568640
    },
    {
        "content": "<p>shortly, a summary will become available at <a href=\"http://build.fhir.org/r2maps.html\" target=\"_blank\" title=\"http://build.fhir.org/r2maps.html\">http://build.fhir.org/r2maps.html</a></p>",
        "id": 153865552,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1483568660
    }
]