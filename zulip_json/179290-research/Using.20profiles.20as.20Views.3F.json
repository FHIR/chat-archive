[
    {
        "content": "<p>Hi all, I am visiting an academic hospital next week and they have the following question about FHIR: after storing all patients from the EHR in a FHIR-server with profile PatientEHR, they want researchers to be able to fetch a limited set of attributes as defined in their profile PatientResearch. The search should work on the same data as stored via PatientEHR, but returns only the data as described in PatientResearch. Is this possible in FHIR and if yes, where can I find the specs?</p>",
        "id": 167846647,
        "sender_full_name": "Rob Mulders",
        "timestamp": 1560257578
    },
    {
        "content": "<p>There is some support being built into FHIR for supporting Research. There is no \"PatientResearch\", so I can't really understand your question. There is a ResearchStudy that defines a specific project, and a ResearchSubject which is a linkage to a subject. These are early developments so now is a good time to engage to produce a future outcome. You might want to start <a href=\"https://www.hl7.org/fhir/researchstudy.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/researchstudy.html\">https://www.hl7.org/fhir/researchstudy.html</a></p>",
        "id": 167850893,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560260639
    },
    {
        "content": "<p>It is possible for a FHIR server to \"trim\" what data elements are exposed based on who's asking and what authorization they (currently) hold.  It's also possible to use the '_elements' parameter to filter what elements are returned.  However, there isn't currently a way to pass a reference to a profile as part of a query and ask for the server to filter the results such that they comply with the profile.  (That's a super-hard problem and quite challenging to do in a generic and performant manner.)</p>",
        "id": 167862749,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1560268168
    },
    {
        "content": "<p>because we are using HTTP REST, one can orchestrate multiple services. So one could have a low level service interface that is raw FHIR to a FHIR Server. With an intermediary service that is assembling the result and possibly doing other things like de-identification.  etc...  by doing it this way you separate concerns and functions while having a consistent API (based on FHIR) between all of the service layers.</p>",
        "id": 167863662,
        "sender_full_name": "John Moehrke",
        "timestamp": 1560268744
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193641\">@Rob Mulders</span> There is a pop-up session on exactly this topic this afternoon at the dev-days, that was triggered by the discussions at the last HL7 WGM NL (see <a href=\"#narrow/stream/179170-smart/topic/SMART.20for.20research.2Fquality.20purposes\" title=\"#narrow/stream/179170-smart/topic/SMART.20for.20research.2Fquality.20purposes\">https://chat.fhir.org/#narrow/stream/179170-smart/topic/SMART.20for.20research.2Fquality.20purposes</a>). Will keep you posted on the results!</p>",
        "id": 167866663,
        "sender_full_name": "Sebastiaan Knijnenburg",
        "timestamp": 1560270960
    },
    {
        "content": "<p>Hi Rob, </p>\n<p>the topic of your posting is a bit misleading. I guess it's not a Profile you need but a Composition+Bundle. </p>\n<blockquote>\n<p>Hi all, I am visiting an academic hospital next week and they have the following question about FHIR: after storing all patients from the EHR in a FHIR-server with profile PatientEHR, they want researchers to be able to fetch a limited set of attributes as defined in their profile PatientResearch. </p>\n</blockquote>\n<p>From a compliance perspective, you'd want the researcher requests to be signed off by the local IRB - so you'd define a Composition Resource and a Bundle. It defines explicitly and expressively what you'll be sharing.  Ideally write a Clear Implementation guide for that because your IRB will want to understand what you are sharing without having to understand to much about FHIR.  </p>\n<blockquote>\n<p>The search should work on the same data as stored via PatientEHR, but returns only the data as described in PatientResearch. Is this possible in FHIR and if yes, where can I find the specs?</p>\n</blockquote>\n<p>You define a FHIR Task to pseudonymize the data and pass it on to a research repository or application. If you use  VONK you could also write a plugin to do that. But there are many ways to do that with other tools.</p>",
        "id": 167872048,
        "sender_full_name": "Gustav Vella",
        "timestamp": 1560274679
    },
    {
        "content": "<p>In practice however you might need more than that - you'd usually want to view that data - ideally in the clinical context - before you pass on the stuff to the research domain (possibly in a reporting SMART on FHIR app) and perform a data review.</p>\n<p>Also, In practice you'll get big gaps in your structured data and your EMR will have no means of raising that data in the granularity needed by your researchers. So in our case we add additional data points for Unstructured and Semistructured data in  a report, prefill the available structured data in the Form App and add the missing data in the Clinical Context.</p>",
        "id": 167873087,
        "sender_full_name": "Gustav Vella",
        "timestamp": 1560275425
    },
    {
        "content": "<p>B.t.w - if you really have to sell the benefits of FHIR to your IRB stakeholders, Data Provenance (Practitioner Info) and History (Autdittrail) - are covered by the FHIR spec Also, you can validate on the basis of the profiles to a certain point on the item value level what's really going through to your research database.</p>",
        "id": 167873709,
        "sender_full_name": "Gustav Vella",
        "timestamp": 1560275867
    },
    {
        "content": "<p>I don't see why you'd need either Composition or Bundle.  The IRB would need to sign off on the types of requests allowed (and who could make them), but I wouldn't necessarily expect them to sign each set of information disclosed - nor would you want to force the shared data to have to be a FHIR document.  Real-time query and/or Bulk Data would be more appropriate interfaces for sharing.</p>",
        "id": 167874240,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1560276148
    },
    {
        "content": "<blockquote>\n<p>The IRB would need to sign off on the types of requests allowed (and who could make them), </p>\n</blockquote>\n<p>Exactly but the Scope is defined in my Composition. He just signs that off once for each individual research /shring use case - but not for each instance / request. What he also does is makes sure that the data only gets shared if consent given 'yes' (key part for each research bundle)</p>\n<p>Is there any good reason why  you would  NOT do it that way? </p>\n<blockquote>\n<p>but I wouldn't necessarily expect them to sign each set of information disclosed. </p>\n</blockquote>\n<p>not each instance. but we do have an individual review for each project setup.</p>\n<blockquote>\n<p>nor would you want to force the shared data to have to be a FHIR document. </p>\n</blockquote>\n<p>agree..assumed from Rob's message that they have all in there</p>\n<blockquote>\n<p>Real-time query and/or Bulk Data would be more appropriate interfaces for sharing.</p>\n</blockquote>\n<p>Possibly - have no first hand experience with both approaches yet. Most hospitals I work with don't allow real time queries on their Central FHIR CDR. even from their own local research environment.</p>",
        "id": 167877954,
        "sender_full_name": "Gustav Vella",
        "timestamp": 1560278422
    },
    {
        "content": "<p>The need to sign things doesn't necessarily mean you need Composition.  You could easily sign off on a protocol (expressed as PlanDefinition) without bringing FHIR documents into it at all.  Generally, I try to avoid the overhead of FHIR documents unless it's strictly needed.</p>",
        "id": 167878873,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1560279026
    },
    {
        "content": "<p>Thanks all for the fast answers! <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> , in my question PatientResearch is their own defined profile, inheriting things from their own defined PatientEHR, which in turn inherits things from nl-core-Patient from Nictiz, which in turn inherits things from Patient (core). Under PatientResearch their might be a self defined profile for each (set of) study/studies, but only if necessary.</p>",
        "id": 167924211,
        "sender_full_name": "Rob Mulders",
        "timestamp": 1560326606
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194020\">@Gustav Vella</span> like Lloyd says I don't want to go the way of Composition and FHIR documents, because the UMC wants to use Real time REST (for applications like Castor) and Bulk export.</p>",
        "id": 167924400,
        "sender_full_name": "Rob Mulders",
        "timestamp": 1560326755
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> you wrote \"a way to pass a reference to a profile as part of a query and ask for the server to filter the results such that they comply with the profile is not available\" but it would be a killer feature for research! Because in that case, the UMC would be able to use the workflow in Simplifier to ask, grant, deliver, audit and evaluate the whole data sequence for researchers, with full compliance cycle for each different request.</p>",
        "id": 167924816,
        "sender_full_name": "Rob Mulders",
        "timestamp": 1560327213
    },
    {
        "content": "<p>By the way, not only for research, but also for Quality Registers it would be awesome. The QR's in The Netherlands start to publish the definition of their data-requests (like IKNL at <a href=\"https://simplifier.net/Oncolinq\" target=\"_blank\" title=\"https://simplifier.net/Oncolinq\">https://simplifier.net/Oncolinq</a>), and if they do it the right way (inheriting from the nl-core profiles), we would be one step further in the jungle of data delivery from hospitals to QR's.</p>",
        "id": 167925078,
        "sender_full_name": "Rob Mulders",
        "timestamp": 1560327512
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197406\">@Sebastiaan Knijnenburg</span> thanks, I missed the HL7NL session, but will be there on the next WGM and next DevDays.</p>",
        "id": 167925381,
        "sender_full_name": "Rob Mulders",
        "timestamp": 1560327904
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193641\">@Rob Mulders</span> There's nothing that stops you from defining a custom feature from passing in a profile as a custom search parameter.  HL7 has declined to do so as a standard search parameter (and all of the open source implementations have declined to implement such a thing) because it has the potential to be totally evil from a performance perspective.  To just filter elements, we already have _elements.  Which means that if you want to pass a profile, there's a desire to do more (limitations on bindings, slicing, etc.)  Applying those to output results can be super-expensive.  The validation process that simply checks for validity against a profile can clock in at a second or more per instance (and it's a super complex set of code).  Attempting to manipulate an instance to comply with a profile would be even worse and could be non-computable.  As an example, imagine that the instance has 3 <a href=\"http://Patient.name\" target=\"_blank\" title=\"http://Patient.name\">Patient.name</a> instances.  The query profile demands there be only 1.  How is the server supposed to know which one to return?</p>\n<p><span class=\"user-mention\" data-user-id=\"191351\">@Chris Grenz</span> has done some work in this space, but I'm not aware of anyone else who's even tried.</p>",
        "id": 167950590,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1560348711
    },
    {
        "content": "<p>Slowly working on an open source library for extracting search parameters from profiles and then optimizing validation to support the \"search by profile\" concept.  There are some general concepts about how a profile can be used for redaction here: <a href=\"https://github.com/chrisgrenz/FHIR-Primer/wiki/Predictable-Resource-Redaction\" target=\"_blank\" title=\"https://github.com/chrisgrenz/FHIR-Primer/wiki/Predictable-Resource-Redaction\">https://github.com/chrisgrenz/FHIR-Primer/wiki/Predictable-Resource-Redaction</a></p>",
        "id": 167955889,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1560352014
    },
    {
        "content": "<p>Lloyds example is specifically disallowed: \"the server will not silently sample an unordered list\"</p>",
        "id": 167955959,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1560352059
    },
    {
        "content": "<p>Built a working example of this in the past, but it's not public code unfortunately.</p>",
        "id": 167955985,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1560352077
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197406\">@Sebastiaan Knijnenburg</span> Any news/results from the dev-days session?</p>",
        "id": 168491796,
        "sender_full_name": "Bram Wesselo",
        "timestamp": 1560937140
    }
]