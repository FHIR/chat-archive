[
    {
        "content": "<p>I've been working the UML sub-system over a fair bit. Concerning the UML diagrams we say:</p>\n<blockquote>\n<p>The actual order of the elements in XML cannot be determined from the diagram</p>\n</blockquote>\n<p>But I have no memory of why we say this, and I think it's only true for interfaces/patterns, not true of the UML diagrams themselves</p>\n<p>Thoughts?</p>",
        "id": 183814820,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576729043
    },
    {
        "content": "<p>When I've finished, the definitions will be more natural in UML... I don't know if we should revisit the discussion of whether there's a UML format worth generating?</p>",
        "id": 183814874,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576729090
    },
    {
        "content": "<p>we considered XMI (unreliable) and eCore before. Who would use BMM (other than Tom)? Anything else we should talk about?</p>",
        "id": 183814889,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576729139
    },
    {
        "content": "<p>ah - order - can't tell where the associations fit in</p>",
        "id": 183815740,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576730251
    },
    {
        "content": "<p>right.  attributes are fine, associations, not so much.</p>",
        "id": 183815962,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1576730588
    },
    {
        "content": "<blockquote>\n<p>we considered XMI (unreliable) and eCore before. Who would use BMM (other than Tom)? Anything else we should talk about?</p>\n</blockquote>\n<p>Not that I am really suggesting it, but BMM is used by CIMI (or at least was, unless replaced by something else recently), and also all the archetyping tools in openEHR (4 at last count, from 4 different orgs). It's probably going to be the de facto model representation standard for the openEHR and extended community, with a generator from the UML tool (MagicDraw), and downstream generators for JSON-schema, Java, and other languages. Someone is even using it to generate Kotlin. See <a href=\"http://specifications.openehr.org/releases/LANG/latest/bmm.html\" target=\"_blank\" title=\"http://specifications.openehr.org/releases/LANG/latest/bmm.html\">specifications.openehr.org/releases/LANG/latest/bmm.html</a> for the v3 spec. All the tools currently do BMMv2.</p>\n<p>The reason you might consider it is the same reason we have it: XMI is a) terrible and b) doesn't do normal generics properly. Ecore (their lang is called Xcore - see <a href=\"https://wiki.eclipse.org/Xcore\" target=\"_blank\" title=\"https://wiki.eclipse.org/Xcore\">https://wiki.eclipse.org/Xcore</a>) is not too bad, but as far as I can tell not specified by anything more formal than that Eclipse wikipedia page. It also doesn't do generics properly last time I looked, and also has a bunch of C++-like junk such as 'protected', 'static' etc which you don't want in proper models.</p>\n<p>I could not find any other good languages to use over the last 10 years. When we upgrade to BMMv3, we will make the syntax look more like Xcore and/or OMG IDL (they are fairly similar).</p>\n<p>For now, everything is in BMM2, which doesn't do functional or procedural elements, but does all the data representation you want. FHIR in BMM2 is here (it's not 100% and only about 80% complete of DSTU4, but you will get the idea - and it computes in ADL Workbench) - <a href=\"https://github.com/openEHR/reference-models/tree/master/models/FHIR/DSTU/BMM\" target=\"_blank\" title=\"https://github.com/openEHR/reference-models/tree/master/models/FHIR/DSTU/BMM\">https://github.com/openEHR/reference-models/tree/master/models/FHIR/DSTU/BMM</a></p>",
        "id": 183955169,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576862647
    },
    {
        "content": "<p>This version of BMM even includes a FHIR-ism that we added (also needed in openEHR) - vocabulary constraints - not yet the required|recommended|example thing in FHIR, but we will probably go that way as well. Example:</p>\n<div class=\"codehilite\"><pre><span></span>    [&quot;relationship&quot;] = (P_BMM_CONTAINER_PROPERTY) &lt;\n        name = &lt;&quot;relationship&quot;&gt;\n        type_def = &lt;\n            container_type = &lt;&quot;List&quot;&gt;\n            type_def = (P_BMM_SIMPLE_TYPE) &lt;\n                type = &lt;&quot;CodeableConcept&quot;&gt;\n                value_constraint = &lt;&quot;fhir::PatientRelationshipType&quot;&gt;  -- ***** VOCAB constraint\n            &gt;\n        &gt;\n        cardinality = &lt;|&gt;=0|&gt;\n    &gt;\n</pre></div>\n\n\n<p>If you don't like ODIN syntax, you can get BMM in JSON - see e.g. the whole openEHR RM in BMM+JSON: <a href=\"https://github.com/openEHR/specifications-ITS-BMM/blob/master/components/RM/Release-1.0.4/json/openehr_rm_ehr_1.0.4.bmm.json\" target=\"_blank\" title=\"https://github.com/openEHR/specifications-ITS-BMM/blob/master/components/RM/Release-1.0.4/json/openehr_rm_ehr_1.0.4.bmm.json\">https://github.com/openEHR/specifications-ITS-BMM/blob/master/components/RM/Release-1.0.4/json/openehr_rm_ehr_1.0.4.bmm.json</a></p>",
        "id": 183955484,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576862914
    },
    {
        "content": "<p>At the end of the day, even though the generated UML is useful in FHIR, the faked up way you have been doing it is probably actually better than any official proper UML2-compliant version, for the basic reason that UML doesn't represent all the things you want to represent - generics; choice (of course), terminology constraints, and more. It has no meta-model for the latter.</p>",
        "id": 183955618,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576863018
    },
    {
        "content": "<p>The long term picture is that you will need a rock-solid model representation formalism, and UML 2.x is not it. Within OMG, it will be replaced by one or both of two new efforts - SysML2 (looks good, but a couple of years away), or a revamped UML (also a couple of years AFAIK). Xcore doesn't have proper generics or vocab constraints. OMG IDL3 is probably over-engineered in some aspects, and under on others. BMM3 is designed more like a strongly typed OO+FP meta-model, and knows about terminology, proper generics, inheritance with generics and various other tricks. Also, there is a modern and well-maintained Java lib for it - <a href=\"https://github.com/openEHR/archie\" target=\"_blank\" title=\"https://github.com/openEHR/archie\">https://github.com/openEHR/archie</a></p>",
        "id": 183955999,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576863289
    },
    {
        "content": "<p>Note that choice[] is supported in none of these formalisms, for reasons discussed at length previously, and where you have choice[] or Reference() in FHIR today, you would see ?Type or something like 'Reference', with no constraints. All constraints are in the archetype layer. BTW I translated FHIR DSTU4 to BMM2 so as to show how to do constraining / profiling using a layer of archetypes over a properly-type model of FHIR. At some point I'll publish some examples.</p>",
        "id": 183956196,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576863459
    },
    {
        "content": "<p>All of those diags of FHIR I produced from our tools on my blog (Admin classes etc - <a href=\"https://wolandscat.net/category/fhir-2/\" target=\"_blank\" title=\"https://wolandscat.net/category/fhir-2/\">https://wolandscat.net/category/fhir-2/</a>) are from a modified version of the BMM2 representation of FHIR.</p>",
        "id": 183956367,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576863584
    },
    {
        "content": "<p>where is BMM2 documented?</p>",
        "id": 183970256,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576873820
    },
    {
        "content": "<p>You can see that here: <a href=\"http://raw.githack.com/openEHR/specifications-BASE/c352f1bbff5c417d5bf8834a1c5c8b3565219d67/docs/bmm/bmm.html\" target=\"_blank\" title=\"http://raw.githack.com/openEHR/specifications-BASE/c352f1bbff5c417d5bf8834a1c5c8b3565219d67/docs/bmm/bmm.html\">http://raw.githack.com/openEHR/specifications-BASE/c352f1bbff5c417d5bf8834a1c5c8b3565219d67/docs/bmm/bmm.html</a></p>",
        "id": 184010787,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576934808
    },
    {
        "content": "<p>'BMM2' mainly refers to the persistent (serial) form - documented here - <a href=\"https://specifications.openehr.org/releases/LANG/latest/bmm_persistence.html\" target=\"_blank\" title=\"https://specifications.openehr.org/releases/LANG/latest/bmm_persistence.html\">https://specifications.openehr.org/releases/LANG/latest/bmm_persistence.html</a></p>",
        "id": 184010841,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576934888
    },
    {
        "content": "<p>The in memory form is the main 'BMM' spec. The modern form of that is <a href=\"https://specifications.openehr.org/releases/LANG/latest/bmm.html\" target=\"_blank\" title=\"https://specifications.openehr.org/releases/LANG/latest/bmm.html\">https://specifications.openehr.org/releases/LANG/latest/bmm.html</a> - if you ignore the functional and values sections, the rest is what the ADL workbench implements. The Archie library is a bit behind but catching up.</p>",
        "id": 184010850,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576934942
    },
    {
        "content": "<p>For the in-memory form, there is no real 'BMM2' or 'BMM3', its just an evolving model. But we have to keep the BMM2 and BMM3 (when it comes) persistent forms separate. Yes, I know, a bit confusing. It took off in the community without me realising, and we need to clean up some of the git versioning details.</p>",
        "id": 184010909,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1576935026
    },
    {
        "content": "<p>so I had a quick look at the abstract syntax. It's missing some pretty key features from my pov:</p>\n<ul>\n<li>invariants (it uses them itself, but doesn't allow them to be defined)</li>\n<li>interfaces </li>\n<li>stereotypes / any form of meta properties</li>\n</ul>\n<p>given that, I don't really see any point in trying to generate BMM. And it's not surprising you have trouble if you try to see FHIR through the lens of BMM</p>",
        "id": 184022542,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576956192
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194379\">@Robert Lario</span> do you have any comments about a usable UML format that is supported between tools?</p>",
        "id": 184023718,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576958501
    },
    {
        "content": "<p>Invariants &amp; pre- and post-conditions (which we had in openEHR specs since 2003) are just going in now. Interfaces don't have a specific keyword or meta-type; currently they are just any type that consists only of methods and not data. Maybe we'll add something to make it a bit clearer. Stereotypes - we do have some, but they are a bit specific. I'm just adding the general capability now as it happens. What are your requirements - classifiers on classes and features? Something more?</p>",
        "id": 184098091,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1577099979
    },
    {
        "content": "<p>The main thing BTW that has to be gotten right for invariants is the expression language, including functional elements (lambas), proper meaning of dot-notation and operator/function mapping. UML/OCL don't do this unfortunately (UML doesn't even recognise delayed function call, and ultimately doesn't distinguish type from class, which is the real killer).</p>",
        "id": 184098204,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1577100108
    },
    {
        "content": "<p>If you find a supported formalism out there somewhere that does all this properly, I'll be very interested to hear about it.</p>",
        "id": 184098269,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1577100149
    },
    {
        "content": "<blockquote>\n<p>currently interfaces are just any type that consists only of methods and not data</p>\n</blockquote>\n<p>this is a problem for me, since UML doesn't differentiate between attributes that represent data and attributes that represent interface. e.g. this class has a 'x' of type x that you can read or write vs this class actually stores an 'x' internally. </p>\n<p>Methods that provide read access are actually something different. Classes with only methods may be concrete leaf descendants that flesh out a method, or they may interface-ish classes. So please make this explicit not implicit. I don't particularly care how. </p>\n<blockquote>\n<p>What are your requirements - classifiers on classes and features? </p>\n</blockquote>\n<p>well, not exactly sure what you mean by 'classifier'; I don't mind whether it's a series of stereotype values or a series of name = value pairs , though I prefer the latter - much more flexible and reliable. And yes, on both classes and features.</p>\n<p>if you're adding stuff... allow an extension to drop a series of SVGs in...</p>\n<blockquote>\n<p>The main thing BTW that has to be gotten right for invariants is the expression language</p>\n</blockquote>\n<p>Well, we use FHIRPath (<a href=\"http://hl7.org/fhir/fhirpath\" target=\"_blank\" title=\"http://hl7.org/fhir/fhirpath\">http://hl7.org/fhir/fhirpath</a>), which I would recommend, actually. It certainly works just fine against openEHR classes, since it works fine against any UML class model. And I think it meets your criteria...</p>",
        "id": 184127544,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1577130039
    },
    {
        "content": "<p>Interfaces: do you mean a type IX is a transactional interface to an x or type X (a proxy of some sort), versus a type X, which is a direct instance of an x:X?</p>\n<p>Ah - you mean interfaces = pure interface def, i.e. without code. Got it. WHere's an example in FHIR?</p>\n<p>On the meta-data, the default right now is a Hash list of keyed values; same for documentation. For SVGs: are you meaning to allow model diags or similar?</p>",
        "id": 184136878,
        "sender_full_name": "Thomas Beale",
        "timestamp": 1577140297
    },
    {
        "content": "<blockquote>\n<p>you mean interfaces = pure interface def, i.e. without code. </p>\n</blockquote>\n<p>... umm yes. well, kind of. Without storage. That's not quite the same as without code but I'm not defining code on the interfaces in FHIR</p>\n<blockquote>\n<p>Got it. Where's an example in FHIR?</p>\n</blockquote>\n<p><a href=\"http://build.fhir.org/canonicalresource.html\" target=\"_blank\" title=\"http://build.fhir.org/canonicalresource.html\">http://build.fhir.org/canonicalresource.html</a></p>\n<p>Maybe one day it'll migrate to being a real resource, but not right now. </p>\n<blockquote>\n<p>On the meta-data, the default right now is a Hash list of keyed values; same for documentation. </p>\n</blockquote>\n<p>that works</p>\n<blockquote>\n<p>For SVGs: are you meaning to allow model diags or similar?</p>\n</blockquote>\n<p>sure. and you can tie the SVG elements to the underlying logical classes by id</p>",
        "id": 184142483,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1577148082
    }
]