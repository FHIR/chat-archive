[
    {
        "content": "<p>Below are a couple of errors we are getting while testing a section on Bulk in Inferno:</p>\n<p>1 - <br>\n     Request:  GET   <a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/$bulkdata-status?job=oVWUczflBh_chJhcTfY2Hw\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/$bulkdata-status?job=oVWUczflBh_chJhcTfY2Hw</a></p>\n<div class=\"codehilite\"><pre><span></span><code>Response:\n</code></pre></div>\n\n<p>{<br>\n  \"transactionTime\": \"2021-09-21T10:53:53.879Z\",<br>\n  \"request\": \"<a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17b5e38b010-74858f83-7570-45cb-979b-8d00b694a293/$export\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17b5e38b010-74858f83-7570-45cb-979b-8d00b694a293/$export</a>\",<br>\n  \"requiresAccessToken\": true,<br>\n  \"output\": [<br>\n    {<br>\n      \"type\": \"Provenance\",<br>\n      \"url\": \"<strong>KTwhDhHknT5k7lLtqB8eUQM2e0LuvIgX7NQSLqbH5_A/Provenance_1.ndjson</strong>\",<br>\n      \"count\": 1<br>\n    },<br>\n    {<br>\n      \"type\": \"AllergyIntolerance\",<br>\n      \"url\": \"<strong>KTwhDhHknT5k7lLtqB8eUQM2e0LuvIgX7NQSLqbH5_A/AllergyIntolerance_1.ndjson</strong>\",<br>\n      \"count\": 1<br>\n    }<br>\n  ],<br>\n  \"error\": []<br>\n}</p>\n<p>Can we get a complete URL in the highlighted section above? The reason is that Inferno further uses the URL above to access the respective resources. In the current situation, when it tries to access the same, it fails because the URL is incomplete.</p>\n<p>2 - <br>\n    After the bulk export was completed, we could not find below resources<br>\n     Device<br>\n     Organization<br>\n     Practitioner </p>\n<div class=\"codehilite\"><pre><span></span><code> Is there a way to configure the export of the above resources or do you need to add support for this in IBM FHIR?\n</code></pre></div>",
        "id": 254211862,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1632232981
    },
    {
        "content": "<p>it sounds like you're using file-based \"storageProvider\" in your fhir-server-config.json<br>\nfor the file-based export, we don't support proxying the exported files from the server and so we cannot give you a full URL (or if we did, it would be a <code>file:</code> url).<br>\nare you able to use aws-s3 / ibm-cos?  if you need to keep the data local, you could look at using MinIO which is what our CI pipeline tests</p>",
        "id": 254219934,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1632235894
    },
    {
        "content": "<p>Hi Lee</p>\n<p>Will you please help us with second point?<br>\n2 - <br>\n    After the bulk export was completed, we could not find below resources<br>\n     Device<br>\n     Organization<br>\n     Practitioner </p>\n<div class=\"codehilite\"><pre><span></span><code> Is there a way to configure the export of the above resources or do you need to add support for this in IBM FHIR?\n</code></pre></div>",
        "id": 254369515,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1632318406
    },
    {
        "content": "<p>HI Mahesh, a few questions... how many resources are stored in the Device / Organization and Practitioner resource types?  a simple FHIR Search can confirm.  What was the $export request was it on Patient or a System Level export?</p>",
        "id": 254370094,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1632318602
    },
    {
        "content": "<p>1 - $export is on group level:<br>\n     Request GET <a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17b5e38b010-74858f83-7570-45cb-979b-8d00b694a293/$export\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17b5e38b010-74858f83-7570-45cb-979b-8d00b694a293/$export</a></p>\n<div class=\"codehilite\"><pre><span></span><code>  Response 202 Accepted\n\n After the export is completed below is the list of resources exported. If you see here, device, organization, and practitioner resources are missing.\n</code></pre></div>\n\n<p>image.png</p>\n<p>2 - Device resource details<br>\n    Request GET <a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device</a></p>\n<div class=\"codehilite\"><pre><span></span><code> Response\n</code></pre></div>\n\n<p>{<br>\n    \"resourceType\": \"Bundle\",<br>\n    \"id\": \"cc4382af-9409-4d04-9141-f4a37ec80b91\",<br>\n    \"type\": \"searchset\",<br>\n    \"total\": 3,<br>\n    \"link\": [<br>\n        {<br>\n            \"relation\": \"self\",<br>\n            \"url\": \"<a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device?_count=10&amp;_page=1\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device?_count=10&amp;_page=1</a>\"<br>\n        }<br>\n    ],<br>\n    \"entry\": [<br>\n        {<br>\n            \"id\": \"17b587c2d01-038ded08-f14a-40b6-b0e3-6182a8cfc404\",<br>\n            \"fullUrl\": \"<a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device/17b587c2d01-038ded08-f14a-40b6-b0e3-6182a8cfc404\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device/17b587c2d01-038ded08-f14a-40b6-b0e3-6182a8cfc404</a>\",<br>\n            \"resource\": {<br>\n                \"resourceType\": \"Device\",<br>\n                \"id\": \"17b587c2d01-038ded08-f14a-40b6-b0e3-6182a8cfc404\",<br>\n                \"meta\": {<br>\n                    \"versionId\": \"1\",<br>\n                    \"lastUpdated\": \"2021-08-18T08:58:58.177514Z\",<br>\n                    \"profile\": [<br>\n                        \"<a href=\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-implantable-device\">http://hl7.org/fhir/us/core/StructureDefinition/us-core-implantable-device</a>\"<br>\n                    ]<br>\n                },<br>\n                \"udiCarrier\": [<br>\n                    {<br>\n                        \"deviceIdentifier\": \"43069338026389\",<br>\n                        \"carrierHRF\": \"(01)43069338026389(11)000302(17)250317(10)1134(21)842026117977\"<br>\n                    }<br>\n                ],<br>\n                \"status\": \"active\",<br>\n                \"distinctIdentifier\": \"43069338026389\",<br>\n                \"manufactureDate\": \"2000-03-02T18:33:18-05:00\",<br>\n                \"expirationDate\": \"2025-03-17T19:33:18-04:00\",<br>\n                \"lotNumber\": \"1134\",<br>\n                \"serialNumber\": \"842026117977\",<br>\n                \"deviceName\": [<br>\n                    {<br>\n                        \"name\": \"Implantable defibrillator, device (physical object)\",<br>\n                        \"type\": \"user-friendly-name\"<br>\n                    }<br>\n                ],<br>\n                \"type\": {<br>\n                    \"coding\": [<br>\n                        {<br>\n                            \"system\": \"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\",<br>\n                            \"code\": \"72506001\",<br>\n                            \"display\": \"Implantable defibrillator, device (physical object)\"<br>\n                        }<br>\n                    ],<br>\n                    \"text\": \"Implantable defibrillator, device (physical object)\"<br>\n                },<br>\n                \"patient\": {<br>\n                    \"reference\": \"Patient/17b57f46378-a6944791-e6ad-4f0f-8e37-683f47f24fa1\"<br>\n                }<br>\n            },<br>\n            \"search\": {<br>\n                \"mode\": \"match\",<br>\n                \"score\": 1<br>\n            }<br>\n        },<br>\n        {<br>\n            \"id\": \"17b587c5238-61cb7fd9-0596-4672-b199-22cb2329c1ba\",<br>\n            \"fullUrl\": \"<a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device/17b587c5238-61cb7fd9-0596-4672-b199-22cb2329c1ba\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device/17b587c5238-61cb7fd9-0596-4672-b199-22cb2329c1ba</a>\",<br>\n            \"resource\": {<br>\n                \"resourceType\": \"Device\",<br>\n                \"id\": \"17b587c5238-61cb7fd9-0596-4672-b199-22cb2329c1ba\",<br>\n                \"meta\": {<br>\n                    \"versionId\": \"1\",<br>\n                    \"lastUpdated\": \"2021-08-18T08:59:07.704421Z\",<br>\n                    \"profile\": [<br>\n                        \"<a href=\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-implantable-device\">http://hl7.org/fhir/us/core/StructureDefinition/us-core-implantable-device</a>\"<br>\n                    ]<br>\n                },<br>\n                \"udiCarrier\": [<br>\n                    {<br>\n                        \"deviceIdentifier\": \"43069338026389\",<br>\n                        \"carrierAIDC\": \"iVBORw0KGgoAAAANSUhEUgAAAioAAAB2CAIAAABpgS9BAAADHUlEQVR42u3aXY+iMBiAUbrZ//+XuxcmpunXvkABNedczahAReWZdkxbIee8bVtK6f3zS3tLaXTv6/b5nttHtuMZHaW8JXJvu8/4GNp72+NGxhN5jvPnHn8tInubn4fIfiKjHZ35+fth1bM49g4/dpaOfWrOnMk7X829449/ciOfzcjrFX/FV73f4sfdexWdv8fOvB9G17T4FW/+WkfOw8ufDQBuJz8AyA8A8gMA8gOA/ACA/AAgPwAgPwDIDwDIDwDyA4D8AID8ACA/ACA/AMgPAMgPAPIDAPIDgPwAID8AID8AyA8AyA8A8gMA8gOA/ACA/AAgPwDIDwDIDwDyAwDyA4D8AID8ACA/ACA/AMgPAPIDAPIDgPwAgPwAID8AID8AyA8AyA8A8gOA/ACA/AAgPwAgPwDIDwDIDwDyAwDyA4D8ACA/ACA/AMgPAMgPAPIDAPIDgPwAgPwAID8AyA8AyA8A8gMA8gOA/ACA/AAgPwAgPwDIDwDyAwDyA4D8AID8ACA/ACA/AMgPAMgPAPIDgPw4BQDIDwDyAwDyA4D8AID8ACA/ACA/AMgPAMgPAPIDgPwAgPwAID8AID8AfJuUc3YWADD7AUB+AOACf50CrpBSqm65dJn3dbgDhyjHeWaEKS1bx141pAefAsgPT7rzWpZzboO3d5yfc/39wCHBchbfYGXDPmdIYPYDW/dv+fev3eWm93pa+bDycjy/4p9cwhoNafRzdZTJM9o1pPYo5eajExI/evdkPrX6h/zAstgEO9FtUtmeqkDdDYP7PJPJ4Bylu/mufXaLMip39Zj40bttO3nqQH54XnvZ6oZk19XtGy+FB8bcVme0k//uPHh0q3zID7/fpPlS1fK518LN29nY1UOqgn1Pm3UI+eEHtbOfdrXnqTnH1dOshV/svrQQVtu4h2++8UB7tqOrPccuu8GtRnOa6l/xB/6TtHxIVzx3MyHMfvid2ET+pp53qNpq/kWv97Jetc/gd+RGaQxuPj/62iHN5y7Bo1cns/yqoZkQd1wivL34xskT8O0svgFg9gOA2Q8AyA8Av+MfJjJq5w+06kcAAAAASUVORK5CYII=\"<br>\n                    }<br>\n                ],<br>\n                \"status\": \"active\",<br>\n                \"distinctIdentifier\": \"43069338026389\",<br>\n                \"manufactureDate\": \"2000-03-02T18:33:18-05:00\",<br>\n                \"expirationDate\": \"2025-03-17T19:33:18-04:00\",<br>\n                \"lotNumber\": \"1134\",<br>\n                \"serialNumber\": \"842026117977\",<br>\n                \"deviceName\": [<br>\n                    {<br>\n                        \"name\": \"Implantable defibrillator, device (physical object)\",<br>\n                        \"type\": \"user-friendly-name\"<br>\n                    }<br>\n                ],<br>\n                \"type\": {<br>\n                    \"coding\": [<br>\n                        {<br>\n                            \"system\": \"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\",<br>\n                            \"code\": \"72506001\",<br>\n                            \"display\": \"Implantable defibrillator, device (physical object)\"<br>\n                        }<br>\n                    ],<br>\n                    \"text\": \"Implantable defibrillator, device (physical object)\"<br>\n                },<br>\n                \"patient\": {<br>\n                    \"reference\": \"Patient/17b57f46378-a6944791-e6ad-4f0f-8e37-683f47f24fa1\"<br>\n                }<br>\n            },<br>\n            \"search\": {<br>\n                \"mode\": \"match\",<br>\n                \"score\": 1<br>\n            }<br>\n        },<br>\n        {<br>\n            \"id\": \"17b5dec7fde-dda0524d-2256-42f0-96d1-9fe252e36d4a\",<br>\n            \"fullUrl\": \"<a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device/17b5dec7fde-dda0524d-2256-42f0-96d1-9fe252e36d4a\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Device/17b5dec7fde-dda0524d-2256-42f0-96d1-9fe252e36d4a</a>\",<br>\n            \"resource\": {<br>\n                \"resourceType\": \"Device\",<br>\n                \"id\": \"17b5dec7fde-dda0524d-2256-42f0-96d1-9fe252e36d4a\",<br>\n                \"meta\": {<br>\n                    \"versionId\": \"1\",<br>\n                    \"lastUpdated\": \"2021-08-19T10:19:45.502943Z\",<br>\n                    \"profile\": [<br>\n                        \"<a href=\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-implantable-device\">http://hl7.org/fhir/us/core/StructureDefinition/us-core-implantable-device</a>\"<br>\n                    ]<br>\n                },<br>\n                \"udiCarrier\": [<br>\n                    {<br>\n                        \"deviceIdentifier\": \"43069338026389\",<br>\n                        \"carrierHRF\": \"(01)43069338026389(11)000302(17)250317(10)1134(21)842026117977\"<br>\n                    }<br>\n                ],<br>\n                \"status\": \"active\",<br>\n                \"distinctIdentifier\": \"43069338026389\",<br>\n                \"manufactureDate\": \"2000-03-02T18:33:18-05:00\",<br>\n                \"expirationDate\": \"2025-03-17T19:33:18-04:00\",<br>\n                \"lotNumber\": \"1134\",<br>\n                \"serialNumber\": \"842026117977\",<br>\n                \"deviceName\": [<br>\n                    {<br>\n                        \"name\": \"Implantable defibrillator, device (physical object)\",<br>\n                        \"type\": \"user-friendly-name\"<br>\n                    }<br>\n                ],<br>\n                \"type\": {<br>\n                    \"coding\": [<br>\n                        {<br>\n                            \"system\": \"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\",<br>\n                            \"code\": \"72506001\",<br>\n                            \"display\": \"Implantable defibrillator, device (physical object)\"<br>\n                        }<br>\n                    ],<br>\n                    \"text\": \"Implantable defibrillator, device (physical object)\"<br>\n                },<br>\n                \"patient\": {<br>\n                    \"reference\": \"Patient/17b5dc09184-54ce1834-2501-4e85-a3fe-e04223da69cf\"<br>\n                }<br>\n            },<br>\n            \"search\": {<br>\n                \"mode\": \"match\",<br>\n                \"score\": 1<br>\n            }<br>\n        }<br>\n    ]<br>\n}    </p>\n<div class=\"codehilite\"><pre><span></span><code>   3 - Organization resource details\nRequest GET https://fhir.secureit.co.in:9443/fhir-server/api/v4/Organization\n</code></pre></div>\n\n<p>Response: Please see attachment</p>\n<div class=\"codehilite\"><pre><span></span><code>   4 -  Practitioner resource details\nRequest GET https://fhir.secureit.co.in:9443/fhir-server/api/v4/Practitioner\n</code></pre></div>\n\n<p>Response: Please see attachment <a href=\"/user_uploads/10155/vTtoI4cjpc17ituHzkVLonDN/Responses.txt\">Responses.txt</a></p>",
        "id": 254530348,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1632401979
    },
    {
        "content": "<p>Hi Mahesh, refer to the following snippet, for the Group Export without resource types we default to the list of resources in the Patient Compartment.  If you list device, organization, et cetra on the included resources it'll export it. </p>\n<p>if (!ExportType.INVALID.equals(exportType)) {<br>\n            if (ExportType.PATIENT.equals(exportType) || ExportType.GROUP.equals(exportType)) {<br>\n                if (types != null &amp;&amp; !types.isEmpty()) {<br>\n                    export.checkExportPatientResourceTypes(types);<br>\n                } else {<br>\n                    types = export.addDefaultsForPatientCompartment();<br>\n                }<br>\n            } else if ((ExportType.SYSTEM.equals(exportType) )<br>\n                            &amp;&amp; (types == null || types.isEmpty())) {<br>\n                types = export.defaultResourceTypes();<br>\n            }</p>",
        "id": 254539557,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1632405639
    },
    {
        "content": "<p>Currently our Patient and Group export implementation will only export resources in the Patient compartment.<br>\nWe do support \"customizable compartment definitions\" but there's currently no support for \"chained\" inclusion criteria there.  See <a href=\"https://github.com/IBM/FHIR/issues/2371\">https://github.com/IBM/FHIR/issues/2371</a> for more info.<br>\nFeel free to add a comment there or open a separate issue with what you you'd like to see.</p>",
        "id": 254539571,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1632405648
    },
    {
        "content": "<p>by default, we limit to the patient compartment</p>",
        "id": 254539576,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1632405650
    },
    {
        "content": "<p>paul just beat me... :-)</p>",
        "id": 254539579,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1632405653
    },
    {
        "content": "<p>I had to check the code :)</p>",
        "id": 254539600,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1632405664
    },
    {
        "content": "<p>So my thinking on this is that we could support these other resource types by implementing 2371 and then our users could customize what is considered \"in the Patient compartment\" per their own wants/needs and we wouldn't need to update our export logic</p>",
        "id": 254539813,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1632405749
    },
    {
        "content": "<p>however, that is pretty low on our priority list right now (and easier said than done)</p>",
        "id": 254539861,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1632405770
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191676\">Lee Surprenant</span> <a href=\"#narrow/stream/212434-ibm/topic/Bulk.20Export/near/254539571\">said</a>:</p>\n<blockquote>\n<p>Currently our Patient and Group export implementation will only export resources in the Patient compartment.<br>\nWe do support \"customizable compartment definitions\" but there's currently no support for \"chained\" inclusion criteria there.  See <a href=\"https://github.com/IBM/FHIR/issues/2371\">https://github.com/IBM/FHIR/issues/2371</a> for more info.<br>\nFeel free to add a comment there or open a separate issue with what you you'd like to see.</p>\n</blockquote>\n<p>Hi Lee</p>\n<p>We are trying different option for bulk export. We tried Amazon S3 and it worked fine but the issue is that inferno (ONC testing tool) expects security token in bulk export URL. So this option maynot work. We are trying workaround and have two questions</p>\n<ol>\n<li>If we want to configure HTTPS export  instead of file or S3 , what will be bulk export section configuration. Do you have any sample config file to demonstrate that?</li>\n<li>In Liberty (FHIR Server) can we expose any folder to public so that it can be accessed over HTTP. Basically we want to expose one folder under FHIR Server itself over HTTPS (so that security can be taken care of)</li>\n</ol>\n<p>Mahesh</p>",
        "id": 255531121,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1632987753
    },
    {
        "content": "<blockquote>\n<p>If we want to configure HTTPS export instead of file or S3 , what will be bulk export section configuration. Do you have any sample config file to demonstrate that?</p>\n</blockquote>\n<p>The \"https\" provider only supports import at the moment.<br>\nHowever, note that the generated s3 download urls ARE HTTPS.  </p>\n<blockquote>\n<p>inferno (ONC testing tool) expects security token in bulk export URL</p>\n</blockquote>\n<p>The S3 feature uses <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html\">https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html</a> to create a URL that has the \"access token\" embedded in the url in the form of Credentials + Signature. Basically the fhir server has read access to the private bucket/object and then temporarilly extends that access to the end user in the form of a (signed) download url with a controllable expiry.</p>\n<p>What is it that inferno doesn't think is valid about this?!  If you can be clear about it, I can help you push back on this.</p>",
        "id": 255549895,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1632997572
    },
    {
        "content": "<p>Hi Lee</p>\n<p>BDE-09: Bulk Data Server SHALL restrict bulk data file access with access token</p>\n<p>Scenario 1 - When token is provided, we get response after validating the token<br>\nRequest:<br>\nGET   200   <a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/$bulkdata-status?job=O5sfGj3l4ZFOO_G0TdwHvQ\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/$bulkdata-status?job=O5sfGj3l4ZFOO_G0TdwHvQ</a></p>\n<p>OAuth Token Provided: YES</p>\n<p>Response:<br>\n{<br>\n  \"transactionTime\": \"2021-10-08T06:58:34.668Z\",<br>\n  \"request\": \"<a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17c5ea3c53d-9ae67467-60d2-4f1d-85f6-6808d680589e/$export\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17c5ea3c53d-9ae67467-60d2-4f1d-85f6-6808d680589e/$export</a>\",<br>\n  \"requiresAccessToken\": true,<br>\n  \"output\": [<br>\n    {<br>\n      \"type\": \"AllergyIntolerance\",<br>\n      \"url\": \"<a href=\"https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/AllergyIntolerance_1.ndjson\">https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/AllergyIntolerance_1.ndjson</a>\",<br>\n      \"count\": 1<br>\n    },<br>\n    {<br>\n      \"type\": \"Group\",<br>\n      \"url\": \"<a href=\"https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/Group_1.ndjson\">https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/Group_1.ndjson</a>\",<br>\n      \"count\": 1<br>\n    },<br>\n    {<br>\n      \"type\": \"Patient\",<br>\n      \"url\": \"<a href=\"https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/Patient_1.ndjson\">https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/Patient_1.ndjson</a>\",<br>\n      \"count\": 1<br>\n    }<br>\n  ],<br>\n  \"error\": []<br>\n}</p>\n<p>Scenario 2 - From the above response, Inferno then picks up individual URLs and does a GET as shown below. In one such scenario, it sends no token<br>\nand it expects 400 or 401, whereas it receives a 200.</p>\n<p>Since we are using AWS bucket, it gives us a direct URL and there is no way it will validate the OAuth token.</p>\n<p>Before using AWS, we tried using file as storage provider, but it provided partial path (\"url\" : \"iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/AllergyIntolerance_1.ndjson\")<br>\nand not the complete URL. If it could provide a complete HTTP/HTTPS path, then this may solve the problem.</p>\n<p>Could you please help us with this? <br>\nAlso, is there a way where S3 URL could be routed through our oAUTH server?</p>\n<p>Request:<br>\nGET   200   <a href=\"https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/AllergyIntolerance_1.ndjson\">https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/AllergyIntolerance_1.ndjson</a></p>\n<p>OAuth Token Provided: NO</p>\n<p>Response:<br>\n{<br>\n  \"resourceType\": \"AllergyIntolerance\",<br>\n  \"id\": \"17c5ea10448-672d34c4-5131-4d90-a488-fae9151fb8f8\",<br>\n  \"meta\": {<br>\n    \"versionId\": \"1\",<br>\n    \"lastUpdated\": \"2021-10-08T06:39:43.178Z\",<br>\n    \"profile\": [<br>\n      \"<a href=\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-allergyintolerance\">http://hl7.org/fhir/us/core/StructureDefinition/us-core-allergyintolerance</a>\"<br>\n    ]<br>\n  },<br>\n  \"clinicalStatus\": {<br>\n    \"coding\": [<br>\n      {<br>\n        \"system\": \"<a href=\"http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical\">http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical</a>\",<br>\n        \"code\": \"inactive\"<br>\n      }<br>\n    ]<br>\n  },<br>\n  \"code\": {<br>\n    \"coding\": [<br>\n      {<br>\n        \"system\": \"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\",<br>\n        \"code\": \"300916003\",<br>\n        \"display\": \"Latex allergy\"<br>\n      }<br>\n    ],<br>\n    \"text\": \"Latex allergy\"<br>\n  },<br>\n  \"patient\": {<br>\n    \"reference\": \"Patient/17c5e5cabb3-19b86ee6-35be-4157-b4a0-fb9b6ad28341\"<br>\n  }<br>\n}</p>",
        "id": 256699140,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1633677797
    },
    {
        "content": "<p>Based on the above description and requirement from Inferno, below could be 2 options that could be possible solutions:</p>\n<p>1 - Before using AWS bucket, we tried using file as storage provider, but it provided partial path (\"URL\" : \"iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/AllergyIntolerance_1.ndjson\")<br>\nand not the complete URL. If it could provide a complete HTTP/HTTPS path, then this may solve the problem.</p>\n<p>2 - When using AWS bucket we get a complete URL (\"URL\": \"<a href=\"https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/Patient_1.ndjson\">https://1secureit.s3.amazonaws.com/fhir/1secureit/iLUQQ4xsv0xbYoQ-auymO567ndIPa5EsRjR40AtZEz8/Patient_1.ndjson</a>\"). From here on Inferno uses this URL to fetch data.<br>\n      Instead of this S3 URL, the IBM FHIR server could introduce a proxy URL, and internally it could use this S3 URL to fetch data. Doing this the OAuth server will be used and the token will be validated before fetching the fhir data from AWS S3. <br>\n      This behavior can be kept configurable in fhirserverconfig.</p>\n<div class=\"codehilite\"><pre><span></span><code>Please let us know your thought\n</code></pre></div>",
        "id": 257043844,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1633948323
    },
    {
        "content": "<p>We purposefully keep the FHIR server out of the path for downloading these large files as, currently, those will compete with resources with the threads serving the REST API.<br>\nAt some point, I'll have a look at the inferno tests, but my first question there is \"why does it require token-based auth when the spec allows for either/or?\"</p>\n<p>I'm not totally opposed to providing an option to proxy the export files, but I do think its better to keep that out of the liberty-based FHIR server app.  Maybe introduce a separate component with the same auth strategy?<br>\nI'd definitely encourage you to design/develop something that works for your use case and then share those learnings.</p>",
        "id": 257055193,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1633954500
    },
    {
        "content": "<p>I did like where you were going with this earlier line of thought:</p>\n<blockquote>\n<p>is there a way where S3 URL could be routed through our oAUTH server?</p>\n</blockquote>\n<p>S3 (and IBM Object Storage) provide a lot of options for securing the exported files.  You can find an overview of those at <a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/secure-s3-resources/\">https://aws.amazon.com/premiumsupport/knowledge-center/secure-s3-resources/</a>.<br>\nWe chose to make presigned URLs against private objects our default, but its definitely possible to disable the presigning from your fhir-server-config and use IAM access policies (which will reject unauthenticated/unauthorized access) instead.</p>",
        "id": 257056542,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1633955183
    },
    {
        "content": "<p>The challenge there will be that the next version of the bulk export spec will indicate that, when requiresAccessToken==true, the security model for the exported files should be the same as the one for requesting the export (using SMART Backend Services): <br>\n<a href=\"#narrow/stream/179250-bulk-data/topic/Attachments.20and.20.22additional.20authentication.20credentials.22/near/246161556\">https://chat.fhir.org/#narrow/stream/179250-bulk-data/topic/Attachments.20and.20.22additional.20authentication.20credentials.22/near/246161556</a></p>",
        "id": 257056892,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1633955402
    },
    {
        "content": "<p>So, it probably depends what you're trying to do (just pass some inferno tests or position yourself for future compliance)</p>",
        "id": 257057105,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1633955500
    },
    {
        "content": "<p>One of the solutions we discussed was around using FILE as a storage provider. Below is an example response after the bulk export is completed:<br>\n{<br>\n\"transactionTime\": \"2021-09-21T10:53:53.879Z\",<br>\n\"request\": \"<a href=\"https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17b5e38b010-74858f83-7570-45cb-979b-8d00b694a293/$export\">https://fhir.secureit.co.in:9443/fhir-server/api/v4/Group/17b5e38b010-74858f83-7570-45cb-979b-8d00b694a293/$export</a>\",<br>\n\"requiresAccessToken\": true,<br>\n\"output\": [{<br>\n\"type\": \"Provenance\",<br>\n\"url\": \"KTwhDhHknT5k7lLtqB8eUQM2e0LuvIgX7NQSLqbH5_A/Provenance_1.ndjson\",<br>\n\"count\": 1<br>\n}],<br>\n\"error\": []<br>\n}</p>\n<p>If you see the URL here is the reference URL and not complete. The exported files are located under fhirserver on liberty. If you could provide a complete HTTP/HTTPS URL instead of a reference URL, then this URL will inherit the authentication system configured for the FHIR server which means if the SMART is enabled it will validate the supplied token and proceed accordingly. </p>\n<p>If you think this could be a probable solution then this could involve fewer changes. The default behavior could be as is, and having a complete URL in the response could be based on a configuration in fhirserverconfig. Again you are the correct person to judge on how much effort and changes would be involved. This URL can be exposed by doing some configuration in Liberty by publishing the folder. I donot know much about how to expose one additional folder in FHIR where these files will reside.</p>\n<p>If we are able to achieve this then we may not need to disturb the current behavior in the S3 storage provider.</p>\n<p>As you mentioned, \"when requiresAccessToken==true, the security model for the exported files should be the same as the one for requesting the export (using SMART Backend Services)\". Could this be one of the approaches to get there?</p>\n<p>Please let us know your thoughts.</p>",
        "id": 257160668,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1634023751
    },
    {
        "content": "<p>Hi</p>\n<p>Have you got a chance to review suggestion above? Any ideas you can suggest whether this will work or not? Will appreciate your help.</p>\n<p>Thanks<br>\nMahesh</p>",
        "id": 257809942,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1634368778
    },
    {
        "content": "<p>Please open an enhancement for appending a URL to the FILE Export</p>",
        "id": 258075667,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1634581366
    },
    {
        "content": "<p>We'll look at implementing it as a configuration option</p>",
        "id": 258075702,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1634581378
    },
    {
        "content": "<p>we managed to use S3 and satisfy what is needed by Inferno. </p>\n<p>Inferno has one test case related to Bulk Export with respect to a definition in metadata as mentioned below.</p>\n<p>BDE-02: Bulk Data Server declares support for 'group-export' operation in CapabilityStatement (<a href=\"http://hl7.org/fhir/uv/bulkdata/OperationDefinition-group-export.html\">http://hl7.org/fhir/uv/bulkdata/OperationDefinition-group-export.html</a>)</p>\n<p>Below is a snapshot of IBM FHIR metadata with respect to type:group<br>\n{<br>\n\"type\": \"Group\",<br>\n\"profile\": \"<a href=\"http://hl7.org/fhir/profiles/Group\">http://hl7.org/fhir/profiles/Group</a>\",<br>\n\"operation\": [{<br>\n\"name\": \"export\",<br>\n\"definition\": \"<a href=\"http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export|1.0.1\">http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export|1.0.1</a>\"<br>\n}]<br>\n}</p>\n<p>Here, the operation name should be \"group-export\". </p>\n<p>Below is a snapshot of the metadata from the FHIR server that Inferno uses:<br>\n{<br>\n  \"type\": \"Group\",<br>\n  \"operation\": [<br>\n{<br>\n \"extension\": [<br>\n{<br>\n \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/capabilitystatement-expectation\">http://hl7.org/fhir/StructureDefinition/capabilitystatement-expectation</a>\",<br>\n \"valueCode\": \"SHOULD\"<br>\n}<br>\n ],<br>\n \"name\": \"group-export\",<br>\n \"definition\": \"<a href=\"http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export\">http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export</a>\"<br>\n}<br>\n  ]<br>\n}</p>\n<p>Please let us know your thoughts.</p>",
        "id": 260089694,
        "sender_full_name": "Mahesh Dabi",
        "timestamp": 1635914954
    },
    {
        "content": "<p>HI Mahesh, you should configure a persistence data store.  You are using the in memory datastore</p>",
        "id": 260133288,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1635945995
    },
    {
        "content": "<p><a href=\"https://github.com/IBM/FHIR/blob/main/fhir-server/liberty-config/configDropins/disabled/postgres/bulkdata.xml\">https://github.com/IBM/FHIR/blob/main/fhir-server/liberty-config/configDropins/disabled/postgres/bulkdata.xml</a></p>",
        "id": 260133358,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1635946030
    },
    {
        "content": "<p>Here is an example.  Line 43 has the datasource for the bulkdata Server</p>",
        "id": 260133394,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1635946053
    },
    {
        "content": "<p>note you also need to support max_prepared_transactions on postgres</p>",
        "id": 260133421,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1635946064
    },
    {
        "content": "<p>BulkData uses JBatch which is an XA transaction across two datasources.</p>",
        "id": 260133455,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1635946080
    },
    {
        "content": "<p>I think Paul's answer was intended for the <code>Delete Job</code> topic.<br>\n<span class=\"user-mention\" data-user-id=\"192632\">@Paul Bastide</span> any thoughts on the operation name we're including in our CapabilityStatement?  I think I agree with Mahesh that this should say <code>export</code> and not <code>group-export</code>...</p>",
        "id": 260140096,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1635949123
    },
    {
        "content": "<p>Yes. that's right on my answer. <br>\nI think that change is OK, I think we hand crafted these quite a while ago</p>",
        "id": 260140738,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1635949419
    },
    {
        "content": "<p>Hello Lee, IBM FHIR gives \"name\": \"export\" in metadata but it should be \"name\": \"group-export\"</p>",
        "id": 260140790,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1635949442
    },
    {
        "content": "<p>oh, on that i disagree</p>",
        "id": 260140873,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1635949464
    },
    {
        "content": "<p>the name in the CapabilityStatement should match that which it is invoked on</p>",
        "id": 260140933,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1635949492
    },
    {
        "content": "<p>i think <code>export</code> is right</p>",
        "id": 260140952,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1635949501
    },
    {
        "content": "<p>if thats what we have now, then i don't think we need a change</p>",
        "id": 260141007,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1635949516
    },
    {
        "content": "<p>I've raised this at <a href=\"#narrow/stream/179166-implementers/topic/CapStmnt.2Econformance.2Erest.2Eoperation.2Ename.20v.20OpDef.2Ecode\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/CapStmnt.2Econformance.2Erest.2Eoperation.2Ename.20v.20OpDef.2Ecode</a> as I think its a bug in the bulkdata spec...I thought we'd already reported this by maybe not</p>",
        "id": 260144411,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1635950958
    },
    {
        "content": "<p>Lee, Sorry I do not see anything in that chat link that you sent.</p>",
        "id": 260147344,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1635952059
    },
    {
        "content": "<p>sorry, i fixed the title of it and that breaks the link in zulip :-(<br>\ntry this:  <a href=\"#narrow/stream/179166-implementers/topic/CapStmnt.2Erest.2Eoperation.2Ename.20v.20OpDef.2Ecode\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/CapStmnt.2Erest.2Eoperation.2Ename.20v.20OpDef.2Ecode</a></p>",
        "id": 260149068,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1635952669
    },
    {
        "content": "<p>The 'definition' here (IBM FHIR metadata) in the example below (<a href=\"http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export|1.0.1\">http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export|1.0.1</a>)  contains URL and version, whereas there is another field 'version' that can contain the version <a href=\"https://www.hl7.org/fhir/operationdefinition.html\">https://www.hl7.org/fhir/operationdefinition.html</a> . We can have the version value in its own field instead.</p>\n<p>IBM FHIR metadata<br>\n{<br>\n\"type\": \"Group\",<br>\n\"profile\": \"<a href=\"http://hl7.org/fhir/profiles/Group\">http://hl7.org/fhir/profiles/Group</a>\",<br>\n\"operation\": [{<br>\n\"name\": \"export\",<br>\n\"definition\": \"<a href=\"http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export|1.0.1\">http://hl7.org/fhir/uv/bulkdata/OperationDefinition/group-export|1.0.1</a>\"<br>\n}]<br>\n}</p>\n<p>Please let us know your thoughts.</p>",
        "id": 260365920,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1636087652
    },
    {
        "content": "<p>URL + \"|\" + version is correct.</p>",
        "id": 260392869,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1636111250
    },
    {
        "content": "<p>Hello <span class=\"user-mention\" data-user-id=\"191676\">@Lee Surprenant</span> <br>\nI hope you are doing well. <br>\nThis is regarding bulk export. When we do a bulk export all resources like patient, immunization, allergies etc are exported, except the below ones:</p>\n<div class=\"codehilite\"><pre><span></span><code>  Device \n  Organization \n  Practitioner\n</code></pre></div>\n\n<p>Could you please tell us how to export above resources also?</p>\n<p>Thank you,<br>\nSagar</p>",
        "id": 269095747,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1643026066
    },
    {
        "content": "<p>HI Sagar, can you grab the joblogs for that particular job? And the messages.log?  If you can share (after checking for any sensitive data), that would help greatly.  If Device, Organization, Practitioner are not included, it seems very strange</p>",
        "id": 269131706,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1643041955
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"392120\">@Sagar Sarvankar</span> which $export operation are you invoking?  If its <code>Patient/$export</code> I think our implementation of that one will only export resources that are in a \"patient compartment\" as defined at <a href=\"https://www.hl7.org/fhir/compartmentdefinition-patient.html\">https://www.hl7.org/fhir/compartmentdefinition-patient.html</a></p>",
        "id": 269133173,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643042545
    },
    {
        "content": "<p>the spec is pretty loose in this regard...it says this:</p>\n<blockquote>\n<p>For Patient- and Group-level requests requests, the Patient Compartment SHOULD be used as a point of reference for recommended resources to be returned. However, other resources outside of the patient compartment that are helpful in interpreting the patient data (such as Organization and Practitioner) may also be returned.</p>\n</blockquote>",
        "id": 269133465,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643042644
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191676\">@Lee Surprenant</span>  We are using Group export  <a href=\"https://fhirserver.justtest.in:9443/fhir-server/api/v4/Group/17e8b79a2cf-20d0f360-e1e9-407a-9340-d3843a152897/$export\">https://fhirserver.justtest.in:9443/fhir-server/api/v4/Group/17e8b79a2cf-20d0f360-e1e9-407a-9340-d3843a152897/$export</a></p>\n<p>Could you please help us configure compartment to retrieve Device, Organization and Practitioner on IBM FHIR?</p>",
        "id": 269136373,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1643043757
    },
    {
        "content": "<p>Hi Sagar, there is a limitation on the CompartmentDefinition which is static in this case.</p>",
        "id": 269143805,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1643046977
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>public void checkExportPatientResourceTypes(List&lt;String&gt; resourceTypes) throws FHIROperationException {\n        boolean valid = false;\n        try {\n            // Also Check to see if the Export is valid for the Compartment.\n            List&lt;String&gt; allCompartmentResourceTypes = CompartmentUtil.getCompartmentResourceTypes(&quot;Patient&quot;);\n            Set&lt;String&gt; supportedResourceTypes = getSupportedResourceTypes();\n            List&lt;String&gt; tmp = resourceTypes.stream()\n                                        .filter(item -&gt; allCompartmentResourceTypes.contains(item) &amp;&amp; supportedResourceTypes.contains(item))\n                                        .collect(Collectors.toList());\n            valid = tmp != null &amp;&amp; !tmp.isEmpty();\n        } catch (Exception e) {\n            // No Operation intentionally\n        }\n        if (!valid) {\n            throw buildOperationException(&quot;Resource Type outside of the Patient Compartment in Export&quot;, IssueType.INVALID);\n        }\n    }\n</code></pre></div>",
        "id": 269143835,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1643046990
    },
    {
        "content": "<p>it's checking the GroupExportOperation is only including valid resources. Since the resources are outside the Compartment, they are filtered/invalid.</p>",
        "id": 269143880,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1643047016
    },
    {
        "content": "<p>Ok, but is there a way in some configuration in IBM FHIR to include the missing resources in the bulk export operation?<br>\nThere is one case in Inferno where it expects export of Device, Organization and Practitioner in Bulk Export Scenario. <br>\nThis is the last step in the Inferno tool, and on passing this test case, we will be through with all the test scenarios in the Inferno tool.</p>",
        "id": 269258828,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1643118620
    },
    {
        "content": "<p>thats a funny test given how loose the spec is in this regard</p>",
        "id": 269258932,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118682
    },
    {
        "content": "<p>we don't support it today</p>",
        "id": 269259040,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118724
    },
    {
        "content": "<p>nor does the spec require it in my opinion</p>",
        "id": 269259056,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118731
    },
    {
        "content": "<p>however, it may be useful in real life, so I'd suggest opening an enhancement request for it</p>",
        "id": 269259098,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118755
    },
    {
        "content": "<p>of note, we recently did something similar for the <code>$everything</code> operation:  <a href=\"https://github.com/IBM/FHIR/issues/2337\">https://github.com/IBM/FHIR/issues/2337</a></p>",
        "id": 269259158,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118791
    },
    {
        "content": "<p>so i think it would be very similar to that</p>",
        "id": 269259181,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118806
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191676\">@Lee Surprenant</span> , may be I do not understand it completely, but Device, Organization and Practitioner should be part of bulk export data like other resources?</p>",
        "id": 269259297,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1643118853
    },
    {
        "content": "<p>why?</p>",
        "id": 269259386,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118902
    },
    {
        "content": "<p>did you see this above, pulled right from the spec?</p>\n<p><span class=\"user-mention silent\" data-user-id=\"191676\">Lee Surprenant</span> <a href=\"#narrow/stream/212434-ibm/topic/Bulk.20Export/near/269133465\">said</a>:</p>\n<blockquote>\n<p>the spec is pretty loose in this regard...it says this:</p>\n<blockquote>\n<p>For Patient- and Group-level requests requests, the Patient Compartment SHOULD be used as a point of reference for recommended resources to be returned. However, other resources outside of the patient compartment that are helpful in interpreting the patient data (such as Organization and Practitioner) may also be returned.</p>\n</blockquote>\n</blockquote>",
        "id": 269259424,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118931
    },
    {
        "content": "<p>it says they \"may\" be returned</p>",
        "id": 269259468,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118950
    },
    {
        "content": "<p>our impl does not return them at the moment</p>",
        "id": 269259538,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643118968
    },
    {
        "content": "<p>Yes, thank you <span class=\"user-mention\" data-user-id=\"191676\">@Lee Surprenant</span> </p>\n<p>So, since this is required in our case, is there a way to include this as part of the Bulk Data Export? Like including this in custom compartment or some other way?</p>\n<p>I also checked in <a href=\"https://github.com/IBM/FHIR/issues/2337\">https://github.com/IBM/FHIR/issues/2337</a> , there is development happening around $everything. Will that be helpful here?</p>\n<p>Please help.</p>\n<p>Regards,<br>\nSagar</p>",
        "id": 269269701,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1643123276
    },
    {
        "content": "<blockquote>\n<p>Will that be helpful here?</p>\n</blockquote>\n<p>Just as an example of how to implement it (and potentially a source for some shared utilities).   That why above I said \"I'd suggest opening an enhancement request for it\"</p>",
        "id": 269293408,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1643132236
    },
    {
        "content": "<p>Hello <span class=\"user-mention\" data-user-id=\"191676\">@Lee Surprenant</span> , <span class=\"user-mention\" data-user-id=\"192632\">@Paul Bastide</span> </p>\n<p>The enhancement request for this requirement is created at <a href=\"https://github.com/IBM/FHIR/issues/3247\">https://github.com/IBM/FHIR/issues/3247</a> <br>\nI hope this request will considered in the next release.</p>\n<p>Thank you for your support.</p>\n<p>Regards,<br>\nSagar</p>",
        "id": 269360930,
        "sender_full_name": "Sagar Sarvankar",
        "timestamp": 1643170597
    }
]