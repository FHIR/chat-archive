[
    {
        "content": "<p>We just merged <a href=\"https://github.com/IBM/FHIR/pull/337\" target=\"_blank\" title=\"https://github.com/IBM/FHIR/pull/337\">https://github.com/IBM/FHIR/pull/337</a> which adds a lot more jobs to our CI build. now it builds with:</p>\n<ol>\n<li>java 8 and java 11 from the default \"Zulu\" build of openjdk</li>\n<li>java 8 and java 11 from a recent nightly build of AdoptOpenJDK</li>\n</ol>",
        "id": 179445981,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450460
    },
    {
        "content": "<p>strangly we were hitting different issues on the two different builds of OpenJDK</p>",
        "id": 179446075,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450489
    },
    {
        "content": "<p>specifically, the Zulu JDK still has an issue when doing mutual auth</p>",
        "id": 179446114,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450515
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192632\">@Paul Bastide</span> worked around that issue by changing our fhir-server-test client to use basic auth by default (previously it was using client cert)</p>",
        "id": 179446169,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450546
    },
    {
        "content": "<p>before I close <a href=\"https://github.com/IBM/FHIR/issues/334\" target=\"_blank\" title=\"https://github.com/IBM/FHIR/issues/334\">https://github.com/IBM/FHIR/issues/334</a> I wanted to hear from the team about whether we want to keep all these jobs, or just throw out the zulu ones</p>",
        "id": 179446427,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450668
    },
    {
        "content": "<p>also i wanted to guage interest in using <a href=\"https://github.com/marketplace/actions/setup-java-environment-based-on-adoptopenjdk\" target=\"_blank\" title=\"https://github.com/marketplace/actions/setup-java-environment-based-on-adoptopenjdk\">https://github.com/marketplace/actions/setup-java-environment-based-on-adoptopenjdk</a> ...this would let us define a single job and use a \"test matrix\" to have it run with both openjdk 8 and 11</p>",
        "id": 179446638,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450768
    },
    {
        "content": "<p>it also has the advantage of keeping us more up-to-date with openjdk nightlies</p>",
        "id": 179446672,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450784
    },
    {
        "content": "<p>without it, we have a <code>wget</code> of some recent snapshot build, and we'd need to remember to refresh that from time-to-time</p>",
        "id": 179446702,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450807
    },
    {
        "content": "<p>assuming it works, i think the only downside of using this action is the dependency on someones personal github action project</p>",
        "id": 179446775,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450843
    },
    {
        "content": "<blockquote>\n<p>before I close <a href=\"https://github.com/IBM/FHIR/issues/334\" target=\"_blank\" title=\"https://github.com/IBM/FHIR/issues/334\">https://github.com/IBM/FHIR/issues/334</a> I wanted to hear from the team about whether we want to keep all these jobs, or just throw out the zulu ones</p>\n</blockquote>\n<p>I think we should do a final regression on release.  the test-matrix is a similar approach that's on travis to 'switch_java' <br>\nI don't think we should run it every time</p>",
        "id": 179446958,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572450956
    },
    {
        "content": "<p>FWIW my preference is to:</p>\n<ol>\n<li>throw out the zulu jobs; and</li>\n<li>use this guy's github action for the adoptopenjdk jobs</li>\n</ol>",
        "id": 179447029,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572450981
    },
    {
        "content": "<p>works for me.</p>",
        "id": 179447045,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572450994
    },
    {
        "content": "<p>Same</p>",
        "id": 179447057,
        "sender_full_name": "John Timm",
        "timestamp": 1572451003
    },
    {
        "content": "<p>I think there is some benefit to running java 8 and java 11 each time (and currently no cost to do this)</p>",
        "id": 179447184,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572451081
    },
    {
        "content": "<p>it helps catch any potential issues earlier in the process</p>",
        "id": 179447262,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572451103
    },
    {
        "content": "<p>and prevents us from merging stuff that might break one or the other</p>",
        "id": 179447311,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572451131
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192632\">@Paul Bastide</span> <a href=\"https://github.com/IBM/FHIR/pull/340\" target=\"_blank\" title=\"https://github.com/IBM/FHIR/pull/340\">https://github.com/IBM/FHIR/pull/340</a> when you get a chance</p>",
        "id": 179451609,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572453718
    },
    {
        "content": "<p>please add --no-transfer-progress</p>",
        "id": 179453783,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572455097
    },
    {
        "content": "<p>it'll cut down on the mvn logs</p>",
        "id": 179453795,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572455104
    },
    {
        "content": "<p>or -ntp</p>",
        "id": 179453820,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572455119
    },
    {
        "content": "<p>trying to raise a proposed edit</p>",
        "id": 179453868,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572455155
    },
    {
        "content": "<p>only suggestions... not requires, as such marked LGTM</p>",
        "id": 179454339,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572455467
    },
    {
        "content": "<p>thx paul, i took the suggestion</p>",
        "id": 179460386,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459117
    },
    {
        "content": "<p>will merge after build succeeds</p>",
        "id": 179460431,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459124
    },
    {
        "content": "<p>One related topic/question:  I went back to java 8 locally and my build is now failing locally</p>",
        "id": 179460459,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459159
    },
    {
        "content": "<p>after thinking it through, i think its because fhir-examples had been build with java 11</p>",
        "id": 179460471,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459174
    },
    {
        "content": "<p>and we use the 1 class from that for our tests</p>",
        "id": 179460506,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459191
    },
    {
        "content": "<p>net:  i'm pretty sure a class compiled for target: 11 CANNOT be run in a lower JVM</p>",
        "id": 179460545,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459231
    },
    {
        "content": "<p>it makes me think we should change it so that the target is always 1.8</p>",
        "id": 179460605,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459249
    },
    {
        "content": "<p>even when compiling with 11</p>",
        "id": 179460612,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459258
    },
    {
        "content": "<p>thoughts?</p>",
        "id": 179460615,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459262
    },
    {
        "content": "<p>is there any benefit to having the compile target be 11?</p>",
        "id": 179460652,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459295
    },
    {
        "content": "<p><a href=\"https://stackoverflow.com/a/56064482/161022\" target=\"_blank\" title=\"https://stackoverflow.com/a/56064482/161022\">https://stackoverflow.com/a/56064482/161022</a></p>",
        "id": 179461386,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572459737
    },
    {
        "content": "<blockquote>\n<p>One related topic/question:  I went back to java 8 locally and my build is now failing locally</p>\n</blockquote>\n<p>no way... this is a good to know</p>",
        "id": 179463882,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572461081
    },
    {
        "content": "<p>let me look at comptability</p>",
        "id": 179463892,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572461086
    },
    {
        "content": "<p>I think you were right with the sourceTarget testTarget 1.8</p>",
        "id": 179463966,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572461136
    },
    {
        "content": "<p>that was a great test</p>",
        "id": 179463978,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572461150
    },
    {
        "content": "<p>based on this i've updated my PR to remove the java11 profile.  folks can still pass <code>-Djava.version=11</code> if they really wanna compile for java 11...but again i'm not sure what the benefit is</p>",
        "id": 179464087,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572461193
    },
    {
        "content": "<p>grrr, now a test failure!</p>\n<div class=\"codehilite\"><pre><span></span>[ERROR] processExamples(com.ibm.fhir.server.test.R4ExampleServerTest)  Time elapsed: 107.564 s  &lt;&lt;&lt; FAILURE!\njavax.ws.rs.client.ResponseProcessingException: Problem with reading the data, class com.ibm.fhir.model.resource.ExplanationOfBenefit, ContentType: application/fhir+json.\n    at com.ibm.fhir.server.test.R4ExampleServerTest.processExamples(R4ExampleServerTest.java:34)\nCaused by: javax.ws.rs.WebApplicationException: HTTP 400 Bad Request\n    at com.ibm.fhir.server.test.R4ExampleServerTest.processExamples(R4ExampleServerTest.java:34)\n</pre></div>",
        "id": 179465502,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572462006
    },
    {
        "content": "<p>found the stack traces above:</p>\n<div class=\"codehilite\"><pre><span></span>Caused by: java.io.InterruptedIOException: Input operation aborted\n    at org.apache.cxf.transport.http.asyncclient.SharedInputBuffer.waitForData(SharedInputBuffer.java:183)\n    at org.apache.cxf.transport.http.asyncclient.SharedInputBuffer.read(SharedInputBuffer.java:262)\n    at org.apache.cxf.transport.http.asyncclient.AsyncHTTPConduit$AsyncWrappedOutputStream$6.read(AsyncHTTPConduit.java:690)\n    at java.io.FilterInputStream.read(FilterInputStream.java:133)\n    at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)\n    at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)\n    at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)\n    at java.io.InputStreamReader.read(InputStreamReader.java:184)\n    at org.glassfish.json.JsonTokenizer.fillBuf(JsonTokenizer.java:495)\n    at org.glassfish.json.JsonTokenizer.read(JsonTokenizer.java:456)\n    ... 68 more\n</pre></div>",
        "id": 179465523,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572462016
    },
    {
        "content": "<p>cant seem how my change would break that</p>",
        "id": 179465538,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572462024
    },
    {
        "content": "<p>clicking re-run check</p>",
        "id": 179465544,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572462028
    },
    {
        "content": "<p>That exception stack trace looks awfully familiar...</p>",
        "id": 179466988,
        "sender_full_name": "John Timm",
        "timestamp": 1572462884
    },
    {
        "content": "<p>similar to, but different io exceptions from the ones we were seeing on that other issue i think</p>",
        "id": 179467081,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572462952
    },
    {
        "content": "<p>all tests passed this time.  i'm gonna merge this one.</p>",
        "id": 179470679,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572465403
    },
    {
        "content": "<p>and work on a change to hopefully get better exception if we hit similar i/o issue again</p>",
        "id": 179470709,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1572465428
    },
    {
        "content": "<p>strange</p>",
        "id": 179473236,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1572467112
    }
]