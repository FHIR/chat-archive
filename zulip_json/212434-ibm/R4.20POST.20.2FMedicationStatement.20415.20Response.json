[
    {
        "content": "<p>Transitioning from DSTU2 to R4 and I'm getting a 415 response w/out a response body to the following pseudo request :</p>\n<div class=\"codehilite\"><pre><span></span>curl -X POST .../api/v4/MedicationStatement \\\n  -H &#39;Accept: */*&#39; \\\n  -H &#39;Content-Type: application/json+fhir&#39; \\\n  -d &#39;&lt;MedicationStatement JSON&gt;&#39;\n</pre></div>\n\n\n<p>This worked w/ DSTU2, but not R4. What content type should I be using in R4?<br>\nThanks in advance</p>",
        "id": 178999412,
        "sender_full_name": "Scott Carrier",
        "timestamp": 1571952326
    },
    {
        "content": "<p>Hi Scott, thanks for the question.  the Media type for FHIR JSON changed from <code>application/json+fhir</code> to <code>application/fhir+json</code> after DSTU2.</p>",
        "id": 179001879,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1571954334
    },
    {
        "content": "<p>However, I do have a related question for the rest of the team:  what is the expected action if the client leaves off the Content-Type header?  Is that header strictly required or can we default to application/fhir+json somehow?   I guess we're sort of limited by JAX-RS?</p>",
        "id": 179001990,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1571954404
    },
    {
        "content": "<p>It should map to application/json+fhir</p>",
        "id": 179008562,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571960057
    },
    {
        "content": "<p>It's in the code, that it maps in FHIRHttpRequestWrapper</p>",
        "id": 179008615,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571960080
    },
    {
        "content": "<p>Just double checked, we do this:</p>",
        "id": 179009428,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571960954
    },
    {
        "content": "<p>default:<br>\n                    httpResponse.setContentType(com.ibm.fhir.core.FHIRMediaType.APPLICATION_FHIR_JSON);<br>\n                    break;<br>\n                }</p>",
        "id": 179009431,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571960955
    },
    {
        "content": "<p>when we don't find a matching contentType, we set it.</p>",
        "id": 179009439,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571960970
    },
    {
        "content": "<p>interesting.  when i tried from curl without the Content-Type header, I got back a 415.  maybe curl is doing something \"interesting\" under the covers.  will check server logs to see whats going on when i get a chance...definitely not too important though</p>",
        "id": 179009726,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1571961281
    },
    {
        "content": "<p>what shows up when you add -v?</p>",
        "id": 179009920,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961488
    },
    {
        "content": "<blockquote>\n<p>GET / HTTP/2<br>\nHost: <a href=\"http://google.com\" target=\"_blank\" title=\"http://google.com\">google.com</a><br>\nUser-Agent: curl/7.54.0<br>\nAccept: <em>/</em></p>\n</blockquote>",
        "id": 179009959,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961534
    },
    {
        "content": "<p>I get that</p>",
        "id": 179009961,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961537
    },
    {
        "content": "<p>so I doubt it is Curl, sometimes when you go through an intermediate proxy, it'll rewrite the request.   I have a doubt on that, but worth putting in the back of our minds</p>",
        "id": 179009985,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961569
    },
    {
        "content": "<p>Oh... I see why</p>",
        "id": 179010015,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961603
    },
    {
        "content": "<p>that's ONLY in the exception case</p>",
        "id": 179010047,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961609
    },
    {
        "content": "<p><code>        } catch (FHIRException e) {</code></p>",
        "id": 179010061,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961628
    },
    {
        "content": "<p>on line 127</p>",
        "id": 179010070,
        "sender_full_name": "Paul Bastide",
        "timestamp": 1571961641
    }
]