[
    {
        "content": "<p>I try to validate my resources and profiles using both the .NET implementation on SIMPLIFIER and the Java validator. However even when my profiles validate OK in SIMPLIFIER I get a lot of errors when I try to run the same validation in Java with a catalog of my StrctureDefinition as my IG.<br>\nThe thing bugging me most at the moment is this one: </p>\n<div class=\"codehilite\"><pre><span></span><code>Unable to generate snapshot for gd-Person from no-basis-Person because Profile GdPerson (http://ehelse.no/fhir/StructureDefinition/gd-Person), element null. Error generating snapshot: Error sorting Differential: StructureDefinition http://ehelse.no/fhir/StructureDefinition/gd-Person: Differential contains path Person.extension.extension.value[x].coding.code which is actually Element.coding.code, which is not found in the in base http://ehelse.no/fhir/StructureDefinition/gd-Person\norg.hl7.fhir.exceptions.DefinitionException: Profile GdPerson (http://ehelse.no/fhir/StructureDefinition/gd-Person), element null. Error generating snapshot: Error sorting Differential: StructureDefinition http://ehelse.no/fhir/StructureDefinition/gd-Person: Differential contains path Person.extension.extension.value[x].coding.code which is actually Element.coding.code, which is not found in the in base http://ehelse.no/fhir/StructureDefinition/gd-Person\n        at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:785)\n        at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:752)\n        at org.hl7.fhir.r5.context.SimpleWorkerContext.allStructures(SimpleWorkerContext.java:635)\n        at org.hl7.fhir.validation.ValidationEngine.prepare(ValidationEngine.java:502)\n        at org.hl7.fhir.validation.cli.services.ValidationService.initializeValidator(ValidationService.java:257)\n        at org.hl7.fhir.validation.cli.services.ValidationService.initializeValidator(ValidationService.java:212)\n        at org.hl7.fhir.validation.ValidatorCli.doValidation(ValidatorCli.java:203)\n        at org.hl7.fhir.validation.ValidatorCli.main(ValidatorCli.java:159)\n</code></pre></div>\n<p>I don't know what the validator is up to here as the StructureDefinition differential should be correctly generated from Forge, and I can't really se any problem with the StructureDefinition in question:</p>\n<div class=\"codehilite\"><pre><span></span><code>    &lt;element id=&quot;Person.extension:citizenship.extension&quot;&gt;\n      &lt;path value=&quot;Person.extension.extension&quot; /&gt;\n      &lt;slicing&gt;\n        &lt;discriminator&gt;\n          &lt;type value=&quot;value&quot; /&gt;\n          &lt;path value=&quot;url&quot; /&gt;\n        &lt;/discriminator&gt;\n        &lt;rules value=&quot;open&quot; /&gt;\n      &lt;/slicing&gt;\n    &lt;/element&gt;\n    &lt;element id=&quot;Person.extension:citizenship.extension:code&quot;&gt;\n      &lt;path value=&quot;Person.extension.extension&quot; /&gt;\n      &lt;sliceName value=&quot;code&quot; /&gt;\n      &lt;mustSupport value=&quot;true&quot; /&gt;\n    &lt;/element&gt;\n    &lt;element id=&quot;Person.extension:citizenship.extension:code.value[x].coding.system&quot;&gt;\n      &lt;path value=&quot;Person.extension.extension.value[x].coding.system&quot; /&gt;\n      &lt;definition value=&quot;Grunndata - sets the system value of http://hl7.org/fhir/ValueSet/iso3166-1-3 or extension for the extended code values from FREG&amp;#xD;&amp;#xA;&amp;#xD;&amp;#xA;The identification of the code system that defines the meaning of the symbol in the code.&quot; /&gt;\n      &lt;mustSupport value=&quot;true&quot; /&gt;\n    &lt;/element&gt;\n    &lt;element id=&quot;Person.extension:citizenship.extension:code.value[x].coding.code&quot;&gt;\n      &lt;path value=&quot;Person.extension.extension.value[x].coding.code&quot; /&gt;\n      &lt;alias value=&quot;Kode for statsborgerskap&quot; /&gt;\n      &lt;mustSupport value=&quot;true&quot; /&gt;\n    &lt;/element&gt;\n</code></pre></div>\n<p>The profile: <a href=\"https://simplifier.net/grunndata-r4/person\">https://simplifier.net/grunndata-r4/person</a></p>\n<p>Any help appreciated <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 242697834,
        "sender_full_name": "Thomas Tveit Rosenlund",
        "timestamp": 1623742815
    },
    {
        "content": "<p>I'll have to debug</p>",
        "id": 242702499,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623745902
    },
    {
        "content": "<p>in fact, the part you quoted isn't incorrect, it's the next line</p>",
        "id": 242807012,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623795567
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>    &lt;element id=&quot;Person.meta.security:addressConfidentiality.system&quot;&gt;\n    &lt;element id=&quot;Person.meta.security:addressConfidentiality.code&quot;&gt;\n    &lt;element id=&quot;Person.meta.security:addressConfidentiality.extension&quot;&gt;\n    &lt;element id=&quot;Person.meta.security:addressConfidentiality.extension:fregMetadata&quot;&gt;\n</code></pre></div>\n<p>extension comes before system</p>",
        "id": 242807068,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623795602
    },
    {
        "content": "<p>Absolutely didn't catch that. However, it does not solve the problem. I think there is really something wrong with my extended extensions again...</p>",
        "id": 242843076,
        "sender_full_name": "Thomas Tveit Rosenlund",
        "timestamp": 1623830800
    },
    {
        "content": "<p>Looks like it validates OK if I generate snapshots for the derived profiles in Forge. There is something funky about the way Forge makes differentials for derived profiles, and it could be related to those problems. I will investigate furter.</p>",
        "id": 242858528,
        "sender_full_name": "Thomas Tveit Rosenlund",
        "timestamp": 1623837583
    }
]