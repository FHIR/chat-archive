[
    {
        "content": "<p>Hi. We're developing an application where practitioners can be invited the join a CareTeam and they can choose to accept the invitation or not.</p>\n<p>In our preliminary design, we thought of always adding the practitioner as a participant, regardless of if they accept the invitation or not, and use the period component to indicate if the invitation had been accepted. If the practitioner declines, we remove them from the CareTeam.participant list.</p>\n<p>However, we also have a requirement where when the practitioner lists Patients, the practitioner should only see patients where they have accepted the CareTeam invitation. We are using the search query <code>Patient?_has:CarePlan:subject:care-team.participant=Practitioner/{practitioner.Id}</code>. I've tried to create a custom SearchParameter that checks if the period component of the participant exists:</p>\n<div class=\"codehilite\"><pre><span></span><code>active-participant:\n  &quot;expression&quot;: &quot;CareTeam.participant.where(period).member&quot;\n</code></pre></div>\n\n<p>The custom search parameter worked when testing on a microsoft fhir-server implementation.<br>\nThe search query used was  <code>Patient?_has:CarePlan:subject:care-team.active-participant=Practitioner/{practitioner.Id}</code>.</p>\n<p>My question is if this is proper usage of the SearchParameter expression? From what I see in the existing SearchParameters, none of them use a where expression similar to what I used, it's either <code>where(resolve() is Resource)</code> or <code>where(field='xxx')</code></p>",
        "id": 267397393,
        "sender_full_name": "Donn Relacion",
        "timestamp": 1641792587
    },
    {
        "content": "<p>There's no restriction against going as weird and wild as you like with your expression.  However, whether a given server will be able to just consume the SearchParameter automatically without needing to write custom code will vary.  The simpler the expression, the more likely it'll just \"work\" out of the box.</p>",
        "id": 267454227,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1641829106
    }
]