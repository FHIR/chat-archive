[
    {
        "content": "<p>Good Day FHIR Folks,</p>\n<p>I am having a bit of difficulty creating the correct endpoint for my GET request to our FHIR API,</p>\n<p>My goal in a very general sense is to call for all Resources that are related to one other specific Resource's id, and only when a certain Element in that resource matches a certain value.</p>\n<p>Specifically, I want to find all Encounter resources that are tied to one specific Patient, and only when those Encounters for that Patient were for a specific year (the Element object is \"period\" with two fields within it, \"start\" and \"end\").  </p>\n<p>I have tried the following endpoints to obtain this desired result, with no luck:</p>\n<p>https://[Base URL]/Encounter?_patient=Patient/###########&amp;?_period.start=2011-09-18T19:05:01-04:00</p>\n<p>https://[Base URL]/Encounter?_patient=Patient/###########&amp;?_period=2011-09-18T19:05:01-04:00</p>\n<p>https://[Base URL]/Encounter?_patient=Patient/###########&amp;period=2011-09-18T19:05:01-04:00</p>\n<p>https://[Base URL]/Encounter?_patient=Patient/###########?given:contains=2011-09-18T19:05:01-04:00</p>\n<p>https://[Base URL]/Encounter?_patient=Patient/###########?contains=2011-09-18T19:05:01-04:00</p>\n<p>https://[Base URL]/Encounter?_patient=Patient/###########&amp;period?given:contains=2011-09-18T19:05:01-04:00</p>\n<p>When send a Get to these endpoints, I am not given the one value that I am testing for, but rather a bundle of all Encounters regardless of matching period-value.</p>\n<p>I am looking on the HL7 documentation here for \"search\" but I can't seem to find what I need, any points in the right direction would be greatly appreciated!!</p>",
        "id": 172856254,
        "sender_full_name": "Mike C.",
        "timestamp": 1565361414
    },
    {
        "content": "<p>No underscore - <code>...Encounter?patient=....</code></p>",
        "id": 172862525,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1565366015
    },
    {
        "content": "<p>https://[Base URL]/Encounter?patient=123&amp;period=2011-09-18</p>",
        "id": 172862603,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565366049
    },
    {
        "content": "<p>So only ever one \"?\", multiple parameters separated by &amp;</p>",
        "id": 172862635,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565366075
    },
    {
        "content": "<p>:contains isn't an allowed qualifier for period</p>",
        "id": 172862712,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565366142
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Thank you for the replies gentlemen! I appreciate your help.</p>",
        "id": 172864773,
        "sender_full_name": "Mike C.",
        "timestamp": 1565367534
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> </p>\n<blockquote>\n<p>https://[Base URL]/Encounter?patient=123&amp;period=2011-09-18</p>\n</blockquote>\n<p>Understood - branching off this, my question would be: is it possible to search for only part of the value in the period field? Essentially, doing a \"string slice\" of the total value (2011-09-18T19:05:01-04:00 is how the dates are formatted in this field for every Encounter), such that I could search for only the first four characters of the period.start value? </p>\n<p>Basically, I want to be able to search for all Encounter resources that begin with a certain year (the first four characters in that string). Since it's not practical, in my use-case, to search for the entire long dateTime object, I want to just search for the all Encounter objects based on a year input i.e. \"2011\"</p>\n<p>I  would think that the ':contains' parameter would be the logical solution to this, but I know you said that ':contains' is not an allowed qualifier for the period Element, so would there be any way of achieving this another way?</p>",
        "id": 172870316,
        "sender_full_name": "Mike C.",
        "timestamp": 1565371416
    },
    {
        "content": "<p>You aren't searching against the characters, you're searching against the math :)  Searches against periods are based on set math of the range of the search term (determined by its precision) and the range of the period (including its precision).  So if you search for period=2011, that will find any records that have a period that overlap the period of 2011-01-01T00:00:00 to 2011-12-31T23:59:59.</p>",
        "id": 172876070,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565375232
    },
    {
        "content": "<p>...isn't it contains, not overlap?</p>",
        "id": 172876787,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1565375557
    },
    {
        "content": "<p>Overlap</p>",
        "id": 172876998,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565375709
    },
    {
        "content": "<p>Something that started 2011-12-31T23:59:58 and lasted 10 days into 2012 would be returned by a query of period=2011</p>",
        "id": 172877051,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565375752
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> , thanks for the suggestion. I tried to use period=2011 as a query parameter but Postman still returns all encounters, basically not filtering by year 2011. Am I missing something?</p>",
        "id": 172878977,
        "sender_full_name": "Mike C.",
        "timestamp": 1565376763
    },
    {
        "content": "<p>Actually, looks like 'period' isn't a valid search parameter.  It should be 'date'.  (You can look at the 'self' link to see what query the server actually executed - any parameters not listed it doesn't support or might not even be valid.)</p>",
        "id": 172882929,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565379842
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> , that's the ticket I needed. Appreciate your and <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> 's help today. Have a great weekend.</p>",
        "id": 172888353,
        "sender_full_name": "Mike C.",
        "timestamp": 1565384277
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  I think the 'self' link section and   <a href=\"http://build.fhir.org/search.html#errors\" target=\"_blank\" title=\"http://build.fhir.org/search.html#errors\">handling errors</a> appear related enough to be merged or at least adjacent? instead of at opposite ends of the page</p>",
        "id": 172989976,
        "sender_full_name": "Eric Haas",
        "timestamp": 1565570348
    },
    {
        "content": "<p>Change request :)</p>",
        "id": 172994368,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1565579209
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  not sure why searching by <code>date</code> instead of <code>period.start</code> and <code>period.end</code> .  Some client need to get all encounter fisnishing before and exact date. Searching by <code>date</code> looks quite unprecise. <br>\nAlso there is no way to <code>_sort</code> by end/start.<br>\nAny thought ?</p>",
        "id": 178560497,
        "sender_full_name": "natus",
        "timestamp": 1571514570
    },
    {
        "content": "<p>Searching by date allows you to find elements that overlap a particular period.  You can use le and/or ge to define the boundaries of the period you're looking for matches with and can then look for records that overlap with those boundaries.  So far no one's mentioned the ability to sort by period - agree that's something that's a reasonable thing to want to do.  <span class=\"user-mention\" data-user-id=\"213944\">@natus</span> would you be willing to submit a change request?</p>",
        "id": 178571938,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1571536048
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  I have two use cases:<br>\n- search for all encounter who have missing end-date, OR end-date between x and y <br>\n- sort them by start date.</p>\n<p>Ok to submit a change request for both. but please discuss before the content of the change.</p>\n<p>Proposal 1:</p>\n<div class=\"codehilite\"><pre><span></span>Encounter?period=2019 //equivalent to actual date\nEncounter?period.start=2019\nEncounter?period.start:lt=2020-02&amp;period.end:gt=2017\nEncounter?period.end:missing=true\nEncounter?_sort=period.start\n</pre></div>\n\n\n<p>Proposal 2:</p>\n<div class=\"codehilite\"><pre><span></span>Encounter?date=2019 // no broken change\nEncounter?start-date=2019\nEncounter?start-date:lt=2020-02&amp;start-date:gt=2017\nEncounter?end-date:missing=false\nEncounter?_sort=-start-date\n</pre></div>",
        "id": 178585445,
        "sender_full_name": "natus",
        "timestamp": 1571563403
    },
    {
        "content": "<p>It would have to be the second.  \".\" is used for chaining and isn't allowed in the names of a search criteria</p>",
        "id": 178598524,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1571587467
    },
    {
        "content": "<p>ok. I guess I did the request in hl7gforce. I am unsure because the process has been tricky</p>",
        "id": 178689584,
        "sender_full_name": "natus",
        "timestamp": 1571686554
    },
    {
        "content": "<p>Yup.  <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=25037\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=25037\">GF#25037</a> looks good.</p>",
        "id": 178692991,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1571688438
    }
]