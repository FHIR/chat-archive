[
    {
        "content": "<p>I just updated the draft of R4 to say that token searches are case sensitive unless they are not.</p>",
        "id": 153925568,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513369177
    },
    {
        "content": "<p>actually, it says, 'unless the underlying semantics say they are not'. That's... tough. really tough from the server side - you get a search token that matches your index, and the match may or may not be case sensitive, depending on the item.</p>",
        "id": 153925569,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513369230
    },
    {
        "content": "<p>is it just me who thinks that this is a hard call for the server? <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> <span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> <span class=\"user-mention\" data-user-id=\"191914\">@Danielle Friend</span> <span class=\"user-mention\" data-user-id=\"191356\">@Jenni Syed</span> <span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> <span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> <span class=\"user-mention\" data-user-id=\"191651\">@Rik Smithies</span> <span class=\"user-mention\" data-user-id=\"191318\">@nicola (RIO/SS)</span> <span class=\"user-mention\" data-user-id=\"192018\">@John Gresh</span> <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> (semi-random selection of server maintainers - apologies if I missed anyone)</p>",
        "id": 153925570,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513369410
    },
    {
        "content": "<p>Given how broad a \"token\" is, yes :)</p>",
        "id": 153925572,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513369489
    },
    {
        "content": "<p>it's a hard call to understand what it means</p>",
        "id": 153925573,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1513369549
    },
    {
        "content": "<p>Let's just take 1 fun example: email. Technically, domain is supposed to be case insensitive, but username is supposed to be sensitive. Your milage may vary when you try to see how this behaves in real life.</p>",
        "id": 153925574,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513369654
    },
    {
        "content": "<p>and that's ignoring FHIR :)</p>",
        "id": 153925575,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513369664
    },
    {
        "content": "<p>(it's a token search in FHIR, which is why I bring that one up)</p>",
        "id": 153925576,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513369679
    },
    {
        "content": "<p>ah so I see. I might have said \"inherent\" semantics</p>",
        "id": 153925577,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1513369721
    },
    {
        "content": "<p>I <em>think</em> in our server, most code searches that are token are case sensitive, but I agree that it would be really hard to say that sensitivity is Yes or No throughout</p>",
        "id": 153925579,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513369843
    },
    {
        "content": "<p>I think it would be better to say that except for a few special parameters, token search parameters are always case insensitive</p>",
        "id": 153925580,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513369901
    },
    {
        "content": "<p>or, even with the email example, implemented consistently and correctly :)</p>",
        "id": 153925581,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513369905
    },
    {
        "content": "<p>how is the server to know the underlying rules? They would need to be brought into FHIR on a per field basis. In fact you cannot even know if a (future) code system is case sensitive.</p>",
        "id": 153925582,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1513369908
    },
    {
        "content": "<p>yes that's part of the challenge. And then a search like this:</p>\n<p>Get Observation?code=Xxx</p>",
        "id": 153925583,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513369998
    },
    {
        "content": "<p>That's surprising for me (the insensitivity) b/c we usually say code is case sensitive</p>",
        "id": 153925584,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513370008
    },
    {
        "content": "<p>I would expect it to follow the underlying rules</p>",
        "id": 153925585,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513370018
    },
    {
        "content": "<p>that's case sensitive or not depending on the system of the coding.</p>",
        "id": 153925586,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513370035
    },
    {
        "content": "<p>Jenni, are v2 tables case sensitive?</p>",
        "id": 153925587,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513370044
    },
    {
        "content": "<p>codes are normally case sensitive, but things like country codes may not be</p>",
        "id": 153925588,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1513370051
    },
    {
        "content": "<p>IANAV2E (I am not a V2 Expert)... not sure</p>",
        "id": 153925589,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513370090
    },
    {
        "content": "<p>in fact, you rarely know whether codes really are case sensitive or not. Postel's law should apply here, and I'm trying to find a way to approach that</p>",
        "id": 153925590,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513370103
    },
    {
        "content": "<p>.. the answer is.. not everyone agrees ... but the FHIR code systems claim that v2 tables are not case sensitive.</p>",
        "id": 153925592,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513370156
    },
    {
        "content": "<p>All FHIR defined codes are case sensitive, right?</p>",
        "id": 153925593,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513370159
    },
    {
        "content": "<p>eg: gender, status fields, etc</p>",
        "id": 153925594,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1513370170
    },
    {
        "content": "<p>yes, except that the build tool won't let you define codes that only differ by case</p>",
        "id": 153925595,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513370182
    },
    {
        "content": "<p>It's definitely a tough call! Perhaps it should depend on the underlying data type of the token; for example, enforcing case-sensitivity on a string search might be problematic and I've always been forgiving on the casing of \"true\" and \"false\" both in and out of FHIR.</p>",
        "id": 153925639,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1513371982
    },
    {
        "content": "<p>This is an interesting question. HAPI JPA/Smile certainly always makes tokens case sensitive currently, and I've never really thought about changing that. But now that you bring it up, Jenni's email example makes sense.</p>\n<p>For a general purpose server I don't know that it makes sense to leave this purely up to server implementors. A standard extension on SearchParameter seems like it might be useful to allow people to configure this at the SP level.</p>",
        "id": 153925648,
        "sender_full_name": "James Agnew",
        "timestamp": 1513373510
    },
    {
        "content": "<p>case insensitivity is evil. I would be happy with it being case sensitive always. which specific things would break, can we make a different search type for them (like go use string)?</p>",
        "id": 153925686,
        "sender_full_name": "John Moehrke",
        "timestamp": 1513443124
    },
    {
        "content": "<p>UK (NHS) HAPI Restful server is case sensitive. (<a href=\"http://yellow.testlab.nhs.uk/careconnect-ri/\" target=\"_blank\" title=\"http://yellow.testlab.nhs.uk/careconnect-ri/\">http://yellow.testlab.nhs.uk/careconnect-ri/</a> )</p>",
        "id": 153925687,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1513444764
    },
    {
        "content": "<p>because of the codes</p>",
        "id": 153925688,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1513444812
    },
    {
        "content": "<p>Actually, <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> , I believe case sensitivity is evil when it comes to strings. Humans think case insensitive, so there must always be strong justification as to why something is case sensitive. Base64 hase a good justification, but coding system codes do not IMHO. Yes, they should be consistently cased, but if you can't have codes that only differ in case (which I believe to be the right thing), then you have conceded that the codes are not truly case sensitive. Unless there are legit uses for codes only differing in case (I have luckily not encountered such a system), is there a reason for search to be case sensitive? Domains/email and UUID strings are case insensitive for good reasons. I do not believe we'd follow Postel's law if code/token searches are case sensitive.</p>",
        "id": 153925709,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1513458360
    },
    {
        "content": "<p>I would agree if humans in all languages considered case insenstivity the same... they don't...</p>",
        "id": 153925710,
        "sender_full_name": "John Moehrke",
        "timestamp": 1513458436
    },
    {
        "content": "<p>Not even when it comes to the meaning of names (and I think of codes as names)?</p>",
        "id": 153925711,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1513458634
    },
    {
        "content": "<p>see email earlier in this thread, though that's  weird outlier. UCUM is case sensitive. But not a high priority for search. v2 tables have caused trouble in production in the past.</p>",
        "id": 153925717,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513463953
    },
    {
        "content": "<p>Case sensitive search is a useful option for searching for names in strings, \"White\" as a name and \"white\" as a colour.</p>",
        "id": 153925771,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1513555873
    },
    {
        "content": "<p>do read the comments about case sensitivity for string parameters</p>",
        "id": 153925774,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513558088
    },
    {
        "content": "<p>I can imagine that a facade implementer knows all the codesystems used in his/her system and can therefore decide whether a token search should be case sensitive or not.<br>\nFor a general purpose FHIR server this is much less the case. Unless it knows the case sensitivity of all used code systems. And then still:<br>\nIn one valueset there can be case sensitive and case insensitive codesystems mixed.<br>\nWhat do you mean by doing a string search instead? Defining a String-type searchparameter on the element?<br>\nIn Vonk we currently always match tokens case insensitive, by the concept that it is usually safer to match a bit broader than narrower, and the expectation that .<br>\nI agree with <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  to allow people to configure this in a SearchParameter, or maybe as a modifier on the search url.</p>",
        "id": 153925961,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1513610785
    },
    {
        "content": "<p>Are there cases where different repetitions of an element contain values from different code systems -- some of which are case-sensitive, others are insensitive?</p>",
        "id": 153926079,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1513639605
    }
]