[
    {
        "content": "<p>Hey, I went through the changelog and figured out for the field <code>dateEnded/reasonEnded in medicationorder</code> there are no corosponding fields in <code>MedicationRequest</code>. I wanted to know why it has been removed ? How else I am supposed to populate this data ? Let me know if I missed a field which is supposed to be replacement of these fields.</p>",
        "id": 153881434,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491619732
    },
    {
        "content": "<p>A good place to look is in the <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemBrowse&amp;tracker_id=677\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemBrowse&amp;tracker_id=677\">GForge trackers</a>  to see the why something has been changed.   These elements are covered by eventHistory. </p>",
        "id": 153881436,
        "sender_full_name": "Eric Haas",
        "timestamp": 1491620893
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> I tried looking into that but with content \"dateEnded\" I couldn't find a similar issue. I am not sure how these should be covered in event history, when you stop a Prescription that is the current state and that should not be part of history.</p>",
        "id": 153881437,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491628153
    },
    {
        "content": "<p>One Idea could be it could be same as dateWritten of Stopped MedicationRequest, but then I am not sure if there could be a scenario when these two could be different </p>",
        "id": 153881438,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491628599
    },
    {
        "content": "<p>MedicationRequest.reasonEnded and dateEnded were replaced by the \"eventHistory\" structure, which was originally going to be a backbone element with status, action, date/time, practitioner, and reason per <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=8442\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=8442\">GF#8442</a> (looked like this temporarily <a href=\"http://hl7.org/fhir/2016Sep/medicationorder.html\" target=\"_blank\" title=\"http://hl7.org/fhir/2016Sep/medicationorder.html\">http://hl7.org/fhir/2016Sep/medicationorder.html</a>), but then \"eventHistory\" morphed into the reference to Provenance as part of workflow alignment with the request pattern, <a href=\"http://build.fhir.org/request.html\" target=\"_blank\" title=\"http://build.fhir.org/request.html\">http://build.fhir.org/request.html</a> per <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=10733\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=10733\">GF#10733</a>. <br>\nPersonally, I would have preferred it to be inline in the resource instead of relying on Provenance.</p>",
        "id": 153881446,
        "sender_full_name": "Michelle (Moseman) Miller",
        "timestamp": 1491651158
    },
    {
        "content": "<p>Note:  we also have <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12144\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12144\">GF#12144</a> approved (but not applied) asking for a profile on Provenance within the Request guidance that will provide examples and documentation on how to use Provenance to represent event history</p>",
        "id": 153881447,
        "sender_full_name": "Michelle (Moseman) Miller",
        "timestamp": 1491653010
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192421\">@Mritunjay Dubey</span> You just need to MedicationRequest.status to stopped and MedicationRequest.authoredOn to the stop date and MedicationRequest.reasonCode/reasonReference to the stop reason and then link this MedicationRequest with previous one using MedicationRequest.eventHistory</p>",
        "id": 153881473,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1491685938
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> I will just put what I have got from here<br>\nWhen I create a new MedicationRequest, this is how it will look like</p>\n<div class=\"codehilite\"><pre><span></span>MedicationRequest1\n         status =&gt; ACTIVE\n         authoredon =&gt; somedate\n</pre></div>\n\n\n<p>When I  stop it this is the way it should be populated</p>\n<div class=\"codehilite\"><pre><span></span>MedicationRequest1\n         status =&gt; ACTIVE\n         authoredon =&gt; startdate\nMedicationRequest2\n         status =&gt; STOPPED\n         authoredon =&gt; stoppeddate\n         reasonCode =&gt; stopreason\n         eventhistory =&gt; Provenance.target=MedicationRequest1\n</pre></div>\n\n\n<p>Correct me if I am wrong</p>",
        "id": 153881480,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491692869
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> <span class=\"user-mention\" data-user-id=\"192421\">@Mritunjay Dubey</span> I disagree with repurposing those elements (specifically, authoredOn and reasonCode).<br>\nFor example, the MedicationRequest.authoredOn is explicitly defined as \"The date (and perhaps time) when the prescription was <strong>initially</strong> written or authored on\"</p>",
        "id": 153881482,
        "sender_full_name": "Michelle (Moseman) Miller",
        "timestamp": 1491703323
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> MedicationRequest.eventHistory actually points to Provenance, not to past MedicationRequest version.  (The Provenance points to a past version.)  You should be able to see the history just from looking at the Provenance:<br>\nProvenance.period = stopped date (we'll let this be a dateTime in R4)<br>\nProvenance.reason = stopped reason<br>\nProvenance.activity =  aborted (which is the code that means stopped)<br>\nProvenance.target = past version of the prescription</p>",
        "id": 153881483,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1491703397
    },
    {
        "content": "<p>Agree with <span class=\"user-mention\" data-user-id=\"191360\">@Michelle M Miller</span> that the Precription.authoredOn always represents the date the prescription was written and the reason always represents the reason for the prescription.</p>",
        "id": 153881484,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1491703453
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191403\">@Michelle (Moseman) Miller</span> <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Even I felt if I will  use <code>authoredOn</code> as dateStopped, it might be not right. I feel there can be a scenario when a doctor can say stop taking a medication in that case dateStopped and authoredOn will be different dates.</p>",
        "id": 153881490,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491729686
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  Here is what is I am confused about, when you say <code>The Provenance points to a past version</code>, and then you say <code>Provenance.period = stopped date etc</code>. I think past medicationrequest  is the one which was initial requested and the latest is the stopped one. So Ideally it should be <code>stopped.provenance=&gt;intitial.reference</code> because initial is the history of stopped  and if this is the case then we will end up populating these fields to the one which was initially created.</p>",
        "id": 153881491,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491731190
    },
    {
        "content": "<p>Correct me if I am thinking in wrong direction.</p>",
        "id": 153881492,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491731222
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192421\">@Mritunjay Dubey</span> You're correct that if the most recent change is the \"stop\", that won't show up in the eventHistory.  Instead, there'll be a Provenance instance that directly points to that version that has the relevant information.  To see all relevant Provenances for a record, you need to do an _include on MedicationRequest.eventHistory and a _revinclude on Provenance.target.  (The latter should generally only give you one record.</p>",
        "id": 153881497,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1491750517
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Sorry I didnâ€™t get last two lines. From what I understood I feel a problem. In our use case most of the times A New medicationorder will be placed and in few cases it will be stopped. After a stop there cannot be a recent state for that order means stopped order will never be a history so there won't be any case it to go as Provenance. So I am not sure how would I populate these fields at all, because these can be populated only in a Provenance.</p>",
        "id": 153881498,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491752784
    },
    {
        "content": "<p>Every time MedicationRequest gets created or changed in any way, a Provenance record should be created that points to the version of the MedicationRequest that was just created.   So, in the simple case of \"create order, stop order\", you'll have MedicationRequest v1 (status = active, no eventHistory), Provenance1 pointing to MedicationRequest v1 indicating who created it, when, etc.  Then MedicationRequest v2 (status = stopped, eventHistory pointing to Provenance1), Provenance2 pointing to MedicationRequest v2 with information about when the stop occurred, why, who did it, etc.</p>",
        "id": 153881500,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1491754334
    },
    {
        "content": "<p>ohh do you mean every version of request will have atleast one provinence which will be not directly reffered in the request.eventHistory. This will hold the information about current version of resource. </p>",
        "id": 153881501,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491754956
    },
    {
        "content": "<p>Yes.  Every version of every resource can (and often should) have a Provenance that captures the details about what changed, who did it and why.  So if tracking that information is needed, Provenance is how it's done.</p>",
        "id": 153881510,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1491761546
    },
    {
        "content": "<p>Given that provenance points to the resource it is tracking, is it possible for it to be contained within the resource?</p>",
        "id": 153881512,
        "sender_full_name": "David Hay",
        "timestamp": 1491771022
    },
    {
        "content": "<p>It should be, but there's an invariant that prevents it at the moment (dom-3).  I've submitted <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13187\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13187\">GF#13187</a> to fix this.</p>",
        "id": 153881526,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1491787895
    },
    {
        "content": "<p>I've added a note to your tracker on dom-3, I don't like the constraint either.</p>",
        "id": 153881533,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1491795223
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191403\">@Michelle (Moseman) Miller</span> <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Agree.. That is better than what I proposed. Thanks.</p>",
        "id": 153881600,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1491833624
    }
]