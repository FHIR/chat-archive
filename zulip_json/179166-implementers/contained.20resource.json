[
    {
        "content": "<p>I'm trying to create an example Immunization resource that contains an AdverseEvent resource within it. The AdverseEvent resource points back to the Immunization resource that caused the adverse event in AdverseEvent.suspectEntity.instance<br>\nThe contained resource part of my example looks like this:<br>\n&lt;Immunization&gt;<br>\n    &lt;id value=\"adverseEvent\"/&gt;<br>\n    &lt;contained&gt;<br>\n        &lt;AdverseEvent&gt;<br>\n            &lt;id value=\"p1\"/&gt;<br>\n            &lt;actuality value=\"actual\"/&gt;<br>\n            &lt;subject&gt; <br>\n                    &lt;reference value=\"Patient/example\"/&gt; <br>\n            &lt;/subject&gt; <br>\n            &lt;suspectEntity&gt; <br>\n                    &lt;instance&gt; <br>\n                    &lt;reference value=\"#\"/&gt; <br>\n                    &lt;/instance&gt; <br>\n            &lt;/suspectEntity&gt; <br>\n        &lt;/AdverseEvent&gt;<br>\n    &lt;/contained&gt;<br>\n&lt;rest of the immunization resource&gt;</p>\n<p>When I try to build locally, I get an error of \"Immunization.contained.suspectEntity.instance: Unable to resolve resource '#' (src = InstanceValidator)</p>\n<p>Any idea what the issue is?</p>\n<p>Note that initially, i didn't include an id in the contained resource and that caused an error too even thought I thought that a contained resource that references the container didn't need one.<br>\nThanks</p>",
        "id": 154012705,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540580118
    },
    {
        "content": "<p>It's possible that the validator doesn't yet support the use of \"#\" to refer to the parent.</p>",
        "id": 154012715,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1540580997
    },
    {
        "content": "<p>(That said - why would the AdverseEvent not be able to stand on its own?  Containing a full adverse event inside an immunization seems a little odd - if anything, I'd expect you to contain a Condition reflecting the reaction rather than a full AdverseEvent which manages the causality assessment, mitigations, etc.)</p>",
        "id": 154012717,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1540581066
    },
    {
        "content": "<p>Does that mean that we can't include an example with a contained resource pointing back to the container for R4 or is there a different way of referencing the container that he example should use?</p>\n<p>Gforge 15124 made the request. <span class=\"user-mention\" data-user-id=\"191403\">@Michelle (Moseman) Miller</span>  can correct me if I'm wrong, but I think the idea was to have a way for a system which doesn't document the adverse event separately (rather it's just part of the immunization event) to be able to still have a way to include the adverse event data.</p>",
        "id": 154012720,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540581212
    },
    {
        "content": "<p>AdverseEvent is about the causality determination.  It's a risk management exercise.  Condition is about \"what symptoms did the patient have and how bad were they\".  Which of the two are you interested in?</p>",
        "id": 154012724,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1540581683
    },
    {
        "content": "<p>They way you were referencing is correct, but it's \"new\" and there may be a bug in that the tooling doesn't support it yet.  Submit a tracker item for a fix to the publication tools.</p>",
        "id": 154012725,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1540581725
    },
    {
        "content": "<p>We discussed this in Patient Care back in January and I thought we'd settled on the use of AdverseEvent and expanded the scope of the resource a bit to include things other than just casuality determination. My understanding is that there were additional discussions in Baltimore. I wasn't able to attend that session so I don't know if they impact this decision or not. I'd like <span class=\"user-mention\" data-user-id=\"191403\">@Michelle (Moseman) Miller</span> to contribute her recollection as well.</p>",
        "id": 154012727,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540582029
    },
    {
        "content": "<p>Tracker 19531 created.<br>\n<a href=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19531\" target=\"_blank\" title=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19531\">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19531</a></p>",
        "id": 154012729,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540582328
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192758\">@Craig Newman</span> is correct on all points.  This was discussed back Feb 1, 2018 at the WGM (and I do remember <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> sitting right by me during this discussion)  The discussion started with <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14238\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14238\">GF#14238</a> asking to allow AdverseEvent.suspectEntity.instance to reference Immunization, so Immunization could then remove its reaction backbone element.  That discussion led to me logging <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15124\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15124\">GF#15124</a> (as an outcome of the WGM discussion) asking to </p>\n<blockquote>\n<p>Add a 'notes' section that indicates the preferred way to convey the immunization reaction is to have a standalone AdverseEvent resource, which uses AdverseEvent.suspectEntity.instance to reference the Immunization (approved with <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14238\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14238\">GF#14238</a>).  As an FYI, the resource created first (Immunization) is referenced from the resource created subsequently (AdverseEvent).<br>\nThe 'notes' section should also advise that those systems that capture the reaction as part of the immunization record, itself, can use a contained AdverseEvent.  Please add an Immunization example that shows the AdverseEvent as a contained resource and link to it from the 'notes' guidance.</p>\n</blockquote>\n<p>All of that said, Patient Care is actively discussing AdverseEvent -- and it is on our agenda for the Thursday FHIR call on Nov 29.  <br>\n<span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> brings up a good question, though, that I don't recall specifically discussing at the WGM.  I think it could be possible to contain a Condition (with dueTo or occurredFollowing extension referencing the Immunization).</p>",
        "id": 154012767,
        "sender_full_name": "Michelle (Moseman) Miller",
        "timestamp": 1540593846
    },
    {
        "content": "<p>This leaves us with a bit of an issue for R4. Do we go with the original plan of using AdverseEvent? If so, is there anyway to include an example Immunization with a contained AdverseEvent given that the tooling has a bug in it? Moving to a Condition seems like a drastic change this close to R4 publication. I guess we could even restore the reaction backbone to Immunization and just defer any changes to R5. it might be better to restore the status quo than to go in a direction and have to backtrack in R5. Thoughts <span class=\"user-mention\" data-user-id=\"191403\">@Michelle (Moseman) Miller</span>  or <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span></p>",
        "id": 154012775,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540596382
    },
    {
        "content": "<p>I'm not necessarily opposed to using Condition, I'm just nervous about making that decision in such a short timeframe.</p>",
        "id": 154012776,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540596511
    },
    {
        "content": "<p>AdverseEvent isn't about documenting a reaction.  It's about documenting the reporting of a reaction - and everything that goes with that.  The reaction itself is just a Condition.</p>",
        "id": 154012789,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1540598636
    },
    {
        "content": "<p>In which case perhaps it should be called AdverseEventReport?</p>",
        "id": 154012822,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1540620183
    },
    {
        "content": "<p>Except that that's usually a document that includes all of the things the AdverseEvent points to</p>",
        "id": 154012824,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1540621176
    },
    {
        "content": "<p>As an implementer, I prefer having the reaction included as a backbone element in Immunization.  Our system often treats the reaction or tolerance simply as comments on the immunization (not as a Condition that references an Immunization).<br>\nAs PC co-chair, I would also note that Observation is yet another candidate to consider since signs are symptoms are a gray area between Observation and Condition.  Per our boundaries section:</p>\n<blockquote>\n<p>This resource is not typically used to record information about subjective and objective information that might lead to the recording of a Condition resource. Such signs and symptoms are typically captured using the Observation resource; although in some cases a persistent symptom, e.g. fever, headache may be captured as a condition before a definitive diagnosis can be discerned by a clinician. By contrast, headache may be captured as an Observation when it contributes to the establishment of a meningitis Condition. </p>\n<p>Use the Observation resource when a symptom is resolved without long term management, tracking, or when a symptom contributes to the establishment of a condition. </p>\n<p>Use Condition when a symptom requires long term management, tracking, or is used as a proxy for a diagnosis or problem that is not yet determined. </p>\n</blockquote>\n<p>Due to the hesitation to use AdverseEvent, I think it might be best to roll back all changes and just keep the Immunization.reaction until we can straighten out which contained resource is preferred -- AdverseEvent, Condition, Observation etc.</p>",
        "id": 154013324,
        "sender_full_name": "Michelle (Moseman) Miller",
        "timestamp": 1540837140
    },
    {
        "content": "<p>I'm good with reverting Immunization back to contain the same reaction elements as in R3</p>",
        "id": 154013325,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540837262
    },
    {
        "content": "<p>I have restored Immunization.reaction to R4. We'll have to deal with how to document reactions to immunizations in R5. We should consider Condition, Observation and Adverse Event as possible options</p>",
        "id": 154013640,
        "sender_full_name": "Craig Newman",
        "timestamp": 1540912068
    },
    {
        "content": "<p>I'm looking for guidance on the Immunization.reaction pattern. DSTU2 &amp; R4 both have a \"reaction\" backbone element, but in both cases the symptom itself is in an Observation reference. We could use reference.display for text, or (more likely) we would embed a very simple Observation. If we do so, does anyone have any feedback on a preferred <a href=\"http://build.fhir.org/observation.html#code-interop\" target=\"_blank\" title=\"http://build.fhir.org/observation.html#code-interop\">pattern</a>?</p>",
        "id": 167391337,
        "sender_full_name": "Jay Lyle",
        "timestamp": 1559743406
    },
    {
        "content": "<p>If it's information that only exists in the context of the Immunization and isn't ever expected to exist on its own, I'd probably create a contained Observation</p>",
        "id": 167398024,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1559747073
    },
    {
        "content": "<p>hmm, so a reaction to immunisation is in the resource, but for administration of a medication it will be an adverseEvent(?). I can understand the reason. do we want to iron that, or best as is?</p>",
        "id": 167403695,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1559750542
    },
    {
        "content": "<p>Is this an appropriate topic for a future workflow call? I've been in on several discussions about this but it still feels a bit unsatisfying.</p>",
        "id": 167404858,
        "sender_full_name": "Craig Newman",
        "timestamp": 1559751320
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192758\">@Craig Newman</span> i think the decision on immunisation.reaction is by PHER and eventually any discrepancy by FMG, but of course iI would be glad to see this in a workflow call. (this is me asking for the meeting chair to give his blessing, wink wink nudge nudge).</p>",
        "id": 167407358,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1559753084
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191985\">@Jay Lyle</span>  sorry for slightly off topic. I think an observation could work (btw, the loinc code for adverse drug reactions 52472-8 is deprecated?), but an isn't adverseEvent more specific?</p>",
        "id": 167408117,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1559753592
    },
    {
        "content": "<p>Immunization.reaction (or AllergyIntolerance.reaction) being an AdverseEvent would be driven by \"what do most systems typically do\" - and I think the designers have made the right call of saying that most immunization and allergy systems don't represent reactions as  links to entries in their repository of reported adverse events.  Any such linkage could be captured with an extension to support those systems that do maintain such a linkage.</p>",
        "id": 167412639,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1559757039
    },
    {
        "content": "<p>i agree it is normally part of the immunization record, so it deserves to differ. <br>\nWhy Observation and not AdverseEvent?. Do we have enough input to say \"most systems capture this as an 'Observation' object constrained for reaction, they do not capture this as a 'Reaction' object\"?</p>",
        "id": 167414506,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1559758198
    },
    {
        "content": "<p>All good comments, and useful for advancing Allergy for R5. But my immediate concern: which coded Obs pattern should the contained Observation follow?<br>\ncode = 31044-1 - Immunization reaction; value = 271807003 |Eruption of skin (disorder)|<br>\ncode = 271807003 |Eruption of skin (disorder)|; value = 410515003 |Known present (qualifier value)|<br>\ncode = 271807003 |Eruption of skin (disorder)|</p>",
        "id": 167414601,
        "sender_full_name": "Jay Lyle",
        "timestamp": 1559758230
    },
    {
        "content": "<p>AdverseEvent is for reporting and causality determination.  Observation is for capturing a symptom</p>",
        "id": 167415383,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1559758682
    },
    {
        "content": "<p>If you want to say \"patient had a rash\", you use Observation.  If you want to list concomitment meds and capture the likelihood that one was the cause, you use AdverseEvent</p>",
        "id": 167415460,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1559758716
    },
    {
        "content": "<p>Hi, <br>\nI have an Encounter resource, with a coverage resource inside the contained.<br>\nI have searched in the documentation but i couldn't find any about this, how do you do this?.</p>\n<p>Thanks in advance</p>",
        "id": 227005495,
        "sender_full_name": "Juan Manuel Caputo",
        "timestamp": 1613758845
    },
    {
        "content": "<p>First, 'contained' should only be used if the information can't exist as stand-alone.  I.e. the Coverage information is only captured, stored and maintained in the context of the Encounter and has no existence outside of that.  It's <em>not</em> a handy mechanism for sending a bunch of resources at once.</p>\n<p>If you meet the requirement for a contained resource, then the only requirement is that the Encounter points to the Coverage or the Coverage points to the Encounter.</p>\n<p>If that doesn't answer what you need, can you further expand on your question?</p>",
        "id": 227007464,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613759761
    },
    {
        "content": "<p>Loyd, thank you very much for you answer.  Im writing a IG using FHIR shorthand, and I'd like to know how to generate a resource with a contained, in a Fish File.<br>\nGreetings</p>",
        "id": 227274306,
        "sender_full_name": "Juan Manuel Caputo",
        "timestamp": 1614004202
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"365661\">@Juan Manuel Caputo</span>.  In FSH, you can create an instance for use in a <code>contained</code> like so:</p>\n<div class=\"codehilite\"><pre><span></span><code>Instance: CoverageExample\nInstanceOf: Coverage\nUsage: #inline\n* status = #active\n* beneficiary = Reference(PatientExample)\n* payor = Reference(PayorOrganizationExample)\n</code></pre></div>\n<p>The <code>Usage: #inline</code> indicates that this instance should only be used inline in another resource (not a standalone resource).  Then to add it to <code>contained</code> in another instance, you can do this:</p>\n<div class=\"codehilite\"><pre><span></span><code>* contained = CoverageExample\n</code></pre></div>\n<p>and then reference it in that same resource as <code>Reference(CoverageExample)</code>.</p>\n<p>I've worked out a full example for you here: <a href=\"https://fshschool.org/FSHOnline/#/share/3aFKZyQ\">https://fshschool.org/FSHOnline/#/share/3aFKZyQ</a></p>",
        "id": 227277580,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1614005503
    },
    {
        "content": "<p>BTW -- if you have further questions about FHIR Shorthand, the #shorthand stream is the best place to ask them!</p>",
        "id": 227277918,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1614005624
    },
    {
        "content": "<p>(<span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> Just passing by this thread but also found your example really useful so thanks for that!)</p>",
        "id": 227397127,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1614069414
    }
]