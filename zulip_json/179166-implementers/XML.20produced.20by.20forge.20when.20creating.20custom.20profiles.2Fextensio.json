[
    {
        "content": "<p>I am looking to do the following</p>\n<p>1) Create profiles in forge<br>\n2) Put the profiles/exts in simplifier<br>\n3) Retrieve the profile from simplifier using the C# FHIR API in an object with information about the profile and extensions, e.g. which valueset the extension is bound to, data types etc. </p>\n<p>all the above works fine if I try with an existing (non custom) profile in simplifier, such as <a href=\"https://simplifier.net/Profile/AllergyIntolerance\" target=\"_blank\" title=\"https://simplifier.net/Profile/AllergyIntolerance\">https://simplifier.net/Profile/AllergyIntolerance</a></p>\n<p>However if I create custom profiles and extensions, based on my findings,  there seems to be a difference in the way that Forge produces XML when using custom profiles and extensions, compared to the XML in the existing ones. For example an existing profile (<a href=\"https://simplifier.net/Profile/AllergyIntolerance\" target=\"_blank\" title=\"https://simplifier.net/Profile/AllergyIntolerance\">https://simplifier.net/Profile/AllergyIntolerance</a>) contains a link to a value set:</p>\n<p>&lt;element&gt;<br>\n      &lt;path value=\"AllergyIntolerance.reaction.severity\" /&gt;<br>\n      &lt;short value=\"mild | moderate | severe (of event as a whole)\" /&gt;<br>\n      &lt;definition value=\"Clinical assessment of the severity of the reaction event as a whole, potentially considering multiple different manifestations.\" /&gt;<br>\n      &lt;comments value=\"It is acknowledged that this assessment is very subjective. There may be some some specific practice domains where objective scales have been applied. Objective scales can be included in this model as extensions.\" /&gt;<br>\n      &lt;min value=\"0\" /&gt;<br>\n      &lt;max value=\"1\" /&gt;<br>\n      &lt;type&gt;<br>\n        &lt;code value=\"code\" /&gt;<br>\n      &lt;/type&gt;<br>\n      &lt;isSummary value=\"true\" /&gt;<br>\n      &lt;binding&gt;<br>\n        &lt;strength value=\"required\" /&gt;<br>\n        &lt;description value=\"Clinical assessment of the severity of a reaction event as a whole, potentially considering multiple different manifestations.\" /&gt;<br>\n        &lt;valueSetReference&gt;<br>\n          &lt;reference value=\"<a href=\"http://hl7.org/fhir/ValueSet/reaction-event-severity\" target=\"_blank\" title=\"http://hl7.org/fhir/ValueSet/reaction-event-severity\">http://hl7.org/fhir/ValueSet/reaction-event-severity</a>\" /&gt;<br>\n        &lt;/valueSetReference&gt;<br>\n      &lt;/binding&gt;<br>\n    &lt;/element&gt;</p>\n<p>but when I make a profile, referencing an extension bound to a valueset with forge it produces </p>\n<p>&lt;element&gt;<br>\n      &lt;path value=\"Basic.extension\" /&gt;<br>\n      &lt;name value=\"SomeValueSetExtension\" /&gt;<br>\n      &lt;short value=\"Base for all elements\" /&gt;<br>\n      &lt;definition value=\"Optional Extensions Element - found in all resources.\" /&gt;<br>\n      &lt;min value=\"1\" /&gt;<br>\n      &lt;max value=\"1\" /&gt;<br>\n      &lt;type&gt;<br>\n        &lt;code value=\"Extension\" /&gt;<br>\n        &lt;profile value=\"<a href=\"http://StructureDefinition/SomeValueSetExtension\" target=\"_blank\" title=\"http://StructureDefinition/SomeValueSetExtension\">http://StructureDefinition/SomeValueSetExtension</a>\" /&gt;<br>\n      &lt;/type&gt;<br>\n      &lt;binding&gt;<br>\n        &lt;strength value=\"example\" /&gt;<br>\n        &lt;valueSetUri value=\"<a href=\"http://hl7.org/fhir/ValueSet/allergyintolerance-substance-code\" target=\"_blank\" title=\"http://hl7.org/fhir/ValueSet/allergyintolerance-substance-code\">http://hl7.org/fhir/ValueSet/allergyintolerance-substance-code</a>\" /&gt;<br>\n      &lt;/binding&gt;<br>\n    &lt;/element&gt;</p>\n<p>using &lt;valueSetUri&gt; instead of &lt;valueSetReference&gt;</p>\n<p>If I manually reformat the XML in profiles created by forge then I can pull the profile using the C# API using</p>\n<p>location = new Uri( &lt;endpoint of profile&gt;)<br>\nStructureDefinition stdef = client.Read&lt;StructureDefinition&gt;(location);</p>\n<p>but if I just create the profiles with forge, upload to simlifer and retrieve using the same approach, then field such as which valueset the extension in the profile is restricted to are missing, meaning that I can't really use it like this without some extra XML reformatting, as this information is missing. </p>",
        "id": 153872337,
        "sender_full_name": "Chris Munro",
        "timestamp": 1487323748
    },
    {
        "content": "<p>Just below the field where you fill in the URL to the valueset, you can check a box to indicate this is a reference. If the box stays unchecked, Forge will make it a valueSetUri.</p>",
        "id": 153872339,
        "sender_full_name": "Mirjam Baltus",
        "timestamp": 1487325537
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193298\">@Chris Munro</span> Note that ElementDefinition.valueSet is a choice type element. The C# FHIR API maps such properties to a generic \"Element\" datatype. A client application has to cast that to a specific datatype in order to access the underlying value via a strongly-typed property. For binding.valueSet, you could try to cast to either a FhirUri or a ResourceReference. This is how Forge reads a profile, so the information is definitely not dropped; you just have to do a bit of extra effort to get to it.</p>",
        "id": 153872390,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1487329725
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span>  and <span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> </p>\n<p>Are there any example on simplifier, of custom profiles using custom extensions that are correct? It would help a lot to have an example as a reference</p>",
        "id": 153872393,
        "sender_full_name": "Chris Munro",
        "timestamp": 1487333038
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193298\">@Chris Munro</span> You could e.g. take a look at the profiles that are published onto Simplifier by Nictiz, a Dutch standards organization:<br>\n<a href=\"https://simplifier.net/NL-BasicComponents\" target=\"_blank\" title=\"https://simplifier.net/NL-BasicComponents\">https://simplifier.net/NL-BasicComponents</a></p>",
        "id": 153872394,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1487333320
    },
    {
        "content": "<p>This question is related more to the implementation of valuesets generally in Forge, but I felt it might be appropriate as part of this thread.<br>\nI would like more information on this as I'm not totally clear. In Forge for a MessageHeader, I have a valueset bound as attached with the IsResourceReference checkbox ticked. This produces xml as follows:-<br>\n      &lt;binding&gt;<br>\n        &lt;strength value=\"preferred\" /&gt;<br>\n        &lt;description value=\"One of the message events defined as part of FHIR.\" /&gt;<br>\n        &lt;valueSetReference&gt;<br>\n          &lt;reference value=\"<a href=\"http://hl7.org/fhir/ValueSet/message-events\" target=\"_blank\" title=\"http://hl7.org/fhir/ValueSet/message-events\">http://hl7.org/fhir/ValueSet/message-events</a>\" /&gt;<br>\n        &lt;/valueSetReference&gt;<br>\n      &lt;/binding&gt;<br>\nHowever, when I untick the IsResourceReference checkbox, the xml output is no different.<br>\nWhat would be a valid reason for ticking this checkbox?<br>\nWhat would be a valid reason for unchecking this tickbox and what impact should it have in the xml output from Forge? I am currently using the Orlando 2016 DSTU2 1.0 Version 0.9.3.5 Forge version.  <a href=\"/user_uploads/10155/B3FM10dxmYw2qYOfs6yweBeW/valueset.png\" target=\"_blank\" title=\"valueset.png\">valueset.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/B3FM10dxmYw2qYOfs6yweBeW/valueset.png\" target=\"_blank\" title=\"valueset.png\"><img src=\"/user_uploads/10155/B3FM10dxmYw2qYOfs6yweBeW/valueset.png\"></a></div>",
        "id": 153875720,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1489051359
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191594\">@Katie Wheatley</span> the IsResourceReference checkbox controls the datatype of the binding.value[x] element.<br>\nChecked = ResourceReference - serialized to a valueSetReference node<br>\nUnchecked = Uri - serialized to a valueSetUri node<br>\nAlso see:<br>\n<a href=\"https://www.hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.binding.valueSet_x_\" target=\"_blank\" title=\"https://www.hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.binding.valueSet_x_\">https://www.hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.binding.valueSet_x_</a></p>",
        "id": 153875750,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1489061422
    }
]