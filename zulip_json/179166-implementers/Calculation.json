[
    {
        "content": "<p>Hi all, which resource shall I use to calculate a particular quantity? For instance, calculating the corrected QT interval in an ECG profile.  Thank you</p>",
        "id": 153906926,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1505215455
    },
    {
        "content": "<p>Observation</p>",
        "id": 153906939,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1505226570
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  Bazett's formula to calculate corrected QT interval is  QTC = QT / âˆš RR. There are two variables QT and RR. Also, QT and RR have units (msec or sec). Which resource does this calculation? <a href=\"/user_uploads/10155/qI0LM2nj8jjx6TUT1YB4z_hX/qtc.PNG\" target=\"_blank\" title=\"qtc.PNG\">qtc.PNG</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/qI0LM2nj8jjx6TUT1YB4z_hX/qtc.PNG\" target=\"_blank\" title=\"qtc.PNG\"><img src=\"/user_uploads/10155/qI0LM2nj8jjx6TUT1YB4z_hX/qtc.PNG\"></a></div>",
        "id": 153907374,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1505307021
    },
    {
        "content": "<p>A Resource is a datastructure, it does no calculations whatsoever. In the Observation resource you can add multiple components, so you can choose to include either QT and RR or the derived QTC, or all three. But the actual calculation has to be done in the software that processes the Observation. You can check the bloodpressure example resource to see one with multiple components (systolic and diastolic blood pressure in this case).</p>",
        "id": 153907401,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1505313509
    },
    {
        "content": "<p>Are you wanting a resource to store the definition of the calculation?</p>",
        "id": 153907403,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1505314183
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span>  Thank you <br>\n<span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  Yes. Which resource shall I pick?</p>",
        "id": 153908967,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1505804489
    },
    {
        "content": "<p>Library would be the option if you're wanting to store it in a computable way.</p>",
        "id": 153909111,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1505850409
    },
    {
        "content": "<p>That said, storing a single calculation in a Library would be \"unusual\".  What is your objective?</p>",
        "id": 153909112,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1505850500
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  My intention is to store some calculations (similar to corrected QT interval) in a resource. How can I do that using the resource 'Library'?   Can I use the resource 'Measure' to calculate certain quantity and store the result in MeasureReport?  Thank you</p>",
        "id": 153909726,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1506000933
    },
    {
        "content": "<p>You want to store the calculated values or you want to store the formula?  MeasureReport is for quality measures not for arbitrary calculations</p>",
        "id": 153909740,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506007517
    },
    {
        "content": "<p>I want to store  formulae and the interpretation as well. <a href=\"/user_uploads/10155/XipapnKzW8WxeLPS7Xzrq_8J/calci.PNG\" target=\"_blank\" title=\"calci.PNG\">calci.PNG</a> The QTc interval is calculated in the screenshot and the interpretation is displayed. Therefore I need a resource which can store formulae and interpretation for the respective formulae.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/XipapnKzW8WxeLPS7Xzrq_8J/calci.PNG\" target=\"_blank\" title=\"calci.PNG\"><img src=\"/user_uploads/10155/XipapnKzW8WxeLPS7Xzrq_8J/calci.PNG\"></a></div>",
        "id": 153909897,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1506084625
    },
    {
        "content": "<p>Ok.  From the screen-shot, it looks like the storage of the formula is as a display string for consumption by a human reader, not as a computable artifact for machine execution.  Is that accurate?  Your screen looks like it's representing something we've been calling an ObservationDefinition - also known as an \"observation master file entry\".  It describes a test or observation that can be performed and relevant information about when/how/why the observation is done, how much it costs, etc.  Would that align with your use-case?</p>",
        "id": 153909930,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506091014
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  I need a resource which can store both the formula for the consumption of a human reader and also computable artifact for machine execution. May I know  what is ObservationDefinition?</p>",
        "id": 153910300,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1506344341
    },
    {
        "content": "<p>ObservationDefinition is a proposed new resource that would support defining types of observations that can exist.  It does not exist yet (and it's not clear whether it'll get done prior to R4 or not).  It's possible you might also be able to use ActivityDefinition, though I'm not sure if this use-case is in scope.  <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> ?</p>",
        "id": 153910442,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506350209
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Please suggest a resource which can store both the formula for the consumption of a human reader and also computable artifact for machine execution.</p>",
        "id": 153910881,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1506491326
    },
    {
        "content": "<p>Observation.text is for human consumption; all the rest of the resource is for machine execution...</p>",
        "id": 153910997,
        "sender_full_name": "John Moehrke",
        "timestamp": 1506522319
    },
    {
        "content": "<p>The only resource we have right now that <em>might</em> be a candidate is ActivityDefinition, but it's best to wait for guidance from <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> .  The alternative would be to define something in Basic.</p>",
        "id": 153911012,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506524328
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193568\">@Pranitha Sruthi</span> , as Lloyd suggested, you could use a Library to store the logic as a CQL expression. It does sound like an ActivityDefinition would work though, you are defining a possible observation with instructions for how to calculate it (if I understand the use case correctly). So, in that usage, you'd specify the calculation as a dynamicValue element. See the <a href=\"http://build.fhir.org/cqif/cqif-topics-using-expressions.html\" target=\"_blank\" title=\"http://build.fhir.org/cqif/cqif-topics-using-expressions.html\">Using Expressions</a> topic for more.</p>",
        "id": 153911017,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1506524811
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  Thank you<br>\n<span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> Ok  thank you<br>\n<span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  Thanks for your response. I have gone through the content.  How can I use the extension in my DiagnosticReport (ECG) profile?  I need to store the formula for the QTc interval and the computable artifact. Thank you</p>",
        "id": 153911206,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1506600232
    },
    {
        "content": "<p>So you'd capture the QTc as an Observation.  You'll need put a <a href=\"http://hl7.org/fhir/extension-event-definition.html\" target=\"_blank\" title=\"http://hl7.org/fhir/extension-event-definition.html\">http://hl7.org/fhir/extension-event-definition.html</a> extension on the Observation that points to the ActivityDefinition.  And then you put the formula in the ActivityDefinition.</p>",
        "id": 153911244,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506609450
    },
    {
        "content": "<p>Right, and in the ActivityDefinition, you would put the formula for the value as a dynamicValue element.</p>",
        "id": 153911431,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1506650556
    },
    {
        "content": "<p>so ActivityDefinition would also support operations on data, not only operations on activities?</p>",
        "id": 153911892,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1506975966
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  can the CQL expression handle the square root calculation?</p>",
        "id": 153911947,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1506994949
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  Is it not necessary to add the CQL extension?</p>",
        "id": 153912031,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1507021244
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span>, yes, the intent is to support dynamic calculation of values, including access to data in context.</p>",
        "id": 153912068,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1507039903
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span>, yes, just use the power, X ^ 0.5</p>",
        "id": 153912069,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1507040007
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193568\">@Pranitha Sruthi</span>, you only need to use the CQL extension for cases where the resources don't already have facilities to support expressions. The ActivityDefinition already has the dynamicValue attribute to support the extension. You could use the extension to describe the formula on the appropriate attributes in DiagnosticReport, but since it's instance-level, the only value in doing so would be descriptive. By using it on ActivityDefinition to describe how to build a DiagnosticReport, you provide a way to share the calculation.</p>",
        "id": 153912070,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1507040270
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/vIox20V2iwvZy0zavp8OHlRQ/expression.PNG\" target=\"_blank\" title=\"expression.PNG\">expression.PNG</a> <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>   I have mentioned the formula in the expression element as in the screenshot. Is that correct?</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/vIox20V2iwvZy0zavp8OHlRQ/expression.PNG\" target=\"_blank\" title=\"expression.PNG\"><img src=\"/user_uploads/10155/vIox20V2iwvZy0zavp8OHlRQ/expression.PNG\"></a></div>",
        "id": 153912218,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1507092772
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193568\">@Pranitha Sruthi</span> yes, that's correct, but you need to express QT and RR in terms of the attributes of the Observation, right?</p>",
        "id": 153912894,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1507325406
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  Yes. How can I do that?</p>",
        "id": 153912952,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1507376325
    },
    {
        "content": "<p>Do I need to install the cql software?</p>",
        "id": 153912953,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1507376349
    },
    {
        "content": "<p>Where are QT and RR represented in the Observation?</p>",
        "id": 153912974,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1507416043
    },
    {
        "content": "<p>Can they be interpreted independently?  If so, they'd be separate observations.  Otherwise they'd be components</p>",
        "id": 153912991,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1507472646
    },
    {
        "content": "<p>How can I represent QT interval and RR rate in the QTc profile (Observation)?</p>",
        "id": 153913008,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1507528909
    },
    {
        "content": "<p>I think I answered that in the prvious post in this thread?</p>",
        "id": 153913113,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1507556792
    },
    {
        "content": "<p>Yes but which method shall I use?  Are they 'components' or independant profiles?</p>",
        "id": 153913114,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1507556873
    },
    {
        "content": "<p>Do you understand what a QT interval and RR rate are?  Do you know if they can be interpretted independently?</p>",
        "id": 153913117,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1507557261
    },
    {
        "content": "<p>They are measurements made from the recorded ECG. I.e.,  The \"QT\" is the interval measured between the \"Q\" and the \"T\" part of the waveform (The waveform has specifically labeled parts). It is a measure of how well the heart is recovering from the work it just did. It is a measurement, but each heart-beat has a QT. And there is some interpretation of where exactly the Q and T are. Which is why the waveform needs to be scalable so that the human cardiologist can use their own diagnostic viewer calipers.</p>",
        "id": 153913327,
        "sender_full_name": "John Moehrke",
        "timestamp": 1507647915
    },
    {
        "content": "<p>Ok - and are the QT and RR typically examined and useful on their own?</p>",
        "id": 153913358,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1507660939
    },
    {
        "content": "<p>Hi, <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  I have created a profile for the QTc calculation (formula) using the ActivityDefinition resource (as per your instructions). I have modified only the 'dynamicValue' element. Kindly check the screenshots for any mistakes. <a href=\"/user_uploads/10155/07dFfm8TJmZOE8UkRfwJJtt1/language.PNG\" target=\"_blank\" title=\"language.PNG\">language.PNG</a> <a href=\"/user_uploads/10155/LgXABXTdXBU3xRr4oY5jvxS5/expression.PNG\" target=\"_blank\" title=\"expression.PNG\">expression.PNG</a> <a href=\"/user_uploads/10155/zIZZKCnCDNgoGQvKWaYbQKdP/path.PNG\" target=\"_blank\" title=\"path.PNG\">path.PNG</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/07dFfm8TJmZOE8UkRfwJJtt1/language.PNG\" target=\"_blank\" title=\"language.PNG\"><img src=\"/user_uploads/10155/07dFfm8TJmZOE8UkRfwJJtt1/language.PNG\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/10155/LgXABXTdXBU3xRr4oY5jvxS5/expression.PNG\" target=\"_blank\" title=\"expression.PNG\"><img src=\"/user_uploads/10155/LgXABXTdXBU3xRr4oY5jvxS5/expression.PNG\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/10155/zIZZKCnCDNgoGQvKWaYbQKdP/path.PNG\" target=\"_blank\" title=\"path.PNG\"><img src=\"/user_uploads/10155/zIZZKCnCDNgoGQvKWaYbQKdP/path.PNG\"></a></div>",
        "id": 153919650,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510738020
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"193568\">@Pranitha Sruthi</span> , I think this is mixing the type/instance distinction. ActivityDefinition is already at the type level, so what's needed here isn't a profile on ActivityDefinition, but an instance of an ActivityDefinition that specifies how to construct an Observation. Does that make sense?</p>",
        "id": 153919709,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1510751036
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span>  Sorry I don't know. Which one of them do you recommend?</p>",
        "id": 153919711,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510751211
    },
    {
        "content": "<p>Well, what I'm saying is that you don't need to define a profile, you need to define an ActivityDefinition.</p>",
        "id": 153919713,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1510751554
    },
    {
        "content": "<p>Ok. How can I do that?</p>",
        "id": 153919714,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510751682
    },
    {
        "content": "<p>You'll need to manually create an XML or JSON instance.  There's no authoring tool for ActivityDefinitions that I'm aware of yet.  (Though you can and should use a tool that at least supports schema validation of your XML or JSON instance.)</p>",
        "id": 153919715,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510751778
    },
    {
        "content": "<p>Can I use clinFHIR?</p>",
        "id": 153919716,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510751872
    },
    {
        "content": "<p>I don't know if it supports ActivityDefinition yet - <span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> ?</p>",
        "id": 153919717,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510751946
    },
    {
        "content": "<p>Well, you should be able to build an instance of the ActivityType in the Scenario Builder (though I've not tries specifically). Was there something more that you wanted to do with it?</p>",
        "id": 153919729,
        "sender_full_name": "David Hay",
        "timestamp": 1510756705
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span>  I have used Scenario Builder to create an instance for the ActivityDefinition. I need to add the formula for corrected QT interval of an ECG waveform.<br>\n  {<br>\n  \"path\": \"QTc Interval\",<br>\n  \"language\": \"text/cql\",<br>\n  \"expression\": \"QT / RR^0.5\"<br>\n}<br>\nI have edited the dynamicValue element of the resource. Is the above mentioned format correct?</p>",
        "id": 153919895,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510814194
    },
    {
        "content": "<p>Path needs to resolve to an element of the target resource. So if the ActivityDefinition is a template for an Observation, then the path would need to resolve to an element of an Observation, most likely \"value\", right? You're defining the expression for calculating the value of the Observation?</p>",
        "id": 153919924,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1510821330
    },
    {
        "content": "<p>Ok. Should I mention the URL of the target Observation in the 'path'?</p>",
        "id": 153919925,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510821533
    },
    {
        "content": "<p>No, it's a relative path expressed from the root of the target resource.</p>",
        "id": 153919931,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1510823824
    },
    {
        "content": "<p>Do you mean the location of the target resource?</p>",
        "id": 153919932,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510823934
    },
    {
        "content": "<p>No, just the target resource. Think of an ActivityDefinition is a set of instructions for constructing a resource. When you follow those instructions, you get an instance of a resource. That instance is what I'm calling the target here.</p>",
        "id": 153919933,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1510824012
    },
    {
        "content": "<p>Can you give an example for the path?</p>",
        "id": 153919935,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510824746
    },
    {
        "content": "<p>Sure, path in this case should be <code>value</code>. You could say <code>valueQuantity</code> if you wanted to delineate the target type, but <code>value</code> is the target element.</p>",
        "id": 153919956,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1510826803
    },
    {
        "content": "<p>Because what you're building is an Observation, and you're calculating the value of the Observation, right?</p>",
        "id": 153919957,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1510826826
    },
    {
        "content": "<p>Yes. As the result of the calculation would be a numerical quantity (number), the path has to be mentioned as 'value'.</p>",
        "id": 153919959,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1510827171
    },
    {
        "content": "<p>Hi all, which one of the following is a better approach for calculating a particular quantity using a specific formula<br>\n1. with the help of  a mobile client  or<br>\n2. with the help of a cql executor?<br>\nThank you</p>",
        "id": 153933415,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1517320356
    }
]