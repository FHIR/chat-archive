[
    {
        "content": "<p>Hi...I'm hitting an issue with variant nomenclature not validating. Using an example from mCODE, which I understand used to validate, I get this error:</p>\n<blockquote>\n<p>None of the codes provided are in the value set <a href=\"http://hl7.org/fhir/us/mcode/ValueSet/mcode-hgvs-vs\">http://hl7.org/fhir/us/mcode/ValueSet/mcode-hgvs-vs</a> (<a href=\"http://hl7.org/fhir/us/mcode/ValueSet/mcode-hgvs-vs\">http://hl7.org/fhir/us/mcode/ValueSet/mcode-hgvs-vs</a>), and a code from this value set is required) (codes = http://varnomen.hgvs.org#NC_000019.8:g.1171707G&gt;A)</p>\n</blockquote>\n<p>The full output from the validator .jar, including version numbers of everything is here: <a href=\"https://gist.github.com/masnick/30bf1eb03cc13ce68e6d4f06c2a52e3d\">https://gist.github.com/masnick/30bf1eb03cc13ce68e6d4f06c2a52e3d</a>. Any help would be appreciated. Thanks!</p>",
        "id": 206177749,
        "sender_full_name": "Max Masnick",
        "timestamp": 1596737883
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"322501\">@Max Masnick</span> I think this is simply the fact that the terminology server used by the validator doesn't know or have access to the code system <a href=\"http://varnomen.hgvs.org\">http://varnomen.hgvs.org</a>. To make matters even less clear, HGVS is more a naming <em>algorithm</em> than a finite set of codes. To even begin to solve this, we would have to have an algorithm to validate HGVS names, and have a way to embed the algorithm within the terminology server (that currently only stores lists of codes).</p>",
        "id": 206456431,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1597063812
    },
    {
        "content": "<p>Seems like a couple of different issues: 1) modeling, 2) fhir validator tooling.  1) for modeling, there are a number of use cases where codeableConcept references not necessarily a fully defined terminology of codes and terms but a naming system with a binding that's <code>extensible</code>- for example HGVS as found in the Genomics Reporting IG and mCODE IG.  2) if the validator points to a terminology server which doesn't handle naming systems and the validator expects a match of a code, then how should the validator handle this?  Should it remain an explainable error, or could we loosen this message to a warning level?  <br>\nWe had earlier versions of the FHIR validator that didn't flag an error on this and I'm concerned that it will pose a challenge if we release a technical errata and it gets rejected because of this discrepancy.  cc: <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> since I think this affects both mCODE and the Genomics Reporting IG.</p>",
        "id": 206459048,
        "sender_full_name": "May Terry",
        "timestamp": 1597065485
    },
    {
        "content": "<p>Good explanation, yes hgvs is a grammar like ucum. This can be expressed as a CS.</p>",
        "id": 206459520,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1597065779
    },
    {
        "content": "<p>If the terminology backend doesn't know the CS there are three choices:</p>\n<ul>\n<li>give a info/warning that this couldn't be validated.</li>\n<li>throw an error as it couldn't be validated.</li>\n<li>ignore the validation for this CS<br>\nThis is up to the server implementer.</li>\n</ul>",
        "id": 206459920,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1597066023
    },
    {
        "content": "<p>Agreed. I guess I'm trying to ensure that we don't get dinged on technical errata releases because the examples are now throwing an error and failing validation.</p>",
        "id": 206460144,
        "sender_full_name": "May Terry",
        "timestamp": 1597066157
    },
    {
        "content": "<p>I think the validator shouldn't throw errors on missing CS, or have this being configurable. There are plenty of usecases where no complete CS/Terminology Servers are available.</p>",
        "id": 206460474,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1597066364
    },
    {
        "content": "<p>hmm. I'll investigate. On the whole I agree for this case. I'm not sure about some other cases that present the same to the validator</p>",
        "id": 206501979,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597087268
    },
    {
        "content": "<p>what's the source being validated above?</p>",
        "id": 206511839,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597092789
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> the file I was trying to validate is <a href=\"http://hl7.org/fhir/us/mcode/Observation-mCODECancerGeneticVariantExample01.xml\">http://hl7.org/fhir/us/mcode/Observation-mCODECancerGeneticVariantExample01.xml</a>. Thanks for looking into this!</p>",
        "id": 206680815,
        "sender_full_name": "Max Masnick",
        "timestamp": 1597229924
    },
    {
        "content": "<p>if you were a non-fhir user, and you wanted to know whether an hgvs code was valid, what would you do?</p>",
        "id": 206681492,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597230473
    },
    {
        "content": "<p><a href=\"https://variantvalidator.org/service/validate/\">https://variantvalidator.org/service/validate/</a> thinks it's not valid...</p>",
        "id": 206681614,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597230570
    },
    {
        "content": "<p>One way to do it is to look at the variant on ClinVar (<a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/619728/\">https://www.ncbi.nlm.nih.gov/clinvar/variation/619728/</a>) based on the ClinVar code in the instance, and I would assume that anything listed under HGVS would be valid.</p>\n<p>In this case NC_000019.8:g.1171707G&gt;A is not listed on ClinVar so maybe that's a bad example (and should be changed in the example instance). </p>\n<p>However, I did hit the same error with this file here, which is using a HGVS value from ClinVar that validates with <a href=\"http://variantvalidator.org\">variantvalidator.org</a>: <a href=\"https://gist.githubusercontent.com/masnick/30bf1eb03cc13ce68e6d4f06c2a52e3d/raw/1fcd9e653e6b5f20a615cc19068b93c40bf9de5d/another_example.json\">https://gist.githubusercontent.com/masnick/30bf1eb03cc13ce68e6d4f06c2a52e3d/raw/1fcd9e653e6b5f20a615cc19068b93c40bf9de5d/another_example.json</a></p>",
        "id": 206682216,
        "sender_full_name": "Max Masnick",
        "timestamp": 1597231107
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> here's the ClinVar link for reference: <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/128144/\">https://www.ncbi.nlm.nih.gov/clinvar/variation/128144/</a></p>\n<p>The variant is NC_000016.10:g.23603471G&gt;T</p>",
        "id": 206682365,
        "sender_full_name": "Max Masnick",
        "timestamp": 1597231242
    },
    {
        "content": "<p>This is the error I get with another_example.json:</p>\n<div class=\"codehilite\"><pre><span></span><code>Error @ Observation.component[2].value.ofType(CodeableConcept) (line 107, col28) : None of the codes provided are in the value set http://hl7.org/fhir/us/mcode/ValueSet/mcode-hgvs-vs (http://hl7.org/fhir/us/mcode/ValueSet/mcode-hgvs-vs), and a code from this value set is required) (codes = http://varnomen.hgvs.org#NC_000016.10:g.23603471G&gt;T)\n</code></pre></div>",
        "id": 206682988,
        "sender_full_name": "Max Masnick",
        "timestamp": 1597231759
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"322501\">@Max Masnick</span> - We see this sort of error in the <a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/\">Genomics Reporting IG</a> quite often for HGVS and other code systems that are not yet supported.  For now, we have ignored the errors, but would love to do something to get these code systems supported.  I know <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> is supportive of that, but no one has had the time to make that happen just yet.  As <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> mentioned above, perhaps the validator should not be treating something like this as an error, or perhaps it could be suppressed by the IG?</p>\n<p>This might be more than you really want, but the CG group (<a class=\"stream\" data-stream-id=\"179197\" href=\"/#narrow/stream/179197-genomics\">#genomics</a> ) started cataloging a variety of tools that will perform this sort of HGVS validation, and you can see that list <a href=\"https://docs.google.com/document/d/1hqcs7l638RCytkwRXStSr18H49vZE5U5QXyL4zXF5es/edit\">here</a>.</p>\n<p>There are a few details in that document, but not near enough.  Suffice it to say that each of these tools have limitations.  We can <strong>broadly</strong> categorize into two parts:<br>\n1 - Syntax, which can be done <a href=\"https://mutalyzer.nl/syntax-checker\">here</a> and is mostly straightforward.<br>\n2 - Semantics (do the parts make sense together - is the ref seq + version valid, is the ref allele indicated accurate, etc..), which to do well is difficult, and is where differences emerge between the various tools.</p>\n<p>If we were to start somewhere, updating the validator to perform syntax validation for HGVS would be a nice start.  Much beyond that will be hard.</p>",
        "id": 206704232,
        "sender_full_name": "Kevin Power",
        "timestamp": 1597243917
    },
    {
        "content": "<p>ok, so from the next release of the IG Publisher, the error will change to the warning, but you won't notice because also HGVS codes will be validated by the multilyzer, though of course it only checks syntax, not semantics. If any one finds a trustworthy semantic checker, let me know</p>",
        "id": 206768184,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597276945
    },
    {
        "content": "<p>Thanks all! <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>, does the change to the IG Publisher also apply to the FHIR Validator? Or is that a separate codebase?</p>",
        "id": 206768494,
        "sender_full_name": "Max Masnick",
        "timestamp": 1597277259
    },
    {
        "content": "<p>same code base. in fact, all the changes were in the validator</p>",
        "id": 206768520,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597277282
    }
]