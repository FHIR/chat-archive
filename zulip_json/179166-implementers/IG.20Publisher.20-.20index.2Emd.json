[
    {
        "content": "<p>I'm trying to rebuild v1.5 of the bulk data IG on top of the base provided by the sample-ig repo. However, when I change the index.html file in pagecontent directory to an index.md file, I get the following build error:</p>\n<div class=\"codehilite\"><pre><span></span><code>java.lang.Exception: Template based HTML file index.html is missing source file index.xml\n    at org.hl7.fhir.igtools.publisher.Publisher.applyPageTemplate(Publisher.java:5991)\n    at org.hl7.fhir.igtools.publisher.Publisher.applyPageTemplate(Publisher.java:6005)\n    at org.hl7.fhir.igtools.publisher.Publisher.generateSummaryOutputs(Publisher.java:5850)\n    at org.hl7.fhir.igtools.publisher.Publisher.generate(Publisher.java:4910)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:888)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:732)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:8414)\n</code></pre></div>\n<p>I thought the index page could be markdown - is there a setting somewhere I need to change? Thanks!</p>",
        "id": 220635544,
        "sender_full_name": "Dan Gottlieb",
        "timestamp": 1608587989
    },
    {
        "content": "<p>Is it referenced in your IG as a page?</p>",
        "id": 220636016,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1608588254
    },
    {
        "content": "<p>yes the index page can be markdown.</p>\n<p>verify the information is correct in the IG resource:</p>\n<p>here is an example: </p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nn\">...</span>\n    <span class=\"p p-Indicator\">-</span>   <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">url</span>\n        <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">https://confluence.hl7.org/display/AP/Argonaut+Project+Home</span>\n<span class=\"nt\">definition</span><span class=\"p\">:</span>\n    <span class=\"nt\">page</span><span class=\"p\">:</span>\n        <span class=\"nt\">generation</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">html</span>\n        <span class=\"nt\">nameUrl</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">toc.html</span>\n        <span class=\"nt\">page</span><span class=\"p\">:</span>\n        <span class=\"p p-Indicator\">-</span>   <span class=\"nt\">generation</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">markdown</span>  <span class=\"c1\"># &lt;&lt;&lt;&lt;&lt;&lt; indicate is markdown here</span>\n            <span class=\"nt\">nameUrl</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">index.html</span>\n            <span class=\"nt\">title</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Home</span>\n        <span class=\"nt\">title</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Table of Contents</span>\n    <span class=\"nt\">parameter</span><span class=\"p\">:</span>\n    <span class=\"p p-Indicator\">-</span>   <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">copyrightyear</span>\n<span class=\"l l-Scalar l-Scalar-Plain\">....</span>\n</code></pre></div>",
        "id": 220636087,
        "sender_full_name": "Eric Haas",
        "timestamp": 1608588322
    },
    {
        "content": "<p>Ah, the generation param is the <em>input</em> format - I had assumed it was the <em>output</em> format. Thanks Eric!</p>",
        "id": 220636383,
        "sender_full_name": "Dan Gottlieb",
        "timestamp": 1608588523
    },
    {
        "content": "<p>Btw, do you know if these items are documented somewhere?</p>",
        "id": 220636404,
        "sender_full_name": "Dan Gottlieb",
        "timestamp": 1608588544
    },
    {
        "content": "<p>Specifically, I'm trying to figure out how to replicate the following features with the current version of the IG Publisher:</p>\n<ol>\n<li>Build page paths in subdirectories like /export/index.html to avoid breaking people's links (I tried using the path as the nameUrl and nesting page elements, neither of which seemed to work, and all the IGs I looked at just use a flat structure in the pagecontent directory)</li>\n<li>Include  files in these subdirectories that get deployed with the IG like <a href=\"https://hl7.org/fhir/uv/bulkdata/authorization/sample-jwks/RS384.public\">https://hl7.org/fhir/uv/bulkdata/authorization/sample-jwks/RS384.public</a> (the publisher seems to object to these since they're not md or xml)</li>\n<li>Add the SMART logo to the header (I tried updating /template/includes/fragment-header.html, but it gets overridden by the template value in ig.ini of hl7.fhir.template)</li>\n<li>Add Boston Children's joint copyright to footer (I tried updating /template/includes/pageend.html, but it gets overridden by the template value in ig.ini of hl7.fhir.template as well)</li>\n</ol>",
        "id": 220638012,
        "sender_full_name": "Dan Gottlieb",
        "timestamp": 1608589560
    },
    {
        "content": "<ol>\n<li>Why do you want that structure not to be flat? I don't think it is possible but I may be wrong</li>\n</ol>",
        "id": 220645429,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1608595400
    },
    {
        "content": "<p>3 and 4 require a template customization.</p>",
        "id": 220645462,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1608595436
    },
    {
        "content": "<p>Not sure this helps: <a href=\"http://build.fhir.org/ig/FHIR/ig-guidance/template.html\">http://build.fhir.org/ig/FHIR/ig-guidance/template.html</a></p>",
        "id": 220645638,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1608595591
    },
    {
        "content": "<ol>\n<li>The publisher does not allow sub-folders for generated content.  It was just too messy to get cross-links to work properly.  All links need to presume all generated pages are in the same (root) folder.</li>\n<li>The only way to get files put anywhere other than the root is if they're defined in the template</li>\n<li>Take a look at how to create your own override template here: <a href=\"https://github.com/HL7/fhir-cdisc-mapping\">https://github.com/HL7/fhir-cdisc-mapping</a></li>\n<li>Seeing how the header gets overridden in #3 should give you an idea of how to override the footer too.  You might actually want to define a 'standard' template for Boston Children's that could be used by multiple IGs - check out the Da Vinci template here: <a href=\"https://github.com/HL7/ig-template-davinci\">https://github.com/HL7/ig-template-davinci</a></li>\n</ol>",
        "id": 220656861,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1608609703
    },
    {
        "content": "<p>actually I think for </p>\n<p>2) put the sample jwks them in the images folder and can reference them and include them directly from the output directory, for example...  <a href=\"https://argonautproject.github.io/patient-lists/cat.jpg\">https://argonautproject.github.io/patient-lists/cat.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"https://argonautproject.github.io/patient-lists/cat.jpg\"><img src=\"https://argonautproject.github.io/patient-lists/cat.jpg\"></a></div><p><a href=\"/user_uploads/10155/NmDHYWETqToReo4u3hJ5k7Yy/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/NmDHYWETqToReo4u3hJ5k7Yy/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/NmDHYWETqToReo4u3hJ5k7Yy/image.png\"></a></div>",
        "id": 220657499,
        "sender_full_name": "Eric Haas",
        "timestamp": 1608610814
    },
    {
        "content": "<p>sadly for 3) and 4) the the current templates don't allow for a secondary sponsoring org link besides HL7.  I think its a lot to ask for folks to create new templates to add a cosponsor to an HL7 guide.  maybe we can add a parameter for a cosponsorship and tweak the standard templates?</p>",
        "id": 220657692,
        "sender_full_name": "Eric Haas",
        "timestamp": 1608611143
    },
    {
        "content": "<p>for 1)   I see how it makes sense from a  web publishing perspective and allows the file structure to follow the web page structure.  IN practice, I found that devilishly tricky in Jekyll even before the templates when publishing the SMART launch guide probably due to the ig-publisher trying to flatten everything out in the temp file.  :-(</p>",
        "id": 220657864,
        "sender_full_name": "Eric Haas",
        "timestamp": 1608611377
    },
    {
        "content": "<p>Ah, I missed that this was for an HL7 IG.  The copyright can be overridden by an IG-specific template folder declared within the IG - as CDISC did.</p>",
        "id": 220663080,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1608619213
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> , <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  and <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> ! To summarize my understanding (please correct me if I'm wrong):</p>\n<ol>\n<li>Sub-folders are no longer supported in the IG builder - I'll move the IG to a flat structure. I was  hoping to keep the hierarchical structure from the STU1 publication to maintain people's inbound links, but perhaps some redirect magic can be done on the HL7 server config to facilitate this when we deploy the new version post-ballot?</li>\n<li>Putting these artifacts in the images folder works! Same issue as #1 with external inbound links breaking though.</li>\n<li>(and 4) I've added an IG template folder (per the super helpful CDISC example) and down the road we can look at extracting that into an external SMART template (per DaVinci) if there are other use cases.</li>\n</ol>",
        "id": 220709365,
        "sender_full_name": "Dan Gottlieb",
        "timestamp": 1608655325
    },
    {
        "content": "<ol>\n<li>I don't think they ever were supported?</li>\n</ol>",
        "id": 220727818,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1608666865
    },
    {
        "content": "<p>I'm not sure if they are officially supported :), but they're being used in<br>\n<a href=\"https://github.com/HL7/bulk-data/tree/master/spec\">https://github.com/HL7/bulk-data/tree/master/spec</a> and seem to build ok at <a href=\"http://build.fhir.org/ig/HL7/bulk-data/\">http://build.fhir.org/ig/HL7/bulk-data/</a></p>",
        "id": 220732922,
        "sender_full_name": "Dan Gottlieb",
        "timestamp": 1608670309
    },
    {
        "content": "<p>use in SMART launch as well.</p>",
        "id": 220760465,
        "sender_full_name": "Eric Haas",
        "timestamp": 1608697948
    },
    {
        "content": "<blockquote>\n<p>Sub-folders are no longer supported in the IG builder</p>\n</blockquote>\n<p>This has got nothing to do with the IG publisher - it's up to the template.</p>",
        "id": 220762168,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1608700801
    },
    {
        "content": "<p>How does the template influence anything?  Is the issue that all sub-folders need to be specifically identified by parameter in the IG?</p>",
        "id": 220794916,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1608734996
    },
    {
        "content": "<p>here is a typical template ('_layout' in Jekyll speak) in the life of a pre template ig using nested page directories....</p>\n<div class=\"codehilite\" data-code-language=\"HTML\"><pre><span></span><code><span class=\"c\">&lt;!-- this liquidi is  to get the internal relative references to work --&gt;</span>\n{% assign base = '' %}\n{% assign depth = page.url | split: '/' | size  %}\n{% if depth == 2 %}{% assign base = '../' %}\n{% elsif depth == 3 %}{% assign base = '../../' %}\n{% elsif depth == 4 %}{% assign base = '../../../' %}\n{% endif %}\n\n{% if page.template %}\n{% assign base = '' %}\n{% endif %}\n\n<span class=\"cp\">&lt;!DOCTYPE html&gt;</span>\n<span class=\"c\">&lt;!-- saved from url=(0043)http://hl7.org/fhir/2016May/FHIRPath.html --&gt;</span>\n<span class=\"p\">&lt;</span><span class=\"nt\">html</span><span class=\"p\">&gt;&lt;</span><span class=\"nt\">head</span><span class=\"p\">&gt;&lt;</span><span class=\"nt\">meta</span> <span class=\"na\">http-equiv</span><span class=\"o\">=</span><span class=\"s\">\"Content-Type\"</span> <span class=\"na\">content</span><span class=\"o\">=</span><span class=\"s\">\"text/html; charset=UTF-8\"</span><span class=\"p\">/&gt;</span>\n\n\n  <span class=\"p\">&lt;</span><span class=\"nt\">title</span><span class=\"p\">&gt;</span>{{page.title}}<span class=\"p\">&lt;/</span><span class=\"nt\">title</span><span class=\"p\">&gt;</span>\n\n  <span class=\"p\">&lt;</span><span class=\"nt\">meta</span> <span class=\"na\">content</span><span class=\"o\">=</span><span class=\"s\">\"width=device-width, initial-scale=1.0\"</span> <span class=\"na\">name</span><span class=\"o\">=</span><span class=\"s\">\"viewport\"</span><span class=\"p\">/&gt;</span>\n  <span class=\"p\">&lt;</span><span class=\"nt\">meta</span> <span class=\"na\">content</span><span class=\"o\">=</span><span class=\"s\">\"http://hl7.org/fhir\"</span> <span class=\"na\">name</span><span class=\"o\">=</span><span class=\"s\">\"author\"</span><span class=\"p\">/&gt;</span>\n\n  <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"stylesheet\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}dist/fhir.css\"</span><span class=\"p\">/&gt;</span>  <span class=\"c\">&lt;!-- THEN use  {{base}} in here everwhere to keep all the nesting straight--&gt;</span>\n  <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"Prev\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}history/index.md\"</span><span class=\"p\">/&gt;</span>\n\n    <span class=\"c\">&lt;!-- Bootstrap core CSS --&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"stylesheet\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}dist/bootstrap.css\"</span><span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"stylesheet\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}dist/bootstrap-fhir.css\"</span><span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"stylesheet\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}dist/bootstrap-glyphicons.css\"</span><span class=\"p\">/&gt;</span>\n\n    <span class=\"c\">&lt;!-- Project extras --&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"stylesheet\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}dist/project.css\"</span><span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"stylesheet\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}dist/pygments-manni.css\"</span><span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">link</span> <span class=\"na\">rel</span><span class=\"o\">=</span><span class=\"s\">\"stylesheet\"</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"{{base}}dist/jquery-ui.css\"</span><span class=\"p\">/&gt;</span>\n\n....\n</code></pre></div>",
        "id": 220803589,
        "sender_full_name": "Eric Haas",
        "timestamp": 1608740963
    },
    {
        "content": "<p>Like I said above, I had struggled with this and found it a pain to get the relative reference and  includes that were in another directory to work, so I personally prefer flat directories  since the temp flattens everything anyway. (  I don't believe that is how Jekyll out of the box works)</p>",
        "id": 220804006,
        "sender_full_name": "Eric Haas",
        "timestamp": 1608741238
    },
    {
        "content": "<p>right. sub-folders are painful. but it's the template that decides how the files are laid out (in the config). the IG publisher just does what the template says</p>",
        "id": 220814287,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1608747927
    },
    {
        "content": "<p>I'm still not really understanding.  The template points to the folder that holds 'pages'.  What does the template need to do to have the IGPublisher process sub-folders within that folder/those folders?</p>",
        "id": 220815046,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1608748434
    },
    {
        "content": "<p>the template decides how the resources are generated</p>",
        "id": 220816075,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1608749069
    },
    {
        "content": "<p>I don't think this is about generating resources, it's about retaining hierarchy of pages?</p>",
        "id": 220824840,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1608755605
    },
    {
        "content": "<p>Flat structures are easier to maintain - definitely. However, I changed my v2 html rendering to directory structures, because many thousand files are hardly maintained in a single directory...</p>",
        "id": 220856833,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1608798939
    }
]