[
    {
        "content": "<p>Welcome to the topic for the Terminology Services track at Connectathon 12</p>",
        "id": 153824941,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462617508
    },
    {
        "content": "<p>Hi Rob, What time is the the Terminology Services track Connectathon?</p>",
        "id": 153824947,
        "sender_full_name": "Gana Pemmanda",
        "timestamp": 1462620833
    },
    {
        "content": "<p>Gana, the Connectathon begins at 9:00 AM</p>",
        "id": 153824950,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462621014
    },
    {
        "content": "<p>Thanks! I meant is there a schedule for different tracks?</p>",
        "id": 153824951,
        "sender_full_name": "Gana Pemmanda",
        "timestamp": 1462621057
    },
    {
        "content": "<p>All tracks run simultaneously</p>",
        "id": 153824952,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1462621100
    },
    {
        "content": "<p>Thanks! I am stuck at Detroit airport. Will make it in around 11:00 - for the afternoon session </p>",
        "id": 153824953,
        "sender_full_name": "Gana Pemmanda",
        "timestamp": 1462621189
    },
    {
        "content": "<p>Sorry.  No, I am not aware of any separate schedules for different tracks.  People can progress through various aspects of the track (any of them) based on their own needs, interests and capabilities.  We will begin with some initial introductory information, but then everyone will turn to coding and testing.  I'm sorry you are stuck - but you can start as soon as you arrive at 11:00.</p>",
        "id": 153824954,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462621350
    },
    {
        "content": "<p>CSIRO Ontoserver - <a href=\"http://52.63.0.196:8080/fhir\" target=\"_blank\" title=\"http://52.63.0.196:8080/fhir\">http://52.63.0.196:8080/fhir</a><br>\nSTU3</p>",
        "id": 153825008,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462627853
    },
    {
        "content": "<p>Please post your server URLs (either that you are hosting and/or intend to test) and I will add them to the Wiki (if they aren't already there)</p>",
        "id": 153825010,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462628121
    },
    {
        "content": "<p>John Gresh / Apelon, does your server produce json or only XML?</p>",
        "id": 153825013,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462628218
    },
    {
        "content": "<p><a href=\"http://fhir3.healthintersections.com.au/open\" target=\"_blank\" title=\"http://fhir3.healthintersections.com.au/open\">http://fhir3.healthintersections.com.au/open</a></p>",
        "id": 153825014,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462628251
    },
    {
        "content": "<p>Check out the updated information on the NLM - FHIR services on VSAC.  They have a large number of code systems and versions available for testing, and they've updated to suport STU3.  They would appreciate lots of testing and feedback.</p>",
        "id": 153825085,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462632336
    },
    {
        "content": "<p>The NLM info is linked from the Connectathon 12 Wiki - and here's the direct link:<br>\n<a href=\"http://wiki.hl7.org/index.php?title=NLM_-_FHIR_services_on_VSAC\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=NLM_-_FHIR_services_on_VSAC\">http://wiki.hl7.org/index.php?title=NLM_-_FHIR_services_on_VSAC</a></p>",
        "id": 153825086,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462632495
    },
    {
        "content": "<p>Is anyone checking out (or planning to check out) the CodeSystem resource specifically?  If so, are there issues/concerns/suggestions?</p>",
        "id": 153825136,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462635785
    },
    {
        "content": "<p>Who is working with the $closure operation on ConceptMap?</p>",
        "id": 153825155,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462636369
    },
    {
        "content": "<p>Here's our URL <a href=\"http://healthapi.hygeiais.com/fhir/stu3\" target=\"_blank\" title=\"http://healthapi.hygeiais.com/fhir/stu3\">http://healthapi.hygeiais.com/fhir/stu3</a>. The $closure operation is not supported yet</p>",
        "id": 153825166,
        "sender_full_name": "Gana Pemmanda",
        "timestamp": 1462637649
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191492\">@Gana Pemmanda</span> do you support SNOMED CT ?</p>",
        "id": 153825176,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462638279
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> Currently only SNOMED CT and other inline ValueSets. Will have LOINC loaded by tomorrow.. </p>",
        "id": 153825177,
        "sender_full_name": "Gana Pemmanda",
        "timestamp": 1462638354
    },
    {
        "content": "<p>I'm getting errors doing and expand on the snomed implicit valueset <a href=\"http://snomed.info/sct?fhir_vs\" target=\"_blank\" title=\"http://snomed.info/sct?fhir_vs\">http://snomed.info/sct?fhir_vs</a><br>\nWrong ValueSet identifier for operation \"$expand\"</p>",
        "id": 153825179,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462638427
    },
    {
        "content": "<p>Note to all, the example for $lookup here <a href=\"http://hl7.org/fhir/2016May/terminology-service.html\" target=\"_blank\" title=\"http://hl7.org/fhir/2016May/terminology-service.html\">http://hl7.org/fhir/2016May/terminology-service.html</a> is broken -- it suggests the following:<br>\nGET [base]/CodeSystem/$lookup?url=http://loinc.org&amp;code=1963-8&amp;properties=code,display,designations<br>\nbut this should be<br>\nGET [base]/CodeSystem/$lookup?url=http://loinc.org&amp;code=1963-8&amp;property=code&amp;property=display&amp;property=designations</p>",
        "id": 153825184,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462638584
    },
    {
        "content": "<p>Thanks, Gana.  What name would you like for your server when I list it on the Connectathon Wiki page (assuming that you want me to do that)? </p>",
        "id": 153825186,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462638939
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> - can you create a task for that property thing?</p>",
        "id": 153825189,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462639989
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> done - 9962</p>",
        "id": 153825201,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462642072
    },
    {
        "content": "<p>thx</p>",
        "id": 153825202,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462642081
    },
    {
        "content": "<p>Some new servers added to the ValueSet explorer tool <a href=\"http://ontoserver.csiro.au/vstool/\" target=\"_blank\" title=\"http://ontoserver.csiro.au/vstool/\">http://ontoserver.csiro.au/vstool/</a></p>",
        "id": 153825208,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462643279
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> Just noticed a bunch of issues with last night's build which we did for the CodeSystem. Will get them fixed tonite..</p>",
        "id": 153825264,
        "sender_full_name": "Gana Pemmanda",
        "timestamp": 1462644794
    },
    {
        "content": "<p>Great, thanks <span class=\"user-mention\" data-user-id=\"191492\">@Gana Pemmanda</span> </p>",
        "id": 153825280,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462647007
    },
    {
        "content": "<p>Soory guys, my serer hasn't been updated for the new terminology services changes for CodeSystem :(</p>",
        "id": 153825283,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1462647224
    },
    {
        "content": "<p>It might claim it does some stuff, but for the most part, I wouldn't be sure it would do much.</p>",
        "id": 153825284,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1462647251
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span> as long as it doesn't claim a fhirVersion &gt;= 1.3.0 then my vstool should be fine - just needs real SNOMED content :-)</p>",
        "id": 153825296,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462648827
    },
    {
        "content": "<p>nice dig, but yes. And my server is reporting 1.3</p>",
        "id": 153825298,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1462648883
    },
    {
        "content": "<p>ah, it was reporting 1.0.2 this morning</p>",
        "id": 153825300,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462648959
    },
    {
        "content": "<p>This server?<br>\n<a href=\"http://sqlonfhir-may.azurewebsites.net/fhir/\" target=\"_blank\" title=\"http://sqlonfhir-may.azurewebsites.net/fhir/\">http://sqlonfhir-may.azurewebsites.net/fhir/</a></p>",
        "id": 153825302,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1462649080
    },
    {
        "content": "<p>ah, not with the -may in there</p>",
        "id": 153825348,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462652665
    },
    {
        "content": "<p>other server is (and will stay dstu2). Decided to keep the server names up with the version of fhir.<br>\nThis connectathon is a snapshot version, so gets the name May ;)</p>",
        "id": 153825393,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1462657102
    },
    {
        "content": "<p>For all of the Terminology Track participants, if you can send to one or two bullets/notes/slides on what you've done and accomplished, that would be great.  I need that by the end of the quarter (10:30) so it will be ready for our report.</p>",
        "id": 153825517,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1462715488
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>'s server returns a 500 error when $expand is called on the SNOMED CT implicit value set.  I would normally have expected a 4xx ?</p>",
        "id": 153825667,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462723771
    },
    {
        "content": "<p>why? </p>",
        "id": 153825668,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462723790
    },
    {
        "content": "<p>it certainly should work, it's not a client error</p>",
        "id": 153825669,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462723804
    },
    {
        "content": "<p>oh is too costly? </p>",
        "id": 153825671,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462723818
    },
    {
        "content": "<p>Well ,message is \"The code System \"<a href=\"http://snomed.info/sct\" target=\"_blank\" title=\"http://snomed.info/sct\">http://snomed.info/sct</a>\" has a grammar, and cannot be enumerated directly\" which looks like either too costly or client error (a request to enumerate the infinite), even though I only ask for 10 of</p>",
        "id": 153825676,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462723895
    },
    {
        "content": "<p>yeah ok, that shoudl be a 4xx. which one? </p>",
        "id": 153825677,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462723933
    },
    {
        "content": "<p>422 I think</p>",
        "id": 153825680,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462724005
    },
    {
        "content": "<p>that's what a too costly with filter returns on your server</p>",
        "id": 153825681,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462724032
    },
    {
        "content": "<p>The ValueSet explorer tool is publically available at <a href=\"http://ontoserver.csiro.au/vstool\" target=\"_blank\" title=\"http://ontoserver.csiro.au/vstool\">http://ontoserver.csiro.au/vstool</a><br>\nIf anyone has a server they would like me to add into the mix, just post here<br>\nIdeally it should suport CORS (otherwise I rely on <a href=\"http://cors.io\" target=\"_blank\" title=\"http://cors.io\">http://cors.io</a>)<br>\nIt MUST support JSON</p>",
        "id": 153825690,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462724557
    },
    {
        "content": "<p>Question about $validate-code -- if the display string doesn't match the display of the code in corresponding $expand request should it always return false?  Or, is it okay of the display matches any of the designations for the code?</p>",
        "id": 153825691,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462724660
    },
    {
        "content": "<p>I think that's a policy decision</p>",
        "id": 153825696,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462725200
    },
    {
        "content": "<p>As a terminology services client, I keep running into three problems:<br>\n1. CORS support is not enabled (my clients are javascript apps running in a browser)<br>\n2. JSON is not supported (if you have a _simple_ way of converting application/xml+fhir to application/json+fhir in the browser, I'm all ears<br>\n3. JSON is supported, but is not returned when errors happen</p>",
        "id": 153825931,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462807689
    },
    {
        "content": "<p>For 1, in the vstool I am now using <a href=\"http://cors.io\" target=\"_blank\" title=\"http://cors.io\">cors.io</a> as a work-around.  This has two issues:<br>\n1. There seems to be some rate-limiting (sometimes responses come back without the CORS header)<br>\n2. The Accept headers are not passed through, so servers such as NLM's that support JSON but do not understand the _format query parameter so XML comes back</p>",
        "id": 153825944,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462808432
    },
    {
        "content": "<p>These are all general errors. We should add these to the implementers check list - can you create a task for that? You can use my server to do xml/json conversion</p>",
        "id": 153825956,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462808970
    },
    {
        "content": "<p>9971 created</p>",
        "id": 153825987,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1462810272
    },
    {
        "content": "<p>thanks</p>",
        "id": 153825990,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462810291
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  What technical level and skills do you expect for the audience of the Connectathon Terminology Services Track? Do they need Java programming skills in order to understand the technical details you bring up?</p>",
        "id": 153856230,
        "sender_full_name": "Guoqian Jiang",
        "timestamp": 1478716194
    },
    {
        "content": "<p>no. you can participate as a consumer if all you know is basic web API knowledge, and basic terminology knowledge</p>",
        "id": 153856246,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1478721290
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> great. Does this mean that your target audience of the connectathon will be consumers rather than developers? </p>",
        "id": 153856248,
        "sender_full_name": "Guoqian Jiang",
        "timestamp": 1478723501
    },
    {
        "content": "<p>well, developers and analysts of consumer systems on the one said, and the service providers on the other</p>",
        "id": 153856250,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1478724577
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> is there a version of Ontoserver available for testing at the San Antonio Connectathon on Saturday?</p>",
        "id": 153866403,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1484182063
    },
    {
        "content": "<p>Absolutely - <a href=\"https://ontoserver.csiro.au/stu3-latest\" target=\"_blank\" title=\"https://ontoserver.csiro.au/stu3-latest\">https://ontoserver.csiro.au/stu3-latest</a></p>",
        "id": 153866404,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1484183371
    },
    {
        "content": "<p>I've also updated the ValueSet explorer tool (<a href=\"http://ontoserver.csiro.au/vstool/\" target=\"_blank\" title=\"http://ontoserver.csiro.au/vstool/\">http://ontoserver.csiro.au/vstool/</a>) with some additional endpoints and the ability to enter one of your own.</p>",
        "id": 153866405,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1484183473
    },
    {
        "content": "<p>Welcome to the <a href=\"http://wiki.hl7.org/index.php?title=201701_Terminology_Services_Track\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=201701_Terminology_Services_Track\">Terminology Services track at Connectathon 14</a> in San Antonio.  We can use this topic for communication within our group about questions that we have, issues that we're encountering and progress that we're making.  I'm looking forward to what will be accomplished over the next day and a half!</p>",
        "id": 153866566,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1484397130
    },
    {
        "content": "<p>For those of you who are providing terminology service endpoints for clients to test and use, it would be great if you can verify the details for your server in the <a href=\"http://wiki.hl7.org/index.php?title=201701_Terminology_Services_Track#ExpectedParticipants\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=201701_Terminology_Services_Track#ExpectedParticipants\">Expected participants</a> section, and update them if needed (let me know if you aren't able to edit the Wiki or need help with updating).  Also, If you encounter any other information on the Wiki pages that is outdated or incomplete, please update it or let me know.</p>",
        "id": 153866567,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1484400205
    },
    {
        "content": "<p>I've updated the <a href=\"http://wiki.hl7.org/index.php?title=NLM_-_FHIR_services_on_VSAC\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=NLM_-_FHIR_services_on_VSAC\">NLM - FHIR services on VSAC</a> page to reflect the latest information from the NLM.  It would be great if we could thoroughly test their service offerings during this Connectathon, so please do that as you have the opportunity.</p>",
        "id": 153866568,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1484401796
    },
    {
        "content": "<p>For the record, here's a link to my experimental terminology service for HLA nomenclature.<br>\n<a href=\"http://mac-and-fhir-prototype.us-east-1.elasticbeanstalk.com/\" target=\"_blank\" title=\"http://mac-and-fhir-prototype.us-east-1.elasticbeanstalk.com/\">http://mac-and-fhir-prototype.us-east-1.elasticbeanstalk.com/</a><br>\nThe landing page includes a Postman collection containing a few usage examples.  Caveats:  it only recognizes a limited set of code systems and value sets, and it was originally developed for DSTU2 and has not yet been updated for STU3.</p>",
        "id": 153866611,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484408584
    },
    {
        "content": "<p>The terminology track is distributed across at least 3 different tables today, so let's try to make maximum use of the chat for collaboration.  It would be great if we could all post something about what we're offering in regard to servers and clients and what we hope to accomplish over the next day and a half.</p>",
        "id": 153866612,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1484408737
    },
    {
        "content": "<p>In addition to the prototype terminology service, I've also been working on a STU3 terminology bundle for HLA which could be loaded into a typical FHIR server.</p>",
        "id": 153866637,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484409576
    },
    {
        "content": "<p>Joel - that would be great. But it was my impression that proper support for  HLA would require implicit knowledge beyond what we could represent in CodeSystem?</p>",
        "id": 153866667,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484410793
    },
    {
        "content": "<p>I'm going to have a shot a simple implemention of $compose for snomed </p>",
        "id": 153866668,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484410806
    },
    {
        "content": "<p>Grahame - For nomenclature-level HLA data, I think CodeSystem(s) would be a good starting point.  </p>\n<p>The IMGT/HLA nomenclature formally releases a new version every 3 months, so for that nomenclature I think it would not be unreasonable to periodically generate &amp; load a new CodeSystem version for each new release.  </p>\n<p>The NMDP multiple-allele code system is a different animal.  New allele codes are being defined every day, and there's no formal versioning or release process.  To represent that as a CodeSystem, I think it would be possible to implement the terminology service as a gateway api that, when needed, calls another service to query the present status.  It may also be possible to generate a \"snapshot\" bundle that captures the state of the code system at a specific point in time.  </p>\n<p>Depending on usage requirements, it might also be useful to define one or more ConceptMap resources, to implement $translate..</p>",
        "id": 153866729,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484414428
    },
    {
        "content": "<p>Last November there was some discussion using Swagger to describe FHIR terminology service APIs (<a href=\"https://chat.fhir.org/#narrow/stream/implementers/subject/Swagger.20and.20RAML\" target=\"_blank\" title=\"https://chat.fhir.org/#narrow/stream/implementers/subject/Swagger.20and.20RAML\">here</a>).  Has there been further progress on that?</p>",
        "id": 153866777,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484416922
    },
    {
        "content": "<p>no; I've been focusing on qa work in the spec itself. I'm expecting to work on swagger APIS in february</p>",
        "id": 153866834,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484422913
    },
    {
        "content": "<p>have you generated a codeSYstem definition for HLA&gt;</p>",
        "id": 153866836,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484422928
    },
    {
        "content": "<p>I've taken an initial stab at generating a CodeSystem &amp; ValueSet bundle for the IMGT/HLA names, but it needs more work.  If you're interested, I'd be happy to share/discuss it.</p>",
        "id": 153866885,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484425280
    },
    {
        "content": "<p>sure I'll look</p>",
        "id": 153866916,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484426096
    },
    {
        "content": "<p><strong>2017-01-15: deleted fhir-imgt-hla-terminology-bundle.xml</strong><br>\nSee below for revised file.</p>",
        "id": 153866963,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484428360
    },
    {
        "content": "<p>I'm thinking of adding properties, and more codes to it.</p>",
        "id": 153866975,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484428790
    },
    {
        "content": "<p>ok, this will work on my server in a few minutes:</p>\n<div class=\"codehilite\"><pre>&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;system&quot;/&gt;\n    &lt;valueUri value=&quot;http://snomed.info/sct&quot;/&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;exact&quot;/&gt;\n    &lt;valueBoolean value=&quot;true&quot;/&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;property&quot;/&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;code&quot;/&gt;\n      &lt;valueCode value=&quot;focus&quot;/&gt;\n    &lt;/part&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;value&quot;/&gt;\n      &lt;valueCode value=&quot;118245000&quot;/&gt;\n    &lt;/part&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;property&quot;/&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;code&quot;/&gt;\n      &lt;valueCode value=&quot;363714003&quot;/&gt;\n    &lt;/part&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;value&quot;/&gt;\n      &lt;valueCode value=&quot;302787001&quot;/&gt;\n    &lt;/part&gt;\n  &lt;/parameter&gt;\n&lt;/Parameters&gt;\n</pre></div>",
        "id": 153867311,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484498082
    },
    {
        "content": "<p>post to <a href=\"http://fhir3.healthintersections.com.au/open/CodeSystem/$compose\" target=\"_blank\" title=\"http://fhir3.healthintersections.com.au/open/CodeSystem/$compose\">http://fhir3.healthintersections.com.au/open/CodeSystem/$compose</a></p>",
        "id": 153867313,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484498115
    },
    {
        "content": "<p>.. can't get it uploaded to use on the server...</p>",
        "id": 153867371,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484501356
    },
    {
        "content": "<p>yay works</p>",
        "id": 153867444,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484503925
    },
    {
        "content": "<p>Here's a revised HLA CodeSystem &amp; ValueSet bundle file.  I changed the bundle type to transaction and added bundle.entry.request elements.  Should work better now.<br>\n<a href=\"/user_uploads/10155/WRCgV5U3VUlHPGDqZadNscB5/fhir-imgt-hla-terminology-bundle.xml\" target=\"_blank\" title=\"fhir-imgt-hla-terminology-bundle.xml\">fhir-imgt-hla-terminology-bundle.xml</a> </p>",
        "id": 153867477,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484506851
    },
    {
        "content": "<p>An example curl script to load the bundle into a FHIR server:</p>\n<div class=\"codehilite\"><pre><span class=\"c\">#!/bin/sh</span>\n\n<span class=\"nv\">BUNDLE_FILENAME</span><span class=\"o\">=</span><span class=\"s2\">&quot;</span><span class=\"nv\">$1</span><span class=\"s2\">&quot;</span>\n<span class=\"k\">if</span> <span class=\"o\">[</span> -z <span class=\"s2\">&quot;</span><span class=\"si\">${</span><span class=\"nv\">BUNDLE_FILENAME</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span> <span class=\"o\">]</span><span class=\"p\">;</span> <span class=\"k\">then</span>\n    <span class=\"nv\">BUNDLE_FILENAME</span><span class=\"o\">=</span><span class=\"s2\">&quot;fhir-imgt-hla-terminology-bundle.xml&quot;</span>\n<span class=\"k\">fi</span>\n\n<span class=\"nv\">SERVICE_URL</span><span class=\"o\">=</span><span class=\"s2\">&quot;</span><span class=\"nv\">$2</span><span class=\"s2\">&quot;</span>\n<span class=\"k\">if</span> <span class=\"o\">[</span> -z <span class=\"s2\">&quot;</span><span class=\"si\">${</span><span class=\"nv\">SERVICE_URL</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span> <span class=\"o\">]</span><span class=\"p\">;</span> <span class=\"k\">then</span>\n    <span class=\"nv\">SERVICE_URL</span><span class=\"o\">=</span><span class=\"s2\">&quot;http://localhost:8080/baseDstu3&quot;</span>\n<span class=\"k\">fi</span>\n\ncurl <span class=\"se\">\\</span>\n  --silent --show-error <span class=\"se\">\\</span>\n  --data <span class=\"se\">\\@</span><span class=\"si\">${</span><span class=\"nv\">BUNDLE_FILENAME</span><span class=\"si\">}</span> <span class=\"se\">\\</span>\n  --header <span class=\"s2\">&quot;Content-Type: application/xml+fhir&quot;</span> <span class=\"se\">\\</span>\n  <span class=\"si\">${</span><span class=\"nv\">SERVICE_URL</span><span class=\"si\">}</span> <span class=\"se\">\\</span>\n  <span class=\"p\">|</span> xmllint --format -\n</pre></div>",
        "id": 153867478,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484507101
    },
    {
        "content": "<p>Thanks, Joel.  I'll try to take some time to look at and work witjh this.</p>",
        "id": 153867535,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1484568344
    },
    {
        "content": "<p><code>$compose</code> example works for me! Returns concept <code>365786009 |Bilirubin level - finding|</code>.  Sub-second response! Exact setting filters out concepts with the same (proximal primitive) focus concept and attribute/value combination, but additional attributes. One up for pre-computing the normalised expressions of each concept.</p>",
        "id": 153867583,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1484583900
    },
    {
        "content": "<p>If you send me examples of your $compose request and response messages, I can work on adding new TestScripts for them.</p>",
        "id": 153867585,
        "sender_full_name": "Richard Ettema",
        "timestamp": 1484584299
    },
    {
        "content": "<p>Grahame's example request is above - but it may be a little early for Test Scripting!</p>\n<p>Response was</p>\n<div class=\"codehilite\"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n    &lt;parameter&gt;\n        &lt;name value=&quot;match&quot;/&gt;\n        &lt;part&gt;\n            &lt;name value=&quot;code&quot;/&gt;\n            &lt;valueCoding&gt;\n                &lt;system value=&quot;http://snomed.info/sct&quot;/&gt;\n                &lt;code value=&quot;365786009&quot;/&gt;\n                &lt;display value=&quot;Bilirubin level - finding&quot;/&gt;\n            &lt;/valueCoding&gt;\n        &lt;/part&gt;\n    &lt;/parameter&gt;\n&lt;/Parameters&gt;\n</pre></div>",
        "id": 153867586,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1484584460
    },
    {
        "content": "<p>Never too early!  :)</p>",
        "id": 153867592,
        "sender_full_name": "Richard Ettema",
        "timestamp": 1484585075
    },
    {
        "content": "<p>here's my pseudo code:</p>\n<div class=\"codehilite\"><pre>findMatchingConcepts(list, focus, refinements)\n  children = get defined childrren(focus);\n  for each child in children \n    exp = loadDefinition of child\n    move all refinements on exp into refinementGroups on exp\n\n    allMatched = true;\n    oneUnMatched = false;\n    grps = new List;\n    for each grp in exp.refinementGroups\n      state := checkGroupStateInRefinements(grp, refinements, grps);\n      if (state = No Match)\n        oneUnMatched = true\n      else if (state != Identical)\n        allMatched := false;\n\n    if (oneUnMatched) then\n      // neither this nor any of the children will ever match\n    else if (allMatched) and (grps.count &gt; 0) then\n      // this reference is a complete match. stop here\n      list.Add(TMatchingConcept.Create(s));\n    else\n      // get the list of non-matches\n      grpNM = list Groups that didn&#39;t match(refinements, grps);\n      if (grpNM.Count &lt; refinements.Count) then // partial match\n        list.Add(TMatchingConcept.Create(s, grpNM));\n      findMatchingConcepts(list, child, grpNM);\n</pre></div>",
        "id": 153867601,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484586877
    },
    {
        "content": "<p>Might be worth waiting until the exact input parameter has been added to the latest build (GF #12605). Current example in the spec also needs updating (GF #12609).</p>",
        "id": 153867611,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1484589185
    },
    {
        "content": "<p>Typos in the spec for $compose:<br>\n  none of the closing &lt;/part&gt; tags include the /;<br>\n  the system parameter has valuUri not valueUri (missing e).</p>",
        "id": 153867749,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1484608659
    },
    {
        "content": "<p>Grahame's server complains about the mode parameter:<br>\n&lt;issue&gt;<br>\n        &lt;severity value=\"error\"/&gt;<br>\n        &lt;code value=\"code-invalid\"/&gt;<br>\n        &lt;diagnostics value=\"Only 'machine' is supported for mode\"/&gt;<br>\n    &lt;/issue&gt;<br>\nBut that is the value I supplied :)</p>",
        "id": 153867750,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1484608710
    },
    {
        "content": "<p>ah, I see the parameter has changed from mode to exact - looks like the error message needs updating</p>",
        "id": 153867751,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1484608764
    },
    {
        "content": "<p>sorry, incomplete changes applied in a hurry during the connectathon</p>",
        "id": 153867773,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484614266
    },
    {
        "content": "<p>Some comments to the $compose operation. 0. what is the intended audience of the operator (as in relation to those who post-coordinate using compositional grammar) 1. the example is ... interesting. The result is a primitive concept and does not in the current version (or daily build) of SNOMED CT have the severity property. Also, should primitives be returned when exact=true? What should be returned when there is no fully defined concept? 2. What does \"partial\" mean? A subsumer? 3. How does the list of parameters address relationship grouping? Cheers, Daniel</p>",
        "id": 153868300,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1484778508
    },
    {
        "content": "<p>I'm not sure what you mean about the operator</p>",
        "id": 153868331,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484795950
    },
    {
        "content": "<p>clearly the example needs work. If severity is not in the concept, it needs to be listed in unmatched. I'll cross the example with my implementation and intl snomed</p>",
        "id": 153868332,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484795997
    },
    {
        "content": "<p>if there is no fully defined concept, can return a partial with a list of things not matched. </p>",
        "id": 153868333,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484796052
    },
    {
        "content": "<p>should primitives be returned...? I am returning primitives, but I can see that this may be problematic. </p>",
        "id": 153868334,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484796082
    },
    {
        "content": "<p>perhaps I should only return them if exact=false</p>",
        "id": 153868335,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484796107
    },
    {
        "content": "<p>2. partial means that the concept matches for some properties, but not others</p>",
        "id": 153868336,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484796125
    },
    {
        "content": "<p>I should provide an example that deals with relationships grouping</p>",
        "id": 153868337,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484796159
    },
    {
        "content": "<p>are you happy to add a task relating to this to gForge?</p>",
        "id": 153868338,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484796171
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> I've generated a new iteration of that IMGT-HLA terminology bundle.  This one includes a set of concept properties which I think enable some interesting $closure possibilities.  The file size is 45 Mb (over 10x the previous size), so instead of attaching it here, it seemed better to upload it to S3:<br>\n<a href=\"https://s3.amazonaws.com/nmdp-fhir-terminology/fhir-imgt-hla-terminology-bundle.xml\" target=\"_blank\" title=\"https://s3.amazonaws.com/nmdp-fhir-terminology/fhir-imgt-hla-terminology-bundle.xml\">https://s3.amazonaws.com/nmdp-fhir-terminology/fhir-imgt-hla-terminology-bundle.xml</a></p>",
        "id": 153868394,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484843645
    },
    {
        "content": "<p>re $compose I think I already opened a rtackr item about the missing severity issue<br>\nI think returning a primitive is fine as long as the focus is the primitive<br>\nI'm also troubled about the use-cases motivating this opreration -- the questions raised about behaviour for exact=false and returning unmatched properties can only really usefully be resolved if the use cases are well understood.</p>\n<p>A final point: if this operations is meant for SNOMED, then the ECL offers a better, pre-existing, approach for doing this kind of thing.  If it's for other code systems as well (LOINC?) then we'll need some good clarification of the intended semantics as there would seem to be tension between what makes sense in a closed-world model as used for LOINC, and an open-world, subsumption model as used for SNOMED.</p>",
        "id": 153868492,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1484869050
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191926\">@Joel Schneider</span> just by way of some (unsolicited) feedback on that bundle. The CodeSystem resource doesn't validate against the shareablecodesystem profile, since that profile (for better or for worse) mandates the concept.definition attribute</p>",
        "id": 153868496,
        "sender_full_name": "Jim Steel",
        "timestamp": 1484870880
    },
    {
        "content": "<p>will remove \"severity\" and keep the rest in the tracker item. Is there some description of the use case(s) served?</p>",
        "id": 153868503,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1484874582
    },
    {
        "content": "<p>Primitives have some unstated meaning not among and additional to the defining relationships, hence they should not be returned. Has nothing to do with focus concept.</p>",
        "id": 153868505,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1484874914
    },
    {
        "content": "<p>primitives might be returned for exact = false with a note? But in some cases, SNOMED CT is too conservative when using primitive=true, and there is no important information not encoded. I think it's a line ball call. but some examples would probably be good</p>",
        "id": 153868514,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484880392
    },
    {
        "content": "<p>$compose is certainly for LOINC and RxNorm as well. and any medication terminology. LOINC is not usable yet, but Dan says that we'll see part codes in June, and then it will be</p>",
        "id": 153868515,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1484880430
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> If the compose request includes <em>just</em> the focus concept and it is primitive, then should it not be a match (exact)?<br>\nSimilarly, if the focus is a primitive concept, and there is one additional property that is also part of the definition of that concept, then why would it not be a match?</p>",
        "id": 153868522,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1484884269
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> OK, got it! Both valid cases when a primitive should be returned (but the former seems less meaningful). My problem was if the operation returns primitive subsumees of the resulting (non-precoordinated) expression. I'm still not sure what the use cases are. I have two guesses though: 1. searching the terminology (e.g. searching SNOMED CT using focus+refinements) or 2. creating expressions (e.g. dagger-asterisk coding for ICD-10, post-coordination). If it's 1, then is it supposed to be a light interface to ECL or DLQuery?</p>",
        "id": 153868610,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1484926104
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> Thanks for the feedback.  I still need to figure out how to run a validator on the CodeSystem.  It may be possible to automatically populate the concept.definition of the 15000 specific allele names and 3000 ambiguous allele names with boilerplate text ...</p>",
        "id": 153868614,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1484926363
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> Yes, SNOMED might be too restrictive but that's what we have... <br>\nOne interesting example would be:<br>\nfocus=clincial finding<br>\nmorphology=fracture<br>\nfinding site=structure of ulna<br>\nfinding site=structure of radius<br>\nFor a search use case, it would be straight forward to find 75857000 | Fracture of radius AND ulna (disorder) |, corresponding to ECL &lt;&lt; |finding|:|morph|=|fracture|,|site|=|ulna|,site=|radius|<br>\nFor a composition use case, it would require more knowledge to deduce that the two finding sites should be in separate relationship groups.</p>",
        "id": 153868621,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1484927033
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> FYI, I've updated that IMGT/HLA terminology bundle:  <a href=\"https://s3.amazonaws.com/nmdp-fhir-terminology/fhir-imgt-hla-terminology-bundle.xml\" target=\"_blank\" title=\"https://s3.amazonaws.com/nmdp-fhir-terminology/fhir-imgt-hla-terminology-bundle.xml\">https://s3.amazonaws.com/nmdp-fhir-terminology/fhir-imgt-hla-terminology-bundle.xml</a></p>\n<p>Still have more improvements in mind, but this one at least passes validation by the HAPI FHIR 2.2 STU3 FhirInstanceValidator.</p>",
        "id": 153869171,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1485380815
    },
    {
        "content": "<p>Just deployed a first attempt at implementing the CodeSystem $compose operation on my server, so please feel free to POST to...<br>\n<a href=\"http://its.patientsfirst.org.nz/RestService.svc/Terminz/CodeSystem/$compose\" target=\"_blank\" title=\"http://its.patientsfirst.org.nz/RestService.svc/Terminz/CodeSystem/$compose\">http://its.patientsfirst.org.nz/RestService.svc/Terminz/CodeSystem/$compose</a><br>\nJust a few caveats - Code System must  be SCT; requires a focus concept and at least one attribute and value; only exact matches supported.  Grahame's example above works, but it would be great to have a few other, more complex, test cases.</p>",
        "id": 153869462,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1485750677
    },
    {
        "content": "<p>Hi Peter,</p>",
        "id": 153869468,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1485779693
    },
    {
        "content": "<p>Hi Peter, <br>\njust tried this example:</p>\n<p>&lt;Parameters xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n  &lt;!-- use SNOMED CT rules --&gt;<br>\n  &lt;parameter&gt;<br>\n    &lt;name value=\"system\"/&gt;<br>\n    &lt;valueUri value=\"http://snomed.info/sct\"/&gt;<br>\n  &lt;/parameter&gt;<br>\n  &lt;!-- 125605004 | Fracture of bone (disorder) | --&gt;<br>\n  &lt;parameter&gt;<br>\n    &lt;name value=\"property\"/&gt;<br>\n    &lt;part&gt;<br>\n      &lt;name value=\"code\"/&gt;<br>\n      &lt;valueCode value=\"focus\"/&gt;<br>\n    &lt;/part&gt;<br>\n    &lt;part&gt;<br>\n      &lt;name value=\"value\"/&gt;<br>\n      &lt;valueCode value=\"125605004\"/&gt;<br>\n    &lt;/part&gt;<br>\n  &lt;/parameter&gt;<br>\n  &lt;!-- Finding site: ulna --&gt;<br>\n  &lt;parameter&gt;<br>\n    &lt;name value=\"property\"/&gt;<br>\n    &lt;part&gt;<br>\n      &lt;name value=\"code\"/&gt;<br>\n      &lt;valueCode value=\"363698007\"/&gt;<br>\n    &lt;/part&gt;<br>\n    &lt;part&gt;<br>\n      &lt;name value=\"value\"/&gt;<br>\n      &lt;valueCode value=\"23416004\"/&gt;<br>\n    &lt;/part&gt;<br>\n  &lt;/parameter&gt;<br>\n  &lt;!-- complete and partial matches only (nothing fuzzy/indeterminate) --&gt;<br>\n  &lt;parameter&gt;<br>\n    &lt;name value=\"exact\"/&gt;<br>\n    &lt;valueCode value=\"true\"/&gt;<br>\n  &lt;/parameter&gt;<br>\n&lt;/Parameters&gt;</p>\n<p>but got no exact match.</p>\n<p>Was expecting 54556006 | Fracture of ulna (disorder) |</p>\n<p>Were my expectations wrong?</p>\n<p>/Daniel</p>",
        "id": 153869469,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1485779820
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> thanks for the testing; that query will return an OperationOutcome exception because the exact parameter should be a boolean data type, not a code. However, even with that correction, neither Grahame's or my server will return an exact match of <code>54556006|Fracture of ulna (disorder)|</code> because that concept has an additional attribute of <br>\n<code>116676008|Associated morphology|=72704001|Fracture|</code>. If you add that attribute to the query, my server will return <br>\n<code>54556006|Fracture of ulna (disorder)| </code></p>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> server still does not return any concepts but, when back on deck, he should be able to explain why.</p>\n<p>(Edit must state that I'm still using the 20160731 release of the International Edition).</p>\n<p>Full POST is...</p>\n<div class=\"codehilite\"><pre><span></span>&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;system&quot;/&gt;\n    &lt;valueUri value=&quot;http://snomed.info/sct&quot;/&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;exact&quot;/&gt;\n    &lt;valueBoolean value=&quot;true&quot;/&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;property&quot;/&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;code&quot;/&gt;\n      &lt;valueCode value=&quot;focus&quot;/&gt;\n    &lt;/part&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;value&quot;/&gt;\n      &lt;valueCode value=&quot;125605004&quot;/&gt;\n    &lt;/part&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;property&quot;/&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;code&quot;/&gt;\n      &lt;valueCode value=&quot;363698007&quot;/&gt;\n    &lt;/part&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;value&quot;/&gt;\n      &lt;valueCode value=&quot;23416004&quot;/&gt;\n    &lt;/part&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=&quot;property&quot;/&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;code&quot;/&gt;\n      &lt;valueCode value=&quot;116676008&quot;/&gt;\n    &lt;/part&gt;\n    &lt;part&gt;\n      &lt;name value=&quot;value&quot;/&gt;\n      &lt;valueCode value=&quot;72704001&quot;/&gt;\n    &lt;/part&gt;\n  &lt;/parameter&gt;\n&lt;/Parameters&gt;\n</pre></div>",
        "id": 153869531,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1485810571
    },
    {
        "content": "<p>[[@<strong>Peter Jordan</strong> ]] sorry about the valueBoolean issue, a copy/paste error. The 125605004 | Fracture of bone (disorder) | concept includes that exact morphology in the definition. Should the operation not take this into consideration? If so, why not and what is the use case to be served?</p>",
        "id": 153869579,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1485859829
    },
    {
        "content": "<p>Sorry about the valueBoolean, copy/paste error...<br>\nStill, the concept 125605004 | Fracture of bone (disorder) | includes the morphology in the definition. Is this service not expected to take this into account? If so, why not?<br>\n/Daniel<br>\nAs you can see I've had internet connection problems today...</p>",
        "id": 153869581,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1485864871
    },
    {
        "content": "<p>Great work, Peter.  I'll try to do some testing and will let you know how it goes.</p>",
        "id": 153869612,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1485890711
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> In terms of expectations - it may be easier if I provide a simple list of the steps that I'm taking to compose, and then you can tell me what I may need to add to determine that the |associated morphology| attribute is in the concept definition...</p>\n<p>a. Select the proximal primitive(s) of the Focus Concept<br>\nb. Select all concepts that have each of the passed attribute/value pairs AND have the same proximal primitives as the Focus Concept<br>\nc. Exclude all concepts that have additional attribute/value pairs to those passed in the query</p>\n<p>Is it significant that the Focus Concept is fully-defined? Should I be adding the attributes already in the definition of the focus concept in those (or all) cases to those contained in the query IF they are not already there. What if they are in the concept definition but have a different value to that passed in the query, as is the case with |Finding site| in this example?</p>",
        "id": 153869659,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1485922549
    },
    {
        "content": "<p>[[@<strong>Peter Jordan</strong> ]] In the { focus=fracture of bone, finding site=ulna } example the primitive(s) would be { disease }, but the morphology=fracture of the fracture of bone definition is lost. If the focus concept(s) is/are fully defined the attributes/values would have to be added in step b. As I understand the requirements only the most specific attribute/value should be used for (exact) comparison.</p>",
        "id": 153869672,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1485959121
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> I've now added the additional step that you advised. If the focus concept is fully defined then any of its attributes not passed in the request are added to the query processed in step b above. Maybe you can test this implementation when time permit? BTW: my server now contains the 20170131 version of the International Edition.</p>",
        "id": 153870237,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486371450
    },
    {
        "content": "<p>hmm I'm falling behind here; will have to catch up...</p>",
        "id": 153870240,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486371676
    },
    {
        "content": "<p>[[@<strong>Peter Jordan</strong> ]] Did test the pervious example and I got the expected (or at least what I expected...) result. Great!</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;Parameters</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;parameter&gt;</span>\n        <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;match&quot;</span> <span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;part&gt;</span>\n            <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;code&quot;</span> <span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;valueCoding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://snomed.info/sct&quot;</span> <span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;54556006&quot;</span> <span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Fracture of ulna&quot;</span> <span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/valueCoding&gt;</span>\n        <span class=\"nt\">&lt;/part&gt;</span>\n    <span class=\"nt\">&lt;/parameter&gt;</span>\n<span class=\"nt\">&lt;/Parameters&gt;</span>\n</pre></div>",
        "id": 153870277,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1486387351
    },
    {
        "content": "<p>[[@<strong>Peter Jordan</strong> ]] Tried this one expecting 75857000 | Fracture of radius AND ulna (disorder) | but got \"no exact match\". Please check if I did something wrong. Also (by mistake), I tried having the previous example with a duplicate finding site parameter (i.e. two finding site=ulna) also with \"no exact match\" result.</p>\n<p>Perhaps it has to do with step c. The ulna&amp;radius fracture has two role groups, each with a finding site and with an assoc. morph.=fracture. Tried adding an additional parameter, but that didn't help.</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;Parameters</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"c\">&lt;!-- use SNOMED CT rules --&gt;</span>\n  <span class=\"nt\">&lt;parameter&gt;</span>\n    <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;system&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;valueUri</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://snomed.info/sct&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/parameter&gt;</span>\n  <span class=\"c\">&lt;!-- 125605004 | Fracture of bone (disorder) | --&gt;</span>\n  <span class=\"nt\">&lt;parameter&gt;</span>\n    <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;property&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;part&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;code&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">&quot;focus&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/part&gt;</span>\n    <span class=\"nt\">&lt;part&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;value&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">&quot;125605004&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/part&gt;</span>\n  <span class=\"nt\">&lt;/parameter&gt;</span>\n  <span class=\"c\">&lt;!-- Finding site: ulna --&gt;</span>\n  <span class=\"nt\">&lt;parameter&gt;</span>\n    <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;property&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;part&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;code&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">&quot;363698007&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/part&gt;</span>\n    <span class=\"nt\">&lt;part&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;value&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">&quot;23416004&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/part&gt;</span>\n  <span class=\"nt\">&lt;/parameter&gt;</span>\n  <span class=\"c\">&lt;!-- Finding site: radius --&gt;</span>\n  <span class=\"nt\">&lt;parameter&gt;</span>\n    <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;property&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;part&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;code&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">&quot;363698007&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/part&gt;</span>\n    <span class=\"nt\">&lt;part&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;value&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">&quot;62413002&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/part&gt;</span>\n  <span class=\"nt\">&lt;/parameter&gt;</span>\n  <span class=\"c\">&lt;!-- complete and partial matches only (nothing fuzzy/indeterminate) --&gt;</span>\n  <span class=\"nt\">&lt;parameter&gt;</span>\n    <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">&quot;exact&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;valueBoolean</span> <span class=\"na\">value=</span><span class=\"s\">&quot;true&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/parameter&gt;</span>\n<span class=\"nt\">&lt;/Parameters&gt;</span>\n</pre></div>",
        "id": 153870278,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1486387642
    },
    {
        "content": "<p>@<strong>Daniel Karsson</strong> thanks again for the feedback. On an exact match I would have thought it reasonable to assume that passing duplicate attribute/value combinations would be to request concepts where these exist in different relationship groups? If so, the response, to the request sent in error, is correct. I will take a close look at the example where you were expecting 75857000 | Fracture of radius AND ulna (disorder) |. It's a good use case as it has the same pair of attributes in 2 relationship groups; in one case the value is the same, in the other it's different!</p>",
        "id": 153870394,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486425610
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> sorry, I'm late to this - I don't understand why you'd do step (a) - proximal primitives at all.<br>\nBut I'm also confused - about the desired semantics.  I think I resolved that (with exact=true), the corresponding ECL is:<br>\n&lt;&lt;125605004 :<br>\n 363698007 = 23416004,<br>\n 116676008 = 72704001,<br>\n [2..2] &lt;&lt; 410662002 = *<br>\ni.e.<br>\n&lt;&lt; {focus} :<br>\n  {property} = {value} ...<br>\n [k..k]  &lt;&lt; 410662002 = *<br>\nwhere 'k' is the number of supplied property value pairs.</p>\n<p>However, this will not work properly when role grouping is in play and, for example, a finding site / value is specified but occurs in multiple groups (because 'k' will be wrong). </p>",
        "id": 153870406,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1486432252
    },
    {
        "content": "<p>Where I'm confused is should this match at all - does 'exact' apply to the focus concept, or does it just mean \"must have exactly the property-values specified and nothing else\"?</p>",
        "id": 153870407,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1486432352
    },
    {
        "content": "<p>I think you are all looking it from a purist point of view, where as the question should be asked from a consumer point of view - I have these different elements and I'm trying to reason across them</p>",
        "id": 153870408,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486432404
    },
    {
        "content": "<p>I guess I'm trying to understand what the consumer wants when they \"reason across them\"?  What might help is a number of example requests and expected responses.  For <span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> 's original one, I was assuming that only the single concept <code>|54556006 |Fracture of ulna|</code> should match and not the additional concept <code>275366009  |Birth fracture of ulna|</code> (because that has the <code>|Occurrence|</code> property), nor <code>71555008 |Closed fracture or ulna|</code> because the morphology value is <code>20946005 |Fracture, closed|</code> which is a child of <code>72704001|Fracture|</code> (see <a href=\"http://ontoserver.csiro.au/shrimp/?concept=54556006&amp;versionId=http%3A%2F%2Fsnomed.info%2Fsct%2F32506021000036107%2Fversion%2F20170131\" target=\"_blank\" title=\"http://ontoserver.csiro.au/shrimp/?concept=54556006&amp;versionId=http%3A%2F%2Fsnomed.info%2Fsct%2F32506021000036107%2Fversion%2F20170131\">http://ontoserver.csiro.au/shrimp/?concept=54556006&amp;versionId=http%3A%2F%2Fsnomed.info%2Fsct%2F32506021000036107%2Fversion%2F20170131</a>)</p>",
        "id": 153870409,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1486433093
    },
    {
        "content": "<p>Maybe instead the consumer wants all codes that are 'subsumed' by the post-coordinated expression? (ignoring role grouping).<br>\nIn terms of the ECL, this would be:</p>\n<p><code>&lt;&lt; 125605004 :\n  &lt;&lt;363698007 = &lt;&lt;23416004,\n  &lt;&lt;116676008 = &lt;&lt;72704001</code></p>\n<p>which matches 52 codes in SNOMED CT-AU 20170131</p>",
        "id": 153870410,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1486433268
    },
    {
        "content": "<p>typical use cases from my pov:<br>\n- I have an observation with a code and no method, and an observation with a code and a method. Are they the same?<br>\n- I have a condition with a code and a severity, and I have to convert it to a condition with a code that includes the severity (or vice versa)<br>\n- I have an observation with a related observation about stage, does that represent a stage iV cancer of the type I am interested in</p>",
        "id": 153870411,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486433826
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> What's the use case for attempting to compose using a fully-defined focus concept without going back to its proximal primitives? Aren't we effectively trying to use equivalence testing techniques here - i.e. find me a concept that's equivalent to this Normal Form definition?</p>",
        "id": 153870412,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486433978
    },
    {
        "content": "<p>also this: <a href=\"http://www.healthintersections.com.au/?p=658\" target=\"_blank\" title=\"http://www.healthintersections.com.au/?p=658\">http://www.healthintersections.com.au/?p=658</a></p>",
        "id": 153870414,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486434873
    },
    {
        "content": "<p>That Health Intersections post tells me attempting to use the compose operation to return <code>162573006 |Suspected lung cancer|</code> is going to be extremely challenging! The definition of that concept is completely counter-intuitive to an endpoint system containing values of diagnosis=cancer, finding site = lung, status = suspected....</p>\n<p><code>243796009|Situation with explicit context|:{408729009|Finding context|=415684004|Suspected|,246090004|Associated finding|=363358000|Malignant tumour of lung|,408731000|Temporal context|=410512000|Current or specified|,408732007|Subject relationship context|=410604004|Subject of record|}</code></p>",
        "id": 153870417,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486436823
    },
    {
        "content": "<p>that's an SCT problem then?</p>",
        "id": 153870421,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486438521
    },
    {
        "content": "<p>I'd suggest that your blog entry leads to that conclusion. Hopefully, there are sufficient positive examples to justify implementing this operation. Perhaps one fertile area might be the new pre-coordinated concepts in the 20170131 version with laterality attributes. Maybe <span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> could suggest some examples.</p>",
        "id": 153870424,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486440330
    },
    {
        "content": "<p>I guess it is ;) but that's what the template work is aiming to address. I'm trying to figure out what the exact use case is for the $compose operation, i.e. what the consumer view of this is and if that can be compatible with a purist view, which is finally going to be needed when implementing the stuff. E.g. we need to specify what to do with subsumption (is it a query operation?), relationship groups and multiple instances of relationships, nested definitions?, is it a \"light\" interface/a transform to ECL?<br>\nI'm not sure we need more examples, ulna+radius fracture and suspected lung cancer would cover these complexities of SNOMED CT, but maybe a page with examples and expected outcomes? E.g. would it be expected that the $compose operation would manage the Suspected cancer use case?</p>",
        "id": 153870486,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1486465901
    },
    {
        "content": "<p>If a Focus Concept of <code>162572001 |Suspected Cancer|</code> and attribute/value pair of <code>246090004|Associated finding|=363358000|Malignant tumour of lung|</code> are passed to my server it will return <code>162573006 |Suspected lung cancer|</code>. The difficulty in the broader example lies where the Focus Concept is a <code>Disease</code> (e.g. <code>93880001|Primary malignant neoplasm of lung</code>) rather than a  <code>Situation with explicit context</code>. This probably requires some complex business logic based on the detection of a<code>Finding Context</code> attribute. From an end-user perspective, it might just be easier to request an expansion of the SCT Implicit Value Set with a text filter of \"suspected lung cancer\".</p>",
        "id": 153870652,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486512803
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> I guess that's what I'm struggling with; it looks to me like most cases are do-able with either ECL (which is already available via ValueSet) or a subsumption test.  But I suspect what's desired is something closer to smart selection of an appropriate template (as <span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span>  refers to).<br>\nAs we can see with the suspected lung cancer example, we quickly run into the boundary/impedance mismatch between the information model and the SNOMED concept model.<br>\n<span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> - yes that's what I'm after.  To implement this I need to know what the expected outcomes are and where it is reasonable to draw boundaries.</p>",
        "id": 153870707,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1486538862
    },
    {
        "content": "<p>I don't see how 'the cases' are do-able via value set </p>",
        "id": 153870717,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486554520
    },
    {
        "content": "<p>it's a completely different API </p>",
        "id": 153870718,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486554528
    },
    {
        "content": "<p>Is there a code system defined for MeSH (<a href=\"https://meshb.nlm.nih.gov\" target=\"_blank\" title=\"https://meshb.nlm.nih.gov\">https://meshb.nlm.nih.gov</a>)? I was looking for a reference here: <a href=\"http://build.fhir.org/terminologies-systems.html\" target=\"_blank\" title=\"http://build.fhir.org/terminologies-systems.html\">http://build.fhir.org/terminologies-systems.html</a>, but couldn't find anything. I am using the MeSH AgeGroupObservationValue value set in an example:</p>\n<div class=\"codehilite\"><pre>&quot;useContext&quot;: {\n      &quot;code&quot;: {\n        &quot;system&quot;: &quot;http://hl7.org/fhir/usage-context-type&quot;,\n        &quot;code&quot;: &quot;age&quot;\n      },\n      &quot;valueCodeableConcept&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;system&quot;: &quot;https://meshb.nlm.nih.gov&quot;,\n            &quot;code&quot;: &quot;D000328&quot;,\n            &quot;display&quot;: &quot;Adult&quot;\n          }\n        ]\n      }\n    }\n</pre></div>",
        "id": 153870771,
        "sender_full_name": "Christopher Schuler",
        "timestamp": 1486588056
    },
    {
        "content": "<p>- I have an observation with a code and no method, and an observation with a code and a method. Are they the same?<br>\nThis is a subsumption test with postcoordination of the second code + method</p>\n<p>- I have a condition with a code and a severity, and I have to convert it to a condition with a code that includes the severity (or vice versa)<br>\nThis is postcoordination (going forwards) or, to extract the severity, you would use the ECL and expand the ValueSet with compose.include.filter.{property = constraint, op = =, value = [code].severity}  -- this example seems to cover <a href=\"http://www.healthintersections.com.au/?p=658\" target=\"_blank\" title=\"http://www.healthintersections.com.au/?p=658\">http://www.healthintersections.com.au/?p=658</a> as well, I think.</p>\n<p>- I have an observation with a related observation about stage, does that represent a stage iV cancer of the type I am interested in<br>\nThis one is hard because:<br>\n   a) the question is not clearly defined - what is the valueset for the stage observation?  If it's &lt;&lt; Clinical stage finding then you're out of luck because these are not linked to specific cancers.  If it's &lt;&lt; Tumor stage finding then you're okay and the remaining question is how is \"of the type I am interested in\" represented?<br>\n  b) SNOMED is not particularly mature in representing (modelling) this information. Looking at Carcinoma of ovary, stage 4 and Carcinoma of colon, stage 4 there's no \"stage 4\" in the relationships, so the only way $compose or anything else is going to be able to answer this is with additional domain knowledge - where does this come from?</p>",
        "id": 153870781,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1486594462
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191897\">@Christopher Schuler</span> please create a task to define a URL for MeSH</p>",
        "id": 153870804,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486612234
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span>  I'll have to try and think about this tomorrow. my initial response is that maybe you're right, but oo do them with existing operations requires a lot of knowledge of SCT, and we're trying to get away from the client needing to know that</p>",
        "id": 153870805,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486612371
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span>   My server now returns<code>75857000 | Fracture of radius AND ulna (disorder) |</code> when you POST that query. It identifies when you pass &gt;1 parameter with the same attribute and reasons that there must be relationship grouping and adds the attributes of the focus concept to each group. Not sure how many more hoops I can jump through!<br>\n[Edit]...Updated process is now:<br>\na. Select the proximal primitive(s) of the Focus Concept posted in the request.<br>\nb. Detect multiple instances of the same attribute posted in the request (&gt;1 denotes relationship grouping).<br>\nc. If the Focus Concept is fully-defined, add any attribute/value pairs not included in the request (one for each group where grouping detected at stage b. above).<br>\nd. Select all concepts that have each of the combined set of attribute/value pairs AND the same proximal primitives as the Focus Concept.<br>\ne. Exclude all concepts that have additional attribute/value pairs to the combined set of attribute/value pairs.</p>",
        "id": 153870812,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486614358
    },
    {
        "content": "<p>[[@<strong>Peter Jordan</strong> ]] I'm still not sure about step b. Should multiple relationships of the same kind be necessary for matching multiple role groups? Or not? Did your query include an additional assoc.morphology=fracture part?  I think we need to more clearly specify what is expected from this operation. From comments it seems like the aim is for a lightweight ECL. I'll set up a google doc (ok?) with some examples and then we can discuss our (varying?) expectations on results.<br>\n<a href=\"https://docs.google.com/document/d/1fOftp1mjL0ypFioG0_AwbYmfgxg9tw1SR3ZqzOUWUIo/edit?usp=sharing\" target=\"_blank\" title=\"https://docs.google.com/document/d/1fOftp1mjL0ypFioG0_AwbYmfgxg9tw1SR3ZqzOUWUIo/edit?usp=sharing\">https://docs.google.com/document/d/1fOftp1mjL0ypFioG0_AwbYmfgxg9tw1SR3ZqzOUWUIo/edit?usp=sharing</a></p>",
        "id": 153870836,
        "sender_full_name": "Daniel Karlsson",
        "timestamp": 1486632702
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192129\">@Daniel Karlsson</span> For the <code>Fracture of radius AND ulna</code> example, I posted the same request as in your entry of 7th Feb above. As the focus concept is fully-defined <code>125605004 |Fracture of bone|</code>, I added the <code>Associated morphology=Fracture</code> attribute from that concept to the set of attributes (stage c. above) to the query executed at stage d. above. I'll try the examples on the Google Doc - it would be good to add these to the document...<br>\n1. Returns Operation Outcome - error - \"Must submit at least one Attribute/Value Pair Property\".  What else would you really expect if all that's posted in the query is a single focus concept?<br>\n2. Returns 73211009 | Diabetes mellitus |. Echoes back what was sent in the request as it's the only exact match. Good test of where a focus concept is its own proximal primitive (had to correct my T-SQL TVF to handle this!).</p>",
        "id": 153870935,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486681077
    },
    {
        "content": "<p>3. Returns <code>54556006 |Fracture of ulna|</code><br>\n4. Returns <code>75857000|Fracture of radius AND ulna|</code><br>\n5. Returns no exact matches - expected behaviour is not yet stated<br>\n6. Returns no exact matches (expected)<br>\n7. Returns no exact matches - expected behaviour</p>\n<p>It might be good to add some of the other, simpler, examples that work to the Google Doc to give a more positive perspective on the potential uses of the operation.</p>",
        "id": 153871119,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1486871315
    },
    {
        "content": "<p>$compose example in the spec (latest build) doesn't work on my Server or Grahame's (whether it should is up for debate, although passing a fully defined focus concept and expecting  a primitive in return may be unrealistic) and has an incorrect rendering of the exact parameter. Appreciate that it may be too late to change this for R3, unless examples can be changed in the Review process. Test 3 or 4 in Daniel's Google Doc would be better. </p>",
        "id": 153872199,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1487292727
    },
    {
        "content": "<p>it's not too late yet</p>",
        "id": 153872202,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487294895
    },
    {
        "content": "<p>close though</p>",
        "id": 153872203,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487294913
    },
    {
        "content": "<p>Successfully added [#12852] to gForge - assigned to Product Director due to shortage of time.  I used your example, near the top of this thread, that returns 65786009 |Bilirubin level - finding|.</p>",
        "id": 153872207,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1487296290
    },
    {
        "content": "<p>which is my bilirubin example <span class=\"user-mention\" data-user-id=\"191364\">@Peter Jordan</span> ?</p>",
        "id": 153872259,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487307770
    },
    {
        "content": "<p><code>&lt;Parameters xmlns=\"http://hl7.org/fhir\"&gt;\n  &lt;parameter&gt;\n    &lt;name value=\"system\"/&gt;\n    &lt;valueUri value=\"http://snomed.info/sct\"/&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=\"exact\"/&gt;\n    &lt;valueBoolean value=\"true\"/&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=\"property\"/&gt;\n    &lt;part&gt;\n      &lt;name value=\"code\"/&gt;\n      &lt;valueCode value=\"focus\"/&gt;\n    &lt;/part&gt;\n    &lt;part&gt;\n      &lt;name value=\"value\"/&gt;\n      &lt;valueCode value=\"118245000\"/&gt;\n    &lt;/part&gt;\n  &lt;/parameter&gt;\n  &lt;parameter&gt;\n    &lt;name value=\"property\"/&gt;\n    &lt;part&gt;\n      &lt;name value=\"code\"/&gt;\n      &lt;valueCode value=\"363714003\"/&gt;\n    &lt;/part&gt;\n    &lt;part&gt;\n      &lt;name value=\"value\"/&gt;\n      &lt;valueCode value=\"302787001\"/&gt;\n    &lt;/part&gt;\n  &lt;/parameter&gt;\n&lt;/Parameters&gt;</code></p>",
        "id": 153872265,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1487308325
    },
    {
        "content": "<p>thx</p>",
        "id": 153872267,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487308355
    },
    {
        "content": "<p>...returns<br>\n<code>&lt;Parameters xmlns=\"http://hl7.org/fhir\"&gt;\n    &lt;parameter&gt;\n        &lt;name value=\"match\" /&gt;\n        &lt;part&gt;\n            &lt;name value=\"code\" /&gt;\n            &lt;valueCoding&gt;\n                &lt;system value=\"http://snomed.info/sct\" /&gt;\n                &lt;code value=\"365786009\" /&gt;\n                &lt;display value=\"Bilirubin level - finding\" /&gt;\n            &lt;/valueCoding&gt;\n        &lt;/part&gt;\n    &lt;/parameter&gt;\n&lt;/Parameters&gt;</code></p>",
        "id": 153872268,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1487308451
    },
    {
        "content": "<p>so I'm going to refer this whole thread to Snomed International via Jane to ask that they confirm that this is the sort of thing SCT should be able to do, and that they consider how to be able to respond to the kind of problems this tthread has thrown up</p>",
        "id": 153872270,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487308712
    },
    {
        "content": "<p>Focus concept is <code>118245000 |Measurement finding|</code>  attributes  are <code>363714003 |Interprets|</code> = <code>302787001 |Bilirubin measurement|</code></p>",
        "id": 153872272,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1487308756
    },
    {
        "content": "<p>I look forward to their response with interest. FWIW, my take is that the glass is more than half full, and the operation will be of value to terminology clients. If it exposes some issues that will result in the improvement of both SCT and FHIR, that will be a good outcome all round.</p>",
        "id": 153872275,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1487309068
    },
    {
        "content": "<p>Looks like an overly elaborate way to query a terminology service to me. What's wrong with using the SNOMED CT Expression constraint language in a query?</p>",
        "id": 153872929,
        "sender_full_name": "Michael Osborne",
        "timestamp": 1487668610
    },
    {
        "content": "<p>because SCT is not the only terminology, and few people know the ECL, and I don't know how you would do what this actually does with ECL - ECL has the same logic, but this is not about logic, it's about how to expose the process to an application. ECL might well be part of the implementation for a server</p>",
        "id": 153872940,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487673995
    },
    {
        "content": "<p>actually ECL is a subset of the same logic </p>",
        "id": 153872941,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487674015
    },
    {
        "content": "<p>Is there a reason we have a CodeSystem resource for snomed (<a href=\"http://hl7.org/fhir/codesystem-snomedct.xml\" target=\"_blank\" title=\"http://hl7.org/fhir/codesystem-snomedct.xml\">http://hl7.org/fhir/codesystem-snomedct.xml</a>) but not for LOINC?</p>",
        "id": 153887477,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1494063404
    },
    {
        "content": "<p>LOINC asked us not to because they're going to host it themselves </p>",
        "id": 153887479,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1494063603
    },
    {
        "content": "<p>but here's what we've agreed:</p>",
        "id": 153887480,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1494063642
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/XT71ZEUJ6Fh5naPSmP9izQmp/loinc.xml\" target=\"_blank\" title=\"loinc.xml\">loinc.xml</a> </p>",
        "id": 153887481,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1494063666
    }
]