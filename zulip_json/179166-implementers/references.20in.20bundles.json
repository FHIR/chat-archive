[
    {
        "content": "<p>Context: <a href=\"http://build.fhir.org/bundle.html#references\" target=\"_blank\" title=\"http://build.fhir.org/bundle.html#references\">http://build.fhir.org/bundle.html#references</a> - this doesn't fully detail the required behavior of a server. </p>\n<p>If server A sends a Patient &amp; Observation transaction bundle to B, 2 POSTs, then the fullURLs of the patient and the observation will be (as an example) <a href=\"http://a.org/Patient/1\" target=\"_blank\" title=\"http://a.org/Patient/1\">a.org/Patient/1</a> and <a href=\"http://a.org/Observation/7\" target=\"_blank\" title=\"http://a.org/Observation/7\">a.org/Observation/7</a>. The reference from the Observation resource to the Patient resource will be to  <a href=\"http://a.org/Patient/1\" target=\"_blank\" title=\"http://a.org/Patient/1\">a.org/Patient/1</a>.<br>\nQuestion: should server B, when it stores the resources contained in this transaction bundle, replace the reference <a href=\"http://a.org/Patient/1\" target=\"_blank\" title=\"http://a.org/Patient/1\">a.org/Patient/1</a> with a reference to its own copy of that patient resource on server B, given that the Patient with that same fullURL was also contained in the transaction bundle ?</p>\n<p>(System A can force this behavior by just using UUIDs instead of URLs, but that's not the question)</p>",
        "id": 153978261,
        "sender_full_name": "René Spronk",
        "timestamp": 1532599648
    },
    {
        "content": "<p>I think yes. <br>\nThe text in the references paragraph states that server first tries to resolve the reference within the bundle, and hence arrives at the Patient/1 in the bundle. That Patient/1 is created on server B first, so the reference from Observation/7 must be replaced. (\"If the server assigns a new id to any resource in the bundle as part of the processing rules above, it SHALL also update any references to that resource in the same bundle as they are processed. \" - from <a href=\"http://build.fhir.org/http.html#transaction\" target=\"_blank\" title=\"http://build.fhir.org/http.html#transaction\">http://build.fhir.org/http.html#transaction</a>)</p>",
        "id": 153978278,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1532604038
    },
    {
        "content": "<p>Agree - <a href=\"http://build.fhir.org/http.html#3.1.0.18.2\" target=\"_blank\" title=\"http://build.fhir.org/http.html#3.1.0.18.2\">http://build.fhir.org/http.html#3.1.0.18.2</a> does answer the issue.</p>",
        "id": 153978290,
        "sender_full_name": "René Spronk",
        "timestamp": 1532605367
    },
    {
        "content": "<p>Dank voor het melden. Stuur je de transactie waarmee je dat getest hebt mee?<br>\nNoot: er is een al bekende beperking op de volgorde in transacties: <a href=\"http://docs.simplifier.net/vonk/features/restful_api.html#transaction\" target=\"_blank\" title=\"http://docs.simplifier.net/vonk/features/restful_api.html#transaction\">http://docs.simplifier.net/vonk/features/restful_api.html#transaction</a></p>",
        "id": 153978295,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1532605718
    }
]