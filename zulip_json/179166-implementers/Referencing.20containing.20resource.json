[
    {
        "content": "<p>Hi,<br>\nI am trying to reference the containing resource, however I continue to receive errors when I reference from inside of the contained resource. </p>\n<p>I will receive </p>\n<p>\"Unable to resolve resource '#person1'\", </p>\n<p>\"If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource ( (unmatched: provenance1)) [contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()]\" </p>\n<p>and \"SHALL have a contained resource if a local reference is provided ( (url: person1; ids: provenance1)) [reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))]\".</p>\n<p>Here is what I am trying to send: </p>\n<p>{<br>\n  \"id\": \"person1\",<br>\n  \"name\": [{<br>\n    \"given\": [\"Test\"],<br>\n    \"family\": \"User\"<br>\n  }],<br>\n  \"contained\": [ {<br>\n    \"id\": \"provenance1\",<br>\n    \"agent\": [{<br>\n      \"who\": {<br>\n        \"display\": \"Tester\"<br>\n      }<br>\n    }],<br>\n    \"target\": [{<br>\n      \"reference\": \"#person1\"<br>\n    }],<br>\n    \"recorded\": \"2015-06-27T08:39:24+10:00\",<br>\n    \"resourceType\": \"Provenance\"<br>\n  }],<br>\n  \"resourceType\": \"Person\"<br>\n}</p>\n<p>I believe I am doing the reference correctly with the #. Am I doing something else wrong? Thanks.</p>",
        "id": 162661378,
        "sender_full_name": "Josh Haskins",
        "timestamp": 1554498570
    },
    {
        "content": "<p>Try to put Provenance as the outer resource and Person as contained.</p>",
        "id": 163115783,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1555000367
    },
    {
        "content": "<p>To point from a contained resource to the container, the reference is just \"#\".  (See towards the end of <a href=\"http://hl7.org/fhir/references.html#contained\" target=\"_blank\" title=\"http://hl7.org/fhir/references.html#contained\">http://hl7.org/fhir/references.html#contained</a>)</p>",
        "id": 163134198,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1555014434
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> I must have missed that the other day when reading on referencing contained resources.</p>",
        "id": 163136015,
        "sender_full_name": "Josh Haskins",
        "timestamp": 1555015826
    },
    {
        "content": "<p>No worries.  There's more than a few things to read :)</p>",
        "id": 163136697,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1555016392
    }
]