[
    {
        "content": "<p>Could you help me out understanding what's going wrong? Attached is an xml instance (source) and a to json converted instance (of test patients)<br>\n<br>\nA nullFlavor extension is used on the .whenHandedOver element like this:<br>\n<code>\n&lt;whenHandedOver&gt;\n   &lt;extension url=\"http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor\"&gt;\n    &lt;valueCode value=\"NI\"/&gt;\n   &lt;/extension&gt;\n&lt;/whenHandedOver&gt;\n </code><br>\nThis is converted to json like this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"s2\">&quot;whenHandedOver&quot;</span><span class=\"err\">:</span> <span class=\"kc\">null</span><span class=\"err\">,</span>\n   <span class=\"s2\">&quot;_whenHandedOver&quot;</span><span class=\"err\">:</span> <span class=\"p\">{</span>\n                    <span class=\"nt\">&quot;extension&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                        <span class=\"p\">{</span>\n                            <span class=\"nt\">&quot;url&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor&quot;</span><span class=\"p\">,</span>\n                            <span class=\"nt\">&quot;valueCode&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;NI&quot;</span>\n                        <span class=\"p\">}</span>\n                    <span class=\"p\">]</span>\n                <span class=\"p\">}</span>\n<span class=\"err\">},</span>\n</pre></div>\n\n\n<p>The fhir validator (FHIR Validation tool Version 4.1.60-SNAPSHOT) gives an error for the json:</p>\n<blockquote>\n<p>Error @ Bundle.entry[1].resource.whenHandedOver (line 1, col5240) : This property must be an simple value, not a primitive property<br>\n<br>\nAnd for XML:</p>\n<p>Error @ Bundle.entry[1].resource.whenHandedOver (line 102, col32) : The extension <a href=\"http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor\" title=\"http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor\">http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor</a> is not allowed to be used at this point (allowed = e:Any; this element is [[Bundle.entry.resource.whenHandedOver, BackboneElement.resource.whenHandedOver, MedicationDispense.whenHandedOver, dateTime])</p>\n</blockquote>\n<p>I don’t know what’s going on here. Anyone an idea?</p>\n<p>I believe the extension is used correctly. <br>\nMy first attempt was to remove the null in json because that isn’t correct according to the FHIR spec. But doesn't remove the error for json and is of course not related to the xml validation error. <a href=\"/user_uploads/10155/3lqSGH3sUDgvYd04PEfTeBcG/Henegouwen.xml\" title=\"Henegouwen.xml\">Henegouwen.xml</a> <a href=\"/user_uploads/10155/lyDQTxyT6atjMKfimY6tNjN2/Henegouwen_null.json\" title=\"Henegouwen_null.json\">Henegouwen_null.json</a></p>",
        "id": 191880082,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1585227749
    },
    {
        "content": "<p>One of the error's looks related to the question in this zulip chat: <a href=\"#narrow/stream/179177-conformance/topic/Context.20for.20Normative.20Version\" title=\"#narrow/stream/179177-conformance/topic/Context.20for.20Normative.20Version\">https://chat.fhir.org/#narrow/stream/179177-conformance/topic/Context.20for.20Normative.20Version</a></p>",
        "id": 191888830,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1585231475
    },
    {
        "content": "<p><code>\"whenHandedOver\": null</code> is not valid.  You should only have the _whenHandedOver if you don't have a 'value'.</p>",
        "id": 191891435,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1585232657
    },
    {
        "content": "<p>I was aware that it was not valid. Validating after removing that part still produced the error's.</p>",
        "id": 191894398,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1585233901
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192301\">@Ardon Toonstra</span> what version of FHIR is this for? I don't get an error from the validator</p>",
        "id": 191968022,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585271256
    },
    {
        "content": "<p>r3.0. I can fix that</p>",
        "id": 191971879,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585277145
    },
    {
        "content": "<p>but this... </p>\n<blockquote>\n<p>This property must be an simple value, not a primitive property</p>\n</blockquote>\n<p>should read </p>\n<blockquote>\n<p>This property must be an simple value, not a null</p>\n</blockquote>\n<p>will be fixed</p>",
        "id": 191971931,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585277189
    },
    {
        "content": "<p>It was indeed STU3. Thnx Grahame for the confirmation.</p>",
        "id": 191988729,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1585298457
    }
]