[
    {
        "content": "<p>We have an environment where resources can be 'enriched' by means of an external service at read time. For example, a terminology lookup that 'normalizes' a condition.code, or lookup a provider details based on an identifier .   If the service is unavailable at the time of querying, we want to indicate that to the client, while returning the data that we have. This could occur on both a search or read of a single resource. What's the best way to do this? A resource tag (like 'subsetted'?) . An operationOutcome would give more detail, but doesn't apply for a single resource read - and in any case, only some of the resources in the query may have been effected...</p>",
        "id": 153904413,
        "sender_full_name": "David Hay",
        "timestamp": 1504578795
    },
    {
        "content": "<p>a tag of \"unenriched\" ? <img alt=\":simple_smile:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f642.png\" title=\":simple_smile:\"></p>",
        "id": 153904415,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1504581971
    },
    {
        "content": "<p>On a query response, I'd probably provide an OperationOutcome.  Not sure about what to do with a Read though</p>",
        "id": 153904417,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1504582145
    },
    {
        "content": "<p>trouble is we still need something on each resource, as not all may have been effected. And we did think of a custom tag :)</p>",
        "id": 153904419,
        "sender_full_name": "David Hay",
        "timestamp": 1504589470
    },
    {
        "content": "<p>It does seem like a tag to indicate that the data was enhanced / enriched is possibly useful. How would you expect to represent this enrichment with Provenance? I would hope that this enrichment is represented by a version... and that version would have a Provenance. Even here, I don't see a good code for what type of Provenance activity or agent you have. This seems like an important gap. Might need FHIR-I, Vocab to give Security some guidance. Presumably some vocabulary value exists to indicate computer aided enrichment. It is just not  in my known vocabulary.</p>",
        "id": 153904438,
        "sender_full_name": "John Moehrke",
        "timestamp": 1504613334
    },
    {
        "content": "<p>I see this post is kind of old but maybe FHIR has better ways to do it now :) . I am facing a similar task.  We also thought of using a tag to indicate the resource was \"enriched\" . My question is, what is the proper way to indicate what elements were enriched by the external service? </p>\n<p>For example, the response did not include the patient address, but my external service was able to fetch the address and add it to the FHIR response. I am not sure if a Provenance resource might be helpful, it does feel like an extension is a way to go.</p>",
        "id": 243704487,
        "sender_full_name": "Amit Cudykier",
        "timestamp": 1624478396
    },
    {
        "content": "<p>As an immediate response, you would echo back what was actually stored (allowing the client to see what had changed/been enriched) or an OperationOutcome with warning/information messages noting what changes were made.</p>\n<p>After the fact, the only way to see where data came from is Provenance.  I believe there are some standard extensions for allowing details to be tracked on a resource element level rather than a \"resource as a whole\" level.  <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span>?</p>",
        "id": 243941016,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1624639499
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> there is a FHIR-I approved CR, but it has not yet been applied and not enough details in the CR for me to understand what the plan is.  <a href=\"https://jira.hl7.org/browse/FHIR-21284\">https://jira.hl7.org/browse/FHIR-21284</a></p>",
        "id": 243942642,
        "sender_full_name": "John Moehrke",
        "timestamp": 1624640330
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  . How will you handle the case where the client is trying to READ a FHIR resource? and you want to enrich data<br>\nI am not really sure,  is it appropriate to send back a bundle resource with the resource that the client wanted to read and the operation outcome resource (I do not think so)?</p>",
        "id": 243952418,
        "sender_full_name": "Amit Cudykier",
        "timestamp": 1624645427
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span>  thank you for sharing the CR. I will monitor it.  I am new to the CR process. What are the next steps to move this CR forward? We are happy to help however we can.<br>\nWe would love to develop a solution for our use case endorsed and accepted by the community.</p>",
        "id": 243953304,
        "sender_full_name": "Amit Cudykier",
        "timestamp": 1624645865
    },
    {
        "content": "<p>FHIR presumes that if data changes, the _lastUpdated timestamp changes and the version changes.  The 'version' and _lastUpdated are important to managing update collisions and having polling work.  So either you need to update your stored copy at the time you receive the new information or at the time the original POST comes in.  Doing it at time of read is likely to cause grief because every time someone looks at the data it's treated as if it's changed.</p>",
        "id": 243970641,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1624655119
    }
]