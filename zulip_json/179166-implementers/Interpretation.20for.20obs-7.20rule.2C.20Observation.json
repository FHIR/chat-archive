[
    {
        "content": "<p>Hello!<br>\nWe have a dilemma regarding how we should interpret the rule obs-7 present for Observation:<br>\n<strong>“If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present” </strong><br>\nWe wonder if for this rule we should compare <br>\n1.  Observation.code.coding.code with Observation.componenet.code.coding.code <br>\n2.  Observation.code.coding with Observation.componenet.code.coding<br>\n3.  The entire tree Observation.code vs Observation.component.code</p>\n<p>If we compare the entire tree then the example below would respect the rule because <em>Observation.code.text</em> is different from <em>Observation.component.code.text</em>, even if <em>Observation.code.coding = Observation.component.coding</em>:</p>\n<p><strong>Observation.code</strong><br>\n\"code\": {<br>\n          \"text\": \"text\",<br>\n          \"coding\": [<br>\n            {<br>\n              \"system\": <a href=\"http://loinc.org\">http://loinc.org</a>,<br>\n              \"code\": \"9279-1\",<br>\n              \"display\": \"Respiratory rate\"<br>\n            }<br>\n          ]<br>\n        },</p>\n<p><strong>Observation.component.code</strong></p>\n<p>\"code\": {<br>\n              \"text\": \"some text\",<br>\n              \"coding\": [<br>\n                {<br>\n                  \"system\": <a href=\"http://loinc.org\">http://loinc.org</a>,<br>\n                  \"code\": \"9279-1\",<br>\n                  \"display\": \"Respiratory rate\"<br>\n                }<br>\n              ]<br>\n            },</p>\n<p>If I validate the example above on <a href=\"http://clinfhir.com/validateResource.html\">http://clinfhir.com/validateResource.html</a> with “Ontoserver R4” then obs-7 rule will fail (we have the same code.coding)<br>\nI validated the example above with “FHIR test 4” on the same site and received no errors. </p>\n<p>The question is: is it the rule wrongly expressed ( it should state “If Observation.code.coding is the same as an Observation.component.code.coding...\") or the validators don’t do the write comparison and we should actually compare Observation.code vs Observation.component[x].code ?</p>\n<p>Thanks in advance!</p>",
        "id": 244264465,
        "sender_full_name": "Constantin Corman",
        "timestamp": 1624965189
    },
    {
        "content": "<p>It's looking for a match on any of the codings.  If there's a coding in the Observation.code that is the same as a coding in an Observation.component.code, the invariant will trigger.  What's in CodeableConcept.text doesn't matter.  I don't know whether the compare on the coding pays any attention to Coding.display.</p>",
        "id": 244284171,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1624974842
    }
]