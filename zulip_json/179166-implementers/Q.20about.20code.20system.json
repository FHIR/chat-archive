[
    {
        "content": "<p>why is there difference between  <a href=\"http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#immunization\">http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#immunization</a> <br>\nGET [base]/Immunization?patient=[patient]&amp;status=[status]<br>\nand <a href=\"http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-immunization.html\">http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-immunization.html</a><br>\nGET [base]/Immunization?patient=[reference]&amp;status={system|}[code]</p>\n<p>difference is in the code system:<br>\nstatus={system|}[code] versus status=[status]<br>\nwhy?</p>",
        "id": 277158114,
        "sender_full_name": "Lital Inghel",
        "timestamp": 1648652397
    },
    {
        "content": "<p>Likely just typing convention/clarity/copy-paste/etc.</p>\n<p>The <code>status</code> search parameter is defined as type <code>token</code>, so including the system is optional.  Given that <code>Immunization.status</code> has a required binding to the <a href=\"http://hl7.org/fhir/R4/valueset-immunization-status.html\">ImmunizationStatusCodes</a> value set, and that the value set only includes codes from a single code system, it is generally not necessary.</p>",
        "id": 277161921,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1648653929
    },
    {
        "content": "<p>this is really confusing and it is all over the IG.</p>\n<p>so what about Encounter type token <br>\nin <a href=\"http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#encounter\">http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#encounter</a><br>\nit says:<br>\nGET [base]/Encounter?patient=[patient]&amp;type=[system]|[code]</p>\n<p>versus<br>\nGET [base]/Encounter?patient=[reference]&amp;type={system|}[code]<br>\nin<br>\n<a href=\"http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-encounter.html\">http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-encounter.html</a></p>\n<p>so which query is correct?<br>\ntype=[system]|[code] or {system|}[code]?</p>",
        "id": 277163218,
        "sender_full_name": "Lital Inghel",
        "timestamp": 1648654542
    },
    {
        "content": "<p>They are all token search parameter, they all have the same structure, that is in the base FHIR specs - what is confusing?</p>",
        "id": 277164263,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1648655043
    },
    {
        "content": "<p>what is the correct query:<br>\nGET [base]/Encounter?patient=[patient]&amp;type=[system]|[code]  <br>\nversus<br>\nGET [base]/Encounter?patient=[reference]&amp;type={system|}[code]</p>",
        "id": 277164360,
        "sender_full_name": "Lital Inghel",
        "timestamp": 1648655103
    },
    {
        "content": "<p>Technically, the <code>token</code> search parameter is defined (<a href=\"https://www.hl7.org/fhir/search.html#token\">here</a>) so that both are allowed.  The difference is that if you do not include a system, the code could be a value from another system that has the same code.  For example, if you have patients with both <code>http://example.org/codesystem/what_I_want#code</code> and <code>http://example.org/codesystem/bad_system#code</code>, passing in just <code>code</code> will match either, but passing in the system allows you to distinguish between them.</p>\n<p>In cases where there is only a single system possible (e.g., a required binding that only has codes from a single system), there is no difference other than syntax.</p>\n<p>That said, if you are finding it hard to differentiate in US Core, I would suggest filing a ticket asking for consistency in the examples.</p>",
        "id": 277164440,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1648655144
    },
    {
        "content": "<p>{} vs [] has different meaning</p>",
        "id": 277164470,
        "sender_full_name": "Lital Inghel",
        "timestamp": 1648655155
    },
    {
        "content": "<p>The curly braces are just showing optionality.  Token always has it <em>defined</em> as optional, but in specific use cases it may be:</p>\n<ul>\n<li>not useful (e.g., required binding from one system)</li>\n<li>optional (e.g., multiple systems, but no code overlaps)</li>\n<li>required (e.g., known codes from multiple systems)</li>\n</ul>",
        "id": 277164707,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1648655271
    },
    {
        "content": "<p>the curly is what i expected to see in the capability statement page of the IG. instead it is [].</p>",
        "id": 277165021,
        "sender_full_name": "Lital Inghel",
        "timestamp": 1648655412
    },
    {
        "content": "<p>also if token means the parameter can be either <br>\ncode, <br>\ncode+system, <br>\nsystem alone, <br>\nwhy system is not in curly {} as well?</p>",
        "id": 277177577,
        "sender_full_name": "Lital Inghel",
        "timestamp": 1648660393
    },
    {
        "content": "<p>(I assume you mean why is code not in curly braces)<br>\nLimitation of syntax - it is difficult to convey that multiple things are optional but at least one segment is required.  The definition of the type has all the details (which is several paragraphs) and inline examples just do the best they can.  Showing every combination on every example is not feasible.</p>",
        "id": 277178842,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1648660958
    },
    {
        "content": "<p>This syntax in profile is correct. Those in CapabilityStatement are \"examples\"</p>\n<p>US Core v4.0 remove those examples (because they are confusing) and add a further clarification about that syntax:</p>\n<p>When searching using the token type searchparameter (how to search by token), the syntax {system|}[code] means that the system value is optional for the client to supply.:</p>\n<ul>\n<li>The client SHALL provide at least a code value and MAY provide both the system and code values.</li>\n<li>The server SHALL support both.</li>\n</ul>",
        "id": 277468916,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1648842182
    },
    {
        "content": "<p>I am not sure if US core is trying to restrict to that, but that is not generally true for token searches.  All of the following are defined as valid:</p>\n<ul>\n<li><code>[parameter]=[code]</code> (just code)</li>\n<li><code>[parameter]=[system]|[code]</code> (system and code)</li>\n<li><code>[parameter]=|[code]</code> (code that explicitly has no system)</li>\n<li><code>[parameter]=[system]|</code> (just system).</li>\n</ul>\n<p>I am not sure of a way to express that in a single line, and asking IGs to express every combination every time does not feel realistic.</p>",
        "id": 277469354,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1648842481
    },
    {
        "content": "<p>Yes All four formats are valid. US Core requires server to support token search using the first two formats (ie code and system|code). Server can implement token search with all four formats.</p>",
        "id": 277469698,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1648842700
    }
]