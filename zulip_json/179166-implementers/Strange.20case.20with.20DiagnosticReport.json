[
    {
        "content": "<p>Hi!</p>\n<p>I am using HAPI and faced strange case with DiagnosticReport.<br>\nI add 3 Observation into DiagnosticReport.getContained(), but in output JSON doesn't have 'contained' section at all.</p>\n<p>Could you help me with any advise why that can be possible?</p>\n<p>Thanks</p>",
        "id": 158513818,
        "sender_full_name": "Valeriy Shtanko",
        "timestamp": 1550135051
    },
    {
        "content": "<p>I believe HAPI removes contained resources if they are not being referenced by the containing resource.</p>\n<p>This should work.</p>\n<p>Patient pat = new Patient();<br>\npat.setActive(true);<br>\n// do not set an id for pat; HAPI will automatically assign ids for contained resources<br>\nObservation obs = new Observation();<br>\nobs.setSubject(new Reference(pat));</p>\n<p>In here, patient is being added as a contained resource to observation.</p>",
        "id": 158518097,
        "sender_full_name": "Michael Calderero",
        "timestamp": 1550139633
    },
    {
        "content": "<p>Hi Micheal!</p>\n<p>Thank you for good advise.<br>\nI try to do in that way.<br>\nBut in my case I want add Observation to DiagnosticReport as contained resource.<br>\nIt is should be possible, I see examples on test server.</p>\n<p>But by some unknown me reason it doesn't work in my case.</p>",
        "id": 158521784,
        "sender_full_name": "Valeriy Shtanko",
        "timestamp": 1550143500
    },
    {
        "content": "<p>You can't just go and do:</p>\n<div class=\"codehilite\"><pre><span></span>mydiagnosticreport.getContained().add(myobs);\n</pre></div>\n\n\n<p>You have to do something like (in your case):</p>\n<div class=\"codehilite\"><pre><span></span>Observation obs = new Observation();\n// set observation fields; do not set resource id\nDiagnosticReport diagRpt = new DiagnosticReport();\ndiagRpt.addResult(new Reference(obs));\n</pre></div>",
        "id": 158523335,
        "sender_full_name": "Michael Calderero",
        "timestamp": 1550145299
    },
    {
        "content": "<p>Thank you! Thank you a lot!  You saved my life!<br>\nIt works now as I want.</p>\n<p>Could I ask one more question?</p>\n<p>I have four STRINGS values which I want put into Observation: </p>\n<div class=\"codehilite\"><pre><span></span> name of analysis,  result of analysis, unit of measurement, result interval\n</pre></div>\n\n\n<p>Could you advice me a way which I can do it?<br>\nI cannot use Quantity because it accepts only numeric result of analysis and result interval?</p>",
        "id": 158524549,
        "sender_full_name": "Valeriy Shtanko",
        "timestamp": 1550146677
    },
    {
        "content": "<p>Are those the actual literal values you want to put into an Observation? Or those are just field names and you are trying to put into an Observation the following example?</p>\n<div class=\"codehilite\"><pre><span></span>Systolic BP, 120, mm<span class=\"k\">[Hg]</span>, 100-120\n</pre></div>",
        "id": 158529167,
        "sender_full_name": "Michael Calderero",
        "timestamp": 1550151356
    },
    {
        "content": "<p>I need to put these literal values into observations.<br>\nThe best way which I found is using Observation.component:<br>\n         {<br>\n            \"resourceType\": \"Observation\",<br>\n            \"id\": \"1\",<br>\n            \"component\": [<br>\n                {<br>\n                    \"id\": \"name-of-analysis\",<br>\n                    \"valueString\": \"a1\"<br>\n                },<br>\n                {<br>\n                    \"id\": \"result-of-analysis\",<br>\n                    \"valueString\": \"a2\"<br>\n                },<br>\n                {<br>\n                    \"id\": \"unit-of-measurement\",<br>\n                    \"valueString\": \"a3\"<br>\n                },<br>\n                {<br>\n                    \"id\": \"reference-interval\",<br>\n                    \"valueString\": \"a4\"<br>\n                }<br>\n            ]<br>\n        }</p>\n<p>But it does't look good. May be \"more FHIR\" way exists?</p>",
        "id": 158530101,
        "sender_full_name": "Valeriy Shtanko",
        "timestamp": 1550152220
    },
    {
        "content": "<p>Not sure what you're trying to model, but in my opinion I would map your:<br>\n1. <code>name of analysis</code> to <code>Observation.code</code><br>\n2. <code>result of analysis</code> to <code>Observation.valueQuantity.value</code><br>\n3. <code>unit of measurement</code> to <code>Observation.valueQuantity.unit</code> or <code>Observation.valueQuantity.code</code><br>\n4. <code>reference-interval</code> to <code>Observation.referenceRange</code></p>\n<p>See this example: <a href=\"http://hl7.org/fhir/STU3/observation-example-f001-glucose.json.html\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/observation-example-f001-glucose.json.html\">http://hl7.org/fhir/STU3/observation-example-f001-glucose.json.html</a></p>",
        "id": 158530596,
        "sender_full_name": "Michael Calderero",
        "timestamp": 1550152688
    },
    {
        "content": "<p>I cannot use Observation.valueQuantity.value, because in my case result of analysis is string, which not garanteed to be representation of numeric value.</p>\n<p>The same about Observation.referenceRange and my referenceinterval.</p>",
        "id": 158532052,
        "sender_full_name": "Valeriy Shtanko",
        "timestamp": 1550154069
    },
    {
        "content": "<p>I suggest you spend some time reading the Observation definition. Observation.value[x] is a \"choice type\" (aka variable type), and will accept values of many different data types.</p>",
        "id": 158532288,
        "sender_full_name": "Craig McClendon",
        "timestamp": 1550154277
    },
    {
        "content": "<p>It might be helpful to understand what you are modeling as well. Having a unit of measure for a string value is not common.</p>",
        "id": 158532439,
        "sender_full_name": "Craig McClendon",
        "timestamp": 1550154441
    },
    {
        "content": "<p>I am already doing that - reading documentation and sources.<br>\nObservation.value[x] can accept restricted set of type and no one can satisfy my crazy uncommon case.</p>\n<p>Thank you a lot for your help.</p>",
        "id": 158537575,
        "sender_full_name": "Valeriy Shtanko",
        "timestamp": 1550157951
    },
    {
        "content": "<p>Be careful in your use of 'contained'.  It's not a packaging/delivery mechanism.  In general, the Observations within a DiagnosticReport should be able to stand independently, which means they should not be sent as 'contained' resources - they should be independent resources.  If you need to send them alongside the DiagnosticReport, look at the batch or transaction mechanisms.</p>",
        "id": 158539555,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1550159280
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"201776\">@Valeriy Shtanko</span> To keep things in topic, I believe your original question is largely answered. Lloyd also gives a good recommendation that you should think about.</p>\n<p>I would suggest creating a new topic thread for your other question so answers and replies for that topic can be focused to that one instead.</p>",
        "id": 158540370,
        "sender_full_name": "Michael Calderero",
        "timestamp": 1550159763
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> , <span class=\"user-mention\" data-user-id=\"193952\">@Michael Calderero</span> </p>\n<p>Thank you.<br>\nI agree, It is right to work with Observation as  independent resource and I will try to do it in that way in nearest future.<br>\nBut at the moment, I have what I have.</p>",
        "id": 158541966,
        "sender_full_name": "Valeriy Shtanko",
        "timestamp": 1550161046
    }
]