[
    {
        "content": "<p>Hello, <br>\nWe are having issues with the IG publisher hanging at a particular point and have figured out that it has something to do with our company network - not the IG publisher specifically. If we run the same inputs via our home network or via our personal mobile hotspots, all is well. As such we are hypothesising that there may have been some firewall changes that are causing the problem. Note that a few weeks ago, there were no problems and it ran well. I have logged a ticket with our internal IT to try to progress things from that end, but I am wondering if there may be some pointers from this community as to where the problem may lie.</p>\n<p>Our implementation guide has profiles that are formally derived from various profiles in the <a href=\"http://build.fhir.org/ig/hl7au/au-fhir-base/index.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/hl7au/au-fhir-base/index.html\">HL7 Australia 'au-fhir-base' IG</a>. For example, we have a patient profile derived from the HL7 Au patient profile etc. The json controller file contains this source as a dependencyList entry.<br>\nRunning a recent IG publisher v3.1.0-12604 (however the version doesn't affect the problem behaviour).<br>\nWe have also added full verbose logging in the json controller file to better see what is going on. Running the IG publisher on the command line gives the following output:</p>\n<div class=\"codehilite\"><pre><span></span>......\nCheck Generate C:\\work\\git\\dh-participants-ig-forge\\qa\\tbl_spacer.png            (24.0373sec)\nCheck Generate C:\\work\\git\\dh-participants-ig-forge\\temp\\tbl_spacer.png          (24.0374sec)\nInitialization complete                                                          (24.0376sec)\nLoad Content                                                                     (24.0377sec)\nProcessing Conformance Resources                                                 (25.0628sec)\nprocess type: NamingSystem                                                       (25.0628sec)\nprocess type: CodeSystem                                                         (25.0628sec)\nprocess type: ValueSet                                                           (25.0628sec)\nprocess type: ConceptMap                                                         (25.0628sec)\nprocess type: DataElement                                                        (25.0628sec)\nprocess type: StructureDefinition                                                (25.0628sec)\nprocess res: patient-australianhuman-base                                        (25.0629sec)\n</pre></div>\n\n\n<p>At the point of the first structure definition resource, the command line output just hangs there without further progress and there are no other indications of failure. At this point, if we then switch networks to our personal hotspot, the output then resumes and completes within an expected timeframe.<br>\nWe are at a loss as to what is specifically occurring at this point of the process in order to inform our IT staff. Any ideas? I'd be happy to provide any further info, not sure what extra helps at the moment.</p>",
        "id": 153926361,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1513728963
    },
    {
        "content": "<p>Do you have the dependency as a source file as well as a url (location)?  <br>\ne.g.,</p>\n<div class=\"codehilite\"><pre><span></span> &quot;dependencyList&quot;: [\n\n    {\n       &quot;name&quot; : &quot;uscore&quot;,\n       &quot;location&quot; : &quot;http://hl7.org/fhir/us/core&quot;,\n       &quot;source&quot; : &quot;definitions.json.zip&quot;\n    }\n</pre></div>\n\n\n<p>also you can run the run the  ig publisher - to run without a terminology server use the '-tx N/A' option and see if that is the issue</p>",
        "id": 153926380,
        "sender_full_name": "Eric Haas",
        "timestamp": 1513740182
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>, </p>\n<p><strong>Re dependencyList source</strong><br>\nWell spotted. We didn't have the source file listed. But actually, after adding it and when the publisher is then run (with no other changes) this error is given:</p>\n<div class=\"codehilite\"><pre><span></span>Connect to Terminology Server at http://tx.fhir.org/r3                           (16.0757sec)\nTerminology Server Version has changed from 1.0.152 to 1.0.198, so clearing txCache (18.0994sec)\nLoad aubase (http://build.fhir.org/ig/hl7au/au-fhir-base) from definitions.json.zip (19.0253sec)\nPublishing Content Failed: C:\\work\\git\\dh-participants-ig-forge\\definitions.json.zip\\definitions.xml.zip (The system cannot find the path specified) (19.0254sec)\n                                                                                 (19.0254sec)\nUse -? to get command line help                                                  (19.0254sec)\n                                                                                 (19.0254sec)\nStack Dump (for debugging):                                                      (19.0254sec)\njava.io.FileNotFoundException: C:\\work\\git\\dh-participants-ig-forge\\definitions.json.zip\\definitions.xml.zip (The system cannot find the path specified)\n        at java.io.FileInputStream.open0(Native Method)\n        at java.io.FileInputStream.open(Unknown Source)\n        at java.io.FileInputStream.&lt;init&gt;(Unknown Source)\n        at java.io.FileInputStream.&lt;init&gt;(Unknown Source)\n        at org.hl7.fhir.igtools.publisher.Publisher.fetchDefinitions(Publisher.java:1211)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:1120)\n        at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:855)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:342)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:3969)\nException in thread &quot;main&quot; java.lang.NullPointerException\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:3979)\n</pre></div>\n\n\n<p>This file does exist within the resources folder.</p>\n<p><strong>Re switching off the terminology server:</strong><br>\nReverting the IG json controller file to remove the dependency source file and running the IG publisher with <code>-tx N/A</code> then does successfully complete (along with the expected warnings about \"running without terminology server\" etc).</p>\n<p>When I combine both of the above, I still get the stack dump error listed first.</p>",
        "id": 153926414,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1513744956
    },
    {
        "content": "<p>The IT staff have indicated there is a known issue with our network regarding authentication handshaking with various websites. And it seems that the FHIR terminology server is now one of them!</p>",
        "id": 153926422,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1513748360
    },
    {
        "content": "<p>When has this started to happen <span class=\"user-mention\" data-user-id=\"192270\">@Rob Eastwood</span> ?</p>",
        "id": 153926426,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1513751069
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span></p>",
        "id": 153926428,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1513751103
    },
    {
        "content": "<p>A couple of weeks ago. IT have been making network changes.</p>",
        "id": 153926429,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1513751138
    },
    {
        "content": "<p>We can run the ig publisher from home.</p>",
        "id": 153926430,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1513751189
    },
    {
        "content": "<p><code>C:\\work\\git\\dh-participants-ig-forge\\definitions.json.zip\\definitions.xml.zip</code> is not a valid path   looks like definitions.xml.zip  is appended to the definitions.json.zip</p>",
        "id": 153926432,
        "sender_full_name": "Eric Haas",
        "timestamp": 1513754675
    },
    {
        "content": "<p>if it runs w/o hitting the terminology server then that  could be the network firewall issue.</p>",
        "id": 153926434,
        "sender_full_name": "Eric Haas",
        "timestamp": 1513754750
    },
    {
        "content": "<p>are they forcing the use of ssl?</p>",
        "id": 153926450,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1513764344
    },
    {
        "content": "<p>Thanks guys for your input.</p>\n<p><span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span> - it started on (or 1 day either side of) Tues Dec 5</p>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - not sure about the specifics re SSL but I will put that to the IT guys</p>\n<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> - yes this is very curious and it seems to be a second (probably related?) problem. The file <code>definitions.json.zip</code> is located in the resources folder but its content neither includes a <code>definitions.xml.zip</code>or definitions for the specific dependency; that is, it has a bunch of 'us-core' related definitions. This originates from the <a href=\"https://github.com/Healthedata1/IG-Template\" target=\"_blank\" title=\"https://github.com/Healthedata1/IG-Template\">Healthedata1 template</a> that we commenced using some months ago and this zip file has not been updated since. So I have followed the file structure of the Healthedata1 template re the dependencies folders, copied in the definitions.json.zip file from the actual dependency and now the error does not occur. The json controller file now has the added line indicated below:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;dependencyList&quot;: [{\n       &quot;name&quot; : &quot;aubase&quot;,\n       &quot;location&quot; : &quot;http://build.fhir.org/ig/hl7au/au-fhir-base&quot;,\n        &quot;source&quot;: &quot;dependencies/aubase&quot;    &lt;&lt;&lt;&lt; Added this line\n    }]\n</pre></div>\n\n\n<p>Thanks for pointing me in the right direction.</p>",
        "id": 153926556,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1513812871
    },
    {
        "content": "<p>Oh, just to confirm - the above changes re the dependencyList source eliminates the stack dump error listed above, but the IG publisher still only completes its run using the no terminology server switch (<code>-tx N/A</code>)</p>",
        "id": 153926561,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1513813789
    },
    {
        "content": "<p>Hello <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - re SSL: it looks like at the time of this problem starting, SSL started being enforced (yet to be confirmed but all indications are so). We are still seeking assistance from our IT guys, but is there anything we can do via running the publisher that can help? Thank you</p>",
        "id": 153928052,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1515451966
    },
    {
        "content": "<p>remind me what the actual error is?</p>",
        "id": 153928053,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1515452100
    },
    {
        "content": "<p>Well, there isn't an actual error per se as the output just hangs at the point it starts processing the first structure definition file. With full logging turned on the output just stops at this (initial output truncated for brevity):</p>\n<div class=\"codehilite\"><pre><span></span>.....\nCheck Generate C:\\work\\git\\dh-participants-ig-forge\\qa\\tbl_spacer.png            (18.0083sec)\nCheck Generate C:\\work\\git\\dh-participants-ig-forge\\temp\\tbl_spacer.png          (18.0084sec)\nInitialization complete                                                          (18.0085sec)\nLoad Content                                                                     (18.0085sec)\nProcessing Conformance Resources                                                 (18.0954sec)\nprocess type: NamingSystem                                                       (18.0964sec)\nprocess type: CodeSystem                                                         (18.0964sec)\nprocess type: ValueSet                                                           (18.0964sec)\nprocess type: ConceptMap                                                         (18.0964sec)\nprocess type: DataElement                                                        (18.0964sec)\nprocess type: StructureDefinition                                                (18.0965sec)\nprocess res: patient-australianhuman-base                                        (18.0965sec)\n</pre></div>",
        "id": 153928058,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1515453303
    },
    {
        "content": "<p>maybe you'll have to run it under the debugger?</p>",
        "id": 153928059,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1515454962
    },
    {
        "content": "<p>Thanks Grahame - not sure what you mean by that (did a search on zulip and the IG publisher wiki). Not sure if you mean the logging outputs, as I have put this into the ig.json file:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;logging&quot;: [&quot;init&quot;, &quot;progress&quot;, &quot;context&quot;, &quot;html&quot;, &quot;tx&quot;],\n</pre></div>\n\n\n<p>Could you poke me in the right direction please</p>",
        "id": 153928061,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1515455563
    },
    {
        "content": "<p>all the source is in the main svn (under \\build) - use eclipse and run the IG publisher under the java debugger.</p>",
        "id": 153928062,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1515455621
    },
    {
        "content": "<p>maybe someone in Phil's team can help</p>",
        "id": 153928063,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1515455632
    },
    {
        "content": "<p>ok thanks Grahame :)</p>",
        "id": 153928064,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1515455671
    }
]