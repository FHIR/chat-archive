[
    {
        "content": "<p>We have several FHIR based APIs on different versions of FHIR. If we need to implement Patient/[id]/$everything, would this be compliant to return a bundle with resources of different FHIR versions (e.g. Patient on STU3, Immunization on DSTU2.1 and MedicationDispense on R4)? Should we indicate a version of each resource in meta.profile as per an example at <a href=\"http://www.hl7.org/fhir/R4/versioning.html#mp-version\" target=\"_blank\" title=\"http://www.hl7.org/fhir/R4/versioning.html#mp-version\">http://www.hl7.org/fhir/R4/versioning.html#mp-version</a>?</p>",
        "id": 160137074,
        "sender_full_name": "Igor Sirkovich",
        "timestamp": 1551908419
    },
    {
        "content": "<p>it's not compliant to mix versions within a single bundle - which has a version of it's own. None of the reference implementations can handle it, and I can't imagine how I'd change a RI to handle it either.</p>",
        "id": 160137485,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551908715
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> . I think it's fine for the Reference Implementation to support only one version as it's actually been built for each version of FHIR. However, I'm not sure if it's realistic to expect that every organization (especially if it's large/complex one) that supports FHIR based APIs for multiple lines of business, would have all their APIs on the same version of FHIR. Each of the lines of business has its own budget, resources, customers and might choose to migrate to a newer version of FHIR on their own timelines or might decide to skip a newer version and wait for the following one. If $everything with a mix of version is not compliant, wouldn't this preclude implementation of this operation in large organizations?</p>",
        "id": 160140721,
        "sender_full_name": "Igor Sirkovich",
        "timestamp": 1551909580
    },
    {
        "content": "<blockquote>\n<p>I'm not sure if it's realistic to expect that every organization would have all their APIs on the same version of FHIR</p>\n</blockquote>\n<p>of course that is not realistic, nor expected and plenty of orgs are already not in that position</p>",
        "id": 160144515,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551910170
    },
    {
        "content": "<blockquote>\n<p>If $everything with a mix of version is not compliant, wouldn't this preclude implementation of this operation in large organizations?</p>\n</blockquote>\n<p>Well, maybe. But just because something is desired doesn't mean it is possible</p>",
        "id": 160144545,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551910198
    },
    {
        "content": "<p>it's more possible to handle multiple versions in bulk data mode, where each file has it's own mime type, which can inform a loader ...</p>",
        "id": 160144654,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551910238
    },
    {
        "content": "<p>What you might need to do is invoke $everything on a version specific basis for each version if the endpoint can't handle data conversion.  (Note that executable mappings are provided for DSTU2 to STU3 and STU3 to R4 so it's not (quite) as onerous to support multiple versions of FHIR as it has been with other standards.</p>",
        "id": 160149638,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1551913465
    },
    {
        "content": "<p>It's not so much about mapping on the server side, but mostly about the clients who have been consuming our line of business APIs on different FHIR versions. Now we want to give them an option to get data from all the APIs in one call, but using versions that they have already been supporting, i.e. they just need to add a small piece of code to parse the \"mixed\" bundle and then reuse their existing code to deal with each resource. This is why I thought that Version Specific Profile in meta.profile described at <a href=\"http://www.hl7.org/fhir/R4/versioning.html#mp-version\" target=\"_blank\" title=\"http://www.hl7.org/fhir/R4/versioning.html#mp-version\">http://www.hl7.org/fhir/R4/versioning.html#mp-version</a> would be a good solution for this approach.</p>",
        "id": 160163563,
        "sender_full_name": "Igor Sirkovich",
        "timestamp": 1551926055
    },
    {
        "content": "<blockquote>\n<p>they just need to add a small piece of code to parse the \"mixed\" bundle</p>\n</blockquote>\n<p>Actually, it's a long piece of string and there are many problems with it. So though I understand the intent and rationale, it doesn't seem very practical to me</p>",
        "id": 160165865,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551929188
    }
]