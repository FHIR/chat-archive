[
    {
        "content": "<p>Hi,</p>\n<p>I am working on an app that among other things should be capable of finding patients that have certain conditions. For that I am using queries like <br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003</a> where 38341003 is the Snomed code for hypertension. This works as expected and I get the following results:<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient\">http://fhirtest.uhn.ca/baseDstu3/Patient</a> -&gt; 4411 patients total<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003</a> -&gt; 283 patients with hypertension<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=44054006\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=44054006\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=44054006</a> -&gt; 44 patients with diabetes<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=417532002\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=417532002\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=417532002</a> -&gt; 0 patients allergic to fish</p>\n<p>Then, if I try to OR those conditions I get the following:<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003,44054006\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003,44054006\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003,44054006</a> -&gt; 300 patient with hypertension OR diabetes<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003,417532002\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003,417532002\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003,417532002</a> -&gt; 283 patient with hypertension OR fish allergy</p>\n<p>That seems correct and obviously some of the patients have both diabetes and hypertension because 300 is less then 283 + 44. The problem is that I cannot AND these conditions properly. For example, if want to find ONLY the patients having both diabetes and hypertension I should do one of these:</p>\n<p>Hypertension AND Diabetes:<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003&amp;_has:Condition:patient:code=44054006\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003&amp;_has:Condition:patient:code=44054006\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=38341003&amp;_has:Condition:patient:code=44054006</a> -&gt; 283 patients<br>\nDiabetes AND Hypertension:<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=44054006&amp;_has:Condition:patient:code=38341003\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=44054006&amp;_has:Condition:patient:code=38341003\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=44054006&amp;_has:Condition:patient:code=38341003</a> -&gt; 44 patients</p>\n<p>Also Fish Allergy AND Hypertension:<br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=417532002&amp;_has:Condition:patient:code=38341003\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=417532002&amp;_has:Condition:patient:code=38341003\">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Condition:patient:code=417532002&amp;_has:Condition:patient:code=38341003</a> -&gt; 0 patients</p>\n<p>I appears that the “_has” parameter can only be used once. However, the documentation states that: multiple _has parameters are allowed (e.g. GET [base]/Patient?_has:Observation:subject:code=123&amp;_has:Observation:subject:code=456). Note that each _has parameter is processed independently of other _has parameters. <br>\nAnd also \"The _has parameter provides limited support for reverse chaining…” - what are the limitations?</p>\n<p>My question is am I doing it wrong or is it just not working properly? What is the correct way to AND _has parameters?</p>\n<p>Thanks,<br>\nVlad</p>",
        "id": 153884913,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1492439332
    },
    {
        "content": "<p>I should also mention that currently there is a \"broken\" patient that messes up many queries. Try this for example: <a href=\"http://fhirtest.uhn.ca/baseDstu3/Patient?gender=female\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Patient?gender=female\">http://fhirtest.uhn.ca/baseDstu3/Patient?gender=female</a></p>",
        "id": 153884919,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1492444393
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> Vlad - just saw this today.  I agree, AND must be supported to cover the majority of _has use cases.  See <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13324\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13324\">GF#13324</a></p>",
        "id": 153887532,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1494068475
    }
]