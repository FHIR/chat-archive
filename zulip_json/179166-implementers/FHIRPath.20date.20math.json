[
    {
        "content": "<p>Hi,</p>\n<p>I want to write a FHIRPath expression that calculates a person's age based on their birthdate.</p>\n<p>Doing this elegantly seems like it would require extracting the \"year\" from both today() and the birthday, e.g pseudocode:</p>\n<p>(today.year - birth.year).select($this - iif(today &lt; birth + $this, 1, 0)</p>\n<p>Is there an elegant way to extract the year from a Date in FHIRPath?</p>\n<p>It seems doable with regex:</p>\n<p>today().toString().replaceMatches('(?&lt;year&gt;\\d{4}).*', '${year}').toDecimal()</p>\n<p>But I'm hoping there's some cleaner way I'm missing. Haven't been able to find anything relevant in these docs: <a href=\"http://build.fhir.org/ig/HL7/FHIRPath/branches/master/N1/\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/FHIRPath/branches/master/N1/\">http://build.fhir.org/ig/HL7/FHIRPath/branches/master/N1/</a></p>\n<p>Thanks!</p>",
        "id": 183089979,
        "sender_full_name": "Tadas Antanavicius",
        "timestamp": 1576004187
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> there's not even a way to subtract a data from date to get a duration?</p>",
        "id": 183096518,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576008238
    },
    {
        "content": "<p>No, because you'd have to define subtractions for each precision.</p>",
        "id": 183097057,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1576008573
    },
    {
        "content": "<p>You can convert both to seconds and get the difference in seconds.</p>",
        "id": 183097141,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1576008607
    },
    {
        "content": "<p>But we explicitly put calendar duration calculation out of scope.</p>",
        "id": 183097174,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1576008626
    },
    {
        "content": "<p>so how would you solve this one?</p>",
        "id": 183099150,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576009922
    },
    {
        "content": "<p>Well to do it right we'd have to introduce date/time component extractors or calendar duration calculation (probably both). It's been on the list, but we have been focused on getting to normative. A perhaps simpler hack would be today().toString().substring(0, 4).toInteger().</p>",
        "id": 183128727,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1576041885
    },
    {
        "content": "<p>Got it, thanks! Going to go with your suggestion for now.</p>",
        "id": 183196911,
        "sender_full_name": "Tadas Antanavicius",
        "timestamp": 1576095251
    }
]