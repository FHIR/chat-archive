[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  Okay . How and where to use defaultValue ?</p>",
        "id": 233927577,
        "sender_full_name": "Radha Rajendran",
        "timestamp": 1618032122
    },
    {
        "content": "<p>As it says in the comments in ElementDefinition, defaultValue is only allowed to be used in logical models.  It'll never be used in resource or data type definitions and it's prohibited for use in profiles on either of those.</p>",
        "id": 233927941,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618032570
    },
    {
        "content": "<p>okay thank you</p>",
        "id": 233928203,
        "sender_full_name": "Radha Rajendran",
        "timestamp": 1618032850
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  One more question , How to define elements in structure definition  for complex data types such as CodeableConcept, BackboneElement   ?</p>",
        "id": 233928352,
        "sender_full_name": "Radha Rajendran",
        "timestamp": 1618033024
    },
    {
        "content": "<p>First, read the section on validation in the core spec? <a href=\"http://build.fhir.org/validation.html\">http://build.fhir.org/validation.html</a></p>",
        "id": 233929088,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618033912
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 233931773,
        "sender_full_name": "Radha Rajendran",
        "timestamp": 1618037010
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - what's the rationale behind prohibiting default values in profiles? I have a use case where it would be helpful for the sending system to not have to provide <code>identifier.system</code> for every resource. In my mind, a profile that defaults that element to a previously agreed upon value (but would still allow it to be overwritten) would be a helpful implementation tool.</p>",
        "id": 259418618,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1635439959
    },
    {
        "content": "<p>Instances need to be safe for systems to parse wherever they come from - so we can't allow different systems to assert different defaults (because that would mean we'd need to interpret instances differently based on where they came from).  Also, default values add complexity to processing because you need to treat an element with one value (null) as if it actually had a distinct value.</p>\n<p>We <em>do</em> allow defaults for logical models - because those aren't about exchange.  However, for FHIR resources and data types, the only thing allowed is \"meaning if missing\" which is globally declared across all FHIR implementations.  E.g. \"If deceases[x] is absent, you should presume the patient is alive\".  That's obviously not a guarantee, but is a safe reasonable inference.  For anything else, you must explicitly populate the value.</p>",
        "id": 259419957,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1635440446
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - thanks for the context. I suppose I was thinking of \"default values\" as they're implemented in many relational databases, where if you insert a record and leave a field null, but that field has a default value defined, the field will actually be populated with the default on insert. Is there any standard/recommended approach for achieving this in a FHIR server implementation?</p>",
        "id": 259426045,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1635443094
    },
    {
        "content": "<p>Can you give a specific example you're wanting to set?  If it's setting a boolean to false, and the meaningIfMissing is \"if not specified, assume false\", then that's relatively safe.  However, for most other defaults, it's not safe and shouldn't be done when consuming FHIR data.  I.e. you can't say \"if you don't send this element, we'll presume you mean X - because that saves bandwidth\".  FHIR requires that X always be transmitted.</p>",
        "id": 259426922,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1635443503
    },
    {
        "content": "<p>I'm thinking primarily of the namespace/code system context. Take the following example:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Encounter</span>\n<span class=\"nt\">meta</span><span class=\"p\">:</span>\n  <span class=\"nt\">source</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://example.org/source-1</span>\n<span class=\"nt\">identifier</span><span class=\"p\">:</span>\n<span class=\"p p-Indicator\">-</span> <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">12345</span>\n<span class=\"nt\">status</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">finished</span>\n<span class=\"nt\">class</span><span class=\"p\">:</span>\n  <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">AMB</span>\n<span class=\"nt\">type</span><span class=\"p\">:</span>\n  <span class=\"nt\">coding</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">1</span>\n<span class=\"nt\">subject</span><span class=\"p\">:</span>\n  <span class=\"nt\">identifier</span><span class=\"p\">:</span>\n    <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">67890</span>\n</code></pre></div>\n<p>It would be helpful to say: \"Because you've provided a <code>meta.source</code> value, I can look that up somewhere and contextualize the identifiers and codes that you've sent.\" Upon POSTing to the server, the resource would look like:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Encounter</span>\n<span class=\"nt\">meta</span><span class=\"p\">:</span>\n  <span class=\"nt\">source</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://example.org/source-1</span>\n<span class=\"nt\">identifier</span><span class=\"p\">:</span>\n<span class=\"p p-Indicator\">-</span> <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">12345</span>\n  <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://example.org/namingsystem/source-1-encounter-id</span>\n<span class=\"nt\">status</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">finished</span>\n<span class=\"nt\">class</span><span class=\"p\">:</span>\n  <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">AMB</span>\n  <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://terminology.hl7.org/CodeSystem/v3-ActCode</span>\n<span class=\"nt\">type</span><span class=\"p\">:</span>\n  <span class=\"nt\">coding</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">1</span>\n    <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://example.org/codesystem/source-1-encounter-type</span>\n<span class=\"nt\">subject</span><span class=\"p\">:</span>\n  <span class=\"nt\">identifier</span><span class=\"p\">:</span>\n    <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">67890</span>\n    <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://example.org/namingsystem/source-1-patient-id</span>\n</code></pre></div>\n<p>I realize that I could simply do some preprocessing upstream of the server to the same effect, but it's beneficial to (1) centralize that configuration and (2) have a canonical standard for documenting it.</p>",
        "id": 259430019,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1635444725
    },
    {
        "content": "<p>Nothing prevents your server from getting the input described above, and storing it as the output shown. The configuration would be only on the server.</p>",
        "id": 259434055,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1635446707
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192685\">@Vassil Peytchev</span> understood, I'm just wondering if there's a best practice for doing the above. It would be useful to expose that configuration as a FHIR Resource - perhaps a custom one?</p>",
        "id": 259437994,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1635448372
    },
    {
        "content": "<p>As a rule, it's not a good idea to encourage the sender to transmit the data that way - as it requires the receiver to have special information to convert the record into \"useable\" form.  If it's a situation where you've got a device with limited bandwidth that always talks to a 'controller' system that inserts the additional data, then that's probably safe.</p>",
        "id": 259438371,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1635448565
    }
]