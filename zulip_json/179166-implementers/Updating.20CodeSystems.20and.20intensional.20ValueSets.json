[
    {
        "content": "<p>Hi, we have a question which concerns updating ValueSets, CodeSystems and FHIR profiles. <br>\n<span class=\"user-mention\" data-user-id=\"192155\">@Anders Jensen</span> <span class=\"user-mention\" data-user-id=\"195814\">@Ole Vilstrup</span> <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> </p>\n<p>We have created an IG which includes profiles with references to both extensional and intensional ValueSets. At the moment both profiles and ValueSets are in the same IG, but we intend to split this into two IGs – lets call them the ‘profile IG’ and ‘ValueSets’/’CodeSystem’, and lets say the split is done.</p>\n<p>Extensional: We want the extensional ValueSets to be almost static and rarely change version. If an extensional ValueSets is updated, it should reflect as an update in the version of the profile IG.</p>\n<p>Intensional: We want the intensional ValueSets to be dynamic and it may change as often as the clinical world demands it to. Most of these changes will be ‘minor’ changes, like addition of a new beta blocker’s code like in the HL7-site example. Codes in the CodeSystem holding the intensional value set may have an activation date or a retirement date. </p>\n<p>So… to the questions:<br>\n1)  How would you handle the versioning of the CodeSystem that holds codes used in the intensional ValueSet and these codes may have an activation or a retirement date? <br>\na.  Is it possible to avoid updating the version of a CodeSystem when a code is eg. retired?<br>\nb.  Is it an advantage to have a separate IG for the CodeSystem?<br>\n2)  How would you handle versioning of the intensional ValueSet which include codes that may have an activation or a retirement date? <br>\n3)  We are not interested in changes in the ValueSet and CodeSystem entails a new version in the profile IG. Is it ‘allowed’ to update the version of a CodeSystem or ValueSet, without updating the version of the profile IG which uses the ValueSet?</p>\n<p>We are quite uncertain about what is best practice in this area, so we are very interested in your point of views.</p>\n<p>Please reach out, if you need further explanation.</p>",
        "id": 265670506,
        "sender_full_name": "Thea Mentz Soerensen",
        "timestamp": 1640083076
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191343\">@Michael Lawley</span> your comments would be very much appreciated ;)</p>",
        "id": 265670611,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640083161
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"431942\">@Thea Mentz Soerensen</span> if I understand you correctly you would also like to add codes to the CodeSystem over time without changing the IG or the version of the CodeSystem, right?</p>",
        "id": 265671895,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640084157
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> Yes, that correct.</p>",
        "id": 265672242,
        "sender_full_name": "Thea Mentz Soerensen",
        "timestamp": 1640084405
    },
    {
        "content": "<p>it would be a super bad idea to add codes to the code system without changing the code system version, and the definitions are quite clear about this:</p>",
        "id": 265678219,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640088788
    },
    {
        "content": "<p>.. no, not in FHIR. <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> the language I'm thinking of it is in core principles? Somewhere? Any change to the meaning of the code system - the codes and their properties - requires a new version</p>",
        "id": 265678418,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640088962
    },
    {
        "content": "<p>anyway, this is true in practice, since otherwise you can't know which version you're talking about it. is something valid or not? No one can know....</p>",
        "id": 265678469,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640088989
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179166-implementers/topic/Updating.20CodeSystems.20and.20intensional.20ValueSets/near/265678219\">said</a>:</p>\n<blockquote>\n<p>it would be a super bad idea to add codes to the code system without changing the code system version, and the definitions are quite clear about this:</p>\n</blockquote>\n<p>I had the feeling that you would answer that. So how is this handled in the best way possible - having an IG with a profile with a binding to a valueset that is defined as intensional to a CodeSystem that may or may not be bound to the same IG.</p>",
        "id": 265678974,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640089369
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"431942\">@Thea Mentz Soerensen</span> <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>  I think this is actually straightforward and common practice and shouldn't be a problem.  You create an intensionally-defined value set (defined in the IG, or defined elsewhere and referenced in the IG) based on the external code system of interest (e.g., SNOMED CT, or other) without specifying a code system version in the value set definition (ValueSet.compose).  Then, as the code system itself is updated (with a new version identifier for each update) the contents of the value set that is used by the IG implementations (the value set expansion) will follow and track with the code system updates and you will have the content that you expect and need.  I think that gives you exactly what you are asking for.</p>",
        "id": 265686834,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1640094667
    },
    {
        "content": "<p>And where is the Codesystem then defined?</p>",
        "id": 265687309,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640094940
    },
    {
        "content": "<p>It depends on the code system.  Is it externally defined (e.g., SNOMED CT, ICD, LOINC, etc.), or defined in HL7 and included in THO (or in one of the HL7 product families - V2, V3/CDA or FHIR), or defined locally in your IG?</p>",
        "id": 265687755,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1640095181
    },
    {
        "content": "<p>The point is that the IG itself should not be updated because new codes gets added to the Codesystem</p>",
        "id": 265688062,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640095314
    },
    {
        "content": "<p>Because the Codesystem may need updates frequently</p>",
        "id": 265688310,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640095445
    },
    {
        "content": "<p>So the Codesystem will be externally defined</p>",
        "id": 265688433,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640095547
    },
    {
        "content": "<p>The IG doesn't need to be updated - unless the code system is defined in the IG.  That's a good reason to use an external code system, or use or define an HL7 code system that is (or will be) published in THO.</p>",
        "id": 265688491,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1640095575
    },
    {
        "content": "<p>And there is no issue in defining the Codesystem in another IG, in FHIR</p>",
        "id": 265688541,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640095635
    },
    {
        "content": "<p>The IG with the valuesets cannot then declare a dependency to that IG I guess as that requires an explicit version</p>",
        "id": 265688709,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640095740
    },
    {
        "content": "<p>So the reference from the valueset to the externally defined Codesystem will be purely logical, right?</p>",
        "id": 265688793,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640095802
    },
    {
        "content": "<p>I don't know about \"purely\". :)  The reference is via the code system canonical url.  But you probably have to (or at least want to) be able to access the actual code system contents in the IG publishing process or in your iG implementations, so the code system will need terminology server support.</p>",
        "id": 265689392,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1640096151
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191427\">Jens Villadsen</span> <a href=\"#narrow/stream/179166-implementers/topic/Updating.20CodeSystems.20and.20intensional.20ValueSets/near/265688709\">said</a>:</p>\n<blockquote>\n<p>The IG with the valuesets cannot then declare a dependency to that IG I guess as that requires an explicit version</p>\n</blockquote>\n<p>you can depend on patched versions, see <a href=\"https://confluence.hl7.org/display/FHIR/NPM+Package+Specification#NPMPackageSpecification-Versionreferences\">npm</a>, we use this approach for our ch-core ig which depends on external CodeSystem/ValueSet which have maybe add translations or spelling corrections in between the ch-core releases.</p>",
        "id": 265690529,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1640096872
    },
    {
        "content": "<p>so ch-core has a dependency of 2.0.x to ch-epr-term, <a href=\"https://github.com/hl7ch/ch-core/blob/master/input/ch.fhir.ig.ch-core.xml\">source</a></p>",
        "id": 265690742,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1640096984
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> aint that a very liberal interpretation of how to use patch versions?</p>",
        "id": 265699801,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640101617
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> the Codesystem will be available in a term server for systems implementing the IG</p>",
        "id": 265700080,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640101748
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> do you then also apply any patches to feature versions that are ahead of your patch versions? Do you then 'frontport' all changes?</p>",
        "id": 265718381,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640111017
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"431942\">@Thea Mentz Soerensen</span> I think we have enough input to proceed then <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 265718573,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640111140
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191427\">Jens Villadsen</span> <a href=\"#narrow/stream/179166-implementers/topic/Updating.20CodeSystems.20and.20intensional.20ValueSets/near/265718381\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191478\">Oliver Egger</span> do you then also apply any patches to feature versions that are ahead of your patch versions? Do you then 'frontport' all changes?</p>\n</blockquote>\n<p>i would say, but i'm not 100% sure if i understand the consequences ...</p>",
        "id": 265721714,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1640112925
    },
    {
        "content": "<blockquote>\n<p>The point is that the IG itself should not be updated because new codes gets added to the Codesystem</p>\n</blockquote>\n<p>so this is an issue with the publication process - you cannot declare a dependency without declaring a version specific dependency. And so far, code systems have been either publicly available or explicitly defined. </p>\n<p>So while it's totally unreasonable to issue new versions of a code system without versioning the code system, it's totally reasonable to update a code system without reissuing a set of IGs.</p>",
        "id": 265721943,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113057
    },
    {
        "content": "<p>however: ImplementationGuide.dependsOn.version is optional. So you can define a non-versioned dependency. I don't think my tools handle it very well, but I haven't really tested it</p>",
        "id": 265722129,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113175
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> Consequences of missing a patch in a future minor revision would mean that you actually remove content which would violate the rules of semantic versioning</p>",
        "id": 265722273,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640113222
    },
    {
        "content": "<p>nor do we really handle well referring to a code system without referring to an IG, but still declaring where the code system is, which is another way to deal with this.</p>",
        "id": 265722308,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113240
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179166-implementers/topic/Updating.20CodeSystems.20and.20intensional.20ValueSets/near/265722308\">said</a>:</p>\n<blockquote>\n<p>nor do we really handle well referring to a code system without referring to an IG, but still declaring where the code system is, which is another way to deal with this.</p>\n</blockquote>\n<p>That is probably how we can proceed to start with</p>",
        "id": 265722378,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640113283
    },
    {
        "content": "<p>we have an extension for authoritative source of a value set, but not for authoritative source of a code system - and it would not be declared in the code system anyway, but in... the IG, I guess</p>",
        "id": 265722479,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113331
    },
    {
        "content": "<p>It cannot be the first time such a challenge arises, right?</p>",
        "id": 265722592,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640113410
    },
    {
        "content": "<p>the extension would be a triple, I guess: the canonical URL, along with a reference to a human readable URL and an end-point that services it. </p>\n<p>But actually, we totally have a way to do this: include a CodeSystem resource that declares the CodeSystem, but contains no content, and declares that the content may be found somewhere else. I know my toosl don't handle that scenario - either publication or validation, but they should.</p>",
        "id": 265722748,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113508
    },
    {
        "content": "<blockquote>\n<p>It cannot be the first time such a challenge arises, right?</p>\n</blockquote>\n<p>it is, yes, because up to now we have just assumed that external code systems are explicit a la Snomed and LOINC</p>",
        "id": 265722787,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113550
    },
    {
        "content": "<p>Okay - well ... yeah ... I've seen that approach before yes, defining an more or less empty codesystem. That would also do the job, yes</p>",
        "id": 265722951,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640113645
    },
    {
        "content": "<p>well, only if you explicitly declared that this is what was going on</p>",
        "id": 265722985,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113666
    },
    {
        "content": "<p>and the tools don't know any way to declare that.</p>",
        "id": 265723012,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640113679
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179166-implementers/topic/Updating.20CodeSystems.20and.20intensional.20ValueSets/near/265722787\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>It cannot be the first time such a challenge arises, right?</p>\n</blockquote>\n<p>it is, yes, because up to now we have just assumed that external code systems are explicit a la Snomed and LOINC</p>\n</blockquote>\n<p>Noone else have requested/stated the use of external code systems before?</p>",
        "id": 265723951,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640114235
    },
    {
        "content": "<p>and whats so special about SNOMED and LOINC in terms of being external?</p>",
        "id": 265723973,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640114256
    },
    {
        "content": "<p>we assume that they are well known. We have not explored the space of 'code systems that are not assumed to be well-known but are external' before to my knowledge</p>",
        "id": 265731143,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640118764
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179166-implementers/topic/Updating.20CodeSystems.20and.20intensional.20ValueSets/near/265731143\">said</a>:</p>\n<blockquote>\n<p>we assume that they are well known. We have not explored the space of 'code systems that are not assumed to be well-known but are external' before to my knowledge</p>\n</blockquote>\n<p>By \"but are external\" you mean,  external to the IG, right, not external to HL7? I'm surprised this isn't already an issue, as jurisdictions are building out local IGs that need to cross-reference content.</p>",
        "id": 265739338,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1640123884
    },
    {
        "content": "<p>AU Base 2 on FHIR R4 uses value sets and code systems that are defined in core, in the IG, and elsewhere.</p>\n<p>An example of the last is in <a href=\"http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-indigenous-status.html\">Australian Indigenous Status extension</a> which is bound to the value set <a href=\"https://www.healthterminologies.gov.au/integration/R4/fhir/ValueSet/australian-indigenous-status-1\">Australian Indigenous Status value set</a>. That national value set is not maintained by HL7 Australia.</p>\n<p>The Validator does not currently validate against it, so it raises warnings, which are suppressed in the <a href=\"http://build.fhir.org/ig/hl7au/au-fhir-base/qa.html#_scratch_ig-build-temp-SCC5M0_repo_resources_structuredefinition-indigenous-status\">qa report</a> e.g.<br>\n<code>The valueSet reference https://healthterminologies.gov.au/fhir/ValueSet/australian-indigenous-status-1 on element Extension.value[x] could not be resolved (8 uses)</code></p>\n<p>The  <a href=\"https://www.healthterminologies.gov.au/integration/R4/fhir/ValueSet/australian-indigenous-status-1\">Australian Indigenous Status value set</a> has been updated to version 1.0.2 without forcing a change the the extension.</p>",
        "id": 265755375,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1640135746
    },
    {
        "content": "<blockquote>\n<p>By \"but are external\" you mean, external to the IG, right, not external to HL7? I'm surprised this isn't already an issue, as jurisdictions are building out local IGs that need to cross-reference content</p>\n</blockquote>\n<p>not sure what you mean 'external to HL7'. but Richard's case is an illustration that things have been worked around rather than coming up, perhaps</p>",
        "id": 265772177,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640156742
    }
]