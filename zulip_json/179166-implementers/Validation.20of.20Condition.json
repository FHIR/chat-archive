[
    {
        "content": "<p>Hi, I'm trying to use the validator in HAPI to validate my resources, but I'm running into some problems with Condition. The problem is when the condition has an abatementDate; which results in the validation failing on con-4. Here is a small test that fails for me: <a href=\"https://pastecode.xyz/view/09509652\" target=\"_blank\" title=\"https://pastecode.xyz/view/09509652\">https://pastecode.xyz/view/09509652</a>. </p>\n<p>The validation fails because of the SchematronBaseValidator (have tried commenting out DefaultProfileValidationSupport and SchemaBaseValidator).</p>\n<p>The error-message that is returned from the validator is : \"[error] in /<em>:Condition[namespace-uri()='<a href=\"http://hl7.org/fhir'][1]\" target=\"_blank\" title=\"http://hl7.org/fhir'][1]\">http://hl7.org/fhir'][1]</a> @ Condition con-4: If condition is abated, then clinicalStatus must be either inactive, resolved, or remission Test=not(f:abatementBoolean/@value=true() or (not(exists(f:abatementBoolean)) and exists(</em>[starts-with(local-name(.), 'abatement')])) or f:clinicalStatus/@value=('resolved', 'remission', 'inactive'))\"</p>",
        "id": 154019760,
        "sender_full_name": "Andreas",
        "timestamp": 1542699491
    },
    {
        "content": "<p>Is this an issue with R3 or R4?</p>",
        "id": 154019819,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1542728994
    },
    {
        "content": "<p>what's the status?</p>",
        "id": 154019956,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1542777196
    },
    {
        "content": "<p>This is R3 and I'm using HAPI 3.4. So I'm trying to set clinicalStatus to inactive, and the abatementDate to a date in the future, but the validation always fails on con-4.</p>",
        "id": 154020000,
        "sender_full_name": "Andreas",
        "timestamp": 1542781892
    },
    {
        "content": "<p>hmm, send me an example and I'll test it out</p>",
        "id": 154020001,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1542782123
    },
    {
        "content": "<p>Here is the example class: <a href=\"https://pastecode.xyz/view/c4476478\" target=\"_blank\" title=\"https://pastecode.xyz/view/c4476478\">https://pastecode.xyz/view/c4476478</a> and I'm using this pom: <a href=\"https://github.com/FirelyTeam/fhirstarters/blob/master/java/hapi-fhirstarters-model-and-parser-examples/pom.xml\" target=\"_blank\" title=\"https://github.com/FirelyTeam/fhirstarters/blob/master/java/hapi-fhirstarters-model-and-parser-examples/pom.xml\">https://github.com/FirelyTeam/fhirstarters/blob/master/java/hapi-fhirstarters-model-and-parser-examples/pom.xml</a></p>",
        "id": 154020003,
        "sender_full_name": "Andreas",
        "timestamp": 1542783140
    },
    {
        "content": "<p>so this works in the latest validator. <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> what's the right way to get the last validator in the context of HAPI?</p>",
        "id": 154020571,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1542925043
    }
]