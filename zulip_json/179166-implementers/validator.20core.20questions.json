[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> is this correct? <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/blob/17eb1c41f7300f6e407cb043ed8b27d1ed2b3783/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/r5/validation/InstanceValidator.java#L2755\" target=\"_blank\" title=\"https://github.com/hapifhir/org.hl7.fhir.core/blob/17eb1c41f7300f6e407cb043ed8b27d1ed2b3783/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/r5/validation/InstanceValidator.java#L2755\">https://github.com/hapifhir/org.hl7.fhir.core/blob/17eb1c41f7300f6e407cb043ed8b27d1ed2b3783/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/r5/validation/InstanceValidator.java#L2755</a> - as I read <a href=\"https://www.hl7.org/fhir/stu3/http.html#2.21.0.17.2\" target=\"_blank\" title=\"https://www.hl7.org/fhir/stu3/http.html#2.21.0.17.2\">https://www.hl7.org/fhir/stu3/http.html#2.21.0.17.2</a> - (Conditional References), relative references with query parameters in the reference are allowed as long as it is contained in a transaction bundle</p>",
        "id": 188203357,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581685022
    },
    {
        "content": "<p>yes</p>",
        "id": 188319217,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581844844
    },
    {
        "content": "<p>hmmm ... validating this:</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;entry&quot;: [\n    {\n      &quot;request&quot;: {\n        &quot;ifNoneExist&quot;: &quot;url=http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url&quot;,\n        &quot;url&quot;: &quot;SearchParameter&quot;,\n        &quot;method&quot;: &quot;POST&quot;\n      },\n      &quot;resource&quot;: {\n        &quot;id&quot;: &quot;ehealth-structuredefinition-search-url&quot;,\n        &quot;xpathUsage&quot;: &quot;normal&quot;,\n        &quot;description&quot;: &quot;Search parameter for finding a structureDefinition by URL&quot;,\n        &quot;resourceType&quot;: &quot;SearchParameter&quot;,\n        &quot;code&quot;: &quot;url&quot;,\n        &quot;status&quot;: &quot;active&quot;,\n        &quot;xpath&quot;: &quot;f:StructureDefinition/f:url&quot;,\n        &quot;type&quot;: &quot;uri&quot;,\n        &quot;expression&quot;: &quot;StructureDefinition.url&quot;,\n        &quot;name&quot;: &quot;url&quot;,\n        &quot;base&quot;: [\n          &quot;StructureDefinition&quot;\n        ],\n        &quot;url&quot;: &quot;http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url&quot;\n      },\n      &quot;fullUrl&quot;: &quot;urn:uuid:58441a26-dd41-4e0b-9cd0-6537ecdf69af&quot;\n    },\n    {\n      &quot;request&quot;: {\n        &quot;ifNoneExist&quot;: &quot;url=http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url-unique&quot;,\n        &quot;url&quot;: &quot;SearchParameter&quot;,\n        &quot;method&quot;: &quot;POST&quot;\n      },\n      &quot;resource&quot;: {\n        &quot;id&quot;: &quot;ehealth-structuredefinition-search-url-unique&quot;,\n        &quot;extension&quot;: [\n          {\n            &quot;valueBoolean&quot;: true,\n            &quot;url&quot;: &quot;http://hapifhir.io/fhir/StructureDefinition/sp-unique&quot;\n          }\n        ],\n        &quot;description&quot;: &quot;Search parameter for making a structureDefinition unique by URL&quot;,\n        &quot;resourceType&quot;: &quot;SearchParameter&quot;,\n        &quot;name&quot;: &quot;unique url&quot;,\n        &quot;status&quot;: &quot;active&quot;,\n        &quot;component&quot;: [\n          {\n            &quot;expression&quot;: &quot;StructureDefinition&quot;,\n            &quot;definition&quot;: {\n              &quot;reference&quot;: &quot;SearchParameter?url=http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url&quot;\n            }\n          }\n        ],\n        &quot;type&quot;: &quot;composite&quot;,\n        &quot;expression&quot;: &quot;StructureDefinition.url&quot;,\n        &quot;base&quot;: [\n          &quot;StructureDefinition&quot;\n        ],\n        &quot;code&quot;: &quot;sd-unique-url&quot;,\n        &quot;url&quot;: &quot;http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url-unique&quot;\n      },\n      &quot;fullUrl&quot;: &quot;urn:uuid:f0a77d9a-fd10-48ed-85f9-51906cf46d29&quot;\n    }\n  ],\n  &quot;type&quot;: &quot;transaction&quot;,\n  &quot;resourceType&quot;: &quot;Bundle&quot;\n}\n</pre></div>\n\n\n<ul>\n<li>against HAPI FHIR 4.2.0 (which does not contain the latest release of the validator core release) ends up in this:</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n  &quot;text&quot;: {\n    &quot;status&quot;: &quot;generated&quot;,\n    &quot;div&quot;: &quot;&lt;div xmlns=\\&quot;http://www.w3.org/1999/xhtml\\&quot;&gt;&lt;h1&gt;Operation Outcome&lt;/h1&gt;&lt;table border=\\&quot;0\\&quot;&gt;&lt;tr&gt;&lt;td style=\\&quot;font-weight: bold;\\&quot;&gt;INFORMATION&lt;/td&gt;&lt;td&gt;[Bundle.entry[1].resource.extension[0], Line 36, Col 12]&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Unknown extension http://hapifhir.io/fhir/StructureDefinition/sp-unique&lt;/pre&gt;&lt;/td&gt;\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t&lt;/tr&gt;\\n\\t\\t\\t&lt;tr&gt;\\n\\t\\t\\t\\t&lt;td style=\\&quot;font-weight: bold;\\&quot;&gt;ERROR&lt;/td&gt;\\n\\t\\t\\t\\t&lt;td&gt;[Bundle.entry[1].resource.component[0].definition]&lt;/td&gt;\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t&lt;td&gt;&lt;pre&gt;Relative URLs must be of the format [ResourceName]/[id].  Encountered SearchParameter?url=http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url&lt;/pre&gt;&lt;/td&gt;\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t&lt;/tr&gt;\\n\\t\\t&lt;/table&gt;\\n\\t&lt;/div&gt;&quot;\n  },\n  &quot;issue&quot;: [\n    {\n      &quot;severity&quot;: &quot;information&quot;,\n      &quot;code&quot;: &quot;processing&quot;,\n      &quot;diagnostics&quot;: &quot;Unknown extension http://hapifhir.io/fhir/StructureDefinition/sp-unique&quot;,\n      &quot;location&quot;: [\n        &quot;Bundle.entry[1].resource.extension[0]&quot;,\n        &quot;Line 36, Col 12&quot;\n      ]\n    },\n    {\n      &quot;severity&quot;: &quot;error&quot;,\n      &quot;code&quot;: &quot;processing&quot;,\n      &quot;diagnostics&quot;: &quot;Relative URLs must be of the format [ResourceName]/[id].  Encountered SearchParameter?url=http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url&quot;,\n      &quot;location&quot;: [\n        &quot;Bundle.entry[1].resource.component[0].definition&quot;\n      ]\n    }\n  ]\n}\n</pre></div>\n\n\n<ul>\n<li>which looks like a bug to me</li>\n</ul>",
        "id": 188337138,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581883144
    },
    {
        "content": "<p>That's interesting - the conditional reference would be resolved if the transaction was posted, but should it pass validation? It's not a valid reference if stored in that form.</p>",
        "id": 188337310,
        "sender_full_name": "Paul Church",
        "timestamp": 1581883456
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/3nHXhrC9tgLbkaEbaKeUxRdU/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/3nHXhrC9tgLbkaEbaKeUxRdU/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/3nHXhrC9tgLbkaEbaKeUxRdU/pasted_image.png\"></a></div>",
        "id": 188337328,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581883516
    },
    {
        "content": "<p>from <a href=\"https://www.hl7.org/fhir/stu3/http.html#2.21.0.17.2\" target=\"_blank\" title=\"https://www.hl7.org/fhir/stu3/http.html#2.21.0.17.2\">https://www.hl7.org/fhir/stu3/http.html#2.21.0.17.2</a></p>",
        "id": 188337339,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581883544
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197072\">@Paul Church</span> - the rules following that snippet says that the query should be resolved. If resolved, the query is replaced: <a href=\"/user_uploads/10155/GV7quXRqVutc1gbQaQty0LUj/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/GV7quXRqVutc1gbQaQty0LUj/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/GV7quXRqVutc1gbQaQty0LUj/pasted_image.png\"></a></div>",
        "id": 188339875,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581887947
    },
    {
        "content": "<p>Well that's my point...it's not a valid resource. It's a valid input to the bundle endpoint, which is transformed according to those rules (resolving the query) to produce a valid resource.</p>",
        "id": 188340383,
        "sender_full_name": "Paul Church",
        "timestamp": 1581888862
    },
    {
        "content": "<p>which is where I'm posting it to</p>",
        "id": 188341868,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581891939
    },
    {
        "content": "<p>so if the content in its whole is valid according to spec, how come it does not pass the validation, <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>?</p>",
        "id": 188341979,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581892139
    },
    {
        "content": "<p>because no one tested it yet</p>",
        "id": 188346764,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581902126
    },
    {
        "content": "<p>this is the errors I get with the current validator:</p>\n<p>ERROR: Bundle.entry[1].resource.component[0].definition: This property must be an simple value, not an object<br>\nwarning: WARNING: Bundle.entry[0].resource: spd-0: Name should be usable as an identifier for the module by machine processing applications such as code generation [name.matches('<a href=\"http://[A-Za-z0-9_]\" target=\"_blank\" title=\"http://[A-Za-z0-9_]\">A-Z</a>{0,254}')]<br>\nwarning: WARNING: Bundle.entry[1].resource: spd-0: Name should be usable as an identifier for the module by machine processing applications such as code generation [name.matches('<a href=\"http://[A-Za-z0-9_]\" target=\"_blank\" title=\"http://[A-Za-z0-9_]\">A-Z</a>{0,254}')]<br>\nERROR: Bundle.entry[1].resource.extension[0]: The extension <a href=\"http://hapifhir.io/fhir/StructureDefinition/sp-unique\" target=\"_blank\" title=\"http://hapifhir.io/fhir/StructureDefinition/sp-unique\">http://hapifhir.io/fhir/StructureDefinition/sp-unique</a> is unknown, and not allowed here<br>\nERROR: Bundle.entry[1].resource.component[0]: Profile <a href=\"http://hl7.org/fhir/StructureDefinition/SearchParameter\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/SearchParameter\">http://hl7.org/fhir/StructureDefinition/SearchParameter</a>, Element 'Bundle.entry[1].resource.component[0].definition': minimum required = 1, but only found 0</p>",
        "id": 188347624,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581903998
    },
    {
        "content": "<p>do you think that any of these errors are wrong?</p>",
        "id": 188347632,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581904011
    },
    {
        "content": "<p>oops, no, these errors:</p>",
        "id": 188347649,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581904079
    },
    {
        "content": "<p>ERROR: Bundle.entry[1].resource.extension[0]: The extension <a href=\"http://hapifhir.io/fhir/StructureDefinition/sp-unique\" target=\"_blank\" title=\"http://hapifhir.io/fhir/StructureDefinition/sp-unique\">http://hapifhir.io/fhir/StructureDefinition/sp-unique</a> is unknown, and not allowed here<br>\nERROR: Bundle.entry[1].resource.component[0].definition: Relative URLs must be of the format [ResourceName]/[id].  Encountered SearchParameter?url=http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url</p>",
        "id": 188347650,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581904080
    },
    {
        "content": "<p>why is the following not allowed?</p>\n<div class=\"codehilite\"><pre><span></span>ERROR: Bundle.entry[1].resource.extension[0]: The extension http://hapifhir.io/fhir/StructureDefinition/sp-unique is unknown, and not allowed here\n</pre></div>\n\n\n<p>its a normal  extension - did you run the validator with strictness that does not allow unknown extensions?</p>\n<ul>\n<li>and the following:</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>ERROR: Bundle.entry[1].resource.component[0].definition: Relative URLs must be of the format [ResourceName]/[id]. Encountered SearchParameter?url=http://ehealth.sundhed.dk/fhir/SearchParameter/StructureDefinition/url\n</pre></div>\n\n\n<ul>\n<li>that should be allowed according to the spec, so that should not be an error. Instead such use should be allowed when in a bundle with type transaction. It may not compute runtime, but it is allowed according to spec. The real question is more: Should such search parameter resolve within the bundle or not. That is not stated clearly. We already have the <code>ifNoneExist</code>which does the resolving according to the persisted data. My guess would be that such use of search within the reference should resolve within the bundle</li>\n</ul>",
        "id": 188360298,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581928389
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 188360310,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581928419
    },
    {
        "content": "<p>The first: by default the validator only allows extensions it knows about. see the validator doco at <a href=\"https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Validator\" target=\"_blank\" title=\"https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Validator\">https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Validator</a></p>",
        "id": 188360383,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581928513
    },
    {
        "content": "<p>I'll look at the second</p>",
        "id": 188360388,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581928528
    },
    {
        "content": "<p>regarding \"The first\" - this is as expected.</p>",
        "id": 188360441,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581928580
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> so whats the verdict? should a search be allowed within the bundle and use placeholder ID's that are later resolved? ... or where does it end?</p>",
        "id": 188408146,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1581975418
    },
    {
        "content": "<p>ok fixed next release</p>",
        "id": 188421074,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581996135
    },
    {
        "content": "<p>as in: \"The validator now allows it and verifies a search within the bundle\" or \"This part is now changed in the spec\"? Don't this have implications on the reference implementations?</p>",
        "id": 188425808,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1582005744
    },
    {
        "content": "<p>the validator now allows valid search references for references in a transaction bundle</p>",
        "id": 188426948,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582007743
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> in case this is not on your radar ...</p>",
        "id": 188430366,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1582012851
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> if the validator is more than an hour old or so, it’s too old for someone ;-)</p>",
        "id": 188434924,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582017920
    },
    {
        "content": "<p>lol</p>",
        "id": 188439017,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1582021393
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - no I was just wondering if HAPI has problems with how this is interpreted</p>",
        "id": 188439101,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1582021471
    },
    {
        "content": "<p>FWIW, the version of the validator that is in the 4.2.0 release (just released) is about 3 weeks old, as we went into feature freeze a while back in order to shake out bugs for stable.</p>\n<p>We've already pushed new 4.3.0-SNAPSHOT builds to Maven though that incorporate the bleeding-edge validator.</p>",
        "id": 188448831,
        "sender_full_name": "James Agnew",
        "timestamp": 1582031292
    },
    {
        "content": "<p>as expected ... ;)</p>",
        "id": 188459345,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1582039223
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> how stable are the snapshots ? do they pass all automated tests?</p>",
        "id": 188459465,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1582039310
    },
    {
        "content": "<p>Yup, we push when the tests are passing. We've found the snapshots to be quite stable in the end.. We're pushing them roughly every week.</p>",
        "id": 188460380,
        "sender_full_name": "James Agnew",
        "timestamp": 1582039855
    },
    {
        "content": "<p>ok, we're almost done upgrading to 4.2.0 (still bugtracking why the entity manager is not providing me with a transaction - probably some local stuff), but it could look like we might already need to go up to 4.3.0 snapshot ...</p>",
        "id": 188460585,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1582039983
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <br>\nConsider the following:</p>\n<div class=\"codehilite\"><pre><span></span>FHIR Validation tool Version 4.2.4-SNAPSHOT (Git# a3d7acdf351d). Built 2020-02-28T15:17:35.66+11:00 (3 days old)\nDetected Java version: 11.0.3 from C:\\Program Files\\AdoptOpenJDK\\jre-11.0.3.7-hotspot on amd64 (64bit). 4070MB available\nArguments: source\\examples\\patient-example-bubber.json -ig source\\resources\nDirectories: Current = C:\\Users\\Jensk\\Documents\\dk-core-r4, Package Cache = C:\\Users\\Jensk\\.fhir\\packages\n  .. FHIR Version current, definitions from hl7.fhir.r5.core#current\n  .. connect to tx server @ http://tx.fhir.org\n    (vcurrent)\n+  .. load IG from source\\resources\n  .. validate [source\\examples\\patient-example-bubber.json]\nValidation Infrastructure fail validating source\\examples\\patient-example-bubber.json: Problem processing expression maritalStatus.coding.exists(code = &#39;P&#39; and system = &#39;http://terminology.hl7.org/CodeSystem/v3-MaritalStatus&#39;) or maritalStatus.coding.exists(code = &#39;A&#39; and system = &#39;http://terminology.hl7.org/CodeSystem/v3-MaritalStatus&#39;) in profile http://hl7.org/fhir/dk/core/StructureDefinition/dk-core-patient path Patient: Error in ?? at 1, 8: The function &quot;exists&quot; requires 0 parameters\nException in thread &quot;main&quot; org.hl7.fhir.exceptions.FHIRException: Problem processing expression maritalStatus.coding.exists(code = &#39;P&#39; and system = &#39;http://terminology.hl7.org/CodeSystem/v3-MaritalStatus&#39;) or maritalStatus.coding.exists(code = &#39;A&#39; and system = &#39;http://terminology.hl7.org/CodeSystem/v3-MaritalStatus&#39;) in profile http://hl7.org/fhir/dk/core/StructureDefinition/dk-core-patient path Patient: Error in ?? at 1, 8: The function &quot;exists&quot; requires 0 parameters\n        at org.hl7.fhir.validation.instance.InstanceValidator.checkInvariant(InstanceValidator.java:5218)\n        at org.hl7.fhir.validation.instance.InstanceValidator.checkInvariants(InstanceValidator.java:5203)\n        at org.hl7.fhir.validation.instance.InstanceValidator.checkInvariants(InstanceValidator.java:5094)\n        at org.hl7.fhir.validation.instance.InstanceValidator.validateElement(InstanceValidator.java:4605)\n        at org.hl7.fhir.validation.instance.InstanceValidator.startInner(InstanceValidator.java:3456)\n        at org.hl7.fhir.validation.instance.InstanceValidator.start(InstanceValidator.java:3380)\n        at org.hl7.fhir.validation.instance.InstanceValidator.validateResource(InstanceValidator.java:5311)\n        at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:681)\n        at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:535)\n        at org.hl7.fhir.validation.ValidationEngine.validate(ValidationEngine.java:1077)\n        at org.hl7.fhir.validation.ValidationEngine.validate(ValidationEngine.java:991)\n        at org.hl7.fhir.validation.Validator.main(Validator.java:659)\n</pre></div>\n\n\n<p>Shouldn't this use of <code>exists </code> be valid?</p>",
        "id": 189475597,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583142255
    },
    {
        "content": "<p>According to <a href=\"http://hl7.org/fhirpath/#existence\" target=\"_blank\" title=\"http://hl7.org/fhirpath/#existence\">http://hl7.org/fhirpath/#existence</a> and the stated example use, I read it as if this kind of use of exists should be valid</p>",
        "id": 189475647,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583142326
    },
    {
        "content": "<p>yes, you;re right. Don't know how the fhirpath tests missed that</p>",
        "id": 189656567,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583290743
    },
    {
        "content": "<p>fixed next release</p>",
        "id": 189657661,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583292327
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I have an observation and I wonder if it is a bug or a shortcoming in the validator: I have  resource profile on Patient. General practitioner is sliced and discriminator is on type=value, path=identifier.system. The identifier has its own datatype resource profile - everything works .... - well sort of. Within the datatype profile on identifier, I have a FHIR path constraint on the identifier.value - but it seems that the validator never evaluates the FHIR path expression when validating the patient resource. Everything else works and I can see that it evaluates the cardinalities stated in the datatype profile on identifier. Is this a bug in the validator or is it as expected?</p>",
        "id": 189743476,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583361555
    },
    {
        "content": "<p>That sounds like a bug.  Submit a narrow example we can use as a test case</p>",
        "id": 189743670,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1583361680
    },
    {
        "content": "<p>will do ... is my use exotic?</p>",
        "id": 189743765,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583361729
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> here or on jira?</p>",
        "id": 189745312,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583362879
    },
    {
        "content": "<p>Jira.  And no, not that exotic</p>",
        "id": 189745854,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1583363356
    },
    {
        "content": "<p><a href=\"https://jira.hl7.org/browse/FHIR-26440\" target=\"_blank\" title=\"https://jira.hl7.org/browse/FHIR-26440\">https://jira.hl7.org/browse/FHIR-26440</a> <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span></p>",
        "id": 189746626,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583364114
    },
    {
        "content": "<p>this one needs a test case- that is, a valid and an invalid example, and as few profiles as required to reproduce the case. And it should be a gibhub issue not a JIRA task</p>",
        "id": 189747537,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583365030
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - did you have a look at what I submitted? It contains a resource profile and a datatype profile and a resource instance that shows that is does not fail when it ought to</p>",
        "id": 189748014,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583365492
    },
    {
        "content": "<p>and now it also contains a resource example that should not fail</p>",
        "id": 189748150,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583365648
    },
    {
        "content": "<p>so I don't see why you think there's a problem with the validator here</p>",
        "id": 189749636,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583367193
    },
    {
        "content": "<p>no. hang on</p>",
        "id": 189749796,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583367425
    },
    {
        "content": "<p>ok fixed next release</p>",
        "id": 189762087,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583386779
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/1h-yeQJcl7yYhUMYTyJzeV1g/image.png\" target=\"_blank\" title=\"image.png\">image.png</a> ;)</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/1h-yeQJcl7yYhUMYTyJzeV1g/image.png\" target=\"_blank\" title=\"image.png\"><img src=\"/user_uploads/10155/1h-yeQJcl7yYhUMYTyJzeV1g/image.png\"></a></div>",
        "id": 189770133,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583397973
    },
    {
        "content": "<p>isn't lenin cat in the mausoleum in the red square with lenin?</p>",
        "id": 189770346,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583398154
    },
    {
        "content": "<p>can't and won't say - it would violate my contract with my client :D</p>",
        "id": 189770769,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583398524
    },
    {
        "content": "<p>ETA of next release would be ....? Within a couple of ours?</p>",
        "id": 189770838,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583398566
    },
    {
        "content": "<p>it's already done</p>",
        "id": 189771307,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583399026
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  I'm pretty sure you broke something else now</p>",
        "id": 189793919,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583416982
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/n0ap2Y2hPEpILU5aPm-DTvN1/dk-core-episodeOfCare.StructureDefinition.xml\" target=\"_blank\" title=\"dk-core-episodeOfCare.StructureDefinition.xml\">dk-core-episodeOfCare.StructureDefinition.xml</a> <a href=\"/user_uploads/10155/Euf5ajDMYyUgUU5ZcuRw0vKf/episodeOfCare-example.json\" target=\"_blank\" title=\"episodeOfCare-example.json\">episodeOfCare-example.json</a> <a href=\"/user_uploads/10155/wnRqtNbG8ORox05qFDQxK30L/episodeOfCare-example-wrong.json\" target=\"_blank\" title=\"episodeOfCare-example-wrong.json\">episodeOfCare-example-wrong.json</a></p>",
        "id": 189794103,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583417090
    },
    {
        "content": "<p>there's a profile and two examples attached. One of the resources should fail the other should pass</p>",
        "id": 189794145,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583417127
    },
    {
        "content": "<p>the profile is the simplified version. The complex one is where I slice the identifiers on system and add different profiles for the identfiers. That part is not attached. Get the simple one to work is the first step. It seems the FhirPath invariants are not evaluated</p>",
        "id": 189794266,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583417194
    },
    {
        "content": "<p>Running on <code>FHIR Validation tool Version 4.2.6-SNAPSHOT (Git# d8262c056c7b). Built 2020-03-05T16:54:24.93+11:00 (8 hours old)</code></p>",
        "id": 189794296,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583417210
    },
    {
        "content": "<p>wait ....</p>",
        "id": 189794467,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583417339
    },
    {
        "content": "<p>nope - error was on my side. I FAILED in declaring the profile in meta ....</p>",
        "id": 189794656,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1583417447
    }
]