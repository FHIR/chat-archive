[
    {
        "content": "<p>I have been tasked with looking at how or if it is possible to query bundles that have been stored in a central location and return all matching bundles within a searchset bundle. The stored bundles have not been processed in any way and retain their original structure, which consists of multiple FHIR resources.<br>\nOne of the resources is MessageHeader which identifies the 'type'  of data it contains, in addition to the Patient resource. Together these would form the search parameters, which I'd like to use to identify any matching bundles.  There are additional parameters that need to be added, but I'd like to know if what is being asked is possible before expanding search parameters. I'm hoping this can be done using REST, but I've never seen this type of search performed, since most bundles are used as a wrapper and not stored.</p>\n<p>One of the concerns I have, if this is possible to do in the first place, is the amount of processing that such a search will need to do, having to search down what could be 1000's of bundles, identify matching records and then returning these back to the client.</p>\n<p>Any advice/guidance would be appreciated.</p>\n<p>Dave</p>",
        "id": 153943016,
        "sender_full_name": "Dave Henderson",
        "timestamp": 1520526166
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"193699\">@Dave Henderson</span>, maybe the central server could index the bundles? This would allow you to optimize search speed, by resolving searches from the index tables.</p>",
        "id": 153943018,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1520526691
    },
    {
        "content": "<p>There is a standard search criteria for Bundle allowing you to chain to the MessageHeader and from there you can filter on MessageHeader elements.  It's up to a server whether it supports such chaining and, if so, to what elements.  However, if it does, then it will presumably index the Bundle accordingly, so the search should perform fairly well.</p>",
        "id": 153943025,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1520526842
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  Can you point me to the FHIR documentation for this. I've trawled through it trying to find some guidance on searching bundles, but was unable to locate anything useful. Thanks</p>",
        "id": 153943050,
        "sender_full_name": "Dave Henderson",
        "timestamp": 1520527651
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span>  If FHIR has its own indexing and search fucntions as <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> has indicated then this could be the answer.</p>",
        "id": 153943051,
        "sender_full_name": "Dave Henderson",
        "timestamp": 1520527701
    },
    {
        "content": "<p>FHIR only defines the API, not the actual implementation. However a smart FHIR Server implementation (such as Vonk) would definitely build indexes for known search parameters.</p>",
        "id": 153943053,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1520527818
    },
    {
        "content": "<p>Search parameters for Bundle are here: <a href=\"http://hl7.org/fhir/bundle.html#search\" target=\"_blank\" title=\"http://hl7.org/fhir/bundle.html#search\">http://hl7.org/fhir/bundle.html#search</a><br>\nSearch parameters for Message are here: <a href=\"http://hl7.org/fhir/messageheader.html#search\" target=\"_blank\" title=\"http://hl7.org/fhir/messageheader.html#search\">http://hl7.org/fhir/messageheader.html#search</a><br>\nDiscussion on chaining is here: <a href=\"http://hl7.org/fhir/search.html#chaining\" target=\"_blank\" title=\"http://hl7.org/fhir/search.html#chaining\">http://hl7.org/fhir/search.html#chaining</a><br>\nExample: <code>GET [baseUrl]/Bundle?message.focus:Encounter.subject:Patient.identifier=[your MRN here]&amp;message.timestamp=ge2017&amp;message.timestamp=lt2018</code><br>\nThat'll give you all messages that have a focus that's an encounter whose subject is a Patient with the identifier specified and that were sent in 2017.</p>",
        "id": 153943086,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1520530602
    },
    {
        "content": "<p>Thanks guys. I've used Vonk quite a bit so I'll do some test runs using the example and look at the links provided for background information. Much appreciated.</p>",
        "id": 153943142,
        "sender_full_name": "Dave Henderson",
        "timestamp": 1520549062
    },
    {
        "content": "<p>A warning though: exactly this type of searchparameter (Bundle.composition and Bundle.message, that chain into one of the Bundle entries) are not yet supported by Vonk. It's on the roadmap to add this sometime in the next few months.</p>",
        "id": 153947247,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1521732685
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> - has this functionality been added in Vonk since this thread? I'm interested in potentially using this in Vonk, but I'm testing a few queries with the current version and am not getting any results back for these types of queries.</p>",
        "id": 179254907,
        "sender_full_name": "Adam Hatherly",
        "timestamp": 1572283955
    },
    {
        "content": "<p>Hi Adam, thanks for asking! I am sorry to say we haven't yet. Since you are the first person actually asking for it, that helps in prioritizing! If others need this type of search (chaining into Bundle entries), please let me know!</p>",
        "id": 179311755,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1572340889
    },
    {
        "content": "<p>hi I am new here. I have questions regarding REST FHIR server</p>",
        "id": 179913830,
        "sender_full_name": "Keerthivasan Ramanathan",
        "timestamp": 1572945532
    },
    {
        "content": "<p>This is the use case, i am working on now..<br>\nFor a group of patients, get most recent specific Lab result (A1C, Lipid panel)</p>\n<p>I believe that the Response would be a bundle of Observation resource. How can a search query can contain references to multiple patients or group of patients? Can someone guide me?</p>",
        "id": 179913964,
        "sender_full_name": "Keerthivasan Ramanathan",
        "timestamp": 1572945623
    },
    {
        "content": "<p>Querying for data across patients is pretty easy (though not all servers will support it).  If you just do a search and filter only by Observation type, you'll get all Observations of those types for all patients.  In R5, there'll be a parameter that lets you filter for subjects that are 'in' a Group.  The hard part about what you're asking for is \"most recent per type per patient\".  That mirror's SQL's \"group by\" mechanism - and RESTful search doesn't currently have any equivalent.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>, could this be done with GraphQL?</p>",
        "id": 179932451,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1572961474
    },
    {
        "content": "<p>maybe. This sounds like $lastn space to me</p>",
        "id": 179975490,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1572986746
    }
]