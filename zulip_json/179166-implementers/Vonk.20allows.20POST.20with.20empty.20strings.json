[
    {
        "content": "<p>Hello again,</p>\n<p>I find that when using Vonk it is possible to POST empty strings. For example if i post a CodeSystem containing 1 'concept' i can set 'code' and 'display' to a value of choice but then leave 'definition' empty -&gt; (\"\"). </p>\n<p>I find this problematic because when i want call the VONK in C# i use the HL7.Fhir nuget to parse the response returned from VONK to a FHIR resource it gives me format exceptions such as (\"The attribute 'value' in element 'definition' has an empty value, which is not allowed.\"). Shouldnt Vonk not allow POST of resources containing empty strings to be more compatible with the HL7 Nuget package validation(or the opposite) or is this a deliberate decision from Vonk to allow empty strings?</p>\n<p>I also found this applicable on some attributes on ValueSet.</p>\n<p>One could argue you dont want to post empty strings in the first place, but i just happened to find myself in this situation(dont ask how) so thought it might be of interest.</p>",
        "id": 165337533,
        "sender_full_name": "Jakob Lindblad",
        "timestamp": 1557496229
    },
    {
        "content": "<p>CodeSystem.concept.description has [0..1] in FHIR base profile so empty definition should be valid  unless other profile is used.</p>",
        "id": 165339417,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1557497810
    },
    {
        "content": "<blockquote>\n<p>CodeSystem.concept.description has [0..1] in FHIR base profile so empty definition should be valid  unless other profile is used.</p>\n</blockquote>\n<p>My guess is that an empty string in defintion still counts as 1. I mean its a difference between \"definition\": \"\" and no defintion at all. So if one declare they have a defintion it must have a value?</p>",
        "id": 165341367,
        "sender_full_name": "Jakob Lindblad",
        "timestamp": 1557499168
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"196371\">@Jakob Lindblad</span> Thanks for reaching out, of course we want to help you to get out of this situation! First of all, empty strings are never a valid value in FHIR, even if the underlying element specifies a cardinality of [0..1]. Therefore, Vonk should accept such a CodeSystem but ignore the empty element. It is definitely not a choice of Vonk to allow it. I assume that you are using the latest version of Vonk (2.0.1)? Could you share one of the ValueSets and CodeSystems? Are you posting the resources against the regular FHIR endpoint or against the administration endpoint?</p>",
        "id": 165353617,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1557508449
    },
    {
        "content": "<p>Hi Jakob, in the mean time, there is a setting in the FhirClient.ParserSettings.PermissiveParsing that you can set to 'true' - the parser will then ignore such empty strings.</p>",
        "id": 165373119,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1557524179
    },
    {
        "content": "<p>I know it is an explicit choice from the Vonk developers to be lenient in what they accept.  If you run your own copy of Vonk, this behaviour is configurable.</p>",
        "id": 165373237,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1557524342
    },
    {
        "content": "<p>See this <a href=\"http://docs.simplifier.net/vonk/features/prevalidation.html#validating-incoming-resources\" target=\"_blank\" title=\"http://docs.simplifier.net/vonk/features/prevalidation.html#validating-incoming-resources\">documentation page</a></p>",
        "id": 165373335,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1557524451
    },
    {
        "content": "<blockquote>\n<p>Hi <span class=\"user-mention silent\" data-user-id=\"196371\">Jakob Lindblad</span> Thanks for reaching out, of course we want to help you to get out of this situation! First of all, empty strings are never a valid value in FHIR, even if the underlying element specifies a cardinality of [0..1]. Therefore, Vonk should accept such a CodeSystem but ignore the empty element. It is definitely not a choice of Vonk to allow it. I assume that you are using the latest version of Vonk (2.0.1)? Could you share one of the ValueSets and CodeSystems? Are you posting the resources against the regular FHIR endpoint or against the administration endpoint?</p>\n</blockquote>\n<p>It seems like im using Vonk 1.0.0. (If that is what software.version referes to in /metadata) so might not be the same result when using Vonk 2.0.1 i guess. Im posting against the regular FHIR endpoint. <br>\nHere is an example of a CodeSystem i can post with empty defintion:<br>\n{<br>\n    \"resourceType\": \"CodeSystem\",<br>\n    \"meta\": {<br>\n        \"versionId\": \"ec7a5291-c366-4b4f-a496-c6589b813203\",<br>\n        \"lastUpdated\": \"2019-05-10T13:43:15.039+00:00\"<br>\n    },<br>\n    \"url\": \"testtest\",<br>\n    \"identifier\": {<br>\n        \"system\": \"dsada\",<br>\n        \"value\": \"dsada\"<br>\n    },<br>\n    \"version\": \"1\",<br>\n    \"name\": \"ett test\",<br>\n    \"title\": \"dsadadad\",<br>\n    \"status\": \"active\",<br>\n    \"experimental\": true,<br>\n    \"date\": \"2019-05-08T11:49:50.300Z\",<br>\n    \"publisher\": \"testtest\",<br>\n    \"contact\": [<br>\n        {<br>\n            \"name\": \"adsadad\",<br>\n            \"telecom\": [<br>\n                {<br>\n                    \"system\": \"phone\",<br>\n                    \"value\": \"dsadadad\"<br>\n                }<br>\n            ]<br>\n        }<br>\n    ],<br>\n    \"description\": \"testtest\",<br>\n    \"purpose\": \"gsgsg\",<br>\n    \"copyright\": \"testtest\",<br>\n    \"caseSensitive\": true,<br>\n    \"hierarchyMeaning\": \"is-a\",<br>\n    \"content\": \"example\",<br>\n    \"concept\": [<br>\n        {<br>\n            \"code\": \"2\",<br>\n            \"display\": \"tv√•\",<br>\n            \"concept\": [<br>\n                {<br>\n                    \"code\": \"4\",<br>\n                    \"display\": \"fyra\",<br>\n                    \"definition\" : \"\"<br>\n                }<br>\n            ]<br>\n        },<br>\n        {<br>\n            \"code\": \"1\",<br>\n            \"display\": \"ett\",<br>\n            \"concept\": [<br>\n                {<br>\n                    \"code\": \"3\",<br>\n                    \"display\": \"tre\"<br>\n                }<br>\n            ]<br>\n        }<br>\n    ]<br>\n}</p>",
        "id": 165517780,
        "sender_full_name": "Jakob Lindblad",
        "timestamp": 1557745540
    },
    {
        "content": "<blockquote>\n<p>Hi Jakob, in the mean time, there is a setting in the FhirClient.ParserSettings.PermissiveParsing that you can set to 'true' - the parser will then ignore such empty strings.</p>\n</blockquote>\n<p>This solved the problem but im guessing that settting PermissiveParsing = true will ignore other validations concerning data structure etc?</p>",
        "id": 165517975,
        "sender_full_name": "Jakob Lindblad",
        "timestamp": 1557745729
    },
    {
        "content": "<p>Would it be a possibility for you to try upgrading? The issue seems to be fixed in the latest release, I can't reproduce the behaviour against the public Vonk endpoint.</p>",
        "id": 165540471,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1557762259
    },
    {
        "content": "<p>And yes, PermissiveParsing will be a bit more lenient to some data structures. The documentation page that Ewout mentioned above describes a few things that are accepted with PermissiveParsing.</p>",
        "id": 165540679,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1557762405
    },
    {
        "content": "<blockquote>\n<p>Would it be a possibility for you to try upgrading? The issue seems to be fixed in the latest release, I can't reproduce the behaviour against the public Vonk endpoint.</p>\n</blockquote>\n<p>I can upgrade. Thank you for the support :-)</p>",
        "id": 165689264,
        "sender_full_name": "Jakob Lindblad",
        "timestamp": 1557900418
    }
]