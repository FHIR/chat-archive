[
    {
        "content": "<p>Could anyone point me to a link or links showing profiles based on QuestionnaireResponse in DSTU2 which have the group.question element sliced please? I have run my profile with its associated xml example through the Furore validation tool and am getting an error message I can't explain, so I think it could be a problem with how I am profiling. Would it be useful to attach the problematic files here?</p>",
        "id": 153899680,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501515554
    },
    {
        "content": "<p>better yet post the error message and the sliciing definition</p>",
        "id": 153899682,
        "sender_full_name": "Eric Haas",
        "timestamp": 1501515824
    },
    {
        "content": "<p>Profiling QuestionnaireResponse is unusual as typically you just define the Questionnaire and use that to guide the QuestionnaireResponse.  Profiling QuestionnaireResponse would only be used if you wanted to define behavior for responses independent of any particular Questionnaire.</p>",
        "id": 153899683,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1501515983
    },
    {
        "content": "<p>This is the error message<br>\n[ERROR] Code 'Y' from system '<a href=\"https://fhir.nhs.uk/ADW-CarerConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ADW-CarerConsultationStatus-1\">https://fhir.nhs.uk/ADW-CarerConsultationStatus-1</a>' with display 'Yes' is not valid for required binding to valueset '<a href=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\">https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1</a>' (at Bundle.entry[10].resource[0].group[0].question[1].answer[0].value[0])<br>\n[INFORMATION] Code 'Y' from system '<a href=\"https://fhir.nhs.uk/ADW-CarerConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ADW-CarerConsultationStatus-1\">https://fhir.nhs.uk/ADW-CarerConsultationStatus-1</a>' does not exist in valueset '<a href=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\">https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1</a>' (at Bundle.entry[10].resource[0].group[0].question[1].answer[0].value[0])</p>",
        "id": 153899684,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516030
    },
    {
        "content": "<p>Here is the zipped up set of files.<a href=\"/user_uploads/10155/Z0SkHGZznYd9QJqOSEde51-P/Profile.ADW-DischargeNotice.zip\" target=\"_blank\" title=\"Profile.ADW-DischargeNotice.zip\">Profile.ADW-DischargeNotice.zip</a></p>",
        "id": 153899685,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516150
    },
    {
        "content": "<p>Sorry there are a lot of files, but I thought it would be better to be complete rather than omit some you might need.</p>",
        "id": 153899686,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516192
    },
    {
        "content": "<p>The error message points me to the valueset, but that seems correct, so I'm thinking something is wrong in the ADW-Discharge-QuestionnaireResponse-1 profile.</p>",
        "id": 153899687,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516251
    },
    {
        "content": "<p>Have I got my slicing and grouping correct in the profile?</p>",
        "id": 153899688,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516266
    },
    {
        "content": "<p>The example throwing the error is ADW-Message-Discharge-Notice-Bundle-1-Example-1.xml</p>",
        "id": 153899689,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516328
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"lloyd@lmckenzie.com\" data-user-id=\"14\">@Lloyd McKenzie</span> - do you think we should have used Questionnaire instead?</p>",
        "id": 153899690,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516378
    },
    {
        "content": "<p>At <a href=\"http://hl7.org/fhir/DSTU2/questionnaireresponse.html\" target=\"_blank\" title=\"http://hl7.org/fhir/DSTU2/questionnaireresponse.html\">http://hl7.org/fhir/DSTU2/questionnaireresponse.html</a> it does state that \"QuestionnaireResponse provides a complete or partial list of answers to a set of questions filled when responding to a questionnaire. The questions may be included directly or by reference to a Questionnaire resource that defines the questions as well as the constraints on the allowed answers.\" and I have included the questions directly in QR with a choice of answer.</p>",
        "id": 153899692,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516634
    },
    {
        "content": "<p>The profile can be viewed visually at <a href=\"https://nhsconnect.github.io/FHIR-ADW-Messaging/Generated/Profile.ADW-DischargeNotice/adw-discharge-questionnaire-response-1.html\" target=\"_blank\" title=\"https://nhsconnect.github.io/FHIR-ADW-Messaging/Generated/Profile.ADW-DischargeNotice/adw-discharge-questionnaire-response-1.html\">https://nhsconnect.github.io/FHIR-ADW-Messaging/Generated/Profile.ADW-DischargeNotice/adw-discharge-questionnaire-response-1.html</a>, although I have since changed the profile name. The profile itself is the same apart from the labels for the child elements of the group.question element which I have removed in the zipped version..</p>",
        "id": 153899693,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501516989
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191594\">@Katie Wheatley</span>, from looking at the files, it seems there's both a ADW-ConsultationStatus-1 and a ADW-<em>Carer</em>ConsultationStatus-1 valueset. You are probably using a code from the first valueset against a binding to the second!</p>",
        "id": 153899694,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1501516992
    },
    {
        "content": "<p>@Ewout yes that's what I thought, but when I investigated this further it all looks correct.</p>",
        "id": 153899695,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501517100
    },
    {
        "content": "<p>You should use the code \"Y\" with system '<a href=\"https://fhir.nhs.uk/ADW-ConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ADW-ConsultationStatus-1\">https://fhir.nhs.uk/ADW-ConsultationStatus-1</a>' against the binding to valueset <a href=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\">https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1</a>, but you are not, you are using \"Y\" from system '<a href=\"https://fhir.nhs.uk/ADW-CarerConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ADW-CarerConsultationStatus-1\">https://fhir.nhs.uk/ADW-CarerConsultationStatus-1</a>'</p>",
        "id": 153899696,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1501517211
    },
    {
        "content": "<p>@Ewout - both these valuesets contain a code \"Y\" and I have used \"Y\" for both of my answers which I believe to be valid.</p>",
        "id": 153899697,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501517587
    },
    {
        "content": "<p>Yes, but both the code AND the system need to be correct.  In FHIR codes are not correct by merely comparing the codes - the systems need to be correct too!</p>",
        "id": 153899698,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1501517812
    },
    {
        "content": "<p>All codes in the valueset  <a href=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1\">https://fhir.nhs.uk/ValueSet/ADW-ConsultationStatus-1</a> are from the system  <a href=\"https://fhir.nhs.uk/ADW-ConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ADW-ConsultationStatus-1\">https://fhir.nhs.uk/ADW-ConsultationStatus-1</a>, so if you provide the code for an element with a binding to that valueset you MUST use the system  mentioned in that file which is <a href=\"https://fhir.nhs.uk/ADW-ConsultationStatus-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/ADW-ConsultationStatus-1\">https://fhir.nhs.uk/ADW-ConsultationStatus-1</a></p>",
        "id": 153899699,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1501517935
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191594\">@Katie Wheatley</span> Questionnaire gives you a lot more control - and if you're gathering a QuestionnaireResponse, most systems will expect a Questionnaire to exist and will be guided by that more than by a profile on QuestionnaireResponse.</p>",
        "id": 153899700,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1501518122
    },
    {
        "content": "<p>@Ewout - here is my code from my xml example - it does appear to be correct with the system in place.<br>\n&lt;group&gt;<br>\n                    &lt;question&gt;<br>\n                        &lt;text value=\"Has the patient been consulted regarding the proposed discharge date?\"/&gt;<br>\n                        &lt;answer&gt;<br>\n                            &lt;valueCoding&gt;<br>\n                                &lt;system value=\"https://fhir.nhs.uk/ADW-ConsultationStatus-1\"/&gt;<br>\n                                &lt;code value=\"Y\"/&gt;<br>\n                                &lt;display value=\"Yes\"/&gt;<br>\n                            &lt;/valueCoding&gt;<br>\n                        &lt;/answer&gt;<br>\n                    &lt;/question&gt;<br>\n                    &lt;question&gt;<br>\n                        &lt;text value=\"Has the patient's carer (if applicable) been consulted regarding the proposed discharge date?\"/&gt;<br>\n                        &lt;answer&gt;<br>\n                            &lt;valueCoding&gt;<br>\n                                &lt;system value=\"https://fhir.nhs.uk/ADW-CarerConsultationStatus-1\"/&gt;<br>\n                                &lt;code value=\"Y\"/&gt;<br>\n                                &lt;display value=\"Yes\"/&gt;<br>\n                            &lt;/valueCoding&gt;<br>\n                        &lt;/answer&gt;<br>\n                    &lt;/question&gt;<br>\n                &lt;/group&gt;</p>",
        "id": 153899701,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501518238
    },
    {
        "content": "<p>Katie, is that example in the zip?  If not, I'd like to have the full example, just PM me privately and I'll double check.</p>",
        "id": 153899704,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1501519788
    },
    {
        "content": "<p>@Ewout - yes the example is in the zip. It is in the Examples folder and it is called ADW-Message-Discharge-Notice-Bundle-1-Example-1.xml. Many thanks for your time with this, Ewout. I'm keen to hear your views on this issue.</p>",
        "id": 153899705,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501520011
    },
    {
        "content": "<p>@Ewout - I have to log off now, but I please do not hesitate to reply in this forum or to PM me and I will pick it up when I am back online.</p>",
        "id": 153899706,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501520267
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> I have resolved the problem with QuestionnaireResponse that we discussed here. The problem was in the profile which I have identified and now corrected.I'm really impressed with how quickly colleagues respond on this forum.</p>",
        "id": 153899848,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501568205
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> I have resolved the problem with QuestionnaireResponse that we discussed here. The problem was in the profile which I have identified and now corrected.I'm really impressed with how quickly colleagues respond on this forum.</p>\n</blockquote>\n<p>Ah, thanks for notifying me, I was just diving into this and starting to realize I had been hunting more or less the same issue for <span class=\"user-mention\" data-user-id=\"191362\">@Richard Kavanagh</span>. I remember now, it was the bit starting around line 190 with \"QuestionnaireResponse.group.question.linkId\"!</p>",
        "id": 153899869,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1501586363
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> Cheers, Ewout, your pointers helped me to resolve this.</p>",
        "id": 153899892,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501603406
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> However, the issue you were looking into for Richard may not be exactly the same, so please don't consider Richard's issue fixed  because I fixed my issue with your direction. Thanks again Ewout.</p>",
        "id": 153899930,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1501605030
    }
]