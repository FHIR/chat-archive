[
    {
        "content": "<p>Should the content of extensions be included in the snapshot of the host profile?</p>",
        "id": 263823609,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1638781874
    },
    {
        "content": "<p>I would expect them to contain the extension content.</p>",
        "id": 263828699,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1638785178
    },
    {
        "content": "<p>It seems that the snapshot generators of JAVA and .NET only include the root concept details into the host profiles snapshot. It leaves out the <code>.value[x]</code> constraints like a binding.  (Checked the JAVA stuff by looking at the snapshots of the US Core IG)</p>\n<p>Makes me wonder about this part of the spec:  \"a StructureDefinition can also carry a \"snapshot\" - a fully calculated form of the structure that is <strong>not dependent on any other structure.</strong>\" <a href=\"https://hl7.org/FHIR/profiling.html#snapshot\">https://hl7.org/FHIR/profiling.html#snapshot</a></p>",
        "id": 263833803,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1638788218
    },
    {
        "content": "<p>where what? Can you give an example?</p>",
        "id": 263835032,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638788852
    },
    {
        "content": "<p><a href=\"https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-patient.profile.xml.html\">us-core-patient profile</a> includes the <a href=\"https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-birthsex.profile.xml.html\">us-core-birthsex extension</a> like this in the diff:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>    <span class=\"nt\">&lt;element</span> <span class=\"na\">id=</span><span class=\"s\">\"Patient.extension:birthsex\"</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">\"Patient.extension\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;sliceName</span> <span class=\"na\">value=</span><span class=\"s\">\"birthsex\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;min</span> <span class=\"na\">value=</span><span class=\"s\">\"0\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;max</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"Extension\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/type&gt;</span>\n      <span class=\"nt\">&lt;mustSupport</span> <span class=\"na\">value=</span><span class=\"s\">\"false\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;mapping&gt;</span>\n        <span class=\"nt\">&lt;identity</span> <span class=\"na\">value=</span><span class=\"s\">\"argonaut-dq-dstu2\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;map</span> <span class=\"na\">value=</span><span class=\"s\">\"Patient.extension\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/mapping&gt;</span>\n    <span class=\"nt\">&lt;/element&gt;</span>\n</code></pre></div>\n<p>Resulting in this snapshot:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code> <span class=\"nt\">&lt;element</span> <span class=\"na\">id=</span><span class=\"s\">\"Patient.extension:birthsex\"</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">\"Patient.extension\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;sliceName</span> <span class=\"na\">value=</span><span class=\"s\">\"birthsex\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;short</span> <span class=\"na\">value=</span><span class=\"s\">\"Extension\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;definition</span> <span class=\"na\">value=</span><span class=\"s\">\"A code classifying the person&amp;#39;s sex assigned at birth  as specified by the [Office of the National Coordinator for Health IT (ONC)](https://www.healthit.gov/newsroom/about-onc).\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;comment</span> <span class=\"na\">value=</span><span class=\"s\">\"The codes required are intended to present birth sex (i.e., the sex recorded on the patient&amp;#x2019;s birth certificate) and not gender identity or reassigned sex.\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;min</span> <span class=\"na\">value=</span><span class=\"s\">\"0\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;max</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;base&gt;</span>\n        <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">\"DomainResource.extension\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;min</span> <span class=\"na\">value=</span><span class=\"s\">\"0\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;max</span> <span class=\"na\">value=</span><span class=\"s\">\"*\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/base&gt;</span>\n      <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"Extension\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/type&gt;</span>\n      <span class=\"nt\">&lt;condition</span> <span class=\"na\">value=</span><span class=\"s\">\"ele-1\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;constraint&gt;</span>\n        <span class=\"nt\">&lt;key</span> <span class=\"na\">value=</span><span class=\"s\">\"ele-1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;severity</span> <span class=\"na\">value=</span><span class=\"s\">\"error\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;human</span> <span class=\"na\">value=</span><span class=\"s\">\"All FHIR elements must have a @value or children\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">\"hasValue() or (children().count() &amp;gt; id.count())\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">\"@value|f:*|h:div\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;source</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/StructureDefinition/Element\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/constraint&gt;</span>\n      <span class=\"nt\">&lt;constraint&gt;</span>\n        <span class=\"nt\">&lt;key</span> <span class=\"na\">value=</span><span class=\"s\">\"ext-1\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;severity</span> <span class=\"na\">value=</span><span class=\"s\">\"error\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;human</span> <span class=\"na\">value=</span><span class=\"s\">\"Must have either extensions or value[x], not both\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">\"extension.exists() != value.exists()\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">\"exists(f:extension)!=exists(f:*[starts-with(local-name(.), &amp;#39;value&amp;#39;)])\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;source</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/StructureDefinition/Extension\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/constraint&gt;</span>\n      <span class=\"nt\">&lt;mustSupport</span> <span class=\"na\">value=</span><span class=\"s\">\"false\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;isModifier</span> <span class=\"na\">value=</span><span class=\"s\">\"false\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;mapping&gt;</span>\n        <span class=\"nt\">&lt;identity</span> <span class=\"na\">value=</span><span class=\"s\">\"rim\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;map</span> <span class=\"na\">value=</span><span class=\"s\">\"player[classCode=PSN|ANM and determinerCode=INSTANCE]/administrativeGender\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/mapping&gt;</span>\n      <span class=\"nt\">&lt;mapping&gt;</span>\n        <span class=\"nt\">&lt;identity</span> <span class=\"na\">value=</span><span class=\"s\">\"iso11179\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;map</span> <span class=\"na\">value=</span><span class=\"s\">\".patient.administrativeGenderCode\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/mapping&gt;</span>\n      <span class=\"nt\">&lt;mapping&gt;</span>\n        <span class=\"nt\">&lt;identity</span> <span class=\"na\">value=</span><span class=\"s\">\"argonaut-dq-dstu2\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;map</span> <span class=\"na\">value=</span><span class=\"s\">\"Patient.extension\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/mapping&gt;</span>\n    <span class=\"nt\">&lt;/element&gt;</span>\n</code></pre></div>\n<p>I would expect that also the following would be included in the snapshot:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>   <span class=\"nt\">&lt;element</span> <span class=\"na\">id=</span><span class=\"s\">\"Extension.url\"</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">\"Extension.url\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;fixedUri</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/element&gt;</span>\n    <span class=\"nt\">&lt;element</span> <span class=\"na\">id=</span><span class=\"s\">\"Extension.valueCode\"</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">\"Extension.valueCode\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;min</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;max</span> <span class=\"na\">value=</span><span class=\"s\">\"1\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;type&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"code\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/type&gt;</span>\n      <span class=\"nt\">&lt;binding&gt;</span>\n        <span class=\"nt\">&lt;strength</span> <span class=\"na\">value=</span><span class=\"s\">\"required\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">\"Code for sex assigned at birth\"</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;valueSet</span> <span class=\"na\">value=</span><span class=\"s\">\"http://hl7.org/fhir/us/core/ValueSet/birthsex\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/binding&gt;</span>\n    <span class=\"nt\">&lt;/element&gt;</span>\n</code></pre></div>",
        "id": 263838673,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1638791253
    },
    {
        "content": "<p>I would like to know why it isn't or why it shouldn't be included.</p>",
        "id": 263838791,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1638791327
    },
    {
        "content": "<p>Perhaps this question is more suited in the #conformance stream? Shall I move it?</p>",
        "id": 263970585,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1638865711
    },
    {
        "content": "<p>if you want. It's on my todo list, but it probably belongs in conformance</p>",
        "id": 263978667,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638870883
    },
    {
        "content": "<p>Moved to <a href=\"#narrow/stream/179177-conformance/topic/Snapshots.3A.20include.20extensions.20and.20datatype.20profiles.3F\">https://chat.fhir.org/#narrow/stream/179177-conformance/topic/Snapshots.3A.20include.20extensions.20and.20datatype.20profiles.3F</a></p>",
        "id": 264164294,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1638974622
    }
]