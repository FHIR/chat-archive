[
    {
        "content": "<p>Hey everybody,</p>\n<p>I have a question concering validating questionnaire responses with the corresponding questionnaire.<br>\nAs far as I understood the documentation every response is connected to a questionnaire via its canonical uri and the items via the individual linkid. Does this mean that every questionnaire has to be online available so it can be validated? How can i test responses locally in case the questionnaires have a copyright and cannot be uploaded? </p>\n<p>At the moment I'm using the jar-validator to validate the reponses and want to add the corresponding questionnaire as an additional parameter. As it seems this is not possible. All data I have are locally available and not yet on a fhir server. How can i test these responses before uploading?</p>\n<p>Thanks in advantage!</p>\n<p>Pascal</p>",
        "id": 245305574,
        "sender_full_name": "Pascal Escher",
        "timestamp": 1625746996
    },
    {
        "content": "<p>Hi Pascal <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span>. The canonical URI  of a resource serves as a globally unique identifier for that resource - though it is nice if they actually resolve as URLs, they don't absolutely have do (see <a href=\"https://www.hl7.org/fhir/r4/resource.html#canonical\">this bit of the FHIR spec</a>). Either way, you can test entirely locally by doing as follows:</p>\n<ol>\n<li>Make sure the canonical URL is entered in <code>Questionnaire.url</code> (if you are actually going to use it, it should be in a namespace you control so you can ensure it is unique)</li>\n<li>Store the questionnaire in a folder, say <em>qs/</em>.</li>\n<li>Make sure the the QuestionnaireResponse has the canonical URL of the matching Questionnaire in <code>QuestionnaireResponse.questionnaire</code> (assuming you are using R4)</li>\n<li>Use the <code>-ig</code> parameter with the JAR-validator to load the questionnaires (passing the name of the folder).</li>\n</ol>\n<p>Hence, assuming that the validator and the response is in the current directory and the Questionnaire in the sub-directory <em>/qs</em>, you would run</p>\n<div class=\"codehilite\"><pre><span></span><code>java -jar validator_cli.jar -version 4.0.1 -ig qs my-questionnaire-response-resource.json\n</code></pre></div>\n<p>This should automatically trigger validation against the Questionnaire. The full documentation for the JAR validator is available <a href=\"https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Validator\">here</a>.</p>",
        "id": 245307302,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1625748107
    },
    {
        "content": "<p>Hey Morten,</p>\n<p>thanks a lot! That's a very good guide about how to do validation properly!<br>\nI used the documentation of the validator, but at some point it lacks of some details in this chapter about where to put the questionnaire: <a href=\"https://confluence.hl7.org/pages/viewpage.action?pageId=35718580#UsingtheFHIRValidator-Questionnaires\">https://confluence.hl7.org/pages/viewpage.action?pageId=35718580#UsingtheFHIRValidator-Questionnaires</a><br>\nThanks again for clarify that out! Maybe somebody can add your explanation to confluence...</p>\n<p>Best regards Pascal</p>",
        "id": 245316220,
        "sender_full_name": "Pascal Escher",
        "timestamp": 1625752648
    },
    {
        "content": "<p>Do you mean validation on the client side or server side?<br>\nBoth sides need the definition to be able to function properly.</p>",
        "id": 245378041,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625781869
    },
    {
        "content": "<p>And typically the server receiving the content would have it's own copy of the questionnaire and not reach out externally (although it could)</p>",
        "id": 245378128,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625781947
    },
    {
        "content": "<p>At first I want to validate the data locally and later on this should be done automatically on the fhir server. <br>\nSo if I understood that correctly then the fhir server will validate a QuestionnaireResponse with the given questionnaire in the uri, e.g. <a href=\"http://hl7.org/fhir/Questionnaire/3141\">http://hl7.org/fhir/Questionnaire/3141</a> <br>\nin case the server does not contain a corresponding questionnaire? The internal questionnaire will be prioritized?</p>",
        "id": 245680065,
        "sender_full_name": "Pascal Escher",
        "timestamp": 1626093699
    },
    {
        "content": "<p>What do you mean by 'internal' Questionnaire?</p>",
        "id": 245700719,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1626102895
    },
    {
        "content": "<p>Internal questionnaire = questionnaire which is stored on the server as a fhir resource.</p>",
        "id": 245793253,
        "sender_full_name": "Pascal Escher",
        "timestamp": 1626165255
    },
    {
        "content": "<p>Then I'm not understanding this sentence: \"in case the server does not contain a corresponding questionnaire? The internal questionnaire will be prioritized?\"</p>\n<p>When dealing with a resource that is pointed to by canonical URL (profile, value set, code system, questionnaire, etc.) systems would typically first look for the resource within the local server.  If not found, they would then search their favorite registry(ies) to see if they can find the resource there.  As a last resort (and if comfortable from a security perspective), they might try to resolve the URL itself.</p>",
        "id": 245832151,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1626186260
    },
    {
        "content": "<p>Thanks, that was the point of my question! :)</p>",
        "id": 246059297,
        "sender_full_name": "Pascal Escher",
        "timestamp": 1626333311
    }
]