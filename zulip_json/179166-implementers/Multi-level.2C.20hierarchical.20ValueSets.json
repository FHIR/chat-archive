[
    {
        "content": "<p>How does FHIR handle multi-level hierarchy ValueSets?  What is the best way to represent them for data consumers?  Should it be in the data or referenced only through the ValueSet?<br>\nSpecifically, I am working referencing <strong>Observation.interpretation </strong>(Abnormal flag for lab test).  I want to use the recommended ValueSet <a href=\"https://www.hl7.org/fhir/valueset-observation-interpretation.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/valueset-observation-interpretation.html\">https://www.hl7.org/fhir/valueset-observation-interpretation.html</a>.  This ValueSet contains multiple levels; e.g. Level 1 is A = abnormal, Level 2 is AA = critical abnormal, Level 3 is HH = critical high.  If I have a test with a flag HH, how do I best represent in the Observation.interpretation that the HH is actual part of A (at level 1) and AA (at level 2)?  This might be important for consumers of the data like my analytics practitioners or business users, so that they can search for anything \"abnormal\" (anything under Level 1 A) instead of having to specify matching A or AA or HH, etc.  </p>\n<p>I think the best way is to capture <em>all applicable levels</em> in the Observation.interpretation (since it allows multiple entries).  That way A, AA, and HH are all present in the field.  It will require me to create a crosswalk based on the ValueSet so I can capture the hierarchy from the single abnormal value provided on the lab, but that is a trivial effort since we have the complete ValueSet.  What do you all think?</p>",
        "id": 171188565,
        "sender_full_name": "Matt Zajack",
        "timestamp": 1563468821
    },
    {
        "content": "<p>the code system is heirarchical already?:  <a href=\"https://www.hl7.org/fhir/v3/ObservationInterpretation/cs.html#definition\" target=\"_blank\" title=\"https://www.hl7.org/fhir/v3/ObservationInterpretation/cs.html#definition\">https://www.hl7.org/fhir/v3/ObservationInterpretation/cs.html#definition</a></p>",
        "id": 171190985,
        "sender_full_name": "Eric Haas",
        "timestamp": 1563470589
    },
    {
        "content": "<p>so to answer your question - that is how it is done.  can read the docs on value sets and code systems too</p>",
        "id": 171191024,
        "sender_full_name": "Eric Haas",
        "timestamp": 1563470627
    },
    {
        "content": "<p>Value sets reflect what codes are permitted.  Code Systems reflect the hierarchy/relationships.</p>",
        "id": 171191028,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1563470632
    },
    {
        "content": "<p>I understand the code system has the hierarchy defined and the value sets are permitted codes.  But I am still confused on how the hierarchy is represented and consumed.  Maybe this is an Analytics on FHIR question, but it affects the implementation.</p>\n<p>Let's say I have an \"HH\" abnormal flag value in the source ORU that I am converting to FHIR Observation.interpretation.  I also know I will have a data scientist who wants to consume the FHIR JSON to find all possible \"Abnormal\" flags.  What is the best way to enable the data scientist to grab abnormals?  </p>\n<p>1) Should I take the code system and programmatically add all higher level codes to the Observation.interpretation, like the code below?</p>\n<div class=\"codehilite\"><pre><span></span> <span class=\"s2\">&quot;interpretation&quot;</span><span class=\"err\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;coding&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">&quot;system&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;A&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;display&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Abnormal&quot;</span>\n        <span class=\"p\">},</span> <span class=\"p\">{</span>\n          <span class=\"nt\">&quot;system&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;AA&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;display&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Critical abnormal&quot;</span>\n        <span class=\"p\">},</span> <span class=\"p\">{</span>\n          <span class=\"nt\">&quot;system&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;HH&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;display&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Critical high&quot;</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">}</span>\n</pre></div>\n\n\n<p>2) Or do I only enter the \"HH\" code and tell the data scientist to look at the code system to create his/her own code to pull all \"abnormal\" values?</p>\n<p>Method 1 seems like the easiest for my data scientist who consumes FHIR, but Method 2 seems more conformant to FHIR best practices.  Is 1) a bad idea from a FHIR conformance perspective?</p>",
        "id": 171197495,
        "sender_full_name": "Matt Zajack",
        "timestamp": 1563475198
    },
    {
        "content": "<p>When you do a search, you can use the :below qualifier to do subsumption based matching (on servers that support that).  So a search for Observation?interpretation:below=A would return those with H or HH as well.  Note that 'interpretation isn't currently a standard search criteria.  (<span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> That seems like a significant omission to me - wouldn't searching for high/low/improved/sensitive/etc. be a pretty common use-case?)</p>",
        "id": 171201650,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1563478148
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> That is exactly what I was looking for!  The FHIR server would do the work to read the Code System and provide the lower values.  Just brilliant.  However, we do not have a FHIR server in our implementation, so it makes it have much more leg work.  But, this is another business case to bring in the FHIR server sooner.  Thank you!<br>\nJust to recap:  Use Method 2, only record the value from the message.  Specifying the correct code system will allow the FHIR server to do the work to find the correct hierarchy when searched using the modifier :below (in this case).<br>\nAnd... I cannot comment on how often Observation.interpretation is used, but it would sure be nice if it were part of the standard search criteria.</p>",
        "id": 171209398,
        "sender_full_name": "Matt Zajack",
        "timestamp": 1563484283
    },
    {
        "content": "<p>BTW- <strong>subsumption</strong> is my new word of the day.</p>",
        "id": 171209544,
        "sender_full_name": "Matt Zajack",
        "timestamp": 1563484377
    },
    {
        "content": "<p>I agree that it makes sense for 'interpretation' to be a standard search parameter.  It seems that it would be very useful to be able to search for all of the \"abnormal\" results for a test, etc.</p>",
        "id": 171252824,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1563539387
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"217496\">@Matt Zajack</span> for more complex retrieval cases you could use the :in modifier. So a search for Observation?interpretation:in=http://acme.org/vs/unusual-interpretations would match those that had a code in the expansion of the ValueSet with the URI <a href=\"http://acme.org/vs/unusual-interpretations\" target=\"_blank\" title=\"http://acme.org/vs/unusual-interpretations\">http://acme.org/vs/unusual-interpretations</a></p>",
        "id": 171297025,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1563574030
    },
    {
        "content": "<p>When defining such a ValueSet you can filter / select based on the hierarchy and other properties of the codes.</p>",
        "id": 171297098,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1563574093
    }
]