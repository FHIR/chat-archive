[
    {
        "content": "<p>Conceptually, does it make sense to use a logical reference to a medication code? <br>\nI have an element that is a Reference(Medication) and In R4, we don't have CodeableReference.</p>",
        "id": 267088174,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641489729
    },
    {
        "content": "<p>Does it make any sense to use a logical reference to the product code (because it's a code, and presumably the code would correspond to a Medication/MedicationKnowledge instance which could have an identifier)?</p>",
        "id": 267088198,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641489738
    },
    {
        "content": "<p>(perhaps this is a compliance question - I think I'm really asking if this is a stretch of the intent behind logical references)</p>",
        "id": 267088206,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641489741
    },
    {
        "content": "<p>i'm not sure what you mean by a \"logical reference\".  In almost all places in R4 where there is a Reference(Medication), it's a choice between that reference and a CodeableConcept.  If all you have is a code, then you put it in the CodeableConcept.</p>",
        "id": 267096981,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1641494080
    },
    {
        "content": "<p><a href=\"http://www.hl7.org/fhir/references.html#logical\">http://www.hl7.org/fhir/references.html#logical</a></p>",
        "id": 267107411,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641499533
    },
    {
        "content": "<p>I'm checking if it is conceptually sensible to use a code in a logical reference.</p>",
        "id": 267107534,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641499579
    },
    {
        "content": "<p>Context:</p>",
        "id": 267107549,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641499584
    },
    {
        "content": "<p>I have an element (in an extension) that is a reference. Not a codeableconcept, just a reference.</p>",
        "id": 267107650,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641499652
    },
    {
        "content": "<p>I see 3 ways to add a code there:</p>\n<ol>\n<li>use a logical reference, simply stick the code as an identifier for the reference, even if the reference doesn't resolve. Simple, available, but may be stretching the mechanism too far - because it implies that the code can be considered an identifier - which I think it can, in the sense of \"Medicinal Product Identifier\".</li>\n</ol>",
        "id": 267107956,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641499813
    },
    {
        "content": "<ol start=\"2\">\n<li>I make that extension a complex one and use Reference / CodeableConcept. Not really my preferred option because it's a complex extension</li>\n</ol>",
        "id": 267108234,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641499968
    },
    {
        "content": "<ol start=\"3\">\n<li>I can use a reference to a contained resource, and I use a contained resource just to use the product code. I don't like this because I'm just using a contained resource for one element, and also I'll eventually need to search on those product codes.</li>\n</ol>",
        "id": 267108392,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641500074
    },
    {
        "content": "<p>Why can't you have an extension that accepts a choice of Reference|CodeableConcept?</p>",
        "id": 267113601,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1641502822
    },
    {
        "content": "<p>so you have an extension that you don't control that just has a Reference(Medication)?  Then either #2 or #3 is the answer.  If you do control the extension, then you should either change it to be a choice of Reference|CodeableConcept or add a CodeableConcept element.</p>",
        "id": 267114385,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1641503201
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179166-implementers/topic/Logical.20reference.20to.20product.20code/near/267113601\">said</a>:</p>\n<blockquote>\n<p>Why can't you have an extension that accepts a choice of Reference|CodeableConcept?</p>\n</blockquote>\n<p>My bad, i didn't see that one. A complex extension is not pretty but i can change the data type of the extension</p>",
        "id": 267114994,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641503528
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> yes, I can change the extension</p>",
        "id": 267115067,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641503579
    },
    {
        "content": "<p>so, from this it seems that we don't like option 1... right?</p>",
        "id": 267115101,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641503600
    },
    {
        "content": "<p>in my opinion, option 1 isn't a option because a code isn't an identifier</p>",
        "id": 267115144,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1641503633
    },
    {
        "content": "<p>Right. That is the question I wanted to ask.</p>",
        "id": 267115196,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641503647
    },
    {
        "content": "<p>sorry, i didn't get that from your first post otherwise I'd have just said that. :)</p>",
        "id": 267115274,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1641503697
    },
    {
        "content": "<p>in Device, an identifier can be a GTIN (i.e. a code). In MedicinalProduct, I think the identifier is a code. Not sure about other resources.</p>",
        "id": 267115280,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641503699
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> does this relate to the discussion started in MnM last time we spoke? I took a note of the 3 issues I'd need to submit, but while I don't find where I put that note, I'm not sure if this seems related to that.</p>",
        "id": 267116074,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641503898
    },
    {
        "content": "<p>i don't think so. the conversation revolves around serial numbers and other unique identifiers of resources.  in regards to a medication, a code is not an identifier of a specific Medication so I don't see how it would relate.</p>",
        "id": 267116181,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1641503966
    },
    {
        "content": "<p>right. since Medication sees identifier as the identifier of an instance - this would not apply. That is consistent.</p>",
        "id": 267116336,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641504043
    },
    {
        "content": "<p>I wonder if for Device the same would apply, because for Device the Identifier is the Identifier for the product kind, not for the product instance</p>",
        "id": 267116412,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641504085
    },
    {
        "content": "<p>so, summary so far<br>\nIf we have an extension that is a Reference and we want to put a code there, we can</p>\n<ol>\n<li>\n<p>Use a logical reference, simply stick the code as an identifier for the reference, even if the reference doesn't resolve. Simple, available, but seems to be stretching the mechanism too far - because it woulc imply that the code can be considered an identifier - which seems to be not kosher</p>\n</li>\n<li>\n<p>Make that extension a complex one and use Reference / CodeableConcept. Not really my preferred option because it's a complex extension</p>\n</li>\n<li>\n<p>Use a reference to a contained resource, and I use a contained resource just to use the product code. I don't like this because I'm just using a contained resource for one element, and also I'll eventually need to search on those product codes.</p>\n</li>\n<li>\n<p><strong>Similar to 2, but instead of a complex extension, simply change the extension from <code>value[x] only Reference</code> to `value[x] only Reference or CodeableConcept</strong></p>\n</li>\n</ol>",
        "id": 267158414,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641540206
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"367071\">@Brecht Van Vooren</span> FYI . bold is what I would prefer</p>",
        "id": 267158422,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641540229
    },
    {
        "content": "<p>Re 3 bear in mind that according to the specification contained can be searched. It's just that current off the shelf implementations may or may not have this functionality.</p>",
        "id": 267175661,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1641552821
    },
    {
        "content": "<p>Right. See above</p>",
        "id": 267236302,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641585790
    },
    {
        "content": "<p>It's hardly implemented</p>",
        "id": 267236339,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641585809
    },
    {
        "content": "<p>But it would be very easy to add support for searching on one or two contained attributes.</p>",
        "id": 267252202,
        "sender_full_name": "Rik Smithies",
        "timestamp": 1641595091
    },
    {
        "content": "<p>Iâ€™m not sure why you think it is hardly implemented.  We implemented an organization-based system that used contained resources for related orgs and services and we are able to search on them.</p>",
        "id": 267273151,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1641613950
    },
    {
        "content": "<p><a href=\"#narrow/stream/179166-implementers/topic/Are.20contained.20resources.20evil.3F\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Are.20contained.20resources.20evil.3F</a></p>",
        "id": 267283850,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641630314
    },
    {
        "content": "<p>I wouldn't use a contained resource for this except in demonstrating some examples. In real life these resources (not the data) need to be profiled, searched, maintained.</p>",
        "id": 267283998,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641630586
    },
    {
        "content": "<p>using option 3 would be the equivalent to going to all the medicationDispense/Request/Administration and replace medication[x] with medicationReference (i.e. just remove the CodeableConcept), and tell people that to use a code, they'd have to contain a resource.</p>",
        "id": 267284310,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641631002
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"367071\">@Brecht Van Vooren</span> option 4 is what is done by all the resources that we're using, and I will propose the change.</p>",
        "id": 267284350,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641631070
    }
]