[
    {
        "content": "<p>There is currently a discussion in Germany ongoing on how to represent passport identifiers. It seems that there are currently two JIRA tickets discussing the issue: <a href=\"https://jira.hl7.org/browse/FHIR-26437\">https://jira.hl7.org/browse/FHIR-26437</a> and <a href=\"https://jira.hl7.org/browse/FHIR-19671\">https://jira.hl7.org/browse/FHIR-19671</a>. <a href=\"http://jira.hl7.org/browse/FHIR-19671\">FHIR-19671</a> already has a resolution, which seems to solve the issue in <a href=\"http://jira.hl7.org/browse/FHIR-26437\">FHIR-26437</a>. Is this already documented anywhere except these tickets?</p>",
        "id": 225983731,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1613047108
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191415\">@Giorgio Cangioli</span></p>",
        "id": 225983760,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1613047133
    },
    {
        "content": "<p>I support your request <span class=\"user-mention\" data-user-id=\"193430\">@Alexander Zautke</span>  : -)..<br>\n .. <a href=\"http://jira.hl7.org/browse/FHIR-19671\">FHIR-19671</a> recommends a pattern, but the status of this issue seems to be \"resolved-change required\". </p>\n<p>So ..it is not clear to me if this is the pattern that we should use or not.. any choice is fine for me, if there is one..</p>",
        "id": 225987371,
        "sender_full_name": "Giorgio Cangioli",
        "timestamp": 1613049325
    },
    {
        "content": "<p>There are a <em>lot</em> of change requests approved by FHIR-I and MnM that aren't yet actioned.  We're going to talk about that on FHIR-I tomorrow.  Volunteers welcome...</p>",
        "id": 226007257,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613057302
    },
    {
        "content": "<p>I tried my best here: <a href=\"https://github.com/HL7/fhir/pull/1094\">https://github.com/HL7/fhir/pull/1094</a><br>\nAs far as I can see in the source, it should be enough to get the entry added to the Identifier registry.</p>",
        "id": 226060239,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1613078755
    },
    {
        "content": "<p>We have the same issue here in Israel.<br>\nWe really need a single URI pattern - a base URL + country code suffix, that will allow us to represent international passport numbers.<br>\nWe also came across this <a href=\"https://github.com/HL7/fhir/pull/1094/files\">https://github.com/HL7/fhir/pull/1094/files</a> and decided to go for this pattern instead of something of our own, but after we incorporated it into our profile (by binding identifier.system to a ValueSet containing the URI's for different countries) we got an error from the java validator because the URL isn't resolveable.</p>\n<p>It seems like the validator only outputs this kind of error when the URL is under HL7's domain. When we switched to a URL under our domain, everything worked.</p>\n<p>So now we need to make a decision - should we use our own URL, knowing that this issue will almost surely be incorporated into the standard in the future, which means we will need to change the URL to be interoperable, or should we go for one of the suggested patterns in the existing tickets, which means we can't validate our resources until the URL becomes resolvable?</p>",
        "id": 233237507,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617660150
    },
    {
        "content": "<p>Some questions on that PR: </p>\n<ol>\n<li>could we change \"passport numbers\" to \"passport number\"? seems more consistent with other NS</li>\n<li>is it valid to have this in the unique id? <a href=\"http://hl7.org/fhir/sid/passport-[XXX]\">http://hl7.org/fhir/sid/passport-[XXX]</a></li>\n<li>what is the meaning of having different unique uris? Can they be different? Is any of those preferred?</li>\n</ol>",
        "id": 233270982,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1617689375
    },
    {
        "content": "<ol>\n<li>Sounds good, I can adapt the PR</li>\n<li>I choose the pattern based on some URIs I found on the CodeSystem Page here <a href=\"https://www.hl7.org/fhir/terminologies-systems.html\">https://www.hl7.org/fhir/terminologies-systems.html</a>, some of those also have a \"[X]\" in it</li>\n</ol>",
        "id": 233277363,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617694101
    },
    {
        "content": "<ol start=\"3\">\n<li>Would there be the assumption that the URIs are preferred over the oids? The oid represents the root of all country-specific oids, in general it would be identical to using \"<a href=\"http://hl7.org/fhir/sid/passport-[XXX]\">http://hl7.org/fhir/sid/passport-[XXX]</a>\". Both identify the root. At least that's my current understanding.</li>\n</ol>",
        "id": 233277936,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617694502
    },
    {
        "content": "<p>The question now becomes how would a country publish its country-specific naming system, e.g. <a href=\"http://hl7.org/fhir/sid/passport-ISR\">http://hl7.org/fhir/sid/passport-ISR</a>, given that it's under an HL7 domain</p>",
        "id": 233279036,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617695207
    },
    {
        "content": "<p>For preferred uri, I don't mean preferred URIs to OIDs. I mean which of the URIs has a preferred flag to True</p>",
        "id": 233293875,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1617703104
    },
    {
        "content": "<p>That's what I meant, sorry for being unclear. Why would \"<a href=\"http://hl7.org/fhir/sid/passport-[XXX]\">http://hl7.org/fhir/sid/passport-[XXX]</a>\" be preferred over \"2.16.840.1.113883.4.330\" other than the fact that an uri may be preferred over an oid?</p>",
        "id": 233299176,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617706256
    },
    {
        "content": "<p>Both identify the same namespace</p>",
        "id": 233299306,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617706346
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> <span class=\"user-mention\" data-user-id=\"191485\">@Ron Shapiro</span> You originally voted on the ticket (<a href=\"http://jira.hl7.org/browse/FHIR-19671\">J#19671</a>), any suggestions on how to handle the country specific naming systems? So we can help out <span class=\"user-mention\" data-user-id=\"361900\">@Daniel Mechanik</span> here</p>",
        "id": 233299761,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617706663
    },
    {
        "content": "<p>To be clear the pattern <a href=\"http://hl7.org/fhir/sid/passport-{XXX}\">http://hl7.org/fhir/sid/passport-{XXX}</a> is proposed that the {XXX} is just the country code. Thus the URL is a legitimate .system for our Identifier datatype.</p>",
        "id": 233305840,
        "sender_full_name": "John Moehrke",
        "timestamp": 1617710405
    },
    {
        "content": "<p>the actual passport number is carried in the Identifier.value</p>",
        "id": 233305957,
        "sender_full_name": "John Moehrke",
        "timestamp": 1617710456
    },
    {
        "content": "<p>and JUST the identifier, right? not some of the other stuff found in the machine readable passport barcode? <a href=\"https://en.wikipedia.org/wiki/Machine-readable_passport\">https://en.wikipedia.org/wiki/Machine-readable_passport</a></p>",
        "id": 233306034,
        "sender_full_name": "John Moehrke",
        "timestamp": 1617710488
    },
    {
        "content": "<p>Yes, currently we are only talking about the system</p>",
        "id": 233307343,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617711069
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"193430\">Alexander Zautke</span> <a href=\"#narrow/stream/179166-implementers/topic/Define.20urls.20for.20passports'.20identification/near/233279036\">said</a>:</p>\n<blockquote>\n<p>The question now becomes how would a country publish its country-specific naming system, e.g. <a href=\"http://hl7.org/fhir/sid/passport-ISR\">http://hl7.org/fhir/sid/passport-ISR</a>, given that it's under an HL7 domain</p>\n</blockquote>\n<p>If it will depend on each country publishing it's own then it's not really solving our original problem. We treat patients from all around the world and identify them by a country code + passport number. In order to represent this in FHIR we need all countries' URI's to be considerred valid as long as the country code is valid, and the pattern should be the same for all countries so that we can autogenerate the URI without a lookup in a registry.<br>\nIs there a way to do this? If not, then I guess generating and publishing all countries at once is a better aprocach</p>",
        "id": 233323094,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617717543
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Can the validator error be suppressed for now under the assumption that eventually the change will be applied and the validator will then accept the URI?</p>",
        "id": 233344482,
        "sender_full_name": "Ron Shapiro",
        "timestamp": 1617724422
    },
    {
        "content": "<p>Validator errors can't be suppressed.  Only warnings and info messages.</p>",
        "id": 233350507,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1617726795
    },
    {
        "content": "<p>The validator really throwing an error or is it just a warning anyway? <span class=\"user-mention\" data-user-id=\"361900\">@Daniel Mechanik</span></p>",
        "id": 233357747,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617729894
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"193430\">Alexander Zautke</span> <a href=\"#narrow/stream/179166-implementers/topic/Define.20urls.20for.20passports'.20identification/near/233357747\">said</a>:</p>\n<blockquote>\n<p>The validator really throwing an error or is it just a warning anyway? <span class=\"user-mention silent\" data-user-id=\"361900\">Daniel Mechanik</span></p>\n</blockquote>\n<p>It's an actual error, not a warning</p>",
        "id": 233458179,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617788181
    },
    {
        "content": "<p>This is the validator output:<br>\n<em>FAILURE</em> validating PatientTest.json:  error:1 warn:0 info:0<br>\n  Error @ Patient.identifier[2].system (line 23, col56) : URL value \"<a href=\"http://hl7.org/fhir/sid/passport-USA\">http://hl7.org/fhir/sid/passport-USA</a>\" does not resolve</p>",
        "id": 233491152,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617803640
    },
    {
        "content": "<p>Ah I guess, because it's an HL7 domain it's expected to resolve</p>",
        "id": 233497232,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1617805640
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"193430\">Alexander Zautke</span> <a href=\"#narrow/stream/179166-implementers/topic/Define.20urls.20for.20passports'.20identification/near/233497232\">said</a>:</p>\n<blockquote>\n<p>Ah I guess, because it's an HL7 domain it's expected to resolve</p>\n</blockquote>\n<p>Yes, this is what we found out :( <br>\nAnd correct me if I'm wrong here but it's an entirely different issue to have all countries' URL's resolve vs having the URL's in the HL7 registry. I think once they are resolved, then the entry isn't necessary for the validator.</p>",
        "id": 233504631,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617807804
    },
    {
        "content": "<p>One more thought - maybe if we switch the dash to a question mark, then we can make the base URL resolvable, something like this:<br>\n<a href=\"http://hl7.org/fhir/sid/passport\">http://hl7.org/fhir/sid/passport</a><br>\nand then all possible strings that come after the question mark will also resolve.<br>\nSo the URI for a USA passport will be:<br>\n<a href=\"http://hl7.org/fhir/sid/passport?USA\">http://hl7.org/fhir/sid/passport?USA</a><br>\nand it will be resolved.<br>\nIs that a valid approach <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ?</p>",
        "id": 233506338,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617808174
    },
    {
        "content": "<p>Having a question-mark would add complexity when searching - you'd have to escape it.  Also, it will make implementing the resolution process harder once we actually get around to doing it.  So I wouldn't be in favor of that as a change.</p>",
        "id": 233593305,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1617849413
    },
    {
        "content": "<p>Thank <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>, good point.</p>",
        "id": 233613829,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617867456
    },
    {
        "content": "<p>Anyway I've been doing some testing trying to understand when exactly the validator expects the URL to resolve, and it seems that most of the URI's in the registry that are HL7 URL's aren't resolvable either. For example the URL for US social security number, <a href=\"http://hl7.org/fhir/sid/us-ssn\">http://hl7.org/fhir/sid/us-ssn</a>,  behaves exactly the same as <a href=\"http://hl7.org/fhir/sid/passport-[xxx]\">http://hl7.org/fhir/sid/passport-[xxx]</a>, but the validator accepts it. So I guess once it's in the registry it does not need resolution. I wonder how hard will it be to add ALL countries to the registry at once?</p>",
        "id": 233613833,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617867463
    },
    {
        "content": "<p>Which countries? The list depends on the point in time when you create a list, on historic countries that may no longer exist, on countries that may or may not have been recognized as such by some other countries. Good luck :-)</p>",
        "id": 233622163,
        "sender_full_name": "René Spronk",
        "timestamp": 1617872508
    },
    {
        "content": "<p>Well I guess all codes defined in iso3166, just to make it simple. If there is a code for a country, then we may encounter a passport from that country. It's true though that the list is static and will have to be updated when new countries are born but that's pretty rare. We actually did this but not as NamingSystems, just as a ValueSet for the binding.</p>",
        "id": 233623558,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617873281
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span> of course if there's another solution that can support what we want to do without pre generating all possible URL's it would be better...</p>",
        "id": 233623828,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617873434
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191372\">René Spronk</span> <a href=\"#narrow/stream/179166-implementers/topic/Define.20urls.20for.20passports'.20identification/near/233622163\">said</a>:</p>\n<blockquote>\n<p>countries that may or may not have been recognized as such by some other countries. Good luck :-)</p>\n</blockquote>\n<p>I don't think recognition is relevant for looking at a passport as a means of identification for a person. The 'country' can be regarded as just the issuing authority of the document, it doesn't need to be recognized as a 'true' country by everyone. I guess the political headache you are talking about is more centerred around what codes enter iso3166</p>",
        "id": 233625075,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617874060
    },
    {
        "content": "<p>In short, don't worry about the fact that the validator yells - it's an issue with the validator.  Submit a Git issue against it.</p>",
        "id": 233676438,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1617896343
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> . How would I define the issue? is it that the validator shouldn't try to resolve HL7 URL's at all? or should it skip the resolution check specifically for the passport pattern? Or maybe for all URL's under HL7 domain that have a [xxx] in them? Another option might be to skip the check for URL's that are found in a binded ValueSet... A lot of option here :)</p>",
        "id": 233682043,
        "sender_full_name": "Daniel Mechanik",
        "timestamp": 1617898328
    },
    {
        "content": "<p>The validator should definitely check URLs in the HL7 space - because it should theoretically know about all of them.  The issue is that it <em>doesn't</em> know about these ones.  It's a bit trickier to handle these because it's not a fixed enumeration.  If and when there's a new country code, there'll be a need for a new SID.  However, given that the validator has access to the full set of country codes, it should be able to handle it.</p>",
        "id": 233691008,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1617901735
    },
    {
        "content": "<p>added a regex fixing this issue: <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/512\">https://github.com/hapifhir/org.hl7.fhir.core/pull/512</a></p>",
        "id": 240027309,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1621848830
    },
    {
        "content": "<p>This PR only matches the pattern, no countryCode validation (added this as a TODO: in the code)</p>",
        "id": 240027399,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1621848857
    },
    {
        "content": "<p>It's always nice when someone has already asked the question I want to know about. However, in addition to passports, is there anything similar with Tax ID numbers?</p>",
        "id": 249396888,
        "sender_full_name": "Grey Faulkenberry",
        "timestamp": 1628879823
    },
    {
        "content": "<p>Identifier system URI for EIN (= tax id) is <code>urn:oid:2.16.840.1.113883.4.4</code> (see <a href=\"http://oidref.com/2.16.840.1.113883.4.4\">http://oidref.com/2.16.840.1.113883.4.4</a>)</p>",
        "id": 249412016,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1628887478
    }
]