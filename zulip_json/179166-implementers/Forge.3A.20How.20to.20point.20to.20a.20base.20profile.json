[
    {
        "content": "<p>I have made a base profile in Forge which is local on my system. I want to 'inherit' from that profile but I cannot figure out what Forge wants me to enter in the <br>\n&lt;baseDefinition value=\"?\" /&gt;<br>\nelement. I tried <br>\n&lt;baseDefinition value=\"PhdBaseObservation\" /&gt;<br>\nsince the base profile is in the same directory as all my other profiles but Forge says it cannot find it. Is Forge expecting me to upload this profile to the FHIR site? That would not be good; especially in a pre-mature state!</p>\n<p>Anyone know how to do this?  Thanks!</p>",
        "id": 153923431,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1512668794
    },
    {
        "content": "<p>needs to be a full URL - a reference to a canonical URL</p>",
        "id": 153923489,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1512680390
    },
    {
        "content": "<p>Unless I am misunderstanding your query, we have done this in Forge with the menu option \"New &gt; New Derived Profile\". An 'open conformance resource' dialogue then displays where the 'base' profile needs to be found somewhere on your accessible file system. Then the profile will open in Forge, ready for your constraints etc. To confirm this, go to the properties tab and scroll down to the 'base definition' entry and the URL of the base profile will have been auto-entered. And as Grahame states - by inspecting the xml, the baseDefinition value is the full url.</p>",
        "id": 153923570,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1512702299
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192228\">@Brian Reinhold</span>, as Grahame explains, the baseDefinition property should contain the canonical url (i.e. value of StructureDefinition.url) of the desired base profile.<br>\n<span class=\"user-mention\" data-user-id=\"192270\">@Rob Eastwood</span> Correct! However Brian's question is not about creating a new derived profile, but about re-basing an existing profile. The Forge UI does not provide a command for this. But as I explained to Brian, you can manually hack the base url, then re-open in Forge to update the constraints wrt the new base.</p>",
        "id": 153923679,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1512725124
    },
    {
        "content": "<p>Note that references to conformance resources are almost always based on the canonical url, not on file name.</p>",
        "id": 153923680,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1512725182
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192270\">@Rob Eastwood</span> you may have given me a way to find out what I need to know. If I look at the 'canonical url' before I try to modify it, the value is <br>\n<a href=\"http://hl7.org/fhir/StructureDefinition/Observation\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/Observation\">http://hl7.org/fhir/StructureDefinition/Observation</a> which is great. That exists. However, my base structure definition is ONLY on my computer. No one wants my garbage on the public FHIR site. So I have no idea how to define this URL such that it points to a file in a directory on my local computer system. Maybe by starting from scratch as you suggest I will find that magic address.....</p>\n<p>And yes, doing so reveals this URL </p>\n<p><a href=\"http://pchalliance.org/phdfhir/StructureDefinition/PhdBaseObservation\" target=\"_blank\" title=\"http://pchalliance.org/phdfhir/StructureDefinition/PhdBaseObservation\">http://pchalliance.org/phdfhir/StructureDefinition/PhdBaseObservation</a></p>\n<p>which is just the fake URL I put in creating my base profile. So now I know the magic URL. However, I hope Forge doesn't try and look for the base definition at that location because it does not exist!</p>\n<p>But Forge likes it! It does not try to go to that non-existent site. Thus it works and I didn't even have to do any hand-editing after the fact. The merge appears to have been done perfectly. A quick scan of the derived profile also shows it only has the new stuff in the difference fields so it worked perfectly!</p>\n<p>I must add one extra step. You need to make some fake edit to complete the merge. Add a space, check that the 'star' gets indicated that you have made edits, delete it, and then save it. Otherwise the merge does not get done since your file is not saved. After manually saving you  will get the merged file with only the difference from your base profile.</p>",
        "id": 153923684,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1512726983
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192228\">@Brian Reinhold</span>, excellent! I'm happy it works.<br>\nConcerning canonical urls: please consider these as \"uri\" (identifier, not locator). How a system resolves a profile by the canonical url identifier depends on the implementation. Forge scans a directory on local disk. A FHIR server will typically perform a database lookup. Or it might even reach out to another server.<br>\nAs for you final comment, indeed Forge doesn't enable the save button until you actually made a change. Because Forge is not aware of the manually updated base, you have to simulate a change. In theory, Forge could detect that the recalculated diff has changed wrt the original. I'll think about it.</p>",
        "id": 153923686,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1512729550
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span>  The problem I had yesterday is that I did not know what that identifier should be. But by creating the new derived profile I found out and it was the identifier I had made up for the base profile. I did not know that would be ok. Then as far as the saving goes, I just wanted others following what I did to make the extra step. It may be obvious in hind sight considering one is working outside of Forge that it would be necessary but i skipped that step at first and wondered why nothing happened. Ah yes....</p>",
        "id": 153923687,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1512729854
    },
    {
        "content": "<p>Thank you for clarifying, I'll keep this in mind.</p>",
        "id": 153923688,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1512730489
    },
    {
        "content": "<p>Some bad news. One profile does not work correctly. The other 4 do. When I first did it and saved it, the saved profile looked good. All the common elements were removed. However, on reloading, one component element from the base profile does not get merged in correctly. It loses the cardinality in the element. I do not know why. In the other profiles this particular component element gets added fine.</p>",
        "id": 153923700,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1512733895
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192228\">@Brian Reinhold</span>, you could try to create a new derived profile from the same base profile (for testing/debugging purposes) and manually recreate the constraints on the specific element you're concerned about. Save the test profile and re-open in Forge and see if you can reproduce/explain the behavior.</p>",
        "id": 153923719,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1512737230
    }
]