[
    {
        "content": "<p>Hi Graham, I was trying to understand the filter feature of ValueSet on your test server, I was going through the provided examples and posted a ValueSet as below:   {<br>\n    \"resourceType\": \"ValueSet\",<br>\n    \"id\": \"13\",<br>\n    \"meta\": {<br>\n        \"versionId\": \"4\",<br>\n        \"lastUpdated\": \"2017-08-19T22:21:43Z\"<br>\n    },<br>\n    \"url\": \"<a href=\"http://hl7.org/fhir/ValueSet/inactive\" target=\"_blank\" title=\"http://hl7.org/fhir/ValueSet/inactive\">http://hl7.org/fhir/ValueSet/inactive</a>\",<br>\n    \"name\": \"Example-inactive\",<br>\n    \"title\": \"Example with inactive codes\",<br>\n    \"status\": \"draft\",<br>\n    \"description\": \"HL7 v3 ActMood Prdicate codes, including inactive codes\",<br>\n    \"compose\": {<br>\n        \"inactive\": true,<br>\n        \"include\": [{<br>\n            \"system\": \"<a href=\"http://hl7.org/fhir/v3/ActMood\" target=\"_blank\" title=\"http://hl7.org/fhir/v3/ActMood\">http://hl7.org/fhir/v3/ActMood</a>\",<br>\n            \"filter\": [{<br>\n                \"property\": \"concept\",<br>\n                \"op\": \"descendent-of\",<br>\n                \"value\": \"_ActMoodPredicate\"<br>\n            }]<br>\n        }]<br>\n    }<br>\n}   I was expecting the following output when I use the $expand operation: {<br>\n    \"resourceType\": \"ValueSet\",<br>\n    \"id\": \"inactive\",</p>\n<div class=\"codehilite\"><pre><span></span>&quot;url&quot;: &quot;http://hl7.org/fhir/ValueSet/inactive&quot;,\n&quot;name&quot;: &quot;Example-inactive&quot;,\n&quot;title&quot;: &quot;Example with inactive codes&quot;,\n&quot;status&quot;: &quot;draft&quot;,\n&quot;description&quot;: &quot;HL7 v3 ActMood Prdicate codes, including inactive codes&quot;,\n&quot;compose&quot;: {\n    &quot;inactive&quot;: true,\n    &quot;include&quot;: [{\n        &quot;system&quot;: &quot;http://hl7.org/fhir/v3/ActMood&quot;,\n        &quot;filter&quot;: [{\n            &quot;property&quot;: &quot;concept&quot;,\n            &quot;op&quot;: &quot;descendent-of&quot;,\n            &quot;value&quot;: &quot;_ActMoodPredicate&quot;\n        }]\n    }]\n},\n&quot;expansion&quot;: {\n    &quot;identifier&quot;: &quot;urn:uuid:46c00b3f-003a-4f31-9d4b-ea2de58b2a99&quot;,\n    &quot;timestamp&quot;: &quot;2017-02-26T10:00:00Z&quot;,\n    &quot;contains&quot;: [{\n            &quot;system&quot;: &quot;http://hl7.org/fhir/v3/ActMood&quot;,\n            &quot;inactive&quot;: true,\n            &quot;code&quot;: &quot;CRT&quot;,\n            &quot;display&quot;: &quot;criterion&quot;\n        },\n        {\n            &quot;system&quot;: &quot;http://hl7.org/fhir/v3/ActMood&quot;,\n            &quot;code&quot;: &quot;EXPEC&quot;,\n            &quot;display&quot;: &quot;expectation&quot;,\n            &quot;contains&quot;: [{\n                    &quot;system&quot;: &quot;http://hl7.org/fhir/v3/ActMood&quot;,\n                    &quot;code&quot;: &quot;GOL&quot;,\n                    &quot;display&quot;: &quot;goal&quot;\n                },\n                {\n                    &quot;system&quot;: &quot;http://hl7.org/fhir/v3/ActMood&quot;,\n                    &quot;code&quot;: &quot;RSK&quot;,\n                    &quot;display&quot;: &quot;risk&quot;\n                }\n            ]\n        },\n        {\n            &quot;system&quot;: &quot;http://hl7.org/fhir/v3/ActMood&quot;,\n            &quot;code&quot;: &quot;OPT&quot;,\n            &quot;display&quot;: &quot;option&quot;\n        }\n    ]\n}\n</pre></div>\n\n\n<p>}   However, I get the following error: {<br>\n\"resourceType\" : \"OperationOutcome\",\"text\" : {\"status\" : \"generated\",\"div\" : \"&lt;div xmlns=\\\"http://www.w3.org/1999/xhtml\\\"&gt;&lt;p&gt;The filter &quot;concept descendent-of _ActMoodPredicate&quot; was not understood in the context of http://hl7.org/fhir/v3/ActMood&lt;/p&gt;&lt;/div&gt;\"},\"issue\" : [{\"severity\" : \"error\",\"details\" : {\"text\" : \"The filter \\\"concept descendent-of _ActMoodPredicate\\\" was not understood in the context of http://hl7.org/fhir/v3/ActMood\"},\"diagnostics\" : \"(00000000014D6D42){FHIRServer.exe} [00000000018D7D42] FHIRValueSetExpander.TFHIRValueSetExpander.processCodes + $1132\\r\\n(00000000000421AB){FHIRServer.exe} [00000000004431AB] System.SysUtils.RaiseExceptObject + $2B\\r\\n(0000000000010166){FHIRServer.exe} [0000000000411166] System.@RaiseAtExcept + $E6\\r\\n(00000000000101B1){FHIRServer.exe} [00000000004111B1] System.@RaiseExcept + $11\\r\\n(00000000014D6D42){FHIRServer.exe} [00000000018D7D42] FHIRValueSetExpander.TFHIRValueSetExpander.processCodes + $1132\\r\\n(00000000014D4D35){FHIRServer.exe} [00000000018D5D35] FHIRValueSetExpander.TFHIRValueSetExpander.handleCompose + $C5\\r\\n(00000000014D3DDF){FHIRServer.exe} [00000000018D4DDF] FHIRValueSetExpander.TFHIRValueSetExpander.expand + $83F\\r\\n(00000000014E02E9){FHIRServer.exe} [00000000018E12E9] TerminologyServer.TTerminologyServer.expandVS + $519\\r\\n(00000000014DFBE8){FHIRServer.exe} [00000000018E0BE8] TerminologyServer.TTerminologyServer.expandVS + $A8\\r\\n(00000000018FC830){FHIRServer.exe} [0000000001CFD830] FHIRNativeStorage.TFhirExpandValueSetOperation.Execute + $820\\r\\n(00000000018EBD06){FHIRServer.exe} [0000000001CECD06] FHIRNativeStorage.TFHIRNativeOperationEngine.ExecuteOperation + $106\\r\\n(00000000016C2B8A){FHIRServer.exe} [0000000001AC3B8A] FHIRStorageService.TFHIROperationEngine.Execute + $36A\\r\\n(00000000017BAD5B){FHIRServer.exe} [0000000001BBBD5B] FHIRRestServer.TFhirWebServer.ProcessRequest + $12B\\r\\n(00000000017AFBC5){FHIRServer.exe} [0000000001BB0BC5] FHIRRestServer.TFhirWebServer.HandleRequest + $1165\\r\\n(00000000017AB9C6){FHIRServer.exe} [0000000001BAC9C6] FHIRRestServer.TFhirWebServer.PlainRequest + $996\\r\\n(00000000014C9F19){FHIRServer.exe} [00000000018CAF19] IdCustomHTTPServer.TIdCustomHTTPServer.DoCommandGet + $49\\r\\n(00000000014CB895){FHIRServer.exe} [00000000018CC895] IdCustomHTTPServer.TIdCustomHTTPServer.DoExecute + $AC5\\r\\n(0000000000243B99){FHIRServer.exe} [0000000000644B99] IdContext.TIdContext.Run + $29\\r\\n(0000000000241BBA){FHIRServer.exe} [0000000000642BBA] IdTask.TIdTask.DoRun + $1A\\r\\n(0000000000245AFB){FHIRServer.exe} [0000000000646AFB] IdThread.TIdThreadWithTask.Run + $1B\\r\\n(0000000000244E1A){FHIRServer.exe} [0000000000645E1A] IdThread.TIdThread.Execute + $EA\\r\\n(000000000011DA83){FHIRServer.exe} [000000000051EA83] System.Classes.ThreadProc + $43\\r\\n(0000000000010D0B){FHIRServer.exe} [0000000000411D0B] System.ThreadWrapper + $3B\\r\\n(0000000000007364){KERNEL32.DLL} [00007FFCCAD18364] BaseThreadInitThunk + $14\\r\\n(0000000000066091){ntdll.dll   } [00007FFCCD2A7091] RtlUserThreadStart + $21\\r\\n\"}]}</p>",
        "id": 153902881,
        "sender_full_name": "ravi.kuchi",
        "timestamp": 1503182061
    },
    {
        "content": "<p>I am not sure if I this is an error on the server implementation or misuse of the filter operation, if you can provide a sample of codesystem with properties and the right usage of ValueSet with a filter on the properties defined it would help the users implement them correctly. Thanks</p>",
        "id": 153902883,
        "sender_full_name": "ravi.kuchi",
        "timestamp": 1503182201
    },
    {
        "content": "<p>looks like I have work to do on my server</p>",
        "id": 153902951,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1503298656
    }
]