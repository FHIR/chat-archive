[
    {
        "content": "<p>Hi All, could someone please suggest the right way of handling realtime observation data with Fhir. Use case is the following: we want to stream realtime ECG data to the server in order to display curve data to the user.</p>",
        "id": 226806439,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613653463
    },
    {
        "content": "<p>Have you looked at the SampledData data type?</p>",
        "id": 226825467,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613661446
    },
    {
        "content": "<p>(with Observation)</p>",
        "id": 226825477,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613661450
    },
    {
        "content": "<p>yes, I did look at it. The question is how to handle a continuous  stream of observations</p>",
        "id": 226826039,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613661665
    },
    {
        "content": "<p>the one option is to send SampledData periodically</p>",
        "id": 226826115,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613661694
    },
    {
        "content": "<p>but I don't really like this approach</p>",
        "id": 226826133,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613661701
    },
    {
        "content": "<p>What would you propose instead?</p>",
        "id": 226829289,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613662959
    },
    {
        "content": "<p>I would propose using websockets for realtime live data transfer</p>",
        "id": 226829436,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613663026
    },
    {
        "content": "<p>Ok, but websockets containing what?</p>",
        "id": 226829651,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613663095
    },
    {
        "content": "<p>If you're going to use FHIR, what is exchanged has to be stand-alone interpretable</p>",
        "id": 226829733,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613663121
    },
    {
        "content": "<p>There's nothing to stop you from just sending a stream of values to a websocket, but that wouldn't be FHIR.  FHIR would be what you turn that into for subsequent storage/exchange.</p>",
        "id": 226829844,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613663160
    },
    {
        "content": "<p>I see, but in this case FHIR is not intended to be used for live data streaming</p>",
        "id": 226830038,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613663222
    },
    {
        "content": "<p>FHIR can be, but if you're doing that, it'll be done by chunking.  Either one Observation per value or one Observation with SampledData for some periodic chunk of data.</p>",
        "id": 226830834,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613663501
    },
    {
        "content": "<p>I suppose you could also use a FHIR operation to say \"Hey, I have a new value\" and just keep calling the operation.</p>",
        "id": 226830958,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1613663537
    },
    {
        "content": "<p>And you'd need a FHIR repo that can \"keep up\" with the real-time storage and client access demands of this \"high frequency\" data.   I've seen a similar use case with realtime data from physio monitors, e.g. vital signs every 30 seconds.</p>",
        "id": 226853522,
        "sender_full_name": "John Silva",
        "timestamp": 1613671751
    },
    {
        "content": "<p>I've heard this raised as an issue a couple of times.  From what I've seen:</p>\n<ul>\n<li>Use the data in a non-FHIR format, have a collection point that periodically transforms into SampledData and sends to a FHIR server.<ul>\n<li>Pros: data is usable immediately, works with standard FHIR server (no custom code), resources are only stored once</li>\n<li>Cons: 'fast access' to data is not in FHIR, period delay in getting data into the FHIR server</li>\n<li>One OSS Example: (disclosure note - I work for MS, though not any of the IoMT teams)<ul>\n<li>Connector ('server' pieces that transform data into FHIR) <a href=\"https://github.com/microsoft/iomt-fhir\">on GitHub</a></li>\n<li>HealthKit Bridge ('client' that transforms iOS HealthKit data to feed the pipeline) <a href=\"https://github.com/microsoft/healthkit-on-fhir\">on GitHub</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Send full FHIR resources (e.g., POST SampledData, followed by PUT or PATCH SampledData)<ul>\n<li>Pros: fully FHIR</li>\n<li>Cons: <em>many</em> versions of resources, heavy device requirements (needs to not only generate FHIR, but track resource IDs over time, etc.).</li>\n</ul>\n</li>\n<li>Define an operation that registers data with the FHIR server, and have it do the processing.<ul>\n<li>Pros: data is always available in FHIR</li>\n<li>Cons: requires custom code on the server, updates to clients can be delayed, version management</li>\n</ul>\n</li>\n</ul>",
        "id": 226859849,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1613674046
    },
    {
        "content": "<p>I suppose you could also keep patching the same resource with the latest data.</p>",
        "id": 226872414,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1613679017
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> yep, I consider that part of the second (create a resource then update it) but wasn't explicit about it.  I've updated to include it, but wanted to add a note so your comment still makes sense  =)</p>",
        "id": 226873076,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1613679300
    },
    {
        "content": "<p>guys, thanks very much for all the suggestions</p>",
        "id": 226929348,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613720732
    },
    {
        "content": "<p>How frequent is the real time data stream? </p>\n<p>If it's relatively low I'm tending to favour  a FHIR Message equivalent of 'unsolicited-observation' for a collection of Observations and DiagnosticReport or a POST /Observation or observation-event FHIR Message (the observation profile would be same/similar and use case dependent). [I've assumed it's a combination of all three]</p>",
        "id": 226936629,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1613725580
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191687\">Kevin Mayfield</span> <a href=\"#narrow/stream/179166-implementers/topic/Streaming.20realtime.20observations/near/226936629\">said</a>:</p>\n<blockquote>\n<p>How frequent is the real time data stream? </p>\n<p>If it's relatively low I'm tending to favour  a FHIR Message equivalent of 'unsolicited-observation' for a collection of Observations and DiagnosticReport or a POST /Observation or observation-event FHIR Message (the observation profile would be same/similar and use case dependent). [I've assumed it's a combination of all three]</p>\n</blockquote>\n<p>around 100 ms</p>",
        "id": 226936709,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613725636
    },
    {
        "content": "<p>Would be tempted to not use FHIR for the streaming.  Does this may be blutooth interface at present? Wondering what the interaces are like, I think the amount of data they transmit is low. Such as datetime, deviceID and an array of observations normally of the form Obs Code and value.<br>\nConversion to FHIR would probably occur but not at the streaming stage?</p>",
        "id": 226937866,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1613726276
    },
    {
        "content": "<p>Kevin, this is exactly one of the options that we're considering. But we have thee hard requirement from product owner to use FHIR only wherever it's feasible</p>",
        "id": 226938249,
        "sender_full_name": "Artem Polyakov",
        "timestamp": 1613726477
    },
    {
        "content": "<p>I was thinking page 7 of this was more practical <a href=\"https://www.devdays.com/wp-content/uploads/2019/02/DD18-US-FHIR-and-Devices-Todd-Cooper-2018-06-19.pdf\">https://www.devdays.com/wp-content/uploads/2019/02/DD18-US-FHIR-and-Devices-Todd-Cooper-2018-06-19.pdf</a><br>\n(probably available on youtube)<br>\nSo stage 1 - not FHIR<br>\nStage 2 - maybe RESTful FHIR<br>\nStage 3 - probably FHIR Message<br>\nThe requirements change between stages.</p>",
        "id": 226938999,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1613726905
    }
]