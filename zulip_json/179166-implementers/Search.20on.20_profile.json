[
    {
        "content": "<p>I'm looking to ask a clarifying question when searching on _profile in R4, Given the Model type is Canonical and the Search Parameter type is Uri.<br>\nIf I had: meta.profile=http://example.com|5#abc, should I be able to find this with _profile=http://example.com or _profile=http://example.com|5 or _profile=http://example.com#abc. Or should the Uri search type on Canonical just be treated like the same as where the Model Type is Uri/Url?</p>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 223455989,
        "sender_full_name": "Brendan Kowitz",
        "timestamp": 1611188669
    },
    {
        "content": "<p>Playing around with other servers, if I use \"http://example.com|5#abc\" as the profile:</p>\n<ul>\n<li>HAPI I need to encode the string \"http%3A%2F%2Fexample.com%7C5%23abc\" exactly to find the resource</li>\n<li>Vonk seems to always ignore the Canonical parts (|5#abc) so will find the Uri portion \"<a href=\"http://example.com\">http://example.com</a>\" no matter what comes after in the search string</li>\n</ul>",
        "id": 223457733,
        "sender_full_name": "Brendan Kowitz",
        "timestamp": 1611190373
    },
    {
        "content": "<p>I'm not sure</p>",
        "id": 223462251,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1611195028
    },
    {
        "content": "<p>Well, this is annoying  =)...</p>\n<p>Starting with the <a href=\"https://www.hl7.org/fhir/search.html#profile\">_profile search parameter</a>, it appears to be defined as a <a href=\"https://www.hl7.org/fhir/search.html#reference\">reference</a> type parameter.</p>\n<p>The <a href=\"https://www.hl7.org/fhir/search.html#versions\">References and Versions</a> section specifies that references to canonicals can have versions specified with the <code>|</code>.</p>\n<p>Additional guidance can then be found in the <a href=\"https://www.hl7.org/fhir/references.html#canonical\">versions section of the references page</a>.  Since the <code>meta.profile</code> is a reference to a canonical of a <code>Structure Definition</code> (which is in the list), I'd say this is the \"most authoritative\" section of the spec.</p>\n<p>So, my (un-authoritative) reading would be that:</p>\n<ul>\n<li>versioned search should be allowed with the <code>|</code> character</li>\n<li>generally the <code>|</code> character should be url encoded to <code>%7C</code> - I cannot seem to find an RFC that lists it as a reserved character, but most url encode methods do the conversion (note that FHIR guidance for servers is to accept either encoded or not)</li>\n<li>a query without a version should start with the highest version of the resource and work backwards to look for a match (note that partial versions are also allowed, <code>5</code> would match <code>5.1</code> or <code>5.0</code>)</li>\n<li><del>I can't find any guidance about mixing the <code>|</code> and the <code>#</code> segments (nor any examples)... so <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span>  on that piece</del></li>\n</ul>\n<p>Edit: I did find:<br>\n<code> &lt;valueSet value=\"http://fhir.acme.com/Questionnaire/example|1.0#vs1\"/&gt;</code>: This is a reference to the value set with id \"vs1\" in version 1.0 of the identified questionnaire. The common case for this is internal references.</p>\n<p>So, that looks valid too.</p>",
        "id": 223568800,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1611262402
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span>, yes, I didn't cover ModelType Canonical =&gt; Search Type Reference searches, the logic here is more complex for sure.<br>\nThat same page (<a href=\"https://www.hl7.org/fhir/resource.html#search\">https://www.hl7.org/fhir/resource.html#search</a>) also has _profile's search type being a uri.<br>\nSome relationships (QuestionnaireResponse.questionnaire) are defined where the search type is Reference</p>",
        "id": 223576907,
        "sender_full_name": "Brendan Kowitz",
        "timestamp": 1611266466
    },
    {
        "content": "<p>Yep, that's definitely a conflict.  I'll file a ticket to bring up at FHIR-I, unless <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> , or anyone else wants to jump in with something.</p>",
        "id": 223581079,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1611268644
    },
    {
        "content": "<p>As a note, I can see that it used to be listed on that page as a <code>reference</code> type (e.g., in <a href=\"http://hl7.org/fhir/2018Dec/resource.html#search\">3.5a.0</a>).  I'm not going to try and find the commit that changed it to sort it out now though.</p>",
        "id": 223582206,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1611269365
    },
    {
        "content": "<p>Created <a href=\"http://jira.hl7.org/browse/FHIR-30514\">FHIR#30514</a> .</p>",
        "id": 223582596,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1611269604
    },
    {
        "content": "<p>If my Account resource is defined with a meta.profile \"<a href=\"http://hl7.org/fhir/us/xxx/StructureDefinition/specialgrouping\">http://hl7.org/fhir/us/xxx/StructureDefinition/specialgrouping</a>\" and I want to search for all resources with that profile?   GET [base]/Account?_profile=http://hl7.org/fhir/us/xxx/StructureDefinition/specialgrouping<br>\nShould that be all I need to do?  Is there some other set up?  Do I need to define the profile in the structure definition?</p>",
        "id": 242946737,
        "sender_full_name": "Ruth berge",
        "timestamp": 1623879534
    },
    {
        "content": "<p>That's it, according to the base specification. If your server supports search with this parameter, it should find all the accounts tagged in this way.</p>",
        "id": 242948836,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1623880826
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> , but this doesn't work on my server so if the community is telling me I've read it right, then I will report the issue to the vendor</p>",
        "id": 243043236,
        "sender_full_name": "Ruth berge",
        "timestamp": 1623946523
    },
    {
        "content": "<p>Servers aren't required to support _profile at all and may also have limitations on which profiles they support tracking and searching against.</p>",
        "id": 243974293,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1624657224
    }
]