[
    {
        "content": "<p>I have done a standard DiagnosticReport search operation using FhirClient (using .NET FHIR API STU3)</p>\n<div class=\"codehilite\"><pre><span></span><code>Bundle diagnosticReportSearchBundle = fhirClient.Search&lt;DiagnosticReport&gt;(searchParams);\n</code></pre></div>\n\n\n<p>And based on the bundle results, I am reading the data and executing my logic.</p>\n<p>I identified my search params were wrong, so FHIR server returned all the DiagnosticResources, and not just limited to my search criteria.<br>\nThis stumped me. <br>\nWhat is the way to identify if the search returned \"OperationOutcome\" resource? Should I traverse all entries for every search and determine that there is no OperationOutcome, this is good result. Seems a bad approach, any better way to identify this?</p>",
        "id": 208879414,
        "sender_full_name": "Santosh Jami",
        "timestamp": 1599076865
    },
    {
        "content": "<p>Why would you want to look for OperationOutcome? Servers are under no obligation to return those when search parameters are not recognized. You can try a <code>Prefer: handling=strict</code> header if you want the search to fail if parameters are not recognized but I do not know how many server implement that (See <a href=\"http://hl7.org/fhir/search.html#errors\">http://hl7.org/fhir/search.html#errors</a>)</p>",
        "id": 208887143,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1599080463
    },
    {
        "content": "<p>I tried the following query on my Vonk server:<br>\n<code>https://localhost/DiagnosticReport?patient=abc123&amp;_format=json</code></p>\n<p>Then I got the below response 200 status code - all the daignosticreports returned to me, no search criteria applied with error details in operationoutcome resource as one of the entries.<br>\nI am trying to find how to identify that below outcome was an error in search instead of the relevant results.</p>\n<p>I am posting the response here:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;resourceType&quot;: &quot;Bundle&quot;,\n    &quot;type&quot;: &quot;searchset&quot;,\n    &quot;entry&quot;: [\n        {\n            &quot;fullUrl&quot;: &quot;https://localhost:10022/DiagnosticReport/A1-B1-C1&quot;,\n            &quot;search&quot;: {\n                &quot;mode&quot;: &quot;match&quot;\n            },\n            &quot;resource&quot;: {\n                &quot;resourceType&quot;: &quot;DiagnosticReport&quot;,\n                &quot;id&quot;: &quot;A1-B1-C1&quot;,\n                &quot;extension&quot;: [\n                    {\n                        &quot;url&quot;: &quot;http://www.acme.org/resultsource&quot;,\n                        &quot;valueString&quot;: &quot;Interface&quot;\n                    }\n                ],\n                &quot;identifier&quot;: [\n                    {\n                        &quot;type&quot;: {\n                            &quot;coding&quot;: [\n                                {\n                                    &quot;system&quot;: &quot;http://hl7.org/fhir/identifier-type&quot;,\n                                    &quot;code&quot;: &quot;PLAC&quot;,\n                                    &quot;display&quot;: &quot;PLAC&quot;\n                                }\n                            ]\n                        },\n                        &quot;system&quot;: &quot;PLAC&quot;,\n                        &quot;value&quot;: &quot;C1&quot;\n                    },\n                    {\n                        &quot;type&quot;: {\n                            &quot;coding&quot;: [\n                                {\n                                    &quot;system&quot;: &quot;http://hl7.org/fhir/identifier-type&quot;,\n                                    &quot;code&quot;: &quot;FILL&quot;,\n                                    &quot;display&quot;: &quot;FILL&quot;\n                                }\n                            ]\n                        },\n                        &quot;system&quot;: &quot;FILL&quot;,\n                        &quot;value&quot;: &quot;D1&quot;\n                    }\n                ],\n                &quot;status&quot;: &quot;final&quot;,\n                &quot;code&quot;: {\n                    &quot;coding&quot;: [\n                        {\n                            &quot;system&quot;: &quot;99QDI&quot;,\n                            &quot;code&quot;: &quot;36126&quot;,\n                            &quot;display&quot;: &quot;RPR(DX) REFL CONFIRM&quot;\n                        }\n                    ]\n                },\n                &quot;subject&quot;: {\n                    &quot;reference&quot;: &quot;https://localhost:10022/Patient/A1&quot;\n                },\n                &quot;context&quot;: {\n                    &quot;reference&quot;: &quot;https://localhost:10022/Encounter/B1&quot;\n                },\n                &quot;effectiveDateTime&quot;: &quot;2018-05-11T21:48:00+00:00&quot;,\n                &quot;issued&quot;: &quot;2020-09-01T18:39:00.000+00:00&quot;,\n                &quot;specimen&quot;: [\n                    {\n                        &quot;reference&quot;: &quot;https://localhost:10022/Specimen/LAB-D1&quot;\n                    }\n                ],\n                &quot;result&quot;: [\n                    {\n                        &quot;reference&quot;: &quot;https://localhost:10022/Observation/A1-B1-C1-LabOrder-HEPC&quot;\n                    },\n                    {\n                        &quot;reference&quot;: &quot;https://localhost:10022/Observation/A1-B1-C1-LabOrder-Syphilis&quot;\n                    }\n                ],\n                &quot;conclusion&quot;: &quot;SELF&quot;,\n                &quot;meta&quot;: {\n                    &quot;versionId&quot;: &quot;216b1a5a-4ecf-48f6-a1c1-5fe791b1786f&quot;,\n                    &quot;lastUpdated&quot;: &quot;2020-09-02T19:00:15.495+00:00&quot;\n                }\n            }\n        },\n        {\n            &quot;fullUrl&quot;: &quot;https://localhost:10022/DiagnosticReport/F1-G1-H1&quot;,\n            &quot;search&quot;: {\n                &quot;mode&quot;: &quot;match&quot;\n            },\n            &quot;resource&quot;: {\n                &quot;resourceType&quot;: &quot;DiagnosticReport&quot;,\n                &quot;id&quot;: &quot;F1-G1-H1&quot;,\n                &quot;extension&quot;: [\n                    {\n                        &quot;url&quot;: &quot;http://www.acme.org/resultsource&quot;,\n                        &quot;valueString&quot;: &quot;Interface&quot;\n                    }\n                ],\n                &quot;identifier&quot;: [\n                    {\n                        &quot;type&quot;: {\n                            &quot;coding&quot;: [\n                                {\n                                    &quot;system&quot;: &quot;http://hl7.org/fhir/identifier-type&quot;,\n                                    &quot;code&quot;: &quot;PLAC&quot;,\n                                    &quot;display&quot;: &quot;PLAC&quot;\n                                }\n                            ]\n                        },\n                        &quot;system&quot;: &quot;PLAC&quot;,\n                        &quot;value&quot;: &quot;H1&quot;\n                    },\n                    {\n                        &quot;type&quot;: {\n                            &quot;coding&quot;: [\n                                {\n                                    &quot;system&quot;: &quot;http://hl7.org/fhir/identifier-type&quot;,\n                                    &quot;code&quot;: &quot;FILL&quot;,\n                                    &quot;display&quot;: &quot;FILL&quot;\n                                }\n                            ]\n                        },\n                        &quot;system&quot;: &quot;FILL&quot;,\n                        &quot;value&quot;: &quot;I1&quot;\n                    }\n                ],\n                &quot;status&quot;: &quot;final&quot;,\n                &quot;code&quot;: {\n                    &quot;coding&quot;: [\n                        {\n                            &quot;system&quot;: &quot;99QDI&quot;,\n                            &quot;code&quot;: &quot;36126&quot;,\n                            &quot;display&quot;: &quot;RPR(DX) REFL CONFIRM&quot;\n                        }\n                    ]\n                },\n                &quot;subject&quot;: {\n                    &quot;reference&quot;: &quot;https://localhost:10022/Patient/F1&quot;\n                },\n                &quot;context&quot;: {\n                    &quot;reference&quot;: &quot;https://localhost:10022/Encounter/G1&quot;\n                },\n                &quot;effectiveDateTime&quot;: &quot;2018-05-11T21:48:00+00:00&quot;,\n                &quot;issued&quot;: &quot;2020-08-31T16:50:00.000+00:00&quot;,\n                &quot;specimen&quot;: [\n                    {\n                        &quot;reference&quot;: &quot;https://localhost:10022/Specimen/LAB-I1&quot;\n                    }\n                ],\n                &quot;result&quot;: [\n                    {\n                        &quot;reference&quot;: &quot;https://localhost:10022/Observation/F1-G1-H1-LabOrder-Gonorrhea&quot;\n                    },\n                    {\n                        &quot;reference&quot;: &quot;https://localhost:10022/Observation/F1-G1-H1-LabOrder-Syphilis&quot;\n                    }\n                ],\n                &quot;conclusion&quot;: &quot;SELF&quot;,\n                &quot;meta&quot;: {\n                    &quot;versionId&quot;: &quot;8237b989-a49c-4fb5-b290-1259d3f087f0&quot;,\n                    &quot;lastUpdated&quot;: &quot;2020-09-02T18:00:27.134+00:00&quot;\n                }\n            }\n        },\n        {\n            &quot;fullUrl&quot;: &quot;https://localhost:10022/OperationOutcome/8aa5996f-cc57-4e21-963b-45720c76483c&quot;,\n            &quot;search&quot;: {\n                &quot;mode&quot;: &quot;outcome&quot;\n            },\n            &quot;resource&quot;: {\n                &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n                &quot;id&quot;: &quot;8aa5996f-cc57-4e21-963b-45720c76483c&quot;,\n                &quot;meta&quot;: {\n                    &quot;versionId&quot;: &quot;ae6ae6a4-e891-4dfe-9bc5-8a955809aecd&quot;,\n                    &quot;lastUpdated&quot;: &quot;2020-09-02T19:30:48.312+00:00&quot;\n                },\n                &quot;issue&quot;: [\n                    {\n                        &quot;severity&quot;: &quot;error&quot;,\n                        &quot;code&quot;: &quot;exception&quot;,\n                        &quot;details&quot;: {\n                            &quot;coding&quot;: [\n                                {\n                                    &quot;system&quot;: &quot;http://hl7.org/fhir/dotnet-api-operation-outcome&quot;,\n                                    &quot;code&quot;: &quot;5006&quot;\n                                }\n                            ],\n                            &quot;text&quot;: &quot;Parameter patient could target one of the resourcetypes &#39;Patient, Group&#39;. Please specify one of those types using the :type modifier.&quot;\n                        }\n                    },\n                    {\n                        &quot;severity&quot;: &quot;warning&quot;,\n                        &quot;code&quot;: &quot;not-supported&quot;,\n                        &quot;details&quot;: {\n                            &quot;coding&quot;: [\n                                {\n                                    &quot;system&quot;: &quot;http://hl7.org/fhir/dotnet-api-operation-outcome&quot;,\n                                    &quot;code&quot;: &quot;5003&quot;\n                                }\n                            ],\n                            &quot;text&quot;: &quot;Parameter If-Modified-Since is not implemented&quot;\n                        }\n                    },\n                    {\n                        &quot;severity&quot;: &quot;warning&quot;,\n                        &quot;code&quot;: &quot;not-supported&quot;,\n                        &quot;details&quot;: {\n                            &quot;coding&quot;: [\n                                {\n                                    &quot;system&quot;: &quot;http://hl7.org/fhir/dotnet-api-operation-outcome&quot;,\n                                    &quot;code&quot;: &quot;5003&quot;\n                                }\n                            ],\n                            &quot;text&quot;: &quot;Parameter If-None-Match is not implemented&quot;\n                        }\n                    }\n                ]\n            }\n        }\n    ],\n    &quot;total&quot;: 5836,\n    &quot;link&quot;: [\n        {\n            &quot;relation&quot;: &quot;self&quot;,\n            &quot;url&quot;: &quot;https://localhost:10022/DiagnosticReport?_format=json&amp;_sort=-_lastUpdated&amp;_count=10&amp;_skip=0&quot;\n        },\n        {\n            &quot;relation&quot;: &quot;next&quot;,\n            &quot;url&quot;: &quot;https://localhost:10022/DiagnosticReport?_format=json&amp;_sort=-_lastUpdated&amp;_count=10&amp;_skip=10&quot;\n        },\n        {\n            &quot;relation&quot;: &quot;last&quot;,\n            &quot;url&quot;: &quot;https://localhost:10022/DiagnosticReport?_format=json&amp;_sort=-_lastUpdated&amp;_count=10&amp;_skip=5830&quot;\n        }\n    ],\n    &quot;id&quot;: &quot;574fb9b4-a4bd-4044-9698-e09231777cb7&quot;,\n    &quot;meta&quot;: {\n        &quot;versionId&quot;: &quot;c48f0125-ef9d-4a45-8658-2b05d2b808f3&quot;,\n        &quot;lastUpdated&quot;: &quot;2020-09-02T19:30:48.291+00:00&quot;\n    }\n}\n</code></pre></div>",
        "id": 208890886,
        "sender_full_name": "Santosh Jami",
        "timestamp": 1599082507
    },
    {
        "content": "<blockquote>\n<p>In such cases, the search process MAY include an OperationOutcome in the search set that contains additional hints and warnings about the search process. This is included in the search results as an entry with search mode = outcome</p>\n</blockquote>\n<p>if looking for Bundle.entry.search.mode = outcome is easier you have that..</p>\n<p>the other thing you can do is check the link.url if it doesn't have a search parameter you sent that means that the parameter was ignored. couldn't find the specific text on that one but I'm pretty sure its true..</p>",
        "id": 208898764,
        "sender_full_name": "ryan moehrke",
        "timestamp": 1599087263
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"237342\">@ryan moehrke</span> .<br>\nAdding the fix to look for search params returned in \"self-link\", and also a condition for Bundle.entry.search.mode = outcome</p>",
        "id": 209099516,
        "sender_full_name": "Santosh Jami",
        "timestamp": 1599229567
    }
]