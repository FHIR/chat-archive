[
    {
        "content": "<p>Hi,</p>\n<p>Looking for some help with FHIR validator. Any help is appreciated.</p>\n<p>I am getting below error when validating resources with FHIR validator.  My top/parent resource have contained resource which in turn has a local reference.</p>\n<p><strong>Error</strong><br>\nref-1: SHALL have a contained resource if a local reference is provided ( (url: prac1234; ids: )) [reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))]</p>\n<p><strong>Example:</strong><br>\n{<br>\nresourceType:”ExplanationOfBenefit”,<br>\ncontained:[<br>\n{<br>\nresourceType:”Practitioner”,<br>\nid:”prac1234”<br>\n},<br>\n{<br>\nresourceType:”PractitionerRole”,<br>\npractitioner:”#prac1234”<br>\n}<br>\n]<br>\n}</p>\n<p>Thanks<br>\nRavi</p>",
        "id": 200176759,
        "sender_full_name": "Ravindra Kondiparthi",
        "timestamp": 1591669489
    },
    {
        "content": "<p>Most likely a bug in the validator, it came up recently: <a href=\"#narrow/stream/179166-implementers/topic/References.20between.20contained.20resources\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/References.20between.20contained.20resources</a></p>",
        "id": 200178021,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1591671564
    },
    {
        "content": "<p>thanks <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span></p>",
        "id": 200181221,
        "sender_full_name": "Ravindra Kondiparthi",
        "timestamp": 1591676663
    },
    {
        "content": "<p>...having said that the double-contained resource would make life hard for clients (our will choke on it I am pretty sure)</p>",
        "id": 200223592,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1591707906
    },
    {
        "content": "<p>They are not double-contained, are they? They are siblings. Or did you mean the intra-contained reference?</p>",
        "id": 200227722,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1591709769
    },
    {
        "content": "<p>I mean that example above - with one contained referencing its sibling contained. Most clients would look in the wrong place to resolve that reference (as the validator is doing)</p>",
        "id": 200231538,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1591711237
    },
    {
        "content": "<p>What you're doing is legal according to the spirit of the spec, but illegal according to how we've written an invariant in R4 unfortunately.  We're going to try to fix that for R5.</p>",
        "id": 200233926,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1591712136
    }
]