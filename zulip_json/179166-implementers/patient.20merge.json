[
    {
        "content": "<p>anyone have examples of implementation for merging Patients and then using the Merged Patient.  In our case, we can have the same Patient enrolled under different IDs in the same organization, which need to be merged together once this duplicate patient has been identified.  I see FHIR provides the option to use .Link but I am not sure how people are using that in real implementations.  Or perhaps, there is just a copy of data from one patient record to the other, rather than just linking.</p>",
        "id": 153953651,
        "sender_full_name": "Radu Craioveanu",
        "timestamp": 1524500870
    },
    {
        "content": "<p>I'm very interested in this topic too. This is really tricky problem. We just think how to approach it. From one side - linking is good, but then you have to get all patient data by set of ids. If you copy from one patient to another - then potential <code>unmerge</code> will be nightmare.</p>",
        "id": 153953660,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1524506004
    },
    {
        "content": "<p>Are you asking about actually performing the merge/unmerge using FHIR?  Or just representing the outcome of the merge using FHIR?  The FHIR spec currently doesn't support doing a merge (or unmerge).  Patient.link is only really the expression of a merge done via non-FHIR means.  Selecting surviving vs. non-surviving demographics, identifiers, etc. can't really be done without an event/operation.</p>\n<p>Our implementation represents two merged patients in FHIR by just returning an HTTP 301 sending you to the target patient if you try to access the source patient.  Our resources that point to patient will all contain references to the target patient, but if any systems have old versions of resources with references to the source patient, that's fine, as they'll just get the 301 once they try to do reference resolution.</p>",
        "id": 153953704,
        "sender_full_name": "Cooper Thompson",
        "timestamp": 1524513602
    },
    {
        "content": "<p>we've never run this into the ground. There's a choice of ways to implement it, which more or less match the choices in v2. I'd like to have a connectathon stream on this, but we've never got enough energy for that</p>",
        "id": 153953706,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1524514108
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191764\">@Cooper Thompson</span> in your case, how are clients instructing the API to perform the merge/unmerge that generates the redirect? Or, is the merge request handled out-of-band and presented to clients as a 301?</p>",
        "id": 153953809,
        "sender_full_name": "Kurt Ericson",
        "timestamp": 1524543122
    },
    {
        "content": "<p>We are almost always going to be the EMPI for an organization, so we do not accept merge requests from API clients.  In the case where there is a 3rd party EMPI, we can accept merge messages via HL7v2.    We have not had a reason to implement a FHIR merge API with another EMPI, since HL7v2 serves perfectly well for that function.  </p>\n<p>Academically, it might be interesting to talk about merges originating from FHIR (non-EMPI) clients, but operational HIM departments are unlikely to be on board with merges  coming from anything but the EMPI.</p>",
        "id": 153953886,
        "sender_full_name": "Cooper Thompson",
        "timestamp": 1524571182
    },
    {
        "content": "<blockquote>\n<p>I'm very interested in this topic too. This is really tricky problem. We just think how to approach it. From one side - linking is good, but then you have to get all patient data by set of ids. If you copy from one patient to another - then potential <code>unmerge</code> will be nightmare.</p>\n</blockquote>\n<p>Hm... you could create a Provenance Resource pointing to all the Resources you copied from one Patient to the other, to make it traceable/reversable. Though I agree that it's a nightmare considering that in some scenarios, this could be hundreds of Resources...</p>",
        "id": 153953913,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1524584442
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191764\">@Cooper Thompson</span> that's a short term view; one could well imagine HIM departments wanting their own 3rd party mergers. Clearly not where you are now, of course.</p>",
        "id": 153954187,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1524606516
    },
    {
        "content": "<p>alternatively, it would be very useful to be able to submit merge proposals from a client</p>",
        "id": 153954189,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1524606543
    },
    {
        "content": "<p>Hey all, The Patient Administration workgroup has on its worklist this year to investigate patient merge functionality and what that means in FHIR.<br>\nThere is a project page setup for the discussion in confluence and we'd like to get the ball rolling.<br>\n<a href=\"https://confluence.hl7.org/display/PA/Patient+Merge+and+Link\" target=\"_blank\" title=\"https://confluence.hl7.org/display/PA/Patient+Merge+and+Link\">https://confluence.hl7.org/display/PA/Patient+Merge+and+Link</a><br>\nWhile we are at it, this is a call for interest in participating in a potential experimental track at the May WGM in Montreal on the topic.<br>\nClick a reaction on this post if you would come and participate.<br>\n(and yes I did just like my own post, to say that I'll participate too)</p>",
        "id": 160258709,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1552013381
    },
    {
        "content": "<p>The agreed first stage of this project was to:</p>\n<ul>\n<li>document existing behaviors of existing products </li>\n<li>how this is exposed in the data</li>\n<li>what are the expectations of client applications <br>\nSo if you have any feedback that you'd like to contribute to any of these 3 topics, please let us know!</li>\n</ul>",
        "id": 160258925,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1552013749
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span>, IHE is working on a profile this year around some of those issues. The next IHE face-to-face meeting is in Chicago immediately before the Montreal WGM. It would be great if we can converge two efforts. <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span>, <span class=\"user-mention\" data-user-id=\"193299\">@Luke Duncan</span>, <span class=\"user-mention\" data-user-id=\"193307\">@Derek Ritz</span>.</p>",
        "id": 160259575,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1552014680
    },
    {
        "content": "<p>Or at least feed the findings for sure! and expand on them... I'm not going to be able to attend the IHE meeting for pretty obvious reasons... <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 160259661,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1552014808
    },
    {
        "content": "<p>Will this include expected behavior of systems when querying patient data post-merge?  And will it deal with the notion of \"un-merge\"?</p>",
        "id": 160260528,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1552015858
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>    Hopefully <strong>yes</strong> to the former and <strong>likely not</strong> to the latter (or not in this cycle, anyway).</p>",
        "id": 160260867,
        "sender_full_name": "Derek Ritz",
        "timestamp": 1552016328
    },
    {
        "content": "<p>Very much agree it will be helpful to collaborate. <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span>  Can we draw Daniel B into this conversation?</p>",
        "id": 160261403,
        "sender_full_name": "Derek Ritz",
        "timestamp": 1552017063
    },
    {
        "content": "<p>Sure, send him an email asking him to sign up to <a href=\"http://chat.fhir.org\" target=\"_blank\" title=\"http://chat.fhir.org\">chat.fhir.org</a>. And remind him that the HL7 WGM will be in his home town.</p>",
        "id": 160261536,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1552017272
    },
    {
        "content": "<blockquote>\n<p>Will this include expected behavior of systems when querying patient data post-merge?  And will it deal with the notion of \"un-merge\"?</p>\n</blockquote>\n<p>This is one critical requirement of the IHE work item. Where we can, we will be defining an actor grouping behavior: Given a data server actor is grouped with a merge notification recipient, when it receives a merge notification from the authority, then it will give post-merge results to future requests for data, so that a client of the data server always gets accurate data query results.</p>",
        "id": 160286774,
        "sender_full_name": "John Moehrke",
        "timestamp": 1552050120
    },
    {
        "content": "<p>Redox is attending in Montreal and we have implemented a FHIR patient merge using a message bundle with code <code>patient-link</code> and two patient resources, as well as handling the ramifications of that merge in our server. Would love to share our experiences before, during, and/or after the Connectathon! We're also participating in v2-to-FHIR mapping which might be somewhat related, at least in comparing a v2 patient merge with a FHIR message bundle.</p>",
        "id": 160325926,
        "sender_full_name": "Benjamin Flessner",
        "timestamp": 1552079421
    },
    {
        "content": "<p>I don't know if I have time to be part of this connectathon track in Montreal, but I'm presenting on this subject at DevDays and will be leaning heavily on the track for my content</p>",
        "id": 160640320,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1552460357
    },
    {
        "content": "<p>So our system as an MPI, linking together patient records that are recognized to be the same person - this creates some questions on how best to render these linked patients in FHIR<br>\nOne option is to render each of them separately, and adding the links in the link element - but this makes getting all the clinical data for that patient somewhat difficult<br>\nThe other option is to merge them all together into a single FHIR resource - in this case though<br>\n1) It might be useful to know that different elements came from different liked patients (corresponding to different data sources)<br>\n2) What to do with conflicting data - like different birth dates?<br>\nWhat we tentatively come up with are some extensions, so if a merged patient has two different names coming from different sources we tag them:</p>\n<div class=\"codehilite\"><pre><span></span> &quot;name&quot;: [\n            {\n                &quot;extension&quot;: [\n                    {\n                        &quot;extension&quot;: [\n                            {\n                                &quot;url&quot;: &quot;source&quot;,\n                                &quot;valueString&quot;: &quot;RK.CareEvolution.Demo&quot;\n                            },\n                            {\n                                &quot;url&quot;: &quot;source&quot;,\n                                &quot;valueString&quot;: &quot;PACode&quot;\n                            }\n                        ],\n                        &quot;url&quot;: &quot;http://careevolution.com/fhirextensions#patient-sources&quot;\n                    }\n                ],\n                &quot;use&quot;: &quot;official&quot;,\n                &quot;family&quot;: [\n                    &quot;Demoski&quot;\n                ],\n                &quot;given&quot;: [\n                    &quot;Stan&quot;\n                ]\n            },\n            {\n                &quot;extension&quot;: [\n                    {\n                        &quot;extension&quot;: [\n                            {\n                                &quot;url&quot;: &quot;source&quot;,\n                                &quot;valueString&quot;: &quot;FHIR&quot;\n                            }\n                        ],\n                        &quot;url&quot;: &quot;http://careevolution.com/fhirextensions#patient-sources&quot;\n                    }\n                ],\n                &quot;use&quot;: &quot;official&quot;,\n                &quot;family&quot;: [\n                    &quot;Graziani&quot;\n                ],\n                &quot;given&quot;: [\n                    &quot;Tizio&quot;\n                ]\n            }\n        ],\n</pre></div>\n\n\n<p>(Stan Demoski comes from <code>RK.CareEvolution.Demo</code> and <code>PACode</code>, Tizio Graziani comes from <code>FHIR</code>)<br>\nFor conflicting data we do generate any values but we put all original values (and their sources) in extensions:</p>\n<div class=\"codehilite\"><pre><span></span>        &quot;_birthDate&quot;: {\n            &quot;extension&quot;: [\n                {\n                    &quot;extension&quot;: [\n                        {\n                            &quot;extension&quot;: [\n                                {\n                                    &quot;url&quot;: &quot;value&quot;,\n                                    &quot;valueDate&quot;: &quot;2011-03-28&quot;\n                                }\n                            ],\n                            &quot;url&quot;: &quot;source&quot;,\n                            &quot;valueString&quot;: &quot;RK.CareEvolution.Demo&quot;\n                        },\n                        {\n                            &quot;extension&quot;: [\n                                {\n                                    &quot;url&quot;: &quot;value&quot;,\n                                    &quot;valueDate&quot;: &quot;2011-03-28&quot;\n                                }\n                            ],\n                            &quot;url&quot;: &quot;source&quot;,\n                            &quot;valueString&quot;: &quot;PACode&quot;\n                        },\n                        {\n                            &quot;extension&quot;: [\n                                {\n                                    &quot;url&quot;: &quot;value&quot;,\n                                    &quot;valueDate&quot;: &quot;1958-03-28&quot;\n                                }\n                            ],\n                            &quot;url&quot;: &quot;source&quot;,\n                            &quot;valueString&quot;: &quot;FHIR&quot;\n                        }\n                    ],\n                    &quot;url&quot;: &quot;http://careevolution.com/fhirextensions#patient-sources&quot;\n                }\n            ]\n        },\n  ```\nDo anyone else have the same issue? How was it solved?\nIs it worthwhile to standardize this (or a similar) extension system? Or maybe there is already something along those lines?\n</pre></div>",
        "id": 164452546,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556544986
    },
    {
        "content": "<p>Looks like you need to tag all the elements in Patient if values coming from different source: address, gender, contacts, ....<br>\nThen the combined Patient json is hard to read.</p>",
        "id": 164462492,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1556552291
    },
    {
        "content": "<p>Yes,we are tagging everything - tagging element with the source is a 'nice to have' though, not strictly needed. What is (probably) needed is to be able to put the original values in the output when they conflict and the element supports only a single value - like in the case of different birthdates</p>",
        "id": 164462734,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556552513
    },
    {
        "content": "<p>A client of the MPI is probably best served by having access to one single consolidated record. A client is unlikely to look or understand these extensions. If you wish to keep track (internally within the MPI) where some bits of data cam from, that'd be Provenance. If the MPI can't be sure as to what the birth date is, then the consolidated Patient resource should indicate there is uncertainty, not list multiple dates. (Just adding the client perspective, these extensions are a bit too focused on the MPI side).</p>",
        "id": 164511349,
        "sender_full_name": "René Spronk",
        "timestamp": 1556600194
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span> </p>\n<blockquote>\n<p>If you wish to keep track (internally within the MPI) where some bits of data cam from, that'd be Provenance.</p>\n</blockquote>\n<p>I can see how I could add multiple Provenance resources pointing to the merged Patient to describe where the data came from, but it does not seem possible to indicate which piece of data come from which Provenance ... am I wrong?</p>\n<blockquote>\n<p>then the consolidated Patient resource should indicate there is uncertainty</p>\n</blockquote>\n<p>How would you do that?</p>",
        "id": 164536744,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556629449
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> the Provenance resource should be indicating how to point to individual data elements within FHIR.</p>\n<p>To flag something as uncertain you can put an extension on the relevant element.   (e.g. within the 'birthDate' element if birthDate is uncertain).</p>",
        "id": 164543681,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1556634709
    },
    {
        "content": "<blockquote>\n<p>To flag something as uncertain you can put an extension on the relevant element</p>\n</blockquote>\n<p>OK - that's what we do now, with a custom extension that actually contains all the original values (ad abundantiam). Is there a 'more standard' way?</p>",
        "id": 164544889,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556635537
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191404\">John Moehrke</span> the Provenance resource should be indicating how to point to individual data elements within FHIR.</p>\n<p>To flag something as uncertain you can put an extension on the relevant element.   (e.g. within the 'birthDate' element if birthDate is uncertain).</p>\n</blockquote>\n<p>There is a CR asking for Provenance to express how to point at specific  data elements. I have passed this to FHIR-I for their guidance on 'how'.</p>",
        "id": 164545770,
        "sender_full_name": "John Moehrke",
        "timestamp": 1556636151
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> Can you link to the tracker?</p>",
        "id": 164548189,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1556637806
    },
    {
        "content": "<p><a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20583\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20583\">GF#20583</a></p>",
        "id": 164552975,
        "sender_full_name": "John Moehrke",
        "timestamp": 1556641657
    },
    {
        "content": "<p>Thanks! (for easier navigation: the tracker references back to <a href=\"#narrow/stream/179166-implementers/topic/Source.20of.20information\" title=\"#narrow/stream/179166-implementers/topic/Source.20of.20information\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Source.20of.20information</a>)</p>",
        "id": 164553419,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556641962
    },
    {
        "content": "<p>Hi, I've read through this thread, through the thread linked above and through this <a href=\"https://stackoverflow.com/questions/33450951/fhir-merge-patients\">https://stackoverflow.com/questions/33450951/fhir-merge-patients</a> . <br>\nOur client wants us to document the ADT/ACK - Merge Patient - Patient Identifier List (Event A40). We can chose how to do this. </p>\n<p>What is the best practice? - is this a concern of the audit event, provenance or  patient resource?</p>\n<p>I'm also looking at this document: <a href=\"https://confluence.hl7.org/display/PA/Merge+Operation\">https://confluence.hl7.org/display/PA/Merge+Operation</a></p>\n<ul>\n<li>\"Question: Provenance/AuditEvent actions - any security issues here?\"</li>\n<li>\"Answer: After some discussion, the Provenance is the preferred resource to track this content, as will likely remain with the clinical data retention, AuditEvents may be cleansed periodically. AuditEvents are not always available/exposed to all users.\"</li>\n</ul>\n<p>Can I consider this as official guidance?</p>\n<p><span class=\"user-mention\" data-user-id=\"193430\">@Alexander Zautke</span> for your info so we don't double post</p>",
        "id": 205467602,
        "sender_full_name": "Gustav Vella",
        "timestamp": 1596109142
    },
    {
        "content": "<p>I am not sure if your whole question is the one on the distinction between Provenance and AuditEvent... but if that is it, then I would answer that is the supported by the definitions in the FHIR core specification for those two resources, and covered on the FHIR core specification security and privacy pages <a href=\"http://build.fhir.org/secpriv-module.html\">http://build.fhir.org/secpriv-module.html</a></p>",
        "id": 205470662,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596111487
    },
    {
        "content": "<p>That said... those are statements of intended use, and expected use under expected policy. FHIR does not declare any restrictions to ANY policy or use-case. We simply design to a set of expected use-cases. So you can certainly use FHIR in ways not consistent with intended use or expected policies.</p>",
        "id": 205470803,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596111599
    },
    {
        "content": "<p>I don't think there is any best practice for documenting patient merges yet. Personally, I think the Provenance resource is best suited for this but one could also imagine a solution utilizing Messaging. I would advice against using AuditEvents as these are not always supposed to be available to normal users whereas the Provenance resource is.</p>",
        "id": 205475185,
        "sender_full_name": "Yannick Börner",
        "timestamp": 1596114170
    },
    {
        "content": "<p>The changes one makes to a Patient (s) resource is a different topic than where to record why it was done (Provenance). There is an Implementation Guide from IHE that focuses on a Golden Patient domain. In this domain, which is a cooperative of many, there are one or more agents looking to detect failures that produced two Patient resources for the same single patient, and Merging. The changes done to the two Patient resources are defined. In that model only the deprecated Patient resource is changed. It is updated to point at the surviving Patient by way of its Patient.link with replaced-by; and it is marked as inactive in its Patient.active element. This following the guidance on the FHIR core Patient <a href=\"http://build.fhir.org/patient.html#dup-records\">http://build.fhir.org/patient.html#dup-records</a>.<br>\nAND all participants in the cooperative are informed of this merge with the expectation that THEY update their data, changing any data that references the deprecated Patient gets updated to point at the surviving Patient.<br>\nThus it is not just the Patient resource that is engaged, but also all the data holders under the influence of that Patient identity domain (golden).<br>\nsee <a href=\"https://wiki.ihe.net/index.php/Patient_Master_Identity_Registry_(PMIR)\">https://wiki.ihe.net/index.php/Patient_Master_Identity_Registry_(PMIR)</a></p>",
        "id": 205476639,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596114914
    },
    {
        "content": "<p>There are other models that would update both the deprecated and the surviving Patient to cross-link them; but this overhead didn't solve any problem, and it presented some synchronization issues.  (Note one can always do a lookup given the Patient resource they have for any other Patients that have a link to it. This would find you all deprecated and thus merged former Patients)</p>",
        "id": 205476881,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596115033
    }
]