[
    {
        "content": "<p>Why don't we publish (at least core IGs) into global npm registry?</p>",
        "id": 250353763,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629726494
    },
    {
        "content": "<p>This is inconvenient and looks like security problem <a href=\"/user_uploads/10155/813cq4dTbVPVPl7d1ymUinko/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/813cq4dTbVPVPl7d1ymUinko/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/813cq4dTbVPVPl7d1ymUinko/image.png\"></a></div>",
        "id": 250354816,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629726971
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span></p>",
        "id": 250357220,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629727998
    },
    {
        "content": "<blockquote>\n<p>no security advisories found for hl7.fhir.us.core</p>\n</blockquote>\n<p>where are you looking?</p>",
        "id": 250397022,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629745553
    },
    {
        "content": "<p>it's pretty bizarre since the actual package contains <em>no</em> code</p>",
        "id": 250397746,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629745839
    },
    {
        "content": "<p><a href=\"https://www.npmjs.com/\">https://www.npmjs.com/</a></p>",
        "id": 250401096,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629747556
    },
    {
        "content": "<p>direct link: <a href=\"https://www.npmjs.com/package/hl7.fhir.us.core\">https://www.npmjs.com/package/hl7.fhir.us.core</a></p>",
        "id": 250401335,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629747682
    },
    {
        "content": "<p>interesting, i've never seen this before. the security message replaces the orig link to the repo. anyone got it?</p>",
        "id": 250401721,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629747861
    },
    {
        "content": "<p>I don't really know <a href=\"http://npmjs.com\">npmjs.com</a>... surely there's a way to find out who published a package? Because I can't see here, it's almost like the security notification was created from scratch</p>",
        "id": 250402071,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629748057
    },
    {
        "content": "<p>npmjs is central npm packages repository</p>",
        "id": 250403338,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629748698
    },
    {
        "content": "<p>if you run <code>npm install</code> it will search the package in <a href=\"http://npmjs.com\">npmjs.com</a></p>",
        "id": 250403410,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629748730
    },
    {
        "content": "<p>right. that much I did know. But how do you find out who published a package?</p>",
        "id": 250404039,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629748994
    },
    {
        "content": "<p>And why would that package be called a security risk when it only contains json?</p>",
        "id": 250404080,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629749016
    },
    {
        "content": "<p>normally, packages are associated with a repo and a list of collaborators, e.g. <a href=\"https://www.npmjs.com/package/@shexjs/shape-path-query\">https://www.npmjs.com/package/@shexjs/shape-path-query</a></p>",
        "id": 250404326,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749150
    },
    {
        "content": "<p>the prob is that we don't have access to that 'cause someone at npm, probably acting in good faith, replaced the entry in the db with the entry for security-holder</p>",
        "id": 250404474,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749211
    },
    {
        "content": "<p>can we ask? I'm at a loss where to go from here...</p>",
        "id": 250404530,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629749245
    },
    {
        "content": "<p>kinda makes sense to do that with dire security threats but it leaves us without a lot of threads to pull on for debugging</p>",
        "id": 250404540,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749250
    },
    {
        "content": "<p>i'm pestering some folks</p>",
        "id": 250404559,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749266
    },
    {
        "content": "<p>(but no one with any connections. hopefully, that will come)</p>",
        "id": 250404601,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749282
    },
    {
        "content": "<p>I don't know how you find out who originally published it (prior to npm's security placeholder), but we shouldn't assume it only contained JSON.  If it was truly a nefarious actor, then they likely <em>did</em> upload it with nefarious (non-JSON) code, squatting on the name and hoping to take some of us unaware.</p>",
        "id": 250404639,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1629749288
    },
    {
        "content": "<p>well, that's possible, I guess</p>",
        "id": 250404684,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629749312
    },
    {
        "content": "<p>so we have no idea of what should be there?</p>",
        "id": 250404705,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749330
    },
    {
        "content": "<p><a href=\"https://simplifier.net/packages/hl7.fhir.us.core/4.0.0\">https://simplifier.net/packages/hl7.fhir.us.core/4.0.0</a></p>",
        "id": 250404760,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629749379
    },
    {
        "content": "<p><code>npm --registry https://packages.simplifier.net install hl7.fhir.us.core@4.0.0</code> suggests to me that it was never published on npm</p>",
        "id": 250404878,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749449
    },
    {
        "content": "<p>probably some dickwad has a script that googles for <code>--registry</code> and tries to impersonate the mentioned package name at <a href=\"http://npmjs.com\">npmjs.com</a></p>",
        "id": 250404956,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749516
    },
    {
        "content": "<p>i'm filing an issue at <a href=\"https://www.npmjs.com/support\">https://www.npmjs.com/support</a> presuming my theory above</p>",
        "id": 250405166,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749625
    },
    {
        "content": "<p>hmm ok. but there's only two packages I can see. hl7.fhir, which is a non-package, and hl7.fhir.us.core. But there's 100s of others...</p>",
        "id": 250405309,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629749697
    },
    {
        "content": "<p>indicating that the squatting isn't well-automated?</p>",
        "id": 250405399,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749748
    },
    {
        "content": "<p>(maybe we can sell them some software that improves their squatting efficacy)</p>",
        "id": 250405485,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629749775
    },
    {
        "content": "<p>I was able to find a little bit more info by using the <code>npm view hl7.fhir.us.core time</code> command.  It provided the following:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &#39;3.1.1&#39;: &#39;2021-02-20T08:10:30.793Z&#39;,\n  created: &#39;2021-02-21T15:12:37.873Z&#39;,\n  &#39;0.0.1-security&#39;: &#39;2021-02-21T15:12:37.998Z&#39;,\n  modified: &#39;2021-02-21T15:12:40.556Z&#39;\n}\n</code></pre></div>\n<p>So we know that version that was declared when it was initially uploaded was v3.1.1.  It was uploaded Feb 20 and GitHub took it down Feb 21.  I tried to find out contributor info for the 3.1.1 version, but GH wasn't coming back w/ any of that.</p>\n<p>It also could have been totally unintentional.  We really don't know.  It's pretty easy via the npm commandline to publish any arbitrary package if it's a unique name.  All it would have taken is for someone to be in the US Core source code repo (with its local <code>package.json</code>) and type <code>npm publish</code> (if they're logged into npm).  That said, I'm not sure that the real US Core source would have been flagged as a threat...</p>",
        "id": 250406122,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1629750103
    },
    {
        "content": "<p>yeah, seems a bit weird, but it's possible i was too quick to assume malfeasance in the issue i filed:</p>\n<blockquote>\n<p><a href=\"https://simplifier.net/packages/hl7.fhir.us.core/4.0.0\">https://simplifier.net/packages/hl7.fhir.us.core/4.0.0</a> has instructions for installing <code>hl7.fhir.us.core</code>, which is published on a fhir-specific registry:</p>\n<blockquote>\n<p>npm --registry <a href=\"https://packages.simplifier.net\">https://packages.simplifier.net</a> install <a href=\"mailto:hl7.fhir.us.core@4.0.0\">hl7.fhir.us.core@4.0.0</a></p>\n</blockquote>\n<p>There's an NPM package by the same name which has been replaced with <code>npm/security-holder</code>, presumably because of some malicious content. Would it be possible to give the controlling account to myself of <a href=\"mailto:grahame@hl7.org\">grahame@hl7.org</a> so we can either replace it with the proper package or with a pointer to <a href=\"http://simplifier.net\">simplifier.net</a> ?</p>\n</blockquote>",
        "id": 250406505,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629750297
    },
    {
        "content": "<p>if they give it to me, i'll briefly go mad with power, then try to figure out to whom to give the keys</p>",
        "id": 250406610,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629750352
    },
    {
        "content": "<p>Also, we can see, <a href=\"https://npm-stat.com/charts.html?package=hl7.fhir.us.core\">via npm-stats</a>, that people <em>have</em> attempted to download US Core from the npm registry.  Not that many people, but _some_.</p>",
        "id": 250406718,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1629750401
    },
    {
        "content": "<p>the full us core would sure be flagged as a security issue because it would include batch files etc</p>",
        "id": 250407253,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629750628
    },
    {
        "content": "<p>most npm packages have executable (albeit js) scripts</p>",
        "id": 250407328,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629750670
    },
    {
        "content": "<p>hard to see how to stick out in that field</p>",
        "id": 250407371,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1629750695
    },
    {
        "content": "<p>I think, we should publish our packages to <a href=\"http://npmjs.com\">npmjs.com</a>  and solve name clashes one by one.  Probably, we can contact npm guys and reserve some prefix somehow for hl7</p>",
        "id": 250409904,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629751961
    },
    {
        "content": "<p>Some of the scripts (e.g., the ones that update the scripts) download from a repo and run that code immediately.  That one gets flagged on my desktop too.</p>",
        "id": 250515958,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1629824816
    },
    {
        "content": "<p>Also, it would be nice to establish a convention for signifying the specification package vs. one containing some sort of language tools (e.g., if you wanted to create a package for JS or TS based on US Core, what should that package name look like).  I would prefer if the convention works across tools so that we can cross publish (e.g., if we add packages to NuGet and want packages built on the Firely libraries there).</p>",
        "id": 250516299,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1629824961
    },
    {
        "content": "<p>well, from my pov, that won't start with hl7. since it wouldn't be hl7 publishing it</p>",
        "id": 250524457,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629828535
    },
    {
        "content": "<p><span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span> that works  =).</p>",
        "id": 250528872,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1629830465
    },
    {
        "content": "<p>If we ever want to officially publish HL7 packages to (non-HL7-managed) global registries, we'd want to do one or both of:</p>\n<ol>\n<li>Use scoped package names for global registries that support this (e.g., <code>@hl7/fhir.us.core</code> for npm to prevent squatters from asserting control of official HL7 package names)</li>\n<li>Use signed packages for global registries that support this (npm doesn't, or rather <em>the public registry signs</em> packages, rather than authors signing them)</li>\n</ol>",
        "id": 250653509,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1629913095
    },
    {
        "content": "<p>Scoped packages looks a good option</p>",
        "id": 250663989,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629917574
    },
    {
        "content": "<p>how does that prevent squatters from asserting control?</p>",
        "id": 250709371,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629943276
    },
    {
        "content": "<p>I believe for scoped npm - you will  own the scope - <a href=\"https://docs.npmjs.com/about-scopes\">https://docs.npmjs.com/about-scopes</a></p>",
        "id": 250739582,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1629966497
    },
    {
        "content": "<p>i think that will break all the dependencies</p>",
        "id": 250765129,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629981791
    },
    {
        "content": "<p>We do not have to rename and break  them - just keep both - scoped on npm official registry + scoped and old on simplifier<br>\nNew igs will use scoped packages - old will eventually migrate</p>",
        "id": 250856059,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1630020025
    },
    {
        "content": "<p>btw simplifier registry does not resolve deps properly :(  - <a href=\"#narrow/stream/179166-implementers/topic/npm.20from.20simpifier.20and.20deps\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/npm.20from.20simpifier.20and.20deps</a></p>",
        "id": 250856255,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1630020188
    },
    {
        "content": "<p>so a follow up to this: I have to use github's trademark policy violation process to recover control over hl7 and fhir organizations. It will take some time... (I can't find out who owns them any other way)</p>",
        "id": 253570837,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631794246
    },
    {
        "content": "<p>let me know what I need to know to help IHE</p>",
        "id": 253571904,
        "sender_full_name": "John Moehrke",
        "timestamp": 1631794821
    }
]