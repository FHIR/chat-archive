[
    {
        "content": "<p>I've been learning about transactions and references to locally identified resources.</p>\n<p>I noticed that the Health Intersections open server (<a href=\"http://fhir3.healthintersections.com.au/open\" target=\"_blank\" title=\"http://fhir3.healthintersections.com.au/open\">http://fhir3.healthintersections.com.au/open</a>) and an instance of HAPI by cerner (<a href=\"http://cerner-genomics.herokuapp.com/baseDstu3\" target=\"_blank\" title=\"http://cerner-genomics.herokuapp.com/baseDstu3\">http://cerner-genomics.herokuapp.com/baseDstu3</a>) processes them differently. Here's a toy example where I create a Patient and then a Specimen that points to that Patient in a single transaction.</p>\n<div class=\"codehilite\"><pre><span class=\"nt\">&lt;Bundle</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;transaction&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;entry&gt;</span>\n    <span class=\"nt\">&lt;fullUrl</span> <span class=\"na\">value=</span><span class=\"s\">&quot;urn:uuid:9e928bfa-f811-4af5-97c5-1ede3d84afc3&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;resource&gt;</span>\n      <span class=\"nt\">&lt;Patient&gt;</span>\n        <span class=\"nt\">&lt;name&gt;</span>\n          <span class=\"nt\">&lt;family</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Doe&quot;</span><span class=\"nt\">/&gt;</span>\n          <span class=\"nt\">&lt;given</span> <span class=\"na\">value=</span><span class=\"s\">&quot;John&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/name&gt;</span>\n      <span class=\"nt\">&lt;/Patient&gt;</span>\n    <span class=\"nt\">&lt;/resource&gt;</span>\n    <span class=\"nt\">&lt;request&gt;</span>\n      <span class=\"nt\">&lt;method</span> <span class=\"na\">value=</span><span class=\"s\">&quot;POST&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Patient&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/request&gt;</span>\n  <span class=\"nt\">&lt;/entry&gt;</span>\n  <span class=\"nt\">&lt;entry&gt;</span>\n    <span class=\"nt\">&lt;fullUrl</span> <span class=\"na\">value=</span><span class=\"s\">&quot;urn:uuid:c92d42e9-3468-416a-9d03-de586f3c7c4b&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;resource&gt;</span>\n        <span class=\"nt\">&lt;Specimen</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;subject&gt;</span>\n                <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">&quot;urn:uuid:9e928bfa-f811-4af5-97c5-1ede3d84afc3&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/subject&gt;</span>\n        <span class=\"nt\">&lt;/Specimen&gt;</span>\n    <span class=\"nt\">&lt;/resource&gt;</span>\n    <span class=\"nt\">&lt;request&gt;</span>\n      <span class=\"nt\">&lt;method</span> <span class=\"na\">value=</span><span class=\"s\">&quot;POST&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Specimen&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/request&gt;</span>\n  <span class=\"nt\">&lt;/entry&gt;</span>\n<span class=\"nt\">&lt;/Bundle&gt;</span>\n</pre></div>\n\n\n<p>When send this to <a href=\"http://fhir3.healthintersections.com.au/open\" target=\"_blank\" title=\"http://fhir3.healthintersections.com.au/open\">http://fhir3.healthintersections.com.au/open</a> it creates both resources, but in the specimen resource, the subject is pointing to the guid. </p>\n<div class=\"codehilite\"><pre><span class=\"cp\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>\n<span class=\"nt\">&lt;Specimen</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">&quot;125&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;versionId</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">&quot;2016-05-10T02:24:36Z&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">&quot;urn:uuid:9e928bfa-f811-4af5-97c5-1ede3d84afc3&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n<span class=\"nt\">&lt;/Specimen&gt;</span>\n</pre></div>\n\n\n<p>But when I send it to the HAPI server at <a href=\"http://cerner-genomics.herokuapp.com/baseDstu3\" target=\"_blank\" title=\"http://cerner-genomics.herokuapp.com/baseDstu3\">http://cerner-genomics.herokuapp.com/baseDstu3</a>, the Specimen resource it creates has a subect reference pointing to the patient resource it create.</p>\n<div class=\"codehilite\"><pre><span class=\"p\">{</span>\n  <span class=\"nt\">&quot;resourceType&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Specimen&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;405&quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;meta&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;versionId&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;1&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;lastUpdated&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;2016-05-10T02:36:20.712+00:00&quot;</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">&quot;subject&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;reference&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient/404&quot;</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n\n<p>I'm trying to understand which should be the expected behavior from my toy example. Naturally, I prefer the cerner (HAPI) server.</p>",
        "id": 153826260,
        "sender_full_name": " Bob Milius",
        "timestamp": 1462848272
    },
    {
        "content": "<p>The HAPI server is the correct behavior.</p>",
        "id": 153826280,
        "sender_full_name": "Jason Walonoski",
        "timestamp": 1462881730
    },
    {
        "content": "<p>yes, I need to fix this</p>",
        "id": 153826287,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462884084
    },
    {
        "content": "<p>thanks!</p>",
        "id": 153826317,
        "sender_full_name": " Bob Milius",
        "timestamp": 1462890456
    }
]