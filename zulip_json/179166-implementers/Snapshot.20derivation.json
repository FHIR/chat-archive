[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , there appears to be a bug in the snapshot derivation computed by your server. I am using the /StructureDefinition/$snapshot operation.  As a test, I took the bp.profile.xml file from May 2016 build, deleted the &lt;snapshot&gt;, and POSTed to your server to compute and return with snapshot.  It returns without error, but misses  &lt;fixedUri&gt; from the differential when computing the snapshot. E.g., see Observation.code.coding.system</p>",
        "id": 153824577,
        "sender_full_name": "Dave Carlson",
        "timestamp": 1462389919
    },
    {
        "content": "<p>Also, do any other servers implement the /StructureDefinition/$snapshot operation?</p>",
        "id": 153824578,
        "sender_full_name": "Dave Carlson",
        "timestamp": 1462390050
    },
    {
        "content": "<p>Grahame, now that HL7 is over, following up on this report of a bug in your $snapshot derivation, still appears in current server.  Also interested if any other servers are implementing StructureDefinition/$snapshot operation?</p>",
        "id": 153827976,
        "sender_full_name": "Dave Carlson",
        "timestamp": 1463410836
    },
    {
        "content": "<p>Hi Dave - I'm working on what a \"correct\" snapshot should be.  Currently, only Grahame's server exposes $snapshot.  Ewout will add to Spark shortly.</p>",
        "id": 153827977,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463410909
    },
    {
        "content": "<p>Not sure about HAPI (<span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> )?</p>",
        "id": 153827978,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463410921
    },
    {
        "content": "<p>Hapi doesn't yet, but will soon.... </p>",
        "id": 153827982,
        "sender_full_name": "James Agnew",
        "timestamp": 1463411991
    },
    {
        "content": "<p>Thanks Chris and James.  I enthusiastically agree that we need a complete, documented specification for how a snapshot is computed from differentials.  Without that, we are assured of incompatible results.  I need this for my work on using MDHT UML tooling  to design FHIR profiles.  I currently export structure definitions from UML with differentials.  For now, I am using Grahame's $snapshot operation to validate and and complete generated profiles.</p>",
        "id": 153827984,
        "sender_full_name": "Dave Carlson",
        "timestamp": 1463413581
    },
    {
        "content": "<p>See this stream for more info: <a href=\"https://chat.fhir.org/#narrow/stream/implementers/subject/Typing.20in.20FHIR\" target=\"_blank\" title=\"https://chat.fhir.org/#narrow/stream/implementers/subject/Typing.20in.20FHIR\">https://chat.fhir.org/#narrow/stream/implementers/subject/Typing.20in.20FHIR</a></p>",
        "id": 153827985,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463413633
    },
    {
        "content": "<p>I saw the wiki page that Grahame posted on FHIR typing prior to HL7, but will review this stream again, thx.</p>",
        "id": 153827987,
        "sender_full_name": "Dave Carlson",
        "timestamp": 1463413712
    },
    {
        "content": "<p>My understanding is that Ewout and Chris were going to write up typing, and use what I wrote as an input. </p>",
        "id": 153828000,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1463420148
    },
    {
        "content": "<p>Further I am waiting for Ewout to drive more alignment on snapshot generation. </p>",
        "id": 153828001,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1463420174
    },
    {
        "content": "<p>Yes - in the works.</p>",
        "id": 153828002,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463420177
    },
    {
        "content": "<p>finally, have you seen the snapshot generation tests? </p>",
        "id": 153828003,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1463420184
    },
    {
        "content": "<p>Where are the tests?</p>",
        "id": 153828005,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463420300
    },
    {
        "content": "<p>class ProfileUtilitiesTests in the reference implementation</p>",
        "id": 153828008,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1463421098
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"197476\">@Dave Carlson</span>, yes, we worked on this for a period of time to make sure the output of Forge is consistent with what Grahame's tooling expects as input. It's slow work since changes to the output, requires Grahame to change stuff further on in the tooling chain. Other priorities took over (and stuff seemed to work good enough ;-), but now we have Grahame, Chris, us and you being dependent on this (and not only Grahame and me), it's time to pick this up again....</p>",
        "id": 153828571,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1463650325
    },
    {
        "content": "<p>The way we started out is by running our snapshot generator on all differentials in the spec (all differentials from the provided IGs in the FHIR spec) and then comparing the snapshots.</p>",
        "id": 153828572,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1463650396
    },
    {
        "content": "<p>We could try that for Chris' and mine now, and see what happens. Then again, I am still working on DSTU2 (since that's \"production\" level for us), and I don't know whether it makes sense for Grahame to invest time to improve the DSTU2 snapshot generator anymore.</p>",
        "id": 153828573,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1463650456
    },
    {
        "content": "<p>So, should we make this work on DSTU2 or STU3?</p>",
        "id": 153828574,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1463650467
    },
    {
        "content": "<p>well, we need to make this work in STU3, but I don't mind working on it in DSTU2 as well. </p>",
        "id": 153828774,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1463692576
    },
    {
        "content": "<p>we should start with the fixed tests, and make sure everyone passes the unit tests. Then we can build from there</p>",
        "id": 153828775,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1463692596
    },
    {
        "content": "<p>I've published a set of profiles with what I believe to be correct snapshots here: <a href=\"https://github.com/chrisgrenz/FHIR-Primer\" target=\"_blank\" title=\"https://github.com/chrisgrenz/FHIR-Primer\">https://github.com/chrisgrenz/FHIR-Primer</a></p>",
        "id": 153828858,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463750621
    },
    {
        "content": "<p>There are branches for the different versions.</p>",
        "id": 153828859,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463750634
    },
    {
        "content": "<p>The wiki has some information about how to determine what to merge.  Note that this is my interpretation at this point and not an official stance.  <a href=\"https://github.com/chrisgrenz/FHIR-Primer/wiki/Snapshots-Determining-Refines\" target=\"_blank\" title=\"https://github.com/chrisgrenz/FHIR-Primer/wiki/Snapshots-Determining-Refines\">https://github.com/chrisgrenz/FHIR-Primer/wiki/Snapshots-Determining-Refines</a></p>",
        "id": 153828860,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1463750705
    }
]