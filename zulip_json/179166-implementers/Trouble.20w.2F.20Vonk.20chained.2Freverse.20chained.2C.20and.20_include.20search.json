[
    {
        "content": "<p>Hello,</p>\n<p>I'm having trouble getting chained, reverse chained, and _include search to work on Vonk (tried 2.0.0 and 3.0.0-beta2).  I've loaded in 10 Patients, each of which have 2 Specimens. </p>\n<p>I tried this chained search: <br>\n<a href=\"/user_uploads/10155/q6k3DjC-ssTwiDAgJAkXvxUk/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/q6k3DjC-ssTwiDAgJAkXvxUk/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/q6k3DjC-ssTwiDAgJAkXvxUk/pasted_image.png\"></a></div><p>which I expected to return 6 specimens (3 patients named Natasha x 2 Specimens per patient)</p>\n<p>I also tried this reverse chained search which didn't seem to work either:<br>\n<a href=\"/user_uploads/10155/NPXAjvYiPrWMSGNIUrfkHMxI/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/NPXAjvYiPrWMSGNIUrfkHMxI/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/NPXAjvYiPrWMSGNIUrfkHMxI/pasted_image.png\"></a></div><p>Similarly, I cannot get the _include parameter to work either. <br>\n<a href=\"/user_uploads/10155/EKma9SWIpcPNpiNfPIf30aC7/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/EKma9SWIpcPNpiNfPIf30aC7/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/EKma9SWIpcPNpiNfPIf30aC7/pasted_image.png\"></a></div><p>Could someone please advise if I'm doing something wrong? </p>\n<p>cc: <span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span> </p>\n<p>Thank you!</p>",
        "id": 180169171,
        "sender_full_name": "Natasha Singh",
        "timestamp": 1573156583
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"225054\">@Natasha Singh</span>  Could you check to see whether your subject reference in the Specimen is correct? I see that your Specimen has a guid as technical id - which is what you'd expect when you POST it to Vonk - but your Specimen.subject uses a custom id ('Patient/PT-00001'). The Patient resource can only have that specific id when you have chosen to PUT it to Vonk with it. If you have also used a POST for the Patient, your links will be broken, and the chained search/include will not work.</p>",
        "id": 180179898,
        "sender_full_name": "Mirjam Baltus",
        "timestamp": 1573163331
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span> , I'm not sure I follow. The custom ids seem to be ok. I tried this and it seems to work:</p>\n<p><a href=\"/user_uploads/10155/am36T_juyL0IEzk7kDC_eJmW/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/am36T_juyL0IEzk7kDC_eJmW/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/am36T_juyL0IEzk7kDC_eJmW/pasted_image.png\"></a></div>",
        "id": 180180669,
        "sender_full_name": "Natasha Singh",
        "timestamp": 1573163835
    },
    {
        "content": "<p>Yes, that would work, since the reference in Specimen.subject has the PT-00001 value in it. But, I suspect that there is no Patient/PT-00001 on your server. You can test that by doing a GET &lt;vonk&gt;/Patient/PT-00001. If that is not there, Vonk will not be able to follow the reference from the Specimen.subject to an existing resource. The Specimen.subject field needs to contain a reference to an existing Patient resource on your server in order for the chain/include to work.</p>",
        "id": 180181296,
        "sender_full_name": "Mirjam Baltus",
        "timestamp": 1573164240
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span> , </p>\n<p>Ok I understand what you are saying about the custom id. GET /Patient/PT-00001 returns a 404. Since I used POST to create everything, all created resources got assigned a generated ID, rather than my custom IDs, which means the links are all broken between referenced resources. </p>\n<p>So, I'm trying to PUT this time, but I'm running into a seperate issue which I'll just post here. Maybe you can help. </p>\n<p>Here's what I did: <br>\n- PUT /Patient/PT-00001 <br>\n- DELETE /Patient/PT-0001 <br>\n- PUT /Patient/PT-00001 - this resulted in the following error that I don't understand:</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n  &quot;id&quot;: &quot;3ad3a264-abcb-4070-a666-195035417f0f&quot;,\n  &quot;meta&quot;: {\n    &quot;versionId&quot;: &quot;b24aa6e3-2029-473f-9a02-a415ea7561cd&quot;,\n    &quot;lastUpdated&quot;: &quot;2019-11-08T15:46:31.189+00:00&quot;\n  },\n  &quot;issue&quot;: [\n    {\n      &quot;severity&quot;: &quot;warning&quot;,\n      &quot;code&quot;: &quot;business-rule&quot;,\n      &quot;details&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;system&quot;: &quot;http://hl7.org/fhir/dotnet-api-operation-outcome&quot;,\n            &quot;code&quot;: &quot;2007&quot;\n          }\n        ],\n        &quot;text&quot;: &quot;Element definition does not specify a &#39;min&#39; value, which is required. Cardinality has not been validated&quot;\n      },\n      &quot;location&quot;: [\n        &quot;Patient&quot;\n      ]\n    },\n    {\n      &quot;severity&quot;: &quot;error&quot;,\n      &quot;code&quot;: &quot;exception&quot;,\n      &quot;details&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;system&quot;: &quot;http://hl7.org/fhir/dotnet-api-operation-outcome&quot;,\n            &quot;code&quot;: &quot;5006&quot;\n          }\n        ],\n        &quot;text&quot;: &quot;Existing resource is in a different informationmodel: Fhir3.0.&quot;\n      }\n    }\n  ]\n}\n</pre></div>\n\n\n<p>All of my requests have the mimeType parameter fhirVersion=4.0. Is Vonk creating both STU3 and R4 resources and only deleting the R4 ones?</p>",
        "id": 180242367,
        "sender_full_name": "Natasha Singh",
        "timestamp": 1573228414
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span> I'm still having the issue above ^ (can't PUT after DELETE due to existing resources in Fhir3.0 ) BUT after I used PUT to create all my resources for the first time, I am seeing that chaining, rev chaining, and _include is working now. The problem was exactly what you said - links were broken bc resources weren't being referenced by my custom IDs. <br>\nSo thank you for helping me resolve that!</p>",
        "id": 180252513,
        "sender_full_name": "Natasha Singh",
        "timestamp": 1573234303
    },
    {
        "content": "<p>Great that that works now! You could also create a transaction Bundle to send all of the resources in one go. Vonk will then go through the references and keep the links if the Bundle contains all the referenced resources.<br>\nAs to your other issue, this is something I cannot reproduce. Vonk does not create the resource for both versions. Could you send an email with your logfile to the vonk mailbox?</p>",
        "id": 180255175,
        "sender_full_name": "Mirjam Baltus",
        "timestamp": 1573236149
    },
    {
        "content": "<p>This happened using the Vonk 3.0.0-beta2 docker image btw. Let me send you the logs too</p>",
        "id": 180257379,
        "sender_full_name": "Natasha Singh",
        "timestamp": 1573237688
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span>  <a href=\"/user_uploads/10155/nziOr0KXFyG2TsaskUqmwy0C/vonk-20191108.log\" target=\"_blank\" title=\"vonk-20191108.log\">vonk-20191108.log</a></p>",
        "id": 180265456,
        "sender_full_name": "Natasha Singh",
        "timestamp": 1573242918
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"225054\">@Natasha Singh</span> This issue was resolved in the stable Vonk 3.0.0 release. Could you please update and re-test?</p>",
        "id": 180272033,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1573247179
    },
    {
        "content": "<p>Ah I see. I had to fall back to using 3.0.0-beta2 only because of this issue: <a href=\"#narrow/stream/179166-implementers/topic/Does.20Vonk.203.2E0.2E0.20try.20to.20fetch.20things.20at.20canonical.20URLs/near/179850218\" title=\"#narrow/stream/179166-implementers/topic/Does.20Vonk.203.2E0.2E0.20try.20to.20fetch.20things.20at.20canonical.20URLs/near/179850218\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Does.20Vonk.203.2E0.2E0.20try.20to.20fetch.20things.20at.20canonical.20URLs/near/179850218</a>.</p>",
        "id": 180272263,
        "sender_full_name": "Natasha Singh",
        "timestamp": 1573247345
    }
]