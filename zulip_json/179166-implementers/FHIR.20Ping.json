[
    {
        "content": "<p>What's the easiest/fastest way to get an answer to a 'FHIR Ping' (i.e. a boolean check whether or not there is a FHIR listener at a certain base URL) ?<br>\n[base]/metadata will work on all servers, a 200 response indicates a FHIR Listener. But this is slow, the response structure [which is itself ignored] rather large<br>\n[base]/Patient?_id=&lt;some fixed uuid&gt; probably works on most servers, returns an empty Bundle, and has a quick round trip time. However, if the server doesn't support the _id parameter it will return a bundle with (a subset of) 'all patients'.<br>\nAny suggestions/comments?</p>",
        "id": 157020307,
        "sender_full_name": "René Spronk",
        "timestamp": 1548676908
    },
    {
        "content": "<p>metadata?_summary=true makes it smaller. And should be quick, in some servers this is a hard coded file, other this is generated in code without db/disk, others like mine generate and cache the result, so you have basically instant results. And with compression too, the result can be quite little.</p>",
        "id": 157020570,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1548677195
    },
    {
        "content": "<p>Hmm. on <a href=\"http://test.fhir.org/r3\" target=\"_blank\" title=\"http://test.fhir.org/r3\">http://test.fhir.org/r3</a> /metadata takes forever, whether one uses _summary or not. /metadata is attractive, and in the kind of script I'm writing performance is not a key issue, but shouldn't there be an easy way of doing this? Currently \"/Patient?_id=xyz123abc\" beats (in terms of round trip time) any /metadata based URL hands down.</p>",
        "id": 157022747,
        "sender_full_name": "René Spronk",
        "timestamp": 1548680043
    },
    {
        "content": "<p>Maybe you could try HEAD to avoid transmission of the body, if the server supports it?</p>",
        "id": 157023575,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1548680943
    },
    {
        "content": "<p>Risky, this may well result in a 405 or 501, on any webserver, regardless of whether it supports FHIR or not.</p>",
        "id": 157028098,
        "sender_full_name": "René Spronk",
        "timestamp": 1548685386
    },
    {
        "content": "<p><a href=\"http://test.fhir.org/r3/metadata?_summary=true\" target=\"_blank\" title=\"http://test.fhir.org/r3/metadata?_summary=true\">http://test.fhir.org/r3/metadata?_summary=true</a> in json = 1012ms for me</p>",
        "id": 157050445,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548703302
    },
    {
        "content": "<p>response size 40kb</p>",
        "id": 157050459,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548703313
    },
    {
        "content": "<p>That (1+ sec) seems too long!  Why not have a FHIR Ping, as suggested by the thread title; a 'no-op' operation to check that the FHIR Server is alive?   This would (should also put less load on the FHIR server if many clients for example, were trying to ping it.)</p>",
        "id": 157060701,
        "sender_full_name": "John Silva",
        "timestamp": 1548712123
    },
    {
        "content": "<p>You could ask for patent/--- which is an invalid id.</p>",
        "id": 157062402,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1548713768
    },
    {
        "content": "<p>Have you tried other servers metadata timing? And how critical is how long this ping takes? Doesn't sound like a user experience problem.</p>",
        "id": 157062461,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1548713838
    },
    {
        "content": "<p>Is a user waiting for the ping?</p>",
        "id": 157062476,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1548713855
    },
    {
        "content": "<p>well, it depends quite what you want to find out. You can hit .well-known on my server.  But that doesn't tell you that the FHIR server is functional. I use patient search in the web server watcher I use to make sure that the FHIR server is fucntional</p>",
        "id": 157063472,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548714782
    },
    {
        "content": "<p>we use _count=0</p>",
        "id": 157085046,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1548744380
    },
    {
        "content": "<p>Problem with /Patient/? is that there may be FHIR servers that don't support Patient resources. OK, those are going to be few and far between - /metadata is the only truly universal solution; it seems only <a href=\"http://test.fhir.org\" target=\"_blank\" title=\"http://test.fhir.org\">test.fhir.org</a> is \"slow\" (relatively speaking)..</p>",
        "id": 157091066,
        "sender_full_name": "René Spronk",
        "timestamp": 1548752736
    },
    {
        "content": "<p>how long is it taking for you?</p>",
        "id": 157091467,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548753160
    },
    {
        "content": "<p>locallly it takes me 200ms. Anything more than is network time</p>",
        "id": 157091481,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548753184
    },
    {
        "content": "<p>Ok, when querying for /Patient/?id=aaa123abc, delays are (in seconds) .14 (Vonk - admittedly hosted 'nearby'), .47 (<a href=\"http://test.fhir.org\" target=\"_blank\" title=\"http://test.fhir.org\">test.fhir.org</a>), .41 (hapi r3). Using /metadata: delays are (in seconds) .46 (Vonk), 10.4 (<a href=\"http://test.fhir.org\" target=\"_blank\" title=\"http://test.fhir.org\">test.fhir.org</a>), .88 (hapi r3) - a whopping 10.4 seconds. Can't imagine that to be wholly due to 'network time' I'm afraid..</p>",
        "id": 157106048,
        "sender_full_name": "René Spronk",
        "timestamp": 1548770110
    },
    {
        "content": "<p><code>/metadata</code> doesn't really need to be part of the FHIR server, it's static enough that could host it on a CDN. Furthermore, implementers may have multiple separate codebases implementing different  clusters of resources. Microservice practitioners would probably try to carve resources up into different functional areas, making the health check topology unique and ever-changing. </p>\n<p>Servers with enough consumers should offer a status page that is hosted external to the stack. They should give the best possible representation of their internal structure, without giving away too much of the internals of the platform. We use <a href=\"http://statuspage.io\" target=\"_blank\" title=\"http://statuspage.io\">statuspage.io</a>.</p>",
        "id": 157108311,
        "sender_full_name": "Nick Hatt",
        "timestamp": 1548772039
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194031\">@Nick Hatt</span>  -- good points!   It seems like the answers here are all using 'side effects' to deduce if a FHIR server is up or not.  Why not implement a 'real ping' so that it can be used for this desired intention?</p>",
        "id": 157109861,
        "sender_full_name": "John Silva",
        "timestamp": 1548773232
    },
    {
        "content": "<p>tx servers may not support Patient</p>",
        "id": 157110025,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1548773371
    },
    {
        "content": "<p>You could also use <code>metadata?_elements=fhirVersion</code> to cut the response size</p>",
        "id": 157110680,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1548773898
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194183\">@John Silva</span> I'm challenging the idea that <code>FHIR server</code> needs to be singular from a service level perspective. Assume I use AWS S3 to implement the <code>Binary</code> resource, and maybe <code>Patient</code> is served from Azure, for example. I need to be able to express this difference to my API clients. That may be because I'm contractually obligated (via an SLA) or because I want to them design around potential failures.</p>",
        "id": 157113945,
        "sender_full_name": "Nick Hatt",
        "timestamp": 1548776813
    },
    {
        "content": "<p>Another possibility is  <code>[base]/$versions</code> .  <br>\nPlenty of FHIR servers don't support the Patient resource (e.g. Terminology Servers, Provider Directory Servers, etc.).</p>",
        "id": 157130860,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1548790234
    },
    {
        "content": "<p>I think there are also many that don't support <code>[base]/$versions</code> too</p>",
        "id": 157135098,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1548793619
    },
    {
        "content": "<p><a href=\"http://test.fhir.org/r3/metadata?_summary=true\" target=\"_blank\" title=\"http://test.fhir.org/r3/metadata?_summary=true\">http://test.fhir.org/r3/metadata?_summary=true</a> : 1824 ms<br>\n<a href=\"http://test.fhir.org/r3/metadata\" target=\"_blank\" title=\"http://test.fhir.org/r3/metadata\">http://test.fhir.org/r3/metadata</a> : 2396 ms</p>\n<p>I have no idea why you're getting 10sec+ times</p>",
        "id": 157136519,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548794772
    },
    {
        "content": "<p>Nick is correct but it's irrelevant how the server is structured - the client sees it as a single endpoint</p>",
        "id": 157136563,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548794805
    },
    {
        "content": "<p>Nick's point could be an argument for a specific health endpoint which has the specific purpose of attesting to the \"status\" of the server as a whole.  This could get quite complex (but also useful)  in the context of federated servers.</p>",
        "id": 157137292,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1548795434
    },
    {
        "content": "<p>Also, FWIW, I get a significant speed different between <a href=\"http://test.fhir.org/r3/metadata?_elements=fhirVersion\" target=\"_blank\" title=\"http://test.fhir.org/r3/metadata?_elements=fhirVersion\">http://test.fhir.org/r3/metadata?_elements=fhirVersion</a> and <a href=\"http://test.fhir.org/r3/metadata?_elements=fhirVersion&amp;_format=json\" target=\"_blank\" title=\"http://test.fhir.org/r3/metadata?_elements=fhirVersion&amp;_format=json\">http://test.fhir.org/r3/metadata?_elements=fhirVersion&amp;_format=json</a> (3.5s - XML vs 0.5s - JSON)</p>",
        "id": 157137598,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1548795657
    },
    {
        "content": "<p>same for me. seems the server is very prone to contention?</p>",
        "id": 157138393,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1548796275
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Originally I didn't use any headers, so your server creates HTML (10.4 secs), if requesting JSON, it'1 1.5 secs (for /metadata)</p>",
        "id": 157169915,
        "sender_full_name": "René Spronk",
        "timestamp": 1548836020
    },
    {
        "content": "<p>The HTTP OPTIONS method could potentially be useful for something like this.  However, the FHIR RESTful API spec does not specify behavior for OPTIONS.</p>",
        "id": 157306920,
        "sender_full_name": "Joel Schneider",
        "timestamp": 1548969212
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span> have you tried the suggestion from <span class=\"user-mention\" data-user-id=\"191318\">@nicola (RIO/SS)</span> ? <code>http://test.fhir.org/r3?_count=0&amp;format=json</code> seems quick, 0.5-0.7s</p>",
        "id": 157341598,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1549014855
    },
    {
        "content": "<p>Not all servers support global search...</p>",
        "id": 157488627,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1549236888
    },
    {
        "content": "<p>Well, yes, technically all you have to support is <code>/metadata</code> and nothing else to be compliant, but we've already started from that</p>",
        "id": 157506347,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1549267315
    },
    {
        "content": "<p>So I went for <a href=\"http://test.fhir.org/r3/metadata?_elements=fhirVersion&amp;_format=json\" target=\"_blank\" title=\"http://test.fhir.org/r3/metadata?_elements=fhirVersion&amp;_format=json\">http://test.fhir.org/r3/metadata?_elements=fhirVersion&amp;_format=json</a> - /metadata is supported by all systems, and should they not support the query parameters (_elements) the ping will still work..</p>",
        "id": 157507644,
        "sender_full_name": "René Spronk",
        "timestamp": 1549269216
    },
    {
        "content": "<p>I Iike it.</p>",
        "id": 157511306,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1549273547
    },
    {
        "content": "<p>I think it would be better for us to take your use-case and come up with an R5 solution. I would like that solution to be a variation of the /metadata endpoint. One would hope that _summary could be made fast, and thus we could put in a 'recommendation' that a _summary should be able to be responded to quickly... not sure how that goes...  I worry that _elements is an unusual thing, and would often be implemented by first getting the normal response then filtering to the _elements... thus it would tend to be slower.</p>",
        "id": 157521618,
        "sender_full_name": "John Moehrke",
        "timestamp": 1549286010
    },
    {
        "content": "<p>Well, either we mandate something new (some new mechanism, from R5 onwards) which shall be supported by all FHIR servers, or we tweak the /metadata query, e.g. by specifying that its contents should be returned ASAP and that a cached version of /metadata may be way of achieving this.</p>",
        "id": 157525522,
        "sender_full_name": "René Spronk",
        "timestamp": 1549289940
    },
    {
        "content": "<p>don't know what that would achieve. I'm already returning it as a quickly as possible.</p>",
        "id": 157550814,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549309527
    }
]