[
    {
        "content": "<p>It seems to me that there is a mismatch between FHIR Structure definition and JSON schema. <br>\nIn particular, JSON schema specifies Claim Insurance Focal field as optional, while documentation <a href=\"https://www.hl7.org/fhir/claim-definitions.html#Claim.insurance.focal\">https://www.hl7.org/fhir/claim-definitions.html#Claim.insurance.focal</a> says it's mandatory.<br>\nSee<br>\n<a href=\"https://github.com/nazrulworld/fhir.resources/issues/18#issuecomment-661692087\">https://github.com/nazrulworld/fhir.resources/issues/18#issuecomment-661692087</a> for the context.</p>",
        "id": 204652767,
        "sender_full_name": "Arseniy Zhizhelev",
        "timestamp": 1595416191
    },
    {
        "content": "<p>That's not an error.  I expect you'll see there's a co-occurrence rule that requires either <code>focal</code> or <code>_focal</code>.</p>",
        "id": 204673517,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1595428363
    },
    {
        "content": "<p>Could you help me find this co-occurrence rule inside json schema? What I see for <code>\"Claim_Insurance\": </code> is this:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"p\">{</span>\n    <span class=\"nt\">&quot;description&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;A provider issued list of professional services and products which have been provided, or are to be provided, to a patient which is sent to an insurer for reimbursement.&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;properties&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n\n\n      <span class=\"nt\">&quot;focal&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;description&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;A flag to indicate that this Coverage is to be used for adjudication of this claim when set to true.&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;$ref&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;#/definitions/boolean&quot;</span>\n      <span class=\"p\">},</span>\n      <span class=\"nt\">&quot;_focal&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;description&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Extensions for focal&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;$ref&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;#/definitions/Element&quot;</span>\n      <span class=\"p\">},</span>\n\n\n      <span class=\"nt\">&quot;coverage&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;description&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Reference to the insurance card level information contained in the Coverage resource. The coverage issuing insurer will use these details to locate the patient\\u0027s actual coverage within the insurer\\u0027s information system.&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;$ref&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;#/definitions/Reference&quot;</span>\n      <span class=\"p\">}</span>\n\n    <span class=\"p\">},</span>\n    <span class=\"nt\">&quot;additionalProperties&quot;</span><span class=\"p\">:</span> <span class=\"kc\">false</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;required&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"s2\">&quot;coverage&quot;</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">}</span>\n</code></pre></div>\n\n\n<p>I only see <code>required</code> field here - <code>coverage</code>.</p>",
        "id": 205238238,
        "sender_full_name": "Arseniy Zhizhelev",
        "timestamp": 1595944631
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 205248088,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1595949049
    },
    {
        "content": "<p>I'm not generating the co-occurence rules</p>",
        "id": 205295221,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1595973231
    },
    {
        "content": "<p>because I don't see how to, I think</p>",
        "id": 205295399,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1595973361
    },
    {
        "content": "<p>FHIR has its own structure definition and validation code - why not use that? JSON schemas are a poor fit</p>",
        "id": 205295996,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1595973730
    },
    {
        "content": "<p>I thought in a post long ago you said you had?  But if it's not possible, so be it.  In any case, the elements have to be optional because the minOccurs rule applies to (at least one of) not both of.</p>",
        "id": 205313461,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1595991315
    },
    {
        "content": "<p>I'm seeing several other missing <code>required</code> statements in the JSON Schema and am wondering if I'm just not reading it right. A couple of exmaples:</p>\n<ul>\n<li>Annotation does not require <code>text</code></li>\n<li>Extension does not require <code>url</code> </li>\n</ul>\n<p>I do see <em>some</em> <code>required</code> properties in other DataTypes, but they're not consistent. For example, Signature lists <code>type</code> and <code>who</code> as required but not <code>when</code>.</p>",
        "id": 207972505,
        "sender_full_name": "Benjamin Flessner",
        "timestamp": 1598366966
    },
    {
        "content": "<p>Oh; the missing <code>required</code> flags are all on primitive data types. Does this mean that if you have an extension on a required field with a primitive datatype that the instance is valid if <em>only</em> the extension is present? E.g. you can have an Extension with <code>_url</code> but no <code>url</code> ? I thought <code>url</code> was still required in this case.</p>",
        "id": 207973517,
        "sender_full_name": "Benjamin Flessner",
        "timestamp": 1598367391
    },
    {
        "content": "<p>url is not required if _url is present</p>",
        "id": 207977353,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1598368992
    },
    {
        "content": "<p>extension is a special case, but the json schema generator doesn't know about that. Feel free to create a task to make extension.url a special case in the generator</p>",
        "id": 208025412,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1598390509
    }
]