[
    {
        "content": "<p>Hi Everyone,<br>\nI have created a bundle resource from HL7 v2 meassage, in  which I am sending full URL for each resource in order to reference in another resource,  i have also  used conditional update in few resources like - Patient Resource and Encounter resource based on the identifiers. My issue is - In fhir server it it creating 2 resources for a single resource from the bundle. one with the resource id with full url  which is an empty resource and another with a new id for example - For a patient resource in a bundle- It is creating 2 patient resources, one with full content inside it and with new resource id and another with the full url id that I have given. Please refer the below json.  <br>\n{<br>\n  \"resourceType\": \"Bundle\",<br>\n  \"type\": \"transaction\",<br>\n  \"entry\": [<br>\n    {<br>\n      \"fullUrl\": \"urn:uuid:9d1ca0a8-0cee-3747-814d-3ff9907939a9\",<br>\n      \"resource\": {<br>\n        \"resourceType\": \"Patient\",<br>\n        \"id\": \"9d1ca0a8-0cee-3747-814d-3ff9907939a9\",<br>\n        \"identifier\": [<br>\n          {<br>\n            \"use\": \"usual\",<br>\n            \"system\": \"<a href=\"http://hospital.org/externalID\">http://hospital.org/externalID</a>\",<br>\n            \"value\": \"NGM03126211\"<br>\n          },<br>\n          {<br>\n            \"use\": \"usual\",<br>\n            \"system\": \"<a href=\"http://mein-krankenhaus.de/NamingSystem/patient-identifier\">http://mein-krankenhaus.de/NamingSystem/patient-identifier</a>\",<br>\n            \"value\": \"201991014\"<br>\n          },<br>\n          {<br>\n            \"use\": \"secondary\",<br>\n            \"system\": \"<a href=\"http://hospital.org/alternatePatientID\">http://hospital.org/alternatePatientID</a>\",<br>\n            \"value\": \"201927815\"<br>\n          }<br>\n        ],<br>\n        \"name\": [<br>\n          {<br>\n            \"use\": \"official\",<br>\n            \"text\": \"Donald\",<br>\n            \"family\": \"Duck Donald\",<br>\n            \"given\": [<br>\n              \"Duck\"<br>\n            ]<br>\n          }<br>\n        ],<br>\n        \"birthDate\": \"1949-12-03\",</p>\n<div class=\"codehilite\"><pre><span></span><code>    &quot;gender&quot;: &quot;male&quot;,\n    &quot;address&quot;: [\n      {\n        &quot;line&quot;: [\n          &quot;Main str. 10&quot;\n        ],\n        &quot;city&quot;: &quot;Berlin&quot;,\n        &quot;postalCode&quot;: &quot;72076&quot;,\n        &quot;country&quot;: &quot;Deuscheland&quot;,\n\n      }\n    ],\n    &quot;telecom&quot;: [\n      {\n        &quot;value&quot;: &quot;0176-3333355&quot;,\n        &quot;system&quot;: &quot;phone&quot;,\n        &quot;use&quot;: &quot;home&quot;\n      },\n      {\n        &quot;value&quot;: &quot;07071-23332&quot;,\n        &quot;system&quot;: &quot;phone&quot;,\n        &quot;use&quot;: &quot;work&quot;\n      }\n    ],\n    &quot;communication&quot;: [\n      {\n        &quot;language&quot;: {\n          &quot;coding&quot;: [\n            {\n              &quot;system&quot;: &quot;urn:ietf:bcp:47&quot;,\n              &quot;code&quot;: &quot;de&quot;,\n              &quot;display&quot;: &quot;German&quot;\n            }\n          ]\n        },\n        &quot;preferred&quot;: true\n      }\n    ],\n    &quot;multipleBirthBoolean&quot;: false\n  },\n  &quot;request&quot;: {\n    &quot;method&quot;: &quot;PUT&quot;,\n    &quot;url&quot;: &quot;Patient?identifier=http://mein-krankenhaus.de/NamingSystem/patient-identifier|201991014&quot;\n  }\n},\n{\n  &quot;fullUrl&quot;: &quot;urn:uuid:2750731b-7408-3289-94f4-913df2982229&quot;,\n  &quot;resource&quot;: {\n    &quot;resourceType&quot;: &quot;Practitioner&quot;,\n    &quot;id&quot;: &quot;2750731b-7408-3289-94f4-913df2982229&quot;,\n    &quot;identifier&quot;: [\n      {\n        &quot;value&quot;: &quot;610732721&quot;\n      }\n    ],\n    &quot;name&quot;: [\n      {\n        &quot;family&quot;: &quot;Test&quot;,\n        &quot;given&quot;: [\n          &quot;Test_Fr&quot;\n        ],\n        &quot;prefix&quot;: [\n          &quot;Dr. med.&quot;\n        ]\n      }\n    ],\n    &quot;address&quot;: [\n      {\n        &quot;line&quot;: [\n          &quot;Unknownstr. 13&quot;\n        ],\n        &quot;city&quot;: &quot;Herrenberg&quot;,\n        &quot;postalCode&quot;: &quot;71083&quot;,\n        &quot;country&quot;: &quot;Deutschland&quot;\n      }\n    ]\n  },\n  &quot;request&quot;: {\n    &quot;method&quot;: &quot;POST&quot;,\n    &quot;url&quot;: &quot;Practitioner&quot;,\n    &quot;ifNoneExist&quot;: &quot;identifier=610732721&quot;\n  }\n},\n{\n  &quot;fullUrl&quot;: &quot;urn:uuid:5dff23ec-e5e1-36a4-9094-249ea4f0b160&quot;,\n  &quot;resource&quot;: {\n    &quot;resourceType&quot;: &quot;Practitioner&quot;,\n    &quot;id&quot;: &quot;5dff23ec-e5e1-36a4-9094-249ea4f0b160&quot;,\n    &quot;identifier&quot;: [\n      {\n        &quot;value&quot;: &quot;618239221&quot;\n      }\n    ],\n    &quot;name&quot;: [\n      {\n        &quot;family&quot;: &quot;Test2&quot;,\n        &quot;given&quot;: [\n          &quot;Uknown&quot;\n        ],\n        &quot;prefix&quot;: [\n          &quot;Dr. med.&quot;\n        ]\n      }\n    ],\n    &quot;address&quot;: [\n      {\n        &quot;line&quot;: [\n          &quot;Str. 3&quot;\n        ],\n        &quot;city&quot;: &quot;Herrenberg&quot;,\n        &quot;postalCode&quot;: &quot;71083&quot;,\n        &quot;country&quot;: &quot;Deutschland&quot;\n      }\n    ]\n  },\n  &quot;request&quot;: {\n    &quot;method&quot;: &quot;POST&quot;,\n    &quot;url&quot;: &quot;Practitioner&quot;,\n    &quot;ifNoneExist&quot;: &quot;identifier=618239221&quot;\n  }\n},\n{\n  &quot;fullUrl&quot;: &quot;urn:uuid:cbee8c1f-9933-3dd3-b62f-c91b87574cf6&quot;,\n  &quot;resource&quot;: {\n    &quot;resourceType&quot;: &quot;Condition&quot;,\n    &quot;id&quot;: &quot;cbee8c1f-9933-3dd3-b62f-c91b87574cf6&quot;,\n    &quot;code&quot;: {\n      &quot;coding&quot;: [\n        {\n          &quot;system&quot;: &quot;https://www.dimdi.de&quot;,\n          &quot;code&quot;: &quot;M65.4&quot;,\n          &quot;display&quot;: &quot;Tendovaginitis stenosans (de Quervain)&quot;\n        },\n        {\n          &quot;system&quot;: &quot;https://www.dimdi.de&quot;,\n          &quot;code&quot;: &quot;M65.41&quot;,\n          &quot;display&quot;: &quot;Tendovaginitis stenosans (de Quervain)&quot;\n        }\n      ],\n      &quot;text&quot;: &quot;Tendovaginitis stenosans (de Quervain)&quot;\n    },\n    &quot;onsetDateTime&quot;: &quot;2020-08-11T11:32:46.000Z&quot;,\n    &quot;subject&quot;: {\n      &quot;reference&quot;: &quot;Patient/9d1ca0a8-0cee-3747-814d-3ff9907939a9&quot;\n    }\n  },\n  &quot;request&quot;: {\n    &quot;method&quot;: &quot;POST&quot;,\n    &quot;url&quot;: &quot;Condition&quot;\n  }\n},\n{\n  &quot;fullUrl&quot;: &quot;urn:uuid:63fc6ebf-83f3-3d74-b76b-be16557c4e61&quot;,\n  &quot;resource&quot;: {\n    &quot;resourceType&quot;: &quot;Condition&quot;,\n    &quot;id&quot;: &quot;63fc6ebf-83f3-3d74-b76b-be16557c4e61&quot;,\n    &quot;code&quot;: {\n      &quot;coding&quot;: [\n        {\n          &quot;system&quot;: &quot;https://www.dimdi.de&quot;,\n          &quot;code&quot;: &quot;M65.4&quot;,\n          &quot;display&quot;: &quot;Tendovaginitis stenosans&quot;\n        },\n        {\n          &quot;system&quot;: &quot;https://www.dimdi.de&quot;,\n          &quot;code&quot;: &quot;M65.40&quot;,\n          &quot;display&quot;: &quot;Tendovaginitis stenosans&quot;\n        }\n      ],\n      &quot;text&quot;: &quot;Tendovaginitis stenosans&quot;\n    },\n    &quot;onsetDateTime&quot;: &quot;2019-06-13T18:24:13.000Z&quot;,\n    &quot;subject&quot;: {\n      &quot;reference&quot;: &quot;Patient/9d1ca0a8-0cee-3747-814d-3ff9907939a9&quot;\n    }\n  },\n  &quot;request&quot;: {\n    &quot;method&quot;: &quot;POST&quot;,\n    &quot;url&quot;: &quot;Condition&quot;\n  }\n},\n{\n  &quot;fullUrl&quot;: &quot;urn:uuid:5c4ffa26-3806-382f-8a85-f21c2afd4ecf&quot;,\n  &quot;resource&quot;: {\n    &quot;resourceType&quot;: &quot;Encounter&quot;,\n    &quot;id&quot;: &quot;5c4ffa26-3806-382f-8a85-f21c2afd4ecf&quot;,\n    &quot;class&quot;: {\n      &quot;code&quot;: &quot;AMB&quot;,\n      &quot;display&quot;: &quot;ambulatory&quot;,\n      &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/v3-ActCode&quot;\n    },\n    &quot;status&quot;: &quot;finished&quot;,\n    &quot;location&quot;: [\n      {\n        &quot;location&quot;: {\n          &quot;display&quot;: &quot;Hospital &quot;\n        },\n        &quot;status&quot;: &quot;active&quot;\n      }\n    ],\n    &quot;participant&quot;: [\n      {\n        &quot;type&quot;: [\n          {\n            &quot;coding&quot;: [\n              {\n                &quot;code&quot;: &quot;REF&quot;,\n                &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/v3-ParticipationType&quot;,\n                &quot;display&quot;: &quot;referrer&quot;\n              }\n            ]\n          }\n        ],\n        &quot;individual&quot;: {\n          &quot;reference&quot;: &quot;Practitioner?identifier=610732721&quot;\n        }\n      },\n      {\n        &quot;type&quot;: [\n          {\n            &quot;coding&quot;: [\n              {\n                &quot;code&quot;: &quot;CON&quot;,\n                &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/v3-ParticipationType&quot;,\n                &quot;display&quot;: &quot;consultant&quot;\n              }\n            ]\n          }\n        ],\n        &quot;individual&quot;: {\n          &quot;reference&quot;: &quot;Practitioner?identifier=618239221&quot;\n        }\n      }\n    ],\n    &quot;identifier&quot;: [\n      {\n        &quot;type&quot;: {\n          &quot;coding&quot;: [\n            {\n              &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/v2-0203&quot;,\n              &quot;code&quot;: &quot;VN&quot;,\n              &quot;display&quot;: &quot;Visit number&quot;\n            }\n          ]\n        },\n        &quot;system&quot;: &quot;http://hospital/visitID&quot;,\n        &quot;value&quot;: &quot;201927815&quot;\n      }\n    ],\n    &quot;period&quot;: {\n      &quot;start&quot;: &quot;2019-05-09T10:49:00.000Z&quot;,\n      &quot;end&quot;: &quot;2019-12-31T23:59:00.000Z&quot;\n    },\n    &quot;subject&quot;: {\n      &quot;reference&quot;: &quot;Patient/9d1ca0a8-0cee-3747-814d-3ff9907939a9&quot;\n    },\n    &quot;diagnosis&quot;: [\n      {\n        &quot;condition&quot;: {\n          &quot;reference&quot;: &quot;Condition/cbee8c1f-9933-3dd3-b62f-c91b87574cf6&quot;\n        }\n      },\n      {\n        &quot;condition&quot;: {\n          &quot;reference&quot;: &quot;Condition/63fc6ebf-83f3-3d74-b76b-be16557c4e61&quot;\n        }\n      }\n    ]\n  },\n  &quot;request&quot;: {\n    &quot;method&quot;: &quot;PUT&quot;,\n    &quot;url&quot;: &quot;Encounter?identifier=http://hospital/visitID|201927815&quot;\n  }\n},\n{\n  &quot;fullUrl&quot;: &quot;urn:uuid:74110a3b-fc68-35e6-99ec-72e70a266a07&quot;,\n  &quot;resource&quot;: {\n    &quot;resourceType&quot;: &quot;Procedure&quot;,\n    &quot;id&quot;: &quot;74110a3b-fc68-35e6-99ec-72e70a266a07&quot;,\n    &quot;status&quot;: &quot;completed&quot;,\n    &quot;code&quot;: {\n      &quot;coding&quot;: [\n        {\n          &quot;system&quot;: &quot;https://www.dimdi.de&quot;,\n          &quot;code&quot;: &quot;5-984&quot;,\n          &quot;display&quot;: &quot;Mikrochirurgische Technik - Zusatzcode&quot;\n        }\n      ],\n      &quot;text&quot;: &quot;Mikrochirurgische Technik - Zusatzcode&quot;\n    },\n    &quot;performedDateTime&quot;: &quot;2019-06-14T08:22:00.000Z&quot;,\n    &quot;category&quot;: {\n      &quot;coding&quot;: [\n        {\n          &quot;code&quot;: &quot;OP&quot;\n        }\n      ]\n    },\n    &quot;subject&quot;: {\n      &quot;reference&quot;: &quot;Patient/9d1ca0a8-0cee-3747-814d-3ff9907939a9&quot;\n    }\n  },\n  &quot;request&quot;: {\n    &quot;method&quot;: &quot;POST&quot;,\n    &quot;url&quot;: &quot;Procedure&quot;\n  }\n}\n</code></pre></div>\n\n\n<p>]<br>\n}</p>",
        "id": 208703855,
        "sender_full_name": "Sandeep Rathore",
        "timestamp": 1598974022
    },
    {
        "content": "<p>That sounds like something to take up with the author of the server...</p>",
        "id": 208706948,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1598975256
    },
    {
        "content": "<p>Hi Lloyd,<br>\nIt seems mean while patient resource is looking for identifier using conditional put, it  creates another resource from the bundle which contains reference to this patient resource and when this referenced patient is not found then, it creates another resource with this reference id.</p>",
        "id": 208736145,
        "sender_full_name": "Sandeep Rathore",
        "timestamp": 1598988630
    },
    {
        "content": "<p>We don't know what server you are using. There are many different implementations of FHIR.</p>",
        "id": 208736499,
        "sender_full_name": "Paul Church",
        "timestamp": 1598988793
    },
    {
        "content": "<p>I am using Hapi Fhir JPA</p>",
        "id": 208736834,
        "sender_full_name": "Sandeep Rathore",
        "timestamp": 1598988974
    },
    {
        "content": "<p>You may get a faster answer in the <a class=\"stream\" data-stream-id=\"179167\" href=\"/#narrow/stream/179167-hapi\">#hapi</a> stream. Also, if you have your bundle in a file, you may attach it to your post there, as it may be easier to review, compared to pasting it in the post...</p>",
        "id": 208737930,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1598989564
    },
    {
        "content": "<p>Sure, Thanks for suggesting</p>",
        "id": 208738358,
        "sender_full_name": "Sandeep Rathore",
        "timestamp": 1598989771
    }
]