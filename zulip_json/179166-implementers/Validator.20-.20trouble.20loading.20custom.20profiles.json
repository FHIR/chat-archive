[
    {
        "content": "<p>I am using the newest validator from <a href=\"https://build.fhir.org/downloads.html\" target=\"_blank\" title=\"https://build.fhir.org/downloads.html\">https://build.fhir.org/downloads.html</a> and want to validate STU3 resources against custom profiles. Using just the standard validation works fine (here for a file in the directory of the validator)</p>\n<div class=\"codehilite\"><pre><span></span>java -jar org.hl7.fhir.validator.jar -version 3.0.1 ./patient-example.xml\n</pre></div>\n\n\n<p>Then I add a Patient profile (just the <code>StructureDefinition</code> resource as XML, not a full IG) in the sub-directory <em>profiles</em>.  Now I want to the validator to load this profile and validate against it. As a test, suppose that I added the standard Patient resource definition, (<a href=\"https://www.hl7.org/fhir/patient.profile.xml\" target=\"_blank\" title=\"https://www.hl7.org/fhir/patient.profile.xml\">https://www.hl7.org/fhir/patient.profile.xml</a>). So I run</p>\n<div class=\"codehilite\"><pre><span></span>java -jar org.hl7.fhir.validator.jar -version 3.0.1 ./patient-example.xml -ig profiles/ -profile http://hl7.org/fhir/StructureDefinition/Patient\n</pre></div>\n\n\n<p>This gives the following error:</p>\n<div class=\"codehilite\"><pre><span></span>    (v3.0.1-null)\n+  .. load IG from profiles/\nException in thread &quot;main&quot; java.lang.Exception: Error parsing patient.profile.xml: Unknown Content valueSetReference @  START_TAG seen ...escription value=&quot;A human language.&quot;/&gt;\\n        &lt;valueSetReference&gt;... @939:28\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadIg(ValidationEngine.java:670)\n        at org.hl7.fhir.r4.validation.Validator.main(Validator.java:341)\nCaused by: org.hl7.fhir.exceptions.FHIRFormatError: Unknown Content valueSetReference @  START_TAG seen ...escription value=&quot;A human language.&quot;/&gt;\\n        &lt;valueSetReference&gt;... @939:28\n        at org.hl7.fhir.r4.formats.XmlParserBase.unknownContent(XmlParserBase.java:279)\n        at org.hl7.fhir.r4.formats.XmlParser.parseElementDefinitionElementDefinitionBindingComponent(XmlParser.java:1888)\n        at org.hl7.fhir.r4.formats.XmlParser.parseElementDefinitionContent(XmlParser.java:1701)\n        at org.hl7.fhir.r4.formats.XmlParser.parseElementDefinition(XmlParser.java:1626)\n        at org.hl7.fhir.r4.formats.XmlParser.parseStructureDefinitionStructureDefinitionSnapshotComponentContent(XmlParser.java:19497)\n        at org.hl7.fhir.r4.formats.XmlParser.parseStructureDefinitionStructureDefinitionSnapshotComponent(XmlParser.java:19486)\n        at org.hl7.fhir.r4.formats.XmlParser.parseStructureDefinitionContent(XmlParser.java:19418)\n        at org.hl7.fhir.r4.formats.XmlParser.parseStructureDefinition(XmlParser.java:19357)\n        at org.hl7.fhir.r4.formats.XmlParser.parseResource(XmlParser.java:23323)\n        at org.hl7.fhir.r4.formats.XmlParserBase.parse(XmlParserBase.java:105)\n        at org.hl7.fhir.r4.formats.XmlParserBase.parse(XmlParserBase.java:89)\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadIg(ValidationEngine.java:659)\n        ... 1 more\n</pre></div>\n\n\n<p>This error occurs even after removing the <code>-profile</code> parameter, so it seems to be related to the initial loading of the profile. Playing with the <code>-tx</code> and <code>-version</code> parameters does not change anything, either. I tried various different profiles and always see this error (always comaplaining about the same field in the StructureDefinition), yet loading profiles from a directory used to work fine and as far as I could tell from the <a href=\"http://wiki.hl7.org/index.php?title=Using_the_FHIR_Validator\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=Using_the_FHIR_Validator\">validator wiki page</a>, it is still supported. Did anything change or am I just missing something?</p>",
        "id": 153991239,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1535464766
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 153991301,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1535469661
    },
    {
        "content": "<p>the question is why it's reading it as an r4 profile, not an r3 profile. I'll have to have a look tonight</p>",
        "id": 153991431,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1535514700
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - was this resolved (or a workaround found)?</p>",
        "id": 153993430,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1536155360
    },
    {
        "content": "<p>no. sorry. I'll work on it tomorrow</p>",
        "id": 153993441,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1536155655
    },
    {
        "content": "<p>OK, thanks! - using the STU3 validator meanwhile.</p>",
        "id": 153994272,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1536321521
    }
]