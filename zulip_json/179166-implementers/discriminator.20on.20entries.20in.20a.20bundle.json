[
    {
        "content": "<p>I am searching for the right kind of discriminator to slice the entries in a bundle profile.<br>\nLet's say I want to be certain always one Patient and one Practitioner is given as an entry in a bundle:  this means in my instance I would have an entry with &lt;resource&gt;/&lt;Patient&gt; and one with &lt;resource&gt;/&lt;Practitioner&gt; but how do choose the right discriminator for this?</p>",
        "id": 191516317,
        "sender_full_name": "Robin Bosman",
        "timestamp": 1584987984
    },
    {
        "content": "<p>type=type, path=entry.resource</p>",
        "id": 191522886,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1584991105
    },
    {
        "content": "<p>Thank you, that pointed me in the right direction! After some trial &amp; error I ended with type=type and path=resource</p>",
        "id": 191579655,
        "sender_full_name": "Robin Bosman",
        "timestamp": 1585039771
    },
    {
        "content": "<p>Would be the discriminator different when I have two different practitioners in the bundle? One practitioner with meta.profile=A and another with meta.profile=B.</p>",
        "id": 192978850,
        "sender_full_name": "Katarina",
        "timestamp": 1586121662
    },
    {
        "content": "<p>In general you should be cautious about relying on meta.profile - it's poor practice to reject an instance that meets your constraints but doesn't happen to specifically declare it meets them.  That said, slicing based on resolve().meta.profile should work so long as the referenced resources are in the Bundle.</p>",
        "id": 192986154,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1586134233
    },
    {
        "content": "<p>After finding this thread I tried the same with the Bundle profile I'm creating. However, I've encountered a few problems.</p>\n<p>In Forge, there is no path for resource when selecting the descriminator. Tried to solve this by just typing the path instead and it seems to work for the discriminator. Next, I linked the resource to a profile, which was the only way I could figure out how to make sure the slices was of a specific resource type. This doesn't work, in the xml the value for entry.resource.type continues to be only a generic resource. This means that when implementing this with Hapi the validation of the profile fails.</p>\n<p>Is there any other way to do this? I found examples where this seems to work and can't figure out where I go wrong.</p>",
        "id": 202286905,
        "sender_full_name": "Rebecka Hansson",
        "timestamp": 1593421883
    },
    {
        "content": "<p>What exactly are you putting in the discriminator?</p>",
        "id": 202313674,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593439696
    },
    {
        "content": "<p>I am slicing the entry element with Path:resource, Type: type.</p>",
        "id": 202343452,
        "sender_full_name": "Rebecka Hansson",
        "timestamp": 1593451977
    },
    {
        "content": "<p>Try Type: resource.  (There is no 'type' element to check the type of...)</p>",
        "id": 202374065,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593468518
    },
    {
        "content": "<p>I tried that now, it is not possible to select or enter resource as the type in Forge at least.<br>\n<a href=\"/user_uploads/10155/NDmIsLN4G9qm1phy0IJsnCnw/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/NDmIsLN4G9qm1phy0IJsnCnw/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/NDmIsLN4G9qm1phy0IJsnCnw/image.png\"></a></div>",
        "id": 202398371,
        "sender_full_name": "Rebecka Hansson",
        "timestamp": 1593497225
    },
    {
        "content": "<p>The other question is how I set e.g. an Observation as data type for the entry.resource instead of 'Resoucre'. I've seen this in other bundle profiles but can't seem to manage in Forge.<br>\n<a href=\"/user_uploads/10155/aQgBCY5jd1XdyujSIQgRz6gZ/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/aQgBCY5jd1XdyujSIQgRz6gZ/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/aQgBCY5jd1XdyujSIQgRz6gZ/image.png\"></a></div>",
        "id": 202556956,
        "sender_full_name": "Rebecka Hansson",
        "timestamp": 1593602516
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"259036\">@Matthijs van der Wielen</span></p>",
        "id": 202557564,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1593603037
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"309003\">Rebecka Hansson</span> <a href=\"#narrow/stream/179166-implementers/topic/discriminator.20on.20entries.20in.20a.20bundle/near/202398371\">said</a>:</p>\n<blockquote>\n<p>I tried that now, it is not possible to select or enter resource as the type in Forge at least.<br>\n<a href=\"/user_uploads/10155/NDmIsLN4G9qm1phy0IJsnCnw/image.png\">image.png</a></p>\n</blockquote>\n<p>It is possible to do this in Forge, you would have to do this manually as you described. <br>\nIt would end up look something like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;element id=&quot;Bundle.entry&quot;&gt;\n   &lt;path value=&quot;Bundle.entry&quot; /&gt;\n    &lt;slicing&gt;\n       &lt;discriminator&gt;\n          &lt;type value=&quot;type&quot; /&gt;\n          &lt;path value=&quot;resource&quot; /&gt;\n       &lt;/discriminator&gt;\n       &lt;rules value=&quot;open&quot; /&gt;\n    &lt;/slicing&gt;\n    &lt;min value=&quot;2&quot; /&gt;\n&lt;/element&gt;\n</code></pre></div>\n\n\n<p>You could look at <a href=\"https://simplifier.net/NictizSTU3-Zib2017/Nictiz.IHE.MHD.ProvideDocumentBundle.Minimal/~xml\">https://simplifier.net/NictizSTU3-Zib2017/Nictiz.IHE.MHD.ProvideDocumentBundle.Minimal/~xml</a> as an example.</p>",
        "id": 202581235,
        "sender_full_name": "Matthijs van der Wielen",
        "timestamp": 1593616444
    },
    {
        "content": "<p>Yes! :) It works to do it manually. I think my biggest issue is how I get the type on the resource element do be set as observation or clinicalImpression instead of just resource. The fact that I canÂ´t do this causes validation errors. Actually, I want to accomplish how it looks in the example you sent: </p>\n<div class=\"codehilite\"><pre><span></span><code>  &lt;element id=&quot;Bundle.entry:List.resource&quot;&gt;\n            &lt;path value=&quot;Bundle.entry.resource&quot; /&gt;\n            &lt;min value=&quot;1&quot; /&gt;\n            &lt;type&gt;\n                &lt;code value=&quot;List&quot; /&gt;\n                &lt;profile value=&quot;http://nictiz.nl/fhir/StructureDefinition/IHE.MHD.List&quot; /&gt;\n            &lt;/type&gt;\n        &lt;/element&gt;\n</code></pre></div>\n\n\n<p>That code value says something else than resource (List). Currently, my profile looks like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>        &lt;element id=&quot;Bundle.entry:clinicalImpression.resource&quot;&gt;\n            &lt;path value=&quot;Bundle.entry.resource&quot; /&gt;\n            &lt;short value=&quot;ClinicalImpression&quot; /&gt;\n            &lt;min value=&quot;1&quot; /&gt;\n            &lt;type&gt;\n                &lt;code value=&quot;Resource&quot; /&gt;\n                &lt;profile value=&quot;https://fhir.cambio.se/StructureDefinition/ClinicalImpressionTriageRetts/v1&quot; /&gt;\n            &lt;/type&gt;\n</code></pre></div>\n\n\n<p>Is that something I need to do manually as well?</p>",
        "id": 202625334,
        "sender_full_name": "Rebecka Hansson",
        "timestamp": 1593638285
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"259036\">@Matthijs van der Wielen</span>  Do you have an idea of how to solve my last question? :)</p>",
        "id": 202695452,
        "sender_full_name": "Rebecka Hansson",
        "timestamp": 1593700002
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"309003\">@Rebecka Hansson</span> ,<br>\nI might be able to help. If you open a bundle, and slice it as in the Nictiz example, under resource you can select Type(s): <a href=\"/user_uploads/10155/PcI27ETYdpMibVd4N5SjiU_2/image.png\">image.png</a> <br>\nYou can select \"List\" here, or is your case \"Observation\". Is this what you are looking for?</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/PcI27ETYdpMibVd4N5SjiU_2/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/PcI27ETYdpMibVd4N5SjiU_2/image.png\"></a></div>",
        "id": 202776674,
        "sender_full_name": "Matthijs van der Wielen",
        "timestamp": 1593762706
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"259036\">@Matthijs van der Wielen</span> ! Yes that's what I'm looking for. However I see that you're working with Forge for STU3 - in which it looks like you can untick 'Resource'. I can't see where that is possible in Forge for R4. Then it only seems like it is possible to add profiles but not to specify the resource type further than 'Resource'.<br>\n<a href=\"/user_uploads/10155/fM2yqZsMPJ8hXbvy0auZe6lI/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/fM2yqZsMPJ8hXbvy0auZe6lI/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/fM2yqZsMPJ8hXbvy0auZe6lI/image.png\"></a></div>",
        "id": 202776960,
        "sender_full_name": "Rebecka Hansson",
        "timestamp": 1593762967
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"309003\">@Rebecka Hansson</span> , with some help from one of my colleagues I found where you can do this in R4. Although it doesn't seem intuitive, you can specify the resource type by defining a \"profile\" on resource.  Since all other core resources are technically profiles on resource. In the screenshot attached you can see how to define that you can only use \"List\" in this slice. You can add other canonical URLs to define other options, which can be core resources or local profiles.<br>\n<a href=\"/user_uploads/10155/vIYoGTxsZT9qZmCBfQ-mVc37/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/vIYoGTxsZT9qZmCBfQ-mVc37/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/vIYoGTxsZT9qZmCBfQ-mVc37/image.png\"></a></div>",
        "id": 203483728,
        "sender_full_name": "Matthijs van der Wielen",
        "timestamp": 1594371252
    }
]