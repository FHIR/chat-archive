[
    {
        "content": "<p>Hi all, </p>\n<p>I can't seem to figure out how to search for a specific bundle.<br>\nThe bundles are received and they are of the document type.<br>\nFor example the bundle contains:<br>\na composition, which has an identifier with system: &lt;SystemUrl&gt; and value: &lt;123&gt;</p>\n<p>Is there a way to search for bundles that have a composition with an identifier that has those values?</p>",
        "id": 166270389,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558533958
    },
    {
        "content": "<p>Bundles are not persisted. It is possible that an import action chooses to archive the Bundle. It would then tend to do this with a DocumentReference or Provenance to a Binary, where the Binary holds the Bundle as it was received.  See <a href=\"http://build.fhir.org/provenance.html#6.3.5.5\" target=\"_blank\" title=\"http://build.fhir.org/provenance.html#6.3.5.5\">http://build.fhir.org/provenance.html#6.3.5.5</a></p>",
        "id": 166271203,
        "sender_full_name": "John Moehrke",
        "timestamp": 1558534407
    },
    {
        "content": "<p>There's Bundle?composition.identifier, but note that the composition has to be the first entry in the document bundle (the composition search parameter is Bundle.entry[0].resource).</p>",
        "id": 166272391,
        "sender_full_name": "Paul Church",
        "timestamp": 1558535106
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> It's not true that Bundles aren't persisted.  If you POST a document or message Bundle to the Bundle endpoint, it will <em>absolutely</em> be persisted there.  And you can search the Bundle endpoint using chaining to filter based on the search parameters in Composition or MessageHeader.  E.g. Bundle?composition.message=123 or Bundle?composition.type=ABC</p>",
        "id": 166273850,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1558535932
    },
    {
        "content": "<p>Bundle?composition.identifier=&lt;systemUrl&gt;|123</p>",
        "id": 166274135,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1558536046
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> (or anyone else :) ) I have tried this and for some reason it will not yield any results.<br>\nBundle?composition.identifier=http://zorgdomein.nl/zdnumber/|ZP10002970 wont return anything even though there is a result for it (or rather, there should be)<br>\nSo I have tried searching for:<br>\nBundle?composition.title=ZP10002970 <br>\nand<br>\nBundle?composition.title:contains=ZP10002970<br>\nWhich will also give no results.<br>\nAny ideas?</p>",
        "id": 166434830,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558688555
    },
    {
        "content": "<p>Have you verified whether the server you're using supports those parameters?</p>",
        "id": 166437609,
        "sender_full_name": "René Spronk",
        "timestamp": 1558691337
    },
    {
        "content": "<p>The server im using has very little documentation available but seeing issues on the github repository and an answer on StackOverflow would indicate that it should allow chained searching</p>\n<p>Edit: Im using Spark, if that helps</p>",
        "id": 166437775,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558691477
    },
    {
        "content": "<p>Have you inspected it's capability statement? That should tell you what parameters it supports for Bundle as well as Composition.</p>",
        "id": 166439891,
        "sender_full_name": "René Spronk",
        "timestamp": 1558693700
    },
    {
        "content": "<p>The capabilityStament doesnt seem to exist, but google led me to the endpoint/metadata which shows it supports Composition as search parameter for bundles, and it does support identifier for composition aswell</p>",
        "id": 166441199,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558695139
    },
    {
        "content": "<p>In that case: your query looks OK to me, and it doesn't work as expected. Does it simply return an empty bundle, or is there an OperationOutcome ?</p>",
        "id": 166441926,
        "sender_full_name": "René Spronk",
        "timestamp": 1558695942
    },
    {
        "content": "<p>It returns an empty searchset.</p>",
        "id": 166442036,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558696041
    },
    {
        "content": "<p>Bundle/5 shows exactly what im looking for in the composition but the search doesnt seem to pick it up</p>",
        "id": 166442161,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558696177
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/g6fuK6Ewx2AYhCs9KmNUrQky/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/g6fuK6Ewx2AYhCs9KmNUrQky/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/g6fuK6Ewx2AYhCs9KmNUrQky/pasted_image.png\"></a></div>",
        "id": 166442235,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558696223
    },
    {
        "content": "<p>Found the cause of the problem.<br>\nSpark runs on MongoDb, it contains a table searchindex, this contains all searchfields for each individual resource. <br>\nSo for each patient, for each bundle, for each organization it shows the searchfields and the values that goes with it.<br>\nIt would appear that the fields for composition are not added for bundles of type document as you would expect.</p>\n<p>Going to look for a solution now, if anyone with Spark experience has an idea on how to fix this please let me know :)</p>",
        "id": 166456062,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558707054
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"218580\">@Teun Pronk</span> Are you developing a server or client? First I thought you are working on a client solution. In that case, you can only cross your fingers and hope the server supports that one day. If you are working on a server solution, you need to figure out your own way to provide this search capabilities.</p>",
        "id": 166464744,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1558712912
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> we work on both, that said.. we arent making our own server, we use Spark which is an open source solution.</p>",
        "id": 166610265,
        "sender_full_name": "Teun Pronk",
        "timestamp": 1558936080
    }
]