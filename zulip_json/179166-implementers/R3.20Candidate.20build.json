[
    {
        "content": "<p>If you maintain a reference implementation or other code built from off the FHIR definitions, then the next 5 days is the best time for you to do QA of the candidate build - the only reason for substantiative changes from the current build to the full R3 (other than stated version) is qa feedback from code generators. </p>\n<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> <span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> @<strong>nicola (RIO)</strong> <span class=\"user-mention\" data-user-id=\"192232\">@Rick Freeman</span> <span class=\"user-mention\" data-user-id=\"191339\">@Pascal Pfiffner</span> <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span> </p>\n<p>Note that the last change I will make when publishing R3 is the stated version: R3 will be 2.0.0</p>",
        "id": 153872938,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487673849
    },
    {
        "content": "<p>that list of names is those that i think/can remember have generated code at one time or another</p>",
        "id": 153872939,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487673895
    },
    {
        "content": "<p>Adding <span class=\"user-mention\" data-user-id=\"191414\">@Dan Gottlieb</span> (maintains FRED, the resource editor) </p>",
        "id": 153872942,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1487680899
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Would this have any effect on your terminology server?  I'm trying to build an IG using the Jan 2017 ballot version of FHIR (and the igpublisher.jar from it) -- and its connection with the terminology server seems to be broken since last night...</p>",
        "id": 153872945,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1487683695
    },
    {
        "content": "<p>Nevermind.  Seems to be working again.  I bet I was trying to use it last night when you had the server down to upgrade it (around 1:30-2:30am EST).</p>",
        "id": 153872947,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1487684585
    },
    {
        "content": "<p>Y. But some data elements have been reordered in XML as of last night</p>",
        "id": 153872994,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487712396
    },
    {
        "content": "<p>Thank you, we will try new release</p>",
        "id": 153873000,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1487713872
    },
    {
        "content": "<p>We are not generating code from the definitions, but automatically configuring our server by parsing a capability statement and the FHIR definitions. Although not specific to the R3 candidate build, I have a comment regarding xpath expressions of composite search parameters. I could not find any similar discussion in zulip or forge. </p>\n<p>We are dynamically generating search parameters and relevant db indices by parsing the search parameter definitions, specifically the xpaths. The problem is, xpaths of composite search parameters include <strong>always</strong> all the paths for all possible types, although the verbal description and FHIRpath expression are limited to the relevant types in scope. It would be easier for me to explain with an example: Consider the onset search parameters of Condition; i.e. onset-age, onset-date, onset-info:</p>\n<div class=\"codehilite\"><pre>        <span class=\"s2\">&quot;code&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;onset-age&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;type&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;quantity&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;description&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;Onsets as age or age range&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;expression&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;Condition.onset.as(Quantity) | Condition.onset.as(Range)&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;xpath&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;f:Condition/f:onsetDateTime | f:Condition/f:onsetAge | f:Condition/f:onsetPeriod | f:Condition/f:onsetRange | f:Condition/f:onsetString&quot;</span><span class=\"err\">,</span>\n\n        <span class=\"s2\">&quot;code&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;onset-date&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;type&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;date&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;description&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;Date related onsets (dateTime and Period)&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;expression&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;Condition.onset.as(dateTime) | Condition.onset.as(Period)&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;xpath&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;f:Condition/f:onsetDateTime | f:Condition/f:onsetAge | f:Condition/f:onsetPeriod | f:Condition/f:onsetRange | f:Condition/f:onsetString&quot;</span><span class=\"err\">,</span>\n\n        <span class=\"s2\">&quot;code&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;onset-info&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;type&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;string&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;description&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;Onsets as a string&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;expression&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;Condition.onset.as(string)&quot;</span><span class=\"err\">,</span>\n        <span class=\"s2\">&quot;xpath&quot;</span><span class=\"err\">:</span> <span class=\"s2\">&quot;f:Condition/f:onsetDateTime | f:Condition/f:onsetAge | f:Condition/f:onsetPeriod | f:Condition/f:onsetRange | f:Condition/f:onsetString&quot;</span><span class=\"err\">,</span>\n</pre></div>\n\n\n<p>I would really appreciate if xpaths are also appropriately restricted to the relevant type(s), just like FHIRpath expressions. We observe the same issue in DSTU2 as well, and there FHIRpath cannot help either.</p>",
        "id": 153873027,
        "sender_full_name": "Mustafa Yuksel",
        "timestamp": 1487762244
    },
    {
        "content": "<p>Thanks for the heads-up Grahame! Does generate well on my end. Is your server up-to-date? It does not return a valid capability statement (missing \"kind\" and missing \"interaction\" in \"rest[78]\"). Also, <code>meta</code> is missing when requesting a summary (I realize marking it _SUBSETTED_ is a _should_ and not a must).</p>",
        "id": 153873139,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1487860861
    },
    {
        "content": "<p>It seems however we are in violation of <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=5582&amp;start=0\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=5582&amp;start=0\">#5582</a> in quite some resources by making elements a minOccurs of 1 but not part of a summary. I'm assuming this is known and tolerated?</p>",
        "id": 153873140,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1487861747
    },
    {
        "content": "<p>I thought we had a hard rule in the tool that elements with minOccurs = 1 had to be in the summary. what's an example?</p>",
        "id": 153873284,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487963571
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192507\">@Mustafa Yuksel</span> I will add this to my list; but I don't know whether I will get to it for R3. Unless you want to provide correct XPath statements... that would help</p>",
        "id": 153873285,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487963623
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I cannot promise either due current work load, but I will try. I guess the easiest would be to generate from the FHIRpaths. When would be the hard deadline to make this part of R3?</p>",
        "id": 153873727,
        "sender_full_name": "Mustafa Yuksel",
        "timestamp": 1488180111
    },
    {
        "content": "<p>next 2 weeks</p>",
        "id": 153873730,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488185928
    },
    {
        "content": "<p>at the moment, xpath statements are hand-written. </p>",
        "id": 153873731,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488185957
    },
    {
        "content": "<p>First example is <code>Account.guarantor.party</code>: <a href=\"http://build.fhir.org/account.html\" target=\"_blank\" title=\"http://build.fhir.org/account.html\">http://build.fhir.org/account.html</a></p>",
        "id": 153873732,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186001
    },
    {
        "content": "<p>Maybe the rule only applies to top-level properties?</p>",
        "id": 153873733,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186057
    },
    {
        "content": "<p>of course. If guarantor is not in the summary, then none of it's children will be either</p>",
        "id": 153873735,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488186135
    },
    {
        "content": "<p>But if it is, and a summary is requested, then \"party\" will not be there. This is expected?</p>",
        "id": 153873736,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186180
    },
    {
        "content": "<p>(I mean \"if it is present\")</p>",
        "id": 153873737,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186200
    },
    {
        "content": "<p>since guarantor is not in the summary, it's irrelevant whether party is labelled to be in the summary or not</p>",
        "id": 153873738,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488186231
    },
    {
        "content": "<p>Ah, of course. But I keep hitting this situation in capability statement, let me check...</p>",
        "id": 153873739,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186279
    },
    {
        "content": "<p><code>CapabilityStatement.rest.resource.interaction</code></p>\n<p><code>CapabilityStatement.rest.resource</code> is part of the summary, and <code>CapabilityStatement.rest.resource.interaction</code> has minOccurs=1 but is not part of the summary.</p>",
        "id": 153873740,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186413
    },
    {
        "content": "<p>Same with <code>CapabilityStatement.rest.operation.name</code>.</p>",
        "id": 153873741,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186691
    },
    {
        "content": "<p>And <code>CapabilityStatement.messaging.event.(mode|focus)</code> and <code>CapabilityStatement.document.code</code>.</p>",
        "id": 153873742,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488186807
    },
    {
        "content": "<p>The build of the .net client is now working, so I'm running it through its paces on your server today <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  Will let you know if I find anything new.</p>",
        "id": 153873924,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1488243113
    },
    {
        "content": "<p>ok thanks</p>",
        "id": 153873925,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488243181
    },
    {
        "content": "<p>Wow.....Claim.payee.resourceType is a trouble maker. Why would we allow an element with the same name as a \"magic\" property in json?</p>",
        "id": 153873980,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488272407
    },
    {
        "content": "<p>Sure I can add something smart to the parser, but everyone building a parser has to account for this. Feels like changing the name is easier. In the mean time I'll look at what I can do in the .NET json parser...</p>",
        "id": 153873981,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488272487
    },
    {
        "content": "<p>Wow, hadn't noticed Claim.payee.resourceType. No trouble with our parser and models but that <strong>is</strong> confusing.</p>",
        "id": 153873985,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488274599
    },
    {
        "content": "<p>What are thoughts on the minOccurs/isSummary issue in things like <code>CapabilityStatement.rest.resource.interaction</code>?</p>",
        "id": 153873986,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488274616
    },
    {
        "content": "<p>We certainly could use a different name which is non colliding for X.payee.resourceType. We could change it to X.payee.resource</p>",
        "id": 153873987,
        "sender_full_name": "Paul Knapp",
        "timestamp": 1488274831
    },
    {
        "content": "<p>Another issue, I get a compile error in our snapshot generator because  ElementDefinition.min is now unsignedInt, but ElementDefinition.base.min is still integer.  I am pretty sure we want these to align.   See <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12918\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12918\">GF#12918</a></p>",
        "id": 153873990,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488276655
    },
    {
        "content": "<p>Paul, that would be really helpful</p>",
        "id": 153873991,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488277282
    },
    {
        "content": "<p>you can propose a task to change it and make it illegal, but for now, you have to fix the parser</p>",
        "id": 153873993,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488278895
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191430\">@Paul Knapp</span> if you want to change the name, FMG has to approve it now. <br>\n<span class=\"user-mention\" data-user-id=\"191339\">@Pascal Pfiffner</span> the capability statement stuff I need to fix as part of QA<br>\n<span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> should we see if we can change the type of ElementDefinition.base.min type immediately?</p>",
        "id": 153873995,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488279074
    },
    {
        "content": "<p>So 2 tasks: 1) Change payee.resourceType to payee.resource in Claim and EOB, 2) Propose that magic element names NOT be allowed for element name at any level of the resource (and maybe tooling will check and error when time permits.)</p>",
        "id": 153873997,
        "sender_full_name": "Paul Knapp",
        "timestamp": 1488279199
    },
    {
        "content": "<p>I have a list of 215 minOccurs/isSummary discrepancies, will see which are of the Account.guarantor.party non-issue type and which are conflicting.</p>",
        "id": 153873998,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488279247
    },
    {
        "content": "<p>I can raise with FMG tomorrow, also while discussion with Brian P saw that the binding strength is not aligned, so could ask to fix that too.</p>",
        "id": 153873999,
        "sender_full_name": "Paul Knapp",
        "timestamp": 1488279247
    },
    {
        "content": "<p>there's obviously something wrong with my algorithm - it's supposed to disallow that</p>",
        "id": 153874000,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488279327
    },
    {
        "content": "<p>as in your tooling was already supposed to catch magic/reserved element names? or are you talking to Pascal?</p>",
        "id": 153874003,
        "sender_full_name": "Paul Knapp",
        "timestamp": 1488279436
    },
    {
        "content": "<p>talking to Pascal. my tooling does catch other reserved words, just not that one (well, that one has not been reserved, because no one ever used it before)</p>",
        "id": 153874006,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488279840
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - yes, I'd prefer to, otherwise I'd just be hacking work-arounds that I will have to remove later on....</p>",
        "id": 153874008,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488282957
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> here's a list of elements with <code>n_min &gt; 0</code> whose parent element <code>isSummary = true</code> but the element itself is <strong>not</strong> part of the summary.</p>\n<div class=\"codehilite\"><pre><span></span>CapabilityStatement.rest.resource.interaction\nCapabilityStatement.rest.operation.name\nCapabilityStatement.messaging.event.mode\nCapabilityStatement.messaging.event.focus\nCapabilityStatement.document.mode\n\nConsent.actor.role\nConsent.actor.reference\nConsent.except.actor.role\nConsent.except.actor.reference\n\nEncounter.diagnosis.condition\n\nObservation.related.target\n\nQuestionnaire.item.enableWhen.question\n</pre></div>\n\n\n<p>I am not sure about questionnaire. <code>Questionnaire.item</code> is <strong>not</strong> part of the summary but <code>Questionnaire.item.enableWhen</code> is. Not sure how that is expected to behave.</p>",
        "id": 153874035,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488295784
    },
    {
        "content": "<p>Not sure this is also a tooling issue: these 3 value sets are part of a required binding it at least one resource but are missing from <code>valuesets.json</code>:</p>\n<div class=\"codehilite\"><pre>http://hl7.org/fhir/ValueSet/v3-ActIncidentCode\nhttp://hl7.org/fhir/ValueSet/v3-ActInvoiceGroupCode\nhttp://hl7.org/fhir/ValueSet/v3-ConfidentialityClassification\n</pre></div>",
        "id": 153874036,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1488296354
    },
    {
        "content": "<p>I found that certain extensions in the build, like the file 'extension-us-core-race.xml' still uses an older format of StructureDefinition: in this file the discriminator is still a single primitive string....</p>",
        "id": 153874049,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488300694
    },
    {
        "content": "<p>mmm.  extension-us-core-race.xml should be out of the build.  It was moved to US Core</p>",
        "id": 153874050,
        "sender_full_name": "Eric Haas",
        "timestamp": 1488300881
    },
    {
        "content": "<p>I didn't remove it completely - didn't realize that it was still generating the sd files</p>",
        "id": 153874052,
        "sender_full_name": "Eric Haas",
        "timestamp": 1488301404
    },
    {
        "content": "<p>and the us patient example is still there too - in the publish file?</p>",
        "id": 153874053,
        "sender_full_name": "Eric Haas",
        "timestamp": 1488301815
    },
    {
        "content": "<p>does that mean deprecated structures and  examples  (marked with !) in the source spreadsheets are being validated by toolsmiths?</p>",
        "id": 153874056,
        "sender_full_name": "Eric Haas",
        "timestamp": 1488302932
    },
    {
        "content": "<p>us state code should move out of core too?</p>",
        "id": 153874067,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1488306076
    },
    {
        "content": "<p>There is lot of content in the build that is US specific but waiting for the registries.....</p>",
        "id": 153874072,
        "sender_full_name": "Eric Haas",
        "timestamp": 1488307811
    },
    {
        "content": "<p>Why would registries affect whether it's published in US Core vs. FHIR Core?</p>",
        "id": 153874078,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1488308238
    },
    {
        "content": "<p>well us state codes are not needed in US-Core right now since we don'd constrain address so this would be informational only.  Better to have a  searchable registry for US codesystems, valuesets, Identifier systems than to stick US-Core.  Don't you think?</p>",
        "id": 153874082,
        "sender_full_name": "Eric Haas",
        "timestamp": 1488308557
    },
    {
        "content": "<p>why are we stil generating the sd files? In fact, given that their format is wrong, I don't think we are still generating them. if you found them in your local copy, you need to clearn that out occasionally</p>",
        "id": 153874162,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488334265
    },
    {
        "content": "<p>Well, I copy *all* files with the name extension-*.xml that are in the publish directory into our unit-tests. Maybe I should not do that then ;-)</p>",
        "id": 153874213,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488357941
    },
    {
        "content": "<p>US state codes aren't just used by the US Realm.</p>",
        "id": 153874217,
        "sender_full_name": "Paul Knapp",
        "timestamp": 1488360486
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  Ah, yes, cleaning out the build worked.</p>",
        "id": 153874228,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488379837
    },
    {
        "content": "<p>Grahame, what's in ElementDefinition.constraint.source?  Sometimes it seems to be the name of the resource/datatype where the constraint originated, sometimes it's an *id* of an element (or it looks like that):         </p>\n<p><code>&lt;source value=\"Observation:vitalsignsprofile\"/&gt;</code></p>",
        "id": 153874229,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488379909
    },
    {
        "content": "<p>Found this in <code>&lt;url value=\"http://hl7.org/fhir/StructureDefinition/bodyweight\"/&gt;</code></p>",
        "id": 153874230,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488379971
    },
    {
        "content": "<p>I have done a comparison of snapshots generated by the .NET and the Java stack.  The good news: I don't think we've ever been this close. The bad news: there are still differences, and some of them remind me of late thursday night discussions during WGMs. </p>",
        "id": 153874232,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488381449
    },
    {
        "content": "<p>To find out more, I have detailed the differences here: <a href=\"https://gist.github.com/ewoutkramer/f10e36a51747759f7cca5d54e9cd44e6\" target=\"_blank\" title=\"https://gist.github.com/ewoutkramer/f10e36a51747759f7cca5d54e9cd44e6\">https://gist.github.com/ewoutkramer/f10e36a51747759f7cca5d54e9cd44e6</a></p>",
        "id": 153874233,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488381478
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span>  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191351\">@Chris Grenz</span>  I hope you find this comparison useful.</p>",
        "id": 153874234,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488381533
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> Excellent - I agree with your conclusions.  The inclusion of base constraint is probably the only remaining point of contention.  It's interesting that your example here includes the <code>Observation:vitalsignsprofile</code> id - this is an example of a root element having a <code>sliceName</code> that shouldn't (I think) be allowed.  We need a constriant that disallows <code>sliceName</code> without <code>slicing</code>. <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12849\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12849\">GF#12849</a> addresses this and is deferred...this is and will be an issue for DSTU3 publication that will be very confusing for US-Core (and other) implementers</p>",
        "id": 153874244,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1488384104
    },
    {
        "content": "<p>I agree, that's the only point of contention left....which means we're in a pretty good position ;-)</p>",
        "id": 153874245,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488384183
    },
    {
        "content": "<p>Note that in Grahame's id generation, the id is considered to be opaque ;-)  So this is probably not meant to indicate a slicename (there is no explicit &lt;sliceName&gt; element here), i think Grahame uses a lower-cased profile id (from the StructureDefinition.url) to generate unique ids here....</p>",
        "id": 153874246,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488384365
    },
    {
        "content": "<p>I see that <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12259\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12259\">GF#12259</a> \"missed the boat\" - concerned that this leaves the behavior unclear for type slices</p>",
        "id": 153874247,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1488384369
    },
    {
        "content": "<p><a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12259\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12259\">GF#12259</a></p>",
        "id": 153874248,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488384386
    },
    {
        "content": "<p>The id is opaque? I thought it was required to be of the agreed upon format?</p>",
        "id": 153874249,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1488384431
    },
    {
        "content": "<p>Yes, that's too bad - then again there's only so much even GG can do before a deadline.....</p>",
        "id": 153874250,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488384470
    },
    {
        "content": "<p>Totally understand...would like to at least give some kind of guidance....</p>",
        "id": 153874251,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1488384493
    },
    {
        "content": "<p>Mustn't the id be <code>TypeName.element:sliceName/resliceName.element</code>...etc?</p>",
        "id": 153874252,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1488384543
    },
    {
        "content": "<p>Hehehe, I already said that many of the differences I found remind me of late-thurday-night  discussions ;-)</p>",
        "id": 153874253,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488384550
    },
    {
        "content": "<p>I do remember this was considered a useful format, but not something you can depend on.....</p>",
        "id": 153874255,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488384592
    },
    {
        "content": "<p>Maybe we should open up another topic about \"R3 Candidate build - SD differences\"  to not pollute this thread too much here.</p>",
        "id": 153874256,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1488384639
    },
    {
        "content": "<p>the root element id of a profile must have something in the name, so that the id does not clash with the id of the element it is a profile of </p>",
        "id": 153874268,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488395801
    },
    {
        "content": "<p>I finally found some time this weekend to work on xpath statement correction. I worked on the latest build, with lastUpdated time of \"2017-03-04T01:00:52.026+00:00\". I filtered with a simple xslt all the SearchParameters that have ORed xpath statements, which turned out to be 73 in total. Then I manually checked all; only a small portion (8 out of 73) have problems. </p>\n<p>Below, I present those SearchParameters with the current fhirpaths, xpaths and with my updates. New xpaths are available in the <code>xpathNew</code> element. I updated 2 fhirpath statements as well, due to age vs. quantity inconsistencies. These are available in the <code>expressionNew</code> element.</p>\n<div class=\"codehilite\"><pre>    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/ClinicalImpression-finding-code&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;token&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;ClinicalImpression.finding.item.as(CodeableConcept)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:ClinicalImpression/f:finding/f:itemCodeableConcept | f:ClinicalImpression/f:finding/f:itemReference&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:ClinicalImpression/f:finding/f:itemCodeableConcept&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/ClinicalImpression-finding-ref&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;reference&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;ClinicalImpression.finding.item.as(Reference)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:ClinicalImpression/f:finding/f:itemCodeableConcept | f:ClinicalImpression/f:finding/f:itemReference&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:ClinicalImpression/f:finding/f:itemReference&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/Condition-abatement-age&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;quantity&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.abatement.as(Quantity) | Condition.abatement.as(Range) | Condition.abatement.as(Age)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:abatementDateTime | f:Condition/f:abatementAge | f:Condition/f:abatementBoolean | f:Condition/f:abatementPeriod | f:Condition/f:abatementRange | f:Condition/f:abatementString&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expressionNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.abatement.as(Range) | Condition.abatement.as(Age)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:abatementAge | f:Condition/f:abatementRange&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/Condition-abatement-date&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;date&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.abatement.as(dateTime) | Condition.abatement.as(Period)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:abatementDateTime | f:Condition/f:abatementAge | f:Condition/f:abatementBoolean | f:Condition/f:abatementPeriod | f:Condition/f:abatementRange | f:Condition/f:abatementString&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:abatementDateTime | f:Condition/f:abatementPeriod&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/Condition-abatement-string&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;string&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.abatement.as(string)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:abatementDateTime | f:Condition/f:abatementAge | f:Condition/f:abatementBoolean | f:Condition/f:abatementPeriod | f:Condition/f:abatementRange | f:Condition/f:abatementString&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:abatementString&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/Condition-onset-age&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;quantity&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.onset.as(Quantity) | Condition.onset.as(Range)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:onsetDateTime | f:Condition/f:onsetAge | f:Condition/f:onsetPeriod | f:Condition/f:onsetRange | f:Condition/f:onsetString&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expressionNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.onset.as(Age) | Condition.onset.as(Range)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:onsetAge | f:Condition/f:onsetRange&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/Condition-onset-date&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;date&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.onset.as(dateTime) | Condition.onset.as(Period)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:onsetDateTime | f:Condition/f:onsetAge | f:Condition/f:onsetPeriod | f:Condition/f:onsetRange | f:Condition/f:onsetString&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:onsetDateTime | f:Condition/f:onsetPeriod&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n    <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/Condition-onset-info&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;string&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Condition.onset.as(string)&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:onsetDateTime | f:Condition/f:onsetAge | f:Condition/f:onsetPeriod | f:Condition/f:onsetRange | f:Condition/f:onsetString&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpathNew</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:Condition/f:onsetString&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n</pre></div>",
        "id": 153874810,
        "sender_full_name": "Mustafa Yuksel",
        "timestamp": 1488747235
    },
    {
        "content": "<p>In addition, I noticed that the last 2 SearchParameters, which are I guess the only ones in the whole set defined on an extension, contain the same xpath statement twice (i.e. duplicate entry), and they also do not have a fhirpath expression:</p>\n<div class=\"codehilite\"><pre>      <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/elementdefinition-11179-DataElement-objectClass&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;token&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:DataElement/f:element/f:mapping/f:extension[@url=&amp;#39;http://hl7.org/fhir/StructureDefinition/11179-objectClass&amp;#39;] | f:DataElement/f:element/f:mapping/f:extension[@url=&amp;#39;http://hl7.org/fhir/StructureDefinition/11179-objectClass&amp;#39;]&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n\n      <span class=\"nt\">&lt;SearchParameter&gt;</span>\n        <span class=\"nt\">&lt;url</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://hl7.org/fhir/SearchParameter/elementdefinition-11179-DataElement-objectClassProperty&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;token&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;xpath</span> <span class=\"na\">value=</span><span class=\"s\">&quot;f:DataElement/f:element/f:mapping/f:extension[@url=&amp;#39;http://hl7.org/fhir/StructureDefinition/11179-objectClassProperty&amp;#39;] | f:DataElement/f:element/f:mapping/f:extension[@url=&amp;#39;http://hl7.org/fhir/StructureDefinition/11179-objectClassProperty&amp;#39;]&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/SearchParameter&gt;</span>\n</pre></div>",
        "id": 153874812,
        "sender_full_name": "Mustafa Yuksel",
        "timestamp": 1488748026
    },
    {
        "content": "<p>ok thanks. I'll work through these soon</p>",
        "id": 153874824,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488753543
    },
    {
        "content": "<p>fixed</p>",
        "id": 153874899,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1488783003
    },
    {
        "content": "<p><img alt=\":+1:\" class=\"emoji\" src=\"/static/third/gemoji/images/emoji/+1.png\" title=\":+1:\"> </p>",
        "id": 153875005,
        "sender_full_name": "Mustafa Yuksel",
        "timestamp": 1488813054
    },
    {
        "content": "<p>I found this in some DSTU2 invariants in profiles-others:</p>\n<p>extension(%ext-11179-permitted-value-valueset).count()</p>\n<p>These are incorrect, since accoding to the FhirPath spec, the external variable reference should be an id, and cannot contain \"-\", hence this should be written as  </p>\n<p>extension(%\"ext-11179-permitted-andso-on\")</p>\n<p>I don't know whether these definitions have moved somewhere else (in STU3 they are no longer in profiles-others), but this could be a common mistake still found in STU3.</p>",
        "id": 153875757,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1489071190
    },
    {
        "content": "<p>not a possible error in STU3</p>",
        "id": 153875829,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489086892
    }
]