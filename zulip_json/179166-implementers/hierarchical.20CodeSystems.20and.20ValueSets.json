[
    {
        "content": "<p>hi everybody,</p>\n<p>I have a question regarding hierarchical codesystems.<br>\nI'm curretly converting an existing terminology to a FHIR one.<br>\nfor the moment I have something like :</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;CodeSystem&quot;,\n  &quot;id&quot;: &quot;someid&quot;,\n  &quot;language&quot;: &quot;en&quot;,\n  &quot;url&quot;: &quot;http://terminology.hl7.org/CodeSystem/something&quot;,\n  &quot;identifier&quot;: [\n    {\n      &quot;system&quot;: &quot;urn:ietf:rfc:3986&quot;,\n      &quot;value&quot;: &quot;urn:oid:1111&quot;\n    }\n   ],\n  &quot;valueSet&quot;: &quot;http://terminology.hl7.org/CodeSystem/someide/vs&quot;,\n  &quot;name&quot;: &quot;somename&quot;,\n  &quot;title&quot;: &quot;sometitle&quot;,\n  &quot;status&quot;: &quot;draft&quot;,\n  &quot;experimental&quot;: false,\n  &quot;hierarchyMeaning&quot;: &quot;is-a&quot;,\n  &quot;content&quot;: &quot;complete&quot;,\n  &quot;count&quot;: 110212,\n  &quot;property&quot;: [\n    {\n      &quot;code&quot;: &quot;active&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;abbreviation&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;meddra_code&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    }\n  ],\n  &quot;concept&quot;: [\n    {\n      &quot;code&quot;: &quot;soc_10005329&quot;,\n      &quot;display&quot;: &quot;Blood and lymphatic system disorders&quot;,\n      &quot;property&quot;: [\n        {\n          &quot;code&quot;: &quot;meddra_code&quot;,\n          &quot;valueCode&quot;: &quot;10005329&quot;\n        },\n        {\n          &quot;code&quot;: &quot;abbreviation&quot;,\n          &quot;valueCode&quot;: &quot;Blood&quot;\n        },\n        {\n          &quot;code&quot;: &quot;child&quot;,\n          &quot;valueCode&quot;: &quot;hlgt_10002086&quot;\n        }\n      ]\n    }\n ]\n}\n</code></pre></div>\n<p>the CodeSystem is imported correctly in HAPI. <br>\nThe issue  I'm facing is that I don't know how to create a ValueSet from it to be able to <br>\nperform queries on it, like what are the codes with text or what are the elements without<br>\na parent.<br>\nThing I don't know is should I create the ValueSet ? If yes, how can it represent the parent/child<br>\nrelationship ?<br>\nThanks</p>",
        "id": 234877438,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618588227
    },
    {
        "content": "<p>I'm not seeing any hierarchy in what you've shared?  <a href=\"https://build.fhir.org/valueset-filter-operator.html\">https://build.fhir.org/valueset-filter-operator.html</a> lets you define value sets based on hierarchical relationships.</p>",
        "id": 234882296,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618589953
    },
    {
        "content": "<p>thank you, still trying to figure how it works. so it should be something like :</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;CodeSystem&quot;,\n  &quot;id&quot;: &quot;someid&quot;,\n  &quot;language&quot;: &quot;en&quot;,\n  &quot;url&quot;: &quot;http://terminology.hl7.org/CodeSystem/something&quot;,\n  &quot;identifier&quot;: [\n    {\n      &quot;system&quot;: &quot;urn:ietf:rfc:3986&quot;,\n      &quot;value&quot;: &quot;urn:oid:1111&quot;\n    }\n   ],\n  &quot;valueSet&quot;: &quot;http://terminology.hl7.org/CodeSystem/someide/vs&quot;,\n  &quot;name&quot;: &quot;somename&quot;,\n  &quot;title&quot;: &quot;sometitle&quot;,\n  &quot;status&quot;: &quot;draft&quot;,\n  &quot;experimental&quot;: false,\n  &quot;hierarchyMeaning&quot;: &quot;is-a&quot;,\n  &quot;content&quot;: &quot;complete&quot;,\n  &quot;count&quot;: 110212,\n      &quot;filter&quot;: [\n        {\n            &quot;code&quot;: &quot;parent&quot;,\n            &quot;operator&quot;: [\n                &quot;=&quot;\n            ],\n            &quot;value&quot;: &quot;A Part code&quot;\n        },\n        {\n            &quot;code&quot;: &quot;child&quot;,\n            &quot;operator&quot;: [\n                &quot;=&quot;\n            ],\n            &quot;value&quot;: &quot;Child codes&quot;\n        },\n    ],\n  &quot;property&quot;: [\n    {\n      &quot;code&quot;: &quot;active&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;abbreviation&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;meddra_code&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    }\n  ],\n  &quot;concept&quot;: [\n    {\n      &quot;code&quot;: &quot;soc_10005329&quot;,\n      &quot;display&quot;: &quot;Blood and lymphatic system disorders&quot;,\n      &quot;property&quot;: [\n        {\n          &quot;code&quot;: &quot;meddra_code&quot;,\n          &quot;valueCode&quot;: &quot;10005329&quot;\n        },\n        {\n          &quot;code&quot;: &quot;abbreviation&quot;,\n          &quot;valueCode&quot;: &quot;Blood&quot;\n        },\n        {\n          &quot;code&quot;: &quot;child&quot;,\n          &quot;valueCode&quot;: &quot;hlgt_10002086&quot;\n        }\n      ]\n    }\n ]\n}\n</code></pre></div>",
        "id": 234887260,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618592004
    },
    {
        "content": "<p>Still not following - you've only got one concept in that code system?</p>",
        "id": 234887826,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618592270
    },
    {
        "content": "<p>i removed the rest because it's too long. let me share a longer example</p>",
        "id": 234888296,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618592447
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;CodeSystem&quot;,\n  &quot;id&quot;: &quot;someid&quot;,\n  &quot;language&quot;: &quot;en&quot;,\n  &quot;url&quot;: &quot;http://terminology.hl7.org/CodeSystem/something&quot;,\n  &quot;identifier&quot;: [\n    {\n      &quot;system&quot;: &quot;urn:ietf:rfc:3986&quot;,\n      &quot;value&quot;: &quot;urn:oid:1111&quot;\n    }\n   ],\n  &quot;valueSet&quot;: &quot;http://terminology.hl7.org/CodeSystem/someide/vs&quot;,\n  &quot;name&quot;: &quot;somename&quot;,\n  &quot;title&quot;: &quot;sometitle&quot;,\n  &quot;status&quot;: &quot;draft&quot;,\n  &quot;experimental&quot;: false,\n  &quot;hierarchyMeaning&quot;: &quot;is-a&quot;,\n  &quot;content&quot;: &quot;complete&quot;,\n  &quot;count&quot;: 110212,\n      &quot;filter&quot;: [\n        {\n            &quot;code&quot;: &quot;parent&quot;,\n            &quot;operator&quot;: [\n                &quot;=&quot;\n            ],\n            &quot;value&quot;: &quot;A Part code&quot;\n        },\n        {\n            &quot;code&quot;: &quot;child&quot;,\n            &quot;operator&quot;: [\n                &quot;=&quot;\n            ],\n            &quot;value&quot;: &quot;Child codes&quot;\n        },\n    ],\n  &quot;property&quot;: [\n    {\n      &quot;code&quot;: &quot;active&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;abbreviation&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;meddra_code&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    }\n  ],\n  &quot;concept&quot;: [\n    {\n      &quot;code&quot;: &quot;soc_10005329&quot;,\n      &quot;display&quot;: &quot;Blood and lymphatic system disorders&quot;,\n      &quot;property&quot;: [\n        {\n          &quot;code&quot;: &quot;meddra_code&quot;,\n          &quot;valueCode&quot;: &quot;10005329&quot;\n        },\n        {\n          &quot;code&quot;: &quot;abbreviation&quot;,\n          &quot;valueCode&quot;: &quot;Blood&quot;\n        },\n        {\n          &quot;code&quot;: &quot;child&quot;,\n          &quot;valueCode&quot;: &quot;hlgt_10002086&quot;\n        }\n      ]\n    },\n    {\n      &quot;code&quot;: &quot;hlgt_10002086&quot;,\n      &quot;display&quot;: &quot;Anaemias nonhaemolytic and marrow depression&quot;,\n      &quot;property&quot;: [\n        {\n          &quot;code&quot;: &quot;meddra_code&quot;,\n          &quot;valueCode&quot;: &quot;10002086&quot;\n        },\n        {\n          &quot;code&quot;: &quot;parent&quot;,\n          &quot;valueCode&quot;: &quot;soc_10005329&quot;\n        }\n      ]\n    }\n ]\n}\n</code></pre></div>",
        "id": 234888609,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618592561
    },
    {
        "content": "<p>Ok - there's still no hierarchy shown there.</p>",
        "id": 234889188,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618592800
    },
    {
        "content": "<p>isn't it given by code=child and code=parent referencing each other ?</p>",
        "id": 234889290,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618592854
    },
    {
        "content": "<p>or <code>hlgt_10002086</code> should be inside <code>soc_10005329</code> ?</p>",
        "id": 234889580,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618592994
    },
    {
        "content": "<p>Hierarchy should only be shown using properties if there's a polyhierarchy - i.e. one concept is a specialization of multiple parents.  Even then, at least part of the hierarchy is typically shown through nesting.  The property also needs to be one that's understood by the terminology server for it to work.  The way you define value sets is the same regardless of whether the hierarchy is defined the 'standard' way by nesting or by supplementing additional parents via property.</p>",
        "id": 234889704,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618593037
    },
    {
        "content": "<p>do you have any example I could follow ?</p>",
        "id": 234889843,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618593114
    },
    {
        "content": "<p>In this case, it's a simple one, one parent multiple children. From my understanding, which is wrong <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>, declaring the parent/child in the properties</p>",
        "id": 234890048,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618593225
    },
    {
        "content": "<p><a href=\"https://terminology.hl7.org/CodeSystem-v3-ActClass.html\">https://terminology.hl7.org/CodeSystem-v3-ActClass.html</a> has both.</p>",
        "id": 234890073,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618593236
    },
    {
        "content": "<p>Thank you, will check it. May I bother again in case I have issues ?</p>",
        "id": 234890423,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618593379
    },
    {
        "content": "<p>That's what Zulip is for :)</p>",
        "id": 234891221,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618593733
    },
    {
        "content": "<p>last test for tonight <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span><br>\ndoes it make more sense like this ?</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;CodeSystem&quot;,\n  &quot;id&quot;: &quot;someid&quot;,\n  &quot;language&quot;: &quot;en&quot;,\n  &quot;url&quot;: &quot;http://terminology.hl7.org/CodeSystem/something&quot;,\n  &quot;identifier&quot;: [\n    {\n      &quot;system&quot;: &quot;urn:ietf:rfc:3986&quot;,\n      &quot;value&quot;: &quot;urn:oid:1111&quot;\n    }\n   ],\n  &quot;valueSet&quot;: &quot;http://terminology.hl7.org/CodeSystem/someide/vs&quot;,\n  &quot;name&quot;: &quot;somename&quot;,\n  &quot;title&quot;: &quot;sometitle&quot;,\n  &quot;status&quot;: &quot;draft&quot;,\n  &quot;experimental&quot;: false,\n  &quot;hierarchyMeaning&quot;: &quot;is-a&quot;,\n  &quot;content&quot;: &quot;complete&quot;,\n  &quot;count&quot;: 110212,\n      &quot;filter&quot;: [\n        {\n            &quot;code&quot;: &quot;parent&quot;,\n            &quot;operator&quot;: [\n                &quot;=&quot;\n            ],\n            &quot;value&quot;: &quot;A Part code&quot;\n        },\n        {\n            &quot;code&quot;: &quot;child&quot;,\n            &quot;operator&quot;: [\n                &quot;=&quot;\n            ],\n            &quot;value&quot;: &quot;Child codes&quot;\n        },\n    ],\n  &quot;property&quot;: [\n    {\n\n        &quot;code&quot;: &quot;parent&quot;,\n        &quot;uri&quot;: &quot;http://hl7.org/fhir/concept-properties#parent&quot;,\n        &quot;description&quot;: &quot;A parent code in the Multiaxial Hierarchy&quot;\n    },\n    {\n        &quot;code&quot;: &quot;child&quot;,\n        &quot;uri&quot;: &quot;http://hl7.org/fhir/concept-properties#child&quot;,\n        &quot;description&quot;: &quot;A child code in the Multiaxial Hierarchy&quot;\n    },\n    {\n      &quot;code&quot;: &quot;active&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;abbreviation&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    },\n    {\n      &quot;code&quot;: &quot;meddra_code&quot;,\n      &quot;type&quot;: &quot;string&quot;\n    }\n  ],\n  &quot;concept&quot;: [\n    {\n      &quot;code&quot;: &quot;soc_10005329&quot;,\n      &quot;display&quot;: &quot;Blood and lymphatic system disorders&quot;,\n      &quot;property&quot;: [\n        {\n          &quot;code&quot;: &quot;child&quot;,\n          &quot;valueCode&quot;: &quot;hlgt_10002086&quot;\n        }\n      ]\n    },\n    {\n      &quot;code&quot;: &quot;hlgt_10002086&quot;,\n      &quot;display&quot;: &quot;Anaemias nonhaemolytic and marrow depression&quot;,\n      &quot;property&quot;: [\n        {\n          &quot;code&quot;: &quot;parent&quot;,\n          &quot;valueCode&quot;: &quot;soc_10005329&quot;\n        }\n      ]\n    }\n ]\n}\n</code></pre></div>",
        "id": 234898185,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618596705
    },
    {
        "content": "<p>so , properties <code>parent</code> and <code>child</code> are declared. the <code>valueCode</code> referenced in parent and child are valid...</p>",
        "id": 234898313,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618596751
    },
    {
        "content": "<p>I'm not seeing hierarchy being used.  If you don't have a polyhierarchy, don't use properties to represent parent/child.  Also, NEVER use properties to point both directions.</p>",
        "id": 234899728,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618597334
    },
    {
        "content": "<p>so I should remove the parent,child in the properties then ?<br>\nthe hierarchy is quite simple parent &gt; child &gt; child<br>\nso i should declare only parents or only children for a code, not both ?<br>\nthank you for your patience</p>",
        "id": 234904661,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618599636
    },
    {
        "content": "<p>If you don't have polyhierarchy, you should nest concepts inside one another as per the hierarchy and not declare properties at all.  If you have polyhierarchy, then use a property to indicate additional parents.</p>",
        "id": 234918418,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618606156
    },
    {
        "content": "<p>I think that Lloyd is quite right that it's the simplest and most understandable and probably the best choice to use the explicit nesting if you have a simple hierarchy (with only single parents).  But I don't think that we've ever said or have a rule that enforces that it's <strong>wrong</strong> to model a simple hierarchy using concept properties (as long as they are understood by the terminology server, as Lloyd says).  If there was a situation where there is only a simple hierarchy with single parents at present, but there was a possibility that it might become a polyhierarchy in the future, then I think that I <strong>might</strong> consider using properties to model it initially.  I'm not sure that mixing nesting and parent properties to build the complete hierarchy is a great idea - that's like to be confusing and potentially error-prone (and could have incomplete and inconsistent behavior on different servers).</p>",
        "id": 234920196,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1618606861
    },
    {
        "content": "<p>Mixing nesting and properties is what we do with polyhierarchies right now - rendering is driven by the 'primary' hierarchy and all other relationships show up as properties.</p>",
        "id": 234925622,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618609189
    },
    {
        "content": "<p>I would just say, yes - but not necessarily.  There are some pros and cons both ways.</p>",
        "id": 234934201,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1618614649
    },
    {
        "content": "<p>hi,<br>\nmanage to have it working with nesting, it's a bit ugly, since it does go five levels deep, but it's working. so i can see the children of entries and so forth.<br>\nthere are a couple of things that i'm having issues with, first is that apparently i cannot use <code>parent</code> and <code>child</code> with hapi as it's limited to the loinc code system only. i will post that in the hapi channel.<br>\nsecond, how do i implement a ValueSet that contains all values from the CodeSystem. <br>\nI've tried with the one below, but not sure if it's ok :</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;compose&quot;: {\n    &quot;include&quot;: [\n      {\n        &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/mdr&quot;\n      }\n    ]\n  }\n</code></pre></div>",
        "id": 235165944,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618832591
    },
    {
        "content": "<p>That 'compose' should work.</p>",
        "id": 235187875,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1618841908
    },
    {
        "content": "<p>Yes.  That's the correct 'compose'.</p>",
        "id": 235188257,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1618842031
    },
    {
        "content": "<p>yep it worked. finally managed to have the whole thing working. thank you !</p>",
        "id": 235205904,
        "sender_full_name": "Gjergj Sheldija",
        "timestamp": 1618848197
    }
]