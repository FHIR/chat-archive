[
    {
        "content": "<p>Hello All - I am working to solve the consent model for dependents use case. We have Primary Insurance holder and also many family member/ dependents under Primary holder. Primary member wants to see all of their family member data in the smart app. We are planning to build a consent management app which list the primary holder and also all of the dependent information. The primary holder can provide different consent for himself and can chose different set of consent for the dependents.  I am having challenges in solving the OAuth authorization in this case. <br>\nSince there can be only one patient ID sent along side the access_token, how do we address this use case?</p>\n<p>1) Does the smart app needs to initialize the authentication process everytime when they switch the patient and obtain tokens specific to the patient of interest (i.e at a given point of time the consent can be provided to only on person and not multiple users)<br>\n OR<br>\n2) Do we design the FIHR API to allow dependent information by using the access_token of the primary holder. (in this case the association and validation of primary-to-dependent is managed by the resource server/API itself)</p>\n<p>Appreciate your support. Thanks.</p>\n<p>Regards,<br>\nPrashanth.</p>",
        "id": 229228657,
        "sender_full_name": "Prashanth Ambalavanan",
        "timestamp": 1615161537
    },
    {
        "content": "<p>You might want to raise this on the <a class=\"stream\" data-stream-id=\"179170\" href=\"/#narrow/stream/179170-smart\">#smart</a> stream</p>",
        "id": 229229838,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615162461
    },
    {
        "content": "<p>You can get this behavior with <code>user/</code> scopes. When an app asks for something like <code>user/Patient.read</code>, the authorization server can prompt the user to approve specific records (or all people in the family).</p>",
        "id": 229232284,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1615164747
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span>. If I want to provide different consent for each family , will the smart app have multiple access_tokens for each member in the family with corresponding scopes approved?. I am unsure if the smart app can support storing multiple access_tokens if we use oauth sdks.</p>\n<p>also how does the smart client app know for which family member the access_token with user/<em>.</em> scope is tied to?. I would assume it would use the patientId claim?</p>",
        "id": 229241819,
        "sender_full_name": "Prashanth Ambalavanan",
        "timestamp": 1615173822
    },
    {
        "content": "<p>When using <code>user/</code> scopes the app will query 'all patients' (ie <code>GET [base]/Patient</code>) to get the list of all patients that are accessible  - it is up to the server to respond correctly and implement any restrictions as selected by the user during authorization (such information can be stored or associated with the issued access token)</p>",
        "id": 229302361,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1615212036
    },
    {
        "content": "<p>CAVEAT: most applications do not support that behavior, they use <code>launch/patient</code> and <code>patient/</code> access scopes and handle one patient at a time</p>",
        "id": 229302508,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1615212097
    },
    {
        "content": "<p>(to be clear: in both cases there will be only a single access token)</p>",
        "id": 229302670,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1615212148
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span></p>",
        "id": 229378756,
        "sender_full_name": "Prashanth Ambalavanan",
        "timestamp": 1615239577
    }
]