[
    {
        "content": "<p>Hello. I am trying to validate Capability Statements using the HL7 FHIR Validator version 5.0.17. When using the validator with the US Core Server Capability statement, (<a href=\"https://www.hl7.org/fhir/us/core/CapabilityStatement-us-core-server.json\">https://www.hl7.org/fhir/us/core/CapabilityStatement-us-core-server.json</a>) I’m getting many errors involving <code>URL value “http://hl7.org/fhir/us/core/...” does not resolve.</code></p>\n<p>Command used:</p>\n<div class=\"codehilite\"><pre><span></span><code>java -jar org.hl7.fhir.validator.jar -version <span class=\"m\">4</span>.0.1 CapabilityStatement-us-core-server.json<span class=\"sb\">`</span>\n</code></pre></div>\n\n\n<p>Output:</p>\n<div class=\"codehilite\"><pre><span></span><code>FHIR Validation tool Version <span class=\"m\">5</span>.0.17 <span class=\"o\">(</span>Git# a375f58c8288<span class=\"o\">)</span>. Built <span class=\"m\">2020</span>-07-30T04:40:26.642Z <span class=\"o\">(</span><span class=\"m\">15</span> hours old<span class=\"o\">)</span>\nDetected Java version: <span class=\"m\">11</span>.0.8 from /Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home on x86_64 <span class=\"o\">(</span>64bit<span class=\"o\">)</span>. 8192MB available\nArguments: -version <span class=\"m\">4</span>.0.1 CapabilityStatement-us-core-server.json\nDirectories: <span class=\"nv\">Current</span> <span class=\"o\">=</span> /Users/rscalfani/Documents/OneDrive MITRE/validator, Package <span class=\"nv\">Cache</span> <span class=\"o\">=</span> /Users/rscalfani/.fhir/packages\n .. FHIR Version <span class=\"m\">4</span>.0, definitions from hl7.fhir.r4.core#4.0.1\n .. connect to tx server @ http://tx.fhir.org\n  <span class=\"o\">(</span>v4.0.1<span class=\"o\">)</span>\n .. validate <span class=\"o\">[</span>CapabilityStatement-us-core-server.json<span class=\"o\">]</span>\nTerminology server: Check <span class=\"k\">for</span> supported code systems <span class=\"k\">for</span> urn:iso:std:iso:3166\n*FAILURE* validating CapabilityStatement-us-core-server.json: error:100 warn:0 info:45\n Error @ CapabilityStatement.url <span class=\"o\">(</span>line <span class=\"m\">8</span>, col75<span class=\"o\">)</span> : URL value <span class=\"s2\">&quot;http://hl7.org/fhir/us/core/CapabilityStatement/us-core-server&quot;</span> does not resolve\n Error @ CapabilityStatement.implementationGuide<span class=\"o\">[</span><span class=\"m\">0</span><span class=\"o\">]</span> <span class=\"o\">(</span>line <span class=\"m\">49</span>, col4<span class=\"o\">)</span> : URL value <span class=\"s2\">&quot;http://hl7.org/fhir/us/core/ImplementationGuide/hl7.fhir.us.core-3.1.0&quot;</span> does not resolve\n</code></pre></div>\n\n\n<p>With many more additional errors of the same type following.<br>\nI’ve seen this issue with other resources, but am using US Core as an example.<br>\nI was unable to find any requirements in the FHIR spec that urls, including canonical urls, must resolve. I can understand why these would be warnings, but can someone explain why these are errors?<br>\nAny help would be much appreciated!</p>",
        "id": 205528371,
        "sender_full_name": "Robert Scalfani",
        "timestamp": 1596140837
    },
    {
        "content": "<p>If you're going to validate content that references artifacts from an IG, you need to use the <code>-ig</code> parameter to indicate the ig (or igs) that are in scope.  Otherwise, the validator just looks at the core spec</p>",
        "id": 205530037,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1596141808
    },
    {
        "content": "<p>Should these really be errors though?</p>\n<p>For example if I validate against the vonk CapabilityStatement at <code>http://vonk.fire.ly/r4/metadata</code>. I get</p>\n<div class=\"codehilite\"><pre><span></span><code>java -jar validator_cli.jar -version <span class=\"m\">4</span>.0.1 metadata\nFHIR Validation tool Version <span class=\"m\">5</span>.0.17 <span class=\"o\">(</span>Git# a375f58c8288<span class=\"o\">)</span>. Built <span class=\"m\">2020</span>-07-30T04:40:26.642Z <span class=\"o\">(</span><span class=\"m\">16</span> hours old<span class=\"o\">)</span>\nDetected Java version: <span class=\"m\">14</span>.0.2 from /Library/Java/JavaVirtualMachines/adoptopenjdk-14.jdk/Contents/Home on x86_64 <span class=\"o\">(</span>64bit<span class=\"o\">)</span>. 4096MB available\nArguments: -version <span class=\"m\">4</span>.0.1 metadata\nDirectories: <span class=\"nv\">Current</span> <span class=\"o\">=</span> /Users/radamson/Downloads, Package <span class=\"nv\">Cache</span> <span class=\"o\">=</span> /Users/radamson/.fhir/packages\n  .. FHIR Version <span class=\"m\">4</span>.0, definitions from hl7.fhir.r4.core#4.0.1\n  .. connect to tx server @ http://tx.fhir.org\n    <span class=\"o\">(</span>v4.0.1<span class=\"o\">)</span>\n  .. validate <span class=\"o\">[</span>metadata<span class=\"o\">]</span>\n   ..Detect format <span class=\"k\">for</span> metadata\n*FAILURE* validating metadata:  error:1 warn:1 info:0\n  Error @ CapabilityStatement.rest<span class=\"o\">[</span><span class=\"m\">0</span><span class=\"o\">]</span>.operation<span class=\"o\">[</span><span class=\"m\">0</span><span class=\"o\">]</span>.definition <span class=\"o\">(</span>line <span class=\"m\">29864</span>, col88<span class=\"o\">)</span> : URL value <span class=\"s2\">&quot;http://hl7.org/fhir/OperationDefinition/CodeSystem-compose&quot;</span> does not resolve\n  Warning @ CapabilityStatement <span class=\"o\">(</span>line <span class=\"m\">1</span>, col1<span class=\"o\">)</span> : cpb-0: Name should be usable as an identifier <span class=\"k\">for</span> the module by machine processing applications such as code generation <span class=\"o\">[</span>name.matches<span class=\"o\">(</span><span class=\"s1\">&#39;[A-Z]([A-Za-z0-9_]){0,254}&#39;</span><span class=\"o\">)]</span>\n</code></pre></div>\n\n\n<p>This OperationDefinition is actually defined in base FHIR (I can resolve it in my browser), but I imagine a CapabilityStatement could just as likely include OperationDefinitions which are not publicly available.</p>\n<p>Is there language in the FHIR spec that backs up these being errors?  I'd imagine it being a warning, similar to an unknown CodeSystem, unless its actually mandatory for these to resolve.</p>",
        "id": 205531493,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1596142657
    },
    {
        "content": "<p>the java validator calls that an error if the target is in <a href=\"http://hl7.org/fhir\">hl7.org/fhir</a>, since it knows all about that space</p>",
        "id": 205545308,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596152804
    },
    {
        "content": "<p>I can understand that from an IG Publisher perspective, but when validating resource instances created by others than myself its not feasible to know which <code>-ig</code> parameters to use.</p>\n<p>As <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> indicated for <span class=\"user-mention\" data-user-id=\"326373\">@Robert Scalfani</span>'s example, the validator doesn't know about <code>http://hl7.org/fhir/us/core/CapabilityStatement/us-core-server</code>, which is in <a href=\"http://hl7.org/fhir\">hl7.org/fhir</a>, unless us core is loaded via the <code>-ig</code> parameter.  There may be an IG artifact that contains a definition for the offending URL in the vonk example as well, but realistically I'm not sure how I would know which to use.</p>\n<p>In these cases I'm not sure whether the resource actually has errors or that the validator does not have the proper resources loaded via the <code>-ig</code> flag.</p>",
        "id": 205578074,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1596192216
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 205591398,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1596203161
    },
    {
        "content": "<p>Since <code>CapabilityStatement.url</code> is not required to resolve:</p>\n<blockquote>\n<p>This SHOULD be globally unique and SHOULD be a literal address at which at which an authoritative instance of this capability statement is (or will be) published.</p>\n</blockquote>\n<p>I would think this should not be reported as an error <em>of the resource being validated</em>, and at worst it is an error of the invocation of the validator itself (i.e., I could not resolve this because you didn't provide it to me, eg via a -ig parameter).</p>",
        "id": 205755531,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1596422849
    },
    {
        "content": "<p>what context is this in?</p>",
        "id": 205755582,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596422886
    },
    {
        "content": "<p>The quote is from <a href=\"https://www.hl7.org/fhir/capabilitystatement-definitions.html#CapabilityStatement.url\">https://www.hl7.org/fhir/capabilitystatement-definitions.html#CapabilityStatement.url</a><br>\nand I'm looking at the Output from <span class=\"user-mention\" data-user-id=\"326373\">@Robert Scalfani</span> 's example at the start of the thread</p>",
        "id": 205755855,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1596423365
    },
    {
        "content": "<p>for now, I've changed the way we check canonical URLs; they are not a reference. I'll think about whether there's more checks I can do</p>",
        "id": 205865758,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596505751
    },
    {
        "content": "<p>Hi Grahame, thanks for your response and help! It looks like this has been resolved for <code>CapabilityStatement.url </code>, but not <code>CapabilityStatement.implementationGuide</code> . I’m still getting the same issue</p>\n<div class=\"codehilite\"><pre><span></span><code>java -jar validator_cli.jar -version 4.0.1 uscoreexample.json\nFHIR Validation tool Version 5.0.22 (Git# 5c4c5ce1c872). Built 2020-08-07T03:52:06.975Z (10 hours old)\nDetected Java version: 11.0.8 from /Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home on x86_64 (64bit). 8192MB available\nArguments: -version 4.0.1 uscoreexample.json\nDirectories: Current = /Users/rscalfani/Documents/CapabiltyStatement-mCODE-SearchRequirements/build/input/capabilities, Package Cache = /Users/rscalfani/.fhir/packages\n  .. FHIR Version 4.0, definitions from hl7.fhir.r4.core#4.0.1\n  .. connect to tx server @ http://tx.fhir.org\n    (v4.0.1)\n  .. validate [uscoreexample.json]\nTerminology server: Check for supported code systems for urn:iso:std:iso:3166\n*FAILURE* validating uscoreexample.json:  error:1 warn:0 info:45\n  Error @ CapabilityStatement.implementationGuide[0] (line 49, col4) : URL value &quot;http://hl7.org/fhir/us/core/ImplementationGuide/hl7.fhir.us.core-3.1.0&quot; does not resolve\n</code></pre></div>\n\n\n<p>Is there a reason why URLs for <code>CapabilityStatement.implementationGuide</code> are still causing failures?</p>",
        "id": 206262398,
        "sender_full_name": "Robert Scalfani",
        "timestamp": 1596810031
    },
    {
        "content": "<p>well, that's a reference rather than a definition, and it looks wrong to me</p>",
        "id": 206312384,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596836211
    },
    {
        "content": "<p>Is it required that the reference <code>CapabilityStatement.implementationGuide</code> must resolve? I don't see this requirement that a canonical URL must resolve in the spec, could you point me to that requirement?</p>",
        "id": 206731844,
        "sender_full_name": "Robert Scalfani",
        "timestamp": 1597256660
    },
    {
        "content": "<p>the validator doesn't require it to resolve, but if you refer into the <a href=\"http://hl7.org/fhir\">hl7.org/fhir</a> space, the validator requires the references to be correct</p>",
        "id": 206761087,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597271981
    }
]