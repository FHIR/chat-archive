[
    {
        "content": "<p>Hello,</p>\n<p>I have a question about multiple chained parameters.<br>\nAs for multiple chained parameters, the FHIR spec says \"chained parameters are applied independently to the target resource.\" </p>\n<p>My understanding is that the search result of the following query illustrated in the spec </p>\n<div class=\"codehilite\"><pre><span></span><code>GET Patient?general-practitioner.name=Joe&amp;general-practitioner.address-state=MN\n</code></pre></div>\n<p>is a UNION of Patients satisfy each condition. </p>\n<p>But I'm confusing because when I tried above query on the several public FHIR servers, all servers returned an intersection of all conditions.</p>\n<p>Is my understanding correct?</p>",
        "id": 229631867,
        "sender_full_name": "Gou Masuda",
        "timestamp": 1615370913
    },
    {
        "content": "<p>Intersection is the expected behavior</p>",
        "id": 229654922,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1615382089
    },
    {
        "content": "<p>Multiple conditions are joined via <code>and</code>, so as Michele said, the expected result is the intersection.  If you need the union, you can run multiple queries, or submit a single <code>batch</code> (if the server supports it) to get all the results together.</p>\n<p>Also note that the syntax supports multiple 'or' values in a single field (see <a href=\"https://www.hl7.org/fhir/search.html#combining\">Composite Search Parameters</a>), so if you wanted the results for MN and WI, you can submit as <code>general-practitioner.address-state=MN,WI</code></p>",
        "id": 229678565,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1615389510
    },
    {
        "content": "<p>The phrase \"chained parameters are applied independently to the target resource\" is an important limitation that is often misunderstood.</p>\n<p>It is <em>only</em> relevant when the reference field has more than one value. If a Patient has only one general-practitioner, then the example always works as expected.</p>\n<p>The case that may be unexpected is where a Patient has <em>two</em> general-practitioners, where one matches name=Joe and the other matches address-state=MN. This will match the example search. There is no way to write a chained search that forces the same general-practitioner to match both, i.e. there is no syntax like Patient?general-practitioner.(name=Joe&amp;address-state=MN)</p>",
        "id": 229701398,
        "sender_full_name": "Paul Church",
        "timestamp": 1615395330
    },
    {
        "content": "<p>If you were to say <code>GET Patient?general-practitioner.name=Joe&amp;general-practioner.name=Smith</code>, the \"applied independently\" means that you would get back a Patient who had one general-practitioner with a name of Joe and another with a name of Smith - there's no implication that both Joe and Smith appear on the same Practitioner.</p>",
        "id": 229706236,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615396886
    },
    {
        "content": "<p>Thank you to everyone. <br>\nI recognized my understanding is incorrect. </p>\n<p>Multiple conditions via '&amp;' are joined, so intersection is expected.<br>\n<em>\"chained parameters are applied independently to the target resource\"</em> in the spec means one referenced resource doesn't need satisfy all conditions at the same time. </p>\n<p>Thank you.</p>",
        "id": 229772840,
        "sender_full_name": "Gou Masuda",
        "timestamp": 1615422734
    },
    {
        "content": "<p>I have seen questions about this <code>GET Patient?general-practitioner.name=Joe&amp;general-practitioner.address-state=MN</code> many times here. That means this query example and its explanation is confusing to regular reader.</p>",
        "id": 229867376,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1615476495
    },
    {
        "content": "<p>would this be an improvement?</p>\n<blockquote>\n<p>Note that when search parameters apply to fields that can have more than one value, each chained parameters acts as an isolated filter. Because they share no context, there is no requirement that field value satisfying one search parameter be matched against the same field value satisfying another search parameter.</p>\n</blockquote>",
        "id": 229870941,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1615477746
    },
    {
        "content": "<p>... followed the the current example text:</p>\n<blockquote>\n<p>For example,</p>\n</blockquote>\n<blockquote>\n<blockquote>\n<p>GET Patient?general-practitioner.name=Joe&amp;general-practitioner.address-state=MN</p>\n</blockquote>\n</blockquote>",
        "id": 229871097,
        "sender_full_name": "Eric Prud'hommeaux",
        "timestamp": 1615477799
    },
    {
        "content": "<p>perhaps: \"there is no requirement that the reference followed to satisfy one search parameter be the same reference followed to satisfy another search parameter\"</p>",
        "id": 229871371,
        "sender_full_name": "Paul Church",
        "timestamp": 1615477879
    },
    {
        "content": "<p>Feel free to submit a change request :)</p>",
        "id": 229871773,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615478027
    },
    {
        "content": "<p>I would also add <span class=\"user-mention\" data-user-id=\"197072\">@Paul Church</span> and <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> 's explanation above</p>",
        "id": 229902318,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1615487736
    }
]