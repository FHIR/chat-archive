[
    {
        "content": "<p>I recently added FHIRPath Patch support to our server. I downloaded the FHIRPath Patch test cases from <a href=\"https://www.hl7.org/fhir/fhirpatch.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/fhirpatch.html\">https://www.hl7.org/fhir/fhirpatch.html</a> but hit a couple issues.</p>",
        "id": 188499678,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1582066327
    },
    {
        "content": "<p>IMHO the most egregious one is <code>Reorder List #4</code>:</p>\n<div class=\"codehilite\"><pre><span></span>  &lt;case name=&quot;Reorder List #4&quot; mode=&quot;forwards&quot;&gt;\n    &lt;input&gt;\n      &lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;&lt;id value=&quot;test&quot;/&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 1&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 2&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 3&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 4&quot;/&gt;\n        &lt;/identifier&gt;\n      &lt;/Patient&gt;\n    &lt;/input&gt;\n    &lt;diff&gt;\n      &lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;&lt;id value=&quot;test&quot;/&gt;\n        &lt;parameter&gt;\n          &lt;name value=&quot;operation&quot;/&gt;\n          &lt;part&gt;\n            &lt;name value=&quot;type&quot;/&gt;\n            &lt;valueCode value=&quot;move&quot;/&gt;\n          &lt;/part&gt;\n          &lt;part&gt;\n            &lt;name value=&quot;path&quot;/&gt;\n            &lt;valueString value=&quot;Patient.identifier&quot;/&gt;\n          &lt;/part&gt;\n          &lt;part&gt;\n            &lt;name value=&quot;source&quot;/&gt;\n            &lt;valueInteger value=&quot;0&quot;/&gt;\n          &lt;/part&gt;\n          &lt;part&gt;\n            &lt;name value=&quot;destination&quot;/&gt;\n            &lt;valueInteger value=&quot;3&quot;/&gt;\n          &lt;/part&gt;\n        &lt;/parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/diff&gt;\n    &lt;output&gt;\n      &lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;&lt;id value=&quot;test&quot;/&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 2&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 3&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 1&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 4&quot;/&gt;\n        &lt;/identifier&gt;\n      &lt;/Patient&gt;\n    &lt;/output&gt;\n  &lt;/case&gt;\n</pre></div>",
        "id": 188499730,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1582066390
    },
    {
        "content": "<p>Shouldn't the expected output be:</p>\n<div class=\"codehilite\"><pre><span></span>      &lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;&lt;id value=&quot;test&quot;/&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 2&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 3&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 4&quot;/&gt;\n        &lt;/identifier&gt;\n        &lt;identifier&gt;\n          &lt;system value=&quot;http://example.org&quot;/&gt;\n          &lt;value value=&quot;value 1&quot;/&gt;\n        &lt;/identifier&gt;\n      &lt;/Patient&gt;\n</pre></div>\n\n\n<p>?</p>",
        "id": 188499748,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1582066416
    },
    {
        "content": "<p>what does <code>mode=\"forwards\"</code> mean in the test case element?</p>",
        "id": 188499836,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1582066459
    },
    {
        "content": "<p>Something is not right there, how do you move it to the start or to the end?<br>\nIs the position the result after removing it, or before removing it, and is it 0 based.<br>\nIf that is the expected result, the only answer I can come up with is it means insert before item (without removing the source).<br>\nI agree that this could do with some clarification.</p>",
        "id": 188517688,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1582091288
    },
    {
        "content": "<p>yeah, here was my assumption about how move should work for a list like [1,2,3,4]:</p>\n<div class=\"codehilite\"><pre><span></span>move(0,0) -&gt; 1,2,3,4\nmove(0,1) -&gt; 2,1,3,4\nmove(0,2) -&gt; 2,3,1,4\nmove(0,3) -&gt; 2,3,4,1\n</pre></div>",
        "id": 188550525,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1582123783
    },
    {
        "content": "<p>OK, I opened <a href=\"https://jira.hl7.org/browse/FHIR-26324\" target=\"_blank\" title=\"https://jira.hl7.org/browse/FHIR-26324\">https://jira.hl7.org/browse/FHIR-26324</a> for it...and I'm happy to open a PR with my suggested fix if someone can point me to the source of these examples</p>",
        "id": 188551252,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1582124251
    },
    {
        "content": "<p>mode is an instruction to the test engine for whether the test case is testing applying or generating differences</p>",
        "id": 188603728,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163247
    },
    {
        "content": "<p>because you can't always go in both directions</p>",
        "id": 188603735,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163264
    },
    {
        "content": "<p>further, I agree with your assumption and I can't see how my code doesn't work the way you think</p>",
        "id": 188604015,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582163749
    },
    {
        "content": "<p>no it does - insert before delete</p>",
        "id": 188604282,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164110
    },
    {
        "content": "<p>That's the only test that's affected</p>",
        "id": 188604363,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164237
    },
    {
        "content": "<p>so I agree that test cases are wrong, and I'll update the test cases in their master location:</p>",
        "id": 188604803,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164742
    },
    {
        "content": "<p><a href=\"https://github.com/FHIR/fhir-test-cases\" target=\"_blank\" title=\"https://github.com/FHIR/fhir-test-cases\">https://github.com/FHIR/fhir-test-cases</a></p>",
        "id": 188604811,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582164757
    }
]