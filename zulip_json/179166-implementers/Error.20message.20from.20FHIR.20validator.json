[
    {
        "content": "<p>When running the official FHIR validator against the attached file, I received this error message: ITK003D  FAIL    ERROR -- DOCUMENT BUNDLE: Must have either extensions or value[x], not both [extension.exists() != value.exists()] * Location: Bundle.entry[1].resource.extension column: 0 <a href=\"/user_uploads/10155/4o9YaIJlppmeu9HpXFzKY8oL/ITK-EDIS-TEST-032a.xml\" target=\"_blank\" title=\"ITK-EDIS-TEST-032a.xml\">ITK-EDIS-TEST-032a.xml</a><br>\nI am not sure what is wrong with the attached file. Please could anyone with knowledge in this area update me on what could be wrong with the file.</p>",
        "id": 153982062,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1533365076
    },
    {
        "content": "<p>I have received this error message from the official FHIR validator when running it against the attached file: ERROR -- DOCUMENT BUNDLE: None of the codes provided are in the value set <a href=\"https://fhir.nhs.uk/STU3/ValueSet/CareSettingType-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/STU3/ValueSet/CareSettingType-1\">https://fhir.nhs.uk/STU3/ValueSet/CareSettingType-1</a> (<a href=\"https://fhir.nhs.uk/STU3/ValueSet/CareSettingType-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/STU3/ValueSet/CareSettingType-1\">https://fhir.nhs.uk/STU3/ValueSet/CareSettingType-1</a>, and a code from this value set is required) (codes = <a href=\"http://snomed.info/sct#893061000000109\" target=\"_blank\" title=\"http://snomed.info/sct#893061000000109\">http://snomed.info/sct#893061000000109</a>) * Location: Bundle.entry[1].resource.extension.valueCodeableConcept column: 0. <a href=\"user_uploads/10155/vlgKBA9EVXbF2OJa-w8kVzzL/ITK-EDIS-TEST-032a.xml\" target=\"_blank\" title=\"user_uploads/10155/vlgKBA9EVXbF2OJa-w8kVzzL/ITK-EDIS-TEST-032a.xml\">ITK-EDIS-TEST-032a.xml</a><br>\nI am uncertain as to why this error message is being given as I the code I am using is a member of the specified  refset. I attach the valueset file: <a href=\"/user_uploads/10155/IdvFZ1nbQD9rtz33uj8KVSxJ/032a-20180802151411989718_B02C07.xml\" target=\"_blank\" title=\"032a-20180802151411989718_B02C07.xml\">032a-20180802151411989718_B02C07.xml</a> <a href=\"/user_uploads/10155/9eyylMMia83lAmE5Lt5IL8Vh/ValueSet-CareSettingType-1.xml\" target=\"_blank\" title=\"ValueSet-CareSettingType-1.xml\">ValueSet-CareSettingType-1.xml</a></p>",
        "id": 153982066,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1533366766
    },
    {
        "content": "<p>What version of the validator are you running?  You should be using the version from <a href=\"http://build.fhir.org\" target=\"_blank\" title=\"http://build.fhir.org\">build.fhir.org</a>.</p>",
        "id": 153982075,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1533389452
    },
    {
        "content": "<blockquote>\n<p>What version of the validator are you running?  You should be using the version from <a href=\"http://build.fhir.org\" target=\"_blank\" title=\"http://build.fhir.org\">build.fhir.org</a>.</p>\n</blockquote>\n<p>We are using the HAPI FHIR validator at <a href=\"http://hapifhir.io/\" target=\"_blank\" title=\"http://hapifhir.io/\">http://hapifhir.io/</a>.</p>",
        "id": 153982478,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1533546842
    },
    {
        "content": "<p>Regarding the error message I have posted, please could you explain why that error message appeared and whether there is anything wrong with the file I attached which caused the HAPI validator to throw this error message. Thanks.<br>\nApologies, perhaps I should have entitled this thread Error message from the FHIR HAPI validator.</p>",
        "id": 153982479,
        "sender_full_name": "Katie Wheatley",
        "timestamp": 1533546981
    },
    {
        "content": "<p>Katie, I think the answer is the valueSet refers to SNOMED Refset which can't be resolved.</p>",
        "id": 153982480,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1533550010
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/VMvklkeW9v1SznHfClQs3Gxx/Screen-Shot-2018-08-06-at-11.18.51.png\" target=\"_blank\" title=\"Screen-Shot-2018-08-06-at-11.18.51.png\">Screen-Shot-2018-08-06-at-11.18.51.png</a> This is ok but the validator doesn't have a way of resolving 999000381000000107</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/VMvklkeW9v1SznHfClQs3Gxx/Screen-Shot-2018-08-06-at-11.18.51.png\" target=\"_blank\" title=\"Screen-Shot-2018-08-06-at-11.18.51.png\"><img src=\"/user_uploads/10155/VMvklkeW9v1SznHfClQs3Gxx/Screen-Shot-2018-08-06-at-11.18.51.png\"></a></div>",
        "id": 153982482,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1533550820
    },
    {
        "content": "<p>hmm. where does that snomed code come from?</p>",
        "id": 153982492,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533554050
    },
    {
        "content": "<p>Uk Refset</p>",
        "id": 153982493,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1533554066
    },
    {
        "content": "<p>hmm should be supported but it's a while since I updated hte UK dirtibution</p>",
        "id": 153982496,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533554113
    },
    {
        "content": "<p>Using r4  validation instead of stu3, was faster and more thorough.</p>\n<p>Not sure how to handle the stu3 profiles, I can convert them structurally to r4 but the contents aren't converted (so for AllergyIntollerance.clinicalStatus it's still a code not coding).  We don't have r4 profiles. </p>\n<p>I'm also noticing a lot issues with profiles themselves (which the r4 validation is discovering).... so I'm thinking: creating r4 profiles with included profile fixes may be the solution?</p>",
        "id": 163630303,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1555574169
    },
    {
        "content": "<p>there's no framework for auto-upgrading the profiles to describe a different version. that's manual work</p>",
        "id": 163630399,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1555574337
    },
    {
        "content": "<p>you should be using the r5 validator now - we've moved onto that.</p>",
        "id": 163630418,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1555574367
    },
    {
        "content": "<p>I'm coming across a few SNOMED ecl statements which our terminology server rejects as too costly. (e.g. the one here <a href=\"https://fhir.nhs.uk/STU3/ValueSet/CareConnect-MedicationCode-1\" target=\"_blank\" title=\"https://fhir.nhs.uk/STU3/ValueSet/CareConnect-MedicationCode-1\">https://fhir.nhs.uk/STU3/ValueSet/CareConnect-MedicationCode-1</a> ). </p>\n<p>Is their another way of asking 'is this code in this valueset' rather than trying to attempting to expand it?</p>",
        "id": 163645501,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1555589886
    },
    {
        "content": "<p>I'm doing this in a validationsupport class</p>",
        "id": 163645527,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1555589934
    },
    {
        "content": "<p>are you asking about the validator? it should be using $validate-code not $expand</p>",
        "id": 163646840,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1555591025
    },
    {
        "content": "<p>That would make more sense, to call direct. <br>\nAt present I'm calling out to a SNOMED term server to answer ecl query (for the ValueSet)</p>",
        "id": 163649566,
        "sender_full_name": "Kevin Mayfield",
        "timestamp": 1555593000
    },
    {
        "content": "<p>well, check - use some http traer. I'm sure it calls $validate-code not $expand</p>",
        "id": 163649669,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1555593057
    }
]