[
    {
        "content": "<p>What does the event look like from a Subscription where payload is set and the criteria is eg. Encounter/?_include=Encounter:subject</p>\n<p>Is it just the Encounter or is it a bundle with the Encounter and Patient(subject)?</p>",
        "id": 154005644,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1538642492
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 154006347,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1538752403
    },
    {
        "content": "<p>yes</p>",
        "id": 154006461,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1538773447
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> yes, as in the first or the last?</p>",
        "id": 154006634,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1538987804
    },
    {
        "content": "<p>yes</p>",
        "id": 154006655,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539002518
    },
    {
        "content": "<p>actually, now that I read it carefully, I don't know. Ask on the subscriptions track</p>",
        "id": 154006657,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539002887
    },
    {
        "content": "<blockquote>\n<p>actually, now that I read it carefully, I don't know. Ask on the subscriptions track</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>  I implemented a simple subscription where the payload was set and I got the resource in the notification. I don't know if that is your question, whether you get the Encounter resource or just a search string for it. Looking back at my code I am a little shocked that it worked as I look at the criteria and it is</p>\n<div class=\"codehilite\"><pre><span></span>subscription.setCriteria(&quot;Observation?patient=sisansarahId-1.2.3.4.5.6.7.8.10&quot;);\n</pre></div>\n\n\n<p>I would expect it to be</p>\n<div class=\"codehilite\"><pre><span></span>subscription.setCriteria(&quot;Observation?subject=sisansarahId-1.2.3.4.5.6.7.8.10&quot;);\n</pre></div>\n\n\n<p>Somehow it worked ...</p>",
        "id": 154006658,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1539003923
    },
    {
        "content": "<blockquote>\n<blockquote>\n<p>actually, now that I read it carefully, I don't know. Ask on the subscriptions track</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>  I implemented a simple subscription where the payload was set and I got the resource in the notification. I don't know if that is your question, whether you get the Encounter resource or just a search string for it. Looking back at my code I am a little shocked that it worked as I look at the criteria and it is</p>\n</blockquote>\n<p>subscription.setCriteria(\"Observation?patient=sisansarahId-1.2.3.4.5.6.7.8.10\");</p>\n<div class=\"codehilite\"><pre><span></span>I would expect it to be\n</pre></div>\n\n\n<p>subscription.setCriteria(\"Observation?subject=sisansarahId-1.2.3.4.5.6.7.8.10\");</p>\n<div class=\"codehilite\"><pre><span></span>Somehow it worked ...\n</pre></div>\n\n\n<p>thats interesting ... lets continue on the subscription stream on \"Subscription and includes\"</p>",
        "id": 154006662,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1539005234
    },
    {
        "content": "<p>for a subscription, the server likely needs to be a bit more picky about 'unknown' parameters. right? with a REST query, ignoring an unknown parameter just affects one response. But ignoring an unknown parameter on a subscription can result in much more  unwanted traffic.</p>",
        "id": 154006670,
        "sender_full_name": "John Moehrke",
        "timestamp": 1539005824
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> - that sounds correct to me. Also, if it indeed is the case that one cannot use the include/revinclude parameters (and maybe other friends from <a href=\"http://build.fhir.org/search.html#Summary\" target=\"_blank\" title=\"http://build.fhir.org/search.html#Summary\">http://build.fhir.org/search.html#Summary</a>) perhaps the criteria definition on subscription should be sharpened a bit.</p>",
        "id": 154006674,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1539005969
    },
    {
        "content": "<p>Historically we've always said (in v2 and v3) that a subscription uses the same format as a search (it is kind of a 'delayed/ongoing search') , so I'd expect that to be the starting point for FHIR unless one has a good reason to include exceptions.</p>",
        "id": 154006682,
        "sender_full_name": "René Spronk",
        "timestamp": 1539008299
    },
    {
        "content": "<p>Format, I would agree. I am just thinking a warning to servers that they likely should be more strict because of this possibility.  It would be an informative recommendation, not a normative requirement.</p>",
        "id": 154006687,
        "sender_full_name": "John Moehrke",
        "timestamp": 1539008719
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 154006707,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1539011536
    },
    {
        "content": "<blockquote>\n<p>Historically we've always said (in v2 and v3) that a subscription uses the same format as a search</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span> interesting - where did we say that?</p>",
        "id": 154006775,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1539023268
    },
    {
        "content": "<p>That's my recollection as an InM co-chair.  Searching for references:</p>\n<p>v2.7 section 5.7.1: Runtime subscription has existed in earlier versions of HL7, but little attention has been drawn to it. Original mode queries could define an open ended time interval in QRF-9-When quantity/timing qualifier.  The unexplained semantics of this field had been interpreted to mean: If the QRF-9 specified an end time in the future, then the source system would keep sending results using the query continuation protocol.</p>\n<p>In v3 the QueryByParameter class has this same kind of fuzzy implied subscription mechanism; the subscription mechanism has not been explicitely documented, although the word subscription is being used in the documentation.  </p>\n<p>As far as HL7 was concerned, a subscription is just a query, with a 'delayed' response period.</p>",
        "id": 154006948,
        "sender_full_name": "René Spronk",
        "timestamp": 1539069402
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span>  Subscriptions cannot just be considered as a 'delayed' response period as it works continuously.</p>",
        "id": 154006957,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1539072328
    },
    {
        "content": "<p>Sloppy wording perhaps - a normal query is \"now\", a subscription is a query that is executed \"from now onwards up to point in time x\".</p>",
        "id": 154006963,
        "sender_full_name": "René Spronk",
        "timestamp": 1539079878
    },
    {
        "content": "<p>Point being: subscription is a query like any others, only the timing differs</p>",
        "id": 154006964,
        "sender_full_name": "René Spronk",
        "timestamp": 1539079950
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span>  if it is a query like any others - how should the criteria Encounter/?_include=Encounter:subject on a Subscription be handled?</p>",
        "id": 154006966,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1539081861
    },
    {
        "content": "<p>The exact same way as it would be handled as a regular query. In other words: any (new) encounters, inclusive of their subject resources will be sent to the subscribing party as part of the subscription stream. So as a result of the subscription will be that you'll receive repetitive bursts each consisting of 2 resources. It's exactly what you asked for.</p>\n<p>But again: it's up to FHIR to redefine this behaviour should it be desirable. This is just a response based on past behaviour of HL7 standards, but that doesn't mean one can't define it any other way if there are reasons to do so.</p>",
        "id": 154006969,
        "sender_full_name": "René Spronk",
        "timestamp": 1539088464
    },
    {
        "content": "<p>I guess given the description <span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span>  that chain search parameters are also allowed? This makes the task a little more difficult as now a server must trigger the subscription searches on every server resource create/update, not just the create/update of the desired resource type. <br>\nFor instance, criteria <code>Observation.subject:Patient.organization.identifier=http//somesystem/for/org|ACME</code><br>\nFor this I must trigger the subscription search on every create.update to the resources Observation, Patient and Organization.<br>\nJust looking for confirmation you agree. It feels rather different to a message subscription where you may just filter messages on topics as they pass through and push that message to a subscription if matched. Here we have to perform many searches very often. I'm guessing that is the case.</p>",
        "id": 154012990,
        "sender_full_name": "Angus Millar",
        "timestamp": 1540689940
    },
    {
        "content": "<p>Yes - any URL that's a valid search expression can also be used as the basis for a subscription.</p>",
        "id": 154013014,
        "sender_full_name": "René Spronk",
        "timestamp": 1540717841
    }
]