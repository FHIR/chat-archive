[
    {
        "content": "<p>hello, looking at the raw structure definition for <a href=\"http://hl7.org/fhir/StructureDefinition/observation-geneticsDNASequenceVariantName\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/observation-geneticsDNASequenceVariantName\">http://hl7.org/fhir/StructureDefinition/observation-geneticsDNASequenceVariantName</a>, I noticed that in the snapshot, it lists Extension.extension as having max=\"*\", but in the differential it has Extension.extension with max=\"0\".  What's the story there?</p>",
        "id": 153983876,
        "sender_full_name": "Nick George",
        "timestamp": 1533764060
    },
    {
        "content": "<p>sounds like more problems in the snapshot generator</p>",
        "id": 153983885,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533764468
    },
    {
        "content": "<p>yeah I assumed it was a bug - I'm working on codegen for profiles and not sure how to handle cases where the snapshot and diff are inconsistent.  Is that something that can get updated?</p>",
        "id": 153983894,
        "sender_full_name": "Nick George",
        "timestamp": 1533764826
    },
    {
        "content": "<p>well, I will certainly fix it for R4. There's also an outstanding request for me to regenerate the R3 snapshots, but that's pretty scary... it's a great deal of work, and what's the QA process?</p>",
        "id": 153983897,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533764926
    },
    {
        "content": "<p>I imagine the QA process would be a validator that makes sure all fields in elements in the diff match those fields in those elements in the snapshot</p>",
        "id": 153983901,
        "sender_full_name": "Nick George",
        "timestamp": 1533765081
    },
    {
        "content": "<p>if only it were so simple</p>",
        "id": 153983905,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533765415
    },
    {
        "content": "<p>Ok Thanks, sounds like best bet is to go with differential when there is a disagreement</p>",
        "id": 153983906,
        "sender_full_name": "Nick George",
        "timestamp": 1533766084
    },
    {
        "content": "<p>so I wrote a tool that compares structure definition differentials to the snapshots and calls out inconsistencies.  Let me know if that's something you'd be interested in taking a look at.  Most of what it found is pretty inconsequential (changed comments/definitions, or mappings that are added in differential but not present in snapshot).  Two bigger things are max number of extensions, where it looks like the differential is the correct one, and some contentReferences on profiles, where it seems that the snapshot is correct (e.g., ConsentDirective profile of Contract.term.group lists #Contract.term in the snapshot but #term in the differential)</p>",
        "id": 153985070,
        "sender_full_name": "Nick George",
        "timestamp": 1533942021
    },
    {
        "content": "<p>how does the tool work?</p>",
        "id": 153985130,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533945481
    },
    {
        "content": "<p>I mean, what langauge/platform to run it?</p>",
        "id": 153985132,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533945499
    },
    {
        "content": "<p>Java.  right now I'm writing it into our StructureDefinition -&gt; protobuf converter, but would be trivial to refactor into a standalone</p>",
        "id": 153985138,
        "sender_full_name": "Nick George",
        "timestamp": 1533946438
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"196561\">@Nick George</span> , we should add a standalone binary in the github package to do these verifications. hopefully others can add more checks if we missed some.</p>",
        "id": 153985154,
        "sender_full_name": "Patrik Sundberg",
        "timestamp": 1533951062
    },
    {
        "content": "<p>I would like to be able to run it from java code on winows/linux/osx - then I could built it into the standard build</p>",
        "id": 153985173,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1533959039
    },
    {
        "content": "<p>I think we can make that work</p>",
        "id": 153985240,
        "sender_full_name": "Nick George",
        "timestamp": 1533967621
    }
]