[
    {
        "content": "<p>I tried to customize FHIR validator jar file with additional rules. I cloned <a href=\"https://github.com/hapifhir/org.hl7.fhir.core\">https://github.com/hapifhir/org.hl7.fhir.core</a>. Without any code change, I run the build on master branch and got build error. Is this normal?<br>\n<a href=\"/user_uploads/10155/aGWLkTNirLYD3xPWGvXReVfz/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/aGWLkTNirLYD3xPWGvXReVfz/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/aGWLkTNirLYD3xPWGvXReVfz/image.png\"></a></div>",
        "id": 234727558,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1618510943
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> I'm seeing the same test failures when I run <code>mvn install</code> on <code>master</code></p>",
        "id": 234729902,
        "sender_full_name": "Michael O'Keefe",
        "timestamp": 1618511855
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span></p>",
        "id": 234733377,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1618513260
    },
    {
        "content": "<p>master is failing?</p>",
        "id": 234733461,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618513292
    },
    {
        "content": "<p>that's not good</p>",
        "id": 234733480,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618513298
    },
    {
        "content": "<p>in a call now</p>",
        "id": 234733482,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618513301
    },
    {
        "content": "<p>will check afterwards</p>",
        "id": 234733495,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618513307
    },
    {
        "content": "<p>I believe is one of the testing artifact: here is the failed test</p>\n<blockquote>\n<hr>\n<p>Test set: org.hl7.fhir.validation.tests.ValidationTests</p>\n<hr>\n<p>Tests run: 361, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 124.823 s &lt;&lt;&lt; FAILURE! - in org.hl7.fhir.validation.tests.ValidationTests<br>\nValidationTests.test  Time elapsed: 1.16 s  &lt;&lt;&lt; FAILURE!<br>\njava.lang.AssertionError: Test cda/example-no-styles profile: logical: Expected 24 errors, but found 25. expected:&lt;24&gt; but was:&lt;25&gt;</p>\n</blockquote>",
        "id": 234733926,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1618513454
    },
    {
        "content": "<p>so, master is currently passing all tests right now</p>",
        "id": 234734353,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618513622
    },
    {
        "content": "<p><a href=\"https://dev.azure.com/fhir-pipelines/fhir-core-library/_build?definitionId=29\">https://dev.azure.com/fhir-pipelines/fhir-core-library/_build?definitionId=29</a></p>",
        "id": 234734355,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618513623
    },
    {
        "content": "<p>let me clone and run locally</p>",
        "id": 234734373,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618513629
    },
    {
        "content": "<p>I'm getting a fail as well.. something is not right, as the CI should have caught this.</p>",
        "id": 234736262,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618514336
    },
    {
        "content": "<p>I'm going to investigate after 5</p>",
        "id": 234736277,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618514342
    },
    {
        "content": "<p>I'm in a meeting right now</p>",
        "id": 234736300,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618514346
    },
    {
        "content": "<p>This may not be related, but If you see errors with ConceptMap it could have to do with the changes that were made recently in the StructureDefinition without corresponding changes to support that also being made in org.hl7.fhir.core.   I did some work on that but it's not yet complete.  Grahame said that intends to clean that up next week.</p>",
        "id": 234737411,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1618514739
    },
    {
        "content": "<p>that's good to know, but it _shouldn't_ change the test outcomes in the core... let me double check</p>",
        "id": 234737882,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618514898
    },
    {
        "content": "<p>my meeting ended early</p>",
        "id": 234737900,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618514903
    },
    {
        "content": "<p>The whole point of having the pipelines for CI/CD for the core libraries is to prevent things like this from happening. We have a stable version of the core, pointing to a stable version of the test cases</p>",
        "id": 234738337,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618515061
    },
    {
        "content": "<p>and in theory anyone should be able to clone and run those tests without issues</p>",
        "id": 234738365,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618515072
    },
    {
        "content": "<p>What is concerning for me is that the tests passed on master, after the last release</p>",
        "id": 234738444,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618515105
    },
    {
        "content": "<p>so this points to a dependency _not_ being locked down that caused this to happen</p>",
        "id": 234738488,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618515122
    },
    {
        "content": "<p>the test in question is cda.example-no-styles</p>",
        "id": 234738659,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618515167
    },
    {
        "content": "<p>Yeah.  That sounds likely unrelated to what I mentioned.</p>",
        "id": 234738864,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1618515241
    },
    {
        "content": "<p>test case has not been updated since november so we can rule that out</p>",
        "id": 234739505,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618515473
    },
    {
        "content": "<p>Alright, so here is the issue</p>",
        "id": 234740836,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618515979
    },
    {
        "content": "<p>when the library last ran this test and passed on Monday, the following was output</p>",
        "id": 234740938,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516025
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>** Logical:   Load hl7.fhir.cda#current - 109 resources (00:51.0261)\n</code></pre></div>",
        "id": 234740958,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516030
    },
    {
        "content": "<p>and now when we run, we get the following:</p>",
        "id": 234740970,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516034
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>  Load hl7.fhir.cda#current - 107 resources (02:37.0171)\n</code></pre></div>",
        "id": 234741072,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516076
    },
    {
        "content": "<p>sorry reverse that</p>",
        "id": 234741133,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516093
    },
    {
        "content": "<p>we got 107 when we ran before, and now we get 109</p>",
        "id": 234741167,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516107
    },
    {
        "content": "<p>and now, it says we get 25 errors, not the expected 24</p>",
        "id": 234741253,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516146
    },
    {
        "content": "<p>the error that is occurring now, that was not occurring before is:</p>",
        "id": 234741319,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516172
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>http://terminology.hl7.org/ValueSet/v3-ParticipationType), and a code is required from this value set) (error message = Unknown Code http://terminology.hl7.org/CodeSystem/v3-ParticipationType#RPLC in http://terminology.hl7.org/CodeSystem/v3-ParticipationType)\nERROR: ClinicalDocument.componentOf.encompassingEncounter.encounterParticipant[0].typeCode: Value is &#39;CON&#39; but must be &#39;DOC&#39;\n</code></pre></div>",
        "id": 234741328,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516177
    },
    {
        "content": "<p>The behavior of the validator has not changed, this appears to be an update in the external dependency hl7.fhir.cda#current</p>",
        "id": 234741615,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516295
    },
    {
        "content": "<p>my first reaction would be to update the test case to expect the 25 errors, as opposed to the currently expected 24</p>",
        "id": 234741666,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516322
    },
    {
        "content": "<p>HOWEVER, I don't really know what I'm doing 99% of the time, and I haven't worked with CDA before</p>",
        "id": 234741748,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516345
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Grahame is off for his birthday, can you please take a look at what I've posted above and let me know what you think?</p>",
        "id": 234741821,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516371
    },
    {
        "content": "<p>or <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> <span class=\"user-mention\" data-user-id=\"191647\">@Michael O'Keefe</span>  who can I talk to about CDA</p>",
        "id": 234741952,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618516434
    },
    {
        "content": "<p>All I can tell is that the error points that something is wrong with resolving a membership in a value set - <code>CON</code> is a valid value for <code> ClinicalDocument.componentOf.encompassingEncounter.encounterParticipant[0].typeCode</code>, while <code>DOC</code> is not. The value set in question confirms that: <a href=\"https://terminology.hl7.org/2.1.0/ValueSet-v3-ParticipationType.html\">https://terminology.hl7.org/2.1.0/ValueSet-v3-ParticipationType.html</a></p>",
        "id": 234743504,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1618517043
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> seems to be the main contributor to <a href=\"https://github.com/HL7/cda-core-2.0\">https://github.com/HL7/cda-core-2.0</a>, which is the source for the <code>hl7.fhir.cda</code> IG</p>",
        "id": 234743530,
        "sender_full_name": "Michael O'Keefe",
        "timestamp": 1618517044
    },
    {
        "content": "<p>I'm just casually observing this thread, but it seems to me a bad idea to have test cases that rely on <code>#current</code> of an external IG that is actively being developed.  So... realizing I have no skin in this game, I'm still going to suggest that if these tests must rely on an external IG, at least evaluate if they can depend on a <em>fixed version</em> of that IG.</p>",
        "id": 234743554,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1618517055
    },
    {
        "content": "<p>I agree</p>",
        "id": 234744016,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618517246
    },
    {
        "content": "<p>That's a larger conversation though</p>",
        "id": 234744051,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618517259
    },
    {
        "content": "<p>hopefully <span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> can shed some light on the recent changes</p>",
        "id": 234744144,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618517286
    },
    {
        "content": "<p>reviewing</p>",
        "id": 234747194,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518524
    },
    {
        "content": "<p>there's definitely an issue in the cda-core-2.0 IG</p>",
        "id": 234747557,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518664
    },
    {
        "content": "<p>trying to figure out what the right solution si</p>",
        "id": 234747573,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518670
    },
    {
        "content": "<p>thanks Sean</p>",
        "id": 234747680,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618518718
    },
    {
        "content": "<p>the cda-core-2.0 repo is missing the <code>EncounterParticipant</code> class</p>",
        "id": 234747683,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518719
    },
    {
        "content": "<p>I will get it added now, stay tuned</p>",
        "id": 234747737,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518726
    },
    {
        "content": "<p>having said that... <code>...encounterParticipant[0].typeCode</code> is just a type <code>code</code>, with no specific binding</p>",
        "id": 234747826,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518772
    },
    {
        "content": "<p>so, I'm not sure why you're getting that validation error</p>",
        "id": 234747837,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518778
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>    &lt;element id=&quot;EncompassingEncounter.encounterParticipant.typeCode&quot;&gt;\n      &lt;path value=&quot;EncompassingEncounter.encounterParticipant.typeCode&quot;/&gt;\n      &lt;representation value=&quot;xmlAttr&quot;/&gt;\n      &lt;min value=&quot;1&quot;/&gt;\n      &lt;max value=&quot;1&quot;/&gt;\n      &lt;type&gt;\n        &lt;code value=&quot;code&quot;/&gt;\n      &lt;/type&gt;\n    &lt;/element&gt;\n</code></pre></div>",
        "id": 234747846,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618518782
    },
    {
        "content": "<p>I can look into it</p>",
        "id": 234748589,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618519060
    },
    {
        "content": "<p>but in the meantime, is this change something you can rollback? or is this intentional</p>",
        "id": 234748673,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618519088
    },
    {
        "content": "<p>nm</p>",
        "id": 234749249,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519375
    },
    {
        "content": "<p>found the problem</p>",
        "id": 234749251,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519377
    },
    {
        "content": "<p>I was looking at an outdated version of the repository</p>",
        "id": 234749279,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519388
    },
    {
        "content": "<p>EncounterParticipant was just added yesterday by a colleague</p>",
        "id": 234749300,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519400
    },
    {
        "content": "<p>looks like <code>typeCode</code> was mistakenly fixed to LOC</p>",
        "id": 234749332,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519415
    },
    {
        "content": "<p>copy/paste error I suspect</p>",
        "id": 234749354,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519423
    },
    {
        "content": "<p>easy fix</p>",
        "id": 234749361,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519427
    },
    {
        "content": "<p>doing now</p>",
        "id": 234749365,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519429
    },
    {
        "content": "<p>errr</p>",
        "id": 234749506,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519474
    },
    {
        "content": "<p>DOC, not LOC</p>",
        "id": 234749515,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519477
    },
    {
        "content": "<p>Thanks Sean</p>",
        "id": 234750047,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618519708
    },
    {
        "content": "<p>fixed</p>",
        "id": 234750349,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519845
    },
    {
        "content": "<p>CI build will pick it up and rebuild it soon</p>",
        "id": 234750356,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1618519850
    },
    {
        "content": "<p>was just about to ask</p>",
        "id": 234750367,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618519858
    },
    {
        "content": "<p>thanks</p>",
        "id": 234750370,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618519859
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> <span class=\"user-mention\" data-user-id=\"191647\">@Michael O'Keefe</span> Once that change is in, please run the tests locally again, and if there is an issue, let me know</p>",
        "id": 234750449,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618519904
    },
    {
        "content": "<p>you will most likely need to do maven clean install</p>",
        "id": 234750471,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618519914
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span>  I can confirm, this fixed the test failure</p>",
        "id": 234859678,
        "sender_full_name": "Michael O'Keefe",
        "timestamp": 1618582262
    },
    {
        "content": "<p>Nice, nice</p>",
        "id": 234859698,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618582274
    },
    {
        "content": "<p>That's good to hear</p>",
        "id": 234859703,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1618582277
    }
]