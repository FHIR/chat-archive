[
    {
        "content": "<p>Hey all,  is there a way to author a single search parameter which performs the same search on different resource types?  </p>\n<p>E.g. I have an extension which references an organisation, where the organisation acts as the custodians for the data.  The data can in theory be any resource type which can have extensions added to them.</p>\n<p>It looks like you can set the 'base' property of SearchParameter to be multiple things.  Is the best way to just list all resource types?  If so, what would the search expression look like?  All the examples I've seen so far are scoped to a single resource type, so the expression usually looks like this: Basic.extension('url').</p>\n<p>The documentation has a section on it under 'SearchParameter on Extensions':<br>\n<a href=\"https://www.hl7.org/fhir/searchparameter.html#srch\" target=\"_blank\" title=\"https://www.hl7.org/fhir/searchparameter.html#srch\">https://www.hl7.org/fhir/searchparameter.html#srch</a></p>\n<p>Where it states that multiple resource searches should use the base 'DomainResource', and that the xpath should be set to the extension url.  However it doesn't say what you're supposed to do with the expression.  If you omit the expression (in HAPI at least), the server returns an error.</p>",
        "id": 153901683,
        "sender_full_name": "Andrew Broadbent",
        "timestamp": 1502384357
    },
    {
        "content": "<p>use a FHIRPath expression. Here's an example:</p>",
        "id": 153901805,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1502400312
    },
    {
        "content": "<p>FamilyMemberHistory.condition.code | DeviceRequest.code.as(CodeableConcept) | AllergyIntolerance.code | AllergyIntolerance.reaction.substance | Procedure.code | List.code | ProcedureRequest.code | Observation.code | DiagnosticReport.code | Condition.code</p>",
        "id": 153901806,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1502400427
    },
    {
        "content": "<p>see <a href=\"http://hl7.org/fhir/searchparameter-registry.html\" target=\"_blank\" title=\"http://hl7.org/fhir/searchparameter-registry.html\">http://hl7.org/fhir/searchparameter-registry.html</a></p>",
        "id": 153901807,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1502400432
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Thanks for your response.</p>\n<p>Sorry but I'm having a little trouble understanding your example, do you mean that string would be the value of the 'expression' node?  I've just tried uploading the following, but I get an error that 'All paths in a single SearchParameter must match the same resource type'.</p>\n<p>&lt;SearchParameter xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n    &lt;name value=\"Annotation\"/&gt;<br>\n    &lt;status value=\"active\"/&gt;<br>\n    &lt;code value=\"annotation\"/&gt;<br>\n    &lt;base value=\"DomainResource\"/&gt;<br>\n    &lt;type value=\"reference\"/&gt;<br>\n    &lt;expression value=\"Basic.extension('http://www.elabdev.org/StructureDefinition/AnnotationRef')|Patient.extension('http://www.elabdev.org/StructureDefinition/AnnotationRef')\"/&gt;<br>\n    &lt;xpathUsage value=\"normal\"/&gt;<br>\n &lt;/SearchParameter&gt;</p>",
        "id": 153902079,
        "sender_full_name": "Andrew Broadbent",
        "timestamp": 1502444545
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> - this looks like an issue in HAPI one way or another</p>",
        "id": 153902124,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1502451230
    },
    {
        "content": "<p>Agreed.</p>\n<p><span class=\"user-mention\" data-user-id=\"192995\">@Andrew Broadbent</span> can you file a bug in the HAPI FHIR issue tracker about this?</p>",
        "id": 153902145,
        "sender_full_name": "James Agnew",
        "timestamp": 1502454189
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  Sure no problem.</p>",
        "id": 153902146,
        "sender_full_name": "Andrew Broadbent",
        "timestamp": 1502454231
    }
]