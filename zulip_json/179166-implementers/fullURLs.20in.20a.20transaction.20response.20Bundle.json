[
    {
        "content": "<p>Hello,  I need some help about fullURLs in a transaction-response Bundle.</p>\n<p>The FHIR spec says,<br>\n2.36.4 Resource URL &amp; Uniqueness rules in a bundle.<br>\nA given version of a resource SHALL only appear once in each Bundle. </p>\n<p>And the conformance rule \"bdl-7\" says that <br>\n\"FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)\"</p>\n<p>Does it apply to transaction response Bundle?</p>\n<p>When I have a transaction bundle which updates a Patient resource and then reads the Patient,<br>\nmy understanding is that the response bundle includes two Patient resources <br>\nwith same fullURL and same meta.versionId. </p>\n<p>Does it break the conformance rule bdl-7? <br>\nIs my understanding correct ? </p>\n<p>Thanks.</p>",
        "id": 202752287,
        "sender_full_name": "Gou Masuda",
        "timestamp": 1593729653
    },
    {
        "content": "<p>Why would you do an update and a read in the same transaction - given that the update will implicitly give you a read response - at least if you ask it to?  In any event, yes, this would violate the constraint and create an invalid instance.</p>",
        "id": 202754087,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593731244
    },
    {
        "content": "<p>Thank you for your reply. </p>\n<p>We are currently implementing a FHIR server. When implementing its transaction bundle processing, I was wondering how we should implement the rules stated in the spec 2.36.4.</p>\n<p>This example is just an example for illustration. I've read your answer and understand that it is unusual case.<br>\nWhen the server receives such a transaction Bundle, should the server return an invalid Bundle response ?<br>\nOr should it return an error?</p>\n<p>Thanks.</p>",
        "id": 202851974,
        "sender_full_name": "Gou Masuda",
        "timestamp": 1593829590
    },
    {
        "content": "<p>It would be best to return an error - returning an invalid instance would make the server non-conformant.  If you like, you can submit a change request and we can explore documenting this edge case in the spec.</p>",
        "id": 202853979,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593833495
    },
    {
        "content": "<p>Thank you for your suggestion. Following your advice, we 'll choose to return an error instead of an invalid response.</p>",
        "id": 203059045,
        "sender_full_name": "Gou Masuda",
        "timestamp": 1594084893
    }
]