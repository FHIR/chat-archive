[
    {
        "content": "<p>Hi,</p>",
        "id": 153836789,
        "sender_full_name": "Michal",
        "timestamp": 1467908811
    },
    {
        "content": "<p>Hi, <br>\nI'm currently working integrating FHIR Questionnaire and QuestionnaireResponse structures with our system. Was able to solve most of the problems but got stuck with a specific problem.<br>\nIn our system we have questions that can have multiple answers:<br>\nQuestion: \"What are your interests?\"<br>\nPossible Multiple Answers: \"Books, Cycling, Running, Movies\"</p>\n<p>I'm using HAPI servers to test my structures, and alwasy receving error message \"Multiple answers to non repeating question with linkId[Link3]\"<br>\nQuestionnaire id: 89655 and 89656<br>\nCan't create QuestionnaireResponse recored due to mentioned error.</p>\n<p>Anyone that can help ?</p>\n<p>structure that I'm POSTing</p>\n<p>{<br>\n  \"resourceType\": \"QuestionnaireResponse\",<br>\n  \"status\": \"in-progress\",<br>\n  \"questionnaire\": {<br>\n    \"reference\": \"Questionnaire/89656\"<br>\n  },<br>\n  \"group\": {<br>\n    \"group\": [<br>\n      {<br>\n        \"linkId\": \"Link0\",<br>\n        \"title\": \"General information about patient\",<br>\n        \"text\": \"GENERAL INFORMATION\",<br>\n        \"question\": [<br>\n          {<br>\n            \"linkId\": \"Link1\",<br>\n            \"text\": \"Full Name\",<br>\n            \"answer\": [<br>\n              {<br>\n                \"valueString\": \"James Earl Carter\"<br>\n              }<br>\n            ]<br>\n          },<br>\n          {<br>\n            \"linkId\": \"Link2\",<br>\n            \"text\": \"Subscriber Member ID\",<br>\n            \"answer\": [<br>\n              {<br>\n                \"valueString\": \"12344321\"<br>\n              }<br>\n            ]<br>\n          },<br>\n          {<br>\n            \"linkId\": \"Link3\",<br>\n            \"text\": \"Service multiple options\",<br>\n            \"answer\": [<br>\n              {<br>\n                \"valueCoding\": {<br>\n                  \"system\": \"<a href=\"http://our.code.system.com\" target=\"_blank\" title=\"http://our.code.system.com\">http://our.code.system.com</a>\",<br>\n                  \"code\": \"Option1\"<br>\n                }<br>\n              },<br>\n              {<br>\n                \"valueCoding\": {<br>\n                  \"system\": \"<a href=\"http://our.code.system.com\" target=\"_blank\" title=\"http://our.code.system.com\">http://our.code.system.com</a>\",<br>\n                  \"code\": \"Option3\"<br>\n                }<br>\n              }<br>\n            ]<br>\n          }<br>\n        ]<br>\n      }<br>\n    ]<br>\n  }<br>\n}</p>",
        "id": 153836791,
        "sender_full_name": "Michal",
        "timestamp": 1467909481
    },
    {
        "content": "<p>Is the Questionnaire.question marked as repeating=true?</p>",
        "id": 153836792,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1467911671
    },
    {
        "content": "<p>Problem is that you repeated the answer at the value level, not the answer level.<br>\nneed:</p>\n<div class=\"codehilite\"><pre>question\n    answer\n        value\n    answer\n       value\n</pre></div>\n\n\n<p>not what you have which is </p>\n<div class=\"codehilite\"><pre>    answer\n        value\n        value\n</pre></div>",
        "id": 153836911,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1467954414
    },
    {
        "content": "<p>I had to check the spec here: <code>http://hl7.org/fhir/questionnaireresponse.html</code> to verify this.</p>",
        "id": 153836912,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1467954447
    },
    {
        "content": "<p>(and be sure that the question is marked for repeats as Lloyd pointed out)</p>",
        "id": 153836913,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1467954471
    },
    {
        "content": "<p>His response structure looks correct to me, he is creating repeated answers. If HAPI is verifying the response structure with the corresponding Questionnaire, it looks like that questionnaire has <code>repeating</code> not set to true, as Lloyd suggests.</p>",
        "id": 153836952,
        "sender_full_name": "Pascal Pfiffner",
        "timestamp": 1467989637
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191339\">@Pascal Pfiffner</span>  that was the issue, the structure was ok, but I was just missing the \"repeating\" setting in my question.<br>\nThanks guys for help.</p>",
        "id": 153837662,
        "sender_full_name": "Michal",
        "timestamp": 1468337627
    },
    {
        "content": "<p>Are you sure? The values don't repeat, the answer does. <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> can you please verify this?</p>",
        "id": 153837719,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1468357830
    },
    {
        "content": "<p>The array markers seem to be in the right place - they're on answer, not value.  (The only place repetition occurs in the example is link3, which shows two answers each with a value.)</p>",
        "id": 153837720,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1468358015
    }
]