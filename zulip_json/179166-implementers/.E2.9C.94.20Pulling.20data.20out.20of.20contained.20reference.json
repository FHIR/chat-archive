[
    {
        "content": "<p>Hi, I'm new to working with FHIR - I am trying to pull the contained Medication reference off of the MedicationRequest - the reference has an id reference to a resource in the Contained array, but I'm not able to access any of the fields using the Java client. I was able to find examples in the docs of building the xml for Contained resources, but not for accessing that data from deserialized objects</p>\n<p>This is the JSON I'm testing with: <a href=\"https://www.hl7.org/fhir/medicationrequest0302.json.html\">https://www.hl7.org/fhir/medicationrequest0302.json.html</a></p>\n<p>This is the info I want to extract:</p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;contained&quot;: [\n    {\n      &quot;resourceType&quot;: &quot;Medication&quot;,\n      &quot;id&quot;: &quot;med0320&quot;,\n      &quot;code&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;system&quot;: &quot;http://snomed.info/sct&quot;,\n            &quot;code&quot;: &quot;324252006&quot;,\n            &quot;display&quot;: &quot;Azithromycin 250mg capsule (product)&quot;\n          }\n        ]\n      }\n    }\n  ]\n</code></pre></div>\n<p>Specifically, I need</p>\n<div class=\"codehilite\"><pre><span></span><code>            &quot;system&quot;: &quot;http://snomed.info/sct&quot;,\n            &quot;code&quot;: &quot;324252006&quot;,\n            &quot;display&quot;: &quot;Azithromycin 250mg capsule (product)&quot;\n</code></pre></div>\n<p>I've tried a couple of different ways but haven't been able to access the contained info from the Java SDK.</p>\n<div class=\"codehilite\"><pre><span></span><code>private Optional&lt;Coding&gt; extractCode(MedicationRequest medicationRequest) {\n        final CodeableConcept codeableConcept = medicationRequest.getMedicationCodeableConcept();\n        return codeableConcept.getCoding().stream().findFirst();\n    }\n</code></pre></div>\n<p>produces exception</p>\n<div class=\"codehilite\"><pre><span></span><code>org.jboss.resteasy.spi.UnhandledException: org.hl7.fhir.exceptions.FHIRException: Type mismatch: the type CodeableConcept was expected, but org.hl7.fhir.r4.model.Reference was encountered\n</code></pre></div>",
        "id": 251598944,
        "sender_full_name": "Beth Werbaneth",
        "timestamp": 1630517791
    },
    {
        "content": "<p>I suspect your medicationRequest contains .medicationReference (not medicationCodeableConcept) which is just that a reference. You have to resolve the reference (the contained Medication resource). At which time you can get the Medication.code. If your medicationRequest contained a medicationCodeableConcept, then your code would probably work.</p>",
        "id": 251608130,
        "sender_full_name": "Daniel Venton",
        "timestamp": 1630521459
    },
    {
        "content": "<p>Hi Daniel, I updated the MedicationTest i'm testing with to this:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;MedicationRequest&quot;,\n  &quot;id&quot;: &quot;medrx002&quot;,\n  &quot;text&quot;: {\n    &quot;status&quot;: &quot;generated&quot;,\n    &quot;div&quot;: &quot;placeholder&quot;\n  },\n  &quot;medication&quot;: {\n    &quot;coding&quot;: [\n      {\n        &quot;system&quot;: &quot;http://www.nlm.nih.gov/research/umls/rxnorm&quot;,\n        &quot;code&quot;: &quot;856907&quot;,\n        &quot;display&quot;: &quot;Sulfamethoxazole - Trimethoprim, Tablet, 400mg - 80mg&quot;\n      }\n    ]\n  },\n  &quot;identifier&quot;: [\n    {\n      &quot;use&quot;: &quot;official&quot;,\n      &quot;system&quot;: &quot;http://www.bmc.nl/portal/prescriptions&quot;,\n      &quot;value&quot;: &quot;12345&quot;\n    }\n  ],\n  &quot;status&quot;: &quot;active&quot;,\n  &quot;intent&quot;: &quot;order&quot;,\n  &quot;authoredOn&quot;: &quot;2021-07-15&quot;,\n  &quot;requester&quot;: {\n    &quot;reference&quot;: &quot;Practitioner/f007&quot;,\n    &quot;display&quot;: &quot;Patrick Pump&quot;\n  },\n  &quot;dosageInstruction&quot;: [\n    {\n      &quot;sequence&quot;: 1,\n      &quot;text&quot;: &quot;Take one tablet daily as directed&quot;\n    }\n  ]\n}\n</code></pre></div>\n<p>I'm no longer getting the type mismatch error and am able to get a CodeableConcept, but the list of coding it returns is null. When I debug, the deserialized medication has all empty fields.</p>",
        "id": 251617646,
        "sender_full_name": "Beth Werbaneth",
        "timestamp": 1630525436
    },
    {
        "content": "<p>Shouldn't \"medication\" be called medicationCodeableConcept, that's how the [x] works. You add the type of data being provided as part of the name.</p>",
        "id": 251619605,
        "sender_full_name": "Daniel Venton",
        "timestamp": 1630526245
    },
    {
        "content": "<p>Thanks so much Daniel, that fixed it!</p>",
        "id": 251620429,
        "sender_full_name": "Beth Werbaneth",
        "timestamp": 1630526575
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"437242\">Beth Werbaneth</span> has marked this topic as resolved.</p>",
        "id": 251620486,
        "sender_full_name": "Notification Bot",
        "timestamp": 1630526604
    }
]