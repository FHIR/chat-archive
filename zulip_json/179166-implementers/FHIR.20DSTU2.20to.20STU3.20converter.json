[
    {
        "content": "<p>Does anyone have code to convert DSTU2 observations to STU3?  I will be using this for a Himss demo.  </p>",
        "id": 153870372,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486413112
    },
    {
        "content": "<p>there's code in the Java reference implementation - see org.hl7.fhir.convertors.VersionConvertor_10_20. </p>",
        "id": 153870373,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486413380
    },
    {
        "content": "<p>That is awesome.  Thanks!</p>",
        "id": 153870379,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486416417
    },
    {
        "content": "<p>I'm looking at converting DSTU2 to STU3 as well - is that the only tool available (not that it's a problem), or are there any others as well?</p>",
        "id": 153870436,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486455348
    },
    {
        "content": "<p>the only other option I know of, which is actually more reliable, is the R2/R3 conversion scripts - but using these requires more infrastructure which is not in place right now</p>",
        "id": 153870439,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486456697
    },
    {
        "content": "<p>a to do for me</p>",
        "id": 153870440,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486456700
    },
    {
        "content": "<p>Do those scripts use these maps? <a href=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/r2maps/R2toR3/Account.map\" target=\"_blank\" title=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/r2maps/R2toR3/Account.map\">https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/r2maps/R2toR3/Account.map</a></p>",
        "id": 153870441,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486456729
    },
    {
        "content": "<p>yes that's the scripts I was referring to </p>",
        "id": 153870444,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486456920
    },
    {
        "content": "<p>Ah man, I got pretty excited about getting to use those. How much more is needed to make them work?</p>",
        "id": 153870445,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486456973
    },
    {
        "content": "<p>well, they work (or they worked 4 weeks ago, and I will need to reviist them), and the code to make them work is in the unit tests for the java reference implementation - but that's the only place and it's not wrapped it elsewehre in a nice reusable form</p>",
        "id": 153870461,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486463297
    },
    {
        "content": "<p>Sounds similar to VersionConvertor_10_20.convertResource which I've just finished grasping (haven't tried running yet though)</p>",
        "id": 153870462,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486463424
    },
    {
        "content": "<p>that doesn't require any infrastructure. You just parse the resource, convert it, and then save it. </p>",
        "id": 153870463,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486463464
    },
    {
        "content": "<p>the maps require an IWorkerContext, which means you need definitions.x.zip</p>",
        "id": 153870464,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486463484
    },
    {
        "content": "<p>Aah, okay. I'll try the convertResource first then</p>",
        "id": 153870465,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486463529
    },
    {
        "content": "<p>Is there a way to convert the FHIR objects to JSON?  I noticed the FHIR-SVN library uses its own DSTU2 and DSTU3 structures.  </p>",
        "id": 153870744,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486573481
    },
    {
        "content": "<p>Oh I think I found the answer.  I didn't see the JsonParser class.  </p>",
        "id": 153870748,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486577112
    },
    {
        "content": "<p>Are these projects exported as gradle/maven projects at all? I got an all-Eclipse build working, but a gradle project would be nicer</p>",
        "id": 153870765,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486583565
    },
    {
        "content": "<p>I would like it as a maven project.  I added jar commands to the ant build files to create jars.  Then added them to my maven project.  </p>",
        "id": 153870775,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486592858
    },
    {
        "content": "<p>Is there a conversion for MedicationAdministration?  I was able to find conversions for others except for that one.  </p>",
        "id": 153870776,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486592905
    },
    {
        "content": "<p>My hope is to get these into HAPI sometime soon, at which point they'll be available as Maven artifacts and kept up to date that way..</p>",
        "id": 153870790,
        "sender_full_name": "James Agnew",
        "timestamp": 1486601761
    },
    {
        "content": "<p>So far I have tried Device, Location, Observation, and Patient which have converted successfully.  I'm hoping for MedicationAdministration.  </p>",
        "id": 153870791,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486601973
    },
    {
        "content": "<p>yes it's my intent that the maven etc distro is as part of HAPI </p>",
        "id": 153870808,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486612441
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193379\">@Jeff Chung</span> Yeah it seems to be missing, but Grahame did make a map in <a href=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/r2maps/R2toR3/MedicationAdministration.map\" target=\"_blank\" title=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/r2maps/R2toR3/MedicationAdministration.map\">https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/r2maps/R2toR3/MedicationAdministration.map</a>. So if you want to pull out the infrastructure for running those from the unit tests...</p>",
        "id": 153870819,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486625172
    },
    {
        "content": "<p>Thanks Vadim</p>",
        "id": 153870889,
        "sender_full_name": "Jeff Chung",
        "timestamp": 1486663976
    },
    {
        "content": "<p>For StructureDefinition, VersionConvertor_10_20 converter mostly works well, but it misses putting the @id on elements in a few spots - is it expecting some values to be present in the DSTU2 StrucDef, or should I patch it for the cases it's missing?</p>",
        "id": 153870971,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486729205
    },
    {
        "content": "<p>If it's not working, then patching or a change request may be necessary</p>",
        "id": 153871040,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1486760371
    },
    {
        "content": "<p>the algorithm for @id changed a lot between STU2 and STU3. I didn't try and get them right in the converter - I expect to use ProfileUtilities.setElementIds after the conversion</p>",
        "id": 153871058,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486766816
    },
    {
        "content": "<p><a href=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.dstu3/src/org/hl7/fhir/dstu3/conformance/ProfileUtilities.java#L2771\" target=\"_blank\" title=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.dstu3/src/org/hl7/fhir/dstu3/conformance/ProfileUtilities.java#L2771\">ProfileUtilities.setIds</a>? I'll give it a go, looks like the right thing.</p>",
        "id": 153871089,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486817657
    },
    {
        "content": "<p>I'm getting ids like MedicationStatement:m1prescribing.effectivePeriod.start:starttidspunkt. The colons look nice and I can make sense of them - just checking that's the expected output?</p>",
        "id": 153871193,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486980380
    },
    {
        "content": "<p>yes</p>",
        "id": 153871198,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1486981592
    },
    {
        "content": "<p>Great thanks.</p>",
        "id": 153871199,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486981609
    },
    {
        "content": "<p>It's sticking sliceName on all elements - is that a big deal outside of slices? The sliceName is also what was the <a href=\"http://ElementDefinition.name\" target=\"_blank\" title=\"http://ElementDefinition.name\">ElementDefinition.name</a> before, whose value wasn't constrained before - and sliceName now needs to follow a regex. Is there a method to strip invalid characters or should I do that as post-processing?</p>",
        "id": 153871220,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486994891
    },
    {
        "content": "<p>Nevermind, it's an issue with the <a href=\"http://build.fhir.org/definitions-r2.xml.zip\" target=\"_blank\" title=\"http://build.fhir.org/definitions-r2.xml.zip\">http://build.fhir.org/definitions-r2.xml.zip</a>, it has names on everything.</p>",
        "id": 153871225,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1486998153
    },
    {
        "content": "<p>then it's wrong. </p>",
        "id": 153871248,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1487013726
    },
    {
        "content": "<p>Hey guys, how can I try these scripts ? which maven artifact will contain these ?</p>",
        "id": 153876172,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489409186
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> - can we get the R2 / R3 converter code into HAPI?</p>",
        "id": 153876266,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489437234
    },
    {
        "content": "<p>very soon! :)</p>\n<p>It's in a git branch right now, will be moved into master and deployed as a snapshot within probably the next 24 hours. The only holdup has been getting the validator updated. The 1.9.0 round of model changes broke a lot of HAPI's unit tests so it's taken a while to get those running. I actually just finally finished that work this morning.</p>",
        "id": 153876286,
        "sender_full_name": "James Agnew",
        "timestamp": 1489438388
    },
    {
        "content": "<p>Seems to me that this approach to consider a DSTU2 to STU3 converter is not a simple translation or mapping exercise.  Sure you can force DSTU2 resources to be STU 3 (and vice-versa) - but this will not work in all (FHIR Resource or Profile type) cases and with all situations without incuring some type of \"data-loss\" or potential \"data-coruption\".  A simple mapping exercise we used to test out conversion includes the following exercise Example-A (v1.0) converted to Example-B (v2.0), followed by Example-B (v2.0) converted to Example-C (v1.0) (same format as Example-A) - if Example-A and Example-C are the same your conversion works (with no data-loss).  I would want to ensure folks understand these challenges - unless I am missing something (which has been known to happen - on occassion).</p>",
        "id": 153876672,
        "sender_full_name": "Mario Hyland",
        "timestamp": 1489517614
    },
    {
        "content": "<p>you could read the introduction at <a href=\"http://build.fhir.org/r2maps.html\" target=\"_blank\" title=\"http://build.fhir.org/r2maps.html\">http://build.fhir.org/r2maps.html</a></p>",
        "id": 153876673,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489518795
    },
    {
        "content": "<p>Are there any plans for R2:ValueSet &lt;-&gt; R3:CodeSystem?</p>",
        "id": 153876847,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1489557990
    },
    {
        "content": "<p>that works. ValueSets with an inline code system are converted to a value set and a code system</p>",
        "id": 153877024,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489604866
    },
    {
        "content": "<p>ah, good.  it's just not clear from the table of conversions</p>",
        "id": 153877142,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1489620441
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> , As you mentioned on 14th march, the converters will be out as a snapshot. Are they already published ? If yes, where can I find them? Is this a separate artifact or part of an existing one</p>",
        "id": 153877634,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489730829
    },
    {
        "content": "<p>Hey, for now I am building myself and using the jar in my project, just to test out. I got a problem, since MedicationOrder is renamed to MedicationRequest how I am supposed to convert a bundle having MedicationOrder.</p>",
        "id": 153877781,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489756882
    },
    {
        "content": "<p>Right now I am getting an error <code>Unknown resource MedicationOrder</code> ?</p>",
        "id": 153877782,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489756920
    },
    {
        "content": "<p>Any ideas about above? I am getting same error for <code>MedicationOrder</code> and <code>DiagnosticOrder</code>. Though I didn't see on fhir-build-diff that<code>DiagnosticOrder</code> is replaced by which resource.</p>",
        "id": 153878101,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489915071
    },
    {
        "content": "<p>It sounds like there's something wrong with your loading conditions. </p>",
        "id": 153878178,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489920139
    },
    {
        "content": "<p>how are you loading?</p>",
        "id": 153878179,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489920142
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , This is the code which I have written </p>\n<p><code>r2ToR3Loader.loadBundle(fileInputStream, false)\nString s1 = FhirContext.forDstu3().newXmlParser().encodeResourceToString(bundle);</code></p>\n<p>It works for fileInputStream containing Immunization/Condition/Procedure/Observation/DiagnosticReport/FamilyHistory/ProcedureRequest, but it fails for DiagnosticOrder/MedicationOrder. I suspect it might be because these are deleted in STU3.</p>",
        "id": 153878206,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489925577
    },
    {
        "content": "<p>how did you prepare you r2tor3Loader?</p>",
        "id": 153878263,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489952287
    },
    {
        "content": "<p>I had checkout svn source and built the jar. I found only one way to prepare <code>r2ToR3Loader</code> which is <code>R2ToR3Loader r2ToR3Loader = new R2ToR3Loader();</code> and after that above lines are called.</p>",
        "id": 153878399,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489978642
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I think one possible reason could be I tried to use these as my dependencies </p>\n<p><code>compile (\"ca.uhn.hapi.fhir:hapi-fhir-base:2.1\")\n    compile (\"ca.uhn.hapi.fhir:hapi-fhir-structures-dstu3:2.1\")\n    compile (\"ca.uhn.hapi.fhir:hapi-fhir-structures-hl7org-dstu3:2.1\")\n    compile files('lib/org.hl7.fhir.igpublisher.jar')</code></p>\n<p><code>org.hl7.fhir.igpublisher.jar</code> is the latest which I built rest I am getting from maven. Which might be the cause, I will try to get snapshots of above thing as well</p>",
        "id": 153878461,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489983771
    },
    {
        "content": "<p>Even this didn't help.</p>",
        "id": 153878462,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489984736
    },
    {
        "content": "<p>I looked at this page as well, <a href=\"http://build.fhir.org/r2maps.html\" target=\"_blank\" title=\"http://build.fhir.org/r2maps.html\">http://build.fhir.org/r2maps.html</a>. Even this doesn't talk about <code>DiagnosticOrder</code> and <code>MedicationOrder</code>.</p>",
        "id": 153878464,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1489985893
    },
    {
        "content": "<p>I will have time to look at this in 48 hours or so, once Release 3 is out</p>",
        "id": 153878467,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1489986560
    },
    {
        "content": "<p>Hey guys any updates on this.</p>",
        "id": 153880028,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490680815
    },
    {
        "content": "<p>One new question, since codesystem and Valueset will be two different systems now. How I am supposed to reffer a CodeSystem from valueset ? </p>",
        "id": 153880215,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490768285
    },
    {
        "content": "<p>You can include a CodeSystem in a ValueSet  with compose/include (see <a href=\"https://www.hl7.org/fhir/valueset.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/valueset.html\">https://www.hl7.org/fhir/valueset.html</a>) e.g.</p>\n<div class=\"codehilite\"><pre> &lt;compose&gt;\n    &lt;include&gt;\n      &lt;system\n              value=&quot;http://..../&gt;\n    &lt;/include&gt;\n</pre></div>",
        "id": 153880216,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1490769010
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span>, Thanks for the response.  I just converted a valueset having an inline <code>codeSystem</code> with R2-&gt;R3 converter. I just got below after conversion this is the extra part we got</p>\n<div class=\"codehilite\"><pre><span></span>&lt;compose&gt;\n        &lt;include&gt;\n            &lt;system value=&quot;http://acme.com/config/fhir/codesystems/cholesterol&quot;/&gt;\n        &lt;/include&gt;\n    &lt;/compose&gt;\n</pre></div>\n\n\n<p>And in R2 was as below</p>\n<div class=\"codehilite\"><pre><span></span>    &lt;codeSystem&gt;\n        &lt;system value=&quot;http://acme.com/config/fhir/codesystems/cholesterol&quot;/&gt;\n        &lt;version value=&quot;4.2.3&quot;/&gt;\n        &lt;caseSensitive value=&quot;true&quot;/&gt;\n        &lt;concept&gt;\n            &lt;code value=&quot;chol&quot;/&gt;\n            &lt;display value=&quot;SChol&quot;/&gt;\n            &lt;definition value=&quot;Serum Cholesterol&quot;/&gt;\n            &lt;designation&gt;\n                &lt;use&gt;\n                    &lt;system value=&quot;http://acme.com/config/fhir/codesystems/internal&quot;/&gt;\n                    &lt;code value=&quot;internal-label&quot;/&gt;\n                &lt;/use&gt;\n                &lt;value value=&quot;Obdurate Labs uses this with both kinds of units...&quot;/&gt;\n            &lt;/designation&gt;\n        &lt;/concept&gt;\n    &lt;/codeSystem&gt;\n</pre></div>\n\n\n<p>I am not sure why others are not populated.</p>",
        "id": 153880218,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490770270
    },
    {
        "content": "<p>If I remember corectly <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> mentioned <code> ValueSets with an inline code system are converted to a value set and a code system</code>.</p>",
        "id": 153880219,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490770479
    },
    {
        "content": "<p>Why is written \"codesystems\" in R2, should I not be CodeSystem?  In the R2R3 map it looks like that a CodeSystem is generated: <a href=\"http://build.fhir.org/valueset-version-maps.html\" target=\"_blank\" title=\"http://build.fhir.org/valueset-version-maps.html\">http://build.fhir.org/valueset-version-maps.html</a> <a href=\"http://build.fhir.org/mapping-language.html\" target=\"_blank\" title=\"http://build.fhir.org/mapping-language.html\">http://build.fhir.org/mapping-language.html</a> (ValueSet-codeSystem\" : for src.codeSystem as vs0 make create(\"CodeSystem\") as vt0 then codeSystem(src, tgt, vs0, vt0))</p>",
        "id": 153880226,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1490777301
    },
    {
        "content": "<p>Hey thanks! One new question now ? I just tried converting  a bundle with DiagnosticOrder. The performer element is missing from the output bundles.</p>\n<div class=\"codehilite\"><pre>      &lt;performer&gt;\n            &lt;reference value=&quot;http://localhost:9997/providers/19.json&quot;/&gt;\n      &lt;/performer&gt;\n</pre></div>\n\n\n<p>This is what input file contains. The output file doesn’t have anything called performer.</p>",
        "id": 153880230,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490780894
    },
    {
        "content": "<p>where is performer defined?</p>",
        "id": 153880322,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1490817903
    },
    {
        "content": "<p>This is what my original xml looks like </p>\n<div class=\"codehilite\"><pre>                &lt;DiagnosticReport xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n                &lt;id value=&quot;86571847-d982-4af9-887c-ee8d0fccfde5&quot;/&gt;\n                &lt;code&gt;\n                    &lt;coding&gt;\n                        &lt;system value=&quot;http://localhost:9997/openmrs/ws/rest/v1/tr/concepts/07a9e3a1-5206-11e5-ae6d-0050568225ca&quot;/&gt;\n                        &lt;code value=&quot;07a9e3a1-5206-11e5-ae6d-0050568225ca&quot;/&gt;\n                        &lt;display value=&quot;Hemoglobin [Mass/volume] in Blood&quot;/&gt;\n                    &lt;/coding&gt;\n                &lt;/code&gt;\n                &lt;status value=&quot;final&quot;/&gt;\n                &lt;issued value=&quot;2015-09-04T15:17:08.000+05:30&quot;/&gt;\n                &lt;subject&gt;\n                    &lt;reference value=&quot;http://localhost:9997/api/default/patients/98001046534&quot;/&gt;\n                    &lt;display value=&quot;98001046534&quot;/&gt;\n                &lt;/subject&gt;\n                &lt;performer&gt;\n                    &lt;reference value=&quot;http://localhost:9997/providers/19.json&quot;/&gt;\n                &lt;/performer&gt;\n                &lt;encounter&gt;\n                    &lt;reference value=&quot;urn:uuid:cfd88241-3af9-4f5b-892a-980a70506f20&quot;/&gt;\n                &lt;/encounter&gt;\n                &lt;identifier&gt;\n                    &lt;value value=&quot;urn:uuid:86571847-d982-4af9-887c-ee8d0fccfde5&quot;/&gt;\n                &lt;/identifier&gt;\n                &lt;request&gt;\n                    &lt;reference value=&quot;http://172.18.46.156:8081/patients/98001046534/encounters/5c2714ce-3b5a-43e3-afd8-50fbb4c32fa4&quot;/&gt;\n                &lt;/request&gt;\n                &lt;effectiveDateTime value=&quot;2015-09-04T15:15:17.000+05:30&quot;/&gt;\n                &lt;result&gt;\n                    &lt;reference value=&quot;urn:uuid:b0a674b5-486a-4975-af43-60fe74b6ed8e&quot;/&gt;\n                &lt;/result&gt;\n            &lt;/DiagnosticReport&gt;\n</pre></div>\n\n\n<p>If you see there is a performer field. Below is the converted xml which doesn't have performer field. </p>\n<div class=\"codehilite\"><pre>            &lt;DiagnosticReport xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n                &lt;id value=&quot;86571847-d982-4af9-887c-ee8d0fccfde5&quot;/&gt;\n                &lt;identifier&gt;\n                    &lt;value value=&quot;urn:uuid:86571847-d982-4af9-887c-ee8d0fccfde5&quot;/&gt;\n                &lt;/identifier&gt;\n                &lt;status value=&quot;final&quot;/&gt;\n                &lt;code&gt;\n                    &lt;coding&gt;\n                        &lt;system value=&quot;http://localhost:9997/openmrs/ws/rest/v1/tr/concepts/07a9e3a1-5206-11e5-ae6d-0050568225ca&quot;/&gt;\n                        &lt;code value=&quot;07a9e3a1-5206-11e5-ae6d-0050568225ca&quot;/&gt;\n                        &lt;display value=&quot;Hemoglobin [Mass/volume] in Blood&quot;/&gt;\n                        &lt;userSelected value=&quot;false&quot;/&gt;\n                    &lt;/coding&gt;\n                &lt;/code&gt;\n                &lt;subject&gt;\n                    &lt;reference value=&quot;http://localhost:9997/api/default/patients/98001046534&quot;/&gt;\n                    &lt;display value=&quot;98001046534&quot;/&gt;\n                &lt;/subject&gt;\n                &lt;context&gt;\n                    &lt;reference value=&quot;urn:uuid:cfd88241-3af9-4f5b-892a-980a70506f20&quot;/&gt;\n                &lt;/context&gt;\n                &lt;effectiveDateTime value=&quot;2015-09-04T15:15:17+05:30&quot;/&gt;\n                &lt;issued value=&quot;2015-09-04T15:17:08.000+05:30&quot;/&gt;\n                &lt;result&gt;\n                    &lt;reference value=&quot;urn:uuid:b0a674b5-486a-4975-af43-60fe74b6ed8e&quot;/&gt;\n                &lt;/result&gt;\n            &lt;/DiagnosticReport&gt;\n</pre></div>",
        "id": 153880349,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490844857
    },
    {
        "content": "<p>I am converting this as <code>r2ToR3Loader.loadBundle(fileInputStream, false)</code>. I have build the <code>igpublisher.jar</code> from my local checked out svn copy which has the latest build from 29th march, <br>\n`r11865 | grahameg | 2017-03-29 07:40:03 +0530 (Wed, 29 Mar 2017) | 1 line</p>\n<p>update vsCache`</p>",
        "id": 153880350,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490845193
    },
    {
        "content": "<p>I just checked the code, these lines are commented out, not sure why</p>\n<div class=\"codehilite\"><pre>//    tgt.setPerformer(convertReference(src.getPerformer()));\n//    for (org.hl7.fhir.dstu2.model.Reference t : src.getRequest())\n//      tgt.addRequest(convertReference(t));\n</pre></div>",
        "id": 153880351,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490846176
    },
    {
        "content": "<p>Any idea about above, Even I found out we are not converting <code>MedicationOrder</code> and <code>DiagnosticOrder</code>. The <code>VersionConvertor_10_30.convertResource()</code> are doesn't check for these two resources.</p>",
        "id": 153880388,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490869269
    },
    {
        "content": "<p>Hey guys any idea about above. If we are not converting above two Resources can we not throw an error. Right now if there is a bundle with <code>Encounter, Condition and MedicationOrder</code> it fails to convert the whole bundle itself because the medicationorder is unknown.</p>",
        "id": 153880569,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1490933731
    },
    {
        "content": "<p>so i</p>",
        "id": 153880696,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491186162
    },
    {
        "content": "<p>so I'll have time to look at this stuff this week.</p>",
        "id": 153880697,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491186175
    },
    {
        "content": "<p>note that there are 2 different conversion routines: the java one, and the mapping language one. </p>",
        "id": 153880698,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491186194
    },
    {
        "content": "<p>going forward, the java one is only really supported for conformance resources, unless someone else wants to take that on. The mapping langauge one is what I intend to invest in from now on. Which is the one your invocation code relates to. I had a quick look at performer, and the mapping language looks all right to me</p>",
        "id": 153880700,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491186261
    },
    {
        "content": "<p>We are using the Java library which is published in <code>igpublisher.jar</code>. As you said *The mapping langauge one is what I intend to invest in from now on*,  Does this mean if there are any missing parts we will have to do that manually in java code by following scripts ?</p>",
        "id": 153880723,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491191778
    },
    {
        "content": "<p>there's the Java library that does the actual conversion directly, and there's the java library that implements the mapping language, and uses the mapping language files published in the spec. </p>",
        "id": 153880725,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491191966
    },
    {
        "content": "<p>the first is only maintained for the conformance resources (though I didn't bother removing the other reosurces in case someone wnated to own that).</p>",
        "id": 153880726,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491191996
    },
    {
        "content": "<p>the second is what I think you are using </p>",
        "id": 153880727,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491192000
    },
    {
        "content": "<p>yeah!</p>",
        "id": 153880731,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491192122
    },
    {
        "content": "<p>so I think we want to sort out this so that there's an easy to run it, which we don't have now. how are you running? as a java class, or as a jar?</p>",
        "id": 153880732,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491192307
    },
    {
        "content": "<p>We have added <code>igpublisher.jar</code> as a dependncy to project and then invoking <code>R2ToR3Loader</code> with DSTU2 bundles.</p>",
        "id": 153880733,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491192387
    },
    {
        "content": "<p>ok, so I will add a new class for this </p>",
        "id": 153880741,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491193349
    },
    {
        "content": "<p>I think I am missing something. What is happening now <code>R2ToR3Loader</code> is working. Internally it calls <code>VersionConvertor_10_30</code> which is not taking care of few things <br>\n1) <code>DiagnosticOrder</code><br>\n2) <code>MedicationOrder</code> there is below commented line I found in java code </p>\n<div class=\"codehilite\"><pre>//    if (src instanceof org.hl7.fhir.dstu2.model.MedicationOrder)\n//      return convertMedicationOrder((org.hl7.fhir.dstu2.model.MedicationOrder) src);\n</pre></div>\n\n\n<p>3) Performer for DiagnosticReport.<br>\n4) <code>FamilyMemberHistory.condition.onset</code> thing is changed from <code>onsetQuantity</code> to <code>onsetAge</code>. I think the mapping-scripts/java-code is not taking care of this.</p>",
        "id": 153880746,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491194434
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> As you said \"so I will add a new class for this\" what this new class will be doing ? I am a bit confused.</p>",
        "id": 153880748,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491194477
    },
    {
        "content": "<p>yes. so you're using the java conversion code directly, but not using it the way I expected it to be used. The conversion code isn't supported anymore. </p>",
        "id": 153880767,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491212493
    },
    {
        "content": "<p>I'll add a new class for you that makes it easy for you to use the right way</p>",
        "id": 153880768,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491212507
    },
    {
        "content": "<p>Okay! After adding the new class will the above issues be fixed ?</p>",
        "id": 153880769,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491212658
    },
    {
        "content": "<p>well, we'll have to see</p>",
        "id": 153880772,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491213701
    },
    {
        "content": "<p>By when can we expect this class to be there? If it is checked in SVN I can pull and build it locally as well.</p>",
        "id": 153880774,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491214128
    },
    {
        "content": "<p>see org.hl7.fhir.convertors.R2R3ConversionManager</p>",
        "id": 153880782,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491218649
    },
    {
        "content": "<p>Hey We just checked out latest code base. There is this new file, but We are not sure how to use this one. Right now what we were doing calling <code>r2ToR3Loader.loadBundle()</code> and it was doing things in expected way. The new class has not implemented anything.</p>",
        "id": 153880786,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491219036
    },
    {
        "content": "<p>I am not sure how to go forward about it. </p>",
        "id": 153880787,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491219074
    },
    {
        "content": "<p>no at present it's just the interface. See the notes at the head for how you would use it. I'll work on the implementtation</p>",
        "id": 153880788,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491219078
    },
    {
        "content": "<p>We tried these scripts. It is converting MedicationOrder as well now, didn't check deep though yet. We found below things are failing<br>\n1) Condition notes are not converted<br>\n2) DiagnosticRepoet Performer are not converted<br>\n3) FamilyMemberHistory condition onset is not converted. shouln't it rename &lt;onsetQuantity&gt; tags to &lt;onsetAge&gt; tag. While comparing I got both datatypes are Age but the tag name is changed.<br>\n4) ProcedureRequest with status request is throwing an error. I feel it has to be taken care in converter only, because outside I won't have control over it. I can't change these in DSTU2 bundle since the new status won't be available. As soon as it reaches to converter it fails saying the old status is unknown in STU3.</p>",
        "id": 153880942,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491369058
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> DiagnosticReport.performer is not converted becaue neither of you answered my question about this while I was working on the conversions. I don't have a clue how to understand the new DiagnosticReport.performer as compared to the old</p>",
        "id": 153880944,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491369664
    },
    {
        "content": "<p>Condition.notes - I overlooked this, and I don't know why </p>",
        "id": 153880945,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491369680
    },
    {
        "content": "<p>fixed, will update the posted scripts soon</p>",
        "id": 153880946,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491369696
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> any idea about the last two ? We just found a new issue, Condition with clinical status as active is not getting converted. </p>",
        "id": 153880947,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491371839
    },
    {
        "content": "<p>What I was thinking while analysisng DiagnosticReport.performer change. Initially it had performer with reference to (Organization/Practitioner). Now it has a performer.actor with same reference. We can populate the stu3 diagnosticreport.performer.actor same as dstu2 diagnosticreport.performer.</p>",
        "id": 153880948,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491372675
    },
    {
        "content": "<p>The stu3 diagnosticreport.performer.role information cannot be populated because this information doesn't exist in older structures. And it cannot be put default also because it has an example binding. That's what I was thinking.</p>",
        "id": 153880949,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491372818
    },
    {
        "content": "<p>Hey guys, The converters are failing for converting the DiagnosticOrder having more than one Item. Why are we restricting it to be only one?  How should this be fixed ?</p>",
        "id": 153880959,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491386285
    },
    {
        "content": "<p>Hello guys, I will just put what We have got today.</p>\n<div class=\"codehilite\"><pre>1) Condition notes are not converted.\n\n2) Condition with clinical status &quot;active&quot; is converted to clinical status null.\n\n3) FamilyMemberHistory condition onset is not converted. Ideally it should rename &lt;onsetQuantity&gt; tags to &lt;onsetAge&gt; tag. While comparing I got both has datatype as Age but the tag name is changed.\n\n4) ProcedureRequest with status &quot;requested&quot; is throwing an error. It should map all existing status to one of the new status. I feel it has to be taken care in converter only, because outside I won&#39;t have control over it. I can&#39;t change these in DSTU2 bundle since the new status won&#39;t be available. As soon as it reaches to converter it fails saying the old status is unknown in STU3.\n\n5) MedicationRequest.dosageInstruction.timing.repeat.boundsQuantity is not getting converted. Ideally it should rename &lt;boundsQuantity&gt; tags to &lt;boundsDuration&gt; tag. While comparing I got both has datatype as Duration but the tag name is changed.\n\n6) DiagnosticRepoet Performer is not converted. (What I was thinking while analyzing DiagnosticReport.performer change. Initially, it had the performer with reference to (Organization/Practitioner). Now it has a performer.actor with the same reference. We can populate the stu3 diagnosticreport.performer.actor same as dstu2 diagnosticreport.performer.)\n\n7) The DiagnosticOrder with more than one Item is failing. Why are we restricting it to be only one? How should this be fixed?\n\n8) The MedicationOrder dateEnded is not present in MedicationRequest. What is the idea behind removing it ? I couldn’t find a similar field.\n</pre></div>",
        "id": 153880967,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491396034
    },
    {
        "content": "<p>R3 performer = R2 performer when R3 performer.role = AUTauthor (originator).    R3 performer could be some other role as well and &lt;&gt; R3 performer.  Probably need to create a tracker to change the binding  to the v3 codes and binding strength to extensible <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span>  what do you think?</p>",
        "id": 153880996,
        "sender_full_name": "Eric Haas",
        "timestamp": 1491407277
    },
    {
        "content": "<p>ProcedureRequest is for a single item.   See how composite requests are handled <a href=\"http://hl7.org/fhir/STU3/request.html#compound\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/request.html#compound\">here</a></p>",
        "id": 153880997,
        "sender_full_name": "Eric Haas",
        "timestamp": 1491407599
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Yes, that's along the lines of what I was expecting to be able to do with DR.performer.role.  The current binding to the performer-role value set doesn't work for that (or at least doesn't provide an example for it), but changing it as you suggest I think would make sense.  I think we could have some discussion as to whether we should make it extensible and whether it should be V3 codes or a FHIR mapping to V3 (or something else).</p>",
        "id": 153881023,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1491415169
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>, thanks for the help. Right now is there a way to tell ignore the errors in the conversion. Like in issues mentioned above the 4th and 7th are throwing an error. Which causes the whole bundle to fail.</p>",
        "id": 153881073,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491458443
    },
    {
        "content": "<p>Hey guys, any updates on above.</p>",
        "id": 153881215,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491532774
    },
    {
        "content": "<p>I meant is it possible anyway to ignore errors while converting, and convert them in my code.</p>",
        "id": 153881216,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491533000
    },
    {
        "content": "<p>The above will be userful while converting something like Diagnostic Order with multiple Items, since the converter expects just one Item per DiagnosticOrder.</p>",
        "id": 153881219,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491533805
    },
    {
        "content": "<p>this is on my list to get to - but I have a lot of things to work on</p>",
        "id": 153881225,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491535394
    },
    {
        "content": "<p>ohhh okey! I wanted to know will something like this will be possible.</p>",
        "id": 153881226,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491536627
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> is there any workaround of above as of now ?</p>",
        "id": 153881495,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1491737477
    },
    {
        "content": "<p>not right now. Hoping to get to it this week, but I'm not keeping up right now</p>",
        "id": 153881518,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491774377
    },
    {
        "content": "<p>ok this is on my list for tomorrow (pinging this to get it back to the top of the topic list)</p>",
        "id": 153885106,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1492604827
    },
    {
        "content": "<p>Hello guys, is converter it not being published as a maven artifact? Right now I am using it as a jar file dependency for my project but I want to avoid it becasue it is causing conflicts with lot of other libraries.</p>",
        "id": 153886914,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1493869787
    },
    {
        "content": "<p>it should be released via HAPI for maven use. I thought that would have happened by now <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span></p>",
        "id": 153886915,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493870013
    },
    {
        "content": "<p>Yeah I gave a try but I was thinking of using <code>R2R3ConversionManager</code> class which comes with just <code>igpublisher.jar</code> file. The same doesn't come with hapi-fhir-converter. I was just checking if this is also published as part of some artifact.</p>",
        "id": 153886917,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1493870378
    },
    {
        "content": "<p>that is what is supposed to come with HAPI now</p>",
        "id": 153886918,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493870421
    },
    {
        "content": "<p>Do you mean even <code>R2R3ConversionManager</code> is supposed to come with HAPI in latest release ?</p>",
        "id": 153886919,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1493870479
    },
    {
        "content": "<p>yes</p>",
        "id": 153886920,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493870491
    },
    {
        "content": "<p>Well, Then <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> will be able to answer. I don't see it in their latest artifact on maven <code>hapi-converter-2.4</code>, neither it's in hapi-fhir github on master, so I can expect it to come as a snapshot.</p>",
        "id": 153886921,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1493870643
    },
    {
        "content": "<p>At this point we have the java converters bundled into HAPI, but not yet the <code>R2R3ConversionManager</code> one. I tried really hard to get this into HAPI 2.4, but wasn't able to. The main reason for this is that R2R3ConversionManager has a dependency on the RI parsers, which don't ship with HAPI. I need to spend some time untangling the co-depoendencies between R2R3ConversionManager and other parts of the RI and I haven't been able to find the bandwidth to do that yet.</p>\n<p>Help obviously welcomed if anyone wants to join into this effort.</p>",
        "id": 153886972,
        "sender_full_name": "James Agnew",
        "timestamp": 1493892265
    },
    {
        "content": "<p>hmm. I'll have a look at that</p>",
        "id": 153886999,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493900964
    },
    {
        "content": "<p>but i absolutely need the  elementmodel parsers. Is that a problem?</p>",
        "id": 153887000,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493900983
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> thanks for the reply. The problem I am facing right now is becasue hapi artifacts have same classname as well as package name but the code is not  same.</p>\n<p>For Example :- <a href=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.utilities/src/org/hl7/fhir/utilities/xhtml/XhtmlParser.java\" target=\"_blank\" title=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.utilities/src/org/hl7/fhir/utilities/xhtml/XhtmlParser.java\">https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.utilities/src/org/hl7/fhir/utilities/xhtml/XhtmlParser.java</a> and <a href=\"https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-base/src/main/java/org/hl7/fhir/utilities/xhtml/XhtmlParser.java\" target=\"_blank\" title=\"https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-base/src/main/java/org/hl7/fhir/utilities/xhtml/XhtmlParser.java\">https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-base/src/main/java/org/hl7/fhir/utilities/xhtml/XhtmlParser.java</a>, both have same package and class name, but in hl7-fhir file has a method <code>public XhtmlNode parseHtmlNode(XmlPullParser xpp)</code> which is not present in the file from hapi-fhir. same problem with <code>XmlParserBase#loadXml(InputStream stream)</code>. </p>\n<p>I am not able to get a way out because I need to import <code>igpublisher.jar</code> which has code from <code>hl7-fhir</code> and I need to do some modification in the resources for that I need <code>hapi-stu3</code> and <code>hapi-stu2</code> structures artifact as well. Which ends up in incompatible code.</p>",
        "id": 153887003,
        "sender_full_name": "Mritunjay Dubey",
        "timestamp": 1493901278
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> no, the elementmodel parsers are no issue, we bundle those already.</p>\n<p><span class=\"user-mention\" data-user-id=\"192421\">@Mritunjay Dubey</span> yeah, there is no way to use the RI stuff and HAPI on the same classpath. HAPI contains modifications to the RI, including stripping out the XmlPullParser as well as a few other dependencies on libraries that are either not needed or that have questionable licenses. I've been slowly rationalizing all of this, but it's a gradual process.</p>",
        "id": 153887014,
        "sender_full_name": "James Agnew",
        "timestamp": 1493901480
    },
    {
        "content": "<p>let's talk through this in Madrid</p>",
        "id": 153887015,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493901508
    },
    {
        "content": "<p>..that is to say, you can't use an RI JAR like igpublisher in the same JVM as HAPI. You can absolutely use RI classes that are included with HAPI of course :)</p>",
        "id": 153887017,
        "sender_full_name": "James Agnew",
        "timestamp": 1493901533
    },
    {
        "content": "<p>Sounds good. </p>",
        "id": 153887018,
        "sender_full_name": "James Agnew",
        "timestamp": 1493901541
    },
    {
        "content": "<p>Is there any chance of us putting the igpublisher into Maven?  (Question from a client)</p>",
        "id": 153887020,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1493901641
    },
    {
        "content": "<p>there's a chance. If someone does it or pays me to do it. </p>",
        "id": 153887022,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493901859
    },
    {
        "content": "<p>Can someone summarize the current options for converting DSTU2 or DSTU2.1 resources to STU3?  The converters bundled with HAPI appear to only address the conformance resources (at least the 2.1 converters do).  I assume the R2R3ConversionManager piece has not made it into HAPI? Thanks!</p>",
        "id": 154000091,
        "sender_full_name": "Craig McClendon",
        "timestamp": 1537988005
    },
    {
        "content": "<p>DELETE POST - answered above.</p>",
        "id": 177075521,
        "sender_full_name": "Craig McClendon",
        "timestamp": 1569949342
    },
    {
        "content": "<p>Hello all, we recently upgraded spark FHIR DSTU2 version and getting error \"Mongo document contains invalid BSON to parse\" with existing data while migrating to new version. Please share your experience if any faced such issue or any recommendation how it can be addressed.</p>\n<p>Will it work fine if we migrate directly to STU3? <br>\nWe also moved infrastructure from Azure to AWS, Windows to Linux  not sure if that is affecting it some way.</p>\n<p>Please share your thoughts.</p>",
        "id": 200231720,
        "sender_full_name": "Mridul Sharma",
        "timestamp": 1591711317
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span></p>",
        "id": 200234034,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1591712164
    },
    {
        "content": "<p>Perhaps <span class=\"user-mention\" data-user-id=\"192710\">@Kenneth Myhra</span> knows</p>",
        "id": 200234997,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1591712524
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310318\">@Mridul Sharma</span>  when was the last time you upgraded Spark? If it has been a while it could be that you need to run the RemoveDuplicateId.js script to remove a Id-field that caused trouble in newer versions of MongoDB. <a href=\"https://github.com/FirelyTeam/spark/tree/master/scripts\">https://github.com/FirelyTeam/spark/tree/master/scripts</a></p>\n<p>Also, is there an inner exception that contains some more information you could share?</p>",
        "id": 200238094,
        "sender_full_name": "Kenneth Myhra",
        "timestamp": 1591713673
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192710\">@Kenneth Myhra</span> thanks for your response. We will follow your suggestion.</p>\n<p>Actually Spark FHIR DSTU2 version we were using is from 2017 and it was never upgraded, below is the inner exception.</p>\n<p>{<br>\n  \"resourceType\": \"OperationOutcome\",<br>\n  \"issue\": [<br>\n    {<br>\n     \"severity\": \"error\",<br>\n      \"diagnostics\": \"InvalidOperationException: Mongo document contains invalid BSON to parse.\"<br>\n    },<br>\n    {<br>\n      \"severity\": \"error\",<br>\n      \"diagnostics\": \"FormatException: Type checking the data: Encountered unknown element 'Id' at location 'Resource.Id[0]' while parsing\"<br>\n    }<br>\n  ]<br>\n}</p>",
        "id": 200239435,
        "sender_full_name": "Mridul Sharma",
        "timestamp": 1591714175
    },
    {
        "content": "<p>Yep, you will need to run the mentioned script. But as always back-up before you do so :)</p>",
        "id": 200239594,
        "sender_full_name": "Kenneth Myhra",
        "timestamp": 1591714226
    },
    {
        "content": "<p>Sure, let me try it.</p>",
        "id": 200239967,
        "sender_full_name": "Mridul Sharma",
        "timestamp": 1591714346
    },
    {
        "content": "<p>And to answer your other question. Since the resources are stored as JSON and in DSTU2 format in MongoDB you would need to run a migration process to convert them to STU3</p>",
        "id": 200240182,
        "sender_full_name": "Kenneth Myhra",
        "timestamp": 1591714420
    },
    {
        "content": "<p>Sure <span class=\"user-mention\" data-user-id=\"192710\">@Kenneth Myhra</span>   will run migration process, any recommendation / best practices or any ready to use tool which can be make this process smooth for us?</p>",
        "id": 200241621,
        "sender_full_name": "Mridul Sharma",
        "timestamp": 1591714899
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310318\">@Mridul Sharma</span>  There are some tools in the HL7 FHIR specification that can do this for you, that is actually how resources in the specification are transferred from one version to the next. In a production system it will need some kind manual  supervision  to make sure you do not loose data when converting from one version to another.</p>\n<p>The tool mentioned uses the <a href=\"http://hl7.org/fhir/mapping-language.html\">mapping language</a>. You can see maps under the diff section on each resources in the FHIR specifcaion, like this for DocumentReference <a href=\"http://hl7.org/fhir/documentreference-version-maps.html\">http://hl7.org/fhir/documentreference-version-maps.html</a></p>\n<p>Depending on how many resource types you are currently using it could be trivial to just code the conversion yourself in your favorite language.</p>",
        "id": 200243826,
        "sender_full_name": "Kenneth Myhra",
        "timestamp": 1591715659
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"192710\">@Kenneth Myhra</span> , will explore these options.<br>\nI really appreciate your help.</p>",
        "id": 200244637,
        "sender_full_name": "Mridul Sharma",
        "timestamp": 1591715969
    }
]