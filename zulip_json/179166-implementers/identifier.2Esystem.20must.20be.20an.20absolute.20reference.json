[
    {
        "content": "<p>I am getting an error from Grahame's 4.0.0 server that states that the Patient.identifier.system must be an absolute reference. In this case the system identifies a business partner's system under which a certain group of patients are catologed. This system identifier was defined by the business partner and only they can understand it. It doesn't make sense to me that this is not a valid use case. I also don't see anywhere that the system must be an absolute reference. It may be convenient for a standardized understanding of the cataloging system but that it not the intent here ... only the particular business partner can understand it.</p>",
        "id": 164032592,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556055830
    },
    {
        "content": "<p>it's still important that it be an absolute reference. Is that hard?</p>",
        "id": 164033365,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556056443
    },
    {
        "content": "<blockquote>\n<p>it's still important that it be an absolute reference. Is that hard?</p>\n</blockquote>\n<p>In this case the system was specified by a business partner and they rule. I could always make a fake absolute URL but they would not understand it.</p>",
        "id": 164033577,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556056633
    },
    {
        "content": "<p>if you make a relative URI, there's no reason that someone else can't make the same, and your content couldn't be differentiated. if you make an absolute one, off a root you own, or using an oid or uuid, then that won't happen. It's super not hard to use a uuid</p>",
        "id": 164033752,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556056777
    },
    {
        "content": "<blockquote>\n<p>if you make a relative URI, there's no reason that someone else can't make the same, and your content couldn't be differentiated. if you make an absolute one, off a root you own, or using an oid or uuid, then that won't happen. It's super not hard to use a uuid</p>\n</blockquote>\n<p>Of course, it just happened to be a customer demand. So we are stuck with it. But I can always use something else; I just happened to be uploading patient information configured for that use case. In the PHD IG, patient information is always out-of-band as it is not something provided by the PHD via a STANDARD protocol.</p>",
        "id": 164036657,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556059711
    },
    {
        "content": "<p>what's the customer demand? to be non-conformant?</p>",
        "id": 164036698,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556059770
    },
    {
        "content": "<blockquote>\n<p>what's the customer demand? to be non-conformant?</p>\n</blockquote>\n<p>That's their system. In this case the data is not going to a FHIR server but to their server; they just want the data in FHIR format as there are lots of convenient tools to parse such a data model. They don't care about the transactions or any of that other stuff. Its not like anyone can read the data from where ever they put it anyways. I am also pretty sure they transform it into a proprietary form. We aim to satisfy our customers.  -- But the Patient is the only thing they can specify. Everything else is controlled by the PHD.</p>",
        "id": 164037026,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556060055
    },
    {
        "content": "<p>Why is an error and not a warning that Patient.identifier.system is not an absolute reference? There is nothing in <a href=\"http://hl7.org/fhir/R4/datatypes.html#uri\" target=\"_blank\" title=\"http://hl7.org/fhir/R4/datatypes.html#uri\">uri</a>, <a href=\"http://hl7.org/fhir/R4/datatypes-definitions.html#Identifier.system\" target=\"_blank\" title=\"http://hl7.org/fhir/R4/datatypes-definitions.html#Identifier.system\">Identifier.system</a>, or <a href=\"http://hl7.org/fhir/R4/patient.html\" target=\"_blank\" title=\"http://hl7.org/fhir/R4/patient.html\">Patient</a> to say that it must be an absolute reference.</p>",
        "id": 164040333,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1556063590
    },
    {
        "content": "<p>no but it does say it must be unique, and how else can it be?</p>",
        "id": 164040560,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556063872
    },
    {
        "content": "<p>Of course! \"The value SHALL be unique within the defined system\" and, as you said above, if several places may use the same system they may use the same value as well and the identifier may not be unique.</p>",
        "id": 164040813,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1556064151
    },
    {
        "content": "<p>Thought that means that if Identifier is used for capturing historical data where value is known but the system is unknown, the use is invalid.</p>",
        "id": 164040912,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1556064302
    },
    {
        "content": "<p>The system must be globally unique</p>",
        "id": 164041877,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1556065379
    },
    {
        "content": "<p>So that if both system and value are present, the identifier as a whole is globally unique</p>",
        "id": 164041964,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1556065445
    },
    {
        "content": "<p>Can you capture historical data where value is known but the system is unknown?<br>\nIf so, how?</p>",
        "id": 164042037,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1556065540
    },
    {
        "content": "<p>just leave system out. That usage is documented in the spec</p>",
        "id": 164043983,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556067987
    },
    {
        "content": "<p>Not my clearest day: \"The value SHALL be unique <strong>within the defined system</strong>\" If there is no system, the value will meet that condition.<br>\nThanks. <span aria-label=\"embarrassed\" class=\"emoji emoji-1f633\" role=\"img\" title=\"embarrassed\">:embarrassed:</span></p>",
        "id": 164044644,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1556068938
    },
    {
        "content": "<blockquote>\n<p>The system must be globally unique</p>\n</blockquote>\n<p>The only remark I have on that is to have something that is globally unique really requires global cooperation and typically registration of something with a global organization (such as a BT address or an IEEE system id EUI). Not all business use cases are going to go for that are are willing to pay for that. All they need to assure is that the identifier is unique within their infrastructure (whatever that may be).</p>",
        "id": 164066613,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556098743
    },
    {
        "content": "<p>UUIDs are good and supeor easy</p>",
        "id": 164069598,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1556102091
    },
    {
        "content": "<blockquote>\n<p>UUIDs are good and supeor easy</p>\n</blockquote>\n<p>True but hard to remember.</p>",
        "id": 164072158,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1556105185
    },
    {
        "content": "<p>URLs have a global registration requirement and management expectations.  You need to register for (and pay for) a domain name and the organization that owns the domain name is responsible for managing the URLs with that domain name as a base.  That provides us with the basis for a globally unique id.  Relative references bypass that and therefore aren't globally unique - which isn't allowed.</p>",
        "id": 164085447,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1556116265
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ,</p>\n<p>You indicated...</p>\n<blockquote>\n<p>just leave system out. That usage is documented in the spec</p>\n</blockquote>\n<p>By 'documented in the spec', are you referring to the fact that you can infer that usage from the \"The value SHALL be unique <strong>within the defined system</strong>\" verbiage that <span class=\"user-mention\" data-user-id=\"191682\">@Richard Townley-O'Neill</span> points out above, or is this usage documented more explicitly somewhere?  <br>\nI realize that the cardinality for system is <strong>0</strong>..1 according to the Identifier datatype definition (<a href=\"https://www.hl7.org/fhir/datatypes.html#Identifier\" target=\"_blank\" title=\"https://www.hl7.org/fhir/datatypes.html#Identifier\">https://www.hl7.org/fhir/datatypes.html#Identifier</a>); however, I have encountered a lot of contention over whether or not Identifiers with no system specified (value only Identifiers) should be permitted/propagated.</p>",
        "id": 185870560,
        "sender_full_name": "David Riddle",
        "timestamp": 1579215118
    },
    {
        "content": "<p>well, if you don't know the system, you don't know the system, so don't say it. OTOH, I strongly agree that you should know the system, and it's very bad practice (rude to your readers) not to include it if it exists</p>",
        "id": 185876754,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1579220844
    },
    {
        "content": "<p>there are lots of business contexts where you can get away with saying that there must be a system, and if you can get away with it you should</p>",
        "id": 185876778,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1579220877
    },
    {
        "content": "<p>however note that there's a classic situation where there's no situation: hardware POC testing devices that read the patient barcode, and only have value, with no system. Some gateway has to inject the right system URL somewhere based on local configuration</p>",
        "id": 185876846,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1579220931
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ,<br>\nThe specific use case I am interested in is the conversion of data from C-CDA documents into FHIR Resources.  C-CDA documents include id elements with a II datatype (An identifier that uniquely identifies a thing or object).  This II datatype supports a root attribute and an extension attribute.  The root attribute is defined as 'A unique identifier that guarantees the global uniqueness of the instance identifier.  <strong>The root alone may be the entire instance identifier</strong>' and the extension attribute is defined as 'a unique identifier within the scope of the identifier root'.   So C-CDA id/@root = FHIR Identifier.system and C-CDA id/@extension = Identifier.value when id/@extension is present, but id/@root = Identifier.value when id/@extension is not present.</p>\n<p>In my mind a C-CDA id element with only the root attribute populated falls into the 'you don't know the system' bucket, but that doesn't mean the id/Identifier should be thrown out (not saying <strong>you</strong> are suggesting that, but it has been suggested).  i.e., I think based on your comments on this thread that a C-CDA id element that looks like this '&lt;id root=\"4adc9999-7b14-12db-9fe1-0800200c9a66\"/&gt;' should be converted to a FHIR Identifier with value = 'urn:uuid:4adc9999-7b14-12db-9fe1-0800200c9a66' &amp; no system vs. throwing that identifier out/not carrying it forward since the system is not known.  Do you agree?</p>",
        "id": 185917182,
        "sender_full_name": "David Riddle",
        "timestamp": 1579269166
    },
    {
        "content": "<p>In the case of a root containing a UUID value, the system is UUID, isn't it?</p>",
        "id": 185945305,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1579287113
    },
    {
        "content": "<p>right. there's a system for 'globally unique identifiers' = <code>urn:ietf:rfc:3986</code> - that's what you should use (though it implies that the UUID above gets prefixed with <code>urni:uuid:</code> in Identifier.value</p>",
        "id": 185950533,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1579290918
    },
    {
        "content": "<p>thats's how the CDA -&gt; FHIR converters I have written work</p>",
        "id": 185950544,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1579290930
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192685\">@Vassil Peytchev</span> and <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ,<br>\nThank you.  I missed the 'urn:ietf:rfc:3986 for when the value of the identifier is itself a globally unique URI' line here <a href=\"http://build.fhir.org/datatypes.html#identifier\" target=\"_blank\" title=\"http://build.fhir.org/datatypes.html#identifier\">http://build.fhir.org/datatypes.html#identifier</a>.  <span class=\"user-mention\" data-user-id=\"191403\">@Michelle (Moseman) Miller</span> pointed that out to me today.</p>\n<blockquote>\n<p>thats's how the CDA -&gt; FHIR converters I have written work</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ,<br>\nSo for root only CDA id elements, it sounds like you are checking for the 8-4-4-4-12 UUID pattern and if found setting Identifier.system = 'urn:ietf:rfc:3986' and Identifer.value = 'urn:uuid:' + id/<strong>@root</strong>.  Is that correct? </p>\n<p>What have your CDA -&gt; FHIR converters done with root only id elements when the id/@root value does <strong>not</strong> appear to be a UUID?  Do you write those as FHIR Identifiers w/o a system, or do you throw them out?</p>",
        "id": 185960555,
        "sender_full_name": "David Riddle",
        "timestamp": 1579297214
    },
    {
        "content": "<p>id/@root can only be UUID or an OID. It is of the UID datatype, where the definition states:</p>\n<blockquote>\n<p>At this time, user-assigned identifiers SHALL only be certain character representations of ISO Object Identifiers (OID) and DCE Universally Unique Identifiers (UUID).</p>\n</blockquote>",
        "id": 185961289,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1579297697
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192685\">@Vassil Peytchev</span> ,</p>\n<p>It seems unlikely, but it sounds like a <strong>root only</strong> id element with an OID vs. a UUID in the id/@root (e.g., &lt;id root=\"1.9.999.114350.9.99.999.2.7.2.99\"&gt;) is possible/permitted.  Is that correct?</p>",
        "id": 185963937,
        "sender_full_name": "David Riddle",
        "timestamp": 1579299821
    },
    {
        "content": "<p>Yes, id/@root can only be a UUID (system urn:ietf:rfc:3986, value urn:uuid: + id/@root) or an OID (system urn:ietf:rfc:3986 value urn:oid: + id/@root)</p>",
        "id": 185964508,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1579300390
    }
]