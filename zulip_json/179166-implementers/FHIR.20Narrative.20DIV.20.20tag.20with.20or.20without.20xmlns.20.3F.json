[
    {
        "content": "<p>Hi all,<br>\nwhen writing a resource that contains an xhtml div tag, is the xmlns attribute requested or optional ? When I have a look at the FHIR specs it is not mentioned but when I have a look at the HAPI validator source, this attribute is requested.<br>\nThanks</p>",
        "id": 153897034,
        "sender_full_name": "Mordekhai Oziel",
        "timestamp": 1500282565
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"193842\">@Mordekhai Oziel</span>, when you are serializing to XML, then I think you should always generate an XML namespace attribute on the div tag, as this element is not part of the FHIR namespace.</p>",
        "id": 153897036,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1500282947
    },
    {
        "content": "<blockquote>\n<p>Hi <span class=\"user-mention\" data-user-id=\"193842\">@Mordekhai Oziel</span>, when you are serializing to XML, then I think you should always generate an XML namespace attribute on the div tag, as this element is not part of the FHIR namespace.</p>\n</blockquote>\n<p>Thanks for your quick help</p>",
        "id": 153897037,
        "sender_full_name": "Mordekhai Oziel",
        "timestamp": 1500283048
    },
    {
        "content": "<p>Hi all,<br>\nis there a reason why in DSTU2 the validation of resources containing a div tag did not require an xmlns and from DSTU3 it seems to be required ? <br>\nIs it required only when serializing xml or also for a json resource containing such a div tag ?<br>\nDoes anybody know why in FHIR specs(<a href=\"https://www.hl7.org/fhir/dstu2/narrative.html#xhtml\" target=\"_blank\" title=\"https://www.hl7.org/fhir/dstu2/narrative.html#xhtml\">https://www.hl7.org/fhir/dstu2/narrative.html#xhtml</a>) we can see that a div without xmlns is legal ?</p>\n<p>\"div\": \"&lt;div&gt;text&lt;/div&gt;\"<br>\nis legal, but this is not:</p>\n<p>\"div\": \"&lt;?xml ...&gt;&lt;div&gt;text&lt;/div&gt;\"</p>\n<p>Thanks</p>",
        "id": 153897059,
        "sender_full_name": "Mordekhai Oziel",
        "timestamp": 1500292582
    },
    {
        "content": "<p>&lt;?xml&gt; is an XML declaration, that is different from the namespace xmlns declaration</p>",
        "id": 153897060,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1500293429
    },
    {
        "content": "<p>The declaration might be not legal because it's just an xhtml snippet and not a full-blown, standalone XML document</p>",
        "id": 153897061,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1500293495
    },
    {
        "content": "<p>See:</p>\n<blockquote>\n<p>The XHTML content SHALL NOT contain a head, a body element, external stylesheet references, deprecated elements, scripts, forms, base/link/xlink, frames, iframes, objects or event related attributes </p>\n</blockquote>\n<p>It's pretty stripped down</p>",
        "id": 153897062,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1500293540
    },
    {
        "content": "<p>I think the XHTML Namespace on the div element is only required when serializing to XML. JSON doesn't have namespaces.<br>\nThe &lt;?xml... is a pre-processing tag that can only occur at the beginning of an XML document.</p>",
        "id": 153897064,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1500295770
    },
    {
        "content": "<blockquote>\n<p>I think the XHTML Namespace on the div element is only required when serializing to XML. JSON doesn't have namespaces.<br>\nThe &lt;?xml... is a pre-processing tag that can only occur at the beginning of an XML document.</p>\n</blockquote>\n<p>Thank you <span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> , if I am correct, even when you write a JSON resource your div field contains xhtml and according to the HAPI validator, when you validate a JSON resource containing such a div tag without xmlns, you get an error.<br>\nI am a little bit confused here...</p>\n<p>Thanks</p>",
        "id": 153897065,
        "sender_full_name": "Mordekhai Oziel",
        "timestamp": 1500296103
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"193842\">@Mordekhai Oziel</span>, not sure about JSON validator, as I mainly work in XML space myself. The \"&lt;div...&gt;...&lt;/div&gt;\" part is actually an XHTML fragment, not a complete document. Namespace on the div element could be useful/necessary when client logic wants to merge the fragment into a containing XHTML page, depending on the processing logic.</p>",
        "id": 153897066,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1500296627
    },
    {
        "content": "<p>I think it's best to always include the namespace on div element in both XHTML and JSON, so the formats are interchangeable.</p>",
        "id": 153897067,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1500296703
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> , Sorry I should precise a little bit more  of context:<br>\nI am writing a validation service that accepts FHIR resources in both XML and JSON formats, deserialize them and validate them.<br>\nWe noticed that when we work on objects that contain div tags missing xmlns we get an error from the HAPI validator.<br>\nHere is an example:<br>\n{<br>\n    \"resourceType\": \"StructureDefinition\",<br>\n         ...<br>\n          \"text\": {<br>\n        \"status\": \"generated\",<br>\n        \"div\": \"&lt;div&gt;abc&lt;/div&gt;\"<br>\n    },<br>\n    ...<br>\n}</p>\n<p>Here is the error: ERROR: StructureDefinition.text.div: Wrong namespace on the XHTML ('null')</p>\n<p>According to the answers I got from you and <span class=\"user-mention\" data-user-id=\"191363\">@Vadim Peretokin</span> , I understand that the xmlns should always be provided. But how can I say this is \"mandatory\" to my users when I can't see anything about it in the FHIR specs ?<br>\nDo you think it is an error from the validator that should accept div without xmlns or do you think FHIR specs are incomplete ?<br>\nSorry to ask several times the same question but I am new to the FHIR world.</p>\n<p>Thank you for your help</p>",
        "id": 153897069,
        "sender_full_name": "Mordekhai Oziel",
        "timestamp": 1500297062
    },
    {
        "content": "<p>I see your point. It is mandatory for XML since it's a different namespace, but JSON doesn't have that idea of them. The .NET validator seems to be fine with it either way, and since nothing is mentioned about it in the spec, I'd say it seems HAPI is adding an extra constraint in here</p>",
        "id": 153897071,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1500298035
    },
    {
        "content": "<blockquote>\n<p>I see your point. It is mandatory for XML since it's a different namespace, but JSON doesn't have that idea of them. The .NET validator seems to be fine with it either way, and since nothing is mentioned about it in the spec, I'd say it seems HAPI is adding an extra constraint in here</p>\n</blockquote>\n<p>Thanks a lot <img alt=\":+1:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f44d.png\" title=\":+1:\"></p>",
        "id": 153897075,
        "sender_full_name": "Mordekhai Oziel",
        "timestamp": 1500298822
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"193842\">@Mordekhai Oziel</span>, maybe you should discuss this with the HAPI team (<span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>)?</p>",
        "id": 153897179,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1500365669
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> , thanks for this contact, I'll do.</p>",
        "id": 153897188,
        "sender_full_name": "Mordekhai Oziel",
        "timestamp": 1500368084
    },
    {
        "content": "<p>the spec says:<br>\n\"The XHTML &lt;div&gt; element in the Narrative datatype is represented as a single escaped string of XHTML. This is to avoid problems in JSON with mixed content, etc. The XHTML SHALL still conform to the rules described for the Narrative\"</p>",
        "id": 153897613,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1500633917
    },
    {
        "content": "<p>the rules for the narrative say that it is xhtml, according to the xhtml spec. So the namespace must be present, as shown in all the examples. We could make this a little more explicit in the JSON page, but it certainly must be present</p>",
        "id": 153897614,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1500633975
    },
    {
        "content": "<p>Yeah, that's something I should add. You can find it under <a href=\"https://github.com/ewoutkramer/fhir-net-api/issues/402\" target=\"_blank\" title=\"https://github.com/ewoutkramer/fhir-net-api/issues/402\">https://github.com/ewoutkramer/fhir-net-api/issues/402</a></p>",
        "id": 153897665,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1500639967
    }
]