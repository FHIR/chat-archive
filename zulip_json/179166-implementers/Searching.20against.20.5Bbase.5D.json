[
    {
        "content": "<p>What is the recommended structure of the response when a search is performed against the base URL, i.e.<br>\n  GET [base]?[parameters]{&amp;_format=[mime-type]}<br>\nI was hoping to see some examples of how mixed-type response bundles are structured, but <a href=\"https://www.hl7.org/fhir/bundle-examples.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/bundle-examples.html\">https://www.hl7.org/fhir/bundle-examples.html</a> examples are still in to-do status.<br>\nWould it be bad form to have an encompassing bundle, comprised of smaller bundles for each resource type? Or is it preferable to have all resource results in a flat bundle?<br>\nConsidering it from an implementer's perspective, there might be a preference to have each resource type within its own bundle, but very interested in the community's thoughts on this.<br>\nThanks!</p>",
        "id": 153973201,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1530640599
    },
    {
        "content": "<p>All the resources must be flat in the root Bundle</p>",
        "id": 153973205,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1530643803
    },
    {
        "content": "<p>The only time you'll see Bundles as the entries in a searchset is if your search includes results from the Bundle endpoint</p>",
        "id": 153973206,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1530643844
    },
    {
        "content": "<p>where's the todo status?</p>",
        "id": 153973222,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530648700
    },
    {
        "content": "<p><a href=\"https://www.hl7.org/fhir/bundle-response-medsallergies.xml.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/bundle-response-medsallergies.xml.html\">https://www.hl7.org/fhir/bundle-response-medsallergies.xml.html</a></p>",
        "id": 153973226,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1530650055
    },
    {
        "content": "<p><a href=\"https://www.hl7.org/fhir/bundle-response-simplesummary.xml.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/bundle-response-simplesummary.xml.html\">https://www.hl7.org/fhir/bundle-response-simplesummary.xml.html</a></p>",
        "id": 153973227,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1530650064
    },
    {
        "content": "<p>In our particular scenario, we have separate DB repositories each for Observations, Immunizations, and MedicationStatements. Each of these exist as a separate API endpoint at the moment, each providing their own bundled searchset responses. <br>\nIf we want to offer a consolidated [base] endpoint for consumers, does that mean we need a middle layer to call each of these repositories, unpack the response bundles, and repack them into a flattened bundle for the ultimate response? Are there any other options, e.g. using a bundle of bundles? I didn't see anything in the FHIR spec explicitly forbidding this (as opposed to nested contains, which are strictly forbidden).</p>",
        "id": 153973230,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1530650768
    },
    {
        "content": "<p>Search results need to be returned consistently or systems won't be able to process them.  When you respond to a query,you're acting as though all of the data resides on your server.  The actual organization of the data is opaque to the recipient.  All of the URLs need to be expressed as though the data is local.  If you feel that's not clear from the current specification, please submit a change request and we'll make things more explicit.</p>",
        "id": 153973234,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1530651842
    },
    {
        "content": "<blockquote>\n<p>All of the URLs need to be expressed as though the data is local</p>\n</blockquote>",
        "id": 153973405,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530727585
    },
    {
        "content": "<p>umm?</p>",
        "id": 153973406,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530727587
    },
    {
        "content": "<p>because why?</p>",
        "id": 153973407,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530727591
    },
    {
        "content": "<p>the rest is true, and you'll need some kind of middleware / proxy to return a search as the client expects.</p>",
        "id": 153973408,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530727616
    },
    {
        "content": "<p>So when you query endpoint 1, you can get results from endpoint 2?</p>",
        "id": 153973414,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1530729049
    },
    {
        "content": "<p>sure. we've never said you can't do that, and there are solutions out there doing that</p>",
        "id": 153973423,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530733219
    },
    {
        "content": "<p>Do we call attention to the fact that it <em>is</em> allowed anywhere?  Because some people might find it surprising.  (I did :))</p>",
        "id": 153973424,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1530733335
    },
    {
        "content": "<p>I don't think so</p>",
        "id": 153973428,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530733905
    },
    {
        "content": "<p><a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17447\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17447\">GF#17447</a></p>",
        "id": 153973465,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1530739552
    },
    {
        "content": "<p>Thank you Graham, Lloyd for your input!</p>",
        "id": 153973766,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1530802421
    },
    {
        "content": "<p>At the end of <a href=\"https://www.hl7.org/fhir/search.html#_type\" target=\"_blank\" title=\"https://www.hl7.org/fhir/search.html#_type\">https://www.hl7.org/fhir/search.html#_type</a>, there is a statement \"In other contexts, searches on multiple types may allow resource specific search parameters\" regarding searching against the [base_url]/ without specifying any resources.<br>\nCould <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> or <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> elaborate on the phrase \"in other contexts\"?<br>\nWould a server be allowed to define an endpoint as &lt;<a href=\"http://sampleorg.com/fhir/STU3/?patient.identifier=9900123\" target=\"_blank\" title=\"http://sampleorg.com/fhir/STU3/?patient.identifier=9900123\">http://sampleorg.com/fhir/STU3/?patient.identifier=9900123</a>&gt; , where all resources (of all types) that have search param \"patient\" would be returned?  We know that [baseurl/Patient?$everything exists, but that requires both context-setting as well as returning a Patient resource.<br>\nThanks!</p>",
        "id": 153975008,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1531427340
    },
    {
        "content": "<p>i'm not sure what 'in other contexts' means in that sentence. I think we're saying that implementers should experiment and make proposals to us regarding this</p>",
        "id": 153975321,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531701267
    },
    {
        "content": "<p>Thanks, Graham. To your knowledge, would enabling a global search via GET [BASE], allowing for patient identifier search param, break any established FHIR rules?<br>\nFor example: GET [BASE]?patient.identifier=someuri|910302, returning all resources (of all types) that contain a patient/subject with identifier someuri|910302?<br>\nOr was the \"<strong>in other contexts</strong>\" on <a href=\"https://www.hl7.org/fhir/search.html#_type\" target=\"_blank\" title=\"https://www.hl7.org/fhir/search.html#_type\">https://www.hl7.org/fhir/search.html#_type</a> specific to the use of <strong>_type</strong>, and not applicable to the global GET [BASE} search?<br>\nThanks!</p>",
        "id": 153976431,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1532027279
    },
    {
        "content": "<p>I'm not sure whether that 'breaks any established rules' because I'm not quite sure what the context of the question is. We could not define that without breaking our own rules about what we'll define, but I think that an implementer could define that as an extension. but it is outside what most servers expect - feedback has been strong that system wide searches like this across all resources are very diffiicult, which is why we are explicit about what parameters can be used across multiple resources</p>",
        "id": 153976478,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532032588
    },
    {
        "content": "<p>Specifically, we want to allow for the global search \"GET [BASE}?\" with patient.identifier as a search parameter. We're worried that would conflict with statement \"<a href=\"https://www.hl7.org/fhir/http.html#vsearch\" target=\"_blank\" title=\"https://www.hl7.org/fhir/http.html#vsearch\">When searching all resources at once, only the parameters defined for all resources can be used.</a>\" (but we were not sure if this may be allowed based on the statement \"<a href=\"https://www.hl7.org/fhir/search.html#_type\" target=\"_blank\" title=\"https://www.hl7.org/fhir/search.html#_type\">In other contexts, searches on multiple types may allow resource specific search parameters</a>.</p>\n<p>We wanted to confirm that allowing for this search parameter for a global search was not explicitly non-conformant.</p>",
        "id": 153976522,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1532035404
    },
    {
        "content": "<p>I think that given that wording, it is non compliant if you don't enumerate the types.</p>",
        "id": 153976604,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532039989
    },
    {
        "content": "<p>but I think you want Patient/$everything - that's what it sounds like. have you looked at that?</p>",
        "id": 153976605,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532040008
    },
    {
        "content": "<p>Yes, we have looked at Patient/$everything, but we currently do not serve up a Patient resource yet. Additionally, Patient/$everything (and Patient/[id]/$everything) rely on either the setting patient context or on obtaining the logical ID -- we were hoping to enable access through a patient.identifier parameter instead. We're assessing out different options at this point. Thank you!</p>",
        "id": 153976846,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1532090540
    },
    {
        "content": "<p>we've not really discussed doing patient $everything by id .... but it's certainly problematic not have patient...</p>",
        "id": 153976849,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532090848
    },
    {
        "content": "<p>The documentation documents the format as \"[base]/Patient/[id]/$everything\".(<a href=\"https://www.hl7.org/fhir/patient-operations.html#8.1.18.2\" target=\"_blank\" title=\"https://www.hl7.org/fhir/patient-operations.html#8.1.18.2\">https://www.hl7.org/fhir/patient-operations.html#8.1.18.2</a>) .</p>",
        "id": 153976861,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1532095273
    }
]