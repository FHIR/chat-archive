[
    {
        "content": "<p>How do I add extension to an element having choice data type. For example: how do I add DAR extension to Condition.onset (in JSON)?</p>",
        "id": 243563659,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1624388502
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"nt\">\"resourceType\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Condition\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"example\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"meta\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"profile\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"s2\">\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition\"</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"clinicalStatus\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://terminology.hl7.org/CodeSystem/condition-clinical\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"active\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Active\"</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">],</span>\n    <span class=\"nt\">\"text\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Active\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"verificationStatus\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://terminology.hl7.org/CodeSystem/condition-ver-status\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"confirmed\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Confirmed\"</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">],</span>\n    <span class=\"nt\">\"text\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Confirmed\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"category\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">\"coding\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://terminology.hl7.org/CodeSystem/condition-category\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"problem-list-item\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Problem List Item\"</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">],</span>\n      <span class=\"nt\">\"text\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Problem\"</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">],</span>\n  <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"text\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Single liveborn, born in hospital\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"subject\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"display\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Amy V. Shaw\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"_onsetDateTime\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"extension\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">\"url\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/data-absent-reason\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"valueCode\"</span><span class=\"p\">:</span> <span class=\"s2\">\"unknown\"</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 243606778,
        "sender_full_name": "Eric Haas",
        "timestamp": 1624423732
    },
    {
        "content": "<p><a href=\"http://JSON%20representation%20of%20primitive%20elements\">JSON representation of primitive elements</a></p>",
        "id": 243606864,
        "sender_full_name": "Eric Haas",
        "timestamp": 1624423915
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> But the interpretation of this is \"I don't know the onsetDateTime\". How do I say \"I don't know any of the onset, no matter it is onsetDatetime, or onsetPeriod, or onsetAge\". Do I need to list all the choices like</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;_onsetDateTime&quot;: {\n    &quot;extension&quot;: [\n      {\n        &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;,\n        &quot;valueCode&quot;: &quot;unknown&quot;\n      }\n    ]\n  },\n  &quot;_onsetAge&quot;: {\n    &quot;extension&quot;: [\n      {\n        &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;,\n        &quot;valueCode&quot;: &quot;unknown&quot;\n      }\n    ]\n  }\n...\n</code></pre></div>",
        "id": 243659859,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1624458519
    },
    {
        "content": "<p>good question, but note that if you knew the time and the Age you would only report one.</p>",
        "id": 243664081,
        "sender_full_name": "Eric Haas",
        "timestamp": 1624460230
    },
    {
        "content": "<p>and no you would not list them as above since max=1</p>",
        "id": 243664385,
        "sender_full_name": "Eric Haas",
        "timestamp": 1624460339
    },
    {
        "content": "<p>what you are really asking for is:</p>\n<p>\"_onset[x]\": {<br>\n    \"extension\": [<br>\n      {<br>\n        \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/data-absent-reason\">http://hl7.org/fhir/StructureDefinition/data-absent-reason</a>\",<br>\n        \"valueCode\": \"unknown\"<br>\n      }<br>\n    ]<br>\n  },</p>\n<p>which I think would be really confusing for implementers since onset[x] doesn't exist  over the wire</p>",
        "id": 243664776,
        "sender_full_name": "Eric Haas",
        "timestamp": 1624460487
    },
    {
        "content": "<p>so if the element is min=0 it is omitted.  I assume what you are asking is if the min=1</p>",
        "id": 243665225,
        "sender_full_name": "Eric Haas",
        "timestamp": 1624460659
    },
    {
        "content": "<p>Yes. I agree that using _onset[x] is confusing. So I think the current consensus is that I can pick any one of the choice and add DAR there.</p>",
        "id": 243787350,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1624542195
    },
    {
        "content": "<p>do you think we should document that.</p>",
        "id": 243807197,
        "sender_full_name": "Eric Haas",
        "timestamp": 1624550203
    },
    {
        "content": "<p>I think we should document at least in DAR extension. I don't know if other extension could have similar confusion.</p>",
        "id": 243925245,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1624632177
    },
    {
        "content": "<p>You have to pick a type.  You can't say \"I don't know independent of type\" because every instance must have a specific type.</p>",
        "id": 243936068,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1624637012
    },
    {
        "content": "<p>In US Core, the US Core DiagnosticReport Lab profile has a mandatory sliced element DiagnosticReport.effective <a href=\"/user_uploads/10155/urxlCcCB9I-9Uv1edvbsQGoC/image.png\">image.png</a>. So if I want to use DAR on that element, I have to pick one of the concrete type, either effectiveDateTime or effectivePeriod, to apply DAR extension. Is my understanding correct?</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/urxlCcCB9I-9Uv1edvbsQGoC/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/urxlCcCB9I-9Uv1edvbsQGoC/image.png\"></a></div>",
        "id": 243943576,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1624640790
    },
    {
        "content": "<p>Correct</p>",
        "id": 243970784,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1624655195
    }
]