[
    {
        "content": "<p>Can I get some help interpreting this validation error?</p>\n<p>Here's what I'm <a href=\"https://fhirvalidator.org/\">validating</a>:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n      <span class=\"nt\">\"resourceType\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Bundle\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"scratchpad-read-all-example\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"type\"</span><span class=\"p\">:</span> <span class=\"s2\">\"collection\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"entry\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"fullUrl\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/ServiceRequest/1\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"resource\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"resourceType\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ServiceRequest\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"status\"</span><span class=\"p\">:</span> <span class=\"s2\">\"draft\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"intent\"</span><span class=\"p\">:</span> <span class=\"s2\">\"proposal\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"subject\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">\"reference\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/Patient/123\"</span>\n            <span class=\"p\">}</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">},</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"fullUrl\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/MedicationRequest/1\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"resource\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">\"resourceType\"</span><span class=\"p\">:</span> <span class=\"s2\">\"MedicationRequest\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"status\"</span><span class=\"p\">:</span> <span class=\"s2\">\"draft\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"intent\"</span><span class=\"p\">:</span> <span class=\"s2\">\"proposal\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"medication\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">\"reference\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/Medication/123\"</span>\n            <span class=\"p\">},</span>\n            <span class=\"nt\">\"subject\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">\"reference\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/Patient/123\"</span>\n            <span class=\"p\">}</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">}</span>\n</code></pre></div>\n<p>The validation error is in regard to the medication reference.  The full error is:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Error Line: 27\nThe property reference must be an Object, not a primitive property (at Bundle.entry[1].resource.medication.reference)\n</code></pre></div>\n<p>I assume this is a straightforward problem, but I'm not super familiar with using the validator yet.</p>\n<p>Thanks!</p>",
        "id": 245195283,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625670401
    },
    {
        "content": "<p>So, I was able to silence the validator by changing my medication reference to look like this:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>            <span class=\"nt\">\"medication\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">\"reference\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n                <span class=\"nt\">\"reference\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/Medication/123\"</span>\n              <span class=\"p\">}</span>\n            <span class=\"p\">},</span>\n</code></pre></div>\n<p>But... is this <em>really</em> correct?</p>",
        "id": 245198163,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625671565
    },
    {
        "content": "<p>There is no such attribute medication, it is either<br>\n.. medication[x]    SÎ£  1..1        Medication to be taken<br>\nBinding: Medication Clinical Drug (extensible)<br>\n.... medicationCodeableConcept          CodeableConcept <br>\n.... medicationReference            Reference(US Core Medication Profile)   </p>\n<p>the attribute should be called medicationReference in your case.</p>",
        "id": 245198232,
        "sender_full_name": "Daniel Venton",
        "timestamp": 1625671596
    },
    {
        "content": "<p>That's what I thought at first, but when I had it this way:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>            <span class=\"nt\">\"medicationReference\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/Medication/123\"</span><span class=\"p\">,</span>\n</code></pre></div>\n<p>I got these errors:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Error Line: 25\nUnrecognised property '@medicationReference'\nError Line: 26\nMedicationRequest.medication: minimum required = 1, but only found 0 (from http://hl7.org/fhir/StructureDefinition/MedicationRequest)\n</code></pre></div>\n<p>I'm assuming I'm doing something obviously wrong, but I just don't see it.</p>",
        "id": 245199018,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625671912
    },
    {
        "content": "<p>FWIW - my first attempt was something like this, which yielded the same error.</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>            <span class=\"nt\">\"medicationReference\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">\"reference\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://example.com/Medication/123\"</span>\n            <span class=\"p\">},</span>\n</code></pre></div>",
        "id": 245199193,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625671961
    },
    {
        "content": "<p>This example on uscore: <a href=\"https://www.hl7.org/fhir/us/core/MedicationRequest-uscore-mo2.json.html\">https://www.hl7.org/fhir/us/core/MedicationRequest-uscore-mo2.json.html</a><br>\nshows it as: <br>\n  \"status\" : \"active\",<br>\n  \"intent\" : \"order\",<br>\n  \"medicationReference\" : {<br>\n    \"reference\" : \"#med2\",<br>\n    \"display\" : \"Nizatidine 15 MG/ML Oral Solution [Axid]\"<br>\n  },<br>\n  \"subject\" : {<br>\n    \"reference\" : \"Patient/example\",<br>\n    \"display\" : \"Amy Shaw\"<br>\n  },</p>\n<p>1st question to ask when dealing with a validator, do you think the validator is right?</p>",
        "id": 245200819,
        "sender_full_name": "Daniel Venton",
        "timestamp": 1625672556
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> ?</p>",
        "id": 245201528,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625672868
    },
    {
        "content": "<p>Based on your description of what is happening, and the error \"MedicationRequest.medication: minimum required = 1\", I <strong>think</strong> that the validator is validating against the R5 MedicationRequest.  It has a <code>medication</code> element that is a <code>CodeableReference</code>.  In that case, <code>\"medication\": { \"reference\": { \"reference\": \"http://...\" } }</code> would be valid.  In fact, I also just tried <code>\"medication\": { \"concept\": { \"text\": \"My Med\" } }</code> and it worked w/ 0 errors -- so that seems to confirm; it is validating against R5 -- <em>not</em> R4.</p>",
        "id": 245201699,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1625672931
    },
    {
        "content": "<p>Yeah what version are you validating against?</p>",
        "id": 245201846,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673000
    },
    {
        "content": "<p>You're looking at how the CodeableReference datatype is defined in the current build: <a href=\"http://build.fhir.org/references.html#CodeableReference\">http://build.fhir.org/references.html#CodeableReference</a></p>",
        "id": 245201969,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1625673042
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/BjhJVi_hVcik4t2KLan9Kd8X/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/BjhJVi_hVcik4t2KLan9Kd8X/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/BjhJVi_hVcik4t2KLan9Kd8X/image.png\"></a></div><p>In other words, a CodeableReference uses  the<code>reference</code> property associated with <code>Reference</code>-type element. This in turn uses a <code>reference</code> property associated with the URL of the referenced thing.</p>",
        "id": 245202007,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1625673062
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> -- when I tried it, the options <em>said</em> FHIR 4.0.1, but as noted above, it seems it is using FHIR 4.6.0 (or some other R5).</p>",
        "id": 245202043,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1625673085
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"233081\">@Carl Anderson</span> -- if you try the <a href=\"https://inferno.healthit.gov/validator/\">Inferno FHIR Validator</a> it gives the results you would expect for validating against FHIR 4.0.1 (i.e., it allows <code>medicationReference</code>).</p>",
        "id": 245202405,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1625673248
    },
    {
        "content": "<p>Let me look into why it's not validating against the correct version</p>",
        "id": 245202478,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673294
    },
    {
        "content": "<p>Github issue opened here: <a href=\"https://github.com/hapifhir/org.hl7.fhir.validator-wrapper/issues/60\">https://github.com/hapifhir/org.hl7.fhir.validator-wrapper/issues/60</a></p>",
        "id": 245202709,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673394
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> - I'm just using the online validator: <a href=\"https://fhirvalidator.org/\">https://fhirvalidator.org/</a> - I'm not sure how to tell which  spec it's using</p>",
        "id": 245203295,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625673653
    },
    {
        "content": "<p>It will say in the options</p>",
        "id": 245203320,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673664
    },
    {
        "content": "<p>I will fix it</p>",
        "id": 245203330,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673666
    },
    {
        "content": "<p>...and put an indicator on the main validation page to indicate the version more clearly</p>",
        "id": 245203374,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673683
    },
    {
        "content": "<p>Ah, there it is.  According to the options it's 4.0.1 - like Chris said.</p>",
        "id": 245203514,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625673725
    },
    {
        "content": "<p>Thanks for looking into this!</p>",
        "id": 245203537,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1625673734
    },
    {
        "content": "<p>yeah, it's def an error</p>",
        "id": 245203556,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673746
    },
    {
        "content": "<p>probably just sending \"current\" or \"4\" as the version, and the validator is upping the version to the one that it thinks is reasonable behind the scenes</p>",
        "id": 245203619,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673777
    },
    {
        "content": "<p>should be a simple ish fix</p>",
        "id": 245203632,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673783
    },
    {
        "content": "<p>I appreciate your patience, this is the first full blown website from scratch I've done, so it's provided a bunch of challenges along the way</p>",
        "id": 245203748,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625673832
    },
    {
        "content": "<p>This fix should be in now btw.</p>",
        "id": 245353603,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1625769495
    }
]