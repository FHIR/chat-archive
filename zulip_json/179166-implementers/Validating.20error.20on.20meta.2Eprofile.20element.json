[
    {
        "content": "<p>In our profiles (structuredefinitions) we sometimes populate the \"meta.profile\" element to claim resource conformance.<br>\nIn the latest Validator (5.2.13) we get an error like:<br>\n        refers to a resource that has the wrong type. Found StructureDefinition expecting one of []<br>\nI am wondering if this is correct, as the definition states the canonical should refer to a resource of type  StructureDefinition</p>",
        "id": 222059391,
        "sender_full_name": "Cees de Jonge",
        "timestamp": 1610103545
    },
    {
        "content": "<p>StructureDefinition.meta.profile would have to be a profile on StructureDefinition.  If you want to identify the profile that your profile is based on, you need to use StructureDefinition.baseDefinition.</p>",
        "id": 222076324,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610115281
    },
    {
        "content": "<p>What exactly are you sending?</p>",
        "id": 222076380,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610115316
    },
    {
        "content": "<p>We are putting indeed the url of a profile on StructureDefinition. This StructureDefinition (profile) we created ourselves and it validates.<br>\nAlso, if we replace meta.profile with the baseDefinition of the mentioned profile, for example: \"<a href=\"http://hl7.org/fhir/StructureDefinition/DetectedIssue\">http://hl7.org/fhir/StructureDefinition/DetectedIssue</a>\", we get the same error.</p>",
        "id": 222266495,
        "sender_full_name": "Cees de Jonge",
        "timestamp": 1610350359
    },
    {
        "content": "<p>Can you post exactly what your meta looks like and your error looks like?</p>",
        "id": 222313550,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610379721
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/fMNHeyXS4rNy0gJn1Sa72Tq2/ILSDetectedIssue.structuredefinition.xml\">ILSDetectedIssue.structuredefinition.xml</a> <a href=\"/user_uploads/10155/5EupZD1ILsYcnFAxHia50DXN/PHMDetectedIssue.structuredefinition.xml\">PHMDetectedIssue.structuredefinition.xml</a> </p>\n<p>When we run:</p>\n<blockquote>\n<p>java -jar ../validator-cli.jar -version 4.0 PHMDetectedIssue.structuredefinition.xml -ig .</p>\n</blockquote>\n<p>The validator produces:</p>\n<blockquote>\n<p>FHIR Validation tool Version 5.2.13 (Git# 5f67b5bad03d). Built 2020-12-24T05:16:59.673Z (19 days old)<br>\n  Java:   14.0.1 from /Library/Java/JavaVirtualMachines/openjdk-14.0.1.jdk/Contents/Home on x86_64 (64bit). 4096MB available<br>\n  Paths:  Current = /Users/nlv09090/Projects/ILS/Zulip/meta.profile, Package Cache = /Users/nlv09090/.fhir/packages<br>\n  Params: -version 4.0 PHMDetectedIssue.structuredefinition.xml -ig .<br>\nLoading<br>\n  Load FHIR v4.0 from hl7.fhir.r4.core#4.0.1 - 4575 resources (00:05.0524)<br>\n  Load hl7.terminology#2.0.0 - 3749 resources (00:01.0060)<br>\n  Terminology server <a href=\"http://tx.fhir.org\">http://tx.fhir.org</a> - Version 1.9.369 (00:03.0049)<br>\n  Load . - 2 resources (00:00.0036)<br>\n  Get set...  go (00:00.0071)<br>\nValidating<br>\n  Validate PHMDetectedIssue.structuredefinition.xml 00:00.0354<br>\nDone. Times: Loading: 00:10.0213, validation: 00:00.0355</p>\n<p><em>FAILURE</em>: 1 errors, 0 warnings, 0 notes<br>\n  Error @ StructureDefinition.differential.element[1].fixed.ofType(canonical) (line 34, col154) : Canonical URL '<a href=\"https://www.fhir.philips.com/4.0/StructureDefinition/populationHealthManagement/common/detectedIssue-v1/PHMDetectedIssue\">https://www.fhir.philips.com/4.0/StructureDefinition/populationHealthManagement/common/detectedIssue-v1/PHMDetectedIssue</a>' refers to a resource that has the wrong type. Found StructureDefinition expecting one of []</p>\n</blockquote>\n<p>I assume letting meta.profile pointing to itself does not make a difference.</p>",
        "id": 222400347,
        "sender_full_name": "Cees de Jonge",
        "timestamp": 1610437957
    },
    {
        "content": "<p>Hmm.  What you have seems right to me.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 222461724,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610470890
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/2voCLhV1pcFzyNHGjv-MSWXg/VitalSign-HL7.structuredefinition.xml\">VitalSign-HL7.structuredefinition.xml</a> <a href=\"/user_uploads/10155/npdRmfQj5Yw8atBu7obl-bN_/VitalSign.structuredefinition.xml\">VitalSign.structuredefinition.xml</a> <a href=\"/user_uploads/10155/JP93VH_EO5cmbnYqQ7Cm_PX3/VitalSign-claim.structuredefinition.xml\">VitalSign-claim.structuredefinition.xml</a> </p>\n<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <br>\nMaybe it is not how \"meta.profile\" is intended, but would it not be great if it could be used to register and validate claims of derived-profiles?<br>\nIncluded an example how we (would) use it, but a recent validator errors on it:</p>\n<blockquote>\n<p>FHIR Validation tool Version 5.2.16 (Git# f815bc8fb8f0). Built 2021-01-14T22:39:23.297Z (4 days old)<br>\n  Java:   14.0.1 from /Library/Java/JavaVirtualMachines/openjdk-14.0.1.jdk/Contents/Home on x86_64 (64bit). 4096MB available<br>\n  Paths:  Current = /Users/nlv09090/Projects/ILS/validate/meta.profile-test, Package Cache = /Users/nlv09090/.fhir/packages<br>\n  Params: VitalSign-HL7.structuredefinition.xml VitalSign-claim.structuredefinition.xml VitalSign.structuredefinition.xml -version 4.0 -ig .<br>\nLoading<br>\n  Load FHIR v4.0 from hl7.fhir.r4.core#4.0.1 - 4575 resources (00:04.0309)<br>\n  Load hl7.terminology#2.0.0 - 3749 resources (00:01.0063)<br>\n  Terminology server <a href=\"http://tx.fhir.org\">http://tx.fhir.org</a> - Version 1.9.369 (00:01.0327)<br>\n  Load . - 3 resources (00:00.0051)<br>\n  Get set...  go (00:00.0088)<br>\nValidating<br>\n  Validate VitalSign-HL7.structuredefinition.xml 00:00.0324<br>\n  Validate VitalSign-claim.structuredefinition.xml 00:00.0082<br>\n  Validate VitalSign.structuredefinition.xml 00:00.0054<br>\nDone. Times: Loading: 00:07.0078, validation: 00:00.0463 (#3)</p>\n<p>-- VitalSign-HL7.structuredefinition.xml ---------------------------------------------<br>\nSuccess: 0 errors, 0 warnings, 1 notes<br>\n  Information @ ?? : All OK</p>\n<hr>\n<p>-- VitalSign-claim.structuredefinition.xml -----------------------------------------------<br>\n<em>FAILURE</em>: 1 errors, 0 warnings, 0 notes<br>\n  Error @ StructureDefinition.differential.element[0].fixed.ofType(canonical) (line 19, col84) : Canonical URL '<a href=\"http://hl7.org/fhir/StructureDefinition/vitalsigns\">http://hl7.org/fhir/StructureDefinition/vitalsigns</a>' refers to a resource that has the wrong type. Found StructureDefinition expecting one of []</p>\n<hr>\n<p>-- VitalSign.structuredefinition.xml -----------------------------------------<br>\nSuccess: 0 errors, 0 warnings, 1 notes<br>\n  Information @ ?? : All OK</p>\n<hr>\n</blockquote>",
        "id": 223202202,
        "sender_full_name": "Cees de Jonge",
        "timestamp": 1611047829
    },
    {
        "content": "<p>To indicate that one profile is derived from another profile, you use StructureDefinition.baseDefinition</p>",
        "id": 223242304,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1611069964
    },
    {
        "content": "<p>Sure.<br>\nI was hoping the meta.profile could be a way to register conformance claims to other existing derived-profiles. I think this is something more people are interested in. Down the road this could maybe be used to validate these claims.<br>\nFrom what I understand now is that we must not and should not use the meta.profile in derived profiles?</p>",
        "id": 224004464,
        "sender_full_name": "Cees de Jonge",
        "timestamp": 1611645915
    },
    {
        "content": "<p>meta.profile on a StructureDefinition would indicate a profile <em>on</em> StructureDefinition.  E.g. one that says that short definitions are mandatory or invariants are prohibited.  I.e. it's rules for profiling, not an indication of profile relationships.</p>",
        "id": 224045983,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1611671306
    }
]