[
    {
        "content": "<p>Hey folks. I'm implementing AuthZ for SMART on FHIR on the server-side (for the CMS Interoperability Rule). It's clear to me that authorization fails to access \"/Practitioner\" urls without a \"patient/Practitioner.read\" or \"patient/*.read\" scope. But how do I determine reliably _which_ Practitioner entities a logged in patient can read? All of them? I have this same question for all of the entities in FHIR (with the exception of the Patient entity). Is how this is to be implemented specified anywhere that I can follow? Thanks!</p>",
        "id": 240629778,
        "sender_full_name": "Merlyn Albery-Speyer",
        "timestamp": 1622220056
    },
    {
        "content": "<p>You might ask on <a class=\"stream\" data-stream-id=\"179170\" href=\"/#narrow/stream/179170-smart\">#smart</a>.  I'm not sure where the patient/Practitioner scope is formally defined.</p>",
        "id": 240637032,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1622223448
    },
    {
        "content": "<p>patient/Practitioner scope is somewhat iffy because there is no association between practitioners and patients - usually it is interpreted as equivalent to user/Practitioner scope = can access all Practitioners</p>",
        "id": 240645646,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1622227599
    },
    {
        "content": "<p>For the clinical resource the meaning of the patient access scope is well defined: the client can access only those associated with the patient in context</p>",
        "id": 240645719,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1622227656
    },
    {
        "content": "<p>Thanks Lloyd, Michele. I browsed the last year of related activity in #smart and then posted my question here: <a href=\"#narrow/stream/179170-smart/topic/Context-dependent.20authorization.20.2F.20authz\">https://chat.fhir.org/#narrow/stream/179170-smart/topic/Context-dependent.20authorization.20.2F.20authz</a>.</p>",
        "id": 240646162,
        "sender_full_name": "Merlyn Albery-Speyer",
        "timestamp": 1622227883
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span> - is it sufficient then to blacklist any response from the FHIR server that references any other Patient, and otherwise let everything through (e.g. all Practitioner results)? I find it hard to reason about the security implications of that (not saying it's wrong - just that it's unclear for me).</p>",
        "id": 240646320,
        "sender_full_name": "Merlyn Albery-Speyer",
        "timestamp": 1622227973
    },
    {
        "content": "<blockquote>\n<p>is it sufficient then to blacklist any response from the FHIR server that references any other Patient, and otherwise let everything through</p>\n</blockquote>\n<p>Yes</p>",
        "id": 240646450,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1622228046
    },
    {
        "content": "<p>For non-Patient associated resources like Practitioner, Organization, Location some server do not implement the patient access scopes at all and require using the user scopes - that is probably cleaner but results in some 'strange' mixed patient / user scopes</p>",
        "id": 240646565,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1622228134
    },
    {
        "content": "<p>Here's a scenario that supports my FUD. Annotation does not reference a Patient, but appears as though it could perhaps contain sensitive PHI data in the text field: (<a href=\"https://www.hl7.org/fhir/datatypes.html#Annotation\">https://www.hl7.org/fhir/datatypes.html#Annotation</a>) - e.g. practitioner authors an annotation.</p>\n<p>{doco<br>\n  // from Element: extension<br>\n  // author[x]: Individual responsible for the annotation. One of these 2:<br>\n  \"authorReference\" : { Reference(Practitioner|Patient|RelatedPerson|Organization) },<br>\n  \"authorString\" : \"&lt;string&gt;\",<br>\n  \"time\" : \"&lt;dateTime&gt;\", // When the annotation was made<br>\n  \"text\" : \"&lt;markdown&gt;\" // R!  The annotation  - text content (as markdown)<br>\n}</p>",
        "id": 240646861,
        "sender_full_name": "Merlyn Albery-Speyer",
        "timestamp": 1622228299
    },
    {
        "content": "<p>That's a data type and not a resource</p>",
        "id": 240647049,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1622228406
    },
    {
        "content": "<p>having said that: it is surely possible that there are resources that are (1) not patient associated and (2) contain sensitive data, but when an app use patient scopes to get data about a patient it really need only patient-associated resources and those handful of resources referenced by them that are necessary for completeness: Practitioner, Organization, Location, PractitionerRole</p>",
        "id": 240648020,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1622228905
    },
    {
        "content": "<p>(Ooops. Thanks for catching my blunder). Ahh. I see. There aren't patient scopes out there for resources that are sensitive that don't link to the patient. Got it. Thanks, Michele.</p>",
        "id": 240649027,
        "sender_full_name": "Merlyn Albery-Speyer",
        "timestamp": 1622229472
    },
    {
        "content": "<p>Scopes are just strings, they can always be made up - but a server decided which one to accept</p>",
        "id": 240652573,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1622231444
    }
]