[
    {
        "content": "<p>Is there anyway of extending SMART on FHIR scope attributes ?<br>\nMy use case is to allow certain users to be tagged as administrators by the IDP so that the resource server can serve certain resources only to those authorised admin users.  </p>\n<p>Ordinary users will have the usual \"openid+fhirUser+user/<em>.</em>\" scope<br>\nI'm thinking my admin users would have something like \"openid+fhirUser+user/<em>.</em>+admin\" for the scope.</p>\n<p>Is there a need to register scope extensions ? I can't see anything in the OIDC or the Smart documentation.</p>",
        "id": 178230428,
        "sender_full_name": "David Moorhouse",
        "timestamp": 1571170220
    },
    {
        "content": "<p>My understanding is that access control rules that can't be described by SMART scopes are left to the EHR's decision control engine to handle based on context available to the EHR upon authorization and may well be specific to your use case. </p>\n<p>If your admin permissions can be adequately represented by a set of SMART scopes then you may want to consider defining a \"role\" with your IDP and assign it to your admin users. Upon authentication the IDP could add the scopes in the role to the access token.</p>",
        "id": 178233115,
        "sender_full_name": "Severin Skillman",
        "timestamp": 1571172129
    },
    {
        "content": "<p>Thanks Severin, I'll follow down that path.</p>",
        "id": 178242976,
        "sender_full_name": "David Moorhouse",
        "timestamp": 1571180385
    },
    {
        "content": "<p>This section describes adding additional scopes: <a href=\"http://hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#extensions\" target=\"_blank\" title=\"http://hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#extensions\">http://hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#extensions</a></p>",
        "id": 178280207,
        "sender_full_name": "Stephen MacVicar",
        "timestamp": 1571226013
    },
    {
        "content": "<p>That's interesting, but there is no way of registration and discovery of scope extensions as far as I can see.  It looks more like a name clash avoidance mechanism.</p>",
        "id": 178416824,
        "sender_full_name": "David Moorhouse",
        "timestamp": 1571342871
    },
    {
        "content": "<p>What I was hoping to use for was something along the lines of a scope like \"admin/system.read\" - which  would be granted to users in administrator roles.</p>",
        "id": 178426396,
        "sender_full_name": "David Moorhouse",
        "timestamp": 1571350141
    },
    {
        "content": "<p>... and \"admin/system.write\" to allow a super user to change parts of the system config.</p>",
        "id": 178426490,
        "sender_full_name": "David Moorhouse",
        "timestamp": 1571350209
    },
    {
        "content": "<p>The general pattern is [scoping]/[Resource].[action]</p>",
        "id": 178479840,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1571409435
    },
    {
        "content": "<p>If a user is involved, I would expect it to be a user/... or patient/... scope (if restricted to a specific patient record)</p>",
        "id": 178479874,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1571409463
    },
    {
        "content": "<p>Those both mean \"the app has access to do what the user can do with this resource\"</p>",
        "id": 178479939,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1571409485
    },
    {
        "content": "<p>IE: user/AllergyIntolerance.write == The application has access to write any allergies that the user can do</p>",
        "id": 178479984,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1571409521
    },
    {
        "content": "<p>What resource in FHIR is your system admin config stored?</p>",
        "id": 178479998,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1571409531
    },
    {
        "content": "<p>or if not a FHIR resource, is there a reason the \"user/...\" scope wouldn't work?</p>",
        "id": 178480093,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1571409602
    },
    {
        "content": "<p>if you need to extend it, I'm curious if there's benefit in maintaining the pattern for your use case or not :)</p>",
        "id": 178480202,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1571409646
    }
]