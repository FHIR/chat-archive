[
    {
        "content": "<p>Hi,</p>\n<p>I am looking for clarification on how to send an externally existing resources in a bundle. <br>\nI am sending a Bundle [type=”transaction”] and I want to POST a ServiceRequestand  Patient resource existing on my Server at <a href=\"http://sendingsystem/fhir/ServiceRequest/123\" target=\"_blank\" title=\"http://sendingsystem/fhir/ServiceRequest/123\">http://sendingsystem/fhir/ServiceRequest/123</a> and <a href=\"http://sendingsystem/fhir/Patient/12345\" target=\"_blank\" title=\"http://sendingsystem/fhir/Patient/12345\">http://sendingsystem/fhir/Patient/12345</a> to <a href=\"http://receivingSystem/fhir/Bundle\" target=\"_blank\" title=\"http://receivingSystem/fhir/Bundle\">http://receivingSystem/fhir/Bundle</a><br>\nAnd have the ServiceRequest and Patient saved at the respective /ServiceRequest and /Patient end points. The way I would structure the Bundle keeping in mind <a href=\"https://www.hl7.org/fhir/bundle.html#references\" target=\"_blank\" title=\"https://www.hl7.org/fhir/bundle.html#references\">https://www.hl7.org/fhir/bundle.html#references</a> is as follows:<br>\nI have used the fullUrl element as the base and then provided the respective ids for each and the transaction related operation with be a POST to the appropriate end points.<br>\nIs this approach valid and the norm?</p>\n<p>Thanks,</p>\n<p>Joel<br>\n<a href=\"/user_uploads/10155/gxYNMYb5xeM0NiiV8RrVY0tE/Transaction_External_Ref.png\" target=\"_blank\" title=\"Transaction_External_Ref.png\">Transaction_External_Ref.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/gxYNMYb5xeM0NiiV8RrVY0tE/Transaction_External_Ref.png\" target=\"_blank\" title=\"Transaction_External_Ref.png\"><img src=\"/user_uploads/10155/gxYNMYb5xeM0NiiV8RrVY0tE/Transaction_External_Ref.png\"></a></div>",
        "id": 153952166,
        "sender_full_name": "Joel Francis",
        "timestamp": 1523575434
    },
    {
        "content": "<p>Your fullUrls need to include the identifiers</p>",
        "id": 153952177,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1523580723
    },
    {
        "content": "<blockquote>\n<p>Your fullUrls need to include the identifiers</p>\n</blockquote>\n<p>Thanks <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span></p>",
        "id": 153952237,
        "sender_full_name": "Joel Francis",
        "timestamp": 1523626862
    },
    {
        "content": "<p>I have a similar usecase, but it is still not quite clear how to set <em>fullUrl</em> in my case: I want to have a client system use batch bundles to POST new Observations that do not (yet) exists as FHIR resources anywhere. These resources contain references to patients that already exist on the receiving server, and the client knows the corresponding logical IDs (so that it can put the correct relative URLs - Patient/123 etc. - into the resources being POSTed). The receiving server assigns logical IDs to created identities itself and will ignore any IDs the client sends along.</p>\n<p>In that case, it is not clear to me how the client can give a <em>fullUrl</em> since the resource does have an identity yet. Indeed, if I leave out <em>fullUrl</em> altogether (as generally allowed for POSTs in bundles), POSTing the bundle on the base URL works fine on a test server (<a href=\"http://fhirtest.uhn.ca/baseDstu3\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3\">http://fhirtest.uhn.ca/baseDstu3</a>). However the resource validator JAR gives a validation error for the corresponding bundle resource: \"Relative Reference appears inside Bundle whose entry is missing a fullUrl\". If I add a UUID as the <em>fullUrl</em>, the validator gives a warning: \"URN reference is not locally contained within the bundle Patient/abc123\".</p>\n<p>So is the best/correct option in that case to put in a generated UUID as the <em>fullUrl</em> or to leave it out altogether - or maybe some third option?</p>",
        "id": 153953395,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1524232715
    },
    {
        "content": "<blockquote>\n<p>So is the best/correct option in that case to put in a generated UUID as the <em>fullUrl</em> or to leave it out altogether - or maybe some third option?</p>\n</blockquote>\n<p>I had same case a while ago and somehow I managed to get <a class=\"stream\" data-stream-id=\"8\" href=\"/#narrow/stream/8-hapi\">#hapi</a> accepting URLs of non existent resources (it was failing at random factor). Temporary identifier you talk about is way to go. Under the hood, regardless of how you specify reference, it is resolved to <code>Patient/&lt;resource-id&gt;</code>and UUID is gone once transaction is commited.</p>",
        "id": 153953411,
        "sender_full_name": "Łukasz Dywicki",
        "timestamp": 1524237781
    },
    {
        "content": "<p>uuid: is expected in this case</p>",
        "id": 153953463,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1524258896
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195497\">@Łukasz Dywicki</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Thanks!</p>",
        "id": 153953516,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1524466355
    }
]