[
    {
        "content": "<p>I have been trying to validate some sample DaVinci resource representations with limited success. I'm running into problems that I think are related to DaVinci's dependency on VhDir. Here is DaVinci's package.json file.<br>\n{<br>\n  \"tools-version\": 3,<br>\n  \"type\": \"fhir.ig\",<br>\n  \"date\": \"20191024123102\",<br>\n  \"license\": \"CC0-1.0\",<br>\n  \"title\": \"DaVinci PDEX Plan Net\",<br>\n  \"dependencies\": {<br>\n    \"hl7.fhir.core\": \"4.0.0\",<br>\n    \"hl7.fhir.uv.vhdir\": \"0.2.0\"<br>\n  },<br>\n  \"author\": \"HL7 Financial Management WG\",<br>\n  \"directories\": {<br>\n    \"lib\": \"package\",<br>\n    \"example\": \"example\"<br>\n  },<br>\n  \"version\": \"0.1.0\",<br>\n  \"name\": \"hl7.fhir.us.davinci-pdex-plan-net\",<br>\n  \"url\": \"<a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net/2020Feb\">http://hl7.org/fhir/us/davinci-pdex-plan-net/2020Feb</a>\",<br>\n  \"canonical\": \"<a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net\">http://hl7.org/fhir/us/davinci-pdex-plan-net</a>\",<br>\n  \"fhirVersions\": [<br>\n    \"4.0.0\"<br>\n  ]<br>\n}</p>\n<p>As you can see DaVinci depends on version 0.2.0 of VhDir. From what I can tell, v0.2.0 is rather old. Here is VhDir's package.json<br>\n{<br>\n  \"type\": \"fhir.ig\",<br>\n  \"license\": \"CC0-1.0\",<br>\n  \"title\": \"Validated Healthcare Directory\",<br>\n  \"author\": \"HL7 Patient Administration Committee\",<br>\n  \"version\": \"0.2.0\",<br>\n  \"name\": \"hl7.fhir.uv.vhdir\",<br>\n  \"url\": \"<a href=\"http://hl7.org/fhir/uv/vhdir/2018Sep\">http://hl7.org/fhir/uv/vhdir/2018Sep</a>\",<br>\n  \"canonical\": \"<a href=\"http://hl7.org/fhir/uv/vhdir\">http://hl7.org/fhir/uv/vhdir</a>\",<br>\n  \"fhirVersions\": [<br>\n    \"3.5.0\"<br>\n  ],<br>\n  \"tools-version\": 3<br>\n}</p>\n<p>When I try to validate VhDir's ImplementationGuide-ig.json file I receive the following message, along with a lot more<br>\n<em>FAILURE</em> validating ImplementationGuide-ig.json:  error:255 warn:0 info:252<br>\n  Error @ ImplementationGuide.fhirVersion (line 1, col667) : This property must be an Array, not a a primitive property</p>\n<p>I'm new-ish to FHIR, so I'm speculating here ... It seems to me that the Implementation guide probably conforms to an older specification.</p>\n<p>If I change DaVinci's dependency to VhDir to \"current\", the Validator doesn't explode as badly. I can even get some representations to validate. </p>\n<p>Changing the dependency doesn't seem like the best answer to me, but it \"works\". Any guidance on what I might be doing wrong is appreciated.</p>\n<p>Thanks ... Charlie</p>",
        "id": 203204571,
        "sender_full_name": "Charlie Filkins",
        "timestamp": 1594156834
    },
    {
        "content": "<p>how are you validating it?</p>",
        "id": 203210261,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594160234
    },
    {
        "content": "<p>From the command line of my Mac, I execute</p>\n<p>java -jar org.hl7.fhir.validator.jar -version 4.0 PractitionerRole-practitionerrole1.json -ig hl7.fhir.us.davinci-pdex-plan-net#0.1.0</p>\n<p>The Validator responds with (slightly redacted)</p>\n<p>FHIR Validation tool Version 5.0.7-SNAPSHOT (Git# 6bc790d98b04). Built 2020-06-07T08:35:37.25+10:00 (31 days old)<br>\nDetected Java version: 13.0.2 from /Library/Java/JavaVirtualMachines/jdk-13.0.2.jdk/Contents/Home on x86_64 (64bit). 4096MB available<br>\nArguments: -version 4.0 PractitionerRole-practitionerrole1.json -ig hl7.fhir.us.davinci-pdex-plan-net#0.1.0<br>\nDirectories: Current = xxx, Package Cache = ~/.fhir/packages<br>\n  .. FHIR Version 4.0, definitions from hl7.fhir.r4.core#4.0.1<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n    (v4.0.1)</p>\n<ul>\n<li>.. load IG from hl7.fhir.us.davinci-pdex-plan-net#0.1.0</li>\n<li>.. load IG from hl7.fhir.uv.vhdir#0.2.0</li>\n<li>load file: ImplementationGuide-ig.json - ignored due to error: class com.google.gson.JsonPrimitive cannot be cast to class com.google.gson.JsonArray (com.google.gson.JsonPrimitive and com.google.gson.JsonArray are in unnamed module of loader 'app')<br>\njava.lang.ClassCastException: class com.google.gson.JsonPrimitive cannot be cast to class com.google.gson.JsonArray (com.google.gson.JsonPrimitive and com.google.gson.JsonArray are in unnamed module of loader 'app')<br>\n...</li>\n</ul>\n<p>There is only one instance of ImplementationGuide-ig.json on my machine. It is in ~/.fhir/packages/hl7.fhir.uv.vhdir#0.2.0</p>\n<p>Thanks for looking into this ... Charlie</p>",
        "id": 203256466,
        "sender_full_name": "Charlie Filkins",
        "timestamp": 1594207779
    },
    {
        "content": "<p>this is what I get:</p>\n<div class=\"codehilite\"><pre><span></span><code>FHIR Validation tool Version 5.0.7-SNAPSHOT (Git# 6bc790d98b04). Built 2020-06-07T08:35:37.25+10:00 (31 days old)\nDetected Java version: 1.8.0_251 from C:\\Program Files\\Java\\jre1.8.0_251 on amd64 (64bit). 14526MB available\nArguments: -version 4.0 C:/work/org.hl7.fhir/build/publish/practitionerrole-example.json -ig hl7.fhir.us.davinci-pdex-plan-net#0.1.0\nDirectories: Current = c:\\temp, Package Cache = C:\\Users\\graha\\.fhir\\packages\n  .. FHIR Version 4.0, definitions from hl7.fhir.r4.core#4.0.1\n  .. connect to tx server @ http://tx.fhir.org\n    (v4.0.1)\n+  .. load IG from hl7.fhir.us.davinci-pdex-plan-net#0.1.0\n  .. validate [C:/work/org.hl7.fhir/build/publish/practitionerrole-example.json]\nTerminology server: Check for supported code systems for http://snomed.info/sct\nSuccess...validating C:/work/org.hl7.fhir/build/publish/practitionerrole-example.json:  error:0 warn:0 info:1\n  Information @ ?? : All OK\n</code></pre></div>",
        "id": 203258987,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594209695
    },
    {
        "content": "<p>and looking at the hl7.fhir.us.davinci-pdex-plan-net#0.1.0 package, I see no reason for vhdir to get in the picture.</p>",
        "id": 203259012,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594209717
    },
    {
        "content": "<p>what do you have at ~/.fhir/packages/hl7.fhir.us.davinci-pdex-plan-net#0.1.0/package/package.json?</p>",
        "id": 203259080,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594209752
    },
    {
        "content": "<p>{<br>\n  \"tools-version\": 3,<br>\n  \"type\": \"fhir.ig\",<br>\n  \"date\": \"20191024123102\",<br>\n  \"license\": \"CC0-1.0\",<br>\n  \"title\": \"DaVinci PDEX Plan Net\",<br>\n  \"dependencies\": {<br>\n    \"hl7.fhir.core\": \"4.0.0\",<br>\n    \"hl7.fhir.uv.vhdir\": \"0.2.0\"<br>\n  },<br>\n  \"author\": \"HL7 Financial Management WG\",<br>\n  \"directories\": {<br>\n    \"lib\": \"package\",<br>\n    \"example\": \"example\"<br>\n  },<br>\n  \"version\": \"0.1.0\",<br>\n  \"name\": \"hl7.fhir.us.davinci-pdex-plan-net\",<br>\n  \"url\": \"<a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net/2020Feb\">http://hl7.org/fhir/us/davinci-pdex-plan-net/2020Feb</a>\",<br>\n  \"canonical\": \"<a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net\">http://hl7.org/fhir/us/davinci-pdex-plan-net</a>\",<br>\n  \"fhirVersions\": [<br>\n    \"4.0.0\"<br>\n  ]<br>\n}</p>",
        "id": 203260249,
        "sender_full_name": "Charlie Filkins",
        "timestamp": 1594210650
    },
    {
        "content": "<p>ok. delete the directory ~/.fhir/packages/hl7.fhir.us.davinci-pdex-plan-net#0.1.0, then run the validator again, and then tell me what's in that file</p>",
        "id": 203260731,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594211055
    },
    {
        "content": "<p>When I ran the validation, I did not specify a version for the IG, just hl7.fhir.us.davinci-pdex-plan-net. Here is the package.json<br>\n{<br>\n  \"tools-version\": 3,<br>\n  \"type\": \"fhir.ig\",<br>\n  \"date\": \"20191024123102\",<br>\n  \"license\": \"CC0-1.0\",<br>\n  \"title\": \"DaVinci PDEX Plan Net\",<br>\n  \"dependencies\": {<br>\n    \"hl7.fhir.core\": \"4.0.0\"<br>\n  },<br>\n  \"author\": \"HL7 Financial Management WG\",<br>\n  \"directories\": {<br>\n    \"lib\": \"package\",<br>\n    \"example\": \"example\"<br>\n  },<br>\n  \"version\": \"0.1.0\",<br>\n  \"name\": \"hl7.fhir.us.davinci-pdex-plan-net\",<br>\n  \"url\": \"<a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net/2020Feb\">http://hl7.org/fhir/us/davinci-pdex-plan-net/2020Feb</a>\",<br>\n  \"canonical\": \"<a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net\">http://hl7.org/fhir/us/davinci-pdex-plan-net</a>\",<br>\n  \"fhirVersions\": [<br>\n    \"4.0.0\"<br>\n  ]<br>\n}</p>\n<p>I no longer see the dependency to VhDir, but now I see errors about extensions<br>\n  Error @ PractitionerRole.extension[0] (line 14, col6) : Problem with use of resolve() - profile '[CanonicalType[http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatientprofile]]' on PractitionerRole.extension:newpatientprofile could not be resolved</p>\n<p>Please tell me if I'm providing too much information here, or not enough. Like I said before, I'm fairly new to the FHIR game.</p>\n<p>Thanks ... Charlie</p>",
        "id": 203264534,
        "sender_full_name": "Charlie Filkins",
        "timestamp": 1594213622
    },
    {
        "content": "<p>so I don't know what the vhdir thing was about.</p>",
        "id": 203314944,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594238300
    },
    {
        "content": "<p>now what you report looks like a bug somewhere. can you attach the resource you are validating?</p>",
        "id": 203315022,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594238335
    },
    {
        "content": "<p>I'm thinking that the 0.2.0 version of the VhDir fires are old and probably incompatible. Attached is a DaVinci PractitionerRole instance that I retrieved from the DaVinci Examples. <a href=\"/user_uploads/10155/QJNX6yGANerxQZk0wJB97199/PractitionerRole-practitionerrole1.json\">PractitionerRole-practitionerrole1.json</a></p>",
        "id": 203329338,
        "sender_full_name": "Charlie Filkins",
        "timestamp": 1594245752
    },
    {
        "content": "<p>Grahame ... thank you for your help with this. Do you know who I can talk to about CARIN's Implementation Guide? I suspect that version 0.2.0 is built on old standards, or is otherwise broken in some way.</p>",
        "id": 203499686,
        "sender_full_name": "Charlie Filkins",
        "timestamp": 1594383617
    },
    {
        "content": "<p>There is a <a class=\"stream\" data-stream-id=\"204607\" href=\"/#narrow/stream/204607-CARIN-Blue-Button-IG\">#CARIN Blue Button IG</a> channel</p>",
        "id": 203508806,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1594389168
    },
    {
        "content": "<p>Thanks Michele!</p>",
        "id": 203536242,
        "sender_full_name": "Charlie Filkins",
        "timestamp": 1594402582
    }
]