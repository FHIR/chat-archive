[
    {
        "content": "<p>Good morning,</p>\n<p>We found an issue when validating a bundle message, with type=document. (we tried 2 validators: Public HAPI STU3 Server and Grahames STU3 server)</p>\n<p>All the references inside the Composition resource (1st entry) are not validated(we have several references  to Practitioner Resources, and those resources do not have any entry).</p>\n<p>We expected the Validator to return error, because there weren't any resources referenced.<br>\nBut instead we've got just warnings about other stuff.</p>\n<p>Is this a bug or are we doing something wrong?</p>\n<p>Thanks in Advance,<br>\nRui</p>",
        "id": 177320018,
        "sender_full_name": "Rui Leite",
        "timestamp": 1570178295
    },
    {
        "content": "<p>can you provide an example I can add to the validator tests?</p>",
        "id": 177327100,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1570185091
    },
    {
        "content": "<p>Sure, <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> </p>\n<p>Some notes: We had to add the resource Patient for the Composition.subject to pass through the validator.</p>\n<p>On a side note:<br>\nWe have some doubts on the FHIR specification about the Composition Resource and the Composition.section.emptyReason:</p>\n<p>+ A section must at least one of text, entries, or sub-sections<br>\n+ A section can only have an emptyReason if it is empty</p>\n<p>The definition of \"empty\" can be vague because:<br>\n<strong><em>Definition: If the section is empty, why the list is empty. An empty section typically has some text explaining the empty reason.</em></strong><br>\nThe Composition.section can't have entries(?):<br>\nComposition.section.entry: <strong><em>If there are no entries in the list, an emptyReason SHOULD be provided.</em></strong></p>\n<p>A section with emptyReason has no sub-sections(?).</p>\n<p>So a Composition.section.text <em>SHALL</em> exist?</p>\n<p>Thanks.<br>\nHere's the message:<br>\n<a href=\"/user_uploads/10155/UNFqM1x49bw-mVtFxAwgQjfI/Bundle.document.json\" target=\"_blank\" title=\"Bundle.document.json\">Bundle.document.json</a></p>",
        "id": 177355395,
        "sender_full_name": "Rui Leite",
        "timestamp": 1570206344
    },
    {
        "content": "<p>ok fixed next release - 68 errors from that bundle now.</p>",
        "id": 179016876,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1571970175
    },
    {
        "content": "<p>\"A section can only have an emptyReason if it is empty\" - that is, if there is no entries. I'm not sure about sub-sections. As you say, typically there will be a narative explaining the empty reason. You could create a task to clarify this</p>",
        "id": 179016930,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1571970252
    },
    {
        "content": "<p>Just came up in the german stream: cmp-1 on composition is: <code>text.exists() or entry.exists() or section.exists()</code> which doesn't work if it is empty with an empty reason. So cmp-1 should be: <code>text.exists() or entry.exists() or section.exists() or emptyReason.exists()</code></p>",
        "id": 207240366,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1597743512
    },
    {
        "content": "<p>right?</p>",
        "id": 207240370,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1597743517
    },
    {
        "content": "<p>I agree</p>",
        "id": 207247827,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597749838
    }
]