[
    {
        "content": "<p>Can I clarify the expected behaviour if a chained query uses a parameter value that does not match any resource. </p>\n<p>eg . GET AllergyIntolerance?patient.identifier=http://mysys|100 .     If there is no patient with that identifier, then what should the response be? My understanding is that it would be an empty bundle (possibly including an informational OO ), but colleagues have looked at the wording here: <a href=\"https://www.hl7.org/fhir/search.html#errors\" target=\"_blank\" title=\"https://www.hl7.org/fhir/search.html#errors\">https://www.hl7.org/fhir/search.html#errors</a> and wonder if it should be an error...</p>",
        "id": 153911581,
        "sender_full_name": "David Hay",
        "timestamp": 1506911812
    },
    {
        "content": "<p>If we can't resolve the received patient identifier to a patient within our overall system (e.g. by asking the patient identity service), our preference is to return an error rather than introduce possible clinical risk if the client doesn't check the operation outcome and just sees the empty collection.</p>",
        "id": 153911582,
        "sender_full_name": "David Teirney",
        "timestamp": 1506912113
    },
    {
        "content": "<p>Conversely, as systems are used more widely in a regional context there's a good chance even the patient identity service we use behind the scenes (typically an EMPI) might not have knowledge of a patient identifier that the server receives.</p>",
        "id": 153911585,
        "sender_full_name": "David Teirney",
        "timestamp": 1506912888
    },
    {
        "content": "<p>If you do a search and nothing matches the criteria, you return an empty set.  The example provided of <code>[base]/Observation?subject=101</code> is a situation where you can clearly say the query is broken as they're asking for a match on a non-existing record.  But if you're searching patient.identifier, you're just not finding any matching rows.</p>",
        "id": 153911845,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506964746
    },
    {
        "content": "<p>There's no difference in behavior between patient.identifier=x and patient.gender=x</p>",
        "id": 153911846,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506964784
    },
    {
        "content": "<p>Nor is there any expectation that there should only be one patient that matches patient.identifier=http://mysys|100 like there would be with subject=101</p>",
        "id": 153911847,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506964824
    },
    {
        "content": "<p>The wording however is all \"SHOULD\".  So if you really want to raise an error, you can.  But I'd only do that if I recognized the system and the identifier value was also specified and I know that the expectation is that there should be exactly one match for that particular identifier system in the repository.</p>",
        "id": 153911848,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506964931
    },
    {
        "content": "<p>It wouldn't be a bad idea for us to add some safety guidance around the creation of chained queries that addresses this issue.</p>",
        "id": 153911849,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506964971
    },
    {
        "content": "<p>Thanks lloyd. Tracker raised: <a href=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13985\" target=\"_blank\" title=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13985\">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13985</a></p>",
        "id": 153911868,
        "sender_full_name": "David Hay",
        "timestamp": 1506970374
    }
]