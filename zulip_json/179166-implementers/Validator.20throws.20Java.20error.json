[
    {
        "content": "<p>When I install the \"official\" validator and try to validate a sample resource, Java throws an error. Here are the details. Any ideas? Java version issue?</p>\n<p>PS C:\\Program Files\\FHIR&gt; ls</p>\n<div class=\"codehilite\"><pre><span></span>Directory: C:\\Program Files\\FHIR\n</pre></div>\n\n\n<p>Mode                LastWriteTime         Length Name<br>\n----                -------------         ------ ----<br>\n-a----        8/25/2018   3:16 PM          15767 ccda-samp-disc-sum.json<br>\n-a----        8/27/2018   4:59 PM       35528413 org.hl7.fhir.validator.jar<br>\n-a----        8/29/2018  11:18 AM           3874 pat-ex.xml<br>\n-a----        8/29/2018   9:11 AM           3176 pt-123-json.txt<br>\n-a----        8/27/2018   4:59 PM           3798 readme.txt<br>\n-a----        8/29/2018  11:13 AM           2057 vx-allergy-123.json<br>\n-a----        8/29/2018   9:14 AM           5589 vxvista-pt-123.json</p>\n<p>PS C:\\Program Files\\FHIR&gt; java -jar org.hl7.fhir.validator.jar pat-ex.xml -version 3.0<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org/r4\" target=\"_blank\" title=\"http://tx.fhir.org/r4\">http://tx.fhir.org/r4</a><br>\nException in thread \"main\" java.lang.OutOfMemoryError: Java heap space<br>\n        at java.util.Arrays.copyOf(Unknown Source)<br>\n        at java.lang.AbstractStringBuilder.ensureCapacityInternal(Unknown Source)<br>\n        at java.lang.AbstractStringBuilder.append(Unknown Source)<br>\n        at java.lang.StringBuilder.append(Unknown Source)<br>\n        at org.hl7.fhir.utilities.TextFile.streamToString(TextFile.java:142)<br>\n        at org.hl7.fhir.dstu3.formats.JsonParserBase.loadJson(JsonParserBase.java:159)<br>\n        at org.hl7.fhir.dstu3.formats.JsonParserBase.parse(JsonParserBase.java:89)<br>\n        at org.hl7.fhir.convertors.R3ToR4Loader.loadBundle(R3ToR4Loader.java:37)<br>\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.loadFromFileJson(SimpleWorkerContext.java:251)<br>\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.loadDefinitionItem(SimpleWorkerContext.java:199)<br>\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.fromDefinitions(SimpleWorkerContext.java:191)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadDefinitions(ValidationEngine.java:301)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadInitialDefinitions(ValidationEngine.java:263)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.&lt;init&gt;(ValidationEngine.java:288)<br>\n        at org.hl7.fhir.r4.validation.Validator.main(Validator.java:337)<br>\nPS C:\\Program Files\\FHIR&gt; java -version<br>\njava version \"1.8.0_181\"<br>\nJava(TM) SE Runtime Environment (build 1.8.0_181-b13)<br>\nJava HotSpot(TM) Client VM (build 25.181-b13, mixed mode)<br>\nPS C:\\Program Files\\FHIR&gt;</p>\n<p>Much obliged for any guidance...</p>",
        "id": 153991634,
        "sender_full_name": "Mike Henderson",
        "timestamp": 1535558665
    },
    {
        "content": "<p>As the error says, you're running out of memory.  You may need to experiment passing -Xmx parameter to specify the amount of memory.</p>",
        "id": 153991635,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1535558822
    },
    {
        "content": "<p>I've specified -Xms and -Xmx values up to 9G (I have ~10G free)... no difference. Would the Java version matter?</p>\n<p>PS C:\\Program Files\\FHIR&gt; java -version<br>\njava version \"1.8.0_181\"<br>\nJava(TM) SE Runtime Environment (build 1.8.0_181-b13)<br>\nJava HotSpot(TM) Client VM (build 25.181-b13, mixed mode)</p>",
        "id": 153991642,
        "sender_full_name": "Mike Henderson",
        "timestamp": 1535560973
    },
    {
        "content": "<p>Can you share your instance?  I won't have a chance to dig into it today, but <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> might.</p>",
        "id": 153991645,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1535561781
    },
    {
        "content": "<p>It seems to happen with any instance. I'm just using <a href=\"http://build.fhir.org//patient-example.xml\" target=\"_blank\" title=\"http://build.fhir.org//patient-example.xml\">http://build.fhir.org//patient-example.xml</a>, retrieved like this, as given in the validator documentation example:</p>\n<p>wget <a href=\"http://build.fhir.org//patient-example.xml\" target=\"_blank\" title=\"http://build.fhir.org//patient-example.xml\">http://build.fhir.org//patient-example.xml</a> -O pat-ex.xml</p>\n<p>Thanks!</p>",
        "id": 153991646,
        "sender_full_name": "Mike Henderson",
        "timestamp": 1535562152
    },
    {
        "content": "<p>And by \"official\" validator, you mean the one from <a href=\"http://build.fhir.org\" target=\"_blank\" title=\"http://build.fhir.org\">http://build.fhir.org</a>?</p>",
        "id": 153991649,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1535562274
    },
    {
        "content": "<p>(The 'current' one)</p>",
        "id": 153991650,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1535562284
    },
    {
        "content": "<p>Correct.</p>",
        "id": 153991651,
        "sender_full_name": "Mike Henderson",
        "timestamp": 1535562428
    },
    {
        "content": "<p>BTW, I'm following the examples at <a href=\"https://build.fhir.org/validation.html\" target=\"_blank\" title=\"https://build.fhir.org/validation.html\">https://build.fhir.org/validation.html</a>.<br>\nAlso, when I try to validate against a remote resource, this ensues:<br>\nPS C:\\Users\\mhenderson\\FHIR&gt; java -jar org.hl7.fhir.validator.jar <a href=\"http://build.fhir.org///patient-example.html\" target=\"_blank\" title=\"http://build.fhir.org///patient-example.html\">http://build.fhir.org///patient-example.html</a> -profile<br>\n<a href=\"http://hl7.org/fhir/StructureDefinition/Patient\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/Patient\">http://hl7.org/fhir/StructureDefinition/Patient</a><br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org/r4\" target=\"_blank\" title=\"http://tx.fhir.org/r4\">http://tx.fhir.org/r4</a><br>\nException in thread \"main\" org.hl7.fhir.exceptions.FHIRException: Unable to resolve the package 'hl7.fhir.core-3.5.0'<br>\n        at org.hl7.fhir.utilities.cache.PackageCacheManager.resolvePackage(PackageCacheManager.java:491)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.resolvePackage(ValidationEngine.java:541)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.fetchByPackage(ValidationEngine.java:530)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadIgSource(ValidationEngine.java:390)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadDefinitions(ValidationEngine.java:298)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadInitialDefinitions(ValidationEngine.java:263)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.&lt;init&gt;(ValidationEngine.java:288)<br>\n        at org.hl7.fhir.r4.validation.Validator.main(Validator.java:337)</p>",
        "id": 153991659,
        "sender_full_name": "Mike Henderson",
        "timestamp": 1535564326
    },
    {
        "content": "<p>Ah.  That's a Grahame issue.  Looks like we need to add an extra step to the \"increment version\" process.</p>",
        "id": 153991663,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1535564705
    },
    {
        "content": "<p>memory: make sure you pass -Xmx parameter before the .jar on the command line</p>",
        "id": 153992063,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1535668226
    },
    {
        "content": "<p>committing a fix for the definitions now - sorry I missed that.</p>",
        "id": 153992064,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1535668241
    },
    {
        "content": "<p>The right placement of the -Xmx parameter did the trick; thanks, Grahame and Lloyd!</p>",
        "id": 153992311,
        "sender_full_name": "Mike Henderson",
        "timestamp": 1535720265
    }
]