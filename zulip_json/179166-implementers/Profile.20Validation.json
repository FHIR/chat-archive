[
    {
        "content": "<p>Does anyone happen to have a very simple example of a profile &amp; a resource please? I am trying to get the validation to work but constantly get non-informative messages \"Unexpected failure while validating resource\". I just want to make sure that the random profiles we have created are/are not the problem (and not a problem with HAPI et al.).</p>",
        "id": 153858141,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1479829470
    },
    {
        "content": "<p>Also, Have tried to use the validator jar both from the command line &amp; in java with both our profiles(custom StructureDefinition) &amp; some random ones from various public servers but to no avail.  .. validate (xml) null ptr exception</p>",
        "id": 153858142,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1479829640
    },
    {
        "content": "<p>Is your XML valid? My guess is you have a problem there. Try validating against the schema before using any StructureDefinition  specific validators...</p>",
        "id": 153858143,
        "sender_full_name": "Jason Walonoski",
        "timestamp": 1479829748
    },
    {
        "content": "<p>Can I ask what you tend to use for XML validation please? I have used the NotePad++ XMLTools plugin and they state there is a problem with the StructureDefinion.xsd file. Element '&lt;w3 url&gt;' complexType: ExtensionContext does already exist. The Visual Studio one was also displaying some problems with the xsd file when I test it yesterday (can find out what they were again if required).</p>",
        "id": 153858144,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1479830299
    },
    {
        "content": "<p>FWIW I use XMLSpy to schema check.   (I have used the notepad ++ which worked great for a while but now errors and I can't debug.)   I also routinely run the jar from the command line without issues.    Another way is to upload (POST) a resource to a reference server they validate and will error with a message.  I'm most comfortable using the healthintersection server and something like Fiddler or Postman for doing this. </p>",
        "id": 153858145,
        "sender_full_name": "Eric Haas",
        "timestamp": 1479830798
    },
    {
        "content": "<p>Thanks Gents, I'll give XMLSpy a try and see what comes up. The problem with healthintersection et. al. that I'm seeing is that all I get back is \"Unexpected failure while validating resource\" which doesn't really help.</p>",
        "id": 153858147,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1479831670
    },
    {
        "content": "<p>XMLSpy did in fact identify some issues with our profile when compared to the scheme, however we're still getting the same error so will have to try finding a simple example to see what we've missed in our ignorance. Cheers. </p>",
        "id": 153858152,
        "sender_full_name": "Stephen Lloyd",
        "timestamp": 1479833705
    },
    {
        "content": "<p>Another way is to use eclipse with the Web Tools Platform <a href=\"http://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.wst.xmleditor.doc.user%2Ftopics%2Ftwxvalid.html\" target=\"_blank\" title=\"http://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.wst.xmleditor.doc.user%2Ftopics%2Ftwxvalid.html\">http://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.wst.xmleditor.doc.user%2Ftopics%2Ftwxvalid.html</a>. You have to adjust the path to the schema (.xsd) in the xml file like:</p>\n<p>&lt;StructureDefinition xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\" xmlns:xsi=\"<a href=\"http://www.w3.org/2001/XMLSchema-instance\" target=\"_blank\" title=\"http://www.w3.org/2001/XMLSchema-instance\">http://www.w3.org/2001/XMLSchema-instance</a>\"<br>\n    xsi:schemaLocation=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a> ../../schemas/fhir-all.xsd\"&gt;</p>\n<p>If that gives no errors the next step is to apply the schematrons to the xml, I personally prefer to use then the validator directly. If you don't mind posting your StructureDefinition and version your running it against (DSTU2 or current build) I can redo the check here.</p>",
        "id": 153858166,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1479845182
    },
    {
        "content": "<p>my apologies that validation isn't working well at the moment. The spec is rolling over so quickly as the milestone approaches that I can't always keep everything working</p>",
        "id": 153858185,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1479879136
    },
    {
        "content": "<p>Just started trying out the profile validation in HAPI (using HL7OrgDSTU2) and noticed a couple of issues<br>\n1. Even though I provide a complete expansion of a valueset (using IValidationSupport.expandValueSet), the default ValueSetExpanderFactory implementation limits to 500 codes. This returns a ETooCostly with a ValueSetChecker which triggers the costly expansion again. Using HAPI's FHIRContext based validator, there is no way to explicitly set a different ValueSetExpanderFactory (its possible using the RI's InstanceValidator class)<br>\nThe IValidationSupport interface should ideally provide both options of expanding a valueset(ValueSet/$expand) and validating a code against a valueset (ValueSet/$validate-code). Users can choose which interface they want to implement<br>\n2. The default ValueSetExpanderSimple does not handle multiple filters for compose.include or compose.exclude. Quoting the comment \"// need to and them, and this isn't done yet. But this shouldn't arise in non loinc and snomed value sets\" <br>\nHowever, Encounter-reason is an example with multiple include filters and there may be others as well.<br>\n3. RI's InstanceValidator routinely gives messages such as \"Binding for path /f:Encounter/f:reason/f:coding has no source, so can't be checked\". In this case, its trying the validate the Coding field within the CodeableConcept. The CodeableConcept has a valueset binding but the Coding does not. I dont really think that it makes sense to validate the Coding within CodeableConcept and should just be validating the CodeableConcept as a whole (which it seems to do anyway). </p>",
        "id": 153885994,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493143409
    },
    {
        "content": "<p>1. <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> I don't know why it's using expand? I don't think it's from my code?<br>\n2. Encounter Reason has multiple includes, not multiple filters on a single include. Are you actually having a problem with this?<br>\n3. I'll haev to fix that</p>",
        "id": 153886020,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493154585
    },
    {
        "content": "<p>More issues with DSTU2 profile validation and this one is with RI's Validator itself.<br>\nI had created a Patient resource claiming to conform to DAF but with a wrong code for us-core-race according to its valueset binding. (system: <a href=\"http://hl7.org/fhir/v3/Race\" target=\"_blank\" title=\"http://hl7.org/fhir/v3/Race\">http://hl7.org/fhir/v3/Race</a>, code: 1010-8 is not part of the required valueset binding for us-core-race (<a href=\"http://hl7.org/fhir/dstu2/daf/valueset-daf-race.html\" target=\"_blank\" title=\"http://hl7.org/fhir/dstu2/daf/valueset-daf-race.html\">http://hl7.org/fhir/dstu2/daf/valueset-daf-race.html</a>)<br>\nI assumed the valueset validation to fail given the wrong code in use but nothing of that sort happened. The output is identical whether using HAPI or RI and the RI output is given below.</p>\n<div class=\"codehilite\"><pre><span></span>java -jar org.hl7.fhir.validator.jar daf1.json -defn validation-min.xml.zip -profile http://hl7.org/fhir/StructureDefinition/daf-patient\n  .. load definitions from validation-min.xml.zip\n  .. connect to terminology server http://fhir2.healthintersections.com.au/open\n  .. load profile http://hl7.org/fhir/StructureDefinition/daf-patient\n  .. load daf1.json\n  .. validate (json)\nValidating daf1.json: 2 messages\nERROR @  Element &#39;.identifier&#39;: minimum required = 1, but only found 0 (src = InstanceValidator)\nERROR @  Element &#39;.identifier&#39;: minimum required = 1, but only found 0 (src = InstanceValidator)\n ...failure\n</pre></div>",
        "id": 153886066,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493180180
    },
    {
        "content": "<p>The wrong resource in question</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;resourceType&quot;: &quot;Patient&quot;,\n  &quot;meta&quot;: {\n    &quot;profile&quot;: [\n      &quot;http://hl7.org/fhir/StructureDefinition/daf-patient&quot;\n    ]\n  },\n  &quot;extension&quot;: [\n    {\n      &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/us-core-race&quot;,\n      &quot;valueCodeableConcept&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;system&quot;: &quot;http://hl7.org/fhir/v3/Race&quot;,\n            &quot;code&quot;: &quot;1010-8&quot;\n          }\n        ]\n      }\n    }\n  ],\n  &quot;name&quot;: [\n    {\n      &quot;family&quot;: [\n        &quot;Chiguren&quot;\n      ],\n      &quot;given&quot;: [\n        &quot;John&quot;\n      ]\n    }\n  ]\n}\n</pre></div>",
        "id": 153886067,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493180224
    },
    {
        "content": "<p>The validator.zip and the validation-min.xml.zip are both from DSTU2 <br>\n<a href=\"http://hl7.org/fhir/dstu2/validation-min.xml.zip\" target=\"_blank\" title=\"http://hl7.org/fhir/dstu2/validation-min.xml.zip\">http://hl7.org/fhir/dstu2/validation-min.xml.zip</a><br>\n<a href=\"http://hl7.org/fhir/dstu2/validator.zip\" target=\"_blank\" title=\"http://hl7.org/fhir/dstu2/validator.zip\">http://hl7.org/fhir/dstu2/validator.zip</a></p>",
        "id": 153886069,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493180367
    },
    {
        "content": "<p>I am sure that I am missing something as I dont believe that such a basic use case fails in the RI. Any help is really appreciated.</p>",
        "id": 153886070,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493180690
    },
    {
        "content": "<p>Never mind, I got my answer. There is no implementation to check the validity of the extension content in DSTU2. (InstanceValidator.java:389, no code after the helpful comment :-) )<br>\nIts there in STU3 and now I have to maintain my own copy of DSTU2's InstanceValidator with this and other changes.</p>",
        "id": 153886216,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493229659
    },
    {
        "content": "<p>You can (and should) use the most recent CI build validator whether you're validating STU 2, STU 3 or \"current\" resources.</p>",
        "id": 153886238,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1493250280
    },
    {
        "content": "<p>May be I misunderstood you, but even the latest DSTU2 validator at <a href=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.validation/src/org/hl7/fhir/dstu2/validation/InstanceValidator.java#L620\" target=\"_blank\" title=\"https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.validation/src/org/hl7/fhir/dstu2/validation/InstanceValidator.java#L620\">https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.validation/src/org/hl7/fhir/dstu2/validation/InstanceValidator.java#L620</a> doesnt have the validation of extension content. Should I check some other place instead? Thanks</p>",
        "id": 153886263,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493263841
    },
    {
        "content": "<p>The current validator jar is at <a href=\"http://build.fhir.org\" target=\"_blank\" title=\"http://build.fhir.org\">build.fhir.org</a>.  The current code is at <a href=\"http://gforge.hl7.org/svn/fhir/trunk/build\" target=\"_blank\" title=\"http://gforge.hl7.org/svn/fhir/trunk/build\">http://gforge.hl7.org/svn/fhir/trunk/build</a>.  Not sure what's hosted at github . . .</p>",
        "id": 153886264,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1493265537
    },
    {
        "content": "<p>the code you are referring to is orphaned and on the way out. The current validator can validate R2 resources and you should use that </p>",
        "id": 153886510,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493609721
    },
    {
        "content": "<p>I had downloaded the validator from <a href=\"http://build.fhir.org\" target=\"_blank\" title=\"http://build.fhir.org\">http://build.fhir.org</a> but that only seems to support validation from FHIR 1.4.0. I am looking to validate DSTU2 resources conforming to 1.0.2</p>",
        "id": 153886595,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493672635
    },
    {
        "content": "<p>I tried it as well and was not able to validate dstu2 instance using the latest validator.  ( the DSTU2 validator works though)  here is my error:...</p>",
        "id": 153886628,
        "sender_full_name": "Eric Haas",
        "timestamp": 1493679653
    },
    {
        "content": "<p>Erics-Air-2:Argo-DSTU2 ehaas$ bash <a href=\"http://validate2.sh\" target=\"_blank\" title=\"http://validate2.sh\">validate2.sh</a><br>\n=========================================================================<br>\n======= Validate Argo-DQ(DSTU2) IG! Mon May 1 22:58:55 UTC 2017 =========<br>\n=========================================================================<br>\nType the file name of the resource that you want to check:<br>\n23.xml<br>\nvalidating /Users/ehaas/Documents/FHIR/Argo-DSTU2/examples/23.xml...<br>\n  .. load FHIR from /Users/ehaas/Downloads/validation.xml.zip<br>\n  .. connect to tx server @ <a href=\"http://fhir2.healthintersections.com.au\" target=\"_blank\" title=\"http://fhir2.healthintersections.com.au\">http://fhir2.healthintersections.com.au</a><br>\nException in thread \"main\" org.hl7.fhir.exceptions.FHIRFormatError: Error parsing extension-definitions.xml:Unknown Content display @  START_TAG seen ...t was discovered\"/&gt;\\n        &lt;display value=\"discovery date time\"/&gt;... @16:47<br>\n    at org.hl7.fhir.r4.context.SimpleWorkerContext.loadFromFile(SimpleWorkerContext.java:176)<br>\n    at org.hl7.fhir.r4.context.SimpleWorkerContext.loadDefinitionItem(SimpleWorkerContext.java:149)<br>\n    at org.hl7.fhir.r4.context.SimpleWorkerContext.fromDefinitions(SimpleWorkerContext.java:142)<br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.loadDefinitions(ValidationEngine.java:176)<br>\n    at org.hl7.fhir.r4.validation.ValidationEngine.&lt;init&gt;(ValidationEngine.java:170)<br>\n    at org.hl7.fhir.r4.validation.Validator.main(Validator.java:232)<br>\nCaused by: org.hl7.fhir.exceptions.FHIRFormatError: Unknown Content display @  START_TAG seen ...t was discovered\"/&gt;\\n        &lt;display value=\"discovery date ti</p>",
        "id": 153886629,
        "sender_full_name": "Eric Haas",
        "timestamp": 1493679662
    },
    {
        "content": "<p>I got this error when I was using DSTU2 definitions with the latest validator. I had been trying numerous combinations of DSTU2/STU3/Current definitions and different versions of Terminology services (<a href=\"http://tx.fhir.org/r2\" target=\"_blank\" title=\"http://tx.fhir.org/r2\">http://tx.fhir.org/r2</a> or <a href=\"http://tx.fhir.org/r3\" target=\"_blank\" title=\"http://tx.fhir.org/r3\">http://tx.fhir.org/r3</a>) and nothing works for validating DSTU2 resources</p>",
        "id": 153886631,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1493680118
    },
    {
        "content": "<p>Where's the source code for the 'official' validator found at <a href=\"https://www.hl7.org/fhir/downloads.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/downloads.html\">https://www.hl7.org/fhir/downloads.html</a>? </p>",
        "id": 153887099,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1493911303
    },
    {
        "content": "<p>is it publicly available or do I have to decompile it?</p>",
        "id": 153887100,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1493911367
    },
    {
        "content": "<p>it's in the fhir svn</p>",
        "id": 153887103,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493911564
    },
    {
        "content": "<p>use the current build</p>",
        "id": 153887104,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1493911587
    },
    {
        "content": "<p>svn ... dat shit's ol'skool ;)</p>",
        "id": 153887105,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1493911755
    },
    {
        "content": "<p>found it. thx</p>",
        "id": 153887117,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1493914258
    },
    {
        "content": "<p>The recent commit (on May 1) into RI from Grahame Grieve fixes many of the issues with validating DSTU2 resources.  Thanks a lot. <br>\n<span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> will these changes make it into HAPI soon?</p>",
        "id": 153889924,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1494867218
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Even with the latest validator, invariant checking is not working for DSTU2 resources. For example, the below resource should have failed the constraint on Patient.contact but it doesnt report any errors.</p>\n<div class=\"codehilite\"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n  &lt;identifier&gt;\n    &lt;system value=&quot;http://acme.org/mrns&quot;/&gt;\n    &lt;value value=&quot;3274832784&quot;/&gt;\n  &lt;/identifier&gt;\n  &lt;name&gt;\n    &lt;family value=&quot;Cousin&quot;/&gt;\n    &lt;given value=&quot;Peter&quot;/&gt;\n  &lt;/name&gt;\n  &lt;contact&gt;\n    &lt;relationship&gt;\n      &lt;coding&gt;\n        &lt;system value=&quot;http://hl7.org/fhir/patient-contact-relationship&quot;/&gt;\n        &lt;code value=&quot;friend&quot;/&gt;\n      &lt;/coding&gt;\n    &lt;/relationship&gt;\n  &lt;/contact&gt;\n&lt;/Patient&gt;\n</pre></div>",
        "id": 153890004,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1494914544
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  when I am trying to validate a profile on <a href=\"http://test.fhir.org/r3\" target=\"_blank\" title=\"http://test.fhir.org/r3\">http://test.fhir.org/r3</a>, some errors are getting displayed as in the screenshot below.<a href=\"/user_uploads/10155/0gGsDLSgDTVMKTnEgVe7fQCr/validation-error.PNG\" target=\"_blank\" title=\"validation-error.PNG\">validation-error.PNG</a>  How can I fix the errors? Thank you</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/0gGsDLSgDTVMKTnEgVe7fQCr/validation-error.PNG\" target=\"_blank\" title=\"validation-error.PNG\"><img src=\"/user_uploads/10155/0gGsDLSgDTVMKTnEgVe7fQCr/validation-error.PNG\"></a></div>",
        "id": 153903380,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1503484848
    },
    {
        "content": "<p>hmm. slice errors - probably my server is the problem; it's a bit behind the java validator which is the gold standard</p>",
        "id": 153903402,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1503494906
    },
    {
        "content": "<p>Hi all, I am creating a new profile based on my requirements. So how do we know newly created profile is valid or not. Can anyone tell me. Thank you.</p>",
        "id": 153903479,
        "sender_full_name": "Mounika",
        "timestamp": 1503552885
    },
    {
        "content": "<p>if the IG publisher doesn't give you any errors, then you don't have any errors we know how to detect</p>",
        "id": 153903485,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1503556988
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 153903486,
        "sender_full_name": "Jayashree Surnar",
        "timestamp": 1503558719
    },
    {
        "content": "<p><a href=\"https://www.hl7.org/fhir/validation.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/validation.html\">https://www.hl7.org/fhir/validation.html</a>  In this documation given how to validate the examples But not given How to validate the profiles. Can't we validate the profile before ig publishing?</p>",
        "id": 153903493,
        "sender_full_name": "Mounika",
        "timestamp": 1503569759
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 153903495,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1503570499
    },
    {
        "content": "<p>Hi,<br>\nI have created a profile MyPatient and have created an extension in MyPatient called clinicalTrial. This is one of the Extensions that come with the Patient profile. When I try to validate MyPaitent Profile using Simplifier I get following errors: <br>\n1. Element must not be empty<br>\nLocation: StructureDefinition.meta[0]<br>\n2. Instance failed constraint sdf-20 \"No slicing on the root element\"<br>\nLocation: StructureDefinition.differential[0]<br>\n3. Instance failed constraint sdf-14 \"All element definitions must have an id\"<br>\nLocation: StructureDefinition</p>\n<p>Can someone please point me to a solution for this.  Thanks for your help.</p>",
        "id": 153903527,
        "sender_full_name": "Haseeb",
        "timestamp": 1503574201
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194144\">@Haseeb</span>, these warnings are caused by separate issues:<br>\n1) Unclear; does the profile specify any constraints on the .meta element?<br>\n2) sdf-20 - the fhirpath expression in the core spec is incorrect, I've recently submitted a tracker issue to gForge about this.<br>\n3) Forge forgets to generate an element id for the extension slicing entry. This will be fixed in the next release.</p>",
        "id": 153903533,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1503574679
    },
    {
        "content": "<p>Hi @<strong>Michel</strong>  Thanks for your quick response.<br>\nFor the first error message, from looking at the Profile, Location meta[0] is 'extension'. I did not change anything except adding the extension in the base Patient resource. I did not explicitly change the metadata.<br>\nFor second and third error message, what would you suggest for the workaround. I did notice that no element id is generated but the field is not editable in Forge.<br>\nThanks for your help.</p>",
        "id": 153903543,
        "sender_full_name": "Haseeb",
        "timestamp": 1503575381
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194144\">@Haseeb</span>, you can safely ignore warning (2), as this needs to be fixed in the spec.<br>\nYou currently cannot fix the missing element id from within Forge (but you could fix it manually). I've already fixed the issue in the internal development branch, the fix will be included in the next release.</p>",
        "id": 153903545,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1503576020
    },
    {
        "content": "<p>Not sure about the first warning, but it is probably related to the other ones.</p>",
        "id": 153903546,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1503576056
    },
    {
        "content": "<p>for validating  profiles validate against StructureDefinition.... Is that what you are asking?  you can do that prior to ig publishing.    a profile is the same as an example - an instance of a resource.  in this case StructureDefinition</p>",
        "id": 153903607,
        "sender_full_name": "Eric Haas",
        "timestamp": 1503598480
    },
    {
        "content": "<p>Hi @<strong>Michel</strong> Thanks for looking into these issues. I fixed the element id manually and then validated the profile using the Java validator i.e. org.hl7.fhir.validator.jar I got only one error which is the slicing issue and which you said I can safely ignore:<br>\n<em>FAILURE</em> validating C:\\Users\\haseeb\\Documents\\StructureDefinitions\\MyPatient.structuredefinition.xml:  error:1 warn:0 info:0<br>\n  Error @ StructureDefinition.differential (line 17, col17) : No slicing on the root element [element.first().slicing.empty()]</p>\n<p>Now that when I publish my profile on Simplifier and also to my vonk FHIR server on my machine and try to POST a patient json including the extension in it I get 400 Bad Request error:<br>\n  \"issue\": [<br>\n        {<br>\n            \"severity\": \"fatal\",<br>\n            \"code\": \"exception\",<br>\n            \"details\": {<br>\n                \"coding\": [<br>\n                    {<br>\n                        \"system\": \"<a href=\"http://hl7.org/fhir/dotnet-api-operation-outcome\" target=\"_blank\" title=\"http://hl7.org/fhir/dotnet-api-operation-outcome\">http://hl7.org/fhir/dotnet-api-operation-outcome</a>\",<br>\n                        \"code\": \"5003\"<br>\n                    }<br>\n                ],<br>\n                \"text\": \"Resource to create could not be parsed.\"<br>\n            }<br>\n        },<br>\n        {<br>\n            \"code\": \"not-supported\",<br>\n            \"details\": {<br>\n                \"coding\": [<br>\n                    {<br>\n                        \"code\": \"not handled\"<br>\n                    }<br>\n                ],<br>\n                \"text\": \"/Patient\"<br>\n            },<br>\n            \"diagnostics\": \"\"<br>\n        }</p>\n<p>I did also publish the profile on <a href=\"https://sb-fhir-stu3.smarthealthit.org/smartstu3/open\" target=\"_blank\" title=\"https://sb-fhir-stu3.smarthealthit.org/smartstu3/open\">https://sb-fhir-stu3.smarthealthit.org/smartstu3/open</a> and POSTed a patient json including the clinicalTrial extension, the Patient gets created but the server conveniently ignore the extension.  I have spent some time investigating why its not accepting the updated Patient but I have no way of confirming whether my approach is wrong or there is issue with the created profile.</p>\n<p>Thanks for your help.<br>\nHaseeb</p>",
        "id": 153903671,
        "sender_full_name": "Haseeb",
        "timestamp": 1503652450
    },
    {
        "content": "<p>You can get rid of the error in your profile with this workaround in Forge:</p>\n<ul>\n<li>in the options menu, select the \"show common resource elements\"</li>\n<li>in your profile, edit the 'id' element by adding a space to the description</li>\n<li>save the profile, it will now validate correctly</li>\n</ul>\n<p>The issue you're having with posting a patient to the server seems to be with wrong data. Can you check if your syntax is correct and you're sending a valid Patient?</p>",
        "id": 153903680,
        "sender_full_name": "Mirjam Baltus",
        "timestamp": 1503657987
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span> I am going to make the changes and let you know how I get on.</p>",
        "id": 153903698,
        "sender_full_name": "Haseeb",
        "timestamp": 1503659065
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194144\">@Haseeb</span>, the incorrect invariant sdf-20 currently complains if the <em>first</em> element in the differential has a sliceName. I've already submitted a tracker issue to gForge about this.<br>\nAs a workaround for the current FHIR release, to prevent the validation message, make sure that the first actual constraint in your profile is on an element without a sliceName. For example, add a dummy comment to the root element. This should prevent sdf-20 from being triggered.</p>",
        "id": 153903713,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1503661915
    },
    {
        "content": "<p>Hi @<strong>Mirjam</strong> and @<strong>Michel</strong>, Thanks for your help. I have been able to get my profile with Extension validated and then created a patient using this profile in my vonk instance. I'll be creating a good few profiles to map our workflow in coming days but its a big relief to be able to get it working. Thanks again :)</p>",
        "id": 153903741,
        "sender_full_name": "Haseeb",
        "timestamp": 1503674244
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194144\">@Haseeb</span>, you're welcome! I'm happy to see that you're up and running.</p>",
        "id": 153903743,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1503674636
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  then how can I validate a profile?</p>",
        "id": 153903798,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1503895875
    },
    {
        "content": "<p>First, read through this whole thread.  If you have further questions, ask them about specifics already discussed here.</p>",
        "id": 153903854,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1503933348
    },
    {
        "content": "<p>Stupid Question: Are there any xpath to fhirpath expression conversions available? We are currently using the R4 validator to validate DSTU2 resources and its working fine except for the invariant validation. We would like to get validation of invariants working.</p>",
        "id": 153909108,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1505848031
    },
    {
        "content": "<p>the validator should evaluate the xpaths in that circumstance</p>",
        "id": 153909122,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505854268
    },
    {
        "content": "<p>It doesn't seem to do that, there is a check to see if the constraint has expression and only validates if it has an expression in InstanceValidator#checkInvariants</p>",
        "id": 153909780,
        "sender_full_name": "Anand Mohan Tumuluri",
        "timestamp": 1506023340
    },
    {
        "content": "<p>any chance that the validator tool could be hosted on github and not just as a mirror ... - it would make it easier to make contributions that way and report bugs</p>",
        "id": 153912837,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507295871
    },
    {
        "content": "<p>\"not just as a mirror\"?</p>",
        "id": 153912864,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1507313188
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> are you saying that you'll look into pr's done on github? If that's the case, that is awesome</p>",
        "id": 153913012,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507534722
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> Ewout also publishes a stand-alone .NET profile validation tool on github:<br>\n<a href=\"https://github.com/ewoutkramer/Furore.Fhir.ValidationDemo\" target=\"_blank\" title=\"https://github.com/ewoutkramer/Furore.Fhir.ValidationDemo\">https://github.com/ewoutkramer/Furore.Fhir.ValidationDemo</a></p>",
        "id": 153913056,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507539768
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> - is it still maintained?</p>",
        "id": 153913057,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507539819
    },
    {
        "content": "<p>Sure! Just make sure to fetch the latest .NET API library packages from NuGet.</p>",
        "id": 153913058,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507539888
    },
    {
        "content": "<p>+1</p>",
        "id": 153913059,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507539900
    },
    {
        "content": "<p>And of course, Ewout actively maintains the .NET validator.</p>",
        "id": 153913060,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507539914
    },
    {
        "content": "<p><a href=\"https://github.com/ewoutkramer/Furore.Fhir.ValidationDemo\" target=\"_blank\" title=\"https://github.com/ewoutkramer/Furore.Fhir.ValidationDemo\">https://github.com/ewoutkramer/Furore.Fhir.ValidationDemo</a> seems like there are couple of missing imports</p>",
        "id": 153913069,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507540890
    },
    {
        "content": "<p>Which branch? I think you should try develop-stu3.</p>",
        "id": 153913072,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507541054
    },
    {
        "content": "<p>my bad ... I did the master</p>",
        "id": 153913074,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507541093
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> I didn't say anything yet - I was just asking what you meant</p>",
        "id": 153913075,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1507541121
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  I was asking if the svn repo on git is mainly for reading and writing, or only for reading.</p>",
        "id": 153913077,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507541448
    },
    {
        "content": "<p>it's only to support git based tooling. so read only</p>",
        "id": 153913078,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1507542628
    },
    {
        "content": "<p>FYI - trying out 3 different resource validators yields 3 different results. Example can be found at <a href=\"https://simplifier.net/eSundhed2017Hackatho/Observation-example/~json#json\" target=\"_blank\" title=\"https://simplifier.net/eSundhed2017Hackatho/Observation-example/~json#json\">https://simplifier.net/eSundhed2017Hackatho/Observation-example/~json#json</a></p>\n<p>Using the validator hosted on Simplifier validates against the uploaded profiles (which is nice) hosted at simplfier and reports: <strong>no issues</strong></p>\n<p>Using the official fhir validator (<a href=\"http://build.fhir.org/validator.zip\" target=\"_blank\" title=\"http://build.fhir.org/validator.zip\">http://build.fhir.org/validator.zip</a>) yields two warnings: <strong>(Unable to find definition for discriminator code.coding.code) and two info's (due to lack of slicing validation)</strong></p>\n<p>Using the HAPI validator yields one error: <strong>(obs-7: If code is the same as a component code then the value element associated with the code SHALL NOT be present)</strong></p>\n<ul>\n<li>no one said writing validators is an easy task <img alt=\":simple_smile:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f642.png\" title=\":simple_smile:\"></li>\n</ul>",
        "id": 153913089,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507549001
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>, did you analyze the different outputs to determine which of the conflicting warning messages are (in)correct?</p>",
        "id": 153913095,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507551514
    },
    {
        "content": "<p>The .NET tool here here ( <a href=\"http://clarotech.co.uk/Products/TinderBox\" target=\"_blank\" title=\"http://clarotech.co.uk/Products/TinderBox\">http://clarotech.co.uk/Products/TinderBox</a> ) might be of use - this validates Bundles. There is a another tool that will be added to the site later this week that validates standalone resources. Both of these tools get their validation processes from the .NET Validator</p>",
        "id": 153913110,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1507554233
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191362\">@Richard Kavanagh</span> not really possible to try it out. Seems like the link is dead <a href=\"http://clarotech.co.uk/apps/TinderBoxSTU3/publish.htm\" target=\"_blank\" title=\"http://clarotech.co.uk/apps/TinderBoxSTU3/publish.htm\">http://clarotech.co.uk/apps/TinderBoxSTU3/publish.htm</a></p>",
        "id": 153913120,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507557509
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191362\">@Richard Kavanagh</span> <a href=\"/user_uploads/10155/VPb94VKfd1gYmd3UUuo8MSPm/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/VPb94VKfd1gYmd3UUuo8MSPm/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/VPb94VKfd1gYmd3UUuo8MSPm/pasted_image.png\"></a></div>",
        "id": 153913126,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507557622
    },
    {
        "content": "<p>Apologies - looks like the latest version has not been posted to the server. Will get that fixed shortly.</p>",
        "id": 153913128,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1507557668
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> - 2 questions regarding the logic of the validator that ships with hapi:<br>\n1) The errorcode when validating this <a href=\"https://simplifier.net/eSundhed2017Hackatho/Observation-example\" target=\"_blank\" title=\"https://simplifier.net/eSundhed2017Hackatho/Observation-example\">example</a><br>\n<em>Message=obs-7: If code is the same as a component code then the value element associated with the code SHALL NOT be present</em><br>\nI can't see that the code is the same as the component code. How come they are interpreted as the same?</p>\n<p>2) This is probably more targeted at the standard, but <em>then the value element associated with the code</em> - which code does it relate to? The Observation.code or the Observation.component.code?</p>",
        "id": 153913157,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507560311
    },
    {
        "content": "<p>2) good question! I assumed that obs-7 is targeting Observation.code, but I agree that the description could be improved.</p>",
        "id": 153913162,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507560508
    },
    {
        "content": "<p>For info the download at <a href=\"http://clarotech.co.uk/apps/TinderBoxSTU3\" target=\"_blank\" title=\"http://clarotech.co.uk/apps/TinderBoxSTU3\">http://clarotech.co.uk/apps/TinderBoxSTU3</a> should now be working</p>",
        "id": 153913183,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1507585082
    },
    {
        "content": "<p>It doesn't</p>",
        "id": 153913184,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585133
    },
    {
        "content": "<p>I'll get there in the end. Follow the download link from here... <a href=\"http://clarotech.co.uk/Products/TinderBox\" target=\"_blank\" title=\"http://clarotech.co.uk/Products/TinderBox\">http://clarotech.co.uk/Products/TinderBox</a></p>",
        "id": 153913185,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1507585229
    },
    {
        "content": "<p>This link works: <a href=\"http://clarotech.co.uk/apps/TinderBox%20v2.1.2%20STU3.zip\" target=\"_blank\" title=\"http://clarotech.co.uk/apps/TinderBox%20v2.1.2%20STU3.zip\">http://clarotech.co.uk/apps/TinderBox%20v2.1.2%20STU3.zip</a></p>",
        "id": 153913186,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585327
    },
    {
        "content": "<p>But curl never lies: <br>\ncurl <a href=\"http://clarotech.co.uk/apps/TinderBoxSTU3\" target=\"_blank\" title=\"http://clarotech.co.uk/apps/TinderBoxSTU3\">http://clarotech.co.uk/apps/TinderBoxSTU3</a> | grep \"Error\"<br>\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current<br>\n                                 Dload  Upload   Total   Spent    Left  Speed<br>\n100  1024    0  1024    0     0   2293      0 --:--:-- --:--:-- --:--:--  2290    &lt;title&gt;ClaroTech - Error&lt;/title&gt;<br>\n100  8252    0  8252    0     0  13353      0 --:--:-- --:--:-- --:--:-- 13352</p>",
        "id": 153913187,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585397
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191362\">@Richard Kavanagh</span> hate to say it but Tinderbox seems to contain some bugs</p>",
        "id": 153913188,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585590
    },
    {
        "content": "<p>That's clearly possible  - what did you find?</p>",
        "id": 153913190,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1507585642
    },
    {
        "content": "<p>it crashed</p>",
        "id": 153913191,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585704
    },
    {
        "content": "<p>twice</p>",
        "id": 153913192,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585726
    },
    {
        "content": "<p>Ouch! - Can you share the file you were attempting to open?</p>",
        "id": 153913193,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1507585769
    },
    {
        "content": "<p>Didn't get that far</p>",
        "id": 153913194,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585779
    },
    {
        "content": "<p>go to settings, press browse and then press cancel</p>",
        "id": 153913195,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507585813
    },
    {
        "content": "<p>Yep _ I can recreate that...</p>",
        "id": 153913196,
        "sender_full_name": "Richard Kavanagh",
        "timestamp": 1507585948
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> - 2 questions regarding the logic of the validator that ships with hapi:<br>\n1) The errorcode when validating this <a href=\"https://simplifier.net/eSundhed2017Hackatho/Observation-example\" target=\"_blank\" title=\"https://simplifier.net/eSundhed2017Hackatho/Observation-example\">example</a><br>\n<em>Message=obs-7: If code is the same as a component code then the value element associated with the code SHALL NOT be present</em><br>\nI can't see that the code is the same as the component code. How come they are interpreted as the same?</p>\n<p>2) This is probably more targeted at the standard, but <em>then the value element associated with the code</em> - which code does it relate to? The Observation.code or the Observation.component.code?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Would you agree that the sentence in 2) could/should be less ambiguous stated</p>",
        "id": 153913198,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507586085
    },
    {
        "content": "<blockquote>\n<p>Hi <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>, did you analyze the different outputs to determine which of the conflicting warning messages are (in)correct?</p>\n</blockquote>\n<p><a href=\"https://github.com/jamesagnew/hapi-fhir/issues/654\" target=\"_blank\" title=\"https://github.com/jamesagnew/hapi-fhir/issues/654\">https://github.com/jamesagnew/hapi-fhir/issues/654</a> - meaning that HAPI has a known issue</p>",
        "id": 153913199,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507587776
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span></p>",
        "id": 153913200,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507587811
    },
    {
        "content": "<p>and <span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> , the simplifier validator does <strong>not</strong> catch obs-7. If you state the <em>same</em> code in Observation.code as in Observation.component.code, where <em>same</em> means that both codes have the same coding (including coding.system and coding.code) - I guess that is what is meant by <em>same</em></p>",
        "id": 153913202,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1507588286
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>, thank you for reporting, I've submitted the issue to Ewout'sFHIR  API repository on github:<br>\n<a href=\"https://github.com/ewoutkramer/fhir-net-api/issues/435\" target=\"_blank\" title=\"https://github.com/ewoutkramer/fhir-net-api/issues/435\">https://github.com/ewoutkramer/fhir-net-api/issues/435</a></p>",
        "id": 153913229,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507623236
    },
    {
        "content": "<p>sure</p>",
        "id": 153913257,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1507633620
    },
    {
        "content": "<p>Obs-7 uses \"!=\", where equivalence in the Fhirpath spec is defined to be \"For complex types, equality requires all child properties to be equal, recursively.\" So, you are in fact comparing Obs.code to everything in the combined collection of Obs.component.code (since component may repeat) - making Obs.code != Obs.component.code almost a tautology - and obs-7 will probably almost always be true.</p>",
        "id": 153914021,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1508140798
    },
    {
        "content": "<p>What is the fix - the intent is to not have identical code-value pairs in the root and in component.</p>",
        "id": 153914136,
        "sender_full_name": "Eric Haas",
        "timestamp": 1508178301
    },
    {
        "content": "<p>I think we need to use the \"in\" operation.  Something like   Obs.code.in(Obs.component.code).not().  The reason I am cautious to say this is \"the\" solution, is that the \"in\" operation uses \"equality\" semantics - which means the Codeableconcepts needs to be exactly the same in both, which is probably not what we want.  Rather ANY of the codes in Obs.code, so maybe even:</p>\n<p>Obs.code.coding.any($this in Obs.component.code.coding).not()</p>",
        "id": 153914143,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1508179473
    },
    {
        "content": "<p>In CQL, membership operators use \"equivalent\" (<code>~</code>) semantics, rather than \"equality\" semantics. And we also just relaxed \"equivalent\" for Codes to compare only code and version, and equivalent for Concept is defined as the intersection of codes is not empty.</p>",
        "id": 153914202,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1508192419
    },
    {
        "content": "<p>So that would be <code>Obs.component.code.where($this ~ Obs.code).empty()</code></p>",
        "id": 153914204,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1508192526
    },
    {
        "content": "<p>I hope you mean code and system</p>",
        "id": 153914219,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1508194900
    },
    {
        "content": "<p>just implemeting rest full webservices</p>",
        "id": 153914221,
        "sender_full_name": "venkateswarlu",
        "timestamp": 1508195035
    },
    {
        "content": "<blockquote>\n<p>In CQL, membership operators use \"equivalent\" (<code>~</code>) semantics, rather than \"equality\" semantics. And we also just relaxed \"equivalent\" for Codes to compare only code and version, and equivalent for Concept is defined as the intersection of codes is not empty.</p>\n</blockquote>\n<p>So, the language-dependent appendices of the FHIRPath spec should start talking about what equivalence and equality means for specific types?</p>\n<p>For the short term - obs-7 would already benefit from what you have done above I guess, which still means even display needs to correspond for this rule to fire...but it's better than what we have now...</p>",
        "id": 153914351,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1508225641
    },
    {
        "content": "<p>Since none of the above seem to work as intended  what about this:</p>\n<p><code>Observation.component.code.where( (coding.code = Observation.code.coding.code) and (coding.system = Observation.code.coding.system)).empty()</code></p>\n<p>code = A<br>\nc.code = A<br>\nempty = false</p>\n<p>code = A<br>\nc.code = B<br>\nempty = true</p>\n<p>code = A<br>\nc.code = empty<br>\nempty = true</p>",
        "id": 153914441,
        "sender_full_name": "Eric Haas",
        "timestamp": 1508253118
    },
    {
        "content": "<p>I just updated the xpath for this invariant  as well:</p>\n<p><code>not(exists(f:*[starts-with(local-name(.), 'value')]) and exists(for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value and f:system/@value=$coding/f:system/@value]))</code></p>",
        "id": 153914472,
        "sender_full_name": "Eric Haas",
        "timestamp": 1508260698
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191375\">@Alexander Henket</span>  and <span class=\"user-mention\" data-user-id=\"191918\">@Sarah Gaunt</span>   you both  posted Gforges on it so take look at it when you get a chance.</p>",
        "id": 153914473,
        "sender_full_name": "Eric Haas",
        "timestamp": 1508260822
    },
    {
        "content": "<p>Checked it and all seems in order to me. Taste wise I'd probably stay away from too many and/or and put the final X and Y bit in separate predicates but if it works it works. Thanks!</p>",
        "id": 153914575,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1508312892
    },
    {
        "content": "<p>O and that's a general thing for most invariants in FHIR: the exists() function is not required for testing presence of node(). When you say not(node()) it is exactly the same as not(exists(node())). You just use more characters to say it.</p>",
        "id": 153914576,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1508313074
    },
    {
        "content": "<p>OK thanks for the tips:  updated to...</p>\n<p><code>not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))</code></p>",
        "id": 153914675,
        "sender_full_name": "Eric Haas",
        "timestamp": 1508346303
    },
    {
        "content": "<blockquote>\n<p>So, the language-dependent appendices of the FHIRPath spec should start talking about what equivalence and equality means for specific types?</p>\n</blockquote>\n<p>I would prefer to see consistent semantics at the base level (FHIRPath), but I understand if that can't be completely aligned. I would suggest that equivalent in FHIRPath for Coding and CodeableConcept be similarly relaxed.</p>",
        "id": 153914711,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1508347923
    },
    {
        "content": "<p>And yes, I meant code, system, and version for code equivalence.</p>",
        "id": 153914714,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1508348026
    },
    {
        "content": "<p>We relaxed it to just code and system, so that the same code would compare equivalent across versions.</p>",
        "id": 153914717,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1508348051
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"bryn@databaseconsultinggroup.com\" data-user-id=\"53\">@Bryn Rhodes</span>, I agree - just double checking ;-)</p>",
        "id": 153914818,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1508400465
    },
    {
        "content": "<blockquote>\n<p>Checked it and all seems in order to me. Taste wise I'd probably stay away from too many and/or and put the final X and Y bit in separate predicates but if it works it works. Thanks!</p>\n</blockquote>\n<p>If I understand it correctly, there is now a tracker item to follow up on this?</p>",
        "id": 153914819,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1508400507
    },
    {
        "content": "<p>that tracker for the xpath was applied.  need one for the fhirpath - but am waiting for the correct or updated expression. do we wait for the new fhirpath equivlence or create a fhirpath using the existing syntax</p>",
        "id": 153914885,
        "sender_full_name": "Eric Haas",
        "timestamp": 1508432485
    },
    {
        "content": "<p>I've added a tracker for this: <a href=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14065\" target=\"_blank\" title=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14065\">GF#14065</a>.</p>",
        "id": 153914911,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1508440711
    },
    {
        "content": "<p>Until that FHIRPath change is applied, the expression you provided above <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> should work.</p>",
        "id": 153914914,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1508440936
    },
    {
        "content": "<p>agree it should not be version dependent. That would be consistent with vocab guidance about use of version</p>",
        "id": 153915244,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1508703670
    },
    {
        "content": "<p>I tried to apply the fhirpath above only to discover I  can't use <code>component.code.where( (coding.code = Observation.code.coding.code)</code>   realized the context node is component and I can't traverse up the tree in fhirpath.  So am stuck <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14073\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14073\">GF#14073</a></p>",
        "id": 153915260,
        "sender_full_name": "Eric Haas",
        "timestamp": 1508716158
    },
    {
        "content": "<p>You can with %resource...</p>",
        "id": 153916788,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1509381104
    },
    {
        "content": "<p>ty ....<a href=\"/user_uploads/10155/4W-Ta_QdIJYhICKsnjlMKFv7/johnny-carson.jpg\" target=\"_blank\" title=\"johnny-carson.jpg\">johnny-carson.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/4W-Ta_QdIJYhICKsnjlMKFv7/johnny-carson.jpg\" target=\"_blank\" title=\"johnny-carson.jpg\"><img src=\"/user_uploads/10155/4W-Ta_QdIJYhICKsnjlMKFv7/johnny-carson.jpg\"></a></div>",
        "id": 153916792,
        "sender_full_name": "Eric Haas",
        "timestamp": 1509383835
    },
    {
        "content": "<p>%resource goes to the top of the component passed in right?<br>\nHow does this work when its a bundle with it inside?</p>",
        "id": 153918812,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1510302945
    },
    {
        "content": "<p>Hi all, please help me fix an exception while validating a profile on command prompt. <a href=\"/user_uploads/10155/1aHLYaqM98vwUvxH8TH3J0-p/forgeexception.PNG\" target=\"_blank\" title=\"forgeexception.PNG\">forgeexception.PNG</a>  Thank you</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/1aHLYaqM98vwUvxH8TH3J0-p/forgeexception.PNG\" target=\"_blank\" title=\"forgeexception.PNG\"><img src=\"/user_uploads/10155/1aHLYaqM98vwUvxH8TH3J0-p/forgeexception.PNG\"></a></div>",
        "id": 153922657,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1512199617
    },
    {
        "content": "<p>Seems like a firewall issue or some other network difficulty.  The file it's complaining about definitely exists at that URL address</p>",
        "id": 153922665,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1512225964
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  How can I fix it?</p>",
        "id": 153922740,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1512363834
    },
    {
        "content": "<p>Try running it from a different network environment?  Try browsing to the file it's complaining it can't access within the same network environment just using a browser</p>",
        "id": 153922741,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1512364532
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  I did not understand. Can you  elaborate?</p>",
        "id": 153922742,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1512367539
    },
    {
        "content": "<p>Hi I was trying to implement custom structure definition but it is always return true.<br>\nPosted the Question <a href=\"https://groups.google.com/forum/#!topic/hapi-fhir/P-iTqA69mMw\" target=\"_blank\" title=\"https://groups.google.com/forum/#!topic/hapi-fhir/P-iTqA69mMw\">https://groups.google.com/forum/#!topic/hapi-fhir/P-iTqA69mMw</a><br>\nCan anyone help?</p>",
        "id": 153922751,
        "sender_full_name": "Clarissa Fernandes",
        "timestamp": 1512382955
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193568\">@Pranitha Sruthi</span> What happens when you type \"<a href=\"http://build.fhir.org/validator.pack\" target=\"_blank\" title=\"http://build.fhir.org/validator.pack\">http://build.fhir.org/validator.pack</a>\" into your browser?</p>",
        "id": 153922771,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1512396717
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194442\">@Clarissa Fernandes</span> First, patternString doesn't do regex pattern matching.  I'm not actually sure it'll do anything at all right now - pattern is usually used with complex structures.  How does the validator know that your profile applies to your instance?</p>",
        "id": 153922772,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1512396913
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention\" data-user-id=\"194442\">@Clarissa Fernandes</span> First, patternString doesn't do regex pattern matching.  I'm not actually sure it'll do anything at all right now - pattern is usually used with complex structures.  How does the validator know that your profile applies to your instance?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  I was trying to use the examples in the hapi-fhir. But there does not seems to be any sample data and profiles.<br>\nCould you let me know how i could do custom validation?</p>",
        "id": 153922796,
        "sender_full_name": "Clarissa Fernandes",
        "timestamp": 1512405010
    },
    {
        "content": "<p>HAPI questions are probably best raised on the HAPI thread.  I'm not sure how you make the HAPI validator aware of a new profile or assert that the profile should be enforced.  You could try declaring the profile in the instance.</p>",
        "id": 153922807,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1512407724
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  The validator.pack is getting downloaded. I have downloaded it again and tried to validate a profile but facing the same problem.</p>",
        "id": 153922894,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1512451969
    },
    {
        "content": "<p>Are you using the most recent validator from <a href=\"http://build.fhir.org\" target=\"_blank\" title=\"http://build.fhir.org\">build.fhir.org</a></p>",
        "id": 153922902,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1512454549
    },
    {
        "content": "<p>I have used the validator from the new version of <a href=\"http://build.fhir.org\" target=\"_blank\" title=\"http://build.fhir.org\">build.fhir.org</a> and got it fixed. Thank you</p>",
        "id": 153922922,
        "sender_full_name": "Pranitha Sruthi",
        "timestamp": 1512463948
    }
]