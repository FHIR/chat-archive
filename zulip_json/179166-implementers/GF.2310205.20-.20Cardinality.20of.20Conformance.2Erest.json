[
    {
        "content": "<p><a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=10205\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=10205\">GF#10205</a> proposes to change the cardinality of Conformance.rest to 0..2, to reflect the meaning on of the invariants. I've tried to apply this once before, and got in a mess. But now I'm thinking about it again, I'm wondering whether it's actually a good idea - see this thread, for instance</p>",
        "id": 153974280,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531121751
    },
    {
        "content": "<p><a href=\"#narrow/stream/4-implementers/subject/GF.2317408.20-.20FHIR.20end-point.20discovery\" title=\"#narrow/stream/4-implementers/subject/GF.2317408.20-.20FHIR.20end-point.20discovery\">https://chat.fhir.org/#narrow/stream/4-implementers/subject/GF.2317408.20-.20FHIR.20end-point.20discovery</a></p>",
        "id": 153974281,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531121811
    },
    {
        "content": "<p>so I wonder - maybe we should revoke the invariant rather than insisting that there can only be one endpoint per capability statement.</p>",
        "id": 153974282,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531121847
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> (<span class=\"user-mention\" data-user-id=\"196305\">@Andrew Marcus</span>)</p>",
        "id": 153974283,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531121864
    },
    {
        "content": "<p>Revoking the invariant on this is fine for me -- but _some_ guidance on when/why this repeats would be helpful. In particular, if I'm a client looking to determine a server's capabilities, do I filter the CapabilityStatement.rest to look at only the ones in \"server\" mode, and then take the union of all capabilities I see?</p>",
        "id": 153974483,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1531238884
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> To support our use case  in <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17408\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17408\">GF#17408</a>, in which a server can support multiple FHIR versions simultaneously at different endpoints, a FHIR client would need to be able to determine which FHIR versions are supported by the server and where to find the CapabilityStatement for each.</p>\n<p>So, in this case, a client would look Conformance.rest and filter for the ones in \"server\" mode, then look at the version associated with each.  Once it selected one it was able to work with, it would then fetch all the CapabilityStatement definitions associated with that version.</p>",
        "id": 153974492,
        "sender_full_name": "Andrew Marcus",
        "timestamp": 1531242630
    },
    {
        "content": "<p>On the other hand, each CapabilityStatement can currently only support a single version of FHIR because <code>CapabilityStatement.fhirVersion</code> has a cardinality of <code>1..1</code>.  To make this work as a solution for <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17408\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17408\">GF#17408</a>, you would actually need to push the <code>fhirVersion</code> element down one level into the <code>rest</code> element.</p>\n<p>That is potentially a viable solution, but probably more of a refactor than you'd like.  It also requires each server to publish a single metadata endpoint which aggregates the metadata for all the versions they support, which can be logistically complicated for the implementor depending on the mix of technologies in play.  In addition, it is not clear how to support DSTU2 as one of the versions, which has a <code>ConformanceStatement</code> instead of a <code>CapabilityStatement</code>.</p>",
        "id": 153974494,
        "sender_full_name": "Andrew Marcus",
        "timestamp": 1531243652
    },
    {
        "content": "<p>yes I think that the cross version thing isn't solved by this.</p>",
        "id": 153974524,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531260989
    },
    {
        "content": "<p>as for mutiple end points.... I guess they'd primarily be differentiated by security?</p>",
        "id": 153974525,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531261009
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> yeah, security's an interesting use case.  There could be several <code>CapabilityStatement.rest</code> endpoints with \"server\" mode but with different <code>security.service</code> values; Smart-on-FHIR, certificates, etc.</p>\n<p>Another potential use case would be to use this to point to a GraphQL server if it were distinct from the FHIR endpoints.  <span class=\"user-mention\" data-user-id=\"196306\">@Robert Winterbottom</span></p>\n<p>In either case, though, the different server rest endpoints would need some attributes a client could use to distinguish between them.  In <a href=\"#narrow/stream/4-implementers/subject/GF.2317408.20-.20FHIR.20end-point.20discovery/near/163982\" title=\"#narrow/stream/4-implementers/subject/GF.2317408.20-.20FHIR.20end-point.20discovery/near/163982\">https://chat.fhir.org/#narrow/stream/4-implementers/subject/GF.2317408.20-.20FHIR.20end-point.20discovery/near/163982</a> I show how each could include its own <code>fhirVersion</code>, but perhaps there are other differentiator fields as well.</p>",
        "id": 153974942,
        "sender_full_name": "Andrew Marcus",
        "timestamp": 1531407662
    },
    {
        "content": "<p>so I just committed a change that allows rest to repeat 0..*. <span class=\"user-mention\" data-user-id=\"196305\">@Andrew Marcus</span> you can include any number of end-points now, and you can introduce your own extension to declare what version(s) the endpoints use. if that turns out to have legs, we can add it in R5</p>",
        "id": 153978542,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532650741
    }
]