[
    {
        "content": "<p>Hi,<br>\nI'm using Vonk as my FHIR server and I'm having an issue using the SearchParameter for date searches. I have the SP type=\"date\" and created a organization entry that uses a date:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;extension url=&quot; https://fhir.nhs.uk/STU3/StructureDefinition/ODSAPI-ActivePeriod-1&quot;&gt;\n    &lt;valuePeriod&gt;\n        &lt;start value=&quot;2017-10-09&quot;/&gt;\n    &lt;/valuePeriod&gt;\n&lt;/extension&gt;\n</pre></div>\n\n\n<p>If I do a REST GET <a href=\"http://localhost:4080/Organization?orgperiod=2017-10-09\" target=\"_blank\" title=\"http://localhost:4080/Organization?orgperiod=2017-10-09\">http://localhost:4080/Organization?orgperiod=2017-10-09</a> I get no results. I tried adding =eq2017-10-09 and still no result, however if I do a =ge2017-10-09 it returns the record. Why can't I find an exact match ? I added the comparator \"eq\" to my SP but that made no difference. </p>\n<p>Any suggestions most welcome.<br>\nThanks<br>\nDave</p>",
        "id": 153913088,
        "sender_full_name": "Dave Henderson",
        "timestamp": 1507546803
    },
    {
        "content": "<p>Hi Dave, I can see the extension as part of the project <a href=\"https://simplifier.net/Test-FHIRODSLookupAP/~introduction\" target=\"_blank\" title=\"https://simplifier.net/Test-FHIRODSLookupAP/~introduction\">https://simplifier.net/Test-FHIRODSLookupAP/~introduction</a>, but the SearchParameter is not yet on the project (or not visible to me). If you could either add that or send it in a pm, along with the example Organization resource you uploaded, I want to try to find out what happens.</p>",
        "id": 153913091,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1507550462
    },
    {
        "content": "<p>Hi,<br>\nAfter a discussion with Christiaan, the issue is with the use of valuePeriod.</p>\n<p>My search =eq2017-10-09 is interpreted as [2017-10-09T00:00:00 - 2017-10-10T00:00:00)<br>\nThe period is only equal if it falls within the period.<br>\nSince I have no end date, this cannot be equal and therefore, cannot be found.</p>\n<p>The question is now, how to return an exact match for a valuePeriod that only has a start date available ? </p>\n<p>FHIR itself is not clear on the equality of periods (<a href=\"http://www.hl7.org/implement/standards/fhir/search.html#date\" target=\"_blank\" title=\"http://www.hl7.org/implement/standards/fhir/search.html#date\">http://www.hl7.org/implement/standards/fhir/search.html#date</a>)  and Christiaan suggested a better interpretation could be \"A period in a resource is considered 'equal' if it has any overlap with the period searched for.\"</p>",
        "id": 153913234,
        "sender_full_name": "Dave Henderson",
        "timestamp": 1507631201
    },
    {
        "content": "<p>I've been reconsidering my date searching implementation to use strings rather than native datetime values in some cases, as the timezones keep getting in my way.</p>",
        "id": 153913997,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1508125635
    },
    {
        "content": "<p>The example you provided <code>2017-10-09T00:00:00 - 2017-10-10T00:00:00</code> doesn't have the timezone there, so what does that mean to your local values?</p>",
        "id": 153913998,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1508125680
    },
    {
        "content": "<blockquote>\n<p>FHIR itself is not clear on the equality of periods (<a href=\"http://www.hl7.org/implement/standards/fhir/search.html#date\" target=\"_blank\" title=\"http://www.hl7.org/implement/standards/fhir/search.html#date\">http://www.hl7.org/implement/standards/fhir/search.html#date</a>)  and Christiaan suggested a better interpretation could be \"A period in a resource is considered 'equal' if it has any overlap with the period searched for.\"</p>\n</blockquote>\n<p>For ranges, 'ap' means \"any overlap\" and 'eq' means \"the range of the search value fully contains the range of the target value\" (see right column: <a href=\"http://www.hl7.org/implement/standards/fhir/search.html#prefix\" target=\"_blank\" title=\"http://www.hl7.org/implement/standards/fhir/search.html#prefix\">http://www.hl7.org/implement/standards/fhir/search.html#prefix</a>)</p>\n<blockquote>\n<p>The question is now, how to return an exact match for a valuePeriod that only has a start date available ? </p>\n</blockquote>\n<p>A period without an end date extends indefinitely into the future, so an exact match doesn't really make sense, but 'ap' or 'ge' might do what you want.</p>",
        "id": 153914002,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1508131320
    }
]