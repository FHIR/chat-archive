[
    {
        "content": "<p>I'm trying to figure out how to map ElementDefinition.type element between R3 and R4. It looks like for R3 -&gt; R4, one needs to group all the values that have the same value of \".code\" field and concatenate their \"profile\" and \"targetProfile\" into lists (in R4, ElementDefinition.profile and ElementDefinition.targetProfile are lists).</p>\n<p>However, I don't really understand how can I do that in the mapping language. Out of the box maps for R3 -&gt; R4 seem to be incorrect, they just copy that field as-is.</p>",
        "id": 154856251,
        "sender_full_name": "Ivan Dubrov",
        "timestamp": 1547141276
    },
    {
        "content": "<p>hmm</p>",
        "id": 154985904,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1547303142
    },
    {
        "content": "<p>there is a way, for sure. I'll have a go later today</p>",
        "id": 154986329,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1547303979
    },
    {
        "content": "<p>Any update? Currently R3 =&gt; R4 would produce invalid StructureDefinition's, I think, because it will not group things properly.</p>",
        "id": 162647377,
        "sender_full_name": "Ivan Dubrov",
        "timestamp": 1554488475
    },
    {
        "content": "<p>see the code in org.hl7.fhir.convertors.VersionConvertor_30_40.convertTypeRefComponent in the java reference implementatoin</p>",
        "id": 162659014,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1554496902
    },
    {
        "content": "<p>Right, but is it possible to do that via Mapping Language (<a href=\"https://www.hl7.org/fhir/mapping-language.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/mapping-language.html\">https://www.hl7.org/fhir/mapping-language.html</a>)?</p>",
        "id": 162954233,
        "sender_full_name": "Ivan Dubrov",
        "timestamp": 1554847556
    },
    {
        "content": "<p>yes. see ... oh I see we have not published that in the spec....</p>",
        "id": 162955252,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1554848391
    },
    {
        "content": "<p>hmm. I think it is possible but I didn't do it. I'll review.</p>",
        "id": 162955434,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1554848529
    }
]