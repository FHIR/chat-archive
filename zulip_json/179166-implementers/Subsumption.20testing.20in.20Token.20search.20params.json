[
    {
        "content": "<p>Hi, I read the relevant info in the documentation, but still cannot understand the concept of Subsumption for implementation of the modifiers <code>:below</code> and <code>:above</code> on search parameters of type \"Token\". Could someone please help me with a more intuitive explanation?</p>",
        "id": 153944034,
        "sender_full_name": "emilio",
        "timestamp": 1520898689
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> ?</p>",
        "id": 153944045,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1520902956
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>GET [base]/Condition?code=http://snomed.info/sct|126851005\n</pre></div>",
        "id": 153944073,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1520905422
    },
    {
        "content": "<p>find all conditions that have the SCT code Neoplasm of liver</p>",
        "id": 153944074,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1520905453
    },
    {
        "content": "<p>Here are a couple of examples that I've used in the FHIR terminology tutorial:</p>\n<blockquote>\n<p>Subsumption-based Modifiers<br>\nCode in a resource subsumes the specified search code (e.g. is-a* relationship): <strong>below “Diabetes mellitus” (73211009)</strong><br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Condition?code:below=http://snomed.info/sct|73211009\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Condition?code:below=http://snomed.info/sct|73211009\">http://fhirtest.uhn.ca/baseDstu3/Condition?code:below=http://snomed.info/sct|73211009</a><br>\nCode in a resource is subsumed by the specified search code (e.g. is-a* relationship): <strong>above “Viral pneumonia” (75570004)</strong><br>\n<a href=\"http://fhirtest.uhn.ca/baseDstu3/Condition?code:above=http://snomed.info/sct|75570004\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseDstu3/Condition?code:above=http://snomed.info/sct|75570004\">http://fhirtest.uhn.ca/baseDstu3/Condition?code:above=http://snomed.info/sct|75570004</a></p>\n</blockquote>\n<p>The :below search is returning Condition resources for \"Type 2 diabetes mellitus\" (44054006) (however, for some reason the HAPI server is returning some resource instances with incorrect 'display' values!), which is \"below\" “Diabetes mellitus” in the code system hierarchy.  The :above search is generally less useful, and in this case it's not returning any Condition resource instances, but it might be expected to return cases of \"Pneumonia\" if they existed on the server.</p>",
        "id": 153944075,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1520905522
    },
    {
        "content": "<p>ah I'll let Rob answer this nicely</p>",
        "id": 153944076,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1520905583
    },
    {
        "content": "<p>I guess the markdown doesn't work correctly inside the quote block, but hopefully it's readable</p>",
        "id": 153944081,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1520905671
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> , I understand the concept. But how do I –as an implementer– know that \"Type 2 diabetes mellitus\" (44054006) is \"below\" “Diabetes mellitus” (73211009)?</p>",
        "id": 153944451,
        "sender_full_name": "emilio",
        "timestamp": 1520968467
    },
    {
        "content": "<p>Well, I guess there are a couple of basic answers.  Assuming that you trust the implementation of the FHIR terminology services, you will know that because the resources with those codes were returned by your :below search, because that's how it's supposed to work.  If within the FHIR context you still need to verify that for some reason you can ask the server to verify it using the CodeSystem $subsumes operation (although that should be unnecessary to do in addition to the :below search).  If you need to verify it outside of the FHIR terminology services context, you can do that manually in a variety of ways with different tools - possibly starting with the SNOMED CT browser at <a href=\"http://browser.ihtsdotools.org/\" target=\"_blank\" title=\"http://browser.ihtsdotools.org/\">http://browser.ihtsdotools.org/</a>.  If you enter 44054006 in the search there you will see that it shows 73211009 as the immediate parent concept.  Sometimes you have to traverse multiple levels to see the descendant or ancestor relationship, but theoretically that is doable.</p>",
        "id": 153944457,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1520969698
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195133\">@emilio</span> One option is that for every Condition in your server you add the associated code to a $closure table, and then also add the :below code (73211009) when the search happens.  Then your closure table will tell you directly all the things that are below \"Diabetes mellitus” (73211009). Alternatively, you could expand a ValueSet with a filter of \"concept is-a 73211009\" and use the results to test against the codes in your Conditions.<br>\nThe best / most efficient approaches depend on how you store/index your data, what terminology service capabilities you have, and whether you need to also handle infinite CodeSystems/ValueSets and things like post coordination.</p>",
        "id": 153944608,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1520988248
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> Oh,  so, I, as the implementer of a FHIR server with search capabilities, but no terminology service, each time that I get a query with a <code>:below</code> modifier, will have to consult with a terminology service to know the parents of the code in the query?</p>",
        "id": 153944890,
        "sender_full_name": "emilio",
        "timestamp": 1521061586
    },
    {
        "content": "<p>well, you have several choices:</p>\n<ul>\n<li>you can consult a terminology service each time you get the query</li>\n<li>you can maintain a closure table internally using the closure table maintenance service from the terminology server interface (several open source implementations provide this). </li>\n<li>you can not support the :below modifier</li>\n</ul>",
        "id": 153944892,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1521062127
    },
    {
        "content": "<p>Another option is that you can build your own terminology service capabilities (whether exposed as a FHIR endpoint or accessed internally).</p>",
        "id": 153945355,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1521203986
    }
]