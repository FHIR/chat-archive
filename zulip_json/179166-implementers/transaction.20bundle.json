[
    {
        "content": "<p>Can I use a transaction bundle to do \"Delete all the observations about this patient first, then create this new observation\" ?</p>",
        "id": 197512445,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589439796
    },
    {
        "content": "<p>the spec seems to say so...</p>",
        "id": 197512449,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589439804
    },
    {
        "content": "<p>yes. DELETEs will be processed before POSTs.</p>",
        "id": 197519542,
        "sender_full_name": "René Spronk",
        "timestamp": 1589442245
    },
    {
        "content": "<p>Cool. And do the servers support POSTing a transaction and watch magic happen?</p>",
        "id": 197520530,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589443047
    },
    {
        "content": "<p><em>Some</em> servers do.  As always, depends on the server...</p>",
        "id": 197553675,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1589463013
    },
    {
        "content": "<p>Should this work then?<br>\nWork= create a patient after trying to delete it</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;Bundle&quot;,\n  &quot;type&quot;: &quot;transaction&quot;,\n  &quot;entry&quot;: [\n    {\n    &quot;fullUrl&quot;: &quot;http://test.fhir.org/r4/Patient/159&quot;,\n      &quot;resource&quot;: {\n        &quot;resourceType&quot;: &quot;Patient&quot;,\n        &quot;id&quot;: &quot;159&quot;,\n        &quot;name&quot;: [\n          {\n            &quot;use&quot;: &quot;official&quot;,\n            &quot;family&quot;: &quot;Larssonsson&quot;,\n            &quot;given&quot;: [\n              &quot;Axel&quot;\n            ]\n          }\n        ],\n        &quot;gender&quot;: &quot;male&quot;\n      },\n      &quot;request&quot;: {\n        &quot;method&quot;: &quot;PUT&quot;,\n        &quot;url&quot;: &quot;Patient/159&quot;\n      }\n    },\n    {\n      &quot;request&quot;: {\n        &quot;method&quot;: &quot;DELETE&quot;,\n        &quot;url&quot;: &quot;Patient/159&quot;\n      }\n    }\n  ]\n}\n</code></pre></div>",
        "id": 197562201,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589466071
    },
    {
        "content": "<p>Hapi is not hapi with it. <a href=\"http://test.fhir.org\">test.fhir.org</a> neither (but I am debugging that)</p>",
        "id": 197562264,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589466097
    },
    {
        "content": "<p>no, a resource identity (Patient/159 in this case) can only appear once in a transaction</p>",
        "id": 197562846,
        "sender_full_name": "Paul Church",
        "timestamp": 1589466419
    },
    {
        "content": "<p>ah great</p>",
        "id": 197563107,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589466583
    },
    {
        "content": "<p>one question: if you are talking about HAPI, can we do $expunge in a transaction? I want to really delete patient 159</p>",
        "id": 197563629,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589466801
    },
    {
        "content": "<p>that's a good question, I can't answer for hapi but the equivalent on Google doesn't allow that - does anyone allow extended $operations in transactions in general?</p>",
        "id": 197564702,
        "sender_full_name": "Paul Church",
        "timestamp": 1589467251
    },
    {
        "content": "<p>wouldn't that require some sort of defined arbitrary order between execution of operations?</p>",
        "id": 197582716,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589474343
    },
    {
        "content": "<p>Actually - <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I can't seem to find any order for processing of operations on <a href=\"https://www.hl7.org/fhir/http.html#transaction\">https://www.hl7.org/fhir/http.html#transaction</a>. Couldn't/shouldn't such an order actually be defined in the capability statement - if needed that is? I Guess <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> would like the $expunge executed deterministically</p>",
        "id": 197583670,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589474709
    },
    {
        "content": "<p>And maybe there's a note somewhere missing that while there is a order, it can be manipulated for at least search given that the search is conducted using POST mode, which then in turn would let you process your search using POST which in turn means that you probably bypass the intended ordering. <span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span> would you know something about that?</p>",
        "id": 197588594,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589476781
    },
    {
        "content": "<blockquote>\n<p>I can't seem to find any order for processing of operations on <a href=\"https://www.hl7.org/fhir/http.html#transaction\">https://www.hl7.org/fhir/http.html#transaction</a></p>\n</blockquote>\n<p>by POST/GET - isn't that enough?</p>",
        "id": 197603670,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589483376
    },
    {
        "content": "<p>Regarding search: maybe it is enough. I was just wondering if it could cause some trouble doing the search using POST in a transaction</p>",
        "id": 197613877,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589488330
    },
    {
        "content": "<p>well, you get some confusing results - you could do the same search twice and get different results</p>",
        "id": 197613929,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589488361
    },
    {
        "content": "<p>yes - that is definitely one outcome</p>",
        "id": 197613989,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589488400
    },
    {
        "content": "<p>that also goes for idempotent operations I guess - since they can be executed as both POST and GET</p>",
        "id": 197614226,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589488530
    },
    {
        "content": "<p>the other thing regarding operations would be if order should be defined across operations. I guess that is probably a bit out of scope since there's order between resources themselves: eg. no rule states that POST /Encounter should be executed before POST /Observation. But with operations it might be a bit more tricky: eg. it might be nice to always have $operationAAA executed before $operationXYZ within a transaction to have the operation execution run deterministically - but no such order or definition of it exists AFAIK.</p>",
        "id": 197615080,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589488926
    },
    {
        "content": "<p>I think it'll have to be literal order</p>",
        "id": 197615271,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589489023
    },
    {
        "content": "<p>that isn't stated anywhere is it?</p>",
        "id": 197615523,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589489156
    },
    {
        "content": "<p>it could also have been a property on operationDefinition?</p>",
        "id": 197615638,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589489202
    },
    {
        "content": "<p>no it's not stated and maybe but I don't know how it would work</p>",
        "id": 197615735,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589489252
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> Operations are allowed as part of a transaction</p>",
        "id": 197643229,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1589511287
    },
    {
        "content": "<p>I guess literal will do for now - adding that piece of doc might be useful though it is not critical for me now  ;)</p>",
        "id": 197656378,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1589528141
    }
]