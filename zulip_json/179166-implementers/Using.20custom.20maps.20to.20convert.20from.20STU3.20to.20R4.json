[
    {
        "content": "<p>Hi,<br>\n    I am currently exploring the Validator tool ( <a href=\"https://github.com/hapifhir/org.hl7.fhir.core\">https://github.com/hapifhir/org.hl7.fhir.core</a>)  to convert from one Fhir version to another . The default maps provided (<a href=\"https://github.com/FHIR/packages/tree/master/interversion/r4/R3toR4\">https://github.com/FHIR/packages/tree/master/interversion/r4/R3toR4</a>) suffices for most of the cases .<br>\nBut in future if we want to add some extensions we would want to be able to use the updated .map version for that resource to accomodate that . For example I am using the following comandline arguments for the Validator Tool to use my local custom map for Resource Condition .<br>\nc:\\fhirmessages\\fhir_condition_epic_stu3_searched.json -version 3.0 -to-version 4.0 -output c:\\fhirmessages\\fhir_condition_epic_r4_searched_output.json -do-native -ig C:\\fhirmessages\\maps_new</p>\n<p>The last argument -ig refers to the directory from where it should load my updated Condtions.map. <br>\nBut while running it keeps giving the following error :</p>\n<ul>\n<li>.. load IG from C:\\fhirmessages\\maps_new</li>\n<li>load file: Condition.txt - ignored due to error:  (null - NPE)</li>\n</ul>\n<p>Am I missing something here . Has anybody used this tool to do conversion using you custom maps ?</p>\n<p>Any help on this is greatly appreciated !</p>\n<p>Thanks</p>",
        "id": 200121153,
        "sender_full_name": "Debashish Ghosh",
        "timestamp": 1591632827
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 200121362,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1591632942
    },
    {
        "content": "<p>you pointed it to a directory to load content from. It's just telling you that it found a file in there that it couldn't read as loadable content. In this case, it looks like it shouldn't be loaded, so that's fine</p>",
        "id": 200140337,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591642182
    },
    {
        "content": "<p>Thanks for your reply . So I am trying to do a conversion from STU3 to R4 and following the documentation <a href=\"https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content#R3_.2F_R4_conversions\">https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content#R3_.2F_R4_conversions</a> .</p>\n<p>Based on the documentation I provided the following arguments to the tool :<br>\nc:\\fhirmessages\\fhir_condition_epic_stu3_searched.json -transform <a href=\"http://hl7.org/fhir/StructureMap/Condition3to4\">http://hl7.org/fhir/StructureMap/Condition3to4</a> -ig C:\\fhirmessages\\maps_new\\interversion\\r4\\R3toR4 -output c:\\fhirmessages\\fhir_condition_epic_r4_searched_output.json -log c:\\fhirmessages\\log\\logs.txt</p>\n<p>I changed the Conditions.map file in C:\\fhirmessages\\maps_new\\interversion\\r4\\R3toR4 and also copied all other files in this directory from <a href=\"https://github.com/FHIR/packages\">https://github.com/FHIR/packages</a> . <br>\nIt keeps giving me the following error :</p>\n<ul>\n<li>\n<p>.. load IG from C:\\fhirmessages\\maps_new\\interversion\\r4\\R3toR4<br>\n   ..Detect format for C:\\fhirmessages\\maps_new\\interversion\\r4\\R3toR4\\AdverseEvent.map.bak<br>\n[Fatal Error] :1:1: Content is not allowed in prolog.</p>\n</li>\n<li>\n<p>load file: ConceptMaps.txt - ignored due to error: Error in ConceptMaps.txt at 8, 6: Unknown relationship token '='<br>\nStart Transform <a href=\"http://hl7.org/fhir/StructureMap/Condition3to4\">http://hl7.org/fhir/StructureMap/Condition3to4</a><br>\nGroup : Condition; vars = source variables [src: (Bundle)], target variables [tgt: (Condition)], shared variables []<br>\nException in thread \"main\" java.lang.Error: duplicate<br>\n    at org.hl7.fhir.r5.utils.StructureMapUtilities.findMatchingMaps(StructureMapUtilities.java:1534)<br>\n    at org.hl7.fhir.r5.utils.StructureMapUtilities.resolveGroupReference(StructureMapUtilities.java:1671)<br>\n    at org.hl7.fhir.r5.utils.StructureMapUtilities.executeGroup(StructureMapUtilities.java:1402)<br>\n    at org.hl7.fhir.r5.utils.StructureMapUtilities.transform(StructureMapUtilities.java:1369)<br>\n    at org.hl7.fhir.validation.ValidationEngine.transform(ValidationEngine.java:1215)<br>\n    at org.hl7.fhir.validation.ValidationEngine.transform(ValidationEngine.java:1202)<br>\n    at org.hl7.fhir.validation.cli.services.ValidationService.transform(ValidationService.java:138)<br>\n    at org.hl7.fhir.validation.Validator.main(Validator.java:180)</p>\n</li>\n</ul>\n<p>I just want to change some mapping in the resource Condition and see how easy it is to update the mappings .<br>\nIs there a trick I am missing out here to get this working ?</p>\n<p>Thanks!</p>",
        "id": 200145641,
        "sender_full_name": "Debashish Ghosh",
        "timestamp": 1591645007
    },
    {
        "content": "<p>well, it looks like you have a syntax error in tour revised mapping</p>",
        "id": 200158445,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591651773
    }
]