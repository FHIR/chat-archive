[
    {
        "content": "<p>The addition of PractitionerRole looks to complicate finding resources associated with a particular physician. </p>\n<p>Currently ImagingStudy has a referrer element of type Reference(Practitioner). To find all ImagingStudy referred by a given practitioner can be done in a single query. We've been asked to change to Reference(Practitioner | PractitionerRole). Is there a recommended search (either as definition of the search parameter, or that we can provide as an example query) that can return all ImagingStudies where a practitioner is either directly referenced, or referenced via the Practitioner role?</p>",
        "id": 154019858,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1542742701
    },
    {
        "content": "<p>That's a good question.  It would be nice if there was an easy way to do this.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span> ?</p>",
        "id": 154019859,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1542742786
    },
    {
        "content": "<p>not the scope of R4</p>",
        "id": 154019954,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1542776893
    },
    {
        "content": "<p>similar clarity on Practitioner compartment?</p>",
        "id": 154020245,
        "sender_full_name": "John Moehrke",
        "timestamp": 1542820726
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> Can you submit a change request for us to evaluate in R5?</p>",
        "id": 154020273,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1542823731
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19688\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19688\">GF#19688</a> submitted.<br>\n<span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> -  Yuck... And you accuse me of coming up with nasty CRs. I've included it in my tracker item.</p>",
        "id": 154020292,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1542826803
    },
    {
        "content": "<p>I only to aspire to your ability to come up with the \"Oh, $hit\" change requests... <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span></p>",
        "id": 154020307,
        "sender_full_name": "John Moehrke",
        "timestamp": 1542831644
    },
    {
        "content": "<p>Maybe this is a crazy idea but would it make sense to add a generalized search parameter to match all resources of a specified type within <em>n</em> degrees of separation? So if you have a Procedure and search for Practitioner with n=2 then you could get those referenced directly as well as those referenced indirectly via PractitionerRole.</p>",
        "id": 154020320,
        "sender_full_name": "Nick Radov",
        "timestamp": 1542834168
    },
    {
        "content": "<p>Yeah, I think something like that may be needed. As I was writing up the tracker item, I thought of cases where you can have a Patient directly, or Patient as part of a Group; Practitioner directly, or Practitioner as part of a PractitionerRole; Organization directly, or Organization as part of a PractitionerRole; and Practitioner directly, or Practitioner as part of a CareTeam. I'm sure there must be more.</p>",
        "id": 154020321,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1542834442
    },
    {
        "content": "<p>Can you add your suggestion to the tracker?</p>",
        "id": 154020322,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1542834461
    },
    {
        "content": "<p>The Patient $everything operation might be semi-related. Or at least implementation of it might cause you to chase various levels of relationships.</p>",
        "id": 154020323,
        "sender_full_name": "Craig McClendon",
        "timestamp": 1542834622
    },
    {
        "content": "<p>added follow-up on tracker</p>",
        "id": 154020324,
        "sender_full_name": "Nick Radov",
        "timestamp": 1542834939
    },
    {
        "content": "<p>I have a different stream and change request relative to the Patient with linked patients... so lets not conflate</p>",
        "id": 154020334,
        "sender_full_name": "John Moehrke",
        "timestamp": 1542838726
    },
    {
        "content": "<p>The Practitioner search seems a bit less problematic. If I am looking for all resources authored by a Practitioner. It likely is appropriate that I am required to first look for all the PractitionerRole that the Practitioner might have played, and pick from that list the subset I really am interested</p>",
        "id": 154020336,
        "sender_full_name": "John Moehrke",
        "timestamp": 1542838783
    },
    {
        "content": "<p>And the practitioner compartment might be more appropriate in some cases, but obv not possible when walking through the patient compartment too. (but that's something for R5 too)</p>",
        "id": 154022445,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1543831768
    },
    {
        "content": "<p>From <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17358\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17358\">GF#17358</a> we just had a discussion on the FHIR Infrastructure workgroup call about incorporating resources linked to a <code>PractitionerRole</code> in a Practitioner compartment. Functionally this feels critical, given that almost all references a Practitioner now occur via a PractitionerRole. But in terms of server support, this would introduce new requirements, like the ability to index a compartment based or resources linked to a PractitionerRole (one hop away from the focus resource of the compartment).</p>",
        "id": 157558385,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1549315402
    },
    {
        "content": "<p>For server developers, is this something you could envision supporting? How hard it is it likely to be?</p>",
        "id": 157558459,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1549315448
    },
    {
        "content": "<p>I will research...</p>",
        "id": 157558488,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549315481
    },
    {
        "content": "<p>FYI <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> <span class=\"user-mention\" data-user-id=\"191318\">@nicola (RIO/SS)</span></p>",
        "id": 157558490,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1549315484
    },
    {
        "content": "<p>but the problem for me is that I have to re-index quite a lot of resources if the PractitionerRole resource changes</p>",
        "id": 157558509,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549315506
    },
    {
        "content": "<p>I think that's a pretty big deal - doing that inside an atomic transaction</p>",
        "id": 157558519,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549315521
    },
    {
        "content": "<p>We should also discuss the possibility of deprecating the Practitioner compartment and just doing a PractitionerRole compartment.</p>",
        "id": 157558546,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1549315556
    },
    {
        "content": "<p>We could handle many use cases with that, I'd bet.</p>",
        "id": 157558603,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1549315578
    },
    {
        "content": "<p>I had an idea a couple of years ago that we could effectively replace Pracitioner with PractitionerRole and let PractitionerRoles nest.  My intent was to support servers that don't have a concept of providers working at different locations (e.g. a national server that only cares about IDs and credentials) in the same structure as servers that do, but I think it'd work here too.  It didn't get any traction back then, and I didn't feel strongly enough to pursue it.  Is it worth considering in light of this challenge?</p>",
        "id": 157621639,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1549386531
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span></p>",
        "id": 157621799,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1549386640
    },
    {
        "content": "<p>Note that the resolution of this issue should consider the resolution of <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19688\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19688\">GF#19688</a>, and vice-versa.</p>",
        "id": 157623487,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1549388037
    },
    {
        "content": "<p>No problems to implement.</p>",
        "id": 157671063,
        "sender_full_name": "nicola (RIO/SS)",
        "timestamp": 1549437928
    },
    {
        "content": "<p>I haven't tested it, but I think we might already support it in our current implementation of compartment search. So sure we could solve this, and it should not be too hard. BTW, in R3 the Patient compartment had this problem already for Provenance (\"target.subject or target.patient or patient\").</p>",
        "id": 159892453,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1551684308
    }
]