[
    {
        "content": "<p>Hi. We're starting a bigger project and will be defining profiles in bulk. For this we need some conventions. Our current strategy is:</p>\n<p>http://[domain]/fhir/[ConformanceResource]/[project]-[name]</p>\n<p>example:<br>\n<a href=\"http://nictiz.nl/fhir/StructureDefinition/bgz-AllergyIntolerance\" target=\"_blank\" title=\"http://nictiz.nl/fhir/StructureDefinition/bgz-AllergyIntolerance\">http://nictiz.nl/fhir/StructureDefinition/bgz-AllergyIntolerance</a></p>\n<p>This seems to be comparable to what other projects are doing. What we are missing is a strategy for versions of profiles. I'm not talking about versions that you create as you develop but version 1.0 and 2.0. Is there any best practice?</p>\n<p>Options:<br>\nhttp://[domain]/fhir/[ConformanceResource]/[version]/[project]-[name]<br>\nhttp://[domain]/fhir/[ConformanceResource]/[project]-[name]-[version]<br>\n...</p>",
        "id": 153834333,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1466680977
    },
    {
        "content": "<p>my advice on this is:<br>\n- when you make a breaking change, that's a new resource identity (new canonical URL) - this is semver mahor version. So you could write that into your URL at the start (or default -1 out, or something)</p>\n<p>- the minor version is .version in the resource. you roll that over under manual control (or under some algorithm that tells the user/system when the minor version changes. e.g. for value set, any change to the content logical definition (per VSD spec) means a new minor version</p>",
        "id": 153834335,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1466681146
    },
    {
        "content": "<p>Hi Grahame, thanks. I'm not worried so much about the decision to create a new profile (version) as opposed to updating the current version. I'm merely wondering about 'when I've determined I need a new canonical URL because I am creating a new profile version, where does the version part go in the canonical URL?' I'm sure I've got total freedom to create whatever URL I want, but if there's any lore on how to do this, I'd like to use it</p>",
        "id": 153834337,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1466681358
    },
    {
        "content": "<p>well, its usually appended as -X or just X</p>",
        "id": 153834338,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1466681726
    },
    {
        "content": "<p>but I've only seen a mahor version change actually happen once so far (usually, a major version change means a scope change and a new name anyway))</p>",
        "id": 153834339,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1466681765
    },
    {
        "content": "<p>FHIR is young. It is only a matter of time before profiles start versioning more often I'm sure. Thanks for your answer. I guess that means we'll go with:</p>\n<p>http://[domain]/fhir/[ConformanceResource]/[project]-[name]-[version]</p>",
        "id": 153834342,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1466681992
    },
    {
        "content": "<p>sure it will happen. it's just that we don't have much experience with ityet</p>",
        "id": 153834389,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1466684561
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191375\">@Alexander Henket</span> Just out of curiosity: What is http://[domain]/fhir going to resolve to? Are the profiles hosted at this endpoint (are you going to redirect to the project endpoint on simplifier) ?</p>",
        "id": 153834435,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1466689118
    },
    {
        "content": "<p>Good question. We do not know yet. We come from V3 with 2386 templates, 1236 of which are active. Suppose that translates to roughly the same amount of profiles over time [we suspect a lot less, but for arguments sake], then we would need to maintain the same number of endpoints. That doesn't sound like a sustainable situation.</p>\n<p>So... my current thinking is that we redirect all endpoints under http://[domain]/fhir to some kind of portal place [maybe just Simplifier] where you may find what you want rather than trying to make every single canonical URL resolve directly.</p>\n<p>If bright ideas float around I'd love to be inspired by them.</p>",
        "id": 153834446,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1466691287
    },
    {
        "content": "<p>canonical URLs are really just registry references in the end</p>",
        "id": 153834572,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1466716598
    },
    {
        "content": "<p>Yes, but still: wouldn't it be nice if all these URLs resolved - at least - to a default site with a simplifier search box ;-)</p>",
        "id": 153834792,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1466765211
    },
    {
        "content": "<p>...or, for the sake of convenience: a prepopulated search box...</p>",
        "id": 153834795,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1466765349
    },
    {
        "content": "<p>BTW: Intuitively I'd expect http://[domain]/fhir  to be a FHIR endpoint, no?</p>",
        "id": 153834796,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1466765671
    },
    {
        "content": "<p>Shouldn't we somehow distinguish the URL conventions for fhir namespaces and fhir endpoints?</p>",
        "id": 153834797,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1466765787
    },
    {
        "content": "<p>no, in many cases they are the same thing. The specification itself, for instance, and any IG published using the new IG infrastructure</p>",
        "id": 153834798,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1466765862
    },
    {
        "content": "<p>Can you have dashes in [project] and [name]? <span class=\"user-mention\" data-user-id=\"191375\">@Alexander Henket</span> the wiki doesn't disallow them explicitly</p>",
        "id": 153880977,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1491399766
    },
    {
        "content": "<p>yes</p>",
        "id": 153881052,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1491440327
    },
    {
        "content": "<p>Awesome thanks</p>",
        "id": 153881077,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1491461025
    },
    {
        "content": "<p>We are investigating the use of a semver major version number in the canonical URLs. (Similiar question asked by Alexander in the beginning of this thread in 2016). The R4 and build spec advice to do so: <a href=\"http://build.fhir.org/resource.html#versions\" title=\"http://build.fhir.org/resource.html#versions\">http://build.fhir.org/resource.html#versions</a></p>\n<p>I am wondering if that advice is still present if you would take the fhir npm packages into account. We are currently versioning the conformance resources through packages. <br>\nWhy should or shouldn't we include a major version number in the canonicals?</p>",
        "id": 193044968,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1586181478
    },
    {
        "content": "<p>Hi there! We're looking to provide our Questionnaires in FHIR for several of our health providers but need some advice around the canonical URL references between a QuestionnaireResponse and its corresponding Questionnaire</p>\n<p>If our healthcare providers modify a Questionnaire, we'd like to increment <code>Questionnaire.version</code> and have all future QuestionnaireResponses reference this new version (<code>QuestionnaireResponse.questionnaire</code>) as the latest version reflects the set of questions that a patient would have answered</p>\n<p>We can see that <code>QuestionnaireResponse.questionnaire</code> is a canonical reference that corresponds to <code>Questionnaire.url</code></p>\n<p>So if we have a new version of a Questionnaire (<code>version = 2</code>), would <code>QuestionnaireResponse.questionnaire</code> and <code>Questionnaire.url</code> be set to <code>Questionnaire/my-questionnaire|2</code>?</p>\n<p>How would searching work? Doing the above and using the search <code>Questionnaire/my-questionnaire|2</code> gives us a 404 on the <code>https://vonk.fire.ly/R4</code> server so we're not sure we completely understand how this Questionnaire version and searching is intended to work</p>",
        "id": 209958766,
        "sender_full_name": "tom",
        "timestamp": 1600047523
    },
    {
        "content": "<p>I think your interpretation is correct. <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> can you comment about the vonk server</p>",
        "id": 209960833,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1600051264
    },
    {
        "content": "<p>Hello <span class=\"user-mention\" data-user-id=\"340802\">@tom</span> , </p>\n<p>I have briefly tried. I only see version 10 on the R4 endpoint currently (twice even), and I can find them by searching for:<br>\n<code>GET http://vonk.fire.ly/R4/Questionnaire?Questionnaire/594b8ddd-10d4-4357-b675-d0d685cd0772|10</code></p>\n<p>Note that canonical url's are generally meant to be <em>full</em> urls.<br>\nThere could be subtle issues here when referencing the Questionnaire by versioned url though, so please check back if you get unexpected results.</p>",
        "id": 209991873,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1600082874
    },
    {
        "content": "<p>I do not have the answer but I have similar issues.</p>\n<ol>\n<li>\n<p>Sample message provided on <strong>https://www.hl7.org/fhir/questionnaireresponse-example-gcs.json.html</strong> failed the validation when using \"questionnaire\": \"Questionnaire/gcs\"  <br>\n    \"severity\" : \"error\",<br>\n    \"code\" : \"structure\",<br>\n    \"details\" : {<br>\n      \"text\" : \"Canonical URLs must be absolute URLs if they are not fragment references (Questionnaire/gcs) \"<br>\n    },<br>\n    \"expression\" : [\"QuestionnaireResponse.questionnaire\"] </p>\n</li>\n<li>\n<p>What is a proper format of using canonical URL for referencing Questionnaire in resource QuestionnaireResponse?  Can someone send any example that is FHIR conformant?  Thanks.</p>\n</li>\n</ol>",
        "id": 210069312,
        "sender_full_name": "Maria Hu",
        "timestamp": 1600121539
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> and <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> , really appreciate your feedback</p>\n<p><span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> Using your search I'm getting a <code>400 Bad Request - Argument 'Questionnaire/594b8ddd-10d4-4357-b675-d0d685cd0772|10' lacks the name/value separator '=' or has no value</code></p>\n<p>Adding <code>url=</code> in returns a bundle containing the Questionnaires, is this what you were using?<br>\n<code>http://vonk.fire.ly/R4/Questionnaire?url=Questionnaire/594b8ddd-10d4-4357-b675-d0d685cd0772|10</code></p>\n<p>I was hoping that by setting QuestionnaireResponse.questionnaire directly to the canoncial URL <code>Questionnaire/594b8ddd-10d4-4357-b675-d0d685cd0772|10</code>, this would resolve directly to the correct questionnaire too somehow - rather than needing to form the separate search term above (which also returns a bundle rather than just the Questionnaire). Is this not possible? Or is the canonical URL not supposed to resolve to the location of the resource on the server?</p>\n<p>Interesting point about the <code>full URL</code> too.. In our case, all resources are located on our FHIR server so we been favouring relative URLs up until now to protect us if say we decided to ever move our data to a different server then these wouldn't need updating</p>",
        "id": 210082982,
        "sender_full_name": "tom",
        "timestamp": 1600134278
    },
    {
        "content": "<p>Sorry <span class=\"user-mention\" data-user-id=\"340802\">@tom</span> , for the copy/paste error, you inferred the correct query indeed (with <code>url=</code> in front).<br>\nWhat do you exactly mean by 'would resolve directly'? </p>\n<ul>\n<li>getting it with an include like this: <code>{base}/R4/QuestionnaireResponse?_include:QuestionnaireResponse.questionnaire</code></li>\n<li>or using it in chained searches like this <code>{base}/R4/QuestionnaireResponse?questionnaire.url=Questionnaire/594b8ddd-10d4-4357-b675-d0d685cd0772|10</code></li>\n</ul>",
        "id": 210229909,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1600241694
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 210229991,
        "sender_full_name": "tom",
        "timestamp": 1600241771
    },
    {
        "content": "<p>No worries <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span> ! Looks like I missed the <code>url=</code> when reading the docs too <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> </p>\n<p>So just to confirm that Questionnaire.url and QuestionnaireResponse.questionnaire should be set to the same thing - <code>{base}/Questionnaire/594b8ddd-10d4-4357-b675-d0d685cd0772|10</code>?</p>\n<p>On the resolve directly part, I got mixed up between general and canonical references where general references are literal but we need to search for a canoncial reference using <code>url=</code>.</p>\n<p>I've created another example of <code>my-questionnaire</code> where there is a version 1 and a version 2. It seems that the server returns both versions even if I explicitly search for version 1: <code>url=https://vonk.fire.ly/R4/Questionnaire?url=https://vonk.fire.ly/R4/Questionnaire/my-questionnaire|1</code><br>\nDoes this server not support searches using the <code>|{version}</code> notation? <code>url=https://vonk.fire.ly/R4/Questionnaire?url=https://vonk.fire.ly/R4/Questionnaire/my-questionnaire&amp;version=1</code> seems to work however</p>",
        "id": 210339131,
        "sender_full_name": "tom",
        "timestamp": 1600306066
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191347\">@Mirjam Baltus</span> could you look into this in detail?</p>",
        "id": 210965922,
        "sender_full_name": "Christiaan Knaap",
        "timestamp": 1600845159
    }
]