[
    {
        "content": "<p>I am having trouble searching the FHIR server for a document bundle based on its composition id. I tried:<br>\n<strong>[base]/Bundle?composition=[resource id] </strong><br>\nand get no results. If I alter this search I always return this error:<br>\n<em>\"Unknown search parameter \\\"composition_id\\\". Value search parameters for this search are: [_id, _language, composition, identifier, message, timestamp, type]\"</em><br>\nAm I doing something wrong? Thanks</p>",
        "id": 215005614,
        "sender_full_name": "Ben Grey",
        "timestamp": 1603994597
    },
    {
        "content": "<p>I would expect that a DocumentReference would index those FHIR-Documents(compositions+) that have been committed to a persistant bundle (binary).</p>",
        "id": 215005868,
        "sender_full_name": "John Moehrke",
        "timestamp": 1603994720
    },
    {
        "content": "<p><a href=\"http://hl7.org/fhir/documents.html\">http://hl7.org/fhir/documents.html</a></p>",
        "id": 215005995,
        "sender_full_name": "John Moehrke",
        "timestamp": 1603994778
    },
    {
        "content": "<p><a href=\"http://hl7.org/fhir/documentreference-mappings.html#fhircomposition\">http://hl7.org/fhir/documentreference-mappings.html#fhircomposition</a></p>",
        "id": 215006062,
        "sender_full_name": "John Moehrke",
        "timestamp": 1603994812
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span>  Thanks! If the contents of a document bundle including the composition are not created and stored individually, but only persist on the server within a bundle, can you query the bundles based on on their contents other than bundle id?</p>",
        "id": 215008200,
        "sender_full_name": "Ben Grey",
        "timestamp": 1603995781
    },
    {
        "content": "<p>You can chain through Composition.  So you can say <code>[base]/Bundle?composition.subject=Patient/123</code> or stuff like that</p>",
        "id": 215010444,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1603996920
    },
    {
        "content": "<p>(providing the server supports the chaining in question)</p>",
        "id": 215010503,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1603996935
    },
    {
        "content": "<p>the limitations of Binary elements and unknown of how capable a server will be at searching within a Binary.... is a reason why a DocumentReference is useful metadata</p>",
        "id": 215015967,
        "sender_full_name": "John Moehrke",
        "timestamp": 1603999544
    },
    {
        "content": "<p>If the Patient resource was in the document Bundle, would the syntax for looking for all documents for Patient 123 be something like <br>\nGET [base]/Bundle?composition.subject:Patient.identifier=123 and if I wanted to get a document  Bundle based on its identifier the would <br>\nGET [base]/Bundle?composition.identifier=abc123 be an OK syntax?</p>",
        "id": 215563725,
        "sender_full_name": "Dave Barnet",
        "timestamp": 1604485843
    },
    {
        "content": "<p>Typically you'll want to include the identifier system, not just the identifier value, but yes, that looks like the appropriate syntaxes</p>",
        "id": 215602743,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1604506097
    },
    {
        "content": "<p>Putting reasons as to why you would want to do this aside, if there was a use case to send both query parameters, it looks from the Search page on the FHIR spec that you use a \"$\" to AND these 2 parameters together<br>\nGET [base]/Bundle?composition.identifier=abc123$composition.subject:Patient.identifier=https://fhir.nhs.uk/Id/nhs-number|123<br>\ndoes that look correct?</p>",
        "id": 215688447,
        "sender_full_name": "Dave Barnet",
        "timestamp": 1604568917
    },
    {
        "content": "<p>Actually, it'd be an &amp; , not a $ ..</p>",
        "id": 215717937,
        "sender_full_name": "René Spronk",
        "timestamp": 1604586388
    },
    {
        "content": "<p>It looks as if it should be a \"&amp;\", but according to the Search documentation, as we are using chaining in the search parameters, I think you are supposed to use \"$\" to AND parameters together (<a href=\"http://hl7.org/fhir/R4/search.html#combining\">http://hl7.org/fhir/R4/search.html#combining</a>)</p>",
        "id": 215724885,
        "sender_full_name": "Dave Barnet",
        "timestamp": 1604589208
    },
    {
        "content": "<p>Composite search parameters using $ have to be pre-defined, and servers will list which ones they support in the capability statement. It's not an operator that can be applied arbitrarily in a query.</p>",
        "id": 215730764,
        "sender_full_name": "Paul Church",
        "timestamp": 1604591519
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197072\">@Paul Church</span> <span class=\"user-mention\" data-user-id=\"191372\">@René Spronk</span>  - I didn't pick that up from documentation. Could you point me to the relevant section that says parameters using $ have to be pre-defined?</p>",
        "id": 215829118,
        "sender_full_name": "Dave Barnet",
        "timestamp": 1604659457
    },
    {
        "content": "<p>See <a href=\"http://build.fhir.org/search.html#composite\">http://build.fhir.org/search.html#composite</a> , which is the only search parameter type that uses $ as a separator</p>",
        "id": 215839820,
        "sender_full_name": "René Spronk",
        "timestamp": 1604666253
    }
]