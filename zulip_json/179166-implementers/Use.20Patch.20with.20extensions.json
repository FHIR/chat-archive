[
    {
        "content": "<p>Hi,</p>\n<p>Is there a way to add extensions with FHIRPath Patch operation? I tried a couple of ways and all seems to be not working. Is this implementation issue or it is not possible by specification?</p>",
        "id": 249830627,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1629282356
    },
    {
        "content": "<p>It <em>should</em>.  What are you sending?</p>",
        "id": 249873559,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629303269
    },
    {
        "content": "<p>Hi,<br>\nI am sending this patch for the Specimen:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;parameter&gt;\n      &lt;name value=&quot;operation&quot;/&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;type&quot;/&gt;\n         &lt;valueString value=&quot;add&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;path&quot;/&gt;\n         &lt;valueString value=&quot;Specimen&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;name&quot;/&gt;\n         &lt;valueString value=&quot;processing&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;value&quot; /&gt;\n         &lt;part&gt;\n             &lt;name value=&quot;description&quot; /&gt;\n             &lt;valueString value=&quot;test&quot; /&gt;\n         &lt;/part&gt;\n         &lt;part&gt;\n             &lt;name value=&quot;timeDateTime&quot; /&gt;\n             &lt;valueDateTime value=&quot;2021-08-13T07:44:38.342+00:00&quot; /&gt;\n          &lt;/part&gt;\n      &lt;/part&gt;\n   &lt;/parameter&gt;\n&lt;/Parameters&gt;\n</code></pre></div>\n<p>Ideally I would like to also add extension for the processing item with the reference for the Device. <br>\n I can do this through update and send the whole Specimen:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;Specimen xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n  &lt;id value=&quot;2507723&quot;/&gt;\n  &lt;meta&gt;\n    &lt;versionId value=&quot;14&quot;/&gt;\n    &lt;lastUpdated value=&quot;2021-08-18T09:41:19.389+00:00&quot;/&gt;\n    &lt;source value=&quot;#BamO8GltglzMPXDN&quot;/&gt;\n  &lt;/meta&gt;\n  &lt;processing&gt;\n    &lt;description value=&quot;test&quot;/&gt;\n    &lt;timeDateTime value=&quot;2021-08-13T07:44:38.342+00:00&quot;/&gt;\n    &lt;extension url=&quot;device&quot;&gt;\n      &lt;valueReference&gt;\n        &lt;reference value=&quot;Device/1&quot;/&gt;\n      &lt;/valueReference&gt;\n    &lt;/extension&gt;\n  &lt;/processing&gt;\n&lt;/Specimen&gt;\n</code></pre></div>\n<p>But I tried a few different formats for the Patch on Spark and HAPI and none of them seems to work, though server returned no errors. So I wonder how it should look like, so I can try it and if it doesn't work for Spark - I could try to fix it. The documentation is quite vague for the complex scenarious and there is no such example in provided examples.</p>",
        "id": 249944433,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1629352061
    },
    {
        "content": "<p>Is the base patch without extension working?  If yes, can you share the patch that <em>isn't</em> working?</p>",
        "id": 249997807,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629384831
    },
    {
        "content": "<p>Have a look here: <a href=\"#narrow/stream/179166-implementers/topic/How.20to.20PATCH.20an.20extension.3F\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/How.20to.20PATCH.20an.20extension.3F</a></p>",
        "id": 250023047,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1629396045
    },
    {
        "content": "<p>Thanks! I checked the link and it did help a bit. <br>\n<span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>, could you please check this patch is correct then? HAPI is not adding extention and Spark gives bad request for it.</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;parameter&gt;\n      &lt;name value=&quot;operation&quot;/&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;type&quot;/&gt;\n         &lt;valueString value=&quot;add&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;path&quot;/&gt;\n         &lt;valueString value=&quot;Specimen&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;name&quot;/&gt;\n         &lt;valueString value=&quot;processing&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;value&quot; /&gt;\n         &lt;part&gt;\n             &lt;name value=&quot;description&quot; /&gt;\n             &lt;valueString value=&quot;test&quot; /&gt;\n         &lt;/part&gt;\n         &lt;part&gt;\n             &lt;name value=&quot;time&quot; /&gt;\n             &lt;valueDateTime value=&quot;2021-08-13T07:44:38.342+00:00&quot; /&gt;\n          &lt;/part&gt;\n          &lt;part&gt;\n             &lt;name value=&quot;extension&quot; /&gt;\n             &lt;part&gt;\n                 &lt;name value=&quot;url&quot; /&gt;\n                 &lt;valueUri value=&quot;ProcessingDevice&quot; /&gt;\n             &lt;/part&gt;\n             &lt;part&gt;\n                 &lt;name value=&quot;value&quot; /&gt;\n                 &lt;valueReference reference=&quot;Device/1&quot; /&gt;\n              &lt;/part&gt;\n         &lt;/part&gt;\n      &lt;/part&gt;\n   &lt;/parameter&gt;\n&lt;/Parameters&gt;\n</code></pre></div>",
        "id": 250086146,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1629444115
    },
    {
        "content": "<p>The URL for the extension is definitely wrong - the base URL for an extension must be a full URL (i.e. http:....).  Also \"description\" isn't a valid name for a FHIRPatch part name.  Also, you should probably list the extension before you list description or time.  </p>\n<p>To me, the spec is somewhat unclear about whether the name for time should be \"time\", \"time[x]\" or \"timeDateTime\".  You might try with any of those (and submit a change request for us to clarify).  If none of those fixes address the issue, then raise on <a class=\"stream\" data-stream-id=\"179167\" href=\"/#narrow/stream/179167-hapi\">#hapi</a></p>",
        "id": 250115428,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629465176
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Thanks for the feedback. The description is the name of Specimen-&gt;processing-&gt;description field. Are you sure it is not good?<br>\nRegarding the url - I know it should be full, maybe I should have made it full even in example.<br>\nAs for the time - I think it was already cleared here: <a href=\"#narrow/stream/179166-implementers/topic/FHIR.20PATCH.20interaction\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/FHIR.20PATCH.20interaction</a> .<br>\nI am more concern about the structure of the extension object that a content. Is that correct?</p>",
        "id": 250325420,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1629708608
    },
    {
        "content": "<p>I'm saying you can't have a URL of \"PorcessingDevice\".  Thanks for the link to the other post - but we still need a change request to make it clear in the spec.  The only piece of the extension structure I see that's incorrect is the value of the URL.</p>",
        "id": 250355578,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629727287
    },
    {
        "content": "<p>Not to steer away the current discussion on extensions, but I've submitted a change request to clarify how to use choice values and linked to it from: <a href=\"#narrow/stream/179166-implementers/topic/FHIR.20PATCH.20interaction\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/FHIR.20PATCH.20interaction</a></p>",
        "id": 250401364,
        "sender_full_name": "Kenneth Myhra",
        "timestamp": 1629747704
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Thanks once more.<br>\nSo considering everything being said this patch object looks good? I fixed url for example purposes only.</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;parameter&gt;\n      &lt;name value=&quot;operation&quot;/&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;type&quot;/&gt;\n         &lt;valueString value=&quot;add&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;path&quot;/&gt;\n         &lt;valueString value=&quot;Specimen&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;name&quot;/&gt;\n         &lt;valueString value=&quot;processing&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;value&quot; /&gt;\n         &lt;part&gt;\n             &lt;name value=&quot;description&quot; /&gt;\n             &lt;valueString value=&quot;test&quot; /&gt;\n         &lt;/part&gt;\n         &lt;part&gt;\n             &lt;name value=&quot;time&quot; /&gt;\n             &lt;valueDateTime value=&quot;2021-08-13T07:44:38.342+00:00&quot; /&gt;\n          &lt;/part&gt;\n          &lt;part&gt;\n             &lt;name value=&quot;extension&quot; /&gt;\n             &lt;part&gt;\n                 &lt;name value=&quot;url&quot; /&gt;\n                 &lt;valueUri value=&quot;http://example.org/fhir/DeviceExtension&quot; /&gt;\n             &lt;/part&gt;\n             &lt;part&gt;\n                 &lt;name value=&quot;value&quot; /&gt;\n                 &lt;valueReference reference=&quot;Device/1&quot; /&gt;\n              &lt;/part&gt;\n         &lt;/part&gt;\n      &lt;/part&gt;\n   &lt;/parameter&gt;\n&lt;/Parameters&gt;\n</code></pre></div>",
        "id": 250478792,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1629809101
    },
    {
        "content": "<p>You should probably move the extension part before description &amp; time.  If that doesn't fix the issue, raise it on <a class=\"stream\" data-stream-id=\"179167\" href=\"/#narrow/stream/179167-hapi\">#hapi</a></p>",
        "id": 250486097,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629812445
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> sorry to bother once more, but could the extension be used as a value or should we have it as a part objects?<br>\nSee example for value (example for parts is above):</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n   &lt;parameter&gt;\n      &lt;name value=&quot;operation&quot;/&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;type&quot;/&gt;\n         &lt;valueString value=&quot;add&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;path&quot;/&gt;\n         &lt;valueString value=&quot;Specimen&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;name&quot;/&gt;\n         &lt;valueString value=&quot;processing&quot;/&gt;\n      &lt;/part&gt;\n      &lt;part&gt;\n         &lt;name value=&quot;value&quot; /&gt;\n         &lt;part&gt;\n           &lt;name value=&quot;extension&quot; /&gt;\n           &lt;extension url=&quot;http://example.org/fhir/DeviceExtension&quot;&gt;\n             &lt;valueReference reference=&quot;Device/1&quot; /&gt;\n           &lt;/extension&gt;\n         &lt;/part&gt;\n         &lt;part&gt;\n             &lt;name value=&quot;description&quot; /&gt;\n             &lt;valueString value=&quot;test&quot; /&gt;\n         &lt;/part&gt;\n      &lt;/part&gt;\n   &lt;/parameter&gt;\n&lt;/Parameters&gt;\n</code></pre></div>",
        "id": 250592240,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1629880101
    },
    {
        "content": "<p>'extension' isn't defined for use with FHIRPath PATCH.  If it was going to be used, I think it would be to extend the patch mechanism, not to define an extension.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 250622751,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629899509
    },
    {
        "content": "<p>wooo I don't know</p>",
        "id": 250709509,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629943388
    },
    {
        "content": "<p>Well... You probably right, since the extension is not on the list of DataTypes that could be used as values. (<a href=\"https://hl7.org/fhir/datatypes.html#open\">https://hl7.org/fhir/datatypes.html#open</a>)</p>",
        "id": 250762410,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1629980308
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"433479\">@Alexandr Shevchenko</span> Can you submit a change request for us to clarify?</p>",
        "id": 250785460,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1629989732
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> yes, sure. I submited the request for user account, so it might take a few days. If I can submit the change request without an account - I would be glad to have some instructions.</p>",
        "id": 250906062,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1630056737
    },
    {
        "content": "<p>Looks like your request has been approved <span class=\"user-mention\" data-user-id=\"433479\">@Alexandr Shevchenko</span></p>",
        "id": 250933621,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1630071923
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Here it is: <a href=\"https://jira.hl7.org/browse/FHIR-33256\">https://jira.hl7.org/browse/FHIR-33256</a>. If you cloud check if any info is missing - I would very appreciate it.</p>",
        "id": 250936050,
        "sender_full_name": "Alexandr Shevchenko",
        "timestamp": 1630072925
    },
    {
        "content": "<p>Looks good to me</p>",
        "id": 250962549,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1630084073
    },
    {
        "content": "<p>Hi --<br>\nI don't want to cross post but, for the register, I just posted a question on #students about how to do a PATCH request, but it wasn't about extensions. There should be more documentation on this particular issue out there.</p>",
        "id": 251704687,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1630584704
    }
]