[
    {
        "content": "<p>Using FHIR validator tool version 4.0.31-SNAPSHOT, I get the following error when running validation on a FHIR example that worked on an earlier validator tool version back from mid-August.  The output is the following:  <br>\n<code>(base) mayt-PC Tue Nov 05 15:45:40 fhirValidator $ java -jar org.hl7.fhir.validator.jar Patient-example-usr4.json -ig hl7.fhir.us.core\nFHIR Validation tool Version 4.0.31-SNAPSHOT - Built 2019-11-05T15:35:39.648+11:00 - Git a0ece162e77c\nDetected Java version: 12.0.2 from /Library/Java/JavaVirtualMachines/adoptopenjdk-12.jdk/Contents/Home on x86_64 (64bit). 4096MB available\nArguments: Patient-example-usr4.json -ig hl7.fhir.us.core\nDirectories: Current = /Users/mayt/mltApps/fhirValidator, Package Cache = /Users/mayt/.fhir/packages\n  .. connect to tx server @ http://tx.fhir.org\n  .. definitions from hl7.fhir.core#current\nError loading ImplementationGuide-fhir.json: Duplicate Resource http://hl7.org/fhir/ImplementationGuide/fhir\nException in thread \"main\" org.hl7.fhir.exceptions.FHIRException: Error loading ImplementationGuide-fhir.json: Duplicate Resource http://hl7.org/fhir/ImplementationGuide/fhir\n    at org.hl7.fhir.r5.context.SimpleWorkerContext.fromDefinitions(SimpleWorkerContext.java:203)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadDefinitions(ValidationEngine.java:409)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadInitialDefinitions(ValidationEngine.java:356)\n    at org.hl7.fhir.r5.validation.ValidationEngine.&lt;init&gt;(ValidationEngine.java:388)\n    at org.hl7.fhir.r5.validation.Validator.main(Validator.java:489)\nCaused by: org.hl7.fhir.exceptions.DefinitionException: Duplicate Resource http://hl7.org/fhir/ImplementationGuide/fhir\n    at org.hl7.fhir.r5.context.BaseWorkerContext.cacheResource(BaseWorkerContext.java:188)\n    at org.hl7.fhir.r5.context.SimpleWorkerContext.loadFromFileJson(SimpleWorkerContext.java:271)\n    at org.hl7.fhir.r5.context.SimpleWorkerContext.loadDefinitionItem(SimpleWorkerContext.java:212)\n    at org.hl7.fhir.r5.context.SimpleWorkerContext.fromDefinitions(SimpleWorkerContext.java:200)\n    ... 4 more</code></p>\n<p>Any ideas on what to try?</p>",
        "id": 179976430,
        "sender_full_name": "May Terry",
        "timestamp": 1572987285
    },
    {
        "content": "<p>it's on my list to resolve</p>",
        "id": 179976933,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1572987580
    },
    {
        "content": "<p>but you need to specify the version - use the parameter <code>-version 4.0</code></p>",
        "id": 179977062,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1572987614
    },
    {
        "content": "<p>I was also having a similar issue trying to validate a resource with known issues.  I previously was able to get validation results back on it, but with the most recent snapshot I'm getting:</p>\n<p><code>Exception in thread \"main\" java.lang.Error: Not done yet - resolve http://hl7.org/fhir/StructureDefinition/us-core-race</code></p>\n<p>When trying: <code>java -jar org.hl7.fhir.validator.jar patient.json -ig hl7.fhir.us.core -version 4.0</code></p>\n<p>When I remove the <code>us-core-race</code> extension I get a similar <code>Not done yet</code> error on another extension.</p>\n<p>Apologies if you were already aware, but I figured I'd bring it up in case it's helpful.</p>",
        "id": 180133880,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1573134975
    },
    {
        "content": "<p>Are you using the most recent validator - as found here: <a href=\"https://fhir.github.io/latest-ig-publisher/org.hl7.fhir.validator.jar\" target=\"_blank\" title=\"https://fhir.github.io/latest-ig-publisher/org.hl7.fhir.validator.jar\">https://fhir.github.io/latest-ig-publisher/org.hl7.fhir.validator.jar</a>?</p>",
        "id": 180144135,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1573141262
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - I worked on this issue with <span class=\"user-mention\" data-user-id=\"197651\">@Reece Adamson</span> - upon further troubleshooting, it seems like there is some issue regarding error handling.  We worked with a FHIR instance that had some errors in it (e.g.: incorrect representation of a complex extension (e.g.: like the race example above), incorrect URLs to coding systems) and each time, the \"Not done yet...\" type of unhandled exception followed by stack trace appears.  As I fixed each error of that severity, it would kick off the same unhandled exception with the next error...all the way until only informational and warning-level errors remained.</p>",
        "id": 180160263,
        "sender_full_name": "May Terry",
        "timestamp": 1573151489
    },
    {
        "content": "<p>The version of the FHIR validator used: <code>FHIR Validation tool Version 4.0.31-SNAPSHOT - Built 2019-11-05T15:35:39.648+11:00 - Git a0ece162e77c</code></p>",
        "id": 180160893,
        "sender_full_name": "May Terry",
        "timestamp": 1573151891
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 180177820,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1573162086
    },
    {
        "content": "<p>it's on my list</p>",
        "id": 180177840,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1573162102
    },
    {
        "content": "<p>I can't reproduce this?</p>",
        "id": 180199285,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1573183234
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/St4orbeFOgs3ADuQnEFFn8oq/patient.json\" target=\"_blank\" title=\"patient.json\">patient.json</a> here is the example I used.</p>\n<p>Just redownloaded and tried again with the same result.</p>\n<p>Validator version: <code>FHIR Validation tool Version 4.0.31-SNAPSHOT - Built 2019-11-05T15:35:39.648+11:00 - Git a0ece162e77c</code></p>",
        "id": 180251282,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1573233491
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/9ljx8PUcAY9q2tVchPANFWzc/resource.json\" target=\"_blank\" title=\"resource.json\">resource.json</a> <span class=\"user-mention\" data-user-id=\"191647\">@Michael O'Keefe</span> and I made another very simple example here that shows the issue.  This resource should be valid as far as I can see though.</p>\n<p><code>\"system\": \"http://hl7.org/fhir/v2/0203\"</code> seems to be the culprit in this example as without it the validation proceeded.</p>",
        "id": 180252852,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1573234504
    },
    {
        "content": "<p>fixed next release. btw, the source of a lot of this is that you are validating on the wrong version - the instance is not an r4 instance (r2?) (no excuse for the validator failing, of course)</p>",
        "id": 180333713,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1573336597
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>, I'll give it a go with the new release!</p>",
        "id": 180522202,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1573569446
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> !  Looks like this latest validator release <code>4.0.36-SNAPSHOT</code> fixed my immediate issue.</p>",
        "id": 180624073,
        "sender_full_name": "May Terry",
        "timestamp": 1573651027
    }
]