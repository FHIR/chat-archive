[
    {
        "content": "<p>How to achieve GROUP BY functionality in FHIR search? for example, I have a use case \"Get only the latest issued DiagnosticReport resources for all the Patient resources\" how can we search with FHIR in such way?</p>",
        "id": 199257567,
        "sender_full_name": "Muhammad Abubakar Ikram",
        "timestamp": 1590846248
    },
    {
        "content": "<p>In general you cannot do that. There is the <a href=\"http://hl7.org/fhir/observation-operation-lastn.html\">$lastn </a> operation for Observation that does something like that, but it is not widely implemented</p>",
        "id": 199257876,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1590846792
    },
    {
        "content": "<p>Yes I know about $lastn. <br>\nIs there any workaround how could I achieve that?</p>",
        "id": 199310313,
        "sender_full_name": "Muhammad Abubakar Ikram",
        "timestamp": 1590939504
    },
    {
        "content": "<p>I am thinking to implement this feature this way in my server</p>\n<p>/fhir/DiagnosticReport/_search?group-by=subject&amp;select=max:issued</p>\n<p>anyone got a better idea?</p>",
        "id": 199596925,
        "sender_full_name": "Muhammad Abubakar Ikram",
        "timestamp": 1591176193
    },
    {
        "content": "<p>This goes a bit beyond what we've tried to do with the FHIR REST API (and _filter too, for that matter). It's a pretty natural thing to <em>want</em> to express though. I wonder if there's interest in standardizing something like this. (I suspect no.)</p>",
        "id": 199642784,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1591201846
    },
    {
        "content": "<p>I have seen an answer on StackOverflow related to my case<br>\n<a href=\"https://stackoverflow.com/questions/50914101/group-by-like-function-in-fhir-search\">https://stackoverflow.com/questions/50914101/group-by-like-function-in-fhir-search</a></p>\n<p>there is a search query uri in the answer<br>\n{{baseurl}}/Observation?device:Device=123&amp;_sort=-_lastUpdated&amp;_count=1</p>\n<ol>\n<li>\n<p>is this -&gt; \"_sort=-_lastUpdated\" part of the search is standard? I have not found in docs though</p>\n</li>\n<li>\n<p>is _lastUpdated find only the most recently changed resources or also the most recently created resources?</p>\n</li>\n<li>\n<p>if  \"_sort=-_lastUpdated\" is a standard and _lastUpdated also gets the most recently created resource, <br>\nthen {{baseurl}}/DiagnosticReport/_search?code=12345&amp;_sort=-_lastUpdated, will find the most recently changed and created resources of code type 12345?</p>\n</li>\n</ol>",
        "id": 199709937,
        "sender_full_name": "Muhammad Abubakar Ikram",
        "timestamp": 1591252523
    },
    {
        "content": "<p>_lastUpdated is one of the search parameters that apply to all resources, assuming a server you are using supports this. Have a look at <a href=\"https://www.hl7.org/fhir/search.html\">https://www.hl7.org/fhir/search.html</a>. If a server supports _lastUpdated, it will have a creation date for a new resource.</p>",
        "id": 199711712,
        "sender_full_name": "Igor Sirkovich",
        "timestamp": 1591254516
    },
    {
        "content": "<p>I see, okay so _lastUpdated only works on Resource.meta.lastUpdated.</p>",
        "id": 199712124,
        "sender_full_name": "Muhammad Abubakar Ikram",
        "timestamp": 1591254858
    },
    {
        "content": "<p>Is your question about GROUP BY or finding the latest resource? It is not obvious to me that the two are the same.</p>",
        "id": 199732928,
        "sender_full_name": "Amrit",
        "timestamp": 1591269860
    },
    {
        "content": "<p>(not related to the main question, but the <code>/_search</code> segment should not be there - that's for POST searches, not GET ones with the parameters in the URL)</p>",
        "id": 199742178,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1591275504
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span>  yes you are right that's a typo. params could be in the body or in the URL. in POST or in GET request respectively.</p>\n<p><span class=\"user-mention\" data-user-id=\"301512\">@Amrit</span> (In the context of SQL) The concept of GROUP BY is when you group the records you have to call a function on a field. That function will decide which record will be picked up in the result set. for example, we can SUM(amount) or COUNT(quantity) or MAX(date), MIN(date). So, what I want to achieve is GROUP BY Patient with MAX(issued).</p>",
        "id": 199743640,
        "sender_full_name": "Muhammad Abubakar Ikram",
        "timestamp": 1591276179
    },
    {
        "content": "<p>Ah.. Since there is apparently no grouping in FHIR, you would have to provide a search value for your variable and loop through all possible values. Assuming all relevant search parameters are supported by your server, for your specific use case, the following should work, so long you iterate over all possible logical ids of patients. <br>\nGET [base]/DiagnosticReport?_patient=[logical id]&amp;_sort=-issued&amp;_count=1<br>\nThe above uses the issued date which is more akin to a business version date. You could also use the record version date. So if that's what you need:<br>\nGET [base]/DiagnosticReport?_patient=[logical id]&amp;_sort=-_lastUpdated&amp;_count=1</p>",
        "id": 199826938,
        "sender_full_name": "Amrit",
        "timestamp": 1591318904
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"301512\">@Amrit</span> I need to get DiagnosticReport for all the Patients available, not for just one patient</p>",
        "id": 199839230,
        "sender_full_name": "Muhammad Abubakar Ikram",
        "timestamp": 1591337731
    }
]