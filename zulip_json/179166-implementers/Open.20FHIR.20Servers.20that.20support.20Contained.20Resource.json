[
    {
        "content": "<p>I have played with a few sandboxes (Logicahealth, smart sandbox) that â€“ although accept FHIR resources that have contained-resources but ignored the reference and return the resource __without__ the contained resource.</p>\n<p>Any open sandbox that supports contained resource?</p>",
        "id": 255306465,
        "sender_full_name": "Raheel Sayeed",
        "timestamp": 1632866148
    },
    {
        "content": "<p>Wait, are you saying that these sandboxes <em>strip</em> contained resources from a resource when invoking the <code>create</code> operation?</p>",
        "id": 255306633,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1632866221
    },
    {
        "content": "<p>That's generally not desired behavior...</p>",
        "id": 255332010,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1632882692
    },
    {
        "content": "<p><a href=\"http://test.fhir.org\">test.fhir.org</a> does, but it doesn't have a sandbox arrangement</p>",
        "id": 255347327,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1632895856
    },
    {
        "content": "<p>Okay, I tested some resources with contained.. it works on logica and smart sandboxes</p>\n<p>However,<br>\nCreating a <code>QuestionnaireResponse</code> that contains its <code>Questionnaire</code> is createed but fails to retain the contained <code>Questionnaire</code>. The same resource works just fine on <a href=\"http://test.fhir.org\">test.fhir.org</a>. (returns the Contained Resource).  Both logica and smart sandboxes are backed by HAPI.</p>\n<p>update: also working on <a href=\"http://hapi.fhir.org/baseR4/\">http://hapi.fhir.org/baseR4/</a></p>\n<div class=\"codehilite\"><pre><span></span><code>{\n   &quot;questionnaire&quot;:&quot;#51EF8C9A-2C9D-4F9A-A70A-D7431341A067&quot;,\n   &quot;subject&quot;:{\n      &quot;reference&quot;:&quot;Patient\\/8d1f86a8-3284-43bd-b45e-5931948c97e4&quot;\n   },\n   &quot;identifier&quot;:{\n      &quot;system&quot;:&quot;http:\\/\\/loinc.org&quot;,\n      &quot;value&quot;:&quot;64206-6&quot;\n   },\n   &quot;contained&quot;:[\n      {\n         &quot;status&quot;:&quot;draft&quot;,\n         &quot;subjectType&quot;:[\n            &quot;Patient&quot;,\n            &quot;Person&quot;\n         ],\n         &quot;code&quot;:[\n            {\n               &quot;system&quot;:&quot;http:\\/\\/loinc.org&quot;,\n               &quot;code&quot;:&quot;64206-6&quot;,\n               &quot;display&quot;:&quot;Have you had any treatment for high blood pressure (hypertension) in the past 10 years?&quot;\n            }\n         ],\n         &quot;identifier&quot;:[\n            {\n               &quot;system&quot;:&quot;http:\\/\\/loinc.org&quot;,\n               &quot;value&quot;:&quot;64206-6&quot;\n            }\n         ],\n         &quot;title&quot;:&quot;On Hypertensive Medication&quot;,\n         &quot;id&quot;:&quot;51EF8C9A-2C9D-4F9A-A70A-D7431341A067&quot;,\n         &quot;version&quot;:&quot;1.0&quot;,\n         &quot;date&quot;:&quot;2020-11&quot;,\n         &quot;resourceType&quot;:&quot;Questionnaire&quot;,\n         &quot;name&quot;:&quot;On Hypertensive Medication&quot;,\n         &quot;item&quot;:[\n            {\n               &quot;type&quot;:&quot;boolean&quot;,\n               &quot;text&quot;:&quot;Are you currently taking any medications for hypertension?&quot;,\n               &quot;required&quot;:true,\n               &quot;linkId&quot;:&quot;1&quot;,\n               &quot;code&quot;:[\n                  {\n                     &quot;display&quot;:&quot;Have you had any treatment for high blood pressure (hypertension) in the past 10 years?&quot;,\n                     &quot;system&quot;:&quot;http:\\/\\/loinc.org&quot;,\n                     &quot;code&quot;:&quot;64206-6&quot;\n                  }\n               ]\n            }\n         ]\n      }\n   ],\n   &quot;authored&quot;:&quot;2021-09-29T06:29:33.8823Z&quot;,\n   &quot;status&quot;:&quot;completed&quot;,\n   &quot;resourceType&quot;:&quot;QuestionnaireResponse&quot;,\n   &quot;item&quot;:[\n      {\n         &quot;text&quot;:&quot;Are you currently taking any medications for hypertension?&quot;,\n         &quot;answer&quot;:[\n            {\n               &quot;valueBoolean&quot;:true\n            }\n         ],\n         &quot;linkId&quot;:&quot;1&quot;\n      }\n   ]\n}\n</code></pre></div>",
        "id": 255350121,
        "sender_full_name": "Raheel Sayeed",
        "timestamp": 1632897961
    },
    {
        "content": "<p>To clarify, are you saying this behavior is specific to contained Questionnaires? (You mentioned \"I tested some resources with contained.. it works on logica and smart sandboxes\" above.)</p>",
        "id": 255396789,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1632921505
    },
    {
        "content": "<p><a href=\"https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-storage/ca/uhn/fhir/jpa/api/config/DaoConfig.html\">https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-storage/ca/uhn/fhir/jpa/api/config/DaoConfig.html</a> doesn't appear to mention settings specific to contained behavior, but I may be missing something. (<span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>, is there a setting that would tell HAPI to strip contained Questionnaires from submitted QuestionnaireResponses?)</p>",
        "id": 255397565,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1632921809
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179166-implementers/topic/Open.20FHIR.20Servers.20that.20support.20Contained.20Resource/near/255396789\">said</a>:</p>\n<blockquote>\n<p>To clarify, are you saying this behavior is specific to contained Questionnaires? (You mentioned \"I tested some resources with contained.. it works on logica and smart sandboxes\" above.)</p>\n</blockquote>\n<p>Yes, appears to only be specific to contained Questionnaires within QuestionnaireResponse.  <br>\nWhen QR contains and references a Patient resource--&gt; works as expected, returns QR contained with patient. But not questionnaire. </p>\n<p>Here's the response:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;QuestionnaireResponse&quot;,\n  &quot;id&quot;: &quot;1084&quot;,\n  &quot;meta&quot;: {\n    &quot;versionId&quot;: &quot;1&quot;,\n    &quot;lastUpdated&quot;: &quot;2021-09-29T15:45:58.265+00:00&quot;\n  },\n  &quot;contained&quot;: [ {\n    &quot;resourceType&quot;: &quot;Patient&quot;,\n    &quot;id&quot;: &quot;patsub&quot;,\n    &quot;identifier&quot;: [ {\n      &quot;system&quot;: &quot;http://cancer.questionnaire.org/systems/id/patientnr&quot;,\n      &quot;value&quot;: &quot;A34442332&quot;\n    }, {\n      &quot;type&quot;: {\n        &quot;text&quot;: &quot;Dutch BSN&quot;\n      },\n      &quot;system&quot;: &quot;urn:oid:2.16.840.1.113883.2.4.6.3&quot;,\n      &quot;value&quot;: &quot;188912345&quot;\n    } ],\n    &quot;gender&quot;: &quot;male&quot;,\n    &quot;birthDate&quot;: &quot;1972-11-30&quot;\n  } ],\n  &quot;questionnaire&quot;: &quot;http://fhir.acme.org/Questionnaire/123|#51EF8C9A-2C9D-4F9A-A70A-D7431341A067&quot;,\n  &quot;status&quot;: &quot;completed&quot;,\n  &quot;subject&quot;: {\n    &quot;reference&quot;: &quot;#patsub&quot;\n  },\n  &quot;authored&quot;: &quot;2021-09-29T06:29:33.8823Z&quot;,\n  &quot;item&quot;: [ {\n    &quot;linkId&quot;: &quot;1&quot;,\n    &quot;text&quot;: &quot;Are you currently taking any medications for hypertension?&quot;,\n    &quot;answer&quot;: [ {\n      &quot;valueBoolean&quot;: true\n    } ]\n  } ]\n}\n</code></pre></div>",
        "id": 255422524,
        "sender_full_name": "Raheel Sayeed",
        "timestamp": 1632930444
    },
    {
        "content": "<p>Tried also experimenting with the canonical reference!</p>",
        "id": 255423404,
        "sender_full_name": "Raheel Sayeed",
        "timestamp": 1632930757
    },
    {
        "content": "<p>When I PUT or POST a QR with a contained Q to the UHN HAPI R4 Server,  the contained Q is still there when I fetch it?</p>",
        "id": 255434488,
        "sender_full_name": "Eric Haas",
        "timestamp": 1632934690
    },
    {
        "content": "<p>Yep! just checked, <a href=\"http://hapi.fhir.org/baseR4\">hapi.fhir.org/baseR4</a> definitely works. I guess it was just <a href=\"http://r4.smarthealthit.org\">r4.smarthealthit.org</a> and sandbox.logicahealth.</p>",
        "id": 255447336,
        "sender_full_name": "Raheel Sayeed",
        "timestamp": 1632939313
    }
]