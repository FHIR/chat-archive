[
    {
        "content": "<p>I know subject queries allow for the \"type\" of subject to be specified since it can vary. What should servers accept for the \"patient\" parameter? So far, our server expects just the id, since it's clear what type of resource patient references. Should servers also accept/parse for patient:Patient=123 and patient=Patient/123?</p>\n<p>If so, this goes back to some earlier questions around why we have 3 different ways for doing this simple query...</p>",
        "id": 153826356,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462896146
    },
    {
        "content": "<p>Hey Jenni, I can't for sure speak to what we should do, but we support the modifier and the Relative URL (we support receiving a full URL too). We do this for compatibility with clients, since we often receive the modifier even though it is not needed.</p>",
        "id": 153826358,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462896433
    },
    {
        "content": "<p>I think we're too far gone with client support of modifiers and URLs to constrain this at this point, but I would love to constrain it further if possible.</p>",
        "id": 153826359,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462896467
    },
    {
        "content": "<p>And not make it worse in the future.</p>",
        "id": 153826360,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1462896555
    },
    {
        "content": "<p>The problem with \"options\" is that they're not really optional for servers.  </p>",
        "id": 153826361,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1462896589
    },
    {
        "content": "<p>Correct. And for urls, you start getting into validating that it's \"equivalent\" to your server... It feels like a server should be able to generally say \"I allow references to external FHIR servers\" or not.</p>",
        "id": 153826364,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462896881
    },
    {
        "content": "<p>we knew these were not optional or serversr</p>",
        "id": 153826366,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462896955
    },
    {
        "content": "<p>I'm pretty sure we dsicussed these variations on the argonaut mailing list and come to agreement</p>",
        "id": 153826368,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462896972
    },
    {
        "content": "<p><strong>Jenni Syed</strong> I agree with you. External linking to FHIR servers is somethign we likely won't support. Do we need a way to formalize that in the conformance statement (or profile)?</p>",
        "id": 153826371,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462897025
    },
    {
        "content": "<p>we haven't considered that before</p>",
        "id": 153826376,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462897101
    },
    {
        "content": "<p>I don't see that as a requirement necessarily, provided we're okay with the behavior of servers to reject such a thing. Is cross server FHIR references something others are trying to do?</p>",
        "id": 153826378,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462897154
    },
    {
        "content": "<p>it's allowed and I've seen a little of it in prototypes in distributed systems. I wouldn't think it would apply in the argonaut context or similar</p>",
        "id": 153826381,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462897282
    },
    {
        "content": "<p>Grahame - I assume for the \"settled\" aspect, you're referring to this: <a href=\"https://groups.google.com/d/topic/argonaut-project/srjnfhNBQbk/discussion\" target=\"_blank\" title=\"https://groups.google.com/d/topic/argonaut-project/srjnfhNBQbk/discussion\">https://groups.google.com/d/topic/argonaut-project/srjnfhNBQbk/discussion</a>. There was a mention of banning the Paitient/ side. But I'm not sure if we discussed beyond that</p>",
        "id": 153826385,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462897508
    },
    {
        "content": "<p>I expect that there will be lots of servers that don't allow cross-server references, and lots that do. Both are valid ways of using FHIR.</p>",
        "id": 153826387,
        "sender_full_name": "James Agnew",
        "timestamp": 1462897562
    },
    {
        "content": "<p>Which, if we did that, would remove the patient=Patient/123</p>",
        "id": 153826388,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462897568
    },
    {
        "content": "<p>(If i understood your intent correctly)</p>",
        "id": 153826389,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462897595
    },
    {
        "content": "<p>For some reason, I thought there was a longer thread on this as well, but can't find it.</p>",
        "id": 153826390,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462897608
    },
    {
        "content": "<p>As to external server references, I assume many of the ref impls and some FHIR servers that keep track of HIE-type info may do this. But as <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  mentions, I think there will be large contingents that don't allow that as well</p>",
        "id": 153826392,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462897902
    },
    {
        "content": "<p>That's the one I had in mind, but I thought we closed that out. </p>",
        "id": 153826393,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462898135
    },
    {
        "content": "<p>we should ;-)</p>",
        "id": 153826394,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462898135
    },
    {
        "content": "<p>I will respond to that chain with two proposals:</p>",
        "id": 153826425,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462905351
    },
    {
        "content": "<p>1. that we should remove the compartment syntax from Argonaut server support (/Patient/[id]/resource)</p>",
        "id": 153826426,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462905371
    },
    {
        "content": "<p>2. That argonaut servers will not provide support for resolving external resource references outside of their server.</p>",
        "id": 153826428,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462905391
    },
    {
        "content": "<p>Any concerns?</p>",
        "id": 153826429,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462905395
    },
    {
        "content": "<p>I think the IG should also include bestpractices for how to construct a query as a client - i.e. support patient=foo above patient:patient=Patient/foo</p>",
        "id": 153826431,
        "sender_full_name": "Sean Moore",
        "timestamp": 1462905425
    },
    {
        "content": "<p>agree. I think we did agree that compartment searches weren't required</p>",
        "id": 153826434,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462905577
    },
    {
        "content": "<p>but it would be good to have a wrap up/conclusion</p>",
        "id": 153826435,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462905587
    },
    {
        "content": "<p>Agreed we need to wrap this discussion up in a neat package!</p>\n<p>I'm fine saying in Argonaut that we remove compartment syntax. I do think we need server support for all of the legal FHIR ways to filter on \"patient=123\" (I agree it's a bit of optionality but my assessment is that it's not <em>hard</em> for servers to get this right, and like it or not, client libraries have diverse behavior here.) <span class=\"user-mention\" data-user-id=\"191945\">@Sean Moore</span> That leaves me with your point #2, which I don't understand: given that the current Argonaut focus is on read APIs, when would an Argonaut server need to \"resolve external resource references\"? </p>",
        "id": 153826641,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1462925381
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> You're correct that implementing read-only helps alleviate that concern (though I think some of our servers either already enable write or are considering that). However, the patient param can be set to a full URL as well. <a href=\"http://hl7.org/fhir/dstu2/search.html#reference\" target=\"_blank\" title=\"http://hl7.org/fhir/dstu2/search.html#reference\">http://hl7.org/fhir/dstu2/search.html#reference</a></p>",
        "id": 153826867,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462977138
    },
    {
        "content": "<p>So, they can technically search for a resource on your server that references a patient on another. Our server wouldn't allow it - either on the read/query nor write</p>",
        "id": 153826868,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1462977180
    },
    {
        "content": "<p>That seems fine... Or,  I mean, you could \"allow it\" but it would return no results.</p>",
        "id": 153826869,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1462977291
    },
    {
        "content": "<p>ah yes. well, I agree that argonaut should not allow full url in search. sorry for missing that point</p>",
        "id": 153826903,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462981731
    },
    {
        "content": "<p>I will go ahead and document as a resolved issue in Argo and add to the General Argo Guidance and in Patient IG.</p>",
        "id": 153827026,
        "sender_full_name": "Eric Haas",
        "timestamp": 1462995629
    },
    {
        "content": "<p>thx Eric</p>",
        "id": 153827033,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1462995755
    },
    {
        "content": "<p>I think you will still want to be able to support subject=Patient/123, as in some cases search parameters can be more than 1 type of reference.</p>",
        "id": 153831790,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1465206265
    },
    {
        "content": "<p>e.g. SearchParam: <code>appointment.actor</code></p>",
        "id": 153831791,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1465206311
    },
    {
        "content": "<p>/Appointment?actor=Patient/43<br>\n/Appointment?actor=Practitioner/43<br>\n/Appointment?actor=43 (what would you do with this? search both patients and practitioners - and the other valid types - for the id 43</p>",
        "id": 153831792,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1465206387
    }
]