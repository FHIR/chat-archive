[
    {
        "content": "<p>I'm looking to map resources from DSTU2 to STU3.<br>\nHas anyone found a mapping engine that can take a FHIR map and execute this task?</p>",
        "id": 159740114,
        "sender_full_name": "VP Herisse",
        "timestamp": 1551467361
    },
    {
        "content": "<p><a href=\"http://hl7.org/fhir/STU3/r2maps.html\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/r2maps.html\">http://hl7.org/fhir/STU3/r2maps.html</a></p>",
        "id": 159740744,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1551467842
    },
    {
        "content": "<p>The FHIR Java validator (<a href=\"http://hl7.org/fhir/validator\" target=\"_blank\" title=\"http://hl7.org/fhir/validator\">http://hl7.org/fhir/validator</a>) includes a mapping engine.  If you run the validator with no parameters, it'll provide instructions.  (<span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> are there instructions online anywhere?)</p>",
        "id": 159743754,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1551470193
    },
    {
        "content": "<p>Okay I will investigate that engine, thank you!</p>",
        "id": 159743969,
        "sender_full_name": "VP Herisse",
        "timestamp": 1551470364
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ,</p>\n<p>I tried running this:</p>\n<p>java -jar org.hl7.fhir.validator.jar allergyintolerance-example.json -transform <a href=\"http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3\">http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3</a> -ig hl7.fhir.transforms.v2v3 -output R3resource.json</p>\n<p>and received this error:</p>\n<p>FHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-09T15:30:00.249-05:00 - Git 53fa82582dda<br>\nArguments: allergyintolerance-example.json -transform <a href=\"http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3\">http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3</a> -ig hl7.fhir.transforms.v2v3 -output R3resource.json<br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n  .. definitions from hl7.fhir.core#4.0.0<br>\nException in thread \"main\" java.lang.OutOfMemoryError: Java heap space<br>\n        at java.util.HashMap.newNode(Unknown Source)<br>\n        at java.util.HashMap.putVal(Unknown Source)<br>\n        at java.util.HashMap.put(Unknown Source)<br>\n        at java.util.HashSet.add(Unknown Source)<br>\n        at org.hl7.fhir.utilities.xhtml.XhtmlParser.&lt;init&gt;(XhtmlParser.java:243)<br>\n        at org.hl7.fhir.r4.formats.JsonParserBase.parseXhtml(JsonParserBase.java:210)<br>\n        at org.hl7.fhir.r4.formats.JsonParser.parseNarrativeProperties(JsonParser.java:236)<br>\n        at org.hl7.fhir.r4.formats.JsonParser.parseNarrative(JsonParser.java:225)<br>\n        at org.hl7.fhir.r4.formats.JsonParser.parseDomainResourceProperties(JsonParser.java:1920)<br>\n        at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinitionProperties(JsonParser.java:23484)<br>\n        at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinition(JsonParser.java:23479)<br>\n        at org.hl7.fhir.r4.formats.JsonParser.parseResource(JsonParser.java:27656)<br>\n        at org.hl7.fhir.r4.formats.JsonParserBase.parse(JsonParserBase.java:113)<br>\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.loadFromFileJson(SimpleWorkerContext.java:262)<br>\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.loadDefinitionItem(SimpleWorkerContext.java:211)<br>\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.fromDefinitions(SimpleWorkerContext.java:199)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadDefinitions(ValidationEngine.java:321)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.loadInitialDefinitions(ValidationEngine.java:283)<br>\n        at org.hl7.fhir.r4.validation.ValidationEngine.&lt;init&gt;(ValidationEngine.java:308)<br>\n        at org.hl7.fhir.r4.validation.Validator.main(Validator.java:367)</p>\n<p>Any ideas? Maybe my syntax is off?</p>",
        "id": 159751138,
        "sender_full_name": "VP Herisse",
        "timestamp": 1551476059
    },
    {
        "content": "<p>Nope, that sounds like a memory issue.  First, make sure you're running the jar with a 64 bit version of Java.  (To do the transformations, the validator first loads all of the FHIR structures and quite a bit of the terminologies, so you typically need a good chunk of memory).  If that doesn't address the problem, you may need to increase the memory available to Java using one of the -Xm parameters</p>",
        "id": 159751314,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1551476186
    },
    {
        "content": "<p>Ah Excellent! thank you Lloyd!</p>",
        "id": 159751519,
        "sender_full_name": "VP Herisse",
        "timestamp": 1551476374
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ,</p>\n<p>I think I'm really close to having this work.</p>\n<p><strong>I've got this for a command:</strong></p>\n<p>java -jar org.hl7.fhir.validator.jar c:\\temp\\r3\\patient.xml -version 3.0 -ig <a href=\"http://hl7.org/fhir/us/core\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core\">http://hl7.org/fhir/us/core</a> -output c:\\temp\\outputPatient.xml -transform <a href=\"http://hl7.org/fhir/StructureMap/Patient3to4\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/Patient3to4\">http://hl7.org/fhir/StructureMap/Patient3to4</a></p>\n<p><strong>Results:</strong></p>\n<p>FHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-11T12:49:16.829-05:00 - Git 7a8671008476<br>\nArguments: c:\\temp\\r3\\patient.xml -version 3.0 -ig <a href=\"http://hl7.org/fhir/us/core\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core\">http://hl7.org/fhir/us/core</a> -output c:\\temp\\outputPatient.xml -transform <a href=\"http://hl7.org/fhir/StructureMap/Patient3to4\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureMap/Patient3to4\">http://hl7.org/fhir/StructureMap/Patient3to4</a><br>\n  .. connect to tx server @ <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">http://tx.fhir.org</a><br>\n  .. definitions from hl7.fhir.core#3.0.1<br>\n    (v3.0.1)<br>\n+  .. load IG from <a href=\"http://hl7.org/fhir/us/core\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core\">http://hl7.org/fhir/us/core</a><br>\n   ... Using version 1.1.0<br>\n ...Failure: null</p>\n<p>Could it be failing because of this structure map url is returning a 404 not found?<br>\n<strong>http://hl7.org/fhir/StructureMap/Patient3to4</strong></p>",
        "id": 160042822,
        "sender_full_name": "VP Herisse",
        "timestamp": 1551822113
    },
    {
        "content": "<p>That seems like a reasonable cause.  Feel free to submit a change request to have the engine return a better message, but you'll definitely need to pass in a path to a transform that actually resolves :)</p>",
        "id": 160044517,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1551823279
    },
    {
        "content": "<p>it's not because of that....</p>",
        "id": 160058467,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551836310
    },
    {
        "content": "<p>Hello! Do you have the implementation of engine of  FHIR mapping language?</p>",
        "id": 164165443,
        "sender_full_name": "Alexey Chistiakov",
        "timestamp": 1556195304
    },
    {
        "content": "<p>The FHIR Validator includes an implementation</p>",
        "id": 164173525,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1556201563
    },
    {
        "content": "<p>Thank you so much!</p>",
        "id": 164173984,
        "sender_full_name": "Alexey Chistiakov",
        "timestamp": 1556201802
    },
    {
        "content": "<p>Hello!<br>\nWe are planning R3/R4 Conversion and have some questions regarding ClaimResponse fields transformation described here: <a href=\"https://www.hl7.org/fhir/claimresponse-version-maps.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/claimresponse-version-maps.html\">https://www.hl7.org/fhir/claimresponse-version-maps.html</a></p>\n<p>1. ClaimResponse.outcome<br>\nTransition is described as follows:<br>\n src.outcome as vs then {<br>\n    vs.coding as c then {<br>\n      c.code where value in ('queued' | 'complete' | 'error' | 'partial') -&gt; tgt.outcome;<br>\n    };</p>\n<p>Outcome field was a codeableConcept in R3 and became a code in R4. CodeableConcept is a list of Codings, so what will we get  if we copy such list to a one variable? What if there are several codes which match the target codes (‘queued' | 'complete' | 'error' | 'partial') - which one will be chosen as tgt.outcome? What if there are no match at all ?</p>\n<p>Currently, we are using claimStatus code set for .outcome (‘processed as primary’ | ‘secondary’ | ‘denied’ | ‘reversal’| ‘forwarded’) - could you suggest how can we convert to R4 in such case without loosing the  initial .outcome value which is more reach than any target code?</p>\n<p>2. In the old version of the resource .outcome field was optional but  it became mandatory in R4. How can we do the switch to a new version of a resource if such a field does not exist in the old one?</p>",
        "id": 164532893,
        "sender_full_name": "Alexey Chistiakov",
        "timestamp": 1556626006
    },
    {
        "content": "<blockquote>\n<p>What if there are no match at all ?</p>\n</blockquote>\n<p>You can try to map the codes you have - eg ‘processed as primary’ -&gt; 'complete'</p>\n<blockquote>\n<p>Currently, we are using claimStatus code set for .outcome (‘processed as primary’ | ‘secondary’ | ‘denied’ | ‘reversal’| ‘forwarded’) - could you suggest how can we convert to R4 in such case without loosing the initial .outcome value which is more reach than any target code?</p>\n</blockquote>\n<p>You can put it into an extension - but it will be something custom to your system</p>\n<blockquote>\n<p>How can we do the switch to a new version of a resource if such a field does not exist in the old one?</p>\n</blockquote>\n<p>You have to decide on a default value to use</p>",
        "id": 164536424,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1556629229
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span><br>\n<span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span><br>\n Thanks a lot for useful information! By the way, I do not understand how I can convert the codeableConcept into code?</p>",
        "id": 164608860,
        "sender_full_name": "Alexey Chistiakov",
        "timestamp": 1556699519
    },
    {
        "content": "<p>Look through the Codings in the CodeableConcept and find the one that corresponds to the valueset for the target 'code'.  If you find one, that's your code.  If you don't find any, omit the element.  Any extra Codings and CodeableConcept.text will need to be sent as extensions.</p>",
        "id": 164621396,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1556715703
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Thanks!</p>",
        "id": 164627626,
        "sender_full_name": "Alexey Chistiakov",
        "timestamp": 1556721220
    },
    {
        "content": "<p>I'm looking for FHIR Mapping engine, I know about Vonk/Firely. Is there any other stable engine available?<br>\nThanks!</p>",
        "id": 201677591,
        "sender_full_name": "Anshu Nigam",
        "timestamp": 1592872612
    },
    {
        "content": "<p>There's one in the FHIR validator as well (<a href=\"https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content\">https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content</a>)</p>",
        "id": 201684505,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1592882644
    },
    {
        "content": "<p>Thanks Lloyd, Is there any other Mapping Engine, which is commercially supported ,  support as API etc.?</p>",
        "id": 201749283,
        "sender_full_name": "Anshu Nigam",
        "timestamp": 1592929775
    },
    {
        "content": "<p>Out of curiosity, what are the criteria that you are looking for?</p>",
        "id": 201757168,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1592933626
    },
    {
        "content": "<p>Looking for FHIR mapping engine which can be called from FHIR server to translate custom objects to FHIR resource</p>",
        "id": 201757706,
        "sender_full_name": "Anshu Nigam",
        "timestamp": 1592933937
    }
]