[
    {
        "content": "<p>I want to update a structureDefinition on VONK using postman. I'm using a PUT command  <a href=\"http://localhost:4080/administration/StructureDefinition\">http://localhost:4080/administration/StructureDefinition</a><br>\nIn the body content I placedthe updated structuredefinition. This is not accepted by VONK. The argument StructureDefinition seems not to be supported. What is not correct in the applied syntax?</p>",
        "id": 216272284,
        "sender_full_name": "Werner De Mulder",
        "timestamp": 1605041389
    },
    {
        "content": "<p>What error are you getting?</p>",
        "id": 216273083,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1605041762
    },
    {
        "content": "<p>{<br>\n    \"resourceType\": \"OperationOutcome\",<br>\n    \"id\": \"3d7e126b-6322-44e6-bbe4-ce9857704b44\",<br>\n    \"meta\": {<br>\n        \"versionId\": \"5f98a3a7-b3f5-43f3-a7d8-39f723f510bf\",<br>\n        \"lastUpdated\": \"2020-11-10T20:42:31.096+00:00\"<br>\n    },<br>\n    \"issue\": [<br>\n        {<br>\n            \"severity\": \"warning\",<br>\n            \"code\": \"not-supported\",<br>\n            \"details\": {<br>\n                \"coding\": [<br>\n                    {<br>\n                        \"system\": \"<a href=\"http://hl7.org/fhir/dotnet-api-operation-outcome\">http://hl7.org/fhir/dotnet-api-operation-outcome</a>\",<br>\n                        \"code\": \"5003\"<br>\n                    }<br>\n                ],<br>\n                \"text\": \"Argument is not supported\"<br>\n            },<br>\n            \"diagnostics\": \"/StructureDefinition\"<br>\n        }<br>\n    ]<br>\n}</p>",
        "id": 216273405,
        "sender_full_name": "Werner De Mulder",
        "timestamp": 1605041929
    },
    {
        "content": "<p>What URL are you PUTing to?</p>",
        "id": 216273865,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1605042143
    },
    {
        "content": "<p>PUT <a href=\"http://localhost:4080/administration/StructureDefinition\">http://localhost:4080/administration/StructureDefinition</a></p>",
        "id": 216274208,
        "sender_full_name": "Werner De Mulder",
        "timestamp": 1605042315
    },
    {
        "content": "<p>body content contains structuredefinition. I didn't apply the Content-Type</p>",
        "id": 216274269,
        "sender_full_name": "Werner De Mulder",
        "timestamp": 1605042351
    },
    {
        "content": "<p>Most servers expect Content-Type to be declared</p>",
        "id": 216274463,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1605042424
    },
    {
        "content": "<p>When I add Content-Type, I receive a message that the argument is not supported</p>",
        "id": 216274631,
        "sender_full_name": "Werner De Mulder",
        "timestamp": 1605042494
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191363\">@Vadim Peretokin</span></p>",
        "id": 216274820,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1605042577
    },
    {
        "content": "<p>are you using the right application/fhir+json or application/fhir+xml content-type headers? because everything else looks right according to their docs <a href=\"https://docs.fire.ly/vonk/features/conformanceresources.html#example\">https://docs.fire.ly/vonk/features/conformanceresources.html#example</a></p>",
        "id": 216291976,
        "sender_full_name": "ryan moehrke",
        "timestamp": 1605052994
    },
    {
        "content": "<p>Yes seems to be fine. Something is not correct. If I perform a database reset using POST HTTP://127.0.0.1:4080/administration/reset I get a status code 200 which means that it is ok. If I search afterwards for structuredefinitions in my database, still some structuredefinitions are in (GET <a href=\"http://127.0.0.1:4080/administration/StructureDefinition?Content-Type=application/fhir+json\">http://127.0.0.1:4080/administration/StructureDefinition?Content-Type=application/fhir+json</a>). How to delete a structuredefintion? <br>\nDELETE <a href=\"http://127.0.0.1:4080/administration/StructureDefinition\">http://127.0.0.1:4080/administration/StructureDefinition</a> doesn't work here.</p>",
        "id": 216317028,
        "sender_full_name": "Werner De Mulder",
        "timestamp": 1605082403
    },
    {
        "content": "<p>It should be <code>DELETE http://127.0.0.1:4080/administration/StructureDefinition/&lt;resource ID&gt;</code></p>",
        "id": 216330106,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1605091594
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"317840\">@Werner De Mulder</span> you need to do a <code>POST</code> if you aren't specifying an ID. See <a href=\"https://www.hl7.org/fhir/http.html#create\">https://www.hl7.org/fhir/http.html#create</a></p>",
        "id": 216330200,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1605091652
    },
    {
        "content": "<p>When using the PUT the url should contain parameters to specify which StructureDefinition should be updated; adding the url from your new StructureDefinition might help; try PUT <code>http://127.0.0.1:4080/administration/StructureDefinition?url=</code> with the specified url after this.</p>",
        "id": 216331437,
        "sender_full_name": "Marc Sandberg",
        "timestamp": 1605092494
    },
    {
        "content": "<p>wait why is your \"Content-Type=application/fhir+json\" in your url parameters? it should be a header right?</p>",
        "id": 216359663,
        "sender_full_name": "ryan moehrke",
        "timestamp": 1605108411
    },
    {
        "content": "<p>Thank you all for your input.<br>\nStill one question about the reset parameter. I should assume that when using POST http://&lt;vonk-endpoint&gt;/administration/reset all the content is cleared, even the structuredefintions. This is not the case. In appsettings.json, I commented out the security element. </p>\n<p>//\"Security\": {<br>\n      //\"AllowedNetworks\": [ \"127.0.0.1\", \"::1\", \"10.51.244.67\" ], // i.e.: [\"127.0.0.1\", \"::1\" (ipv6 localhost), \"10.1.50.0/24\", \"10.5.3.0/24\", \"31.161.91.98\"]<br>\n      //\"OperationsToBeSecured\": [ \"reindex\", \"reset\", \"preload\", \"importResources\" ] <br>\n    //}<br>\n  }</p>\n<p>I receive no error, return code 200, but my structuredefinitions are still in.</p>",
        "id": 216376833,
        "sender_full_name": "Werner De Mulder",
        "timestamp": 1605116843
    },
    {
        "content": "<p>I haven't used Vonk, but based on <a href=\"https://docs.fire.ly/vonk/features/resetdb.html\">https://docs.fire.ly/vonk/features/resetdb.html</a> I would assume that this POST should have worked (especially since you received a 200 response code). Maybe you could try the documented alternative. It could also be helpful to check the logs for an error that could have occurred after the 200 response. Since I'm no Vonk user I don't know if the response will be send before the operation is complete (since large databases could take a while), or just wait until it's all done.</p>",
        "id": 216442082,
        "sender_full_name": "Marc Sandberg",
        "timestamp": 1605171281
    }
]