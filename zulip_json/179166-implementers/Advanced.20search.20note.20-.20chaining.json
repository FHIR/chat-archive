[
    {
        "content": "<p>At the bottom of <a href=\"http://hl7.org/fhir/R4/search.html#chaining\" target=\"_blank\" title=\"http://hl7.org/fhir/R4/search.html#chaining\">http://hl7.org/fhir/R4/search.html#chaining</a>, there's text that says:</p>\n<blockquote>\n<p>Advanced Search Note: Where a chained parameter searches a resource reference that may have more than one type of resource as its target, the parameter chain may end up referring to search parameters with the same name on more than one kind of resource at once. Servers SHOULD reject a search where the logical id refers to more than one matching resource across different types. For example, the client has to specify the type explicitly using the syntax in the second example above.</p>\n</blockquote>\n<p>This same note was present in STU3 (i.e. <a href=\"https://www.hl7.org/fhir/STU3/search.html#chaining\" target=\"_blank\" title=\"https://www.hl7.org/fhir/STU3/search.html#chaining\">https://www.hl7.org/fhir/STU3/search.html#chaining</a>).<br>\nIf I were to interpret this, would this mean that searches like <code>AuditEvent?entity.patient=X</code> (i.e. <a href=\"http://hl7.org/fhir/STU3/compartmentdefinition-patient.html\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/compartmentdefinition-patient.html\">http://hl7.org/fhir/STU3/compartmentdefinition-patient.html</a>) would always be rejected? I surmise that's why in R4, the Patient compartment had removed these types of searches from the list?</p>\n<p>For the record, our FHIR server can handle <code>AuditEvent?entity.patient=X</code> but my other question is since the spec says \"server SHOULD reject a search\" does that mean we're not following the FHIR standard anymore? I tend to think that following the SHALL, MUST and SHOULD of the spec means we're FHIR-compliant and not following those would mean the opposite?</p>",
        "id": 166054266,
        "sender_full_name": "Michael Calderero",
        "timestamp": 1558324047
    },
    {
        "content": "<p><code>entity.patient=x</code> is wrong - it should be <code>entity:Patient=x</code> or <code>entity=Patient/x</code><br>\nChaining works with search parameters of the target resource - so <code>entity:Patient.name=Smith</code> (and because <code>entity</code> has more that one type of resource as its target the <code>:Patient</code> part is needed)</p>",
        "id": 166077433,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1558352314
    },
    {
        "content": "<p>So you're saying that the compartment definition of Patient for STU3 is wrong/non-executable if there's an AuditEvent resource?</p>",
        "id": 166080867,
        "sender_full_name": "Michael Calderero",
        "timestamp": 1558355658
    }
]