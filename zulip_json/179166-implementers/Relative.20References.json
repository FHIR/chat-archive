[
    {
        "content": "<p>I have a question about a breaking change to a normative part of the specification. </p>\n<p>Process note: Breaking changes to normative content are only allowed if <em>everyone</em> agrees that they're a reasonable change to make, and it won't break implementations. This might be one of those cases.</p>",
        "id": 175893725,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568716747
    },
    {
        "content": "<div class=\"message_inline_image\"><a href=\"https://i.kym-cdn.com/photos/images/original/000/264/241/9e9.gif\" target=\"_blank\" title=\"https://i.kym-cdn.com/photos/images/original/000/264/241/9e9.gif\"><img src=\"https://i.kym-cdn.com/photos/images/original/000/264/241/9e9.gif\"></a></div>",
        "id": 175893803,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1568716804
    },
    {
        "content": "<p><a href=\"https://www.hl7.org/fhir/references.html#literal\" target=\"_blank\" title=\"https://www.hl7.org/fhir/references.html#literal\">https://www.hl7.org/fhir/references.html#literal</a> describes how relative references work. It says that a reference like </p>\n<p>Patient/1</p>\n<p>is a reference to a resource located at \"Patient/1\" relative to the resource. There's a special rule that if you accessed the resource by the RESTful API, \"relative to\" actually means 'Relative to the service base', not to the actual resource.</p>",
        "id": 175893830,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568716842
    },
    {
        "content": "<p>Note, however, that this relative reference is also perfectly fine: </p>\n<p>old_resources/my_archive/resources/something-else/thisthat.xml</p>",
        "id": 175893858,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568716886
    },
    {
        "content": "<p>whatever is served up from this URL must be a resource that is one of the acceptable target types for the element that contains the reference</p>",
        "id": 175893883,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568716915
    },
    {
        "content": "<p>There's one thing the specification doesn't say which is kind of surprising to most implementers: there's no rule that a reference like </p>\n<p>Patient/1 </p>\n<p>Actually has to point to a patient. Weird, and I would very strongly recommend against mucking around with people's expectations like that. And if you didn't serve a Patient from a link like that, you probably wouldn't conform to the RESTful API... but maybe you aren't anyway (you don't have to only use resources with the RESTful API).</p>\n<p>What this means is that as the reference level, you can't assume that Patient/1 actually references a patient: you have to fetch it to see what it references.</p>",
        "id": 175894117,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568717088
    },
    {
        "content": "<p>I think most people would find that surprising... So we could consider changing the specification to say that if a reference is relative, and starts with [Type]/ where Type is one of the known resources, then it SHALL refer to a resource of the named type.</p>",
        "id": 175894180,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568717153
    },
    {
        "content": "<p>we can only do that if everyone agrees that this a reasonable rule that no one has deviated from (and we would have to implementer survey on this).</p>",
        "id": 175894246,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568717192
    },
    {
        "content": "<p>Bulk data relies on all references being in the [Type]/[id] format</p>",
        "id": 175904327,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1568726020
    },
    {
        "content": "<p>I guess a validator would still have to verify by resolving the reference, and report a type mismatch as an error.</p>",
        "id": 175906948,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1568727703
    },
    {
        "content": "<p>Validators look at  a lot of things that normal clients don't need to.  ;)</p>",
        "id": 175907094,
        "sender_full_name": "Michael Donnelly",
        "timestamp": 1568727794
    },
    {
        "content": "<p>This seems totally good and clear. Out of curiosity: did this come up as a problem in a real-world situation?</p>",
        "id": 175907344,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1568727953
    },
    {
        "content": "<p>it arose when I was testing a validator fail report (on <a class=\"stream\" data-stream-id=\"179167\" href=\"/#narrow/stream/179167-hapi\">#hapi</a> if you want to read the details)</p>",
        "id": 175908063,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568728380
    },
    {
        "content": "<p>Thanks! <a href=\"#narrow/stream/179167-hapi/topic/constraint.20on.20careteam.20%28ctm-1%29/near/175879831\" title=\"#narrow/stream/179167-hapi/topic/constraint.20on.20careteam.20%28ctm-1%29/near/175879831\">deep link  to the thread</a>.</p>",
        "id": 175908194,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1568728471
    },
    {
        "content": "<blockquote>\n<p>This seems totally good and clear. Out of curiosity: did this come up as a problem in a real-world situation?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span>  My main focus tends to revolve around real-world situations. Imaginary stuff scares the s**t out of me <span aria-label=\"scream\" class=\"emoji emoji-1f631\" role=\"img\" title=\"scream\">:scream:</span></p>",
        "id": 175950839,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1568755650
    },
    {
        "content": "<p><span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 175950851,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1568755666
    },
    {
        "content": "<blockquote>\n<p>Process note: Breaking changes to normative content are only allowed if <em>everyone</em> agrees that they're a reasonable change to make, and it won't break implementations. This might be one of those cases.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  How many is <em>everyone</em> and what would the ETA be? Would this go back to eg. STU3?</p>",
        "id": 176001531,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1568811241
    },
    {
        "content": "<p>well, we would actively seek input repeatedly through all the channels we have, particularly ballot, hammering on the fact that this is a breaking change to normative content that can only stand if no one objects and we have thoroughly asked the community. And if TSC approves that we did all that properly</p>",
        "id": 176002528,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568811877
    },
    {
        "content": "<p>and it wouldn't apply retrospectively directly, but it would be pretty strong guidance</p>",
        "id": 176002718,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568811992
    },
    {
        "content": "<p>So ... between two days and two years</p>",
        "id": 176002797,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1568812036
    }
]