[
    {
        "content": "<p>\"If the server assigns a new id to any resource in the bundle as part of the processing rules above, it SHALL also update any references to that resource in the same bundle as they are processed\"</p>\n<p><span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span>  there seems to be some confusion about this sentence, in regard to DocumentReference.content.attachment.url. If this references a binary in the bundle, then it SHALL be updated</p>",
        "id": 153905436,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504989650
    },
    {
        "content": "<p>I tried it to in Furore's Vonk Server, and it does not replace the url with the url for the binary.</p>",
        "id": 153905449,
        "sender_full_name": "diego kaminker",
        "timestamp": 1504990740
    },
    {
        "content": "<p>And also tried with <a href=\"http://test.fhir.org/r3\" target=\"_blank\" title=\"http://test.fhir.org/r3\">http://test.fhir.org/r3</a> (Grahame's server) and cannot make it replace the url with the Binary resource  location/id inside of the transaction[XDS_EXAMPLE_BINARY_URL_REPLACE.xml] is what I posted.<br>\n Maybe I am posting it wrong? Any ideas?<br>\n (<a href=\"https://chat.fhir.org/user_uploads/10155/_68YuSUtcikFSVpXcQyIvopl/XDS_EXAMPLE_BINARY_URL_REPLACE.xml\" target=\"_blank\" title=\"XDS_EXAMPLE_BINARY_URL_REPLACE.xml\">https://chat.fhir.org/user_uploads/10155/_68YuSUtcikFSVpXcQyIvopl/XDS_EXAMPLE_BINARY_URL_REPLACE.xml</a>)</p>",
        "id": 153905451,
        "sender_full_name": "diego kaminker",
        "timestamp": 1504991135
    },
    {
        "content": "<p>The patient and practitioner references seem wrong</p>",
        "id": 153905454,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504991463
    },
    {
        "content": "<p>Shouldn't <code>Patient/a2</code> actually be <code>urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce35</code> (the patient that is in the bundle) ?</p>",
        "id": 153905455,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504991510
    },
    {
        "content": "<p>I edited all references from the example in the FHIR STU3 spec, forgot that one. But even correcting it, content.attachment.url is not replaced with the id assigned to the Binary resource by the server.</p>",
        "id": 153905457,
        "sender_full_name": "diego kaminker",
        "timestamp": 1504991768
    },
    {
        "content": "<p>Yes, but that's an actual URL to data (or should be) - it is not an id to a resource</p>",
        "id": 153905458,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504991855
    },
    {
        "content": "<p>I don't think it should be replaced</p>",
        "id": 153905459,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504991862
    },
    {
        "content": "<p>I think that's the issue with the IHE MHD IG, it asks us to send the Binary as part of the transaction hoping that the URL will be replaced. It's not replaced by any of the reference servers I tried. Maybe NO server will ever replace the URL, and we should do TWO trips one for the binary, one for the DocumentReference). I just want to know.</p>",
        "id": 153905461,
        "sender_full_name": "diego kaminker",
        "timestamp": 1504991999
    },
    {
        "content": "<p>Never quite understood that in the spec - you can just put the binary data directly in the DocumentReference - why even use a separate Binary resource?</p>",
        "id": 153905464,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504992085
    },
    {
        "content": "<p>Fixing a bit the practitioners that bundle works on our server</p>",
        "id": 153905467,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504992451
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>\n</pre></div>",
        "id": 153905468,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504992454
    },
    {
        "content": "<p>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;<br>\n&lt;Bundle xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n    &lt;id value=\"xds\"/&gt; <br>\n    &lt;type value=\"transaction\"/&gt; <br>\n    &lt;entry&gt; <br>\n        &lt;fullUrl value=\"urn:uuid:3fdc72f4-a11d-4a9d-9260-a9f745779e1d\"/&gt; <br>\n        &lt;resource&gt; <br>\n            &lt;DocumentReference&gt; <br>\n                &lt;text&gt; <br>\n                    &lt;status value=\"generated\"/&gt; <br>\n                    &lt;div xmlns=\"<a href=\"http://www.w3.org/1999/xhtml\" target=\"_blank\" title=\"http://www.w3.org/1999/xhtml\">http://www.w3.org/1999/xhtml</a>\"&gt;</p>\n<div class=\"codehilite\"><pre><span></span>                    &lt;a href=&quot;http://vonk.furore.com/Binary/1e404af3-077f-4bee-b7a6-a9be97e1ce32&quot;&gt;Document: urn:oid:129.6.58.92.88336&lt;/a&gt; undefined, created 24/12/2005\n                &lt;/div&gt; \n            &lt;/text&gt; \n            &lt;masterIdentifier&gt; \n                &lt;system value=&quot;urn:ietf:rfc:3986&quot;/&gt; \n                &lt;value value=&quot;urn:oid:129.6.58.92.88336&quot;/&gt; \n            &lt;/masterIdentifier&gt; \n            &lt;status value=&quot;current&quot;/&gt; \n            &lt;type&gt; \n                &lt;coding&gt; \n                    &lt;system value=&quot;http://ihe.net/connectathon/classCodes&quot;/&gt; \n                    &lt;code value=&quot;History and Physical&quot;/&gt; \n                    &lt;display value=&quot;History and Physical&quot;/&gt; \n                &lt;/coding&gt; \n            &lt;/type&gt; \n            &lt;class&gt; \n                &lt;coding&gt; \n                    &lt;system value=&quot;http://loinc.org&quot;/&gt; \n                    &lt;code value=&quot;47039-3&quot;/&gt; \n                    &lt;display value=&quot;Inpatient Admission history and physical note&quot;/&gt; \n                &lt;/coding&gt; \n            &lt;/class&gt; \n            &lt;subject&gt; \n                &lt;reference value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce35&quot;/&gt; \n            &lt;/subject&gt; \n            &lt;created value=&quot;2005-12-24&quot;/&gt; \n            &lt;indexed value=&quot;2013-07-01T23:11:33+10:00&quot;/&gt; \n            &lt;author&gt; \n                &lt;reference value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce34&quot;/&gt; \n            &lt;/author&gt; \n            &lt;author&gt; \n                &lt;reference value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce33&quot;/&gt; \n            &lt;/author&gt; \n            &lt;description value=&quot;Physical&quot;/&gt; \n            &lt;securityLabel&gt; \n                &lt;coding&gt; \n                    &lt;system value=&quot;http://hl7.org/fhir/v3/Confidentiality&quot;/&gt; \n                    &lt;code value=&quot;N&quot;/&gt; \n                    &lt;display value=&quot;normal&quot;/&gt; \n                &lt;/coding&gt; \n            &lt;/securityLabel&gt; \n            &lt;content&gt; \n                &lt;attachment&gt; \n                    &lt;contentType value=&quot;text/plain&quot;/&gt; \n                    &lt;language value=&quot;en-us&quot;/&gt; \n                    &lt;url value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce32&quot;/&gt; \n                &lt;/attachment&gt; \n                &lt;format&gt; \n                    &lt;system value=&quot;urn:oid:1.3.6.1.4.1.19376.1.2.3&quot;/&gt; \n                    &lt;code value=&quot;urn:ihe:pcc:handp:2008&quot;/&gt; \n                &lt;/format&gt;  \n            &lt;/content&gt; \n            &lt;context&gt; \n                &lt;period&gt; \n                    &lt;start value=&quot;2004-12-23T08:00:00+10:00&quot;/&gt; \n                    &lt;end value=&quot;2004-12-23T08:01:00+10:00&quot;/&gt; \n                &lt;/period&gt; \n                &lt;practiceSetting&gt; \n                    &lt;coding&gt; \n                        &lt;system value=&quot;http://ihe.net/connectathon/practiceSettingCodes&quot;/&gt; \n                        &lt;code value=&quot;General Medicine&quot;/&gt; \n                        &lt;display value=&quot;General Medicine&quot;/&gt; \n                    &lt;/coding&gt; \n                &lt;/practiceSetting&gt; \n            &lt;/context&gt; \n        &lt;/DocumentReference&gt; \n    &lt;/resource&gt; \n    &lt;request&gt; \n        &lt;method value=&quot;POST&quot;/&gt; \n        &lt;url value=&quot;DocumentReference&quot;/&gt; \n    &lt;/request&gt; \n&lt;/entry&gt; \n&lt;entry&gt; \n    &lt;fullUrl value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce35&quot;/&gt; \n    &lt;resource&gt; \n        &lt;!--    if the server can find a matching resource, use that, else create a new \n            resource with these details    --&gt;\n        &lt;Patient&gt; \n            &lt;text&gt; \n                &lt;status value=&quot;generated&quot;/&gt; \n                &lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;Person DOE, John, M, dob: 27/05/1956&lt;/div&gt; \n            &lt;/text&gt; \n            &lt;identifier&gt; \n                &lt;use value=&quot;usual&quot;/&gt; \n                &lt;value value=&quot;MRN&quot;/&gt; \n            &lt;/identifier&gt; \n            &lt;name&gt; \n                &lt;use value=&quot;usual&quot;/&gt; \n                &lt;text value=&quot;DOE, John&quot;/&gt; \n                &lt;family value=&quot;Doe&quot;/&gt; \n                &lt;given value=&quot;John&quot;/&gt; \n            &lt;/name&gt; \n            &lt;birthDate value=&quot;1956-05-27&quot;/&gt; \n        &lt;/Patient&gt; \n    &lt;/resource&gt; \n    &lt;request&gt; \n        &lt;method value=&quot;POST&quot;/&gt; \n        &lt;url value=&quot;Patient&quot;/&gt; \n    &lt;/request&gt; \n&lt;/entry&gt; \n&lt;entry&gt; \n    &lt;fullUrl value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce34&quot;/&gt; \n    &lt;resource&gt; \n        &lt;Practitioner&gt; \n            &lt;text&gt; \n                &lt;status value=&quot;generated&quot;/&gt; \n                &lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;Author Gerald Smitty @ Cleveland Clinic&lt;/div&gt; \n            &lt;/text&gt; \n            &lt;identifier&gt; \n                &lt;use value=&quot;usual&quot;/&gt; \n                &lt;value value=&quot;GeradSmitty&quot;/&gt; \n            &lt;/identifier&gt; \n            &lt;name&gt; \n                &lt;use value=&quot;usual&quot;/&gt; \n                &lt;family value=&quot;Smitty&quot;/&gt; \n                &lt;given value=&quot;Gerald&quot;/&gt; \n            &lt;/name&gt; \n        &lt;/Practitioner&gt; \n    &lt;/resource&gt; \n    &lt;request&gt; \n        &lt;method value=&quot;POST&quot;/&gt; \n        &lt;url value=&quot;Practitioner&quot;/&gt; \n    &lt;/request&gt; \n&lt;/entry&gt; \n&lt;entry&gt; \n    &lt;fullUrl value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce33&quot;/&gt; \n    &lt;resource&gt; \n        &lt;Practitioner&gt; \n            &lt;text&gt; \n                &lt;status value=&quot;generated&quot;/&gt; \n                &lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;Author Person @ Cleveland Clinic&lt;/div&gt; \n            &lt;/text&gt; \n            &lt;identifier&gt; \n                &lt;use value=&quot;usual&quot;/&gt; \n                &lt;value value=&quot;SherryDoplemeyer&quot;/&gt; \n            &lt;/identifier&gt; \n            &lt;name&gt; \n                &lt;use value=&quot;usual&quot;/&gt; \n                &lt;family value=&quot;Dopplemeyer&quot;/&gt; \n                &lt;given value=&quot;Sherry&quot;/&gt; \n            &lt;/name&gt; \n        &lt;/Practitioner&gt; \n    &lt;/resource&gt; \n    &lt;request&gt; \n        &lt;method value=&quot;POST&quot;/&gt; \n        &lt;url value=&quot;Practitioner&quot;/&gt; \n    &lt;/request&gt; \n&lt;/entry&gt; \n&lt;entry&gt; \n    &lt;fullUrl value=&quot;urn:uuid:1e404af3-077f-4bee-b7a6-a9be97e1ce32&quot;/&gt; \n    &lt;resource&gt; \n        &lt;Binary&gt; \n            &lt;contentType value=&quot;text/plain&quot;/&gt; \n            &lt;content value=&quot;YXNkYXNkYXNkYXNkYXNk&quot;/&gt; \n        &lt;/Binary&gt; \n    &lt;/resource&gt; \n    &lt;request&gt; \n        &lt;method value=&quot;POST&quot;/&gt; \n        &lt;url value=&quot;Binary&quot;/&gt; \n    &lt;/request&gt; \n&lt;/entry&gt;\n</pre></div>\n\n\n<p>&lt;/Bundle&gt;</p>",
        "id": 153905469,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504992455
    },
    {
        "content": "<p>See results at <a href=\"https://fhir.careevolution.com/apitest/fhir/DocumentReference/209a001c-7d09-4b3c-a0cf-0df44a398f20\" target=\"_blank\" title=\"https://fhir.careevolution.com/apitest/fhir/DocumentReference/209a001c-7d09-4b3c-a0cf-0df44a398f20\">https://fhir.careevolution.com/apitest/fhir/DocumentReference/209a001c-7d09-4b3c-a0cf-0df44a398f20</a></p>",
        "id": 153905470,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504992535
    },
    {
        "content": "<p>I discussed this with Ewout and James. We created a hot topic to recommend using content.attachment.data instead of a binary resource to overcome this problem. Let's see what is the outcome of the discussion.</p>",
        "id": 153905475,
        "sender_full_name": "diego kaminker",
        "timestamp": 1504992919
    },
    {
        "content": "<p>...yes, and the bundle will also be smaller / simpler</p>",
        "id": 153905481,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504993141
    },
    {
        "content": "<p>that hot topic ducks the underlying issue. The server writers are just kicking the can down the road...</p>",
        "id": 153905551,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504998418
    },
    {
        "content": "<p>there's really compelling engineering reasons for using a binary not base64 attachment data</p>",
        "id": 153905552,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504998453
    },
    {
        "content": "<p>...but if you put the Binary resource in the bundle  you still have to use base64 ?</p>",
        "id": 153905555,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504998536
    },
    {
        "content": "<p>yes, but you can fetch it directly as a binary</p>",
        "id": 153905558,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504998584
    },
    {
        "content": "<p>and you can reference it from html</p>",
        "id": 153905559,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1504998593
    },
    {
        "content": "<p>Yes, the <code>attachment</code> can reference a URL that serves directly the binary data - and then you do not even need the Binary resource at all</p>",
        "id": 153905570,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504998770
    },
    {
        "content": "<p>...but that works only if the system that is POSTing the bundle can host the binary content somewhere accessible from the receiving system</p>",
        "id": 153905572,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1504998829
    },
    {
        "content": "<p>no it works for FHIR  servers too</p>",
        "id": 153905603,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505001241
    },
    {
        "content": "<p>post as binary using the binary format</p>",
        "id": 153905604,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505001253
    },
    {
        "content": "<p>get as binary using the binary format</p>",
        "id": 153905605,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505001259
    },
    {
        "content": "<p>use base64 if you need to do it in a transaction</p>",
        "id": 153905606,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505001268
    },
    {
        "content": "<p>ah OK - sure - then you POST the binary first, get back the id and use that in the DocumentReference</p>",
        "id": 153905607,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505001370
    },
    {
        "content": "<p>but you can do that in a transaction too</p>",
        "id": 153905608,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505001394
    },
    {
        "content": "<p>how?</p>",
        "id": 153905609,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505001415
    },
    {
        "content": "<p>post it as a bas64, and then get it as a binary - that's why MHD does it as a binary not an attachment</p>",
        "id": 153905618,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505001990
    },
    {
        "content": "<p>I don't get it - you are still sending the data over as base64. The target FHIR server does not have to get the data - as binary or otherwise - it already has it</p>",
        "id": 153905623,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505002208
    },
    {
        "content": "<p>if it is in the transaction as base64</p>",
        "id": 153905625,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505002288
    },
    {
        "content": "<p>yes but if you put it in the Attachment as base64, you can only get it as base64, where as if you post it in binary, you post it in base64, but you get it in binary</p>",
        "id": 153905643,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505006330
    },
    {
        "content": "<p>I see what you mean now - but isn't this an internal implementation detail of the server?</p>",
        "id": 153905750,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059443
    },
    {
        "content": "<p>The way it  renders the DocumentReference when GETing it does not have to depend on the way it has been created originally</p>",
        "id": 153905753,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059479
    },
    {
        "content": "<p>i.e. it can be rendered with the data as a separate Binary resource even if it has been created with data embedded as base64 - or vice-versa</p>",
        "id": 153905754,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059541
    },
    {
        "content": "<p>as a matter of fact our servers does the 'vice-versa': regardless on how the DocumentReference is created it always renders it with embedded base64 data</p>",
        "id": 153905755,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059595
    },
    {
        "content": "<p>(and we should probably do the opposite)</p>",
        "id": 153905757,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059622
    },
    {
        "content": "<p>if you have the binary(s) embedded inside the DocumentReference, then you can't get the content as a native binary. that's not an internal implementation detail</p>",
        "id": 153905760,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505059702
    },
    {
        "content": "<p>mhhh why not? we could surely do it in our server (although as I said we are doing the opposite now)</p>",
        "id": 153905762,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059778
    },
    {
        "content": "<p>because how? when we discussed this in FHIR-I it rapidly started to get complicated.</p>",
        "id": 153905764,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505059836
    },
    {
        "content": "<p>if you have the data stored in binary somewhere in your db you can always render that data as a Binary  resource and put a url to it in the DOcumentReference</p>",
        "id": 153905766,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059850
    },
    {
        "content": "<p>that's as a binary... that's exactly what MHD is doing.</p>",
        "id": 153905767,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505059881
    },
    {
        "content": "<p>we seem to have come around in a circle back to the logical thing that MHD is doing</p>",
        "id": 153905768,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505059906
    },
    {
        "content": "<p>yes - but that does not have to have anything to do on how the DocumentReference has been created</p>",
        "id": 153905769,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059908
    },
    {
        "content": "<p>you can do it regardless</p>",
        "id": 153905770,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505059921
    },
    {
        "content": "<p>yes it does. if you inline the data in the DocumentReference, then you return it that way too. irrespective of how you store it</p>",
        "id": 153905771,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505059943
    },
    {
        "content": "<p>mhh...for a spec reason or a technical reason?</p>",
        "id": 153905772,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060011
    },
    {
        "content": "<p>I don't see a technical reason</p>",
        "id": 153905773,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060019
    },
    {
        "content": "<p>technical reason? for what?</p>",
        "id": 153905774,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505060043
    },
    {
        "content": "<p>'if you inline the data in the DocumentReference, then you return it that way too. '</p>",
        "id": 153905775,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060063
    },
    {
        "content": "<p>why?</p>",
        "id": 153905776,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060131
    },
    {
        "content": "<p>well, it's allowed for the server to un-inline data. Typically, that's really difficult but this is one case where it would be technically possible. It's an MHD rule in this case. But I think that it would be better for the servers to be fixed to follow the spec than for MHD to mandate posting in one format, and the server converting to another</p>",
        "id": 153905777,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505060211
    },
    {
        "content": "<p>I would not mandate MHD to do one or the other - I would just allow both</p>",
        "id": 153905778,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060274
    },
    {
        "content": "<p>and suggest that the server returns data as separate Binary</p>",
        "id": 153905779,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060285
    },
    {
        "content": "<p>(that is not really part of MHD in any case - MHD is only for the POSTing part isn't it?)</p>",
        "id": 153905780,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060314
    },
    {
        "content": "<p>I thought it did reading too. Argonaut does the read part, and that is harmonised...</p>",
        "id": 153905784,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505060420
    },
    {
        "content": "<p>but you want it to work whichever ways are allowed</p>",
        "id": 153905785,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505060433
    },
    {
        "content": "<p>...seems better ... and from what <span class=\"user-mention\" data-user-id=\"191839\">@diego kaminker</span> wrote above it seems that most server do not really like the separate binary resource in the bundle</p>",
        "id": 153905788,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060656
    },
    {
        "content": "<p>our server does handle it because we did some work to be MHD compliant</p>",
        "id": 153905789,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060673
    },
    {
        "content": "<p>(with the current specs)</p>",
        "id": 153905790,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060683
    },
    {
        "content": "<p>(...but then we ran into other problems - mostly Practitioner without identifiers - that are OK for the specs and our server does not like)</p>",
        "id": 153905792,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060755
    },
    {
        "content": "<p>(and we gave up )</p>",
        "id": 153905793,
        "sender_full_name": "Michele Mottini",
        "timestamp": 1505060762
    },
    {
        "content": "<p>We have further discussed this with <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> , we will present the issues in our report for this connectathon track today. You can see the presentation here: <a href=\"https://www.dropbox.com/s/hrbuj69fs1x61er/MHD_STU3_TRACK.pptx?dl=0\" target=\"_blank\" title=\"https://www.dropbox.com/s/hrbuj69fs1x61er/MHD_STU3_TRACK.pptx?dl=0\">https://www.dropbox.com/s/hrbuj69fs1x61er/MHD_STU3_TRACK.pptx?dl=0</a></p>\n<div class=\"message_inline_ref\"><a href=\"https://www.dropbox.com/s/hrbuj69fs1x61er/MHD_STU3_TRACK.pptx?dl=0\" target=\"_blank\" title=\"MHD_STU3_TRACK.pptx\"><img src=\"https://www.dropbox.com/static/images/spectrum-icons/generated/content/content-ppt-large.png\"></a><div><div class=\"message_inline_image_title\">MHD_STU3_TRACK.pptx</div><desc class=\"message_inline_image_desc\"></desc></div></div>",
        "id": 153905836,
        "sender_full_name": "diego kaminker",
        "timestamp": 1505062553
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191912\">@Michele Mottini</span>  MHD includes both the publication side, and the consumption side.  It is published here <a href=\"http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_MHD.pdf\" target=\"_blank\" title=\"http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_MHD.pdf\">http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_MHD.pdf</a></p>",
        "id": 153906000,
        "sender_full_name": "John Moehrke",
        "timestamp": 1505081012
    },
    {
        "content": "<p>I will propose a CR that tries to address this need, while keeping the solution general use, and not being overly hard to implement. Thus only asking that the same fixup that is done for  Resource references be done with URL datatype.</p>",
        "id": 153906001,
        "sender_full_name": "John Moehrke",
        "timestamp": 1505081490
    },
    {
        "content": "<p>See <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13823\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13823\">GF#13823</a></p>",
        "id": 153906003,
        "sender_full_name": "John Moehrke",
        "timestamp": 1505081837
    },
    {
        "content": "<p>I wrote a summary of the IHE-MHD at FHIR Connectathon <a href=\"https://healthcaresecprivacy.blogspot.com/2017/09/fhir-connectathon-of-ihe-mhd-profile.html\" target=\"_blank\" title=\"https://healthcaresecprivacy.blogspot.com/2017/09/fhir-connectathon-of-ihe-mhd-profile.html\">https://healthcaresecprivacy.blogspot.com/2017/09/fhir-connectathon-of-ihe-mhd-profile.html</a></p>",
        "id": 153906283,
        "sender_full_name": "John Moehrke",
        "timestamp": 1505153495
    },
    {
        "content": "<p>Another thing that is relevant here is that Attachment.url is of type Uri, and our server will not replace the content of uri's in a bundle to point to the newly inserted resource in the same way we do with References.  Should Attachment.url into something like Attachment.link[x] where x can be Uri or Reference?</p>",
        "id": 153908567,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1505429572
    },
    {
        "content": "<p>your server should do that</p>",
        "id": 153908587,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505430635
    },
    {
        "content": "<blockquote>\n<p>your server should do that</p>\n</blockquote>\n<p>Not in general: I should not do that for Coding.system for example, which is also a Uri. So how would my server know Attachment is a special case?  Hand code it in?  We could do that of course, but it's not really clear from the spec we should do it currently (or me and James look in the wrong place)...</p>",
        "id": 153908607,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1505431229
    },
    {
        "content": "<p>it should not arise for Coding.system, but that is an interesting point.</p>",
        "id": 153908609,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505431260
    },
    {
        "content": "<p>the wording in question is</p>",
        "id": 153908611,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505431269
    },
    {
        "content": "<p>Servers SHALL replace all matching links in the bundle, whether they are found in the resource ids, resource references, url elements, or &lt;a href=\"\" &amp; &lt;img src=\"\" in the narrative</p>",
        "id": 153908615,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505431356
    },
    {
        "content": "<p>That seems constrained (is within same Bundle), would work for DocumentReference, and seems to me it would work for any URI anywhere.  Relying on uniqueness of unique ID generation...</p>",
        "id": 153908902,
        "sender_full_name": "John Moehrke",
        "timestamp": 1505744095
    },
    {
        "content": "<p>well, you do need to get that bit right</p>",
        "id": 153908943,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505769102
    },
    {
        "content": "<p>I missed that text, I only interpretted resource references (and in narrative), not uri datatypes.</p>",
        "id": 153909199,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1505894237
    },
    {
        "content": "<p>it might be a little clearer, I guess</p>",
        "id": 153909287,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1505913270
    },
    {
        "content": "<blockquote>\n<p>it should not arise for Coding.system, but that is an interesting point.</p>\n</blockquote>\n<p>I think StructureDefinition.uri and maybe a few others are vulnerable too.  I remember doing it in Spark in exactly this way, but getting error reports and pushback. Obviously, in Vonk (and HAPI), we're more cautious....  <span class=\"user-mention\" data-user-id=\"191757\">@Christiaan Knaap</span>  <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span></p>",
        "id": 153910625,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506424139
    },
    {
        "content": "<p>how would it be a problem for StructureDefinition.uri ?</p>",
        "id": 153911107,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1506550502
    },
    {
        "content": "<blockquote>\n<p>how would it be a problem for StructureDefinition.uri ?</p>\n</blockquote>\n<p>I would not want the server to alter the canonical - if I am posting a bundle of structuredefinitions where initially the fullUrl and the uri's match to a conformance server, the server will most probably assign a new technical id to the SD, but I would not want the fullUrl to be changed.</p>",
        "id": 153911186,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506584427
    },
    {
        "content": "<p>Ewout, the rule we are indicating is only when the unique value is of an object that is also in the same Transaction Bundle.   It is a fixup requirement, not a general requirement for the datatype.</p>",
        "id": 153911222,
        "sender_full_name": "John Moehrke",
        "timestamp": 1506603292
    },
    {
        "content": "<p>So it seems like an edge case to me, but given the definition of the canonical uri, we can say that it, and references to it, shouldn't be changed. That complicates matters, but there's lots of cases where you wnat/need uri references to be updated</p>",
        "id": 153911570,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1506899373
    },
    {
        "content": "<p>Most of the examples that I can think of or uri's that should not be updated are uri's representing canonicals in the conformance resources....And Coding.system.   Quantity.system......  extension.url,   Signature.whoUri (?), maybe quite some more....</p>",
        "id": 153911804,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506957026
    },
    {
        "content": "<p>All corner cases....that's for sure. Very unlikely you'd have a clash here....</p>",
        "id": 153911805,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506957117
    },
    {
        "content": "<p>well, you could create a task for s to clarify this special exception to the rules</p>",
        "id": 153911946,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1506994744
    },
    {
        "content": "<p>Ok! <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13990\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13990\">GF#13990</a>.</p>",
        "id": 153912028,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1507018987
    }
]