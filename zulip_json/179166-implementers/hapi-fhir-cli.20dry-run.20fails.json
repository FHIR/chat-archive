[
    {
        "content": "<p>I'm getting this message:</p>\n<div class=\"codehilite\"><pre><span></span><code>2021-07-01 11:34:50.218 [main] ERROR ca.uhn.fhir.cli.App Error during execution:\norg.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [alter table TRM_CONCEPT_DESIG add constraint FK_CONCEPTDESIG_CSV foreign key (CS_VER_PID) references TRM_CODESYSTEM_VER]; nested exception is java.sql.SQLSyntaxErrorException: ORA-00942: table or view does not exist\n\n        at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)\n        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)\n        at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1541)\n        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)\n        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:431)\n        at ca.uhn.fhir.jpa.migrate.taskdef.AddTableRawSqlTask.lambda$doExecute$2(AddTableRawSqlTask.java:80)\n        at ca.uhn.fhir.jpa.migrate.taskdef.AddTableRawSqlTask$$Lambda$139/0000000038802B70.doInTransaction(Unknown Source)\n        at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)\n        at ca.uhn.fhir.jpa.migrate.taskdef.AddTableRawSqlTask.doExecute(AddTableRawSqlTask.java:76)\n        at ca.uhn.fhir.jpa.migrate.taskdef.BaseTask.execute(BaseTask.java:179)\n        at ca.uhn.fhir.jpa.migrate.TaskOnlyMigrator.migrate(TaskOnlyMigrator.java:59)\n        at ca.uhn.fhir.cli.BaseFlywayMigrateDatabaseCommand.run(BaseFlywayMigrateDatabaseCommand.java:137)\n        at ca.uhn.fhir.cli.HapiFlywayMigrateDatabaseCommand.run(HapiFlywayMigrateDatabaseCommand.java:56)\n        at ca.uhn.fhir.cli.BaseApp.run(BaseApp.java:269)\n        at ca.uhn.fhir.cli.App.main(App.java:43)\nCaused by: java.sql.SQLSyntaxErrorException: ORA-00942: table or view does not exist\n\n        at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:494)\n        at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)\n        at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1054)\n        at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:623)\n        at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:252)\n        at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:612)\n        at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)\n        at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)\n        at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:896)\n        at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1119)\n        at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1737)\n        at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1692)\n        at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)\n        at org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:194)\n        at org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:194)\n        at org.springframework.jdbc.core.JdbcTemplate$1ExecuteStatementCallback.doInStatement(JdbcTemplate.java:422)\n        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)\n        ... 11 common frames omitted\nCaused by: oracle.jdbc.OracleDatabaseException: ORA-00942: table or view does not exist\n\n        at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)\n        ... 27 common frames omitted\n2021-07-01 11:34:50.231 [Thread-3] INFO  ca.uhn.fhir.cli.App HAPI FHIR is shutting down...\n</code></pre></div>\n<p>My database is absolutely empty, and I'm using <code>--dry-run</code> option in order to get sql statements.</p>\n<p>My command is:</p>\n<div class=\"codehilite\"><pre><span></span><code>java -cp hapi-fhir-cli.jar:/home/jeusdi/projects/workarea/salut/mpi/ojdbc8.jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000 ca.uhn.fhir.cli.App migrate-database -d ORACLE_12C -n HES_MPI_TEST_ADM -p hesmpitestadm4des -u jdbc:oracle:thin:@10.49.160.114:1521:ORCLCDB --dry-run\n</code></pre></div>\n<p>Any ideas?</p>",
        "id": 244541578,
        "sender_full_name": "Jordi Cabré",
        "timestamp": 1625132854
    },
    {
        "content": "<p>Currently, I'm getting this other message:</p>\n<div class=\"codehilite\"><pre><span></span><code>2021-07-01 12:04:14.345 [main] INFO  c.u.f.j.m.TaskOnlyMigrator Dry run 4_0_0.20190722.29 Rename column CODE to CODEVAL on table TRM_CONCEPT\n2021-07-01 12:04:14.440 [main] ERROR ca.uhn.fhir.cli.App Error during execution:\nca.uhn.fhir.rest.server.exceptions.InternalErrorException: Can not rename TRM_CONCEPT.CODE to CODEVAL because neither column exists!\n    at ca.uhn.fhir.jpa.migrate.TaskOnlyMigrator.migrate(TaskOnlyMigrator.java:62)\n    at ca.uhn.fhir.cli.BaseFlywayMigrateDatabaseCommand.run(BaseFlywayMigrateDatabaseCommand.java:137)\n    at ca.uhn.fhir.cli.HapiFlywayMigrateDatabaseCommand.run(HapiFlywayMigrateDatabaseCommand.java:56)\n    at ca.uhn.fhir.cli.BaseApp.run(BaseApp.java:269)\n    at ca.uhn.fhir.cli.App.main(App.java:43)\nCaused by: java.sql.SQLException: Can not rename TRM_CONCEPT.CODE to CODEVAL because neither column exists!\n    at ca.uhn.fhir.jpa.migrate.taskdef.RenameColumnTask.doExecute(RenameColumnTask.java:114)\n    at ca.uhn.fhir.jpa.migrate.taskdef.BaseTask.execute(BaseTask.java:179)\n    at ca.uhn.fhir.jpa.migrate.TaskOnlyMigrator.migrate(TaskOnlyMigrator.java:59)\n    ... 4 common frames omitted\n</code></pre></div>",
        "id": 244543450,
        "sender_full_name": "Jordi Cabré",
        "timestamp": 1625133970
    },
    {
        "content": "<p>I've just realized that:<br>\n 1) <code>--dry-run</code> is creating tables on my database <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span> <br>\n 2) Each time I perform my command I'm getting different messages:</p>\n<div class=\"codehilite\"><pre><span></span><code>* `bad SQL grammar [alter table TRM_CONCEPT_MAP add constraint FK_TRMCONCEPTMAP_RES foreign key (RES_ID) references HFJ_RESOURCE]`\n</code></pre></div>\n\n<p>* <code>bad SQL grammar [alter table TRM_CONCEPT_PROPERTY add constraint FK_CONCEPTPROP_CSV foreign key (CS_VER_PID) references TRM_CODESYSTEM_VER];</code><br>\n  * ...</p>",
        "id": 244544208,
        "sender_full_name": "Jordi Cabré",
        "timestamp": 1625134420
    },
    {
        "content": "<p>My goal is to get sql statements scripts... Any idea?</p>",
        "id": 244545569,
        "sender_full_name": "Jordi Cabré",
        "timestamp": 1625135214
    },
    {
        "content": "<p>If that is happening on a HAPI server, you can probably get better responses on the <a class=\"stream\" data-stream-id=\"179167\" href=\"/#narrow/stream/179167-hapi\">#hapi</a> channel...</p>",
        "id": 244577960,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1625150809
    }
]