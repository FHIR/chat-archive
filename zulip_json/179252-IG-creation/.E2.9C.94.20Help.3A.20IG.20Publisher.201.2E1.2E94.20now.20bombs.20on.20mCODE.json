[
    {
        "content": "<p>See <a href=\"http://build.fhir.org/ig/HL7/fhir-mCODE-ig/branches/master/failure/build.log\">http://build.fhir.org/ig/HL7/fhir-mCODE-ig/branches/master/failure/build.log</a> </p>\n<div class=\"codehilite\"><pre><span></span><code>Generating Narratives                                                            (00:49.0675)\nValidating Conformance Resources                                                 (02:44.0674)\nPublishing Content Failed: Error parsing JSON source: Unexpected char &#39;&lt;&#39; in json stream at Line 1 (path=[null]) (02:56.0748)\n                                                                                 (02:56.0748)\nUse -? to get command line help                                                  (02:56.0748)\n                                                                                 (02:56.0748)\nStack Dump (for debugging):                                                      (02:56.0748)\njava.io.IOException: Error parsing JSON source: Unexpected char &#39;&lt;&#39; in json stream at Line 1 (path=[null])\n    at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.error(JsonTrackingParser.java:208)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.next(JsonTrackingParser.java:340)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.start(JsonTrackingParser.java:233)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.&lt;init&gt;(JsonTrackingParser.java:144)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:407)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:403)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:395)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:391)\n    at org.hl7.fhir.utilities.json.JsonTrackingParser.parseJson(JsonTrackingParser.java:371)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:198)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:172)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:99)\n    at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4188)\n    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4117)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:945)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:796)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9031)\n</code></pre></div>",
        "id": 267748397,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1642004822
    },
    {
        "content": "<p>I just debugged this. This is a change of functionality on the HL7 web server - it's suddenly stopped sending conformant http -&gt; https redirects. or something</p>",
        "id": 267751350,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642006043
    },
    {
        "content": "<p>at least, I've instructed the java client to follow redirects, but the content being returned from the java client starts like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;head&gt;&lt;title&gt;Document Moved&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;&lt;h1&gt;Object Moved&lt;/h1&gt;...\n</code></pre></div>",
        "id": 267752080,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642006331
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"371769\">@Eric Schmitt</span> do you know anything about this?</p>",
        "id": 267752271,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642006393
    },
    {
        "content": "<p>No.  What can you tell me?</p>",
        "id": 267752915,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642006645
    },
    {
        "content": "<p>Hi Grahame,  This could be due to our change to redirect to HTTPS if HTTP was used for request.<br>\nWe can roll it back if you like.... but the goal was to always have HTTPS requests site wide.</p>",
        "id": 267753127,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642006729
    },
    {
        "content": "<p>well, it's not working with the Java client. </p>\n<div class=\"codehilite\" data-code-language=\"Java\"><pre><span></span><code>    <span class=\"n\">URL</span> <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"n\">URL</span><span class=\"p\">(</span><span class=\"s\">\"http://hl7.org/fhir/us/core/package-list.json\"</span><span class=\"p\">);</span>\n      <span class=\"n\">HttpURLConnection</span> <span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">HttpURLConnection</span><span class=\"p\">)</span> <span class=\"n\">url</span><span class=\"p\">.</span><span class=\"na\">openConnection</span><span class=\"p\">();</span>\n      <span class=\"n\">c</span><span class=\"p\">.</span><span class=\"na\">setInstanceFollowRedirects</span><span class=\"p\">(</span><span class=\"kc\">true</span><span class=\"p\">);</span>\n      <span class=\"kt\">byte</span><span class=\"o\">[]</span> <span class=\"n\">cnt</span> <span class=\"o\">=</span> <span class=\"n\">TextFile</span><span class=\"p\">.</span><span class=\"na\">streamToBytes</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"p\">.</span><span class=\"na\">getInputStream</span><span class=\"p\">());</span>\n</code></pre></div>\n<p>cnt will contain the XML. But it shouldn't according to <a href=\"https://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html#setInstanceFollowRedirects(boolean)\">https://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html#setInstanceFollowRedirects(boolean)</a></p>",
        "id": 267753508,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642006857
    },
    {
        "content": "<p>I just searched and I have 2.5 million uses of <a href=\"http://hl7.org\">http://hl7.org</a> in the java code base, the vast majority of which are name spaces and shouldn't use https, but some of which are know broken http accesses...</p>",
        "id": 267753629,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642006915
    },
    {
        "content": "<p>Its been very confusing to me since i started that there are some areas of the site not requiring HTTPS and some areas it does...</p>",
        "id": 267753685,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642006925
    },
    {
        "content": "<p>I'm not going to sorting through them manually, that's for sure.</p>",
        "id": 267753707,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642006934
    },
    {
        "content": "<p>right.. Ok.  I just use a global file for my change and it will take 1 second to roll it back</p>",
        "id": 267753758,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642006955
    },
    {
        "content": "<p>so either:</p>\n<ol>\n<li>we don't redirect at all</li>\n<li>we figure out the redirect so that it works with java</li>\n<li>we let users find the broken places for us</li>\n</ol>",
        "id": 267753803,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642006975
    },
    {
        "content": "<p>Sounds like the redirect setup may not be done correctly.</p>",
        "id": 267753806,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1642006977
    },
    {
        "content": "<p>I can roll it back...  and do it at the IIS level.   This was done at the code base level.</p>",
        "id": 267753899,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642007015
    },
    {
        "content": "<p>ok so lets roll it back, and then trouble shoot why it doesn't work with the java client before reapplying it</p>",
        "id": 267753954,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642007039
    },
    {
        "content": "<p>Ok. sounds good.  I definitely want the site HTTPS ...</p>",
        "id": 267754063,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642007069
    },
    {
        "content": "<p>no. it's harder than this: <a href=\"https://stackoverflow.com/questions/1884230/httpurlconnection-doesnt-follow-redirect-from-http-to-https\">https://stackoverflow.com/questions/1884230/httpurlconnection-doesnt-follow-redirect-from-http-to-https</a></p>",
        "id": 267754260,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642007154
    },
    {
        "content": "<p>Deploying rollback now...</p>",
        "id": 267754271,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642007159
    },
    {
        "content": "<p>it's really nice how the java documentation explains that most redirects <em>won't</em> be followed</p>",
        "id": 267754429,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642007210
    },
    {
        "content": "<p>Hmm, I thought</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code><span class=\"nt\">&lt;head&gt;&lt;title&gt;</span>Document Moved<span class=\"nt\">&lt;/title&gt;&lt;/head&gt;</span>\n<span class=\"nt\">&lt;body&gt;&lt;h1&gt;</span>Object Moved<span class=\"nt\">&lt;/h1&gt;</span>...<span class=\"nt\">&lt;/body&gt;</span>\n</code></pre></div>\n<p>indicates that the server is doing something incompletely, but if indeed the redirect is not followed, that could be the cause...</p>",
        "id": 267754776,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1642007356
    },
    {
        "content": "<p>We are back to HTTP</p>",
        "id": 267754924,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642007418
    },
    {
        "content": "<p>yes it's not the server. :-( It's stinking Java.</p>",
        "id": 267754969,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642007439
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"371769\">@Eric Schmitt</span> I'll let you know when I think I've sorted this out and you can reapply the change</p>",
        "id": 267755015,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642007459
    },
    {
        "content": "<p>Ok thanks!  HTTPS baby!</p>",
        "id": 267755106,
        "sender_full_name": "Eric Schmitt",
        "timestamp": 1642007497
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"215604\">Saul Kravitz</span> has marked this topic as resolved.</p>",
        "id": 267776821,
        "sender_full_name": "Notification Bot",
        "timestamp": 1642017091
    }
]