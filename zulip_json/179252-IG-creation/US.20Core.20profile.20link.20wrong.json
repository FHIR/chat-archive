[
    {
        "content": "<p>I have a dependency on the latest version of US Core: </p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;dependsOn id=&quot;hl7fhiruscore&quot;&gt;\n        &lt;uri value=&quot;http://hl7.org/fhir/us/core/ImplementationGuide/hl7.fhir.us.core&quot;/&gt;\n        &lt;packageId value=&quot;hl7.fhir.us.core&quot;/&gt;\n        &lt;version value=&quot;4.0.0&quot;/&gt;\n    &lt;/dependsOn&gt;\n</code></pre></div>\n<p>This is creating links in the profiles that have a US Core base profile that appear to be wrong: <a href=\"http://build.fhir.org/ig/HL7/vr-common-library/StructureDefinition-Patient-mother.html\">http://build.fhir.org/ig/HL7/vr-common-library/StructureDefinition-Patient-mother.html</a> (See the link at \"This structure is derived from USCorePatientProfile).</p>\n<p>Something is setting the link to: <a href=\"http://hl7.org/fhir/us/core/STU4.0.0/StructureDefinition-us-core-patient.html\">http://hl7.org/fhir/us/core/STU4.0.0/StructureDefinition-us-core-patient.html</a> and it looks like the link should be: <a href=\"http://hl7.org/fhir/us/core/STU4/StructureDefinition-us-core-patient.html\">http://hl7.org/fhir/us/core/STU4/StructureDefinition-us-core-patient.html</a>.</p>\n<p>Another thing to note is that the IG Publisher is not picking up that the link is bad...</p>\n<p>Is this something I can fix on my end (I guess I could change the version I'm depending on to current, but I don't think I really want to do that do I?)?</p>",
        "id": 245756294,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626127516
    },
    {
        "content": "<p>Actually will try to set the dependsOn version to just be 4 - not sure that's actually valid in terms of versions though....</p>",
        "id": 245759378,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626129740
    },
    {
        "content": "<p>Unfortunately that doesn't work - crashes with <code>Publishing Content Failed: Unable to find package hl7.fhir.us.core#4</code></p>",
        "id": 245761744,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626131543
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span>  I have created an issue for this here: <a href=\"https://github.com/HL7/fhir-ig-publisher/issues/295\">https://github.com/HL7/fhir-ig-publisher/issues/295</a></p>",
        "id": 245764136,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626133650
    },
    {
        "content": "<p>I erroneously set the package file to <code> http://hl7.org/fhir/us/core/STU4.0.0</code> and Grahame fixed it prior to publishing.   Obviously it had some other consequences because the package file </p>\n<p><code>~/.fhir/packages/hl7.fhir.us.core#4.0.0/package/package.json</code></p>\n<p>has this </p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"nt\">\"name\"</span><span class=\"p\">:</span> <span class=\"s2\">\"hl7.fhir.us.core\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"4.0.0\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"tools-version\"</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"type\"</span><span class=\"p\">:</span> <span class=\"s2\">\"fhir.ig\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"date\"</span><span class=\"p\">:</span> <span class=\"s2\">\"20210628190945\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"license\"</span><span class=\"p\">:</span> <span class=\"s2\">\"CC0-1.0\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"canonical\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"url\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core/STU4.0.0\"</span><span class=\"p\">,</span>\n  <span class=\"err\">...</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 245776447,
        "sender_full_name": "Eric Haas",
        "timestamp": 1626148039
    },
    {
        "content": "<p>you can do a temporary work around this locally by editing this file</p>",
        "id": 245777194,
        "sender_full_name": "Eric Haas",
        "timestamp": 1626149023
    },
    {
        "content": "<p>Ah... Thanks for the intel <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> . We're getting ready to publish a few (3) IGs that depend on US Core, so the local fix won't really help much.</p>",
        "id": 245786015,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626159968
    },
    {
        "content": "<p>sorry for the error causing this delay</p>",
        "id": 245841531,
        "sender_full_name": "Eric Haas",
        "timestamp": 1626189792
    },
    {
        "content": "<p>No delay yet - I'm sure we'll work something out before we publish!</p>",
        "id": 245879009,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626206433
    },
    {
        "content": "<p>sigh. Publishing errors are really pernicious. This is really difficult to fix because the package is released, and wrong.</p>",
        "id": 245880604,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1626207159
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> you can work around this in /org.hl7.fhir.utilities/src/main/java/org/hl7/fhir/utilities/npm/PackageHacker.java in fixPackageUrl</p>",
        "id": 245880844,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1626207267
    },
    {
        "content": "<p>BTW - the IG publisher didn't catch that the links were broken, was just a fluke that I found them. (I've added that to the ticket so hopefully it can be changed to pick them up in the future.)</p>",
        "id": 245884629,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626209021
    },
    {
        "content": "<p>Is this Warning the same issue: [Unable to determine whether the provided codes are in the value set <a href=\"http://hl7.org/fhir/us/core/ValueSet/us-core-vital-signs\">http://hl7.org/fhir/us/core/ValueSet/us-core-vital-signs</a> because the value set or code system is not known to the validator]?</p>\n<p>If you try to go to <a href=\"http://hl7.org/fhir/us/core/ValueSet/us-core-vital-signs\">http://hl7.org/fhir/us/core/ValueSet/us-core-vital-signs</a> it re-directs to: <a href=\"http://hl7.org/fhir/us/core/STU4.0.0/ValueSet-us-core-vital-signs.html\">http://hl7.org/fhir/us/core/STU4.0.0/ValueSet-us-core-vital-signs.html</a>...</p>",
        "id": 245897294,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626215022
    },
    {
        "content": "<p>Hitting the same issue with the SDOH-CC IG.  We have hyperlinks in the CapabilityStatement that are driven by the canonical URL.  The canonical URL is redirecting, but there's nothing at the location it redirects to.</p>",
        "id": 245897381,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1626215083
    },
    {
        "content": "<p>If the vital signs value set re-directed to <a href=\"http://hl7.org/fhir/us/core/STU4/ValueSet-us-core-vital-signs.html\">http://hl7.org/fhir/us/core/STU4/ValueSet-us-core-vital-signs.html</a> it would work, I think.</p>",
        "id": 245897530,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626215184
    },
    {
        "content": "<p>Looking at this now</p>",
        "id": 245961343,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626270352
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191918\">@Sarah Gaunt</span> if I wanted to test this, what would be the quickest way to see if my fix works?</p>",
        "id": 245964303,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626271643
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 245968639,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626273403
    },
    {
        "content": "<p>nm answered my own question</p>",
        "id": 245968672,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626273417
    },
    {
        "content": "<p>I still would like to know how to test it though <span class=\"user-mention\" data-user-id=\"191918\">@Sarah Gaunt</span></p>",
        "id": 245969239,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626273687
    },
    {
        "content": "<p>PR is here: <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/560\">https://github.com/hapifhir/org.hl7.fhir.core/pull/560</a></p>",
        "id": 245969271,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626273710
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span>  Re-build HL7 / vr-common-library from here: <a href=\"https://fhir.github.io/auto-ig-builder/builds.html\">https://fhir.github.io/auto-ig-builder/builds.html</a>, then go to <a href=\"http://build.fhir.org/ig/HL7/vr-common-library/StructureDefinition-Patient-mother.html\">http://build.fhir.org/ig/HL7/vr-common-library/StructureDefinition-Patient-mother.html</a>, find \"This structure is derived from USCorePatientProfile\" and make sure the link works.</p>",
        "id": 246016176,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626294824
    },
    {
        "content": "<p>I'm rebuilding now - not sure if you've fixed or not, but will test...</p>",
        "id": 246016287,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626294870
    },
    {
        "content": "<p>Or I guess, build that IG locally and check same.</p>",
        "id": 246016428,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626294934
    },
    {
        "content": "<p>I did not merge the PR yet</p>",
        "id": 246085163,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626351324
    },
    {
        "content": "<p>I would have to check locally</p>",
        "id": 246085173,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626351334
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"191918\">@Sarah Gaunt</span> can you please try the latest release of the IG-publisher</p>",
        "id": 246457255,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626702752
    },
    {
        "content": "<p><a href=\"https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.77\">https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.77</a></p>",
        "id": 246457257,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626702753
    },
    {
        "content": "<p>let me know if that solves your issue</p>",
        "id": 246457272,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626702760
    },
    {
        "content": "<p>it contains the fix from the core libraries that I put in tlast week</p>",
        "id": 246457289,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626702771
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> I just re-built and still getting the \"4.0.0\" instead of \"4\" in the url: <a href=\"http://hl7.org/fhir/us/core/STU4.0.0/StructureDefinition-us-core-encounter.html\">http://hl7.org/fhir/us/core/STU4.0.0/StructureDefinition-us-core-encounter.html</a>. (see <a href=\"http://build.fhir.org/ig/HL7/fhir-bfdr/branches/master/StructureDefinition-Encounter-birth.html\">http://build.fhir.org/ig/HL7/fhir-bfdr/branches/master/StructureDefinition-Encounter-birth.html</a>).</p>",
        "id": 246501677,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626722823
    },
    {
        "content": "<p>Any further updates on this <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> ?</p>",
        "id": 246730402,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626879101
    },
    {
        "content": "<p>I had a fix in , and I couldn't build because the terminology server was down. Now that it is back working again, I will try and push out the change</p>",
        "id": 246745131,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626885594
    },
    {
        "content": "<p>Sorry for the delay</p>",
        "id": 246745140,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626885599
    },
    {
        "content": "<p>No worries, just didn't want it to fall off the radar! And I didn't actually realize you couldn't build either with the tx server being down...</p>",
        "id": 246763078,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1626893707
    },
    {
        "content": "<p>Okay, so reviewing this again, I'm not sure why this is still not working for you. I released 1.1.77 (<a href=\"https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.77\">https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.77</a>) with the changed from the core (specifically <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/560/files\">https://github.com/hapifhir/org.hl7.fhir.core/pull/560/files</a>).</p>",
        "id": 247012583,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627063691
    },
    {
        "content": "<p>I check for the url fragment </p>\n<div class=\"codehilite\"><pre><span></span><code>    if (webref.contains(&quot;hl7.org/fhir/us/core/STU4.0.0&quot;)) {\n      webref.replace(&quot;hl7.org/fhir/us/core/STU4.0.0&quot;, &quot;hl7.org/fhir/us/core/STU4&quot;);\n    }`\n</code></pre></div>",
        "id": 247012646,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627063734
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> is there any other place other than the PackageHacker that I need to check for this?</p>",
        "id": 247012850,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627063857
    },
    {
        "content": "<p>I the downloaded package file  today and it still has <a href=\"http://hl7.org/fhir/us/core/STU4.0.0\">hl7.org/fhir/us/core/STU4.0.0</a> in package.json:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"s2\">\"name\"</span><span class=\"o\">:</span> <span class=\"s2\">\"hl7.fhir.us.core\"</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"version\"</span><span class=\"o\">:</span> <span class=\"s2\">\"4.0.0\"</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"tools-version\"</span><span class=\"o\">:</span> <span class=\"mf\">3</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"type\"</span><span class=\"o\">:</span> <span class=\"s2\">\"fhir.ig\"</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"date\"</span><span class=\"o\">:</span> <span class=\"s2\">\"20210628190945\"</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"license\"</span><span class=\"o\">:</span> <span class=\"s2\">\"CC0-1.0\"</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"canonical\"</span><span class=\"o\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core\"</span><span class=\"p\">,</span>\n  <span class=\"s2\">\"url\"</span><span class=\"o\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core/STU4.0.0\"</span><span class=\"p\">,</span> <span class=\"c1\">//&lt;&lt;&lt;&lt;&lt;&lt;&lt; still here</span>\n  <span class=\"s2\">\"title\"</span><span class=\"o\">:</span> <span class=\"s2\">\"US Core Implementation Guide\"</span><span class=\"p\">,</span>\n  <span class=\"c1\">//..</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 247017808,
        "sender_full_name": "Eric Haas",
        "timestamp": 1627066628
    },
    {
        "content": "<p>I think that's an <span class=\"user-mention\" data-user-id=\"193599\">@Lynn Laakso</span> issue?</p>",
        "id": 247024323,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627070177
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193599\">@Lynn Laakso</span> can we have a quick call at some point today, if you are available. I have most of the permissions to do commits and publish, I just need clarification on exactly what needs to be done.</p>",
        "id": 247207479,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627308833
    },
    {
        "content": "<p>I would prefer to get this done soon, as I know <span class=\"user-mention\" data-user-id=\"191918\">@Sarah Gaunt</span> has been waiting on this.</p>",
        "id": 247207560,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627308862
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> just back from medical time off, DM me for scheduling</p>",
        "id": 247207599,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1627308884
    },
    {
        "content": "<p>We won't have approval to publish the affected IGs for a couple of weeks (still have to go through FMG and TSC), so it's not a huge rush - just needs to be fixed before we actually publish.</p>",
        "id": 247262044,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1627333374
    },
    {
        "content": "<p>Also - I will re-build again now - I am not sure if you made another change after the terminology server issues.  I haven't tested since then...</p>",
        "id": 247262564,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1627333515
    },
    {
        "content": "<p>Yes, still broken - must be the package.json file that Eric mentioned.</p>",
        "id": 247266729,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1627335209
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> don't want to hassle you too much though I suspect there was no easing back into work for you... Could you take a look at this issue sometime in the near future as we have a few IGs that are being held up from publication because we can't publish with the broken US Core links.</p>",
        "id": 249941446,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1629347897
    },
    {
        "content": "<p>so I thought this was fixed. How to reproduce?</p>",
        "id": 249942340,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629349212
    },
    {
        "content": "<p>Build any IG that bases a profile on a US Core profile. Like here: <a href=\"http://build.fhir.org/ig/HL7/case-reporting/branches/master/StructureDefinition-us-ph-patient.html\">http://build.fhir.org/ig/HL7/case-reporting/branches/master/StructureDefinition-us-ph-patient.html</a><br>\nClick on the link for the US Core Patient and it uses <code>http://hl7.org/fhir/us/core/STU4.0.0/StructureDefinition-us-core-patient.html</code><br>\nIt should be: <code>http://hl7.org/fhir/us/core/STU4/StructureDefinition-us-core-patient.html</code></p>\n<p>It's not just the base profile links either, I think it's anything from US Core - like if you click on the US Core Ethnicity extension link in that same profile I linked above, you'll get the same problem.</p>",
        "id": 249943093,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1629350265
    },
    {
        "content": "<p>And now I'm super confused, because I look at an IG that just went to ballot and it doesn't have the issue: <a href=\"http://hl7.org/fhir/us/cancer-reporting/2021Sep/StructureDefinition-us-pathology-related-practitioner-role.html\">http://hl7.org/fhir/us/cancer-reporting/2021Sep/StructureDefinition-us-pathology-related-practitioner-role.html</a></p>\n<p>So maybe it's something I'm doing wrong?</p>",
        "id": 249943773,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1629351129
    },
    {
        "content": "<p>Though, that same profile in the ci build has the issue, so maybe Lynn etc. manually fixed the issue before ballot... <a href=\"https://build.fhir.org/ig/HL7/cancer-reporting/StructureDefinition-us-pathology-related-practitioner-role.html\">https://build.fhir.org/ig/HL7/cancer-reporting/StructureDefinition-us-pathology-related-practitioner-role.html</a></p>",
        "id": 249944013,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1629351532
    },
    {
        "content": "<p>It was fixed after publication, note the link in cancer-reporting goes to us/core/STU4 but your IG is still picking up a reference to us/core/STU4.0.0. There's somewhere that didn't get fixed.</p>",
        "id": 249979284,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1629376522
    },
    {
        "content": "<p>I just rebuilt the Cancer IG in the CI Build and it's still picking up the 4.0.0 reference - maybe was just fixed for the ballot publications?</p>",
        "id": 250049450,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1629407313
    },
    {
        "content": "<p>fixed next release</p>",
        "id": 250057303,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629412205
    },
    {
        "content": "<p>Do we have an ETA on the next release?</p>",
        "id": 250831185,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1630008053
    },
    {
        "content": "<p>sometime soon. maybe today or tomorrow</p>",
        "id": 250836675,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630010312
    }
]