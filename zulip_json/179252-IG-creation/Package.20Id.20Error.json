[
    {
        "content": "<p>Hi all, <br>\nwhile publishing the IG, getting the below error. Can anyone suggest me how to fix the issue?<br>\n<a href=\"/user_uploads/10155/lgy5w1JIVrN0KpUPm67pv7eN/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/lgy5w1JIVrN0KpUPm67pv7eN/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/lgy5w1JIVrN0KpUPm67pv7eN/image.png\"></a></div>",
        "id": 258224111,
        "sender_full_name": "Mounika",
        "timestamp": 1634660081
    },
    {
        "content": "<p>It looks like maybe you have declared that your IG depends on an a package named <em>JoshSandbox.TestPackage</em> version <em>1.0.1</em> - and the IG Publisher cannot find that dependency.  Do you expect that package to be available in the FHIR registry?</p>",
        "id": 258225345,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1634660480
    },
    {
        "content": "<p>can you tell me how to fix that</p>",
        "id": 258226248,
        "sender_full_name": "Mounika",
        "timestamp": 1634660784
    },
    {
        "content": "<p>do you really want to depend on a package named JoshSandbox?<br>\nIf you don't, then remove that dependency from your IG.</p>",
        "id": 258226660,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1634660945
    },
    {
        "content": "<p>Okay</p>",
        "id": 258227899,
        "sender_full_name": "Mounika",
        "timestamp": 1634661366
    },
    {
        "content": "<p>Thankyou</p>",
        "id": 258227910,
        "sender_full_name": "Mounika",
        "timestamp": 1634661372
    },
    {
        "content": "<p>Hi. I am seeing a similar failure and I am not quite sure how I introduced it. My IG builds with out a dependency to us core, except I get a few unresolved errors. When I add my us core dependency, I get the attached failure. <a href=\"/user_uploads/10155/DrPJroQ2VVIzerbVaHhNbt3a/ig-error.png\">ig-error.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/DrPJroQ2VVIzerbVaHhNbt3a/ig-error.png\" title=\"ig-error.png\"><img src=\"/user_uploads/10155/DrPJroQ2VVIzerbVaHhNbt3a/ig-error.png\"></a></div><p>I am adding the dependency with the following XML in my ig.xml.</p>\n<p>&lt;dependsOn&gt;  <br>\n    &lt;uri value=\"http://hl7.org/fhir/us/core/ImplementationGuide/hl7.fhir.us.core\"/&gt; <br>\n    &lt;version value=\"4.0.0\"/&gt;<br>\n  &lt;/dependsOn&gt; </p>\n<p>If I remove this dependency, the build failure goes away. Any ideas on what I might be doing wrong? Thanks for any insights!</p>\n<p><span class=\"user-mention\" data-user-id=\"396697\">@Richard Braman (FLY.HEALTH)</span>  FYI</p>",
        "id": 260160821,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1635957337
    },
    {
        "content": "<p>you have to look for dependencies in your guide.  in the past, when we've seen this error, it's because a sample dependency was specified.</p>",
        "id": 260163096,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1635958289
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192166\">Jean Duteau</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Package.20Id.20Error/near/260163096\">said</a>:</p>\n<blockquote>\n<p>you have to look for dependencies in your guide.  in the past, when we've seen this error, it's because a sample dependency was specified.</p>\n</blockquote>\n<p>There is only one dependency in this Guide.  Its US Core.  Notably, the build does not fail on my machine.  I think this is something left over in the US Core v4 package.   JoshSandbox may mean something to <span class=\"user-mention\" data-user-id=\"191864\">@Isaac Vetter</span></p>",
        "id": 260286232,
        "sender_full_name": "Richard Braman (FLY.HEALTH)",
        "timestamp": 1636039626
    },
    {
        "content": "<p>there is nothing in US core about JoshSandbox. That's a dependency in your base IG</p>",
        "id": 260316946,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636051805
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Package.20Id.20Error/near/260316946\">said</a>:</p>\n<blockquote>\n<p>there is nothing in US core about JoshSandbox. That's a dependency in your base IG</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191701\">@Matt Jenks</span> do you have some remnant package somewhere?</p>\n<p>Like I said,  I dont get this error when building from the same repo/branch</p>",
        "id": 260318531,
        "sender_full_name": "Richard Braman (FLY.HEALTH)",
        "timestamp": 1636052437
    },
    {
        "content": "<p>the package is probably in your package cache. If you clean your package cache out, you'll probably get the error</p>",
        "id": 260320820,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636053547
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Package.20Id.20Error/near/260320820\">said</a>:</p>\n<blockquote>\n<p>the package is probably in your package cache. If you clean your package cache out, you'll probably get the error</p>\n</blockquote>\n<p>We only have one dependency in the IG: Us Core.  How do you clear the FHIR package cache?  This is blank:<br>\n<a href=\"https://wiki.hl7.org/FHIR_Package_cache\">https://wiki.hl7.org/FHIR_Package_cache</a></p>",
        "id": 260321785,
        "sender_full_name": "Richard Braman (FLY.HEALTH)",
        "timestamp": 1636054055
    },
    {
        "content": "<p><a href=\"https://confluence.hl7.org/display/FHIR/FHIR+Package+Cache\\\">https://confluence.hl7.org/display/FHIR/FHIR+Package+Cache\\</a></p>",
        "id": 260321997,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636054175
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Package.20Id.20Error/near/260320820\">said</a>:</p>\n<blockquote>\n<p>the package is probably in your package cache. If you clean your package cache out, you'll probably get the error</p>\n</blockquote>\n<p>I cleared my cache, and now I get the error as well.  We have no dependency in this IG, nor have we ever heard of, JoshSandbox.<br>\nthe only dependency in the IG is:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &lt;dependsOn&gt;\n    &lt;uri value=&quot;http://hl7.org/fhir/us/core/ImplementationGuide/hl7.fhir.us.core&quot;/&gt;\n    &lt;version value=&quot;4.0.0&quot;/&gt;\n  &lt;/dependsOn&gt;\n</code></pre></div>\n<p>Please advise.</p>",
        "id": 260323746,
        "sender_full_name": "Richard Braman (FLY.HEALTH)",
        "timestamp": 1636054954
    },
    {
        "content": "<p>can I reproduce this?</p>",
        "id": 260324007,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636055071
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  We would definitely appreciate your help. I'm on mac and I have cleared my cache as well and I still see it. I've invited you through Github to our private repo. Thanks</p>",
        "id": 260324929,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636055536
    },
    {
        "content": "<p>There is one nugget I see in the build log (not sure what it means)</p>\n<div class=\"codehilite\"><pre><span></span><code>Dependency &#39;http://hl7.org/fhir/us/core/ImplementationGuide/hl7.fhir.us.core&#39; has no id, so can&#39;t be referred to in markdown in the IG (00:54.0720)\n</code></pre></div>",
        "id": 260325044,
        "sender_full_name": "Richard Braman (FLY.HEALTH)",
        "timestamp": 1636055594
    },
    {
        "content": "<p>I also notice that the uscore package is not in my package cache</p>",
        "id": 260325182,
        "sender_full_name": "Richard Braman (FLY.HEALTH)",
        "timestamp": 1636055653
    },
    {
        "content": "<p>well, that built fine for me. Which I expected.</p>",
        "id": 260325341,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636055740
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"396697\">@Richard Braman (FLY.HEALTH)</span> Yeah, I think that package id refers to the npm package id. Which we should add.</p>",
        "id": 260325369,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636055754
    },
    {
        "content": "<p>you only need an id if you're doing to do funky stuff in the html templates</p>",
        "id": 260325449,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636055778
    },
    {
        "content": "<p>it's not the same as the packageId which you can have instead of or was well as the canonical</p>",
        "id": 260325512,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636055807
    },
    {
        "content": "<p>so it does build correctly. What's your package cache local folder name?</p>",
        "id": 260325636,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636055871
    },
    {
        "content": "<p>and it doesn't have any dependency on us-core as I got it, so you won't have that in your cache</p>",
        "id": 260325700,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636055890
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Try either the development or the fix/fhirfly branches. That's where I see the problem.</p>",
        "id": 260326212,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636056101
    },
    {
        "content": "<p>I found a package cache in ~/.fhir. I don't see one in /var/lib</p>",
        "id": 260326407,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636056180
    },
    {
        "content": "<p>ok do you see anything else in ~/.fhir?</p>",
        "id": 260326471,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636056215
    },
    {
        "content": "<p>package-client and packages directories <a href=\"/user_uploads/10155/YtYczgotZjjMXl1uFDnoG29P/package-cache.txt\">package-cache.txt</a></p>",
        "id": 260326579,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636056248
    },
    {
        "content": "<p>well, both those branches build fine for me. So .zip up the package-client folder and send it to me somehow</p>",
        "id": 260326884,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636056367
    },
    {
        "content": "<p>oh no wait, I just reproduced it</p>",
        "id": 260327046,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636056455
    },
    {
        "content": "<p>well, this is interesting. What's totally mystifying is why you get this and others don't.</p>",
        "id": 260329856,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636057741
    },
    {
        "content": "<p>I agree it is mystifying. I guess we are just lucky!</p>",
        "id": 260329905,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636057770
    },
    {
        "content": "<p>so I'm going to explain because I'm not sure how to solve the underlying technical problem. <span class=\"user-mention\" data-user-id=\"191701\">@Matt Jenks</span> you can work around it easily by adding an explicit packageId in your dependency</p>",
        "id": 260329934,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636057785
    },
    {
        "content": "<p>the way you refer to a dependency in an IG is</p>",
        "id": 260330066,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636057838
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/cDPAIFlKkqZDM-04uHYUgWCu/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/cDPAIFlKkqZDM-04uHYUgWCu/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/cDPAIFlKkqZDM-04uHYUgWCu/image.png\"></a></div>",
        "id": 260330067,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636057839
    },
    {
        "content": "<p>you can provide either a packageId, or a URI.</p>",
        "id": 260330110,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636057863
    },
    {
        "content": "<p>So add the packageId for my us core dependency?</p>",
        "id": 260330183,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636057889
    },
    {
        "content": "<p>internally, all the tools are packageId based. So if you provide a URL and not a packageId, the first thing the tool has to do is convert the URL to a packageId.</p>",
        "id": 260330295,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636057932
    },
    {
        "content": "<p>and this is done by </p>\n<ol>\n<li>looking through the existing packages to see if there's a match to the canonical URL in the package info</li>\n<li>if that fails, going and consulting <a href=\"http://packages.fhir.org\">packages.fhir.org</a></li>\n<li>if that fails, looking through the ci-build information (should only be for things not yet published)</li>\n<li>if that fails, then the user gets an error</li>\n</ol>",
        "id": 260330459,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058007
    },
    {
        "content": "<p>the package info looks like this:</p>",
        "id": 260330483,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058019
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"nt\">\"name\"</span><span class=\"p\">:</span> <span class=\"s2\">\"hl7.fhir.us.core\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"4.0.0\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"tools-version\"</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"type\"</span><span class=\"p\">:</span> <span class=\"s2\">\"fhir.ig\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"date\"</span><span class=\"p\">:</span> <span class=\"s2\">\"20210628190945\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"license\"</span><span class=\"p\">:</span> <span class=\"s2\">\"CC0-1.0\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"canonical\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"url\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core/STU4.0.0\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"title\"</span><span class=\"p\">:</span> <span class=\"s2\">\"US Core Implementation Guide\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"description\"</span><span class=\"p\">:</span> <span class=\"s2\">\"The US Core Implementation Guide is based on FHIR Version R4 and defines the minimum conformance requirements for accessing patient data. The Argonaut pilot implementations, ONC 2015 Edition Common Clinical Data Set (CCDS), and ONC U.S. Core Data for Interoperability (USCDI) v1 provided the requirements for this guide. The prior Argonaut search and vocabulary requirements, based on FHIR DSTU2, are updated in this guide to support FHIR Version R4. This guide was used as the basis for further testing and guidance by the Argonaut Project Team to provide additional content and guidance specific to Data Query Access for purpose of ONC Certification testing. These profiles are the foundation for future US Realm FHIR implementation guides. In addition to Argonaut, they are used by DAF-Research, QI-Core, and CIMI. Under the guidance of HL7 and the HL7 US Realm Steering Committee, the content will expand in future versions to meet the needs specific to the US Realm.\\nThese requirements were originally developed, balloted, and published in FHIR DSTU2 as part of the Office of the National Coordinator for Health Information Technology (ONC) sponsored Data Access Framework (DAF) project. For more information on how DAF became US Core see the US Core change notes. (built Mon, Jun 28, 2021 19:09+0000+00:00)\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"fhirVersions\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"s2\">\"4.0.1\"</span>\n  <span class=\"p\">],</span>\n  <span class=\"nt\">\"dependencies\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"hl7.fhir.r4.core\"</span><span class=\"p\">:</span> <span class=\"s2\">\"4.0.1\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"hl7.fhir.uv.bulkdata\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1.0.1\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"us.nlm.vsac\"</span><span class=\"p\">:</span> <span class=\"s2\">\"0.3.0\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"author\"</span><span class=\"p\">:</span> <span class=\"s2\">\"HL7 International - US Realm Steering Committee\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"maintainers\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">\"name\"</span><span class=\"p\">:</span> <span class=\"s2\">\"HL7 International - US Realm Steering Committee\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"url\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://www.hl7.org/Special/committees/usrealm/index.cfm\"</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">],</span>\n  <span class=\"nt\">\"directories\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"lib\"</span><span class=\"p\">:</span> <span class=\"s2\">\"package\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"example\"</span><span class=\"p\">:</span> <span class=\"s2\">\"example\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"jurisdiction\"</span><span class=\"p\">:</span> <span class=\"s2\">\"urn:iso:std:iso:3166#US\"</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 260330597,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058065
    },
    {
        "content": "<p>so it matches on the canonical URL here</p>",
        "id": 260330620,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058078
    },
    {
        "content": "<p>if consulting <a href=\"http://packages.fhir.org\">packages.fhir.org</a>, then it does</p>",
        "id": 260330652,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058095
    },
    {
        "content": "<p><a href=\"http://packages.fhir.org/catalog?canonical=http://hl7.org/fhir/us/core\">http://packages.fhir.org/catalog?canonical=http://hl7.org/fhir/us/core</a></p>",
        "id": 260330662,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058102
    },
    {
        "content": "<p>and this is where it falls over</p>",
        "id": 260330678,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058111
    },
    {
        "content": "<p>I didn't read the api spec carefully enough. I assumed that ?canonical=url would search for the package.json canonical. But no:</p>\n<blockquote>\n<p>With the canonical parameter, you can search for any package that contains a resource that has the canonical url of the given value. The canonical needs to be an exact match. The search does not support partial matching.</p>\n</blockquote>",
        "id": 260330747,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058152
    },
    {
        "content": "<p>so... there's no way for me to use <a href=\"http://packages.fhir.org\">packages.fhir.org</a> to determine a packageId for a given canonical URL at this time. <span class=\"user-mention\" data-user-id=\"191335\">@Martijn Harthoorn</span> / <span class=\"user-mention\" data-user-id=\"259036\">@Matthijs van der Wielen</span>  that's a pretty fatal error from my perspective</p>",
        "id": 260330921,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058228
    },
    {
        "content": "<p>and because of that, and not properly understanding how much trouble I was in, I defaulted to the first returned package from the search above. Hence, JoshSandbox.</p>",
        "id": 260330993,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058273
    },
    {
        "content": "<p>so I know what the problem is, but I can't fix it.</p>",
        "id": 260331068,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636058292
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"396697\">@Richard Braman (FLY.HEALTH)</span>  The development branch is now building for me. Would you give it a try? <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Thanks for the help!!</p>",
        "id": 260332895,
        "sender_full_name": "Matt Jenks",
        "timestamp": 1636059128
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , interesting confusion. But I think being able to search for a package canonical is valuable thing to add.</p>",
        "id": 260375860,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1636100024
    },
    {
        "content": "<p>So our team will work on this today to allow searching for package canonical.</p>",
        "id": 260377572,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1636101447
    },
    {
        "content": "<p>Have you tried:<br>\n<a href=\"http://packages.simplifier.net/catalog?pkgcanonical=http://hl7.org/fhir\">http://packages.simplifier.net/catalog?pkgcanonical=http://hl7.org/fhir</a><br>\n<span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 260418116,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1636125062
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 260418176,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1636125091
    },
    {
        "content": "<p>yes that's what I would expect - but looks great, thanks</p>",
        "id": 260447945,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1636137996
    }
]