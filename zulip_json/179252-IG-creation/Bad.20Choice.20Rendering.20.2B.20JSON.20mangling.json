[
    {
        "content": "<p>In my 3.0.1-based IG, profiles on Observation suffer from a poorly rendered <code>basedOn</code> choice in the <code>Snapshot</code> table. See:</p>\n<p><a href=\"/user_uploads/10155/m1q21Tn4fm4XD2BU1FmQxxTi/bad_choice.png\" target=\"_blank\" title=\"bad_choice.png\">bad_choice.png</a> </p>\n<p>In the profile.json I send to the IG publisher, the basedOn type looks about right (as best I can tell):</p>\n<div class=\"codehilite\"><pre><span></span>&quot;type&quot;: [\n          {\n            &quot;code&quot;: &quot;Reference&quot;,\n            &quot;targetProfile&quot;: &quot;http://hl7.org/fhir/StructureDefinition/CarePlan&quot;\n          },\n          {\n            &quot;code&quot;: &quot;Reference&quot;,\n            &quot;targetProfile&quot;: &quot;http://hl7.org/fhir/StructureDefinition/DeviceRequest&quot;\n          },\n         // etc\n],\n</pre></div>\n\n\n<p>But if I download the profile.json from the IG-produced profile page, it looks like the IG publisher lost all my <code>targetProfile</code>s!</p>\n<div class=\"codehilite\"><pre><span></span>&quot;type&quot;: [\n          {\n            &quot;code&quot;: &quot;Reference&quot;\n          },\n          {\n            &quot;code&quot;: &quot;Reference&quot;\n          },\n          // etc\n],\n</pre></div>\n\n\n<p>For an example, see the Snapshot Table here: <a href=\"http://build.fhir.org/ig/HL7/us-breastcancer/StructureDefinition-oncology-HER2byISH.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/us-breastcancer/StructureDefinition-oncology-HER2byISH.html\">http://build.fhir.org/ig/HL7/us-breastcancer/StructureDefinition-oncology-HER2byISH.html</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/m1q21Tn4fm4XD2BU1FmQxxTi/bad_choice.png\" target=\"_blank\" title=\"bad_choice.png\"><img src=\"/user_uploads/10155/m1q21Tn4fm4XD2BU1FmQxxTi/bad_choice.png\"></a></div>",
        "id": 153947451,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521773407
    },
    {
        "content": "<p>hmm. I thought I had found all those plaecs</p>",
        "id": 153947453,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1521773524
    },
    {
        "content": "<p>code seems to have fallen out; wait for this build and try again</p>",
        "id": 153947454,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1521773719
    },
    {
        "content": "<p>So... I just rebuilt on the auto-build, which I think uses the latest available igpublisher.jar.  Now I see the bars (i.e., <code>|</code>) between each choice item, but it's still not wrapping between any -- so we get a super long horizontal list.  In addition, when I download the JSON, it still looks like the <code>targetProfile</code> is stripped from each object in the <code>type</code>.</p>",
        "id": 153947486,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521809331
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/RlcBAqr8GnCB3rEeWsQRKJNH/bad_choice_2.png\" target=\"_blank\" title=\"bad_choice_2.png\">bad_choice_2.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/RlcBAqr8GnCB3rEeWsQRKJNH/bad_choice_2.png\" target=\"_blank\" title=\"bad_choice_2.png\"><img src=\"/user_uploads/10155/RlcBAqr8GnCB3rEeWsQRKJNH/bad_choice_2.png\"></a></div>",
        "id": 153947487,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521809415
    },
    {
        "content": "<p>I also just noticed that there is a trailing <code>|</code> at the end of the list of choices in the HTML rendering...</p>",
        "id": 153947488,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521809453
    },
    {
        "content": "<p>Looking at the page source, I see that there are no spaces between the links and the bars (<code>|</code>) -- and that there is a missing bar between the first two choices and an extra bar at the end:</p>",
        "id": 153947515,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521818376
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>Reference&lt;/a&gt;(&lt;a href=&quot;http://hl7.org/fhir/STU3/careplan.html&quot;&gt;CarePlan&lt;/a&gt;&lt;a href=&quot;http://hl7.org/fhir/STU3/devicerequest.html&quot;&gt;DeviceRequest&lt;/a&gt;|&lt;a href=&quot;http://hl7.org/fhir/STU3/immunizationrecommendation.html&quot;&gt;ImmunizationRecommendation&lt;/a&gt;|&lt;a href=&quot;http://hl7.org/fhir/STU3/medicationrequest.html&quot;&gt;MedicationRequest&lt;/a&gt;|&lt;a href=&quot;http://hl7.org/fhir/STU3/nutritionorder.html&quot;&gt;NutritionOrder&lt;/a&gt;|&lt;a href=&quot;http://hl7.org/fhir/STU3/procedurerequest.html&quot;&gt;ProcedureRequest&lt;/a&gt;|&lt;a href=&quot;http://hl7.org/fhir/STU3/referralrequest.html&quot;&gt;ReferralRequest&lt;/a&gt;|)\n</pre></div>",
        "id": 153947516,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521818387
    },
    {
        "content": "<p>Instead, this needs to be:</p>",
        "id": 153947517,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521818413
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>Reference&lt;/a&gt;(&lt;a href=&quot;http://hl7.org/fhir/STU3/careplan.html&quot;&gt;CarePlan&lt;/a&gt; | &lt;a href=&quot;http://hl7.org/fhir/STU3/devicerequest.html&quot;&gt;DeviceRequest&lt;/a&gt; | &lt;a href=&quot;http://hl7.org/fhir/STU3/immunizationrecommendation.html&quot;&gt;ImmunizationRecommendation&lt;/a&gt; | &lt;a href=&quot;http://hl7.org/fhir/STU3/medicationrequest.html&quot;&gt;MedicationRequest&lt;/a&gt; | &lt;a href=&quot;http://hl7.org/fhir/STU3/nutritionorder.html&quot;&gt;NutritionOrder&lt;/a&gt; | &lt;a href=&quot;http://hl7.org/fhir/STU3/procedurerequest.html&quot;&gt;ProcedureRequest&lt;/a&gt; | &lt;a href=&quot;http://hl7.org/fhir/STU3/referralrequest.html&quot;&gt;ReferralRequest&lt;/a&gt;)\n</pre></div>",
        "id": 153947518,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521818461
    },
    {
        "content": "<p>The spaces on each side of the <code>|</code> allow the choice types to wrap -- and I've confirmed that fixes the display issue.</p>",
        "id": 153947519,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521818509
    },
    {
        "content": "<p>Now as for why the <code>targetProfile</code> is stripped from the exported JSON, I don't know -- nor do I know if it's at all related to this.</p>",
        "id": 153947520,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521818544
    },
    {
        "content": "<p>which json is stripped from?</p>",
        "id": 153947558,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1521833049
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> See <code>Observation:oncology-HER2byISH.basedOn</code> element here: <a href=\"http://build.fhir.org/ig/HL7/us-breastcancer/StructureDefinition-oncology-HER2byISH.json.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/us-breastcancer/StructureDefinition-oncology-HER2byISH.json.html\">http://build.fhir.org/ig/HL7/us-breastcancer/StructureDefinition-oncology-HER2byISH.json.html</a></p>\n<p>Now for comparison, look at the JSON structure definition I provided to the IG Publisher in the source: <a href=\"https://github.com/HL7/us-breastcancer/blob/master/resources/structuredefinition-oncology-HER2byISH.json#L490-L551\" target=\"_blank\" title=\"https://github.com/HL7/us-breastcancer/blob/master/resources/structuredefinition-oncology-HER2byISH.json#L490-L551\">https://github.com/HL7/us-breastcancer/blob/master/resources/structuredefinition-oncology-HER2byISH.json#L490-L551</a></p>",
        "id": 153947570,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521834133
    },
    {
        "content": "<p>fixed</p>",
        "id": 153947575,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1521836073
    },
    {
        "content": "<p>The rendering looks much better.  Thanks, <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>!  There still seems to be an issue w/ the JSON / XML output, but it's a different issue now.  I'll make a new thread for that.</p>",
        "id": 153947612,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1521869203
    }
]