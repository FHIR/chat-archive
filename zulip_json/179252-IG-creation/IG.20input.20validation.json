[
    {
        "content": "<p>One idea to quickly catch some errors in the IG input: we could define StructureDefs on the ImplementationGuide resource, for a few constraints:</p>\n<ol>\n<li>base : all the necessary parameters for the publisher and template to be able to work</li>\n<li>hl7: all the additional constraints for the HL7 templates to work<br>\n(3. same for IHE but that was on another thread)</li>\n</ol>",
        "id": 197746885,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589573537
    },
    {
        "content": "<p>We could possibly have template pass parameters to the IGPublisher that indicate profiles to use for validating specific types of artifacts on load.  Not sure how feasible that is though.  Thoughts <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>?</p>",
        "id": 197747225,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1589573749
    },
    {
        "content": "<p>(We could ask the build script to call the validator but that would mean adding a command-line option)</p>",
        "id": 197747537,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589573937
    },
    {
        "content": "<p>The validator has a commandline option.  The bigger issue is that launching the validator is slow - and we'd want to use different profiles for different artifacts, which would mean launching it multiple times and probably adding a few minutes or more to the overall build</p>",
        "id": 197748566,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1589574470
    },
    {
        "content": "<p>sorry, I meant adding a command-line option to the Publisher - we don't want to have 2 large jars if 1 could do it</p>",
        "id": 197749324,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589574928
    },
    {
        "content": "<p>I admit to not understanding what the point of this is.</p>",
        "id": 197749429,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589574982
    },
    {
        "content": "<p>This would be a sanity check so I think it would save time - and we could make it an option so we can turn it off.</p>",
        "id": 197749478,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589575025
    },
    {
        "content": "<p>the template should check any input parameters it depends on. And the publisher already checks everything it needs up front</p>",
        "id": 197749529,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589575065
    },
    {
        "content": "<p>yes, each template should check those parameters. <br>\nThis could be done with xslt - which is what happens now, and the output is somewhere in the console output. <br>\nOR we could validate the source against a profile - which is an available functionality in the validator.</p>",
        "id": 197749768,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589575207
    },
    {
        "content": "<p>doing it with a profile allows ups to maintain the rules separately from the xslt. Depending on who we ask, maintaining a structureDef is easier to maintain than xslt.</p>",
        "id": 197749867,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589575290
    },
    {
        "content": "<p>and then produce output in qa.html?</p>",
        "id": 197749875,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589575291
    },
    {
        "content": "<p>i was not thinking of producing qa, but could be - depends on what the validator can do</p>",
        "id": 197749913,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1589575318
    },
    {
        "content": "<p>I see an error that may relate to this:<br>\nValidation_VAL_Profile_Minimum <br>\nProfile <a href=\"http://hl7.org/fhir/StructureDefinition/ImplementationGuide\">http://hl7.org/fhir/StructureDefinition/ImplementationGuide</a>, Element 'ImplementationGuide.definition.resource': minimum required = 1, but only found 0</p>",
        "id": 207346694,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1597787395
    },
    {
        "content": "<ol>\n<li>is this using the validator mechanism?</li>\n<li>if so, can we tell it to validate another profile, e.g. <a href=\"http://profiles.ihe.net/fhir/StructureDefinition/ihe-implementationguide\">profiles.ihe.net/fhir/StructureDefinition/ihe-implementationguide</a> ?</li>\n</ol>",
        "id": 207346901,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1597787535
    },
    {
        "content": "<p>I don't follow either question</p>",
        "id": 207346928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597787560
    },
    {
        "content": "<p>say in IHE we want to have constraints on the input IG, like \"contact[0] must be a url for ihe,  contact[1] must be a url for the ihe domain,  contact[2] must be an email...\"</p>",
        "id": 207347122,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1597787709
    },
    {
        "content": "<p>if we define those constraints in a structuredef, can we tell publisher to validate the ig.xml against that structuredef (instead of against the core <a href=\"http://hl7.org/fhir/structuredefinition/implementationguide\">hl7.org/fhir/structuredefinition/implementationguide</a>)?</p>",
        "id": 207347218,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1597787767
    },
    {
        "content": "<p>I'm not requesting this feature, i'm just asking if the code that gives me that error could allow that.</p>",
        "id": 207347335,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1597787863
    },
    {
        "content": "<p>if it is feasible/sensible, then I will create an issue in the github repo.</p>",
        "id": 207347414,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1597787902
    },
    {
        "content": "<p>I'm not sure about this. The IG itself is the master definition. It can invoke the profile on itself in ImplementationGuide.meta.profile. But since it's the master, where else can you impose a rule like that?</p>",
        "id": 207348536,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597788818
    }
]