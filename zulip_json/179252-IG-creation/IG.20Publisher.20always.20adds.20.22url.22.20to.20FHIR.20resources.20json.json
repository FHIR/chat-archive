[
    {
        "content": "<p>I am creating a profile based on SDC adaptive questionnaire profile which prohibits/removes \"url\" on a Questionnaire. When I create the FSH file for an instance of the profile I create, FHIR shorthand handles it correctly without adding \"url\" when generating the  Questionnaire json file. However, when I run IG publisher, the publisher automatically adds \"url\" and other data elements to the Json file of the Questionnaire. The qa.html complains with the following error: Questionnaire.url: max allowed = 0, but found 1.  I am wondering if this is a known issue. Is there a workaround? Thanks in advance.</p>",
        "id": 269185240,
        "sender_full_name": "Yolanda",
        "timestamp": 1643065298
    },
    {
        "content": "<p>This sounds like a publisher issue.  You'll have to submit a Git issue against the publisher.  (That said, SDC examples didn't seem to have a problem, so not sure why yours would...)</p>",
        "id": 269192914,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643070905
    },
    {
        "content": "<p>Yolanda asked me about this first and I suggested she post here.  When she asked me, I created this simple project that reproduces the issue: <a href=\"/user_uploads/10155/ndDS6Qp9HngufwZGsELaFRi8/QuestionnaireUrlBug.zip\">QuestionnaireUrlBug.zip</a>.  If you run it through the IG Publisher, you can see that the <code>Questionnaire-MyAdaptiveQuestionnaire.json</code> generated by SUSHI in <code>fsh-generated</code> does <em>not</em> have <code>url</code> specified.  The <code>Questionnaire-MyAdaptiveQuestionnaire.json</code> generated by the IG Publisher in <code>output</code> <em>does</em> have <code>url</code> specified (which then causes a QA error).</p>",
        "id": 269260287,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643119289
    },
    {
        "content": "<p>Thank you both Lloyd and Chris. Will open a JIRA ticket for this issue.</p>",
        "id": 269264119,
        "sender_full_name": "Yolanda",
        "timestamp": 1643120961
    },
    {
        "content": "<p>The question is why it's added when generating using SUSHI, but not in the SDC IG itself.</p>",
        "id": 269293196,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643132147
    },
    {
        "content": "<p>Does the SDC have any example of an adaptive questionnaire? I don't find one</p>",
        "id": 269300286,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643134887
    },
    {
        "content": "<p>from what I see, the publisher is always adding a URL to the questionnaire</p>",
        "id": 269300335,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643134917
    },
    {
        "content": "<p>Here is the example QuestionnaireResponse which contains an adaptive questionnaire and the questionnaire doesn't have the \"url\" property: <a href=\"https://build.fhir.org/ig/HL7/sdc/QuestionnaireResponse-adaptive-questionnaireresponse-sdc-example-phq9.json.html\">https://build.fhir.org/ig/HL7/sdc/QuestionnaireResponse-adaptive-questionnaireresponse-sdc-example-phq9.json.html</a></p>",
        "id": 269302897,
        "sender_full_name": "Yolanda",
        "timestamp": 1643135926
    },
    {
        "content": "<p>Created the issue:  <a href=\"https://github.com/HL7/fhir-ig-publisher/issues/381\">https://github.com/HL7/fhir-ig-publisher/issues/381</a></p>",
        "id": 269302967,
        "sender_full_name": "Yolanda",
        "timestamp": 1643135953
    },
    {
        "content": "<p>I'm lost</p>",
        "id": 269307186,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643137564
    },
    {
        "content": "<p>Questionnaire or QuestionnaireResponse?</p>",
        "id": 269307202,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643137571
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> -- I think she's referring to the <em>contained</em> Questionnaire in the QuestionnaireResponse.</p>",
        "id": 269314345,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643140440
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - It has nothing to do with SUSHI.  Here is another example project that does not use SUSHI at all.  The adaptive questionnaire in <code>input/resources</code> has no <code>url</code> property, but the IG Publisher adds one when it generates the same questionnaire to <code>ouput</code>.  Example: <a href=\"/user_uploads/10155/CL8OxHxR1e6s_DjRbae6bcQK/QuestionnaireUrlBugNoSUSHI.zip\">QuestionnaireUrlBugNoSUSHI.zip</a></p>",
        "id": 269315406,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643140867
    },
    {
        "content": "<p>I don't know what's going on.  SDC seems to be publishing fine: <a href=\"https://build.fhir.org/ig/HL7/sdc/QuestionnaireResponse-adaptive-questionnaireresponse-sdc-example-phq9.xml.html\">https://build.fhir.org/ig/HL7/sdc/QuestionnaireResponse-adaptive-questionnaireresponse-sdc-example-phq9.xml.html</a></p>",
        "id": 269318595,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643142287
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> -- that's a QuestionnaireResponse.  It does have an AdaptiveQuestionnaire in its contained array, but I wouldn't be surprised if the IG Publisher doesn't process contained resources the same way it processes standalone resources.  That's what I suspect is the difference here.</p>",
        "id": 269333731,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643149100
    },
    {
        "content": "<p>The only place that the URL is prohibited is in the contained Questionnaire.  You still need a URL in the stand-alone Questionnaire that says \"Hi, I'm adaptive\".</p>",
        "id": 269338990,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643151970
    },
    {
        "content": "<p>The profile for searchable adaptive forms absolutely expects the URL to be there.</p>",
        "id": 269339030,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643151998
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - Maybe I don't understand how adaptive questionnaires work (sorry).  I'm not that familiar with SDC; just trying to understand what is going on here.</p>\n<p>The SDC IG has an <a href=\"https://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-questionnaire-adapt.html\">Adaptive Questionnaire Profile</a>.  That profile prohibits <code>url</code> (using <code>0..0</code>).  Are you saying that this profile should <em>only</em> be used for contained Questionnaires?  That it's actually <em>incorrect</em> to have a standalone instance of an <code>Adaptive Questionnaire</code>?</p>",
        "id": 269410200,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643203869
    },
    {
        "content": "<p>Correct on both counts.  The \"Adaptive Questionnaire\" is always contained (and is allowed to have items).  The \"Adaptive Questionnaire - Search\" is the stand-alone one (and generally shouldn't have items).</p>",
        "id": 269425890,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643209671
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - OK, then I think that helps to clear things up.  Thanks for patiently walking us through this!  Is this documented somewhere in the guide?  I know I reviewed the AdaptiveQuestionnaire profile page and I don't think it said anywhere that it is only to be used in <code>contained</code>.  I expect maybe it is documented in a different part of the guide?</p>\n<p><span class=\"user-mention\" data-user-id=\"257118\">@Yolanda</span>, what is your use case for creating a standalone instance of an AdaptiveQuestionnaire?  If you just need to create it so you can put it into the <code>contained</code> of a QuestionnaireResponse, then use <code>Usage: #inline</code> in your SUSHI definition of the AdaptiveQuestionnaire instance.  This will tell SUSHI <em>not</em> to create a standalone instance of it.</p>",
        "id": 269428315,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643210574
    },
    {
        "content": "<p>DTR is creating a profile which extends the adaptive questionnaire profile from SDC. In this case, we need to create an example of the new profile in the IG.</p>",
        "id": 269434649,
        "sender_full_name": "Yolanda",
        "timestamp": 1643212802
    },
    {
        "content": "<p>If there is a profile in the IG, it is expecting an example/instance for the profile. Otherwise, qa reprt would complain. Is there a way to get around that.</p>",
        "id": 269454704,
        "sender_full_name": "Yolanda",
        "timestamp": 1643220111
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"257118\">@Yolanda</span> -- you can tell the IG Publisher to ignore that warning.  This is actually exactly what the SDC project does.  See the last 2 lines in SDC's <a href=\"https://github.com/HL7/sdc/blob/master/input/ignoreWarnings.txt\">input/ignoreWarnings.txt</a> file:</p>\n<div class=\"codehilite\"><pre><span></span><code># This is a contained adaptive Questionnaire in QuestionnaireReponse profile, so ignoring this warning\nWARNING: StructureDefinition.where(url = &#39;http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-adapt&#39;): The Implementation Guide contains no examples for this profile\n</code></pre></div>",
        "id": 269459017,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643221817
    },
    {
        "content": "<p>oh, I see. Great, will do that. Thanks Chris.</p>",
        "id": 269459958,
        "sender_full_name": "Yolanda",
        "timestamp": 1643222214
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I added the adaptive questionnaire as contained resource to the QuestionnaireResponse. FSH is not generating the resource as the Questionnaire is \"inline\". But the QA report is complaining about the JSON can't be resolved for the inline Questionnaire. Any thoughts?  Thanks. Here is the QA report warnings: <a href=\"https://build.fhir.org/ig/HL7/davinci-dtr/qa.html\">https://build.fhir.org/ig/HL7/davinci-dtr/qa.html</a></p>",
        "id": 271901265,
        "sender_full_name": "Yolanda",
        "timestamp": 1644879171
    },
    {
        "content": "<p>where's the complaint?</p>",
        "id": 271901646,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644879408
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - I think it is these two: <a href=\"/user_uploads/10155/d9tv2o60TkFfbaSXrM0dBOzb/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/d9tv2o60TkFfbaSXrM0dBOzb/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/d9tv2o60TkFfbaSXrM0dBOzb/image.png\"></a></div>",
        "id": 271902019,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1644879642
    },
    {
        "content": "<p>Those appear to be pages that are supposed to represent the Questionnaire that was inlined as a contained resource in the example QuestionnaireResponse here: <a href=\"https://build.fhir.org/ig/HL7/davinci-dtr/QuestionnaireResponse-home-o2-sdc-adaptive-questionnaireresponse.json\">https://build.fhir.org/ig/HL7/davinci-dtr/QuestionnaireResponse-home-o2-sdc-adaptive-questionnaireresponse.json</a></p>",
        "id": 271902120,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1644879710
    },
    {
        "content": "<p>looks like a contained resource issue. I'll think about it when Lloyd says it's not a template issue</p>",
        "id": 271902129,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644879715
    },
    {
        "content": "<p>Yes, thanks Chris :-)</p>",
        "id": 271902443,
        "sender_full_name": "Yolanda",
        "timestamp": 1644879874
    },
    {
        "content": "<p>I suspect it's a template issue.  So ignore for now.</p>",
        "id": 271922996,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644896651
    },
    {
        "content": "<p>Sounds good, thanks Lloyd and Grahame.</p>",
        "id": 271969430,
        "sender_full_name": "Yolanda",
        "timestamp": 1644929783
    }
]