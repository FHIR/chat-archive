[
    {
        "content": "<p>I'm getting the following error from a profile which built without an issue a couple of IGPublisher versions ago:</p>\n<p>org.hl7.fhir.exceptions.FHIRException: Unable to generate snapshot for <a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement</a> in C:\\Users\\timbl\\OneDrive\\Documents\\nsw-health-fhir-itoc\\resources\\nswhealthitocmedicationstatement<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3805)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:3762)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3217)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:768)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:655)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6662)<br>\nCaused by: org.hl7.fhir.exceptions.DefinitionException: Differential does not have a slice: MedicationStatement.medication[x].coding/ (b:22 of 56 / 6/ 11) in profile <a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement</a><br>\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:945)<br>\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:1179)<br>\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:492)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3803)<br>\n        ... 5 more</p>\n<p>Profile as follows:</p>\n<p>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;<br>\n&lt;StructureDefinition xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n  &lt;id value=\"nswhealthitocmedicationstatement\" /&gt;<br>\n  &lt;url value=\"<a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement</a>\" /&gt;<br>\n  &lt;version value=\"1.0.0\" /&gt;<br>\n  &lt;name value=\"NSWHealthiTOCMedicationStatement\" /&gt;<br>\n  &lt;status value=\"draft\" /&gt;<br>\n  &lt;date value=\"2019-10-29\"/&gt;<br>\n  &lt;publisher value=\"NSW eHealth\" /&gt;  <br>\n  &lt;fhirVersion value=\"4.0.1\" /&gt;<br>\n  &lt;kind value=\"resource\" /&gt;<br>\n  &lt;abstract value=\"false\" /&gt;<br>\n  &lt;type value=\"MedicationStatement\" /&gt;<br>\n  &lt;baseDefinition value=\"<a href=\"http://hl7.org.au/fhir/StructureDefinition/au-medicationstatement\" target=\"_blank\" title=\"http://hl7.org.au/fhir/StructureDefinition/au-medicationstatement\">http://hl7.org.au/fhir/StructureDefinition/au-medicationstatement</a>\" /&gt;<br>\n  &lt;derivation value=\"constraint\" /&gt;<br>\n  &lt;differential&gt;<br>\n    &lt;element id=\"MedicationStatement\"&gt;<br>\n      &lt;path value=\"MedicationStatement\" /&gt;<br>\n      &lt;short value=\"A record of medication being taken by a patient in an Australian healthcare context.\" /&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.extension:diluent\"&gt;<br>\n      &lt;path value=\"MedicationStatement.extension\" /&gt;<br>\n      &lt;sliceName value=\"diluent\" /&gt;<br>\n      &lt;short value=\"The diluent medication\" /&gt;<br>\n      &lt;min value=\"0\" /&gt;<br>\n      &lt;max value=\"1\" /&gt;<br>\n      &lt;type&gt;<br>\n        &lt;code value=\"Extension\" /&gt;<br>\n        &lt;profile value=\"<a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/diluent\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/diluent\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/diluent</a>\" /&gt;<br>\n      &lt;/type&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.basedOn\"&gt;<br>\n        &lt;path value=\"MedicationStatement.basedOn\"/&gt;<br>\n        &lt;type&gt;<br>\n          &lt;code value=\"Reference\"/&gt;<br>\n          &lt;targetProfile value=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocorder\"/&gt;<br>\n        &lt;/type&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.category\"&gt;<br>\n      &lt;path value=\"MedicationStatement.category\" /&gt;<br>\n      &lt;short value=\"The type of medication usage. For Medication List use case use &quot;inpatient&quot;.  For Medication History use case use &quot;patientspecified&quot;.\" /&gt;<br>\n      &lt;definition value=\"Indicates where type of medication statement and where the medication is expected to be consumed or administered. For Medication List use case use &quot;inpatient&quot;.  For Medication History use case use &quot;patientspecified&quot;.\" /&gt;<br>\n      &lt;min value=\"1\" /&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x]\"/&gt;<br>\n        &lt;sliceName value=\"medicationCodeableConcept\"/&gt;<br>\n    &lt;/element&gt;      <br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:cerner\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding\"/&gt;<br>\n        &lt;sliceName value=\"cerner\"/&gt;<br>\n        &lt;short value=\"The cerner (MULTUM) code for the medication\"/&gt;            <br>\n        &lt;max value=\"1\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:cerner.system\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.system\"/&gt;<br>\n        &lt;min value=\"1\"/&gt;<br>\n        &lt;fixedUri value=\"http://cerner.com/itoc/codes\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:cerner.code\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.code\"/&gt;<br>\n        &lt;short value=\"Cerner (MULTUM) code value\" /&gt;        <br>\n        &lt;min value=\"1\"/&gt;<br>\n    &lt;/element&gt;      <br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:imdsoft\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding\"/&gt;<br>\n        &lt;sliceName value=\"imdsoft\"/&gt;<br>\n        &lt;short value=\"The MetaVision / IMDsoft code for the medication\"/&gt;           <br>\n        &lt;max value=\"1\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:imdsoft.system\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.system\"/&gt;<br>\n        &lt;min value=\"1\"/&gt;<br>\n        &lt;fixedUri value=\"http://www.imd-soft.com/itoc/codes\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:imdsoft.code\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.code\"/&gt;<br>\n        &lt;short value=\"MetaVision / IMDsoft code value\" /&gt;       <br>\n        &lt;min value=\"1\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationReference\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medicationReference\"/&gt;<br>\n        &lt;sliceName value=\"medicationReference\"/&gt;<br>\n        &lt;short value=\"A reference to a NSW Health iTOC Medication\" /&gt;<br>\n        &lt;type&gt;<br>\n          &lt;code value=\"Reference\"/&gt;<br>\n          &lt;targetProfile value=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedication\"/&gt;<br>\n        &lt;/type&gt;<br>\n    &lt;/element&gt;  <br>\n    &lt;element id=\"MedicationStatement.subject\"&gt;<br>\n      &lt;path value=\"MedicationStatement.subject\" /&gt;<br>\n      &lt;short value=\"The patient who is or was taking the medication.\" /&gt;<br>\n      &lt;definition value=\"The person who is/was taking the medication.\" /&gt;<br>\n      &lt;type&gt;<br>\n        &lt;code value=\"Reference\" /&gt;<br>\n        &lt;targetProfile value=\"<a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocpatient\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocpatient\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocpatient</a>\" /&gt;<br>\n      &lt;/type&gt;<br>\n    &lt;/element&gt;</p>\n<p>&lt;/differential&gt;<br>\n&lt;/StructureDefinition&gt;</p>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  Has something changed?</p>",
        "id": 183503417,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576442372
    },
    {
        "content": "<p>well, something has changed, but not that actual detail. I think of this as a discovered issue - something wasn't working before and is now, so you see this error.</p>",
        "id": 183503687,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576442760
    },
    {
        "content": "<p>you need to be explicit about your slicing on coding</p>",
        "id": 183503728,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576442775
    },
    {
        "content": "<p>Not quite sure what that means?  Can you please give an example?</p>",
        "id": 183504210,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576443559
    },
    {
        "content": "<p>from your sd:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;element</span> <span class=\"na\">id=</span><span class=\"s\">&quot;MedicationStatement.medication[x]:medicationCodeableConcept&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">&quot;MedicationStatement.medication[x]&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;sliceName</span> <span class=\"na\">value=</span><span class=\"s\">&quot;medicationCodeableConcept&quot;</span><span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;/element&gt;</span>\n<span class=\"nt\">&lt;element</span>\n<span class=\"na\">id=</span><span class=\"s\">&quot;MedicationStatement.medication[x]:medicationCodeableConcept.coding:cerner&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">&quot;MedicationStatement.medication[x].coding&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;sliceName</span> <span class=\"na\">value=</span><span class=\"s\">&quot;cerner&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;short</span> <span class=\"na\">value=</span><span class=\"s\">&quot;The cerner (MULTUM) code for the medication&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;max</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span><span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;/element&gt;</span>\n</pre></div>",
        "id": 183504836,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576444398
    },
    {
        "content": "<p>you launched right into the cerner slice without first defining the slicing</p>",
        "id": 183504840,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576444413
    },
    {
        "content": "<p>so you should have something like:</p>\n<div class=\"codehilite\"><pre><span></span>  <span class=\"nt\">&lt;element</span> <span class=\"na\">id=</span><span class=\"s\">&quot;MedicationStatement.medication[x]:medicationCodeableConcept.coding&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">&quot;MedicationStatement.medication[x].coding&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;slicing&gt;</span>\n        <span class=\"nt\">&lt;discriminator&gt;</span>\n          <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;value&quot;</span><span class=\"nt\">/&gt;</span>\n          <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">&quot;system&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/discriminator&gt;</span>\n        <span class=\"nt\">&lt;discriminator&gt;</span>\n          <span class=\"nt\">&lt;type</span> <span class=\"na\">value=</span><span class=\"s\">&quot;value&quot;</span><span class=\"nt\">/&gt;</span>\n          <span class=\"nt\">&lt;path</span> <span class=\"na\">value=</span><span class=\"s\">&quot;code&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/discriminator&gt;</span>\n        <span class=\"nt\">&lt;rules</span> <span class=\"na\">value=</span><span class=\"s\">&quot;open&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/slicing&gt;</span>\n  <span class=\"nt\">&lt;/element&gt;</span>\n</pre></div>",
        "id": 183504921,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576444550
    },
    {
        "content": "<p>in between</p>",
        "id": 183504926,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576444553
    },
    {
        "content": "<p>Okay, thanks.</p>",
        "id": 183505337,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576445252
    },
    {
        "content": "<p>Still having issues.  If I add in:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;element id=&quot;MedicationStatement.medication[x]:medicationCodeableConcept.coding&quot;&gt;\n  &lt;path value=&quot;MedicationStatement.medication[x].coding&quot; /&gt;\n  &lt;slicing&gt;\n    &lt;discriminator&gt;\n      &lt;type value=&quot;value&quot; /&gt;\n      &lt;path value=&quot;system&quot; /&gt;\n    &lt;/discriminator&gt;\n    &lt;rules value=&quot;open&quot; /&gt;\n  &lt;/slicing&gt;\n  &lt;short value=&quot;Medication Codes&quot; /&gt;\n&lt;/element&gt;\n</pre></div>\n\n\n<p>I get error:</p>\n<p>Stack Dump (for debugging):                                                      (00:47.0615)<br>\norg.hl7.fhir.exceptions.DefinitionException: Slice encountered midway through path on MedicationStatement.medication[x].coding; profile <a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement</a>; instance patientprofile1-medhistory-example0<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.assignChildren(InstanceValidator.java:4661)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validateElement(InstanceValidator.java:4320)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.checkChild(InstanceValidator.java:4533)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validateElement(InstanceValidator.java:4327)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.start(InstanceValidator.java:3256)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validateResource(InstanceValidator.java:4984)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validateContains(InstanceValidator.java:4234)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.checkChild(InstanceValidator.java:4437)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validateElement(InstanceValidator.java:4327)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.checkChild(InstanceValidator.java:4453)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validateElement(InstanceValidator.java:4327)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.start(InstanceValidator.java:3235)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validateResource(InstanceValidator.java:4984)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validate(InstanceValidator.java:850)<br>\n        at org.hl7.fhir.r5.validation.InstanceValidator.validate(InstanceValidator.java:810)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.validate(Publisher.java:4031)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.validate(Publisher.java:4008)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:775)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:657)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6689)</p>\n<p>This is a derived profile.  Does that make a difference?</p>",
        "id": 183795265,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576706701
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191368\">@Brett Esler</span>  Thoughts?</p>",
        "id": 183795283,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576706711
    },
    {
        "content": "<p>are you adding that on the first element?</p>",
        "id": 183801935,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576712440
    },
    {
        "content": "<p>Full profile here:</p>\n<p>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;<br>\n&lt;StructureDefinition xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n  &lt;id value=\"nswhealthitocmedicationstatement\" /&gt;<br>\n  &lt;url value=\"<a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedicationstatement</a>\" /&gt;<br>\n  &lt;version value=\"1.0.0\" /&gt;<br>\n  &lt;name value=\"NSWHealthiTOCMedicationStatement\" /&gt;<br>\n  &lt;status value=\"draft\" /&gt;<br>\n  &lt;date value=\"2019-10-29\"/&gt;<br>\n  &lt;publisher value=\"NSW eHealth\" /&gt;  <br>\n  &lt;fhirVersion value=\"4.0.1\" /&gt;<br>\n  &lt;kind value=\"resource\" /&gt;<br>\n  &lt;abstract value=\"false\" /&gt;<br>\n  &lt;type value=\"MedicationStatement\" /&gt;<br>\n  &lt;baseDefinition value=\"<a href=\"http://hl7.org.au/fhir/StructureDefinition/au-medicationstatement\" target=\"_blank\" title=\"http://hl7.org.au/fhir/StructureDefinition/au-medicationstatement\">http://hl7.org.au/fhir/StructureDefinition/au-medicationstatement</a>\" /&gt;<br>\n  &lt;derivation value=\"constraint\" /&gt;<br>\n  &lt;differential&gt;<br>\n    &lt;element id=\"MedicationStatement\"&gt;<br>\n      &lt;path value=\"MedicationStatement\" /&gt;<br>\n      &lt;short value=\"A record of medication being taken by a patient in an Australian healthcare context.\" /&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.extension:diluent\"&gt;<br>\n      &lt;path value=\"MedicationStatement.extension\" /&gt;<br>\n      &lt;sliceName value=\"diluent\" /&gt;<br>\n      &lt;short value=\"The diluent medication\" /&gt;<br>\n      &lt;min value=\"0\" /&gt;<br>\n      &lt;max value=\"1\" /&gt;<br>\n      &lt;type&gt;<br>\n        &lt;code value=\"Extension\" /&gt;<br>\n        &lt;profile value=\"<a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/diluent\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/diluent\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/diluent</a>\" /&gt;<br>\n      &lt;/type&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.basedOn\"&gt;<br>\n        &lt;path value=\"MedicationStatement.basedOn\"/&gt;<br>\n        &lt;type&gt;<br>\n          &lt;code value=\"Reference\"/&gt;<br>\n          &lt;targetProfile value=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocorder\"/&gt;<br>\n        &lt;/type&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.category\"&gt;<br>\n      &lt;path value=\"MedicationStatement.category\" /&gt;<br>\n      &lt;short value=\"The type of medication usage. For Medication List use case use &quot;inpatient&quot;.  For Medication History use case use &quot;patientspecified&quot;.\" /&gt;<br>\n      &lt;definition value=\"Indicates where type of medication statement and where the medication is expected to be consumed or administered. For Medication List use case use &quot;inpatient&quot;.  For Medication History use case use &quot;patientspecified&quot;.\" /&gt;<br>\n      &lt;min value=\"1\" /&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x]\"/&gt;<br>\n        &lt;sliceName value=\"medicationCodeableConcept\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding\"&gt;<br>\n      &lt;path value=\"MedicationStatement.medication[x].coding\" /&gt;<br>\n      &lt;slicing&gt;<br>\n        &lt;discriminator&gt;<br>\n          &lt;type value=\"value\" /&gt;<br>\n          &lt;path value=\"system\" /&gt;<br>\n        &lt;/discriminator&gt;<br>\n        &lt;rules value=\"open\" /&gt;<br>\n      &lt;/slicing&gt;<br>\n      &lt;short value=\"Medication Codes\" /&gt;<br>\n    &lt;/element&gt;  <br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:cerner\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding\"/&gt;<br>\n        &lt;sliceName value=\"cerner\"/&gt;<br>\n        &lt;short value=\"The cerner (MULTUM) code for the medication\"/&gt;            <br>\n        &lt;max value=\"1\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:cerner.system\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.system\"/&gt;<br>\n        &lt;min value=\"1\"/&gt;<br>\n        &lt;fixedUri value=\"http://cerner.com/itoc/codes\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:cerner.code\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.code\"/&gt;<br>\n        &lt;short value=\"Cerner (MULTUM) code value\" /&gt;        <br>\n        &lt;min value=\"1\"/&gt;<br>\n    &lt;/element&gt;      <br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:imdsoft\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding\"/&gt;    <br>\n        &lt;sliceName value=\"imdsoft\"/&gt;<br>\n        &lt;short value=\"The MetaVision / IMDsoft code for the medication\"/&gt;           <br>\n        &lt;max value=\"1\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:imdsoft.system\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.system\"/&gt;<br>\n        &lt;min value=\"1\"/&gt;<br>\n        &lt;fixedUri value=\"http://www.imd-soft.com/itoc/codes\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationCodeableConcept.coding:imdsoft.code\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medication[x].coding.code\"/&gt;<br>\n        &lt;short value=\"MetaVision / IMDsoft code value\" /&gt;       <br>\n        &lt;min value=\"1\"/&gt;<br>\n    &lt;/element&gt;<br>\n    &lt;element id=\"MedicationStatement.medication[x]:medicationReference\"&gt;<br>\n        &lt;path value=\"MedicationStatement.medicationReference\"/&gt;<br>\n        &lt;sliceName value=\"medicationReference\"/&gt;<br>\n        &lt;short value=\"A reference to a NSW Health iTOC Medication\" /&gt;<br>\n        &lt;type&gt;<br>\n          &lt;code value=\"Reference\"/&gt;<br>\n          &lt;targetProfile value=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocmedication\"/&gt;<br>\n        &lt;/type&gt;<br>\n    &lt;/element&gt;  <br>\n    &lt;element id=\"MedicationStatement.subject\"&gt;<br>\n      &lt;path value=\"MedicationStatement.subject\" /&gt;<br>\n      &lt;short value=\"The patient who is or was taking the medication.\" /&gt;<br>\n      &lt;definition value=\"The person who is/was taking the medication.\" /&gt;<br>\n      &lt;type&gt;<br>\n        &lt;code value=\"Reference\" /&gt;<br>\n        &lt;targetProfile value=\"<a href=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocpatient\" target=\"_blank\" title=\"http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocpatient\">http://fhir.health.nsw.gov.au/fhir/ehealth/itoc/v1.0/StructureDefinition/nswhealthitocpatient</a>\" /&gt;<br>\n      &lt;/type&gt;<br>\n    &lt;/element&gt;</p>\n<p>&lt;/differential&gt;<br>\n&lt;/StructureDefinition&gt;</p>",
        "id": 183803120,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576713566
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  The slicing is present on the profile from which I derive (AU Base MediciationStatement).  Does it need to be repeated in this derived profile?</p>",
        "id": 183815674,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576730159
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191802\">@Tim Blake</span> <br>\nMedicationStatement.category short and definition have instances of \" in their values.</p>",
        "id": 183820723,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1576737891
    },
    {
        "content": "<p>I think that was Zulip.  The original has &quot;</p>",
        "id": 183821039,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576738361
    },
    {
        "content": "<p>&amp; quot;</p>",
        "id": 183821044,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576738375
    },
    {
        "content": "<p>Strange.</p>",
        "id": 183824221,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1576742938
    },
    {
        "content": "<p>It used to build fine until some recent IG publisher changes. I need some help <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>   Do you want the link to the GitHub repo?</p>",
        "id": 183824358,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576743096
    },
    {
        "content": "<p>sure</p>",
        "id": 183824599,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576743353
    },
    {
        "content": "<p><a href=\"https://github.com/timblake78/nsw-health-itoc\" target=\"_blank\" title=\"https://github.com/timblake78/nsw-health-itoc\">https://github.com/timblake78/nsw-health-itoc</a></p>",
        "id": 183826049,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576745028
    },
    {
        "content": "<p>carumba that was a subtle one - a bug in the snapshot generator. I'm releasing a new IGPublisher</p>",
        "id": 183834834,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576752758
    },
    {
        "content": "<p>Thanks, Iâ€™ll test shortly.</p>",
        "id": 183884407,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576788990
    },
    {
        "content": "<blockquote>\n<p>carumba that was a subtle one - a bug in the snapshot generator. I'm releasing a new IGPublisher</p>\n</blockquote>\n<p>Just keeping you on your toes <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  Thanks, builds successfully now...</p>",
        "id": 183890267,
        "sender_full_name": "Tim Blake",
        "timestamp": 1576793317
    },
    {
        "content": "<p>A SUSHI user has reported a similar (but different) issue to us <a href=\"https://github.com/FHIR/sushi/issues/207\" target=\"_blank\" title=\"https://github.com/FHIR/sushi/issues/207\">here</a>.  In short, they are profiling a profile -- and more specifically, constraining an existing slice in the base profile.  SUSHI puts the specific constraint in the differential, but does <em>not</em> put the <code>sliceName</code> property in the differential (since it is not, in fact, <em>different</em> from the parent -- and our basic approach is to only put things that are actually <em>different</em> in the differential).  Unfortunately, this causes the IG Publisher to crash.  The SUSHI user reports that they think the <code>sliceName</code> needs to be included in the differential -- and that relying on the <code>id</code> to identify the existing slice in the parent is not enough for the publisher.  I couldn't find documentation around this, so just wanted to confirm before we adjust SUSHI to always spit out a <code>sliceName</code> element/property in the differential when constraining an existing slice.</p>",
        "id": 187821081,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581345799
    },
    {
        "content": "<p>Correct.  The tooling does not drive off the id</p>",
        "id": 187822660,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581346744
    },
    {
        "content": "<p>So is it sequence-based?  In other words, going back to the <code>sliceName</code> example -- if the tooling sees a <code>sliceName</code> in a differential element, then does it just assume that all sequentially following elements with a child path are in that slice -- until it gets to a non-child element (at which point the slicename context is cleared or reset to the next slicename if it's there)?</p>",
        "id": 187824513,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581347905
    },
    {
        "content": "<p>Correct.  (It doesn't assume - that's a rule.)</p>",
        "id": 187827736,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581349779
    },
    {
        "content": "<p>Lloyd is right, but I don't think it's documented well enough at the moment. There's a task to fix that up somewhere</p>",
        "id": 187851850,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581364464
    }
]