[
    {
        "content": "<p>I have a slice whose discriminator is the value of an extension:</p>\n<div class=\"codehilite\"><pre><span></span><code>* careTeam ^slicing.discriminator.type = #value\n* careTeam ^slicing.discriminator.path = &quot;extension(&#39;http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-careTeamClaimScope&#39;).valueBoolean&quot;\n* careTeam ^slicing.rules = #open\n* careTeam ^slicing.description = &quot;Slice based on whether the care team member belongs to the overall claim or to an individual claim item.&quot;\n* careTeam contains OverallClaimMember 0..14 and ItemClaimMember 0..10\n</code></pre></div>\n<p>When I run the publisher, it fails with the following error:</p>\n<div class=\"codehilite\"><pre><span></span><code>java.lang.IndexOutOfBoundsException: Index 0 out of bounds for length 0\n    at java.base/jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:64)\n    at java.base/jdk.internal.util.Preconditions.outOfBoundsCheckIndex(Preconditions.java:70)\n    at java.base/jdk.internal.util.Preconditions.checkIndex(Preconditions.java:248)\n    at java.base/java.util.Objects.checkIndex(Objects.java:372)\n    at java.base/java.util.ArrayList.get(ArrayList.java:458)\n    at org.hl7.fhir.r5.utils.FHIRPathEngine.evaluateDefinition(FHIRPathEngine.java:5500)\n    at org.hl7.fhir.validation.instance.InstanceValidator.getCriteriaForDiscriminator(InstanceValidator.java:3058)\n    at org.hl7.fhir.validation.instance.InstanceValidator.sliceMatches(InstanceValidator.java:3554)\n</code></pre></div>\n<p>I'm assuming that it is my example with this slice since I just added the slice, but there is no other information since this is a Java error.  Is my slice discriminator incorrect in some way?</p>",
        "id": 245458982,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1625845045
    },
    {
        "content": "<p>Does FHIRPath recognize valueBoolean?  I thought you had to say \".value as boolean\"...</p>",
        "id": 245473224,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625852023
    },
    {
        "content": "<p>i switched that to .value but it turns out that wasn't the error.  it's the fact that the fhirpath engine is always looking for a extension type.</p>",
        "id": 245475477,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1625853072
    },
    {
        "content": "<p>Have you filed a Git issue?</p>",
        "id": 245486782,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625858915
    },
    {
        "content": "<p>yep</p>",
        "id": 245492961,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1625862116
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Here is the original issue that caused me to switch from using a FSH version of my profile to a JSON version that I then needed to include a snapshot.</p>",
        "id": 250685949,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1629927072
    },
    {
        "content": "<p>i did not raise a Git issue because I wasn't sure my analysis was correct.</p>",
        "id": 250685975,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1629927093
    },
    {
        "content": "<p>I am checking in the FSH files that cause the above error.</p>",
        "id": 250685995,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1629927103
    }
]