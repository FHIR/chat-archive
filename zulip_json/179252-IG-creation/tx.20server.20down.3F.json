[
    {
        "content": "<p>I'm getting timeouts on connect</p>",
        "id": 242211927,
        "sender_full_name": "David Pyke",
        "timestamp": 1623334076
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/ig/Carequality/CEQSubscription/branches/master/failure/build.log\">http://build.fhir.org/ig/Carequality/CEQSubscription/branches/master/failure/build.log</a></p>",
        "id": 242212083,
        "sender_full_name": "David Pyke",
        "timestamp": 1623334119
    },
    {
        "content": "<p>Me too</p>",
        "id": 242214597,
        "sender_full_name": "David deRoode",
        "timestamp": 1623335037
    },
    {
        "content": "<p>I'll check</p>",
        "id": 242214900,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623335143
    },
    {
        "content": "<p>Restarted - service is back up now.</p>",
        "id": 242216634,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623335727
    },
    {
        "content": "<p>When the server crashes, is the entire thing locked? Would it be possible to have a watchdog process that restarts it automatically when some conditions are met?</p>",
        "id": 242216782,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1623335769
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> It's the service that hangs (I suspect it could be due to memory leak issues?).  The server itself is (usually) fine.  In lieu of having the underlying problem resolved, I agree that a watchdog process that can follow the service activity and detect when it has stopped and then automatically restart the service, as you suggest, would probably be an immense help.  If the watchdog could notify me, Mark and Grahame and then restart the service, that would probably be ideal.</p>",
        "id": 242217728,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623336116
    },
    {
        "content": "<p>So, if it can't fetch the capabilitystatement, it restarts the service.</p>",
        "id": 242217864,
        "sender_full_name": "David Pyke",
        "timestamp": 1623336152
    },
    {
        "content": "<p>Yes, sure - that should work.</p>",
        "id": 242217926,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623336173
    },
    {
        "content": "<p>The watchdog could be set to ping periodically for the CapabilityStatement (I don't think the ping would need to be terminology specific).</p>",
        "id": 242218422,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623336335
    },
    {
        "content": "<p>Cool. Is this a linux server or windows? How are deployments/updates managed?</p>",
        "id": 242232708,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1623342008
    },
    {
        "content": "<p>windows. I install a windows service</p>",
        "id": 242233518,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623342378
    },
    {
        "content": "<p>Well, there's your problem... Windows</p>",
        "id": 242234733,
        "sender_full_name": "David Pyke",
        "timestamp": 1623342922
    },
    {
        "content": "<p>What kind of notification would you want when it goes down?</p>",
        "id": 242235975,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1623343520
    },
    {
        "content": "<p>A fax. Need to be backwards compatible.</p>",
        "id": 242237136,
        "sender_full_name": "David Pyke",
        "timestamp": 1623344061
    },
    {
        "content": "<p>Hmm.. I'd suggest some e-Fax solution then; the international call charges are going to be nuts otherwise.</p>",
        "id": 242237581,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1623344267
    },
    {
        "content": "<p>Maybe an email to fax gateway</p>",
        "id": 242237671,
        "sender_full_name": "David Pyke",
        "timestamp": 1623344289
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> Maybe we could take it a step up and go with email? :)  Or a Zulip notification.  So we can be aware of the circumstances and monitor how often this problem actually occurs.  Eventually we should see about fixing the underlying issue.</p>",
        "id": 242245431,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623347634
    },
    {
        "content": "<p>I can meet you half way and use ICQ</p>",
        "id": 242245500,
        "sender_full_name": "David Pyke",
        "timestamp": 1623347658
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> sure - I'm just doing something basic, but email is straightforward.  I don't want to do too much, because it quickly becomes better to bite the bullet and use a proper monitoring package.</p>",
        "id": 242247108,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1623348391
    },
    {
        "content": "<p>Yes, that makes sense.  Best to keep it simple.</p>",
        "id": 242249649,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623349504
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I have a basic service that monitors a url, restarts a service (and kills a process if it can't stop it, etc.).  I'm starting the notification code, but realized the time and I won't be able to get back to it until next week.  Do you have a preference on what it has now vs. waiting until next week?</p>",
        "id": 242276672,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1623362253
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> I think the notification is definitely a very nice to have.  But I, at least, think that going ahead and deploying what you have now makes sense.  It would definitely help us to provide an improved level of service.  It definitely seems that as the demands on the server have apparently been increasing (I haven't actually had a look at the stats) that the issue has been showing up more frequently.</p>",
        "id": 242278766,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623363607
    },
    {
        "content": "<p>A good, lightweight availability test is [base]/$versions which is called every 5 mins on my Server (hosted on Azure).</p>",
        "id": 242283143,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1623366586
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> Sorry for the delay in getting back, I missed it last week and am just getting back to this.  Josh setup a GH for this, so it's at: <a href=\"https://github.com/FHIR/terminology-service-liveness-monitor\">https://github.com/FHIR/terminology-service-liveness-monitor</a> .  You can clone the repo and build, or I did a release for <a href=\"https://github.com/FHIR/terminology-service-liveness-monitor/releases/tag/v0.0.1\">v0.0.1</a> which has the binaries.</p>\n<p>The documentation explains, but the TLDR:</p>\n<ul>\n<li>A console app that can also be installed as a service</li>\n<li>Configuration can be done either via <code>appsettings.json</code> (in the executable directory) or via environment variables (standard translation for the property names - Microsoft.Extensions.Configuration)<ul>\n<li><code>WindowsServiceName</code>: the name of the service that we are monitoring (e.g., the one to start/stop)</li>\n<li><code>ProcessName</code>: if a value is present, the monitor will kill that process if it takes too long to stop</li>\n<li><code>ServiceTestUrl</code>: the URL to GET, service will be restarted if the request fails</li>\n<li><code>ServiceStopDelaySeconds</code>: number of seconds to wait before killing the process (if set in <code>ProcessName</code>)</li>\n<li><code>PollIntervalSeconds</code>: number of seconds between checks to the <code>ServiceTestUrl</code></li>\n</ul>\n</li>\n</ul>\n<p>The Email configuration can be ignored for now, since I haven't implemented it yet.</p>\n<p>edit: It can be run from the command line (requires admin) or installed as a service via something like <code>sc create terminology-service-liveness-monitor \"binPath=&lt;path to executable&gt;\\terminology-service-liveness-monitor.exe\" start=demand</code></p>\n<p>I'll add the email as soon as I have a chance, but this should at least keep the service running until someone sets up a proper monitoring system.</p>\n<p>Cheers!</p>",
        "id": 242782566,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1623783598
    },
    {
        "content": "<p>Thanks, <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span>.  That is fantastic!  I should be able to work on getting it set up on the server later today.</p>",
        "id": 242788307,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623786051
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> the server takes about 5 minutes to start up. is there a start delay?</p>",
        "id": 242950817,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623882140
    },
    {
        "content": "<p>Hmm.. I don’t think I put that in. It <em>should</em> wait until it has a success after starting to do anything, but I don’t remember if I put that in or just thought about it.  I’ll check next chance I get</p>",
        "id": 242951018,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1623882285
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  Actually, I'm thinking from what I've seen that the start time is probably closer to 10 min (at least to be safe about it).  So I wouln't do any monitoring until at least that amount of time after restart has passed.</p>",
        "id": 242956281,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623886186
    },
    {
        "content": "<p>My thought is that once a start is issued, failures are ignored (can add a max timeout here if we want).  Once there is a success, monitoring resumes as normal</p>",
        "id": 242957708,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1623887317
    },
    {
        "content": "<p>That seems like probably the most sensible and simplest approach.</p>",
        "id": 242962850,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1623892232
    },
    {
        "content": "<p>Hi, during IG build I'm getting this error:</p>\n<div class=\"codehilite\"><pre><span></span><code>Error performing operation &#39;validate-code: Failed to connect to tx.fhir.org/104.196.166.17:80&#39; (parameters = &quot;&quot;) for &#39;http://unitsofmeasure.org#cm[H2O]&#39;\n</code></pre></div>\n<p>Is the related to the server being down? If I go to <a href=\"http://tx.fhir.org/r4/CodeSystem/$lookup?system=http://unitsofmeasure.org&amp;code=cm[H2O]\">http://tx.fhir.org/r4/CodeSystem/$lookup?system=http://unitsofmeasure.org&amp;code=cm[H2O]</a> I get an response. What could be the reason for the error in my IG build?</p>",
        "id": 243633409,
        "sender_full_name": "Christian Nau",
        "timestamp": 1624444830
    },
    {
        "content": "<p>have you cleared out your txCache</p>",
        "id": 243635933,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1624446680
    },
    {
        "content": "<p>yes, I did.</p>",
        "id": 243636424,
        "sender_full_name": "Christian Nau",
        "timestamp": 1624447026
    },
    {
        "content": "<p>...if you are talking about the directory <code>ig-root/input-cache/txcache</code></p>",
        "id": 243636593,
        "sender_full_name": "Christian Nau",
        "timestamp": 1624447120
    },
    {
        "content": "<p>and that particular operation is consistently failing?</p>",
        "id": 243637020,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1624447351
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> IG Publisher is complaining</p>",
        "id": 270351574,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643792024
    },
    {
        "content": "<p>what about?</p>",
        "id": 270355096,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643793855
    },
    {
        "content": "<p>Timeouts</p>",
        "id": 270357779,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643795239
    },
    {
        "content": "<p>It was timing out for a while, then worked again, now it's hesitating</p>",
        "id": 270357840,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643795269
    },
    {
        "content": "<p>if's failing now completely with the ci-build: org.hl7.fhir.exceptions.FHIRException: Unable to connect to terminology server. Error = Error fetching the server's capability statement: Error parsing response message: This does not appear to be a FHIR resource (wrong namespace '') (@ /)</p>",
        "id": 270370841,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1643802188
    },
    {
        "content": "<p>e.g. <a href=\"http://build.fhir.org/ig/ahdis/ch-crl/branches/master/failure/build.log\">http://build.fhir.org/ig/ahdis/ch-crl/branches/master/failure/build.log</a></p>",
        "id": 270370987,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1643802255
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> can you help?</p>",
        "id": 270377197,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1643805798
    },
    {
        "content": "<p>yes - let me check</p>",
        "id": 270378628,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1643806450
    },
    {
        "content": "<p>I'm working on restarting it.  It's not coming up very quickly, but it may just need a little longer.</p>",
        "id": 270381833,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1643808015
    },
    {
        "content": "<p>The startup had a glitch, but it should be coming back.</p>",
        "id": 270383958,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1643808982
    },
    {
        "content": "<p>The FHIR server may be having an SSL issue.  I'll restart the VM and see how that works.</p>",
        "id": 270386077,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1643809830
    },
    {
        "content": "<p>We should finally be back up.  Sorry it took so long!</p>",
        "id": 270394806,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1643813241
    },
    {
        "content": "<p>what happened?</p>",
        "id": 270448395,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643832030
    },
    {
        "content": "<p>Not clear.  The monitor didn't detect that it was down, but the console was frozen and the server wasn't responding to requests.  I was preparing to lead and then was leading the IPS call at the same time, and I didn't end up checking if memory was maxed out (or something like that).  Restarting the service didn't restore it.  But after rebooting the VM and then restarting the service a couple of additional times, it resumed normal operation and seems to have been functioning normally since then.</p>",
        "id": 270453593,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1643834338
    },
    {
        "content": "<p>Is the terminology server currently down? ... Caused by: java.net.ConnectException: Failed to connect to <a href=\"http://tx.fhir.org/104.196.166.17:80\">tx.fhir.org/104.196.166.17:80</a></p>",
        "id": 273019122,
        "sender_full_name": "Yan Heras",
        "timestamp": 1645654537
    },
    {
        "content": "<p>yes</p>",
        "id": 273019280,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1645654647
    }
]