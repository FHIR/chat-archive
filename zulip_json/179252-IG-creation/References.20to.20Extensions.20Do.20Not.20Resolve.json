[
    {
        "content": "<p>I'm working on the DaVinci Plan-net IG.   We are incorporating extensions from VHDir into profiles of USCore and R4 resources.<br>\nSo, I'm trying to incorporate extensions like <a href=\"http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatients\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatients\">http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatients</a> (<a href=\"http://hl7.org/fhir/uv/vhdir/2018Sep/StructureDefinition-newpatients.html\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/vhdir/2018Sep/StructureDefinition-newpatients.html\">http://hl7.org/fhir/uv/vhdir/2018Sep/StructureDefinition-newpatients.html</a>).</p>\n<p>Apparently, since these are still in ballot, they don't have resolvable URLs, like extensions in published IGs.<br>\nThe IG publisher flags them as unresolvable extensions: <strong>\"URL value '<a href=\"http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatients\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatients\">http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatients</a>' does not resolve\" </strong></p>\n<p>The type of extension is listed as: <strong>  ?? [CanonicalType[http://hl7.org/fhir/uv/vhdir/StructureDefinition/newpatients]]</strong></p>\n<p>What can be done?</p>",
        "id": 172320363,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564761518
    },
    {
        "content": "<p>The validator will complain about any extensions referenced from external IGs if you haven't specifically identified those IGs as dependencies.  That's the only way it can know how to resolve the URLs.</p>",
        "id": 172326682,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1564766887
    },
    {
        "content": "<p>Given that VHDir depends on USCore, why is USCore referencing VHDir extensions?  If they're useful in US-Core, then migrate them and define them there.  Otherwise, US-Core shouldn't be referencing any extensions from IGs that depend on it.  In terms of referencing extensions defined in IGs within the core spec, that's a harder problem.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 172326765,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1564766961
    },
    {
        "content": "<p>USCore isn't referencing VHDir extensions (unless Plan-Net is destined to be annointed as part of USCore)...<br>\nI'll need to learn how to define the VHDir (and USCore?)  IG as a dependency....</p>",
        "id": 172329879,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564769500
    },
    {
        "content": "<p>Here's an example from QI-Core, depending on US-Core STU 3:</p>",
        "id": 172333171,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564772034
    },
    {
        "content": "<p><a href=\"https://github.com/cqframework/qi-core/blob/master/ig.json#L26\" target=\"_blank\" title=\"https://github.com/cqframework/qi-core/blob/master/ig.json#L26\">https://github.com/cqframework/qi-core/blob/master/ig.json#L26</a></p>",
        "id": 172333172,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564772035
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> </p>\n<p>When I added the dependency to my ig.json file as follows:<br>\nHere is the dependency I added to ig.json:<br>\n\"dependencyList\": [<br>\n   {<br>\n     \"package\": \"hl7.fhir.us.core\",<br>\n     \"version\": \"3.0.0\",<br>\n     \"name\": \"uscore\",<br>\n     \"location\": \"<a href=\"http://hl7.org/fhir/us/core\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core\">http://hl7.org/fhir/us/core</a>\"<br>\n   },<br>\n   {<br>\n     \"package\": \"hl7.fhir.uv.vhdir\",<br>\n     \"version\": \"0.2.0\",<br>\n     \"name\": \"VhDir\",<br>\n     \"location\": \"<a href=\"http://build.fhir.org/ig/HL7/VhDir/\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/VhDir/\">http://build.fhir.org/ig/HL7/VhDir/</a>\"<br>\n   }</p>\n<p>I get a strange IG builder error:<br>\nLoad VhDir (<a href=\"http://build.fhir.org/ig/HL7/VhDir/\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/VhDir/\">http://build.fhir.org/ig/HL7/VhDir/</a>) from hl7.fhir.uv.vhdir#0.2.0    (43.0793sec)<br>\nVersion mismatch. This IG is version 4.0.0, while the IG 'VhDir' is from version 3.5.0 (will try to run anyway) (43.0800sec)<br>\nPublishing Content Failed: Unsupported version 3.5.0                             (43.0802sec)<br>\n                                                                                (43.0802sec)<br>\nUse -? to get command line help                                                  (43.0802sec)<br>\n                                                                                (43.0802sec)<br>\nStack Dump (for debugging):                                                      (43.0802sec)<br>\njava.lang.Exception: Unsupported version <strong>3.5.0</strong><br>\n    at org.hl7.fhir.igtools.publisher.Publisher.loadFromPackage(Publisher.java:2130)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:2201)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.initializeFromJson(Publisher.java:1685)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1123)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:606)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6208)<br>\nException in thread \"main\" java.lang.NullPointerException<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6218)</p>\n<p>(FHIR IG Publisher Version 0.9.43-SNAPSHOT - Built 2019-07-23T10:57:09.698Z - Git 6aa2358bd653)</p>\n<p>The VHDir IG clearly says it is based on R4:<br>\n{<br>\n  \"resourceType\": \"ImplementationGuide\",<br>\n  \"id\": \"hl7.core.uv.vhdir-0.2.0\",<br>\n  \"text\": {<br>\n    \"status\": \"generated\",<br>\n    \"div\": \"&lt;div xmlns=\\\"http://www.w3.org/1999/xhtml\\\"&gt;&lt;h2&gt;VhDir&lt;/h2&gt;&lt;p&gt;The official URL for this implementation guide is: &lt;/p&gt;&lt;pre&gt;http://hl7.org/fhir/uv/vhdir/ImplementationGuide/ig&lt;/pre&gt;&lt;/div&gt;\"<br>\n  },<br>\n  \"url\": \"<a href=\"http://hl7.org/fhir/uv/vhdir/ImplementationGuide/ig\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/vhdir/ImplementationGuide/ig\">http://hl7.org/fhir/uv/vhdir/ImplementationGuide/ig</a>\",<br>\n  \"version\": \"0.2.0\",<br>\n  \"name\": \"VhDir\",<br>\n  \"title\": \"Validated Healthcare Directory\",<br>\n  \"status\": \"draft\",<br>\n  \"publisher\": \"HL7 International - Patient Admistration Working Group\",<br>\n  \"contact\": [<br>\n    {<br>\n      \"telecom\": [<br>\n        {<br>\n          \"system\": \"url\",<br>\n          \"value\": \"<a href=\"http://www.hl7.org/Special/Committees/pafm/index.cfm\" target=\"_blank\" title=\"http://www.hl7.org/Special/Committees/pafm/index.cfm\">http://www.hl7.org/Special/Committees/pafm/index.cfm</a>\"<br>\n        }<br>\n      ]<br>\n    }<br>\n  ],<br>\n  \"copyright\": \"Used by permission of HL7 Patient Administration Committee, all rights reserved Creative Commons License\",<br>\n  \"packageId\": \"hl7.fhir.uv.vhdir\",<br>\n  \"license\": \"CC0-1.0\",<br>\n  \"fhirVersion\": [<br>\n    \"4.0.0\"<br>\n  ],</p>",
        "id": 172334739,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564773285
    },
    {
        "content": "<p>Hmmm... check the fhirVersion attribute in your ImplementationGuide resource?</p>",
        "id": 172334874,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564773384
    },
    {
        "content": "<p>\"packageId\": \"hl7.fhir.uv.vhdir\",<br>\n\"license\": \"CC0-1.0\",<br>\n\"fhirVersion\": [<br>\n\"4.0.0\"</p>",
        "id": 172335181,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564773618
    },
    {
        "content": "<p><a href=\"https://build.fhir.org/ig/HL7/VhDir/branches/master/qa.html\" target=\"_blank\" title=\"https://build.fhir.org/ig/HL7/VhDir/branches/master/qa.html\">https://build.fhir.org/ig/HL7/VhDir/branches/master/qa.html</a> shows the package id not in the usual format hl7.core.uv.vhdir#0.2.0 could that be it? should probably be hl7.fhir.uv.vhdir#0.2.0</p>",
        "id": 172335961,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1564774369
    },
    {
        "content": "<p>It looks like there's already a dependencyList entry in the IG, pointing to the current US Core and bulk data:</p>",
        "id": 172335993,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564774406
    },
    {
        "content": "<p><a href=\"https://github.com/HL7/VhDir/blob/master/ig.json#L1108\" target=\"_blank\" title=\"https://github.com/HL7/VhDir/blob/master/ig.json#L1108\">https://github.com/HL7/VhDir/blob/master/ig.json#L1108</a></p>",
        "id": 172335998,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564774408
    },
    {
        "content": "<p>Is it possible you now have 2 dependencyList entries in your ig.json?</p>",
        "id": 172336016,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564774431
    },
    {
        "content": "<p>The dependency list in my plan-net IG has two dependencies:<br>\n\"dependencyList\": [<br>\n    {<br>\n      \"package\": \"hl7.fhir.us.core\",<br>\n      \"version\": \"3.0.0\",<br>\n      \"name\": \"uscore\",<br>\n      \"location\": \"<a href=\"http://hl7.org/fhir/us/core\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core\">http://hl7.org/fhir/us/core</a>\"<br>\n    },<br>\n    {<br>\n      \"package\": \"hl7.fhir.uv.vhdir\",<br>\n      \"version\": \"0.2.0\",<br>\n      \"name\": \"VhDir\",<br>\n      \"location\": \"<a href=\"http://build.fhir.org/ig/HL7/VhDir/\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/VhDir/\">http://build.fhir.org/ig/HL7/VhDir/</a>\"<br>\n    }<br>\n  ],</p>\n<p>FHIR 3.5 seems to correspond to FHIR v3.5.0: R4 Ballot #2<br>\n<a href=\"http://hl7.org/fhir/2018Sep/\" target=\"_blank\" title=\"http://hl7.org/fhir/2018Sep/\">http://hl7.org/fhir/2018Sep/</a></p>\n<p>The version history says it is based on 3.5:<br>\n<a href=\"http://www.hl7.org/fhir/uv/vhdir/history.cfml\" target=\"_blank\" title=\"http://www.hl7.org/fhir/uv/vhdir/history.cfml\">http://www.hl7.org/fhir/uv/vhdir/history.cfml</a></p>\n<p>The Implementation guide file says it is based on 4.0â€¦.</p>",
        "id": 172336525,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564774783
    },
    {
        "content": "<p>For the time being, the content is here:   <a href=\"https://github.com/saulakravitz/davinci-pdex-plan-net\" target=\"_blank\" title=\"https://github.com/saulakravitz/davinci-pdex-plan-net\">https://github.com/saulakravitz/davinci-pdex-plan-net</a></p>",
        "id": 172337258,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564775307
    },
    {
        "content": "<p>Right, so you need to point to the \"current\" version of VhDir, not 0.2.0. 0.2.0 was based on Fhir 3.5, the latest version is based on R4, but it's going to ballot, so they haven't bumped the version in the CI Build yet.</p>",
        "id": 172338331,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564776269
    },
    {
        "content": "<p>So, until the conclusion of the ballot, are we stuck?   This seems like a accounting /procedural  problem, not a technical problem....or am I missing something (as is often the case in my naive wanderings through HL7/FHIR-land).</p>",
        "id": 172341238,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564778884
    },
    {
        "content": "<p>No, change the version in your dependencyList to \"current\", it should work.</p>",
        "id": 172341505,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564779203
    },
    {
        "content": "<p>Of course, I can't get VhDir to build locally, so there might be a different issue there :)</p>",
        "id": 172341663,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1564779349
    },
    {
        "content": "<p>Works like a charm.... I <strong>never</strong> would have figured that out.   Thanks for saving us 1-2 days!   Enjoy the weekend.</p>",
        "id": 172341928,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1564779576
    }
]