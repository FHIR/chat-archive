[
    {
        "content": "<p>How to fix this warning? Do I need to put a lang=\"...\" in every narrative field of every resource? or is there a good way to handle this? I'm not sure what is missing</p>",
        "id": 187933010,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581441915
    },
    {
        "content": "<p>yes in the narrative yes</p>",
        "id": 187947617,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581450791
    },
    {
        "content": "<p>OK I see it. <br>\nQuestion: is that a warning? isn't that too harsh? My source resources do not have narrative, so I will have this for every resource with a language.</p>",
        "id": 187978870,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581478286
    },
    {
        "content": "<p>oh - it's generated narrative? that's pretty poor on my part then...</p>",
        "id": 187978984,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581478444
    },
    {
        "content": "<p>no:</p>\n<div class=\"codehilite\"><pre><span></span>    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">r</span><span class=\"p\">.</span><span class=\"na\">hasLanguage</span><span class=\"p\">())</span> <span class=\"p\">{</span>\n      <span class=\"n\">x</span><span class=\"p\">.</span><span class=\"na\">setAttribute</span><span class=\"p\">(</span><span class=\"s\">&quot;xml:lang&quot;</span><span class=\"p\">,</span> <span class=\"n\">r</span><span class=\"p\">.</span><span class=\"na\">getLanguage</span><span class=\"p\">());</span>\n    <span class=\"p\">}</span>\n</pre></div>",
        "id": 187979000,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581478481
    },
    {
        "content": "<p>so I'm not sure what you need to do</p>",
        "id": 187979016,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581478526
    },
    {
        "content": "<p>from what I see, it sets xml:lang but the qa checks for lang.</p>",
        "id": 187979774,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581479870
    },
    {
        "content": "<p>i just changed one of my lang to xml:lang and it is broken again</p>",
        "id": 187979818,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581479898
    },
    {
        "content": "<p>which one is right?</p>\n<div class=\"codehilite\"><pre><span></span>    &quot;div&quot;: &quot;<span class=\"nt\">&lt;div</span> <span class=\"na\">xmlns=</span><span class=\"s\">\\&quot;http://www.w3.org/1999/xhtml\\&quot;</span> <span class=\"na\">xml:lang=</span><span class=\"s\">\\&quot;nl-BE\\&quot;</span><span class=\"nt\">&gt;&lt;p&gt;&lt;b&gt;</span>Generated Narrative with Details<span class=\"nt\">&lt;/b&gt;</span>\n</pre></div>\n\n\n<p>or</p>\n<div class=\"codehilite\"><pre><span></span>    &quot;div&quot;: &quot;<span class=\"nt\">&lt;div</span> <span class=\"na\">xmlns=</span><span class=\"s\">\\&quot;http://www.w3.org/1999/xhtml\\&quot;</span> <span class=\"na\">lang=</span><span class=\"s\">\\&quot;nl-BE\\&quot;</span><span class=\"nt\">&gt;&lt;p&gt;&lt;b&gt;</span>Generated Narrative with Details<span class=\"nt\">&lt;/b&gt;</span>\n</pre></div>",
        "id": 187979896,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581480023
    },
    {
        "content": "<p>the second does not give me a warning</p>",
        "id": 187979912,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581480070
    },
    {
        "content": "<p>it's a SHOULD in the spec, so it's a warning. I will update the code to generate lang not xml:lang</p>",
        "id": 187980247,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581480757
    },
    {
        "content": "<p>thanks</p>",
        "id": 187980650,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581481492
    },
    {
        "content": "<p><a href=\"https://www.w3.org/TR/i18n-html-tech-lang/#langvalues\" target=\"_blank\" title=\"https://www.w3.org/TR/i18n-html-tech-lang/#langvalues\">https://www.w3.org/TR/i18n-html-tech-lang/#langvalues</a></p>",
        "id": 187985227,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581489179
    },
    {
        "content": "<p>seems more complicated</p>",
        "id": 187985233,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581489182
    },
    {
        "content": "<p>says that for xhtml we have to use both lang and xml:lang</p>",
        "id": 187985318,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581489341
    },
    {
        "content": "<p>what should the QA check for? xml:lang, lang, or both? <br>\nAt this moment it seems that the generation code is inconsistent with the qa check, which i'd fix first if possible</p>",
        "id": 187985385,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581489454
    },
    {
        "content": "<p>both. in both cases</p>",
        "id": 187985907,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581490298
    },
    {
        "content": "<p>Check is now OK against lang and xml:lang, but generated narrative doesn't add either</p>",
        "id": 188073167,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581561390
    },
    {
        "content": "<p>how to reproduce? because the code sure thinks it is adding both</p>",
        "id": 188073454,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581561932
    },
    {
        "content": "<p>in the ci build now</p>",
        "id": 188073599,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581562152
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/ig/hl7-be/be-core/branches/master/qa.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/hl7-be/be-core/branches/master/qa.html\">http://build.fhir.org/ig/hl7-be/be-core/branches/master/qa.html</a></p>",
        "id": 188073601,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581562158
    },
    {
        "content": "<p>so that's not generated narrative; it only looks like it. It's actually narrative that you provided manually, so the ig publisher doesn't replace it</p>",
        "id": 188074326,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581563320
    },
    {
        "content": "<p>indeed one of the examples had some narrative that I pasted there (just removed it). But the others don't have narrative and are having the same issue.<br>\n<a href=\"https://github.com/hl7-be/be-core/tree/master/input/examples/Communication\" target=\"_blank\" title=\"https://github.com/hl7-be/be-core/tree/master/input/examples/Communication\">https://github.com/hl7-be/be-core/tree/master/input/examples/Communication</a></p>",
        "id": 188075107,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581564627
    },
    {
        "content": "<p>what am I missing?</p>",
        "id": 188075109,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581564641
    },
    {
        "content": "<p>found it. fixed next release</p>",
        "id": 188080739,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581573645
    },
    {
        "content": "<p>I wonder if your <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  latest fix has a bad effect on my own IG. The warning below appeared with this latest release:<br>\nResource has a language, but the XHTML does not have an xml:lang tag (needs both lang and xml:lang - see <a href=\"https://www.w3.org/TR/i18n-html-tech-lang/#langvalues\" target=\"_blank\" title=\"https://www.w3.org/TR/i18n-html-tech-lang/#langvalues\">https://www.w3.org/TR/i18n-html-tech-lang/#langvalues</a>)<br>\nWhich is fine, from what is explained above in this stream. However, the warning persists also after adding xml:lang. <br>\nMy narrative is like this:<br>\n    &lt;text&gt;<br>\n        &lt;status value=\"additional\"/&gt;<br>\n        &lt;div xmlns=\"<a href=\"http://www.w3.org/1999/xhtml\" target=\"_blank\" title=\"http://www.w3.org/1999/xhtml\">http://www.w3.org/1999/xhtml</a>\" xml:lang=\"fr-FR\" lang=\"fr-FR\"&gt;<br>\n            &lt;p&gt;codage affiné et conditions d'application du dosage de la vitamine D - Nomenclature des Actes de Biologie Médicale&lt;/p&gt;<br>\n        &lt;/div&gt;<br>\n    &lt;/text&gt;<br>\nSo why do I still get the warning?</p>",
        "id": 188109511,
        "sender_full_name": "François Macary",
        "timestamp": 1581603336
    },
    {
        "content": "<p>Indeed. I just tested and I confirm: I manually added an additional narrative to one of my resources and suddenly I now have the same warning.</p>",
        "id": 188113043,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1581605663
    },
    {
        "content": "<p>fixed next release</p>",
        "id": 188156945,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581631230
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 188617645,
        "sender_full_name": "François Macary",
        "timestamp": 1582186412
    }
]