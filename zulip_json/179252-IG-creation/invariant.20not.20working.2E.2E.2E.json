[
    {
        "content": "<p>Here is an invariant we added to Provenance profile... </p>\n<p>context = Provenance.agent.onBehalfOf</p>\n<div class=\"codehilite\"><pre><span></span> <span class=\"nt\">&lt;constraint&gt;</span>\n        <span class=\"nt\">&lt;key</span> <span class=\"na\">value=</span><span class=\"s\">&quot;provenance-1&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;severity</span> <span class=\"na\">value=</span><span class=\"s\">&quot;error&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;human</span> <span class=\"na\">value=</span><span class=\"s\">&quot;SHALL be present when Provenance.agent.who is a Practitioner&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;expression</span> <span class=\"na\">value=</span><span class=\"s\">&quot;exists() and not(Provenance.agent.who.resolve().ofType(Practitioner))&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/constraint&gt;</span>\n</pre></div>\n\n\n<p>I tried to test out using an example in ig-pub  where Provenance.agent.who is a type Practitioner and Provenance.agent.onBeahalfOf is not present and it does not work. ( no error )<br>\n*  Is it bad FHIRPath?<br>\n* does the ig-pub support resolve? <br>\n* Should we use a regex or other FHIRPath instead?</p>",
        "id": 170506026,
        "sender_full_name": "Eric Haas",
        "timestamp": 1562723985
    },
    {
        "content": "<p><code>($this.agent.who.resolve().is Practitioner) implies exists()</code></p>",
        "id": 170538522,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1562763372
    },
    {
        "content": "<p>but I would put it on the agent:</p>",
        "id": 170538535,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1562763390
    },
    {
        "content": "<p><code>who.resolve().is Practitioner) implies onBehalfOf.exists()</code></p>",
        "id": 170538584,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1562763432
    },
    {
        "content": "<p>How does one learn to write and test these expressions? I find myself guessing many times, and then break down and bug <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>  and <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ...or you  :)</p>",
        "id": 170544916,
        "sender_full_name": "Brett Marquard",
        "timestamp": 1562768101
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191410\">@Brett Marquard</span> -- I use <a href=\"https://hl7.github.io/fhirpath.js/\" target=\"_blank\" title=\"https://hl7.github.io/fhirpath.js/\">https://hl7.github.io/fhirpath.js/</a> to test FHIRpath, although it doesn't support <em>everything</em>.  You can also check out some of the other resources here: <a href=\"http://wiki.hl7.org/index.php?title=FHIRPath_Implementations\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=FHIRPath_Implementations\">http://wiki.hl7.org/index.php?title=FHIRPath_Implementations</a></p>",
        "id": 170545118,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1562768238
    },
    {
        "content": "<p>I just added you to my list of folks to ask when I get stuck <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 170545155,
        "sender_full_name": "Brett Marquard",
        "timestamp": 1562768267
    },
    {
        "content": "<p><a href=\"https://hl7.github.io/fhirpath.js\" target=\"_blank\" title=\"https://hl7.github.io/fhirpath.js\">https://hl7.github.io/fhirpath.js</a> does not support resolve :-(</p>",
        "id": 170545900,
        "sender_full_name": "Eric Haas",
        "timestamp": 1562768785
    },
    {
        "content": "<p>also the and up there was supposed to be an or</p>",
        "id": 170545930,
        "sender_full_name": "Eric Haas",
        "timestamp": 1562768808
    }
]