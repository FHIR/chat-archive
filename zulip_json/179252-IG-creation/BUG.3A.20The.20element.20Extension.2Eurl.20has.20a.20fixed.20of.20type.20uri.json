[
    {
        "content": "<p>When building R4 IGs, they're raising the following error in the qa.txt: \"The element Extension.url has a fixed of type uri, which is not in the list of allowed types.([http://hl7.org/fhirpath/System.String])\"</p>\n<p>This issue was initially raised over 10 days ago on the <a href=\"#narrow/stream/215610-shorthand/topic/The.20element.20Extension.2Eurl.20has.20a.20fixed.20of.20type.20uri\">FSH stream</a>.  I know <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> and <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> were heads down on R4B at that point.  So re-surfacing it here to make sure it's on the priority list to fix.</p>",
        "id": 230527035,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615906746
    },
    {
        "content": "<p>Have they tried building again recently</p>",
        "id": 230527136,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1615906776
    },
    {
        "content": "<p>this is similar to another error that I encountered recently, that was fixed with a kindling dependency bump</p>",
        "id": 230527214,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1615906800
    },
    {
        "content": "<p>I just retried with a client IG (not publicly available) 5 minutes ago with the current validator and it was still an issue</p>",
        "id": 230527628,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615906906
    },
    {
        "content": "<p>I'll retry again with a 'public' one.</p>",
        "id": 230527824,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615906955
    },
    {
        "content": "<p>Still an issue w/ SDC<br>\n<a href=\"http://build.fhir.org/ig/HL7/sdc/branches/master/qa.html#_scratch_ig-build-temp-JVWTM1_repo_input_examples_questionnaire-sdc-profile-example\">http://build.fhir.org/ig/HL7/sdc/branches/master/qa.html#_scratch_ig-build-temp-JVWTM1_repo_input_examples_questionnaire-sdc-profile-example</a></p>",
        "id": 230529633,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615907522
    },
    {
        "content": "<p>And I forgot about this issue and why I was holding off upgrading to the latest publisher.  I did that in one project and now have 40 spurious errors. that I'm going to have to explain to the client.  I really need to start using stickies around my computer to remind me of things!</p>",
        "id": 230544929,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1615911825
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> do you need anything further to chase?</p>",
        "id": 230594434,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615930233
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179252-IG-creation/topic/BUG.3A.20The.20element.20Extension.2Eurl.20has.20a.20fixed.20of.20type.20uri/near/230594434\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"248736\">Mark Iantorno</span> do you need anything further to chase?</p>\n</blockquote>\n<p>There is the error on the &lt;fixedUri&gt; element when in an extension introduced by the latest version of the IG publisher ....Does this fix it?</p>",
        "id": 230697883,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1615990893
    },
    {
        "content": "<p>I don't believe we have a fix yet...</p>",
        "id": 230699668,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615991547
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Okay, working with Jessica on the transport identifier naming system. Going well.<br>\nResolved the dependency issue. Have an agreed upon JIRA xml file (today's DoF meeting) so the only thing left is this fix uri.  <strong>By the way, if I change &lt;fixedUri&gt; to &lt;fixeduri&gt; in the extension, the error goes away.</strong></p>",
        "id": 230701237,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1615992145
    },
    {
        "content": "<p>That's definitely a bug in the publisher - because fixedUri is what's defined in the schema, and that's not allowed to change.  (<span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> FYI)</p>",
        "id": 230719715,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1615997697
    },
    {
        "content": "<p>I have the same issue today on both local and public build of fhir-order-catalog IG. Two weeks ago the same IG had zero errors in its QA. Now it has 65 after the single change of adding copyrigths to ValueSet resources to comply with HTA QA.</p>",
        "id": 230720984,
        "sender_full_name": "Fran√ßois Macary",
        "timestamp": 1615997995
    },
    {
        "content": "<p>Yes, and some of the 65 errors are \"Attempt to use Terminology server when no Terminology server is available for 'http://unitsofmeasure.org#mmol/L'\" - which seems (almost certainly) unrelated (but since they've occurred at the same time that is a little suspicious).</p>",
        "id": 230722877,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1615998606
    },
    {
        "content": "<p>Alright so, I think this is related to a commit made on March 2-3 (14dc86e3a2f895498d5a63aa8baefa0c5283fc85)</p>",
        "id": 231088845,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187448
    },
    {
        "content": "<p>There was code added in the validation process to add the message you are encountering</p>",
        "id": 231088876,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187468
    },
    {
        "content": "<p>specifically:<br>\n<code>    // in a snapshot, we validate that fixedValue, pattern, and defaultValue, if present, are all of the right type\n    if (snapshot &amp;&amp; element.getIdBase().contains(\".\")) {\n      if (rule(errors, IssueType.EXCEPTION, stack.getLiteralPath(), !typeCodes.isEmpty() || element.hasChild(\"contentReference\"), I18nConstants.SD_NO_TYPES_OR_CONTENTREF, element.getIdBase())) {\n        Element v = element.getNamedChild(\"defaultValue\");\n        if (v != null) {\n          rule(errors, IssueType.EXCEPTION, stack.push(v, -1, null, null).getLiteralPath(), typeCodes.contains(v.fhirType()), I18nConstants.SD_VALUE_TYPE_IILEGAL, element.getIdBase(), \"defaultValue\", v.fhirType(), typeCodes);\n        }\n        v = element.getNamedChild(\"fixed\");\n        if (v != null) {\n          rule(errors, IssueType.EXCEPTION, stack.push(v, -1, null, null).getLiteralPath(), typeCodes.contains(v.fhirType()), I18nConstants.SD_VALUE_TYPE_IILEGAL, element.getIdBase(), \"fixed\", v.fhirType(), typeCodes);\n        }\n        v = element.getNamedChild(\"pattern\");\n        if (v != null) {\n          rule(errors, IssueType.EXCEPTION, stack.push(v, -1, null, null).getLiteralPath(), typeCodes.contains(v.fhirType()), I18nConstants.SD_VALUE_TYPE_IILEGAL, element.getIdBase(), \"pattern\", v.fhirType(), typeCodes);\n        }\n      }\n    }</code></p>",
        "id": 231088901,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187479
    },
    {
        "content": "<p>That is the only time this message is used in the core.</p>\n<p>SD_VALUE_TYPE_IILEGAL = The element {0} has a {1} of type {2}, which is not in the list of allowed types ({3})</p>",
        "id": 231089001,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187510
    },
    {
        "content": "<p>This is in the StructureDefinitionValidator</p>",
        "id": 231089032,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187530
    },
    {
        "content": "<p>Let me look at what exactly is getting validated there</p>",
        "id": 231089079,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187552
    },
    {
        "content": "<p>and why</p>",
        "id": 231089085,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187554
    },
    {
        "content": "<p>Can someone here please provide me with instructions on how to actually get this to happen, like provide me with the files and steps so I can reproduce locally</p>",
        "id": 231089273,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187630
    },
    {
        "content": "<p>it will help me get it done faster</p>",
        "id": 231089312,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187641
    },
    {
        "content": "<p>any IG with extensions will trigger.  You can test it on one of mine:  <a href=\"https://github.com/HL7/fhir-spl\">https://github.com/HL7/fhir-spl</a></p>",
        "id": 231089500,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616187719
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> I've never published an IG, are there instructions on how to do it</p>",
        "id": 231089597,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187754
    },
    {
        "content": "<p>I just do the plumbing, never done the actual spec work</p>",
        "id": 231089636,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187775
    },
    {
        "content": "<p>clone the repository, run <a href=\"http://_updatePublisher.sh\">_updatePublisher.sh</a> to download the publisher.jar and then run <a href=\"http://_genonce.sh\">_genonce.sh</a> to generate the IG</p>",
        "id": 231089685,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616187796
    },
    {
        "content": "<p>great</p>",
        "id": 231089690,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616187802
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> I'm getting an error</p>",
        "id": 231090207,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188093
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 231090218,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188097
    },
    {
        "content": "<p>forget it, I remember I had a messed up installation of the tools from before</p>",
        "id": 231090271,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188138
    },
    {
        "content": "<p>I will fix</p>",
        "id": 231090288,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188146
    },
    {
        "content": "<p>actually it's still throwing the error after I re-installed</p>",
        "id": 231090543,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188283
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"checking\"><pre><span></span><code>Online\n\nFHIR IG Publisher Version 1.1.63 (Git# 0bd80eee0691). Built 2021-03-05T01:42:43.498Z (14 days old)\nDetected Java version: 11.0.9.1 from /home/mark/.sdkman/candidates/java/11.0.9.open-adpt on Linux/amd64 (64bit). 8028MB available\ndir = /home/mark/Documents/Projects/temp/fhir-spl, path = /home/mark/gems/bin:/home/mark/Downloads/google-cloud-sdk/bin:/home/mark/gems/bin:/home/mark/.nvm/versions/node/v8.9.1/bin:/home/mark/.sdkman/candidates/java/current/bin:/home/mark/.sdkman/candidates/gradle/current/bin:/home/mark/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/lib/jvm/java-8-oracle/bin:/usr/lib/jvm/java-8-oracle/db/bin:/usr/lib/jvm/java-8-oracle/jre/bin:Users/home/mark/.local/bin:Users/home/mark/.local/bin\nParameters: -ig .\nStart Clock @ Friday, March 19, 2021 at 5:10:19 p.m. Eastern Daylight Time (2021-03-19T17:10:19-04:00)\n\nAPI keys loaded from /home/mark/apikeys.ini                                      (00:00.0013)\nPackage Cache: /home/mark/.fhir/packages                                         (00:00.0015)\nRun Sushi on /home/mark/Documents/Projects/temp/fhir-spl                         (00:00.0015)\nSushi: info  Running SUSHI v1.3.0 (implements FHIR Shorthand specification v1.1.0) (00:00.0375)\nSushi: info  Arguments:                                                          (00:00.0375)\nSushi: info    --out /home/mark/Documents/Projects/temp/fhir-spl                 (00:00.0376)\nSushi: info    /home/mark/Documents/Projects/temp/fhir-spl                       (00:00.0376)\nSushi: info  Using configuration file: /home/mark/Documents/Projects/temp/fhir-spl/sushi-config.yaml (00:00.0379)\nSushi: info  Importing FSH text...                                               (00:00.0389)\nSushi: info  Preprocessed 12 documents with 1 aliases.                           (00:00.0585)\nSushi: error BigInt is not defined                                               (00:00.0590)\nSushi: File: /home/mark/Documents/Projects/temp/fhir-spl/input/fsh/EstablishmentLogicalModel.fsh (00:00.0590)\nSushi: Line: 1 - 337                                                             (00:00.0591)\nSushi: error BigInt is not defined                                               (00:00.0593)\nSushi: File: /home/mark/Documents/Projects/temp/fhir-spl/input/fsh/GDUFALogicalModel.fsh (00:00.0594)\nSushi: Line: 1 - 247                                                             (00:00.0594)\nSushi: error BigInt is not defined                                               (00:00.0595)\nSushi: File: /home/mark/Documents/Projects/temp/fhir-spl/input/fsh/LabelerLogicalModel.fsh (00:00.0595)\nSushi: Line: 1 - 220                                                             (00:00.0596)\nSushi: error BigInt is not defined                                               (00:00.0596)\nSushi: File: /home/mark/Documents/Projects/temp/fhir-spl/input/fsh/Operations.fsh (00:00.0596)\nSushi: Line: 1 - 27                                                              (00:00.0597)\nSushi: error BigInt is not defined                                               (00:00.0598)\nSushi: File: /home/mark/Documents/Projects/temp/fhir-spl/input/fsh/ProductSubmissionLogicalModel.fsh (00:00.0598)\nSushi: Line: 1 - 328                                                             (00:00.0599)\nSushi: info  Imported 32 definitions and 18 instances.                           (00:00.0601)\nSushi: info  Checking local cache for hl7.fhir.r4.core#4.0.1...                  (00:00.0602)\nSushi: info  Found hl7.fhir.r4.core#4.0.1 in local cache.                        (00:00.0980)\nSushi: info  Loaded package hl7.fhir.r4.core#4.0.1                               (00:00.0981)\nSushi: info  Converting FSH to FHIR resources...                                 (00:01.0035)\nSushi: info  Converted 23 FHIR StructureDefinitions.                             (00:01.0921)\nSushi: info  Converted 2 FHIR CodeSystems.                                       (00:01.0953)\nSushi: info  Converted 7 FHIR ValueSets.                                         (00:02.0017)\nSushi: info  Converted 18 FHIR instances.                                        (00:02.0473)\nSushi: info  Exporting FHIR resources as JSON...                                 (00:02.0473)\nSushi: info  Exported 50 FHIR resources as JSON.                                 (00:02.0523)\nSushi: info  Assembling Implementation Guide sources...                          (00:02.0523)\nSushi: error Group LogicalModel configured with nonexistent resource StructureDefinition/LabelerCodeRequestLogicalModel (00:02.0525)\nSushi: error Group LogicalModel configured with nonexistent resource StructureDefinition/EstablishmentRegistrationLogicalModel (00:02.0526)\nSushi: error Group LogicalModel configured with nonexistent resource StructureDefinition/GDUFAFacilityIdentificationLogicalModel (00:02.0526)\nSushi: error Group LogicalModel configured with nonexistent resource StructureDefinition/ProductSubmissionDocumentLogicalModel (00:02.0526)\nSushi: error Group Operations configured with nonexistent resource OperationDefinition/processOrganizationBundle (00:02.0526)\nSushi: info  Generated ImplementationGuide-hl7.fhir.us.spl.json                  (00:02.0529)\nSushi: info  Assembled Implementation Guide sources; ready for IG Publisher.     (00:02.0530)\nSushi:                                                                           (00:02.0530)\nSushi: ========================= SUSHI RESULTS ===========================       (00:02.0530)\nSushi: |  -------------------------------------------------------------  |       (00:02.0531)\nSushi: | | Profiles | Extensions | ValueSets | CodeSystems | Instances | |       (00:02.0531)\nSushi: | |-------------------------------------------------------------| |       (00:02.0531)\nSushi: | |    19    |     4      |     7     |      2      |    18     | |       (00:02.0532)\nSushi: |  -------------------------------------------------------------  |       (00:02.0532)\nSushi: |                                                                 |       (00:02.0532)\nSushi: ===================================================================       (00:02.0533)\nSushi: | Some-fin went wrong...                 10 Errors     0 Warnings |       (00:02.0533)\nSushi: ===================================================================       (00:02.0533)\nSushi couldn't be run. Complete output from running Sushi :                      (00:02.0539)\nNote: Check that Sushi is installed correctly (\"npm install -g fsh-sushi\". On windows, get npm from https://www.npmjs.com/get-npm) (00:02.0539)\nException: Process exited with an error: 10 (Exit value: 10)                     (00:02.0539)\nPublishing Content Failed: Process exited with an error: 10 (Exit value: 10)     (00:02.0540)\n                                                                                 (00:02.0540)\nUse -? to get command line help                                                  (00:02.0540)\n                                                                                 (00:02.0540)\nStack Dump (for debugging):                                                      (00:02.0540)\norg.apache.commons.exec.ExecuteException: Process exited with an error: 10 (Exit value: 10)\n    at org.apache.commons.exec.DefaultExecutor.executeInternal(DefaultExecutor.java:404)\n    at org.apache.commons.exec.DefaultExecutor.execute(DefaultExecutor.java:166)\n    at org.apache.commons.exec.DefaultExecutor.execute(DefaultExecutor.java:153)\n    at org.hl7.fhir.igtools.publisher.Publisher.runFsh(Publisher.java:1567)\n    at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1451)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:726)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:8424)\n</code></pre></div>",
        "id": 231090549,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188287
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span></p>",
        "id": 231090556,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188290
    },
    {
        "content": "<p>any idea why this is happening</p>",
        "id": 231090563,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188295
    },
    {
        "content": "<p>Sushi is installed</p>",
        "id": 231090597,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188316
    },
    {
        "content": "<p>no, BigInt isn't in those files, so this seems like a SUSHI bug.  I'd suggest to reinstall sushi?</p>",
        "id": 231090951,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616188440
    },
    {
        "content": "<p>will try</p>",
        "id": 231091147,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188530
    },
    {
        "content": "<p>Here is a guide that doesn't have logical models, not sure if that will bypass this error: <a href=\"https://github.com/bcgov/moh-plr-fhir\">https://github.com/bcgov/moh-plr-fhir</a></p>",
        "id": 231091149,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616188530
    },
    {
        "content": "<p>It's also happening on the <a href=\"https://github.com/HL7/fhir-subscription-backport-ig\">Subscription Backport IG</a>, which is fairly simple.</p>",
        "id": 231091253,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1616188570
    },
    {
        "content": "<p>quick question, does sushi work on linux</p>",
        "id": 231091567,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188784
    },
    {
        "content": "<p>yep</p>",
        "id": 231091619,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1616188806
    },
    {
        "content": "<p>kk</p>",
        "id": 231091632,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188810
    },
    {
        "content": "<p>wanted to make sure</p>",
        "id": 231091643,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616188822
    },
    {
        "content": "<p>Yeah, that code all got added on March 2nd.  The problem is that the list of valid type codes is only String.  In the snapshots that are being created, we have the following declaration of type:</p>\n<div class=\"codehilite\"><pre><span></span><code>        &quot;type&quot;: [\n          {\n            &quot;extension&quot;: [\n              {\n                &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-fhir-type&quot;,\n                &quot;valueUrl&quot;: &quot;uri&quot;\n              }\n            ],\n            &quot;code&quot;: &quot;http://hl7.org/fhirpath/System.String&quot;\n          }\n        ],\n</code></pre></div>\n<p>The validation uses this where the type is declared as fhirpath/System.String.  That is actually incorrect.  It should be \"<a href=\"http://hl7.org/fhir/data-types/uri\">http://hl7.org/fhir/data-types/uri</a>\".</p>\n<p>This leads me to believe that the bug is not necessarily in this new validation routine but in the snapshot generation which is putting the wrong type for this element.</p>",
        "id": 231092519,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616189402
    },
    {
        "content": "<p>I think the issue is that the code isn't doing camel-casing properly.  It should be looking for fixedUri rather than fixeduri</p>",
        "id": 231092921,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1616189644
    },
    {
        "content": "<p>i'm not sure that an earlier report about changing it to uri wasn't a red herring.  Here's the code where it builds up the valid set of types:</p>\n<div class=\"codehilite\"><pre><span></span><code>    List&lt;Element&gt; types = element.getChildrenByName(&quot;type&quot;);\n    Set&lt;String&gt; typeCodes = new HashSet&lt;&gt;();\n    for (Element type : types) {\n      if (hasMustSupportExtension(type)) {\n        typeMustSupport = true;\n      }\n      typeCodes.add(type.getChildValue(&quot;code&quot;));\n      // check the stated profile - must be a constraint on the type\n      if (snapshot || sd != null) {\n        validateElementType(errors, type, stack.push(type, -1, null, null), sd, element.getChildValue(&quot;path&quot;));\n      }\n    }\n</code></pre></div>\n<p>It's just looking at element.type.code.</p>",
        "id": 231093086,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616189760
    },
    {
        "content": "<p>That totally fits with the error message: The element Extension.url has a fixed of type uri, which is not in the list of allowed types ([http://hl7.org/fhirpath/System.String])</p>\n<p>The only value in the typeCode array is System.String because that's exactly what the snapshot says it can be.  So fixedUri isn't allowed.  fixedSystem.String would be :)</p>",
        "id": 231093226,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616189851
    },
    {
        "content": "<p>Extension.url has a type of 'uri' - so why is the list of allowed types only String?</p>",
        "id": 231093421,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1616189987
    },
    {
        "content": "<p>look up in the chat.  because the snapshot is saying that it's type is [http://hl7.org/fhirpath/System.String]</p>",
        "id": 231093504,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616190018
    },
    {
        "content": "<p>So it's a snapshot generation issue?</p>",
        "id": 231093548,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1616190039
    },
    {
        "content": "<p>yes, I think this is actually a bug in snapshot generation</p>",
        "id": 231093561,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616190053
    },
    {
        "content": "<p>yeah, I manually changed the generated structure definition from \"<a href=\"http://hl7.org/fhirpath/System.String\">http://hl7.org/fhirpath/System.String</a>\" to \"string\" or \"uri\" and then ran the validator and it passed.</p>",
        "id": 231094863,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616190807
    },
    {
        "content": "<p>I'm not sure why the snapshot generation is putting both \"string\" and \"uri\" to \"<a href=\"http://hl7.org/fhirpath/System.String\">http://hl7.org/fhirpath/System.String</a>\".  There might be a reason for that.  But if there is, the validator code that checks types doesn't recognize it.</p>",
        "id": 231095059,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616190936
    },
    {
        "content": "<p>so explain to me exactly what would need to be changed here</p>",
        "id": 231095061,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616190937
    },
    {
        "content": "<p>when the generation happens you want uri's to be labelled as Strings?</p>",
        "id": 231095128,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616190965
    },
    {
        "content": "<p>well, I think the easiest solution is to comment out lines 152-162 in the StructureDefinitionValidator.  I'm loathe to change the snapshot generator without knowing why it's spitting out <a href=\"http://hl7.org/fhirpath/System.String\">http://hl7.org/fhirpath/System.String</a>.</p>",
        "id": 231095175,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616190999
    },
    {
        "content": "<p>okay, i can make that change in the validator for now, and then tag Grahame to actually figure out what is going on when he is back from being sick</p>",
        "id": 231095310,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616191083
    },
    {
        "content": "<p>exactly.  Can you point me to the code that does snapshot generation?  I can look into that and see if I can see why it's doing what it is doing.</p>",
        "id": 231095367,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616191112
    },
    {
        "content": "<p>I will have to run the full test suite to make sure I don' mess up anythig</p>",
        "id": 231095377,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616191120
    },
    {
        "content": "<p>give me a bit</p>",
        "id": 231095387,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616191128
    },
    {
        "content": "<p>PR here: <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/465\">https://github.com/hapifhir/org.hl7.fhir.core/pull/465</a></p>",
        "id": 231097464,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616192365
    },
    {
        "content": "<p>pardon my ignorance, but what is the process to move from the pull request to getting out a new release of the publisher?</p>",
        "id": 231098480,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616193069
    },
    {
        "content": "<p>lots of pipelines</p>",
        "id": 231100108,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194121
    },
    {
        "content": "<p>I will detail shortly</p>",
        "id": 231100113,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194125
    },
    {
        "content": "<p>Phrased a different way - <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> do you expect to push out a new version of the publisher incorporating that rollback \"soon-ish\"?</p>",
        "id": 231100260,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1616194215
    },
    {
        "content": "<p>:)</p>",
        "id": 231100266,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1616194218
    },
    {
        "content": "<p>Version 5.3.6 of the core libraries will have this fix, the pipeline running the job is here: <a href=\"https://dev.azure.com/fhir-pipelines/fhir-core-library/_build/results?buildId=2855&amp;view=results\">https://dev.azure.com/fhir-pipelines/fhir-core-library/_build/results?buildId=2855&amp;view=results</a></p>",
        "id": 231100285,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194224
    },
    {
        "content": "<p>this will take 45ish min to release</p>",
        "id": 231100305,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194237
    },
    {
        "content": "<p>once that is completed, I will need to release the IG publisher</p>",
        "id": 231100319,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194250
    },
    {
        "content": "<p>The current version of the IG publisher is 1.1.63, these changes will be released in IG publisher 1.1.64</p>",
        "id": 231100394,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194306
    },
    {
        "content": "<p>if everything works this should all be done in a couple hours</p>",
        "id": 231100530,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194386
    },
    {
        "content": "<p>takes time to upload and run all the tests and such</p>",
        "id": 231100541,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616194396
    },
    {
        "content": "<p>The latest build is live</p>",
        "id": 231107449,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616199277
    },
    {
        "content": "<p>v1.1.64 is available to download here: <a href=\"https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.64\">https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.64</a></p>",
        "id": 231107465,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616199300
    },
    {
        "content": "<p>please let me know if there is an issue</p>",
        "id": 231107497,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1616199328
    },
    {
        "content": "<p>this is properly working the latest validator now</p>",
        "id": 232384256,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1617088888
    },
    {
        "content": "<p>Did you fix the snapshot generation code?  We have an R5 ticket that has the same symptoms that caused this validation error.</p>",
        "id": 232385206,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1617089457
    },
    {
        "content": "<p>no the problem was in the validator.</p>",
        "id": 232482604,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1617132206
    },
    {
        "content": "<p>really?  Because we have a JIRA issues that seems related:<br>\n<a href=\"http://jira.hl7.org/browse/FHIR-28586\">FHIR-28586</a>: unsignedInt.value has a type.code of System.String</p>\n<div class=\"codehilite\"><pre><span></span><code>    {\n      &quot;id&quot; : &quot;unsignedInt.value&quot;,\n      &quot;path&quot; : &quot;unsignedInt.value&quot;,\n      &quot;representation&quot; : [&quot;xmlAttr&quot;],\n      &quot;short&quot; : &quot;Primitive value for unsignedInt&quot;,\n      &quot;definition&quot; : &quot;Primitive value for unsignedInt&quot;,\n      &quot;min&quot; : 0,\n      &quot;max&quot; : &quot;1&quot;,\n      &quot;type&quot; : [{\n        &quot;extension&quot; : [{\n          &quot;url&quot; : &quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-fhir-type&quot;,\n          &quot;valueUri&quot; : &quot;unsignedInt&quot;\n        },\n        {\n          &quot;url&quot; : &quot;http://hl7.org/fhir/StructureDefinition/regex&quot;,\n          &quot;valueString&quot; : &quot;[0]|([1-9][0-9]*)&quot;\n        }],\n        &quot;code&quot; : &quot;http://hl7.org/fhirpath/System.String&quot;\n      }\n</code></pre></div>\n<p>Do you know why the snapshot generation is putting System.String here?</p>",
        "id": 232487209,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1617134119
    },
    {
        "content": "<p>for what version?</p>",
        "id": 232504284,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1617141502
    },
    {
        "content": "<p>that's currently in R5</p>",
        "id": 232504508,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1617141615
    },
    {
        "content": "<p>oh. not an IG issue?</p>",
        "id": 232504612,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1617141658
    },
    {
        "content": "<p>that's not an IG issue but it looked the same as the error we saw in the IGs</p>",
        "id": 232506231,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1617142475
    },
    {
        "content": "<p>yes it should be System.Integer not System.String</p>",
        "id": 232516386,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1617148956
    },
    {
        "content": "<p>right.  do you know where this gets created?  Marc and I couldn't see it, so I assigned the issue to you.  If it's something you can point me to, i.e. not some snapshot generation code, then I'll take it back</p>",
        "id": 232519997,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1617151777
    },
    {
        "content": "<p>it's in code, that one. Just found it. I'll commit it now but it won't be released for a few days</p>",
        "id": 232520654,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1617152344
    },
    {
        "content": "<p>thanks.  i'll mark the issue as applied.</p>",
        "id": 232520772,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1617152418
    },
    {
        "content": "<p><a href=\"https://github.com/HL7/kindling/pull/12\">https://github.com/HL7/kindling/pull/12</a></p>",
        "id": 232522053,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1617153677
    }
]