[
    {
        "content": "<p>So I'm trying to use the us-core-race extension. The example in the US Core IG has:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;extension url=&quot;http://hl7.org/fhir/us/core/StructureDefinition/us-core-race&quot;&gt;\n    &lt;extension url=&quot;ombCategory&quot;&gt;\n      &lt;valueCoding&gt;\n        &lt;system value=&quot;urn:oid:2.16.840.1.113883.6.238&quot;/&gt;\n        &lt;code value=&quot;2106-3&quot;/&gt;\n        &lt;display value=&quot;White&quot;/&gt;\n      &lt;/valueCoding&gt;\n    &lt;/extension&gt;\n</code></pre></div>\n<p>If I try to use urn:oid:2.16.840.1.113883.6.238 I get <code>Code System URI 'urn:oid:2.16.840.1.113883.6.238' is unknown so the code cannot be validated</code></p>\n<p>So I looked in the VSAC package and saw:  \"<a href=\"http://terminology.hl7.org/CodeSystem/v2-0005\">http://terminology.hl7.org/CodeSystem/v2-0005</a>\". So I replaced urn:oid:2.16.840.1.113883.6.238 with that.</p>\n<p>Now I am getting: \"The Coding provided (<a href=\"http://terminology.hl7.org/CodeSystem/v2-0005#2054-5\">http://terminology.hl7.org/CodeSystem/v2-0005#2054-5</a>) is not in the value set <a href=\"http://hl7.org/fhir/us/core/ValueSet/omb-race-category\">http://hl7.org/fhir/us/core/ValueSet/omb-race-category</a>, and a code is required from this value set. (error message = Not in value set <a href=\"http://hl7.org/fhir/us/core/ValueSet/omb-race-category\">http://hl7.org/fhir/us/core/ValueSet/omb-race-category</a>)\"</p>\n<p>When I look up the OID there are two pages: <a href=\"https://terminology.hl7.org/2.1.0/CodeSystem-PHRaceAndEthnicityCDC.html\">https://terminology.hl7.org/2.1.0/CodeSystem-PHRaceAndEthnicityCDC.html</a> and <a href=\"https://terminology.hl7.org/2.1.0/CodeSystem-v2-0005.html\">https://terminology.hl7.org/2.1.0/CodeSystem-v2-0005.html</a></p>\n<p>How does this work? Why can't I get what is working in the US Core example to work in my IG?</p>\n<p>The code 2054-5 is clearly in the value set: <a href=\"http://hl7.org/fhir/us/core/ValueSet/omb-race-category\">http://hl7.org/fhir/us/core/ValueSet/omb-race-category</a>. But with the urn:oid:2.16.840.1.113883.6.238 code system, which I can't get to work...</p>",
        "id": 237736761,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1620338186
    },
    {
        "content": "<p>My dependency is to the US Core January ballot version (because ballot comments wanted us to use the new Vital Records profiles). Obviously we will have to point to the published US Core once it's published.  Could this have anything to do with it?</p>",
        "id": 237737544,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1620338583
    },
    {
        "content": "<p>I'm thinking that this might have something to do with the fact that in the new version of US Core - one of the value sets is defined in VSAC and the other isn't... Might have to use different values for the same code system... (<a href=\"http://hl7.org/fhir/us/core/2021Jan/ValueSet-omb-race-category.html\">http://hl7.org/fhir/us/core/2021Jan/ValueSet-omb-race-category.html</a> and <a href=\"https://vsac.nlm.nih.gov/valueset/2.16.840.1.113883.1.11.14914/expansion\">https://vsac.nlm.nih.gov/valueset/2.16.840.1.113883.1.11.14914/expansion</a>).</p>\n<p>Coincidentally I'm just talking to <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> and <span class=\"user-mention\" data-user-id=\"191410\">@Brett Marquard</span> about moving that one that isn't in VSAC into VSAC...</p>",
        "id": 237738940,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1620339264
    },
    {
        "content": "<p>Now I remember that there is a problem with this race and vsac thing;</p>\n<ul>\n<li>CDCREC codes and code system value ( OID vs ? defined in package or by VSAC ????) <a href=\"#narrow/stream/179252-IG-creation/topic/cdcrec.20code.20errors.20in.20US.20Core\">see this Zulip for details</a> per 12/2 FMG won't be able to sort out by ballot.</li>\n</ul>",
        "id": 237739974,
        "sender_full_name": "Eric Haas",
        "timestamp": 1620339848
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> !</p>",
        "id": 237740266,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1620340030
    },
    {
        "content": "<p>So based on that thread - right now there is nothing that I can do to get the examples to validate? We have to wait until a VSAC alignment is done?</p>",
        "id": 237741544,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1620340830
    },
    {
        "content": "<p>OK I investigated this further and  downloaded the VSAC expansion for  race valueset 2.16.840.1.114222.4.11.8 336  (<a href=\"https://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.836/$expand\">https://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.836/$expand</a>)  and it appears they are using the OID for the code system.   But <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  when I open up the valueset 2.16.840.1.114222.4.11.836  in the us.nlm.vsac#0.3.0 package file it  is using the url:<code>http://cts.nlm.nih.gov/fhir/cs/cdcrec</code>:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">ValueSet</span>\n<span class=\"nt\">id</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">2.16.840.1.114222.4.11.836</span>\n<span class=\"nt\">meta</span><span class=\"p\">:</span>\n  <span class=\"nt\">versionId</span><span class=\"p\">:</span> <span class=\"s\">'1'</span>\n  <span class=\"nt\">lastUpdated</span><span class=\"p\">:</span> <span class=\"s\">'2012-10-25T12:28:31.000-04:00'</span>\n<span class=\"nt\">text</span><span class=\"p\">:</span>\n  <span class=\"nt\">status</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">generated</span>\n<span class=\"nt\">url</span><span class=\"p\">:</span> <span class=\"s\">'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.836'</span>\n<span class=\"nt\">version</span><span class=\"p\">:</span> <span class=\"s\">'20121025'</span>\n<span class=\"nt\">name</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Race</span>\n<span class=\"nt\">status</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">active</span>\n<span class=\"nt\">date</span><span class=\"p\">:</span> <span class=\"s\">'2012-10-25T12:28:31-04:00'</span>\n<span class=\"nt\">publisher</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">CDC NCHS</span>\n<span class=\"nt\">compose</span><span class=\"p\">:</span>\n  <span class=\"nt\">include</span><span class=\"p\">:</span>\n    <span class=\"p p-Indicator\">-</span> <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"s\">'http://cts.nlm.nih.gov/fhir/cs/cdcrec'</span> <span class=\"c1\">#&lt;&lt;&lt;&lt;&lt;not 2.16.840.1.114222.4.11.836!</span>\n      <span class=\"nt\">concept</span><span class=\"p\">:</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">1002-5</span>\n          <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">American Indian or Alaska Native</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">2028-9</span>\n          <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Asian</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">2054-5</span>\n          <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Black or African American</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">2076-8</span>\n          <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Native Hawaiian or Other Pacific Islander</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">2106-3</span>\n          <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">White</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">2131-1</span>\n          <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Other Race</span>\n</code></pre></div>",
        "id": 242011133,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623205283
    },
    {
        "content": "<p>I am pretty sure this is causing validation errors for patient race values like those that can be seen here: <a href=\"http://build.fhir.org/ig/HL7/US-Core/qa.html\">http://build.fhir.org/ig/HL7/US-Core/qa.html</a>   and described by Sarah</p>\n<p>When do you think you can look into this?</p>",
        "id": 242011403,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623205576
    },
    {
        "content": "<p>well, first of all, where is this code system actually meant to be defined?</p>",
        "id": 242558110,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623653309
    },
    {
        "content": "<p>I am not sure what you mean.  All I want is the code system to be consistently the OID throughout and the errors to go away.</p>",
        "id": 242618076,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623685720
    },
    {
        "content": "<p>the code system actually has to be defined somewhere for the errors to go away</p>",
        "id": 242625968,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623688934
    },
    {
        "content": "<p>Following the breadcrumbs here:</p>\n<p><a href=\"/user_uploads/10155/Q3BfMXmX9AHl_Cs25PABDl7u/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/Q3BfMXmX9AHl_Cs25PABDl7u/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/Q3BfMXmX9AHl_Cs25PABDl7u/image.png\"></a></div>",
        "id": 242640653,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623695543
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/ig/HL7/UTG/CodeSystem-v3-Race.html\">http://build.fhir.org/ig/HL7/UTG/CodeSystem-v3-Race.html</a></p>",
        "id": 242642212,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623696301
    },
    {
        "content": "<p>except they don't use the same OID that is used in CCDA and FHIR  (2.16.840.1.113883.6.238): </p>\n<p>there are two other codessytems called: CodeSystem: PH_RaceAndEthnicity_CDC which do use the OID, but don't enumerate any codes so this seems to be  a muddled mess</p>\n<p>I guess the next step is to harangue HTA...  <a href=\"#narrow/stream/179202-terminology/topic/US.20CDCREC.20codessystems.20in.20HTA/near/242645695\">https://chat.fhir.org/#narrow/stream/179202-terminology/topic/US.20CDCREC.20codessystems.20in.20HTA/near/242645695</a></p>",
        "id": 242643352,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623696840
    },
    {
        "content": "<p>right. raise it on <a class=\"stream\" data-stream-id=\"179202\" href=\"/#narrow/stream/179202-terminology\">#terminology</a>, because I can't solve that</p>",
        "id": 242651581,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1623700775
    },
    {
        "content": "<p>So now we have determined the issue with CDCREC  codesystem,  we put the CDCREC code system back  into US Core until HTA can get that sorted out.   This resolves many but not all of the errors with race and ethnicity</p>",
        "id": 242977293,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623910854
    },
    {
        "content": "<p>These errors remain:</p>\n<p><a href=\"/user_uploads/10155/uJwoNu9j-qOQ6vQ0T5ZBYIT4/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/uJwoNu9j-qOQ6vQ0T5ZBYIT4/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/uJwoNu9j-qOQ6vQ0T5ZBYIT4/image.png\"></a></div>",
        "id": 242977307,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623910870
    },
    {
        "content": "<p>And I believe there are related to the  nlm vsac package version 0.3.0.</p>",
        "id": 242977389,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623910939
    },
    {
        "content": "<p>the code systems in the package for the following value sets are not in alignment with the latest VSAC expansions I downloaded.</p>\n<ul>\n<li><a href=\"http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.837\">http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.837</a></li>\n<li><a href=\"http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.877\">http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.877</a></li>\n<li><a href=\"http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.1.11.14914\">http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.1.11.14914</a></li>\n</ul>",
        "id": 242977552,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623911121
    },
    {
        "content": "<p>for example for valueset 877:</p>\n<p>package file:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"nt\">\"resourceType\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ValueSet\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"2.16.840.1.114222.4.11.877\"</span>\n  <span class=\"err\">...</span>\n  <span class=\"nt\">\"compose\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"include\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">\"system\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://terminology.hl7.org/CodeSystem/v2-0005\"</span><span class=\"p\">,</span>  <span class=\"err\">#&lt;&lt;&lt;&lt;</span> <span class=\"err\">SHOULD</span> <span class=\"err\">BE</span> <span class=\"err\">OID</span>\n        <span class=\"nt\">\"version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1.2\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"concept\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"err\">....</span>\n</code></pre></div>",
        "id": 242977784,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623911368
    },
    {
        "content": "<p>vs direct expansion from VSAC:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code><span class=\"cp\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>\n\n<span class=\"nt\">&lt;ValueSet</span> <span class=\"na\">xmlns=</span><span class=\"s\">\"http://hl7.org/fhir\"</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">\"2.16.840.1.114222.4.11.877\"</span><span class=\"nt\">/&gt;</span>\n ...\n    <span class=\"nt\">&lt;contains&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"urn:oid:2.16.840.1.113883.6.238\"</span><span class=\"nt\">/&gt;</span>  <span class=\"c\">&lt;!-- Correct OID in expansion --&gt;</span>\n      <span class=\"nt\">&lt;version</span> <span class=\"na\">value=</span><span class=\"s\">\"1.2\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"2137-8\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Spaniard\"</span><span class=\"nt\">/&gt;</span>\n</code></pre></div>",
        "id": 242977987,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623911540
    },
    {
        "content": "<p>So we are going  work around this by  using  the US Core valuesets from the prior version and use vsac whenever the package is fixed.</p>",
        "id": 242978282,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623911833
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"191410\">@Brett Marquard</span>  and <span class=\"user-mention\" data-user-id=\"191991\">@Gay Dolin</span></p>",
        "id": 243045578,
        "sender_full_name": "Eric Haas",
        "timestamp": 1623947544
    }
]