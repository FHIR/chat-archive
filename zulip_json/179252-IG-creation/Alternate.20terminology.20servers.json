[
    {
        "content": "<p>Based last month's terminology server scramble, it looks like it is possible to use a terminology server other than <a href=\"http://tx.fhir.org\">tx.fhir.org</a> for the IG publisher. That raises some questions about organizations hosting their own terminology servers:</p>\n<ul>\n<li>To host a terminology server only for IG build support , what capabilities does it need? Can it be a static website that just supports downloading  ValueSet and CodeSystem resources? Does it need to support the full terminology services spec (<a href=\"http://build.fhir.org/terminology-service.html\">http://build.fhir.org/terminology-service.html</a>) or does the IG publisher use a subset?</li>\n<li>Is there anyway to pass credentials or a token through the publisher, so the terminology server can determine the user is authorized? </li>\n<li>Does that server have to support all terminology used in the IGs built pointing at it, or can it define only the local terminology and defer other content to <a href=\"http://tx.fhir.org\">tx.fhir.org</a>? Or can publisher be pointed at multiple terminology servers?</li>\n</ul>\n<p>Or, am I looking at this the wrong way, and the correct path is for an organization to get their vocabulary into <a href=\"http://tx.fhir.org\">tx.fhir.org</a>, or to publishing an IG with their vocabulary in it?</p>",
        "id": 249943039,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629350162
    },
    {
        "content": "<p>in principle, there is an intent to support alternative servers, though not for Hl7 published content. Documenting the requirements is still on my todo list. The publisher makes extensive use of $expand and $validate-code, and there's some very deep requirements around validate-code and particular code systems.</p>\n<p>in principle, it may be possible to delegate some terminologies to another server. That's also on my todo list. It's also good to get vocabulary onto <a href=\"http://tx.fhir.org\">tx.fhir.org</a>. That's all there is right now, actually</p>",
        "id": 249943798,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629351214
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/249943798\">said</a>:</p>\n<blockquote>\n<p>though not for Hl7 published content</p>\n</blockquote>\n<p>What about HL7 affiliates? Are they expected to put terminologies in <a href=\"http://tx.fhir.org\">tx.fhir.org</a>?</p>\n<blockquote>\n<p>The publisher makes extensive use of $expand and $validate-code</p>\n</blockquote>\n<p>That's what I was afraid of. So a static website isn't enough. Even a FHIR server that supports CodeSystem and ValueSet and their associated search parameters (including canonical resolution) isn't enough. It needs to support specific terminology capabilities.</p>\n<blockquote>\n<p>It's also good to get vocabulary onto <a href=\"http://tx.fhir.org\">tx.fhir.org</a>. </p>\n</blockquote>\n<p>This may sound silly, but why? (Other than that's all that is really supported right now.) The demands to keep vocabulary up to date will continue to grow. Will HL7 be able to handle the demand? What about organizations that have IP restrictions on their vocab, and don't want it on a public server?</p>",
        "id": 249944520,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629352162
    },
    {
        "content": "<blockquote>\n<p>What about HL7 affiliates? </p>\n</blockquote>\n<p>The intention is that affiliates can nominate alternative tx servers, but they can't right now</p>\n<blockquote>\n<p>It needs to support specific terminology capabilities.</p>\n</blockquote>\n<p>Yes. It hammers them</p>\n<blockquote>\n<p>It's also good to get vocabulary onto <a href=\"http://tx.fhir.org\">tx.fhir.org</a>.</p>\n</blockquote>\n<p>because then everyione can access it easily. </p>\n<blockquote>\n<p>Will HL7 be able to handle the demand?</p>\n</blockquote>\n<p>the intent is that it will rest on the package infrastructure - so publish it through packages, <a href=\"http://tx.fhir.org\">tx.fhir.org</a> will pick it up</p>\n<blockquote>\n<p>What about organizations that have IP restrictions on their vocab, and don't want it on a public server?</p>\n</blockquote>\n<p>Then of course it won't go on <a href=\"http://tx.fhir.org\">tx.fhir.org</a>, and right now, that's not supported, though as I said, it's on the roadmap</p>",
        "id": 249944700,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629352369
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/249944700\">said</a>:</p>\n<blockquote>\n<p>the intent is that it will rest on the package infrastructure - so publish it through packages, <a href=\"http://tx.fhir.org\">tx.fhir.org</a> will pick it up</p>\n</blockquote>\n<p>Interesting. </p>\n<p>That circles back to an earlier thought I had -- your description of the terminology server requirements makes me think that the IG publisher ignores ~/.fhir/packages for terminology. If I had a package for my, e.g. IP-restricted vocabulary, just adding it there wouldn't do any good.</p>",
        "id": 249945509,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629353391
    },
    {
        "content": "<p>no it only load what it's told to load. Add it as a dependency</p>",
        "id": 249947328,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629355442
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/249943798\">said</a>:</p>\n<blockquote>\n<p>in principle, there is an intent to support alternative servers, though not for Hl7 published content. Documenting the requirements is still on my todo list. The publisher makes extensive use of $expand and $validate-code, and there's some very deep requirements around validate-code and particular code systems.</p>\n</blockquote>\n<p>I'm wondering if those 'deep' requirements relate to use outside of the validation requirements of the IG Publisher?  The fact is that no one Terminology Server is going to have all of the Code Systems and the (federated) approach I'd like to see is that a local/national Terminology Server is called by the Validator and re-directs to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> for HL7 vocabularies. This is very difficult to do when the $validate-code requests are POSTs with complex, non-standard, parameters (e.g. expansion profiles) - it would be so much easier if they were GET requests. Are these additional parameters required for validating IGs, or more complex operations such as the build process?</p>",
        "id": 249948224,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1629356327
    },
    {
        "content": "<p>GET / POST doesn't make any difference. The complexity does... and there's lots of that, because people want features. So the complexity isn't going away.</p>",
        "id": 249948831,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629356850
    },
    {
        "content": "<p>but they're not non-standard. The validation part is; I need to work on that, because the validate-code API needs work to support the validator. That's one of the issues. But others relate to expansion parameters that must be supported</p>",
        "id": 249948842,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629356861
    },
    {
        "content": "<p>Peter, I believe part of the issue is that for anything HL7 publishes, they want to be able to verify it is correct.  If I build an IG that validates against my local terminology server, I can say that anything is valid and correct.</p>",
        "id": 249976446,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1629374870
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/249947328\">said</a>:</p>\n<blockquote>\n<p>no it only load what it's told to load. Add it as a dependency</p>\n</blockquote>\n<p>Even if I add a terminology package to my cache, and add it as a dependency in my IG, I can't build the IG using that vocab, because the publisher requires an actual server to validate against, correct?</p>\n<p><span class=\"user-mention silent\" data-user-id=\"191364\">Peter Jordan</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/249948224\">said</a>:</p>\n<blockquote>\n<p>The fact is that no one Terminology Server is going to have all of the Code Systems and the (federated) approach I'd like to see is that a local/national Terminology Server is called by the Validator and re-directs to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> for HL7 vocabularies.</p>\n</blockquote>\n<p>I think a federated/distributed approach will be needed, but I don't know that we need redirects. If the publisher has a list of servers, it can try each of them until it finds the one hosting the resources it needs. Supporting multiple servers would also allow for cases where Org A hosts a terminology server with their vocab, Org B hosts a server with their vocab, there is a national server, and the default HL7 server; a redirect-chained approach couldn't handle that.</p>",
        "id": 250000468,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629385846
    },
    {
        "content": "<p>when the publisher tries each of them until it finds what it needs - that polling could become a lot of unnecessary traffic, no?</p>",
        "id": 250002032,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1629386488
    },
    {
        "content": "<p>unnecessary unless that result is what your IG needs. but, agreed there must be a better way.</p>",
        "id": 250002260,
        "sender_full_name": "John Moehrke",
        "timestamp": 1629386593
    },
    {
        "content": "<blockquote>\n<p>I can't build the IG using that vocab, because the publisher requires an actual server to validate against</p>\n</blockquote>\n<p>The IG publisher has an internal mini terminology server that evaluates things locally when possible</p>",
        "id": 250042365,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629403662
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191832\">Jose Costa Teixeira</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/250002032\">said</a>:</p>\n<blockquote>\n<p>when the publisher tries each of them until it finds what it needs - that polling could become a lot of unnecessary traffic, no?</p>\n</blockquote>\n<p>My approach only requires a local/national Terminology Server and the re-direction of requests to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> for any artefacts with HL7 URLs. However, at present, it only does this for GET requests...so work to do, AND I need to understand some of the complex IG validation use cases that Grahame refers to. Are these such that they need to be handled in a single place?</p>",
        "id": 250054143,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1629409996
    },
    {
        "content": "<p>it's certainly easier for me for the terminology server to handle delegation, and I may investigate that when I work on this</p>",
        "id": 250057237,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629412159
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/250042365\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>I can't build the IG using that vocab, because the publisher requires an actual server to validate against</p>\n</blockquote>\n<p>The IG publisher has an internal mini terminology server that evaluates things locally when possible</p>\n</blockquote>\n<p>What triggers non-local evaluation? </p>\n<p>I guess what I'm wondering is if I can distribute a package of my terminology, can I get away without a terminology server?</p>\n<p><span class=\"user-mention silent\" data-user-id=\"191364\">Peter Jordan</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/250054143\">said</a>:</p>\n<blockquote>\n<p>My approach only requires a local/national Terminology Server and the re-direction of requests to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> for any artefacts with HL7 URLs. </p>\n</blockquote>\n<p>This only works if you can link your terminology servers into one chain: (local -&gt;) national -&gt; HL7. How about an IG that draws on vocab from two national terminologies, or two private terminology servers? Jose's polling concerns can be dealt with through caching (perhaps), etags, etc.</p>",
        "id": 250060122,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629414707
    },
    {
        "content": "<p>right. life is really complex. And it'll never be as simple as 'any artefacts with HL7 URLs' - <a href=\"http://tx.fhir.org\">tx.fhir.org</a> does all sorts of terminologies that you'll run into accidentally.</p>",
        "id": 250060717,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629415214
    },
    {
        "content": "<blockquote>\n<p>What triggers non-local evaluation?</p>\n</blockquote>\n<p>When local evaluation fails. Then the IG publisher bundles up everything it has locally that's relevant and hands it off to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> and that tries.</p>",
        "id": 250060748,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629415253
    },
    {
        "content": "<p>So you can have a value set that mixes a local terminology to the IG, and a terminology  only known to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> (we have several IGs that do this)</p>",
        "id": 250060768,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629415281
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/250060748\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>What triggers non-local evaluation?</p>\n</blockquote>\n<p>When local evaluation fails. </p>\n</blockquote>\n<p><span aria-label=\"rolling eyes\" class=\"emoji emoji-1f644\" role=\"img\" title=\"rolling eyes\">:rolling_eyes:</span></p>",
        "id": 250060915,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629415396
    },
    {
        "content": "<p>So this would be things like a local ValueSet using a <a href=\"http://tx.fhir.org\">tx.fhir.org</a> CodeSystem, and needing to check if the values are actually in the code system?</p>",
        "id": 250061022,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629415503
    },
    {
        "content": "<p>sure. Snomed / LOINC / RxNorm, which are too big to load into the IG publisher on the fly</p>",
        "id": 250061246,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629415693
    },
    {
        "content": "<p>OK. I think I'm getting there.</p>\n<p>Taking the opposite approach, what's needed to get terminology hosted on <a href=\"http://tx.fhir.org\">tx.fhir.org</a>?</p>",
        "id": 250061438,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629415863
    },
    {
        "content": "<p>Previously(?) there were some proprietary APIs that were being used to (as I understood things) temporarily load content into the terminology server.  Are these still being used, or only conditionally used if the tx server supports them?</p>",
        "id": 250061590,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1629415997
    },
    {
        "content": "<p>I was thinking less about mechanics and more about policy, etc. but I suppose the mechanics are important too.</p>",
        "id": 250061677,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1629416055
    },
    {
        "content": "<p>policy wise, you just have to ask, and provide reasonable evidence that you have the authority to ask</p>",
        "id": 250061802,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629416165
    },
    {
        "content": "<p>if you have CodeSystem or ValueSet resources, just release them as a package, and ask. Or you can make them as a contribution to  <a href=\"https://github.com/FHIR/packages/tree/master/packages/fhir.tx.support.r4\">https://github.com/FHIR/packages/tree/master/packages/fhir.tx.support.r4</a></p>",
        "id": 250061846,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629416235
    },
    {
        "content": "<p>if they're too big for a FHIR resource, then we need to talk about that</p>",
        "id": 250061856,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629416247
    },
    {
        "content": "<p>Sorry, I wasn't asking in the context of your question <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> .  Rather I was keen to know whether there is a barrier to using other tx servers.</p>",
        "id": 250061949,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1629416310
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> wrt too big for a FHIR resource, what is the size limit?  We have a FHIR CodeSystem that is more than 300MB in size</p>",
        "id": 250062758,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1629417099
    },
    {
        "content": "<p>pragmatic. My server doesn't set a limit, it just gets slow</p>",
        "id": 250063201,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629417548
    },
    {
        "content": "<p><a href=\"http://tx.fhir.org\">tx.fhir.org</a> does run some modifications to the terminology service API, and it is on my todo list to document them. The two that stick to mind are:</p>\n<ul>\n<li>more control over validation using a paremeter to tell the terminology server what to validate</li>\n<li>a session mechanism that means that content is only posted to the terminology server once by the validator / IG publisher, instead of every time (makes a lot of difference to performance)</li>\n</ul>",
        "id": 250063348,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1629417678
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"222054\">Gino Canessa</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Alternate.20terminology.20servers/near/249976446\">said</a>:</p>\n<blockquote>\n<p>Peter, I believe part of the issue is that for anything HL7 publishes, they want to be able to verify it is correct.  If I build an IG that validates against my local terminology server, I can say that anything is valid and correct.</p>\n</blockquote>\n<p>Sure, that's why I re-direct to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> for HL7 terminologies. BTW: I've just worked on my solution for POSTs which, of course, become 307 GET requests when re-directed, so all the parameters need to go in the query string and that won't be possible where resources such as value sets are in the request payload.</p>",
        "id": 250079901,
        "sender_full_name": "Peter Jordan",
        "timestamp": 1629437588
    }
]