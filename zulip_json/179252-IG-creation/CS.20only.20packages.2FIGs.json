[
    {
        "content": "<p>Grahame adviced to move the topic from implementers to this channel:<br>\nI am currently trying to create fhir packages for (big) CodeSystems like ICD10, NCIT, etc..<br>\nThese are converted directly from CLAML -&gt; FHIR, some are authored in FSH. While sushi is quite fast at creating the CS json files, the IG publisher struggles and takes almost 3h on a 8core 16gig gitlab runner.<br>\nMost of the time is consumed by validation and narrative generation.</p>\n<p>My preferred solution would be to be able to disable narrative generation and validation for the IG creation in the ig publisher, as far as is saw this is not possible at the moment.<br>\n2nd Option would be to just use sushi and package manually in a CI step. Which doesn't produce a IG html page where guidance for these CodeSystems should go.<br>\nIs there an easy solution which i am missing?</p>",
        "id": 253407620,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631710372
    },
    {
        "content": "<p>Current idea is to first invoke sushi and the use the hapi cli to create the package</p>",
        "id": 253407726,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631710435
    },
    {
        "content": "<p>But i could also see IG Publisher supporting this use-case. Could be done through enabling deactivation of the 2 time-consuming steps (narrative generation and validation) in the  ig.ini</p>",
        "id": 253408189,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631710662
    },
    {
        "content": "<p>I think an IG parameter for disabling validation would make sense here</p>",
        "id": 253411818,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631712094
    },
    {
        "content": "<p>this would go into ig.ini, right?</p>",
        "id": 253415404,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631713390
    },
    {
        "content": "<p>I don't know about a parameter.  This isn't something that should <em>always</em> be true for the IG.  When it comes time to publish, you'd need full validation and narrative generation.  You'd just like to be able to iterate more quickly some of the time.  So it seems to me that a launch parameter would make more sense?</p>",
        "id": 253417733,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1631714169
    },
    {
        "content": "<p>I meantit as a repeatable parameter with the canonical urls.</p>",
        "id": 253419771,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631714834
    },
    {
        "content": "<p>something like \"skipValidationUrl\"</p>",
        "id": 253420349,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631715011
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> We have one package containing ICD, NCIT, ATC ...... Validates approx 3hours.<br>\nThis is something we are doing manually from time to time. These FHIR Ressources are FSH generated, so sushi is our CI testing tool.</p>",
        "id": 253420394,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631715032
    },
    {
        "content": "<p>So for our use-case ig.ini parameters:<br>\nskipNarrativeGeneration<br>\nskipValidation</p>\n<p>would make sense. As this a CS only package we don't need to have this bound to specific canonicals as <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> proposed. <br>\nBut i also can see his implied use-case.</p>",
        "id": 253420454,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631715059
    },
    {
        "content": "<p>Here I assume that within one IG, there would be resources that should be validated and others that shouldn't.</p>",
        "id": 253420548,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631715095
    },
    {
        "content": "<p>There should be other cases for this skipValidation: For example if a testScript uses a non-conformant resource on purpose, we could skip validation for that one</p>",
        "id": 253420759,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631715172
    },
    {
        "content": "<p>So having both options would be nice then</p>",
        "id": 253420817,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631715198
    },
    {
        "content": "<p>Alternatively / additionally, we could have a \"validate all or skip all\" parameter - there it would be <br>\na) a command line, if sometimes we want to validate and sometimes we want not to validate<br>\nb) a fixed parameter (in the IG? I'd prefer not to mess with the ig.ini)</p>",
        "id": 253421397,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631715393
    },
    {
        "content": "<p>ad b) could be an extension(s) on the IG resource itself/ sushi yaml setting</p>",
        "id": 253425561,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631716887
    },
    {
        "content": "<p>do you need option b, Patrick?</p>",
        "id": 253426378,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631717195
    },
    {
        "content": "<p>or a)</p>",
        "id": 253426391,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631717201
    },
    {
        "content": "<p>i.e. when you skip validation, do you always skip validation for the entire IG in every build?</p>",
        "id": 253426508,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631717244
    },
    {
        "content": "<p>The key thing for me is that these processes can't be skipped for content that we actually publish (and perhaps even not for content posted to the CI-build - though an extra warning in the CI-build might be enough)</p>",
        "id": 253442188,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1631722627
    },
    {
        "content": "<p>can't we put \"invalid\" content in the CI build? e.g test resources?</p>",
        "id": 253455282,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1631727040
    },
    {
        "content": "<p>is this a public package? Why isn't this stuff going into <a href=\"http://terminology.hl7.org\">terminology.hl7.org</a>?</p>",
        "id": 253457810,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631728012
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> This is exactly the issue I was facing a couple of weeks ago. See <a href=\"#narrow/stream/179252-IG-creation/topic/Multipart.20IGs\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Multipart.20IGs</a>. I'm not sure if the issue is to disable validation, or to look at whether the publisher can be restructured to not require everything be in memory at once.</p>",
        "id": 253466641,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1631731455
    },
    {
        "content": "<p>I think that <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> has bigger problems than running out of memory. I certainly never imagined that someone would try to publish those big code systems through a CodeSystem resource, let alone through the IG machinery</p>",
        "id": 253475313,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631734867
    },
    {
        "content": "<p>Agree with Grahame - this doesn't seem like the right (or at least the best) approach to take for this.  Unless I'm missing something, I think this is something that should be supported directly by the terminology server.  ICD-10 and ICD-10-GM are already supported on <a href=\"http://tx.fhir.org\">tx.fhir.org</a>, and ICD-10-GM can be as well.  That is done via a CodeSystem resource instance in the packages repo that includes the full code system contents (so it 's pretty big), but I think it avoids most of the overhead that is being experienced with trying to publish it through the IG mechanism.  We also can and want to include the complete contents for ATC - but we haven't yet because I haven't found a full source for it other than a flat file, and I had expected and hoped to include the hierarchy.  So if <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> would be able to provide a source(?), that would be great.  And, as far as I know, we can include support for NCIT, as well.</p>",
        "id": 253496880,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1631744436
    },
    {
        "content": "<p>I'm interested in how big these code systems are.  We have one for the UK's DM+D which is, in JSON form, &gt; 300MB (without narrative)</p>",
        "id": 253517419,
        "sender_full_name": "Michael Lawley",
        "timestamp": 1631757992
    },
    {
        "content": "<p>Almost always, these code systems have their own distribution formats. CodeSystem was never intended to scale up to compete with those</p>",
        "id": 253521578,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631761505
    },
    {
        "content": "<p>Yes these CS have their own format most of the time. We are loading huge CS in hapi, which works fine.<br>\nI agree this is an edge case, and validation in the CI autobuild should be enabled.</p>",
        "id": 253542820,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631778906
    },
    {
        "content": "<p>I think the easiest would be to have an optional  command.-line parameter on the <a href=\"http://genonce.sh/publisher.jar\">genonce.sh/publisher.jar</a></p>",
        "id": 253542881,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631778954
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/CS.20only.20packages.2FIGs/near/253457810\">said</a>:</p>\n<blockquote>\n<p>is this a public package? Why isn't this stuff going into <a href=\"http://terminology.hl7.org\">terminology.hl7.org</a>?</p>\n</blockquote>\n<p>private only. Used to distribute CodeSystems in a project to the partners.</p>",
        "id": 253542947,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631778983
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191405\">Rob Hausam</span> <a href=\"#narrow/stream/179252-IG-creation/topic/CS.20only.20packages.2FIGs/near/253496880\">said</a>:</p>\n<blockquote>\n<p>Agree with Grahame - this doesn't seem like the right (or at least the best) approach to take for this.  Unless I'm missing something, </p>\n</blockquote>\n<p>My use-case is: create a package of Terminology Resources to distribute the content to servers. These servers are using these resources for validation.<br>\nSo adding more CS to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> ist always nice  - wouldn't solve the issue.</p>",
        "id": 253543150,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631779096
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191405\">Rob Hausam</span> <a href=\"#narrow/stream/179252-IG-creation/topic/CS.20only.20packages.2FIGs/near/253496880\">said</a>:</p>\n<blockquote>\n<p>So if <span class=\"user-mention silent\" data-user-id=\"191451\">Patrick Werner</span> would be able to provide a source(?), that would be great.  And, as far as I know, we can include support for NCIT, as well.</p>\n</blockquote>\n<p>We created the CS from the WHO Excel Sheet (with german display values), available here: <a href=\"https://www.wido.de/publikationen-produkte/arzneimittel-klassifikation/\">https://www.wido.de/publikationen-produkte/arzneimittel-klassifikation/</a></p>",
        "id": 253544215,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631779673
    },
    {
        "content": "<p>NCIT created from: <a href=\"https://evs.nci.nih.gov/ftp1/NCI_Thesaurus/\">https://evs.nci.nih.gov/ftp1/NCI_Thesaurus/</a></p>",
        "id": 253544390,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1631779762
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> Do you know (or would you be able to find out) what the source is of the ATC content that WIdO uses for their adaptation of it for Germany?  I've received from an EU source a copy of the ATC content as a flat list, but I need a way to continue to obtain updated versions as additions and revisions are made by the WHO Collaborating Centre.  This seems to be the elusive item.  And then I need to write (which should be too hard) or steal a script to extract the embedded hierarchy from the codes and transform the data to the FHIR CodeSystem resource.</p>",
        "id": 253585118,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1631800379
    },
    {
        "content": "<p>I'd prefer a flag that says that \"don't validate X, Y and Z\" rather than \"don't validate at all\".  Or perhaps even \"Use Tx server to validate X\".</p>\n<p>You can avoid narrative generation simply by defining your own narrative.</p>",
        "id": 253614180,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1631811506
    },
    {
        "content": "<p>I too would like to tag artifacts as \"don't validate\".. so that I can put in offending resources so as to speak to them in a test plan.</p>",
        "id": 253632301,
        "sender_full_name": "John Moehrke",
        "timestamp": 1631818624
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191405\">Rob Hausam</span> <a href=\"#narrow/stream/179252-IG-creation/topic/CS.20only.20packages.2FIGs/near/253585118\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191451\">Patrick Werner</span> Do you know (or would you be able to find out) what the source is of the ATC content that WIdO uses for their adaptation of it for Germany?  I've received from an EU source a copy of the ATC content as a flat list, but I need a way to continue to obtain updated versions as additions and revisions are made by the WHO Collaborating Centre.  This seems to be the elusive item.  And then I need to write (which should be too hard) or steal a script to extract the embedded hierarchy from the codes and transform the data to the FHIR CodeSystem resource.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span>  Will investigate and update you. What do you mean by source?<br>\nThe technical source they are using? Or what is the base for the german publication?</p>",
        "id": 254042875,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1632141801
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> I think I meant the technical source - if I understand what you mean by that.  How do they get the latest content releases from WHO CC, that they will then incorporate into the German adaptation?</p>",
        "id": 254131662,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1632179007
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> ok i just got the opportunity to ask the involved persons:<br>\nWHO Oslo distributes ATC in EXCEL and PDF</p>",
        "id": 255015661,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1632733478
    },
    {
        "content": "<p>Thanks, <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span>.  Neither of those formats would be my first choice, of course, but we can definitely work with Excel (probably not PDF).  I (or someone) will need to write a transform from the Excel XML to the CodeSystem resource (either JSON or XML).  One aspect is that it is necessary (or at least very desirable) to parse the codes to extract the embedded hierarchy and properly represent that in the CodeSystem resource.  Doing that won't be particularly difficult, but does require a bit of extra effort.</p>",
        "id": 255042567,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1632747360
    },
    {
        "content": "<p>I agree.</p>",
        "id": 255042680,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1632747402
    },
    {
        "content": "<p>parsing XML and inferring heirarchy sounds like an hour or two work for me. I'd do it</p>",
        "id": 255154143,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1632798199
    },
    {
        "content": "<p>It took a while to get to it, but the work for parsing the file is now done, and the full version of ATC (from May 2020, which is the source that I had) is now available on <a href=\"http://tx.fhir.org\">tx.fhir.org</a>.  As soon as we get an updated Excel source file the update on the server will be much easier and quicker.<br>\n<span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span></p>",
        "id": 257681212,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1634296619
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span></p>",
        "id": 257838436,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1634397086
    }
]