[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> We got an error in our example: Relative URLs must be of the format [ResourceName]/[id]. Encountered Patient?given=Alice&amp;family=Newman&amp;birthdate=1970-05-01&amp;address-postalcode=97006. As we discussed that the IG validation may add the function to support conditional reference. Please help. Thank you</p>",
        "id": 195578861,
        "sender_full_name": "Cheng Liu",
        "timestamp": 1588086888
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 195593415,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1588092804
    },
    {
        "content": "<p>The issue is that conditional references in a transaction or batch are failing validation because they're not strict references, but rather queries</p>",
        "id": 195593500,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1588092841
    },
    {
        "content": "<p>do we have an example? Because the validator already allows this. So it's not clear to me why this is a problem</p>",
        "id": 195614546,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1588102421
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"240020\">@Cheng Liu</span> - where is this in Git?</p>",
        "id": 195617443,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1588103738
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - Please check the error here: <a href=\"http://build.fhir.org/ig/HL7/sdoh-cc/branches/development/qa.html#_scratch_ig-build-temp-M28NWK_repo_input_resources_bundle_10432\" title=\"http://build.fhir.org/ig/HL7/sdoh-cc/branches/development/qa.html#_scratch_ig-build-temp-M28NWK_repo_input_resources_bundle_10432\">http://build.fhir.org/ig/HL7/sdoh-cc/branches/development/qa.html#_scratch_ig-build-temp-M28NWK_repo_input_resources_bundle_10432</a></p>",
        "id": 195619693,
        "sender_full_name": "Cheng Liu",
        "timestamp": 1588104569
    },
    {
        "content": "<p>so the validator says that conditional references are only allowed in transactions.</p>",
        "id": 195649303,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1588122851
    },
    {
        "content": "<p>I missed that, sorry.  Agree.  Conditional matches aren't permitted in messages - because messages aren't presumed to be interacting with systems that expose RESTful interfaces.</p>",
        "id": 195658047,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1588133140
    },
    {
        "content": "<p>Get it. I will report to the team. Thanks a lot</p>",
        "id": 195732888,
        "sender_full_name": "Cheng Liu",
        "timestamp": 1588176265
    },
    {
        "content": "<p>I am having a problem when there is a pipe <code>|</code> in a conditional reference.</p>\n<p>In a Bundle transaction example in my IG, I have an Observation with a reference to a Patient using a conditional query with an <code>identifier</code> that specifies both a system and value. IG Publisher (v1.1.56) produces the following pairs of errors:</p>\n<ul>\n<li><code>The URL is not valid because '(URL contains Invalid Characters ([|]))': Patient?identifier=urn:oid:&lt;oid&gt;|&lt;value&gt;</code></li>\n<li><code>Unable to resolve resource Patient?identifier=urn:oid:&lt;oid&gt;|&lt;value&gt;</code></li>\n</ul>\n<p>There is an existing example Patient resource in the IG that has a matching identifier. When I try to transact for real with a locally running Smile/HAPI, the transaction works fine.</p>",
        "id": 221240773,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1609357494
    },
    {
        "content": "<p>Did you try escaping the |?</p>",
        "id": 221551609,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1609780340
    },
    {
        "content": "<p>Yes with <code>%7C</code>, still fails.</p>",
        "id": 221963306,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1610036640
    },
    {
        "content": "<p>To clarify, the failure about the invalid characters no longer appears. However the \"unable to resolve\" error is still there.</p>",
        "id": 221964342,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1610037061
    },
    {
        "content": "<p>Should the IG publisher support the un-escaped <code>|</code>? The FHIR spec seems to show it acceptable in this form (<a href=\"https://www.hl7.org/fhir/search.html#token\">https://www.hl7.org/fhir/search.html#token</a>)</p>",
        "id": 221964694,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1610037213
    },
    {
        "content": "<p>where is it saying it can't be resolved?</p>",
        "id": 221992687,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1610049552
    },
    {
        "content": "<p>in qa.html</p>",
        "id": 221992923,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1610049661
    },
    {
        "content": "<p>right but where is the reference?</p>",
        "id": 221993055,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1610049726
    },
    {
        "content": "<p>There is a transaction Bundle. One of the entries is an Observation. The reference in question is that Observation's subject (conditional reference to a patient using an identifier).</p>",
        "id": 221993379,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1610049899
    },
    {
        "content": "<p>how do I reproduce this?</p>",
        "id": 221995149,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1610050760
    }
]