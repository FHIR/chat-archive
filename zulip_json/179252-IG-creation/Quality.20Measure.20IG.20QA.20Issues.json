[
    {
        "content": "<p>I'm working on wrapping up QA issues in the Quality Measure IG, and one of the things that changed as part of reconciliation is the use of <code>text/cql.identifier</code> to specify the names of expressions referenced by populations from Measure. This new media type was introduced in the CQL ballot to enable expression identifiers to be distinguished from complete in-line expressions. The Quality Measure IG now requires the use of this media type to identify expressions, but the publication validator doesn't know about this type, so I'm getting validation warnings like this: <code>The expression language text/cql.identifier is not supported, so can't be validated</code></p>",
        "id": 201921269,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593045931
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> The <a href=\"http://build.fhir.org/codesystem-expression-language.html\">ExpressionLanguage</a> code system is pretty small but the (all codes) value set is bound extendable so you need to get Graham or Lloyd to change it since it's a FHIR internal code system and not governed by UTG (which it should and I think eventually will be). I'll note that the code system is Normative (level 5) but is clearly a fragment. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <span class=\"user-mention\" data-user-id=\"191982\">@Ted Klein</span> <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> How would this be handled? We know there are a bunch of other proper media type codes and I'm surprised other IGs have not pushed additions.</p>",
        "id": 202127427,
        "sender_full_name": "Robert McClure",
        "timestamp": 1593197351
    },
    {
        "content": "<p>It's possible to add codes to a normative value set.  Is text/cql.identifier a valid mime type?</p>",
        "id": 202129032,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593198150
    },
    {
        "content": "<p>Technically, it's STU Maturity Level 5, but that is not much of a difference...</p>\n<p>text/cql.identifier seems to be an acceptable format for a MIME type (for example: application/prs.cww, application/EmergencyCallData.Comment+xml from <a href=\"https://www.iana.org/assignments/media-types/media-types.xhtml#application\">https://www.iana.org/assignments/media-types/media-types.xhtml#application</a>)</p>",
        "id": 202130629,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1593198966
    },
    {
        "content": "<p>I'm not sure how this slipped by me. We should not have a code system for this one. I'm ok with the binding, which is extensible, but the binding should be straight to the bcp 13 codes, not inventing alternative identical codes</p>",
        "id": 202140690,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593204499
    },
    {
        "content": "<p>but the validation warning is nothing to do with the definitions - it's a statement of fact: the validator doesn't support CQL, so it can't validate the expression</p>",
        "id": 202140756,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593204554
    },
    {
        "content": "<p>This is validation of the Measure that was recently added to check the library for references to valid expressions. It's not validating CQL, it's just validating that the expressions referenced by the Measure exist in the library. Which is why we introduced the <code>text/cql.identifier</code> media type in the CQL ballot, to more clearly support that use case. I can add the media type to the value set and deprecate the expression language code system, but the validator code needs to allow for validating with either <code>text/cql</code> or <code>text/cql.identifier</code>. Basically <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/instance/type/MeasureValidator.java#L113\">this</a> needs to include <code>text/cql.identifier</code> as well</p>",
        "id": 202328932,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593445662
    },
    {
        "content": "<p>Happy to submit a PR for that.</p>",
        "id": 202329064,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593445701
    },
    {
        "content": "<p>And here's an issue to track the addition of the media type to the ExpressionLanguage value set, and deprecate the ExpressionLanguage code system: <a href=\"https://jira.hl7.org/browse/FHIR-27883\">https://jira.hl7.org/browse/FHIR-27883</a></p>",
        "id": 202330874,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593446547
    },
    {
        "content": "<p>yes a PR would be good</p>",
        "id": 202366091,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593463715
    },
    {
        "content": "<p>PR submitted: <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/264\">https://github.com/hapifhir/org.hl7.fhir.core/pull/264</a></p>",
        "id": 202375883,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593469923
    },
    {
        "content": "<p>won't make this release of the IG publisher</p>",
        "id": 202375904,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593469946
    },
    {
        "content": "<p>Note that I get failures from the tests running locally, so I can't validate that, but the change is simple enough I'm pretty confident in it.</p>",
        "id": 202375918,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593469964
    },
    {
        "content": "<p>That's fine, no worries, but that's the source of most of the outstanding warnings in the QM IG.</p>",
        "id": 202375940,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593469988
    },
    {
        "content": "<p>Regarding the ExpressionLanguage code system and value set, the binding from Expression references <a href=\"http://www.rfc-editor.org/bcp/bcp13.txt\">http://www.rfc-editor.org/bcp/bcp13.txt</a>, but the UTG lists this as the code system for MIME: <a href=\"https://terminology.hl7.org/CodeSystem-v3-mime.html\">https://terminology.hl7.org/CodeSystem-v3-mime.html</a></p>",
        "id": 202447756,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593529300
    },
    {
        "content": "<p>Should I just update the value set to pull codes from that system?</p>",
        "id": 202447820,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593529321
    },
    {
        "content": "<p>bcp is what you're supposed to use for FHIR.</p>",
        "id": 202450793,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593530438
    },
    {
        "content": "<p>I see, so: urn:ietf:bcp:13</p>",
        "id": 202493647,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593550618
    },
    {
        "content": "<p>we should not use the internal code system. That should be removed from <a href=\"http://terminology.hl7.org\">terminology.hl7.org</a> and we should reference the right code system directly from the value set</p>",
        "id": 202498082,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593552857
    },
    {
        "content": "<p>So can I just remove the ExpressionLanguage code system from the build and submit a proposal to UTG to retire it?</p>",
        "id": 202522242,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593567512
    },
    {
        "content": "<p>yes</p>",
        "id": 202522584,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593568006
    },
    {
        "content": "<p>The binding in the expression data type has a maxBinding of <code>http://www.rfc-editor.org/bcp/bcp13.txt</code>, is that still valid?</p>",
        "id": 202523927,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593569578
    },
    {
        "content": "<p>that's not the code system url is it?</p>",
        "id": 202524433,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593570185
    },
    {
        "content": "<p>No, code system url is urn:ietf:bcp:13</p>",
        "id": 202525203,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593570869
    },
    {
        "content": "<p>hmm. max binding needs to be to a value set that has that as the code system</p>",
        "id": 202525220,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593570897
    },
    {
        "content": "<p>I can add that</p>",
        "id": 202525233,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593570911
    },
    {
        "content": "<p>Right now the max binding url is  <a href=\"http://www.rfc-editor.org/bcp/bcp13.txt\">http://www.rfc-editor.org/bcp/bcp13.txt</a>.</p>",
        "id": 202525246,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593570929
    },
    {
        "content": "<p>which is not valid</p>",
        "id": 202525260,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593570949
    },
    {
        "content": "<p>right</p>",
        "id": 202525265,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593570956
    },
    {
        "content": "<p>the intent is right, but the actual url is not</p>",
        "id": 202525270,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593570959
    },
    {
        "content": "<p>agree</p>",
        "id": 202525337,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593570996
    },
    {
        "content": "<p>So, I think I did this right, but I'm getting a broken link to the max value set in a generated page. Not sure what I'm doing wrong: <a href=\"https://github.com/HL7/fhir/pull/919\">https://github.com/HL7/fhir/pull/919</a></p>",
        "id": 202527627,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593574227
    },
    {
        "content": "<p>Okay, figured it out and that's fixed now, that PR is ready to merge. If you get a chance I'd love a review <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> <span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span></p>",
        "id": 202573167,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593612687
    },
    {
        "content": "<p>As far as how this slipped by you Grahame, I created the ExpressionLanguage value set as a code list in the Expression.xml spreadsheet, which automatically created the code system, so that's on me. The good news is that it actually isn't in UTG, so no need to submit a request to retire the code system there.</p>",
        "id": 202580292,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593616077
    },
    {
        "content": "<p>My first comment on the PR is that we need to stop using spreadsheets (you can't see the diff!).  But you and I can't do anything about that right now.  But, after reviewing the Expression spreadsheet and my question about the max binding on the CDS call, the PR looks good to me.</p>",
        "id": 202595483,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593623027
    },
    {
        "content": "<p>looks like Bryn didn't run the build in the spreadsheet before doing the PR? (the build is supposed to fix it up so the diff is coherent)</p>",
        "id": 202618822,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593634530
    },
    {
        "content": "<p>but other than that is looks good</p>",
        "id": 202618877,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593634561
    },
    {
        "content": "<p>Okay, the next issue is that since I don't have a fixed-business-version set, extensions defined in spreadsheets don't have their version element set, which looking at the IGSpreadsheetParser isn't something that it currently does, so here's a PR to make it set the version based on the Version column in the spreadsheet: <a href=\"https://github.com/HL7/fhir-ig-publisher/pull/122\">https://github.com/HL7/fhir-ig-publisher/pull/122</a></p>",
        "id": 202651411,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593667519
    },
    {
        "content": "<p>Tested this PR with the currently committed CQF Measures, and it does address the extension version warnings issue.</p>",
        "id": 202651416,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1593667548
    },
    {
        "content": "<p>Okay, the next issue is that since I don't have a fixed-business-version set, I can't answer this item in the Publication Checklist: <code>Version has been approved by Product Director and is specified in fixed-business-version</code></p>",
        "id": 203017834,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594056532
    },
    {
        "content": "<p>Is this indicating that a fixed-business-version is required? I can't do that for this IG, since there are artifacts in the IG whose business version should not be set based on that fixed-business-version (they are examples, but I don't know how to turn off setting version selectively).</p>",
        "id": 203017910,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594056596
    },
    {
        "content": "<p>well, in principle I'm ok with not using fixed-business-version if I have confidence that every non-example artifact does have a version, and it's the version I approve</p>",
        "id": 203029948,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594063295
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>define ConformanceResourceVersions:\n  (\n    [CodeSystem]\n      union [ConceptMap]\n      union [ImplementationGuide]\n      union [StructureDefinition]\n      union [ValueSet]\n\n  ) CR return CR.version\n</code></pre></div>",
        "id": 203051258,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594076656
    },
    {
        "content": "<p>Returns:</p>\n<div class=\"codehilite\"><pre><span></span><code>ConformanceResourceVersions = [2.0.0]\n</code></pre></div>",
        "id": 203051267,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594076669
    },
    {
        "content": "<p>Previous version was 1.1.0 and we made substantive and breaking changes, so I incremented the version to 2.0.0.</p>",
        "id": 203059189,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594085062
    },
    {
        "content": "<p>ok then that's fine</p>",
        "id": 203060580,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594086895
    },
    {
        "content": "<p>Great, thank you! The only error left is that I have some profiles that require narrative, but the validation is being performed by the publisher prior to narrative generation.</p>",
        "id": 203061144,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594087698
    },
    {
        "content": "<blockquote>\n<p>some profiles that require narrative, but the validation is being performed by the publisher prior to narrative generation.</p>\n</blockquote>\n<p>That's not what the code says - narrative is generated first for this reason</p>",
        "id": 203061305,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594088013
    },
    {
        "content": "<p>But the library resource it's referencing does have a generated narrative:</p>",
        "id": 203061527,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594088349
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/ig/HL7/cqf-measures/Library-EXMPublishableLibrary.xml.html\">http://build.fhir.org/ig/HL7/cqf-measures/Library-EXMPublishableLibrary.xml.html</a></p>",
        "id": 203061528,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594088350
    },
    {
        "content": "<p>ok I figured out what is going on, and it'll be fixed next release</p>",
        "id": 203221601,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594170616
    },
    {
        "content": "<p>Thanks Grahame!</p>",
        "id": 203222368,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594171722
    },
    {
        "content": "<p>I tried to suppress the warnings as discussed on the FMG call: <a href=\"https://github.com/HL7/cqf-measures/blob/master/SuppressedWarnings.txt#L6\">https://github.com/HL7/cqf-measures/blob/master/SuppressedWarnings.txt#L6</a> but no joy. <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ?</p>",
        "id": 203331813,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594247555
    },
    {
        "content": "<p>Did you copy them from the qa.txt file (not qa.html)?</p>",
        "id": 203336569,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1594251128
    },
    {
        "content": "<p>Yes, I copied the message without the path from qa.txt</p>",
        "id": 203339111,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594253696
    },
    {
        "content": "<p>You just want \"ValueSet <a href=\"http://www.rfc-editor.org/bcp/bcp13.txt\">http://www.rfc-editor.org/bcp/bcp13.txt</a> not found by validator\" - dump the \"WARNING: \" bit</p>",
        "id": 203345050,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1594260982
    },
    {
        "content": "<p>That did it, thanks <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> !</p>",
        "id": 203391480,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1594304600
    }
]