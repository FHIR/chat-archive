[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191682\">Richard Townley-O'Neill</span> has marked this topic as unresolved.</p>",
        "id": 272643473,
        "sender_full_name": "Notification Bot",
        "timestamp": 1645421726
    },
    {
        "content": "<p>Quantity.type.profile = \"<a href=\"http://hl7.org/fhir/StructureDefinition/Age\">http://hl7.org/fhir/StructureDefinition/Age</a>\" does not work.  <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span> </p>\n<p>It gives</p>\n<blockquote>\n<p>Profile <a href=\"http://hl7.org/fhir/StructureDefinition/Age\">http://hl7.org/fhir/StructureDefinition/Age</a> is for type StructureDefinition[http://hl7.org/fhir/StructureDefinition/Age], but the Observation.value[x] element has type Quantity</p>\n</blockquote>",
        "id": 272643746,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1645422017
    },
    {
        "content": "<p>Right. I just read that Age is a specialization of Quantity, not a profile</p>",
        "id": 272647552,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1645425871
    },
    {
        "content": "<p>Yeah. I think you have two choices:</p>\n<ul>\n<li>replicate the Age constraints on value[x] (type constraint to Quantity, duplicate <a href=\"http://hl7.org/fhir/R4/datatypes.html#Age\">age-1</a> invariant w/ modified paths, and extensible VS binding to <a href=\"http://hl7.org/fhir/R4/valueset-all-time-units.html\">AllUCUMExpressionForTime</a>)</li>\n<li>define a FHIRPath constraint on value[x] that says <code>$this.conformsTo('http://hl7.org/fhir/StructureDefinition/Age')</code></li>\n</ul>",
        "id": 272692811,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1645452550
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> . I had not thought of a FHIRPath  constraint using conforms to.</p>",
        "id": 272741152,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1645482893
    },
    {
        "content": "<p>I've decided to replicate the relevant bits from Age. As I'm making value, system and code 1..1 I can simplify the constraint.</p>",
        "id": 272741329,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1645483042
    },
    {
        "content": "<p>I'm not sure that conformsTo is meant to be used that way. I'm not sure I've ever tested it, but a quantity can't conform to Age, because the definitions says that it's a <em>type</em> not a profile</p>",
        "id": 272742706,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1645484320
    },
    {
        "content": "<p>Ah.  I hadn't noticed that <code>conformsTo</code> is specific to profiles.  The function signature just says <code>structure</code> -- but you're right, the body says it should be a profile.  My bad.  Thanks for the correction!</p>",
        "id": 272752544,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1645495348
    }
]