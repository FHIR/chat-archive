[
    {
        "content": "<p>Some value sets in our IG aren't properly listing codes when the codes come from a CodeSystem also defined in the same IG.  For example:</p>\n<ul>\n<li>ValueSet: <a href=\"http://build.fhir.org/ig/HL7/us-breastcancer/ValueSet-shr-oncology-BreastSpecimenTypeVS.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/us-breastcancer/ValueSet-shr-oncology-BreastSpecimenTypeVS.html\">http://build.fhir.org/ig/HL7/us-breastcancer/ValueSet-shr-oncology-BreastSpecimenTypeVS.html</a></li>\n<li>CodeSystem: <a href=\"http://build.fhir.org/ig/HL7/us-breastcancer/CodeSystem-shr-oncology-BreastSpecimenTypeCS.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/us-breastcancer/CodeSystem-shr-oncology-BreastSpecimenTypeCS.html\">http://build.fhir.org/ig/HL7/us-breastcancer/CodeSystem-shr-oncology-BreastSpecimenTypeCS.html</a></li>\n</ul>\n<p>In the \"Expansion\" part of the VS page, it reports:</p>\n<blockquote>\n<p>Error unmarshalling resource: Unable to provide support for code system <a href=\"http://hl7.org/fhir/us/breastcancer/CodeSystem/shr-oncology-BreastSpecimenTypeCS\" target=\"_blank\" title=\"http://hl7.org/fhir/us/breastcancer/CodeSystem/shr-oncology-BreastSpecimenTypeCS\">http://hl7.org/fhir/us/breastcancer/CodeSystem/shr-oncology-BreastSpecimenTypeCS</a></p>\n</blockquote>\n<p>Note that on the code system page, however, it properly identifies the value set as referencing it.</p>\n<p>Here are the value set compose rules (also <a href=\"https://github.com/HL7/us-breastcancer/blob/master/resources/valueset-shr-oncology-BreastSpecimenTypeVS.json#L31-L69\" target=\"_blank\" title=\"https://github.com/HL7/us-breastcancer/blob/master/resources/valueset-shr-oncology-BreastSpecimenTypeVS.json#L31-L69\">here</a>):</p>\n<div class=\"codehilite\"><pre><span></span>  &quot;compose&quot;: {\n    &quot;include&quot;: [\n      {\n        &quot;system&quot;: &quot;http://snomed.info/sct&quot;,\n        &quot;concept&quot;: [\n          {\n            &quot;code&quot;: &quot;119295008&quot;,\n            &quot;display&quot;: &quot;Specimen obtained by aspiration (specimen)&quot;\n          },\n          {\n            &quot;code&quot;: &quot;16215491000119108&quot;,\n            &quot;display&quot;: &quot;Specimen from breast duct obtained by excision (specimen)&quot;\n          },\n          {\n            &quot;code&quot;: &quot;122595009&quot;,\n            &quot;display&quot;: &quot;Specimen from breast obtained by total mastectomy (specimen)&quot;\n          }\n        ]\n      },\n      {\n        &quot;system&quot;: &quot;http://hl7.org/fhir/us/breastcancer/CodeSystem/shr-oncology-BreastSpecimenTypeCS&quot;,\n        &quot;concept&quot;: [\n          {\n            &quot;code&quot;: &quot;core&quot;,\n            &quot;display&quot;: &quot;Core biopsy specimen&quot;\n          },\n          {\n            &quot;code&quot;: &quot;excision&quot;,\n            &quot;display&quot;: &quot;Excision specimen without wire loc&quot;\n          },\n          {\n            &quot;code&quot;: &quot;wire&quot;,\n            &quot;display&quot;: &quot;Excision specimen with wire loc&quot;\n          }\n        ]\n      }\n    ]\n  }\n</pre></div>",
        "id": 153987018,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1534352219
    },
    {
        "content": "<p>I was getting that also last night - ended up also adding the expansion - that's the only way I could get rid of that error last night.... When I just had the compose it gave same error about unmarshalling... I figured it was a bit of a hack, but it got rid of my errors!</p>\n<div class=\"codehilite\"><pre><span></span>&lt;compose&gt;\n    &lt;include&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;concept&gt;\n        &lt;code value=&quot;RRVS20&quot; /&gt;\n        &lt;display value=&quot;eICR was processed - with a warning&quot; /&gt;\n      &lt;/concept&gt;\n    &lt;/include&gt;\n    &lt;include&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;concept&gt;\n        &lt;code value=&quot;RRVS19&quot; /&gt;\n        &lt;display value=&quot;eICR processed&quot; /&gt;\n      &lt;/concept&gt;\n    &lt;/include&gt;\n    &lt;include&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;concept&gt;\n        &lt;code value=&quot;RRVS22&quot; /&gt;\n        &lt;display value=&quot;eICR was not processed - error&quot; /&gt;\n      &lt;/concept&gt;\n    &lt;/include&gt;\n    &lt;include&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;concept&gt;\n        &lt;code value=&quot;RRVS21&quot; /&gt;\n        &lt;display value=&quot;eICR was processed - with a severe warning&quot; /&gt;\n      &lt;/concept&gt;\n    &lt;/include&gt;\n  &lt;/compose&gt;\n  &lt;expansion&gt;\n    &lt;identifier value=&quot;http://hl7.org/fhir/us/ecr/ValueSet/eicr-processing-status-ecr&quot; /&gt;\n    &lt;timestamp value=&quot;2017-12-27&quot; /&gt;\n    &lt;contains&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;code value=&quot;RRVS20&quot; /&gt;\n      &lt;display value=&quot;eICR was processed - with a warning&quot; /&gt;\n    &lt;/contains&gt;\n    &lt;contains&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;code value=&quot;RRVS19&quot; /&gt;\n      &lt;display value=&quot;eICR processed&quot; /&gt;\n    &lt;/contains&gt;\n    &lt;contains&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;code value=&quot;RRVS22&quot; /&gt;\n      &lt;display value=&quot;eICR was not processed - error&quot; /&gt;\n    &lt;/contains&gt;\n    &lt;contains&gt;\n      &lt;system value=&quot;urn:oid:2.16.840.1.114222.4.5.274&quot; /&gt;\n      &lt;code value=&quot;RRVS21&quot; /&gt;\n      &lt;display value=&quot;eICR was processed - with a severe warning&quot; /&gt;\n    &lt;/contains&gt;\n  &lt;/expansion&gt;\n</pre></div>",
        "id": 153987091,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534364901
    },
    {
        "content": "<p>I originally had defined the codesystem resource for that one I have referenced above, but it was causing problems in other places also (like I had given it a non-oid identifier and using that non-oid identifier in examples caused an error), so I ended up deleting it and going with the oid.... (Again, probably a hack, but no errors (and running out of time!)...)</p>",
        "id": 153987092,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534365124
    },
    {
        "content": "<p>what was the error?</p>",
        "id": 153987196,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534374654
    },
    {
        "content": "<p>Error unmarshalling resource: Unable to provide support for code system xxxx</p>",
        "id": 153987199,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534375500
    },
    {
        "content": "<p>In the examples though - I can't remember. Something similar - will test again and let you know.</p>",
        "id": 153987201,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534375532
    },
    {
        "content": "<p>Pretty sure it was just: <code>Invalid FHIR Code System http://hl7.org/fhir/us/ecr/CodeSystem/ph-phinvs-cdc</code> - even though the codeSystem existed (as a resource in the IG and the publisher published it etc.). I'd have to resurrect the codeSystem from my archive to find out for sure though. If i get some spare time after lunch, I'll give it a go.</p>",
        "id": 153987211,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534376487
    },
    {
        "content": "<p>so I've fixed this, but you don't have the cache files committed to git - why not? (it means I can't remove the entry from your cache)</p>",
        "id": 153987225,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534377775
    },
    {
        "content": "<p>that least was for <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span></p>",
        "id": 153987226,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534377807
    },
    {
        "content": "<p>Because I totally removed that codeSystem</p>",
        "id": 153987227,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534377813
    },
    {
        "content": "<p>Oh ok</p>",
        "id": 153987228,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534377819
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191918\">@Sarah Gaunt</span> I fixed a problem with the expansion - if the expand referred to content that the ig publisher doesn't know, it would ask the terminology server to do the expand, and the server doesn't know the IG specific stuff. So that's sorted</p>",
        "id": 153987229,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534377876
    },
    {
        "content": "<p>but changing to an oid is only related to this if you basically broke  the value set inclusions while youwere at it</p>",
        "id": 153987230,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534377892
    },
    {
        "content": "<p>Ok, I'll have a play with it later...</p>",
        "id": 153987231,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1534377922
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- we can probably check in the cache if you'd like.  Since we generate the whole IG from our tooling every time, the cache gets blown away when we regenerate.  I've got it on my list to try to find a way to handle that better in the future, but I can do a bit more of a manual process for now so the cache gets checked in.</p>",
        "id": 153987324,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1534388342
    },
    {
        "content": "<p>well, keeping the cache will make a real difference to your performance and reduce the load on <a href=\"http://tx.fhir.org\" target=\"_blank\" title=\"http://tx.fhir.org\">tx.fhir.org</a></p>",
        "id": 153987327,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534389551
    },
    {
        "content": "<p>Confirmed fixed on my end.  Thank you!</p>",
        "id": 153987397,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1534398068
    }
]