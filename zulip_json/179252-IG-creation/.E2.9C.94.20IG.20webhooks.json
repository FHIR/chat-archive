[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> I'm getting an HTTP 500 and the message <code>Error: could not handle the request</code> after having added the IG Webhook to a range of my new IG's (eg. ). Could it be because they currently only have the <code>main</code> branch and not a <code>master</code> ?</p>",
        "id": 264458083,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639148216
    },
    {
        "content": "<p>Nvm - that was actually the cause... You might wanna add that to the <a href=\"https://github.com/FHIR/auto-ig-builder\">https://github.com/FHIR/auto-ig-builder</a> that the main branch <em>must</em> be named master</p>",
        "id": 264458908,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639148522
    },
    {
        "content": "<p>Interesting,  We have talked through some of the plans required to overcome this limitation here, but I don't remember having an issue with the initial web hook as part of those plans.</p>",
        "id": 264459714,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1639148810
    },
    {
        "content": "<p>In any case, I have updated the guidance with a note <a href=\"https://github.com/FHIR/auto-ig-builder/commit/3fc7987d503eeecb1d6d111eca3eb05f3414b389\">https://github.com/FHIR/auto-ig-builder/commit/3fc7987d503eeecb1d6d111eca3eb05f3414b389</a></p>",
        "id": 264460178,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1639148974
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 264462641,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1639149997
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191427\">Jens Villadsen</span> has marked this topic as resolved.</p>",
        "id": 264498130,
        "sender_full_name": "Notification Bot",
        "timestamp": 1639165372
    },
    {
        "content": "<p>but that can't be true - there are plenty of IGs running through the autobuilder that use main not master</p>",
        "id": 264498213,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639165420
    },
    {
        "content": "<p>Not that publish on the IG-builder without pushing to master</p>",
        "id": 264543026,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1639200676
    },
    {
        "content": "<p>You can publish a 'branch' using 'main', but not the root CI-build folder</p>",
        "id": 264543033,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1639200699
    },
    {
        "content": "<p>Yep - agree with <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> here. You can very easily test it by creating a new repo (defaults to 'main' branch) and throw a webhook at it.</p>",
        "id": 264553279,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639216325
    },
    {
        "content": "<p>Then you'll see that it fails</p>",
        "id": 264553294,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639216344
    },
    {
        "content": "<p>And this is the default experience (until <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span>  updated the doc)</p>",
        "id": 264553379,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639216445
    },
    {
        "content": "<p>Which other reasons may lead to HTTP status code 500?  The branch is called \"master\" and is the only branch in the repository.  Unfortunately, the error message \"Error: could not handle the request\" does not allow me to understand what shall be fixed.</p>",
        "id": 270976907,
        "sender_full_name": "Dmytro Rud",
        "timestamp": 1644240245
    },
    {
        "content": "<p>Ok, in my case, the error occurred because the value of the parameter <code>name</code> in sushi-config.yaml was not suitable for an identifier.</p>",
        "id": 271000514,
        "sender_full_name": "Dmytro Rud",
        "timestamp": 1644249980
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191870\">@Dmytro Rud</span> that woud normally be trapped with a local build, no? Did you try to run locally?</p>",
        "id": 271009469,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644253560
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> Sure, I ran the build locally multiple times.  There was no error, no warning in the console, but a warning on the QA page.</p>",
        "id": 271009936,
        "sender_full_name": "Dmytro Rud",
        "timestamp": 1644253771
    },
    {
        "content": "<p>Can you clarify where you're seeing this error (on what repo, and what the POST body looked like)?</p>",
        "id": 271010206,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644253888
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <br>\nRepository: <a href=\"https://github.com/ehealthsuisse/ch-epr-ppqm\">https://github.com/ehealthsuisse/ch-epr-ppqm</a><br>\nFailed delivery log: see attached <a href=\"/user_uploads/10155/jwZSyGx_9OUmUywlcuCwfCsX/delivery.txt\">delivery.txt</a></p>",
        "id": 271011131,
        "sender_full_name": "Dmytro Rud",
        "timestamp": 1644254329
    },
    {
        "content": "<p>I see a header in your delivery.txt with:</p>\n<div class=\"codehilite\"><pre><span></span><code>X-GitHub-Event: ping\n</code></pre></div>\n\n<p>... which is not expected. Can you confrim that you've selected \"Just the push\" and followed other instructions at <a href=\"https://github.com/fhir/auto-ig-builder#quick-start-guide\">https://github.com/fhir/auto-ig-builder#quick-start-guide</a> ?</p>\n<p>i.e. your config should show:<br>\n<a href=\"/user_uploads/10155/e2Vvsndour2jT35fTuOA_n9V/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/e2Vvsndour2jT35fTuOA_n9V/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/e2Vvsndour2jT35fTuOA_n9V/image.png\"></a></div>",
        "id": 271012892,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644255008
    },
    {
        "content": "<p>Yes, I confirm this.  The header is probably because I clicked on the \"Redeliver\" button on GitHub.  Please see attached the log of the previous (original) delivery: <a href=\"/user_uploads/10155/k6HLx_3lf5vmSJZlEjaB-oBg/delivery1.txt\">delivery1.txt</a>.</p>",
        "id": 271013797,
        "sender_full_name": "Dmytro Rud",
        "timestamp": 1644255402
    },
    {
        "content": "<p>The txt file you included again has</p>\n<div class=\"codehilite\"><pre><span></span><code>X-GitHub-Event: ping\n</code></pre></div>",
        "id": 271025586,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644260210
    },
    {
        "content": "<p>This indicates an unexpected event notification</p>",
        "id": 271025630,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644260229
    },
    {
        "content": "<p>Sorry, don't know how to improve this.  Webhook configuration:<br>\n<a href=\"/user_uploads/10155/dTW7IdDnQ0NjYRjXTItWKEqW/image.png\">image.png</a><br>\nPayload of the both requests:</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/dTW7IdDnQ0NjYRjXTItWKEqW/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/dTW7IdDnQ0NjYRjXTItWKEqW/image.png\"></a></div><div class=\"codehilite\"><pre><span></span><code>    &quot;events&quot;: [\n      &quot;push&quot;\n    ],\n</code></pre></div>",
        "id": 271027849,
        "sender_full_name": "Dmytro Rud",
        "timestamp": 1644261132
    },
    {
        "content": "<p>And when you actually do push to the repo, what notification log do you see?</p>",
        "id": 271035976,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644264945
    },
    {
        "content": "<p>If you want to share access with me (<code>jmandel</code>) I can attempt to diagnose.</p>",
        "id": 271036097,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644264989
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> Thank you, the problem was solved by fixing the attribute <code>name</code> in sushi-config.yaml.</p>",
        "id": 271055624,
        "sender_full_name": "Dmytro Rud",
        "timestamp": 1644274604
    },
    {
        "content": "<p>Hmm, I don't see how that could affect the initial webhook invocation's response status, since the sush-config contents aren't  part of the webhook invocation. But glad you've got this working now.</p>",
        "id": 271055722,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1644274678
    }
]