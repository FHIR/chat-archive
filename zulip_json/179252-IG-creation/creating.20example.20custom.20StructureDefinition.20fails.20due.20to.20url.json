[
    {
        "content": "<p>I'm working on the pCREDS ig and we're using structureDefinition for sending the mappings we want.  when I create an example instance, the url should point to where the published map will be, not an ig.  However, when I point to a URL that isn't the IG (or put in a UUID, etc.) the publisher fails with:</p>",
        "id": 253280272,
        "sender_full_name": "David Pyke",
        "timestamp": 1631636932
    },
    {
        "content": "<p>java.lang.Exception: Error generating snapshot for Cath-PCI Submission StructureDefinition(CathPCI): Cannot find or generate snapshot for base definition (null from <a href=\"http://hl7.org/fhir/cda/StructureDefinition/cathpci-map\">http://hl7.org/fhir/cda/StructureDefinition/cathpci-map</a>)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:4632)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3919)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:897)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:752)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:8664)<br>\nCaused by: java.lang.Exception: Cannot find or generate snapshot for base definition (null from <a href=\"http://hl7.org/fhir/cda/StructureDefinition/cathpci-map\">http://hl7.org/fhir/cda/StructureDefinition/cathpci-map</a>)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:4649)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:4630)</p>",
        "id": 253280285,
        "sender_full_name": "David Pyke",
        "timestamp": 1631636938
    },
    {
        "content": "<p>(the URL doesn't matter, that example was playing around with things.  I was hoping to point to a different server)</p>",
        "id": 253280401,
        "sender_full_name": "David Pyke",
        "timestamp": 1631636981
    },
    {
        "content": "<p>Do I need to point to the StructureDefinition profile it's based on?</p>",
        "id": 253280775,
        "sender_full_name": "David Pyke",
        "timestamp": 1631637121
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 253282245,
        "sender_full_name": "David Pyke",
        "timestamp": 1631637667
    },
    {
        "content": "<p>you're trying to point to a structure definition that doesn't exist?</p>",
        "id": 253283831,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631638306
    },
    {
        "content": "<p>It does exist, it's the one that's being created as an instance of the profile on StructureDefinition</p>",
        "id": 253283955,
        "sender_full_name": "David Pyke",
        "timestamp": 1631638339
    },
    {
        "content": "<p>It hasn't been published anywhere, though</p>",
        "id": 253283995,
        "sender_full_name": "David Pyke",
        "timestamp": 1631638356
    },
    {
        "content": "<p>well, how would the IG publisher find it?</p>",
        "id": 253284603,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631638568
    },
    {
        "content": "<p>No idea.  Can I tell it not to look?  IT doesnt' need to validate the example's url</p>",
        "id": 253284719,
        "sender_full_name": "David Pyke",
        "timestamp": 1631638616
    },
    {
        "content": "<p>The definition of StructureDefinition.url says \"is published (or will be published)\" so it shouldn't matter</p>",
        "id": 253285154,
        "sender_full_name": "David Pyke",
        "timestamp": 1631638770
    },
    {
        "content": "<p>it doesn't matter whether it's published or not. Only that the IG publisher knows about it</p>",
        "id": 253285788,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631639003
    },
    {
        "content": "<p>It should, it's an instance of an existing profile</p>",
        "id": 253285850,
        "sender_full_name": "David Pyke",
        "timestamp": 1631639023
    },
    {
        "content": "<p>well, I don't really know what you're doing. The URL you quote doesn't exist, and isn't valid. And won't be. But it looks like you don't have a base definition?</p>",
        "id": 253286017,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631639084
    },
    {
        "content": "<p>I don't understand</p>",
        "id": 253286728,
        "sender_full_name": "David Pyke",
        "timestamp": 1631639337
    },
    {
        "content": "<p>And it doesnt' matter what I put in, even a UUID, I get the same error</p>",
        "id": 253286919,
        "sender_full_name": "David Pyke",
        "timestamp": 1631639411
    },
    {
        "content": "<p>put in what? can we start this again... you have two structure definitions, with canonical urls of ?</p>",
        "id": 253290470,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631640705
    },
    {
        "content": "<p>I have a profile of StructureDef with the URL of <a href=\"http://hl7.org/fhir/us/fhir-registry-protocols-ig/StructureDefinition/CREDSStructureDefinition\">http://hl7.org/fhir/us/fhir-registry-protocols-ig/StructureDefinition/CREDSStructureDefinition</a>.  I have an example instance of that profile which fails, no matter what I put in the .url</p>",
        "id": 253291138,
        "sender_full_name": "David Pyke",
        "timestamp": 1631640948
    },
    {
        "content": "<p>github repo so we can see the source?</p>",
        "id": 253291671,
        "sender_full_name": "John Moehrke",
        "timestamp": 1631641146
    },
    {
        "content": "<p>so you've profiled StructureDefinition itself?</p>",
        "id": 253291702,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631641158
    },
    {
        "content": "<p>what did you put in the example instance?</p>",
        "id": 253291765,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631641186
    },
    {
        "content": "<p><a href=\"https://github.com/HL7/fhir-registry-protocols-ig\">https://github.com/HL7/fhir-registry-protocols-ig</a></p>",
        "id": 253295136,
        "sender_full_name": "David Pyke",
        "timestamp": 1631642521
    },
    {
        "content": "<p>I have no idea what the CathPci definition is trying to do, but it's not something that the tools support.</p>",
        "id": 253302054,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631645074
    },
    {
        "content": "<p>Okay, so, I'll have to manually create the examples.</p>",
        "id": 253302095,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645103
    },
    {
        "content": "<p>I don't know about manually or not, but it's not a valid structure definition as far as the tools are concerned</p>",
        "id": 253302164,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631645133
    },
    {
        "content": "<p>Okay, then I'll have to see what I need to do to make them valid</p>",
        "id": 253302254,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645164
    },
    {
        "content": "<p>it claims to be an abstract definition of a new base type, but the tools only have one specially known base type, Base. But then it presents a snap shot that just jumps straight into a deep path inside a structure, a path that can't exist</p>",
        "id": 253302358,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631645217
    },
    {
        "content": "<p>I can't even tell what you're actually trying to do here</p>",
        "id": 253302420,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631645247
    },
    {
        "content": "<p>I'm trying to set a mapping path between data needed for a registry and where that data could be found in FHIR/CDA/V2, etc.</p>",
        "id": 253302493,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645277
    },
    {
        "content": "<p>So, for last name, I put the mapping to be the places in FHIR Patient, CDA and an ADT message</p>",
        "id": 253302605,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645311
    },
    {
        "content": "<p>So, you would send this SD to a remote system would would pull the data based on the mappings in the SD</p>",
        "id": 253302670,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645342
    },
    {
        "content": "<p>YOu would then put the data into the Profile specified in the targetProfile element for inclusion in the submission Bundle</p>",
        "id": 253302782,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645392
    },
    {
        "content": "<p>THe CathPCI instance is a (small) example of the mappings they have for their data submissions to the ACC Cath-PCI registry</p>",
        "id": 253303004,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645463
    },
    {
        "content": "<p>but you can only do that with a structure definition if you have a structure that's actually defined. This profile doesn't do anything like that, so the tools go bang.</p>",
        "id": 253303205,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631645529
    },
    {
        "content": "<p>what's cathPci.snapshot.episodeUniqueKey? Where's it defined?</p>",
        "id": 253303230,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631645539
    },
    {
        "content": "<p>Oh, now I get it.</p>",
        "id": 253303279,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645561
    },
    {
        "content": "<p>Okay, it's not defined outside that SD.  So it makes sense that the tools go bang</p>",
        "id": 253303335,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645580
    },
    {
        "content": "<p>right. you need to define it, in order to do this, and then provide it as a definition, and then change to doing a derived profile on the base definition, and doing it in a differential, or just do it as a logical model and define the structure properly</p>",
        "id": 253303461,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1631645637
    },
    {
        "content": "<p>Okay, that I can fix</p>",
        "id": 253303544,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645658
    },
    {
        "content": "<p>Thank you</p>",
        "id": 253303621,
        "sender_full_name": "David Pyke",
        "timestamp": 1631645692
    }
]