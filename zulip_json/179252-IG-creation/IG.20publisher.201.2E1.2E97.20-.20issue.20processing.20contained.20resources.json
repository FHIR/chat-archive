[
    {
        "content": "<p>Hi, working with the <a href=\"https://github.com/hl7au/au-fhir-base\">HL7 Australia Base IG</a> and am getting a failure to build (ie not completing) with IG Publisher v1.1.97 but not so using v1.1.96 or earlier.<br>\nThe problem is with one of the example instances - the only one that has contained resources - and when this is commented out from the ig.xml, v1.1.97 runs successfully.<br>\nError messages indicate that the contained resources are being sought as individual instances rather than as being included in the example.</p>\n<p><em>The example</em>: <a href=\"https://github.com/hl7au/au-fhir-base/blob/master/examples/list-0ebc46a8-4ea8-11e9-8647-d663bd873d93.xml\">https://github.com/hl7au/au-fhir-base/blob/master/examples/list-0ebc46a8-4ea8-11e9-8647-d663bd873d93.xml</a></p>\n<p><em>Failure build log</em>: <a href=\"http://build.fhir.org/ig/hl7au/au-fhir-base/branches/master/failure/build.log\">http://build.fhir.org/ig/hl7au/au-fhir-base/branches/master/failure/build.log</a>, indicating:</p>\n<blockquote>\n<p>Could not locate the included file 'Encounter-28060b9a-4ffb-11e9-8647-d663bd873d93-html.xhtml' in any of ...</p>\n</blockquote>\n<p>Also note that the build log reports</p>\n<blockquote>\n<p>Error Generating Narrative for MedicationUsage/7e6620b8-4ea9-11e9-8647-d663bd873d93: Cannot find definition for MedicationUsage</p>\n</blockquote>\n<ul>\n<li>this is a R4 IG </li>\n<li>the <code>id</code> reported is one of the contained MedicationStatements in the same example</li>\n<li>there are 5 errors like this for the 5 contained MedicationStatements </li>\n</ul>\n<p>I have modified the example numerous ways with no impact to the build failure. And looking at the <a href=\"https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.97\">release notes for the v1.1.97 publisher</a> there has been some recent attention to \"Renderer: Create index for contained files\" - so posting here to seek guidance whether this is a publisher issue.</p>",
        "id": 268793477,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1642737891
    },
    {
        "content": "<p>fyi <span class=\"user-mention\" data-user-id=\"191368\">@Brett Esler</span> <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span></p>",
        "id": 268793734,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1642738239
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  does this look like the same issue that you were dealing with in the SDC IG?<br>\n(or possibly related to the fix that was being done for it?)</p>",
        "id": 268793766,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1642738308
    },
    {
        "content": "<p>The SDC IG wasn't and still isn't failing.  There was a recent fix.  But it shouldn't have done anything that would trigger a failure.  <br>\n<span class=\"user-mention\" data-user-id=\"192270\">@Rob Eastwood</span>, can you provide a full stack trace?</p>",
        "id": 268796997,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1642741778
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179252-IG-creation/topic/IG.20publisher.201.2E1.2E97.20-.20issue.20processing.20contained.20resources/near/268796997\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"192270\">Rob Eastwood</span>, can you provide a full stack trace?</p>\n</blockquote>\n<p>Note that on my local machine running the IG Publisher, it just hangs at \"Jekyll: Generating...\" and progresses no further; I have to kill the process. The following stack trace was generated using jstack at the point of 5 mins or so  into the hang. Others in my team get the error as demonstrated in the build.log link above. </p>\n<p>GitHub gist: <a href=\"https://gist.github.com/robeastwood-agency/94c65fe37e7e41267fe7d5ba9aca5513\">https://gist.github.com/robeastwood-agency/94c65fe37e7e41267fe7d5ba9aca5513</a></p>\n<p>(caveat - my first attempt getting stack trace &amp; happy to be poked in another direction as needed)</p>\n<p>Many thanks for looking into this <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span></p>",
        "id": 268800694,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1642745770
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192270\">@Rob Eastwood</span> still an issue I expect?<br>\nI might get a chance to look later in the week.</p>",
        "id": 269061727,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1643002167
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191367\">Brian Postlethwaite</span> <a href=\"#narrow/stream/179252-IG-creation/topic/IG.20publisher.201.2E1.2E97.20-.20issue.20processing.20contained.20resources/near/269061727\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"192270\">Rob Eastwood</span> still an issue I expect?</p>\n</blockquote>\n<p>Yes, still an issue for me</p>",
        "id": 269063001,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1643003894
    },
    {
        "content": "<p>I grabbed the IG from Git and ran it.  Jekyll failed with the following:<br>\nJekyll: Source: C:/Users/lloyd/Documents/SVN/_IGs/_other/au-fhir-base/temp       (06:38.0772)<br>\nJekyll: Generating...                                                            (06:38.0774)<br>\nJekyll has failed. Complete output from running Jekyll: ‚Üê[31m  Liquid Exception: Could not locate the included file 'Encounter-28060b9a-4ffb-11e9-8647-d663bd873d93-html.xhtml' in any of [\"C:/Users/lloyd/Documents/SVN/_IGs/_other/au-fhir-base/temp/_includes\"]. Ensure it exists in one of those directories and, if (06:56.0544)<br>\nNote: Check that Jekyll is installed correctly                                   (06:56.0549)<br>\nPublishing Content Failed: Process exited with an error: 1 (Exit value: 1)       (06:56.0558)</p>",
        "id": 269138032,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643044467
    },
    {
        "content": "<p>is this fixed then?</p>",
        "id": 269519828,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643252447
    },
    {
        "content": "<p>I don't know - but the issue seemed to be a problem with the IG.</p>",
        "id": 269521536,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1643254306
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/IG.20publisher.201.2E1.2E97.20-.20issue.20processing.20contained.20resources/near/269519828\">said</a>:</p>\n<blockquote>\n<p>is this fixed then?</p>\n</blockquote>\n<p>(sorry, I have been on leave for a few days)</p>\n<p>No, not yet fixed:</p>\n<p>Build details:</p>\n<ul>\n<li>HL7 Australia AU Base 2 IG, latest master commit <a href=\"https://github.com/hl7au/au-fhir-base/commit/3111965a7bc3e33364d8265f9485fdb2f0d2aad2\">#3111965a7</a></li>\n<li>using <a href=\"https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.97\">IG Publisher v1.1.97</a></li>\n<li>fresh build manually triggered for <a href=\"http://build.fhir.org\">build.fhir.org</a> (using instructions <a href=\"https://github.com/FHIR/auto-ig-builder/blob/master/README.md#if-you-want-to-manually-trigger-a-build\">here</a>), with the resultant <a href=\"http://build.fhir.org/ig/hl7au/au-fhir-base/branches/master/failure/build.log\">failure build.log</a> including this:</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code>Jekyll has failed. Complete output from running Jekyll: \u001b[31m  Liquid Exception: Could not locate the included file &#39;Encounter-28060b9a-4ffb-11e9-8647-d663bd873d93-html.xhtml&#39; in any of [&quot;/scratch/ig-build-temp-YZMUH0/repo/temp/_includes&quot;]. Ensure it exists in one of those directories and, if it is a symlink, d (04:33.0448)\nNote: Check that Jekyll is installed correctly                                   (04:33.0448)\nPublishing Content Failed: Process exited with an error: 1 (Exit value: 1)       (04:33.0449)\n                                                                                 (04:33.0449)\nUse -? to get command line help                                                  (04:33.0449)\n                                                                                 (04:33.0449)\nStack Dump (for debugging):                                                      (04:33.0449)\norg.apache.commons.exec.ExecuteException: Process exited with an error: 1 (Exit value: 1)\n    at org.apache.commons.exec.DefaultExecutor.executeInternal(DefaultExecutor.java:404)\n    at org.apache.commons.exec.DefaultExecutor.execute(DefaultExecutor.java:166)\n    at org.apache.commons.exec.DefaultExecutor.execute(DefaultExecutor.java:153)\n    at org.hl7.fhir.igtools.publisher.Publisher.runJekyll(Publisher.java:6053)\n    at org.hl7.fhir.igtools.publisher.Publisher.runTool(Publisher.java:5974)\n    at org.hl7.fhir.igtools.publisher.Publisher.generate(Publisher.java:5335)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:960)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:798)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9079)\n</code></pre></div>\n<p>The build.log also reports an inability to find MedicationUsage instances with ids that are only are included as references to contained MedicationStatements in a List example (see <a href=\"https://github.com/hl7au/au-fhir-base/blob/master/examples/list-0ebc46a8-4ea8-11e9-8647-d663bd873d93.xml#L452\">this</a> and <a href=\"https://github.com/hl7au/au-fhir-base/blob/master/examples/list-0ebc46a8-4ea8-11e9-8647-d663bd873d93.xml#L147-L160\">this</a>). When the List example is excluded from being processed by the publisher, the build is successful using v1.1.97. </p>\n<p>Note the same IG successfully runs using <a href=\"https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.96\">v1.1.96</a>.</p>\n<p>I'd be happy to provide more information, if that would help.</p>",
        "id": 270138289,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1643680026
    },
    {
        "content": "<p><strong>Update re IG Publisher v1.1.98</strong></p>\n<p>HL7 AU build still fails, with identical error message reported above re \"<em>Could not locate the included file 'Encounter-28060b9a-4ffb-11e9-8647-d663bd873d93-html.xhtml'</em>\" (new <a href=\"http://build.fhir.org/ig/hl7au/au-fhir-base/branches/master/failure/build.log\">build log</a>). Note</p>\n<ul>\n<li>the ig.xml does not have a listing for an Encounter instance with this id - the id is only present in a List example as a <a href=\"https://github.com/hl7au/au-fhir-base/blob/master/examples/list-0ebc46a8-4ea8-11e9-8647-d663bd873d93.xml#L436-L438\">reference for List.encounter</a> to an internal <a href=\"https://github.com/hl7au/au-fhir-base/blob/master/examples/list-0ebc46a8-4ea8-11e9-8647-d663bd873d93.xml#L370-L419\">contained Encounter resource</a></li>\n<li>when this List example is excluded from the build, it runs successfully</li>\n<li>maybe this List example is doing containment incorrectly, but I can't see it - please suggest variations if anyone has ideas</li>\n</ul>\n<p>Also note that the earlier reported messages re \"<em>inability to find MedicationUsage instances</em>\" are no longer present in the 1.1.98 build.log (presumably related to the publisher release note \"<em>Renderer: Stop trying to use R5 version of contained resource for internal rendering</em>\")</p>",
        "id": 270305627,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1643757628
    },
    {
        "content": "<p>I can't reproduce this?</p>",
        "id": 270630423,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643928587
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/IG.20publisher.201.2E1.2E97.20-.20issue.20processing.20contained.20resources/near/270630423\">said</a>:</p>\n<blockquote>\n<p>I can't reproduce this?</p>\n</blockquote>\n<p>mmm, that's not good! Thanks for looking <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> </p>\n<p>Even though it happens on local PCs for us, it also occurs (ie fails) in the cloud build.fhir environment; see the link above for the build.log indicating how the auto-builder fails to complete.</p>\n<p>I confess to being at a total loss to know what else to do to problem solve this one - anyone have any suggestions?</p>",
        "id": 270648289,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1643933885
    },
    {
        "content": "<p>I think that this is a problem in the Australian template</p>",
        "id": 270655739,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643938745
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/IG.20publisher.201.2E1.2E97.20-.20issue.20processing.20contained.20resources/near/270655739\">said</a>:</p>\n<blockquote>\n<p>I think that this is a problem in the Australian template</p>\n</blockquote>\n<p>Actually, I have come to the same conclusion - I have just copied the problematic HL7AU List example into a fresh IG using the <a href=\"https://github.com/FHIR/sample-ig\">https://github.com/FHIR/sample-ig</a> - and it doesn't fail to build.</p>",
        "id": 270657467,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1643939851
    },
    {
        "content": "<p>fixed.</p>",
        "id": 270658754,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643940831
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/IG.20publisher.201.2E1.2E97.20-.20issue.20processing.20contained.20resources/near/270658754\">said</a>:</p>\n<blockquote>\n<p>fixed.</p>\n</blockquote>\n<p>Many many thanks Graham for your decisive input here. </p>\n<p>And apologies for casting doubt on the IG publisher; that was not intended.</p>",
        "id": 270660014,
        "sender_full_name": "Rob Eastwood",
        "timestamp": 1643941903
    }
]