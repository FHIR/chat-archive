[
    {
        "content": "<p>I'm building the fhir-order-catalog IG. This IG includes profiles of PlanDefinition and ChargeItemDefinition. My example of these two resources systematically lose their useContext elements in the output of the IG. In addition PlanDefinition also loses action.definitionCanonical element. See for intance this example in the input: <a href=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-blood-electrolyte.xml\" target=\"_blank\" title=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-blood-electrolyte.xml\">https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-blood-electrolyte.xml</a>, and then check the output in the artifacts of the guide.  Any idea on this issue? Thanks</p>",
        "id": 188023182,
        "sender_full_name": "François Macary",
        "timestamp": 1581523159
    },
    {
        "content": "<p>What version of FHIR is the IG targeting?</p>",
        "id": 188024325,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581523672
    },
    {
        "content": "<p>4.0.1</p>",
        "id": 188024470,
        "sender_full_name": "François Macary",
        "timestamp": 1581523735
    },
    {
        "content": "<p>That's really weird...  The order of elements in your source instance is correct.  There appears to be no change from 4.0.1 to R5 for the respective elements.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> any ideas?</p>",
        "id": 188025799,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581524425
    },
    {
        "content": "<p>it was code you wrote, <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> , of course</p>",
        "id": 188046288,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581536502
    },
    {
        "content": "<p>fixed next release</p>",
        "id": 188046733,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581536794
    },
    {
        "content": "<p>Looking forward to it :-) Thank you, guys.</p>",
        "id": 188055024,
        "sender_full_name": "François Macary",
        "timestamp": 1581543012
    },
    {
        "content": "<p>I don't think I'm deserving of thanks in this particular case... (sorry)</p>",
        "id": 188055397,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581543325
    },
    {
        "content": "<p>The fix is only partial, unfortunately. <br>\nNow my examples of PlanDefinition and ChargeItemDefinition have their useContext elements generated in the output. Happy of this!<br>\nBut my PlanDefinition elements are still missing some child elements  of PlanDefinition.action in the output.</p>\n<p>This example:  <a href=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-blood-electrolyte.xml\" target=\"_blank\" title=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-blood-electrolyte.xml\">https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-blood-electrolyte.xml</a> <br>\nis missing action.definitionCanonical value=\"ActivityDefinition/example-lab-blood-electrolyte\" in the output. </p>\n<p>This example:  <a href=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-test-serum-creatinine.xml\" target=\"_blank\" title=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-test-serum-creatinine.xml\">https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-test-serum-creatinine.xml</a><br>\nis missing its two sub-actions and their respective definitionCanonical child elements (lines #107 to #112 vanished from the output)</p>",
        "id": 188125225,
        "sender_full_name": "François Macary",
        "timestamp": 1581612539
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> There is more around parsing PlanDefinition.action. Apparently the IG builder is not able to parse a PlanDefinition with more than one level of nested actions. It aborts with a java error in that case.<br>\nUnlike in the Dune novel, it could not say \"I can see plans within plans\".<br>\nI'm guessing that this is closely related to the issue above.</p>",
        "id": 188136717,
        "sender_full_name": "François Macary",
        "timestamp": 1581619521
    },
    {
        "content": "<p>looking into this... I notice that you are not using semantic versioning for your version. As an HL7 IG, this will be required before publication</p>",
        "id": 188142939,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581623148
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192504\">@François Macary</span>  I found and fixed the issue with action.definitionCanonical but I can not reproduce the issue with the sub-actions. I see it on the ci-build, but not locally. that's real weird, because there's no change since release except for the action.definitionCanonical  thing. </p>\n<p>you say:</p>\n<blockquote>\n<p>It aborts with a java error in that case.</p>\n</blockquote>\n<p>What is the specific error? I don't see that on the ci-build?</p>",
        "id": 188144533,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581624072
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  I checked right now on the CI build. The PlanDefinition.action.definitionCanonical are still missing for all my 5 examples.<br>\nI had commented the more complex one E5 with two levels of sub-actions, which provoked the abort. I'm removing the comments right now.<br>\nThis one:  <a href=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-urine24h-creatinine-clearance.xml\" target=\"_blank\" title=\"https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-urine24h-creatinine-clearance.xml\">https://github.com/HL7/fhir-order-catalog/blob/master/input/examples/example-lab-panel-urine24h-creatinine-clearance.xml</a> <br>\nI have also used the &lt;Debug Summary&gt; button and sent you the content by email, as instructed by this button.<br>\nSo in summary: <br>\n1) I don't see yet any PlanDefinition.action.definitionCanonical in the output<br>\n2) The problematic example above aborts tne build.</p>",
        "id": 188187573,
        "sender_full_name": "François Macary",
        "timestamp": 1581669507
    },
    {
        "content": "<p>All corrected. Thanks <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 188617614,
        "sender_full_name": "François Macary",
        "timestamp": 1582186362
    }
]