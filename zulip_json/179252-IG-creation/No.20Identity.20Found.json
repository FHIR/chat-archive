[
    {
        "content": "<p>Anyone seen this error: '''Error loading CodeSystem-2.16.840.1.113883.6.259.json: Internal error in IG NHSNHealthcareAssociatedInfectionReports map: No identity found for <a href=\"http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259\" target=\"_blank\" title=\"http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259\">http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259</a> (00:14.0516)<br>\nPublishing Content Failed: Error loading CodeSystem-2.16.840.1.113883.6.259.json: Internal error in IG NHSNHealthcareAssociatedInfectionReports map: No identity found for <a href=\"http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259\" target=\"_blank\" title=\"http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259\">http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259</a> (00:14.0516)'''. </p>\n<p>Not sure what 'no identity found' refers to.</p>",
        "id": 184782409,
        "sender_full_name": "David deRoode",
        "timestamp": 1578102381
    },
    {
        "content": "<p>It means that when loading that code system from the package where it's defined, there's no entry in the spec.internals file that indicates what page should be the target of hyperlinks when referring to that resource in the current IG.  It means that there's something wrong with the NPM package for the IG you're pointing to.  If you're able to, try regenerating the referenced IG.  If that's still unhappy, provide a copy of the NPM package for that IG and we can see if we can figure out what's going on.</p>",
        "id": 184785562,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578108035
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> we can't regenerate the IG we are pointing to as it's published. The NPM Package is here: <a href=\"http://hl7.org/fhir/us/hai/package.tgz\" target=\"_blank\" title=\"http://hl7.org/fhir/us/hai/package.tgz\">http://hl7.org/fhir/us/hai/package.tgz</a> <br>\nIt looks like the spec.internals file is correct though? (Not that I really know what it should look like!). But in \"paths\" it has:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259|2.0.0&quot;: &quot;2.0.0/CodeSystem-2.16.840.1.113883.6.259.html&quot;,\n    &quot;http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259&quot;: &quot;CodeSystem-2.16.840.1.113883.6.259.html&quot;,\n</pre></div>\n\n\n<p>And in \"targets\" it has:</p>\n<div class=\"codehilite\"><pre><span></span> &quot;CodeSystem-2.16.840.1.113883.6.259.html&quot;,\n    &quot;CodeSystem-2.16.840.1.113883.6.259.json.html&quot;,\n    &quot;CodeSystem-2.16.840.1.113883.6.259.ttl.html&quot;,\n    &quot;CodeSystem-2.16.840.1.113883.6.259.xml.html&quot;,\n</pre></div>",
        "id": 184979129,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578367574
    },
    {
        "content": "<p>And actually, now I'm confused. There is also this file: <a href=\"http://hl7.org/fhir/us/hai/STU2/package.tgz\" target=\"_blank\" title=\"http://hl7.org/fhir/us/hai/STU2/package.tgz\">http://hl7.org/fhir/us/hai/STU2/package.tgz</a> which is from the circled url in the screen shot: <a href=\"/user_uploads/10155/HIblrhgPCpnxz40R7r2tEs8-/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/HIblrhgPCpnxz40R7r2tEs8-/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/HIblrhgPCpnxz40R7r2tEs8-/pasted_image.png\"></a></div><p>Its contained spec.internals file is quite different to the one at the previous link I sent. Should they not be the same?</p>",
        "id": 184979277,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578367831
    },
    {
        "content": "<p>Now I'm thinking it must have had something to do with this thread (<a href=\"#narrow/stream/179252-IG-creation/topic/Dependency.20package.20missing.20other.2Fspec.2Einternals\" title=\"#narrow/stream/179252-IG-creation/topic/Dependency.20package.20missing.20other.2Fspec.2Einternals\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Dependency.20package.20missing.20other.2Fspec.2Einternals</a>) where <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> fixed our earlier issue. The internals.spec in the STU2 link has the same date as when he fixed it. I think maybe someone just needs to regenerate the tgz?</p>",
        "id": 184980437,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578369766
    },
    {
        "content": "<p>I don't see anything obviously wrong from the tgz.  Only thing suspect is that the versions of the artifacts and the versions of the IG aren't the same.  Also, the version-specific paths have a relative path of 2.0.0, which I don't think is correct - though tool would have no way of knowing that.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , thoughts?</p>",
        "id": 185013099,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578406138
    },
    {
        "content": "<p>I looked at US Core's file to compare and it also had those version specific paths.</p>",
        "id": 185048050,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578426977
    },
    {
        "content": "<p>The second spec.internals file I mentioned that is different (the one at the permanent link for stu2) does not have those version specific paths. It is missing some other stuff at the beginning of the file.</p>",
        "id": 185048296,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578427089
    },
    {
        "content": "<p>so this is still an issue?</p>",
        "id": 185469403,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1578898941
    },
    {
        "content": "<p>Yes it is.</p>",
        "id": 185469544,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578899227
    },
    {
        "content": "<p>ok. so I'm not clear what the actual manifestation of it is, or how I would know if I've fixed it</p>",
        "id": 185470034,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1578899995
    },
    {
        "content": "<p>Let me just rebuild that IG and double check that it's still an issue. I'll get back to you if it is.</p>",
        "id": 185470322,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578900416
    },
    {
        "content": "<p>Ok definitely still an issue. Will try to explain...<br>\nThe HAI LTCF IG is failing to build with the following error message (<a href=\"http://build.fhir.org/ig/HL7/HAI-LTCF/branches/master/build.log\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/HAI-LTCF/branches/master/build.log\">http://build.fhir.org/ig/HL7/HAI-LTCF/branches/master/build.log</a>): </p>\n<div class=\"codehilite\"><pre><span></span>org.hl7.fhir.exceptions.FHIRException: Error loading CodeSystem-2.16.840.1.113883.6.259.json: Internal error in IG NHSNHealthcareAssociatedInfectionReports map: No identity found for http://hl7.org/fhir/us/hai/CodeSystem/2.16.840.1.113883.6.259\n</pre></div>\n\n\n<p>The HAI LTCF IG has a dependency on the HAI IG that has already been published.</p>\n<p>According to Lloyd, that error message means that there is no entry in the spec.internals file to show what page should be the target of hyperlinks when referring to that resource in the IG (HAI ig).</p>\n<p>So I did a bit of digging and found two different spec.internals files here: <a href=\"http://hl7.org/fhir/us/hai/package.tgz\" target=\"_blank\" title=\"http://hl7.org/fhir/us/hai/package.tgz\">http://hl7.org/fhir/us/hai/package.tgz</a> and here: <a href=\"http://hl7.org/fhir/us/hai/STU2/package.tgz\" target=\"_blank\" title=\"http://hl7.org/fhir/us/hai/STU2/package.tgz\">http://hl7.org/fhir/us/hai/STU2/package.tgz</a> </p>\n<p>The latter spec.internals file looks incomplete. I'm assuming the dependency lookup would be on the specific version (STU2).</p>\n<p>Back in November we had a different issue when trying to build the HAI LTCF IG  - HAI was completely missing the spec.internals file. See this thread:  <a href=\"#narrow/stream/179252-IG-creation/topic/Dependency.20package.20missing.20other.2Fspec.2Einternals\" title=\"#narrow/stream/179252-IG-creation/topic/Dependency.20package.20missing.20other.2Fspec.2Einternals\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Dependency.20package.20missing.20other.2Fspec.2Einternals</a> </p>\n<p>You fixed this for us, I'm guessing, by generating the file?</p>\n<p>But... and again this is just a guess based on the date on the STU2 spec.internals file (i.e. the same date that you said you'd fixed it) that is missing information that I mention up above, I think maybe something went wrong there and it is missing some stuff??  Like I said just a guess...</p>",
        "id": 185470781,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1578901102
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191918\">@Sarah Gaunt</span> I get the same when depending on hl7.fhir.r4.core#3.0.2:</p>\n<div class=\"codehilite\"><pre><span></span><code>org.hl7.fhir.exceptions.FHIRException: Error loading CapabilityStatement-base.json: Internal error in IG hl7.fhir.r3.core#3.0.2 map: No identity found for http://hl7.org/fhir/CapabilityStatement/base\n        at org.hl7.fhir.igtools.publisher.Publisher.loadFromPackage(Publisher.java:2620)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:2574)\n        at org.hl7.fhir.igtools.publisher.Publisher.initializeFromIg(Publisher.java:1754)\n        at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1334)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:701)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7756)\nCaused by: java.lang.Exception: Internal error in IG hl7.fhir.r3.core#3.0.2 map: No identity found for http://hl7.org/fhir/CapabilityStatement/base\n        at org.hl7.fhir.igtools.publisher.Publisher.loadResourceFromPackage(Publisher.java:2652)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadFromPackage(Publisher.java:2617)\n        ... 5 more\n</code></pre></div>\n\n\n<p>Dependencies in my IG:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;dependsOn&quot;: [\n    {\n      &quot;packageId&quot;: &quot;hl7.fhir.r3.core&quot;,\n      &quot;version&quot;: &quot;3.0.2&quot;,\n    }\n</code></pre></div>\n\n\n<p>I probably shouldn't have done that, it's already inferred by the validator from my FHIR version setting and runs fine when I leave out the <code>dependsOn</code>. But perhaps it helps debugging the above.</p>",
        "id": 211906925,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1601557942
    }
]