[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  your decision to throttle the page toc levels to 1..3 is causing me headaches.</p>\n<p>Since every markdown page header can only start with h3 level or the section numbering repeat the page title.  That only give a single level page TOC which is  too inflexible IMO.</p>\n<p>For example this page:  <a href=\"http://build.fhir.org/ig/HL7/davinci-deqm/branches/master/datax.html\">http://build.fhir.org/ig/HL7/davinci-deqm/branches/master/datax.html</a>  (building as I write this)<br>\nI need the h4 levels displayed in the toc header as these are key sections.</p>\n<p>I propose we follow the <a href=\"https://kramdown.gettalong.org/converter/html.html\">Kramdown guidance here</a> and make page toc levels to 1..4  and if you want to hide a header use the .no_toc class</p>\n<p>e.g.</p>\n<div class=\"codehilite\"><pre><span></span><code>#### FOO\n{:.no_toc}\n</code></pre></div>",
        "id": 203532488,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594400576
    },
    {
        "content": "<p>P.S. There is no way in Jekyll to override this default as far as I can find.</p>",
        "id": 203532890,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594400772
    },
    {
        "content": "<p>I don't want authors to have to do anything to influence the TOC - if it's going to be variable, it should be determined by a script, not by the author.  Author control adds to complexity and makes it too easy to get it wrong.</p>",
        "id": 203533485,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1594401084
    },
    {
        "content": "<p>I will continue to disagree ...but anyway...  in addition, those annoying empty TOC boxes still persist.   We could get rid of them with page level controls by adding more elements the to IG resources and defining them there  ( but I question if this is easier)</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nn\">...</span>\n<span class=\"nt\">page</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">generation</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">markdown</span>\n    <span class=\"nt\">nameUrl</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">index.html</span>\n    <span class=\"nt\">extension</span><span class=\"p\">:</span>\n      <span class=\"p p-Indicator\">-</span> <span class=\"nt\">url</span><span class=\"p\">:</span> <span class=\"s\">&#39;http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/extension-show_toc&#39;</span>\n        <span class=\"nt\">valueBoolean</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">False</span> <span class=\"c1\">#default = True</span>\n<span class=\"l l-Scalar l-Scalar-Plain\">....</span>\n</code></pre></div>",
        "id": 203534553,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594401700
    },
    {
        "content": "<p>and a  site parameter...</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nn\">...</span>\n  <span class=\"nt\">parameter</span><span class=\"p\">:</span>\n    <span class=\"p p-Indicator\">-</span> <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">max-toc-level</span>\n      <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"s\">&quot;4&quot;</span> <span class=\"c1\">#default = 3</span>\n<span class=\"nn\">...</span>\n</code></pre></div>",
        "id": 203535113,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594402001
    },
    {
        "content": "<p>My take on this: Give Vanilla to everyone - no user should need to change the ToC from the defaults. If some institution wants to change the levels, they can mess with the template, enjoy the risks and handle the benefits.<br>\nBut also allow some gourmet users to make advanced flavour - those users should be able to override sections of the ToC - to the extent that the template allows - institutions (e.g. IHE) may want to lock down the depth of their IGs.</p>",
        "id": 203535635,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1594402261
    },
    {
        "content": "<p>I think the extension is heavy, but TBH it's because it is an extension. I had a similar / crazier idea, which would require changes to the ImplementationGuide resource.</p>",
        "id": 203535860,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1594402391
    },
    {
        "content": "<p>I question the original decision on the default since it only allow a single level.</p>",
        "id": 203535908,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594402417
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> I think you missed 2 spaces before the word <code>extension</code> in your yaml..?</p>",
        "id": 203536113,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1594402521
    },
    {
        "content": "<p>Changing this XML will not be a simple fix and will have impact on other parts. <br>\nI feel the pain though -  not sure an extension will avoid further pain.</p>",
        "id": 203536652,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1594402837
    },
    {
        "content": "<p>Yes that is  copy and paste error fixed....</p>",
        "id": 203536831,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594402945
    },
    {
        "content": "<p>Well existing guides feel the pain having to reformat to conform.. Authors are not off the hook in either case.</p>",
        "id": 203537060,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594403055
    },
    {
        "content": "<p>I'm not a fan of users in HL7 IGs doing any overriding.  I would like to keep the learning curve the same for all IGs and behavior consistent regardless of who the author happened to be.  I don't think we can technically prohibit overriding in most cases, but we should strongly discourage it.  I'm perfectly happy with us to tune the appearance of the ToC - removing empty ToCs on those pages that legitimately are so short they don't need sub-sections (though those should be pretty rare).  I'm also ok with making the generation of the ToC 'smarter' such that if going deeper will make a more useful ToC in certain cases, then we make it go deeper.  I just <em>don't</em> want that to be an author-governed behavior.  I already suppress ToC on HTML-authored pages when it's empty - because I can easily parse the HTML.  I wasn't super clear on how to write Javascript to parse the markdown to accomplish the same think for markdown authored pages, so I didn't.  But in principle, that could be done.  And if we can come up with a set of criteria that would allow us to decide on when it's appropriate/reasonable to have a deeper ToC, we can certainly plug that logic into the generation process too.</p>",
        "id": 203538711,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1594403991
    },
    {
        "content": "<blockquote>\n<p>I already suppress ToC on HTML-authored pages when it's empty - because I can easily parse the HTML.</p>\n</blockquote>",
        "id": 203539084,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594404151
    },
    {
        "content": "<p>OK  I'll make a PR...</p>",
        "id": 203539582,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594404389
    },
    {
        "content": "<p>I have liquid solution</p>",
        "id": 203560490,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594417102
    }
]