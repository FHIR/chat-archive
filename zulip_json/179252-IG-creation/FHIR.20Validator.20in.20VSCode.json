[
    {
        "content": "<p>This might be useful for those of you using VSCode during IG creation: You can create a custom-task in tasks.json that runs the fhir-validator on your resources and reports the output as problems with highlighting in vscode using a custom problemMatcher:<br>\n<a href=\"/user_uploads/10155/Oz2z-mmOqP3FZOWTHgWzdsWJ/vscode-validator-example.png\">vscode-validator-example.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/Oz2z-mmOqP3FZOWTHgWzdsWJ/vscode-validator-example.png\" title=\"vscode-validator-example.png\"><img src=\"/user_uploads/10155/Oz2z-mmOqP3FZOWTHgWzdsWJ/vscode-validator-example.png\"></a></div><p>Note: This problemMatcher only works when validating at least 2 resources, because the console-output when validating a single resource differs from multi-resource validation.</p>\n<p>tasks.json:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"nt\">\"version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"2.0.0\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"tasks\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">\"label\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Run FHIR Validator\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"type\"</span><span class=\"p\">:</span> <span class=\"s2\">\"shell\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"command\"</span><span class=\"p\">:</span> <span class=\"s2\">\"java\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"args\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s2\">\"-jar\"</span><span class=\"p\">,</span> <span class=\"s2\">\"validator_cli.jar\"</span><span class=\"p\">,</span>\n        <span class=\"s2\">\"${workspaceFolder}/test-resources\"</span><span class=\"p\">,</span>\n        <span class=\"s2\">\"-version\"</span><span class=\"p\">,</span> <span class=\"s2\">\"4.0\"</span><span class=\"p\">,</span>\n      <span class=\"p\">],</span>\n      <span class=\"nt\">\"presentation\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">\"clear\"</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">},</span>\n      <span class=\"nt\">\"problemMatcher\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"p\">{</span>\n          <span class=\"nt\">\"source\"</span><span class=\"p\">:</span> <span class=\"s2\">\"FHIR Validator\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"fileLocation\"</span><span class=\"p\">:</span> <span class=\"s2\">\"absolute\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"pattern\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n            <span class=\"p\">{</span>\n              <span class=\"nt\">\"regexp\"</span><span class=\"p\">:</span> <span class=\"s2\">\"^-- (.+) -{5,}$\"</span><span class=\"p\">,</span>\n              <span class=\"nt\">\"file\"</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n            <span class=\"p\">},</span>\n            <span class=\"p\">{</span>\n              <span class=\"nt\">\"regexp\"</span><span class=\"p\">:</span> <span class=\"s2\">\"^.*$\"</span><span class=\"p\">,</span>\n            <span class=\"p\">},</span>\n            <span class=\"p\">{</span>\n              <span class=\"nt\">\"regexp\"</span><span class=\"p\">:</span> <span class=\"s2\">\"^  ((?:Info|Warning|Error)).* \\\\(line ?(\\\\d+), col ?(\\\\d+)\\\\) : (.+)$\"</span><span class=\"p\">,</span>\n              <span class=\"nt\">\"severity\"</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n              <span class=\"nt\">\"line\"</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">,</span>\n              <span class=\"err\">//</span><span class=\"nt\">\"column\"</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n              <span class=\"nt\">\"message\"</span><span class=\"p\">:</span> <span class=\"mi\">4</span><span class=\"p\">,</span>\n              <span class=\"nt\">\"loop\"</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n            <span class=\"p\">}</span>\n          <span class=\"p\">]</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 256963687,
        "sender_full_name": "Eirik Myklebost",
        "timestamp": 1633880099
    },
    {
        "content": "<blockquote>\n<p>This problemMatcher only works when validating at least 2 resources, because the console-output when validating a single resource differs from multi-resource validation</p>\n</blockquote>\n<p>umm. really? I would've thought it would be the other way around?</p>",
        "id": 256999201,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633914485
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/FHIR.20Validator.20in.20VSCode/near/256999201\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>This problemMatcher only works when validating at least 2 resources, because the console-output when validating a single resource differs from multi-resource validation</p>\n</blockquote>\n<p>umm. really? I would've thought it would be the other way around?</p>\n</blockquote>\n<p>Output from single resource validation:</p>\n<div class=\"codehilite\"><pre><span></span><code>Validating\n  Validate fsh-generated\\resources\\Questionnaire-NAV-06-03-04.json   ..Detect format for fsh-generated\\resources\\Questionnaire-NAV-06-03-04.json\n 00:01.0003\nDone. Times: Loading: 00:12.0465, validation: 00:01.0004. Memory = 398Mb\n\nSuccess: 0 errors, 5 warnings, 2 notes\n  Information @ Questionnaire.item[0].answerValueSet (line 21, col68) : Canonical URL &#39;http://fhir.nav.no/ValueSet/icd10-vs-nr2&#39; does not resolve\n</code></pre></div>\n<p>Output from multi resource validation:</p>\n<div class=\"codehilite\"><pre><span></span><code>Validating\n  Validate fsh-generated\\resources\\Patient.json   ..Detect format for fsh-generated\\resources\\Patient.json\n 00:00.0083\n  Validate fsh-generated\\resources\\Questionnaire-NAV-06-03-04.json   ..Detect format for fsh-generated\\resources\\Questionnaire-NAV-06-03-04.json\n 00:00.0836\nDone. Times: Loading: 00:10.0786, validation: 00:00.0923 (#2). Memory = 353Mb\n\n-- fsh-generated\\resources\\Patient.json --------------------------------------------\nSuccess: 0 errors, 0 warnings, 1 notes\n  Information @ ?? : All OK\n------------------------------------------------------------------------------------\n\n-- fsh-generated\\resources\\Questionnaire-NAV-06-03-04.json ---------------------------------------------------------------\nSuccess: 0 errors, 5 warnings, 2 notes\n  Information @ Questionnaire.item[0].answerValueSet (line 21, col68) : Canonical URL &#39;http://fhir.nav.no/ValueSet/icd10-vs-nr2&#39; does not resolve\n</code></pre></div>\n<p>The problemMatcher uses regex and looks for <code>-- {filepath} -----</code>, which is excluded from the single-resource validation output.</p>",
        "id": 257027006,
        "sender_full_name": "Eirik Myklebost",
        "timestamp": 1633939176
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , is it possible to change the log format, or add support for different styles? Using an already established format will make it easier to integrate the validator in IDEs and tools, e.g. as a linter. <a href=\"https://eslint.org/docs/user-guide/formatters/\">ESlint's compact or stylish format</a> are some alternatives.</p>",
        "id": 257222789,
        "sender_full_name": "Eirik Myklebost",
        "timestamp": 1634052890
    },
    {
        "content": "<p>it's possible, sure. I'd accept a PR or you can create a task. I'</p>",
        "id": 257249865,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634063285
    },
    {
        "content": "<p>I'm not going to change the default behaviour but we'd sure support an -output-style paramter</p>",
        "id": 257249910,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634063310
    },
    {
        "content": "<p>Alright, will look into it. <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 257276949,
        "sender_full_name": "Eirik Myklebost",
        "timestamp": 1634075197
    },
    {
        "content": "<p>ok so I added a parameter -output-style and a possible value eslint-compact. And it's now much easier to add any kind of other output style because I refactored the code to make it easy</p>",
        "id": 258475018,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634781375
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"223185\">@Eirik Myklebost</span> should be in today's release</p>",
        "id": 258475033,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634781388
    }
]