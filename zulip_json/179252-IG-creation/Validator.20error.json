[
    {
        "content": "<p>I'm trying to run the validator (on my linux system) against the definitions from SANER locally but I'm getting this error:<br>\n   ..Detect format for /home/loftwyr/Downloads/CT24/saner/spec.internals<br>\n[Fatal Error] :1:1: Content is not allowed in prolog.<br>\n  .. validate [Epic-MR-REad-2.json]<br>\nValidation Infrastructure fail validating Epic-MR-REad-2.json: null<br>\nException in thread \"main\" java.lang.NullPointerException<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.checkReference(InstanceValidator.java:2216)<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.checkChild(InstanceValidator.java:4155)<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.validateElement(InstanceValidator.java:4012)<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.startInner(InstanceValidator.java:3472)<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.start(InstanceValidator.java:3396)<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.validateResource(InstanceValidator.java:4727)<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:709)<br>\n        at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:563)<br>\n        at org.hl7.fhir.validation.ValidationEngine.validate(ValidationEngine.java:1099)<br>\n        at org.hl7.fhir.validation.ValidationEngine.validate(ValidationEngine.java:1006)<br>\n        at org.hl7.fhir.validation.cli.services.ValidationService.validateSources(ValidationService.java:53)<br>\n        at org.hl7.fhir.validation.Validator.main(Validator.java:202)</p>\n<p>Any ideas what I'm doing wrong? The error persists after I remove the BOM</p>",
        "id": 197566780,
        "sender_full_name": "David Pyke",
        "timestamp": 1589468128
    },
    {
        "content": "<p>java -jar ./org.hl7.fhir.validator.jar -ig /home/loftwyr/Downloads/CT24/saner/ -version 4.0.1 $1</p>",
        "id": 197585521,
        "sender_full_name": "David Pyke",
        "timestamp": 1589475551
    },
    {
        "content": "<p>FHIR Validation tool Version 4.2.30-SNAPSHOT (Git# fd09f8be936b). Built 2020-05-12T11:40:09.571+10:00 (60 hours old)</p>",
        "id": 197586168,
        "sender_full_name": "David Pyke",
        "timestamp": 1589475795
    },
    {
        "content": "<p>Linux www 5.4.0-29-generic #33-Ubuntu SMP Wed Apr 29 14:32:27 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</p>",
        "id": 197586220,
        "sender_full_name": "David Pyke",
        "timestamp": 1589475814
    },
    {
        "content": "<p>openjdk version \"11.0.7\" 2020-04-14<br>\nOpenJDK Runtime Environment (build 11.0.7+10-post-Ubuntu-3ubuntu1)<br>\nOpenJDK 64-Bit Server VM (build 11.0.7+10-post-Ubuntu-3ubuntu1, mixed mode, sharing)</p>",
        "id": 197586280,
        "sender_full_name": "David Pyke",
        "timestamp": 1589475837
    },
    {
        "content": "<p>strangely, I get the same error on my windows VM.  What version of java should I be running?</p>",
        "id": 197590479,
        "sender_full_name": "David Pyke",
        "timestamp": 1589477609
    },
    {
        "content": "<p>It's having trouble resolving one of your target profiles.  I'll add some code to catch and raise a better error.  Dunno when Grahame will have a chance to release though</p>",
        "id": 197594225,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1589479320
    },
    {
        "content": "<p>Okay, I'll do without it for now</p>",
        "id": 197595002,
        "sender_full_name": "David Pyke",
        "timestamp": 1589479632
    },
    {
        "content": "<blockquote>\n<p>against the definitions from SANER locally</p>\n</blockquote>\n<p>What did you do? which definitions?</p>",
        "id": 197595303,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589479766
    },
    {
        "content": "<p>but looking at the stack, there's no reason to think that the error has anything to do with your definitions. Instead, it's something in your instance. <span class=\"user-mention\" data-user-id=\"192587\">@David Pyke</span> please run again with the latest validator so I know what line it is</p>",
        "id": 197595566,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589479885
    },
    {
        "content": "<p>I downloaded the definitions.json.zip and extracted it in a directory.  I thought I was using the latest.</p>",
        "id": 197595807,
        "sender_full_name": "David Pyke",
        "timestamp": 1589479998
    },
    {
        "content": "<p>Is 4.2.30 not the latest version?</p>",
        "id": 197596034,
        "sender_full_name": "David Pyke",
        "timestamp": 1589480114
    },
    {
        "content": "<p>that's the stack from 4.2.30? ouch</p>",
        "id": 197596273,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589480224
    },
    {
        "content": "<blockquote>\n<p>I downloaded the definitions.json.zip and extracted it in a directory</p>\n</blockquote>\n<p>Just use the package hl7.fhir.us.saner#current. But that isn't the issue here</p>",
        "id": 197596445,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589480299
    },
    {
        "content": "<p>The code was looking for a structure definition and the presuming it was found - pull request to check to see if it's null</p>",
        "id": 197596791,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1589480441
    },
    {
        "content": "<p>Using the package version fails because it can't find a Measure profile.  Reese Adamson said that it worked with a local copy of the definitions, so I've been trying with that.</p>",
        "id": 197596794,
        "sender_full_name": "David Pyke",
        "timestamp": 1589480442
    },
    {
        "content": "<p>I don't understand any of this, can you send me the instance?</p>",
        "id": 197597281,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589480643
    },
    {
        "content": "<p>I downloaded the definitions.json.zip from here: <a href=\"http://build.fhir.org/ig/HL7/fhir-saner/definitions.json.zip\">http://build.fhir.org/ig/HL7/fhir-saner/definitions.json.zip</a> and am validating this file with them <a href=\"/user_uploads/10155/xt6gqzXiCYuBWA-bZrxwBV6S/Epic-MR-REad-2.json\">Epic-MR-REad-2.json</a></p>",
        "id": 197598534,
        "sender_full_name": "David Pyke",
        "timestamp": 1589481160
    },
    {
        "content": "<p>for completeness, if I try to run the validator with -ig hl7.fhir.us.saner#current I get:<br>\nWarning @ MeasureReport (line 9, col87) : The Measure \"<a href=\"http://hl7.org/fhir/us/saner/StructureDefinition/PublicHealthMeasure\">http://hl7.org/fhir/us/saner/StructureDefinition/PublicHealthMeasure</a>\" could not be resolved, so no validation can be performed against the Measure<br>\nYet the meansure exists.</p>",
        "id": 197600377,
        "sender_full_name": "David Pyke",
        "timestamp": 1589481951
    },
    {
        "content": "<p>well, you should read the error, because the error is perfectly correct</p>",
        "id": 197601501,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589482388
    },
    {
        "content": "<p>there us no <em>Measure</em> \"<a href=\"http://hl7.org/fhir/us/saner/StructureDefinition/PublicHealthMeasure\">http://hl7.org/fhir/us/saner/StructureDefinition/PublicHealthMeasure</a>\" because that's a <em>Profile</em></p>",
        "id": 197601572,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589482428
    },
    {
        "content": "<p>Of course.  Thank you.  I\"ve stared at that 50 times and didn't think of that.</p>",
        "id": 197601684,
        "sender_full_name": "David Pyke",
        "timestamp": 1589482464
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> the problem with the NPE - downloading the definitions.json.zip and loading the profiles means that dependencies are not resolved. And this refers to US core IG which is not loaded. I'm not sure how the validator should handle this case, really</p>",
        "id": 197602794,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589482936
    },
    {
        "content": "<p>I guess I'll settle for adding this in the output:</p>\n<p>Error @ MeasureReport.subject (line 13, col24) : Unable to resolve the profile reference \"<a href=\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-location\">http://hl7.org/fhir/us/core/StructureDefinition/us-core-location</a>\"</p>",
        "id": 197603112,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589483107
    },
    {
        "content": "<p>it's not strictly a problem in the instance,so the location is not directly correct, but I don't really have a better location to report</p>",
        "id": 197603153,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589483136
    }
]