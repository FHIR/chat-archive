[
    {
        "content": "<p>I have re-built an IG, just to keep up-to-date, but now I am getting errors on example Bundles having content that is not matching profiles. This was working before, i think it is still right, but not now.<br>\nDid something changed in the rules the IG build is enforcing regarding Bundles? Profiles?</p>",
        "id": 264860060,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639490062
    },
    {
        "content": "<p>seems \"ref-1\" is being enforced differently now than before?</p>",
        "id": 264882498,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639498754
    },
    {
        "content": "<p>no change</p>",
        "id": 264908194,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639508290
    },
    {
        "content": "<p>I have not changed my IG source. The sushi output, with new sushi, is logically identical to before. But now the IG publisher throws \"ref-1\" errors. The only thing I change is to get the new publisher. I get a couple of errors with the following pattern.</p>\n<div class=\"codehilite\"><pre><span></span><code>Bundle.entry[0] (l17/c6)    error   This element does not match any known slice defined in the profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.ProvideBundle and slicing is CLOSED: Bundle.entry[0]: Does not match slice &#39;SubmissionSet&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.SubmissionSet, Bundle.entry[0]: Does not match slice &#39;DocumentRefs&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.DocumentReference, Bundle.entry[0]: Does not match slice &#39;Documents&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://hl7.org/fhir/StructureDefinition/Binary, Bundle.entry[0]: Does not match slice &#39;Folders&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.Folder, Bundle.entry[0]: Does not match slice &#39;Patient&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://hl7.org/fhir/StructureDefinition/Patient\nBundle (l1/c2)  error   Bundle.entry:SubmissionSet: minimum required = 1, but only found 0 (from http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.ProvideBundle)\nBundle.entry[0].resource.extension[1].value.ofType(Reference) (l57/c14) error   ref-1: &#39;SHALL have a contained resource if a local reference is provided&#39; &#39;SHALL have a contained resource if a local reference is provided&#39; ( (url: in-practitioner2; ids: ))\n</code></pre></div>",
        "id": 264935019,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639520438
    },
    {
        "content": "<p>I am fine with being told that XYZ is now more strict, and that I had been taking advantage of liberal previous version of the IG builder..</p>",
        "id": 264935069,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639520470
    },
    {
        "content": "<p>But, when I inspect the structure definitions and the examples, they look good to me.</p>",
        "id": 264935099,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639520488
    },
    {
        "content": "<p>hm, my testBundle project does not have the problem... that one assembles similar bundles, but does not have any profiling.</p>",
        "id": 264936294,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639521168
    },
    {
        "content": "<p>the project that is failing is a profiled bundle using #profile slicing discriminator</p>",
        "id": 264936594,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639521329
    },
    {
        "content": "<p>nope. not an issue with #profile slicing. just migrated that to testBundle without failure</p>",
        "id": 264937791,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639522049
    },
    {
        "content": "<p>I can't figure out why it built perfectly a month ago, but now fails on bundles with the ref-1 error<br>\n<a href=\"https://github.com/IHE/ITI.MHD\">https://github.com/IHE/ITI.MHD</a></p>",
        "id": 264942481,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639523784
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> (I hope the fish were large and challenging) - I too was FSHing. I have isolated the bug. I have created a testBundle IG that isolates the problem.<br>\n<a href=\"https://github.com/JohnMoehrke/testBundle\">https://github.com/JohnMoehrke/testBundle</a><br>\ncI-Build <br>\n<a href=\"http://build.fhir.org/ig/JohnMoehrke/testBundle/branches/main/index.html\">http://build.fhir.org/ig/JohnMoehrke/testBundle/branches/main/index.html</a></p>",
        "id": 265050539,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639591664
    },
    {
        "content": "<p>The errors are thrown when... I have a Bundle that is profiled, that bundle profile is by #profile, and a resource in the bundle has a contained resource.<br>\nSee fshFood.fsh. comment out like 91 and 92 (the contained Practitioner); and no error will be thrown.</p>",
        "id": 265050910,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639591806
    },
    {
        "content": "<p>note, it does not help for the profile of that resource to mandate contained resource. (line 80)</p>",
        "id": 265051609,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639592093
    },
    {
        "content": "<p><a href=\"https://github.com/HL7/fhir-ig-publisher/issues/357\">https://github.com/HL7/fhir-ig-publisher/issues/357</a></p>",
        "id": 265166769,
        "sender_full_name": "John Moehrke",
        "timestamp": 1639666400
    },
    {
        "content": "<p>fixed next release</p>",
        "id": 265250369,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639712231
    },
    {
        "content": "<p>latest publisher does seem to work for this issue.</p>",
        "id": 265914780,
        "sender_full_name": "John Moehrke",
        "timestamp": 1640264926
    }
]