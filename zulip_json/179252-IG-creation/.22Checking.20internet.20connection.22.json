[
    {
        "content": "<p>Have there been any changes lately that would affect pinging <a href=\"http://fx.fhir.org\">fx.fhir.org</a> at the start of <a href=\"http://_updatePublisher.sh\">_updatePublisher.sh</a>? The script seems to be waiting the full 1000 seconds before failing.</p>\n<p>This is being invoked from a github action which uses the latest hl7fhir/ig-publisher-base image.<br>\n(<span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> )</p>",
        "id": 217227758,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605758729
    },
    {
        "content": "<p>Northing I'm aware of. can you confirm that the terminology server was up and running at the time?</p>",
        "id": 217273800,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1605795059
    },
    {
        "content": "<p>It was. Builds on my local machine and regular auto builds were both working.</p>\n<p>I’ll give it another try shortly to see if it’s better now.</p>",
        "id": 217285800,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605800125
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191380\">Elliot Silver</span> <a href=\"#narrow/stream/179252-IG-creation/topic/.22Checking.20internet.20connection.22/near/217285800\">said</a>:</p>\n<blockquote>\n<p>l give it another try shortly to see if it’s better now.</p>\n</blockquote>\n<p>Nope, no change. It feels like a problem with what networks the image is allowed to see, or something similar. I did recently upgrade to sushi 1.0 (and restructured my project), but I doubt that is related since this is happening when trying to do <a href=\"http://_updatePublisher.sh\">_updatePublisher.sh</a>.</p>",
        "id": 217296677,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605804231
    },
    {
        "content": "<p>It is definitely an issue with ping hanging. I've tried updating the action so that ping is invoked before updatePublisher, and it is definitely hanging on the ping, not the updatePublisher script. One theory I had was that the network isn't up yet when ping is called, but adding a sleep before the ping doesn't seem to affect things. Another theory is that somehow ping is privileged (uses linux capabilities?), and I'm running it from a non-privileged account, but my experiments to prove that out don't seem to be going anywhere. Not sure where to look next.</p>",
        "id": 217335949,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605822922
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> want to try this line instead of ping?<br>\n<code>   linux-gnu* ) wget -q --spider http://tx.fhir.org/snomed/doco ;; </code></p>",
        "id": 217340268,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1605825250
    },
    {
        "content": "<p>(line 35 of <a href=\"http://_updatePublisher.sh\">_updatePublisher.sh</a>)</p>",
        "id": 217340318,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1605825287
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> ,  that does it.</p>",
        "id": 217341580,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605826148
    },
    {
        "content": "<p>Any idea why wget works, but ping doesn't? (I still suspect a change in the github action environment, or in the ig-publisher image related to capabilities.)</p>",
        "id": 217342376,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605826687
    },
    {
        "content": "<p><code>ping</code> uses the ICMP protocol, while <code>wget</code> uses TCP.   It's possible that somewhere along the network between the two machines ICMP had been blocked by a piece of network equipment, or by the destination host itself.</p>",
        "id": 217441542,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1605897472
    },
    {
        "content": "<p>That was my expectation. I was stumped trying to figure out where that block was though.</p>",
        "id": 217442384,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605897925
    },
    {
        "content": "<p>I use a tool called <code>mtr</code>, which allows you to see all the hops along the network, updating them every second.  You can specify using TCP, ICMP, or UDP for connections, too.<br>\n<a href=\"https://en.wikipedia.org/wiki/MTR_(software)\">https://en.wikipedia.org/wiki/MTR_(software)</a></p>\n<p>If there's a hop on a path blocking ICMP, you can usually spot it when comparing with the TCP path.</p>",
        "id": 217443807,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1605898633
    },
    {
        "content": "<p>I suppose it could also be dropped packets, if the network was having issues.  If ping gives up after 4 tries, or reports failure if any of the pings fail - that might also cause ping to fail while wget works.</p>",
        "id": 217444239,
        "sender_full_name": "Carl Anderson",
        "timestamp": 1605898828
    }
]