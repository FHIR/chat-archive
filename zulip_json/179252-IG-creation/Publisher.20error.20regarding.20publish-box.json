[
    {
        "content": "<p>IG repo: <a href=\"https://github.com/cqframework/opioid-cds-r4/tree/master\" target=\"_blank\" title=\"https://github.com/cqframework/opioid-cds-r4/tree/master\">https://github.com/cqframework/opioid-cds-r4/tree/master</a></p>\n<p>Getting the following error:<br>\norg.hl7.fhir.exceptions.FHIRException: The auto-build infrastructure does not publish IGs that contain HTML pages without the publish-box present. For further information, see note at <a href=\"http://wiki.hl7.org/index.php?title=FHIR_Implementation_Guide_Publishing_Requirements#HL7_HTML_Standards_considerations\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=FHIR_Implementation_Guide_Publishing_Requirements#HL7_HTML_Standards_considerations\">http://wiki.hl7.org/index.php?title=FHIR_Implementation_Guide_Publishing_Requirements#HL7_HTML_Standards_considerations</a></p>\n<p>However, I  do have the publish-box declared as the link specifies in my templates. Is this an issue with the publisher? The IG was building just a couple of days ago.</p>",
        "id": 175368404,
        "sender_full_name": "Christopher Schuler",
        "timestamp": 1568142251
    },
    {
        "content": "<p>I’ll have to debug</p>",
        "id": 175369700,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568143104
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191897\">@Christopher Schuler</span> -- I see you put it in your <a href=\"https://github.com/cqframework/opioid-cds-r4/blob/master/pages/_includes/container-start.html#L6\" target=\"_blank\" title=\"https://github.com/cqframework/opioid-cds-r4/blob/master/pages/_includes/container-start.html#L6\">container-start.html</a> include file.  Does that get inserted into every single html page in the IG?  The publisher checks every one.  If so, then maybe the <code>&lt;li&gt;</code> tags you wrapped around it are causing the issue?  In my IGs, I have it on its own line w/ no other tags to the left or right.</p>",
        "id": 175370063,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1568143399
    },
    {
        "content": "<p>It does have to be byte for byte perfect, not just close. (The comparison isn’t based on some canonical HTML)</p>",
        "id": 175370317,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568143567
    },
    {
        "content": "<p>I can't run it - I'm on a plane and they've blocked github (!). Perhaps you could paste a fragment from your generated html files....</p>",
        "id": 175372715,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568145445
    },
    {
        "content": "<p>Yes if you have a layout that gets included in the layout.</p>",
        "id": 175374274,
        "sender_full_name": "Eric Haas",
        "timestamp": 1568146528
    },
    {
        "content": "<p>sounds like my framework</p>",
        "id": 175374286,
        "sender_full_name": "Eric Haas",
        "timestamp": 1568146541
    },
    {
        "content": "<p>there are 2 layouts :</p>\n<ul>\n<li>static pages</li>\n<li>fhir artifacts</li>\n</ul>",
        "id": 175374376,
        "sender_full_name": "Eric Haas",
        "timestamp": 1568146599
    },
    {
        "content": "<p>most of the includes in the frameworks directory are included in these layouts to create templates for all the pages.</p>",
        "id": 175374404,
        "sender_full_name": "Eric Haas",
        "timestamp": 1568146639
    },
    {
        "content": "<p>( I went overboard with includes)</p>",
        "id": 175374421,
        "sender_full_name": "Eric Haas",
        "timestamp": 1568146665
    },
    {
        "content": "<p>this error took down US Core - all our pages have publish box .  the error shuts down the build but does not say which page it is.  which is not helpful.</p>",
        "id": 175394163,
        "sender_full_name": "Eric Haas",
        "timestamp": 1568165602
    },
    {
        "content": "<p>found it</p>\n<div class=\"codehilite\"><pre><span></span>icon_fixed.gif  error   The html source does not contain the publish box &lt;!--ReleaseHeader--&gt;&lt;p id=&quot;publish-box&quot;&gt;Publish Box goes here&lt;/p&gt;&lt;!--EndReleaseHeader--&gt; (see note at http://wiki.hl7.org/index.php?title=FHIR_Implementation_Guide_Publishing_Requirements#HL7_HTML_Standards_considerations)\nicon_slice_item.png error   The html source does not contain the publish box\n</pre></div>\n\n\n<p>this seems to be a ig-pub error</p>",
        "id": 175395110,
        "sender_full_name": "Eric Haas",
        "timestamp": 1568167192
    },
    {
        "content": "<p>It's also affected at least one of the IGs MITRE produces as well (<a href=\"https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/branches/master/build.log\" target=\"_blank\" title=\"https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/branches/master/build.log\">davinci-pdex-plan-net</a>) -- although in our case we don't have any nice errors like Eric found that tell us the offending file.</p>",
        "id": 175423098,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1568202740
    },
    {
        "content": "<p>what error do you get then?</p>",
        "id": 175423391,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568202980
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> US core works for me.... not sure how you can get an error like htat</p>",
        "id": 175424182,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568203623
    },
    {
        "content": "<p>no interesting... I can recreate that problem</p>",
        "id": 175424722,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568204077
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- it just has this at the end:</p>\n<div class=\"codehilite\"><pre><span></span>Checking Output HTML                                                             (00:47.0913)\nfound 1561 files                                                                 (00:47.0919)\nPublishing Content Failed: The auto-build infrastructure does not publish IGs that contain HTML pages without the publish-box present. For further information, see note at http://wiki.hl7.org/index.php?title=FHIR_Implementation_Guide_Publishing_Requirements#HL7_HTML_Standards_considerations (00:54.0055)\n                                                                                 (00:54.0055)\nUse -? to get command line help                                                  (00:54.0055)\n                                                                                 (00:54.0055)\nStack Dump (for debugging):                                                      (00:54.0055)\norg.hl7.fhir.exceptions.FHIRException: The auto-build infrastructure does not publish IGs that contain HTML pages without the publish-box present. For further information, see note at http://wiki.hl7.org/index.php?title=FHIR_Implementation_Guide_Publishing_Requirements#HL7_HTML_Standards_considerations\n    at org.hl7.fhir.igtools.publisher.HTLMLInspector.check(HTLMLInspector.java:241)\n    at org.hl7.fhir.igtools.publisher.Publisher.generate(Publisher.java:3960)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:732)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:610)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6437)\n</pre></div>\n\n\n<p>No clue what file is violating it -- but I don't recall getting any QA errors about missing publish-box before this change to the IG publisher.</p>",
        "id": 175424774,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1568204147
    },
    {
        "content": "<p>and you don't get anything else building locally?</p>",
        "id": 175424856,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568204193
    },
    {
        "content": "<p>TBH, haven't tried building locally.  I'm just reporting this on behalf of someone else.  I don't actually work on that project.  But... I'll ask them to build locally and see if they get more data.</p>",
        "id": 175424977,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1568204296
    },
    {
        "content": "<p>they will. I'll release an update that fixes this stuff now</p>",
        "id": 175425164,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568204481
    },
    {
        "content": "<p>Is there a reason that the auto build doesn't log as much data as a local build then?  It seems it would be really helpful to have all that data in order to debug failed builds (like this).</p>",
        "id": 175432408,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1568209268
    },
    {
        "content": "<p>It was blowing up before the log messages got written to the file output. It isn't doing that anymore</p>",
        "id": 175433210,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1568209695
    },
    {
        "content": "<p>davinci-pdex-plan-net no longer failing...thx</p>",
        "id": 175445201,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1568216610
    },
    {
        "content": "<p>getting this from qa.html again.  not sure why is showing up.  just downloaded latest ig-pub and CI build is down as well...</p>\n<div class=\"codehilite\"><pre><span></span>icon_fixed.gif  error   The html source does not contain the publish box &lt;!--ReleaseHeader--&gt;&lt;p id=&quot;publish-box&quot;&gt;Publish Box goes here&lt;/p&gt;&lt;!--EndReleaseHeader--&gt; (see note at http://wiki.hl7.org/index.php?title=FHIR_Implementation_Guide_Publishing_Requirements#HL7_HTML_Standards_considerations)\nicon_slice_item.png error   The html source does not contain the publish box\n</pre></div>",
        "id": 176418956,
        "sender_full_name": "Eric Haas",
        "timestamp": 1569281425
    },
    {
        "content": "<p>Same error on our IGs as well...</p>",
        "id": 176419060,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1569281611
    },
    {
        "content": "<p>Our IGs won't even publish - they are failing.</p>",
        "id": 176419322,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1569281911
    },
    {
        "content": "<p>Sigh. That’s a transient error in the publication infrastructure. Should be gone now.</p>",
        "id": 176457731,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1569327642
    },
    {
        "content": "<p>definitely should be gone now</p>",
        "id": 176510178,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1569361951
    }
]