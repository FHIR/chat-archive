[
    {
        "content": "<p>After <span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span>  identified (resolved in a forthcoming release)  the issue experienced with Forge:<br>\n<a href=\"#narrow/stream/implementers/topic/Forge.20error.20when.20adding.20Must.20support.20.3D.20true.20to.20an.20extension\" title=\"#narrow/stream/implementers/topic/Forge.20error.20when.20adding.20Must.20support.20.3D.20true.20to.20an.20extension\">https://chat.fhir.org/#narrow/stream/implementers/topic/Forge.20error.20when.20adding.20Must.20support.20.3D.20true.20to.20an.20extension</a><br>\n<span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  - Iâ€™m seeking advice with troubleshooting an error encountered with the IG Publisher.  <br>\nWhile running IG Publisher (v3.2.0-13560, gen-code v3.2.0-13475) the following error is encountered:</p>\n<div class=\"codehilite\"><pre><span></span>process res: relatedperson-levelone                                              (25.0085sec)\nprocess res: patient-levelone                                                    (25.0351sec)\nException in thread &quot;main&quot; java.lang.Error: Not handled yet (sortElements: Patient.deceased[x]:boolean, dateTime)\n        at org.hl7.fhir.r4.conformance.ProfileUtilities.sortElements(ProfileUtilities.java:2982)\n        at org.hl7.fhir.r4.conformance.ProfileUtilities.sortDifferential(ProfileUtilities.java:2906)\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.seeMetadataResource(SimpleWorkerContext.java:508)\n        at org.hl7.fhir.r4.context.BaseWorkerContext.cacheResource(BaseWorkerContext.java:188)\n        at org.hl7.fhir.igtools.publisher.Publisher.load(Publisher.java:2110)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:1778)\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:426)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:390)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4314)\n</pre></div>\n\n\n<p>The file containing this code and the IG Publisher debug file are attached.<br>\nIf you need any further information, please let me know.  <br>\n<a href=\"/user_uploads/10155/MTvRae4B_baRlJm-sy6GvZ-a/patient-levelone.xml\" target=\"_blank\" title=\"patient-levelone.xml\">patient-levelone.xml</a> <a href=\"/user_uploads/10155/rOq2bdTABZG7wR-ny0ktSfBL/IG-Publisher-DeBug-20180412.txt\" target=\"_blank\" title=\"IG-Publisher-DeBug-20180412.txt\">IG-Publisher-DeBug-20180412.txt</a></p>",
        "id": 153952008,
        "sender_full_name": "David McKillop",
        "timestamp": 1523511241
    },
    {
        "content": "<p>I'll have to debug that. probably over the weekend.</p>",
        "id": 153952012,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1523511489
    },
    {
        "content": "<p>OK - thanks.</p>",
        "id": 153952014,
        "sender_full_name": "David McKillop",
        "timestamp": 1523511564
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  the following is probably related to the above issue:<br>\nWhen I run the IG Publisher (v3.4.0-13713, gen-code v3.4.0-13690) with the file <br>\n<a href=\"/user_uploads/10155/RzG17B_o04Ex4oJ4Jt2O0F9n/patient-dh-base.xml\" target=\"_blank\" title=\"patient-dh-base.xml\">patient-dh-base.xml</a> <br>\nthe IG publisher runs fine.<br>\nWhen I then delete the invariant \"inv-dh-pat-01\" on Patient<br>\n<a href=\"/user_uploads/10155/o_qHjq2JR5a_HuYCq31U4lSE/patient-dh-base.xml\" target=\"_blank\" title=\"patient-dh-base.xml\">patient-dh-base.xml</a><br>\n and run the IG Publisher, I get the following errors:</p>\n<div class=\"codehilite\"><pre><span></span>process type: StructureDefinition                                                (25.0451sec)\nprocess res: patient-dh-base                                                     (25.0451sec)\n-tx: Terminology server: Check for supported code systems for urn:ietf:bcp:47\nError in snapshot generation: Differential for http://ns.electronichealth.net.au/ci/fhir/StructureDefinition/patient-dh-base with id: Patient.deceased[x]:deceasedboolean has an element that is not marked with a snapshot match\nPublishing Content Failed: Exception loading http://ns.electronichealth.net.au/ci/fhir/StructureDefinition/patient-dh-base: Snapshot for http://ns.electronichealth.net.au/ci/fhir/StructureDefinition/patient-dh-base does not contain an element that matches an existing differential element that has id: Patient.deceased[x]:deceasedboolean (29.0428sec)\n                                                                                 (29.0428sec)\nUse -? to get command line help                                                  (29.0428sec)\n                                                                                 (29.0428sec)\nStack Dump (for debugging):                                                      (29.0428sec)\njava.lang.Exception: Exception loading http://ns.electronichealth.net.au/ci/fhir/StructureDefinition/patient-dh-base: Snapshot for http://ns.electronichealth.net.au/ci/fhir/StructureDefinition/patient-dh-base does not contain an element that matches an existing differential element that has id: Patient.deceased[x]:deceasedboolean\n        at org.hl7.fhir.igtools.publisher.Publisher.load(Publisher.java:2188)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:1854)\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:495)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:459)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4393)\nCaused by: org.hl7.fhir.exceptions.DefinitionException: Snapshot for http://ns.electronichealth.net.au/ci/fhir/StructureDefinition/patient-dh-base does not contain an element that matches an existing differential element that has id: Patient.deceased[x]:deceasedboolean\n        at org.hl7.fhir.r4.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:394)\n        at org.hl7.fhir.r4.context.SimpleWorkerContext.seeMetadataResource(SimpleWorkerContext.java:513)\n        at org.hl7.fhir.r4.context.BaseWorkerContext.cacheResource(BaseWorkerContext.java:188)\n        at org.hl7.fhir.igtools.publisher.Publisher.load(Publisher.java:2186)\n        ... 4 more\nException in thread &quot;main&quot; java.lang.NullPointerException\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4403)\n</pre></div>\n\n\n<p>which seems odd as nothing relating to Patient.deceased[x]:deceasedboolean  was changed.<br>\nThe IG Publisher debug file is:<br>\n<a href=\"/user_uploads/10155/Bcd-D0DQTsmz61iFmgIBaOfG/IG-Publisher-DeBug-20180501.txt\" target=\"_blank\" title=\"IG-Publisher-DeBug-20180501.txt\">IG-Publisher-DeBug-20180501.txt</a> <br>\nIf you need any further info just let me know.  <br>\nThanks for your help.</p>",
        "id": 153955147,
        "sender_full_name": "David McKillop",
        "timestamp": 1525139175
    },
    {
        "content": "<p>so what iG is this for?</p>",
        "id": 153974176,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1530909555
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  - this is actually used in for the Agency profiles \"Patient Base\" which is derived from \"au-patient\" (<a href=\"http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-patient.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-patient.html\">http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-patient.html</a>) with further constraints. <br>\nThis profile and other profiles derived from au-patient including the Agency \"patient-ident\" which is \"Patient Base\" with a mandatory identifier and \"patient-ihi\" which is \"Patient Base\" with mandatory identifier and IHI\" are then used in IG's depending on the requirements for the IG.<br>\nLet me know if you need more info.</p>",
        "id": 153974262,
        "sender_full_name": "David McKillop",
        "timestamp": 1531097076
    },
    {
        "content": "<p>yes how do I reproduce this?</p>",
        "id": 153974273,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1531119801
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  - I've sent you an email with the files and the problem in the element id path.  Let me know if you need anything else.</p>",
        "id": 153974289,
        "sender_full_name": "David McKillop",
        "timestamp": 1531124721
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  FYI - The problem has been resolved as we are now able to remove the additional \"deceased[x].\" from the path &lt;element id=\"Patient.deceased[x].deceased[x]:deceasedBoolean\"&gt;, plus we are now able to mark the element with \"Must Support\".</p>\n<p>Please close this ticket : <a href=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17165\" target=\"_blank\" title=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17165\">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17165</a></p>",
        "id": 154023952,
        "sender_full_name": "David McKillop",
        "timestamp": 1544414610
    }
]