[
    {
        "content": "<p>In LIVD we have an invariant on ConceptMap.group.element.target.dependsOn, but when the invariant id is added for the element the IG build complains, even though the invariant is there and should be findable:</p>\n<div class=\"codehilite\"><pre><span></span>     [java] Initialization complete                                                          (16.0103sec)\n     [java] Load Content                                                                     (16.0103sec)\n     [java] java.lang.Exception: exception parsing pack /Users/rhausam/git-repo/livd/src/resources/conceptmap-uv-livd-spreadsheet: unable to find Invariant &#39;4&#39; /Users/rhausam/git-repo/livd/src/resources/conceptmap-uv-livd-spreadsheet, sheet &quot;conceptmap-uv-livd&quot;, row 33\n     [java]     at org.hl7.fhir.igtools.spreadsheets.IgSpreadsheetParser.parse(IgSpreadsheetParser.java:208)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.loadSpreadsheet(Publisher.java:1905)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.loadSpreadsheets(Publisher.java:1890)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.load(Publisher.java:1601)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:513)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:479)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4622)\n     [java] Caused by: java.lang.Exception: unable to find Invariant &#39;4&#39; /Users/rhausam/git-repo/livd/src/resources/conceptmap-uv-livd-spreadsheet, sheet &quot;conceptmap-uv-livd&quot;, row 33\n     [java] Missing IsModifierReason on ConceptMap.group.element.target.equivalence\n     [java]     at org.hl7.fhir.igtools.spreadsheets.IgSpreadsheetParser.processLine(IgSpreadsheetParser.java:764)\n     [java]     at org.hl7.fhir.igtools.spreadsheets.IgSpreadsheetParser.parseProfileSheet(IgSpreadsheetParser.java:275)\n     [java]     at org.hl7.fhir.igtools.spreadsheets.IgSpreadsheetParser.parse(IgSpreadsheetParser.java:182)\n     [java]     ... 6 more\n     [java] Exception in thread &quot;main&quot; java.lang.NullPointerException\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4632)\n     [java] Publishing Content Failed: exception parsing pack /Users/rhausam/git-repo/livd/src/resources/conceptmap-uv-livd-spreadsheet: unable to find Invariant &#39;4&#39; /Users/rhausam/git-repo/livd/src/resources/conceptmap-uv-livd-spreadsheet, sheet &quot;conceptmap-uv-livd&quot;, row 33 (16.0638sec)\n     [java]                                                                                  (16.0639sec)\n     [java] Use -? to get command line help                                                  (16.0639sec)\n     [java]                                                                                  (16.0639sec)\n     [java] Stack Dump (for debugging):                                                      (16.0639sec)\n\nBUILD FAILED\n/Users/rhausam/git-repo/livd/framework/build.xml:78: Java returned: 1\n</pre></div>\n\n\n<p>This is committed in the livd2 branch at <a href=\"https://github.com/HL7/livd/tree/livd2\" target=\"_blank\" title=\"https://github.com/HL7/livd/tree/livd2\">https://github.com/HL7/livd/tree/livd2</a>.  Has anyone else encountered this?</p>",
        "id": 153987754,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1534449019
    },
    {
        "content": "<p>I assume this is likely a bug?  Will I need to remove the invariant id from the element for now and add a note that it is <strong>supposed</strong> to be there and will be corrected in the future?  Or can it be fixed or is there something to correct on my end?</p>",
        "id": 153987788,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1534451757
    },
    {
        "content": "<p>it's on my list for next</p>",
        "id": 153987791,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534451800
    },
    {
        "content": "<p>Well, I think I can take it off your list.  The answer seems to be that when you add the '-Inv' to the tab name for the invariants for that structure you <strong>must</strong> use a capital 'I'.  I obviously should have tried that a bit sooner. :(</p>",
        "id": 153987862,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1534457707
    },
    {
        "content": "<p>ok</p>",
        "id": 153987866,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1534457925
    },
    {
        "content": "<p>running into the same issue (i guess). My invariant tab is named: Invariants-Inv (also tried foo-INV, Invariant, Invariants).<br>\nThese Invariants aren't found while parsing the spreadsheet causing a similar error.</p>",
        "id": 177631506,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1570551031
    },
    {
        "content": "<p>How is the Invariant Tab discriminated by the Publisher? The Tab with a -Inv ending? couldn't find the naming conventions :-(</p>",
        "id": 177631602,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1570551096
    },
    {
        "content": "<p>It should have the same name as the profile.  E.g. MyPatient-INV for invariants related to the MyPatient profile.  (Every profile needs its own Invariant tab)</p>",
        "id": 177632661,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1570551723
    },
    {
        "content": "<p>done. Now it seems to be linked, but i get the exception: </p>\n<blockquote>\n<p>java.lang.Exception: exception parsing pack Observations: Profile finding Invariant null (As HGNC contains overlapping  gene and gene-family IDs  please use a more specific CodeSystem Uri.) has no XPath statement    </p>\n</blockquote>\n<p>I thought filling out the expression tab with FHIRpath should be sufficient?</p>",
        "id": 177698934,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1570615445
    },
    {
        "content": "<p>Still need XPath for R4.  I think it goes away in R5</p>",
        "id": 177721193,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1570632677
    },
    {
        "content": "<p><span aria-label=\"pensive\" class=\"emoji emoji-1f614\" role=\"img\" title=\"pensive\">:pensive:</span></p>",
        "id": 177731615,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1570638871
    },
    {
        "content": "<blockquote>\n<p>Still need XPath for R4.  I think it goes away in R5</p>\n</blockquote>\n<p>wait what? I just checked some profiles. For example german base profiles are using expression without XPath</p>",
        "id": 177732039,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1570639151
    },
    {
        "content": "<p>Also elementDefinition has no constrain on constrain <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span> to enforce Xpath.</p>",
        "id": 177732064,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1570639175
    },
    {
        "content": "<p>It may be a 'feature' of the spreadsheet extraction mechanism :(  Not something I can dig into in the next couple of weeks unfortunately.</p>",
        "id": 177747748,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1570649502
    },
    {
        "content": "<p>yes that's a policy constraint for HL7 IGs - you need to provide an XPath expression as well (even though they are not universally required).</p>",
        "id": 177784856,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1570691482
    },
    {
        "content": "<p>thanks for the explanations</p>",
        "id": 177794589,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1570701111
    }
]