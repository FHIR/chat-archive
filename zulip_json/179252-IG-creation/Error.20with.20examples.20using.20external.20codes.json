[
    {
        "content": "<p>I'm getting a number of errors of the following form:</p>\n<div class=\"codehilite\"><pre><span></span><code>None of the codes provided are in the value set http://hl7.org/fhir/us/davinci-pas/ValueSet/X12278RequestedServiceType (http://hl7.org/fhir/us/davinci-pas/ValueSet/X12278RequestedServiceType), and a code from this value set is required) (codes = http://codesystem.x12.org/005010/1525#HS\n</code></pre></div>\n<p>I've defined value sets with multiple codes from multiple code systems and one of those is an X12 code system that the validator can't access.  Unfortunately with these errors, I can't suppress them.  I have that exact message in my ignoreWarnings file but it still appears.</p>\n<p><a href=\"http://build.fhir.org/ig/HL7/davinci-pas/branches/master/qa.html\">http://build.fhir.org/ig/HL7/davinci-pas/branches/master/qa.html</a> if you want to see the results.</p>",
        "id": 217063011,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605647350
    },
    {
        "content": "<p>Have you tried copying the whole message from <a href=\"http://build.fhir.org/ig/HL7/davinci-pas/branches/master/qa.txt\">http://build.fhir.org/ig/HL7/davinci-pas/branches/master/qa.txt</a> (you might have, I didn't check, but I was having issues until I used that file).</p>",
        "id": 217064065,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1605647838
    },
    {
        "content": "<p>i'll try that.  i've had success with just copying from the qa.html</p>",
        "id": 217064796,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605648130
    },
    {
        "content": "<p>I seem to have varying success with just the shorter message from the html, but it seems to consistently work if I copy the whole line including WARNING, etc. from the text file. It does mean you need more lines in your suppression file though because they are profile/instance specific.</p>",
        "id": 217065098,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1605648255
    },
    {
        "content": "<p>you copied the entire line including ERROR and the list where it is found?  I haven't done that with any of my other error/warning/info messages.</p>",
        "id": 217065211,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605648326
    },
    {
        "content": "<p>yeah, that didn't fix it :)</p>",
        "id": 217065417,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605648455
    },
    {
        "content": "<p>Errors (except for possibly link issues) aren't suppressible</p>",
        "id": 217065613,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1605648556
    },
    {
        "content": "<p>duouh!  I think I even knew that.</p>",
        "id": 217066395,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605648956
    },
    {
        "content": "<p>Which is weird - usually those external value set issues are warnings, not errors.</p>",
        "id": 217066410,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1605648962
    },
    {
        "content": "<p>so never mind the \"can't suppress\" these part of my stream.  this seems like a mistake in the publisher validation routine since it can't determine what's in the value set, so it can't really validate the code that I give it.</p>",
        "id": 217066496,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605649001
    },
    {
        "content": "<p>Right.  I think it's a publisher issue.  This problem <em>shouldn't</em> be an error</p>",
        "id": 217067407,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1605649545
    },
    {
        "content": "<p>well, here's a case in point:</p>",
        "id": 217117612,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605695452
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>            <span class=\"nt\">&lt;valueCodeableConcept&gt;</span>\n              <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://codesystem.x12.org/005010/1525\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"HS\"</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Health Services Review\"</span><span class=\"nt\">/&gt;</span>\n              <span class=\"nt\">&lt;/coding&gt;</span>\n            <span class=\"nt\">&lt;/valueCodeableConcept&gt;</span>\n</code></pre></div>",
        "id": 217117660,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605695485
    },
    {
        "content": "<p>the value set in question says:</p>",
        "id": 217117678,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605695497
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code><span class=\"nt\">&lt;compose&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://codesystem.x12.org/005010/1365\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://www.ama-assn.org/go/cpt\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://www.cms.gov/Medicare/Coding/HCPCSReleaseCodeSets\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://terminology.hl7.org/CodeSystem/icd9cm\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://www.cms.gov/Medicare/Coding/ICD10\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n</code></pre></div>",
        "id": 217117700,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605695513
    },
    {
        "content": "<p>so the error sure looks correct to me</p>",
        "id": 217117710,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605695521
    },
    {
        "content": "<p>if you point me at a place where the validator is wrong, I'll be happy to look into it</p>",
        "id": 217118053,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605695699
    },
    {
        "content": "<p>oops, most of those errors were my fault.  I think i've got it down to an actual error.  Same value set:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code><span class=\"nt\">&lt;compose&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://codesystem.x12.org/005010/1365\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://www.ama-assn.org/go/cpt\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://www.cms.gov/Medicare/Coding/HCPCSReleaseCodeSets\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://terminology.hl7.org/CodeSystem/icd9cm\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n    <span class=\"nt\">&lt;include&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://www.cms.gov/Medicare/Coding/ICD10\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/include&gt;</span>\n</code></pre></div>\n<p>And here is my element:</p>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>  <span class=\"nt\">&lt;code&gt;</span>\n    <span class=\"nt\">&lt;coding&gt;</span>\n      <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">\"http://codesystem.x12.org/005010/1365\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">\"3\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">\"Consultation\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/coding&gt;</span>\n  <span class=\"nt\">&lt;/code&gt;</span>\n</code></pre></div>\n<p>ServiceRequest - Referral Request Example<br>\nClaim-Referral Authorization Example</p>\n<p>are the two example instances that have the error.</p>",
        "id": 217180922,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605726077
    },
    {
        "content": "<p>Hmm, that's weird.  While I get errors in my local build, the CI build has no errors other than a JIRA-Spec-Artifacts error that I don't get on my local build.</p>",
        "id": 217182422,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605726727
    },
    {
        "content": "<p>clear your tx-cache?</p>",
        "id": 217208540,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605740383
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Error.20with.20examples.20using.20external.20codes/near/217065613\">said</a>:</p>\n<blockquote>\n<p>Errors (except for possibly link issues) aren't suppressible</p>\n</blockquote>\n<p>The CG IG has several tx related errors due to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> (probably the codes in question are newer than the loinc version on <a href=\"http://tx.fhir.org\">tx.fhir.org</a>)?</p>",
        "id": 218441910,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1606838561
    },
    {
        "content": "<p>As errors arent' filterable, how should we deal with them?</p>",
        "id": 218441996,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1606838593
    },
    {
        "content": "<p>If i try the validation of these LOINC manually (Postman) it seems to work:<br>\n<code>http://tx.fhir.org/r4/CodeSystem/$lookup?system=http://loinc.org&amp;code=92822-6</code>works but throws errors during IG build: </p>\n<div class=\"codehilite\"><pre><span></span><code>The code &quot;92822-6&quot; is not valid in the system http://loinc.org; The code provided (http://loinc.org#92822-6) is not valid in the value set &#39;All codes known to the system&#39; (from http://tx.fhir.org/r4) for &#39;http://loinc.org#92822-6&#39;\n</code></pre></div>",
        "id": 218443851,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1606839206
    },
    {
        "content": "<p>I agree that the $lookup is working correctly on the server.  Is this possibly a cache issue?</p>",
        "id": 218446137,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1606840129
    },
    {
        "content": "<p>hmm the error is reported by the CI build which should reset the tx cache every build?</p>",
        "id": 218446808,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1606840399
    },
    {
        "content": "<p>Actually, I don't think the CI build automatically resets the cache.  If a file for the code system is checked in for txcache I believe it will use it.  This also returns 'true': <code>http://tx.fhir.org/r4/ValueSet/$validate-code?url=http://loinc.org/vs&amp;system=http://loinc.org&amp;code=92822-6</code></p>",
        "id": 218447394,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1606840633
    },
    {
        "content": "<p>Grahame manually purges the cache before official publication, but the CI build generally uses the cache - for performance reasons and to keep the load on <a href=\"http://tx.fhir.org\">tx.fhir.org</a> reasonable.</p>",
        "id": 218448866,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1606841178
    },
    {
        "content": "<p>Yes.</p>",
        "id": 218449174,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1606841289
    },
    {
        "content": "<p>so is the autobuild build using a cache each time? is there a way to clear it prior to the next build?</p>",
        "id": 218451831,
        "sender_full_name": "Eric Haas",
        "timestamp": 1606842388
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191405\">Rob Hausam</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Error.20with.20examples.20using.20external.20codes/near/218447394\">said</a>:</p>\n<blockquote>\n<p>Actually, I don't think the CI build automatically resets the cache.  If a file for the code system is checked in for txcache I believe it will use it.  This also returns 'true': <code>http://tx.fhir.org/r4/ValueSet/$validate-code?url=http://loinc.org/vs&amp;system=http://loinc.org&amp;code=92822-6</code></p>\n</blockquote>\n<p>oh! Thanks for the info. Will try to reset the cache locally.</p>",
        "id": 218454495,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1606843583
    },
    {
        "content": "<p>I am considering asking everyone to remove txcache from git. the teminology system is more robust than it used to be, and the cache is starting to be a negative value. I have some internal metric goals to meet before doing this</p>",
        "id": 218478219,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606855171
    },
    {
        "content": "<p>Ah, so there isn't a reused server-side cache, but the tx cache folder is also used by the CI build?</p>",
        "id": 218534408,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1606902507
    }
]