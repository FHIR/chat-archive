[
    {
        "content": "<p>I have a feature request from the CDA publishing team that has bubbled to the top of my list.</p>\n<p>The request is to able to publish examples for logical models. Internally, these will be Binary resources, but they'll be published as examples rather than plain binary resources. </p>\n<p>From an editors point of view, it will work like this:</p>\n<ul>\n<li>Include the file as a binary resource, like any other resource </li>\n<li>the resource format will be anything at all; it will be converted to a binary resource as is is loaded</li>\n<li>if the binary is labelled as an example of a logical model, it will be parsed and validated against the logical model like other kinds of resources are, and treated as an example for the logical model</li>\n</ul>\n<p>Comments welcome on this basic approach</p>",
        "id": 251192344,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630308042
    },
    {
        "content": "<p>(this does imply that the logical model is marked up with the details it needs to parse the example correctly. CDA logical models are</p>",
        "id": 251192400,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630308083
    },
    {
        "content": "<p>i like the approach! The editors need to convert the CDA (or other logical model) to base64 for embedding it in the Binary, correct? Or would it be a possibility that the tooling (IGPublisher) also creates the base64 in the Binary maybe via a tooling extension?</p>",
        "id": 251193605,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1630308891
    },
    {
        "content": "<p>no need for base64; the IG publisher would publish that, of course, but you'd just have and see native XML for the CDA content</p>",
        "id": 251194242,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630309354
    },
    {
        "content": "<p>I welcome this. The elements in the LM: can we specify data types and will those be validated?</p>",
        "id": 251205795,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1630316694
    },
    {
        "content": "<p>e.g. if my LM says \"this is a date\" and the example contains a string \"30 Augustus 2021\", will this be validated?</p>",
        "id": 251205876,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1630316734
    },
    {
        "content": "<p>no. only two date formats are supported right now - xml and the HL7 yyyymmddhhmmss.sssZ</p>",
        "id": 251210445,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630319777
    },
    {
        "content": "<p>though you can propose others - there's an extension to say what it is if it's something else</p>",
        "id": 251210459,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630319792
    },
    {
        "content": "<p>I didn't want to propose a new date type. I wanted to ask whether the LM instance will be validated against whatever data types we use (so the date I mention should fail because it is not a valid FHIR date)</p>",
        "id": 251211232,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1630320356
    },
    {
        "content": "<p>I should have asked \"will this be validated and therefore fail?\"</p>",
        "id": 251211290,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1630320383
    },
    {
        "content": "<p>yes it will be validated against the logical model</p>",
        "id": 251214249,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630322334
    },
    {
        "content": "<p>Thanks. Looking forward to this enhancement</p>",
        "id": 251217406,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1630324260
    },
    {
        "content": "<p>Is the whole \"wrap it in a binary resource thing\" needed because the IG Publisher only processes valid FHIR resources?  Is that the thing we're working around here?</p>",
        "id": 251222033,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1630326719
    },
    {
        "content": "<p>yes</p>",
        "id": 251222100,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630326744
    },
    {
        "content": "<p>internally, they will be Binary resources. They'll just look like something else as well when they get published</p>",
        "id": 251222149,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630326780
    },
    {
        "content": "<p>OK, and one more question.  When you say \"this does imply that the logical model is marked up with the details it needs to parse the example\", is that referring to specifying <code>ElementDefinition.representation</code>?  Is there anything else that's needed? (I'm asking in order to understand how SUSHI might best support this).</p>",
        "id": 251222434,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1630326952
    },
    {
        "content": "<p>Yes, and these extensions:</p>\n<ul>\n<li><a href=\"http://hl7.org/fhir/StructureDefinition/elementdefinition-namespace\">http://hl7.org/fhir/StructureDefinition/elementdefinition-namespace</a></li>\n<li><a href=\"http://hl7.org/fhir/StructureDefinition/structuredefinition-xml-no-order\">http://hl7.org/fhir/StructureDefinition/structuredefinition-xml-no-order</a></li>\n<li><a href=\"http://hl7.org/fhir/StructureDefinition/elementdefinition-xml-name\">http://hl7.org/fhir/StructureDefinition/elementdefinition-xml-name</a></li>\n</ul>\n<p>Though I expect that to be a growing set over time. basically: a set of metadata that explains how a logical model is related to a particular wire format representation. In json, it might be around how the wire format gets started, for instance</p>",
        "id": 251224682,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630328187
    },
    {
        "content": "<p>It needs to be visually clear that these are <em>not</em> FHIR examples and can't appear in FHIR interfaces.</p>",
        "id": 251251765,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1630339319
    },
    {
        "content": "<p>I think that's the business of the template and/or IG author, given the range of things that a binary can be used for.</p>",
        "id": 251460370,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444196
    },
    {
        "content": "<p>Anyway, the release due out in the next few hours will include the first part of this change: you can now provide Binary resources as Binary. Here's an example in the IG:</p>",
        "id": 251460516,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444237
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>    <span class=\"nt\">&lt;resource&gt;</span>\n      <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"http://hl7.org/fhir/StructureDefinition/implementationguide-resource-format\"</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">\"image/jpeg\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/extension&gt;</span>\n      <span class=\"nt\">&lt;reference&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"Binary/image-example\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/reference&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"Example of Binary Image\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">\"Example showing example content for an image\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/resource&gt;</span>\n</code></pre></div>",
        "id": 251460831,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444350
    },
    {
        "content": "<p>then you provide the binary as a file:</p>",
        "id": 251460845,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444356
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/t1TGcMcxzRVMbdWMnwxHlN4c/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/t1TGcMcxzRVMbdWMnwxHlN4c/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/t1TGcMcxzRVMbdWMnwxHlN4c/image.png\"></a></div>",
        "id": 251460888,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444376
    },
    {
        "content": "<p>Then, when it generates:</p>",
        "id": 251460909,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444384
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/z8t-8M1r6J8tJFMvG_2vNRB9/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/z8t-8M1r6J8tJFMvG_2vNRB9/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/z8t-8M1r6J8tJFMvG_2vNRB9/image.png\"></a></div>",
        "id": 251460949,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444407
    },
    {
        "content": "<p>The Binary resource was built on the fly from the image. And the narrative rendering:</p>",
        "id": 251460980,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444421
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/VIZkUGg3EZo8aDO9drhXz9DZ/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/VIZkUGg3EZo8aDO9drhXz9DZ/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/VIZkUGg3EZo8aDO9drhXz9DZ/image.png\"></a></div>",
        "id": 251461138,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444453
    },
    {
        "content": "<p>this also works for xml or json Binary files:</p>",
        "id": 251461507,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444540
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/kw4NECAsA7mpHgzdy_4zHHiK/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/kw4NECAsA7mpHgzdy_4zHHiK/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/kw4NECAsA7mpHgzdy_4zHHiK/image.png\"></a></div>",
        "id": 251461591,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630444565
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191505\">@Sean McIlvenna</span> this is for you - you should be good to go now</p>",
        "id": 251543970,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630496672
    },
    {
        "content": "<p>This is great, <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ! Thanks!</p>\n<ul>\n<li>Is implementationguide-resource-format extension required? What's the difference between this and Binary.contentType? How are the two used differently?</li>\n<li>I'm surprised the ImplementationGuide.resource doesn't specify <code>exampleBoolean=true</code> at the least? How does it now that this IG resource is an example?</li>\n<li>Is it required to put these Binary XML files in the <code>input/examples</code> folder?</li>\n</ul>",
        "id": 251578247,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1630509862
    },
    {
        "content": "<ul>\n<li>\n<p>you need the extension because the Binary is constructed on the fly, and the value of the extension becomes the value of Binary.contentType</p>\n</li>\n<li>\n<p>you need to specify exampleCanonical = {logical} to link the example to the logical. There's an example here: <a href=\"https://github.com/FHIR/sample-ig/blob/master/input/myig.xml\">https://github.com/FHIR/sample-ig/blob/master/input/myig.xml</a></p>\n</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"XML\"><pre><span></span><code>    <span class=\"nt\">&lt;resource&gt;</span>\n      <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">\"http://hl7.org/fhir/StructureDefinition/implementationguide-resource-format\"</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;valueCode</span> <span class=\"na\">value=</span><span class=\"s\">\"application/xml\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/extension&gt;</span>\n      <span class=\"nt\">&lt;reference&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">\"Binary/logical-example\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/reference&gt;</span>\n      <span class=\"nt\">&lt;name</span> <span class=\"na\">value=</span><span class=\"s\">\"Example of Logical Model\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">\"Example showing example content for a logical model\"</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;exampleCanonical</span> <span class=\"na\">value=</span><span class=\"s\">\"http://somewhere.org/fhir/uv/myig/StructureDefinition/MyLogical\"</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/resource&gt;</span>\n</code></pre></div>\n<p>which leads to this: <a href=\"https://build.fhir.org/ig/FHIR/sample-ig/Binary-logical-example.html\">https://build.fhir.org/ig/FHIR/sample-ig/Binary-logical-example.html</a></p>\n<ul>\n<li>no, you can put the files whereever they could be loaded from otherwise</li>\n</ul>",
        "id": 251615247,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630524502
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 251695581,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1630579250
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- just to confirm, should this work w/ examples that are in JSON format as well?  The discussion above mostly concerns XML formatted examples.  SUSHI produces JSON, so I want to be sure it will work before we go too far down this road.</p>",
        "id": 255761008,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1633101842
    },
    {
        "content": "<p>certainly should. I'll never do anything that's format specific</p>",
        "id": 255796803,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1633117079
    },
    {
        "content": "<p>OK.  So you're pretty much just rendering whatever is in the attachment, using the resource format value to determine its mime-type.  I get it now.  Thanks.</p>",
        "id": 255801386,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1633119286
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> those custom json / xml structures would need to be excluded from sushi's mix-ins, right?</p>",
        "id": 255802570,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1633119865
    },
    {
        "content": "<p>By <code>mix-ins</code>, do you mean SUSHI's attempt to load all the non-FSH definitions in other <code>input</code> folders?  Assuming that's what you mean, then, yes, I guess SUSHI would need to skip those (at least for now).  I'm not sure what it does now, as I can't recall if it just ignores non-FHIR files it finds there or if it will emit an error because it doesn't recognize it as a valid FHIR resource.</p>",
        "id": 255873202,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1633183118
    },
    {
        "content": "<p>Right, just wanted to mention that. I hope sushi ignores those non-FHIR files</p>",
        "id": 255877621,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1633187589
    },
    {
        "content": "<p>How to get the reference entries into the sushi generated IG?</p>",
        "id": 265222561,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1639690423
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191549\">@Frank Oemig</span> - I'm not sure if I fully understand your question, but we documented how to put logical models into a SUSHI IG in the release notes for SUSHI 2.2.0: <a href=\"https://github.com/FHIR/sushi/releases/tag/v2.2.0\">https://github.com/FHIR/sushi/releases/tag/v2.2.0</a>.  See the section titled <em>Allow Authors to Provide Instances of Logical Models</em>.</p>",
        "id": 265223551,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639690954
    },
    {
        "content": "<p>Thx, Chris, will check that.</p>",
        "id": 265225102,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1639691722
    },
    {
        "content": "<p>That works, thx <span aria-label=\"blush\" class=\"emoji emoji-1f60a\" role=\"img\" title=\"blush\">:blush:</span><br>\nBut is there any means to specify how an instance should be rendered?  I am thinking on defining a template (in Jekyll?) For a LM to specify which attributes should be taken and arranged, eg. in a table or so...</p>",
        "id": 267884000,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1642087418
    },
    {
        "content": "<p>Yes, <span class=\"user-mention\" data-user-id=\"191549\">@Frank Oemig</span> I'd like to work on that , as soon as the feature is enabled</p>",
        "id": 267911587,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1642099049
    },
    {
        "content": "<p>Great, where to look at?</p>",
        "id": 268116983,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1642239950
    }
]