[
    {
        "content": "<p>I'm getting the following QA message:<br>\nThe Coding provided (<a href=\"http://ihe.net/fhir/ValueSet/IHE.FormatCode.codesystem#urn:ihe:pcc:apr:handp:2008\">http://ihe.net/fhir/ValueSet/IHE.FormatCode.codesystem#urn:ihe:pcc:apr:handp:2008</a>) is not in the value set <a href=\"http://hl7.org/fhir/ValueSet/formatcodes\">http://hl7.org/fhir/ValueSet/formatcodes</a>, and a code is recommended to come from this value set. (error message = Not in value set <a href=\"http://hl7.org/fhir/ValueSet/formatcodes\">http://hl7.org/fhir/ValueSet/formatcodes</a>)</p>\n<p>But when you look at the R4 expansion for format codes, that code is absolutely in the set...</p>",
        "id": 271386008,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644468649
    },
    {
        "content": "<p>how to reproduce?</p>",
        "id": 271386803,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644469550
    },
    {
        "content": "<p>Sorry.  HRex IG</p>",
        "id": 271387534,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644470509
    },
    {
        "content": "<p>so this is part of the thing I have been trying to get fixed for sometime. IHE has now formally published an IG with their vocabulary for FormatCode. What you have is out dated.</p>",
        "id": 271433590,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644501238
    },
    {
        "content": "<p><a href=\"https://profiles.ihe.net/fhir/ihe.formatcode.fhir/index.html\">https://profiles.ihe.net/fhir/ihe.formatcode.fhir/index.html</a></p>",
        "id": 271433597,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644501241
    },
    {
        "content": "<p>The codesystem no longer has \"ValueSet\" in it.<br>\n<a href=\"http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode\">http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode</a></p>",
        "id": 271433722,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644501278
    },
    {
        "content": "<p>I had asked for advice on if I should keep the old canonical URI, or fix it. I got guidance to fix it.</p>",
        "id": 271433823,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644501338
    },
    {
        "content": "<p>the codeSystem OID has not ever been wrong or changed.  ;-)</p>",
        "id": 271434010,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644501402
    },
    {
        "content": "<p>You got the guidance to fix it from whom?  Changing canonicals is very problematic...</p>\n<p>In any case, my issue is that the codes that are 'valid' according to THO aren't being treated as valid.</p>",
        "id": 271452354,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644508926
    },
    {
        "content": "<p>yes. agreed</p>",
        "id": 271481485,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644521101
    },
    {
        "content": "<p>at some point one could depend on the formatCode IG, and then use the valueSet. but I can't get that working</p>",
        "id": 271482837,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644521664
    },
    {
        "content": "<p>well, where is it defined? The reason it's giving this error is because the tx server doesn't know the code system</p>",
        "id": 271949269,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644918524
    },
    {
        "content": "<p><a href=\"http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode\">http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode</a> should be right...</p>",
        "id": 271950327,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644919093
    },
    {
        "content": "<p>and so the server should know it</p>",
        "id": 271950894,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644919368
    },
    {
        "content": "<p>yes your canonical is wrong</p>",
        "id": 271953600,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644920861
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Bad.20validation.20of.20IHE.20format.20code/near/271953600\">said</a>:</p>\n<blockquote>\n<p>yes your canonical is wrong</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> who has it wrong? Is there something I need to fix?</p>",
        "id": 271970832,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644930464
    },
    {
        "content": "<p>no it's <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> that has the wrong canonical</p>",
        "id": 271970932,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644930505
    },
    {
        "content": "<p>I am also not able to use the IHE codesystem... so I don't think it is just the canonical. I have not had the time to figure out exactly what combination of settings works vs doesn't.</p>",
        "id": 271971133,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644930625
    },
    {
        "content": "<p>you should be able to use the code system. What are you trying?</p>",
        "id": 271971807,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644930990
    },
    {
        "content": "<p>The canonical I'm using is the one on THO...  How is that wrong?</p>",
        "id": 271991079,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644939260
    },
    {
        "content": "<p>Im guessing that THO has the origianl canonical, not the one IHE currently uses</p>",
        "id": 272020918,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644951341
    },
    {
        "content": "<p>which might be the root of many unusual things</p>",
        "id": 272020940,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644951358
    },
    {
        "content": "<p>The issue we have is that what's on THO is supposed to be source-of-truth for FHIR (and the validator)</p>",
        "id": 272029463,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644955061
    },
    {
        "content": "<p>I have tried to THO to 'copy' the IHE now published codeSystem... I did not know it had a copy of the old stuff. I understood the old stuff was pulled (via FTP) into the FHIR core build.</p>",
        "id": 272034370,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644957449
    },
    {
        "content": "<p>I was told that THO will not take on a shadow copy, given that anyone using an IG will magically find the IHE published work.</p>",
        "id": 272034425,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644957482
    },
    {
        "content": "<p>well, THO has <a href=\"http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode\">http://ihe.net/fhir/ihe.formatcode.fhir/CodeSystem/formatcode</a></p>",
        "id": 272035121,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644957848
    },
    {
        "content": "<p>oh, well that is the right one. How did it get in there? I understood from you that it would not do that.</p>",
        "id": 272035267,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644957938
    },
    {
        "content": "<p>that's in a value set reference to it. Which is correct. I don't know what <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> is looking at, because THO doesn't contain a code system or a naming system - as it shouldn't</p>",
        "id": 272035528,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644958079
    },
    {
        "content": "<p>okay</p>",
        "id": 272035701,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644958164
    },
    {
        "content": "<p>I was incorrect in blaming THO.  The issue is in the R4 publication: <a href=\"http://hl7.org/fhir/valueset-formatcodes.html\">http://hl7.org/fhir/valueset-formatcodes.html</a></p>",
        "id": 272043673,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644962088
    },
    {
        "content": "<p>it's not fixed in R5 either. <span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> please fix it ASAP</p>",
        "id": 272044471,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644962491
    },
    {
        "content": "<p>I do not know how the R5 expansion is generated. Must be some hack under the covers.</p>",
        "id": 272044590,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644962538
    },
    {
        "content": "<p>I have no idea how either... I think the FHIR core pulls it via FTP.. like it did DICOM..</p>",
        "id": 272046381,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644963523
    },
    {
        "content": "<p>I can try to help sort that out(?).</p>",
        "id": 272053621,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1644968207
    },
    {
        "content": "<p>don't worry about that, just correct the code system URL in R5</p>",
        "id": 272053663,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644968235
    },
    {
        "content": "<p>\"Fixing\" a URL is problematic - as it's undoubtedly out in the wild the wrong way too.  Though the fact that the validator chokes on it helps.  Certainly the UTG entry needs to include the 'wrong' URL as an alternate.</p>",
        "id": 272054337,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644968743
    },
    {
        "content": "<p>what UTG entry?</p>",
        "id": 272054506,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644968846
    },
    {
        "content": "<p>We would need a NamingSystem in UTG that says \"this is the official URL - and this is another one that's been used\".  We shouldn't have <em>any</em> code systems referenced in core that UTG doesn't either define or indicate what the official URL for them is.</p>",
        "id": 272066703,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644978687
    },
    {
        "content": "<p>well, you can propose one. Though I think that we shouldn't have to. And we don't for technical reasons</p>",
        "id": 272066795,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644978775
    },
    {
        "content": "<p>\"We don't for technical reasons\" - we don't have to, or don't want to?</p>",
        "id": 272068133,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644980310
    },
    {
        "content": "<p>My justification for wanting to is that if we're using a terminology, it ought to be discoverable in our source-of-truth for terminology.  Plus it ensures that there's an understood authoritative URL that everyone's expected to use.</p>",
        "id": 272068167,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644980361
    },
    {
        "content": "<p>don't have to</p>",
        "id": 272068916,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644981188
    },
    {
        "content": "<p>and I don't think it has to be definable if we can link to it.</p>",
        "id": 272068928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644981209
    },
    {
        "content": "<p>though we don't link to it right now. I'll add that to my list at some stage</p>",
        "id": 272068993,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644981269
    },
    {
        "content": "<p>I asked if I should have done something with NamingSystem...  crickets at the time.</p>",
        "id": 272112303,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645016522
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Bad.20validation.20of.20IHE.20format.20code/near/272053663\">said</a>:</p>\n<blockquote>\n<p>don't worry about that, just correct the code system URL in R5</p>\n</blockquote>\n<p>I have tried to change the ValueSet in R5, and it won't build.  My Branch <br>\n<a href=\"https://github.com/hl7/fhir/tree/moehrke-formatCode\">https://github.com/hl7/fhir/tree/moehrke-formatCode</a></p>",
        "id": 272112759,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645016791
    },
    {
        "content": "<p>not sure why i didn't make a pull-request.. but likely didn't because it fails to build.</p>",
        "id": 272112960,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645016911
    },
    {
        "content": "<p>what was the error? I can't build R5 right now - some weird OSX thing - I'm gradually getting through them</p>",
        "id": 272113386,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1645017181
    }
]