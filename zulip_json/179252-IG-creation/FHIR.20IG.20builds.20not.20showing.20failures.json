[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> - lower priority than some of the other fires you are/have been fighting, but the <a href=\"https://fhir.github.io/auto-ig-builder/builds.html\">https://fhir.github.io/auto-ig-builder/builds.html</a> now only shows successful builds, not failures.  It would be very nice if it went back to showing failures as well as successes.  (Nice to be able to force a re-build without a meaningless commit, nice to see what's working and what's not, etc.)</p>",
        "id": 246930121,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627009439
    },
    {
        "content": "<p>I thought I was seeing thumbs downs?  But I agree that we should be able to see both?</p>",
        "id": 246930199,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1627009505
    },
    {
        "content": "<p>Thumbs down is working find on <a class=\"stream\" data-stream-id=\"179297\" href=\"/#narrow/stream/179297-committers.2Fnotification\">#committers/notification</a>.  I'm talking about the build dashboard page.</p>",
        "id": 246930296,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627009585
    },
    {
        "content": "<p>It shows all green for the last 3 years, which seems unlikely (particularly given recent troubles)</p>",
        "id": 246930313,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627009614
    },
    {
        "content": "<p>Yes, that makes sense.</p>",
        "id": 246930901,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1627010348
    },
    {
        "content": "<p>I've fixed up <a href=\"https://fhir.github.io/auto-ig-builder/builds.html\">https://fhir.github.io/auto-ig-builder/builds.html</a> so it's not totally borked. It needs a re-work at some point, since it's literally downloading all the build logs from all the IGs into the browser to determine which ones succeeded and which ones failed. But for now, I just added a request \"pool\" so it doesn't try to grab hundreds of logs all at once; it now will stick to no more than eight requests at a time :-)</p>",
        "id": 246931950,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627011669
    },
    {
        "content": "<blockquote>\n<p>Nice to be able to force a re-build without a meaningless commit, nice to see what's working and what's not, etc.</p>\n</blockquote>\n<p>FWIW I generally use curl for triggering a re-build; instructions at <a href=\"https://github.com/FHIR/auto-ig-builder#if-you-want-to-manually-trigger-a-build\">https://github.com/FHIR/auto-ig-builder#if-you-want-to-manually-trigger-a-build</a></p>",
        "id": 246932321,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627012233
    },
    {
        "content": "<p>Ok, I'm still only seeing 'green'? (<span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> )</p>",
        "id": 246997585,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627056562
    },
    {
        "content": "<p>Open dev tools and look at the network tab -- build failures will only show up in the \"Builds\" table when the script finishes fetching all the logs (like: 500+ http requests).</p>",
        "id": 246998897,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627057289
    },
    {
        "content": "<p>This takes ~10sec for me on a fast network connection.</p>",
        "id": 246998939,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627057315
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/TkKhgjsjgBJZbOY_prW0kIzt/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/TkKhgjsjgBJZbOY_prW0kIzt/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/TkKhgjsjgBJZbOY_prW0kIzt/image.png\"></a></div>",
        "id": 246998961,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627057323
    },
    {
        "content": "<p>(there are also issues with this dashboard for repos that use <code>main</code> instead of <code>master</code> -- they were missing altogether until last night; now they show up but the \"logs\" links etc are still not right.)</p>",
        "id": 246999080,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627057372
    },
    {
        "content": "<p>This dashboard was created in <del>2016</del> 2018 when there were, like... a <del>small</del> smaller number of IGs in the world. It has lasted much longer than I ever though it would, but it's by no means capable of handling our current size (or growth!).</p>",
        "id": 246999168,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627057424
    },
    {
        "content": "<p>It's time for a rewrite, if anyone's interested ;-)</p>",
        "id": 246999196,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627057442
    },
    {
        "content": "<p>What's it written in Josh?</p>",
        "id": 247012083,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627063430
    },
    {
        "content": "<p>There's two parts:</p>\n<ol>\n<li>\n<p>During the IG Auto-build process, every time an IG is built and copied into <a href=\"http://build.fhir.org\">build.fhir.org</a>, we run this <a href=\"https://github.com/FHIR/auto-ig-builder/blob/b9715c5369ed571e3e95fab9a0fb9db9061b3595/images/ci-build/publish-ig#L39-L43\">four-line bash script</a> to update the <a href=\"https://build.fhir.org/ig/builds.json\"><code>builds.json</code></a> file and the <a href=\"https://build.fhir.org/ig/qas.json\"><code>qas.json</code></a> file on the CI server.  These two files are JSON arrays with entries for every (ig, branch) hosted on <a href=\"http://build.fhir.org\">build.fhir.org</a></p>\n</li>\n<li>\n<p><a href=\"https://fhir.github.io/auto-ig-builder/builds.html\">https://fhir.github.io/auto-ig-builder/builds.html</a> is HTML/JS (all self-contained) that grabs the builds.json and qas.json files to create a table of builds, and it <em>also</em> grabs all the build <em>logs</em> from the folders on the CI server to determine which builds succeeded vs failed.</p>\n</li>\n</ol>",
        "id": 247012712,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627063784
    },
    {
        "content": "<p>It's probably a good idea for (1) to do the additional work of analyzing build log to determine success-vs-failure status, and include this info in builds.json directly, so that way the web page could rely on the builds.json file without also needing to grab/evaluate logs.</p>",
        "id": 247012864,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627063867
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179252-IG-creation/topic/FHIR.20IG.20builds.20not.20showing.20failures/near/246932321\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>Nice to be able to force a re-build without a meaningless commit, nice to see what's working and what's not, etc.</p>\n</blockquote>\n<p>FWIW I generally use curl for triggering a re-build; instructions at <a href=\"https://github.com/FHIR/auto-ig-builder#if-you-want-to-manually-trigger-a-build\">https://github.com/FHIR/auto-ig-builder#if-you-want-to-manually-trigger-a-build</a></p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> I was trying to follow your instructions on manually triggering a re-build and I don't see the \"Settings &gt; Webhooks &gt; \".  I'm going to try the curl option.</p>",
        "id": 247478608,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1627488134
    },
    {
        "content": "<p>If you don't see webhooks, can you confirm you're an administrator on the repository? In any case, curl should work for you and is generaly what I'd recommend.</p>",
        "id": 247608749,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627576916
    },
    {
        "content": "<p>If it's an HL7 repository, they shouldn't be an administrator - administrator privileges are supposed to be tightly held.</p>",
        "id": 247609303,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627577190
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> you could  fork the repo, make stuff work as you like it to be and add the webhooks - and then afterwards make a PR back to the origin</p>",
        "id": 247626924,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1627585460
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/179252-IG-creation/topic/FHIR.20IG.20builds.20not.20showing.20failures/near/246999080\">said</a>:</p>\n<blockquote>\n<p>(there are also issues with this dashboard for repos that use <code>main</code> instead of <code>master</code> -- they were missing altogether until last night; now they show up but the \"logs\" links etc are still not right.)</p>\n</blockquote>\n<p>Have you also changed the default browsing path then? Meaning that by default it will direct you to the <code>main</code>branch instead of <code>master</code> ?</p>",
        "id": 247628071,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1627586066
    },
    {
        "content": "<p>No, the tooling still pretty much expects everything to be called <code>master</code>. I've written a plan outlining the development steps required to improve this, but I don't want to take this work on myself; if we're going to invest in improvements to the tooling, we need to grow the community around it.</p>",
        "id": 247636457,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627590319
    },
    {
        "content": "<p>makes sense</p>",
        "id": 247636492,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1627590342
    },
    {
        "content": "<p>Just to complete the thought: <a href=\"#narrow/stream/179252-IG-creation/topic/Primary.20branch.20name/near/214200898\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Primary.20branch.20name/near/214200898</a> is a link to the previous discussion where I outlined steps required.</p>",
        "id": 247649250,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1627597671
    },
    {
        "content": "<p>I'll read the discussion - but I'll ask this now.  For an IG that currently has a 'main' branch (not 'master'), should we change the 'main' branch to 'master' to be more compatible with the current tooling (at least until the use of a 'main' branch is sufficiently supported)?</p>",
        "id": 247652815,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1627600188
    },
    {
        "content": "<p>You can.  You can also just push your changes to a 'master' branch in addition to 'main' to trigger publication.  (While I don't like doing so, I've been manually changing new IGs from 'main' to 'master' when I set them up just to keep things simpler for people.)</p>",
        "id": 247665902,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1627614121
    }
]