[
    {
        "content": "<p>If you want to see what I'm talking about below - <a href=\"https://github.com/HL7/fhir-spl/\">https://github.com/HL7/fhir-spl/</a></p>\n<p>I have an Organization profile where I slice Organization.contact.telecom based on the system.  On each slice, I indicate that the contact.telecom must conform to a ContactPoint profile I've created:</p>\n<div class=\"codehilite\"><pre><span></span><code>      {\n        &quot;id&quot;: &quot;Organization.contact.telecom&quot;,\n        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,\n        &quot;slicing&quot;: {\n          &quot;discriminator&quot;: [\n            {\n              &quot;type&quot;: &quot;value&quot;,\n              &quot;path&quot;: &quot;system&quot;\n            }\n          ],\n          &quot;rules&quot;: &quot;open&quot;,\n          &quot;description&quot;: &quot;Require a telephone number and an email address.&quot;\n        },\n        &quot;min&quot;: 2,\n        &quot;mustSupport&quot;: true\n      },\n      {\n        &quot;id&quot;: &quot;Organization.contact.telecom:Phone&quot;,\n        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,\n        &quot;sliceName&quot;: &quot;Phone&quot;,\n        &quot;min&quot;: 1,\n        &quot;max&quot;: &quot;1&quot;,\n        &quot;type&quot;: [\n          {\n            &quot;code&quot;: &quot;ContactPoint&quot;,\n            &quot;profile&quot;: [\n              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;\n            ]\n          }\n        ],\n        &quot;mustSupport&quot;: true\n      },\n      {\n        &quot;id&quot;: &quot;Organization.contact.telecom:Phone.system&quot;,\n        &quot;path&quot;: &quot;Organization.contact.telecom.system&quot;,\n        &quot;patternCode&quot;: &quot;phone&quot;\n      },\n      {\n        &quot;id&quot;: &quot;Organization.contact.telecom:Email&quot;,\n        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,\n        &quot;sliceName&quot;: &quot;Email&quot;,\n        &quot;min&quot;: 1,\n        &quot;max&quot;: &quot;1&quot;,\n        &quot;type&quot;: [\n          {\n            &quot;code&quot;: &quot;ContactPoint&quot;,\n            &quot;profile&quot;: [\n              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;\n            ]\n          }\n        ],\n        &quot;mustSupport&quot;: true\n      },\n      {\n        &quot;id&quot;: &quot;Organization.contact.telecom:Email.system&quot;,\n        &quot;path&quot;: &quot;Organization.contact.telecom.system&quot;,\n        &quot;patternCode&quot;: &quot;email&quot;\n      },\n      {\n        &quot;id&quot;: &quot;Organization.contact.address&quot;,\n        &quot;path&quot;: &quot;Organization.contact.address&quot;,\n        &quot;min&quot;: 1,\n        &quot;type&quot;: [\n          {\n            &quot;code&quot;: &quot;Address&quot;,\n            &quot;profile&quot;: [\n              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLAddress&quot;\n            ]\n          }\n        ],\n        &quot;mustSupport&quot;: true\n      }\n</code></pre></div>\n<p>After generation by the IG Publisher, all of the constraints expressed on my ContactPoint profile are being \"moved up\" into the Organization profile.  The profile specifies that contact.telecom must conform to SPLContactPoint, but it also duplicates all of the constraints as well.</p>\n<div class=\"codehilite\"><pre><span></span><code>      {\n        &quot;id&quot;: &quot;Organization.contact.telecom:Phone&quot;,\n        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,\n        &quot;sliceName&quot;: &quot;Phone&quot;,\n        &quot;short&quot;: &quot;Details of a Technology mediated contact point (phone, fax, email, etc.)&quot;,\n        &quot;definition&quot;: &quot;Details for all kinds of technology mediated contact points for a person or organization, including telephone, email, etc.&quot;,\n        &quot;requirements&quot;: &quot;People have (primary) ways to contact them in some way such as phone, email.&quot;,\n        &quot;min&quot;: 1,\n        &quot;max&quot;: &quot;1&quot;,\n        &quot;base&quot;: {\n          &quot;path&quot;: &quot;Organization.contact.telecom&quot;,\n          &quot;min&quot;: 0,\n          &quot;max&quot;: &quot;*&quot;\n        },\n        &quot;type&quot;: [\n          {\n            &quot;code&quot;: &quot;ContactPoint&quot;,\n            &quot;profile&quot;: [\n              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;\n            ]\n          }\n        ],\n...\n          {\n            &quot;key&quot;: &quot;spl-2.1.7.x&quot;,\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;human&quot;: &quot;Telephone and fax numbers are formatted properly&quot;,\n            &quot;expression&quot;: &quot;(system = &#39;phone&#39; or system = &#39;fax&#39;) implies value.matches(&#39;^\\\\\\\\+[0-9]{1,3}-[0-9]{1,3}-[0-9]{3,4}-[0-9]{4}(;ext=[0-9]+)?$&#39;)&quot;,\n            &quot;source&quot;: &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;\n          },\n          {\n            &quot;key&quot;: &quot;spl-2.1.7.11&quot;,\n            &quot;severity&quot;: &quot;error&quot;,\n            &quot;human&quot;: &quot;Emails are formatted properly&quot;,\n            &quot;expression&quot;: &quot;system = &#39;email&#39; implies value.matches(&#39;^[a-zA-Z0-9.!#$%&amp;â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(\\\\\\\\.[a-zA-Z0-9-]+)*$&#39;)&quot;,\n            &quot;source&quot;: &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;\n          }\n</code></pre></div>\n<p>This effectively duplicates the profile constraints.  I'm not sure that it should be doing that.</p>",
        "id": 243218787,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1624062579
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> should the snapshot be pulling the constraints from the datatype profile into the main profile?  I'm wondering if it is doing that because my discriminator is on the ContactPoint.system?</p>",
        "id": 243434030,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1624305148
    }
]