[
    {
        "content": "<p>As discussed here: <a href=\"http://jira.hl7.org/browse/FHIR-27023\">J#27023</a> the NUCC codesystem contains spurious codes serving as grouper codes that should not be exposed.  It is unclear whether the codes should be expanded at all due to PI questions.  ( maybe <span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span>  can clarify that point ).  in summary here is the <a href=\"file:///Users/ehaas/Documents/FHIR/US-Core-R4/output/ValueSet-us-core-provider-specialty.html#expansion\">expansion from US Core </a><br>\nand the codes beginning with \"base\" are not part of the code-system.  not sure which repro to post an issue&gt;  ig-pub or</p>",
        "id": 203761264,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594669335
    },
    {
        "content": "<p>ok so why this happens:</p>\n<ul>\n<li>NUCC includes abstract concepts </li>\n<li>NUCC doesn't assign them codes</li>\n<li>the CodeSystem resource requires all concepts to have codes </li>\n<li>so the code I used to create this resource auto-generated internal codes for those concepts</li>\n<li>the US core value set asks for all concepts in NUCC, so it gets all the concepts, including my generated codes </li>\n</ul>\n<p>So the NUCC value set should only include leaf concepts</p>",
        "id": 203762335,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594669847
    },
    {
        "content": "<p>No, the value set has to have all the codes that have a code defined by NUCC. These will not be limited to leaf concepts. But restructuring the value set definition to do such a thing will not correctly fix the problem that the FHIR rendering is assigning identifiers to the abstract concepts <strong>and those identifiers can be found, used, and displayed.</strong> Is there a way that we can suppress <strong>any use</strong> within FHIR <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 203763068,
        "sender_full_name": "Robert McClure",
        "timestamp": 1594670207
    },
    {
        "content": "<p>I don't understand. Either:</p>\n<ul>\n<li>the NUCC code system defines codes for the concepts </li>\n<li>we shouldn't put the grouping concepts in the code system (and so can't select sub-sets by category)</li>\n<li>we should generate codes for the concepts </li>\n</ul>\n<p>You appear to imply there's a 4th option, but I don't know what that is</p>",
        "id": 203763289,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594670330
    },
    {
        "content": "<p>In a perfect world we would generate internal identifiers for the groupers and be able to use that in defining a value set compose, <strong>but those concepts could <em>never</em> be included in an expansion.</strong></p>",
        "id": 203763837,
        "sender_full_name": "Robert McClure",
        "timestamp": 1594670598
    },
    {
        "content": "<p>but there's cases where you <em>want</em> to be able to include them in the expansion because of what you are doing. For me, this is a problem in the definition of the value set.</p>",
        "id": 203763949,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594670646
    },
    {
        "content": "<p>You just want to be lazy in the definition of the value set.</p>",
        "id": 203763983,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594670665
    },
    {
        "content": "<p>But I need to confirm that would be allowed by NUCC. The alternative would be they don't want the groupers to have any code, which we'd have to tell them means they can not be in the code system because they provide value as groupers so are either usable, or don't exist.</p>",
        "id": 203764061,
        "sender_full_name": "Robert McClure",
        "timestamp": 1594670703
    },
    {
        "content": "<p>ok. It's certainly good to clarify this with NUCC. Ideally, they'll choose to assign codes to the groupers so that people can refer to the groupers, and then we can update the code system with the codes</p>",
        "id": 203764141,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594670755
    },
    {
        "content": "<blockquote>\n<p>So the NUCC value set should only include leaf concepts</p>\n</blockquote>\n<p>how do I do that exactly?   it says <a href=\"http://build.fhir.org/valueset.html#compositions\">here</a>:</p>\n<blockquote>\n<p>Value sets may include abstract codes - that is, codes designated by the underlying code system as not for use as a selectable concept in a particular context. These abstract codes are typically used as a grouping/searching mechanism, and can be included either by enumerating them, or by using a filter.</p>\n</blockquote>",
        "id": 203768302,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594672906
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">&lt;filter&gt;</span>\n  <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;child&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;op</span> <span class=\"na\">value=</span><span class=\"s\">&quot;exists&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;false&quot;</span><span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;filter&gt;</span>\n</code></pre></div>",
        "id": 203768481,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594672979
    },
    {
        "content": "<p>the above text implies the abstact codes are excluded by default</p>",
        "id": 203768508,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594672990
    },
    {
        "content": "<p>well, that's certainly not the case that they are excluded by default</p>",
        "id": 203768556,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594673019
    },
    {
        "content": "<p>OK I just found that text and my experience is that they are included by default.  I will log a tracker</p>",
        "id": 203768674,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594673067
    },
    {
        "content": "<p>hold on that is for composition and not expansion... my mistake</p>",
        "id": 203768798,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594673133
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> the expectation would be not just leaf node values. An \"all codes\" expansion should have anything with \"an official NUCC code.\"</p>",
        "id": 203776003,
        "sender_full_name": "Robert McClure",
        "timestamp": 1594676904
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191503\">@Robert McClure</span>  my understanding was that in this case the abstract grouping codes are the problem.</p>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>   I added the filter and I am now getting this validation error  ( I am at a disadvantage since I don't where the codes system resource is defined ) :</p>\n<div class=\"codehilite\"><pre><span></span><code>/Users/ehaas/Documents/FHIR/US-Core-R4/source/resources/valueset-us-core-provider-specialty.xml\nPath    Severity    Message\nValueSet/us-core-provider-specialty: ValueSet   Process Info    Validate resource against profile http://hl7.org/fhir/StructureDefinition/ValueSet\nValueSet.where(id = &#39;us-core-provider-specialty&#39;)   error   Error from server: The filter &quot;child exists false&quot; was not understood in the context of http://nucc.org/provider-taxonomy (see Tx log)\n</code></pre></div>\n\n\n<p>here is the actual valueset BTW</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;ValueSet xmlns=&quot;http://hl7.org/fhir&quot; xmlns:xhtml=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\n  &lt;id value=&quot;us-core-provider-specialty&quot;/&gt;\n  &lt;url value=&quot;http://hl7.org/fhir/us/core/ValueSet/us-core-provider-specialty&quot;/&gt;\n  &lt;version value=&quot;1.0.1&quot;/&gt;\n  &lt;name value=&quot;USCoreProviderSpecialityNucc&quot;/&gt;\n  &lt;title value=&quot;US Core Provider Speciality (NUCC)&quot;/&gt;\n  &lt;status value=&quot;active&quot;/&gt;\n  &lt;date value=&quot;2019-05-21&quot;/&gt;\n  &lt;publisher value=&quot;HL7 US Realm Steering Committee&quot;/&gt;\n  &lt;contact&gt;\n    &lt;telecom&gt;\n      &lt;system value=&quot;other&quot;/&gt;\n      &lt;value value=&quot;http://hl7.org/fhir&quot;/&gt;\n    &lt;/telecom&gt;\n  &lt;/contact&gt;\n  &lt;description value=&quot;Provider speciality roles codes which are composed of the NUCC Health Care Provider Taxonomy Code Set for providers&quot;/&gt;\n  &lt;copyright value=&quot;This value set includes content from NUCC Health Care Provider Taxonomy Code Set for providers which is copyright Â© 2016+ American Medical Association.  For commercial use, including sales or licensing, a license must be obtained.&quot;/&gt;\n  &lt;compose&gt;\n    &lt;include&gt;\n      &lt;system value=&quot;http://nucc.org/provider-taxonomy&quot;/&gt;\n      &lt;filter&gt;\n        &lt;property value=&quot;child&quot;/&gt;\n        &lt;op value=&quot;exists&quot;/&gt;\n        &lt;value value=&quot;false&quot;/&gt;\n      &lt;/filter&gt;\n    &lt;/include&gt;\n  &lt;/compose&gt;\n&lt;/ValueSet&gt;\n</code></pre></div>",
        "id": 203795109,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594696547
    },
    {
        "content": "<p>ok fixed some time today</p>",
        "id": 203797694,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594700825
    },
    {
        "content": "<p>So I'm clear: <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> , is there a solution that will preclude the groupers from getting an HL7 internal defined code but allow them to still be \"in the HL7 rendering of the code system\" and also allow a value set compose to reference them so that it could say something like \"all decedents of\" the grouper, but the groupers would not show up in any expansion, yet <strong>all</strong> the other concepts could (both leaves and their parents.)</p>",
        "id": 203864670,
        "sender_full_name": "Robert McClure",
        "timestamp": 1594748900
    },
    {
        "content": "<p>I am being really pragmatic -but right now to meet timelines and budgets so all I am concerned about is not exposing these grouper codes in us-core  I think the solution you are asking for is not currently implemented.</p>",
        "id": 203865851,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594749524
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> Understand we have constraints. Is the solution to only include leaf concepts in the expansion? IE: change the definition of that value set? I'd much rather we change the code system resource to mark all the groupers as abstract or something then exclude them while leaving the CLD for the value set \"all non-abstract codes\" or some such. Is this possible? if you restrict to only leaf concepts that changes the meaning of the value set and removes valid codes.</p>",
        "id": 203866553,
        "sender_full_name": "Robert McClure",
        "timestamp": 1594749867
    },
    {
        "content": "<blockquote>\n<p>the CLD for the value set \"all non-abstract codes\" </p>\n</blockquote>\n<p>I don't know how to do that.  I looked and did not see a way.</p>",
        "id": 203868751,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594751012
    },
    {
        "content": "<p>posted this question <a href=\"#narrow/stream/179202-terminology/topic/how.20to.20filter.20by.20abstract.20codes.3F\">here</a></p>",
        "id": 203869186,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594751192
    },
    {
        "content": "<p>and also I don't how to access and view this  code system in FHIR</p>",
        "id": 203869409,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594751291
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> is it intentional that inactive codes are included in the <a href=\"https://www.hl7.org/fhir/us/core/ValueSet-us-core-provider-specialty.html\">provider speciality valueset</a> e.g. <code>103GC0700X</code>?  I see inactive codes in the <a href=\"https://github.com/FHIR/packages/blob/master/packages/fhir.tx.support.r4/package/CodeSystem-nucc-provider-taxonomy.json\">FHIR CodeSystem representation on GitHub FHIR/Pacages</a>.  I don't have an opinion on whether or not they should be included, just looking for clarification if that was the intent.</p>",
        "id": 217327680,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1605818555
    },
    {
        "content": "<p>We did not intentionally include them and before we can consider whether they should be discouraged 0- which I assume is the wish of the code system oweners.  I am going to defer this question to the Vocabulary stream.  There are a lot of questions swirling around using NUCC codes right now and will just add this to the list before we can resolve it for US Core.</p>",
        "id": 217330110,
        "sender_full_name": "Eric Haas",
        "timestamp": 1605819904
    },
    {
        "content": "<p>moved discussion to here:  <a href=\"#narrow/stream/179202-terminology/topic/NUCC.20inactive.20codes.2E\">https://chat.fhir.org/#narrow/stream/179202-terminology/topic/NUCC.20inactive.20codes.2E</a></p>",
        "id": 217330505,
        "sender_full_name": "Eric Haas",
        "timestamp": 1605820142
    }
]