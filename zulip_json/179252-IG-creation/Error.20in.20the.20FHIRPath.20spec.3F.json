[
    {
        "content": "<p>Looking at <a href=\"https://hl7.org/fhir/fhirpath.html#simple\">Section 2.9.4</a> of the FHIRPath spec, it defines the 'simple' FHIRPath syntax we use for things like defining slicing discriminators.  The wording says:<br>\n<code>All statements SHALL start with the name of the context element (e.g. on a Patient resource, Patient.contact.name.), or SHALL be simply \"$this\" to refer to the element that has focus</code><br>\nHowever, I know for a fact that none of the tools allow this.  If you're starting at Patient and want to specify a discriminator of patient contact name, then the discriminator path is \"<a href=\"http://contact.name\">contact.name</a>\", not \"<a href=\"http://Patient.contact.name\">Patient.contact.name</a>\".  I.e. you never include the name of the 'current' element as part of the path - that's one of the reasons we need $this.</p>\n<p>Am I correct that this wording is in error?  (<span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>)</p>\n<p>(The fact it's a SHALL statement is going to make it more fun to fix...)</p>",
        "id": 257863999,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634420879
    },
    {
        "content": "<p>I don't think that the statement is wrong. where don't the tools support it?</p>",
        "id": 257864115,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634420971
    },
    {
        "content": "<p>Simple example:</p>\n<div class=\"codehilite\"><pre><span></span><code>    &lt;element id=&quot;Task.input&quot;&gt;\n      &lt;path value=&quot;Task.input&quot;/&gt;\n      &lt;slicing&gt;\n        &lt;discriminator&gt;\n          &lt;type value=&quot;pattern&quot;/&gt;\n          &lt;path value=&quot;type&quot;/&gt;\n        &lt;/discriminator&gt;\n        &lt;rules value=&quot;open&quot;/&gt;\n      &lt;/slicing&gt;\n      &lt;mustSupport value=&quot;true&quot;/&gt;\n    &lt;/element&gt;\n</code></pre></div>",
        "id": 257864351,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634421192
    },
    {
        "content": "<p>According to the text in the spec, my discriminator ought to be \"Task.input.pattern\" (or maybe \"input.pattern\"?)</p>",
        "id": 257864378,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634421227
    },
    {
        "content": "<p>it won't work there - you'll need $this.</p>",
        "id": 257864565,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634421368
    },
    {
        "content": "<p>I don't need $this - a discriminator of \"pattern\" works just fine...</p>",
        "id": 257865918,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634422614
    },
    {
        "content": "<p>I only need $this if the discriminator is the same as the element being sliced.</p>",
        "id": 257865946,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634422647
    },
    {
        "content": "<p>you'll need $this to be compliant with the rule</p>",
        "id": 257866351,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634423027
    },
    {
        "content": "<p>Right - but if tools don't enforce the rule, and there's no need for the rule, why do we have the rule?</p>",
        "id": 257866838,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634423477
    }
]