[
    {
        "content": "<p>I am at a lost at how to 'slice' effective[x] or if I even need to slice it. In my profile, the Observation.effective[x] must exist, but it can be either effectiveDateTime or effectivePeriod. Which one of the two depends upon what a medical device reports.<br>\nMy effort is as follows:</p>\n<div class=\"codehilite\"><pre><span></span>    &lt;element id=&quot;Observation.effective[x]&quot;&gt;\n      &lt;path value=&quot;Observation.effective[x]&quot; /&gt;\n      &lt;slicing&gt;\n        &lt;discriminator&gt;\n          &lt;type value=&quot;type&quot; /&gt;\n          &lt;path value=&quot;$this&quot; /&gt;\n        &lt;/discriminator&gt;\n        &lt;rules value=&quot;open&quot; /&gt;\n      &lt;/slicing&gt;\n      &lt;definition value=&quot;The time or time-period the observed value is asserted as being true. It is a time period if a Measure-Active-Period (duration) attribute is part of the metric measurement sent by the PHD. Otherwise it is the time stamp sent by the PHD or the time of reception by the PHG if the PHD sent no time stamp.&quot; /&gt;\n      &lt;min value=&quot;1&quot; /&gt;\n      &lt;!-- The base Observation profile specifies that max=1. However, if you do not re-specify it here, you will get a slicing on non-repeating element error unless\n      you have a constraint that restricts the total number. Here I end up stating both since the constraint makes it clearer to the implementer that not only can\n      only one exists but that has to be at least one. --&gt;\n      &lt;max value=&quot;1&quot; /&gt;\n      &lt;type&gt;\n        &lt;code value=&quot;dateTime&quot;/&gt;\n      &lt;/type&gt;\n      &lt;type&gt;\n        &lt;code value=&quot;Period&quot;/&gt;\n      &lt;/type&gt;\n      &lt;constraint&gt;\n        &lt;key value=&quot;phd-obs-1&quot;/&gt;\n        &lt;!-- Some time stamp SHALL be present --&gt;\n        &lt;severity value=&quot;error&quot;/&gt;\n        &lt;human value=&quot;Either an effectiveDateTime or effectivePeriod shall be present&quot;/&gt;\n        &lt;expression value=&quot;effectiveDateTime.exists() or effectivePeriod.exists().exists()&quot;/&gt;\n      &lt;/constraint&gt;\n    &lt;/element&gt;\n</pre></div>\n\n\n<p>I do not really understand the &lt;path value=\"$this\"/&gt; as I obtained it from another guide which seemed to do what I needed to do but I have not found anything about it on the FHIR pages. In any case, the IG Publisher validator does not like it and reports an error for every example resource I have (no surprise as the element is required). The error is</p>\n<div class=\"codehilite\"><pre><span></span>Profile http://hl7.org/fhir/uv/phd/StructureDefinition/PhdCoincidentTimeStampObservation, Element matches more than one slice - , dateTime\n</pre></div>\n\n\n<p>which indicates to me the '$this' is not doing what I thought it was supposed to do. <br>\nIs it sufficient just to have the constraint in the element?</p>",
        "id": 154020128,
        "sender_full_name": "Brian Reinhold",
        "timestamp": 1542802187
    },
    {
        "content": "<p>I got a similar error which was discussed <a href=\"#narrow/stream/99-IG-creation/subject/QA.20error.20on.20type.20slicing\" title=\"#narrow/stream/99-IG-creation/subject/QA.20error.20on.20type.20slicing\">here</a>. Not sure if it has been fixed.</p>",
        "id": 154020183,
        "sender_full_name": "Stefan Karl",
        "timestamp": 1542814546
    },
    {
        "content": "<p>I don't think that needs to be profiled at all.  It sounds like the base resource does the trick</p>",
        "id": 154020198,
        "sender_full_name": "Eric Haas",
        "timestamp": 1542816601
    },
    {
        "content": "<p>What are you doing with your slices?  The invariant is declared on the wrong element.  You can't check if effective is present within the context of effective</p>",
        "id": 154020254,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1542822243
    }
]