[
    {
        "content": "<p>What does this IG Publisher error mean?<br>\nI have a clean sushi build, but IG Publisher sez:</p>\n<p>Error in snapshot generation: The profile <a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization\">http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization</a> has 5 elements in the differential (id: <a href=\"http://Organization.identifier.id\">Organization.identifier.id</a>, id: Organization.identifier.use, id: Organization.identifier.type, id: Organization.identifier.period, id: Organization.identifier.assigner) that don't have a matching element in the snapshot: check that the path and definitions are legal in the differential (including order) (</p>\n<p>Relates to this fsh:  <a href=\"https://github.com/HL7/davinci-pdex-plan-net\">https://github.com/HL7/davinci-pdex-plan-net</a></p>\n<p>The relevant FSH input is:</p>\n<ul>\n<li><a href=\"http://identifier.id\">identifier.id</a> MS</li>\n<li>identifier.use MS</li>\n<li>identifier.system MS</li>\n<li>identifier.type MS</li>\n<li>identifier.value MS</li>\n<li>identifier.period MS</li>\n<li>identifier.assigner MS</li>\n</ul>\n<p>PlanNetOrganization is a profile of USCore-Organization, which has two (open) slices of identifier (NPI and CLIA).<br>\nCould that be contributing to a sushi or IG Publisher issue?</p>",
        "id": 198922052,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1590599213
    },
    {
        "content": "<p>I've taken a look at this, and one thing I am noticing is that SUSHI will add an empty <code>Practitioner.identifier</code>element to the differential so that the differential is not sparse:<br>\n<a href=\"/user_uploads/10155/ksySPPrOjwqZAf9ANOvOKxnm/image.png\">image.png</a><br>\nBut if that empty <code>Practitioner.identifier</code> element is taken out, it looks like this error goes away. We didn't think having an empty diff element like this would be a problem, but it seems to be a problem in this case for some reason.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/ksySPPrOjwqZAf9ANOvOKxnm/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/ksySPPrOjwqZAf9ANOvOKxnm/image.png\"></a></div>",
        "id": 198926843,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1590601597
    },
    {
        "content": "<p>ok here is what sushi generates:</p>\n<div class=\"codehilite\"><pre><span></span><code>      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier&quot;</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.id&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.id&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.use&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.use&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.period&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.period&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.assigner&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.identifier.assigner&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.active&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.active&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;patternBoolean&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Organization.type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;binding&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n          <span class=\"nt\">&quot;strength&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;required&quot;</span><span class=\"p\">,</span>\n          <span class=\"nt\">&quot;valueSet&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://hl7.org/fhir/us/davinci-pdex-plan-net/ValueSet/OrgTypeVS&quot;</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n</code></pre></div>",
        "id": 198931717,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590603806
    },
    {
        "content": "<p>they are all mustSupport, I don't see how this can be about sparse or exhaustive differentials.</p>",
        "id": 198932030,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590603960
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"239822\">@Nick Freiter</span> you are saying about Practitioner, but the issue reported is in the Organization...?</p>",
        "id": 198932196,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590604010
    },
    {
        "content": "<blockquote>\n<p>they are all mustSupport, I don't see how this can be about sparse or exhaustive differentials.</p>\n</blockquote>\n<p>The sparse/exhaustive part is referring to the fact that we include an element for <code>Organization.identifier</code> even though it has no changes.  A sparse differential is when the full path to an element isn't represented in the differential (e.g., if there is an element for <code>Organization.identifier.id</code> but not for its parent, <code>Organization.identifier</code>).</p>\n<p>I'm thinking that this probably has to do with the parent profile having a <code>slicing</code> on <code>Organization.identifier</code> -- and in this profile we're trying to apply constraints to the \"all slices\" part of the slicing -- but the publisher is confused about that.</p>",
        "id": 198932475,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590604118
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"215604\">@Saul Kravitz</span> are you using the latest version of the publisher?</p>",
        "id": 198932600,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590604193
    },
    {
        "content": "<p>@Nick Freiter confirmed to me in an earlier message that this issue exists for both the <code>Organization</code> and <code>Practitioner</code>-based profiles in Saul's IG.  He probably just copied the wrong one in here.</p>",
        "id": 198932755,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590604255
    },
    {
        "content": "<p>ok</p>",
        "id": 198933028,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590604381
    },
    {
        "content": "<p>Just updated to:  FHIR IG Publisher Version 1.0.97-SNAPSHOT (Git# 9433f4baf940). Built 2020-05-27T11:06:47.451+10:00 (17 hours old)</p>\n<p>Still get:<br>\nError in snapshot generation: The profile <a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization\">http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization</a> has 5 elements in the differential (id: <a href=\"http://Organization.identifier.id\">Organization.identifier.id</a>, id: Organization.identifier.use, id: Organization.identifier.type, id: Organization.identifier.period, id: Organization.identifier.assigner) that don't have a matching element in the snapshot: check that the path and definitions are legal in the differential (including order)</p>\n<p>and<br>\nError in snapshot generation: The profile <a href=\"http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Practitioner\">http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Practitioner</a> has 5 elements in the differential (id: <a href=\"http://Practitioner.identifier.id\">Practitioner.identifier.id</a>, id: Practitioner.identifier.use, id: Practitioner.identifier.type, id: Practitioner.identifier.period, id: Practitioner.identifier.assigner) that don't have a matching element in the snapshot: check that the path and definitions are legal in the differential (including order)</p>",
        "id": 198933837,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1590604742
    },
    {
        "content": "<p>are you slicing  organization.identifier?</p>",
        "id": 198934342,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590604977
    },
    {
        "content": "<p>ah, sorry. on the parent profile...</p>",
        "id": 198934393,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590605004
    },
    {
        "content": "<p>ok I understand now, <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> the parent profile has the slices , but the child profile is trying to apply a MS to all slices.</p>",
        "id": 198934577,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590605090
    },
    {
        "content": "<p>Right -- including the \"open\" part of the slicing (e.g., elements that don't fall into a slice).</p>\n<p>I've tried adding the \"slicing\" definition in the differential as well as adding the missing slices (e.g., NPI, etc) -- and nothing makes this error go away except removing the root <code>identifier</code> element.</p>",
        "id": 198935728,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590605588
    },
    {
        "content": "<p>so it means there was a but in the differential processing code. Fixed next release</p>",
        "id": 199017718,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590670464
    }
]