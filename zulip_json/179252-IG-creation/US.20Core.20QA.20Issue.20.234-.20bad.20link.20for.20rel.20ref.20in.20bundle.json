[
    {
        "content": "<p>for the example search bundle instance : <a href=\"https://build.fhir.org/ig/HL7/US-Core-R4/Bundle-c887e62f-6166-419f-8268-b5ecd6c7b901.html\">https://build.fhir.org/ig/HL7/US-Core-R4/Bundle-c887e62f-6166-419f-8268-b5ecd6c7b901.html</a></p>\n<p>source file here: <a href=\"https://github.com/HL7/US-Core-R4/blob/master/source/examples/allergyintolerance-provenance-example.json\">https://github.com/HL7/US-Core-R4/blob/master/source/examples/allergyintolerance-provenance-example.json</a></p>\n<p>I am getting this bad link error...</p>\n<div class=\"codehilite\"><pre><span></span><code>The link &#39;AllergyIntolerance/79613&#39; for &quot;AllergyIntolerance/79613&quot; cannot be resolved\n</code></pre></div>\n\n\n<p>I double checked the  rules for resolving references in bundles  reference using the <a href=\"http://build.fhir.org/bundle-references.xml.html\">bundle example </a> in the base spec and  I can't see what is wrong ...here is a snippet...</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Bundle</span>\n<span class=\"nt\">id</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">c887e62f-6166-419f-8268-b5ecd6c7b901</span>\n<span class=\"nt\">meta</span><span class=\"p\">:</span>\n  <span class=\"nt\">lastUpdated</span><span class=\"p\">:</span> <span class=\"s\">&#39;2019-07-09T18:49:01.235+00:00&#39;</span>\n<span class=\"nt\">type</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">searchset</span>\n<span class=\"nt\">total</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">1</span>\n<span class=\"nt\">link</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">relation</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">self</span>\n    <span class=\"nt\">url</span><span class=\"p\">:</span> <span class=\"p p-Indicator\">&gt;-</span>\n      <span class=\"no\">http://example.org/fhir/AllergyIntolerance?_revinclude=Provenance%3Atarget&amp;patient=Examples</span>\n<span class=\"nt\">entry</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">fullUrl</span><span class=\"p\">:</span> <span class=\"s\">&#39;http://example.org/fhir/AllergyIntolerance/79613&#39;</span>  <span class=\"c1\"># &lt;-----referenced resource here</span>\n    <span class=\"nt\">resource</span><span class=\"p\">:</span>\n      <span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">AllergyIntolerance</span>\n      <span class=\"nt\">id</span><span class=\"p\">:</span> <span class=\"s\">&#39;79613&#39;</span>\n      <span class=\"l l-Scalar l-Scalar-Plain\">...</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">fullUrl</span><span class=\"p\">:</span> <span class=\"s\">&#39;http://example.org/fhir/Provenance/79614&#39;</span>\n    <span class=\"nt\">resource</span><span class=\"p\">:</span>\n      <span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Provenance</span>\n      <span class=\"nt\">id</span><span class=\"p\">:</span> <span class=\"s\">&#39;79614&#39;</span>\n      <span class=\"l l-Scalar l-Scalar-Plain\">...</span>\n      <span class=\"nt\">target</span><span class=\"p\">:</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">reference</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">AllergyIntolerance/79613</span>  <span class=\"c1\">#&lt;--- link to resource in bundle</span>\n      <span class=\"nt\">recorded</span><span class=\"p\">:</span> <span class=\"s\">&#39;2019-07-09T15:26:23.217+00:00&#39;</span>\n    <span class=\" -Error\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">....</span>\n</code></pre></div>",
        "id": 202832426,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593805379
    },
    {
        "content": "<p>looks like it should be right</p>",
        "id": 202836192,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593809530
    },
    {
        "content": "<p>I will run in my test ig and see...</p>",
        "id": 202836396,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593809769
    },
    {
        "content": "<p>Oddly I can run <a href=\"http://hl7.org/fhir/bundle-example.html\">this example</a> and no link errors</p>\n<p>But my example above which I revalidated has the above link error as does this contained reference for this file:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">MedicationRequest</span>\n<span class=\"nt\">id</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">uscore-mo2</span>\n<span class=\"nt\">meta</span><span class=\"p\">:</span>\n  <span class=\"nt\">profile</span><span class=\"p\">:</span>\n    <span class=\"p p-Indicator\">-</span> <span class=\"s\">&#39;http://hl7.org/fhir/us/core/StructureDefinition/us-core-medicationrequest&#39;</span>\n<span class=\"nt\">contained</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">resourceType</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Medication</span>\n    <span class=\"nt\">id</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">med2</span>  <span class=\"c1\">#&lt;----</span>\n    <span class=\"nt\">code</span><span class=\"p\">:</span>\n      <span class=\"nt\">coding</span><span class=\"p\">:</span>\n        <span class=\"p p-Indicator\">-</span> <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"s\">&#39;http://www.nlm.nih.gov/research/umls/rxnorm&#39;</span>\n          <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"s\">&#39;582620&#39;</span>\n          <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"s\">&#39;Nizatidine</span><span class=\"nv\"> </span><span class=\"s\">15</span><span class=\"nv\"> </span><span class=\"s\">MG/ML</span><span class=\"nv\"> </span><span class=\"s\">Oral</span><span class=\"nv\"> </span><span class=\"s\">Solution</span><span class=\"nv\"> </span><span class=\"s\">[Axid]&#39;</span>\n      <span class=\"nt\">text</span><span class=\"p\">:</span> <span class=\"s\">&#39;Nizatidine</span><span class=\"nv\"> </span><span class=\"s\">15</span><span class=\"nv\"> </span><span class=\"s\">MG/ML</span><span class=\"nv\"> </span><span class=\"s\">Oral</span><span class=\"nv\"> </span><span class=\"s\">Solution</span><span class=\"nv\"> </span><span class=\"s\">[Axid]&#39;</span>\n<span class=\"nt\">status</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">active</span>\n<span class=\"nt\">intent</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">order</span>\n<span class=\"nt\">medicationReference</span><span class=\"p\">:</span>\n  <span class=\"nt\">reference</span><span class=\"p\">:</span> <span class=\"s\">&#39;#med2&#39;</span> <span class=\"c1\">#&lt;-----</span>\n  <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"s\">&#39;Nizatidine</span><span class=\"nv\"> </span><span class=\"s\">15</span><span class=\"nv\"> </span><span class=\"s\">MG/ML</span><span class=\"nv\"> </span><span class=\"s\">Oral</span><span class=\"nv\"> </span><span class=\"s\">Solution</span><span class=\"nv\"> </span><span class=\"s\">[Axid]&#39;</span>\n<span class=\"nt\">subject</span><span class=\"p\">:</span>\n  <span class=\"nt\">reference</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Patient/example</span>\n  <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Amy Shaw</span>\n<span class=\"nt\">authoredOn</span><span class=\"p\">:</span> <span class=\"s\">&#39;2008-04-05&#39;</span>\n<span class=\"nt\">requester</span><span class=\"p\">:</span>\n  <span class=\"nt\">reference</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">Practitioner/practitioner-1</span>\n  <span class=\"nt\">display</span><span class=\"p\">:</span> <span class=\"s\">&#39;Ronald</span><span class=\"nv\"> </span><span class=\"s\">Bone,</span><span class=\"nv\"> </span><span class=\"s\">MD&#39;</span>\n<span class=\"nt\">dosageInstruction</span><span class=\"p\">:</span>\n  <span class=\"p p-Indicator\">-</span> <span class=\"nt\">text</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">10 mL bid</span>\n    <span class=\"nt\">timing</span><span class=\"p\">:</span>\n      <span class=\"nt\">repeat</span><span class=\"p\">:</span>\n        <span class=\"nt\">boundsPeriod</span><span class=\"p\">:</span>\n          <span class=\"nt\">start</span><span class=\"p\">:</span> <span class=\"s\">&#39;2008-04-05&#39;</span>\n<span class=\"nt\">dispenseRequest</span><span class=\"p\">:</span>\n  <span class=\"nt\">numberOfRepeatsAllowed</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">1</span>\n  <span class=\"nt\">quantity</span><span class=\"p\">:</span>\n    <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">480</span>\n    <span class=\"nt\">unit</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">mL</span>\n    <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"s\">&#39;http://unitsofmeasure.org&#39;</span>\n    <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">mL</span>\n  <span class=\"nt\">expectedSupplyDuration</span><span class=\"p\">:</span>\n    <span class=\"nt\">value</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">30</span>\n    <span class=\"nt\">unit</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">days</span>\n    <span class=\"nt\">system</span><span class=\"p\">:</span> <span class=\"s\">&#39;http://unitsofmeasure.org&#39;</span>\n    <span class=\"nt\">code</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">d</span>\n</code></pre></div>\n\n\n<p>which give the following error:</p>\n<div class=\"codehilite\"><pre><span></span><code>The link &#39;#med2&#39; for &quot;Nizatidine 15 MG/ML Oral Solution [Axid]. Generated Summary: unknown resource contained&quot; cannot be resolved (valid targets: [ig-status, segment-header, publish-box, root, stripe, segment-footer, segment-post-footer, segment-navbar, segment-content, segment-breadcrumb])\n</code></pre></div>",
        "id": 202838631,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593812779
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>  Do you still have this error message, or how did you solve it/what is the reason?</p>",
        "id": 203358010,
        "sender_full_name": "Michaela Ziegler",
        "timestamp": 1594280368
    },
    {
        "content": "<p>I will need to run again in isolation to see.  will ping you after.</p>",
        "id": 203452086,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594335146
    },
    {
        "content": "<p>Yes I am still getting bad links for contained references even though there is no corresponding error in the example resource itself.</p>\n<p>Here is the repro:  <a href=\"https://github.com/Healthedata1/IG-Template4/tree/color-highlighting\">https://github.com/Healthedata1/IG-Template4/tree/color-highlighting</a></p>\n<p>the qa file is here:  <a href=\"https://github.com/Healthedata1/IG-Template4/blob/color-highlighting/docs/qa.txt\">https://github.com/Healthedata1/IG-Template4/blob/color-highlighting/docs/qa.txt</a></p>",
        "id": 203664520,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594593578
    },
    {
        "content": "<p>I did not recheck the bundle example.</p>",
        "id": 203664522,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594593599
    },
    {
        "content": "<p>so when I try to clone that repo to a new folder:</p>\n<div class=\"codehilite\"><pre><span></span><code>git.exe clone --progress -v &quot;https://github.com/Healthedata1/IG-Template4&quot; &quot;C:\\work\\org.hl7.fhir.igs\\IG-Template4&quot;\nCloning into &#39;C:\\work\\org.hl7.fhir.igs\\IG-Template4&#39;...\nPOST git-upload-pack (152 bytes)\nPOST git-upload-pack (490 bytes)\nremote: Enumerating objects: 5484, done.\nremote: Counting objects: 100% (5484/5484), done.\nremote: Compressing objects: 100% (2107/2107), done.\nremote: Total 28998 (delta 4522), reused 4123 (delta 3312), pack-reused 23514\nReceiving objects: 100% (28998/28998), 85.58 MiB | 3.09 MiB/s, done.\nResolving deltas: 100% (25047/25047), done.\nerror: invalid path &#39;my notes/201810:29-build notes&#39;\nfatal: unable to checkout working tree\nwarning: Clone succeeded, but checkout failed.\nYou can inspect what was checked out with &#39;git status&#39;\nand retry with &#39;git restore --source=HEAD :/&#39;\ngit did not exit cleanly (exit code 128) (33453 ms @ 14/07/2020 9:31:17 AM)\n</code></pre></div>",
        "id": 203783773,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594683117
    },
    {
        "content": "<p>OK I cleaned up the folder and should  work for you now.   Note that the error is reproduced in the 'color-highlighting' branch</p>",
        "id": 203792840,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594693177
    },
    {
        "content": "<p>I still get error: invalid path 'my notes/201810:29-build notes'</p>",
        "id": 204051023,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594882255
    },
    {
        "content": "<p>you can't commit a file with : in the name</p>",
        "id": 204051028,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594882261
    },
    {
        "content": "<p>OK I removed all the my_notes folders from all the branches in the repro.   so I hope is not  a problem anymore</p>",
        "id": 204138793,
        "sender_full_name": "Eric Haas",
        "timestamp": 1594931485
    },
    {
        "content": "<p>ok fixed next release</p>",
        "id": 204167710,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594957093
    },
    {
        "content": "<p>yes that fixed the contained references but still getting a bad link error to a bundle entry for a  search bundle examples for provenance target referencing the other resource in the Bundle.</p>\n<div class=\"codehilite\"><pre><span></span><code>Bundle-example1.html#/html/body/div/div/div/div/div/div/blockquote/p/a at Line 196, column 517  error   The link &#39;Procedure/1153&#39; for &quot;Procedure/1153&quot; cannot be resolved\n</code></pre></div>\n\n\n<p>It can be reproduced in the the same repro as above but in the \"add-tabs branch\": <a href=\"https://github.com/Healthedata1/IG-Template4/tree/add-tabs\">https://github.com/Healthedata1/IG-Template4/tree/add-tabs</a></p>\n<p>for this example:  <a href=\"https://github.com/Healthedata1/IG-Template4/blob/add-tabs/input/examples/bundle-example1.json\">https://github.com/Healthedata1/IG-Template4/blob/add-tabs/input/examples/bundle-example1.json</a></p>",
        "id": 204603021,
        "sender_full_name": "Eric Haas",
        "timestamp": 1595365643
    },
    {
        "content": "<p>error: invalid path 'my_notes/201810:29-build notes'</p>",
        "id": 204609095,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1595369648
    },
    {
        "content": "<p>sorry removed the folder from that branch too.</p>",
        "id": 204609667,
        "sender_full_name": "Eric Haas",
        "timestamp": 1595370078
    },
    {
        "content": "<p>This error popped up again. a relative link in the generated narrative for a bundle entry is causing a bad link error....</p>\n<p><a href=\"/user_uploads/10155/xO5Ogf3FDfjZaen6_FJodKZ-/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/xO5Ogf3FDfjZaen6_FJodKZ-/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/xO5Ogf3FDfjZaen6_FJodKZ-/image.png\"></a></div>",
        "id": 205371201,
        "sender_full_name": "Eric Haas",
        "timestamp": 1596035944
    },
    {
        "content": "<p>here is the generated output that is leading to the link error...</p>\n<p><a href=\"/user_uploads/10155/lSB98CgWmP4c3YGkaC8EAGYj/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/lSB98CgWmP4c3YGkaC8EAGYj/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/lSB98CgWmP4c3YGkaC8EAGYj/image.png\"></a></div>",
        "id": 205371278,
        "sender_full_name": "Eric Haas",
        "timestamp": 1596035980
    },
    {
        "content": "<p>how do I reproduce this?</p>",
        "id": 205405606,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596052568
    },
    {
        "content": "<p>I will create a test case and let you know</p>",
        "id": 205408662,
        "sender_full_name": "Eric Haas",
        "timestamp": 1596054046
    },
    {
        "content": "<p>this repro :  <a href=\"https://github.com/Healthedata1/IG-Template4/tree/add-tabs\">https://github.com/Healthedata1/IG-Template4/tree/add-tabs</a><br>\n has this example</p>\n<p><a href=\"/user_uploads/10155/mzff2HEQFoST4tWXf24kxKBE/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/mzff2HEQFoST4tWXf24kxKBE/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/mzff2HEQFoST4tWXf24kxKBE/image.png\"></a></div>",
        "id": 205528706,
        "sender_full_name": "Eric Haas",
        "timestamp": 1596141007
    },
    {
        "content": "<p>ok fixed</p>",
        "id": 205561610,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596176776
    }
]