[
    {
        "content": "<p>Hi -- I am trying to figure out what part IG publishing workflow is responsible for what I think is a bug.</p>\n<p>I am adding a relative link in the Description field of a StructureDefintion implemented in FSH (<a href=\"https://github.com/HL7/fhir-mCODE-ig/blob/debug-relative-link-issue/input/fsh/SD_Bundle.fsh#L5\">view on GitHub</a>:</p>\n<div class=\"codehilite\"><pre><span></span><code>Profile: MCODEPatientBundle\nParent: Bundle\nId: mcode-patient-bundle\nTitle: &quot;mCODE Patient Bundle&quot;\nDescription: &quot;A collection of data for an mCODE cancer patient. [See details here](mcode-patient-bundle.html).&quot;\n</code></pre></div>\n<p>This link appears as a relative link on <a href=\"https://build.fhir.org/ig/HL7/fhir-mCODE-ig/branches/debug-relative-link-issue/artifacts.html\"><code>artifacts.html</code></a>:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;a href=&quot;mcode-patient-bundle.html&quot;&gt;See details here&lt;/a&gt;\n</code></pre></div>\n<p>However, on the <a href=\"https://build.fhir.org/ig/HL7/fhir-mCODE-ig/branches/debug-relative-link-issue/StructureDefinition-mcode-patient-bundle.html\">StructureDefinition</a> page, the link is converted to an absolute link to <code>http://hl7.org/fhir/R4/</code>:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;tr&gt;&lt;td&gt;Definition:&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;a name=&quot;8c170834-61ce-429b-99b2-d3dbf6558d9a&quot;&gt;&lt;/a&gt;A collection of data for an mCODE cancer patient. &lt;a href=&quot;http://hl7.org/fhir/R4/mcode-patient-bundle.html&quot;&gt;See details here&lt;/a&gt;.&lt;/p&gt;\n&lt;/td&gt;&lt;/tr&gt;\n</code></pre></div>\n<p><strong>I believe the expected behavior here is a relative link</strong> (<code>&lt;a href=\"mcode-patient-bundle.html\"&gt;See details here&lt;/a&gt;</code>) on all pages where this appears in the built IG.</p>\n<p>I looked at the JSON generated by SUSHI, and it appears the Markdown link is being passed to the IG Publisher correctly:</p>\n<div class=\"codehilite\"><pre><span></span><code>fsh-generated/resources/StructureDefinition-mcode-patient-bundle.json:\n   17    &quot;title&quot;: &quot;mCODE Patient Bundle&quot;,\n   18    &quot;status&quot;: &quot;active&quot;,\n   19:   &quot;description&quot;: &quot;A collection of data for an mCODE cancer patient. [See details here](mcode-patient-bundle.html).&quot;,\n</code></pre></div>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  Does this indicate a bug with the IG Publisher? If so, does this need an issue on GitHub? If not, what else could be the culprit?</p>",
        "id": 215367185,
        "sender_full_name": "Max Masnick",
        "timestamp": 1604345606
    },
    {
        "content": "<p>I'll have to debug. I don't know why it would be interpreting the context of the link as the base specification</p>",
        "id": 215374844,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1604349311
    },
    {
        "content": "<p>Thanks, please let me know if you need any additional information to reproduce this.</p>",
        "id": 215387498,
        "sender_full_name": "Max Masnick",
        "timestamp": 1604355813
    },
    {
        "content": "<p>this doesn't happen for me. I get:</p>",
        "id": 215660512,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1604537874
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"HTML\"><pre><span></span><code><span class=\"p\">&lt;</span><span class=\"nt\">td</span><span class=\"p\">&gt;</span>\n<span class=\"p\">&lt;</span><span class=\"nt\">p</span><span class=\"p\">&gt;</span>A collection of data for an mCODE cancer patient. <span class=\"p\">&lt;</span><span class=\"nt\">a</span> <span class=\"na\">href</span><span class=\"o\">=</span><span class=\"s\">\"mcode-patient-bundle.html\"</span><span class=\"p\">&gt;</span>See details here<span class=\"p\">&lt;/</span><span class=\"nt\">a</span><span class=\"p\">&gt;</span>.<span class=\"p\">&lt;/</span><span class=\"nt\">p</span><span class=\"p\">&gt;</span>\n<span class=\"p\">&lt;/</span><span class=\"nt\">td</span><span class=\"p\">&gt;</span>\n</code></pre></div>",
        "id": 215660554,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1604537892
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I reproduced this with a completely fresh clone of the mCODE git repo and the most up-to-date publisher. The full dump from my terminal showing this is here: <a href=\"https://gist.github.com/masnick/da69d3dd925ff012214553b181124e2f\">https://gist.github.com/masnick/da69d3dd925ff012214553b181124e2f</a></p>\n<p>The key line showing the repro (at the very bottom):</p>\n<div class=\"codehilite\"><pre><span></span><code>$ cat output/StructureDefinition-mcode-patient-bundle.html | grep http://hl7.org/fhir/R4/mcode-patient-bundle.html\n &lt;tr&gt;&lt;td&gt;Definition:&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;a name=&quot;d8c1570f-1bec-486e-a44a-7c51d63774b6&quot;&gt;â€‹&lt;/a&gt;A collection of data for an mCODE cancer patient. &lt;a href=&quot;http://hl7.org/fhir/R4/mcode-patient-bundle.html&quot;&gt;See details here&lt;/a&gt;.&lt;/p&gt;\n</code></pre></div>\n<p>The CI build is also reproducing this, at least as of Monday. I believe <span class=\"user-mention\" data-user-id=\"191447\">@Mark Kramer</span> also saw this happen on his Windows computer.</p>",
        "id": 215703449,
        "sender_full_name": "Max Masnick",
        "timestamp": 1604578675
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> any luck reproducing this? We have some changes we want to merge into the mCODE IG that depend on these relative links working.</p>",
        "id": 216194315,
        "sender_full_name": "Max Masnick",
        "timestamp": 1605004846
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> sorry to bug you again...have you had any luck reproducing/fixing this?</p>",
        "id": 217395865,
        "sender_full_name": "Max Masnick",
        "timestamp": 1605876280
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> this appears to be resolved with the latest publisher. Thanks!</p>",
        "id": 217932680,
        "sender_full_name": "Max Masnick",
        "timestamp": 1606334651
    }
]