[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"215604\">@Saul Kravitz</span> and I have come across an issue relating to his <a href=\"https://github.com/saulakravitz/carin-bb/tree/saul\">carin-bb IG</a>, that to me looks like it might be related to the IG Publisher's handling of sparse differentials. When that IG is generated using SUSHI 0.13.2, the IG Publisher quits with the following error:</p>\n<div class=\"codehilite\"><pre><span></span><code>java.lang.Exception: Error generating snapshot for CARIN BB ExplanationOfBenefit Inpatient Facility(CARIN-BB-ExplanationOfBenefit-Inpatient-Facility): Unable to generate snapshot for http://hl7.org/fhir/us/carin-bb/StructureDefinition/CARIN-BB-ExplanationOfBenefit-Inpatient-Facility in C:\\Users\\nfreiter\\dev\\standardhealth\\carin-bb\\input\\profiles\\structuredefinition-CARIN-BB-ExplanationOfBenefit-Inpatient-Facility\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:4224)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3605)\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:836)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:698)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7533)\nCaused by: org.hl7.fhir.exceptions.FHIRException: Unable to generate snapshot for http://hl7.org/fhir/us/carin-bb/StructureDefinition/CARIN-BB-ExplanationOfBenefit-Inpatient-Facility in C:\\Users\\nfreiter\\dev\\standardhealth\\carin-bb\\input\\profiles\\structuredefinition-CARIN-BB-ExplanationOfBenefit-Inpatient-Facility\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:4277)\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:4222)\n        ... 4 more\nCaused by: java.lang.StringIndexOutOfBoundsException: String index out of range: -25\n        at java.lang.String.substring(String.java:1931)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.fixedPathSource(ProfileUtilities.java:2001)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:841)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:894)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:1019)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:1218)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:865)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:865)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:865)\n        at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:536)\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:4275)\n        ... 5 more\n</code></pre></div>\n\n\n<p>However, when you generate that IG using SUSHI 0.12.7, no such error appears. The only difference I can find between the StructureDefinition generated by SUSHI 0.13.2, and the StructureDefinition generated by SUSHI 0.12.7 is that the 0.12.7 output contains extra elements in the differential that have not themselves changed, but which have changed children. This was a choice we made in 0.12.7 to make differentials non-sparse. But, in 0.13.2, we rolled back this change to make the differential fully sparse per the guidance given by <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/The.20link.20.22XXX.22.20for.20.22coding.22.20cannot.20be.20resolved\">here</a>. So in this case, it <em>seems</em> to us like the sparse differential on this profile causes the IG Publisher to crash.</p>",
        "id": 201025082,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1592318468
    },
    {
        "content": "<p>can you please create a task here: <a href=\"https://github.com/HL7/fhir-ig-publisher/issues\">https://github.com/HL7/fhir-ig-publisher/issues</a> and reference the branch of your repo that demonstrates the problem, and where to find it - thanks</p>",
        "id": 201044467,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592326642
    },
    {
        "content": "<p>This is a blocker for updating the CI build of carinbb, unless I can force the CI build process to use sushi 0.12.7.... possible?  </p>\n<p><a href=\"https://github.com/HL7/fhir-ig-publisher/issues/111\">https://github.com/HL7/fhir-ig-publisher/issues/111</a></p>",
        "id": 202346197,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1593453436
    },
    {
        "content": "<p>Planning question:  Do you anticipate that this issue will be addressed this summer?<br>\n<span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 203774432,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1594675911
    },
    {
        "content": "<p>yes I do</p>",
        "id": 203774829,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594676142
    },
    {
        "content": "<p>Fixed in New IGPublisher v1.1.3?   (From release. notes, looks like the answer is no).  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> </p>\n<p>thx</p>",
        "id": 204439058,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1595259894
    },
    {
        "content": "<p>no I don't think so. Still on my todo list</p>",
        "id": 204462928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1595272138
    }
]