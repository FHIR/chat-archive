[
    {
        "content": "<p>Running a somewhat recent (Oct 1) IG publisher on a DSTU2 IG and I'm getting these errors on all my profiles:</p>\n<div class=\"codehilite\"><pre><span></span>Exception generating resource /Users/cmoesel/dev/standardhealth/shr-cli/out/fhir/guide/resources/structuredefinition-shr-simple-Observation::StructureDefinition/shr-simple-Observation: not the right kind of structure to generate schematrons for (29.0935sec)\norg.hl7.fhir.exceptions.DefinitionException: not the right kind of structure to generate schematrons for\n    at org.hl7.fhir.r4.conformance.ProfileUtilities.generateSchematrons(ProfileUtilities.java:3171)\n    at org.hl7.fhir.igtools.publisher.Publisher.generateOutputsStructureDefinition(Publisher.java:4460)\n    at org.hl7.fhir.igtools.publisher.Publisher.generateHtmlOutputs(Publisher.java:4055)\n    at org.hl7.fhir.igtools.publisher.Publisher.generate(Publisher.java:2775)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:581)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:510)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4895)\n   org.hl7.fhir.r4.conformance.ProfileUtilities.generateSchematrons(ProfileUtilities.java:3171) (29.0935sec)\n   org.hl7.fhir.igtools.publisher.Publisher.generateOutputsStructureDefinition(Publisher.java:4460) (29.0935sec)\n   org.hl7.fhir.igtools.publisher.Publisher.generateHtmlOutputs(Publisher.java:4055) (29.0935sec)\n   org.hl7.fhir.igtools.publisher.Publisher.generate(Publisher.java:2775)        (29.0935sec)\n   org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:581)         (29.0935sec)\n   org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:510)          (29.0935sec)\n   org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4895)            (29.0936sec)\n</pre></div>\n\n\n<p>It seems to work fine when generating STU3 IGs, but (obviously) not on DSTU2 IGs.  Looking at the source code it references, it appears that error is thrown when <code>structure.getDerivation() != TypeDerivationRule.CONSTRAINT</code>.  In DSTU2, <code>StructureDefinition</code> doesn't have a <code>derivation</code> element (it was added in STU3).  Might that be the problem?</p>",
        "id": 154015261,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1541187080
    },
    {
        "content": "<p>problem in my converter then - how do I reproduce this?</p>\n<p>(btw, sorry for the tardiness on this stream - I had a long weekend last week and then I've been closing out the main build)</p>",
        "id": 154017047,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1541745759
    },
    {
        "content": "<p>I'll try to get you something to reproduce.  I was out at AMIA last week, so I'm catching up as well.</p>",
        "id": 154018099,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1542133494
    },
    {
        "content": "<p>I've looked into this one further and determined the cause of the issue.  Although I was setting the <code>base</code> to the URL for the resource I was profiling, I was <em>not</em> setting the <code>constrainedType</code> to the name of the resource I was profiling.  Once I added <code>constrainedType</code>, the schematron issue went away.</p>",
        "id": 154019618,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1542648790
    },
    {
        "content": "<p>I have the same issue (in 4.0.0). I am just trying to create a datatype - a string with up to 320 characters. <br>\nAny idea on what to look for or how to fix this?</p>",
        "id": 178748535,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1571746037
    }
]