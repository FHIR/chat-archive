[
    {
        "content": "<p>In the Plan-Net IG, we want to require the meta.profile field be populated and the _profile search parameter be supported  for two reasons:</p>\n<ol>\n<li>Easier for clients, since the server attests that the data instances it is delivering conform to the Plan-Net Profiles, and its associated extensions/constraints.</li>\n<li>There are two profiles of USCore Organization -- Plannet-Network and Plannet-Organization.   If one wants to retrieve only the Networks, which is a meaningful and reasonable query, the only way to differentiate is by constraining the search to _profile=Plannet-Network unless you traverse the relationships with other instances.</li>\n</ol>\n<p>Two questions:</p>\n<ul>\n<li>Is this an appropriate and reasonable profile constraint?  (If not, why have a meta.profile field?)</li>\n<li>If so, should the constraint on meta.profile include:<ul>\n<li>only the Plan-Net profile, or</li>\n<li>the Plan-Net profile AND the underlying US-Core profile?</li>\n</ul>\n</li>\n</ul>\n<p>Thx,<br>\nSaul.    <span class=\"user-mention\" data-user-id=\"196359\">@Robert Dieterle</span></p>",
        "id": 210455639,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1600379178
    },
    {
        "content": "<p>The problems with requiring declaration are:</p>\n<ul>\n<li>if a system is already producing instances that are otherwise conformant, you're requiring them to change code in order to conform</li>\n<li>in a general space, you might not have control over the client systems and have no way to <em>make</em> them declare the profile, but still want their data (so having your system rely on its presence is going to eventually cause grief)</li>\n<li>the declaration isn't a guarantee of accuracy.  Once someone puts a fixed value profile declaration in their code, odds are at some point in the future they'll make a change that breaks compatibility but will leave the profile declaration in place - so having the profile doesn't remove the need (or the cost) of validating the instance anyhow</li>\n</ul>",
        "id": 210457529,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1600380425
    },
    {
        "content": "<p>You should <em>never</em> use profile as a way of searching for meaningful data.  If you want to know whether something is a network or organization, that must be inferrable from the data in the instance if you strip the profile declarations away.  If you can't, then your IG is non-conformant.</p>",
        "id": 210457602,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1600380481
    },
    {
        "content": "<p>I.e. you should be using an extension or some other data element to distinguish, not meta.profile</p>",
        "id": 210457665,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1600380507
    },
    {
        "content": "<p>So, if I can't require that someone populate meta.profile to declare conformance, you view it as an informational declaration of a data producer that is always optional?</p>",
        "id": 210459572,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1600381974
    },
    {
        "content": "<p>I'm not saying you <em>can't</em> require it, I'm saying it's not good practice - and it's certainly not something anyone should ever look at for semantic information.  It must always be possible to wipe all profile declarations and then redetermine them solely by validating instances against all of the possible applicable profiles.</p>",
        "id": 210460277,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1600382521
    },
    {
        "content": "<p>The automated conformance testing that some reference implementations do when the .meta.profile is populated is not the only way to get conformance testing. You can have a server that forcefully requires conformance.</p>",
        "id": 210462026,
        "sender_full_name": "John Moehrke",
        "timestamp": 1600383877
    },
    {
        "content": "<p>The trouble is the chicken-and-egg situation with respect to conformance testing. If you want to verify that a server conforms to US Core, one part of that involves testing that all labs conform to US Core Observation Lab. To do this, you query for all Observations, sort the Observations into two piles, labs and non-labs, and then run the validator on the labs. Simple! Except that....</p>\n<p>How do you determine which Observations are supposed to be labs? Sorting them requires using the information in the Observation, which is exactly what you are testing. The server may have improperly populated Observation.category or used the wrong LOINC code (or didn't use LOINC at all), so the testing software cannot identify which resources are <em>supposed to be</em> labs. </p>\n<p>If everything that the testing software identified as a lab passes validation, there still might be resources that <em>should have</em> conformed to US Core Lab, but were never identified as labs in the first place. So conformance question is undecidable.</p>\n<p>This is a normal feature of black box testing. You can never really decide if the software you're testing is 100% correct via black box testing. What Saul suggests, and many have suggested before, doesn't change this.  It only changes the scope of what you are testing, namely, if the server declares via meta.profile that \"I intend this resource to conform to US Core Lab\" then a test can easily decide if what the server <em>thinks</em> are labs do or do not conform to US Core.  </p>\n<p>Basically, conformance testing has limitations, and unless there is a out-of-band method of sorting out what is <em>intended</em> to be what, we're stuck.</p>",
        "id": 210524448,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1600438567
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191447\">@Mark Kramer</span> you appear to have the last word....</p>",
        "id": 211067054,
        "sender_full_name": "Saul Kravitz",
        "timestamp": 1600898169
    },
    {
        "content": "<p>no having the last word on this is on my to do list</p>",
        "id": 211067371,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1600898385
    },
    {
        "content": "<p>I won't have a chance until after the WGM</p>",
        "id": 211067391,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1600898399
    },
    {
        "content": "<p>The FHIR documentation requires meta.profile to be populated if the server declares it a supported profile: <br>\n\"To help a consumer find the correct set of reports for a use-case, a producer of resources also SHALL, for any profile declared in CapabilityStatement.rest.resource.supportedProfile:</p>\n<ol>\n<li>Mark resources with profile assertions documenting the profile(s) they conform to (this enables indexing by the profile)</li>\n<li>(if a server) support searching by the _profile parameter for the declared profiles<br>\nBeyond these requirements, a producer of resources SHOULD ensure that any resource instance that would reasonably be expected to conform to the declared profiles SHOULD be published in this form.\"<br>\nSee <a href=\"https://www.hl7.org/fhir/profiling.html#CapabilityStatement.rest.resource.supportedProfile\">https://www.hl7.org/fhir/profiling.html#CapabilityStatement.rest.resource.supportedProfile</a></li>\n</ol>",
        "id": 211148949,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1600961749
    },
    {
        "content": "<p>Last word regained <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 211149021,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1600961768
    },
    {
        "content": "<p>... it's not over yet</p>",
        "id": 211149225,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1600961875
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>, going back to this discussion, I see that it's not a good practice to have meta.profile as a required element for client data submission and it's not appropriate to rely on searches by a \"_profile\" parameter (even though it's a standard parameter). However, I'm wondering whether it wouldn't make sense to require a read-only server (e.g. a CARIN BB or Plan Net server) to always declare meta.profile.</p>",
        "id": 212627028,
        "sender_full_name": "Igor Sirkovich",
        "timestamp": 1602109687
    },
    {
        "content": "<p>You can certainly mandate declaring a profile</p>",
        "id": 212634653,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1602115555
    },
    {
        "content": "<p>However, that creates a cost for systems that might comply with the profile without having been custom designed for your IG.  Is that something that's even a vague possibility for compliant systems?</p>",
        "id": 212634837,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1602115720
    },
    {
        "content": "<p>Thank you Lloyd. I believe all the payers are implementing CARIN BB compliant servers and will implement the Plan Net ones next year to meet the new CMS/ONC rule, so possibly having meta.profile as required would make sense for all these implementations. <span class=\"user-mention\" data-user-id=\"215604\">@Saul Kravitz</span>, <span class=\"user-mention\" data-user-id=\"243554\">@Pat Taylor</span>, maybe some additional discussion of this requirement would be helpful.</p>",
        "id": 212688546,
        "sender_full_name": "Igor Sirkovich",
        "timestamp": 1602163521
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> The CARIN BB profiles were designed to align with claims submission data standards adopted by HHS.  The reimbursement methodologies, benefits applied and value sets are different between the profiles.  As the  source of the data is the payer and the end user of the data is a consumer, from a payer perspective, conveying data with a high degree of data quality is an important consideration.  Our preference is to require the meta.profile to be populated.  <span class=\"user-mention\" data-user-id=\"191393\">@Igor Sirkovich</span> <span class=\"user-mention\" data-user-id=\"192132\">@Amol Vyas</span> <span class=\"user-mention\" data-user-id=\"215604\">@Saul Kravitz</span></p>",
        "id": 212703788,
        "sender_full_name": "Pat Taylor",
        "timestamp": 1602169626
    }
]