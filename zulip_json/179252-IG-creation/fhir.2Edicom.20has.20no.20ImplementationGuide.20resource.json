[
    {
        "content": "<p>Hello. When we perform a dependency to fhir.dicom package, by configuring the sushi-config.yaml like this: </p>\n<div class=\"codehilite\"><pre><span></span><code>dependencies:\n  fhir.dicom:\n    uri: http://fhir.org/packages/fhir.dicom\n    version: 2021.4.20210910\n</code></pre></div>\n<p>We have a warning in the QA.html : </p>\n<div class=\"codehilite\"><pre><span></span><code>location: ImplementationGuide.dependency[1].url\nmessage: The canonical URL for an Implementation Guide must point directly to the implementation guide resource, not to the Implementation Guide as a whole\n</code></pre></div>\n<p>fhir.dicom package does not have an ImplementationGuide resource. I suppose that it makes sense, as this package contains only value sets from DICOM, and is not seen as an IG. However, I don't know how can I fix the generated warning within QA.html .</p>",
        "id": 263577885,
        "sender_full_name": "Abderrazek Boufahja",
        "timestamp": 1638537572
    },
    {
        "content": "<p>this is probably something to raise on <a class=\"stream\" data-stream-id=\"215610\" href=\"/#narrow/stream/215610-shorthand\">#shorthand</a></p>",
        "id": 263621791,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638557387
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- If the warning is in QA.html then it is coming from IG Publisher.  I'm not sure there is anything SUSHI can do about it.  I think a more generic version of the question is this:  <em>If a dependency package does not contain an ImplementationGuide resource, then what URI should be used in the primary IG's <code>dependsOn.uri</code> field (which is <code>1..1</code>)?  What the proper way to specify that dependency?</em>  This question is not specific to IGs built using FSH/SUSHI.</p>",
        "id": 263626216,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1638559640
    },
    {
        "content": "<p>oh the qa.html? I wasn't paying attention because this doesn't appear for any other package... oh and that's because the dicom package has no IG canonical URL, so you can't include a canonical URL in the reference to it.</p>",
        "id": 263626778,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638559892
    },
    {
        "content": "<p>hmm. but it's a required element. I wonder why this hasn't come up before... I'll have to investigate</p>",
        "id": 263627385,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638560204
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span>   by the way, i tried putting as a dependency the package  <a href=\"http://fhir.org/packages/fhir.dicom/2021.5.20211122/package.tgz\">http://fhir.org/packages/fhir.dicom/2021.5.20211122/package.tgz</a> and it doesn't work, i needed to use the  2021.4.20210910 to be found by sushi</p>",
        "id": 264292371,
        "sender_full_name": "Diana_Ovelgoenne",
        "timestamp": 1639052417
    },
    {
        "content": "<p>SUSHI uses <a href=\"http://packages.fhir.org\">packages.fhir.org</a> and <a href=\"http://packages2.fhir.org\">packages2.fhir.org</a>.  It looks like <a href=\"http://packages.fhir.org\">packages.fhir.org</a> doesn't have any versions of fhir.dicom on it.  <a href=\"http://packages2.fhir.org\">packages2.fhir.org</a> only lists the 2021.4.20210910 version.  See: <a href=\"https://packages2.fhir.org/packages/fhir.dicom\">https://packages2.fhir.org/packages/fhir.dicom</a></p>",
        "id": 264309783,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639060539
    },
    {
        "content": "<p>the 2021e release is fixed up now</p>",
        "id": 265772431,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640157005
    },
    {
        "content": "<blockquote>\n<blockquote>\n<p>message: The canonical URL for an Implementation Guide must point directly to the implementation guide resource, not to the Implementation Guide as a whole</p>\n</blockquote>\n</blockquote>\n<blockquote>\n<p>fhir.dicom package does not have an ImplementationGuide resource</p>\n</blockquote>\n<p>So the answer is to pretend that it does have an implementation guide e.g. </p>\n<p><code>http://fhir.org/packages/fhir.dicom/ImplementationGuide/fhir.dicom</code></p>",
        "id": 265772852,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1640157491
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- can this be generalized to <code>http://fhir.org/packages/${packageId}/ImplementationGuide/${packageId}</code> for all cases where there isn't an IG resource?  Or will the base part of the URL be different depending on the package?</p>",
        "id": 265807336,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640181315
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> ${packageId} or ${ig_id} ?</p>",
        "id": 266851314,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641324123
    },
    {
        "content": "<p>I assume <code>${package_id}</code> because if it doesn't have an IG resource, would there even be an <code>${ig_id}</code>?  (Actually, I guess in the <a href=\"https://confluence.hl7.org/display/FHIR/NPM+Package+Specification\">package spec</a> we call it <em>package name</em>).</p>",
        "id": 266852449,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641324762
    },
    {
        "content": "<p>right. I looked at the <code>id/ImplementationGuide/id</code> thing and it really looks like the /ImplementationGuide/xxx convention would expect the id of the IG.</p>",
        "id": 266853154,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1641325187
    },
    {
        "content": "<p>Yeah.  I think that's the point.  There is no IG, so we're making it up, pretending like there is one.  And as long as we pretend the way Grahame says to pretend (using that format), then the IG Publisher will go along with it.</p>",
        "id": 266854649,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641325994
    },
    {
        "content": "<p>yes</p>",
        "id": 266862768,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641330081
    },
    {
        "content": "<p>should we expect that when calling on a DICOM valueset, that the IG rendering of that has a redirect thru simplifier?</p>",
        "id": 268561034,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642608170
    },
    {
        "content": "<p>for example - <a href=\"http://build.fhir.org/ig/HL7/fhir-radiation-dose-summary-ig/StructureDefinition-modality-device.html\">http://build.fhir.org/ig/HL7/fhir-radiation-dose-summary-ig/StructureDefinition-modality-device.html</a></p>",
        "id": 268561109,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642608197
    },
    {
        "content": "<p>The Device.type is bound to the DICOM modality canonical URI; but the rendering skips thru simplifier. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 268561459,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642608334
    },
    {
        "content": "<blockquote>\n<p>&lt;/span&gt;&lt;a href=\\\"https://simplifier.net/resolve?scope=fhir.dicom@2021.4.20210910&amp;canonical=http://dicom.nema.org/medical/dicom/current/output/chtml/part16/sect_CID_33.html\\\"&gt;Modality&lt;/a&gt;</p>\n</blockquote>",
        "id": 268561968,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642608510
    },
    {
        "content": "<p>is this just an artifact of the way fhir.dicom is defined/published?</p>",
        "id": 268567644,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642610618
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191404\">@John Moehrke</span> The IG Publisher would normally figure out from the Implementation Guide resource in a package where the documentation for a specific resource lives. The <code>fhir.dicom</code> package <a href=\"https://simplifier.net/packages/fhir.dicom/2021.4.20210910/~files\">is published without one</a>. The <a href=\"https://simplifier.net/resolve?fhirVersion=R4&amp;scope=fhir.dicom@2021.5.20211122\">Simplifier resolve functionality</a> is used as a backup mechanism to find a relevant page for it.</p>",
        "id": 268601627,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642625596
    },
    {
        "content": "<p>so... it is expected? The ballot on this IG complained about this. so, we were not sure if it was expected or not... and it seems odd to do differently</p>",
        "id": 268602029,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642625798
    },
    {
        "content": "<p>that is to say.. there were comments on the ballot that complained about this.</p>",
        "id": 268602174,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642625868
    },
    {
        "content": "<p>would be good if the IG builder would decorate these links such that a copy grabs the canonical, not the simplifier redirect.</p>",
        "id": 268710234,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642692889
    },
    {
        "content": "<p>It would still be ok if simplifier redirects properly, currently it isn't working on the IG John mentioned above</p>",
        "id": 268712622,
        "sender_full_name": "Diana_Ovelgoenne",
        "timestamp": 1642693782
    },
    {
        "content": "<p>it was working</p>",
        "id": 268713885,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642694272
    },
    {
        "content": "<p>I thought it was working before. but yes you need to go to the simplifier page, and then copy the canonical from there.</p>",
        "id": 268714402,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642694428
    },
    {
        "content": "<p>this is a bug in the publisher somewhere. It should not be referring to that package as it it were a simplifier project</p>",
        "id": 269520514,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643253165
    },
    {
        "content": "<p>okay, that is what the II wg presumed.</p>",
        "id": 269595857,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643299979
    },
    {
        "content": "<p>I created an IG publisher issue - <a href=\"https://github.com/HL7/fhir-ig-publisher/issues/382\">https://github.com/HL7/fhir-ig-publisher/issues/382</a></p>",
        "id": 269596346,
        "sender_full_name": "John Moehrke",
        "timestamp": 1643300167
    },
    {
        "content": "<p>fixed next release</p>",
        "id": 269782560,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643395238
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I don't see <a href=\"#narrow/stream/179240-Announcements/topic/Dicom.20FHIR.20Package/near/270938184\">the new fhir.dicom</a> in the package feed yet: <a href=\"http://fhir.org/packages/package-feed.xml\">http://fhir.org/packages/package-feed.xml</a></p>",
        "id": 270961294,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1644231498
    },
    {
        "content": "<p>duh thanks - missed updating the package feed. Doing it now</p>",
        "id": 270974155,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644238864
    },
    {
        "content": "<p>done. thanks</p>",
        "id": 270976278,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644239965
    },
    {
        "content": "<p>I think I am noticing that I can use DICOM codeSystem, but when I try to use a DICOM valueSet I don't get a valueSet but rather I get a link to the DICOM specification. I presume this is because DICOM has used html URLs for their canonical URI for their valueSets. These canonical URL do seem to be in their valueSets in the fhir.dicom package... Is this a known problem? Should I create a sample IG that shows off the problem?</p>",
        "id": 273025446,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645658097
    },
    {
        "content": "<p>what do you mean, 'you don't get a valueset'?</p>",
        "id": 273026431,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1645658780
    },
    {
        "content": "<p>The canonical URLs that DICOM wants to use are the html pages in the spec for that value set. Are you suggesting that the resolution is failing because the canonical ends in .html?</p>",
        "id": 273029736,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1645660952
    },
    {
        "content": "<p>Elliot, i don't know. I  suspect this is true.</p>",
        "id": 273030434,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645661467
    },
    {
        "content": "<p>Grahame, I will make a sample IG that shows you what I am seeing in my bigger IGs.</p>",
        "id": 273030475,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645661500
    },
    {
        "content": "<p>Here is my test IG for DICOM codes and valuesets use - <a href=\"http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/index.html\">http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/index.html</a></p>",
        "id": 273036527,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645666291
    },
    {
        "content": "<p>github repo - <a href=\"https://github.com/JohnMoehrke/testDicom\">https://github.com/JohnMoehrke/testDicom</a></p>",
        "id": 273036539,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645666309
    },
    {
        "content": "<p>so, the dicom valueSet does seem to get used to validate a code is in that valueSet.... when that valueSet is directly called for in the profile. But call on that valueSet in your own valueSet and you just get a non-expanded valueSet that does not do validation. Further there are odd errors and warnings as indicated .</p>",
        "id": 273037059,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645666854
    },
    {
        "content": "<p>Didn't seem to matter if I had a depends on the fhir.dicom or not.</p>",
        "id": 273037279,
        "sender_full_name": "John Moehrke",
        "timestamp": 1645667078
    },
    {
        "content": "<p>FYI - The latest SUSHI 2.3.0 release will now infer an IG URL of the format <code>http://fhir.org/packages/${packageId}/ImplementationGuide/${packageId}</code> when a dependency package doesn't have its own IG resource.</p>",
        "id": 273293384,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1645828141
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I was expecting that the valuesets that dicom does have in that package would be available, but it seems they are not. See <a href=\"http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/index.html\">http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/index.html</a></p>",
        "id": 273586133,
        "sender_full_name": "John Moehrke",
        "timestamp": 1646104750
    },
    {
        "content": "<p>you really can't pay attention to http/https issues...</p>",
        "id": 273587387,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1646106124
    },
    {
        "content": "<p>fix those up and try again</p>",
        "id": 273587390,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1646106133
    },
    {
        "content": "<p>I changed the https to http. seems better, but still odd qa error</p>",
        "id": 273587871,
        "sender_full_name": "John Moehrke",
        "timestamp": 1646106829
    },
    {
        "content": "<p>the valueset pulling in the dicom modality valueset worked -- <a href=\"http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/ValueSet-JustModalitiesVS.html\">http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/ValueSet-JustModalitiesVS.html</a></p>",
        "id": 273587942,
        "sender_full_name": "John Moehrke",
        "timestamp": 1646106930
    },
    {
        "content": "<p>but binding an element to a dicom valueset, seems to bind it to a web page, not valueset. See the .modality element on this profile <a href=\"http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/StructureDefinition-JohnMoehrke.testDicom.testImage.bind.html\">http://build.fhir.org/ig/JohnMoehrke/testDicom/branches/master/StructureDefinition-JohnMoehrke.testDicom.testImage.bind.html</a></p>",
        "id": 273588006,
        "sender_full_name": "John Moehrke",
        "timestamp": 1646106987
    },
    {
        "content": "<p>what's the odd qa error?</p>",
        "id": 273588013,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1646107010
    },
    {
        "content": "<p>okay, so the ci-build doesn't throw it. my local build throws</p>\n<div class=\"codehilite\"><pre><span></span><code>    Error from server: Unable to find value set &quot;https://dicom.nema.org/medical/dicom/current/output/chtml/part16/sect_CID_29.html&quot;\n</code></pre></div>\n<p>which I double checked that I always asked for http:</p>",
        "id": 273588395,
        "sender_full_name": "John Moehrke",
        "timestamp": 1646107296
    },
    {
        "content": "<p>I guess I should clear all my caches, and try again?</p>",
        "id": 273588400,
        "sender_full_name": "John Moehrke",
        "timestamp": 1646107312
    },
    {
        "content": "<p>yes</p>",
        "id": 273588495,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1646107437
    },
    {
        "content": "<p>that error went away with flushed caches</p>",
        "id": 273588678,
        "sender_full_name": "John Moehrke",
        "timestamp": 1646107590
    }
]