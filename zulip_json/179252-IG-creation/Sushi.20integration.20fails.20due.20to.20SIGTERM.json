[
    {
        "content": "<p>Last two builds have run fine on my local system with most recent builds of SUSHI and FHIR IG Publisher.  However, the online publisher has twice failed this build.  I've also verified that SUSHI runs standalone over this project without errors.  The error report from the IG Builder is that the process exited with an exit code of 143.  That's never thrown directly by SUSHI, but matches exactly the exit code used by a shell on receiving SIGTERM (signal 15).  I'm assuming that SUSHI is given a 1 minute timeout, and that seems insufficient for it to process 143 SUSHI files.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"191899\">FHIR Bot</span> <a href=\"#narrow/stream/179297-committers.2Fnotification/topic/ig-build/near/205477612\">said</a>:</p>\n<blockquote>\n<p><strong><a href=\"https://github.com/HL7/v2-to-fhir/tree/master\">HL7/v2-to-fhir: master</a></strong> rebuilt<br>\nCommit: Rebuild w/ Proposed Extensions (kboone) <span aria-label=\"thumbs down\" class=\"emoji emoji-1f44e\" role=\"img\" title=\"thumbs down\">:thumbs_down:</span><br>\nDetails: <a href=\"http://build.fhir.org/ig/HL7/v2-to-fhir/branches/master/failure/build.log\">build logs</a> | <a href=\"http://build.fhir.org/ig/HL7/v2-to-fhir/branches/master/failure\">debug</a></p>\n</blockquote>",
        "id": 205479778,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596116641
    },
    {
        "content": "<p>Is there a way to control the SUSHI timeout from the IG configuration?</p>",
        "id": 205479879,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596116682
    },
    {
        "content": "<p>Answered that for myself, no, it is a fixed timeout.  Can you give us a way to control the timeout value in configuration so that when checking in a project with a large number of FSH files, this problem can be addressed in the project configuration.  cc: <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span>  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 205481843,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596117733
    },
    {
        "content": "<p>sounds like your fish are out of control... sure you didn't get an invasive species boom?</p>",
        "id": 205481908,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596117769
    },
    {
        "content": "<p>I just have a little automatic breeding pond ...</p>",
        "id": 205482000,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596117819
    },
    {
        "content": "<p>clearly you need a predator to keep population down. a couple of sharks or alligators.</p>",
        "id": 205482339,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596117979
    },
    {
        "content": "<p>... or a virus...</p>",
        "id": 205483454,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596118499
    },
    {
        "content": "<p>... a one minute timeout does seem to not be very sane...</p>",
        "id": 205483644,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596118602
    },
    {
        "content": "<p>Can you create a chain of sushi runs to do it?  That would require manual copying into the IG folders but the timeout wouldn't be a problem</p>",
        "id": 205485250,
        "sender_full_name": "David Pyke",
        "timestamp": 1596119347
    },
    {
        "content": "<p>a chain of lakes?</p>",
        "id": 205485293,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596119377
    },
    {
        "content": "<p>a sushi train.</p>",
        "id": 205485467,
        "sender_full_name": "David Pyke",
        "timestamp": 1596119455
    },
    {
        "content": "<p>ah, with multiple chefs filling the sushi train</p>",
        "id": 205485586,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596119521
    },
    {
        "content": "<p>Workarounds I have, but that causes challenges for other editors.  And I'd just like the software to work.</p>",
        "id": 205490632,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596121744
    },
    {
        "content": "<p>That would set a dangerous precedent</p>",
        "id": 205491226,
        "sender_full_name": "David Pyke",
        "timestamp": 1596121933
    },
    {
        "content": "<p>I'm curious <span class=\"user-mention\" data-user-id=\"191387\">@Keith Boone</span> -- how long does it take SUSHI to process your project locally?</p>",
        "id": 205493512,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1596123002
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191387\">Keith Boone</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Sushi.20integration.20fails.20due.20to.20SIGTERM/near/205479879\">said</a>:</p>\n<blockquote>\n<p>Is there a way to control the SUSHI timeout from the IG configuration?</p>\n</blockquote>\n<p>i don't think so</p>",
        "id": 205493742,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596123113
    },
    {
        "content": "<p>59 seconds.</p>",
        "id": 205497847,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596125057
    },
    {
        "content": "<p>that's close.</p>",
        "id": 205503331,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596127837
    },
    {
        "content": "<p>Yeah, and if I hammer my system or perhaps change the process priority, I'll bet I can get it to fail in Publisher in the same way.</p>",
        "id": 205503394,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596127887
    },
    {
        "content": "<p>is this an IG with lots of stuff on it?</p>",
        "id": 205503412,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596127903
    },
    {
        "content": "<p>Yeah.  FSH files for every V2 data type, message and segment being worked on in the V2-to-fhir project.</p>",
        "id": 205503510,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596127958
    },
    {
        "content": "<p>in other words, should we try<br>\na) just give it more time<br>\nb) make it configurable so that power users can still enjoy some flexibility</p>",
        "id": 205503513,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596127959
    },
    {
        "content": "<p>b please</p>",
        "id": 205503561,
        "sender_full_name": "David Pyke",
        "timestamp": 1596127984
    },
    {
        "content": "<p>a would be the simplest - i guess it's here<br>\n<a href=\"https://github.com/HL7/fhir-ig-publisher/blob/master/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java#L501\">https://github.com/HL7/fhir-ig-publisher/blob/master/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java#L501</a></p>",
        "id": 205503581,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596127999
    },
    {
        "content": "<p>if b) i'd love to help but I can't be trusted with java for that</p>",
        "id": 205503683,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596128046
    },
    {
        "content": "<p>The problem is even nastier in that if you are using SUSHI, the ig.ini that the Publisher uses is created by SUSHI, and so what's in there isn't necessarily the most up to date value, so the only recourse for me to deal with this locally is to bump the value in a CUSTOM version of publisher (and I'm now running into this problem with SANER Builds as well).</p>",
        "id": 205521120,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596136891
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191387\">Keith Boone</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Sushi.20integration.20fails.20due.20to.20SIGTERM/near/205521120\">said</a>:</p>\n<blockquote>\n<p>The problem is even nastier in that if you are using SUSHI, the ig.ini that the Publisher uses is created by SUSHI, and so what's in there isn't necessarily the most up to date value, so the only recourse for me to deal with this locally is to bump the value in a CUSTOM version of publisher (and I'm now running into this problem with SANER Builds as well).</p>\n</blockquote>\n<p>So sushi overwrites the ig.ini even if you start with one?</p>",
        "id": 205522138,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596137443
    },
    {
        "content": "<p>I think this problem is only going to get bigger - <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> I posted this on the shorthand - we should really have a better separation between what is input and output for sushi.</p>",
        "id": 205523361,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596138140
    },
    {
        "content": "<p>(i'll follow up on shorthand, this is a sushi thing)</p>",
        "id": 205523447,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1596138208
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191387\">@Keith Boone</span> -- w/ SUSHI 0.13.0 and above, if you <em>don't</em> include a <code>template</code> property in <code>config.yaml</code>, SUSHI will not generate an <code>ig.ini</code> file.  If you have a <code>fsh/ig-data/ig.ini</code> file present, SUSHI will copy that to the root folder (where IG Publisher will find it).  If you do <em>not</em> specify <code>template</code> in <code>config.yaml</code> <em>and</em> you do <em>not</em> have a <code>fsh/ig-data/ig.ini</code> file present, SUSHI will do nothing w/ ig.ini at all.  In this case, you can leave your own <code>ig.ini</code> checked into the root folder if you wish and manage it entirely yourself...  Does that address your problem or am I missing something?</p>",
        "id": 205525817,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1596139455
    },
    {
        "content": "<p>I use FSHOnly and it keeps things separate quite nicely. FSH folder only is used to create input/ conformance files. sushi does nothing else.</p>",
        "id": 205526042,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596139575
    },
    {
        "content": "<p>further the hand edited XML conformance resources I have written are in the input/resources; so there is no conflict with what sushi creates as sushi only creates things in other directories that I don't commit to github</p>",
        "id": 205526206,
        "sender_full_name": "John Moehrke",
        "timestamp": 1596139656
    },
    {
        "content": "<p>from the next release, you can create a file fsh.ini as a sibling to the fsh directory which has the following content:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">[FSH]</span>\n<span class=\"na\">timeout</span><span class=\"o\">=</span><span class=\"s\">NN</span>\n</code></pre></div>\n\n\n<p>where NN is in seconds</p>",
        "id": 205531446,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596142624
    },
    {
        "content": "<p>Completely, even if in some cases it would lead to indeterminate settings, it’s doable, just not pretty.</p>",
        "id": 205545898,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596153430
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Sushi.20integration.20fails.20due.20to.20SIGTERM/near/205531446\">said</a>:</p>\n<blockquote>\n<p>from the next release, you can create a file fsh.ini as a sibling to the fsh directory which has the following content:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">[FSH]</span>\n<span class=\"na\">timeout</span><span class=\"o\">=</span><span class=\"s\">NN</span>\n</code></pre></div>\n\n\n<p>where NN is in seconds</p>\n</blockquote>\n<p>Awesome! TY</p>",
        "id": 205545922,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596153481
    },
    {
        "content": "<p>Any clue when that release is going to get pushed out?  I've got two ballots that are depending on this (one is out of cycle, another due this week).</p>",
        "id": 205821593,
        "sender_full_name": "Keith Boone",
        "timestamp": 1596475081
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191387\">@Keith Boone</span> I managed to get this out</p>",
        "id": 205851770,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1596491752
    },
    {
        "content": "<p>Not working, see your e-mail.  Basically, it's looking for fsh.ini in the parent of the parent of the ig.ini folder, because you call getDirectoryForFile() twice, at least as best I can tell.  I'm still getting timeouts at one minute when I specify 180 seconds.</p>",
        "id": 206507284,
        "sender_full_name": "Keith Boone",
        "timestamp": 1597090085
    },
    {
        "content": "<p>what's your output look like?</p>",
        "id": 206508366,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1597090726
    }
]