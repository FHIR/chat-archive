[
    {
        "content": "<p>I am getting this warning on several search parameters...</p>\n<div class=\"codehilite\"><pre><span></span><code>SearchParameter/us-core-careplan-date: SearchParameter  warning SEARCHPARAMETER_EXP_WRONG\n</code></pre></div>\n\n\n<p>if this means the expression is wrong that is curious since the expression are identical to the corresponding base searchparameter:</p>\n<p>for example:  CarePlan patient<br>\nig version:</p>\n<div class=\"codehilite\"><pre><span></span><code>...\n  &quot;expression&quot; : &quot;CarePlan.subject.where(resolve() is Patient)&quot;,\n  &quot;xpath&quot; : &quot;f:CarePlan/f:subject&quot;,\n...\n</code></pre></div>\n\n\n<p>corresponds to the <a href=\"http://hl7.org/fhir/SearchParameter/clinical-patient\">http://hl7.org/fhir/SearchParameter/clinical-patient</a></p>",
        "id": 202634083,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593644842
    },
    {
        "content": "<p>these only seem to occur with the common SearchParameters like clinical patient</p>",
        "id": 202634197,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593644940
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> I found out why you were getting \"SEARCHPARAMETER_EXP_WRONG\". here's the errors you should be getting:</p>",
        "id": 202642857,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593654510
    },
    {
        "content": "<p>actually, there are none now that I improved the checking.</p>",
        "id": 202644254,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593656477
    },
    {
        "content": "<p>wrong:</p>",
        "id": 202644370,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593656638
    },
    {
        "content": "<ul>\n<li>The expression \"<a href=\"http://DocumentReference.id\">DocumentReference.id</a>\" is not compatible with the expression \"<a href=\"http://Resource.id\">Resource.id</a>\" in the derivedFrom SearchParameter <a href=\"http://hl7.org/fhir/SearchParameter/Resource-id\">http://hl7.org/fhir/SearchParameter/Resource-id</a>, and this likely indicates that the derivation relationship is not valid</li>\n<li>The expression \"<a href=\"http://Location.name\">Location.name</a>\" is not compatible with the expression \"<a href=\"http://Location.name\">Location.name</a> | Location.alias\" in the derivedFrom SearchParameter <a href=\"http://hl7.org/fhir/SearchParameter/Location-name\">http://hl7.org/fhir/SearchParameter/Location-name</a>, and this likely indicates that the derivation relationship is not valid</li>\n<li>The expression \"<a href=\"http://Organization.name\">Organization.name</a>\" is not compatible with the expression \"<a href=\"http://Organization.name\">Organization.name</a> | Organization.alias\" in the derivedFrom SearchParameter <a href=\"http://hl7.org/fhir/SearchParameter/Organization-name\">http://hl7.org/fhir/SearchParameter/Organization-name</a>, and this likely indicates that the derivation relationship is not valid</li>\n<li>The expression \"<a href=\"http://Patient.id\">Patient.id</a>\" is not compatible with the expression \"<a href=\"http://Resource.id\">Resource.id</a>\" in the derivedFrom SearchParameter <a href=\"http://hl7.org/fhir/SearchParameter/Resource-id\">http://hl7.org/fhir/SearchParameter/Resource-id</a>, and this likely indicates that the derivation relationship is not valid</li>\n<li>The expression \"Condition.onset.as(dateTime)\" is not compatible with the expression \"Condition.onset.as(dateTime) | Condition.onset.as(Period)\" in the derivedFrom SearchParameter <a href=\"http://hl7.org/fhir/SearchParameter/Condition-onset-date\">http://hl7.org/fhir/SearchParameter/Condition-onset-date</a>, and this likely indicates that the derivation relationship is not valid</li>\n<li>The expression \"<a href=\"http://Encounter.id\">Encounter.id</a>\" is not compatible with the expression \"<a href=\"http://Resource.id\">Resource.id</a>\" in the derivedFrom SearchParameter <a href=\"http://hl7.org/fhir/SearchParameter/Resource-id\">http://hl7.org/fhir/SearchParameter/Resource-id</a>, and this likely indicates that the derivation relationship is not valid</li>\n<li>The expression \"<a href=\"http://Location.name\">Location.name</a>\" is not compatible with the expression \"<a href=\"http://Location.name\">Location.name</a> | Location.alias\" in the derivedFrom SearchParameter <a href=\"http://hl7.org/fhir/SearchParameter/Location-name\">http://hl7.org/fhir/SearchParameter/Location-name</a>, and this likely indicates that the derivation relationship is not valid</li>\n</ul>",
        "id": 202644466,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593656758
    },
    {
        "content": "<p>thanks!</p>",
        "id": 202715223,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593709141
    },
    {
        "content": "<p>I am unclear should I still be getting errors?  because I am still getting these on my local build - deleted the FHIR cache and downloaded the latest build...</p>",
        "id": 202760841,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593739000
    },
    {
        "content": "<p>sure you should still be getting those warnings - do you think they're wrong?</p>",
        "id": 202760852,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593739044
    },
    {
        "content": "<p>to be clear I am seeing </p>\n<div class=\"codehilite\"><pre><span></span><code>SEARCHPARAMETER_EXP_WRONG\n</code></pre></div>\n\n\n<p>should I see something else?</p>",
        "id": 202760930,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593739164
    },
    {
        "content": "<p>yes you should. What version is running?</p>",
        "id": 202760935,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593739180
    },
    {
        "content": "<p>OK my downloader is not working properly</p>\n<p>I'm still on Version 1.1.0 and I'm updating from here:   </p>\n<p><a href=\"https://github.com/HL7/fhir-ig-publisher/releases/latest/download/publisher.jar\">https://github.com/HL7/fhir-ig-publisher/releases/latest/download/publisher.jar</a></p>\n<p>I thought that was the latest?</p>\n<p>or is it here  the link in the qa page: </p>\n<p><a href=\"https://storage.googleapis.com/ig-build/org.hl7.fhir.publisher.jar\">https://storage.googleapis.com/ig-build/org.hl7.fhir.publisher.jar</a></p>",
        "id": 202761249,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593739697
    },
    {
        "content": "<p>1.1.0 is the latest. <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> I do not understand why this error code is not converted - I think it must be a build/deploy problem - can you look into this? You need to run the IG publisher on the last US Core repo, which is <a href=\"https://github.com/HL7/US-Core-R4\">https://github.com/HL7/US-Core-R4</a></p>",
        "id": 202761335,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593739843
    },
    {
        "content": "<p>both of these locations have the same jar, but the second one will disappear next release (tmorrow)</p>",
        "id": 202761344,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593739865
    },
    {
        "content": "<p>OK can you update the link in the QA page then too...</p>",
        "id": 202761358,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593739890
    },
    {
        "content": "<p>yes thx</p>",
        "id": 202761423,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593739994
    },
    {
        "content": "<p>I'll look into it first thing tomorrow morning. Are there dependencies within the code that read the version number directly?</p>",
        "id": 202762607,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593741940
    },
    {
        "content": "<p>not sure what you're asking. But I think you mean can you rely on the fact that 1.1.0 is actually running? yes if the log says 1.1.10, then that's what's running for sure. See <a href=\"https://github.com/HL7/fhir-ig-publisher/blob/master/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java#L7646\">https://github.com/HL7/fhir-ig-publisher/blob/master/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java#L7646</a></p>",
        "id": 202763817,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593743925
    },
    {
        "content": "<p>...how long is this process supposed to take?</p>",
        "id": 202814520,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593789731
    },
    {
        "content": "<p>it's taking forever to run on my machine (&gt;1 hour), is this normal?</p>",
        "id": 202814568,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593789765
    },
    {
        "content": "<p>I'm getting our of memory exceptions trying to  run this end to end</p>",
        "id": 202823403,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593796363
    },
    {
        "content": "<p>I've increased the allocated memory for the jvm, but it's still not completing</p>",
        "id": 202823417,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593796380
    },
    {
        "content": "<p>going to just give it a tonne and try again</p>",
        "id": 202823565,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593796548
    },
    {
        "content": "<p>It might be good to have a record of what \"a tonne\" of memory is in this case. From what I remember, 16 GB seemed to have been plenty before, so if it's more than that it's worth mentioning.</p>",
        "id": 202825523,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1593798255
    },
    {
        "content": "<p>I'm giving it 8GB now</p>",
        "id": 202825572,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593798325
    },
    {
        "content": "<p>it's still running though</p>",
        "id": 202825578,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593798331
    },
    {
        "content": "<p>How long does it take to run on average, against the us core ig</p>",
        "id": 202825590,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593798342
    },
    {
        "content": "<p>I don't know about US Core, but when I tried to build the IPS IG using Publisher 1.1.0 for the first time, it took 3 hours and 6 min.!</p>",
        "id": 202826028,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593798738
    },
    {
        "content": "<p>Alright, so that makes sense for what I'm experiencing then</p>",
        "id": 202826052,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593798758
    },
    {
        "content": "<p>thanks</p>",
        "id": 202826053,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593798759
    },
    {
        "content": "<p>I wanted to make sure it wasn't my machine</p>",
        "id": 202826061,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593798766
    },
    {
        "content": "<p>Is the txCache not committed?</p>",
        "id": 202826094,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593798815
    },
    {
        "content": "<p>(It certainly <em>should</em> be...)</p>",
        "id": 202826101,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593798826
    },
    {
        "content": "<p>So if I want to use the tx cache, how do I modify the basic command lloyd</p>",
        "id": 202826157,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1593798851
    },
    {
        "content": "<p>it rebuilds the txcache - I still need to check the diff on it that Grahame mentioned to see what it's actually doing</p>",
        "id": 202826192,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593798891
    },
    {
        "content": "<p>Is it faster to have it rebuild the cache or wipe it and have it pull it all down again?</p>",
        "id": 202827417,
        "sender_full_name": "David Pyke",
        "timestamp": 1593800161
    },
    {
        "content": "<p>I expect that it will be about the same.  But you could take several hours to test it both ways and report back the results (actually, I am curious about that). :)</p>",
        "id": 202828618,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593801436
    },
    {
        "content": "<p>Well, my system has a few spare cycles.  Time to test it out and build USCore..</p>",
        "id": 202828718,
        "sender_full_name": "David Pyke",
        "timestamp": 1593801535
    },
    {
        "content": "<p>Sounds good.  I will mention that we shouldn't be surprised (I won't be) if your mileage does vary.  I expect that there will be some differences between IGs.</p>",
        "id": 202828836,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593801646
    },
    {
        "content": "<blockquote>\n<p>Lloyd McKenzie: Is the txCache not committed?</p>\n</blockquote>\n<p>it is indeed committed.</p>\n<p>US Core should not take 3 hrs to build even the first time.</p>",
        "id": 202829900,
        "sender_full_name": "Eric Haas",
        "timestamp": 1593802932
    },
    {
        "content": "<p>My first run (no txcache) Finished. 12:11.0582.</p>",
        "id": 202829928,
        "sender_full_name": "David Pyke",
        "timestamp": 1593802986
    },
    {
        "content": "<p>That's not bad at all (certainly in comparison to my &gt; 3 hours).</p>",
        "id": 202830053,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593803071
    },
    {
        "content": "<p>Second run was Finished. 00:53.0574.  I'm assuming I need to clear a build cache.</p>",
        "id": 202830093,
        "sender_full_name": "David Pyke",
        "timestamp": 1593803108
    },
    {
        "content": "<p>I think you need to checkout the previous set of cache files.</p>",
        "id": 202830149,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593803157
    },
    {
        "content": "<p>I'll try that</p>",
        "id": 202830198,
        "sender_full_name": "David Pyke",
        "timestamp": 1593803172
    },
    {
        "content": "<p>running with a fresh cloning</p>",
        "id": 202830276,
        "sender_full_name": "David Pyke",
        "timestamp": 1593803264
    },
    {
        "content": "<p>But it doesn't appear that you're likely to have much of a problem with US Core.  I'm not sure why Mark's experience seemed so vastly different - but we'll see how this next run goes.</p>",
        "id": 202830297,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593803279
    },
    {
        "content": "<p>run with a fresh clone: Finished. 00:52.0571.</p>",
        "id": 202830374,
        "sender_full_name": "David Pyke",
        "timestamp": 1593803324
    },
    {
        "content": "<p>That's fast.  There must be another variable.</p>",
        "id": 202830405,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593803360
    },
    {
        "content": "<p>The 3 hours was for IPS, <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>.  But it shouldn't have taken maybe more than 10-20 minutes (tops), either.</p>",
        "id": 202830418,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593803386
    },
    {
        "content": "<p>Running it again, fresh download of the publisher, just in case</p>",
        "id": 202830422,
        "sender_full_name": "David Pyke",
        "timestamp": 1593803390
    },
    {
        "content": "<p>My second build of IPS with 1.1.0, following the txcache updates, took 5 minutes.</p>",
        "id": 202830554,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1593803520
    },
    {
        "content": "<p>I think we need to chip in a buy Mark a new faster computer</p>",
        "id": 202830697,
        "sender_full_name": "David Pyke",
        "timestamp": 1593803674
    },
    {
        "content": "<p>I have noticed that validating some like  ValueSet/us-core-narrative-status takes a significant time</p>",
        "id": 202830728,
        "sender_full_name": "David Pyke",
        "timestamp": 1593803718
    },
    {
        "content": "<p>So I tried running it again over the weekend, while the computer wasn't doing anything else, and it still threw an OOM exception, despite allocating 16gb to the process... I'm going to talk with Grahame this week about it. I might be doing something incorrectly</p>",
        "id": 202985604,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1594040761
    },
    {
        "content": "<p>I don't know what you could be doing incorrectly, but it doesn't happen for me</p>",
        "id": 203029769,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594063201
    },
    {
        "content": "<p>Just as an update to everyone here, this issue was fixed yesterday, and will be in the next release of the publisher.</p>",
        "id": 203382647,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1594299956
    },
    {
        "content": "<p>PR for the fix is here: <a href=\"https://github.com/HL7/fhir-ig-publisher/pull/127\">https://github.com/HL7/fhir-ig-publisher/pull/127</a></p>",
        "id": 203383160,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1594300255
    }
]