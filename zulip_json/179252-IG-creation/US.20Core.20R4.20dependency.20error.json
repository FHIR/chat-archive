[
    {
        "content": "<p>I'm trying to create a FHIR R4-based IG with a dependency on the current build of US Core, which is also on FHIR R4. However, I keep getting the following error:</p>\n<div class=\"codehilite\"><pre><span></span>Publishing Content Failed: Unknown Package hl7.fhir.us.core#4.0.0                (18.0084sec)\nStack Dump (for debugging):                                                      (18.0085sec)\njava.lang.Exception: Unknown Package hl7.fhir.us.core#4.0.0\n    at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:1527)\n</pre></div>\n\n\n<p>My ImplementationGuide resoruce has the following:</p>\n<p>&lt;dependsOn&gt;<br>\n&lt;uri value=\"http://hl7.org/fhir/us/core\"&gt;&lt;/uri&gt;<br>\n&lt;packageId value=\"hl7.fhir.us.core\"&gt;&lt;/packageId&gt;<br>\n&lt;version value=\"current\"&gt;&lt;/version&gt;<br>\n&lt;/dependsOn&gt;</p>\n<p>And ig.json has the following:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;dependencyList&quot;: [\n    {\n        &quot;location&quot;: &quot;http://hl7.org/fhir/us/core&quot;,\n        &quot;name&quot;: &quot;uscore&quot;,\n        &quot;version&quot;: &quot;current&quot;\n    }\n]\n</pre></div>",
        "id": 157550343,
        "sender_full_name": "Rick Geimer",
        "timestamp": 1549309196
    },
    {
        "content": "<p>it's on my list to look at tomorrow. SOmething very weird is going on...</p>",
        "id": 157551021,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549309636
    },
    {
        "content": "<p>I'm getting something weird on the autobuild when I try to run US-Meds with dependency on US core version 1.1.0.</p>\n<p>Here is the ig.json :</p>\n<p>\"dependencyList\": [<br>\n    {<br>\n      \"version\": \"1.1.0\",<br>\n      \"location\": \"<a href=\"http://hl7.org/fhir/us/core\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core\">http://hl7.org/fhir/us/core</a>\",<br>\n      \"name\": \"uscore\",<br>\n      \"source\": \"dependencies/uscore-vp\"<br>\n    }<br>\n  ],<br>\nworks fine locally:</p>\n<div class=\"codehilite\"><pre><span></span>...\nLoad hl7.fhir.core-3.0.1 package from /Users/ehaas/.fhir/packages/hl7.fhir.core#3.0.1 (02.0417sec)\nLoad Terminology Cache from /Users/ehaas/Documents/FHIR/FHIR-ONC-Meds/generated_output/txCache (34.0623sec)\nConnect to Terminology Server at http://tx.fhir.org                              (34.0708sec)\n-tx cache miss: Connect to http://tx.fhir.org//r3\nLoad uscore (http://hl7.org/fhir/us/core) from hl7.fhir.us.core#1.1.0            (36.0177sec)\n...\n</pre></div>\n\n\n<p>causes this builderror on the autobuild :-)</p>\n<div class=\"codehilite\"><pre><span></span>...\nLoad hl7.fhir.core-3.0.1 package from var/lib/.fhir/packages/hl7.fhir.core#3.0.1 (16.0645sec)\nLoad Terminology Cache from /scratch/ig-build-temp-IIC1JO/repo/generated_output/txCache (26.0057sec)\nConnect to Terminology Server at http://tx.fhir.org                              (26.0059sec)\n-tx cache miss: Connect to http://tx.fhir.org//r3\nPublishing Content Failed: Unknown Package hl7.fhir.us.core#3.0.1                (26.0443sec)\n                                                                                 (26.0443sec)\nUse -? to get command line help                                                  (26.0443sec)\n                                                                                 (26.0443sec)\nStack Dump (for debugging):                                                      (26.0443sec)\njava.lang.Exception: Unknown Package hl7.fhir.us.core#3.0.1\n    at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:1527)\n    at org.hl7.fhir.igtools.publisher.Publisher.initializeFromJson(Publisher.java:1146)\n    at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:949)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:524)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4933)\nException in thread &quot;main&quot; java.lang.NullPointerException\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4943)\n...\n</pre></div>\n\n\n<p>it is looking for version 3.0.1 of US core which is curious....</p>",
        "id": 157559682,
        "sender_full_name": "Eric Haas",
        "timestamp": 1549316555
    },
    {
        "content": "<p>looks like others getting this too... hl7au/au-fhir-childhealth has a similar error.   <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> ?</p>",
        "id": 157560088,
        "sender_full_name": "Eric Haas",
        "timestamp": 1549316929
    },
    {
        "content": "<p>I'm sure what differences there are vs the local build. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> may have ideas?</p>",
        "id": 157560124,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1549316998
    },
    {
        "content": "<p>Not sure if this helps, but I just tried POSTing the ImplementationGuide resource in question to <a href=\"http://fhirtest.uhn.ca/baseR4/ImplementationGuide\" target=\"_blank\" title=\"http://fhirtest.uhn.ca/baseR4/ImplementationGuide\">http://fhirtest.uhn.ca/baseR4/ImplementationGuide</a> and got this error:</p>\n<div class=\"codehilite\"><pre><span></span>Invalid resource reference found at path[ImplementationGuide.dependsOn.uri] - Resource type is unknown or not supported on this server - http://hl7.org/fhir/us/core\n</pre></div>\n\n\n<p>So maybe this is related to the move of some of the core code to HAPI?</p>",
        "id": 157561286,
        "sender_full_name": "Rick Geimer",
        "timestamp": 1549317976
    },
    {
        "content": "<p>Was able to fix that HAPI error by changing ImplementationGuide.dependsOn.uri to <a href=\"http://hl7.org/fhir/us/core/ImplementationGuide/ig\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core/ImplementationGuide/ig\">http://hl7.org/fhir/us/core/ImplementationGuide/ig</a> (i.e. the cannonical URL of the ImplementationGuide resource vs. the cannonical URL of the implementation guide...the fact that those two things are different is sure to confuse no one at all :)</p>\n<p>But now I get the following error from the build:</p>\n<p>Fetch Package history from <a href=\"http://hl7.org/fhir/us/core/ImplementationGuide/ig/package-list.json\" target=\"_blank\" title=\"http://hl7.org/fhir/us/core/ImplementationGuide/ig/package-list.json\">http://hl7.org/fhir/us/core/ImplementationGuide/ig/package-list.json</a></p>\n<p>So seems like the build wants the cannonical URL of the implementation guide, but the ImplementationGuide resource requires a cannonical reference to another ImplementationGuide resource.</p>",
        "id": 157562238,
        "sender_full_name": "Rick Geimer",
        "timestamp": 1549318820
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 157564760,
        "sender_full_name": "Eric Haas",
        "timestamp": 1549321109
    },
    {
        "content": "<p>I don't know why it's broken. It's first thing on my list for tomorrow once I'm back working (meetings all day today)</p>",
        "id": 157600878,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549367823
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Just wondering if you were able to dig into this at all yet.</p>",
        "id": 157727565,
        "sender_full_name": "Rick Geimer",
        "timestamp": 1549488267
    },
    {
        "content": "<p>just made a commit around this right now</p>",
        "id": 157728049,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549488642
    },
    {
        "content": "<p>happy new year <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  - is this resolved now?  i am still having problems; any thing more than rebuilds needed?</p>",
        "id": 157736516,
        "sender_full_name": "Brett Esler",
        "timestamp": 1549495221
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193760\">@Shovan Roy</span>  fyi</p>",
        "id": 157736691,
        "sender_full_name": "Brett Esler",
        "timestamp": 1549495358
    },
    {
        "content": "<p>Thanks Brett. I had tried as well .. still the issue exists. Only difference I can notice is related to the error message:<br>\nPreviously: Publishing Content Failed: Unknown Package hl7.fhir.au.base#3.0.1<br>\nToday: Publishing Content Failed: Unknown Package hl7.fhir.au.base#current</p>",
        "id": 157736950,
        "sender_full_name": "Shovan Roy",
        "timestamp": 1549495623
    },
    {
        "content": "<p>just merged the fix (I think it's the fix) - give it 20min and try agin</p>",
        "id": 157737219,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549495889
    },
    {
        "content": "<p>thanks <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  it's working for me now..</p>",
        "id": 157738244,
        "sender_full_name": "Shovan Roy",
        "timestamp": 1549496836
    },
    {
        "content": "<p>good</p>",
        "id": 157738532,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549497167
    },
    {
        "content": "<p>it was a combination of two things: reporting the wrong version in the error message, and doing package resolution wrongly. The wrong error message pointed me off in the wrong direction</p>",
        "id": 157738555,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549497205
    },
    {
        "content": "<p>how do I add a formal dependency on US-Core? Who has a good example IG?</p>",
        "id": 157780056,
        "sender_full_name": "John Moehrke",
        "timestamp": 1549549493
    }
]