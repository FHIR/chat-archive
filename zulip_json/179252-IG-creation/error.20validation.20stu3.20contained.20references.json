[
    {
        "content": "<p>If I make a DocumentManifest with a contained resouce DocumentReference with referenced (also contained - in DocumentManifest) i.e. author and patient, i receive errors with the validator and/or publisher:</p>\n<p>Error @ DocumentManifest.contained[0].ofType(DocumentReference).subject (line 16, col25) : ref-1: SHALL have a contained resource if a local reference is provided ( (url: 2; ids: )) [(reference = '#') or reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))]<br>\n  Error @ DocumentManifest.contained[0].ofType(DocumentReference).author[0] (line 20, col18) : ref-1: SHALL have a contained resource if a local reference is provided ( (url: 3; ids: )) [(reference = '#') or reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))]</p>\n<p>should the actual version of publisher (1.1.76) handle this also correctly or should an older version of publisher be used for stu3? <a href=\"/user_uploads/10155/bUTvVWjokmNf5OUMSkJhVIyj/docmanifest.json\">docmanifest.json</a></p>",
        "id": 244341203,
        "sender_full_name": "Roeland Luykx",
        "timestamp": 1624997815
    },
    {
        "content": "<p>STU3 had a bug in one of the invariants that didn't handle certain contained references properly.  This was fixed in R4.  You may need to live with ignoring the error in STU3.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> thoughts?</p>",
        "id": 244344340,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1624999102
    },
    {
        "content": "<p>I don't know. is the invariant in error?</p>",
        "id": 244371066,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1625020019
    },
    {
        "content": "<p>does it have to do with the content.p[x] 1..1 stuff in stu3 in difference to R4 where content is a Reference?<br>\nthe difference of the definitions in picture (left R4, right stu3)<br>\n<a href=\"/user_uploads/10155/Vtn0TnZC8CmhjrXSQPO6UzX8/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/Vtn0TnZC8CmhjrXSQPO6UzX8/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/Vtn0TnZC8CmhjrXSQPO6UzX8/image.png\"></a></div>",
        "id": 244375959,
        "sender_full_name": "Roeland Luykx",
        "timestamp": 1625026834
    },
    {
        "content": "<p>R4 uses %rootResource.  STU3 only used %resource.</p>",
        "id": 244423339,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625059754
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179252-IG-creation/topic/error.20validation.20stu3.20contained.20references/near/244423339\">said</a>:</p>\n<blockquote>\n<p>R4 uses %rootResource.  STU3 only used %resource.</p>\n</blockquote>\n<p>so it is a definition problem in the STU3 and not in the validator functionality?</p>",
        "id": 244424560,
        "sender_full_name": "Roeland Luykx",
        "timestamp": 1625060317
    },
    {
        "content": "<p>Correct</p>",
        "id": 244433428,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625063947
    },
    {
        "content": "<p>Though we could theoretically put a patch in the validator to work around the STU3 issue.  (Not sure what the likelihood of getting a technical correction out on STU3 is at this point.)</p>",
        "id": 244433517,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625063986
    },
    {
        "content": "<p>there's a spot in the validator where it corrects some old invariants, so a patch for this could be added to the java code</p>",
        "id": 244477298,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1625082230
    },
    {
        "content": "<p>Added <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/issues/552\">https://github.com/hapifhir/org.hl7.fhir.core/issues/552</a></p>",
        "id": 244511564,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625105958
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195864\">@Roeland Luykx</span> please attach the example you were working with that demonstrated this problem to the github task that Lloyd created.</p>",
        "id": 250847297,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630015412
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> yes, i will attach the example to the issue <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/issues/552\">https://github.com/hapifhir/org.hl7.fhir.core/issues/552</a></p>",
        "id": 250886161,
        "sender_full_name": "Roeland Luykx",
        "timestamp": 1630043064
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  thanks for the fix. it seems to work now.</p>",
        "id": 252586351,
        "sender_full_name": "Roeland Luykx",
        "timestamp": 1631174594
    }
]