[
    {
        "content": "<p>I'm getting the following crash (<a href=\"http://build.fhir.org/ig/HL7/case-reporting/branches/master/failure/build.log\">http://build.fhir.org/ig/HL7/case-reporting/branches/master/failure/build.log</a>):</p>\n<div class=\"codehilite\"><pre><span></span><code>2020-11-30 10:19:11.920 [main] INFO  o.h.f.u.npm.BasePackageCacheManager [BasePackageCacheManager.java:79] Failed to resolve package hl7.fhir.r4.core#4.0.0 from server: http://packages.fhir.org\n2020-11-30 10:19:12.068 [main] INFO  o.h.f.u.npm.BasePackageCacheManager [BasePackageCacheManager.java:79] Failed to resolve package hl7.fhir.r4.core#4.0.0 from server: http://packages2.fhir.org/packages\nPublishing Content Failed: Unable to resolve package id hl7.fhir.r4.core#4.0.0   (00:21.0626)\n                                                                                 (00:21.0626)\nUse -? to get command line help                                                  (00:21.0626)\n                                                                                 (00:21.0626)\nStack Dump (for debugging):                                                      (00:21.0626)\norg.hl7.fhir.exceptions.FHIRException: Unable to resolve package id hl7.fhir.r4.core#4.0.0\n    at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.fetchTheOldWay(FilesystemPackageCacheManager.java:688)\n    at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.loadFromPackageServer(FilesystemPackageCacheManager.java:225)\n    at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.loadPackage(FilesystemPackageCacheManager.java:498)\n    at org.hl7.fhir.utilities.npm.BasePackageCacheManager.loadPackage(BasePackageCacheManager.java:166)\n    at org.hl7.fhir.igtools.publisher.Publisher.loadFromPackage(Publisher.java:2827)\n    at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:2784)\n    at org.hl7.fhir.igtools.publisher.Publisher.initializeFromIg(Publisher.java:1893)\n    at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1450)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:722)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:8397)\n</code></pre></div>\n<p>I can't see any other IGs failing like this. But I can't find any references to 4.0.0 in my code.</p>\n<p>If I run using 1.1.42 it doesn't crash. (Didn't try 1.1.43 as it sounded like there were problems with it). </p>\n<p>BUT, it does come up with this message <code>FHIR Version mismatch in package hl7.fhir.us.odh#1.0.0: version is 4.0.0 but must be 4.0.1 (path: hl7.fhir.us.ecr#1.0.0)</code>. But I look at the ODH (<a href=\"http://hl7.org/fhir/us/odh/\">http://hl7.org/fhir/us/odh/</a>) I'm pointing to and it says: \" Package hl7.fhir.us.odh#1.0.0 based on FHIR 4.0.1\".</p>",
        "id": 218271377,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606733255
    },
    {
        "content": "<p>Digging some, I'm thinking it might have something to do with this: <a href=\"https://simplifier.net/packages/hl7.fhir.us.odh/1.0.0/files/113234\">https://simplifier.net/packages/hl7.fhir.us.odh/1.0.0/files/113234</a></p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;dependencies&quot;: {\n    &quot;hl7.fhir.r4.core&quot;: &quot;4.0.0&quot;,\n</code></pre></div>\n<p>And could be a similar issue to this: <a href=\"#narrow/stream/179252-IG-creation/topic/Broken.20Package.20Dependency.20in.20PDEX.20Package\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Broken.20Package.20Dependency.20in.20PDEX.20Package</a></p>",
        "id": 218279249,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606738586
    },
    {
        "content": "<p>Is the certificate issue why this is crashing or is it something else? I am a bit stuck here.</p>",
        "id": 218330082,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606762897
    },
    {
        "content": "<p>The 4.0.0 is likely a problem regardless.  What fhirVersion is referenced in your ImplementationGuide instance?  It <em>should</em> be 4.0.1.</p>",
        "id": 218330457,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1606763045
    },
    {
        "content": "<p>There isn't a single instance of 4.0.0 in the IG. The only related 4.0.0 I can find is linked above in the ODH package on which the eCR IG is dependent.</p>",
        "id": 218331977,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606763770
    },
    {
        "content": "<p>So <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  when I remove the dependency to ODH, I don't get that crash any more.  (I do get a crash - I presume because of the certificate issue - but it passes where it made it to before: <a href=\"http://build.fhir.org/ig/HL7/case-reporting/branches/master/failure/build.log\">http://build.fhir.org/ig/HL7/case-reporting/branches/master/failure/build.log</a>)</p>\n<p>And of course, if I could get it to run to completion, I will now have multiple errors on the ODH profiles because I removed the dependency to ODH... </p>\n<p>So a bit of a catch-22. Any suggestions? </p>\n<p>(This was working a few days ago, something must have changed.)</p>",
        "id": 218344771,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606769781
    },
    {
        "content": "<p>I'm afraid this is <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> territory :(</p>",
        "id": 218347806,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1606771266
    },
    {
        "content": "<p>Here are the dependencies (and I see that I should probably point to US Core 3.1.1 in the Common Profiles Library), but it's the boxed version that I think is causing the problem:<br>\n<a href=\"/user_uploads/10155/PYk0vbhyb8v5raGIw8-orfgC/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/PYk0vbhyb8v5raGIw8-orfgC/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/PYk0vbhyb8v5raGIw8-orfgC/image.png\"></a></div>",
        "id": 218347813,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606771270
    },
    {
        "content": "<p>so the case-reporting IG runs fine for me from the master branch?</p>",
        "id": 218366650,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606782661
    },
    {
        "content": "<p>Maybe because I have commented out the dependency on ODH... Are there tons of errors around the ODH profiles?</p>",
        "id": 218366818,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606782802
    },
    {
        "content": "<p>It crashes if the dependency exists. (On the CI build and ToF anyway).</p>",
        "id": 218366853,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606782837
    },
    {
        "content": "<p>Add this back in and try it:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;dependsOn&gt;\n        &lt;uri value=&quot;http://hl7.org/fhir/us/odh/ImplementationGuide/hl7.fhir.us.odh&quot;/&gt;\n        &lt;packageId value=&quot;hl7.fhir.us.odh&quot;/&gt;\n        &lt;version value=&quot;1.0.0&quot;/&gt;\n    &lt;/dependsOn&gt;\n</code></pre></div>",
        "id": 218366919,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606782869
    },
    {
        "content": "<p>I feel like this package: <a href=\"http://packages2.fhir.org/packages/hl7.fhir.us.odh/1.0.0\">http://packages2.fhir.org/packages/hl7.fhir.us.odh/1.0.0</a> just needs updating to 4.0.1 (rather than 4.0.0).</p>",
        "id": 218366964,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606782918
    },
    {
        "content": "<p>we can't update packages.</p>",
        "id": 218367073,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606783022
    },
    {
        "content": "<p>It used to work. Like 3 days ago.</p>",
        "id": 218367114,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606783066
    },
    {
        "content": "<p>I have no idea what changed</p>",
        "id": 218367176,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606783100
    },
    {
        "content": "<p>it'll start working from the next release</p>",
        "id": 218367228,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606783151
    },
    {
        "content": "<p>hopefully this afternoon sometime</p>",
        "id": 218367234,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606783158
    },
    {
        "content": "<p>Ok thanks. Will keep the dependency out for now and try to ignore the billion errors! <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 218367395,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606783299
    },
    {
        "content": "<p>Does the latest IG publisher release fix this issue also <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ?</p>",
        "id": 218479117,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1606855656
    },
    {
        "content": "<p>yes</p>",
        "id": 218487176,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1606859523
    }
]