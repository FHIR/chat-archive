[
    {
        "content": "<p>I'm pretty sure that I know the answer to this one, but I thought I'd ask to make sure.</p>\n<p>I have two AdverseEvent profiles that differ only on the AdverseEvent.event binding.  Each profile defines a different value set for that binding.  I made the binding extensible because new vaccination or immunization-related events can be added.  By doing this, I'm pretty much guaranteed that no validator will be able to determine the proper value set, correct?  I then made them required bindings but I still get the same warning.  This time I believe it is because my value set is using MedDRA codes and the IG Publisher validator doesn't know about MedDRA so it can't determine if the code I gave it is in either value set.</p>\n<p>Assuming that the validator <em>could</em> determine that the code was valid, is this a valid way to differentiate two profiles - a required binding value set on one element?</p>",
        "id": 222620363,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1610560725
    },
    {
        "content": "<p>If the two value sets are from distinct code systems, you could slice based on system.  Slicing by value set only works if the terminology server can expand the value set</p>",
        "id": 222660921,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610579754
    },
    {
        "content": "<p>yeah, they aren't.  they are different axes of the same code system.  i was able to get it to work because there is some additional constraints that I hadn't thought of at first blush.</p>",
        "id": 222661025,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1610579805
    },
    {
        "content": "<p>I think this is a bug. We encountered a similar issue in the CG IG: <a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/qa.html\">http://build.fhir.org/ig/HL7/genomics-reporting/qa.html</a></p>",
        "id": 270964718,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644233528
    },
    {
        "content": "<p>Found multiple matching profiles for Task/usage-1a among choices: <a href=\"http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/followup-recommendation\">http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/followup-recommendation</a>, <a href=\"http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/medication-recommendation\">http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/medication-recommendation</a></p>",
        "id": 270964918,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644233645
    },
    {
        "content": "<p>These are the profiles: <a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/StructureDefinition-medication-recommendation.html\">http://build.fhir.org/ig/HL7/genomics-reporting/StructureDefinition-medication-recommendation.html</a> &amp;  <a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/StructureDefinition-followup-recommendation.html\">http://build.fhir.org/ig/HL7/genomics-reporting/StructureDefinition-followup-recommendation.html</a></p>",
        "id": 270965190,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644233844
    },
    {
        "content": "<p>both are having a different bindings to distinct Loinc answer lists.</p>",
        "id": 270965238,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644233880
    },
    {
        "content": "<p>So the validator should be able to differentiate <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 270965695,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644234176
    },
    {
        "content": "<p>It's probably worth pointing out that AdverseEvent.event (and similarly AdverseEvent.code in R5) is non-repeating.  So this is exactly the same situation, for the same reason, that we have encountered in IPS.  So you are not supposed to be able to slice on a non-repeating element.  There is a way that the validator is perfectly happy with that, though.  And I think you <strong>should</strong> be able to slice on a non-repeating element - precisely to allow a choice of different sets of constraints.  And if the discrimination is on the value set binding and the bindings are required and the value sets are completely disjoint (even if they are from the same code system) then this should work (but that's often too high a bar, and with open slicing we still run into a lot of validation \"noise\").  But, with that said, using the extension for additional bindings as discussed <a href=\"#narrow/stream/179202-terminology/topic/Extension.20for.20additional.20bindings\">here</a> may ultimately be the way to go for this.</p>",
        "id": 270979210,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1644241334
    },
    {
        "content": "<p>In the case <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> is talking about:</p>\n<ul>\n<li>We have an extension that we constrain to only be a reference to one of the two Task profiles he links above</li>\n<li>We have an example that uses this extension, and it refers to an instance of a Task with a 'meta.profile' that lists one of our profiles</li>\n<li>We get a warning on the example:</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Found multiple matching profiles for Task/usage-1a among choices: http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/medication-recommendation, http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/followup-recommendation\n</code></pre></div>\n<p>(where Task/usage-1a is a Task instance that has has 'meta.profile' of our 'medication-recommendation' profile)</p>\n<p>So I am trying to understand what this warning is telling us?</p>",
        "id": 270995269,
        "sender_full_name": "Kevin Power",
        "timestamp": 1644247981
    },
    {
        "content": "<p>It seems, that the validator isn't able to expand and match the Loinc AnswerLists.</p>",
        "id": 270998635,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644249268
    },
    {
        "content": "<p>Yes, thats the problem: <a href=\"https://tx.fhir.org/r4/ValueSet?url=http://loinc.org/vs/LL4049-4\">https://tx.fhir.org/r4/ValueSet?url=http://loinc.org/vs/LL4049-4</a> is not found</p>",
        "id": 270999093,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644249440
    },
    {
        "content": "<p>could the Loinc Answerlists be added to <a href=\"http://tx.fhir.org\">tx.fhir.org</a> ?</p>",
        "id": 270999149,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644249464
    },
    {
        "content": "<p>Yes, <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span>, I'm sure that support for the LOINC answer lists can be added to <a href=\"http://tx.fhir.org\">tx.fhir.org</a>.  I thought there was another recent request for and discussion on that, but I'm not locating anything about it at the moment.  It's just a matter of determining who will do it and when it can get done.  It might be a relatively straightforward addition to make - but I haven't tried to verify that yet.</p>",
        "id": 271005863,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1644252027
    },
    {
        "content": "<p>As these AnswerLists are already existing on the Loinc FHIR Server, i think the easiest way would be LOINC creating a answerlist package?</p>",
        "id": 271007573,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644252787
    },
    {
        "content": "<p>Maybe.  But I'm not sure that is necessary or makes the most sense, as all of the codes and relationships are in the LOINC distribution and we just need the terminology server LOINC importer tool to process and include them in the FHIR code system representation.</p>",
        "id": 271008459,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1644253170
    },
    {
        "content": "<p>good point. Is the importer tool java based? and could you point me to its source?</p>",
        "id": 271010376,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644253963
    },
    {
        "content": "<p>not java. The source you're referring to is here:</p>",
        "id": 271033383,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644263805
    },
    {
        "content": "<p><a href=\"https://github.com/HealthIntersections/fhirserver/blob/master/library/ftx/ftx_loinc_importer.pas\">https://github.com/HealthIntersections/fhirserver/blob/master/library/ftx/ftx_loinc_importer.pas</a></p>",
        "id": 271033473,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644263849
    },
    {
        "content": "<p><a href=\"http://tx.fhir.org\">tx.fhir.org</a> should support LOINC answer lists. I thought it did already</p>",
        "id": 271033511,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644263865
    },
    {
        "content": "<p>I wasn't sure how to do a query to confirm more broadly, but I did a quick look for about 5 of the 20 some LOINC answer lists we used, and none were found on <a href=\"http://tx.fhir.org\">tx.fhir.org</a></p>",
        "id": 271045357,
        "sender_full_name": "Kevin Power",
        "timestamp": 1644269819
    },
    {
        "content": "<p>No idea if I know what is going on, but is this going to be case sensitive?</p>\n<p><a href=\"https://github.com/HealthIntersections/fhirserver/blob/master/library/ftx/ftx_loinc_importer.pas#L754\">https://github.com/HealthIntersections/fhirserver/blob/master/library/ftx/ftx_loinc_importer.pas#L754</a><br>\n<a href=\"/user_uploads/10155/FgNuVp1mP8pO7KpbY3x4g9X1/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/FgNuVp1mP8pO7KpbY3x4g9X1/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/FgNuVp1mP8pO7KpbY3x4g9X1/image.png\"></a></div><p>And, does this process the downloadable files from LOINC? The answer lists seem to be in this accessory file page:<br>\n<a href=\"https://loinc.org/downloads/accessory-files/\">https://loinc.org/downloads/accessory-files/</a><br>\n<a href=\"https://loinc.org/download/loinc-answer-file/\">https://loinc.org/download/loinc-answer-file/</a></p>\n<p>When I download, this, here is what I see as the contents:<br>\n<a href=\"/user_uploads/10155/vLCnHTEAav08CswAiT7nK558/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/vLCnHTEAav08CswAiT7nK558/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/vLCnHTEAav08CswAiT7nK558/image.png\"></a></div><p>Looks like the code is looking for 'answerList.csv' but the download has 'AnswerList.csv' ? No idea if this is the problem, but I was curious enough that I had to look for a bit.</p>",
        "id": 271055056,
        "sender_full_name": "Kevin Power",
        "timestamp": 1644274244
    },
    {
        "content": "<p>Thanks for searching. Since the TX server is running on windows (unless that has changed) this should not really matter</p>",
        "id": 271056351,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644275011
    },
    {
        "content": "<p>(I think <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> can confirm or correct)</p>",
        "id": 271056382,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644275035
    },
    {
        "content": "<p>Didn't really expect it to be that easy <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 271057666,
        "sender_full_name": "Kevin Power",
        "timestamp": 1644275751
    },
    {
        "content": "<p>the import happens on windows at the moment</p>",
        "id": 271062189,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644278671
    },
    {
        "content": "<p>i checked <a href=\"http://tx.fhir.org\">tx.fhir.org</a>, i didn't find a single LL AnswerList through the ValueSet Endpoint. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> should we file a bug in the issue tracker?</p>",
        "id": 271126786,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644326935
    },
    {
        "content": "<p><a href=\"https://github.com/HealthIntersections/fhirserver/issues/184\">https://github.com/HealthIntersections/fhirserver/issues/184</a></p>",
        "id": 271182075,
        "sender_full_name": "Kevin Power",
        "timestamp": 1644350168
    },
    {
        "content": "<p>I just talked with Dan Vreeman yesterday and mentioned this - not surprisingly, it's something that he has some interest in :).  Thanks for submitting the issue <span class=\"user-mention\" data-user-id=\"191913\">@Kevin Power</span>.</p>",
        "id": 271205241,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1644361642
    },
    {
        "content": "<p>I just got this error in another IG:  Error @ Observation.component[0].code (line 40, col20): The code \"LP7386-8\" is not valid in the system <a href=\"http://loinc.org\">http://loinc.org</a>; The code provided (http://loinc.org#LP7386-8) is not valid in the value set 'EkgLeads' (from <a href=\"http://tx.fhir.org/r4\">http://tx.fhir.org/r4</a>)</p>",
        "id": 271580135,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644588001
    },
    {
        "content": "<p>It seems that LP codes aren't imported/supported at the moment. <span class=\"user-mention\" data-user-id=\"191405\">@Rob Hausam</span> do you like this as a separate Issue? OR should i add this to Kevins Issue?</p>",
        "id": 271580369,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644588059
    },
    {
        "content": "<p>I thought that they were. It should be the same issue anyway</p>",
        "id": 271623122,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644606581
    },
    {
        "content": "<p>I'm also surprised that LP code isn't showing up.  But I was able to do a $lookup on LP15099-2 (Sodium [Moles/volume] in Serum or Plasma).  I was also able to successfully $lookup LL891-3 (UA_crystals) as well as one of the answers in that list, LA12817-5 (Calcium oxalate crystals).  So this doesn't seem to be a general issue for all of the codes of a particular \"type\".</p>",
        "id": 271635037,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1644612534
    }
]