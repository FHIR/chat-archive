[
    {
        "content": "<p>Ever since I got the latest IG Publisher yesterday, I am starting to have issue and not able to build locally. The build keeps failing due to error fetching package hl7.fhir.us.core#4.1.0 from server. The Risk Adjustment IG that I am building does not even point to us.core#4.1.0 anywhere. Could this be a possible issue with the IG Publisher? Below is the error message:</p>",
        "id": 263888856,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638813160
    },
    {
        "content": "<p>2021-12-06 09:27:32.419 [main] INFO  o.h.f.u.npm.BasePackageCacheManager [BasePackageCacheManager.java:80] Failed to resolve package hl7.fhir.us.core#4.1.x from server: <a href=\"https://packages2.fhir.org/packages\">https://packages2.fhir.org/packages</a> (<a href=\"https://packages2.fhir.org/packages/hl7.fhir.us.core/4.1.x\">https://packages2.fhir.org/packages/hl7.fhir.us.core/4.1.x</a>)<br>\nPublishing Content Failed: Error fetching package directly (<a href=\"http://hl7.org/fhir/us/core/4.1.0/package.tgz\">http://hl7.org/fhir/us/core/4.1.0/package.tgz</a>), or fetching package list for hl7.fhir.us.core from <a href=\"http://hl7.org/fhir/us/core/package-list.json\">http://hl7.org/fhir/us/core/package-list.json</a>: Unable to fetch: Server returned HTTP response code: 400 for URL: <a href=\"http://hl7.org/fhir/us/core/4.1.0/package.tgz\">http://hl7.org/fhir/us/core/4.1.0/package.tgz</a> (01:02.0018)<br>\n                                                                                 (01:02.0020)<br>\nUse -? to get command line help                                                  (01:02.0021)<br>\n                                                                                 (01:02.0022)<br>\nStack Dump (for debugging):                                                      (01:02.0023)<br>\norg.hl7.fhir.exceptions.FHIRException: Error fetching package directly (<a href=\"http://hl7.org/fhir/us/core/4.1.0/package.tgz\">http://hl7.org/fhir/us/core/4.1.0/package.tgz</a>), or fetching package list for hl7.fhir.us.core from <a href=\"http://hl7.org/fhir/us/core/package-list.json\">http://hl7.org/fhir/us/core/package-list.json</a>: Unable to fetch: Server returned HTTP response code: 400 for URL: <a href=\"http://hl7.org/fhir/us/core/4.1.0/package.tgz\">http://hl7.org/fhir/us/core/4.1.0/package.tgz</a><br>\n        at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.fetchTheOldWay(FilesystemPackageCacheManager.java:722)<br>\n        at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.loadFromPackageServer(FilesystemPackageCacheManager.java:223)<br>\n        at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.loadPackage(FilesystemPackageCacheManager.java:507)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:99)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4173)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4102)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:942)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:794)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:8942)<br>\nCaused by: org.hl7.fhir.exceptions.FHIRException: Unable to fetch: Server returned HTTP response code: 400 for URL: <a href=\"http://hl7.org/fhir/us/core/4.1.0/package.tgz\">http://hl7.org/fhir/us/core/4.1.0/package.tgz</a><br>\n        at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.fetchFromUrlSpecific(FilesystemPackageCacheManager.java:525)<br>\n        at org.hl7.fhir.utilities.npm.FilesystemPackageCacheManager.fetchTheOldWay(FilesystemPackageCacheManager.java:719)<br>\n        ... 9 more</p>",
        "id": 263888879,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638813168
    },
    {
        "content": "<p>Do any of the IGs you depend on depend on US Core?</p>",
        "id": 263894571,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1638815353
    },
    {
        "content": "<p>Yes, but it is version 4.0.0 and 3.1.0, not 4.1.0</p>",
        "id": 263897582,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638816503
    },
    {
        "content": "<p>how do i reproduce this? I can't</p>",
        "id": 263934410,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638829890
    },
    {
        "content": "<p>I think it is this IG, but I haven't tried it: <a href=\"https://github.com/HL7/davinci-ra/\">https://github.com/HL7/davinci-ra/</a></p>",
        "id": 263936795,
        "sender_full_name": "Vassil Peytchev",
        "timestamp": 1638831450
    },
    {
        "content": "<p>it is, but I just cloned it and it ran without any errors</p>",
        "id": 263936819,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1638831464
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"222957\">@Dave Hill</span> ran into a similar issue recently. I can't say it is the same thing, but the same sort of issue has appeared on the CI build, but seems intermittent. Sometimes just forcing a CI rebuild fixed it. It seems challenging to track down since it is intermittent without code changes.</p>",
        "id": 263939488,
        "sender_full_name": "Corey Spears",
        "timestamp": 1638833241
    },
    {
        "content": "<p>Right. I've tried several times but I can't reproduce it and don't have any insights from the code</p>",
        "id": 263941787,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638835076
    },
    {
        "content": "<p>I tried it using another IG (the DEQM IG) and getting the same error for can't find us core 4.1.0 package. I asked Rob Reynolds to build the risk adjustment IG and he didn't get any errors, so I am not sure what's going on. I re-cloned the RA IG and it didn't help. I haven't changed anything on my end.</p>",
        "id": 264050124,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638902060
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191529\">@Corey Spears</span> how do I force a CI rebuild?</p>",
        "id": 264050699,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638902264
    },
    {
        "content": "<p>from <a href=\"https://fhir.github.io/auto-ig-builder/builds.html\">https://fhir.github.io/auto-ig-builder/builds.html</a></p>",
        "id": 264056258,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1638904355
    },
    {
        "content": "<p>Thanks Lynn. I will give it a try.</p>",
        "id": 264058994,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638905564
    },
    {
        "content": "<p>Well, forcing a CI rebuild did not resolve the issue, but I figured out a way to fix it. I manually downloaded the us core 4.1.0 package and added to the  cache package-client folder and I am now able to build. However, I have no idea why the build is asking to download us core 4.1.0 package because it is not called anywhere in the IG. Maybe something hidden somewhere is causing the issue? I guess besides the IG Publisher update, the other potential variable that I can think about is that I did notice that US Core build site was last generated on 12/6 and that was the same date when I began to encounter this build issue.</p>",
        "id": 264075975,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638912963
    },
    {
        "content": "<p>actually the date was 12/5 when I started to see the issue, and US Core had a build that date too.</p>",
        "id": 264076182,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638913073
    },
    {
        "content": "<p>I can't understand why you haev to download the package manually, when it should just download automatically and it does for most people</p>",
        "id": 264085761,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638917772
    },
    {
        "content": "<p>and I can't test. I'm wondering whether you have a caching issue - a corporate web proxy that's screwing it up</p>",
        "id": 264085963,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638917895
    },
    {
        "content": "<p>All other packages are downloaded automatically. But for some reason the publisher/build is looking for us.core.4.1.0 package and failing to download it. The problem is that the RA IG is not even using version 4.1.0 and I can't figure out why the build is even trying to download 4.1.0. I never had this problem before and I haven't changed any environment settings.</p>",
        "id": 264089357,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638919779
    },
    {
        "content": "<p>4.1.0 was published, and all US realm guides look in the lastest US Core to see that the conform</p>",
        "id": 264089712,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638919930
    },
    {
        "content": "<p>Thanks Grahame, that explains why it tries to look for 4.1.0, but it is weird that this is the only package that doesn't download automatically for me.</p>",
        "id": 264099284,
        "sender_full_name": "Yan Heras",
        "timestamp": 1638926483
    },
    {
        "content": "<p>Is it appropriate that all US realm guides are checked against a yet to be balloted version of US Core? It does not seem that ballot versions should be looked at for conformance unless the IG is specifically dependent on that version. Just  before going to ballot QA review I got a surprised new warning that my IG was not conformant to a brand new profile that was first created less than a month ago.</p>",
        "id": 264115846,
        "sender_full_name": "Corey Spears",
        "timestamp": 1638943770
    },
    {
        "content": "<p>well, I don't think that should be a problem from a process point of view. I don't think we'd say something couldn't ballot because of a warning like that. And it's better to know earlier than later</p>",
        "id": 264116057,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638944039
    },
    {
        "content": "<p>I am getting this error now after loading latest IG pub and running the US Core CI Build locally.  Deleting caches and trying again...</p>",
        "id": 268299453,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642441997
    },
    {
        "content": "<p>no dice getting:</p>\n<div class=\"codehilite\"><pre><span></span><code>Validating Conformance Resources                                                 (02:26.0939)\nPublishing Content Failed: Server returned HTTP response code: 400 for URL: https://hl7.org/fhir/us/core/package-list.json?nocache=1642442621598 (03:09.0101)\n                                                                                 (03:09.0105)\nUse -? to get command line help                                                  (03:09.0107)\n                                                                                 (03:09.0110)\nStack Dump (for debugging):                                                      (03:09.0115)\njava.io.IOException: Server returned HTTP response code: 400 for URL: https://hl7.org/fhir/us/core/package-list.json?nocache=1642442621598\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n    at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:488)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1963)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1958)\n    at java.base/java.security.AccessController.doPrivileged(Native Method)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getChainedException(HttpURLConnection.java:1957)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1525)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1509)\n    at java.base/sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:245)\n    at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:150)\n    at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:108)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:199)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)\n    at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4190)\n    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4119)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:947)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:798)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9033)\nCaused by: java.io.IOException: Server returned HTTP response code: 400 for URL: https://hl7.org/fhir/us/core/package-list.json?nocache=1642442621598\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1913)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1509)\n    at java.base/java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:527)\n    at java.base/sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:329)\n    at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:136)\n    ... 9 more\n</code></pre></div>",
        "id": 268300846,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642442851
    },
    {
        "content": "<p>trying the CI build....</p>",
        "id": 268301172,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642443058
    },
    {
        "content": "<p>what version?</p>",
        "id": 268308610,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642448261
    },
    {
        "content": "<p>works with CI Build... I 'll run locally once more to make sure....</p>",
        "id": 268328299,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642465356
    },
    {
        "content": "<p>FHIR IG Publisher Version 1.1.97 (Git# 32b147b5e630). Built 2022-01-18T00:06:35.489Z (17 mins old)</p>",
        "id": 268328395,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642465446
    },
    {
        "content": "<p>deleted entire local cache but still same error locally,  any more suggestions to get this to build locally?</p>",
        "id": 268330699,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642467909
    },
    {
        "content": "<p>can you access <a href=\"https://hl7.org/fhir/us/core/package-list.json\">https://hl7.org/fhir/us/core/package-list.json</a> in your browser?</p>",
        "id": 268332650,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642469780
    },
    {
        "content": "<p>yes</p>",
        "id": 268337955,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642475248
    },
    {
        "content": "<p>hmm. strange...</p>",
        "id": 268338973,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642476525
    },
    {
        "content": "<p>I can't think how to investigate. <span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> have you got any ideas - why would accessing this URL in java get a 400 in Java on one particular computer and not others?</p>",
        "id": 268339069,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642476608
    },
    {
        "content": "<p>Eric, what Java version are you running? On what OS?</p>",
        "id": 268339072,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642476619
    },
    {
        "content": "<p>MacOS Mojave,</p>\n<div class=\"codehilite\"><pre><span></span><code>ERICS-AIR-2:US-Core-R4 ehaas$ java --version\njava 10.0.2 2018-07-17\nJava(TM) SE Runtime Environment 18.3 (build 10.0.2+13)\nJava HotSpot(TM) 64-Bit Server VM 18.3 (build 10.0.2+13, mixed mode)\n</code></pre></div>",
        "id": 268346542,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642485293
    },
    {
        "content": "<p>From Eric's description, the first thing I'd be checking is whether or not Java 18 is the culprit. It shouldn't be, but it happens. What steps would I have to follow to replicate ?</p>\n<p>From the code on <a href=\"https://github.com/HL7/davinci-ra/\">https://github.com/HL7/davinci-ra/</a> I believe I would run <a href=\"http://_updatePublisher.sh\">_updatePublisher.sh</a> and then <a href=\"http://_genonce.sh\">_genonce.sh</a>. Is this correct?</p>",
        "id": 268398454,
        "sender_full_name": "David Otasek",
        "timestamp": 1642516281
    },
    {
        "content": "<p>I got the same error as Eric when I used 1.1.95 last Friday. I switched back to an older version 1.1.90 that I have locally and it builds no problem. I also tried cleaning the cache and didn't work.</p>",
        "id": 268437742,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642531677
    },
    {
        "content": "<p>The error is with building locally with 1.1.95. After I build locally with 1.1.90 it commits fine in the CI build.</p>",
        "id": 268437905,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642531745
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> yes, if you use davinci-ra. I used _genonce.bat, but I think .sh gives the same issue.</p>",
        "id": 268438203,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642531868
    },
    {
        "content": "<p>This is the Jira version I use: <br>\njava version \"1.8.0_221\"<br>\nJava(TM) SE Runtime Environment (build 1.8.0_221-b11)<br>\nJava HotSpot(TM) 64-Bit Server VM (build 25.221-b11, mixed mode)</p>",
        "id": 268438476,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642531990
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> run it in docker instead ... then all your environment variables stays the same</p>",
        "id": 268438699,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1642532089
    },
    {
        "content": "<p>eg.: <code>rm -rf output &amp;&amp; rm -rf temp/ &amp;&amp; docker run -v $(pwd):/home/publisher/ig hl7fhir/ig-publisher-base:latest /bin/bash -c \"cd /home/publisher/ig &amp;&amp; ./_updatePublisher.sh -y -f &amp;&amp; ./_genonce.sh -Xms1G -Xmx4G\"</code></p>",
        "id": 268438775,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1642532129
    },
    {
        "content": "<p>And your Java version, Jekyll version and what-not-version also stays the same</p>",
        "id": 268438930,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1642532180
    },
    {
        "content": "<p>Not much luck replicating here. I'm running <a href=\"http://_genonce.sh\">_genonce.sh</a> locally without exceptions.</p>\n<p>I've also tried replicating <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> 's failure with a unit test using the latest FHIR core build. The query is pretty straightforward, and no version of Java appears to have trouble with it.  There is no change in that area of the code that should impact that query.</p>\n<p>Still investigating.</p>",
        "id": 268460832,
        "sender_full_name": "David Otasek",
        "timestamp": 1642542637
    },
    {
        "content": "<p>I made a branch of davinci-ra with additional http logging: <a href=\"https://github.com/dotasek/davinci-ra/tree/http-debug\">https://github.com/dotasek/davinci-ra/tree/http-debug</a></p>\n<p>If you pull this and run <a href=\"http://_genonce.sh\">_genonce.sh</a>, it should produce a davinci-http.log file in your home folder that we may be able to analyze to get more information on why this is failing on your configuration.</p>",
        "id": 268470951,
        "sender_full_name": "David Otasek",
        "timestamp": 1642548169
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span>  can you send me your old ig-pub version? ( I wiped my trashcan :-( )</p>",
        "id": 268471651,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642548596
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> just sent you via skype. Too big to send through email.</p>",
        "id": 268472563,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642549222
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> I just run the build using your branch. I can't find the davinci-http.log file.</p>",
        "id": 268473152,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642549706
    },
    {
        "content": "<p>I am still getting the error message: Validating Conformance Resources                                                 (00:46.0975)<br>\nPublishing Content Failed: Server returned HTTP response code: 400 for URL: <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1642549543032\">https://hl7.org/fhir/us/core/package-list.json?nocache=1642549543032</a> (00:52.0750)<br>\n                                                                                 (00:52.0751)<br>\nUse -? to get command line help                                                  (00:52.0752)<br>\n                                                                                 (00:52.0752)<br>\nStack Dump (for debugging):                                                      (00:52.0753)<br>\njava.io.IOException: Server returned HTTP response code: 400 for URL: <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1642549543032\">https://hl7.org/fhir/us/core/package-list.json?nocache=1642549543032</a><br>\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)<br>\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)<br>\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)<br>\n        at java.lang.reflect.Constructor.newInstance(Unknown Source)<br>\n        at sun.net.www.protocol.http.HttpURLConnection$10.run(Unknown Source)<br>\n        at sun.net.www.protocol.http.HttpURLConnection$10.run(Unknown Source)<br>\n        at java.security.AccessController.doPrivileged(Native Method)<br>\n        at sun.net.www.protocol.http.HttpURLConnection.getChainedException(Unknown Source)<br>\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(Unknown Source)<br>\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)<br>\n        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(Unknown Source)<br>\n        at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:150)<br>\n        at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:108)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:199)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4190)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4119)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:947)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:798)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9079)<br>\nCaused by: java.io.IOException: Server returned HTTP response code: 400 for URL: <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1642549543032\">https://hl7.org/fhir/us/core/package-list.json?nocache=1642549543032</a><br>\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(Unknown Source)<br>\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)<br>\n        at java.net.HttpURLConnection.getResponseCode(Unknown Source)<br>\n        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(Unknown Source)<br>\n        at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:136)<br>\n        ... 9 more</p>",
        "id": 268473166,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642549721
    },
    {
        "content": "<p>using 1.1.97 and on Windows 10</p>",
        "id": 268473231,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642549785
    },
    {
        "content": "<p>I can confirm that switching back to an older version 1.1.90  builds locally with no problem.  (thanks <span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span> )</p>",
        "id": 268475943,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642551693
    },
    {
        "content": "<p>Despite the fact that the http error does not seem to indicate this would be the issue and I can fetch them in my browser, Could the  content of the package-list file be causing the problem?   The uscore package-list files contain large markdown files that have caused Grahame headaches in the past.</p>",
        "id": 268476373,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642552036
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> I can definitely check if the file size is an issue, but a 400 error would indicate that something is wrong with the request, not the response.</p>\n<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span> Try pulling the latest change I did on that branch; the <code>davinci-http.log</code> log file should now appear in your davinci-ra project after a run. You can also verify that there is a <code>logging.properties</code> file in that directory, as that will ensure you are on the right branch.</p>",
        "id": 268548298,
        "sender_full_name": "David Otasek",
        "timestamp": 1642603100
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> . Here is the generated davinci-http.log file. <a href=\"/user_uploads/10155/Z70-71ToSbSH4axpS_uQfXbl/davinci-http.log\">davinci-http.log</a></p>",
        "id": 268575402,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642613559
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span> Here's something you could follow up on, based on that log:</p>\n<p>I found this description of the failure:</p>\n<div class=\"codehilite\"><pre><span></span><code>FINE: sun.net.www.MessageHeader@1000d54d6 pairs: {null: HTTP/1.1 400 Bad Request}{Content-Type: text/html; charset=us-ascii}{Server: Microsoft-HTTPAPI/2.0}{Date: Wed, 19 Jan 2022 17:28:57 GMT}{Connection: close}{Content-Length: 339}\n</code></pre></div>\n<p>The key there may be the server field: `Microsoft-HTTPAPI/2.0. A quick google led me to this, which indicates that it could be something locally configured that's blocking the request. </p>\n<p><a href=\"https://stackoverflow.com/questions/35277668/get-request-to-iis-returns-microsoft-httpapi-2-0\">https://stackoverflow.com/questions/35277668/get-request-to-iis-returns-microsoft-httpapi-2-0</a></p>",
        "id": 268589250,
        "sender_full_name": "David Otasek",
        "timestamp": 1642619544
    },
    {
        "content": "<p>This is new territory for me, so I have no immediate answer.</p>",
        "id": 268589290,
        "sender_full_name": "David Otasek",
        "timestamp": 1642619569
    },
    {
        "content": "<p>The first answer on that thread suggests taking a look in the config for the HTTP.sys service, which can be found in the windows registry under <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\HTTP\\Parameters</code></p>\n<p>I will try to replicate this on one of my Windows boxes, but my result may vary (I still need to set up Jekyll/Ruby/etc).</p>",
        "id": 268590586,
        "sender_full_name": "David Otasek",
        "timestamp": 1642620130
    },
    {
        "content": "<p>If you can find that config, maybe I can compare it with my default.</p>",
        "id": 268590647,
        "sender_full_name": "David Otasek",
        "timestamp": 1642620168
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> I will look for the config. It is strange though that the older version 1.1.90 builds just fine.</p>",
        "id": 268718726,
        "sender_full_name": "Yan Heras",
        "timestamp": 1642696071
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span></p>",
        "id": 268718837,
        "sender_full_name": "David Otasek",
        "timestamp": 1642696098
    },
    {
        "content": "<p>What I suspect triggered it is the migration to https for that particular endpoint. https should not be a problem (hence why I can't replicate), but it looks like we hit an edge case here.</p>",
        "id": 268720165,
        "sender_full_name": "David Otasek",
        "timestamp": 1642696640
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span>  let me know if it works.  then I can figure out for mac os</p>",
        "id": 268724756,
        "sender_full_name": "Eric Haas",
        "timestamp": 1642698512
    },
    {
        "content": "<p>this does sound like a proxy issue, and we will continue to migrating to https across the board, so I guess this will come up for others</p>",
        "id": 269520385,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643253029
    },
    {
        "content": "<p>I can verify that this works for me on Windows, and the multi-platform test I created here appears to indicate it works across all the OS's in our core build: <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/718\">https://github.com/hapifhir/org.hl7.fhir.core/pull/718</a></p>",
        "id": 269628513,
        "sender_full_name": "David Otasek",
        "timestamp": 1643313277
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 269799634,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643402604
    },
    {
        "content": "<p>is this in the right topic?</p>",
        "id": 269799847,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643402704
    },
    {
        "content": "<p>oops :-)</p>",
        "id": 269815943,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643411236
    },
    {
        "content": "<p>The latest version of the publisher still does not work locally for me and I continue to use an old version of the publisher.  What do I need to do?</p>",
        "id": 269837634,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643430824
    },
    {
        "content": "<p>well, you could start by saying why it doesn't work locally</p>",
        "id": 269841785,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643435371
    },
    {
        "content": "<p>The reasons are documented in the thread above.</p>",
        "id": 269844839,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643439127
    },
    {
        "content": "<p>so you can fetch <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1642442621598\">https://hl7.org/fhir/us/core/package-list.json?nocache=1642442621598</a> in your browser?</p>",
        "id": 269887482,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643488904
    },
    {
        "content": "<p>yep...</p>\n<p><a href=\"/user_uploads/10155/LhoJmkHmesJEkOMxEx3myS78/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/LhoJmkHmesJEkOMxEx3myS78/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/LhoJmkHmesJEkOMxEx3myS78/image.png\"></a></div>",
        "id": 270068235,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643649353
    },
    {
        "content": "<p>once again same error when run ig-pub:</p>\n<div class=\"codehilite\"><pre><span></span><code>java -jar /Users/ehaas/Downloads/org.hl7.fhir.igpublisher.jar -ig ig.ini -tx http://tx.fhir.org\nFHIR IG Publisher Version 1.1.97 (Git# 32b147b5e630). Built 2022-01-18T00:06:35.489Z (13 days old)\nDetected Java version: 10.0.2 from /Library/Java/JavaVirtualMachines/jdk-10.0.2.jdk/Contents/Home on Mac OS X/x86_64 (64bit). 2048MB available\ndir = /Users/ehaas/Documents/FHIR/Davinci-CDEX, path = /Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/opt/ruby/bin:/usr/local/opt/ruby/bin:/Library/Frameworks/Python.framework/Versions/3.7/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/Ant-1.10.5/bin:/opt/X11/bin:/Users/ehaas/.rvm/bin\nParameters: -ig ig.ini -tx http://tx.fhir.org\nStart Clock @ Monday, January 31, 2022 at 9:21:36 AM Pacific Standard Time (2022-01-31T09:21:36-08:00)\n\nAPI keys loaded from /Users/ehaas/fhir-api-keys.ini                              (00:00.0152)\nPackage Cache: /Users/ehaas/.fhir/packages                                       (00:00.0165)\nLoad Template from hl7.davinci.template#current                                  (00:03.0572)\n Load Template from hl7.fhir.template#current                                    (00:06.0266)\n  Load Template from hl7.base.template#current                                   (00:06.0322)\n   Load Template from fhir.base.template#current                                 (00:06.0454)\n\nonLoad.findSpreadsheets:\n\nonLoad.updateIg:\n     [xslt] Processing /Users/ehaas/Documents/FHIR/Davinci-CDEX/template/onLoad-ig-working.xml to /Users/ehaas/Documents/FHIR/Davinci-CDEX/template/onLoad-ig-updated.xml\n     [xslt] Loading stylesheet /Users/ehaas/Documents/FHIR/Davinci-CDEX/template/scripts/onLoad.xslt\n\nonLoad.extend:\n\nonLoad:\nRoot directory: /Users/ehaas/Documents/FHIR/Davinci-CDEX                         (00:14.0135)\nCore Package hl7.fhir.r4.core#4.0.1\nTerminology Cache is at /Users/ehaas/Documents/FHIR/Davinci-CDEX/input-cache/txcache. 5 files in cache (00:28.0317)\nConnect to Terminology Server at http://tx.fhir.org                              (00:28.0360)\nLoad Package hl7.fhir.pubpack#0.0.9\nLoad Package hl7.fhir.xver-extensions#0.0.8\nLoad Package hl7.terminology.r4#3.0.0\nLoad Package hl7.fhir.us.core#3.1.1\nLoad Package hl7.fhir.us.core#3.1.0\nLoad Package hl7.fhir.us.davinci-hrex#0.2.0\nLoad Package hl7.fhir.us.davinci-pas#1.0.0\nInitialization complete                                                          (00:40.0406)\nFetch http://hl7.org/fhir/us/davinci-cdex/package-list.json for version check    (00:40.0413)\nLoad Content                                                                     (00:40.0753)\nloadPrePages from FetchedFile[/Users/ehaas/Documents/FHIR/Davinci-CDEX/input/includes] as /Users/ehaas/Documents/FHIR/Davinci-CDEX/input/includes\nloadPrePages from FetchedFile[/Users/ehaas/Documents/FHIR/Davinci-CDEX/fsh-generated/includes] as /Users/ehaas/Documents/FHIR/Davinci-CDEX/fsh-generated/includes\nloadPrePages from FetchedFile[/Users/ehaas/Documents/FHIR/Davinci-CDEX/input/data] as /Users/ehaas/Documents/FHIR/Davinci-CDEX/input/data\nloadPrePages from FetchedFile[/Users/ehaas/Documents/FHIR/Davinci-CDEX/input/intro-notes] as /Users/ehaas/Documents/FHIR/Davinci-CDEX/input/intro-notes\nloadPrePages from FetchedFile[/Users/ehaas/Documents/FHIR/Davinci-CDEX/input/pagecontent] as /Users/ehaas/Documents/FHIR/Davinci-CDEX/input/pagecontent\nProcessing Conformance Resources                                                 (00:41.0933)\nGenerating Snapshots                                                             (00:42.0554)\nGenerating Narratives                                                            (00:42.0775)\nValidating Conformance Resources                                                 (01:07.0590)\nPublishing Content Failed: Server returned HTTP response code: 400 for URL: https://hl7.org/fhir/us/core/package-list.json?nocache=1643649769086 (01:11.0061)\n                                                                                 (01:11.0064)\nUse -? to get command line help                                                  (01:11.0065)\n                                                                                 (01:11.0066)\nStack Dump (for debugging):                                                      (01:11.0067)\njava.io.IOException: Server returned HTTP response code: 400 for URL: https://hl7.org/fhir/us/core/package-list.json?nocache=1643649769086\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n    at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:488)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1963)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection$10.run(HttpURLConnection.java:1958)\n    at java.base/java.security.AccessController.doPrivileged(Native Method)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getChainedException(HttpURLConnection.java:1957)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1525)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1509)\n    at java.base/sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:245)\n    at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:150)\n    at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:108)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:199)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)\n    at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4190)\n    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4119)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:947)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:798)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9079)\nCaused by: java.io.IOException: Server returned HTTP response code: 400 for URL: https://hl7.org/fhir/us/core/package-list.json?nocache=1643649769086\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1913)\n    at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1509)\n    at java.base/java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:527)\n    at java.base/sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:329)\n    at org.hl7.fhir.utilities.SimpleHTTPClient.get(SimpleHTTPClient.java:136)\n    ... 9 more\n=== rename the input/_fsh folder to input/fsh  ===\nERICS-AIR-2:Davinci-CDEX ehaas$\n</code></pre></div>",
        "id": 270070825,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643650303
    },
    {
        "content": "<p>you didn't answer my question - can you access that in a browser?</p>",
        "id": 270095022,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643659131
    },
    {
        "content": "<p>yes</p>",
        "id": 270131289,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643675618
    },
    {
        "content": "<p>well, next version of the publisher will include some more debugging. This is obviously a proxy issue, but I don't have any idea what the issue is</p>",
        "id": 270135062,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643677856
    },
    {
        "content": "<p>try again with 1.1.98</p>",
        "id": 270162263,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643699649
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Is.20this.20an.20IG.20Publisher.20issue.3F/near/270162263\">said</a>:</p>\n<blockquote>\n<p>try again with 1.1.98</p>\n</blockquote>\n<p>I tracked down what causes this error.   When our friend the Implementation Guide resource has an id that begins with \"<a href=\"http://hl7.fhir.us\">hl7.fhir.us</a>.\" you get this error at the \"Validating Conformance Resources\" step.  For example:</p>\n<p>This will throw and error:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">resourceType</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">ImplementationGuide</span><span class=\"w\"></span>\n<span class=\"nt\">id</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">hl7.fhir.us.healthedata1-sandbox</span><span class=\"w\"> </span><span class=\"c1\">#&lt;&lt;&lt;&lt;&lt;Begins with \"hl7.fhir.us.\"</span><span class=\"w\"></span>\n<span class=\"nt\">url</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p p-Indicator\">&gt;-</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"no\">http://hl7.org/fhir/us/davinci-cdex/ImplementationGuide/hl7.healthedata1-sandbox</span><span class=\"w\"></span>\n<span class=\"nt\">version</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">1.0.0</span><span class=\"w\"></span>\n<span class=\"nn\">...</span><span class=\"w\"></span>\n</code></pre></div>\n<p>This will not:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">resourceType</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">ImplementationGuide</span><span class=\"w\"></span>\n<span class=\"nt\">id</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">healthedata1-sandbox</span><span class=\"w\"> </span><span class=\"c1\">#&lt;&lt;&lt;&lt;&lt;Does not begin with \"hl7.fhir.us.\"</span><span class=\"w\"></span>\n<span class=\"nt\">url</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p p-Indicator\">&gt;-</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"no\">http://hl7.org/fhir/us/davinci-cdex/ImplementationGuide/hl7.healthedata1-sandbox</span><span class=\"w\"></span>\n<span class=\"nt\">version</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">1.0.0</span><span class=\"w\"></span>\n<span class=\"nn\">...</span><span class=\"w\"></span>\n</code></pre></div>\n<p>So any US Realm ig that that uses the package id as their Implementation Guide Resource ID will get this error e.g., <code>hl7.fhir.us.davinci-cdex</code></p>",
        "id": 270296533,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643753420
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span>  FYI</p>",
        "id": 270296701,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643753511
    },
    {
        "content": "<p>well, yes, any US implementation guide, as judged by the package id, will try to run the code that's failing.</p>",
        "id": 270304470,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643757076
    },
    {
        "content": "<p>hacking the package id might work around the problem but isn't actually a solution</p>",
        "id": 270304510,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643757097
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>.  I renamed our ig resource id to davindi-ra, the 1.1.98 still gives me the same 400 error for use core. Is the work around to change the us-core package id?</p>",
        "id": 270436614,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643827273
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span>  I was able to recreate the error in the base template using my test build by changing the Implementation Guide FHIR ID.   Nothing else that I tried caused the error.   Updating the CDEX IG FHIR ID from  <code>hl7.fhir.us.davinci-cdex</code> to <code>davinci-cdex</code>  fixed it for the <em>base template</em> , but the davinci template requires it begin with :</p>\n<div class=\"codehilite\"><pre><span></span><code>ImplementationGuide.id must be in the form &quot;hl7.[family].[realm].id&quot; where family is cda, fhir, v2 or other\n</code></pre></div>\n<p>so still stuck... :-(</p>",
        "id": 270447228,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643831574
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  I thought this might be a useful clue to solving the bug.</p>",
        "id": 270447556,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643831704
    },
    {
        "content": "<p>no all this with the package id is irrelevant. The question is, how did the error change?</p>",
        "id": 270448505,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643832065
    },
    {
        "content": "<p>I don't know if your question is rhetorical but the error did not change, it appears and disappeared depending on the IG resource id</p>",
        "id": 270449699,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643832586
    },
    {
        "content": "<p>you still get <em>exactly</em> the same error? weird. Are you really sure? the error you were getting is a java error and I changed that bit and it should be some different error now</p>",
        "id": 270449805,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643832615
    },
    {
        "content": "<p>I still get the same error with 1.1.98 after renaming the ig resource id to davinci-ra. <br>\nValidating Conformance Resources                                                 (00:57.0654)<br>\nPublishing Content Failed: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643832874543\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643832874543</a> (01:00.0966)<br>\n                                                                                 (01:00.0968)<br>\nUse -? to get command line help                                                  (01:00.0969)<br>\n                                                                                 (01:00.0969)<br>\nStack Dump (for debugging):                                                      (01:00.0970)<br>\njava.io.IOException: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643832874543\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643832874543</a><br>\n        at org.hl7.fhir.utilities.SimpleHTTPClient$HTTPResult.checkThrowException(SimpleHTTPClient.java:70)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:200)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4198)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4127)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:949)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:800)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9099)</p>",
        "id": 270451017,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643833160
    },
    {
        "content": "<p>it <em>is</em> different</p>",
        "id": 270451801,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643833537
    },
    {
        "content": "<p>you are right</p>",
        "id": 270456091,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643835422
    },
    {
        "content": "<p>try again with <a href=\"http://www.healthintersections.com.au/org.hl7.fhir.publisher.cli-1.1.99-SNAPSHOT.jar\">http://www.healthintersections.com.au/org.hl7.fhir.publisher.cli-1.1.99-SNAPSHOT.jar</a></p>",
        "id": 270458590,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643836449
    },
    {
        "content": "<p>Validating Conformance Resources                                                 (00:56.0721)<br>\nPublishing Content Failed: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643836764833\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643836764833</a> (01:00.0656)<br>\n                                                                                 (01:00.0657)<br>\nUse -? to get command line help                                                  (01:00.0658)<br>\n                                                                                 (01:00.0659)<br>\nStack Dump (for debugging):                                                      (01:00.0660)<br>\njava.io.IOException: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643836764833\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643836764833</a><br>\n        at org.hl7.fhir.utilities.SimpleHTTPClient$HTTPResult.checkThrowException(SimpleHTTPClient.java:70)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:200)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4198)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4127)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:949)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:800)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9099)<br>\nPress any key to continue . . .</p>",
        "id": 270459502,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643836853
    },
    {
        "content": "<p>Error messages from 1.1.99-SNAPSHOT</p>",
        "id": 270459710,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643836938
    },
    {
        "content": "<p>hmm that didn't work. Try again with <a href=\"https://oss.sonatype.org/service/local/repositories/snapshots/content/org/hl7/fhir/publisher/org.hl7.fhir.publisher.cli/1.1.99-SNAPSHOT/org.hl7.fhir.publisher.cli-1.1.99-20220202.230507-2.jar\">https://oss.sonatype.org/service/local/repositories/snapshots/content/org/hl7/fhir/publisher/org.hl7.fhir.publisher.cli/1.1.99-SNAPSHOT/org.hl7.fhir.publisher.cli-1.1.99-20220202.230507-2.jar</a></p>",
        "id": 270473824,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643843411
    },
    {
        "content": "<p>FHIR IG Publisher Version 1.1.99-SNAPSHOT (Git# d2b6b3296deb). Built 2022-02-02T23:05:14.727Z (16 hours old)....</p>\n<p>Validating Conformance Resources                                                 (01:06.0789)<br>\nPublishing Content Failed: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643903080594\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643903080594</a> (Bad Request) (01:09.0677)<br>\n                                                                                 (01:09.0680)<br>\nUse -? to get command line help                                                  (01:09.0682)<br>\n                                                                                 (01:09.0683)<br>\nStack Dump (for debugging):                                                      (01:09.0684)<br>\njava.io.IOException: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643903080594\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643903080594</a> (Bad Request)<br>\n    at org.hl7.fhir.utilities.SimpleHTTPClient$HTTPResult.checkThrowException(SimpleHTTPClient.java:72)<br>\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:200)<br>\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)<br>\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4198)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4127)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:949)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:800)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9099)<br>\n=== rename the input/_fsh folder to input/fsh  ===</p>",
        "id": 270570607,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643903533
    },
    {
        "content": "<p>hmm it's a small step forward</p>",
        "id": 270611955,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643919815
    },
    {
        "content": "<p>try again (new release)</p>",
        "id": 270645997,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643932648
    },
    {
        "content": "<p>FHIR IG Publisher Version 1.1.99 (Git# ca030e5586e7). Built 2022-02-03T23:55:44.658Z (28 mins old)<br>\n...<br>\nPublishing Content Failed: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643934294314\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643934294314</a> (Bad Request) (content in /var/folders/_n/bhz7c7qd57d85fvm0g7dzdcw0000gn/T/fhir-http-3.log) (01:09.0316)<br>\n                                                                                 (01:09.0322)<br>\nUse -? to get command line help                                                  (01:09.0323)<br>\n                                                                                 (01:09.0325)<br>\nStack Dump (for debugging):                                                      (01:09.0327)<br>\njava.io.IOException: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643934294314\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643934294314</a> (Bad Request) (content in /var/folders/_n/bhz7c7qd57d85fvm0g7dzdcw0000gn/T/fhir-http-3.log)<br>\n    at org.hl7.fhir.utilities.SimpleHTTPClient$HTTPResult.checkThrowException(SimpleHTTPClient.java:75)<br>\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:200)<br>\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)<br>\n    at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4198)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4127)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:949)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:800)<br>\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9099)<br>\n=== rename the input/_fsh folder to input/fsh  ===</p>",
        "id": 270649086,
        "sender_full_name": "Eric Haas",
        "timestamp": 1643934383
    },
    {
        "content": "<p>please paste the content of /var/folders/_n/bhz7c7qd57d85fvm0g7dzdcw0000gn/T/fhir-http-3.log here</p>",
        "id": 270649130,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643934418
    },
    {
        "content": "<p>I am on Windows. Here is the error message from 1.1.99:<br>\nValidating Conformance Resources                                                 (00:50.0564)<br>\nPublishing Content Failed: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643943327381\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643943327381</a> (Bad Request) (content in c:\\temp\\fhir-http-4.log) (00:54.0382)<br>\n                                                                                 (00:54.0383)<br>\nUse -? to get command line help                                                  (00:54.0384)<br>\n                                                                                 (00:54.0385)<br>\nStack Dump (for debugging):                                                      (00:54.0386)<br>\njava.io.IOException: Invalid HTTP response 400 from <a href=\"https://hl7.org/fhir/us/core/package-list.json?nocache=1643943327381\">https://hl7.org/fhir/us/core/package-list.json?nocache=1643943327381</a> (Bad Request) (content in c:\\temp\\fhir-http-4.log)<br>\n        at org.hl7.fhir.utilities.SimpleHTTPClient$HTTPResult.checkThrowException(SimpleHTTPClient.java:75)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchJson(USRealmBusinessRules.java:200)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.fetchLatestUSCore(USRealmBusinessRules.java:176)<br>\n        at org.hl7.fhir.igtools.publisher.realm.USRealmBusinessRules.checkSD(USRealmBusinessRules.java:103)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.checkConformanceResources(Publisher.java:4198)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:4127)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:949)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:800)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:9099)</p>",
        "id": 270661499,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643943554
    },
    {
        "content": "<p>Here is what's in c:\\temp\\fhir-http-4.log   </p>\n<p>&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\"\"<a href=\"http://www.w3.org/TR/html4/strict.dtd\">http://www.w3.org/TR/html4/strict.dtd</a>\"&gt;<br>\n&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Bad Request&lt;/TITLE&gt;<br>\n&lt;META HTTP-EQUIV=\"Content-Type\" Content=\"text/html; charset=us-ascii\"&gt;&lt;/HEAD&gt;<br>\n&lt;BODY&gt;&lt;h2&gt;Bad Request - Invalid Header&lt;/h2&gt;<br>\n&lt;hr&gt;&lt;p&gt;HTTP Error 400. The request has an invalid header name.&lt;/p&gt;<br>\n&lt;/BODY&gt;&lt;/HTML&gt;</p>",
        "id": 270661549,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643943584
    },
    {
        "content": "<p>well, @#$%@ that's a pretty unuseful error message</p>",
        "id": 270661603,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643943607
    },
    {
        "content": "<p><a href=\"https://stackoverflow.com/questions/70980975/how-to-investigate-a-proxy-returning-400\">https://stackoverflow.com/questions/70980975/how-to-investigate-a-proxy-returning-400</a></p>",
        "id": 270662101,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643944022
    },
    {
        "content": "<p>ok, <span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span> and <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>: are you running anti-virus that performs a MITM attack on your connections? Are you running any kind of network security agent? Are you able to access <a href=\"https://hl7.org/fhir/us/core/package-list.json\">https://hl7.org/fhir/us/core/package-list.json</a> using cURL? Do you have to set anything in your browser proxy settings for HTTP access to work?</p>",
        "id": 270662211,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643944115
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> any ideas with that additional information?</p>",
        "id": 270662332,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643944237
    },
    {
        "content": "<p>I am not running any anti-virus that performs a MITM attack that I am aware of. I am using built-in Windows security.  Yes, I am able to access the package-list.json using cURL from command prompt.  I don't have to set anything in browser proxy.  I can still build the same IG successfully using 1.1.90 and I haven't changed anything in my environment as far as I know.</p>",
        "id": 270666939,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643949314
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"453078\">David Otasek</span> <a href=\"#narrow/stream/179252-IG-creation/topic/Is.20this.20an.20IG.20Publisher.20issue.3F/near/268590647\">said</a>:</p>\n<blockquote>\n<p>If you can find that config, maybe I can compare it with my default.</p>\n</blockquote>\n<p>Here is the screenshot of the parameters <a href=\"/user_uploads/10155/uY1Yw3WVlP65uXZ7B524sjlk/HTTP-Parameters.png\">HTTP-Parameters.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/uY1Yw3WVlP65uXZ7B524sjlk/HTTP-Parameters.png\" title=\"HTTP-Parameters.png\"><img src=\"/user_uploads/10155/uY1Yw3WVlP65uXZ7B524sjlk/HTTP-Parameters.png\"></a></div>",
        "id": 270673846,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643956861
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> Tried modifying registries suggested in that stackoverflow link you sent, it did not help. Still getting the 400 error. Also, tried turning off firewall, it did not help either.</p>",
        "id": 270674019,
        "sender_full_name": "Yan Heras",
        "timestamp": 1643957071
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> The bad header warning is something we may be able to check if we log the request. I wish it told us what particular header, though.</p>\n<p><span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span> I'll explore what my registry looks like; if there's nothing significant, at least we can rule out that cause. What entries did you change in your own registry?</p>",
        "id": 270752775,
        "sender_full_name": "David Otasek",
        "timestamp": 1643998827
    },
    {
        "content": "<blockquote>\n<p>I wish it told us what particular header, though.</p>\n</blockquote>\n<p>I know. remarkable, really</p>",
        "id": 270757130,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644000784
    },
    {
        "content": "<p>From the previous logging that I did with Yan, there doesn't appear to be any obvious header problems. However there is a slight difference in the User-Agent request header:</p>\n<p>My header:<br>\n<code>{User-Agent: Java/16.0.1}</code></p>\n<p>Yan's header:<br>\n<code>{User-Agent: Java/1.8.0_221}</code></p>\n<p>Is there anything on the server side of this query that could be choking on the underscore there?</p>",
        "id": 270758638,
        "sender_full_name": "David Otasek",
        "timestamp": 1644001428
    },
    {
        "content": "<p>I would suggest updating Java - it feels like the kind of thing that could have been a version bug/issue/incompatibility between IG publisher and the runtime (I remember seeing things like this in the past).  I am running 1.8.0 302 (64-bit) and everything works, if that helps.</p>\n<p>edit: note that 1.8.0 v 221 is from 2019, so it's probably a good idea to update if possible anyway =)</p>",
        "id": 270768926,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1644006770
    },
    {
        "content": "<p>Re: User-Agent header. It seems unlikely; I just tried sending a copy of Yan's query via Insomnia with the same header, and it still runs cleanly.</p>",
        "id": 270768928,
        "sender_full_name": "David Otasek",
        "timestamp": 1644006771
    },
    {
        "content": "<p>(edited)</p>",
        "id": 270768996,
        "sender_full_name": "David Otasek",
        "timestamp": 1644006806
    },
    {
        "content": "<p>it seems very likely to me that's some MITM user proxy. <span class=\"user-mention\" data-user-id=\"192119\">@Yan Heras</span> and <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> how do you connect to the internet? can you change that or try a different device? This is something that works for everyone else so far.</p>",
        "id": 270774302,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644009682
    },
    {
        "content": "<p>I updated to the most recent 1.8.0_321 (64 bit) and it builds now with 1.1.99! Thank you <span class=\"user-mention\" data-user-id=\"222054\">@Gino Canessa</span> for the suggestion. Thank you <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> and <span class=\"user-mention\" data-user-id=\"453078\">@David Otasek</span> for looking into this.  I guess there probably was something changed in a release after 1.1.90 that no longer compatible with the older java version. <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> do you want to check and see if this solves the problem on your mac?</p>",
        "id": 270792095,
        "sender_full_name": "Yan Heras",
        "timestamp": 1644021366
    },
    {
        "content": "<p>This started happening to me as well with the latest publisher, I was on 11.0.2 (also from 2019), updated to 11.0.14 and working now.</p>",
        "id": 272755943,
        "sender_full_name": "Bryn Rhodes",
        "timestamp": 1645499746
    },
    {
        "content": "<p>me too</p>",
        "id": 273524216,
        "sender_full_name": "Eric Haas",
        "timestamp": 1646069214
    }
]