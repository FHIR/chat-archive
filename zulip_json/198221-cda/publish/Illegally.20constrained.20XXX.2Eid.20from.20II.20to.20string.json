[
    {
        "content": "<p>Getting this error in the cda-core-2.0 IG:</p>\n<div class=\"codehilite\"><pre><span></span>org.hl7.fhir.exceptions.DefinitionException: StructureDefinition http://hl7.org/fhir/cda/StructureDefinition/Entity at Entity.id: illegal constrained type http://hl7.org/fhir/cda/StructureDefinition/II from string in http://hl7.org/fhir/StructureDefinition/Element\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.updateFromDefinition(ProfileUtilities.java:2030)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:736)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:472)\n    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3773)\n    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:3726)\n    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3181)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:768)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:656)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6622)\n</pre></div>",
        "id": 183308285,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188697
    },
    {
        "content": "<p>I believe this is related to other discussions we've had about basing things on Element, and that Element has <a href=\"http://Element.id\" target=\"_blank\" title=\"http://Element.id\">Element.id</a></p>",
        "id": 183308348,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188728
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , can't remember the solution you proposed... I think maybe you were suggesting creating BaseElement which has <a href=\"http://BaseElement.id\" target=\"_blank\" title=\"http://BaseElement.id\">BaseElement.id</a> and derives from Element, which is empty.</p>",
        "id": 183308391,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188774
    },
    {
        "content": "<p>I believe that would solve this</p>",
        "id": 183308394,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188780
    },
    {
        "content": "<p>But the FHIR spec would have to change baseDefinition references from Element to BaseElement</p>",
        "id": 183308413,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188797
    },
    {
        "content": "<p>or... maybe instead we could create BaseElement as being the empty profile, and Element derives from BaseElement</p>",
        "id": 183308431,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188816
    },
    {
        "content": "<p>then no references would need to change</p>",
        "id": 183308436,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188820
    },
    {
        "content": "<p>and the cda-core-2.0 IG would just need to use a baseDefinition of BaseElement instead of Element</p>",
        "id": 183308450,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188834
    },
    {
        "content": "<p>Until this is fixed, though, I am going to push a commit that comments out the <code>&lt;type&gt;</code> constraints on all <a href=\"http://XXX.id\" target=\"_blank\" title=\"http://XXX.id\">XXX.id</a> elements so that the build can run succesfully</p>",
        "id": 183308676,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576188970
    },
    {
        "content": "<p>I don't follow how that fixes it</p>",
        "id": 183309248,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576189407
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> did we have any other solution for this?</p>",
        "id": 183309259,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576189422
    },
    {
        "content": "<p>I have defined Base formally in R5 now</p>",
        "id": 183309266,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576189429
    },
    {
        "content": "<p>right now, Element has \"id\" which is of type string</p>",
        "id": 183310200,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576190171
    },
    {
        "content": "<p>in CDA, not all elements have \"id\"</p>",
        "id": 183310213,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576190178
    },
    {
        "content": "<p>and the ones that do are of type \"II\"</p>",
        "id": 183310221,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576190185
    },
    {
        "content": "<p>so, CDA elements can currently be based on Element because of that conflict</p>",
        "id": 183310261,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576190219
    },
    {
        "content": "<p>we either need to remove \"id\" from \"Element\"</p>",
        "id": 183310276,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576190227
    },
    {
        "content": "<p>or we need to create something new that doesn't have \"id\" in it that CDA elements can be based on</p>",
        "id": 183310287,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576190239
    },
    {
        "content": "<p>In the fork I created a <a href=\"https://github.com/ahdis/cda-core-2.0/commit/9fc75dde9969af8a4508aa064513f1d03526df7a\" target=\"_blank\" title=\"https://github.com/ahdis/cda-core-2.0/commit/9fc75dde9969af8a4508aa064513f1d03526df7a\">Base Element for R4</a> in the Implementation Guide, since the discussion on <a href=\"#narrow/stream/179177-conformance/topic/Loglcal.20Models.20.26.20Element\" title=\"#narrow/stream/179177-conformance/topic/Loglcal.20Models.20.26.20Element\">Zulip Logical Models</a> was not finished I did not create a pull request. </p>\n<p>However if a Base is integrated in R5 I see two options: <br>\n1) if you accept a Base Definition in the cda-core-2.0 R4 IG I create a pull request based on the commit above <br>\nor<br>\n2) change the cda-core-2.0 guide to a R5 version. Since it is a logical model the FHIR version does anyhow not depend much on it .</p>\n<p>which approach do you prefer? Given the development of R5 I don't see alternatives to above.</p>",
        "id": 183311530,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1576191123
    },
    {
        "content": "<p>let me investigate</p>",
        "id": 183311990,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576191526
    },
    {
        "content": "<p>ok, so this is what I'm going to use as my test case:</p>",
        "id": 183318219,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576197759
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/ayTl5MlPp8Thk0RN2nGw8SPr/cda.xml\" target=\"_blank\" title=\"cda.xml\">cda.xml</a> <a href=\"/user_uploads/10155/BXRlbQAFnS6irmzANg3eV_KA/example.xml\" target=\"_blank\" title=\"example.xml\">example.xml</a> <a href=\"/user_uploads/10155/sFjIkQFr31PXAbOLJlHDqsdF/ii.xml\" target=\"_blank\" title=\"ii.xml\">ii.xml</a> <a href=\"/user_uploads/10155/QS8OWQt13707rTjhvV76ogg3/any.xml\" target=\"_blank\" title=\"any.xml\">any.xml</a></p>",
        "id": 183318225,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576197770
    },
    {
        "content": "<p>that captures the essence the problem, yes?</p>",
        "id": 183318237,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576197784
    },
    {
        "content": "<p>well, that will work next release. So just go ahead and change everything to Base</p>",
        "id": 183322404,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576202806
    },
    {
        "content": "<p>next release is not that many hours away :-(</p>",
        "id": 183322489,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576202948
    },
    {
        "content": "<p>so there will be a \"Base\" type that is empty?</p>",
        "id": 183325475,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576207208
    },
    {
        "content": "<p>yes</p>",
        "id": 183325512,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576207304
    },
    {
        "content": "<p>awesome!</p>",
        "id": 183325624,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576207512
    },
    {
        "content": "<p>ok so I pushed more to the tests. I'm going to get terminlogy validation working</p>",
        "id": 183331575,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576217109
    },
    {
        "content": "<p>and the tests are here:</p>",
        "id": 183332068,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576217955
    },
    {
        "content": "<p><a href=\"https://github.com/FHIR/fhir-test-cases/tree/master/validator/cda\" target=\"_blank\" title=\"https://github.com/FHIR/fhir-test-cases/tree/master/validator/cda\">https://github.com/FHIR/fhir-test-cases/tree/master/validator/cda</a></p>",
        "id": 183332379,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576218573
    },
    {
        "content": "<p>ok, please let me know when a new build is ready for me to play with. I'll check out the Base stuff</p>",
        "id": 183333013,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576219673
    },
    {
        "content": "<p>cool what happens while sleeping :-) will check it out also to test</p>",
        "id": 183335111,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1576222589
    },
    {
        "content": "<p>ok terminology validation works... sort of.</p>",
        "id": 183348168,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576234667
    },
    {
        "content": "<p>we will have to work on CDA value sets - they don't seem to exist in UTG?</p>",
        "id": 183348232,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576234693
    },
    {
        "content": "<p>we will also have to work on OID 2 URI translations</p>",
        "id": 183348259,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576234708
    },
    {
        "content": "<p>otherwise... I think it's solid</p>",
        "id": 183348268,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576234721
    },
    {
        "content": "<p>I assume the \"Base\" stuff is not ready, yet? I just got latest and tried with <a href=\"http://hl7.org/fhir/StructureDefinition/Base\" target=\"_blank\" title=\"http://hl7.org/fhir/StructureDefinition/Base\">http://hl7.org/fhir/StructureDefinition/Base</a> and it failed</p>",
        "id": 183375071,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576254333
    },
    {
        "content": "<p>I haven't released it yet. I will sometime in the next few hours</p>",
        "id": 183394117,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576266743
    },
    {
        "content": "<p>Awesome. Given that your last message was eight hours ago, should I download the latest publisher and try it out?</p>",
        "id": 183422143,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576295280
    },
    {
        "content": "<p>yes</p>",
        "id": 183422790,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576296572
    },
    {
        "content": "<p>Hmmm... I must be missing something.<br>\nI changed <code>&lt;baseDefinition value=\"http://hl7.org/fhir/StructureDefinition/Element\"/&gt;</code> to <code>&lt;baseDefinition value=\"http://hl7.org/fhir/StructureDefinition/Base\"/&gt;</code> and it's giving a NullPointerException</p>",
        "id": 183423089,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576297194
    },
    {
        "content": "<p>and fyi, I removed <code>hl7.fhir.r4.core#4.0.1</code> from my package cache and had it re-download it</p>",
        "id": 183423291,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576297514
    },
    {
        "content": "<p>what's the stack?</p>",
        "id": 183423762,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576298311
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>Stack Dump (for debugging):                                                      (00:30.0910)\njava.lang.NullPointerException\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3813)\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:3762)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3217)\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:768)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:655)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6662)\n</pre></div>",
        "id": 183424357,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576299635
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 183460567,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576361467
    },
    {
        "content": "<p>do I need to point to 4.0.2 or something? don't think so, cause then the ig publisher complains that it only supports 4.0.1</p>",
        "id": 183571850,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576517632
    },
    {
        "content": "<p>I'm not finding StructureDefinition-Base anywhere</p>",
        "id": 183571913,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576517648
    },
    {
        "content": "<p>ok, I see the model shows up in the org.hl7.fhir.r4-4.1.27-SNAPSHOT.jar file</p>",
        "id": 183572445,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576518083
    },
    {
        "content": "<p>but, it's not being downloaded as part of the package that's stored in c:\\users\\XXX\\.fhir</p>",
        "id": 183572460,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576518100
    },
    {
        "content": "<p>no, it's implicit. I can't retrospectively define it in the packages, so it's a special case</p>",
        "id": 183581509,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576524323
    },
    {
        "content": "<p>so cda-core-2.0 publishes for me... I'm not sure what the problem is, or what's driving your PR to the IG publisher?</p>",
        "id": 183585871,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576527235
    },
    {
        "content": "<p>the PR is just a minor improvement on error handling</p>",
        "id": 183591040,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576530632
    },
    {
        "content": "<p>cda-core-2.0 is definitely not publishing for me</p>",
        "id": 183591054,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576530648
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/qM_EK__LngG15ucU1qcfaCag/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/qM_EK__LngG15ucU1qcfaCag/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/10155/qM_EK__LngG15ucU1qcfaCag/pasted_image.png\"></a></div>",
        "id": 183591092,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576530680
    },
    {
        "content": "<p>I would expect to find StructureDefinition-Base.json here</p>",
        "id": 183591107,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576530689
    },
    {
        "content": "<p>can you confirm that it should be?</p>",
        "id": 183591113,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576530692
    },
    {
        "content": "<p>no you won't find it there.</p>",
        "id": 183593928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576532469
    },
    {
        "content": "<p>it's a special case because I can't retrospectively define a type as part of a past specification. but I can pretend that it exists in my tooling</p>",
        "id": 183594464,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576532863
    },
    {
        "content": "<p>but looking at this, why doesn't Act etc inherit from InfrastructureRoot?</p>",
        "id": 183594594,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576532943
    },
    {
        "content": "<p>the IG will build fine next release</p>",
        "id": 183596816,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576534471
    },
    {
        "content": "<p>so it wasn't just me?</p>",
        "id": 183599438,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576536464
    },
    {
        "content": "<p>no</p>",
        "id": 183599530,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576536548
    },
    {
        "content": "<p>nice, seems to be working, at least against my local build of the ig publisher after doing a pull from master</p>",
        "id": 183603059,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1576539785
    }
]