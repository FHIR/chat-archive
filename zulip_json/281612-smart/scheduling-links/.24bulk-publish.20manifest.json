[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"218703\">@Nick Robison</span> thanks for this demo! Re: URLs. I think we've assumed full URLs rather than relative for the <code>output.url</code> links.</p>",
        "id": 232486325,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1617133756
    },
    {
        "content": "<p>Definitely! I just cheated so I didn't have to add a config parameter.</p>",
        "id": 232488475,
        "sender_full_name": "Nick Robison",
        "timestamp": 1617134593
    },
    {
        "content": "<p>FWIW our bulk data client assumes absolute urls in the manifest, so we had to do a little workaround here for <span class=\"user-mention\" data-user-id=\"218703\">@Nick Robison</span>'s publisher service in <a href=\"https://github.com/nickrobison-usds/vaccine-scheduler\">nickrobison-usds/vaccine-scheduler</a> (assuming that's what you are referring to).  Can we get that requirement added to the bulk spec if that is the intent (I can't seem to find it)?  Or should we make our client more flexible?</p>",
        "id": 233263947,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617681915
    },
    {
        "content": "<p>Only other issue we have had so far was that service rejects requests with the \"Accept: application/fhir+ndjson\" header.</p>",
        "id": 233264205,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617682157
    },
    {
        "content": "<p>Yikes! Thatâ€™s not good. The publisher is mostly there for testing, but I can push up a couple of quick fixes. The relative URLs was a hack, I have a ticket to make them full URLs.</p>",
        "id": 233306697,
        "sender_full_name": "Nick Robison",
        "timestamp": 1617710788
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192576\">@Robert Scanlon</span> Both issues have been 'fixed' and the changes merged into mainline, let me know if you run into any other issues.</p>",
        "id": 233342173,
        "sender_full_name": "Nick Robison",
        "timestamp": 1617723536
    },
    {
        "content": "<p>When running using docker-compose and accessed via <a href=\"http://localhost:9090/$bulk-publish\">http://localhost:9090/$bulk-publish</a>, I'm getting URLs pointing to a hostname only accessible by other containers in that docker-compose group (<a href=\"http://publisher:9090/data/test-slot.ndjson\">http://publisher:9090/data/test-slot.ndjson</a>).  So unfortunately your fix doesn't seem to work in that environment (unless there is something I'm missing).</p>",
        "id": 233372092,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617736035
    },
    {
        "content": "<p>We generally have our apps be able to accept a host name as a config variable (through the environment often), to work around this issue using docker-compose. Though perhaps there is a more elegant solution.</p>",
        "id": 233372442,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617736191
    },
    {
        "content": "<p>(I generallly do the same <span class=\"user-mention\" data-user-id=\"192576\">@Robert Scanlon</span>; if anybody has a better pattern I'd be keen to know it.)</p>",
        "id": 233374971,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1617737341
    },
    {
        "content": "<p>We use that pattern too, both for SMART Scheduling links and the normal REST API (due to fullUrl in searchset bundles).  We have a config for the publicly facing absolute base path.  You probably want more than hostname so you can handle reverse proxies which usually have a path component.</p>",
        "id": 233377328,
        "sender_full_name": "Cooper Thompson",
        "timestamp": 1617738360
    },
    {
        "content": "<p>+5 on including path info if you want others to be able to reuse :)</p>",
        "id": 233379060,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617739058
    },
    {
        "content": "<p>Fortunately, the config does exist, it's just not documented <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span>.</p>\n<p>When docker compose runs, it starts the services with the <code>dockerized</code> profile, which means you can modify the <code>publisher.base-url</code> property in the <code>application-dockerized.yml</code> file.</p>\n<p>Link here: <a href=\"https://github.com/nickrobison-usds/vaccine-scheduler/blob/main/publisher-application/src/main/resources/application-dockerized.yml\">https://github.com/nickrobison-usds/vaccine-scheduler/blob/main/publisher-application/src/main/resources/application-dockerized.yml</a></p>\n<p>I need to update the README to include some additional runtime configuration.</p>",
        "id": 233380269,
        "sender_full_name": "Nick Robison",
        "timestamp": 1617739559
    }
]