[
    {
        "content": "<p>The Ad hoc team has been working with <span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> on testing CMS BCDA and DPC FHIR APIs using the BDT Bulk FHIR testing tool <a href=\"https://bulk-data-tester.smarthealthit.org/\">https://bulk-data-tester.smarthealthit.org/</a>, and we have made great process integrating BDT with our build processes and testing our sandboxes with the Online runner. </p>\n<p>An issue came up while testing DPC, which we are trying to make fully conformant to the SMART Backend spec.  The issue is around how to test whether a SMART Backend server properly handles the <code> scope</code>form parameter on a call to create an access token.  DPC only supports the scope: <code>system/*.*</code>, which means all resources, all permissions  </p>\n<p>A little on our DPC Bulk FHIR server for context:  DPC supports Group export, Job status,  and resource Downloads per the bulk spec.  Only <code>Patient, Coverage, and ExplanationofBenefit </code> resources are exportable.   </p>\n<p>I read  the Wildcard Scopes Spec at  <a href=\"http://hl7.org/fhir/smart-app-launch/0.8.0/scopes-and-launch-context/\">http://hl7.org/fhir/smart-app-launch/0.8.0/scopes-and-launch-context/</a> , which states: <code> clients can request clinical scopes that contain a wildcard (*) for both the FHIR resource as well as the requested permission for the given resource. When a wildcard is requested for the FHIR resource, the client is asking for all data for all available FHIR resources, both now and in the future.</code></p>\n<p>This seems to support <code>system/*.*</code> as a valid, minimum scope that  all SMART on FHIR Bulk  servers must accept, when requested by the client.</p>\n<p>Questions:</p>\n<ol>\n<li>\n<p>Is that a correct interpretation?</p>\n</li>\n<li>\n<p>Does a server  have to support all the different the potential individual scope combinations depending on the available resources and available permissions on the server?</p>\n</li>\n<li>\n<p>if a server supports <code>system *.*</code>, does it have to also support <code>system/*.read</code> as well?  </p>\n</li>\n</ol>\n<p>To me,  <code>system/*.* </code>makes sense as a  default or minimum required scope for testing conformance, but I can also see the argument for a Bulk  server needing to accept <code>system/*.read</code>.because it makes sense for an export system,   </p>\n<p>The BDT tool currently uses <code>system/*.read</code> as its default scope.   An option for BDT is making configuration of the test client default scope possible, but some  input and consensus from the Bulk and #smart community on the above questions would be helpful and appreciated to know which direction we need to head with BDT and /or our DPC server.</p>",
        "id": 203670785,
        "sender_full_name": "Richard Braman",
        "timestamp": 1594604253
    },
    {
        "content": "<p>Here is my take on that (but it might be incorrect):</p>\n<ol>\n<li><code>system/*.*</code> is not the \"minimum\" but the ultimate scope that allows everything. If there is any common denominator scope that should be supported by every Bulk Data Export Server, that would probably be <code>system/*.read</code>. However, even that may be too optimistic because for example, a server may choose to only make a subset of its resources available for export.</li>\n<li>Yes, I believe a server that supports <code>system/*.*</code> should support <code>system/{Resource}.read</code> scopes or at least infer them from <code>system/*.*</code>. Otherwise it like saying \"I support everything but I don't support this one\". </li>\n<li>Yes, that should also be inferred from <code>system/*.*</code>. In fact, a server should not support <code>system/*.*</code> if it does not support writing to the data (like Bulk Data Import).</li>\n</ol>",
        "id": 203674352,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1594610249
    },
    {
        "content": "<p>In general, keep in mind that a server <em>can</em> maintain its own policies beyond  this scope system. So a specific client with a <code>system/*.*</code> is not necessarily going to see all data in the system.</p>",
        "id": 203716586,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1594648094
    },
    {
        "content": "<p>The advantage of allowing a client to at runtime request more specific scopes is that you can keep individual tokens more limited in their power. But a client's abilities are always limited by the policy configuration of the underlying system, irrespective of scopes.</p>",
        "id": 203716653,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1594648139
    }
]