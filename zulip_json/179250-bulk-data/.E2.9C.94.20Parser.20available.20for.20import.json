[
    {
        "content": "<p>Is there a parser available to convert ndjson files that were created by $export back to json so they can be imported into another Fhir server?</p>",
        "id": 254060066,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632148619
    },
    {
        "content": "<p>From: Fhir on Azure server To: Azure API on Fhir server</p>",
        "id": 254060200,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632148670
    },
    {
        "content": "<p>I set up an Azure Function to monitor an import folder and whenever I drop the ndjson files it returns an error that they are not proper json files and fails.</p>",
        "id": 254061465,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632149121
    },
    {
        "content": "<p>SQL Server backend</p>",
        "id": 254066049,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632150947
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"433820\">@Michael Brady</span>  - This Microsoft tool is supposed to do that: <a href=\"https://github.com/microsoft/fhir-loader\">https://github.com/microsoft/fhir-loader</a></p>",
        "id": 254091357,
        "sender_full_name": "John Silva",
        "timestamp": 1632160740
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"298707\">John Silva</span> <a href=\"#narrow/stream/179250-bulk-data/topic/Parser.20available.20for.20import/near/254091357\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"433820\">Michael Brady</span>  - This Microsoft tool is supposed to do that: <a href=\"https://github.com/microsoft/fhir-loader\">https://github.com/microsoft/fhir-loader</a></p>\n</blockquote>\n<p>that works to load the files once they are in json format. I'm trying to get the ndjson files into json files so I can use it.</p>",
        "id": 254101802,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632164889
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"298707\">@John Silva</span> My mistake - actually I read that too fast and I thought you were referencing the fhirloader tool from <span class=\"user-mention\" data-user-id=\"195775\">@Michael Hansen</span> which requires json files.<br>\nI'm running the deployment now.</p>",
        "id": 254107266,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632167375
    },
    {
        "content": "<p>Ok I got this deployed and it originally looked like it was working. I dropped all the ndjson files into the ndjson folder on the storage account and watched the App Insights Log Stream as it imported them. BUT when I go to test in Postman using https://{name}.azurehealthcareapis.com/Patient which should return pages of Patient data I get 14 lines in the response<br>\n{<br>\n    \"resourceType\": \"Bundle\",<br>\n    \"id\": \"7e4f390b5016a841b17382cd91cfff50\",<br>\n    \"meta\": {<br>\n        \"lastUpdated\": \"2021-09-20T20:47:04.7433617+00:00\"<br>\n    },<br>\n    \"type\": \"searchset\",<br>\n    \"link\": [<br>\n        {<br>\n            \"relation\": \"self\",<br>\n            \"url\": \"https://{name}.azurehealthcareapis.com/Patient\"<br>\n        }<br>\n    ]<br>\n}</p>",
        "id": 254116183,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632171215
    },
    {
        "content": "<p>When I looked at a sample file in budles folder it appears to be using PUT rather than POST. </p>\n<p>Do I have to open each of these and change them all to POST?</p>",
        "id": 254116482,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632171340
    },
    {
        "content": "<p>Hmm, reading the documentation on the MS fhir-loader page I assumed it \"just worked\".</p>",
        "id": 254213701,
        "sender_full_name": "John Silva",
        "timestamp": 1632233673
    },
    {
        "content": "<p>I tried deploying this twice. Both times I had to create the keys manually. Both times it gets to the point of authenticating to the Azure API for Fhir service and fails. 400 login error Authentication Failed https://{myservice}.azurehealthcareapis.com. I noticed that it is using {mytenant}/oauth2/token. When I try that in Postman it gets the token, but denies access. When I try {mytenant}/oauth2/v2.0/token in Postman it works and provides access to the data. But as I cannot get the data loaded from Fhir-Loader there is nothing to return. I have a call with the developer tomorrow, so I will post back my findings. He is saying that having to create the keys manually is highly irregular, so I must have provided something incorrect in the deployment.</p>",
        "id": 254369211,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632318300
    },
    {
        "content": "<p>Worked with <span class=\"user-mention\" data-user-id=\"374094\">@Dale Emel</span>  today on this. We validated the install was correct. We found some issues with keys and permissions. We created a new App Registration. Saw some success with loading a patient \"manually\", but none with the FhirLoader. There is a admin grant operation I am waiting for. Will try again after that.</p>",
        "id": 254570466,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632417071
    },
    {
        "content": "<p>Well the consent grant never happened. But I added the app registration to the keyvault and it worked! The fhir-loader ingests individual jsons and/or ndjsons. I had 3800 resources to load and it took ~30 min.</p>",
        "id": 254704756,
        "sender_full_name": "Michael Brady",
        "timestamp": 1632490646
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"433820\">Michael Brady</span> has marked this topic as resolved.</p>",
        "id": 254704771,
        "sender_full_name": "Notification Bot",
        "timestamp": 1632490652
    }
]