[
    {
        "content": "<p>we have a client that would like the bulk data zipped. would it re reasonable for my server to support _outputFormat=application/zip and return a .zip file or should i write a small app that consumes the .ndjson from the server and packages it for the client?</p>",
        "id": 174535420,
        "sender_full_name": "Brian Kolowitz",
        "timestamp": 1567164246
    },
    {
        "content": "<p>I like the idea of a the <code>application/zip</code> value for _outputFormat. </p>\n<p>An alternative could be a request that looks something like:<br>\n<code>/Patient/$export?_type=DocumentManifest&amp;_typeFilter =...</code>. This would result in an <code>.ndjson</code> file containing 1 document manifest that has 1 Attachment that contains a url pointing to the zip file.</p>\n<p>I think Brian's approach is simpler, but it'd be helpful to think and discuss alternatives to fulfill this use case.</p>",
        "id": 174540770,
        "sender_full_name": "Jeffrey Taylor",
        "timestamp": 1567169468
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194604\">@Jeffrey Taylor</span> I like your  suggestion, my question regards how do we specify that the DocumentManifest contains a zip as opposed to a pointer to the ndjson</p>",
        "id": 174540981,
        "sender_full_name": "Brian Kolowitz",
        "timestamp": 1567169581
    },
    {
        "content": "<p>I thought we did this at a connectathon using standard HTTP headers... let me look</p>",
        "id": 174549381,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1567175240
    },
    {
        "content": "<p>Accept-Encoding</p>",
        "id": 174549419,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1567175278
    },
    {
        "content": "<p>Because if you replaced the output format, you wouldn't know what was in the zip (fhir JSON, ND JSON, etc)</p>",
        "id": 174549483,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1567175304
    },
    {
        "content": "<p>I could be remembering incorrectly</p>",
        "id": 174549511,
        "sender_full_name": "Jenni Syed",
        "timestamp": 1567175320
    },
    {
        "content": "<p>Our experience in connectathon led us to encourage/prefer clients to request encodings, as Jenni says here. This way we re-use all the content type negotiations.</p>",
        "id": 174549595,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567175393
    },
    {
        "content": "<p>It doesn't quite give you \"a zip\" at the end of the process, but it allows a client to limit bandwidth required, and the client can pipe the file to a zip or whatever its compressed format of choice might be.</p>",
        "id": 174549682,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567175430
    },
    {
        "content": "<p>I'm considering returning an ndjson with a single row containing a documentmanifest that contains a link to a zip file... not sure if that makes sense</p>",
        "id": 174549723,
        "sender_full_name": "Brian Kolowitz",
        "timestamp": 1567175460
    },
    {
        "content": "<p>I don't think it makes a ton of sense. That is to say: you'd seem to lose most of the API capabilities and you wouldn't get much in the way of interop.</p>",
        "id": 174550522,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1567175991
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span>  thanks for the gut check.</p>",
        "id": 174550892,
        "sender_full_name": "Brian Kolowitz",
        "timestamp": 1567176243
    },
    {
        "content": "<p>zip is tricky because it's both a compression and a folder format.</p>",
        "id": 174617456,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1567257109
    }
]