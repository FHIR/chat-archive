[
    {
        "content": "<p>At last connectathon ONC track, we found a strange issue. The SMART bulk data reference server does not use 'Content-Type:application/fhir+json' is its response header for metadata request. Is this a bug or a reason behind it? <span class=\"user-mention\" data-user-id=\"193731\">@Vladimir Ignatov</span> <span class=\"user-mention\" data-user-id=\"191414\">@Dan Gottlieb</span> <br>\n<a href=\"/user_uploads/10155/bro5jJoVYdtXsZvj1ZhqZfI9/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/bro5jJoVYdtXsZvj1ZhqZfI9/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/bro5jJoVYdtXsZvj1ZhqZfI9/image.png\"></a></div>",
        "id": 223650205,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1611326917
    },
    {
        "content": "<p>Could be considered a bug if it causes problems. The reason is that it is not a FHIR server and it replies with JSON by default. Is that preventing you from parsing the content somehow?</p>",
        "id": 223673923,
        "sender_full_name": "Vladimir Ignatov",
        "timestamp": 1611337296
    },
    {
        "content": "<p>Not really. Inferno does not test the Content-Type header. It was actually caught by another testing application. That brings the question what the Content-Type of metadata response SHALL be. According to <a href=\"http://build.fhir.org/http.html#mime-type\">http://build.fhir.org/http.html#mime-type</a>, the <strong>MIME-type of FHIR resources</strong> is application/fhir+json. <br>\nIMO, CapabilityStatement is a FHIR resource so it SHALL be application/fhir+json.</p>",
        "id": 223681314,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1611340672
    },
    {
        "content": "<p>Am I incorrect if I always match the Accept Header of the $export call? Does the bulk spec require a specific content type (for the manifest file)?</p>\n<p>When nothing is specified the server can pick a default response format. Based upon my understanding.</p>",
        "id": 223771192,
        "sender_full_name": "Josh Lamb",
        "timestamp": 1611431393
    },
    {
        "content": "<p>The bulk data IG specifically says that the Accept header for $export SHALL be <code>application/fhir+json</code>. I believe the server SHALL throw out any $export request which does NOT have that header.<br>\nThe question I raised is on the /metadata endpoint. Bulk Data IG does not say anything about that.</p>",
        "id": 223976231,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1611616226
    },
    {
        "content": "<p>A general question I would like to clarify. The FHIR spec at <a href=\"http://build.fhir.org/http.html#mime-type\">http://build.fhir.org/http.html#mime-type</a> says that</p>\n<blockquote>\n<p>the MIME-type of FHIR resources is application/fhir+json.</p>\n</blockquote>\n<p>This applies to both FHIR servers and non-FHIR servers as long as the payload is a FHIR resource. Is my understanding correct? <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span></p>",
        "id": 224191529,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1611759062
    },
    {
        "content": "<p>I think it's a little bit slippery. the fhir specification is saying something true about this content type, but it is also true to say that the content type of fhir JSON resources is \"application/json\".</p>",
        "id": 224192417,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1611759404
    },
    {
        "content": "<p>In any case, I think the behavior that originally raised the issue here is a bug in the bulk data reference server, and indeed a FHIR server ought to use the content type defined in the fhir specification</p>",
        "id": 224192485,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1611759442
    },
    {
        "content": "<p>The question I am facing is that if the server response contains valid FHIR resource but the Content-Type is not 'application/fhir+json', should that be a test failure. My interpretation is based on the wording literally. The content-type is tied to the payload not the server type.  Actually, I don't know if there is any definition about what is a \"FHIR server\".</p>",
        "id": 224194226,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1611760142
    },
    {
        "content": "<p>if you are running a test suite against the thing and comparing its behavior with the fhir HTTP specification, then your test suite should trigger a failure here. The fact that you are testing it as a FHIR server is what brings these requirements to focus for me.</p>",
        "id": 224194490,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1611760241
    }
]