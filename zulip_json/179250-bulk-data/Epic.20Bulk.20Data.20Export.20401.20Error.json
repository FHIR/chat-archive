[
    {
        "content": "<p>Hey all,</p>\n<p>I'm implementing a FHIR integration in Python to pull data from Epic's sandbox environment. I wanted to see if anyone else has attempted this, or has had any issues with token authentication when doing the kick-off request.</p>\n<p>Some notable information on my build/progress:</p>\n<ol>\n<li>I'm using  <a href=\"https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token\">https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token</a> to get the token</li>\n<li>The JWT passed back is valid and signed</li>\n<li>Per Epic's bulk export specification, I'm using <a href=\"https://apporchard.epic.com/interconnect-aocurprd-oauth/api/FHIR/R4/Group/eIscQb2HmqkT.aPxBKDR1mIj3721CpVk1suC7rlu3yX83/$export\">https://apporchard.epic.com/interconnect-aocurprd-oauth/api/FHIR/R4/Group/eIscQb2HmqkT.aPxBKDR1mIj3721CpVk1suC7rlu3yX83/$export</a> as the endpoint to request data from.</li>\n<li>\n<p>To the above url, in my get request, I pass the following headers:<br>\n        'Accept':'application/fhir+json',<br>\n        'Content-type' : 'application/fhir+json', &lt;- I've also tried removing this as it isn't explicitly stated to be passed<br>\n        'Prefer':'respond-async',<br>\n        'Authorization' : 'Bearer ' + token</p>\n</li>\n<li>\n<p>I use a session to handle requests, and preserve the Authorization header by overriding NoRebuildAuthSession in requests.Session</p>\n</li>\n</ol>\n<p>The response from the get request comes  back with a 401 error and the following information under www-authenticate:<br>\nBearer error=\"invalid_token\", error_description=\"The access token provided is not valid\"</p>\n<p>Any guidance would be helpful! I think I might be using the wrong endpoint but I'm totally stumped right now.</p>",
        "id": 264211899,
        "sender_full_name": "Robert Barrett",
        "timestamp": 1638993639
    },
    {
        "content": "<p><a href=\"https://stackoverflow.com/questions/70281101/issues-with-epic-bulk-data-request-401-error\">https://stackoverflow.com/questions/70281101/issues-with-epic-bulk-data-request-401-error</a> - please only ask in one place at a time</p>",
        "id": 264237147,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639006670
    },
    {
        "content": "<p>Apologies - I haven't used this forum before and wasn't sure if it was the appropriate place to ask questions pertaining to Epic.</p>",
        "id": 264249452,
        "sender_full_name": "Robert Barrett",
        "timestamp": 1639017396
    },
    {
        "content": "<p>probably this is the best place</p>",
        "id": 264252087,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639020195
    },
    {
        "content": "<p>For troubleshooting Epic sandbox auth issues, <a href=\"mailto:open@epic.com\">open@epic.com</a> is probably the best support channel.  Can you send your issue there, and include your client ID and the access token you got from the sandbox?</p>",
        "id": 264306150,
        "sender_full_name": "Cooper Thompson",
        "timestamp": 1639058998
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"463053\">@Robert Barrett</span> I've been running into a similar issue and have sent a similar e-mail to Epic. I _think_ in your case that the access token is invalid because you got a token from <a href=\"https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token\">https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token</a> and are trying to use it against app orchard, which I believe is different.</p>",
        "id": 264356417,
        "sender_full_name": "Justin Kenel",
        "timestamp": 1639079338
    }
]