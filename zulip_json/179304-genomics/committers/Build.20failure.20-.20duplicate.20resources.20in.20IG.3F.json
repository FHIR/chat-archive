[
    {
        "content": "<p>I just upgraded my device, and as a test I tried to get my FHIR IG builds going again.  When I tried to build the latest version of genomics-reporting, I am getting the following errors:</p>\n<div class=\"codehilite\"><pre><span></span><code>     [java] Load Package hl7.fhir.pubpack#0.0.6\n     [java] Load Package hl7.fhir.xver-extensions#0.0.4\n     [java] Load Content                                                                     (00:17.0500)\n     [java] Duplicate Resource in IG: ValueSet/hgnc\n     [java] Duplicate Resource in IG: ValueSet/dna-change-type\n     [java] Duplicate Resource in IG: ValueSet/variant-inheritance\n     [java] Duplicate Resource in IG: ValueSet/high-low-codes\n     [java] Duplicate Resource in IG: ValueSet/functional-annotation\n     [java] Duplicate Resource in IG: ValueSet/hgvs\n     [java] Duplicate Resource in IG: ValueSet/seq-phase-relationship\n     [java] Exception in thread &quot;main&quot; java.lang.Error: Unable to continue because duplicate input resources were identified\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.load(Publisher.java:2966)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:841)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:707)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7756)\n\nBUILD FAILED\n/Users/cerkyp/Documents/GitHub/genomics-reporting/framework/build.xml:161: Java returned: 1\n</code></pre></div>",
        "id": 203110709,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594132660
    },
    {
        "content": "<p>Anyone else get this, or just me?  <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> / <span class=\"user-mention\" data-user-id=\"196553\">@Jamie Jones</span>  ?</p>",
        "id": 203110832,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594132717
    },
    {
        "content": "<p>local build? I'll take a look</p>",
        "id": 203110941,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1594132778
    },
    {
        "content": "<p>Yes, local.  Was afraid to trigger the cloud build in case it bombs there too.</p>",
        "id": 203111039,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594132808
    },
    {
        "content": "<p>error confirmed. looks like our valueset declarations need some thought after recent updates</p>",
        "id": 203118639,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1594135998
    },
    {
        "content": "<p>'Recent updates' ?  You mean IG Publisher updates, or IG updates?</p>",
        "id": 203118773,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594136049
    },
    {
        "content": "<p>publisher/framework, no IG content changes since May</p>",
        "id": 203122821,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1594137882
    },
    {
        "content": "<p>I can't seem to find what is causing the problem.  <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span></p>",
        "id": 203123030,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594137979
    },
    {
        "content": "<p>FYI - Found someone who had a similar issue, and added our issue on this topic: <a href=\"#narrow/stream/179252-IG-creation/topic/New.20release.201.2E101.20fails\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/New.20release.201.2E101.20fails</a></p>",
        "id": 203140408,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594146294
    },
    {
        "content": "<p>all 7 value sets we define as bindings in the observation spreadsheet are the ones generating errors. TBD codes is the only one not generating an error, and it is the only one not referenced on the \"Bindings\" tab in Obs.</p>",
        "id": 203196601,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1594152544
    },
    {
        "content": "<p>this is a genuine error in the IG as far as I am concerned. I added additional error checking after it turned out that other IGs were having unpredictable outcomes because of duplicate resources</p>",
        "id": 203210029,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1594160068
    },
    {
        "content": "<p>Ok we can try removing the ‘extra’ references on the bindings tab of the spreadsheet.</p>",
        "id": 203214543,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594163498
    },
    {
        "content": "<p>Tried a few things without luck</p>",
        "id": 203222217,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1594171550
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179304-genomics.2Fcommitters/topic/Build.20failure.20-.20duplicate.20resources.20in.20IG.3F/near/203210029\">said</a>:</p>\n<blockquote>\n<p>this is a genuine error in the IG as far as I am concerned. I added additional error checking after it turned out that other IGs were having unpredictable outcomes because of duplicate resources</p>\n</blockquote>\n<p>these VS resources weren't duplicates. They were just referenced via their filename (without endings). They are only defined as xml resources</p>",
        "id": 203262974,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1594212653
    },
    {
        "content": "<p>i just tried to switch to their urls, no luck. Now getting:</p>\n<div class=\"codehilite\"><pre><span></span><code>  [java] Exception in thread &quot;main&quot; java.lang.Error: Access single value, but value count is 0\n     [java]     at org.hl7.fhir.r5.renderers.utils.ElementWrappers$PropertyWrapperMetaElement.value(ElementWrappers.java:303)\n     [java]     at org.hl7.fhir.r5.renderers.DiagnosticReportRenderer.render(DiagnosticReportRenderer.java:67)\n     [java]     at org.hl7.fhir.r5.renderers.ResourceRenderer.render(ResourceRenderer.java:76)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.generateNarratives(Publisher.java:1043)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3632)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:845)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:707)\n     [java]     at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7756)\n</code></pre></div>",
        "id": 203263158,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1594212788
    },
    {
        "content": "<p>So, in reading the spreadsheet authoring guidance,  it says that when we indicate a binding, it need to point to a binding name on the Bindings tab:</p>\n<blockquote>\n<p>Binding: Conditional. This must be specified for any data element that allows a type of code, Coding or CodeableConcept (including \"*\"). It should not be present for other elements. It must refer to a <em>Binding name from either the #Bindings Tab in the current spreadsheet or one of the other resource spreadsheets</em>. (Note - the order in which resources are first loaded into memory is controlled by the build/source/fhir.ini file. Resources that define bindings must be listed before other resources that use them.</p>\n</blockquote>\n<p>We have XML files for these ValueSets, and we give them a 'binding name' on the Bindings tab of the spreadsheet.  So I am not sure why they are now flagged as duplicates?</p>",
        "id": 203265572,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594214283
    },
    {
        "content": "<p>i'm not sure what is happening behind the xslt curtain in the generation steps</p>",
        "id": 203265663,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1594214341
    },
    {
        "content": "<p>Yet another reason to get off these spreadsheets <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span></p>",
        "id": 203265916,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594214485
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191913\">Kevin Power</span> <a href=\"#narrow/stream/179304-genomics.2Fcommitters/topic/Build.20failure.20-.20duplicate.20resources.20in.20IG.3F/near/203265572\">said</a>:</p>\n<blockquote>\n<p>So, in reading the spreadsheet authoring guidance,  it says that when we indicate a binding, it need to point to a binding name on the Bindings tab:</p>\n<blockquote>\n<p>Binding: Conditional. This must be specified for any data element that allows a type of code, Coding or CodeableConcept (including \"*\"). It should not be present for other elements. It must refer to a <em>Binding name from either the #Bindings Tab in the current spreadsheet or one of the other resource spreadsheets</em>. (Note - the order in which resources are first loaded into memory is controlled by the build/source/fhir.ini file. Resources that define bindings must be listed before other resources that use them.</p>\n</blockquote>\n<p>We have XML files for these ValueSets, and we give them a 'binding name' on the Bindings tab of the spreadsheet.  So I am not sure why they are now flagged as duplicates?</p>\n</blockquote>\n<p>exactly. we only are defining the bindings in the spreadsheets, referring to the external (xml StrucDefs in src/resources/vocabulary) defined VSs</p>",
        "id": 203269013,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1594216094
    },
    {
        "content": "<p>That definitely <em>shouldn't</em> be treated as a duplicate</p>",
        "id": 203270658,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1594216910
    },
    {
        "content": "<p>So, where does that leave us?  We haven't found a way to get around this (yet)?</p>",
        "id": 203278591,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594220726
    },
    {
        "content": "<p>After some conversations with <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> and <span class=\"user-mention\" data-user-id=\"196553\">@Jamie Jones</span> , it seems this might be the time to move off the spreadsheets for authoring.  I logged <a href=\"http://jira.hl7.org/browse/FHIR-27942\">J#27942</a> for the workgroup to consider.</p>",
        "id": 203507014,
        "sender_full_name": "Kevin Power",
        "timestamp": 1594388204
    },
    {
        "content": "<p>Is anyone able to bypass these errors and get a valid build? I've run aground</p>",
        "id": 205256301,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1595952679
    },
    {
        "content": "<p>nopes. We just have to switch. Should have time for this next week, this week is horrible</p>",
        "id": 205256467,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1595952757
    },
    {
        "content": "<p>I tried a few things and couldn't get around it either.  I might have some time later this week to work on this as well.</p>",
        "id": 205257088,
        "sender_full_name": "Kevin Power",
        "timestamp": 1595953069
    },
    {
        "content": "<p>I am getting the same build error as <span class=\"user-mention\" data-user-id=\"196553\">@Jamie Jones</span> and have no idea where they are coming from.</p>",
        "id": 205816812,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596472770
    },
    {
        "content": "<p>will debug later this week</p>",
        "id": 205816952,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1596472820
    },
    {
        "content": "<p>I have branched my changes as I don't <em>think</em> the changes are causing this build error (which perhaps Jamie can confirm if he feels the same).</p>",
        "id": 205817100,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596472901
    },
    {
        "content": "<p>Yeah I couldn't get it to build with just replacing the offending resources and staying on spreadsheet method either</p>",
        "id": 205818757,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1596473762
    },
    {
        "content": "<p>Likely used to be happening before as well but not validated as an error</p>",
        "id": 205818926,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1596473847
    },
    {
        "content": "<p>Huh, well, when I created the branch - it built fine in the CI build environment</p>",
        "id": 205819249,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596473991
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/branches/switch_structdefs/index.html\">http://build.fhir.org/ig/HL7/genomics-reporting/branches/switch_structdefs/index.html</a></p>",
        "id": 205819333,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596474015
    },
    {
        "content": "<p>I just realized my local IG Publisher is from June, so deleting it to trigger a download and trying again.</p>",
        "id": 205819679,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596474165
    },
    {
        "content": "<p>Ugg, still failed, but still downloaded IG Publisher from June?  Did the location of the publisher change again?</p>",
        "id": 205819746,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596474209
    },
    {
        "content": "<p>That would be a much easier fix if it's the case!</p>",
        "id": 205820177,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1596474420
    },
    {
        "content": "<p>Looks like it:</p>\n<p>from the committers/notification stream:<br>\nig-publisher Release Bot12:44 AM<br>\nNew IGPublisher v1.1.6 released via Maven.</p>\n<p>New Publisher at <a href=\"https://github.com/HL7/fhir-ig-publisher/releases/latest/download/publisher.jar\">https://github.com/HL7/fhir-ig-publisher/releases/latest/download/publisher.jar</a></p>\n<p>Details can be found at <a href=\"https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.6\">https://github.com/HL7/fhir-ig-publisher/releases/tag/1.1.6</a></p>",
        "id": 205820347,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596474487
    },
    {
        "content": "<p>Shouldn't that change be in announcements so we don't have to dig through notification...</p>",
        "id": 205820495,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1596474580
    },
    {
        "content": "<p>I did some digging and can't find it, but am assuming it is there and I just missed it.</p>",
        "id": 205820586,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596474608
    },
    {
        "content": "<p>Happy we can move past it and make updates again, either way</p>",
        "id": 205821218,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1596474893
    },
    {
        "content": "<p>I think we are one of the few left on an older IG framework.</p>",
        "id": 205821850,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596475223
    },
    {
        "content": "<p>OK, local build now works, pushed up publisher location change to the branch.</p>",
        "id": 205822143,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596475388
    },
    {
        "content": "<p>If someone wouldn't mind double checking a local build, I would appreciate it.</p>",
        "id": 205825751,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596477385
    },
    {
        "content": "<p><code>BUILD SUCCESSFUL</code></p>",
        "id": 205829183,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1596478999
    },
    {
        "content": "<p>Just FYI - I also committed/pushed a change to remove the spreadsheets from the src directory so we won't have confusion in the future.</p>",
        "id": 205851447,
        "sender_full_name": "Kevin Power",
        "timestamp": 1596491608
    }
]