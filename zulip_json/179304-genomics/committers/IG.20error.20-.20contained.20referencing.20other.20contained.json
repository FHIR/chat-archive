[
    {
        "content": "<p>I am not sure how long this has been occurring, but I noticed an error that seems new after reviewing the latest QA (on AnnotationExample.json).  This example is a DiagnosticReport with two Observation resources as 'contained' inside the DR.  One of the contained Observation resources tries to 'derivedFrom' the other contained Observation resource, but it throws this error: </p>\n<div class=\"codehilite\"><pre><span></span>SHALL have a contained resource if a local reference is provided ( (url: 2; ids: )) [reference.startsWith(&#39;#&#39;).not() or (reference.substring(1).trace(&#39;url&#39;) in %resource.contained.id.trace(&#39;ids&#39;))]\n</pre></div>\n\n\n<p>It seems that one contained resource cannot reference another contained resource even when they are in the same container?</p>",
        "id": 178702618,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571695033
    },
    {
        "content": "<p>I don't think it was tracking that error before but it is a great catch and makes sense re: contained resources. That effectively means we can't do implications as contained, should push for sending them as bundles.</p>",
        "id": 178704351,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1571696255
    },
    {
        "content": "<p>Contained resources aren't exposed to queries as far as I know as well</p>",
        "id": 178704431,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1571696298
    },
    {
        "content": "<p>are both observations in the results section of the diagnostic report?</p>",
        "id": 178704744,
        "sender_full_name": "Bret H",
        "timestamp": 1571696570
    },
    {
        "content": "<p>Agree with the move to bundles. And yes, they are referenced from the results section of diagnostic report. But that works since the report is the container.</p>",
        "id": 178704956,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571696716
    },
    {
        "content": "<p>I'm confused. Sorry. from the above I see 'one contained resource...' and then 'that works since the report is the container.' What is the example url?</p>",
        "id": 178705119,
        "sender_full_name": "Bret H",
        "timestamp": 1571696840
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/AnnotationExample.html\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/genomics-reporting/AnnotationExample.html\">http://build.fhir.org/ig/HL7/genomics-reporting/AnnotationExample.html</a></p>",
        "id": 178721273,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571717328
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> - I assume you concur this is a real error?  And if so, is there some way to fix it while keeping the contained resources?  I know contained resources are meant to stay 'contained' within the container - but does that imply the contained resources should not be able to refer to each other?</p>",
        "id": 178759314,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571753284
    },
    {
        "content": "<p>After doing some more research on this - I did find another example in FHIR core that does this (one contained resource referring to another): <a href=\"http://build.fhir.org/claim-example-oral-contained.xml.html\" target=\"_blank\" title=\"http://build.fhir.org/claim-example-oral-contained.xml.html\">http://build.fhir.org/claim-example-oral-contained.xml.html</a></p>\n<p>The Coverage resource (id = coverage-1) has two properties (subscriber, beneficiary) that reference #patient-1, which is another contained resource.  I did run the validator on it, and it does generate the same errors as we are seeing.</p>",
        "id": 178760757,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571754259
    },
    {
        "content": "<p>Contained resources should be able to refer to each other using #id</p>",
        "id": 178762787,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1571755621
    },
    {
        "content": "<p>They just can't (easily) refer to resources contained in a different resource</p>",
        "id": 178762837,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1571755656
    },
    {
        "content": "<p>If this should be OK, then this is a problem in the validator?  Seems perhaps we should log a tracker?</p>",
        "id": 178777321,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571765609
    },
    {
        "content": "<p>Y</p>",
        "id": 178799242,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1571778269
    },
    {
        "content": "<p><a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=25042\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=25042\">GF#25042</a></p>",
        "id": 178799970,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571778887
    },
    {
        "content": "<p>We ought to consider guidance on where contained resources are most/least appropriate for future release as well</p>",
        "id": 178866954,
        "sender_full_name": "Jamie Jones",
        "timestamp": 1571845483
    },
    {
        "content": "<p>-1 for contained <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 178868856,
        "sender_full_name": "Kevin Power",
        "timestamp": 1571846713
    }
]