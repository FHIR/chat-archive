[
    {
        "content": "<p>Anyone have any ideas when this example bundle doesn't render?</p>\n<p><a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/Bundle-bundle-pgxexample.html\">http://build.fhir.org/ig/HL7/genomics-reporting/Bundle-bundle-pgxexample.html</a><br>\nFSH: <a href=\"https://github.com/HL7/genomics-reporting/blob/master/input/fsh/examples/bundle-pgxexample.fsh\">https://github.com/HL7/genomics-reporting/blob/master/input/fsh/examples/bundle-pgxexample.fsh</a></p>\n<p>Here is another transaction bundle that does render:<br>\n<a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/Bundle-bundle-complexVariant-nonHGVS.html\">http://build.fhir.org/ig/HL7/genomics-reporting/Bundle-bundle-complexVariant-nonHGVS.html</a><br>\nFSH: <a href=\"https://github.com/HL7/genomics-reporting/blob/master/input/fsh/examples/bundle-complexVariant-nonHGVS.fsh\">https://github.com/HL7/genomics-reporting/blob/master/input/fsh/examples/bundle-complexVariant-nonHGVS.fsh</a></p>\n<p>If anyone has any suggestions, let me know.</p>",
        "id": 270424109,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643822786
    },
    {
        "content": "<p>maybe the warning in the build about the matching profiles creates this issue?</p>",
        "id": 270568326,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643902732
    },
    {
        "content": "<p>Can you put that warning here Patrick?</p>",
        "id": 270568489,
        "sender_full_name": "Bret H",
        "timestamp": 1643902800
    },
    {
        "content": "<p>Hmmm, perhaps? Any suggestions on how to fix the warning? That has been on my list, but just hasn't bubbled to the top</p>",
        "id": 270568544,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643902806
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/qa.html\">http://build.fhir.org/ig/HL7/genomics-reporting/qa.html</a> (search for warning in that QA page)</p>",
        "id": 270568632,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643902840
    },
    {
        "content": "<p>Change the names so that profiles (instances) are unique<br>\ne.g. Found multiple matching profiles for Task/usage-1a among choices: <a href=\"http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/followup-recommendation\">http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/followup-recommendation</a>, <a href=\"http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/medication-recommendation\">http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/medication-recommendation</a></p>\n<p>try changing one of the usage-1a to usage-1b or something like that. I worked through a problem similar</p>",
        "id": 270568826,
        "sender_full_name": "Bret H",
        "timestamp": 1643902920
    },
    {
        "content": "<p>similar for Task/med-usage-impact-task-pgx-example</p>",
        "id": 270568996,
        "sender_full_name": "Bret H",
        "timestamp": 1643902979
    },
    {
        "content": "<p>There is only a single instance with 'usage-1a' that I can find.</p>",
        "id": 270569305,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643903094
    },
    {
        "content": "<p>I <em>think</em> the message is saying that the Task/usage-1a instance <em>could</em> be multiple profiles, and therefore the publisher doesn't know how to validate it?</p>",
        "id": 270569481,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643903159
    },
    {
        "content": "<p>but our FSH clearly says which profile it should be:</p>\n<p>Instance: usage-1a<br>\nInstanceOf: MedicationRecommendation</p>",
        "id": 270569629,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643903211
    },
    {
        "content": "<p>yes</p>",
        "id": 270569630,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643903212
    },
    {
        "content": "<p>sushi doesn't populate .profile by default. So the validator just tries to match</p>",
        "id": 270569698,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643903238
    },
    {
        "content": "<p>.profile in the reference?</p>",
        "id": 270569784,
        "sender_full_name": "Bret H",
        "timestamp": 1643903270
    },
    {
        "content": "<p>The Example shouldnt match multiple profile, the code its having clearly points to the medication recommendation profile</p>",
        "id": 270569789,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643903272
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192123\">Bret H</span> <a href=\"#narrow/stream/179304-genomics.2Fcommitters/topic/QA.20-.20issue.20with.20example.20bundle.20not.20rendering/near/270569784\">said</a>:</p>\n<blockquote>\n<p>.profile in the reference?</p>\n</blockquote>\n<p>in the example instances. So resource.meta.profile</p>",
        "id": 270569889,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643903296
    },
    {
        "content": "<p>So this seems to be a bug.</p>",
        "id": 270569918,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643903308
    },
    {
        "content": "<p>Look to see if the profile with the same name is elsewhere in the IG</p>",
        "id": 270569938,
        "sender_full_name": "Bret H",
        "timestamp": 1643903316
    },
    {
        "content": "<p>I changed names when there were two examples in the IG (not in the same example) with the same profile name, and that removed an warning. I think it was the same one but can't quite remember</p>",
        "id": 270570057,
        "sender_full_name": "Bret H",
        "timestamp": 1643903364
    },
    {
        "content": "<p>ah i'm wrong. Default is to set .profile</p>",
        "id": 270570282,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643903434
    },
    {
        "content": "<p>Yea, and these warnings are on different examples than the one that is failing to render. So, something to figure out I guess, but it isn't causing the failure to render problem.</p>",
        "id": 270570729,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643903584
    },
    {
        "content": "<p>Is the warning saying we don't slicing setup right on our extension?</p>\n<p><a href=\"http://build.fhir.org/ig/HL7/genomics-reporting/StructureDefinition-recommended-action.html\">http://build.fhir.org/ig/HL7/genomics-reporting/StructureDefinition-recommended-action.html</a></p>",
        "id": 270571178,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643903759
    },
    {
        "content": "<p>Or that we don't have our medication-recommendation or followup-recommendation profiles defined such that they can be distinguished between?</p>",
        "id": 270571594,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643903892
    },
    {
        "content": "<p>why would it be wrong here and right elsewhere?</p>",
        "id": 270571834,
        "sender_full_name": "Bret H",
        "timestamp": 1643903982
    },
    {
        "content": "<p>Might be the only place we have  that can refer to one or the other of these?</p>",
        "id": 270571984,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643904014
    },
    {
        "content": "<p>(this is why I hadn't really investigated this yet <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> )</p>",
        "id": 270572101,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643904041
    },
    {
        "content": "<p>So, those two profiles (MedicationRecommendation and FollowupRecommendation) do not use a fixed code, but say the code should be from a LOINC answer list, and they each specify a different answer list. The example that we have the warning about (it is a MedicationRecommendation) uses a code from the appropriate answer list. Perhaps the validation can't handle when the constraint is on a value set instead of a fixed code?</p>",
        "id": 270575233,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643905209
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191913\">Kevin Power</span> <a href=\"#narrow/stream/179304-genomics.2Fcommitters/topic/QA.20-.20issue.20with.20example.20bundle.20not.20rendering/near/270571594\">said</a>:</p>\n<blockquote>\n<p>Or that we don't have our medication-recommendation or followup-recommendation profiles defined such that they can be distinguished between?</p>\n</blockquote>\n<p>they use different codes (through bindings) so they should be</p>",
        "id": 270584903,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643908763
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191913\">Kevin Power</span> <a href=\"#narrow/stream/179304-genomics.2Fcommitters/topic/QA.20-.20issue.20with.20example.20bundle.20not.20rendering/near/270575233\">said</a>:</p>\n<blockquote>\n<p>So, those two profiles (MedicationRecommendation and FollowupRecommendation) do not use a fixed code, but say the code should be from a LOINC answer list, and they each specify a different answer list. The example that we have the warning about (it is a MedicationRecommendation) uses a code from the appropriate answer list. Perhaps the validation can't handle when the constraint is on a value set instead of a fixed code?</p>\n</blockquote>\n<p>it should be, seems like a bug/missing feature in the validator. Slicing by pattern and VS bindings works with the java validator</p>",
        "id": 270585131,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643908828
    },
    {
        "content": "<p>Worth asking about?</p>",
        "id": 270585957,
        "sender_full_name": "Kevin Power",
        "timestamp": 1643909107
    },
    {
        "content": "<p>Yes, definitely</p>",
        "id": 270680674,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1643962339
    },
    {
        "content": "<p>I asked about it here: <a href=\"#narrow/stream/179252-IG-creation/topic/Found.20multiple.20matching.20profiles.2E.2E.2E/near/270964718\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Found.20multiple.20matching.20profiles.2E.2E.2E/near/270964718</a></p>",
        "id": 270966366,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644234593
    },
    {
        "content": "<p>found the source of the issue: <a href=\"http://tx.fhir.org\">tx.fhir.org</a> doesn't know the Loinc LL VS</p>",
        "id": 270999694,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644249660
    },
    {
        "content": "<p>would they expect that we just use LOINC?</p>",
        "id": 271019363,
        "sender_full_name": "Bret H",
        "timestamp": 1644257489
    },
    {
        "content": "<p>In this case, we are using LOINC. The two profiles in question define a binding on Task.code to different LOINC answer lists. And then part of the FHIR validator processing is to evaluate each instance of a resource to determine if it matches a profile. In this case, that includes validating that Task.code we have in our example matches the binding on the two profiles. Well, it seems that <a href=\"http://tx.fhir.org\">tx.fhir.org</a> doesn't have any LOINC defined answer lists loaded, so therefore the validator is unable to confirm that the Task.code we used was in one of the ValueSets defined in the bindings. So therefore, the validator wasn't able to determine if our instance matched one of the profiles we said it should be, so therefore it throws the warning.</p>\n<p>I hope I have that right after <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> had to set me straight. <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 271026077,
        "sender_full_name": "Kevin Power",
        "timestamp": 1644260402
    }
]