[
    {
        "content": "<p>Hi, I'm working  on a demo at OYS TestLab @ PPSHP where we want to demonstrate sending of FHIR resources to Kanta Sandbox from an external system. I'm pretty new with this sandbox and FHIR altogether and I've been only testing the service in this point by using the website and Chrome's Advanced REST Client (ARC)</p>\n<p>I've tried to create a Patient resource like it was stated in the documentation and  there was no problems with that. I received HTTP 201 Created to confirm it succeeded.</p>\n<p>However, next I tried to create a Observation resource containing a Body Temperature reading and tried to submit it. I received the following error:</p>\n<p>&lt;OperationOutcome&gt;<br>\n&lt;issue&gt;<br>\n&lt;severity value=\"error\" /&gt;<br>\n&lt;code value=\"processing\" /&gt;<br>\n&lt;diagnostics value=\"Failed to call access method\" /&gt; <br>\n &lt;/issue&gt; <br>\n&lt;/OperationOutcome&gt;</p>\n<p>The message I tried to submit should be a-ok. Is this error message related to user-error or something else?</p>\n<p>Below is the test message I tried to send from ARC.</p>\n<p>URL:  <a href=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\" target=\"_blank\" title=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation</a></p>\n<p>Accept-Charset: utf-8<br>\nAccept: application/fhir+xml<br>\nAccept-Encoding: gzip<br>\nContent-Type: application/fhir+xml</p>\n<p>&lt;Observation xmlns=\"<a href=\"http://hl7.org/fhir\" target=\"_blank\" title=\"http://hl7.org/fhir\">http://hl7.org/fhir</a>\"&gt;<br>\n   &lt;meta&gt;<br>\n       &lt;profile value=\"http://phr.kanta.fi/StructureDefinition/fiphr-bodytemperature-stu3\"/&gt;<br>\n   &lt;/meta&gt;<br>\n   &lt;language value=\"fi\"/&gt;<br>\n   &lt;category&gt; <br>\n    &lt;coding&gt; <br>\n      &lt;system value=\"http://hl7.org/fhir/observation-category\"/&gt; <br>\n      &lt;code value=\"vital-signs\"/&gt; <br>\n      &lt;display value=\"Vital Signs\"/&gt; <br>\n    &lt;/coding&gt; <br>\n    &lt;text value=\"Vital Signs\"/&gt; <br>\n   &lt;/category&gt; <br>\n   &lt;effectiveDateTime value=\"2017-06-16\"/&gt;<br>\n   &lt;issued value=\"2017-06-15T17:39:44.937Z\"/&gt;<br>\n   &lt;status value=\"final\"/&gt;<br>\n   &lt;code&gt;<br>\n      &lt;coding&gt;<br>\n         &lt;system value=\"http://loinc.org\"/&gt;<br>\n         &lt;code value=\"8310-5\"/&gt;<br>\n         &lt;display value=\"Body temperature\"/&gt;<br>\n      &lt;/coding&gt;<br>\n   &lt;/code&gt;<br>\n   &lt;subject&gt;<br>\n      &lt;reference value=\"urn:uuid:d5db9d42-f269-4518-8ed4-c5615eb710fc\"/&gt;<br>\n   &lt;/subject&gt;<br>\n   &lt;performer&gt;<br>\n      &lt;reference value=\"urn:uuid:3eeb2a91-cd2c-4710-ae54-ed39909689f4\"/&gt;<br>\n   &lt;/performer&gt;<br>\n   &lt;valueQuantity&gt; <br>\n      &lt;value value=\"36.5\"/&gt; <br>\n      &lt;unit value=\"Cel\"/&gt; <br>\n      &lt;system value=\"http://unitsofmeasure.org\"/&gt; <br>\n      &lt;code value=\"Cel\"/&gt; <br>\n   &lt;/valueQuantity&gt;<br>\n&lt;/Observation&gt;</p>\n<p>Is there anything I'm doing wrong? Thanks for any help or insight you might offer!</p>\n<p>//Kari V-A</p>",
        "id": 153911456,
        "sender_full_name": "Kari Vatjus-Anttila",
        "timestamp": 1506677311
    },
    {
        "content": "<p>Profiles, extensions, value sets and code systems SHALL be in JSON format when uploaded to the Finnish PHR platform. Also the resource instances SHALL be in JSON format (XML not supported).</p>",
        "id": 153912040,
        "sender_full_name": "Mika Tuomainen",
        "timestamp": 1507029911
    },
    {
        "content": "<p>I've tried sending the aforementiond request in JSON format as well. Both end up yielding the same end result:</p>\n<p>URL: <a href=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\" target=\"_blank\" title=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation</a></p>\n<p>Accept-Charset: utf-8<br>\nAccept: application/fhir+json<br>\nAccept-Encoding: gzip<br>\nContent-Type: application/fhir+json</p>\n<p>{<br>\n    \"resourceType\": \"OperationOutcome\",<br>\n    \"issue\": [<br>\n        {<br>\n            \"severity\": \"error\",<br>\n            \"code\": \"processing\",<br>\n            \"diagnostics\": \"Failed to call access method\"<br>\n        }<br>\n    ]<br>\n}</p>\n<p>Is there an example somewhere how to do this the correct way or is there something weird going on server side?</p>",
        "id": 153912059,
        "sender_full_name": "Kari Vatjus-Anttila",
        "timestamp": 1507033218
    },
    {
        "content": "<p>We are investigating this problem and we'll inform you as soon as a solution is found.</p>\n<p>Could you please give the message you're trying to send in json format? That would help us investigate the problem.</p>",
        "id": 153912228,
        "sender_full_name": "Anna Korpela",
        "timestamp": 1507098892
    },
    {
        "content": "<p>Sure. Here you go. I presume the message structure is ok because if there's a field missing or contains invalid values it usually nags about it.</p>\n<p>{<br>\n    \"resourceType\": \"Observation\",<br>\n    \"meta\": {<br>\n        \"profile\": [<br>\n            \"<a href=\"http://phr.kanta.fi/StructureDefinition/fiphr-bodytemperature-stu3\" target=\"_blank\" title=\"http://phr.kanta.fi/StructureDefinition/fiphr-bodytemperature-stu3\">http://phr.kanta.fi/StructureDefinition/fiphr-bodytemperature-stu3</a>\"<br>\n        ]<br>\n    },<br>\n    \"language\": \"fi\",<br>\n    \"category\": [<br>\n        {<br>\n            \"coding\": [<br>\n                {<br>\n                    \"system\": \"<a href=\"http://hl7.org/fhir/observation-category\" target=\"_blank\" title=\"http://hl7.org/fhir/observation-category\">http://hl7.org/fhir/observation-category</a>\",<br>\n                    \"code\": \"vital-signs\",<br>\n                    \"display\": \"Vital Signs\"<br>\n                }<br>\n            ],<br>\n            \"text\": \"Vital Signs\"<br>\n        }<br>\n    ],<br>\n    \"effectiveDateTime\": \"2017-06-16\",<br>\n    \"issued\": \"2017-06-15T17:39:44.937Z\",<br>\n    \"status\": \"final\",<br>\n    \"code\": [<br>\n        {<br>\n            \"coding\": [<br>\n                {<br>\n                    \"system\": \"<a href=\"http://loinc.org\" target=\"_blank\" title=\"http://loinc.org\">http://loinc.org</a>\",<br>\n                    \"code\": \"8310-5\",<br>\n                    \"display\": \"Body temperature\"<br>\n                }<br>\n            ],<br>\n            \"text\": \"Body temperature\"<br>\n        }<br>\n    ],<br>\n    \"subject\": [<br>\n        {<br>\n            \"reference\": \"urn:uuid:d5db9d42-f269-4518-8ed4-c5615eb710fc\"<br>\n        }<br>\n    ],<br>\n    \"performer\": [<br>\n        {<br>\n            \"reference\": \"urn:uuid:3eeb2a91-cd2c-4710-ae54-ed39909689f4\"<br>\n        }<br>\n    ],<br>\n    \"valueQuantity\": {<br>\n        \"value\": \"36.5\",<br>\n        \"unit\": \"Cel\",<br>\n        \"system\": \"<a href=\"http://unitsofmeasure.org\" target=\"_blank\" title=\"http://unitsofmeasure.org\">http://unitsofmeasure.org</a>\",<br>\n        \"code\": \"Cel\"<br>\n    }<br>\n}</p>",
        "id": 153912229,
        "sender_full_name": "Kari Vatjus-Anttila",
        "timestamp": 1507099539
    },
    {
        "content": "<p>Problem is with the subject reference.  They are supposed to be in the format Patient/&lt;uuid&gt; where &lt;uuid&gt; is replaced with the id of the patient. The Patient must exist in PHR before storing the observation. I checked and patient with uuid d5db9d42-f269-4518-8ed4-c5615eb710fc can be found in the database so you should use \"Patient/d5db9d42-f269-4518-8ed4-c5615eb710fc\" as subject.reference.</p>\n<p>Unfortunately the error message wasn't very helpful in this case. I can see how it would be difficult to know what went wrong. We will open a defect about that.</p>",
        "id": 153912232,
        "sender_full_name": "Matti Uusitalo",
        "timestamp": 1507107935
    },
    {
        "content": "<p>Hi, you're correct. It seems to work now when I modified the subject.reference as instructed. The error message was a bit uninformative which led to confusion. Thank you very much for the support!</p>",
        "id": 153912237,
        "sender_full_name": "Kari Vatjus-Anttila",
        "timestamp": 1507111625
    }
]