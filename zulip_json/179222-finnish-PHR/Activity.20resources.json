[
    {
        "content": "<p>Apparently the sandbox server is not yet configured fully according to the newly entered activity resources, could you ping us when the config is ready, thanks. We e.g. get errors on fitness results ValueSet or fitness category CodeSystem references that are not based on our XML definition files..</p>",
        "id": 153916275,
        "sender_full_name": "Harri Honko",
        "timestamp": 1509030245
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193693\">@Harri Honko</span> Were you creating a resource instance? In a resource instance it is mandatory to declare conformance to profile also in the sandbox environment.</p>\n<p>Check this: <a href=\"http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille\" target=\"_blank\" title=\"http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille\">http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille</a> (Declaration of conformance to a FHIR profile)</p>",
        "id": 153916397,
        "sender_full_name": "Mika Tuomainen",
        "timestamp": 1509100740
    },
    {
        "content": "<p>And of course, the referenced profile shall be uploaded to the sandbox.</p>",
        "id": 153916398,
        "sender_full_name": "Mika Tuomainen",
        "timestamp": 1509100877
    },
    {
        "content": "<p>I uploaded the profiles to the sandbox on Sunday evening. Now - we're currently failing to create even a body weight observation using the Finnish PHR body weight profile example JSON as the basis. Trying to reverse engineer the problem, the values in the PHR Vital signs value set get an # before the LOINC code it's supposed to refer to at LOINC, and the value set URL ends up having a /#codenumber -&gt; fail.</p>",
        "id": 153916438,
        "sender_full_name": "Harri Honko",
        "timestamp": 1509105478
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/NXTxEGIxKh-uWJrKMxinfS0p/bodyweightLOINCerror.png\" target=\"_blank\" title=\"bodyweightLOINCerror.png\">bodyweightLOINCerror.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/NXTxEGIxKh-uWJrKMxinfS0p/bodyweightLOINCerror.png\" target=\"_blank\" title=\"bodyweightLOINCerror.png\"><img src=\"/user_uploads/10155/NXTxEGIxKh-uWJrKMxinfS0p/bodyweightLOINCerror.png\"></a></div>",
        "id": 153916439,
        "sender_full_name": "Harri Honko",
        "timestamp": 1509105553
    },
    {
        "content": "<p>The json leading to the error is attached here. If we remove the forward slash from the end of \"<a href=\"http://loinc.org/\" target=\"_blank\" title=\"http://loinc.org/\">http://loinc.org/</a>\" in Observation.code.coding.system (as the server suggests) then server responses with an internal error. <a href=\"/user_uploads/10155/ZT3y8AnKbq4iFA1V46LBIlue/malli.json\" target=\"_blank\" title=\"malli.json\">malli.json</a></p>",
        "id": 153916440,
        "sender_full_name": "Timo Aaltonen",
        "timestamp": 1509106142
    },
    {
        "content": "<p>have you read the error?</p>",
        "id": 153916549,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1509136085
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/BL3AypsMtz7VP2VTjydzepwt/500.png\" target=\"_blank\" title=\"500.png\">500.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/BL3AypsMtz7VP2VTjydzepwt/500.png\" target=\"_blank\" title=\"500.png\"><img src=\"/user_uploads/10155/BL3AypsMtz7VP2VTjydzepwt/500.png\"></a></div>",
        "id": 153916697,
        "sender_full_name": "Timo Aaltonen",
        "timestamp": 1509351376
    },
    {
        "content": "<p>There are two issues at play here. It looks like what you are doing is fine. Unfortunately there were multiple versions of the same profiles stored in the sandbox environment. In that case it is random which one the resource server ends up using. I have removed the duplicate profiles from sandbox.</p>\n<p>However another issue remains. In the latest update  we added a feature which adds the software (i.e. the client) used to store the resource. If the non authorizing version <a href=\"http://fhirsandbox.kanta.fi\" target=\"_blank\" title=\"http://fhirsandbox.kanta.fi\">http://fhirsandbox.kanta.fi</a>. is used we don't know which client is used to store the data and this causes the error. We have our main focus in the production version of the applications so unfortunately this use case has been overlooked during development. We are working toward releasing a fix for this this wednesday (1.11.2017).</p>",
        "id": 153916734,
        "sender_full_name": "Matti Uusitalo",
        "timestamp": 1509359655
    },
    {
        "content": "<p>We're probably best off to turn using the authorizing version to get things progressing. No big issue, we should have the necessary OAuth registration already done. <span class=\"user-mention\" data-user-id=\"194314\">@Timo Aaltonen</span> will confirm &amp; move things onwards (I'm busy Tue-Wed with other projects).</p>",
        "id": 153916793,
        "sender_full_name": "Harri Honko",
        "timestamp": 1509384032
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197084\">@Matti Uusitalo</span>  Should the issue with creating resources in non-authorizing sandbox be resolved now?</p>",
        "id": 153922047,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1511964193
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention\" data-user-id=\"197084\">@Matti Uusitalo</span>  Should the issue with creating resources in non-authorizing sandbox be resolved now?</p>\n</blockquote>\n<p>Yes, it works now.</p>",
        "id": 153922050,
        "sender_full_name": "Matti Uusitalo",
        "timestamp": 1511964886
    },
    {
        "content": "<p>Thanks! There's probably something wrong with the profile I'm trying to submit. Validation provided by the server does not help much, as POST to <a href=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/StructureDefinition/$validate\" target=\"_blank\" title=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/StructureDefinition/$validate\">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/StructureDefinition/$validate</a> returns just \"{<br>\n  \"resourceType\": \"OperationOutcome\",<br>\n  \"issue\": [<br>\n    {<br>\n      \"severity\": \"error\",<br>\n      \"code\": \"processing\"<br>\n    }<br>\n  ]<br>\n}\"</p>",
        "id": 153922105,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1511974401
    },
    {
        "content": "<p>If you can provide exact timestamp for the request we can check the logs on the server side for more info - the error handling is probably a bit too strict right now.</p>\n<p>(Edit: strict as in doesn't give enough information for the caller)</p>",
        "id": 153922149,
        "sender_full_name": "Eeva Turkka",
        "timestamp": 1511986337
    },
    {
        "content": "<p>And also: did you try to create the profile? We don't yet support the validation-operation (<a href=\"https://simplifier.net/FinnishPHR/capabilitystatement3\" target=\"_blank\" title=\"https://simplifier.net/FinnishPHR/capabilitystatement3\">https://simplifier.net/FinnishPHR/capabilitystatement3</a>) so this might be a case of really bad error message.</p>",
        "id": 153922152,
        "sender_full_name": "Eeva Turkka",
        "timestamp": 1511986617
    },
    {
        "content": "<p>Yes, I first did try to create the resource. And got the same error message.</p>",
        "id": 153922233,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1512022279
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192917\">@Mikael Rinnetmäki</span> Could you attach the resource  file you tried to submit here?</p>",
        "id": 153925117,
        "sender_full_name": "Mika Tuomainen",
        "timestamp": 1513238495
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192558\">@Mika Tuomainen</span> I got the StructureDefinition uploaded. It's now in sandbox as <a href=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/StructureDefinition/fefa2acf-7209-47c1-9cee-4cf736330c51\" target=\"_blank\" title=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/StructureDefinition/fefa2acf-7209-47c1-9cee-4cf736330c51\">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/StructureDefinition/fefa2acf-7209-47c1-9cee-4cf736330c51</a>.</p>",
        "id": 153926644,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1513857885
    },
    {
        "content": "<p>I did try to specify the id as instructed at <a href=\"http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille\" target=\"_blank\" title=\"http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille\">http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille</a>:</p>\n<blockquote>\n<p>\"The id of the profile (element <a href=\"http://StructuredDefinition.id\" target=\"_blank\" title=\"http://StructuredDefinition.id\">StructuredDefinition.id</a>) must be the same as the last part of the URL\"<br>\nBoth by specifying it in resource data, and in the separate field in the server UI, but the resource still gets stored under a UUID id.</p>\n</blockquote>",
        "id": 153926645,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1513858140
    }
]