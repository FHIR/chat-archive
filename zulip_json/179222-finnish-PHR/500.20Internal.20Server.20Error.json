[
    {
        "content": "<p>Hi,</p>\n<p>I have been developing fhir json import and export to medical software. Patient information for import and export are already working (Our software gives validate FHIR json-file and that can be PUT to kanta test server). Now it's time to move on study information. My first idea was to create bundle containing all the different observations from our study data. Kanta does not seem to support bundle at all. The idea was be able to upload all the observations at once. Now I'm planning to do multiple observation resource files all referring to patient they belong. Is there any other way to do that? Or does someone have better idea to implement this?</p>\n<p>While trying to figure out how to implement importing and exporting of study. I have been trying to upload simple observation for BMI. </p>\n<p>I'm using POST to: <a href=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\" target=\"_blank\" title=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation</a><br>\njson:</p>\n<p><code>{\n  \"resourceType\": \"Observation\",\n  \"meta\": {\n    \"profile\": [\n      \"http://hl7.org/fhir/StructureDefinition/vitalsigns\"\n    ]\n  },\n  \"text\": {\n    \"status\": \"generated\",\n    \"div\": \"&lt;div xmlns='http://www.w3.org/1999/xhtml'&gt;&lt;a name='mm'/&gt;&lt;/div&gt;\"\n  },\n  \"status\": \"final\",\n  \"category\": [\n    {\n      \"coding\": [\n        {\n          \"code\": \"vital-signs\",\n          \"system\": \"http://hl7.org/fhir/observation-category\",\n          \"display\": \"Vital Signs\"\n        }\n      ]\n    }\n  ],\n  \"subject\": {\n    \"reference\": \"Patient/907e5750-0c82-1000-a37d-6c5500005666\"\n  },\n  \"performer\": [\n    {\n      \"reference\": \"Patient/907e5750-0c82-1000-a37d-6c5500005666\"\n    }\n  ],\n  \"code\": {\n    \"coding\": [\n      {\n        \"code\": \"39156-5\",\n        \"system\": \"http://loinc.org\",\n        \"display\": \"Body mass index (BMI) [Ratio]\"\n      }\n    ],\n    \"text\": \"BMI ratio\"\n  },\n  \"issued\": \"2018-09-18T14:05:26+03:00\",\n  \"valueQuantity\": {\n    \"value\": 16,\n    \"unit\": \"kg/m2\"\n  },\n  \"comment\": \"Some comment here\"\n}</code></p>\n<p>This should be valid fhir and it can be uploaded to other test server.</p>\n<p>Kanta test Server gives: 500 Internal Server Error as a return.<br>\nA generic error message, given when no more specific message is suitable. </p>\n<p>So I don't get any information what is wrong with this observation. Can anyone help and tell me what seems to be the problem with this resource? Am I missing something obvious here? Thanks!</p>",
        "id": 153997588,
        "sender_full_name": "Lauri Karppinen",
        "timestamp": 1537272075
    },
    {
        "content": "<p>Not sure whether that's the issue, but I don't see a profile defined for BMI in <a href=\"https://simplifier.net/finnishphr/~resources?category=Profile\" target=\"_blank\" title=\"https://simplifier.net/finnishphr/~resources?category=Profile\">https://simplifier.net/finnishphr/~resources?category=Profile</a>. There are profiles for body height and body weight, but not for BMI. I've understood you can't store anything in the Finnish PHR unless a suitable profile exists on the platform.</p>",
        "id": 153997697,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1537292294
    },
    {
        "content": "<p>I tried to have a conversation especially on the vital signs on the platform in the past, as I had understood that that's the one single profile definition that should be implemented identically across all FHIR implementations, but that discussion did not really lead to anything...</p>",
        "id": 153997699,
        "sender_full_name": "Mikael Rinnetmäki",
        "timestamp": 1537292613
    },
    {
        "content": "<p>I can check the logs why you are getting the error if you message me with more precise point in time, but the correct POST should have /Observation as in  POST <a href=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\" target=\"_blank\" title=\"http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation\">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation</a> ?</p>",
        "id": 153997944,
        "sender_full_name": "Eeva Turkka",
        "timestamp": 1537335875
    },
    {
        "content": "<p>And yes, a resource needs to have a  <a href=\"http://phr.kanta.fi\" target=\"_blank\" title=\"http://phr.kanta.fi\">http://phr.kanta.fi</a> -profile refrenced.</p>",
        "id": 153997945,
        "sender_full_name": "Eeva Turkka",
        "timestamp": 1537336142
    },
    {
        "content": "<p>Thanks! This seems to be the problem. I try to demo with height/weight today after I get other stuff done. It seems like we have lot of values in our software  which are not supported in Kanta. Thanks.</p>",
        "id": 153997946,
        "sender_full_name": "Lauri Karppinen",
        "timestamp": 1537336854
    },
    {
        "content": "<p>I had \"/Observation\" in the link. Just forgot to put it in my chat post. By the way do you prefer using english in here?</p>",
        "id": 153997947,
        "sender_full_name": "Lauri Karppinen",
        "timestamp": 1537337038
    },
    {
        "content": "<p>I tested with Body weight and I get the same error (500 Internal Server Error).  </p>\n<p><code>{\n  \"resourceType\": \"Observation\",\n  \"meta\": {\n    \"profile\": [\n      \"http://hl7.org/fhir/StructureDefinition/vitalsigns\"\n    ]\n  },\n  \"text\": {\n    \"status\": \"generated\",\n    \"div\": \"&lt;div xmlns='http://www.w3.org/1999/xhtml'&gt;Weight&lt;a name='mm'/&gt;&lt;/div&gt;\"\n  },\n  \"subject\": {\n    \"reference\": \"Patient/907e5750-0c82-1000-a37d-6c5500005666\"\n  },\n  \"code\": {\n    \"coding\": [\n      {\n        \"code\": \"29463-7\",\n        \"system\": \"http://loinc.org\",\n        \"display\": \"Body weight\"\n      }\n    ]\n  },\n  \"valueQuantity\": {\n    \"system\": \"http://unitsofmeasure.org\",\n    \"value\": \"82\",\n    \"unit\": \"kg\"\n  },\n  \"status\": \"final\"\n}</code></p>\n<p>This should be valid FHIR and supported in: <a href=\"https://simplifier.net/finnishphr/fiphr-bodyweight-stu3\" target=\"_blank\" title=\"https://simplifier.net/finnishphr/fiphr-bodyweight-stu3\">https://simplifier.net/finnishphr/fiphr-bodyweight-stu3</a></p>",
        "id": 153997949,
        "sender_full_name": "Lauri Karppinen",
        "timestamp": 1537338904
    },
    {
        "content": "<p>The profile needs to be referenced in the meta,</p>\n<p>\"meta\": {<br>\n    \"profile\": [<br>\n      \"<a href=\"http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3\" target=\"_blank\" title=\"http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3\">http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3</a>\"<br>\n    ]</p>\n<p>this was just saved ok: </p>\n<p>{<br>\n  \"resourceType\": \"Observation\",<br>\n  \"meta\": {<br>\n    \"profile\": [<br>\n      \"<a href=\"http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3\" target=\"_blank\" title=\"http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3\">http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3</a>\"<br>\n    ]<br>\n  },<br>\n  \"language\": \"fi\",<br>\n  \"text\": {<br>\n    \"status\": \"generated\",<br>\n    \"div\": \"&lt;div&gt;Code: Body weight (29463-7)&lt;br /&gt;Time: 20.11.2017 11:46&lt;br /&gt;Result: 78 kg&lt;/div&gt;\"<br>\n  },<br>\n  \"identifier\": [<br>\n    {<br>\n      \"system\": \"urn:ietf:rfc:3986\",<br>\n      \"value\": \"urn:uuid:3aa26139-13ed-4f2a-bdf4-11dd5fd40f0f\"<br>\n    }<br>\n  ],<br>\n  \"status\": \"final\",<br>\n  \"category\": [<br>\n    {<br>\n      \"coding\": [<br>\n        {<br>\n          \"code\": \"vital-signs\",<br>\n          \"system\": \"<a href=\"http://hl7.org/fhir/observation-category\" target=\"_blank\" title=\"http://hl7.org/fhir/observation-category\">http://hl7.org/fhir/observation-category</a>\"<br>\n        }<br>\n      ]<br>\n    }<br>\n  ],<br>\n  \"code\": {<br>\n    \"coding\": [<br>\n      {<br>\n        \"code\": \"29463-7\",<br>\n        \"display\": \"Body weight\",<br>\n        \"system\": \"<a href=\"http://loinc.org\" target=\"_blank\" title=\"http://loinc.org\">http://loinc.org</a>\"<br>\n      }<br>\n    ]<br>\n  },<br>\n  \"subject\": {<br>\n    \"reference\": \"Patient/91db836a-b62a-49af-8e7a-a94ed90a41d5\"<br>\n  },<br>\n  \"effectiveDateTime\": \"2017-11-20T11:46:00+02:00\",<br>\n  \"issued\": \"2017-11-20T11:46:00+02:00\",<br>\n  \"performer\": [<br>\n    {<br>\n      \"reference\": \"Patient/91db836a-b62a-49af-8e7a-a94ed90a41d5\"<br>\n    }<br>\n  ],<br>\n  \"valueQuantity\": {<br>\n    \"value\": 78,<br>\n    \"unit\": \"kg\",<br>\n    \"system\": \"<a href=\"http://unitsofmeasure.org\" target=\"_blank\" title=\"http://unitsofmeasure.org\">http://unitsofmeasure.org</a>\",<br>\n    \"code\": \"kg\"<br>\n  }<br>\n}</p>",
        "id": 153997950,
        "sender_full_name": "Eeva Turkka",
        "timestamp": 1537339235
    },
    {
        "content": "<p>If you need more values supported they can be proposed by interested parties, see here: <a href=\"https://www.kanta.fi/en/system-developers/development-of-the-national-data-content\" target=\"_blank\" title=\"https://www.kanta.fi/en/system-developers/development-of-the-national-data-content\">https://www.kanta.fi/en/system-developers/development-of-the-national-data-content</a> . Both English and Finnish are fine here.</p>",
        "id": 153997951,
        "sender_full_name": "Eeva Turkka",
        "timestamp": 1537339389
    },
    {
        "content": "<p>Kiitos avusta! Viittasin tosiaan aivan väärään osoitteeseen structure defenitionin osalta. Ei ihme, ettei serveri osannut kertoa, mikä oli pielessä. Ja kiitos myös linkistä. Selvitän mille kaikelle tiedolle tarvitsemme tuen, ja teemme lisäysehdoitukset kantaan.</p>",
        "id": 153998030,
        "sender_full_name": "Lauri Karppinen",
        "timestamp": 1537347513
    }
]