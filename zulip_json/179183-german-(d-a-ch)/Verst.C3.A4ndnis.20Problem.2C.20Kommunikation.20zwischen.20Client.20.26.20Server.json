[
    {
        "content": "<p>Hallo zusammen, <br>\nich steh gerade etwas auf dem Schlauch.<br>\nIch möchte einen Patienten mit einigen Observations an den Server geben.<br>\nDie Observations haben eine Referenz auf den Patienten. <br>\nIch erstelle ein Bundle für die Transaktion und gebe es an den Server.<br>\nWenn ich nun den Patienten suche, finde ich diesen auch, aber nichts von den Observations.</p>\n<p>Muss ich dem Patienten auch eine Referenz auf die Observations geben? (Wenn ja, wie geht das wenn ich mehrere Observations habe?)</p>\n<p>Ich glaube ich hab hier ein Verständnis Problem.</p>\n<p>Mein Ziel wäre es clientseitig über z. B. die Patienten - Id, alle Observations abrufen zu können, geht das denn überhaupt?</p>\n<p>Oder gibt es eine Möglichkeit eine Art Observation-Array zu erstellen, das ich nur einmal referenzier und somit beliebig viele Observations an einen Patienten übergeben kann und darüber auch abrufen?</p>\n<p>Vielen Dank für eure Hilfe.</p>",
        "id": 244966656,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1625512519
    },
    {
        "content": "<p>Wäre es möglich das Transaction Bundle hier zu posten? Dann können wir gerne drüber gucken wo es klemmt. Eigentlich wollte der Server sowohl die Patienten-Ressource als auch die Observations innerhalb der Transaction speichern.</p>",
        "id": 244969492,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1625515181
    },
    {
        "content": "<p>Über das sogenannte Chaining lässt sich auch eine Suchabfrage aller Observations anhand der Id der Patienten-Ressource durchführen:</p>\n<p><code>[base]/Observation?patient.id=1234</code></p>\n<p>Diese Suchanfrage würde alle Observations zurückgeben, die über die Observation.subject Referenz auf einen Patienten zeigen mit der ID 1234.</p>",
        "id": 244969790,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1625515399
    },
    {
        "content": "<p>Siehe <a href=\"https://www.hl7.org/fhir/search.html#chaining\">https://www.hl7.org/fhir/search.html#chaining</a></p>",
        "id": 244969795,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1625515405
    },
    {
        "content": "<p>Hallo, natürlich die Code-Zeilen sehen wie folgt aus:</p>\n<p>val bundle: org.hl7.fhir.r4.model.Bundle = org.hl7.fhir.r4.model.Bundle()<br>\n            bundle.setType(org.hl7.fhir.r4.model.Bundle.BundleType.TRANSACTION)</p>\n<p>//Patient zum Bundle hinzufügen<br>\nbundle.addEntry().setFullUrl(patientTest.idElement.value).setResource(patientTest)<br>\n                .request.setUrl(\"PatientTest\").setIfNoneExist(\"identifier=WunddokuHSKE|301180\")<br>\n                .setMethod(org.hl7.fhir.r4.model.Bundle.HTTPVerb.POST)</p>\n<p>//Observation zum Bundle hinzufügen<br>\n bundle.addEntry().setResource(observation).getRequest().setUrl(\"Observation\").setMethod(org.hl7.fhir.r4.model.Bundle.HTTPVerb.POST)</p>\n<p>//weiter Observation zum Bundle hinzufügen<br>\nbundle.addEntry().setResource(testObservation).getRequest().setUrl(\"TestObservation\").setMethod(org.hl7.fhir.r4.model.Bundle.HTTPVerb.POST)<br>\n            bundle.addEntry().setResource(testObservation2).request.setUrl(\"TestObservation2\").setMethod(org.hl7.fhir.r4.model.Bundle.HTTPVerb.POST)</p>\n<p>Oder meinten Sie den Inhalt des Bundle nach einem parsen /prettyprint?</p>\n<p>Schon mal vielen Dank Ihnen</p>",
        "id": 245010391,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1625560990
    },
    {
        "content": "<p>Gerne nach der Serialisierung als JSON/XML hier posten! Dann können andere Leser das Szenario einfach nachstellen und testen :-)</p>",
        "id": 245019921,
        "sender_full_name": "Yannick Börner",
        "timestamp": 1625567346
    },
    {
        "content": "<p>Okay, das ist die Aussgabe dazu mit JSON (prettyprint):</p>\n<p>{<br>\n      \"resourceType\": \"Bundle\",<br>\n      \"type\": \"transaction\",<br>\n      \"entry\": [ {<br>\n        \"fullUrl\": \"urn:uuid:f13e06af-f1a1-4e81-8c64-2f838df5035d\",<br>\n        \"resource\": {<br>\n          \"resourceType\": \"Patient\",<br>\n          \"identifier\": [ {<br>\n            \"system\": \"Wunddoku\",<br>\n            \"value\": \"301180\"<br>\n          } ],<br>\n          \"name\": [ {<br>\n            \"family\": \"Schütz\",<br>\n            \"given\": [ \"dbuar\", \"Klaus\" ]<br>\n          } ],<br>\n          \"gender\": \"male\",<br>\n          \"address\": [ {<br>\n            \"city\": \"K-Town\",<br>\n            \"state\": \"Bayern\",<br>\n            \"postalCode\": \"01234\",<br>\n            \"country\": \"Germany\"<br>\n          } ]<br>\n        },<br>\n        \"request\": {<br>\n          \"method\": \"POST\",<br>\n          \"url\": \"PatientTest\",<br>\n          \"ifNoneExist\": \"identifier=Wunddoku|301180\"<br>\n        }<br>\n      }, {<br>\n        \"resource\": {<br>\n          \"resourceType\": \"Observation\",<br>\n          \"status\": \"final\",<br>\n          \"code\": {<br>\n            \"coding\": [ {<br>\n              \"system\": \"test-??\",<br>\n              \"code\": \"888888\",<br>\n              \"display\": \"das gehört zu ... [#/volume]\"<br>\n            } ]<br>\n          },<br>\n          \"subject\": {<br>\n            \"reference\": \"urn:uuid:f13e06af-f1a1-4e81-8c64-2f838df5035d\"<br>\n          },<br>\n          \"valueQuantity\": {<br>\n            \"value\": 4.12,<br>\n            \"unit\": \"10 trillion/L\",<br>\n            \"system\": \"wieder eine setSystem URL - Test\",<br>\n            \"code\": \"10*12/L\"<br>\n          }<br>\n        },<br>\n        \"request\": {<br>\n          \"method\": \"POST\",<br>\nI/System.out:       \"url\": \"Observation\"<br>\n        }<br>\n      }, {<br>\n        \"resource\": {<br>\n          \"resourceType\": \"Observation\",<br>\n          \"status\": \"final\",<br>\n          \"code\": {<br>\n            \"coding\": [ {<br>\n              \"system\": \"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\",<br>\n              \"code\": \"420226006\"<br>\n            } ]<br>\n          },<br>\n          \"subject\": {<br>\n            \"reference\": \"urn:uuid:f13e06af-f1a1-4e81-8c64-2f838df5035d\"<br>\n          },<br>\n          \"valueQuantity\": {<br>\n            \"value\": 88.0,<br>\n            \"system\": \"<a href=\"http://unitsofmeasure.org\">http://unitsofmeasure.org</a>\",<br>\n            \"code\": \"kg\"<br>\n          },<br>\n          \"referenceRange\": [ {<br>\n            \"low\": {<br>\n              \"value\": 45,<br>\n              \"system\": \"<a href=\"http://unitsofmeasure.org\">http://unitsofmeasure.org</a>\",<br>\n              \"code\": \"kg\"<br>\n            },<br>\n            \"high\": {<br>\n              \"value\": 90,<br>\n              \"system\": \"<a href=\"http://unitsofmeasure.org\">http://unitsofmeasure.org</a>\",<br>\n              \"code\": \"kg\"<br>\n            }<br>\n          } ]<br>\n        },<br>\n        \"request\": {<br>\n          \"method\": \"POST\",<br>\n          \"url\": \"TestObservation\"<br>\n        }<br>\n      }, {<br>\n        \"resource\": {<br>\n          \"resourceType\": \"Observation\",<br>\n          \"status\": \"final\",<br>\n          \"code\": {<br>\n            \"coding\": [ {<br>\n              \"system\": \"<a href=\"http://test.code\">http://test.code</a>\",<br>\n              \"code\": \"TestCode\"<br>\n            } ]<br>\n          },<br>\n          \"subject\": {<br>\n            \"reference\": \"urn:uuid:f13e06af-f1a1-4e81-8c64-2f838df5035d\"<br>\n          },<br>\n          \"valueString\": \"TestObservation2!!!!\"<br>\n        },<br>\n        \"request\": {<br>\n          \"method\": \"POST\",<br>\n          \"url\": \"TestObservation2\"<br>\n        }<br>\n      } ]<br>\n    }</p>\n<p>Das ist die Ausgabe, wenn ich nur den Patienten ausgebe:</p>\n<p>{<br>\n      \"resourceType\": \"Patient\",<br>\n      \"identifier\": [ {<br>\n        \"system\": \"Wunddoku\",<br>\n        \"value\": \"301180\"<br>\n      } ],<br>\n      \"name\": [ {<br>\n        \"family\": \"Schütz\",<br>\n        \"given\": [ \"dbuar\", \"Klaus\" ]<br>\n      } ],<br>\n      \"gender\": \"male\",<br>\n      \"address\": [ {<br>\n        \"city\": \"K-Town\",<br>\n        \"state\": \"Bayern\",<br>\n        \"postalCode\": \"01234\",<br>\n        \"country\": \"Germany\"<br>\n      } ]<br>\n    }</p>",
        "id": 245024633,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1625570620
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"193430\">Alexander Zautke</span> <a href=\"#narrow/stream/179183-german-.28d-a-ch.29/topic/Verst.C3.A4ndnis.20Problem.2C.20Kommunikation.20zwischen.20Client.20.26.20Server/near/244969790\">said</a>:</p>\n<blockquote>\n<p>Über das sogenannte Chaining lässt sich auch eine Suchabfrage aller Observations anhand der Id der Patienten-Ressource durchführen:</p>\n<p><code>[base]/Observation?patient.id=1234</code></p>\n<p>Diese Suchanfrage würde alle Observations zurückgeben, die über die Observation.subject Referenz auf einen Patienten zeigen mit der ID 1234.</p>\n</blockquote>\n<p>Hab das gerade ausprobiert, hat super funktioniert, habe dazu RESTClient als Firefox Addon verwendet. Dakeschön</p>",
        "id": 245025181,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1625570999
    },
    {
        "content": "<p>Ich habe nun soweit ein paar Punkte getestet und es scheint zu funktionieren, auch die Observations habe ich finden können über den Patienten. </p>\n<p>Was mir dennoch unklar ist, ich habe zwar in der Dokumentation die Ressourcen Group, List und Composition gefunden, bin mir aber nicht sicher ob ich diese dann richtig verwende.</p>\n<p>Wie kurz angesprochen möchte ich einem Patienten einige Observations mitgeben, z. B. Wundfarbe, Wundexsudat, länge der Wunde, breite der Wunde usw.. dazu würde ich eine Observation wie folgt nutzten:</p>\n<p>//Observation erstellen<br>\ntestObservation.valueStringType.setValue(\"TestObservation!!!\")<br>\ntestObservation.setStatus(Observation.ObservationStatus.FINAL)<br>\nvar coding : Coding = testObservation.code.addCoding()<br>\ncoding.setCode(\"420226006\").setSystem(\"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\")</p>\n<p>//Referenz zum Patienten erstellen<br>\ntestObservation.setSubject(Reference(patientTest.getIdElement().value))</p>\n<p>//Observation an Bundle geben<br>\nbundle.addEntry().setResource(testObservation).getRequest().setUrl(\"TestObservation\")<br>\n   .setMethod(org.hl7.fhir.r4.model.Bundle.HTTPVerb.POST)</p>\n<p>Sollte ich hier nun dies so für alle Observations machen (es könnten schon bis zu 30 sein), oder gibt es hierfür eine andere Ressource?<br>\nÜbersehe ich etwas?</p>\n<p>Danke für Ihre Hilfe</p>",
        "id": 245030537,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1625574352
    },
    {
        "content": "<p>Wo kommen diese Endpunkte her? z.B.:</p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;request&quot;: {\n&quot;method&quot;: &quot;POST&quot;,\n&quot;url&quot;: &quot;PatientTest&quot;,\n ...\n}\n</code></pre></div>\n<p>oder </p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;request&quot;: {\n&quot;method&quot;: &quot;POST&quot;,\n&quot;url&quot;: &quot;TestObservation&quot;\n}\n</code></pre></div>\n<p>Endpunkt für einen bestimmten Ressourcentyp ist immer [base]/[Name des Ressourcentyps], vgl. Abschnitt 3.1.0.1.2 Service Base URL unter <a href=\"http://www.hl7.org/fhir/http.html#general\">http://www.hl7.org/fhir/http.html#general</a> oder das Transaction-Bundle-Beispiel: <a href=\"http://www.hl7.org/fhir/bundle-transaction.xml.html\">http://www.hl7.org/fhir/bundle-transaction.xml.html</a></p>\n<p>Ist das ein selbst implementierter Server?</p>",
        "id": 245055651,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1625585446
    },
    {
        "content": "<p>Ich nutze zum testen den R4, kein selbst implementierter Server.<br>\nDie Übermittlung der Daten erfolgt über die Android App die gerade programmiere, welche Kotlin als Sprache verwendet.</p>\n<p>Okay, ich werde mir Ihre links nochmal anschauen, Danke.</p>\n<p>Die Werte werden aufgrund der im obigen Post erwähnten Codezeilen erstellt.</p>\n<p>//Observation erstellen<br>\ntestObservation.valueStringType.setValue(\"TestObservation!!!\")                     &lt;-- Hier<br>\ntestObservation.setStatus(Observation.ObservationStatus.FINAL)<br>\nvar coding : Coding = testObservation.code.addCoding()<br>\ncoding.setCode(\"420226006\").setSystem(\"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\")</p>\n<p>//Observation an Bundle geben<br>\nbundle.addEntry().setResource(testObservation).getRequest().setUrl(\"TestObservation\")           &lt;-- und hier<br>\n.setMethod(org.hl7.fhir.r4.model.Bundle.HTTPVerb.POST)</p>\n<p>Wie gesagt, nur Beispielwerte um zunächst das Konzept zu testen.</p>",
        "id": 245059739,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1625587093
    },
    {
        "content": "<p>Was ist denn \"der R4\"? R4 bezeichnet die 4. Version von FHIR (davor kamen STU3 und DSTU2). FHIR-Server sind z. B.  HAPI oder Firely.</p>\n<p>Man kann nicht einfach so einen eigenen Ressourcentyp \"TestObservation\" erstellen. Der Ressourcentyp muss in jedem Fall \"Observation\" sein. Man kann dann einfach die Ressource mit den Testdaten befüllen, oder z. B. zur Nachverfolgbarkeit meta.tag = \"TestObservation\" setzen.</p>",
        "id": 245647908,
        "sender_full_name": "Abel Stolz",
        "timestamp": 1626069446
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"256468\">Abel Stolz</span> <a href=\"#narrow/stream/179183-german-.28d-a-ch.29/topic/Verst.C3.A4ndnis.20Problem.2C.20Kommunikation.20zwischen.20Client.20.26.20Server/near/245647908\">said</a>:</p>\n<blockquote>\n<p>Was ist denn \"der R4\"? R4 bezeichnet die 4. Version von FHIR (davor kamen STU3 und DSTU2). FHIR-Server sind z. B.  HAPI oder Firely.</p>\n<p>Man kann nicht einfach so einen eigenen Ressourcentyp \"TestObservation\" erstellen. Der Ressourcentyp muss in jedem Fall \"Observation\" sein. Man kann dann einfach die Ressource mit den Testdaten befüllen, oder z. B. zur Nachverfolgbarkeit meta.tag = \"TestObservation\" setzen.</p>\n</blockquote>\n<p>Verzeihung dies war mir nicht bewusst. Ich meinte natürlich den HAPI TestServer mit der Base: <a href=\"http://hapi.fhir.org/baseR4\">http://hapi.fhir.org/baseR4</a>.</p>\n<p>Ich lege z. B. eine Observation wie folgt an:</p>\n<p>private lateinit var wundexsudatObservation : Observation</p>\n<div class=\"codehilite\"><pre><span></span><code>  //Observation Wundexsudat\n    wundexsudatObservation = Observation()\n    wundexsudatObservation.setSubject(Reference(patientTEST1.getIdElement().value))\n    wundexsudatObservation.valueStringType.value = &quot;Wundexsudat Menge&quot;\n    wundexsudatObservation.status = Observation.ObservationStatus.FINAL\n    var wundexsudatCoding : Coding = wundexsudatObservation.code.addCoding()\n    when(pWundexsudat != &quot;Bitte auswählen!&quot;){\n        wundexsudat_sp.selectedItemPosition == 1 -&gt; {\n            wundexsudatCoding.setCode(&quot;260413007&quot;).setSystem(&quot;http://snomed.info/sct&quot;)\n        }\n        wundexsudat_sp.selectedItemPosition == 2 -&gt; {\n            wundexsudatCoding.setCode(&quot;255507004&quot;).setSystem(&quot;http://snomed.info/sct&quot;)\n        }\n        wundexsudat_sp.selectedItemPosition == 3 -&gt; {\n            wundexsudatCoding.setCode(&quot;255508009&quot;).setSystem(&quot;http://snomed.info/sct&quot;)\n        }\n        wundexsudat_sp.selectedItemPosition == 4 -&gt; {\n            wundexsudatCoding.setCode(&quot;kein Code hierfür aber soltle moderat sein&quot;).setSystem(&quot;snomed hat nur 4 Stufen&quot;)\n        }\n        wundexsudat_sp.selectedItemPosition == 5 -&gt; {\n            wundexsudatCoding.setCode(&quot;255509001&quot;).setSystem(&quot;http://snomed.info/sct&quot;)\n        }\n    }\n</code></pre></div>\n\n<p>Und das ausgegebene Ergebnis sieht dann so aus:</p>\n<p>\"resource\": {<br>\n          \"resourceType\": \"Observation\",<br>\n          \"status\": \"final\",<br>\n          \"code\": {<br>\n            \"coding\": [ {<br>\n              \"system\": \"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\",<br>\n              \"code\": \"255508009\"<br>\n            } ]<br>\n          },<br>\n          \"valueString\": \"Wundexsudat Menge\"<br>\n        }</p>\n<p>Ist das nicht korrekt?<br>\n(Ich möchte aktuell nicht nach irgend welchen Standards validieren oder ähnliches, die App, die diesen Code erzeugt, ist nur für Testzwecke um eine Kommunikation mit dem Server zu testen)</p>",
        "id": 246243453,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1626451581
    },
    {
        "content": "<p>Nach dem Simplifier-Validator ist das korrekt (Standard R4.0.1), nach visueller Kontrolle und Abgleich mit <a href=\"http://hl7.org/fhir/observation.html\">http://hl7.org/fhir/observation.html</a> auch. Das Problem ist: Man kann nicht wirklich sagen, ob die Ressource korrekt ist, wenn man sie nicht nach irgendeinem Standard misst. Ich habe also Core R4.0.1 genommen. Wenn es nur um die Kommunikation mit dem Server geht, dann verstehe ich nicht, wieso sich die Frage nach der Korrektheit überhaupt stellt. Man könnte ja eine inkorrekte Ressource schicken; wenn der Server eine Fehlermeldung schickt, dass die Ressource nicht korrekt ist, hat die Kommunikation funktioniert...</p>",
        "id": 246418569,
        "sender_full_name": "Abel Stolz",
        "timestamp": 1626673966
    },
    {
        "content": "<p>Hallo <span class=\"user-mention\" data-user-id=\"399680\">@Morris Miltz</span>,<br>\nich habe gerade das Gefühl, dass Code und Value durcheinander geraten sind. <br>\n<code>code</code>sagt, um was es sich handelt. Dort müsste stehen, dass es sich um die Menge an Wundexsudat handelt, z.B. mittels des SNOMED CT Codes (441281002) oder LOINC (39116-9). <br>\nDie Menge, im genannten Beispiel \"medium\" (SNOMED-Code 255508009), kommt dann in den <code>value</code> als <code>valueCodeableConcept</code>. <br>\nDaher würde ich die Frage: \"Ist das nicht richtig?\" mit \"Stimmt, das ist nicht richtig\" beantworten.</p>\n<p>Ich habe einmal das Beispiel angepasst, wobei ich im Code sowohl den LOINC- als auch den SNOMED Code hinterlegt habe. </p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;resource&quot;: {\n   &quot;resourceType&quot;: &quot;Observation&quot;,\n   &quot;status&quot;: &quot;final&quot;,\n   &quot;code&quot;: {\n      &quot;coding&quot;: [\n         {\n            &quot;system&quot;: &quot;http://snomed.info/sct&quot;,\n            &quot;code&quot;: &quot;441281002&quot;,\n            &quot;display&quot;: &quot;Amount of exudate&quot;\n         } ,\n         {\n            &quot;system&quot;: &quot;http://loinc.org&quot;,\n            &quot;code&quot;: &quot;39116-9&quot;,\n            &quot;display&quot;: &quot;Drainage amount of Wound&quot;\n         }\n      ]\n   },\n   &quot;valueCodeableConcept&quot;: {\n      &quot;coding&quot;: [\n         {\n            &quot;system&quot;: &quot;http://snomed.info/sct&quot;,\n            &quot;code&quot;: &quot;255508009&quot;,\n            &quot;display&quot;: &quot;medium&quot;\n         }\n      ]\n   }\n}\n</code></pre></div>\n<p>Ich hoffe, die Antwort hilft weiter.<br>\nViele Grüße</p>",
        "id": 246426282,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1626681581
    },
    {
        "content": "<p>Hallo <span class=\"user-mention\" data-user-id=\"196115\">@Mareike Przysucha</span> vielen Dank für die Antwort.<br>\nHabe ich es dann richtig verstanden, dass der innerhalb vom code eben das coding wie snomed und loinc stehen, die dann Angeben was der Code sein soll. Also sozusagen der Überbegriff. Und im valueCodableConcept ich dann Einträge oder \"arten\" habe, die unter den \"Überbegriff\" fallen?</p>\n<p>Bezug auf das obere Beispiel, hier hätte ich für das coding den snomed 441...<br>\nUnd im valueCodableConcept dann denn 255.. mit medium, ist das dann so dass ich mehrere valueCodableConept erstellen kann. Also für z. B. high und low auch?</p>\n<p>Vielen Dank nochmal :)</p>",
        "id": 246427754,
        "sender_full_name": "Morris Miltz",
        "timestamp": 1626682700
    },
    {
        "content": "<p>Gerne. Du kannst auch im value mehrere codings haben, jedoch sollten diese das gleiche repräsentieren. Wenn Du \"high\" und \"low\" einsetzt, sagst Du, dass bei Wunde XY sowohl viel als auch wenig Exsudat zur gleichen Zeit auftritt. Und das klappt nicht so richtig... Also solltest Du Dich dann auf eines konzentrieren.</p>",
        "id": 246428532,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1626683326
    }
]