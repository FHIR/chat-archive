[
    {
        "content": "<p>Da bin ich schon wieder <span class=\"emoji emoji-1f604\" title=\"smile\">:smile:</span>. In dem <a href=\"https://simplifier.net/medikationsplanplus/medicationstatement-1\" target=\"_blank\" title=\"https://simplifier.net/medikationsplanplus/medicationstatement-1\">MPP-Profil für <code>MedicationStatement</code></a>, hat das Feld <code>dosage</code> die Kardinalität <code>1...5</code>. Ich hatte angenommen, dass man dementsprechend  die Angabe \"1 Tablette Morgens und 1 Tablette Abends\" mit zwei Einträge, die beide dem Slice \"kodiert\" entsprechen, kodieren könnte (siehe Beispiel Unten). Aber im Profil ist die Kardinalität von beide Slices auf <code>0..1</code> festgelegt und dementsprechend fliegt auch einen Fehler beim Validieren (Slice \"kodiert\" kommt zweimal vor, darf aber nur einmal vorkommen). Da der Slicing closed ist, scheint es, dass man nie mehr als zwei Einträge (ein pro Slice) haben könnte. Habe ich was falsch verstanden oder gibt es tatsächlich ein Problem?</p>\n<p>Beispiel: Mögliche Kodierung für Morgens &amp; Abends?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"s2\">&quot;dosage&quot;</span><span class=\"err\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;timing&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n                <span class=\"nt\">&quot;coding&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                    <span class=\"p\">{</span>\n                        <span class=\"nt\">&quot;system&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot; http://hl7.org/fhir/v3/TimingEvent&quot;</span><span class=\"p\">,</span>\n                        <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;CM&quot;</span>\n                    <span class=\"p\">}</span>\n                <span class=\"p\">]</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">},</span>\n        <span class=\"nt\">&quot;doseQuantity&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"err\">...</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">},</span>\n    <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;timing&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n                <span class=\"nt\">&quot;coding&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                    <span class=\"p\">{</span>\n                        <span class=\"nt\">&quot;system&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot; http://hl7.org/fhir/v3/TimingEvent&quot;</span><span class=\"p\">,</span>\n                        <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;CV&quot;</span>\n                    <span class=\"p\">}</span>\n                <span class=\"p\">]</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">},</span>\n        <span class=\"nt\">&quot;doseQuantity&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n            <span class=\"err\">...</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">]</span>\n</pre></div>",
        "id": 154015161,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1541170413
    },
    {
        "content": "<p>Die Absicht ist: es kann 5 verschiedene Anweisungen geben (morgens, mittags abends, nachts, freitext), daher 1..5<br>\nEin MedicationStatement darf aber nicht zwei slices mit Angabe für z.B. \"morgens\" haben, daher ist jeder slice maximal einmal erlaubt.</p>",
        "id": 154015614,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1541424379
    },
    {
        "content": "<p>Ah. Moment...    Wir hatten das ausdifferenzierte Slicing (\"morgens, mittags abends, nachts\") aufgrund von Problemen mit dem Discriminator wieder auf zwei Slices reduziert, nämlich \"kodiert\" und \"freitext\".<br>\nUnd du hast recht: damit müsste der \"kodiert\" slice die Kardinalität 0..4 bekommen, da ein Medikament, ja -worst case- zu allen vier Zeiten eingenommen werden muss...</p>",
        "id": 154015616,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1541424711
    },
    {
        "content": "<p>Auch der fixed value in timing.code.coding.display auf \"morgens\" ist natürlich Quark. Vermutlich ist das beim zurückbauen der Slices aus versehen übrig geblieben...</p>",
        "id": 154015617,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1541424832
    },
    {
        "content": "<p><a href=\"https://github.com/hl7germany/medikationsplanplusplus/issues/59\" target=\"_blank\" title=\"https://github.com/hl7germany/medikationsplanplusplus/issues/59\">https://github.com/hl7germany/medikationsplanplusplus/issues/59</a><br>\n(<span class=\"user-mention\" data-user-id=\"194952\">@Julian Sass</span> , <span class=\"user-mention\" data-user-id=\"191532\">@dr Kai U. Heitmann</span> )</p>",
        "id": 154015620,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1541425101
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191450\">@Simone Heckmann</span> Alles klar, danke! Das mit \"morgens\" hat mich auch etwas verwirrt <span class=\"emoji emoji-1f60f\" title=\"smirk\">:smirk:</span></p>",
        "id": 154015626,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1541425188
    },
    {
        "content": "<p>Aber 1..5 haben wir doch bereits auf der Ebene von dosage?</p>",
        "id": 154015650,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541429568
    },
    {
        "content": "<p>Ja, ist aber ein \"closed\" slicing, daher ist nur erlaubt, was in den Slices definiert ist...</p>",
        "id": 154015677,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1541434287
    },
    {
        "content": "<p>Selbst wenn es \"open\" wäre: wenn das einzelne Slice (wie hier) auf max. 1 constrained ist, wären 2 oder mehr Vorkommen ein Error.</p>",
        "id": 154015679,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1541436124
    },
    {
        "content": "<p>ok, ich glaube ich habe es jetzt verstanden, danke.</p>\n<p>Und sowas wie <br>\n      &lt;slicing&gt;<br>\n        &lt;discriminator&gt;<br>\n          &lt;type value=\"exists\" /&gt;<br>\n          &lt;path value=\"text\" /&gt;<br>\n        &lt;/discriminator&gt;<br>\n        &lt;discriminator&gt;<br>\n          &lt;type value=\"value\" /&gt;<br>\n          &lt;path value=\"timing/code/coding/code\" /&gt;<br>\n        &lt;/discriminator&gt;<br>\n        &lt;rules value=\"closed\" /&gt;<br>\n      &lt;/slicing&gt;<br>\nwurde vermutlich schon ausprobiert...</p>",
        "id": 154015706,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541443300
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193991\">@Christof Gessner</span> : In wie fern wäre das anders als der Status Quo?</p>",
        "id": 154015845,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1541488897
    },
    {
        "content": "<p>Ich glaube, ich wollte damit auf das gleiche hinaus, was du oben als “ausdifferenziertes slicing” bezeichnetest. Also sowohl text als auch den code als discriminator.</p>",
        "id": 154015946,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541524396
    },
    {
        "content": "<p>kleine Anmerkung hierzu: Slicing auf text gilt als bad practice und sollte vermieden werden.</p>",
        "id": 154016060,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1541548137
    },
    {
        "content": "<p>Auch mit discriminator typ exists?</p>",
        "id": 154016139,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541574113
    },
    {
        "content": "<p>FYI: Ich hab die beiden Bugs in der Dosage (Kardinalität 0..4 statt 0..1)  und den fehlerhaften fixed value behoben...<br>\n<a href=\"https://simplifier.net/medikationsplanplus/medicationstatement-1\" target=\"_blank\" title=\"https://simplifier.net/medikationsplanplus/medicationstatement-1\">https://simplifier.net/medikationsplanplus/medicationstatement-1</a></p>",
        "id": 154022091,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1543585395
    }
]