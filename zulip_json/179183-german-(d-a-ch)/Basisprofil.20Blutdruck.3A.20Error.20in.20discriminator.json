[
    {
        "content": "<p>Ich bekomme gerade einen etwas seltsamen Fehler vom neusten Java JAR Validator, wenn ich versuche, eine Beispiel-Resource gegen den Blutdruck-Basisprofil (<a href=\"http://fhir.de/StructureDefinition/observation-de-blutdruck/0.2\" target=\"_blank\" title=\"http://fhir.de/StructureDefinition/observation-de-blutdruck/0.2\">http://fhir.de/StructureDefinition/observation-de-blutdruck/0.2</a>) zu validieren:</p>\n<div class=\"codehilite\"><pre><span></span>*FAILURE* validating examples/bp-base-example.xml:  error:4 warn:0 info:0\n  Error @ Observation.component[1] (line 20, col16) : Error in discriminator at Observation.component:diastolisch.code.coding: slicing found\n  Error @ Observation.component[1] (line 20, col16) : Error in discriminator at Observation.component:systolisch.code.coding: slicing found\n  Error @ Observation.component[2] (line 34, col16) : Error in discriminator at Observation.component:diastolisch.code.coding: slicing found\n  Error @ Observation.component[2] (line 34, col16) : Error in discriminator at Observation.component:systolisch.code.coding: slicing found\n</pre></div>\n\n\n<p>Wenn ich das richtig lese, beschwert er sich hier über den Profil, könnte aber auch einen Bug im Validator sein (<code>$validate</code>auf <a href=\"http://fhir.hl7.de\" target=\"_blank\" title=\"http://fhir.hl7.de\">fhir.hl7.de</a> mit meinem Beispiel geht durch, weiss aber nicht, ob er die Profile hat). Hat jemanden diesen Fehler schon mal gesehen?</p>",
        "id": 154025281,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544693413
    },
    {
        "content": "<p>Beispiel-Resource:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;Observation</span>\n    <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value =</span><span class=\"s\">&quot;http://fhir.de/StructureDefinition/observation-de-blutdruck/0.2&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">&quot;final&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;code&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://loinc.org&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;85354-9&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/code&gt;</span>\n    <span class=\"nt\">&lt;subject&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Patient/patient-example&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/subject&gt;</span>\n    <span class=\"nt\">&lt;effectiveDateTime</span> <span class=\"na\">value=</span><span class=\"s\">&quot;2016-03-21T18:01:10Z&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;performer&gt;</span>\n        <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Practitioner/practitioner-example&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/performer&gt;</span>\n    <span class=\"nt\">&lt;component&gt;</span>\n        <span class=\"nt\">&lt;code&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://loinc.org&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;8462-4&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/code&gt;</span>\n        <span class=\"nt\">&lt;valueQuantity&gt;</span>\n            <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;58&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;unit</span> <span class=\"na\">value=</span><span class=\"s\">&quot;mmHg&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://unitsofmeasure.org&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;mm[Hg]&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/valueQuantity&gt;</span>\n    <span class=\"nt\">&lt;/component&gt;</span>\n    <span class=\"nt\">&lt;component&gt;</span>\n        <span class=\"nt\">&lt;code&gt;</span>\n            <span class=\"nt\">&lt;coding&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://loinc.org&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;8480-6&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/coding&gt;</span>\n        <span class=\"nt\">&lt;/code&gt;</span>\n        <span class=\"nt\">&lt;valueQuantity&gt;</span>\n            <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;111&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;unit</span> <span class=\"na\">value=</span><span class=\"s\">&quot;mmHg&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://unitsofmeasure.org&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;mm[Hg]&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/valueQuantity&gt;</span>\n    <span class=\"nt\">&lt;/component&gt;</span>\n<span class=\"nt\">&lt;/Observation&gt;</span>\n</pre></div>",
        "id": 154025283,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544693847
    },
    {
        "content": "<p>Hallo Morten,</p>\n<p>hast du das Beispiel mal auf Simplifier hochgeladen und validiert? Dann hättest Du eine Zweitmeinung von einem Validator, der das Profil definitiv kennt ;-)</p>",
        "id": 154025303,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1544700214
    },
    {
        "content": "<p>Hi Simone,<br>\nnee, nocht nicht, gute Idee - wie geht das eigentlicht? Meinst Du POST per HTTP-Client  gegen <a href=\"https://stu3.simplifier.net/BasisprofilDE/Patient\" target=\"_blank\" title=\"https://stu3.simplifier.net/BasisprofilDE/Patient\">https://stu3.simplifier.net/BasisprofilDE/Patient</a> oder can ich $validate auf dem URL benutzen? (ich will ja Simplifier nicht zumüllen <span class=\"emoji emoji-1f600\" title=\"grinning\">:grinning:</span>).</p>",
        "id": 154025308,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544700826
    },
    {
        "content": "<p>Simplifier Account anlegen &gt; Sandbox-Projekt erstellen &gt; per upload (c&amp;p) das Beispiel hochladen und dann den Validate-Button verwenden. Ist etwas aufwendiger, aber dafür kannst du uns dann auch den Link zum Beispiel zur Verfügung stellen, und wir können das reproduzieren :)</p>",
        "id": 154025310,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1544700962
    },
    {
        "content": "<p>Ah ja, macht Sinn. Simplifier sagt alles gut - zieht er automatisch den richtigen Profil von dem Basisprofile-Repo?</p>",
        "id": 154025313,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544701371
    },
    {
        "content": "<p>Ah, macht er. Dann sind die Validatoren wohl unterschiedlicher meinung.</p>",
        "id": 154025314,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544701550
    },
    {
        "content": "<p>Ich werfe das mal in den Conformance-Stream, danke für den Tipp!</p>",
        "id": 154025316,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544701796
    },
    {
        "content": "<p>Man kann die Ressourcen auch unter <a href=\"https://simplifier.net/validate\" target=\"_blank\" title=\"https://simplifier.net/validate\">https://simplifier.net/validate</a> per copy&amp;paste validieren lassen. Simplifier-Account ist trotzdem Pflicht. Es wird aber nichts gespeichert.</p>",
        "id": 154025317,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1544701800
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193430\">@Alexander Zautke</span> Danke, gut zu wissen!</p>",
        "id": 154025318,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544701899
    },
    {
        "content": "<p>Validator-Battle Follow-up: <a href=\"#narrow/stream/23-conformance/topic/Java.20validator.20and.20Simplifier.20disagree.20on.20slice.20validity\" title=\"#narrow/stream/23-conformance/topic/Java.20validator.20and.20Simplifier.20disagree.20on.20slice.20validity\">https://chat.fhir.org/#narrow/stream/23-conformance/topic/Java.20validator.20and.20Simplifier.20disagree.20on.20slice.20validity</a></p>",
        "id": 154025328,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544702928
    },
    {
        "content": "<p>Das Profil an sich ist nicht STU3 kompatibel: sdf-20: On StructureDefinition.differential: No slicing on the root element (expression  on StructureDefinition.differential: element.first().slicing.empty())</p>",
        "id": 154025349,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1544709280
    },
    {
        "content": "<p>Dies ist ein Bug im Standard der in R4 gefixt wurde, Firely hat es wohl in ihrer Implementierung gefixt, entspricht also nicht STU3 ;-)</p>",
        "id": 154025351,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1544709331
    },
    {
        "content": "<p>Ich hatte im anderen Stream schon gefragt ob das in STU3 noch gefixt würde, ich bin da aber eher pessimistisch.</p>",
        "id": 154025353,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1544709362
    },
    {
        "content": "<p>Wir könnten workarounds in die Basisprofile einbauen um das Triggern dieses Bugs zu verhindern.</p>",
        "id": 154025354,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1544709424
    },
    {
        "content": "<p>Hi Patrick - aha, <em>der</em> Bug! Habe ich schon mal getroffen, allerdings nur in Zusammenhang mit der Validierung von <code>StructureDefinitions</code>. Woher genau kommt er hier in diesem Kontext? Ich habe mit anderen Blutdruck-Profilen (z.B. Argonaut) rumgespielt, die auch Slicings-in-Slicings haben, und mit dem Java-Validator dagegen validiert, und es hat problemlos geklappt.</p>",
        "id": 154025357,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544710127
    },
    {
        "content": "<p>Einen Validator-Fix wäre sicherlich am schönsten (danke auch für Deinen Kommentar dazu im Implementer-Stream). Wenn das kurzfristig nicht geht  dann wäre Workaround villeicht gar nicht so abwegig. Es ist eine ungute Situation, wenn der vom Spec selbst verlinkten Validator mit einem Standardprofil nicht zurechtkommt (auch wenn der Profil nicht Schuld ist und der Grund bekannt ist), ich habe schon ein paar Stunden damit verbracht und es könnte wohl anderen genauso gehen.</p>",
        "id": 154025358,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1544710523
    },
    {
        "content": "<p>Kann bestätigen, dass sdf-20 in Simplifier \"behoben\" wurde. Die Packages im Hintergrund sind ein wenig verschieden.</p>",
        "id": 154025370,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1544714163
    },
    {
        "content": "<p>Dieser Thread ist ja schon etwas eingetrocknet, aber es gibt gute Nachrichten: Der R4-Fix für den sdf-20 Bug wird  für STU3 runterportiert im nächsten Technical Correction <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span></p>\n<p><a href=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20339\" target=\"_blank\" title=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20339\">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20339</a></p>\n<p><span class=\"user-mention\" data-user-id=\"193430\">@Alexander Zautke</span> <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> <span class=\"user-mention\" data-user-id=\"191450\">@Simone Heckmann</span></p>",
        "id": 162311350,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1554191542
    }
]