[
    {
        "content": "<p>Ich spiele gerade mit Medikationsplan PLUS Beispieldaten von dem <a href=\"http://fhir.hl7.de\" target=\"_blank\" title=\"http://fhir.hl7.de\">http://fhir.hl7.de</a> Testserver rum und sehe dabei Validierungsfehler für <code>Medication</code>-Resourcen, die eigenlicht valide aussehen. Genauer gesagt behauptet der Validator (standard JAR-validator, ganz frisch von der <a href=\"https://build.fhir.org/downloads.html\" target=\"_blank\" title=\"https://build.fhir.org/downloads.html\">R4-Downloadseite</a>), dass die EDQM-Dareichungsform-Kodes nicht korrect sind. Unten haben ich ein Beispiel vom Server reinkopiert, das erzeugt den folgenden Fehler:</p>\n<div class=\"codehilite\"><pre><span></span>*FAILURE* validating examples\\mpp-med-example.xml:  error:1 warn:0 info:1\n  Error @ Medication.form (line 21, col11) : None of the codes provided are in the value set http://fhir.de/ValueSet/medikationsplanplus/edqm-darreichungsform (http://fhir.de/ValueSet/medikationsplanplus/edqm-darreichungsform, and a code from this value set is required) (codes = urn:oid:0.4.0.127.0.16.1.1.2.1#10219000)\n</pre></div>\n\n\n<p>Der relevante Teil von der Resource ist</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;form&gt;</span>\n    <span class=\"nt\">&lt;coding&gt;</span>\n        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;urn:oid:0.4.0.127.0.16.1.1.2.1&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;10219000&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Tablette&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/coding&gt;</span>\n<span class=\"nt\">&lt;/form&gt;</span>\n</pre></div>\n\n\n<p>Dabei ist <em>10219000</em> tatsächlich die richtige Kode für \"Tablette\" (siehe <a href=\"https://simplifier.net/medikationsplanplus/edqm-darreichungsform-1\" target=\"_blank\" title=\"https://simplifier.net/medikationsplanplus/edqm-darreichungsform-1\">die entsprechende ValueSet</a>).</p>\n<p>Ich bin mir nicht sicher, ob ich einen tatsächlichen Fehler in der Resource übersehen habe, ob es womöglich ein Problem mit dem Profil gibt, oder ob der Validator sich irrt. Hat jemanden was ähnliches gesehen (oder hat einfach bessre Augen...)?</p>\n<p>Hier ist die komplette Resource:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;Medication</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;id</span> <span class=\"na\">value=</span><span class=\"s\">&quot;276&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;meta&gt;</span>\n        <span class=\"nt\">&lt;versionId</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;lastUpdated</span> <span class=\"na\">value=</span><span class=\"s\">&quot;2018-05-12T09:16:31.097+02:00&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;profile</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://fhir.de/StructureDefinition/medikationsplanplus/medication&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/meta&gt;</span>\n    <span class=\"nt\">&lt;text&gt;</span>\n        <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">&quot;generated&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;div</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;hapiHeaderText&quot;</span><span class=\"nt\">&gt;</span>true<span class=\"nt\">&lt;/div&gt;</span>\n        <span class=\"nt\">&lt;/div&gt;</span>\n    <span class=\"nt\">&lt;/text&gt;</span>\n    <span class=\"nt\">&lt;code&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://fhir.de/CodeSystem/ifa/pzn&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;766736&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">&quot;RAMIPRIL 1A PHARMA 5 MG&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/code&gt;</span>\n    <span class=\"nt\">&lt;form&gt;</span>\n        <span class=\"nt\">&lt;coding&gt;</span>\n            <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;urn:oid:0.4.0.127.0.16.1.1.2.1&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;10219000&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;display</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Tablette&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/coding&gt;</span>\n    <span class=\"nt\">&lt;/form&gt;</span>\n    <span class=\"nt\">&lt;ingredient&gt;</span>\n        <span class=\"nt\">&lt;itemCodeableConcept&gt;</span>\n            <span class=\"nt\">&lt;text</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Ramipril&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;/itemCodeableConcept&gt;</span>\n        <span class=\"nt\">&lt;amount&gt;</span>\n            <span class=\"nt\">&lt;numerator&gt;</span>\n                <span class=\"nt\">&lt;extension</span> <span class=\"na\">url=</span><span class=\"s\">&quot;http://hl7.org/fhir/StructureDefinition/amount-display&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;valueString</span> <span class=\"na\">value=</span><span class=\"s\">&quot;5 mg&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;/extension&gt;</span>\n                <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;5&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://unitsofmeasure.org&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;mg&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/numerator&gt;</span>\n            <span class=\"nt\">&lt;denominator&gt;</span>\n                <span class=\"nt\">&lt;value</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;http://unitsofmeasure.org&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/denominator&gt;</span>\n        <span class=\"nt\">&lt;/amount&gt;</span>\n    <span class=\"nt\">&lt;/ingredient&gt;</span>\n<span class=\"nt\">&lt;/Medication&gt;</span>\n</pre></div>",
        "id": 154013233,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1540824150
    },
    {
        "content": "<p>Hi, das dürfte dieser (ungelöste) issue sein: <br>\n<a href=\"https://github.com/hl7germany/medikationsplanplusplus/issues/43\" target=\"_blank\" title=\"https://github.com/hl7germany/medikationsplanplusplus/issues/43\">https://github.com/hl7germany/medikationsplanplusplus/issues/43</a></p>",
        "id": 154013553,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540881808
    },
    {
        "content": "<p>Könnte daran liegen, dass unsere Beispiele Deutsche Display Values verwenden, das ValueSet aber nur Englische hinterlegt hat.</p>",
        "id": 154013555,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540881991
    },
    {
        "content": "<p>Jupp:</p>\n<div class=\"codehilite\"><pre><span></span>        {\n          &quot;system&quot;: &quot;urn:oid:0.4.0.127.0.16.1.1.2.1&quot;,\n          &quot;code&quot;: &quot;10219000&quot;,\n          &quot;display&quot;: &quot;Tablet&quot;\n        },\n</pre></div>\n\n\n<p>Mit der Englischen Bezeichnung sollte es klappen.<br>\nDie deutsche Übersetzung für EDQM fehlt uns noch.<br>\n<span class=\"user-mention\" data-user-id=\"191532\">@dr Kai U. Heitmann</span> ?</p>",
        "id": 154013556,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540882064
    },
    {
        "content": "<p>…EDQM ist auch für die Kodierung der Medikation in der MI-Initiative in der Planung, da würden wir das auch benötigen!</p>",
        "id": 154013568,
        "sender_full_name": "Danny Ammon",
        "timestamp": 1540888859
    },
    {
        "content": "<p>IIRC gab es die Übersetzungen, sie waren bloß noch nicht im ArtDecor eingepflegt...</p>",
        "id": 154013569,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540888964
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191450\">@Simone Heckmann</span>, danke für den Hinweis! Allerdings bleibt der gleiche Fehler, auch wenn ich in der Beispiel-Resource \"Tablet\" statt \"Tablette\" für Display benutze, oder gar <code>display</code>ganz enferne. Obwohl ich die ValueSet von MPP hinterlegt habe, scheint der Validator irgendwie den Code selbst nicht zu finden <span class=\"emoji emoji-1f615\" title=\"confused\">:confused:</span> (Übrigens, in der MPP-ValueSet <a href=\"http://fhir.de/ValueSet/medikationsplanplus/edqm-darreichungsform\" target=\"_blank\" title=\"http://fhir.de/ValueSet/medikationsplanplus/edqm-darreichungsform\">http://fhir.de/ValueSet/medikationsplanplus/edqm-darreichungsform</a> von Simplifier stehen tatsächlich deutsche Display-Werte drin).</p>",
        "id": 154013570,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1540888983
    },
    {
        "content": "<p>ICYMI: EDQM pflegt alle Übersetzungen in alle EU-Sprachen zentral. Change requests dazu am Besten via DIMDI. Und es gibt ein API zum Zugriff auf die Datenbestände der EDQM Standard Terms. ART DECOR hat dafür m. E. einen Zugang erhalten, ich hatte das jedenfalls damals mal angeregt.</p>",
        "id": 154013855,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1540934555
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194703\">@Morten Ernebjerg</span> :<br>\nDas ValueSet auf dem Server hat jedenfalls keine Deutschen Display-Values: <a href=\"http://fhir.hl7.de:8080/baseDstu3/ValueSet/627\" target=\"_blank\" title=\"http://fhir.hl7.de:8080/baseDstu3/ValueSet/627\">http://fhir.hl7.de:8080/baseDstu3/ValueSet/627</a></p>\n<p>Was aber viel wahrscheinlicher die Ursache ist: Die ValueSet-Ressource ist nicht valide:<br>\n<a href=\"http://fhir.hl7.de:8080/baseDstu3/ValueSet/627/$validate\" target=\"_blank\" title=\"http://fhir.hl7.de:8080/baseDstu3/ValueSet/627/$validate\">http://fhir.hl7.de:8080/baseDstu3/ValueSet/627/$validate</a> :) Folglich kann der Server sie deswegen vermutlich auch nicht richtig auswerten...</p>",
        "id": 154014034,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540968847
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191532\">@dr Kai U. Heitmann</span>  <br>\nKönnt ihr beim Export der ValueSets aus ArtDecor bitte darauf achten, das \"ValueSet.description\" immer gefüllt ist?<br>\n(Oder alternativ den Conformance Claim zu sharable-valueset aus meta-profile entfernen, wobei die erste Lösung die interoperablere wäre)</p>",
        "id": 154014035,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540969338
    },
    {
        "content": "<p>Den harten \"error\" bei der Validierung hab ich im o.g. ValueSet jetzt gefixed, indem ich eine description hinzugefügt habe...</p>",
        "id": 154014036,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540969539
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194703\">@Morten Ernebjerg</span>  Wenn ich Deine Ressource jetzt validiere, bekomme ich nur noch INFORMATIONs, der Fehler bzgl, des ValueSets ist weg...</p>",
        "id": 154014037,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1540969682
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191450\">@Simone Heckmann</span> Danke für die Sherlock-Holmes-Arbeit! Ich versuche, <em>lokal</em> zu validieren mit dem Java JAR validator und ziehe mit deshalb die Profile etc. von MPP-Projekt auf Simplifier. Die <code>ValueSet</code> für Dareichungsform da hat Deutsche texte (so sieht es zumindest aus), siehe <a href=\"https://simplifier.net/medikationsplanplus/edqm-darreichungsform-1\" target=\"_blank\" title=\"https://simplifier.net/medikationsplanplus/edqm-darreichungsform-1\">https://simplifier.net/medikationsplanplus/edqm-darreichungsform-1</a> . D.h. ich mache folgendes:</p>\n<p>1. Alle MPP-Profile, <code>ValueSets</code> etc. von Simplifier runterladen und in <em>profiles/</em> abgelegen (<em>0616-jpg.xml</em> muss raus, sonst schmiert der Validator ab)<br>\n2. Beispiel-Resource (Oben) in <em>examples/</em> ablegen <br>\n3. Java-JAR  Validator runterladen von <a href=\"https://build.fhir.org/downloads.html\" target=\"_blank\" title=\"https://build.fhir.org/downloads.html\">https://build.fhir.org/downloads.html</a><br>\n4. Validator laufen lassen mit <code>java -jar org.hl7.fhir.validator.jar -version 3.0.1 -ig profiles/ examples/mpp-med-example.xml</code></p>\n<p>Und hier bekomme ich dann den Fehler von Oben (unabhängig vom <code>display</code>). Wenn ich den Fehler richtig lese, findet er die <code>ValueSet</code>aber liest sie irgendwie falsch. Sind die <code>ValueSet</code>auf dem Server anders als die auf Simplifier?</p>",
        "id": 154014478,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1541061871
    },
    {
        "content": "<p>Sind denn alle glücklich mit der Regel für eine OID, wie hier angegeben:</p>\n<p>oid An OID represented as a URI (RFC 3001 ); e.g. urn:oid:1.2.3.4.5 xs:anyURI   JSON string - uri<br>\nRegex: urn:oid:<a href=\"http://\\.[1-9]\\d*\" target=\"_blank\" title=\"http://\\.[1-9]\\d*\">0-2</a>+</p>\n<p><a href=\"https://www.hl7.org/fhir/datatypes.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/datatypes.html\">https://www.hl7.org/fhir/datatypes.html</a></p>",
        "id": 154014479,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541062857
    },
    {
        "content": "<p>“Regex: urn:oid:<a href=\"http://\\.[1-9]\\d*\" target=\"_blank\" title=\"http://\\.[1-9]\\d*\">0-2</a>+”</p>",
        "id": 154014480,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541062944
    },
    {
        "content": "<p>hmmm, zulip mag mein copy und paste nicht - bitte selbst mal in der FHIR spec nachlesen!</p>",
        "id": 154014481,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541063004
    },
    {
        "content": "<p>Ich finde, die dort angegebene regexp passt nicht recht zu der OID für die DoseForms. Benutzt validator.jar diese Regel?</p>",
        "id": 154014482,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541063519
    },
    {
        "content": "<p>Habe es gerade ausprobiert,  die RegExp hat sich von STU3 bis R4 etwas geändert <del>aber \"urn:oid:0.4.0.127.0.16.1.1.2.1\" passt zu beiden (als JS-RegExp)</del></p>",
        "id": 154014483,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1541064482
    },
    {
        "content": "<p>Da war ich etwas zu schnell: wenn die RegExp so gelesen wird, dass der ganze String passen must (also für JS mit einem \"$\" am Ende hinzugefügt), dann passt \"\"urn:oid:0.4.0.127.0.16.1.1.2.1\" tatsächlich nicht zur STU3-RegExp (weil <code>urn:oid:[0-2](\\.[1-9]\\d*)+</code> nur 0 am Anfang einern \"Gruppe\" am Anfang zulässt), aber schon zur R4-RegExp (<code>urn:oid:[0-2](\\.(0|[1-9][0-9]*))+</code>)</p>",
        "id": 154014484,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1541064997
    },
    {
        "content": "<p>Aber Falls der Validator diese Regel berücksichtigt (habe leider keine Ahnung), hätte ich eigentlich einen anderen Fehler erwartet.</p>",
        "id": 154014485,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1541065144
    },
    {
        "content": "<p>okay, war bloß so’ne Idee.</p>",
        "id": 154014486,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1541066179
    },
    {
        "content": "<p>Ist auf jeden Fall ein guter Punkt, dass der OID anscheinend nicht STU3 konform ist. Und es könnte auch noch die Fehler-Ursache sein, Fehlermeldungen sind ja leider nicht immer ganz präzise...</p>",
        "id": 154014487,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1541067055
    }
]