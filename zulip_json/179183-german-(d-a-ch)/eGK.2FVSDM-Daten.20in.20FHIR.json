[
    {
        "content": "<p>Wie bereits in <a href=\"#narrow/stream/179183-german-(d-a-ch)/topic/Coverage.20(Profil.20GKV)\" title=\"#narrow/stream/179183-german-(d-a-ch)/topic/Coverage.20(Profil.20GKV)\">https://chat.fhir.org/#narrow/stream/179183-german-(d-a-ch)/topic/Coverage.20(Profil.20GKV)</a> andiskutiert, möchte ich hier die Überlegungen fortführen, wie ein Datensatz von der elektronischen Versichertenkarte (VSDM, künftig ggf. auch Notfalldaten etc) in FHIR kommuniziert werden könnte.<br>\nWir waren uns bisher weitgehend einig dass</p>\n<ul>\n<li>so viel wie möglich aus dem Datensatz auf FHIR-Standard-Elemente gemappt werden sollte</li>\n<li>nicht alles was auf der EKG steht, sinnvoll zu mappen ist</li>\n<li>die komplexen STU3-Extensions, mit denen wir versucht haben, die VSDM-Inhalte in die Coverage-Ressource zu pressen etwas unhandlich sind</li>\n<li>es in einigen UseCases weniger darauf ankommt, die Inhalte in FHIR abzubilden, sondern lediglich der Orginial-Datensatz persistiert/transportiert/rekonstruiert werden muss.</li>\n</ul>\n<p>Die Überlegungen gingen daher in die Richtung, den EGK-Datensatz als DocumentReference mit Base64-codierten Original-Daten abzubilden. Dessen ungeachtet sollten natürlich so viel Informationen wie sinnvoll/möglich auf FHIR gemappt werden, um über die API zur Verfügung zu stehen.</p>",
        "id": 175076730,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1567784755
    },
    {
        "content": "<p>Bei Notfalldaten und Medikationsplan gibt es vermutlich use cases wo es sinnvoll sein kann, die jeweils als BLOB zu transportieren. Natürlich separat von den VSDM-Daten. Und für ein FHIR- mapping dieser eGK-Daten sollten wir uns m. E. mit diversen Beteiligten jedenfalls abstimmen. vgl. KBV-Schnittstelle für Verordnungssoftware und UKF-Spezifikation.</p>",
        "id": 175077558,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1567785288
    },
    {
        "content": "<p>Richtig.</p>\n<p>Der Medikationsplan (UKF) ist in der KBV-Verordnungsschnittstelle in DocumentReference profiliert (Profil <a href=\"https://fhir.kbv.de/StructureDefinition/74_PR_VoS_DokuRef\" target=\"_blank\" title=\"https://fhir.kbv.de/StructureDefinition/74_PR_VoS_DokuRef\">https://fhir.kbv.de/StructureDefinition/74_PR_VoS_DokuRef</a> ).<br>\nDas ganze direkt eingebettet in content.attachment.data und zwar ggf. sogar innerhalb einer DocumentReference der Medikationsplan sowohl als XML (aka UKF) als auch als PDF (2 content-Elemente).<br>\nDies ganz im Sinn der FHIR-Spec: zu DocumentReference.content: \"The document and format referenced. There may be multiple content element repetitions, each with a different format.\"</p>",
        "id": 175078001,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1567785580
    },
    {
        "content": "<p>Hier mal grob eine Idee, wie ein \"Original\"-Datensatz als DocumentReference aussehen könnte:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;DocumentReference</span> <span class=\"na\">xmlns=</span><span class=\"s\">&quot;http://hl7.org/fhir&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;status</span> <span class=\"na\">value=</span><span class=\"s\">&quot;current&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"c\">&lt;!--DocType TBD--&gt;</span>\n  <span class=\"nt\">&lt;type&gt;</span>\n    <span class=\"nt\">&lt;coding&gt;</span>\n        <span class=\"nt\">&lt;system</span> <span class=\"na\">value=</span><span class=\"s\">&quot;tbd&quot;</span><span class=\"nt\">/&gt;</span>\n        <span class=\"nt\">&lt;code</span> <span class=\"na\">value=</span><span class=\"s\">&quot;VSDM&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/coding&gt;</span>\n  <span class=\"nt\">&lt;/type&gt;</span>\n  <span class=\"nt\">&lt;subject&gt;</span>\n    <span class=\"c\">&lt;!-- die Patientendaten können aus dem VSDM-Datensatz extrahiert worden sein--&gt;</span>\n    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Patient/1234&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/subject&gt;</span>\n  <span class=\"c\">&lt;!--Einlesedatum--&gt;</span>\n  <span class=\"nt\">&lt;date</span> <span class=\"na\">value=</span><span class=\"s\">&quot;2019-09-06&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;description</span> <span class=\"na\">value=</span><span class=\"s\">&quot;VSDM-Datensatz&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;content&gt;</span>\n    <span class=\"nt\">&lt;attachment&gt;</span>\n      <span class=\"nt\">&lt;contentType</span> <span class=\"na\">value=</span><span class=\"s\">&quot;application/xml&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"c\">&lt;!--hier Base64-codiert der Datensatz--&gt;</span>\n      <span class=\"nt\">&lt;data</span> <span class=\"na\">value=</span><span class=\"s\">&quot;A64FCB746CFA6746B...&quot;</span><span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/attachment&gt;</span>\n  <span class=\"nt\">&lt;/content&gt;</span>\n  <span class=\"nt\">&lt;related&gt;</span>\n    <span class=\"c\">&lt;!--link auf Coverage, die aus VSDM-Daten erzeugt wurde--&gt;</span>\n    <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">&quot;Coverage/5432&quot;</span><span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/related&gt;</span>\n<span class=\"nt\">&lt;/DocumentReference&gt;</span>\n</pre></div>\n\n\n<p>Die Suche nach dem EGK-Datensatz zu Patient 1234 könnte dann mit <br>\n<code>.../DocumentReference?subject:Patient._id=1234&amp;type=VSDM</code> erfolgen.</p>",
        "id": 175078304,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1567785723
    },
    {
        "content": "<p>warum nicht die FHIR resources, die der eMP repräsentieren möchte?</p>",
        "id": 175078788,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1567786058
    },
    {
        "content": "<p>Versteh' die Frage nicht...</p>",
        "id": 175079785,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1567786801
    },
    {
        "content": "<p>UKF war mal als komprimierte Repräsentation von FHIR gedacht. Falls man die Kompression nicht mehr braucht, würde man vielleicht FHIR verbatim speichern. Würde man sowas dann auch in dieser Form als DocumentReference übertragen wollen?</p>",
        "id": 175080146,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1567787063
    },
    {
        "content": "<p>Nein, DocumentReference nur, wenn man die Original-Daten zusätzlich oder anstelle der gemappten Informationen benötigt...</p>",
        "id": 175080296,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1567787174
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193991\">@Christof Gessner</span> Entsprechende Einzelprofile in Äquivalenz zum BMP gibt es in VoS auch.<br>\nDas DokRef-Profil ist dazu gedacht den fertig gerenderten MP (PDF) oder/und eben 1:1 das darauf abzulegende strukturiererte XML (=UKF) zu übermitteln.</p>",
        "id": 175080330,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1567787205
    },
    {
        "content": "<p>Das Mapping ist halt viel entspannter, wenn man nicht jede - für den jeweiligen UseCase noch so irrelevante - Information aus den Originaldaten in eine FHIR-Ressource/-Extension pressen muss, nur um den vollständigen Original-Datensatz wiederherstellen zu können...</p>",
        "id": 175080446,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1567787296
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191450\">@Simone Heckmann</span> Genau.<br>\nIn diesem Fall ist es das Verordnungssystem (FHIR-Client), das die Daten hat und auch den MP generiert und das PVS (FHIR-Server), das genau dies eben nicht kann (bzw. können muss) und ggf. einfach nur als Dokumentenmanagementsystem für Medikationspläne in PDF und/oder XML agiert.</p>",
        "id": 175080466,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1567787324
    },
    {
        "content": "<p>Mir treibt nur gerade die Überlegung um, ob man sich die Liste der Dokumente zu einem Patienten dann nicht mit menschen-unlesbaren und für den Anwender irrelevanten Datensätzen zuspammt. <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> <br>\nLeider haben wir kein Flag, um ein Dokument als \"nicht zum Konsum geeignet\" zu flaggen. Müsste man also anhand des Dokumenttyps in der UI sinnvoll sortieren...</p>",
        "id": 175080747,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1567787525
    },
    {
        "content": "<p>Einen ersten Hinweis liefert natürlich der contentType.<br>\nFür ein XML (wie den UKF) bräuchte es ein StyleSheet.<br>\nWeitere Infos zur Differenzierung könnten nach content.format passen</p>",
        "id": 175081061,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1567787646
    },
    {
        "content": "<p>Wenn man übrigens sowohl mappt als auch das Original als DocumentReference speichert, und man sich ein Fleiß-Sternchen verdienen möchte, dann könnte man eine Provenance-Ressource erstellen, die die gemappten Ressourcen als <code>target</code> verlinkt und die DocumentReference als <code>entity</code> mit der Rolle <code>source</code> und damit nachvollziehbar macht, welche Informationen aus dem eGK-Datensatz extrahiert wurden.<br>\n...aber das macht später alles die FHIR Mapping-Engine für uns, stimmt's <span class=\"user-mention\" data-user-id=\"193430\">@Alexander Zautke</span>  ;-)</p>",
        "id": 175081191,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1567787751
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 175083367,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1567789442
    },
    {
        "content": "<p>This is left as an exercise to the reader ;D Ich möchte ja nicht der einzige bleiben der diese Sprache kann...</p>",
        "id": 175083432,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1567789477
    },
    {
        "content": "<p>Ich meine, dass ich in der VoS spec eine recht ausdifferenzierte XML oder JSON Struktur für das eRezept gesehen habe, für den eMP aber nicht. Bloß daher meine Verwunderung...</p>",
        "id": 175084919,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1567790610
    },
    {
        "content": "<p>haben wir dann 2 parallele Varianten wie in v2? Dann kann man wählen...</p>",
        "id": 175225930,
        "sender_full_name": "Frank Oemig",
        "timestamp": 1568020810
    },
    {
        "content": "<p>Ich würde die Diskussion gerne mal im Hinblick auf die AWS-Spec der KBV lenken:<br>\nIst es dort zwingend erforderlich, die Zusatzinformationen in die Coverage-Extensions zu mappen? Die Funktionalität Import/Export könnte man auch mit dem Original-Datensatz erzielen. Die Frage wäre, wie diese Daten in den PVSsen vorgehalten werden. Werden diese dort in die eigene DB-Struktur gemappt und der VSDM-Datensatz müsste erst wiederhergestellt werden (was auch nicht mehr oder weniger komplex wäre als die FHIR-Resource zu erstellen) oder speichern PVS-System das Originalformat?</p>",
        "id": 175818763,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1568645115
    },
    {
        "content": "<p>Auf der Rückseite der deutschen eGK sind die EHIC-Daten aufgedruckt. Hat hierzu schonmal jemand was in FHIR erstellt?<br>\nFalls ja: bitte melden bei <a href=\"#narrow/stream/242580-europe/topic/EHIC.20.2B.20FHIR\">https://chat.fhir.org/#narrow/stream/242580-europe/topic/EHIC.20.2B.20FHIR</a> </p>\n<p><a href=\"/user_uploads/10155/M-fTBTwZjxbEuINBZ1fyg2Xc/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/M-fTBTwZjxbEuINBZ1fyg2Xc/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/M-fTBTwZjxbEuINBZ1fyg2Xc/image.png\"></a></div>",
        "id": 233792896,
        "sender_full_name": "Christof Gessner",
        "timestamp": 1617961138
    }
]