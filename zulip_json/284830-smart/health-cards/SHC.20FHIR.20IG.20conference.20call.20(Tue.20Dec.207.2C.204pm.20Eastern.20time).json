[
    {
        "content": "<p>On the agenda for today's call (in about an hour):</p>\n<ul>\n<li>Review branch that allows <code>Patient.gender</code> <a href=\"http://build.fhir.org/ig/HL7/fhir-shc-vaccination-ig/branches/gender\">http://build.fhir.org/ig/HL7/fhir-shc-vaccination-ig/branches/gender</a></li>\n<li>Review <a href=\"https://github.com/dvci/shc-terminology\">https://github.com/dvci/shc-terminology</a></li>\n<li>Call for help with value set for <code>Observation.bodySite</code> for lab tests</li>\n<li>(Lack of) update from SNOMED</li>\n</ul>",
        "id": 264062857,
        "sender_full_name": "Max Masnick",
        "timestamp": 1638907175
    },
    {
        "content": "<p>I won't be on the call, but the gender branch doesn't address all the disposition, because we also said that we'd provide more documentation about jurisdictional adoption / internationalization</p>",
        "id": 264064871,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638907980
    },
    {
        "content": "<p>(ok for it to be done later - just don't want it missed)</p>",
        "id": 264064955,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638908019
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I added a section on this in that branch, but it's not super robust <a href=\"http://build.fhir.org/ig/HL7/fhir-shc-vaccination-ig/branches/gender/profiles.html\">http://build.fhir.org/ig/HL7/fhir-shc-vaccination-ig/branches/gender/profiles.html</a> <a href=\"/user_uploads/10155/B27DO0COu3-IuEsK0D9oY5q2/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/B27DO0COu3-IuEsK0D9oY5q2/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/B27DO0COu3-IuEsK0D9oY5q2/image.png\"></a></div>",
        "id": 264065692,
        "sender_full_name": "Max Masnick",
        "timestamp": 1638908295
    },
    {
        "content": "<p><a href=\"https://confluence.hl7.org/display/PHWG/2021-12-07+SHC-VT+ballot+reconciliation+meeting\">https://confluence.hl7.org/display/PHWG/2021-12-07+SHC-VT+ballot+reconciliation+meeting</a> Agenda page</p>",
        "id": 264066552,
        "sender_full_name": "Paul Denning",
        "timestamp": 1638908720
    },
    {
        "content": "<p>I missed that. I'll word smith it when I get a chance</p>",
        "id": 264067316,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638909106
    },
    {
        "content": "<p>how about something like this:</p>\n<h2>Internationalization</h2>\n<p>The base SHC specification is suitable for international use. This specification includes profiles for </p>\n<ul>\n<li>United States</li>\n</ul>\n<p>Other jurisdictions are welcome to define their own profiles that reflect their local concerns - contact the local HL7 affiliate or the authors of this specification for assistance. In particular, it is expected that jurisdictional profiles will constrain the <a href=\"http://xx.html\">AD profiles</a> with details such as national patient/consumer identifiers, relevant demographic details around names etc, and specifying which applicable code systems may be used. Some Jurisdictions may need to make additional rules around the representation of names with regard to character set etc.</p>\n<h3>International Adoption Issues</h3>\n<p>Patient Name</p>\n<p>Implementers of systems that present SHCs for verification should be aware that naming practices vary around the world, both in terms of name order, and the behavior and relevance of prefixes and suffixes on a person's name. If the Patient name has a text field, then this should be presented as is, and the structured parts of the name (family, given) may also be shown as additional details. </p>\n<p>Language</p>\n<p>The text for a patient's name is typically appropriately presented in their original language, but some patient names may come with more than one presentation form (e.g. Cyrillic/Latin, or Kanji / Hiragana / Katakana). Where more than one name exists, verifiers should generally show all the names, unless it is confident that one should be preferred, based on the language of the user of the verification system.</p>\n<p>The other important text is the display values for the various codes. If a display value is provided in line, this may be used, though it's language may be unknown (see Resource.language). The VIC initiative maintains implementation collateral with language appropriate representations for the some of the codes in this specification (see <a href=\"https://github.com/dvci/shc-terminology\">github</a>).</p>\n<hr>\n<p>btw: recommend that the profiles call out Resource.language and recommend populating it (\"language\":\"en\", = 17 bytes.)</p>",
        "id": 264097204,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638924658
    },
    {
        "content": "<p>though some of that text might belong on the core SHC spec, not this IG</p>",
        "id": 264097387,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638924833
    },
    {
        "content": "<p>Quick note that byte counts need to be assessed in context -- in terms of effect on realistic payloads after compression.</p>",
        "id": 264109959,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638936833
    },
    {
        "content": "<p>indeed. it will be a little less than 17 in effect, but not much. But I think, on considering the cross-border workflows, that Resource.language is a worthwhile thing</p>",
        "id": 264110023,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638936889
    },
    {
        "content": "<p>Can you say more about how it will be used? The resources in a SMART Health Card don't generally include free text in any language. (Naively, including this information and never resource would be 68 + bytes which ~5% of a small budget but yes with compression it's less bad. But this stuff accretes.)</p>",
        "id": 264110193,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638937104
    },
    {
        "content": "<p>well, they include text. a Covid certificate has text in a particular language in the following places:</p>\n<ul>\n<li>Patient.name.text|.family|.given|.prefix|.suffix</li>\n<li>Immunization.vaccineCode.coding.display</li>\n<li>Immunization.performer.display</li>\n</ul>\n<p>I know that Immunization.vaccineCode.coding.display isn't supposed to be populated, but implementers outside USA have little choice right now, since the verifier apps will look up US specific displays. At least with covid certs we could aspire to make that unnecessary (per value set we're working on) but there's faint hope of that once we get into lab, let alone all the other things that might come later. So I'm assuming that there will be a display, and border apps (at least) will have to care about it's language</p>",
        "id": 264114052,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638941455
    },
    {
        "content": "<p>Display values are ok for wallet apps (credentials are usually in a language the holder can read), but are terrible for verifier apps. Re-signing a translated credential is quite common in multi-jurisdiction activities (i.e. international students coming to the US universities get their \"SHCs\" translated and resigned by the translating authority before showing it to a verifier).</p>",
        "id": 264153854,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638969940
    },
    {
        "content": "<p>I would strongly recommend following <a href=\"https://www.icao.int/publications/pages/publication.aspx?docnum=9303\">ICAO's 9303</a> spec for names. These are used by the EU DCC with good outcomes (aligns with ID cards). The idea is to accept the native way to describe the name in UTF-16 and a transliterated version in the roman alphabet (fields must match) encoded as in the Machine Readable Zone (MRZ). The name can also be <em>truncated</em>.</p>",
        "id": 264165544,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638975157
    },
    {
        "content": "<p>As an example, this is the body of a transliterated DCC of a person with an Arabic name</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"nt\">\"ver\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1.3.0\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"nam\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"fn\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ابو بكر محمد بن زكريا الرازي\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"fnt\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ABW&lt;BKR&lt;MXHMD&lt;BN&lt;ZKRYA&lt;ALRAZY\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"gn\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ناصر\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"gnt\"</span><span class=\"p\">:</span> <span class=\"s2\">\"NAXSSR\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">\"dob\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1964-01-01\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"v\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"p\">{</span>\n      <span class=\"nt\">\"tg\"</span><span class=\"p\">:</span> <span class=\"s2\">\"840539006\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"vp\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1119349007\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"mp\"</span><span class=\"p\">:</span> <span class=\"s2\">\"EU/1/20/1507\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"ma\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ORG-100031184\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"dn\"</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"sd\"</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"dt\"</span><span class=\"p\">:</span> <span class=\"s2\">\"2021-06-11\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"co\"</span><span class=\"p\">:</span> <span class=\"s2\">\"NL\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"is\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Ministry of Health Welfare and Sport\"</span><span class=\"p\">,</span>\n      <span class=\"nt\">\"ci\"</span><span class=\"p\">:</span> <span class=\"s2\">\"URN:UVCI:01:NL:DADFCC47C7334E45A906DB12FD859FB7\"</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 264165980,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638975351
    },
    {
        "content": "<p>I'm not sure exactly what it would mean for us to follow this specification. Do  you have a  sense of how this would play out in FHIR?    Also, can you clarify whether there is some intrinsic reason for the choice of UTF-16?</p>",
        "id": 264166243,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638975476
    },
    {
        "content": "<p>On UTF-8 vs UTF-16, Shorter representations can be achieved with UTF-16. It should be preferred for space constrained situations. </p>\n<p>For instance, the Chinese letter \"語\" - its UTF-8 encoding is:<br>\n<code>11101000 10101010 10011110</code><br>\nWhile its UTF-16 encoding is shorter:<br>\n<code>10001010 10011110</code></p>",
        "id": 264167047,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638975766
    },
    {
        "content": "<p>Reminder that both UTF-8 and UTF-16 are not fixed to 8 and 16 bits. Only UTF-32 is fixed to 32 bits. UTF-8 and UTF-16 are variable length (e.g. UTF-8 the code point maybe represented using either 32, 16, 24 or 8 bits)</p>",
        "id": 264167419,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638975892
    },
    {
        "content": "<p>Besides that, since ECMAScript forced JavaScript strings to be all UTF-16 sequences, UTF-16 representations became the new standard for many applications.</p>",
        "id": 264167698,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638975991
    },
    {
        "content": "<p>When you say that shorter representations can be achieved, you mean for not ASCII characters? Whereas for ASCII that representation is twice as long? Just trying to understand the trade-off you are implying,  assuming you were talking about encoding the entire payload of the JWT ...</p>",
        "id": 264167899,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638976083
    },
    {
        "content": "<p>Correct. Remember, most of the world is non ASCII. :)</p>",
        "id": 264168272,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638976233
    },
    {
        "content": "<p>most of our JWT payload character set, however, is asking. Every FHIR property name, every delimiter character, etc.</p>",
        "id": 264168378,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638976275
    },
    {
        "content": "<p>So achieving higher efficiency on the display names that might occur at one or two spots in the payload would not be an obvious win  If the rest of the payload expands, right? Or am I misunderstanding something?</p>",
        "id": 264168417,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638976292
    },
    {
        "content": "<p>I believe the JavaScript version of the SHC implementation already uses UTF-16, no?</p>",
        "id": 264168456,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638976311
    },
    {
        "content": "<p>I don't think we have specified this or produced examples. Don't think character encoding has come up outside of our canonicalization schemes where we have proposed utf8</p>",
        "id": 264168577,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638976358
    },
    {
        "content": "<p>If you didn't manually converted to UTF-8 representations, that javascript implementation is already in UTF-16</p>",
        "id": 264168603,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638976375
    },
    {
        "content": "<p>But you can choose UTF-8 as well. I am not that strong about it.</p>",
        "id": 264169095,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638976560
    },
    {
        "content": "<p>For me, the important component is having a latin representation of the name (as an optional, but formalized field)</p>",
        "id": 264169213,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638976599
    },
    {
        "content": "<p>Or a latin representation of any \"display\" entry</p>",
        "id": 264169833,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638976828
    },
    {
        "content": "<p>Leaving inside the encoding question, do you want to share an example of what this would look like in FHIR Patient? We've had some discussion about these practices previously, simple adding more than one item to <code>Patient.name[]</code>.  But the main distinction I'm seeing here between what you are suggesting and what Grahame has suggested is  whether to divide the name into parts or not.  Your example from ICAO suggests (seems to) that names can always be divided into parts and never need to be represented as a single combined string?</p>",
        "id": 264170437,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638977037
    },
    {
        "content": "<p>(For our reference code, looks like the utf-8 encoding is covered by <a href=\"https://nodeca.github.io/pako/\">https://nodeca.github.io/pako/</a></p>\n<blockquote>\n<p>Pako's deflate detects input data type, and automatically recode strings to utf-8 prior to compress</p>\n</blockquote>\n<p>)</p>",
        "id": 264171314,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638977340
    },
    {
        "content": "<p>I think the FHIR version of the ICAO model would be an array of 2 HumanNames, but I might be wrong.</p>",
        "id": 264186856,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638983297
    },
    {
        "content": "<p>Too bad the <code>HumanName.use</code> code doesn't have a clear option for transliteration.</p>",
        "id": 264188321,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638983941
    },
    {
        "content": "<p>several comments</p>",
        "id": 264203881,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638990205
    },
    {
        "content": "<ol>\n<li>\n<p>FHIR specifies UTF-8 always. UTF-16 is not supported. This was a decision taken in consideration of CDA and HL7 v2 usage in east asian countries, who already made that rule. </p>\n</li>\n<li>\n<p>the question of script doesn't deal with name parts, and the ICAO guidance doesn't either. it's considering an orthogonal issue.</p>\n</li>\n<li>\n<p>The FHIR spec says, concerning this: \"The forms are differentiated by the character subset each contains\", and from the standard's pov, transliteration isn't a 'use'\"</p>\n</li>\n</ol>\n<p>The ICAO example in FHIR looks like this:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"name\"</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ابو بكر محمد بن زكريا الرازي\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ناصر\"</span><span class=\"p\">,</span>\n<span class=\"p\">},{</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ABW&lt;BKR&lt;MXHMD&lt;BN&lt;ZKRYA&lt;ALRAZY\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"NAXSSR\"</span>\n<span class=\"p\">}]</span>\n</code></pre></div>\n<p>Technically, if one wanted to be explicit, you could do this:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"name\"</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ابو بكر محمد بن زكريا الرازي\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ناصر\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"extension\"</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n  <span class=\"nt\">\"url\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/language\"</span><span class=\"p\">,</span>\n   <span class=\"nt\">\"valueCode\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ar-Arab\"</span>\n  <span class=\"p\">}]</span>\n<span class=\"p\">},{</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ABW&lt;BKR&lt;MXHMD&lt;BN&lt;ZKRYA&lt;ALRAZY\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"NAXSSR\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"extension\"</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n    <span class=\"nt\">\"url\"</span> <span class=\"p\">:</span> <span class=\"s2\">\" http://hl7.org/fhir/StructureDefinition/iso21090-EN-representation\"</span><span class=\"p\">,</span>\n   <span class=\"nt\">\"valueCode\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ABC\"</span>\n  <span class=\"p\">},{</span>\n  <span class=\"nt\">\"url\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/language\"</span><span class=\"p\">,</span>\n   <span class=\"nt\">\"valueCode\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ar-Latn\"</span>\n  <span class=\"p\">}]</span>\n<span class=\"p\">}]</span>\n</code></pre></div>",
        "id": 264205654,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638990948
    },
    {
        "content": "<p>there's no ISO name representation code for arabic characters - the representation code is intended for Japan (which is why it's an extension). What's happening in the Arabic case isn't quite the same thing, so probably the ISO extension is not quite valid (would need to sit in a room with  a bunch of linguists and terminologists and let them argue over that one).</p>",
        "id": 264206049,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638991121
    },
    {
        "content": "<blockquote>\n<p>FHIR specifies UTF-8 always.</p>\n</blockquote>\n<p>Interesting! I have to pay more attention when working with FHIR on JavaScript then.</p>",
        "id": 264207101,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638991623
    },
    {
        "content": "<p>What I don't like about the array structure is that the relationship between the two array items is not defined. The HumanName array on FHIR might represent completely different names, each should have their own transliteration as per ICAO's model. </p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"name\"</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ابو بكر محمد بن زكريا الرازي\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ناصر\"</span><span class=\"p\">,</span>\n<span class=\"p\">},{</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ABW&lt;BKR&lt;MXHMD&lt;BN&lt;ZKRYA&lt;ALRAZY\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"NAXSSR\"</span>\n<span class=\"p\">}]</span>\n</code></pre></div>",
        "id": 264207458,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638991791
    },
    {
        "content": "<p>I am not sure if there is a good solution. Maybe FHIR-based implementations simply cannot expect to map names and transliterated names individually.</p>",
        "id": 264207609,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638991825
    },
    {
        "content": "<p>From my perspective, tagging one name as \"this one is romanized\" doesn't add information that a client couldn't figure out for itself (i.e., by inspecting the name).</p>",
        "id": 264208723,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1638992326
    },
    {
        "content": "<p>The ISO21090 extension <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  mentioned classifies in ABC (Alphabetic), IDE (Ideographic), SYL (Phonetic), which might have valid use cases.</p>",
        "id": 264209010,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638992457
    },
    {
        "content": "<p>But it would be nice to not have extensions on SHCs (space constraints)</p>",
        "id": 264209145,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638992522
    },
    {
        "content": "<p>indeed I don't think that extensions are justified here.</p>",
        "id": 264209567,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638992698
    },
    {
        "content": "<p>I agree that it could be more explicit, but we discussed this extensively with regard to arabic names somewhere else. It was a few years ago, so I don't recall where we discussed it, sorry.</p>",
        "id": 264210039,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1638992912
    },
    {
        "content": "<p>The ISO21090 representation and the passport MRZ encoding seem to also be orthogonal from each other.</p>",
        "id": 264210342,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638993034
    },
    {
        "content": "<p>What a mess.</p>",
        "id": 264210380,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638993056
    },
    {
        "content": "<p>Let's remove all Patient info and just put the patient's faceID biometric vector there. Problem solved. <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 264210671,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1638993160
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191315\">Josh Mandel</span> <a href=\"#narrow/stream/284830-smart.2Fhealth-cards/topic/SHC.20FHIR.20IG.20conference.20call.20.28Tue.20Dec.207.2C.204pm.20Eastern.20time.29/near/264208723\">said</a>:</p>\n<blockquote>\n<p>From my perspective, tagging one name as \"this one is romanized\" doesn't add information that a client couldn't figure out for itself (i.e., by inspecting the name).</p>\n</blockquote>\n<p>From a verifier perspective, I want to be able to display all names in their appropriate UI. In the example, I would put <code>ناصر ابو بكر محمد بن زكريا الرازي</code> as a name in the top of the card and <code>NAXSSR&lt;ABW&lt;BKR&lt;MXHMD&lt;BN&lt;ZKRYA&lt;ALRAZY</code> in the bottom, with a smaller font, similar to the Passport layout.</p>",
        "id": 264228333,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639001506
    },
    {
        "content": "<p>And if a <code>Naxssr Abw Bkr Mxhmd Bn Zkrya Alrazy</code>is provided, the UI's name component would be <code>Name (Arabic/English)</code> and the top of the card would have <code>ناصر ابو بكر محمد بن زكريا الرازي/Naxssr Abw Bkr Mxhmd Bn Zkrya Alrazy</code></p>",
        "id": 264228699,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639001681
    },
    {
        "content": "<p>Like this: <a href=\"/user_uploads/10155/dai24Bn42VVTE2mz8tZlni12/Screen-Shot-2021-12-08-at-5.17.01-PM.png\">Screen-Shot-2021-12-08-at-5.17.01-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/dai24Bn42VVTE2mz8tZlni12/Screen-Shot-2021-12-08-at-5.17.01-PM.png\" title=\"Screen-Shot-2021-12-08-at-5.17.01-PM.png\"><img src=\"/user_uploads/10155/dai24Bn42VVTE2mz8tZlni12/Screen-Shot-2021-12-08-at-5.17.01-PM.png\"></a></div>",
        "id": 264229201,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639001832
    },
    {
        "content": "<p>The use makes sense; I'm just saying that you could make the distinction by inspection, without an explicit metadata tag.</p>",
        "id": 264249246,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1639017143
    },
    {
        "content": "<p>you can, if you know what you're looking for. writing a general purpose detection algorithm is going to be pretty fun. But my basic contention is that you don't need to - you have a series of strings that are names - show them all to a user, and if you're doing id matching (shouldn't be off an SHC, so this is mainly elsewhere) then consider all the names. If that general purpose algorithm falls down, then you need to unicode range determination</p>",
        "id": 264251710,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639019742
    },
    {
        "content": "<p>\"Just dump them on the user\" is not good UX design. Users expect much more than a dump of the FHIR fields on the screen.</p>",
        "id": 264255294,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639023684
    },
    {
        "content": "<p>of course in general I agree. But for names... I don't agree. what else are you going to do but show the names you find in an SHC?</p>",
        "id": 264263519,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639033233
    },
    {
        "content": "<p>Apps generally have a context they are working with in. For instance, if they know their user speaks Chinese by checking the languages installed on their phone, they don't need to show transliterated names. If the user only speaks English, the app doesn't need to present the Chinese version of the name. It's irrelevant.</p>",
        "id": 264312790,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639061930
    },
    {
        "content": "<p>The option to show additional versions of the name will be on the screen somewhere (if they need, it will be accessible), but it's not the default behavior.</p>",
        "id": 264312896,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639061987
    },
    {
        "content": "<p>Same is true for levels of detail of information (showing issuing city for locals vs issuing country for foreigners)</p>",
        "id": 264313075,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639062036
    },
    {
        "content": "<p>An SHC issued by BC should show \"Issued by BC\" in Canada and \"Issued by Canada\" in the US. A US user doesn't care which state the holder got his credentials from.</p>",
        "id": 264313209,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639062098
    },
    {
        "content": "<p>A US SHC in India doesn't show the Pharmacy's name. It simply shows \"Issued by a pharmacy in the USA\". If they click on it, users will get more info, but otherwise it's irrelevant. If the app shows \"Issued by CVS\", no one knows what those letters are. It's just more confusion for the low level staff trying to process these credentials in the field.</p>",
        "id": 264314037,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639062458
    },
    {
        "content": "<p>In many cases outside the US, SHCs from US-based entities will simply say \"Issued by the USA\" to avoid user interface freakout. It's not correct. But it doesn't matter. What matters is that users can do their job (pass people trough) fast.</p>",
        "id": 264314288,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639062578
    },
    {
        "content": "<p>Going back to the names. If the app knows the user is verifying against an ID, the app needs to choose to display only the name that will be in the ID (likely the \"official\" name on the array). But if the holder is a foreigner, the app needs to show the transliterated version (e.g. Americans can't do pattern matching of Chinese characters). If the names are not comparable for a foreigner, the app needs to show the MRZ code and the user needs to compare against that part in the passport. Now, if the user is not performing ID checks against another document, then the app should show the \"usual\" or \"nicknames\" available as names.</p>",
        "id": 264315205,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639062964
    },
    {
        "content": "<p>If you think about the business case for each app, you would never say \"they don't need to\". Because they MUST. It's the only thing they can do to survive. The only differentiator between apps processing the same payload is the amount of smartness baked into the app that makes the life easier for their user base. The value-add for apps is directly proportional to the work they do to contextualize the information. Thus, the more the spec ALLOWS them to contextualize, the better it gets.</p>",
        "id": 264317192,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639063791
    },
    {
        "content": "<blockquote>\n<p>the more the spec ALLOWS them to contextualize, the better it gets.</p>\n</blockquote>\n<p>Sure -- and a spec where multiple names are available, and  where apps can evaluate them to determine context on the basis of their <em>content</em> (e.g., characters) would seem to meet this bar.</p>",
        "id": 264320380,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1639065067
    },
    {
        "content": "<p>Does this make sense? </p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"name\"</span> <span class=\"p\">:</span> <span class=\"p\">[{</span>\n  <span class=\"nt\">\"use\"</span><span class=\"p\">:</span> <span class=\"s2\">\"official\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"enc\"</span><span class=\"p\">:</span> <span class=\"s2\">\"IDE\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ابو بكر محمد بن زكريا الرازي\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ناصر\"</span>\n<span class=\"p\">},{</span>\n  <span class=\"nt\">\"use\"</span><span class=\"p\">:</span> <span class=\"s2\">\"official\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"enc\"</span><span class=\"p\">:</span> <span class=\"s2\">\"MRZ\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ABW&lt;BKR&lt;MXHMD&lt;BN&lt;ZKRYA&lt;ALRAZY\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"NAXSSR\"</span>\n<span class=\"p\">},{</span>\n  <span class=\"nt\">\"use\"</span><span class=\"p\">:</span> <span class=\"s2\">\"usual\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"enc\"</span><span class=\"p\">:</span> <span class=\"s2\">\"IDE\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ابو بكر\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ناصر\"</span>\n<span class=\"p\">},{</span>\n  <span class=\"nt\">\"use\"</span><span class=\"p\">:</span> <span class=\"s2\">\"usual\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"enc\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ABC\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"family\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"ALRAZY\"</span><span class=\"p\">,</span>\n  <span class=\"nt\">\"given\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"NASSIR\"</span>\n<span class=\"p\">}]</span>\n</code></pre></div>",
        "id": 264320884,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639065274
    },
    {
        "content": "<blockquote>\n<p>For instance, if they know their user speaks Chinese by checking the languages installed on their phone, they don't need to show transliterated names. If the user only speaks English, the app doesn't need to present the Chinese version of the name. It's irrelevant.</p>\n</blockquote>\n<p>I don't agree with that, because the app doesn't know anything about who the user is talking to - using a verifier app is almost never a solitary experience</p>",
        "id": 264351589,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639077102
    },
    {
        "content": "<blockquote>\n<p>A US SHC in India doesn't show the Pharmacy's name. It simply shows \"Issued by a pharmacy in the USA\". If they click on it, users will get more info, but otherwise it's irrelevant. If the app shows \"Issued by CVS\", no one knows what those letters are. It's just more confusion for the low level staff trying to process these credentials in the field.</p>\n</blockquote>\n<p>maybe but nothing about the existing content of an SHC allows for this level of sophistication</p>",
        "id": 264351711,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639077146
    },
    {
        "content": "<blockquote>\n<p>Does this make sense?</p>\n</blockquote>\n<p>Well, what's the definition of 'enc'?</p>",
        "id": 264351785,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639077185
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/284830-smart.2Fhealth-cards/topic/SHC.20FHIR.20IG.20conference.20call.20.28Tue.20Dec.207.2C.204pm.20Eastern.20time.29/near/264351589\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>For instance, if they know their user speaks Chinese by checking the languages installed on their phone, they don't need to show transliterated names. If the user only speaks English, the app doesn't need to present the Chinese version of the name. It's irrelevant.</p>\n</blockquote>\n<p>I don't agree with that, because the app doesn't know anything about who the user is talking to - using a verifier app is almost never a solitary experience</p>\n</blockquote>\n<p>The user of a verifier app is a verifier, not the holder. The app knows plenty about the verifier.  The holder is irrelevant to the context used by a Verifier app. The Holder only matters to the Wallet app (which also knows the holder very well).</p>",
        "id": 264353153,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639077791
    },
    {
        "content": "<p>Wallet apps don't even need to show the Patient name by default ;)   I don't need to see my name in the card.</p>",
        "id": 264353348,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639077888
    },
    {
        "content": "<blockquote>\n<p>Well, what's the definition of 'enc'?</p>\n</blockquote>\n<p>Encoding. It's an extended version of the ISO21090 \"representation\" codes</p>",
        "id": 264353594,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639078015
    },
    {
        "content": "<blockquote>\n<p>I don't need to see my name in the card</p>\n</blockquote>\n<p>Well, you have kids? because my wallet has stuff in it for my kids. And also, my wife and I have our covid certificates in both our wallets, in case we run out of battery on one of our phones</p>",
        "id": 264354059,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639078247
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/284830-smart.2Fhealth-cards/topic/SHC.20FHIR.20IG.20conference.20call.20.28Tue.20Dec.207.2C.204pm.20Eastern.20time.29/near/264354059\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>I don't need to see my name in the card</p>\n</blockquote>\n<p>Well, you have kids? because my wallet has stuff in it for my kids. And also, my wife and I have our covid certificates in both our wallets, in case we run out of battery on one of our phones</p>\n</blockquote>\n<p>The wallet knows your name. It doesn't need to show your name on your credentials. If you add your kids/wife/etc credentials, they are not yours. The app is supposed to know the difference and render them differently.</p>",
        "id": 264354355,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639078393
    },
    {
        "content": "<p>Here's how a Wallet app should display every SHC where the holder == user. </p>\n<p><a href=\"/user_uploads/10155/40lj6kyxPNVJ00kEJhckPzB3/Card.png\">Card.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/40lj6kyxPNVJ00kEJhckPzB3/Card.png\" title=\"Card.png\"><img src=\"/user_uploads/10155/40lj6kyxPNVJ00kEJhckPzB3/Card.png\"></a></div>",
        "id": 264355501,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639078953
    },
    {
        "content": "<p>No names, no vaccine brand and no other detailed information. Just the calculation on where my protection starts (what really matters).</p>",
        "id": 264355716,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639079043
    },
    {
        "content": "<p>Notice how the biggest value-add (knowing when the protection starts) requires the app to manage scientific knowledge beyond what you will find on an SHCs. That's why users will choose this app as opposed to some random open-source FHIR visualizer app.</p>",
        "id": 264356134,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639079219
    },
    {
        "content": "<p>Here's a second design I worked with: <a href=\"/user_uploads/10155/v4L4jxeMUjOjU8KlGtNASBkc/dashboard_with_1_dose_1_code_ios.png\">dashboard_with_1_dose_1_code_ios.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/v4L4jxeMUjOjU8KlGtNASBkc/dashboard_with_1_dose_1_code_ios.png\" title=\"dashboard_with_1_dose_1_code_ios.png\"><img src=\"/user_uploads/10155/v4L4jxeMUjOjU8KlGtNASBkc/dashboard_with_1_dose_1_code_ios.png\"></a></div>",
        "id": 264357386,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639079751
    },
    {
        "content": "<p>From a Verifier, perspective. This is one I have been working with. It allows the verifier (venue host) to host his credentials in the app and show to attendees when they want to see it while serving the main purpose of scanning and storing the credentials of everyone that comes in, separating them by date + tags and then name of the holder. </p>\n<p><a href=\"/user_uploads/10155/ytIbno3huwuX70PkqIsU3IW0/Screen-Shot-2021-12-09-at-3.09.00-PM.png\">Screen-Shot-2021-12-09-at-3.09.00-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/ytIbno3huwuX70PkqIsU3IW0/Screen-Shot-2021-12-09-at-3.09.00-PM.png\" title=\"Screen-Shot-2021-12-09-at-3.09.00-PM.png\"><img src=\"/user_uploads/10155/ytIbno3huwuX70PkqIsU3IW0/Screen-Shot-2021-12-09-at-3.09.00-PM.png\"></a></div>",
        "id": 264359665,
        "sender_full_name": "Vitor Pamplona",
        "timestamp": 1639080689
    },
    {
        "content": "<p>I logged an issue re: populating <code>Resource.language</code>: <a href=\"https://jira.hl7.org/browse/FHIR-34808\">https://jira.hl7.org/browse/FHIR-34808</a></p>",
        "id": 266457941,
        "sender_full_name": "Max Masnick",
        "timestamp": 1640898095
    }
]