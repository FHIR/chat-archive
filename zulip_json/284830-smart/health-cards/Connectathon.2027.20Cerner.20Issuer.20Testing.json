[
    {
        "content": "<p>Just tested out the Cerner Issuer <code>$health-cards-issue</code> operation and it worked like a charm! <span aria-label=\"party ball\" class=\"emoji emoji-1f38a\" role=\"img\" title=\"party ball\">:party_ball:</span> </p>\n<p>Only thing our tests noticed is that there is no <code>./well-known/smart-configuration</code> file.</p>\n<p><a href=\"/user_uploads/10155/NfqB5eMXqtJXf-VF3iIIwweA/Screen-Shot-2021-05-18-at-12.27.53-PM.png\">Screen-Shot-2021-05-18-at-12.27.53-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/NfqB5eMXqtJXf-VF3iIIwweA/Screen-Shot-2021-05-18-at-12.27.53-PM.png\" title=\"Screen-Shot-2021-05-18-at-12.27.53-PM.png\"><img src=\"/user_uploads/10155/NfqB5eMXqtJXf-VF3iIIwweA/Screen-Shot-2021-05-18-at-12.27.53-PM.png\"></a></div>",
        "id": 239283900,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1621355295
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> I don't see an explicit SHOULD or SHALL for supporting <code>/.well-known/smart-configuration</code> and indicating support for the <code>health-cards</code> capability (<a href=\"https://smarthealth.cards/#via-fhir-health-cards-issue-operation\">link to section of the spec</a>). Is this something that should be an optional test or that we should clarify the language for?</p>",
        "id": 239284083,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1621355377
    },
    {
        "content": "<blockquote>\n<p>A SMART on FHIR Server advertises support for issuing VCs according to this specification by adding the health-cards capability to its /.well-known/smart-configuration JSON file</p>\n</blockquote>\n<p>This should be updated to say:</p>\n<blockquote>\n<p>A SMART on FHIR Server SHALL advertise support for issuing VCs according to this specification by adding the health-cards capability to its /.well-known/smart-configuration JSON file</p>\n</blockquote>\n<p>I'll create a PR.</p>",
        "id": 239284537,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621355538
    },
    {
        "content": "<p>We do not publish /.well-known/smart-configuration on our Open/Insecure endpoint as it is not backed by SMART authorization. It should pass if you try using the patient access endpoint.</p>",
        "id": 239284540,
        "sender_full_name": "Zameer Sura",
        "timestamp": 1621355539
    },
    {
        "content": "<p>Added <a href=\"https://github.com/smart-on-fhir/health-cards/pull/145\">https://github.com/smart-on-fhir/health-cards/pull/145</a></p>",
        "id": 239284793,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621355642
    },
    {
        "content": "<p>would this only be in the case of the $issue operation?</p>",
        "id": 239285166,
        "sender_full_name": "Isaac Vetter",
        "timestamp": 1621355768
    },
    {
        "content": "<p>Yes -- it's a requirement for FHIR servers supporting issuance.</p>",
        "id": 239285233,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621355796
    },
    {
        "content": "<p>Added further clarification to PR#145.</p>",
        "id": 239285374,
        "sender_full_name": "Josh Mandel",
        "timestamp": 1621355855
    },
    {
        "content": "<p>Tested against the secured endpoint where the SMART configuration test passes <span aria-label=\"congratulations\" class=\"emoji emoji-1f389\" role=\"img\" title=\"congratulations\">:congratulations:</span> </p>\n<p><a href=\"/user_uploads/10155/3IiEDyirp0QQZFp9PT1illx-/Screen-Shot-2021-05-18-at-12.55.11-PM.png\">Screen-Shot-2021-05-18-at-12.55.11-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/3IiEDyirp0QQZFp9PT1illx-/Screen-Shot-2021-05-18-at-12.55.11-PM.png\" title=\"Screen-Shot-2021-05-18-at-12.55.11-PM.png\"><img src=\"/user_uploads/10155/3IiEDyirp0QQZFp9PT1illx-/Screen-Shot-2021-05-18-at-12.55.11-PM.png\"></a></div>",
        "id": 239288196,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1621356964
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197651\">@Reece Adamson</span> what tool is that?</p>",
        "id": 239289385,
        "sender_full_name": "James Kizer",
        "timestamp": 1621357431
    },
    {
        "content": "<p>It's an alpha release of a new version of inferno: <a href=\"https://inferno-dev.healthit.gov/\">https://inferno-dev.healthit.gov/</a></p>",
        "id": 239289736,
        "sender_full_name": "Stephen MacVicar",
        "timestamp": 1621357562
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"199274\">@Zameer Sura</span> it does give a warning that the JWKS response does not include the <code>Access-Control-Allow-Origin</code> header expected by the spec (<a href=\"https://smarthealth.cards/#determining-keys-associated-with-an-issuer\">https://smarthealth.cards/#determining-keys-associated-with-an-issuer</a>).</p>\n<p>This is required, but for the tests we have it tuned to a warning so that it doesn't halt the following tests.</p>",
        "id": 239289828,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1621357590
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197651\">Reece Adamson</span> <a href=\"#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20Cerner.20Issuer.20Testing/near/239289828\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"199274\">Zameer Sura</span> it does give a warning that the JWKS response does not include the <code>Access-Control-Allow-Origin</code> header expected by the spec (<a href=\"https://smarthealth.cards/#determining-keys-associated-with-an-issuer\">https://smarthealth.cards/#determining-keys-associated-with-an-issuer</a>).</p>\n<p>This is required, but for the tests we have it tuned to a warning so that it doesn't halt the following tests.</p>\n</blockquote>\n<p>Our endpoints do support CORS but it seems like the inferno test is making the calls without an <code>Origin</code> header set, basically in <code>no-cors</code> mode which is why our server is not responding with the required CORS headers.</p>\n<p>See: <a href=\"https://www.test-cors.org/#?client_method=GET&amp;client_credentials=false&amp;server_url=https%3A%2F%2Ffhir-myrecord.stagingcerner.com%2Fbeta%2Fec2458f2-1e24-41c8-b71b-0e701af7583d%2F.well-known%2Fjwks.json&amp;server_enable=true&amp;server_status=200&amp;server_credentials=false&amp;server_tabs=remote\">Here</a>, which shows the CORS headers being returned if you look under your browser developer tools.</p>",
        "id": 239300363,
        "sender_full_name": "Zameer Sura",
        "timestamp": 1621361690
    },
    {
        "content": "<p>Good catch <span class=\"user-mention\" data-user-id=\"199274\">@Zameer Sura</span> - we'll debug that now</p>",
        "id": 239302438,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1621362419
    },
    {
        "content": "<p>Reece, aside from the CORS warning i also see the inferno tool giving a warning about the payload length</p>\n<blockquote>\n<p>Payload may not be properly minified. Received a payload with length 1448, but was able to generate a payload with length 1167</p>\n</blockquote>\n<p>This seems to be performing the check against the decompressed payload instead of the JWS token. Lengths of the responses, decompressed payload = 1448, jws token = 889</p>",
        "id": 239302633,
        "sender_full_name": "Zameer Sura",
        "timestamp": 1621362492
    },
    {
        "content": "<p>The payload length checks have some known issues we're looking at so you can ignore that warning.</p>",
        "id": 239302863,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1621362592
    },
    {
        "content": "<p>That test is intended to specifically check against the decompressed payload. We take the payload, minify it ourselves and compare the lengths. It's tricky to say for sure that a difference in length is an actual problem, so it's just a warning and the wording says \"may\". Due to an issue that we are unlikely to resolve before the connectathon, the length we're checking against is ~40 characters shorter than it should be. A difference of 300 characters seems like it indicates a problem with one of our implementations.</p>",
        "id": 239305982,
        "sender_full_name": "Stephen MacVicar",
        "timestamp": 1621363735
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"199274\">@Zameer Sura</span>  One query for the cerner issuer,  is authentication through SmartOnFHIR required to access the API through Patient Access? We have enabled authentication through Bearer  token from our Holder App.</p>",
        "id": 239400344,
        "sender_full_name": "Vijayendra Prabhakar",
        "timestamp": 1621420481
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306186\">@Vijayendra Prabhakar</span> I was able to test with the Cerner open endpoint.</p>\n<p><a href=\"https://github.com/joeratt/connectathon_notes/blob/may_2021-HL7-health_cards/health_cards/Cerner%20SMART%20Health%20Cards%20-%20Integration%20Notes.md#health-card-endpoints\">Documentation is here</a></p>\n<p>For convenience here is the open endpoint: <code>https://fhir-open.stagingcerner.com/beta/ec2458f2-1e24-41c8-b71b-0e701af7583d/Patient/{id}/$health-cards-issue</code></p>",
        "id": 239404755,
        "sender_full_name": "Reece Adamson",
        "timestamp": 1621422961
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306186\">@Vijayendra Prabhakar</span>, yes in a production system you got to access the Patient Access API through the SMART On FHIR OAuth2 authentication. The documentation that Reece linked describes how you can register your application to connect with this endpoint.<br>\nPlease let me know if you require assistance with this.</p>\n<p>Additionally we provide the open endpoint to test in our public sandbox/connectathon domain that does not require authentication.</p>",
        "id": 239417735,
        "sender_full_name": "Zameer Sura",
        "timestamp": 1621428781
    }
]