[
    {
        "content": "<p>isaacvetter opened <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>During the HL7 FHIR Connectathon in Koeln, we had a CDS Hooks breakout session and talked through the tenant / billing_code discussion that originated with this SMART issue: <a href=\"https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/133\" target=\"_blank\" title=\"https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/133\">https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/133</a></p>\n<p>We talked through this issue for CDS Hooks and started to get consensus that an implementation specific key/value pair in the JWT body is a reasonable method to suggest in the specification.</p>\n</blockquote>",
        "id": 153959571,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526206213
    },
    {
        "content": "<p>grahamegrieve <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388616874\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388616874\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>I like it in the JWT, and that works for CDS-hooks, but I worry that putting in the JWT is too late for some applications - they'll want to know this before auth not after. However it will be hard to be secure if it's ut in the launch URL </p>\n</blockquote>",
        "id": 153959585,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526207546
    },
    {
        "content": "<p>jmandel <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388617184\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388617184\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>The JWT is available right up front -- a CDS Service can validate it first, then apply logic... or can look inside it before validating. I'm not sure how this affects your assessment @grahamegrieve </p>\n</blockquote>",
        "id": 153959586,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526207823
    },
    {
        "content": "<p>grahamegrieve <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388619827\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388619827\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>it is in the CDS-hooks context, but not in the context of a smart app launched from the EHR</p>\n</blockquote>",
        "id": 153959591,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526210821
    },
    {
        "content": "<p>jmandel <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388620219\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388620219\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>That's a SMART issue though. For non-sensitive information in SMART, we<br>\ncould add another ehr-launch-time query param to convey this information.<br>\nWe could even migrate from the current \"iss\" and \"launch\" parameters to a<br>\nsigned JWT. But that's a separate discussion.</p>\n<p>On Sun, May 13, 2018, 13:27 Grahame Grieve &lt;<a href=\"mailto:notifications@github.com\" title=\"mailto:notifications@github.com\">notifications@github.com</a>&gt; wrote:</p>\n<blockquote>\n<p>it is in the CDS-hooks context, but not in the context of a smart app<br>\nlaunched from the EHR</p>\n<p>â€”<br>\nYou are receiving this because you commented.<br>\nReply to this email directly, view it on GitHub<br>\n&lt;<a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388619827\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388619827\">https://github.com/cds-hooks/docs/issues/205#issuecomment-388619827</a>&gt;, or mute<br>\nthe thread<br>\n&lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AATHAX1X3SEpKbmJa7FQDiwAhNwVzoQvks5tyBiGgaJpZM4T8vWc\" target=\"_blank\" title=\"https://github.com/notifications/unsubscribe-auth/AATHAX1X3SEpKbmJa7FQDiwAhNwVzoQvks5tyBiGgaJpZM4T8vWc\">https://github.com/notifications/unsubscribe-auth/AATHAX1X3SEpKbmJa7FQDiwAhNwVzoQvks5tyBiGgaJpZM4T8vWc</a>&gt;<br>\n.</p>\n</blockquote>\n</blockquote>",
        "id": 153959595,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526211216
    },
    {
        "content": "<p>olbrich <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388622463\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388622463\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>To a large extent this problem can be resolved by allowing implementers to include additional fields in the service request that would be specified by a service provider in their implementation guide.</p>\n</blockquote>",
        "id": 153959637,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526213646
    },
    {
        "content": "<p>nschwertner <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388624625\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388624625\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>The proposed approach to use extend the JWT to be the carrier of vendor/site/etc claims might open new possibilities beyond our current approach of:</p>\n<p>a) Inferring the vendor/site from the the FHIR Base/Service URI at launch time<br>\nb) Injecting custom parameters in the SMART launch URI or otherwise using unique launch URIs per site</p>\n<p>While (b) would work for a SMART app, it it not that trivial to implement in a CDS Hooks service scenario without turning it into a hack. The nice part of JWT is that it would work equally well for a SMART app and a CDS Hooks service with the added benefit of signature-based authenticity validation of the claims.</p>\n<p>I wonder though if there is anything simpler to implement than a JWT to the same effect. For example, the CDS service invocation (the payload of the POST req) already contains context that is trusted, then why not extend that context with other useful claims?</p>\n</blockquote>",
        "id": 153959665,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526215890
    },
    {
        "content": "<p>kpshek <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388630257\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388630257\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<blockquote>\n<p>I wonder though if there is anything simpler to implement than a JWT to the same effect. For example, the CDS service invocation (the payload of the POST req) already contains context that is trusted, then why not extend that context with other useful claims?</p>\n</blockquote>\n<p>The reason why I think placing this information in the JWT is most appropriate because it seems to be related to the EHR authentication process as well as information already in the JWT (namely, the issuer represented by the <code>iss</code>).</p>\n<p>Here is a concrete proposal for a new <em>private claim</em> in the JWT payload:</p>\n<table>\n<thead>\n<tr>\n<th>Field</th>\n<th>Optionality</th>\n<th>Type</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>tenant</td>\n<td>REQUIRED</td>\n<td><em>string</em></td>\n<td>An opaque string identifying the healthcare organization that is invoking the CDS Hooks request.</td>\n</tr>\n</tbody>\n</table>\n<p>Per <a href=\"https://tools.ietf.org/html/rfc7519#section-4.1\" target=\"_blank\" title=\"https://tools.ietf.org/html/rfc7519#section-4.1\">rfc7519</a>, regarding the claims:</p>\n<blockquote>\n<p>All the names are short because a core goal of JWTs is for the representation to be compact.</p>\n</blockquote>\n<p>Additionally, since we are defining a <em>private claim</em> here, also from rfc7519:</p>\n<blockquote>\n<p>Unlike Public Claim Names, Private Claim Names are subject to collision and should be used with caution.</p>\n</blockquote>\n<p>I am proposing a <em>private claim</em> (as opposed to public) as I don't see a need register a new public claim in the <a href=\"https://www.iana.org/assignments/jwt/jwt.xhtml\" target=\"_blank\" title=\"https://www.iana.org/assignments/jwt/jwt.xhtml\">IANA \"JSON Web Token Claims\" registry</a>. I am not concerned with claim name collisions since we are defining what fields we use in the JWT and there are no public claims with the proposed name today.</p>\n<p>This new JWT payload claim satisfies the immediate need expressed in the original issue description.</p>\n<p>For the needs expressed by @olbrich, we could add this additional statement to our specification:</p>\n<p>\"An EHR and CDS Service may negotiate additional custom private claims in the JWT payload to communicate additional data. These custom private claims should be named with a prefix of \"<code>x-</code>\" (extension) to avoid name collisions with possible future CDS Hooks claims.\"</p>\n<p>Thoughts?</p>\n</blockquote>",
        "id": 153959737,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526221122
    },
    {
        "content": "<p>olbrich <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388631358\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388631358\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>@kpshek Perhaps <code>entity</code>, it's less tied to a particular use case.</p>\n</blockquote>",
        "id": 153959757,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526222022
    },
    {
        "content": "<p>kpshek <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388631519\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388631519\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<blockquote>\n<p>Perhaps entity, it's less tied to a particular use case.</p>\n</blockquote>\n<p>I wouldn't be opposed to using <code>entity</code> as the claim name.</p>\n</blockquote>",
        "id": 153959758,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526222186
    },
    {
        "content": "<p>nschwertner <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388632211\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388632211\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p><code>entity</code> or even <code>instance</code> sound abstract enough to me. What is the rationale behind making this a \"required\" claim?</p>\n</blockquote>",
        "id": 153959772,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526222739
    },
    {
        "content": "<p>kpshek <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388633100\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-388633100\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<blockquote>\n<p>What is the rationale behind making this a \"required\" claim?</p>\n</blockquote>\n<p>My thinking was that every EHR is going to have some identifier (already in use or can create a new identifier) that represents this concept.</p>\n<p>I know we're focused on CDS Hooks here, but in my experience with production SMART on FHIR apps, nearly all of them need this value (which is why the large EHR vendors provide this value as part of the SMART app launch). This reality was another reason why I am proposing this field is required.</p>\n</blockquote>",
        "id": 153959775,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526223469
    },
    {
        "content": "<p>kpshek labeled <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>",
        "id": 153959776,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526223475
    },
    {
        "content": "<p>jec <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-389186330\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-389186330\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>In one implementation, I called mine <code>rqe</code> for \"requesting entity.\"</p>\n</blockquote>",
        "id": 153961190,
        "sender_full_name": "Github Notifications",
        "timestamp": 1526394346
    },
    {
        "content": "<p>isaacvetter <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-392946388\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-392946388\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>How would <code>entity</code> be different from <code>sub</code> <a href=\"http://cds-hooks.org/specification/1.0/#trusting-ehrs\" target=\"_blank\" title=\"http://cds-hooks.org/specification/1.0/#trusting-ehrs\">in the JWT</a>? ... and why?</p>\n</blockquote>",
        "id": 153965330,
        "sender_full_name": "Github Notifications",
        "timestamp": 1527628227
    },
    {
        "content": "<p>kpshek <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-393271959\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-393271959\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<blockquote>\n<p>How would entity be different from sub in the JWT? ... and why?</p>\n</blockquote>\n<p>I wouldn't be opposed to using the <code>sub</code> field for this. <a href=\"https://tools.ietf.org/html/rfc7519#page-9\" target=\"_blank\" title=\"https://tools.ietf.org/html/rfc7519#page-9\">rfc 7519</a> defines <code>sub</code> as:</p>\n<blockquote>\n<p>4.1.2.  \"sub\" (Subject) Claim</p>\n<p>The \"sub\" (subject) claim identifies the principal that is the<br>\n   subject of the JWT.  The claims in a JWT are normally statements<br>\n   about the subject.  The subject value MUST either be scoped to be<br>\n   locally unique in the context of the issuer or be globally unique.<br>\n   The processing of this claim is generally application specific.  The<br>\n   \"sub\" value is a case-sensitive string containing a StringOrURI<br>\n   value.  Use of this claim is OPTIONAL.</p>\n</blockquote>\n<p>We could argue that the subject of our JWT is that entity/organization. I was hoping that whatever field name we came up with, we could use this same name as a new launch context parameter in SMART. I'd be fine using <code>sub</code> here in the context of a JWT as we can explain that but a field named <code>sub</code> seems a bit odder in the SMART on FHIR launch context parameter use case.</p>\n<p>With all of that being said, I've been beaten down on this particular topic for a long time so I'm fine with whatever name we decide to use -- <code>sub</code> or something equally as generic (like <code>entity</code>). <span class=\"emoji emoji-1f61d\" title=\"stuck out tongue closed eyes\">:stuck_out_tongue_closed_eyes:</span> </p>\n</blockquote>",
        "id": 153965727,
        "sender_full_name": "Github Notifications",
        "timestamp": 1527705531
    },
    {
        "content": "<p>kpshek milestoned <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>",
        "id": 153969092,
        "sender_full_name": "Github Notifications",
        "timestamp": 1528905189
    },
    {
        "content": "<p>kpshek unlabeled <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>",
        "id": 153969093,
        "sender_full_name": "Github Notifications",
        "timestamp": 1528905192
    },
    {
        "content": "<p>kpshek <a href=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-397081726\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205#issuecomment-397081726\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>\n<blockquote>\n<p>## <span class=\"emoji emoji-1f4de\" title=\"telephone receiver\">:telephone_receiver:</span> CDS Working Group Block Vote (6-13-2018)</p>\n<p>Meeting notes: <a href=\"http://wiki.hl7.org/index.php?title=File:2018-06-13_CDS_WG_Call_Minutes.docx\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=File:2018-06-13_CDS_WG_Call_Minutes.docx\">http://wiki.hl7.org/index.php?title=File:2018-06-13_CDS_WG_Call_Minutes.docx</a></p>\n<p>@kpshek moved the following disposition, seconded by @isaacvetter.</p>\n<p>We will add the following new private claim to the JWT:</p>\n<table>\n<thead>\n<tr>\n<th>Field</th>\n<th>Optionality</th>\n<th>Type</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>tenant</td>\n<td>OPTIONAL</td>\n<td><em>string</em></td>\n<td>An opaque string identifying the healthcare organization that is invoking the CDS Hooks request.</td>\n</tr>\n</tbody>\n</table>\n<p><span class=\"emoji emoji-1f44d\" title=\"+1\">:+1:</span> For: 10<br>\n<span class=\"emoji emoji-1f611\" title=\"expressionless\">:expressionless:</span> Abstain: 0<br>\n<span class=\"emoji emoji-1f44e\" title=\"-1\">:-1:</span> Against: 0</p>\n<p><span class=\"emoji emoji-1f389\" title=\"tada\">:tada:</span> The motion passed! <span class=\"emoji emoji-1f389\" title=\"tada\">:tada:</span></p>\n</blockquote>",
        "id": 153969142,
        "sender_full_name": "Github Notifications",
        "timestamp": 1528922993
    },
    {
        "content": "<p>kpshek labeled <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>",
        "id": 153980051,
        "sender_full_name": "Github Notifications",
        "timestamp": 1533098301
    },
    {
        "content": "<p>kpshek closed <a href=\"https://github.com/cds-hooks/docs/issues/205\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/205\">Issue #205</a></p>",
        "id": 154016215,
        "sender_full_name": "Github Notifications",
        "timestamp": 1541609790
    }
]