[
    {
        "content": "<p>grahamegrieve opened <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Some hooks require a set of resources be passed to the decision support service, so that it can evaluate a set of actions that are inter-related. For instance, order-review - many of the uses of this hook will relate to a set of orders e.g. the set of diagnostic requests proposed. The same applies to medications particularly, where clinicians - rightly - think of a single prescription that contains multiple medications, but FHIR (also rightly) treats this as a set of resources.  </p>\n<p>The context should be either an object or an array of objects, where each elemetn in the array is an object that has the same content as the object would have. The hook definition should define the cardinality of the context.</p>\n</blockquote>",
        "id": 153901960,
        "sender_full_name": "Github Notifications",
        "timestamp": 1502416173
    },
    {
        "content": "<p>kpshek <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328301401\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328301401\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Context is an array of objects in our current implementation so we just have a bug in our current documentation. Thanks for raising this and I'll get it fixed today with a PR</p>\n</blockquote>",
        "id": 153905429,
        "sender_full_name": "Github Notifications",
        "timestamp": 1504988657
    },
    {
        "content": "<p>kpshek milestoned <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>",
        "id": 153905430,
        "sender_full_name": "Github Notifications",
        "timestamp": 1504988665
    },
    {
        "content": "<p>jmandel <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328308777\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328308777\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>I think we're going to run into limitations with simple arrays. For example, let's imagine a future hook definition like <code>reconcile-med-lists</code> where two lists of medications will be passed into the service. Let's say List One includes: drug a, drug b; whereas List Two includes drug c, drug d.</p>\n<p>If we just have a context array, the service will see:<br>\n[<br>\n  {Prescription for drug a },<br>\n  {Prescription for drug b },<br>\n  {Prescription for drug c },<br>\n  {Prescription for drug d }<br>\n]</p>\n<p>... but it won't know which correspond to \"List One\" and which correspond to \"List Two\".</p>\n<p>We can solve this by adding context parameter names as part of a hook definition like:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;context&quot;: [{\n  &quot;name&quot;: &quot;list_one&quot;,\n  &quot;value&quot;: {Prescription resource for drug a}\n}, {\n  &quot;name&quot;: &quot;list_one&quot;,\n  &quot;value&quot;: {Prescription resource for drug b}\n}, {\n  &quot;name&quot;: &quot;list_two&quot;,\n  &quot;value&quot;: {Prescription resource for drug c}\n}, {\n  &quot;name&quot;: &quot;list_two&quot;,\n  &quot;value&quot;: {Prescription resource for drug d}\n}, ]\n</pre></div>\n\n\n</blockquote>",
        "id": 153905554,
        "sender_full_name": "Github Notifications",
        "timestamp": 1504998528
    },
    {
        "content": "<p>robs16 <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328343891\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328343891\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p><span class=\"user-mention\" data-user-email=\"jmandel@gmail.com\" data-user-id=\"9\">@Josh Mandel</span> I agree that the array is too limited. However I might take a page from the prefetch approach and use:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;context&quot;: {\n  &quot;list_one&quot;: {\n    &quot;response&quot;: {\n      &quot;status&quot;: &quot;200 OK&quot;\n    },\n    &quot;resource&quot;: {\n      &quot;resourceType&quot;: &quot;Bundle&quot;,\n      &quot;entry&quot;: [\n        {&quot;resource&quot;: {Prescription resource for drug a}},\n        {&quot;resource&quot;: {Prescription resource for drug b}}\n      ]\n    }\n  },\n  &quot;list_two&quot;: {\n    &quot;response&quot;: {\n      &quot;status&quot;: &quot;200 OK&quot;\n    },\n    &quot;resource&quot;: {\n      &quot;resourceType&quot;: &quot;Bundle&quot;,\n      &quot;entry&quot;: [\n        {&quot;resource&quot;: {Prescription resource for drug c}},\n        {&quot;resource&quot;: {Prescription resource for drug d}}\n      ]\n    }\n  }\n}\n</pre></div>\n\n\n</blockquote>",
        "id": 153905732,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505051386
    },
    {
        "content": "<p>jmandel <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328345152\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328345152\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Agreed @robs16! Agee discussion with you Alex, I think the cleanest thing to say is: context is an object whose properties are entirely specified in the hook definition.</p>\n</blockquote>",
        "id": 153905741,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505052661
    },
    {
        "content": "<p>grahamegrieve <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328352697\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328352697\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>that's moving the deck chairs around... how is the hook definition going to say that?</p>\n</blockquote>",
        "id": 153905763,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505059800
    },
    {
        "content": "<p>jmandel <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328362851\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328362851\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>I'd say that this approach is separating concerns between the generic spec and the hook-specific requirements. As for \"how\"... it could be prose, or a snippet of swagger (JSON schema), or whatever... We can be prescriptive on this point.</p>\n</blockquote>",
        "id": 153905918,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505068920
    },
    {
        "content": "<p>isaacvetter <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328363336\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328363336\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Hey <span class=\"user-mention\" data-user-email=\"jmandel@gmail.com\" data-user-id=\"9\">@Josh Mandel</span>, </p>\n<p>At some point, the CDS Hooks community will start pumping out new hooks. For this reason, the process for defining a new hook, including specifying any required context, needs to be tightly defined. </p>\n<p>Defining a minimal key/value pair as the structure of context seems like it's needed, otherwise, context format is going to be all over the board. I'd further suggest that we should not only define the structure ahead of time, but also provide guidelines for naming the keys and defining when resources are required.</p>\n</blockquote>",
        "id": 153905933,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505069372
    },
    {
        "content": "<p>jmandel <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328363480\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328363480\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Agreed <span class=\"user-mention\" data-user-email=\"isaacvetter@gmail.com\" data-user-id=\"558\">@Isaac Vetter</span>! I don't think this dissuades us from adopting the \"hook-specified context\" approach that @robs16 described above, right?</p>\n</blockquote>",
        "id": 153905939,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505069527
    },
    {
        "content": "<p>bkaney <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328375254\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328375254\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>It would be nice if <code>context</code> were similar in schema/shape to <code>resource</code> in SMART, as we are finding it convienent to pass through. The data disparity requires more work in between.</p>\n</blockquote>",
        "id": 153905999,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505080917
    },
    {
        "content": "<p>isaacvetter <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328391258\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328391258\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Hey @bkaney ,</p>\n<p>Are you using SMART's resource? If so, you'll be interested in <a href=\"https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/138\" target=\"_blank\" title=\"https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/138\">this conversation</a>.</p>\n<p>Secondly, I don't think that SMART's launch parameters that specify a FHIR resource (patient, encounter, location, resource, etc) actually contain/include a full FHIR resource, rather they're just the resourceType/FhirId.</p>\n<p>Isaac</p>\n</blockquote>",
        "id": 153906041,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505092423
    },
    {
        "content": "<p>bkaney <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328498341\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328498341\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Things are moving fast. And I didn't know <code>resource</code> wasn't able to be a full resource in SMART.</p>\n<p>We are not quite there, but planning to implement over the next few weeks. Given this, I will not use  it and see how else contextual launch information could be passed on.</p>\n<p>Thanks!</p>\n</blockquote>",
        "id": 153906077,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505128409
    },
    {
        "content": "<p>jmandel <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328528579\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328528579\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>As we work through the standardization process for smart, we will also clarify that launch context is extensible. It's OK  to add details/parameters as needed (but if there's a standard way to accomplish your use case, that's clearly better). </p>\n</blockquote>",
        "id": 153906081,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505136449
    },
    {
        "content": "<p>bkaney <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328533027\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-328533027\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p><span class=\"user-mention\" data-user-email=\"jmandel@gmail.com\" data-user-id=\"9\">@Josh Mandel</span> right, I am thinking we will add a new key called <code>context</code> to the SMART launch_context, and have it pass what we get from CDS Hooks.</p>\n</blockquote>",
        "id": 153906083,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505137408
    },
    {
        "content": "<p>bkaney <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-330560383\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-330560383\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Re-reading this thread, and to summarize the proposal I think the idea is to advertise the <code>context</code> in the service definition (following the pattern we have for <code>prefetch</code>), like this:</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;hook&quot;: &quot;medication-prescribe&quot;,\n  &quot;title&quot;: &quot;Medication Foo Service&quot;,\n  &quot;id&quot;: &quot;medication-foo&quot;,\n  &quot;context&quot;: {\n    &quot;list_one&quot;: &quot;MedicationRequest?patient={{Patient.id}}&amp;code=285018&quot;,\n    &quot;list_two&quot;: &quot;MedicationRequest?patient={{Patient.id}}&amp;code=1594660&quot;\n  }\n}\n</pre></div>\n\n\n<p>Then when calling the service, include the resources, like this:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;context&quot;: {\n  &quot;list_one&quot;: {\n    &quot;response&quot;: {\n      &quot;status&quot;: &quot;200 OK&quot;\n    },\n    &quot;resource&quot;: {\n      &quot;resourceType&quot;: &quot;Bundle&quot;,\n      &quot;entry&quot;: [\n        {&quot;resource&quot;: {MedRequest resource for drug a, date 1}},\n        {&quot;resource&quot;: {MedRequest resource for drug a, date 2}}\n      ]\n    }\n  },\n  &quot;list_two&quot;: {\n    &quot;response&quot;: {\n      &quot;status&quot;: &quot;200 OK&quot;\n    },\n    &quot;resource&quot;: {\n      &quot;resourceType&quot;: &quot;Bundle&quot;,\n      &quot;entry&quot;: [\n        {&quot;resource&quot;: {MedRequest resource for drug b, date 3}}\n      ]\n    }\n  }\n}\n</pre></div>\n\n\n<p>Is this correct?</p>\n</blockquote>",
        "id": 153909002,
        "sender_full_name": "Github Notifications",
        "timestamp": 1505831817
    },
    {
        "content": "<p>isaacvetter <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-333674666\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-333674666\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Need to better document in spec:<br>\n- context is an object<br>\n- the structure of the context object is hook dependent.</p>\n<p>We should update the spec's Hook Catalog to clarify the medication-prescribe and order-review hooks.<br>\n- Should medication-prescribe's context should be a list of one or more MedicationOrders?</p>\n</blockquote>",
        "id": 153911912,
        "sender_full_name": "Github Notifications",
        "timestamp": 1506980795
    },
    {
        "content": "<p>isaacvetter assigned <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>",
        "id": 153911913,
        "sender_full_name": "Github Notifications",
        "timestamp": 1506980807
    },
    {
        "content": "<p>vlindhol <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338371365\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338371365\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>@bkaney I'm a bit confused, if <code>context</code> is so rigidly structured with FHIR search strings, how does that differ from <code>prefetch</code>? I use <code>context</code> for e.g. setting some request specific settings (like the version number of the data that the CDS uses to make its decisions). These are generally simple key-value pairs.</p>\n</blockquote>",
        "id": 153915161,
        "sender_full_name": "Github Notifications",
        "timestamp": 1508570877
    },
    {
        "content": "<p>bkaney <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338410256\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338410256\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>I think the difference is <code>context</code> is required to use the service whereas <code>prefetch</code> is an optimization but not required. I am guessing here though...</p>\n</blockquote>",
        "id": 153915162,
        "sender_full_name": "Github Notifications",
        "timestamp": 1508599664
    },
    {
        "content": "<p>vadi2 <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338410526\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338410526\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>That is my understanding as well.</p>\n<p>On Sat, Oct 21, 2017 at 5:27 PM Brian Kaney &lt;<a href=\"mailto:notifications@github.com\" title=\"mailto:notifications@github.com\">notifications@github.com</a>&gt;<br>\nwrote:</p>\n<blockquote>\n<p>I think the difference is context is required to use the service whereas<br>\nprefetch is an optimization but not required. I am guessing here though...</p>\n<p>â€”<br>\nYou are receiving this because you are subscribed to this thread.<br>\nReply to this email directly, view it on GitHub<br>\n&lt;<a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338410256\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-338410256\">https://github.com/cds-hooks/docs/issues/75#issuecomment-338410256</a>&gt;, or mute<br>\nthe thread<br>\n&lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AAGxjJSVU42OhjTiQuWC3TzoR4_p7Sl1ks5sug1wgaJpZM4O0KzL\" target=\"_blank\" title=\"https://github.com/notifications/unsubscribe-auth/AAGxjJSVU42OhjTiQuWC3TzoR4_p7Sl1ks5sug1wgaJpZM4O0KzL\">https://github.com/notifications/unsubscribe-auth/AAGxjJSVU42OhjTiQuWC3TzoR4_p7Sl1ks5sug1wgaJpZM4O0KzL</a>&gt;<br>\n.</p>\n</blockquote>\n</blockquote>",
        "id": 153915163,
        "sender_full_name": "Github Notifications",
        "timestamp": 1508599892
    },
    {
        "content": "<p>vlindhol <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-339207042\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-339207042\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>I see. Is there any official place to put small \"configuration-type\" values? Like my example above, where I basically want to have the config <code>{ dataVersion: \"0.9.0\" }</code> somewhere, so my CDS can return a reply based on version 0.9.0 of its clinical data. Another use case might be setting the wanted language of the returned messages.</p>\n<p>Should <code>context</code> be used here as well? Any special syntax to signify that it is not a FHIR search string?</p>\n</blockquote>",
        "id": 153915847,
        "sender_full_name": "Github Notifications",
        "timestamp": 1508903827
    },
    {
        "content": "<p>vlindhol <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-339207875\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-339207875\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>I should add that my CDS is stateless and pure, i.e. it does not contact the calling server for more information. I have been (wrongly) using <code>prefetch</code> for specifying what data I need using FHIR search strings, and <code>context</code> as a place to put both config values as well as FHIR resources that are not expressible through FHIR search strings.</p>\n</blockquote>",
        "id": 153915849,
        "sender_full_name": "Github Notifications",
        "timestamp": 1508904222
    },
    {
        "content": "<p>isaacvetter closed <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>",
        "id": 153920839,
        "sender_full_name": "Github Notifications",
        "timestamp": 1511304676
    },
    {
        "content": "<p>isaacvetter <a href=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-346187379\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75#issuecomment-346187379\">commented</a> on <a href=\"https://github.com/cds-hooks/docs/issues/75\" target=\"_blank\" title=\"https://github.com/cds-hooks/docs/issues/75\">Issue #75</a></p>\n<blockquote>\n<p>Hey @vlindhol , I think that you should check out this issue #76.</p>\n<p>I'm going to close this issue in favor of #39 .</p>\n<p>Isaac</p>\n</blockquote>",
        "id": 153920840,
        "sender_full_name": "Github Notifications",
        "timestamp": 1511304676
    }
]