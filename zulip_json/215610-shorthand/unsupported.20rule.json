[
    {
        "content": "<p>Getting this error (note lack of spaces)</p>\n<blockquote>\n<p>warn: Unsupported rule: *identifiercontainsHPI0..1MS   </p>\n</blockquote>\n<p>from this file</p>\n<div class=\"codehilite\"><pre><span></span>Profile:        HPIPractitioner\nParent:         Practitioner\nId:             hpi-practitioner\nTitle:          &quot;HPI Practitioner&quot;\nDescription:    &quot;The practitioner exposed by the HPI.&quot;\n* identifier contains HPI 0..1 MS\n* identifier 1..*\n* identifier[HPI].system = &quot;https://standards.digital.health.nz/id/hpi-person&quot;\n* name 1..*\n* name.family 1..1\n</pre></div>",
        "id": 183320594,
        "sender_full_name": "David Hay",
        "timestamp": 1576200419
    },
    {
        "content": "<p>updated sushi and the errors are slightly different...</p>\n<div class=\"codehilite\"><pre><span></span>error: Cannot create HPI slice. No slicing found for Practitioner.identifier.\n  File: /Users/davidhay/clinfhir/sushi/samples/HPIPractitioner.fsh\n  Line: 7\nerror: No element found at path identifier[HPI] for HPIPractitioner, skipping rule\n  File: /Users/davidhay/clinfhir/sushi/samples/HPIPractitioner.fsh\n  Line: 7\nerror: No element found at path identifier[HPI] for HPIPractitioner, skipping rule\n  File: /Users/davidhay/clinfhir/sushi/samples/HPIPractitioner.fsh\n  Line: 7\nerror: No element found at path identifier[HPI].system for HPIPractitioner, skipping rule\n  File: /Users/davidhay/clinfhir/sushi/samples/HPIPractitioner.fsh\n  Line: 10\n</pre></div>",
        "id": 183321474,
        "sender_full_name": "David Hay",
        "timestamp": 1576201593
    },
    {
        "content": "<p>In the current version of SUSHI, we have not implemented \"Ginzu\" slicing yet.  This means that we cannot <em>infer</em> slicing discriminators.  You need to set them yourself.  If you try to add a slice to an element that doesn't have a discriminator defined, you'll get that first error.  The next three errors are because creating that slice failed (due to no discriminator) -- so attempting to reference it will fail as well.</p>",
        "id": 183358993,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1576244052
    },
    {
        "content": "<p>You should be able to setup the discriminator in your above example using a syntax like this:</p>\n<div class=\"codehilite\"><pre><span></span>* identifier ^slicing.discriminator[0].type = #value\n* identifier ^slicing.discriminator[0].path = &quot;system&quot;\n* identifier ^slicing.ordered = false\n* identifier ^slicing.rules = #open\n</pre></div>\n\n\n<p>... and you should do it <em>before</em> you use the <code>contains</code> rule to add the HPI slice.</p>",
        "id": 183359333,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1576244356
    },
    {
        "content": "<p>Thanks! Figured that the first one was the root cause - but I copied the file from the docs and didn't realize that it wasn't supported yet...</p>",
        "id": 183423582,
        "sender_full_name": "David Hay",
        "timestamp": 1576297954
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> I think two things are going on, related to the early phase of development of SUSHI... <br>\n(1) Auto-slicing is not yet implemented. Therefore, you need to specify the slicing using the caret (escape) syntax:</p>\n<div class=\"codehilite\"><pre><span></span>* extension ^slicing.discriminator.type = #value\n* extension ^slicing.discriminator.path = &quot;url&quot;\n</pre></div>\n\n\n<p>(This is an example for slicing an extension, which will no longer be necessary after 0.4 release, I'm told).</p>\n<p>(2) The error \"No element found at path\" is something <span class=\"user-mention\" data-user-id=\"239822\">@Nick Freiter</span> is looking into now. We think it should be working, and it is just a bug.</p>",
        "id": 183545082,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1576500235
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"239822\">@Nick Freiter</span> -  The \"No element found at path\" is expected since the rule that introduced the slice failed (therefore there the reference to the <em>failed</em> slice won't find anything).</p>",
        "id": 183551818,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1576505547
    },
    {
        "content": "<p>I think you are correct Chris. Mark has also found a bug with slicing that I am looking at now which can cause \"No element found at path\", but I don't believe that bug should be an issue in this case.</p>",
        "id": 183552333,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1576505940
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191469\">Chris Moesel</span> <a href=\"#narrow/stream/215610-shorthand/topic/unsupported.20rule/near/183359333\">said</a>:</p>\n<blockquote>\n<p>You should be able to setup the discriminator in your above example using a syntax like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>* identifier ^slicing.discriminator[0].type = #value\n* identifier ^slicing.discriminator[0].path = &quot;system&quot;\n* identifier ^slicing.ordered = false\n* identifier ^slicing.rules = #open\n</code></pre></div>\n\n\n<p>... and you should do it <em>before</em> you use the <code>contains</code> rule to add the HPI slice.</p>\n</blockquote>\n<p>Hi,</p>\n<p>I have done some testing how to do slicing with Shorthand. I got the same error as the first writer (David) of this thread. I have done testing with examples found here (<a href=\"http://build.fhir.org/ig/HL7/fhir-shorthand/index.html\">http://build.fhir.org/ig/HL7/fhir-shorthand/index.html</a>) and also in Shorthand tutorial slides.  I found the reason for this error when Grahame pointed this #shorthand stream and found the Chris's answer. I think it could be useful to instruct slicing order here: <a href=\"http://build.fhir.org/ig/HL7/fhir-shorthand/reference.html#contains-rules-for-slicing\">http://build.fhir.org/ig/HL7/fhir-shorthand/reference.html#contains-rules-for-slicing</a>. Now there it reads: \"In FSH, slicing is addressed in three steps: (1) identifying the slices, (2) defining each sliceâ€™s contents, and (3) specifying the slicing logic.\". Maybe the firs step should be \"specifying the slicing logic\". And also in tutorial slides the order of the steps could be the right one <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 207786449,
        "sender_full_name": "Mika Tuomainen",
        "timestamp": 1598209160
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192558\">@Mika Tuomainen</span> You make a very good point, the order of that documentation is confusing for someone first using FSH. I'm not sure how much freedom we have to make changes to the documentation at this point thought. <span class=\"user-mention\" data-user-id=\"191447\">@Mark Kramer</span> would know better than me.</p>\n<p>Another thing to consider is that this documentation defines the FSH specification, and one could think of this requirement that the <code>^</code> rules come first as a weakness of the SUSHI reference implementation, and not something that is necessarily baked into FSH. If that is the case, then we should just fix this requirement in SUSHI and leave the documentation as-is.</p>",
        "id": 207835441,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1598271179
    },
    {
        "content": "<p>Good point. I added some documentation to make is clear that the three slicing steps are presented in <em>logical</em> order, but the rules from step (3) must physically occur BEFORE the rules in steps (1) and (2).</p>",
        "id": 207843326,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1598276116
    },
    {
        "content": "<p>Actually, strike that previous comment. I ended up re-ordering the three steps.</p>",
        "id": 207844617,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1598276829
    },
    {
        "content": "<p>Oh good. The incorrect order tripped me up too.</p>",
        "id": 207857123,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1598282736
    },
    {
        "content": "<p>I would agree with this - either fix the SUSHI implementation so that it does not matter what order it comes or make the change to the documentation as a technical correction.  And I should have read the rest of the replies in the thread. :)</p>",
        "id": 207858028,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1598283113
    },
    {
        "content": "<p>It's fixed now: <a href=\"http://build.fhir.org/ig/HL7/fhir-shorthand/reference.html#contains-rules-for-slicing\">http://build.fhir.org/ig/HL7/fhir-shorthand/reference.html#contains-rules-for-slicing</a></p>",
        "id": 208152068,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1598477717
    },
    {
        "content": "<blockquote>\n<p>one could think of this requirement that the ^ rules come first as a weakness of the SUSHI reference implementation, and not something that is necessarily baked into FSH.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"239822\">@Nick Freiter</span>  Yes , I agree. We can relax this rule later.</p>",
        "id": 208152186,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1598477774
    }
]