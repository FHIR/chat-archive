[
    {
        "content": "<p>I'm trying to create slices on agent in audit event, where the slices are on the values of role and requestor.</p>\n<p>First I set up the discriminators thus:</p>\n<ul>\n<li>agent ^slicing.discriminator[0].type = #pattern</li>\n<li>agent ^slicing.discriminator[0].path = \"role\"</li>\n<li>agent ^slicing.discriminator[1].type = #pattern</li>\n<li>agent ^slicing.discriminator[1].path = \"requestor\"</li>\n<li>agent ^slicing.description = \"Slicing is based on role and requestor.\"</li>\n<li>agent ^slicing.ordered = false</li>\n<li>agent ^slicing.rules = #open</li>\n</ul>\n<p>Then I declare use of three slices in the profile:</p>\n<ul>\n<li>agent contains Source 1..1 and HumanRequestor 0..* and Destination 1..1</li>\n</ul>\n<p>Then I describe constraints on each slice inline, including on the discriminator fields:</p>\n<ul>\n<li>agent[Source].role =  <a href=\"http://dicom.nema.org/resources/ontology/DCM#110153\" target=\"_blank\" title=\"http://dicom.nema.org/resources/ontology/DCM#110153\">http://dicom.nema.org/resources/ontology/DCM#110153</a> \"Source\"</li>\n<li>agent[Source].requestor = false</li>\n<li>agent[Source].altId 1..1</li>\n<li>\n<p>agent[Source].name 1..1</p>\n</li>\n<li>\n<p>agent[HumanRequestor].requestor = true</p>\n</li>\n<li>agent[HumanRequestor].role 0..*</li>\n<li>agent[HumanRequestor].altId 1..1</li>\n<li>\n<p>agent[HumanRequestor].name 1..1</p>\n</li>\n<li>\n<p>agent[Destination].role =  <a href=\"http://dicom.nema.org/resources/ontology/DCM#110152\" target=\"_blank\" title=\"http://dicom.nema.org/resources/ontology/DCM#110152\">http://dicom.nema.org/resources/ontology/DCM#110152</a> \"Destination\"</p>\n</li>\n<li>agent[Destination].requestor = false</li>\n<li>agent[Destination].altId 1..1</li>\n<li>agent[Destination].name 1..1</li>\n</ul>\n<p>The produced StructureDefinition doesn't include discriminators for agent at all.</p>",
        "id": 189000129,
        "sender_full_name": "Keith Boone",
        "timestamp": 1582619567
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191387\">@Keith Boone</span>.  That's odd.  We'll take a look.</p>",
        "id": 189019517,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1582637769
    },
    {
        "content": "<p>Logged here: <a href=\"https://github.com/FHIR/sushi/issues/254\" target=\"_blank\" title=\"https://github.com/FHIR/sushi/issues/254\">https://github.com/FHIR/sushi/issues/254</a></p>",
        "id": 189019794,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1582637988
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191387\">@Keith Boone</span> do you have the full FSH file? I tried to replicate this by just copying and pasting those rules:</p>\n<div class=\"codehilite\"><pre><span></span>Profile: MyAuditEvent\nParent: AuditEvent\n* agent ^slicing.discriminator[0].type = #pattern\n* agent ^slicing.discriminator[0].path = &quot;role&quot;\n* agent ^slicing.discriminator[1].type = #pattern\n* agent ^slicing.discriminator[1].path = &quot;requestor&quot;\n* agent ^slicing.description = &quot;Slicing is based on role and requestor.&quot;\n* agent ^slicing.ordered = false\n* agent ^slicing.rules = #open\n* agent contains Source 1..1 and HumanRequestor 0..* and Destination 1..1\n* agent[Source].role = http://dicom.nema.org/resources/ontology/DCM#110153 &quot;Source&quot;\n* agent[Source].requestor = false\n* agent[Source].altId 1..1\n* agent[Source].name 1..1\n* agent[HumanRequestor].requestor = true\n* agent[HumanRequestor].role 0..*\n* agent[HumanRequestor].altId 1..1\n* agent[HumanRequestor].name 1..1\n* agent[Destination].role = http://dicom.nema.org/resources/ontology/DCM#110152 &quot;Destination&quot;\n* agent[Destination].requestor = false\n* agent[Destination].altId 1..1\n* agent[Destination].name 1..1\n</pre></div>\n\n\n<p>And this did produce output with discriminators on the <code>AuditEvent.agent</code> element. So there may be a cause outside these rules alone.</p>",
        "id": 189022903,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1582640392
    }
]