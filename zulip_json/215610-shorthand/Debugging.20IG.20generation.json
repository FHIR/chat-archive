[
    {
        "content": "<p>It's my day 3 with FSH/IG wizardry, so any help is greatly appreciated.  I am trying to build a basic profile to include extension containing address validation results to the Address. The intent is to have a at most one validation results extension on Organization for now:</p>\n<p>Profile:        MyOrganization<br>\nParent:         Organization<br>\nId:             My-organization<br>\nTitle:          \"Organization\"<br>\nDescription:    \"A profile on the Organization resource for My Organization.\"</p>\n<ul>\n<li>address.extension contains MyValidatedAddressExtension named MyValidatedAddressExtension 0..1</li>\n</ul>\n<p>Extension: MyValidatedAddressExtension<br>\nTitle: \"My Validated Address\"<br>\nDescription: \"Address that's been validated by an external service.\"</p>\n<ul>\n<li>value[x] only code</li>\n<li>\n<p>valueCode from MyAddressValidationResultsValueS<br>\nValueSet: MyAddressValidationResultsValueSet<br>\nTitle: \"My Address Validation Value Set\"<br>\nDescription: \"My Address Validation Value Set\"</p>\n</li>\n<li>\n<p>include codes from system ExternalAddressValidationResultsCodeSystem</p>\n</li>\n</ul>\n<p>CodeSystem: ExternalAddressValidationResultsCodeSystem<br>\nTitle: \"External Address Validation Results Code System\"<br>\nDescription: \"Code System for External Address Validation Results\"</p>\n<ul>\n<li>^url = \"<a href=\"https://www.external.org/AddressValidation\">https://www.external.org/AddressValidation</a>\"</li>\n<li>#valid \"Valid\" \"Valid Address as validated by an external service\"</li>\n<li>#invalid \"Invalid\" \"Invalid Address as validated by an external service\"</li>\n<li>#not-validated \"Not-Validated\" \"Unable to validate address by an external service\"</li>\n</ul>\n<p>This mostly works except when I am building IG, qa.html contains this error:</p>\n<p>StructureDefinition/ValidatedAddressExtension: StructureDefinition  Process Info    Validate resource against profile <a href=\"http://hl7.org/fhir/StructureDefinition/StructureDefinition\">http://hl7.org/fhir/StructureDefinition/StructureDefinition</a><br>\nStructureDefinition/ValidatedAddressExtension: StructureDefinition.snapshot.element[3].fixed.ofType(uri)    error   The element Extension.url has a fixed of type uri, which is not in the list of allowed types ([http://hl7.org/fhirpath/System.String])</p>\n<p>Is it a showstopper? What am I doing wrong?</p>",
        "id": 230756425,
        "sender_full_name": "Nick Goupinets",
        "timestamp": 1616011126
    },
    {
        "content": "<p>This is a known bug recently introduced in the IG Publisher.  They're working on fixing it.  It's discussed <a href=\"#narrow/stream/215610-shorthand/topic/The.20element.20Extension.2Eurl.20has.20a.20fixed.20of.20type.20uri\">here</a> and <a href=\"#narrow/stream/179252-IG-creation/topic/BUG.3A.20The.20element.20Extension.2Eurl.20has.20a.20fixed.20of.20type.20uri\">here</a>.</p>",
        "id": 230759303,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1616012196
    },
    {
        "content": "<p>BTW -- welcome to the FSH community!  We're glad you're here.  Here's a pro-tip: you can share short(ish) FSH snippets via <a href=\"https://fshschool.org/FSHOnline/\">FSH Online</a>.  For example, here is a link to the code you posted above: <a href=\"https://fshschool.org/FSHOnline/#/share/3tAocLJ\">https://fshschool.org/FSHOnline/#/share/3tAocLJ</a></p>",
        "id": 230759709,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1616012379
    },
    {
        "content": "<p>Thank you Chris! With so much support, I am here to stay :)</p>",
        "id": 230770813,
        "sender_full_name": "Nick Goupinets",
        "timestamp": 1616016857
    },
    {
        "content": "<p>Oh sorry.  Forgot to tell you.  Only the first two are free -- and it looks like you already used yours.  The next one is $59.95 (or you can buy a 2-pack for $99.95).  ;-)</p>",
        "id": 230771655,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1616017255
    },
    {
        "content": "<p>That was a joke, by the way.  Always glad to help!</p>",
        "id": 230784376,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1616022543
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191469\">Chris Moesel</span> <a href=\"#narrow/stream/215610-shorthand/topic/Debugging.20IG.20generation/near/230784376\">said</a>:</p>\n<blockquote>\n<p>That was a joke, by the way.  Always glad to help!</p>\n</blockquote>\n<p>He says it's a joke, but you won't be laughing when the bill shows up at your office!  I'm okay with paying for support, but I thought the $25k bill was a bit excessive!</p>",
        "id": 230784452,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1616022602
    },
    {
        "content": "<p>He has a special price just for you Jean...</p>",
        "id": 230802441,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1616031959
    },
    {
        "content": "<p>Hey! I'm paying $139.95 a month for my support with a maximum of one issue per month!  How come he gets a deal?!?</p>",
        "id": 230850041,
        "sender_full_name": "David Pyke",
        "timestamp": 1616068451
    },
    {
        "content": "<p>Chris needs to post his rates.  None of this discriminating against Canadians!</p>",
        "id": 230850102,
        "sender_full_name": "David Pyke",
        "timestamp": 1616068498
    },
    {
        "content": "<p>29,99â‚¬ for shipping chat messages to Germany!? ARE YOU KIDDING ME????</p>",
        "id": 230850303,
        "sender_full_name": "Simone Heckmann",
        "timestamp": 1616068616
    },
    {
        "content": "<p>don't foget about surge pricing</p>",
        "id": 230852114,
        "sender_full_name": "John Moehrke",
        "timestamp": 1616069552
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192587\">@David Pyke</span> -- the prices reflect how difficult you are to deal with.  Each person has their own rate.  So if your rate seems high, well...</p>",
        "id": 230857077,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1616072006
    },
    {
        "content": "<p>I'm almost scared to ask what my rate is...</p>",
        "id": 231243154,
        "sender_full_name": "David Hay",
        "timestamp": 1616363115
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> --  We give you a discount since you promote FSH on your blog and in your tooling.</p>",
        "id": 231303785,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1616417286
    },
    {
        "content": "<p>Lol, this is funny. To be honest, FSH is such a fantastic tool, any it would be easy to justify any reasonable support costs :)</p>",
        "id": 232664072,
        "sender_full_name": "Nick Goupinets",
        "timestamp": 1617224362
    },
    {
        "content": "<p>shh <span class=\"user-mention\" data-user-id=\"358887\">@Nick Goupinets</span> don't give them ideas!</p>",
        "id": 232664191,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1617224410
    },
    {
        "content": "<p>My IG generation is  stuck from here (after line \"Sushi: info  Converted 28 FHIR StructureDefinitions\"). Had errors in the profile, which has been corrected, but this seems something not related to that:<br>\n<a href=\"/user_uploads/10155/Ej9hnYNMVXzbbyeMPyk_qmVM/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/Ej9hnYNMVXzbbyeMPyk_qmVM/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/Ej9hnYNMVXzbbyeMPyk_qmVM/image.png\"></a></div><p>I notice Node.js component using 500+MB since running IG tool (see image)<br>\n<a href=\"/user_uploads/10155/aSstgFhgBoOrsezGXScvrF1n/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/aSstgFhgBoOrsezGXScvrF1n/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/aSstgFhgBoOrsezGXScvrF1n/image.png\"></a></div><p><code>temp/qa</code> folder too is not updated, so this means it has not come upto this stage.</p>\n<p>Is there a way to see a debug output ?</p>",
        "id": 235292040,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1618898761
    },
    {
        "content": "<p>That looks like either you have a <em>lot</em> of CodeSystem/ValueSet/Instances (since it does those next after StructureDefinitions) or SUSHI is trying to load some large sub-folder in the project.  Does it work OK <em>outside</em> of the IG Pubisher (if you run <code>sushi</code> directly)?  Outside of the publisher, you can turn on SUSHI debug output via the <code>-d</code> flag -- but, honestly, we don't provide many additional debug statements.</p>\n<p>I have also seen cases where the IG Publisher does not handle long log statements from SUSHI well and it stops printing them to the console -- so it <em>appears</em> it is stuck even though it isn't.  Have you tried just waiting a while to see if it eventually picks up again?</p>",
        "id": 235334071,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1618921560
    },
    {
        "content": "<p>IG generation takes some time for me as well (~15min) and it looks like it is stuck during this progress. Unless you haven't tried this I would suggest that you \"just wait\" for a good amount of time (as <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> also said)</p>",
        "id": 235335118,
        "sender_full_name": "Christian Nau",
        "timestamp": 1618921972
    },
    {
        "content": "<p>This IG generates fine with a minimal setup. Also, I have kept it for longer periods (&gt; 30 mins). So I'll try reducing the no of StuctureDefinitions and other sub-items as much as possible, thanks for the tip of running just Sushi, as its colored output helps save me a lot of time. So I will figure out to fix the errors first.</p>",
        "id": 235336421,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1618922539
    },
    {
        "content": "<p>I have sushi giving me no errors, also included dependencies in <code>sushi-config.yaml</code>:</p>\n<div class=\"codehilite\"><pre><span></span><code>dependencies:\n  hl7.fhir.no.basis:\n    uri: https://simplifier.net/packages/hl7.fhir.no.basis/2.0.11\n    version: 2.0.11\n</code></pre></div>\n<p>But getting this error, any idea why ?</p>\n<div class=\"codehilite\"><pre><span></span><code>Publishing Content Failed: Error generating snapshot for HnDomainVitalSignsObservationBloodpressure(HnDomainVitalSignsObservationBloodpressure): Cannot find or generate snapshot for base definition (http://hl7.no/fhir/StructureDefinition/no-domain-vitalsignsobservation-bloodpressure from http://dips.no/StructureDefinition/HnDomainVitalSignsObservationBloodpressure) (00:26.0176)\n</code></pre></div>\n<p><a href=\"/user_uploads/10155/c6jXh7_bhHHwwQQE5S1Kk087/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/c6jXh7_bhHHwwQQE5S1Kk087/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/c6jXh7_bhHHwwQQE5S1Kk087/image.png\"></a></div>",
        "id": 235795239,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619161056
    },
    {
        "content": "<p>The reason is, that Simplifier doesn't include snapshots in their FHIR packages.</p>",
        "id": 235811049,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1619169567
    },
    {
        "content": "<p>workaround is to download the package directly from Simplifier, you can then choose download with snapshots, and then replace the version in your local fhir package cache with the snapshotted one.</p>",
        "id": 235811166,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1619169618
    },
    {
        "content": "<p>I hope Simplifier will address this issue soon.</p>",
        "id": 235811208,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1619169640
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> tried your solution by manually replacing the local package cache, but it doesn't seem to pick that up. I tried specifying the dependencies as below, still no luck. Since the URI is needed, won't it always fetch from there ? </p>\n<div class=\"codehilite\"><pre><span></span><code>dependencies:\n  hl7.fhir.no.basis: 2.0.11\n</code></pre></div>",
        "id": 235828377,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619179343
    },
    {
        "content": "<p>Also, there are many dependencies to this package ( hl7.fhir.no.basis ), so do we need those added under YAML file dependencies as well? I don't see much documentation around this, all say just add the URI. <br>\n<a href=\"/user_uploads/10155/AqnZyWKOu-BMscsMCHyHnjMo/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/AqnZyWKOu-BMscsMCHyHnjMo/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/AqnZyWKOu-BMscsMCHyHnjMo/image.png\"></a></div>",
        "id": 235828871,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619179630
    },
    {
        "content": "<p>yes transitive dependencies (if they are coming from simplifier) are still another problem. You have to manually d/l each one of these and add them to your cache</p>",
        "id": 235832332,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1619181288
    },
    {
        "content": "<p>This is the thread discussing this issue: <a href=\"#narrow/stream/215610-shorthand/topic/Dependencies\">https://chat.fhir.org/#narrow/stream/215610-shorthand/topic/Dependencies</a></p>",
        "id": 235832415,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1619181336
    },
    {
        "content": "<p>ok, thanks will continue my question there, as the topic of this post is different</p>",
        "id": 235834594,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619182339
    },
    {
        "content": "<p>Usually the issue w/ Simplifier not publishing snapshots causes problems with <em>SUSHI</em>.  In this case, however, <span class=\"user-mention\" data-user-id=\"253898\">@Janaka Peiris</span> reports that SUSHI does fine and it is actually causing an issue in the <em>IG Publisher</em>.  So does the IG Publisher <em>also</em> not handle the Simplifier packages well, <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span>?</p>",
        "id": 235834712,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1619182404
    },
    {
        "content": "<p>As suggested by <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> I was able to get SUSHI working. Downloaded profiles into <code>C:\\Users\\&lt;user&gt;\\.fhir\\packages\\hl7.fhir.no.basis#dev</code> with snapshot and SUSHI was ok(<code>\"Sushi: info  Loaded package hl7.fhir.no.basis#dev\"</code>):</p>\n<div class=\"codehilite\"><pre><span></span><code>dependencies:\n  hl7.fhir.no.basis:\n    uri: https://simplifier.net/packages/hl7.fhir.no.basis/2.0.11\n    version: dev\n</code></pre></div>\n<p>Yet the same error comes with IG Publisher.</p>",
        "id": 235835406,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619182706
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span>  <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span>  Do you know how I can get IG Publisher (publisher.jar) to use the same approach as in Sushi, and get it to refer updated packages from local cache ?</p>",
        "id": 236293967,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619508034
    },
    {
        "content": "<p>the IG Publisher can also use dev dependencies, provide the package name and the version 'dev'.  maybe you need to remove the uri?</p>",
        "id": 236297125,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1619510141
    },
    {
        "content": "<p>URL in dependencies is needed for Sushi to validate, otherwise it stops with error:</p>\n<div class=\"codehilite\"><pre><span></span><code>Failed to add hl7.fhir.no.basis:dev to ImplementationGuide instance because SUSHI could not find the IG URL in the dependency IG. To specify the IG URL in your sushi-config.yaml, use the dependency details format:\n</code></pre></div>\n<p>So this is the error IG Publisher still gives:</p>\n<div class=\"codehilite\"><pre><span></span><code>Cannot find or generate snapshot for base definition\n</code></pre></div>",
        "id": 236305059,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619514562
    },
    {
        "content": "<p>The error reported by SUSHI is that it cannot determine the canonical URL to the IG from the package.  This is required because <a href=\"http://build.fhir.org/implementationguide-definitions.html#ImplementationGuide.dependsOn\">ImplementationGuide.dependsOn.uri</a> is <code>1..1</code> -- so we <em>need</em> to have it when we generate the <code>ImplementationGuide</code>.  Usually we search the package for an instance of <code>ImplementationGuide</code> w/ the specified package ID and then extract the URL from that.  But many (most?) Simplifier packages don't have an <code>ImplementationGuide</code> at all, so there is nothing to extract it from.  Which is why we ask the user to provide it in the <code>sushi-config.yaml</code> in those cases.</p>\n<p>This, however, is a separate issue from the IG Publisher error <code>Cannot find or generate snapshot for base definition</code>.  If I am to take that one at face value, it sounds like it can't find a snapshot in a base definition (presumably the base for one of your profiles).  I actually don't <em>fully</em> understand the issue, however, because I <em>thought</em> that the IG Publisher generated snapshots when they weren't there (unlike SUSHI, which does not have that capability). So... I am already a little confused by that.  When SUSHI can't find a snapshot in a dependency, the solution is to download a version of the package w/ snapshots in it and manually copy that into your local FHIR cache (which I <a href=\"#narrow/stream/215610-shorthand/topic/Dependencies/near/230538588\">described here</a>, and I think you're already aware of).  Are you saying that when you do that, the IG Publisher still doesn't seem to recognize the snapshots in your package?</p>",
        "id": 236331034,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1619528230
    },
    {
        "content": "<p>usually it means that snapshot generation failed for that base, and there should be an error in the output</p>",
        "id": 236398680,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1619553501
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> Yes, I've already copied the package with snapshot and was able to get SUSHI to validate without errors. So it's the IG Publisher I have this error now. After your explanation, I checked the input/ImplementationGuide resource json file and noticed that doesnt have <code>dependsOn</code> property, and may be this is why IG Publisher is unable to proceed.  So I tried adding it as follows:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;dependsOn&quot;:[\n    {\n      &quot;uri&quot;: &quot;https://simplifier.net/packages&quot;,\n      &quot;packageId&quot; : &quot;hl7.fhir.no.basis&quot;,\n      &quot;version&quot;: &quot;2.0.11&quot;\n    }\n  ],\n</code></pre></div>\n<p>Now the error has changed to: </p>\n<div class=\"codehilite\"><pre><span></span><code>Load Package hl7.fhir.pubpack#0.0.7\nLoad Package hl7.fhir.xver-extensions#0.0.5\nLoad Package hl7.terminology.r4#2.1.0\nDependency &#39;hl7.fhir.no.basis&#39; has no id, so can&#39;t be referred to in markdown in the IG (00:25.0066)\nPublishing Content Failed: no core dependency or FHIR Version found in the Package definition (00:25.0077)\n</code></pre></div>\n<p>I see that it tries to load <code>hl7.fhir.no.basis</code>, so it must be fetching it from the url. Then I checked the packages.json, and found 2 mandatory properties are missing (fhirVersions and author). Tried manually updating the values in my local cache, still it doesn't seem to pick that up. </p>\n<p>So Is there a way I can get the local copy (with snapshot) to be referred by IG Publisher, as we did in Sushi with <code>version: dev</code> ? (already tried as \"version\": \"dev\" but IG Pub gives the same error)</p>",
        "id": 236630642,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619681202
    },
    {
        "content": "<p>I've tested with newer versions of package <code>hl7.fhir.no.basis</code>  and that <code>2.0.16-beta</code> seems to have corrected those errors. Now checking next error with those...</p>",
        "id": 236645031,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1619688953
    },
    {
        "content": "<p>I had to go through source code of IG Publisher from <a href=\"https://github.com/HL7/fhir-ig-publisher/blob/9dbb2b23516665ae919043b0290fc55269205480/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java#L2833\">Publisher.java</a>  to figure out this error:</p>\n<div class=\"codehilite\"><pre><span></span><code>Load Package hl7.terminology.r4#2.1.0\nPublishing Content Failed: JsonNull                                              (00:23.0388)\n                                                                                 (00:23.0390)\nUse -? to get command line help                                                  (00:23.0392)\n                                                                                 (00:23.0398)\nStack Dump (for debugging):                                                      (00:23.0401)\njava.lang.UnsupportedOperationException: JsonNull\n        at com.google.gson.JsonElement.getAsString(JsonElement.java:192)\n        at org.hl7.fhir.utilities.npm.NpmPackage.getWebLocation(NpmPackage.java:818)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:2789)\n        at org.hl7.fhir.igtools.publisher.Publisher.initializeFromIg(Publisher.java:1909)\n        at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1461)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:729)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:8429)\n</code></pre></div>\n<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> This error was due to the \"url\" property of fhir package, which was <code>null</code>. Its great if it can be given an error message instead of an exception. Since I had my local cache with \"fhir package with snapshot\" downloaded as a <code>dev</code> version, I manually edited the <code>packages.json</code> and included 'url' with same value from simplifier package repo. Then it solved above issue, but I have to continue finding an answer for the next error.</p>",
        "id": 237360927,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1620147362
    },
    {
        "content": "<p><a href=\"https://confluence.hl7.org/display/FHIR/NPM+Package+Specification\">https://confluence.hl7.org/display/FHIR/NPM+Package+Specification</a>: says <code>url</code> of packages.json is optional, so then IG Publisher should handle that error, isnt it ?</p>\n<div class=\"codehilite\"><pre><span></span><code>Package Manifest Properties\n\nurl - optional - where the human readable representation (e.g. IG) that represents this version of this package is published on the web (if there is such a thing)\n</code></pre></div>",
        "id": 237363472,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1620148311
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192681\">@Espen Stranger Seland</span> , <span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span> Do you know of an Implementation Guide created using the fhir package <code> hl7.fhir.no.basis </code> ver <code>2.0.16-beta</code> (or any other version)  ? I'm following the FHIR Shorthand path as per <a href=\"https://fshschool.org/docs/sushi/project/\">https://fshschool.org/docs/sushi/project/</a>. </p>\n<p>Either my files need a lot of changes, or I'm not sure if I'm missing something here, as anyone who had tried this approach should have faced the above issues using the IG Publisher. On the other hand, there are so many IGs created and published using IG Publisher tool  (I assume). Let me know if you know of any such Norwegian IGs so I can refer. Thanks</p>",
        "id": 237368141,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1620150097
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253898\">@Janaka Peiris</span> Sorry about this, I did not realize that IG generation using SUSHI and IG publisher was such a pain with the no-basis packages. As you noted the 2.0.16-beta version did fix some issues reported by the java-validation tool, and I am glad to see that this actually did help somewhat. </p>\n<p>Our current production pipeline involves Forge and SIMPLIFIER as tools for publishing. But if there are problems using the SIMPLIFIER packages for IG generation using the java tooling and SUSHI this is actually a big deal for us. I have been interested in looking into IG generation using standard tooling for some time now, but other pressing issues have gotten the best of me so far unfortunately. Anyways, please let us know if there are any other bugfixes we could provide to the packages/source-code of no-basis to make the SUSHI/IG-publisher pipeline work as intended.</p>\n<p>I don't know of any projects in Norway using the IG-publisher pipeline currently, as we invested in the SIMPLIFIER tooling early on and most major projects are using that pipeline for FHIR documentation.</p>",
        "id": 237372966,
        "sender_full_name": "Thomas Tveit Rosenlund",
        "timestamp": 1620151822
    },
    {
        "content": "<p>Thanks for all of the information, <span class=\"user-mention\" data-user-id=\"253898\">@Janaka Peiris</span>.  I'm not sure if I fully followed everything, but it seems like you have figured some things out.</p>\n<p>If there is SUSHI output (generated in the <code>fsh-generated</code> folder) that needs to be changed, please let me know and I can see if we can fix it in SUSHI.  For issues w/ the IG Publisher, however, it's probably best to reach out to Grahame, as I (and the FSH/SUSHI) team do not work on the IG Publisher.</p>",
        "id": 237384249,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1620156407
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span> and <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> , I will post updates as I figure out solutions, as that would help anyone generating IGs using these Norwegian national base packages.</p>",
        "id": 237438906,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1620188722
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  I think <a href=\"#narrow/stream/215610-shorthand/topic/Debugging.20IG.20generation/near/237360927\">this</a> might need a fix in IG Publisher, as it should not end up with an error for an optional property in <code>packages.json</code> isn't it ?  If this should be reported, I'll add details.</p>",
        "id": 237439243,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1620189060
    },
    {
        "content": "<p>I'm not sure why the url is present and null?</p>",
        "id": 237439566,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1620189338
    },
    {
        "content": "<p>Yes, so I tried removing the <code>url</code> property, then IG Publisher didn't complain. The error was when it tries to get a string out of a \"defined\" property, which is null.  </p>\n<p><span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span>  as <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> mentions, maybe we should check the rest of the properties with <code>null</code> and remove those to avoid any issues:</p>\n<p>packages.json from <a href=\"https://simplifier.net/packages/hl7.fhir.no.basis/2.0.16-beta\">https://simplifier.net/packages/hl7.fhir.no.basis/2.0.16-beta</a>:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;name&quot;: &quot;hl7.fhir.no.basis&quot;,\n  &quot;version&quot;: &quot;2.0.16-beta&quot;,\n  &quot;description&quot;: &quot;Norwegian core profiles for R4\\r\\nversion 2.0.16-beta&quot;,\n  &quot;author&quot;: &quot;thomiz&quot;,\n  &quot;fhirVersions&quot;: [\n    &quot;4.0.1&quot;\n  ],\n  &quot;dependencies&quot;: {\n    &quot;hl7.fhir.core&quot;: &quot;4.0.1&quot;,\n    &quot;hl7.fhir.r4.core&quot;: &quot;4.0.1&quot;\n  },\n  &quot;devDependencies&quot;: null,\n  &quot;keywords&quot;: null,\n  &quot;license&quot;: null,\n  &quot;homepage&quot;: null,\n  &quot;directories&quot;: null,\n  &quot;title&quot;: null,\n  &quot;fhir-version-list&quot;: null,\n  &quot;maintainers&quot;: null,\n  &quot;canonical&quot;: null,\n  &quot;url&quot;: null,\n  &quot;jurisdiction&quot;: null\n}\n</code></pre></div>",
        "id": 237441581,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1620190929
    },
    {
        "content": "<p>it's certainly not something I expected, that you'd have null there, instead of no property, and because of the way gson (google json library) works, they'll all produce NPEs. Or some of them anyway. the <code>url</code>property won't after the next release</p>",
        "id": 237442821,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1620192155
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253898\">@Janaka Peiris</span>  You could try using my updated packages.json <a href=\"https://simplifier.net/HL7Norwayno-basis/package.json/~overview\">https://simplifier.net/HL7Norwayno-basis/package.json/~overview</a></p>\n<p>Is should be available as part of the package download starting from the next package version we publish.</p>",
        "id": 237472216,
        "sender_full_name": "Thomas Tveit Rosenlund",
        "timestamp": 1620210395
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span> let me know once this new package is updated in Simplifier. Though the  modified FHIR package in local cache is picked up correctly by SUSHI (ver: dev), it seems the IG Publisher is still referring other (ver: 2.0.16-beta). So when 2 packages are being referred, there could be issues. I have put this on hold as going through code to investigate is taking more time to resolve.</p>",
        "id": 237790476,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1620378598
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span> Thoughts on how those <code>null</code> values came there originally?</p>",
        "id": 238460733,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1620820325
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span> I learned I can answer my own question, our package library may have introduced them previously. We also already published a fix, which will remove the <code>null</code> values from <code>package.json</code> on any newly created package version.</p>",
        "id": 238463628,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1620821857
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> You might still want to put error handling in place for ignoring any package manifest parameters that have a <code>null</code> value? (If only because we can't remove this from package manifests from already published packages)</p>",
        "id": 238463787,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1620821964
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> Correct, SIMPLIFIER put them in there. I could fix this myself by editing the package.json file. Nice to hear you have fixed this!</p>",
        "id": 238467182,
        "sender_full_name": "Thomas Tveit Rosenlund",
        "timestamp": 1620823620
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span> Thanks for confirming. Sorry for the trouble!</p>",
        "id": 238476499,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1620827350
    },
    {
        "content": "<p>I added it for this one. I'll review the others at some stage</p>",
        "id": 238563096,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1620864853
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192856\">@Thomas Tveit Rosenlund</span> is there a plan to upload a new package, latest I still see is still <code>hl7.fhir.no.basis 2.0.16-beta</code> at <a href=\"https://simplifier.net/HL7Norwayno-basis/~packages\">https://simplifier.net/HL7Norwayno-basis/~packages</a></p>",
        "id": 240811434,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1622453498
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"253898\">Janaka Peiris</span> <a href=\"#narrow/stream/215610-shorthand/topic/Debugging.20IG.20generation/near/240811434\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"192856\">Thomas Tveit Rosenlund</span> is there a plan to upload a new package, latest I still see is still <code>hl7.fhir.no.basis 2.0.16-beta</code> at <a href=\"https://simplifier.net/HL7Norwayno-basis/~packages\">https://simplifier.net/HL7Norwayno-basis/~packages</a></p>\n</blockquote>\n<p>Yes, but it will be an excact copy of the beta. Have not found any other bugs in the beta version (except the packaging definition that is fixed now).</p>",
        "id": 240813279,
        "sender_full_name": "Thomas Tveit Rosenlund",
        "timestamp": 1622454667
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I'm trying to debug the following error (), so I was checking the Git repo at:<br>\n<a href=\"https://github.com/HL7/fhir-ig-publisher/blob/master/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java\">https://github.com/HL7/fhir-ig-publisher/blob/master/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java</a></p>\n<div class=\"codehilite\"><pre><span></span><code>java.lang.Exception: Error generating snapshot for HnDomainVitalSignsObservationBloodpressure(HnDomainVitalSignsObservationBloodpressure): Cannot find or generate snapshot for base definition (http://hl7.no/fhir/StructureDefinition/no-domain-vitalsignsobservation-bloodpressure from http://dips.no/StructureDefinition/HnDomainVitalSignsObservationBloodpressure)\n        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:4522)\n</code></pre></div>\n<p>Q:<br>\n1) I see <code>org.hl7.fhir.r5.model.*</code> are used from <code>master</code> branch, is there a different branch that uses R4 models ?</p>\n<p>2) I tried downloading the project and just building it using \"mvn install -e\", then I get this error. Is there anything i'm missing ?</p>\n<p><a href=\"/user_uploads/10155/nJiTVK6JxtDGIK0nnfOQEeb3/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/nJiTVK6JxtDGIK0nnfOQEeb3/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/nJiTVK6JxtDGIK0nnfOQEeb3/image.png\"></a></div>",
        "id": 241105870,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1622609668
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> will let you know when the IG publisher compiles again</p>",
        "id": 241106453,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1622610516
    },
    {
        "content": "<p>the IG publisher is all R5 internally</p>",
        "id": 241106456,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1622610528
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191469\">Chris Moesel</span> <a href=\"#narrow/stream/215610-shorthand/topic/Debugging.20IG.20generation/near/236331034\">said</a>:</p>\n<blockquote>\n<p>When SUSHI can't find a snapshot in a dependency, the solution is to download a version of the package w/ snapshots in it and manually copy that into your local FHIR cache (which I <a href=\"#narrow/stream/215610-shorthand/topic/Dependencies/near/230538588\">described here</a>, and I think you're already aware of).  Are you saying that when you do that, the IG Publisher still doesn't seem to recognize the snapshots in your package?</p>\n</blockquote>\n<p>Is there a more  humane way of doing this already?</p>",
        "id": 241149108,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622640866
    },
    {
        "content": "<p>Is there a way for sushi to say \"no wait, if the package is from simplifier, I'm going to make sure I download the snapshot-enabled package\" <br>\n?</p>",
        "id": 241149211,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622640923
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> <br>\nFor Sushi, this is possible by setting the version to \"dev\" . I've done this already and Sushi detects local package cache correctly. But what I dont know is if the IG Publisher tool does the same (take local cache without reaching the URL). <br>\neg:</p>\n<div class=\"codehilite\"><pre><span></span><code>dependencies:\n  hl7.fhir.no.basis:\n    uri: https://simplifier.net/packages/hl7.fhir.no.basis/\n    version: dev\n</code></pre></div>",
        "id": 241150349,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1622641398
    },
    {
        "content": "<p>that just tells me that the package should be installed locally before (manually, which is what I want to avoid)</p>",
        "id": 241152524,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622642336
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Falling back to ehealthplatform.be.r4.federalprofiles#current since ehealthplatform.be.r4.federalprofiles#dev is not locally cached. To avoid this, add ehealthplatform.be.r4.federalprofiles#dev to your local FHIR cache by building it locally with\nthe (00:06.0432)\n</code></pre></div>",
        "id": 241152530,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622642338
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span>, there is not yet a \"more humane\" way of handling Simplifier packages that don't have snapshots.  Unfortunately, Simplifier does not provide an API for downloading the package <em>with</em> snapshots (otherwise we would use it!).  Only authenticated users can download the snapshot-enabled packages (through a browser) -- which is why updating the FHIR cache is still a manual process.</p>",
        "id": 241153597,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1622642772
    },
    {
        "content": "<p>ah ok that is what I was missing</p>",
        "id": 241153949,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622642942
    },
    {
        "content": "<p>there is a GET request for getting the package with snapshots, but it requires authentication indeed...</p>",
        "id": 241154119,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622643031
    },
    {
        "content": "<p>is there any expectation that in the future this would be handled? I guess the change would need to be on simplifier <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> ?</p>",
        "id": 241154200,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622643072
    },
    {
        "content": "<p>I'd still like to see if there are things we can do to make it a little easier (if nothing else, providing polished documentation on how to do it) -- but right now releasing SUSHI 2.0 w/ logical models, custom resources, indent contexts, and enhanced CodeSystem syntax is top priority!</p>",
        "id": 241154272,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1622643113
    },
    {
        "content": "<p>For reference, here is a conversation from March/April covering some of these topics w/ feedback from Ward as well: <a href=\"#narrow/stream/215610-shorthand/topic/Dependencies\">https://chat.fhir.org/#narrow/stream/215610-shorthand/topic/Dependencies</a></p>",
        "id": 241154617,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1622643265
    },
    {
        "content": "<p>Right, I did not find that threadt, thanks.</p>",
        "id": 241158446,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622644852
    },
    {
        "content": "<p>I'll continue the discussion over there</p>",
        "id": 241158558,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1622644903
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191451\">Patrick Werner</span> <a href=\"#narrow/stream/215610-shorthand/topic/Debugging.20IG.20generation/near/235811166\">said</a>:</p>\n<blockquote>\n<p>workaround is to download the package directly from Simplifier, you can then choose download with snapshots, and then replace the version in your local fhir package cache with the snapshotted one.</p>\n</blockquote>\n<p>Can anybody point me in the direction where the package cache is on mac? I checked /Library/Caches and /Users/{user}/Library/Caches but can't find it. I have the .fhir folder on my windows machine, but no such thing on my mac.</p>",
        "id": 241400377,
        "sender_full_name": "Julian Sass",
        "timestamp": 1622731430
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>cd ~\nls .fhir\n</code></pre></div>",
        "id": 241401020,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1622731681
    },
    {
        "content": "<p>in your home directory /Users/{user}</p>",
        "id": 241401159,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1622731723
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 241401401,
        "sender_full_name": "Julian Sass",
        "timestamp": 1622731809
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/215610-shorthand/topic/Debugging.20IG.20generation/near/241106453\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"248736\">Mark Iantorno</span> will let you know when the IG publisher compiles again</p>\n</blockquote>\n<p>I was able to load project using Eclipse IDE and Debug. Issues I faced were:<br>\n1) I had taken a copy of the code using a ZIP file than cloning the GIT repo. So my local folder did not have branch information. There was an error mentioned while running Maven compile. Cloning is needed. <br>\n2) Still there were few errors in <code>org.hl7.fhir.igtools.publisher.Publisher.java</code>. But all those could be corrected just by following suggestions (I guess those arent critical). </p>\n<p>Just shared this, for anyone wanting to debug the IG errors and find reasons.</p>",
        "id": 241874440,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1623132774
    },
    {
        "content": "<p>Pls <a href=\"https://github.com/HL7/fhir-ig-publisher/releases/\">download</a> the latest IG Generator tool, as there are some fixes. I've had many issues trying to debug using Eclipse and manually running Jekyll to get this generated. </p>\n<p>Thanks a lot <span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> for the updates !</p>",
        "id": 242625242,
        "sender_full_name": "Janaka Peiris",
        "timestamp": 1623688608
    },
    {
        "content": "<p>Thanks, <span class=\"user-mention\" data-user-id=\"253898\">@Janaka Peiris</span>  -- to be specific, I am able to generate the IG without problems locally, it is just not getting hooked up to github IO.</p>",
        "id": 242644275,
        "sender_full_name": "Peter Robinson",
        "timestamp": 1623697338
    }
]