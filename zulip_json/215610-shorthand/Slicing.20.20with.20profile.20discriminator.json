[
    {
        "content": "<p>Can anyone please help me?</p>\n<p>I'm trying to slice a bundle entry using the profile as discriminator, but SUSHI give me an \"Value does not match element type\" error.<br>\nI have provided a simple example of my approach below. What am I missing?</p>\n<p>Thanks, Torben</p>\n<p>Profile: MyBundle<br>\nParent: Bundle<br>\n...</p>\n<ul>\n<li>entry ^slicing.discriminator.type = #profile</li>\n<li>entry ^slicing.discriminator.path = \"item.resolve()\"</li>\n<li>entry contains myPatient 1..1 and ...</li>\n<li>entry[myPatient ].resource 1..1</li>\n<li>entry[myPatient ].resource only MyPatient<br>\n...</li>\n</ul>\n<p>Profile: MyPatient<br>\nParent: Patient<br>\n...</p>\n<p>Instance: TestPatient<br>\nInstanceOf: MyPatient<br>\n...</p>\n<p>Instance: TestBundle<br>\nInstanceOf: MyBundle<br>\n...</p>\n<ul>\n<li>entry[myPatient ].resource = Reference(TestPatient) // Fails: Cannot fix Reference value: Reference(Patient/TestPatient). Value does not match element type: Patient<br>\n...</li>\n</ul>",
        "id": 207499619,
        "sender_full_name": "Torben M. Hagensen",
        "timestamp": 1597912095
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"240678\">Torben M. Hagensen</span> <a href=\"#narrow/stream/215610-shorthand/topic/Slicing.20.20with.20profile.20discriminator/near/207499619\">said</a>:</p>\n<blockquote>\n<ul>\n<li>entry ^slicing.discriminator.path = \"item.resolve()\"</li>\n</ul>\n</blockquote>\n<p>It seems to ignore the path entirely???<br>\nTried \"resource\" and \"adkfkjhk\" with no effect at all.</p>\n<p>I hope someone can tell me how to do this <span aria-label=\"sweat\" class=\"emoji emoji-1f613\" role=\"img\" title=\"sweat\">:sweat:</span></p>",
        "id": 207504524,
        "sender_full_name": "Torben M. Hagensen",
        "timestamp": 1597915942
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"240678\">Torben M. Hagensen</span> <a href=\"#narrow/stream/215610-shorthand/topic/Slicing.20.20with.20profile.20discriminator/near/207499619\">said</a>:</p>\n<blockquote>\n<ul>\n<li>entry[myPatient ].resource = Reference(TestPatient) // Fails: Cannot fix Reference value: Reference(Patient/TestPatient). Value does not match element type: Patient</li>\n</ul>\n</blockquote>\n<p>Stupid me. This line should be:</p>\n<ul>\n<li>entry[myPatient].resource = TestPatient</li>\n</ul>\n<p>Actually, what the error said <span aria-label=\"weary\" class=\"emoji emoji-1f629\" role=\"img\" title=\"weary\">:weary:</span></p>",
        "id": 207515873,
        "sender_full_name": "Torben M. Hagensen",
        "timestamp": 1597926192
    },
    {
        "content": "<p>Ha.  Yeah, it was complaining because you used a reference where a inline instance (not reference) was needed.  That said, although the error did say that, it didn't say it as clearly as it could have.  I can see how the error could be misunderstood to mean that the reference is of the wrong type (which it's not).  I'll file an issue to see if we can provide a clearer error for this type of situation.  Maybe something like:</p>",
        "id": 207555763,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1597947350
    },
    {
        "content": "<blockquote>\n<p>Cannot fix Reference value: Reference(Patient/TestPatient). References are not allowed at this path; use a value directly instead.</p>\n</blockquote>",
        "id": 207556083,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1597947494
    },
    {
        "content": "<p>Logged: <a href=\"https://github.com/FHIR/sushi/issues/575\">https://github.com/FHIR/sushi/issues/575</a></p>",
        "id": 207556596,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1597947796
    }
]