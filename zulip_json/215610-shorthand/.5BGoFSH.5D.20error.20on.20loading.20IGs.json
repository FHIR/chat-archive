[
    {
        "content": "<p>When referencing a non-snapshot IG (Simplifier) in GoFSH the following error is shown:</p>\n<div class=\"codehilite\"><pre><span></span><code>info  Downloading de.gematik.isik-basismodul#1.0.2...\nerror Failed to load de.gematik.isik-basismodul@1.0.2: Request failed with status code 404\n</code></pre></div>",
        "id": 264302623,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1639057514
    },
    {
        "content": "<p>The correct error message should point to the true reason: no snapshots found in IG</p>",
        "id": 264302904,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1639057651
    },
    {
        "content": "<p><a href=\"https://github.com/FHIR/GoFSH/issues/162\">https://github.com/FHIR/GoFSH/issues/162</a></p>",
        "id": 264305430,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1639058688
    },
    {
        "content": "<p>Actually, that is not the reason that GoFSH is failing.  It really is an issue downloading the package.  Although, in my debugging, it actually looks like an <code>HTTP 405</code> error (not <code>HTTP 404</code> as the error message suggests).  Still investigating...</p>",
        "id": 264307244,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639059454
    },
    {
        "content": "<p>It looks like something has actually changed on the package server / registry.  Since some packages live on <a href=\"http://packages.fhir.org\">packages.fhir.org</a> and some live on <a href=\"http://packages2.fhir.org\">packages2.fhir.org</a>, we first issue an HTTP HEAD request against the expected package location on <a href=\"http://packages.fhir.org\">packages.fhir.org</a>.  If that succeeds, we know to use <a href=\"http://packages.fhir.org\">packages.fhir.org</a> URL.  If it fails, then we assume we should use the <a href=\"http://packages2.fhir.org\">packages2.fhir.org</a> URL.</p>\n<p>Up until <em>very recently</em>, this approach worked well.  But it seems that since then, someone disabled HTTP HEAD requests on <a href=\"http://packages.fhir.org\">packages.fhir.org</a>:</p>\n<div class=\"codehilite\"><pre><span></span><code>$ curl --HEAD https://packages.fhir.org/de.gematik.isik-basismodul/1.0.2\nHTTP/1.1 405 Method Not Allowed\n</code></pre></div>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>, <span class=\"user-mention\" data-user-id=\"191335\">@Martijn Harthoorn</span>, <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> - do you know anything about this change?</p>",
        "id": 264308454,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639059977
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> Maybe that also relates to your issue loading the package in the Java Validator?</p>",
        "id": 264311725,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1639061399
    },
    {
        "content": "<p>CC: <span class=\"user-mention\" data-user-id=\"259036\">@Matthijs van der Wielen</span></p>",
        "id": 264311846,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1639061450
    },
    {
        "content": "<p>Interesting. I also ran into issues with the java validator which is unable to d/l packages in some configurations. Never had this issue, started some weeks ago.</p>",
        "id": 264312046,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1639061533
    },
    {
        "content": "<p>java library doesn't use head - I've never understood the logic. If the server has it, I'm going to fetch it, so why did I bother with head? The only use I've ever seen for head is if I already have a resource, and I'm checking it's currency - but over the years I've learnt that caches of various kinds love to lie to me about that.</p>",
        "id": 264351193,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639076936
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- I'm using it precisely because I don't know if the server has it or not and I'm trying to determine the right URL to use before actually invoking the download logic.  But that's a little beside the point here.  The question is, do you know anything about someone disabling HEAD on <a href=\"http://packages.fhir.org\">packages.fhir.org</a>?  Or is that a question for the Simplifier team?</p>",
        "id": 264353839,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639078145
    },
    {
        "content": "<p>AFAIK we haven't done anything with the HEAD. But I have never tested if it (ever) worked.</p>",
        "id": 264431132,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639134194
    },
    {
        "content": "<p>But the way Firely Terminal (and i think npm too) checks if a package exist, is to call the listing endpoint.</p>",
        "id": 264431169,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639134228
    },
    {
        "content": "<p>Just get the listing (json) document from ~/&lt;packagename&gt;</p>",
        "id": 264431402,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639134345
    },
    {
        "content": "<p>and see if the version is in there.</p>",
        "id": 264431418,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639134352
    },
    {
        "content": "<p>That is also the better solution, since it is needed to correctly resolve ranges and wildcard dependencies.</p>",
        "id": 264431494,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639134386
    },
    {
        "content": "<p>See the json document here:<br>\n<a href=\"https://packages.simplifier.net/hl7.fhir.us.core\">https://packages.simplifier.net/hl7.fhir.us.core</a></p>",
        "id": 264431841,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639134602
    },
    {
        "content": "<p>In Firely Terminal we have this built in:</p>\n<div class=\"codehilite\"><pre><span></span><code>&gt; fhir versions hl7.fhir.us.core\n  0.0.0\n  1.0.0\n  1.0.1\n  1.1.0\n  2.0.0\n  2.1.0\n  3.0.0\n  3.0.1\n  3.1.0\n  3.1.1\n  3.2.0\n  4.0.0\n  4.1.0\n</code></pre></div>",
        "id": 264432229,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639134852
    },
    {
        "content": "<p>Specifically for the case of installing dependencies that may contain floating versions:</p>\n<div class=\"codehilite\"><pre><span></span><code>&gt; fhir semver hl7.fhir.us.core 3.2\n0.0.0\n1.0.0\n1.0.1\n1.1.0\n2.0.0\n2.1.0\n3.0.0\n3.0.1\n3.1.0\n3.1.1\n3.2.0 &lt;---\n4.0.0\n4.1.0\n</code></pre></div>",
        "id": 264432668,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1639135153
    },
    {
        "content": "<p>Thanks, <span class=\"user-mention\" data-user-id=\"191335\">@Martijn Harthoorn</span>.  That does sound like a better way to go.  We'll work toward that, but for now, we'll put in a quick fix to get around the issue w/ HTTP HEAD.</p>",
        "id": 264446683,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639142947
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> - we released a fix for this in SUSHI 2.2.2.  Thanks for reporting it!</p>",
        "id": 264511519,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639171984
    },
    {
        "content": "<p>Thanks for fixing it!</p>",
        "id": 264625215,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1639317980
    }
]