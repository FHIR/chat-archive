[
    {
        "content": "<p>This line: * <a href=\"http://SubstanceDefinition.name.name\">SubstanceDefinition.name.name</a> 0..* MS<br>\ngets this error<br>\ninfo Converting FSH to FHIR resources...<br>\nerror No element found at path <a href=\"http://SubstanceDefinition.name.name\">SubstanceDefinition.name.name</a> for DrugSubstance, skipping rule</p>\n<p>It is odd that the error message says DrugSubstance and not SubstanceDefinition</p>",
        "id": 249000037,
        "sender_full_name": "Catherine Hosage Norman",
        "timestamp": 1628612004
    },
    {
        "content": "<p>I believe this is because <code>DrugSubstance</code> is the name of the <code>Profile</code> where this error is occurring. For example, I can recreate this with the following definition:</p>",
        "id": 249012726,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1628617962
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Profile: DrugSubstance\nParent: SubstanceDefinition\n* SubstanceDefinition.name.name 0..* MS\n</code></pre></div>",
        "id": 249012733,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1628617967
    },
    {
        "content": "<p>In this case, I think the solution would be to not include <code>SubstanceDefinition</code> in the rule. So try something like</p>\n<div class=\"codehilite\"><pre><span></span><code>name.name 0..* MS\n</code></pre></div>",
        "id": 249012788,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1628617999
    },
    {
        "content": "<p>We are hoping to use FSH and SUSHI to create a new IG with a Profile of a Resource about to be added to the CI-build version of FHIR R5.  The CI-build version of FHIR R5 does not have a numbered version, and the most recent numbered version (4.6.0 which is the R5 ballot snapshot from half a year ago) is not current enough for our IG. </p>\n<p>Is there a way to use FSH and SUSHI with the current-build R5, or is there a way to insert the Resource StructureDefinition (that we know and can isolate) so we can use FSH to develop a Profile of this Resource? <span class=\"user-mention\" data-user-id=\"192545\">@Alex Goel</span></p>",
        "id": 261661918,
        "sender_full_name": "Brian Alper",
        "timestamp": 1637078046
    },
    {
        "content": "<p>considering that the IG Publisher doesn't go against #current, I'm not sure how much support SUSHI should give to it.  Basically SUSHI only supports what the IG Publisher supports so it's up to Grahame and team to add support for #current.</p>",
        "id": 261662224,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1637078156
    },
    {
        "content": "<p>On your local computer, you can update your cached version of FHIR (<code>~/.fhir/packages</code>) and use that.  It will let you build locally, since IG Publisher looks there first. (There are more detailed instructions either on this stream or in <a class=\"stream\" data-stream-id=\"179252\" href=\"/#narrow/stream/179252-IG-creation\">#IG creation</a> - though it was probably documented against R4B instead of R5).</p>\n<p>To my knowledge, there is not a way to get the CI builds of that process working yet.</p>",
        "id": 261663823,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1637078650
    },
    {
        "content": "<p>So... SUSHI <em>does</em> support <code>fhirVersion: current</code> in the <code>sushi-config.yaml</code> -- and will download and use the latest CI build of FHIR for that.  SUSHI stores the CI build of FHIR R5 in the FHIR cache at <code>~/.fhir/packages/hl7.fhir.r5.core#current</code>.</p>\n<p><em>That said</em>, as <span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> noted above, the IG Publisher does not support building IGs against FHIR R5 current -- so even though SUSHI supports it, you won't get too far with it after that.</p>\n<p>As for ways to work around this (by including the JSON resource in the IG, etc.) -- I'm not sure, but it may be possible.  I'll do a little testing with it.</p>",
        "id": 261668736,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1637080662
    },
    {
        "content": "<p>To clarify; if you do the process Chris describes, you will have the <code>hl7.fhir.r5.core#current</code> directory in your cache.  If you rename that to <code>hl7.fhir.r5.core#4.6.0</code> (and do the same for <code>hl7.fhir.r5.expansions#current</code> with <code>hl7.fhir.r5.expansions#4.6.0</code>), you can then build against <code>4.6.0</code>, which works in both sushi and IG Publisher.</p>\n<p>Again note that this only works locally since you are manually replacing the files (e.g., the CI build of your IG will fail).  I have been taking the output folder and posting the contents in a <code>github.io</code> repo to make them publicly available.</p>",
        "id": 261669958,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1637081154
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192085\">@Brian Alper</span> -- I gave your idea a shot and had some surprising luck with it.  Here's what I did:</p>\n<ol>\n<li>Set <code>fhirVersion: 4.6.0</code> in <code>sushi-config.yaml</code> (since it is the most recent FHIR R5 the IG Publisher supports)</li>\n<li>Added <a href=\"http://build.fhir.org/devicedispense.profile.json\">StructureDefinition-DeviceDispense.json</a> to <code>input/resources</code> in my IG project (an example of a resource in current build but not 4.6.0)</li>\n<li>Added the following in <code>sushi-config.yaml</code> to tell SUSHI <em>not</em> to include DeviceDispense in the ImplementationGuide JSON</li>\n</ol>\n<div class=\"codehilite\"><pre><span></span><code>resources:\n  StructureDefinition/DeviceDispense: omit\n</code></pre></div>\n<ol start=\"4\">\n<li>Created a FSH profile w/ <code>Parent: DeviceDispense</code></li>\n</ol>\n<p>The above worked fine in SUSHI, and more surprisingly, seemed to work in the IG Publisher.  There were some errors in the QA, but the IG Publisher did not crash and produced a fairly useful IG w/ my profile in it.  I'd still label this as \"very experimental\", but it may get you what you need for now.</p>",
        "id": 261670996,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1637081593
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192545\">@Alex Goel</span> <span class=\"user-mention\" data-user-id=\"191359\">@Bryn Rhodes</span> <span class=\"user-mention\" data-user-id=\"220253\">@Khalid Shahin</span> <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> Thanks, Chris. Perhaps we can create an EBMonFHIR IG with a Recommendation Profile (of ArtifactAssessment Resource about to be added to FHIR current build) and see it work in the IG Publisher.  If we keep the test limited this will essentially involve 1 Profile, 2 value sets, 1 code system (if the value sets can be subsets of values from the code system), and 1 IG.</p>",
        "id": 261673937,
        "sender_full_name": "Brian Alper",
        "timestamp": 1637082673
    },
    {
        "content": "<p>I need a word of advise here. Whats the latest stable version (R5-wise) that works across fsh and the IG builder using the CI/CD chain? What version should I state in the sushi-config?</p>",
        "id": 264692484,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639394518
    },
    {
        "content": "<p>Currently using <code>4.6.0</code> does not seem to work. The CI/CD on (<a href=\"https://github.com/hl7-eu/gravitate-health/tree/fixing\">https://github.com/hl7-eu/gravitate-health/tree/fixing</a>) is not happy about the current situation (<a href=\"https://build.fhir.org/ig/hl7-eu/gravitate-health/branches/fixing/failure/build.log\">https://build.fhir.org/ig/hl7-eu/gravitate-health/branches/fixing/failure/build.log</a>)</p>",
        "id": 264692706,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639394649
    },
    {
        "content": "<p>It looks like sushi does not care whether eg. the instance properties are arrays or not. As can be see on <a href=\"https://build.fhir.org/ig/hl7-eu/gravitate-health/branches/fixing/failure/fsh-generated/resources/RegulatedAuthorization-cfsb1639234802176.json\">https://build.fhir.org/ig/hl7-eu/gravitate-health/branches/fixing/failure/fsh-generated/resources/RegulatedAuthorization-cfsb1639234802176.json</a> - where the fsh-generated files gives you a single property, the IG expects an array as can be see on <a href=\"http://build.fhir.org/regulatedauthorization.html\">http://build.fhir.org/regulatedauthorization.html</a> - <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> any advise is highly appreciated</p>",
        "id": 264710421,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639404560
    },
    {
        "content": "<p>(<span class=\"user-mention\" data-user-id=\"408801\">@Craig Anderson</span> )</p>",
        "id": 264713941,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639406010
    },
    {
        "content": "<p>SUSHI does care whether instances are arrays or not -- and outputs them accordingly.  You identified your FHIR version as 4.6.0.  SUSHI used the official 4.6.0 (May 2021 ballot) release , in which <a href=\"http://hl7.org/fhir/2021May/regulatedauthorization-definitions.html#RegulatedAuthorization.subject\">RegulatedAuthorization.subject is 0..1</a>.  The IG Publisher, however, appears to be using the current build (including changes <em>since</em> the 4.6.0 release), in which <a href=\"http://build.fhir.org/regulatedauthorization-definitions.html#RegulatedAuthorization.subject\">RegulatedAuthorization.subject is 0..*</a>.</p>\n<p>In my opinion, SUSHI is doing the right thing here by using the actual 4.6.0 release that is available in the package registry.  But I am biased.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- does the IG Publisher intentionally use current build when the IG calls for 4.6.0?</p>",
        "id": 264715343,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639406572
    },
    {
        "content": "<p>running against R5 current is not supported at this time. And in practice, running against the 4.6.0 isn't either. It's on my list of things to do once I publish the next milestone of R5 in the next week</p>",
        "id": 264749996,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639420163
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> you're right - it does indeed care  - wrong wording from my side.</p>",
        "id": 264753208,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639421746
    },
    {
        "content": "<p>So if 4.6.0 is the May Release - then what does the IG publisher think <code>4.6.0</code> is - because it seems like the IG publisher thinks it is something different. <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I'm not targeting <code>current</code> then I assume. I target <code>4.6.0</code>. Ain't that supported by the publisher?</p>",
        "id": 264753435,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639421854
    },
    {
        "content": "<p>I'm confused here <span aria-label=\"oh no\" class=\"emoji emoji-1f615\" role=\"img\" title=\"oh no\">:oh_no:</span></p>",
        "id": 264753566,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639421919
    },
    {
        "content": "<p>OK - I guess I'll have to wait for next week then.</p>",
        "id": 264754992,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639422524
    },
    {
        "content": "<p>I'm afraid so</p>",
        "id": 264755208,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639422643
    },
    {
        "content": "<p>So its gonna be christmas after all :D</p>",
        "id": 264761205,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639425481
    },
    {
        "content": "<p>FYI - our connectathon track sort of heavily depends on it</p>",
        "id": 264761294,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639425509
    },
    {
        "content": "<p>so, no pressure...</p>",
        "id": 264761483,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639425580
    },
    {
        "content": "<p>You said it ... <span aria-label=\"rolling on the floor laughing\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rolling on the floor laughing\">:rolling_on_the_floor_laughing:</span></p>",
        "id": 264761581,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639425607
    },
    {
        "content": "<div class=\"message_inline_image\"><a href=\"https://c.tenor.com/cA_nqTZf1qEAAAAd/under-pressure-david-bowie.gif\"><img src=\"https://uploads.zulipusercontent.net/e221b4df473565abbd31e30c6ec1a3f2b585faee/68747470733a2f2f632e74656e6f722e636f6d2f63415f6e71545a6631714541414141642f756e6465722d70726573737572652d64617669642d626f7769652e676966\"></a></div>",
        "id": 264761748,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639425664
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span>, does this mean the FSH ePI content is compliant? Or do we have to wait until Grahame finishes his component to confirm?</p>",
        "id": 264767252,
        "sender_full_name": "Craig Anderson",
        "timestamp": 1639428196
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"408801\">@Craig Anderson</span>  Easiest is to wait</p>",
        "id": 264767446,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639428294
    },
    {
        "content": "<p>So... this is super hacky, but I'll throw it out there.  Here is the current situation:</p>\n<ul>\n<li><strong>fhirVersion: 4.6.0</strong>:<ul>\n<li>SUSHI: Uses the 4.6.0 package from the registry (May 2021 R5 ballot)</li>\n<li>IG Publisher: I think it uses the current R5 build (and it sort of works?)</li>\n</ul>\n</li>\n<li><strong>fhirVersion: current</strong>:<ul>\n<li>SUSHI: Uses the current R5 build</li>\n<li>IG Publisher: Does not work</li>\n</ul>\n</li>\n</ul>\n<p>Based on this, if you actually <em>want</em> <code>current</code>, I think you could set <code>fhirVersion: current</code> in sushi-config.yaml and run SUSHI that way.  THEN modify the ImplementationGuide JSON file in fsh-generated to change <code>fhirVersion</code> to <code>[ \"4.6.0\" ]</code> -- since IG Publisher currently treats that like current.  Then run IG Publisher with the <code>-no-sushi</code> flag (so it doesn't re-run SUSHI and overwrite your modifications in fsh-generated).</p>\n<p>Again, it's a hack.  So use at your own peril!</p>",
        "id": 264770200,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639429742
    },
    {
        "content": "<p>(And it will / should break whenever Grahame addresses this in IG Publisher).</p>",
        "id": 264770376,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639429814
    },
    {
        "content": "<p>Naaa .... doing <code>sushi . ; sed -i '' -e 's/current/4.6.0/g' fsh-generated/resources/ImplementationGuide-hl7.eu.fhir.gh.json &amp;&amp; ./_genonce.sh -no-sushi </code> didn't do it <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span></p>",
        "id": 264781517,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639435328
    },
    {
        "content": "<p>Dang.  Sorry.  I thought that might work.  I guess you'll just have to wait. :-/</p>",
        "id": 264787985,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639439578
    },
    {
        "content": "<p>np - I'm waiting ...</p>",
        "id": 264788034,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639439624
    },
    {
        "content": "<p>It was worth a shot</p>",
        "id": 264788050,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639439632
    },
    {
        "content": "<p>I just tried it as well.  I'm not sure where you stopped, but when I did it, the real problem was when I changed <code>fhirVersion</code> to <code>current</code> in the SUSHI project.  After that, SUSHI reported 151 errors because so many other things have changed since the 4.6.0 R5 ballot release.  To fully test out my hack, I'd need to go in and fix all those 151 errors in the FSH to align w/ the changes in FHIR R5 current.</p>",
        "id": 264790840,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639441791
    },
    {
        "content": "<p>Things like:</p>\n<blockquote>\n<p>error Cannot assign Reference value: Reference(Organization/cfsb1639015344307). Value does not match element type: BackboneElement</p>\n</blockquote>\n<p>because <code>Ingredient.manufacturer</code> changed from a Reference in 4.6.0 to a BackboneElement in current build.</p>",
        "id": 264791143,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639442009
    },
    {
        "content": "<p>Maybe it was a bit late when I gave up .... <span aria-label=\"sleeping\" class=\"emoji emoji-1f634\" role=\"img\" title=\"sleeping\">:sleeping:</span></p>",
        "id": 264877034,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639496781
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> you're right. Flipping the version to current certainly triggered something. <span class=\"user-mention\" data-user-id=\"408801\">@Craig Anderson</span> are you able to run sushi locally?</p>",
        "id": 265065343,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639597838
    },
    {
        "content": "<p>Yeah, and that's expected.  There are a lot of differences between the May 2021 4.6.0 ballot build and current.  The question is, which one are you trying to target?  The 4.6.0 ballot package or latest build (current)?  If the latter, then I guess you probably want <code>version: current</code> and will just need to work through all the issues related to changes in the resources.</p>",
        "id": 265076995,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639603481
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> tried but no. Couldn’t get Sushi working.</p>",
        "id": 265104935,
        "sender_full_name": "Craig Anderson",
        "timestamp": 1639621598
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 265116761,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639635995
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/215610-shorthand/topic/R5.20support/near/264749996\">said</a>:</p>\n<blockquote>\n<p>running against R5 current is not supported at this time. And in practice, running against the 4.6.0 isn't either. It's on my list of things to do once I publish the next milestone of R5 in the next week</p>\n</blockquote>\n<p>So crossing fingers and everything else here and just to be clear: The thing on your todo list is to provide support for 4.6.0 (<a href=\"http://hl7.org/fhir/2021May/\">http://hl7.org/fhir/2021May/</a>) in the upcoming week in the IG publisher. Correct?</p>",
        "id": 265144281,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639655461
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> does clinFHIR use the 4.6.0 package (<a href=\"http://hl7.org/fhir/2021May/\">http://hl7.org/fhir/2021May/</a>) as well for the FSH parts?</p>",
        "id": 265149125,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1639658328
    },
    {
        "content": "<p>yep. When you create a project in GraphBuilder you can select the FHIR version - if you select R5 draft that uses 4.6.0 for the resources (I should make that more explicit). The magic of sushi (actually the API) does the rest!</p>",
        "id": 265188389,
        "sender_full_name": "David Hay",
        "timestamp": 1639675261
    },
    {
        "content": "<p>And in the main UI, at the top left is a link to the spec. In this case, the May2021 version will be shown...</p>",
        "id": 265188809,
        "sender_full_name": "David Hay",
        "timestamp": 1639675455
    },
    {
        "content": "<p>I've only just enabled it, so there may well be issues - ping me if you find any...</p>",
        "id": 265188913,
        "sender_full_name": "David Hay",
        "timestamp": 1639675510
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> do you have an ETA?</p>",
        "id": 265593395,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640021655
    },
    {
        "content": "<p>It's not <code>current</code>, but I think Grahame just released version <code>5.0.0-snapshot1</code> based on recent sources.  Might that contain what you need?  If so, just specify <code>fhirVersion: 5.0.0-snapshot1</code> in your sushi-config.yaml file.</p>",
        "id": 265609072,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640030251
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> so sushi-wise that would be 4.6.0 and IGPub-wise it would be 5.0.0-snapshot1 ?</p>",
        "id": 265665881,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640080028
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> -- you should be able to use <code>5.0.0-snapshot1</code> seamlessly across SUSHI and IG Publisher.</p>",
        "id": 265689166,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640096022
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191469\">Chris Moesel</span> <a href=\"#narrow/stream/215610-shorthand/topic/R5.20support/near/265689166\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191427\">Jens Villadsen</span> -- you should be able to use <code>5.0.0-snapshot1</code> seamlessly across SUSHI and IG Publisher.</p>\n</blockquote>\n<p>Really?<br>\n<code>Sushi: error The sushi-config.yaml must specify a supported version of FHIR. Be sure to add \"fhirVersion: 4.0.1\" (or 4.x.y, as appropriate) to the sushi-config.yaml file. (00:01.0790)</code></p>",
        "id": 265701851,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640102552
    },
    {
        "content": "<p>Thats what sushi tells me when I insert <code>5.0.0-snapshot1</code> as version using fsh-sushi v2.2.3 <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span></p>",
        "id": 265702720,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640102949
    },
    {
        "content": "<p>Same goes for fsh-sushi v2.2.4 <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span></p>",
        "id": 265724007,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1640114278
    },
    {
        "content": "<p>Oh.  Well... dang.  I guess I should have tested it first.  I tested 4.3.0-snapshot1 and just assumed that if that worked, so would 5.0.0-snapshot1.  I'm sorry for the confusion.  We'll try to get a fix in for it.</p>",
        "id": 265726887,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640115999
    },
    {
        "content": "<p><a href=\"https://github.com/FHIR/sushi/issues/994\">SUSHI#994</a></p>",
        "id": 265735563,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640121661
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> - This is fixed in the newly released SUSHI 2.2.5.  See my release announcement for details.</p>",
        "id": 265852358,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640206866
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191427\">Jens Villadsen</span> <a href=\"#narrow/stream/215610-shorthand/topic/R5.20support/near/265149125\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191321\">David Hay</span> does clinFHIR use the 4.6.0 package (<a href=\"http://hl7.org/fhir/2021May/\">http://hl7.org/fhir/2021May/</a>) as well for the FSH parts?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> , can you update ClinFHIR to accept the FHIR R5.0.0-snapshot1? <a href=\"http://hl7.org/fhir/5.0.0-snapshot1/\">http://hl7.org/fhir/5.0.0-snapshot1/</a></p>\n<p>Jens was able to update the build workflow updated to hl7.fhir.r5.core#5.0.0-snapshot1 but ClinFHIR is still on 4.6.0. There are a few changes in the resources between the two versions.</p>",
        "id": 265951953,
        "sender_full_name": "Craig Anderson",
        "timestamp": 1640292340
    },
    {
        "content": "<p>Yeah I saw that sushi supports that version - will do so, but probably not until next week...</p>",
        "id": 265953732,
        "sender_full_name": "David Hay",
        "timestamp": 1640293828
    },
    {
        "content": "<p>Any known issues with the API? I get error: TypeError: Cannot read property 'startsWith' of undefined on line 168 of processing.js when I pass in an id of 5.0.0-snapshot1</p>",
        "id": 266016805,
        "sender_full_name": "David Hay",
        "timestamp": 1640369817
    },
    {
        "content": "<p>(I haven't yet tried using sushi directly yet so may be my setup - need to go and participate in Christmas morning!).  And a merry christmas to you all....  :)</p>",
        "id": 266016838,
        "sender_full_name": "David Hay",
        "timestamp": 1640369880
    },
    {
        "content": "<p>So it works fine when run from vscode - just not through the API...</p>",
        "id": 266069484,
        "sender_full_name": "David Hay",
        "timestamp": 1640455716
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191321\">@David Hay</span> What version are you running? That error should no longer occur starting with version 2.2.5, so if it is, something unusual is happening.</p>",
        "id": 266175169,
        "sender_full_name": "Mint Thompson",
        "timestamp": 1640614301
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"242620\">@Mint Thompson</span>  -  version 2.2.5   The following function (in processing) would seem to limit to the 4.x series...</p>\n<p>function isSupportedFHIRVersion(version) {<br>\n    // For now, allow current or any 4.x version of FHIR except 4.0.0. This is a quick check; not a guarantee.  If a user passes<br>\n    // in an invalid version that passes this test (e.g., 4.99.0), it is still expected to fail when we load dependencies.<br>\n    //return true<br>\n    return /current|4\\.0\\.1|4\\.[1-9]\\d*.\\d+/.test(version);<br>\n}</p>",
        "id": 266188494,
        "sender_full_name": "David Hay",
        "timestamp": 1640625204
    },
    {
        "content": "<p>Hmm, that function had its definition changed in SUSHI 2.2.5 (<a href=\"https://github.com/FHIR/sushi/blob/v2.2.5/src/utils/Processing.ts#L28-L32\">https://github.com/FHIR/sushi/blob/v2.2.5/src/utils/Processing.ts#L28-L32</a>), so if you're still seeing that definition of isSupportedFHIRVersion, there may be something out of alignment in your SUSHI installation.</p>",
        "id": 266194237,
        "sender_full_name": "Mint Thompson",
        "timestamp": 1640629700
    },
    {
        "content": "<p>hmm. here's the response to sushi -v :SUSHI v2.2.5 (implements FHIR Shorthand specification v1.2.0)</p>\n<p>I'll try another install and see where I get to. At least I'll know what to look for!</p>",
        "id": 266197678,
        "sender_full_name": "David Hay",
        "timestamp": 1640632856
    },
    {
        "content": "<p>Yep - I had forgotten that I was using a local install of sushi. All good now. Thanks!</p>",
        "id": 266199662,
        "sender_full_name": "David Hay",
        "timestamp": 1640634347
    },
    {
        "content": "<p>I'm getting a <code>error Failed to load hl7.fhir.r5.core#5.0.0-snapshot1: The package hl7.fhir.r5.core#5.0.0-snapshot1 could not be loaded locally or from the FHIR package registry.</code> - is that a general issue <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span></p>",
        "id": 266675315,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641208723
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> -- it wasn't an issue when I left for holiday break.  I'm just returning today, so I'll have to look if something changed since then.  But when we released SUSHI 2.2.5, that was working.</p>",
        "id": 266685608,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641216571
    },
    {
        "content": "<p>See also <a href=\"http://build.fhir.org/ig/hl7-eu/gravitate-health/branches/master/failure/build.log\">http://build.fhir.org/ig/hl7-eu/gravitate-health/branches/master/failure/build.log</a></p>",
        "id": 266686408,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641217127
    },
    {
        "content": "<p>don't know if is related, i get also now error messages for hl7.fhir.r4.core#4.0.1 and our swiss packages with sushi, see: <a href=\"http://build.fhir.org/ig/ahdis/ch-rad-poc/branches/master/failure/build.log\">http://build.fhir.org/ig/ahdis/ch-rad-poc/branches/master/failure/build.log</a></p>",
        "id": 266690604,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1641219673
    },
    {
        "content": "<p>Wow...  I will definitely look into this as soon as I get through my mountain of emails.  The logs make it seem like something has changed on the package servers -- and things aren't where we expect them to be anymore.  That doesn't seem good.</p>",
        "id": 266691867,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641220259
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span>  Its probably due to expired certificate. See -&gt; <a href=\"#narrow/stream/179252-IG-creation/topic/build.2Efhir.2Eorg.20broken\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/build.2Efhir.2Eorg.20broken</a></p>",
        "id": 266696682,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641222730
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191427\">@Jens Villadsen</span> - yes, that is definitely it!  Hopefully someone can fix that certificate.  I'm in a meeting now, but when I get out, I can also post a temporary workaround to disable certificate validation locally.</p>",
        "id": 266698054,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641223556
    },
    {
        "content": "<p>If you are developing locally and STUCK due to the expired certificate, there is a workaround to TURN OFF certificate validation.  This is generally a bad idea, because certificate validation is there to protect you from untrusted sources and intercepted communications.  BUT... if you really need to move forward, do all of this from the same terminal window:</p>\n<ol>\n<li>Ensure you have already installed the latest SUSHI (<code>sushi -v</code>) should report version 2.2.5.  If not, install it (<code>npm install -g fsh-sushi</code>).</li>\n<li>Set the NODE_TLS_REJECT_UNAUTHORIZED environment variable to 0. You may need to \"export\" it so SUSHI can see it.  On Mac, you usually use this command: <code>export NODE_TLS_REJECT_UNAUTHORIZED=0</code></li>\n<li>Run SUSHI once on your project so it downloads the packages to your local cache.</li>\n<li>Remove the NODE_TLS_REJECT_UNAUTHORIZED environment variable or set its value to 1.  On Mac, you usually use this command: <code>unset NODE_TLS_REJECT_UNAUTHORIZED</code> or you can use <code>export NODE_TLS_REJECT_UNAUTHORIZED=1</code></li>\n<li>Confirm that NODE_TLS_REJECT_UNAUTHORIZED is not set anymore or is set to 1.  On Mac, you usually use this command: <code>echo $NODE_TLS_REJECT_UNAUTHORIZED</code> and expect either a blank result (if you unset it) or 1 (if you set it to 1).</li>\n</ol>\n<p>The steps above minimize your risk by only removing certificate validation temporarily to download the FHIR packages the initial time.</p>",
        "id": 266722279,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641235719
    },
    {
        "content": "<p>I don't know how to do this in Windows, otherwise I'd tell you (sorry).  But the basic intent of the steps should be the same.</p>\n<p>Also note that the FHIR auto build server will still fail.  I expect that <span class=\"user-mention\" data-user-id=\"191315\">@Josh Mandel</span> does not want to turn off certificate validation on the build server -- so you'll probably need to wait until <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> renews the certificate.</p>",
        "id": 266722414,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641235797
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> thx - works like a charm!</p>",
        "id": 266731271,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641240528
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193599\">@Lynn Laakso</span> ehmm ... so could this sort of thing be a priority for HQ - having CI/CD pipeline that works?</p>",
        "id": 266787316,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641289323
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 266813080,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641306219
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 266813968,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1641306678
    },
    {
        "content": "<p>Grahame has not posted on Zulip since December 27, so he appears to be out.  Do we know when he will be back?  Is there no one else who can renew that expired SSL certificate?</p>",
        "id": 266815174,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641307266
    },
    {
        "content": "<p>Sadly, no one else at HQ has administration privileges for <a href=\"http://fhir.org\">fhir.org</a>.</p>",
        "id": 266815597,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1641307460
    },
    {
        "content": "<p>HL7 has to plan for \"business continuity without Grahame and Lloyd\".</p>",
        "id": 266815735,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1641307535
    },
    {
        "content": "<p>Yep - we as a community are highly dependent on the tooling and the infrastructure around it</p>",
        "id": 266822360,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641310654
    },
    {
        "content": "<p>I have no argument for that. I will send a note to HQ about how to address this with the new CSDO and CSIO</p>",
        "id": 266823719,
        "sender_full_name": "Lynn Laakso",
        "timestamp": 1641311324
    },
    {
        "content": "<p>Feel free to mention that it should be their top priority, IMHO. Dont get me wrong - I love their work and their contributions but the two-men army doesnt scale</p>",
        "id": 266826500,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641312565
    },
    {
        "content": "<p>I did have a couple of days off. I expected to get hammered for it, but this issue is a surprise....</p>",
        "id": 266862182,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641329813
    },
    {
        "content": "<p>Thanks you!!</p>",
        "id": 266959792,
        "sender_full_name": "Jakob Abada",
        "timestamp": 1641401615
    },
    {
        "content": "<p>should be all fixed now</p>",
        "id": 267002430,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641422606
    },
    {
        "content": "<p>wonderful</p>",
        "id": 267002882,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641422864
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> pipeline does not agree entirely with you: <a href=\"#narrow/stream/179297-committers.2Fnotification/topic/ig-build\">https://chat.fhir.org/#narrow/stream/179297-committers.2Fnotification/topic/ig-build</a></p>",
        "id": 267003372,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641423153
    },
    {
        "content": "<p>same goes for curl:</p>\n<div class=\"codehilite\"><pre><span></span><code>curl https://packages.fhir.org/catalog\ncurl: (60) SSL certificate problem: certificate has expired\nMore details here: https://curl.haxx.se/docs/sslcerts.html\n</code></pre></div>",
        "id": 267003635,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641423329
    },
    {
        "content": "<p>indeed. I can't update the certificate on that server. I've asked firely about it</p>",
        "id": 267005089,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641424229
    },
    {
        "content": "<p>as in <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> ?</p>",
        "id": 267005579,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641424517
    },
    {
        "content": "<p>y</p>",
        "id": 267005928,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641424718
    },
    {
        "content": "<p>Oh my - and here all along I thought that was only something you could fix <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> - that then gives you time to look at all the other things I've burdened you with <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 267006281,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641424963
    },
    {
        "content": "<p>Is it a different certificate?  Or just a matter of applying the already-acquired new certificate to that particular server?</p>",
        "id": 267007011,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641425469
    },
    {
        "content": "<p>Looks like a wildcard certificate to me so it should be fine:<br>\n<a href=\"/user_uploads/10155/vn4s44R2oMXkgNG9lclHxErw/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/vn4s44R2oMXkgNG9lclHxErw/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/vn4s44R2oMXkgNG9lclHxErw/image.png\"></a></div>",
        "id": 267007572,
        "sender_full_name": "Jens Villadsen",
        "timestamp": 1641425857
    },
    {
        "content": "<p>yes it's just a matter of applying the certificate to the server.</p>",
        "id": 267007844,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641426068
    },
    {
        "content": "<p>well, and me giving them the private key</p>",
        "id": 267007869,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641426090
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Can you share the necessary documents with me? I'll get them to the right people</p>",
        "id": 267041108,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1641461875
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I don't think I've received anything yet, right?</p>",
        "id": 267443470,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1641823996
    },
    {
        "content": "<p>If we can get this fixed soon, that would be great.  The only reason SUSHI is working at all right now is because when things fail on <code>packages.fhir.org</code>, it falls back to <code>packages2.fhir.org</code>, which apparently has the new cert already and also seems to host most of the same packages as <code>packages.fhir.org</code>.  But this is not the ideal workflow, and I'm hoping that the packages on <code>packages2.fhir.org</code> are <em>the same</em> as the packages on <code>packages.fhir.org</code>.</p>",
        "id": 267447251,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641825961
    },
    {
        "content": "<p>Received the certificate from Grahame yesterday. Should now be resolved <span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span></p>",
        "id": 267563668,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1641897731
    },
    {
        "content": "<p><span aria-label=\"party ball\" class=\"emoji emoji-1f38a\" role=\"img\" title=\"party ball\">:party_ball:</span></p>",
        "id": 267564254,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1641898088
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191447\">Mark Kramer</span> <a href=\"#narrow/stream/215610-shorthand/topic/R5.20support/near/266815735\">said</a>:</p>\n<blockquote>\n<p>HL7 has to plan for \"business continuity without Grahame and Lloyd\".</p>\n</blockquote>\n<p>\"bus factor\" = 2. <br>\n<a href=\"https://en.wikipedia.org/wiki/Bus_factor\">https://en.wikipedia.org/wiki/Bus_factor</a></p>",
        "id": 268008812,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1642164546
    }
]