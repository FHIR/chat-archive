[
    {
        "content": "<p>I have a profile in which I set the Observation.code to a LOINC code (patternCodeableConcept by default).  Code snippet...</p>\n<div class=\"codehilite\"><pre><span></span><code>Profile: BodyMassIndex\nParent: BMI\n...\n* code = LNC#39156-5\n</code></pre></div>\n<p>I have an example of this profile that gives instance data for it.....</p>\n<div class=\"codehilite\"><pre><span></span><code>Instance: bmi-example\nInstanceOf: BodyMassIndex\nDescription: &quot;Body Mass Index example&quot;\n...\n* code = LNC#39156-5 &quot;Body mass index (BMI) [Ratio]&quot;\n</code></pre></div>\n<p>Sushi then generates the example with both codes in it.</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;code&quot;: {\n    &quot;coding&quot;: [\n      {\n        &quot;code&quot;: &quot;39156-5&quot;,\n        &quot;system&quot;: &quot;http://loinc.org&quot;,\n        &quot;display&quot;: &quot;Body mass index (BMI) [Ratio]&quot;\n      },\n      {\n        &quot;system&quot;: &quot;http://loinc.org&quot;,\n        &quot;code&quot;: &quot;39156-5&quot;\n      }\n    ]\n  },\n</code></pre></div>\n<p>I appropriately get an error when running the publisher that there are too many Observation.code instances.  What am I doing wrong?</p>",
        "id": 268613764,
        "sender_full_name": "Nathan Davis",
        "timestamp": 1642631789
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191411\">@Nathan Davis</span>. I think you stumbled upon a recently discovered bug in SUSHI (see <a href=\"https://github.com/FHIR/sushi/issues/1008\">SUSHI#1008</a>).  Basically, in some cases, if a profile fixes a value to an element, but the parent profile has also already fixed the same values, then SUSHI will output both values in instances of the child profile.  Now, ideally SUSHI should handle this, but currently it does not.</p>\n<p>The best way to avoid this bug is by not re-specifying fixed values for elements that are already properly fixed to a value.  In your case, you're setting <code>code</code> to the LOINC code for BMI, but this is probably not necessary, because I think your parent profile (<code>BMI</code>) has already done that.  So... if you remove the line that fixes <code>code</code> to <code>LNC#39156-5</code>, then this problem goes away (and your profile still requires it - but it just inherits it from the parent instead).  If that is an acceptable solution, then I recommend it.</p>",
        "id": 268617748,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1642633835
    }
]