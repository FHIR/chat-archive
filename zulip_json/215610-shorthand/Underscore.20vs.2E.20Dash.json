[
    {
        "content": "<p>It seems that you can use an underscore character (<code>_</code>) in logical model element names, SUSHI converts these to dashes/hyphens (<code>-</code>) if you try to profile the logical model reference the element. Is this intentional?</p>",
        "id": 260333077,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1636059235
    },
    {
        "content": "<p>I'm having trouble imagining exactly what you're describing, could you give an example?</p>",
        "id": 260333730,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1636059531
    },
    {
        "content": "<p>I'm defining a logical model (<code>Logical</code>) in FSH. One of the elements looks like this:</p>\n<div class=\"codehilite\" data-code-language=\"Fish\"><pre><span></span><code>* _source 1..1 code <span class=\"s2\">\"A value representing the source of the data captured within this record\"</span>\n</code></pre></div>\n<p>When I run SUSHI, this shows up correctly in the corresponding StructureDefinition:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>      <span class=\"p\">{</span>\n        <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"my-logical-model._source\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"path\"</span><span class=\"p\">:</span> <span class=\"s2\">\"my-logical-model._source\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"short\"</span><span class=\"p\">:</span> <span class=\"s2\">\"A value representing the source of the data captured within this record\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"definition\"</span><span class=\"p\">:</span> <span class=\"s2\">\"A value representing the source of the data captured within this record\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"min\"</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"max\"</span><span class=\"p\">:</span> <span class=\"s2\">\"1\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"type\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">\"code\"</span><span class=\"p\">:</span> <span class=\"s2\">\"code\"</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n      <span class=\"p\">},</span>\n</code></pre></div>\n<p>However, when I profile the logical model:</p>\n<div class=\"codehilite\" data-code-language=\"Fish\"><pre><span></span><code>* _source MS\n</code></pre></div>\n<p>The corresponding StructureDefinition changes the <code>_</code> to a <code>-</code>:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>      <span class=\"p\">{</span>\n        <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"my-logical-model.-source\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"path\"</span><span class=\"p\">:</span> <span class=\"s2\">\"my-logical-model.-source\"</span><span class=\"p\">,</span>\n        <span class=\"nt\">\"mustSupport\"</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">},</span>\n</code></pre></div>\n<p>This causes all sorts of weirdness when rendering an IG, as it looks like the element isn't defined in the parent.</p>",
        "id": 260356218,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1636075198
    },
    {
        "content": "<p>Underscores are not allowed in ids. <a href=\"https://www.hl7.org/fhir/datatypes.html#id\">https://www.hl7.org/fhir/datatypes.html#id</a></p>",
        "id": 260398211,
        "sender_full_name": "Stephen MacVicar",
        "timestamp": 1636115281
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"225612\">@Stephen MacVicar</span> - I think SUSHI should throw a warning about this rather than silently changing the character. I'll add an issue in GitHub.</p>",
        "id": 260402932,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1636117997
    },
    {
        "content": "<p>I ran into the underscore problem with some of the DaVinci profiles; hopefully they have been fixed to not use underscores.</p>",
        "id": 260433757,
        "sender_full_name": "John Silva",
        "timestamp": 1636131642
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"251487\">@Matt Rouhana</span> -- I agree.  SUSHI needs to warn in these cases.  It's also inconsistent that SUSHI actually <em>allows</em> the underscore in the logical definition but transforms it in the profile.  I was about to log an issue for this, but see that you already did (<a href=\"https://github.com/FHIR/sushi/issues/950\">SUSHI#950</a>)!  Thanks!</p>",
        "id": 260800225,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1636466201
    },
    {
        "content": "<p>I've done some investigation on this issue, and here's what I can report:</p>\n<ul>\n<li>This behavior does not appear to occur in recent versions of SUSHI. FSH Online is currently using SUSHI v2.2.1. The example used to demonstrate this is <a href=\"https://fshschool.org/FSHOnline/#/share/3IRjku7\">https://fshschool.org/FSHOnline/#/share/3IRjku7</a></li>\n<li>Underscores are not allowed in elements of type <code>id</code>, but <code>ElementDefinition.id</code>, which is inherited from <code>Element</code>, is <code>string</code> type, and there are no listed restrictions on <code>_</code> in <code>Element.id</code>.</li>\n<li><code>ElementDefinition.path</code> contains the name of the element. <code>_</code> is not in the list of prohibited characters for <code>ElementDefinition.path</code>: <a href=\"https://hl7.org/fhir/elementdefinition.html#path\">https://hl7.org/fhir/elementdefinition.html#path</a><br>\nTherefore, the behavior as of SUSHI v2.2.1 seems to be in compliance with the specifications, and since <code>_</code> are no longer being changed to <code>-</code>,  there is no longer an inconsistency in the <code>id</code> and <code>path</code>. Please let me know if there is some additional detail about this scenario that I have not considered. Otherwise, I think that there is nothing that needs to change in SUSHI.</li>\n</ul>",
        "id": 264889918,
        "sender_full_name": "Mint Thompson",
        "timestamp": 1639501491
    }
]