[
    {
        "content": "<p>I've a new errors in the FHIR for FAIR IG  moving from FHIR 4b to FHIR 4b snapshot 1. </p>\n<p>The problem seems to be related to the fact that in one of the extension defined </p>\n<ul>\n<li>value[x] only Reference(Resource)<br>\nis now converted into a <em>CodeableReference</em> instead of a <em>Reference</em>.</li>\n</ul>\n<p>Is there a way to force the element to be a Reference ?</p>",
        "id": 274743533,
        "sender_full_name": "Giorgio Cangioli",
        "timestamp": 1646855853
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191415\">@Giorgio Cangioli</span>.  Wow.  I thought maybe I misunderstood what you were saying, but I just tried this in an R4B Snapshot1 project myself with simple extension:</p>\n<div class=\"codehilite\"><pre><span></span><code>Extension: MyExtension\n* value[x] only Reference(Resource)\n</code></pre></div>\n<p>and see this in the resulting SD JSON:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Extension.value[x]\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"path\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Extension.value[x]\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"nt\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"CodeableReference\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"nt\">\"targetProfile\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/Resource\"</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>Yikes!  That is surprising.  I have no idea why that would happen, but we'll definitely look into it!</p>",
        "id": 274747067,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1646857354
    },
    {
        "content": "<p>Luckily, there is a harmless workaround if you just need this to work now.  It is to first restrict the type to a <code>Reference</code> and then to a <code>Reference(Resource)</code>.  E.g., this works as expected:</p>\n<div class=\"codehilite\"><pre><span></span><code>Extension: MyExtension\n* value[x] only Reference\n* value[x] only Reference(Resource)\n</code></pre></div>\n<p>resulting in:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Extension.value[x]\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"path\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Extension.value[x]\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"nt\">\"code\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Reference\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"nt\">\"targetProfile\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/Resource\"</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 274747612,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1646857589
    },
    {
        "content": "<p><a href=\"https://github.com/FHIR/sushi/issues/1044\">SUSHI#1044</a></p>",
        "id": 274748287,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1646857937
    },
    {
        "content": "<p>Thank you so much <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span>  :-)</p>",
        "id": 274797922,
        "sender_full_name": "Giorgio Cangioli",
        "timestamp": 1646896329
    }
]