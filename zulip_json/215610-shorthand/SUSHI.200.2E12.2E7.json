[
    {
        "content": "<p>Announcing <strong>SUSHI 0.12.7</strong> with the following enhancements and bug fixes:</p>\n<ul>\n<li>No longer exports sparse differentials (#442)</li>\n<li>Allows constraints on children of choice elements</li>\n<li>Generates <code>id</code>s for <code>ImplementationGuide.dependsOn</code> (#445)</li>\n<li>Considers child elements / extensions of primitives when counting cardinality (#393)</li>\n<li>Reports an error when a profile declares itself as its own parent (#175)</li>\n<li>Reports an error when authors attempt to add a duplicate slice name (#199)</li>\n<li>Fixes issue that previously could result in slices having wrong cardinality (#450)</li>\n<li>Correctly handles profiles of the <code>Reference</code> datatype (#451)</li>\n<li>Replaces deprecated <code>request</code> library with current <code>axios</code> library (#344)</li>\n<li>Fixes a typo in an error message (#417)</li>\n<li>More FSH/fish puns (thanks <span class=\"user-mention\" data-user-id=\"236429\">@Benjamin Langley</span>!)</li>\n</ul>\n<p>To install or update:</p>\n<div class=\"codehilite\"><pre><span></span><code>npm install -g fsh-sushi\n</code></pre></div>\n\n\n<p>For more details, see the release notes: <a href=\"https://github.com/FHIR/sushi/releases/tag/v0.12.7\">https://github.com/FHIR/sushi/releases/tag/v0.12.7</a></p>",
        "id": 198382685,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590098438
    },
    {
        "content": "<p>I seem to be getting an error with inter-IG links (ie a profile defined in one IG can't be found from another). It was all working before I updated - the dependencies seem fine and the IG being 'referenced' is present in the cache. How cal I roll back to the previous version to test a bit more?</p>",
        "id": 198397677,
        "sender_full_name": "David Hay",
        "timestamp": 1590110324
    },
    {
        "content": "<p>My bad - I forgot that I was using the beta version that uses the yaml config file. Rolled back to that (RTFM David!) and all good...</p>",
        "id": 198397971,
        "sender_full_name": "David Hay",
        "timestamp": 1590110682
    },
    {
        "content": "<p>But a side effect is that I can't update sushi until the branch is merged...</p>",
        "id": 198398001,
        "sender_full_name": "David Hay",
        "timestamp": 1590110725
    },
    {
        "content": "<p>Yeah, we plan to apply all these bug fixes to the 0.13 beta line as well -- but might not be until early next week...</p>",
        "id": 198475560,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590171226
    },
    {
        "content": "<p>no worries...</p>",
        "id": 198515687,
        "sender_full_name": "David Hay",
        "timestamp": 1590204576
    },
    {
        "content": "<p>Actually there could be an issue - as the autobuild uses this version (and not the one that supports config.yaml), it doesn't run correctly (interestingly, one does - but not another) so exits with an error and the IG is not built. Sigh. It was all going so well... :)</p>",
        "id": 198556540,
        "sender_full_name": "David Hay",
        "timestamp": 1590276148
    },
    {
        "content": "<p>Fixed it by setting package.json directly...</p>",
        "id": 198559448,
        "sender_full_name": "David Hay",
        "timestamp": 1590281650
    },
    {
        "content": "<p>The IG Publisher doesn't like the id that sushi is generating. It seems the publisher doesn't like dashes in the id. In my package.json</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;dependencies&quot;: {\n    &quot;hl7.fhir.r4.core&quot;: &quot;4.0.1&quot;,\n    &quot;hl7.fhir.uv.genomics-reporting&quot;: &quot;1.0.0&quot;\n  },\n</code></pre></div>\n\n\n<p>and sushi creates this in the ImplementationGuide-xxx.json file</p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;dependsOn&quot;: [\n    {\n      &quot;uri&quot;: &quot;http://hl7.org/fhir/uv/genomics-reporting/ImplementationGuide/hl7.fhir.uv.genomics-reporting&quot;,\n      &quot;packageId&quot;: &quot;hl7.fhir.uv.genomics-reporting&quot;,\n      &quot;id&quot;: &quot;hl7_fhir_uv_genomics-reporting&quot;,\n      &quot;version&quot;: &quot;1.0.0&quot;\n    }\n  ],\n</code></pre></div>\n\n\n<p>which results in this error from IG Publisher</p>\n<div class=\"codehilite\"><pre><span></span><code>Publishing Content Failed: IG Name must be a valid token (hl7_fhir_uv_genomics-reporting) (00:11.0299)\n                                                                                 (00:11.0299)\nUse -? to get command line help                                                  (00:11.0299)\n                                                                                 (00:11.0299)\nStack Dump (for debugging):                                                      (00:11.0299)\njava.lang.Exception: IG Name must be a valid token (hl7_fhir_uv_genomics-reporting)\n        at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:2499)\n        at org.hl7.fhir.igtools.publisher.Publisher.initializeFromIg(Publisher.java:1726)\n        at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1306)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:682)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7310)\n</code></pre></div>\n\n\n<p>If I remove the <code>dependsOn</code> <code>id</code>, then no complaints from IG Publisher, except the usual warning that it has no id, and it builds ok.<br>\nAlso, I change the <code>id</code> from \"hl7_fhir_uv_genomics-reporting\" to \"hl7_fhir_uv_genomics_reporting\" and the publisher doesn't complain.</p>",
        "id": 199193333,
        "sender_full_name": " Bob Milius",
        "timestamp": 1590776983
    },
    {
        "content": "<p>what is dependsOn[].id?</p>",
        "id": 199195666,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590778060
    },
    {
        "content": "<p>anyway, this id is indeed checked against isToken - which only considers alphanumerics, _ [ ] <br>\nI do not know why</p>",
        "id": 199199805,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590780076
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191832\">Jose Costa Teixeira</span> <a href=\"#narrow/stream/215610-shorthand/topic/SUSHI.200.2E12.2E7/near/199195666\">said</a>:</p>\n<blockquote>\n<p>what is dependsOn[].id?</p>\n</blockquote>\n<p>If there is no id, then the IG Publisher gives this warning,</p>\n<div class=\"codehilite\"><pre><span></span><code>Dependency &#39;hla-reporting&#39; has no id, so can&#39;t be referred to in markdown in the IG (00:11.0285)\n</code></pre></div>",
        "id": 199202041,
        "sender_full_name": " Bob Milius",
        "timestamp": 1590781169
    },
    {
        "content": "<p>i know, but ImplementationGuide.dependsOn does not have an id attribute</p>",
        "id": 199202155,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590781209
    },
    {
        "content": "<p>and if it does have an id, it is checked and indeed underscore is allowed (whereas normally in an id, underscore is not allowed, only dash)</p>",
        "id": 199202389,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590781352
    },
    {
        "content": "<p><code>ImplementationGuide.dependsOn</code> is a <code>BackboneElement</code>, which is an <code>Element</code>, which has an <code>id</code> property.  That <code>id</code> is supposed to be just a string (<a href=\"http://hl7.org/fhir/R4/element.html\">doc</a>) but it seems that the publisher is a little more strict than that.  SUSHI uses the <code>packageId</code> as the <code>id</code>, but replaces the <code>.</code> with <code>_</code> since we discovered the IG Publisher does not like <code>.</code>.  We did not realize, however, that the publisher also does not like <code>-</code>, so we missed that one.  I think this will need to be resolved via a bug fix in SUSHI.</p>",
        "id": 199202943,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590781657
    },
    {
        "content": "<p>Every element has an 'id' element - inherited from Element.  In XML, it's sent as an attribute.</p>",
        "id": 199203163,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1590781771
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> correct. I did follow that. apologies</p>",
        "id": 199203192,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590781784
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> and/or <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- is there anywhere that documents what the valid characters are for <code>ImplementationGuide.dependsOn.id</code>?  They clearly aren't every character allowed in <code>string</code>...</p>",
        "id": 199203280,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590781815
    },
    {
        "content": "<p>if it is an id, it should not have underscores</p>",
        "id": 199203286,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590781817
    },
    {
        "content": "<p><a href=\"http://build.fhir.org/datatypes#id\">http://build.fhir.org/datatypes#id</a></p>",
        "id": 199203327,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590781842
    },
    {
        "content": "<p>But it's not an <code>id</code>.  It's a <code>string</code>.</p>",
        "id": 199203345,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590781855
    },
    {
        "content": "<p>damn i can't get one straight :)</p>",
        "id": 199203375,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590781875
    },
    {
        "content": "<p>i was fixed on that before.</p>",
        "id": 199203393,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1590781882
    },
    {
        "content": "<p>Well... I can see how you might assume something called <code>id</code> would be an <code>id</code>. ;-)</p>",
        "id": 199203417,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590781901
    },
    {
        "content": "<p>hmm. several comments:</p>",
        "id": 199203590,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590781992
    },
    {
        "content": "<p>the id element originally had an id type but then we discovered some reasons that we did not element id limited in length and allowable characters, so we changed it to string</p>",
        "id": 199203781,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782092
    },
    {
        "content": "<p>but it's still <code>id</code> because it functionally corresponds to xml:id and for legacy reasons</p>",
        "id": 199203882,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782152
    },
    {
        "content": "<p>We could probably document this more clearly</p>",
        "id": 199203944,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782166
    },
    {
        "content": "<p>I think an invariant that specifies allowed (or disallowed) characters would be helpful.</p>",
        "id": 199203999,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590782196
    },
    {
        "content": "<p>sure. you could make a task for that. It must not contain whitespace, for instance</p>",
        "id": 199204084,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782252
    },
    {
        "content": "<p>however the rule that are concerned with here specifically relates only this specific element - that is, <code>ImplementationGuide.dependsOn.id</code>, and it exists because of the way that this id is used.</p>",
        "id": 199204159,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782281
    },
    {
        "content": "<p>it is used in markdown, liquid, and potentially thymeleaf to refer to the IG</p>",
        "id": 199204249,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782307
    },
    {
        "content": "<p>OK.  We generate the <code>id</code> for the user right now, based on the <code>packageId</code> -- so if we know the blacklist of disallowed characters (that might be allowed in <code>packageId</code>), we can filter them out.</p>",
        "id": 199204380,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590782363
    },
    {
        "content": "<p>well, right now, it's <code>a..z, A..Z, 0..9, _, [, ]</code></p>",
        "id": 199204467,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782401
    },
    {
        "content": "<p>It allows brackets.  I would not have guessed that!</p>",
        "id": 199204591,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590782452
    },
    {
        "content": "<p>looking at this now, that piece of code is repurposed from some other usage, and thinking about the usage, it should not contain [ or ] , where as - should be allowed</p>",
        "id": 199204617,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782462
    },
    {
        "content": "<p>as should .</p>",
        "id": 199204657,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782482
    },
    {
        "content": "<p>as of the next release, the allowed characters for that specific id will be a..z, A..Z, 0..9, and _-. and it must start with a..z | A..Z</p>",
        "id": 199205029,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782663
    },
    {
        "content": "<p>If it's used as a variable in markdown, liquid, etc, I could see how maybe <code>-</code> could cause problems.  Might one of those languages mistake <code>foo-bar</code> for an attempt to subtract <code>bar</code> from <code>foo</code>?</p>",
        "id": 199205033,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590782664
    },
    {
        "content": "<p>that's a pretty good question. It could indeed, but in fact, this usage hasn't been set up, I discover, looking through the code.</p>",
        "id": 199205603,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782926
    },
    {
        "content": "<p>so for it is only in markdown, and - is ok there.</p>",
        "id": 199205658,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782950
    },
    {
        "content": "<p>There's a variety of names you could try to use that wouldn't, in fact work, either, because they are already defined</p>",
        "id": 199205746,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782979
    },
    {
        "content": "<p>and I'm not going to list them here.</p>",
        "id": 199205752,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590782984
    },
    {
        "content": "<p>but I'll take - out, since sushi shouldn't auto-generate it  - eventually someone will complain and you'll have a hard time changing if someone does</p>",
        "id": 199205994,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590783093
    },
    {
        "content": "<p>so just a..z, A..Z, 0..9, and _. and it must start with a..z | A..Z</p>",
        "id": 199206089,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590783133
    },
    {
        "content": "<p>although probably . will be a problem too...</p>",
        "id": 199206109,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590783142
    },
    {
        "content": "<p>a..z, A..Z, 0..9, and _ and it must start with a..z | A..Z</p>",
        "id": 199206144,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590783165
    },
    {
        "content": "<p>the other question is where this should be documented. It's a business rule in the IG publisher. So eventually, when we get around to redoing the IG Publisher documentation, in there</p>",
        "id": 199206211,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1590783212
    },
    {
        "content": "<p>Alright.  Fair enough.  Thanks for working through that with me!</p>",
        "id": 199207062,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1590783614
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/215610-shorthand/topic/SUSHI.200.2E12.2E7/near/199206211\">said</a>:</p>\n<blockquote>\n<p>the other question is where this should be documented. It's a business rule in the IG publisher. So eventually, when we get around to redoing the IG Publisher documentation, in there</p>\n</blockquote>\n<ol>\n<li>in the guidance ig</li>\n<li>as a constrain in a Profile on the ImplementationGuide resource?</li>\n</ol>",
        "id": 200403230,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1591787732
    },
    {
        "content": "<p>and I assume that <code>-</code> and <code>.</code> are no longer to be supported?</p>",
        "id": 200403312,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1591787781
    },
    {
        "content": "<p>so <br>\n<code>http://build.fhir.org/ig/IHE/ihe-ig-template</code><br>\nshould be renamed to <br>\n<code>http://build.fhir.org/ig/IHE/ihe_ig_template ?</code></p>",
        "id": 200403454,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1591787909
    },
    {
        "content": "<p>the name of the repo doesn't matter, so far as I know</p>",
        "id": 200407477,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591791131
    },
    {
        "content": "<p>I think i was just matching it to the IG id, to have some consistency. I'll keep the repo name, and change ids. <br>\nCan you confirm that <code>-</code> and <code>.</code> will no longer be accepted in the id?</p>",
        "id": 200407742,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1591791338
    },
    {
        "content": "<p>yes confirm, but that is specifically the id of the dependency, not the other ids</p>",
        "id": 200408172,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591791609
    },
    {
        "content": "<p>ok thanks</p>",
        "id": 200408444,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1591791830
    }
]