[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> Hi! Is there an option for sushi to generate/update a <code>package.json</code> based on the contents of <code>sushi-config.yaml</code> (or the other way around)? I don't have an IG resource in <a href=\"https://github.com/FirelyTeam/ACME-FSH-Example\">https://github.com/FirelyTeam/ACME-FSH-Example</a> and Firely Terminal needs a <code>package.json</code> for knowing the project details.</p>",
        "id": 268766877,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642717310
    },
    {
        "content": "<p>I think package.json is generated by IG publisher. I haven't found a way to influence its contents yet.</p>",
        "id": 268769239,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1642718841
    },
    {
        "content": "<p>Right, as <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> noted, we rely on the IG Publisher to generate the <code>package.json</code>.  We don't manipulate it ourselves.</p>\n<p>We could potentially look into doing this, but I'm not sure how it jives with the publisher workflow.  I wouldn't want to create a package.json that causes trouble/conflicts with the IG Publisher, so it would probably need to be an option of some sort.</p>",
        "id": 268773733,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1642721741
    },
    {
        "content": "<p>I <em>think</em> it may actually be the templates/jekyll processing that create it, but that's beyond my limit.</p>",
        "id": 268773902,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1642721845
    },
    {
        "content": "<p>package.json is a file that is created by the publishing process. manually... and usually checked into your project.</p>",
        "id": 268776022,
        "sender_full_name": "John Moehrke",
        "timestamp": 1642723249
    },
    {
        "content": "<p>which package.json is this about? I only see one, inside package.tgz, and that one is generated by the publisher.</p>",
        "id": 268805877,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1642751562
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191380\">Elliot Silver</span> <a href=\"#narrow/stream/215610-shorthand/topic/Generate.20package.2Ejson.20with.20sushi/near/268773902\">said</a>:</p>\n<blockquote>\n<p>I <em>think</em> it may actually be the templates/jekyll processing that create it, but that's beyond my limit.</p>\n</blockquote>\n<p>in ../org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools</p>\n<p>The Java code is divided into publishers/renderers/spreadsheet/teplates/ui</p>\n<p>Beyond my limit/lifespan too (this is a large code base and the whole thing is not well documented, with even some document drift)</p>",
        "id": 268831481,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1642766152
    },
    {
        "content": "<p>Thanks for all the input!</p>\n<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> In my testing the IG Publisher just ignores any <code>package.json</code> present in the root. And the only one it outputs, as <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> mentions, is in <code>.\\output\\package.tgz</code> (and some limited version at <code>.\\output\\package.manifest.json</code>).</p>",
        "id": 268915846,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642806573
    },
    {
        "content": "<p>Thanks for the info, <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span>.  If the IG Publisher ignores a user-provided <code>package.json</code> then that means we can't mess it up -- but I could also see users being confused by seeing a <code>package.json</code> generated by SUSHI that is <em>not</em> used by the IG Publisher (and perhaps wondering why the one in their <code>package.tgz</code> is so different than the one that SUSHI generated).  So I think I'd still want to make its generation be an <em>opt-in</em> sort of deal.</p>\n<p>Could you provide some requirements regarding what you would expect a SUSHI-generated <code>package.json</code> to contain? And perhaps file an official issue requesting it over at <a href=\"https://github.com/FHIR/sushi/issues\">https://github.com/FHIR/sushi/issues</a> ?</p>",
        "id": 268917555,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1642807633
    },
    {
        "content": "<p>Where would that package.json be? In which folder? Is there a risk it messes up the publisher itself?</p>",
        "id": 268917753,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1642807766
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> Will create a feature request and provide more details there!</p>",
        "id": 268917846,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642807818
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> In the root folder, where the <code>input</code> and <code>fsh-generated</code> folder also live.<br>\nAnd regarding messing up the IG publisher: As stated above, I believe it completely ignores it. But let me know if you find differently.<br>\nAnd I totally see Chris' point on making it optional, so even if the publisher would look at it, it would be a deliberate user choice to turn that on.</p>",
        "id": 268918191,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642808041
    },
    {
        "content": "<p>I see. I never saw that file so i was wondering if it's going to be in input or any of the defined folders. If it's in the root it should be harmless</p>",
        "id": 268918329,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1642808115
    },
    {
        "content": "<p>Firely Terminal, Simplifier and Forge use that <code>package.json</code> to know what dependencies a project needs and download and install these FHIR packages if needed. You can read more on the file here: <a href=\"https://confluence.hl7.org/display/FHIR/NPM+Package+Specification#NPMPackageSpecification-Packagemanifest\">https://confluence.hl7.org/display/FHIR/NPM+Package+Specification#NPMPackageSpecification-Packagemanifest</a></p>",
        "id": 268918621,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642808287
    },
    {
        "content": "<p>I'm confused about the use case. Is it so that someone using Sushi can upload their project to Simplifier, and include an already filled out package.json? Is it to provide more control over the publisher generated package.json?</p>",
        "id": 268918865,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1642808475
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> The first one.</p>\n<p>Take <a href=\"https://github.com/FirelyTeam/ACME-FSH-Example/\">https://github.com/FirelyTeam/ACME-FSH-Example/</a>, where I am using FSH to define my resources and Simplifier to create the Implementation Guide.<br>\nCurrently I must manually bring over the package dependencies from sushi-config.yaml to a package.json. Otherwise, Simplifier is unaware of the package dependencies I already previously specified.<br>\nSimilarly when I want to run Firely Terminal locally after my sushi run, to validate if the JSON output is correct or validate my custom business rules.</p>",
        "id": 268919671,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642809005
    },
    {
        "content": "<p>Aren't the dependencies in the IG resource though?</p>",
        "id": 268919778,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1642809092
    },
    {
        "content": "<p>I suppose though, there are some projects that are missing IG resources (ahem, DICOM vocab).</p>",
        "id": 268919874,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1642809143
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> Yes, sushi indeed brings them to the IG resource. Alternatively, we should teach our toolstack to  search a full folder structure for (hopefully one) IG resource. But I'd strongly prefer to just have a package.json in the root of a FHIR development project and use the package infrastructure for this.<br>\nJust like with published FHIR packages, which also contain both the IG resource (or two...) and always exactly one package manifest (package.json).</p>",
        "id": 268920432,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642809597
    },
    {
        "content": "<p>Got it. OK. Or teach Simplifier to populate projects off of the package. (I suspect the number of people using Sushi who wouldn't be comfortable running the publisher once is limited.)</p>",
        "id": 268920899,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1642809861
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> Simplifier will already happily accept a package.tgz if you upload that to your FHIR project <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span><br>\nBut I don't think that's the most efficient workflow.</p>",
        "id": 268921528,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642810266
    },
    {
        "content": "<p>Well, that would have saved me some time. <span aria-label=\"rolling eyes\" class=\"emoji emoji-1f644\" role=\"img\" title=\"rolling eyes\">:rolling_eyes:</span></p>",
        "id": 268921627,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1642810364
    },
    {
        "content": "<p>Reported the feature request here: <a href=\"https://github.com/FHIR/sushi/issues/1010\">https://github.com/FHIR/sushi/issues/1010</a> <span aria-label=\"thank you\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"thank you\">:thank_you:</span></p>",
        "id": 268923214,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1642811693
    },
    {
        "content": "<p>Thanks for the detailed writeup, <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span>.  I've added a few of my thoughts in comments to that issue (for you or anyone else following along).</p>",
        "id": 269112247,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643034155
    }
]