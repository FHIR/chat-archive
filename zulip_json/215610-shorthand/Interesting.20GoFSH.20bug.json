[
    {
        "content": "<p>Hello --<br>\nNot exactly sure this is a real bug, but I just passed a bunch of files through gofsh and one of them (below) had a \"/\" in the \"name:\" (see below) and this caused gofsh to convert the file opening a new \"/Cor\" directory<br>\n{<br>\n    \"resourceType\": \"CodeSystem\",<br>\n    \"id\": \"br-core-codesystem-patient-raceethnicity-race\",<br>\n    \"meta\": {<br>\n        \"lastUpdated\": \"2020-03-11T18:20:19.538+00:00\"<br>\n    },<br>\n    \"language\": \"pt-BR\",<br>\n    \"url\": \"<a href=\"http://www.saude.gov.br/fhir/r4/CodeSystem/BRRacaCor\">http://www.saude.gov.br/fhir/r4/CodeSystem/BRRacaCor</a>\",<br>\n    \"version\": \"201701A\",<br>\n    \"name\": \"Raça/Cor\",<br>\n    \"status\": \"active\",<br>\n    \"experimental\": false,<br>\n    \"date\": \"2020-03-11T18:20:40.0457007+00:00\",<br>\n    \"publisher\": \"Ministério da Saúde do Brasil\",<br>\n    \"description\": \"Códigos para representação de raça/cor.\",<br>\n    \"content\": \"complete\",<br>\n    \"concept\": [<br>\n        {<br>\n            \"code\": \"01\",<br>\n            \"display\": \"Branca\"<br>\n        },<br>\n        {<br>\n            \"code\": \"02\",<br>\n            \"display\": \"Preta\"<br>\n        },<br>\n        {<br>\n            \"code\": \"03\",<br>\n            \"display\": \"Parda\"<br>\n        },<br>\n        {<br>\n            \"code\": \"04\",<br>\n            \"display\": \"Amarela\"<br>\n        },<br>\n        {<br>\n            \"code\": \"05\",<br>\n            \"display\": \"Indígena\"<br>\n        }<br>\n    ]<br>\n}</p>\n<p><a href=\"/user_uploads/10155/4QCFxk-_Q5SEfSKPo_ei37Pq/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/4QCFxk-_Q5SEfSKPo_ei37Pq/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/4QCFxk-_Q5SEfSKPo_ei37Pq/image.png\"></a></div><p>This is interesting because, of course, per the spec for the string data type, this is not a bug (<a href=\"https://hl7.org/fhir/r4/datatypes.html#string\">https://hl7.org/fhir/r4/datatypes.html#string</a>)<br>\nJust thought you guys might like to know this.  I'd be interested in your comments.<br>\nCheers,<br>\nHank.</p>",
        "id": 265418816,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639834530
    },
    {
        "content": "<p>If this wasn't clear: \"name\":  \"Raça/Cor\" (← this string) caused gofsh to split into a new directory (the string means: \"Race/Color\").</p>",
        "id": 265445741,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639864561
    },
    {
        "content": "<p>True that it’s not really a bug but the name of a profile is expected to be computer friendly so the / character would raise a warning</p>",
        "id": 265447080,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1639866295
    },
    {
        "content": "<p>This is absolutely a real bug, as a maliciously crafted input could end up overwriting a file in an arbitrary location. I'll let the team know ASAP.</p>",
        "id": 265558657,
        "sender_full_name": "Mint Thompson",
        "timestamp": 1640005059
    },
    {
        "content": "<p>Oh, boy I'm glad I reported this!</p>",
        "id": 265567645,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1640009380
    },
    {
        "content": "<p>Yep.  We'll work on a fix!</p>\n<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> is correct, however, that names <em>should</em> not contain characters like <code>/</code>.  According to the spec, names should be alphanumeric.  More specifically, they should start with an uppercase letter and be followed by any combination of uppercase or lowercase letters, digits, and the underscore character (<code>_</code>).  That said, it is SHOULD, not SHALL.  See <a href=\"http://hl7.org/fhir/R4/structuredefinition-definitions.html#StructureDefinition.name\">StructureDefinition.name</a>.</p>",
        "id": 265568166,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640009610
    },
    {
        "content": "<p>Is that invariant enforced anywhere? (I’d never noticed the capitalization requirement before, and suspect many of my resources are non-conformant.) Actually, seems like something the IG publisher should check.</p>",
        "id": 265585792,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1640017906
    },
    {
        "content": "<p>sushi does throw an error, I recall that the IG publisher does \"warn\". I am sure I recall seeing that as a warn or error. ... but if you are not using sushi to start with (why would you be using GoFSH), or the IG publisher, or a validator, etc. I think in this case GoFSH is starting with an IG that was not formally published (or not lately)</p>",
        "id": 265590543,
        "sender_full_name": "John Moehrke",
        "timestamp": 1640020261
    },
    {
        "content": "<p>but Postel's Law needs to be applied to GoFSH too. Be robust, don't assume well structured input.</p>",
        "id": 265590958,
        "sender_full_name": "John Moehrke",
        "timestamp": 1640020462
    },
    {
        "content": "<p>For GoFSH, except in very extreme circumstances, we prioritize consistency w/ the input source over best practice / correctness.  E.g., if you pass GoFSH a FHIR project, it will try to create FSH that reflects that FHIR project as closely as possible (warts and all).  If we changed ids/names to follow best practices then we'd be creating a project that is not backward compatible to the input project you passed us.  That doesn't seem like a good idea, so we try not to do that.</p>",
        "id": 265609368,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640030409
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"437401\">@Hank Lenzi</span> - this bug is fixed in the newly released GoFSH 1.4.2.  See my other post for details.</p>",
        "id": 265642825,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1640056392
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191469\">Chris Moesel</span> <a href=\"#narrow/stream/215610-shorthand/topic/Interesting.20GoFSH.20bug/near/265642825\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"437401\">Hank Lenzi</span> - this bug is fixed in the newly released GoFSH 1.4.2.  See my other post for details.</p>\n</blockquote>\n<p>Fantastic! Kudos for the quick response!</p>",
        "id": 265690302,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1640096741
    }
]