[
    {
        "content": "<p>Hi ,  just to check: I'm trying to use  the nictiz.fhir.nl.r4.zib2020: 0.1.0-beta1 in my sushi project. There's no IG in this package, so I can't use this in my project can I?</p>",
        "id": 264494426,
        "sender_full_name": "Sebastiaan Raap",
        "timestamp": 1639163515
    },
    {
        "content": "<p>Yes, you can still use it in a SUSHI project, but there are a few things you will need to do.</p>\n<ol>\n<li>Update SUSHI to v2.2.2 since it addresses a bug with downloading dependencies.</li>\n<li>Update your dependency in sushi-config.yaml to include an IG canonical URL since the package doesn't specify one.</li>\n<li>Use Firely Terminal to \"bake\" the dependency in your FHIR cache since it is not distributed w/ the profile snapshots (which SUSHI needs).</li>\n</ol>",
        "id": 264508747,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639170660
    },
    {
        "content": "<p>Re 2 above, you can do something like this:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">dependencies</span><span class=\"p\">:</span>\n  <span class=\"nt\">nictiz.fhir.nl.r4.zib2020</span><span class=\"p\">:</span>\n    <span class=\"nt\">uri</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://nictiz.nl/fhir</span>\n    <span class=\"nt\">version</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">0.1.0-beta1</span>\n</code></pre></div>",
        "id": 264508782,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639170676
    },
    {
        "content": "<p>Re 3 above, you'll need the <a href=\"https://www.nuget.org/packages/Firely.Terminal/2.5.0-beta-4\">Firely Terminal 2.5.0 beta</a>.  You should use the <code>fhir bake</code> command to populate the snapshots.</p>",
        "id": 264509482,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639171001
    },
    {
        "content": "<p>thanks, added the package to my fhir cache, but didn't bake it yet. thanks again.</p>",
        "id": 264566111,
        "sender_full_name": "Sebastiaan Raap",
        "timestamp": 1639233950
    },
    {
        "content": "<p>when I download  package de.gkvsv.eRezeptAbrechnungsdaten or  nictiz.fhir.nl.r4.zib2020 from simplifier, there is no \"url\" or \"canonical\" present in the package.json. It differs from other packages on simplifier like hl7.fhir.uv.sdc , that package.json does contain url and canonical.</p>",
        "id": 264702990,
        "sender_full_name": "Sebastiaan Raap",
        "timestamp": 1639400965
    },
    {
        "content": "<p>I've added url  to the nictiz.fhir.nl.r4.zib2020 package.json and everything works like a charm. But shouldn't url (and maybe canonical) always be present in package.json when downloaded from the package registry?</p>",
        "id": 264703285,
        "sender_full_name": "Sebastiaan Raap",
        "timestamp": 1639401141
    },
    {
        "content": "<p>I'm not sure if it is required or not.  That might be a good question for <span class=\"user-mention\" data-user-id=\"191335\">@Martijn Harthoorn</span>.</p>",
        "id": 264703419,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639401241
    },
    {
        "content": "<p>According to the NPM package spec both canonical and url are optional in the package manifest. <a href=\"https://confluence.hl7.org/display/FHIR/NPM+Package+Specification\">https://confluence.hl7.org/display/FHIR/NPM+Package+Specification</a><br>\nAnd after a quick search on Simplifier, which is the backbone for the registry, most packages do not contain a canonical or a url in the package manifest.</p>",
        "id": 264821688,
        "sender_full_name": "Matthijs van der Wielen",
        "timestamp": 1639467775
    },
    {
        "content": "<p>Hello --I was just wondering...Where does sushi pull the resource IG template from? Suppose I wanted to create an extension to a published IG that's not at <a href=\"http://hl7.fhir.org\">hl7.fhir.org</a>, but that was already an extension of Patient resources (suppose a national \"Core\" project). Where would I configure that in? What would I write in <a href=\"http://shushi-yaml.org\">shushi-yaml.org</a>? TIA</p>",
        "id": 264834390,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639476181
    },
    {
        "content": "<p>are you asking about the template, or the core content of the profiles?</p>",
        "id": 264838409,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639478555
    },
    {
        "content": "<p>Hello Grahame - The question is: when I did the fish exercises, I extended a Patient profile. I suppose sushi pulls this from <a href=\"http://hl7.fhir.org\">hl7.fhir.org</a> Right? Now, if I were to extended somebody else's Patient profile (say, a national \"core\" project), where would I set that on the fsh files? In \"dependency\"? <br>\n(I guess the answer would be core content of the profiles).</p>",
        "id": 264851191,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639485751
    },
    {
        "content": "<p>Just to make myself clear. I'd like to extend this: <a href=\"https://registry.fhir.org/package/BRCore-01.00.00%7C1.0.0\">https://registry.fhir.org/package/BRCore-01.00.00%7C1.0.0</a><br>\n(or simplifier: <a href=\"https://simplifier.net/BR-Core\">https://simplifier.net/BR-Core</a>  ) I've copied all CodeSystems and ValueSets to [root]/input/resources</p>",
        "id": 264851365,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639485857
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 264851896,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639486177
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"437401\">@Hank Lenzi</span> - If you want use resources from another IG, then you need to declare it as a dependency in sushi-config.yaml.  You can find some documentation on dependency configuration here: <a href=\"https://fshschool.org/docs/sushi/configuration/#dependencies\">https://fshschool.org/docs/sushi/configuration/#dependencies</a></p>\n<p>If you want to depend on the BRCore-01.00.00 IG you linked to above, you need to use the long-form dependency declaration since that IG does not contain an ImplementationGuide resource (which is where we would normally pull the IG URL from).  For example, something like this:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">dependencies</span><span class=\"p\">:</span>\n  <span class=\"nt\">brcore-01.00.00</span><span class=\"p\">:</span>\n    <span class=\"nt\">uri</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">http://www.saude.gov.br/fhir/r4</span>\n    <span class=\"nt\">version</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">1.0.0</span>\n</code></pre></div>\n<p>Unfortunately, you still run into one more problem, which is that the IG doesn't come packaged with snapshots -- yet SUSHI requires snapshots in order to process the resources correctly.  So... you will need to download the latest <a href=\"https://www.nuget.org/packages/Firely.Terminal/2.5.0-beta-4\">Firely.Terminal 2.5.0 Beta</a> and use its <code>fhir bake</code> command to populate the snapshots in your FHIR cache.</p>",
        "id": 264858660,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639489464
    },
    {
        "content": "<p>Thanks for the confirmation and clarification, <span class=\"user-mention\" data-user-id=\"259036\">@Matthijs van der Wielen</span>.  SUSHI requires <em>some</em> URI associated w/ the dependency because it generates an ImplementationGuide resource, for which <code>dependsOn.uri</code> is <em>required</em>.  It's still not clear what that value should be for packages that have no IG resource, but I usually just use the root of the canonical URLs I see in most of the package contents.</p>",
        "id": 264859105,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639489661
    },
    {
        "content": "<p>BTW -- the issue about <code>dependsOn.uri</code> being required has recently come up in <a href=\"#narrow/stream/179252-IG-creation/topic/fhir.2Edicom.20has.20no.20ImplementationGuide.20resource/near/263627385\">another thread</a> and Grahame was going to investigate how it should work.</p>",
        "id": 264859853,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639489970
    },
    {
        "content": "<p>Hi Chris ---  Thanks. <br>\nFor the following site: <a href=\"https://br-core.gointerop.com/fhir\">https://br-core.gointerop.com/fhir</a><br>\nwhich implements br-core, would this be the correct url on the dependency?</p>",
        "id": 264859905,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639489994
    },
    {
        "content": "<p>To be honest, I'm not sure how much it matters.  The IG Publisher will probably complain that it does not point to an ImplementationGuide resource, but since BR Core does not have an ImplementationGuide resource, it is impossible to point to it!  I usually just put the base canonical URL I see across many resources in the IG -- but it's probably fine to put a URL like the one you suggested as well.  Hopefully we'll have more clarity on this after <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> investigates what to do w/ <code>dependsOn.uri</code> for packages without an IG resource.</p>",
        "id": 264860420,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639490218
    },
    {
        "content": "<p>Seems complicated. Meanwhile, we're investigating a new path: fed JSON files to GoFish and then feed that into FSH. Takes some tweaking. Not sure on the outcome yet, though.</p>",
        "id": 264893780,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639502812
    },
    {
        "content": "<p>I think it depends on what you're after.  There is value in formally declared dependencies and references -- but if that's not what you need, I suppose there are other approaches!</p>\n<p>Re: the need to use Firely.Terminal and <code>fhir bake</code>, I plan on documenting that better soon so that it doesn't seem quite so complicated!</p>",
        "id": 264902698,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1639506299
    },
    {
        "content": "<p>I think it's an issue for committee - the design requires that IGs depend on packages that declare themselves as IGs - I don't think I can override that in the tools somehow</p>",
        "id": 264916128,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1639511738
    },
    {
        "content": "<p>Our hack, to circumvent these situations (groups that release stuff with no IGs) is to process the resources via GoFish, thn tweak the FSH files in order to regenerate+extend whatever it is we are doing (we're attempting a Covid-19 notification composition, following the data dictionaries from the official documentation for notification guides (non-FHIR) from the Brazilian Ministry of Health. It's been an interesting afternoon in experimenting with that. Sushi remains  a bit mysterious to me.</p>",
        "id": 264937933,
        "sender_full_name": "Hank Lenzi",
        "timestamp": 1639522127
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> <br>\nI read the whole thread but I want to make sure I understand before I commit to all the work necessary. <br>\nThis is how our dependencies are declared:<br>\n<a href=\"/user_uploads/10155/Lxbk7aa2u9qPmzGlSNnm-SmD/image.png\">image.png</a> <br>\nBut sushi still asks for snapshots from <code>ILCore</code>. Does this mean I too have to <code>fhir bake</code> the project? If so, is there any way of getting the tool w/o installing dotnet? I never needed it so far and it feels a bit much for a single tiny command...</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/Lxbk7aa2u9qPmzGlSNnm-SmD/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/Lxbk7aa2u9qPmzGlSNnm-SmD/image.png\"></a></div>",
        "id": 276871595,
        "sender_full_name": "Kippi Bordowitz",
        "timestamp": 1648473513
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"380122\">@Kippi Bordowitz</span> -- There are a couple of things going on here.</p>\n<p>First, if you are using SUSHI 2.3.0, then you no longer need to specify the URL in your dependencies (even for packages without an IG resource).  So you can simplify your dependencies to:</p>\n<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"nt\">dependencies</span><span class=\"p\">:</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">il.core.fhir.r4</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">0.6.0</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"nt\">hl7.fhir.us.core</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">4.1.0</span><span class=\"w\"></span>\n</code></pre></div>\n<p>There are more details in the <a href=\"https://github.com/FHIR/sushi/releases/tag/v2.3.0\">SUSHI 2.3.0 Release Notes</a>.</p>\n<p>Second, SUSHI <em>does</em> require dependencies to contain the snapshot elements.  If you get an error that SUSHI can't process a parent because it does not have a snapshot, you'll need to get its snapshot into the FHIR cache.  Using Firely Terminal with <code>fhir bake</code> is the easiest approach for most users (<a href=\"https://fshschool.org/docs/sushi/tips/#structure-definition-is-missing-snapshot\">see doc here</a>).</p>\n<p>If you do not want to install Firely Terminal (and its dotNET requirement), then you can manually update your FHIR cache.  These are the basic steps for that:</p>\n<ol>\n<li>Download the package <em>with snapshots</em> by going to the version of the package you want on simplifier (example: <a href=\"https://simplifier.net/packages/il.core.fhir.r4/0.6.0\">il.core.fhir.r4 0.6.0</a>, then click <em>Download</em> --&gt; <em>Download Snapshots</em>).</li>\n<li>Extract the downloaded tgz file.  The extraction will have a folder named <code>package</code> with all of the important files in it.</li>\n<li>Create the dependency's folder in your FHIR cache.  In your case, this means creating the folder: <code>~/.fhir/packages/il.core.fhir.r4#0.6.0/</code>.  If that folder already exists, just delete its contents.</li>\n<li>Copy all the files from the extracted tgz's <code>package</code> folder to the relevant folder in the FHIR cache (that you just created or cleaned).</li>\n<li>Run SUSHI again and verify it now works.</li>\n</ol>",
        "id": 276891379,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1648481765
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> thanks!<br>\nAs I happen to be the person who also maintains the ILCore simplifier - could you tell me how one goes about making sure the package actually has the snapshots?</p>",
        "id": 276892752,
        "sender_full_name": "Kippi Bordowitz",
        "timestamp": 1648482389
    },
    {
        "content": "<p>More important - how do I find my FHIR cache folder? I googled it but found nothing...<br>\nI'm on windows</p>",
        "id": 276893161,
        "sender_full_name": "Kippi Bordowitz",
        "timestamp": 1648482594
    },
    {
        "content": "<p>Simplifier doesn't create snapshots in their packages. You can run through the process <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> describes, upload the resulting profiles to Simplifier, and repackage those; or, you can build use IG publisher to build profiles that have snapshots, upload the resulting profiles to Simplifier, and package those.</p>\n<p>Your FHIR cache is in ~/.fhir on Mac, I forget where it is on other platforms.</p>",
        "id": 276893626,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1648482791
    },
    {
        "content": "<p>found it! c:\\users\\&lt;username&gt;\\.fhir\\packages</p>",
        "id": 276894118,
        "sender_full_name": "Kippi Bordowitz",
        "timestamp": 1648483023
    },
    {
        "content": "<p>Right, as <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> noted, packages created by Simplifier do not contain snapshots (by default).  You can manually force a download w/ snapshots (as I described above), but that's not available via an API (which is why it is a manual process).</p>\n<p>Regarding the FHIR cache, if you can find your user home directory (wherever that is in Windows), it should contain a <code>.fhir</code> folder within it.  It's possible that Windows hides that folder from normal views; I'm not sure.</p>",
        "id": 276894127,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1648483028
    },
    {
        "content": "<p>Oh.  You found it.  Perfect!</p>",
        "id": 276894155,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1648483041
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> , <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span>  - Great success. Thanks a lot you guys!</p>",
        "id": 276897154,
        "sender_full_name": "Kippi Bordowitz",
        "timestamp": 1648484351
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"380122\">@Kippi Bordowitz</span> <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> </p>\n<blockquote>\n<p>Simplifier doesn't create snapshots in their packages.</p>\n</blockquote>\n<p>Actually, we are introducing a new, configurable package publication pipeline in Simplifier, which also includes the option to generation snapshots as part of the process.<br>\nPlease reach out to me if you'd like to beta test this.</p>",
        "id": 277771791,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1649095588
    }
]