[
    {
        "content": "<p>Hi <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> I'm using goFSH tool to turn an existing Composition profile designed in Forge into FSH. The profile slices <code>Composition.section</code> and one of those slices is optional (<code>0..*</code>, to be precise). The corresponding entry in the StructureDefinition has neither <code>min</code> nor <code>max</code> fields:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"p\">{</span>\n    <span class=\"nt\">\"id\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Composition.section:questionnaire\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"path\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Composition.section\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"sliceName\"</span><span class=\"p\">:</span> <span class=\"s2\">\"questionnaire\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"short\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Questionnaires used in the software\"</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>In addition, two fields in the <code>entry</code> element are defined as required in that slice. However, running goFSH on this gives a <em>required</em> slice in FSH:</p>\n<div class=\"codehilite\"><pre><span></span><code>* section contains\n    [other slices]\n    questionnaire 1..* and\n    [other slices]\n</code></pre></div>\n<p>which indeed compiles into an a slice entry like the above, except that it explicitly sets <code>min</code> and <code>max</code> to 1 and *, respectively. So it seems goFSH assumes that the default minimum slice cardinality is 1. I didn't see any statement on this (or the contrary) in the <a href=\"https://www.hl7.org/fhir/elementdefinition.html#ElementDefinition\">ElementDefinition documentation</a> - was this a deliberate choice?</p>",
        "id": 241756994,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1623062475
    },
    {
        "content": "<p>I don't think that is a deliberate choice.  It may be a bug.  Is there a public FHIR JSON/XML representation we can look at to try to reproduce this?</p>",
        "id": 241774076,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1623071647
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span>, here is a minimal example that leads to this behavior - the <em>quest</em> slice should be optional but gets converted into a required slice.</p>\n<ul>\n<li><a href=\"/user_uploads/10155/Jd1Ue19cDxtSDe7bOf_7hPDQ/Composition-prof.StructureDefinition.json\">Composition-prof.StructureDefinition.json</a></li>\n</ul>\n<p>I discovered that this is related to the fact that the profile also sets the cardinality of <code>Composition.section</code> to <code>1..*</code>. If that cardinality is set to <code>0..*</code>,  the slice remains optional  (is set to <code>0..*</code>). However, since the slicing is open, it is of course valid to only have an optional slice.</p>",
        "id": 241799456,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1623081751
    },
    {
        "content": "<p>Thanks... we're a bit tied up at the moment trying to get some last minute things in for FHIR DevDays, but hopefully we can take a look at this soon.  Your example and analysis is very helpful.  Thank you!</p>",
        "id": 241808297,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1623085475
    },
    {
        "content": "<p>A worthy cause - after all, I myself learned FSH from your session at the last DevDays <span aria-label=\"nerd\" class=\"emoji emoji-1f913\" role=\"img\" title=\"nerd\">:nerd:</span></p>",
        "id": 241816249,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1623088922
    },
    {
        "content": "<p>I've logged this as <a href=\"https://github.com/FHIR/GoFSH/issues/135\">GoFSH#135</a>. We hope to fix this in the next two-week sprint (which starts tomorrow).</p>",
        "id": 242950361,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1623881839
    }
]