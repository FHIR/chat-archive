[
    {
        "content": "<p>I'm trying to create a profile based on an external profile (genomics-reporting). So I add this to the package.json</p>\n<div class=\"codehilite\"><pre><span></span>&quot;dependencies&quot;: {\n    &quot;hl7.fhir.r4.core&quot;: &quot;4.0.1&quot;,\n    &quot;hl7.fhir.uv.genomics-reporting&quot;: &quot;1.0.0&quot;\n  },\n</pre></div>\n\n\n<p>and then create a fsh file that requires a named slice of a component (gene-studied) that's optional in the parent profile.</p>\n<div class=\"codehilite\"><pre><span></span>Profile:        Mygenotype\nParent:         genotype\nId:             mygenotype\nTitle:          &quot;My Profile of Genotype Observation&quot;\nDescription:    &quot;Profiling genotype observation&quot;\n\n* component contains gene-studied 1..1\n</pre></div>\n\n\n<p>Sushi runs without any error, but when I go to build the IG, I get a </p>\n<div class=\"codehilite\"><pre><span></span>Publishing Content Failed: Unable to generate snapshot for http://example.org/fhir/hla-reporting/StructureDefinition/mygenotype in /Users/bmilius/Documents/src/fsh/hla/build/input/resources/structuredefinition-mygenotype (00:17.0464)\n</pre></div>\n\n\n<p>that's rather uninformative. Am I doing something wrong?</p>",
        "id": 187535182,
        "sender_full_name": " Bob Milius",
        "timestamp": 1580983928
    },
    {
        "content": "<p>I can't speak to the IG publisher, but I think the FSH should be changed to:</p>\n<div class=\"codehilite\"><pre><span></span>Profile:        Mygenotype\nParent:         genotype\nId:             mygenotype\nTitle:          &quot;My Profile of Genotype Observation&quot;\nDescription:    &quot;Profiling genotype observation&quot;\n\n* component[gene-studied] 1..1\n</pre></div>\n\n\n<p>Since the <code>gene-studied</code> slice already exists via the parent resource, you don't need to use the <code>contains</code> keyword, since that keyword is used to create slices. You can just directly access the slice and set its cardinality using the syntax shown above.</p>\n<p>It looks like if you do use the <code>contains</code> keyword, we actually generate a new slice called <code>gene-studied</code> alongside the already existing slice, so you end up with two <code>gene-studied</code> slices. We should've been emitting an error to warn you this was happening incorrectly, so I'll track that as a bug in SUSHI.</p>",
        "id": 187548631,
        "sender_full_name": "Nick Freiter",
        "timestamp": 1580996807
    },
    {
        "content": "<p>Thanks, <span class=\"user-mention\" data-user-id=\"239822\">@Nick Freiter</span>  That makes sense. I made the change but am still getting the IG publisher error.</p>",
        "id": 187584856,
        "sender_full_name": " Bob Milius",
        "timestamp": 1581020516
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191916\">@ Bob Milius</span> - have you included the profile name into the ImplementationGuide JSON file?  I think you need to manually configure that.  This file would be in the ./build/input directory.<br>\nAs an example, below is a snippet of how we included the mCODE <code>CancerGeneticVariant</code> profile in our ./build/input/ImplementationGuide-fhir.us.mcode.json file:  </p>\n<div class=\"codehilite\"><pre><span></span>        {\n          &quot;reference&quot;: {\n            &quot;reference&quot;: &quot;StructureDefinition/CancerGeneticVariant&quot;\n          },\n          &quot;name&quot;: &quot;Cancer Genetic Variant&quot;,\n          &quot;description&quot;: &quot;Records an alteration in the most common DNA nucleotide sequence. The term variant can be used to describe an alteration that may be benign, pathogenic, or of unknown significance. The term variant is increasingly being used in place of the term mutation.&quot;,\n          &quot;exampleBoolean&quot;: false\n        }\n</pre></div>",
        "id": 187585699,
        "sender_full_name": "May Terry",
        "timestamp": 1581021100
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192302\">@May Terry</span> , thanks, but yes it's already included</p>\n<div class=\"codehilite\"><pre><span></span>      {\n        &quot;reference&quot;: {\n          &quot;reference&quot;: &quot;StructureDefinition/mygenotype&quot;\n        },\n        &quot;name&quot;: &quot;My Profile of Genotype Observation&quot;,\n        &quot;description&quot;: &quot;Profiling genotype observation&quot;,\n        &quot;exampleBoolean&quot;: false\n      }\n</pre></div>\n\n\n<p>btw, I just noticed this msg from the IG publisher output:</p>\n<div class=\"codehilite\"><pre><span></span>Dependency &#39;hl7.fhir.uv.genomics-reporting&#39; has no id, so can&#39;t be referred to in markdown in the IG (00:16.0880)\n</pre></div>",
        "id": 187586537,
        "sender_full_name": " Bob Milius",
        "timestamp": 1581021704
    },
    {
        "content": "<p>I've seen that last error before and it <em>seems</em> to be harmless.  I'll take a look at this <span class=\"user-mention\" data-user-id=\"191916\">@ Bob Milius</span>.  If I can reproduce it on my side I might be able to figure out what's going on.</p>",
        "id": 187589171,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581023432
    },
    {
        "content": "<p>it's significance depends on what you are doing. If you don't want to refer to the dependency in the markdown, then you don't need an id.</p>",
        "id": 187589210,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581023471
    },
    {
        "content": "<p>That makes sense -- and the message is pretty clear about that.  I guess I meant that it shouldn't have an effect on things like what Bob is currently reporting.  But... I think we can get the <code>id</code> in there too, so people can refer to them in markdown if they'd like.</p>",
        "id": 187591822,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581025369
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- I'm having trouble determining the problem here.  The profile that SUSHI generates seems valid to me, but the IG publisher crashes on it.  Here is the SD (I removed our generated snapshot to ensure that's not the issue -- and it still fails):</p>\n<div class=\"codehilite\"><pre><span></span>{\n  &quot;resourceType&quot;: &quot;StructureDefinition&quot;,\n  &quot;id&quot;: &quot;mygenotype&quot;,\n  &quot;url&quot;: &quot;http://hl7.org/fhir/sushi-test/StructureDefinition/mygenotype&quot;,\n  &quot;version&quot;: &quot;0.1.0&quot;,\n  &quot;name&quot;: &quot;Mygenotype&quot;,\n  &quot;title&quot;: &quot;My Profile of Genotype Observation&quot;,\n  &quot;status&quot;: &quot;active&quot;,\n  &quot;description&quot;: &quot;Profiling genotype observation&quot;,\n  &quot;fhirVersion&quot;: &quot;4.0.1&quot;,\n  &quot;mapping&quot;: [\n    {\n      &quot;identity&quot;: &quot;v2-cg-results&quot;,\n      &quot;uri&quot;: &quot;http://unknown.org/V2-CG-Results&quot;,\n      &quot;name&quot;: &quot;V2-CG-Results&quot;\n    },\n    {\n      &quot;identity&quot;: &quot;workflow&quot;,\n      &quot;uri&quot;: &quot;http://hl7.org/fhir/workflow&quot;,\n      &quot;name&quot;: &quot;Workflow Pattern&quot;\n    },\n    {\n      &quot;identity&quot;: &quot;sct-concept&quot;,\n      &quot;uri&quot;: &quot;http://snomed.info/conceptdomain&quot;,\n      &quot;name&quot;: &quot;SNOMED CT Concept Domain Binding&quot;\n    },\n    {\n      &quot;identity&quot;: &quot;v2&quot;,\n      &quot;uri&quot;: &quot;http://hl7.org/v2&quot;,\n      &quot;name&quot;: &quot;HL7 v2 Mapping&quot;\n    },\n    {\n      &quot;identity&quot;: &quot;rim&quot;,\n      &quot;uri&quot;: &quot;http://hl7.org/v3&quot;,\n      &quot;name&quot;: &quot;RIM Mapping&quot;\n    },\n    {\n      &quot;identity&quot;: &quot;w5&quot;,\n      &quot;uri&quot;: &quot;http://hl7.org/fhir/fivews&quot;,\n      &quot;name&quot;: &quot;FiveWs Pattern Mapping&quot;\n    },\n    {\n      &quot;identity&quot;: &quot;sct-attr&quot;,\n      &quot;uri&quot;: &quot;http://snomed.org/attributebinding&quot;,\n      &quot;name&quot;: &quot;SNOMED CT Attribute Binding&quot;\n    }\n  ],\n  &quot;kind&quot;: &quot;resource&quot;,\n  &quot;abstract&quot;: false,\n  &quot;type&quot;: &quot;Observation&quot;,\n  &quot;baseDefinition&quot;: &quot;http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/genotype&quot;,\n  &quot;derivation&quot;: &quot;constraint&quot;,\n  &quot;differential&quot;: {\n    &quot;element&quot;: [\n      {\n        &quot;id&quot;: &quot;Observation.component&quot;,\n        &quot;path&quot;: &quot;Observation.component&quot;,\n        &quot;min&quot;: 1\n      },\n      {\n        &quot;id&quot;: &quot;Observation.component:gene-studied&quot;,\n        &quot;path&quot;: &quot;Observation.component&quot;,\n        &quot;min&quot;: 1,\n        &quot;max&quot;: &quot;1&quot;\n      }\n    ]\n  }\n}\n</pre></div>\n\n\n<p>As you can see, the diff is pretty straight-forward.  And here is the exception:</p>\n<div class=\"codehilite\"><pre><span></span>org.hl7.fhir.exceptions.FHIRException: Unable to generate snapshot for http://hl7.org/fhir/sushi-test/StructureDefinition/mygenotype in /Users/cmoesel/dev/fsh/bob-ig/build/input/resources/structuredefinition-mygenotype\n    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3958)\n    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:3910)\n    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3343)\n    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:804)\n    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:665)\n    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6937)\nCaused by: java.lang.NullPointerException\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:1427)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:523)\n    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3956)\n    ... 5 more\n</pre></div>",
        "id": 187593723,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581026847
    },
    {
        "content": "<p>For reference, here is the baseDefinition profile that it is based on: <a href=\"http://hl7.org/fhir/uv/genomics-reporting/genotype.html\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/genomics-reporting/genotype.html\">http://hl7.org/fhir/uv/genomics-reporting/genotype.html</a></p>",
        "id": 187593853,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581026925
    },
    {
        "content": "<p>And here is a simple FSH project (already built w/ SUSHI) that I used to demonstrate it.  The buildable IG is in the <code>build</code> folder. <a href=\"/user_uploads/10155/X4noJUeUu9K7IKN8MZAnruVH/mygenotype-ig.zip\" target=\"_blank\" title=\"mygenotype-ig.zip\">mygenotype-ig.zip</a></p>",
        "id": 187593894,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581026976
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 187610241,
        "sender_full_name": "Mark Kramer",
        "timestamp": 1581045824
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"239822\">@Nick Freiter</span> just noticed that this bug looks a lot like another bug that was reported to us over the weekend (<a href=\"https://github.com/FHIR/sushi/issues/207\" target=\"_blank\" title=\"https://github.com/FHIR/sushi/issues/207\">SUSHI #207</a>).  So it's likely that this bug has the same root cause as the other: we (SUSHI) are not repeating inherited slice names in the differential.  Look for a fix in a future version of SUSHI.</p>",
        "id": 187830549,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581351461
    },
    {
        "content": "<p>the problem was a missing slice name. Next release won't give you an NPE, but the missing slice name will still cause an error</p>",
        "id": 187984462,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581487984
    },
    {
        "content": "<p>Thanks for the confirmation, <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- we're already on it!</p>",
        "id": 188010528,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1581515124
    }
]