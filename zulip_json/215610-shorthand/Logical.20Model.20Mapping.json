[
    {
        "content": "<p>Is it possible to define a <a href=\"https://build.fhir.org/ig/HL7/fhir-shorthand/reference.html#defining-mappings\">FSH Mapping</a> from a base resource (e.g., Patient) to a FSH-created logical model?</p>",
        "id": 257272807,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1634073056
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"251487\">@Matt Rouhana</span> - The FSH Mapping capability is just a friendlier syntax for the existing <a href=\"http://hl7.org/fhir/R4/structuredefinition-definitions.html#StructureDefinition.mapping\">StructureDefinition.mapping</a> and <a href=\"http://hl7.org/fhir/R4/elementdefinition-definitions.html#ElementDefinition.mapping\">ElementDefinition.mapping</a> mechanism. Those say they are for mapping to <em>external</em> specifications, but I don't think there is anything that would technically prevent you from adding mappings on your logical models that point to FHIR resources they map to.</p>\n<p>I think the more traditional approach to mapping logical models to FHIR resources might be via <a href=\"http://hl7.org/fhir/R4/structuremap.html\">StructureMap</a> and/or <a href=\"http://hl7.org/fhir/R4/mapping-language.html\">FHIR Mapping Language</a>.  But we're starting to reach the limits of my expertise on logical models and mappings, so perhaps <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> can lend more to this conversation than I can.</p>",
        "id": 257278944,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1634076261
    },
    {
        "content": "<p>I can only speak for the utility of it and the generic mechanism:<br>\nMapping a Patient resource to a logical model can be useful to understand what data elements in a profile/resource are mapped to the \"abstract\" model. For example I'm doing this in Belgium: First define the functional (logical) data model of the data I need (which can be inferred from an previous standard), and then I map this to the FHIR profiles. This mapping is useful to check whether the models are compatible, if there are gaps, etc</p>",
        "id": 257279551,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1634076592
    },
    {
        "content": "<p>The mapping itself in this case can be captured in two places (at least):<br>\na) StructureDefinition.mapping and ElementDefinition.mapping<br>\nb) in a StructureMap that links them both (which can expressed also in the form of FHIR mapping as <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> says)<br>\nFrom a governance perspective, I am more in favour of using the StructureMap, so option b)</p>",
        "id": 257279944,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1634076787
    },
    {
        "content": "<p>because mapping assertions are meaningful and authors must maintain them, version them, ..<br>\nFor example someone mapping \"gender\" in a LM to Patient: do they map to patient.gender or to the gender identity extension? This mapping really does matter, I think</p>",
        "id": 257280214,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1634076922
    },
    {
        "content": "<p>Thanks to both of you for your prompt responses. I was running into the following SUSHI error when trying to compile the Mapping:</p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">error Unable to find source \"Patient\".</span>\n</code></pre></div>\n<p>Seems that the <code>Source</code> element of the mapping can't reference a base resource? Creating a stub profile of Patient and referencing that instead seems to work.</p>\n<p>As far as using a StructureMap vs. the <code>mapping</code> element of StructureDefinition/ElementDefinition, the former seemed like overkill for my particular use case, at least in my initial review. I'll revisit the documentation and ensure I'm on the right track.</p>",
        "id": 257369622,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1634133498
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"251487\">@Matt Rouhana</span> - I think you would want to create the mappings on the Logical Model.  So your <code>Source:</code> should point to the <code>Logical</code> definition and your destination is the FHIR resource.  You need to describe it in terms of how your model maps to the FHIR resource (not how the FHIR resource maps to your model).</p>\n<p><em>That said</em>, it looks like there is a bug in SUSHI that does not properly allow this.  When I tried a simple example (<a href=\"https://fshschool.org/FSHOnline/#/share/3FGzEMt\">FSHOnline link</a>), SUSHI did not recognize the Logical Model as a valid source.  We will need to fix this in SUSHI.</p>",
        "id": 257381799,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1634137659
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> yeah, I had tried it both ways without any luck. Thanks for looking into it!</p>",
        "id": 257387970,
        "sender_full_name": "Matt Rouhana",
        "timestamp": 1634139888
    },
    {
        "content": "<p>For those who wish to track this change, this is <a href=\"https://github.com/FHIR/sushi/issues/940\">SUSHI#940</a>.</p>",
        "id": 258529891,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1634816704
    },
    {
        "content": "<p>This has been fixed in <a href=\"https://github.com/FHIR/sushi/releases/tag/v2.2.0\">SUSHI 2.2.0</a>.</p>",
        "id": 261308628,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1636750106
    },
    {
        "content": "<p>Hi there. <br>\nI created several Logical Models and want to map them (a) to other LogicalModels and (b) to existing FHIR Resources. Is it possible to set links?<br>\nE.g. for Mappings to RIM, there is a link (<a href=\"http://hl7.org/v3\">http://hl7.org/v3</a>). But for the target of a \"self-made\" mapping, I don't know how to add a link. Is that possible?<br>\nGlad to read your answers.</p>",
        "id": 277119255,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1648633822
    },
    {
        "content": "<p>Or is this for IG creation?</p>",
        "id": 277120667,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1648634575
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"196115\">@Mareike Przysucha</span>.  I see what you mean.  I just did a test project w/ this simple FSH:</p>\n<div class=\"codehilite\"><pre><span></span><code>Logical: PatientLogical\nParent: Element\n* identifier 1..1 SU Identifier &quot;Identifier&quot; &quot;Identifier&quot;\n\nMapping:  PatientLogicalToFhirR4\nSource:   PatientLogical\nTarget:   &quot;http://hl7.org/fhir/R4&quot;\nId:       fhir-r4\nTitle:    &quot;FHIR R4&quot;\n* -&gt; &quot;Patient&quot;\n* identifier -&gt; &quot;Patient.identifier&quot;\n</code></pre></div>\n<p>The resulting StructureDefinition has these top-level mappings:</p>\n<div class=\"codehilite\"><pre><span></span><code>&quot;mapping&quot; : [\n    {\n      &quot;identity&quot; : &quot;rim&quot;,\n      &quot;uri&quot; : &quot;http://hl7.org/v3&quot;,\n      &quot;name&quot; : &quot;RIM Mapping&quot;\n    },\n    {\n      &quot;identity&quot; : &quot;fhir-r4&quot;,\n      &quot;uri&quot; : &quot;http://hl7.org/fhir/R4&quot;,\n      &quot;name&quot; : &quot;FHIR R4&quot;\n    }\n  ]\n</code></pre></div>\n<p>Which get rendered like this:<br>\n<a href=\"/user_uploads/10155/b1AxK9MeDUEO6B2Q1PzhEMox/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/b1AxK9MeDUEO6B2Q1PzhEMox/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/b1AxK9MeDUEO6B2Q1PzhEMox/image.png\"></a></div>",
        "id": 277162953,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1648654407
    },
    {
        "content": "<p>As you can see, there is no difference in the way the JSON mappings are formatted.  The best I can tell is that the IG Publisher must have some special logic that recognizes some mapping URLs (RIM v3) and links them -- but doesn't recognize/link other mapping URLs (FHIR R4?).  This probably is a good question for <a class=\"stream\" data-stream-id=\"179252\" href=\"/#narrow/stream/179252-IG-creation\">#IG creation</a>.</p>",
        "id": 277163132,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1648654494
    },
    {
        "content": "<p>Hi _ I am trying to refer to a locally defined package, still in dev, and not in the  official FHIR package registry. Unless I manually install it into my local .fhir cache, I get an error \"could not be loaded locally or from the FHIR package registry\". Is there a way to get sushi to load this from package from my own url? I tried special urls, it did not help</p>\n<p>parameters:<br>\n  show-inherited-invariants: false<br>\n  special-url:</p>\n<div class=\"codehilite\"><pre><span></span><code>- https://dev.d3ox9vcqia2rpj.amplifyapp.com/site\n</code></pre></div>",
        "id": 277211580,
        "sender_full_name": "Patrick Ryan",
        "timestamp": 1648679413
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"474688\">@Patrick Ryan</span> . Unfortunately, there isn't a way around this - you'll have to manually install the package into your local FHIR cache. SUSHI does not have support built in to download a package from your own URL. SUSHI only looks in your local FHIR cache for packages with version \"dev\" based on the guidance in the IG Publisher Documentation <a href=\"https://confluence.hl7.org/pages/viewpage.action?pageId=35718627#IGPublisherDocumentation-DependencyList\">here</a>.</p>",
        "id": 277294433,
        "sender_full_name": "Julia Afeltra",
        "timestamp": 1648738800
    },
    {
        "content": "<p>It may also be worthwhile to mention that if you build the dev package locally using the IG Publisher, the IG Publisher should put the built dev package into your local FHIR cache for you, which hopefully makes the manual process a little bit easier.</p>",
        "id": 277304101,
        "sender_full_name": "Julia Afeltra",
        "timestamp": 1648742709
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> Thanks for the reply. Once I am back to office, I will raise the issue there.</p>",
        "id": 277314693,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1648747832
    },
    {
        "content": "<p>New to shorthand (JR to FHIR).<br>\nI've defined a new logical structure and it complies just fine with no errors.<br>\nYet when I add an example, SUSHI tells me it's not able to find the InstanceOf (the example is being defined within the same fsh file as the logical structure...</p>\n<p>thanks</p>",
        "id": 277922809,
        "sender_full_name": "Al Pivonka",
        "timestamp": 1649183068
    },
    {
        "content": "<p>I figured it out. I was using logical when I should have been using Resource</p>\n<p>HMM thought I resloved this&gt;&gt;</p>\n<p>warn  <br>\n╭─────────────────────────────────────────────────────────────────╮<br>\n│ Detected the following non-conformant Resource definitions:     │<br>\n│ - QuestionnaireItemSettings                                     │<br>\n│                                                                 │<br>\n│ Resources not in the \"<a href=\"http://hl7.org/fhir/StructureDefinition\">http://hl7.org/fhir/StructureDefinition</a>\"  │<br>\n│ namespace are not conformant to the FHIR specification.         │<br>\n│ These resources are incompatible with standard XML/JSON         │<br>\n│ schemas, public test servers, public registries, standard       │<br>\n│ validation, and standard publication tooling. These resources   │<br>\n│ should not be used for inter-organizational data exchange.      │<br>\n╰─────────────────────────────────────────────────────────────────╯</p>",
        "id": 277925797,
        "sender_full_name": "Al Pivonka",
        "timestamp": 1649184096
    },
    {
        "content": "<p>You can't easily do an instance of a logical model.  There are threads about this but the short answer is that it's a pain and has to be a binary inclusion in your IG</p>",
        "id": 277932158,
        "sender_full_name": "David Pyke",
        "timestamp": 1649186988
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193364\">@Al Pivonka</span> -- <span class=\"user-mention\" data-user-id=\"192587\">@David Pyke</span> is spot on (as usual?).  You <em>cannot</em> create instances of logical models using the <code>Instance:</code> FSH mechanism.  You must create your example as raw JSON or XML and then include it into the project via a special mechanism.  We added support for this workflow in SUSHI 2.2.0.  See the <a href=\"https://github.com/FHIR/sushi/releases/tag/v2.2.0\">SUSHI 2.2.0 Release Notes</a>, and in particular, the section titled <strong>Allow Authors to Provide Instances of Logical Models</strong>.</p>",
        "id": 278019770,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1649250130
    },
    {
        "content": "<p>Thank you.</p>\n<p>I'm an ol-java guy. <br>\nShould I equate:</p>\n<ol>\n<li>\"Resource\" to a Java Object: <strong>able</strong> to be instantiated \"instanceOf\",  </li>\n<li>\"Logical\" to a Java  interface: <strong>not</strong> able to be instantiated?</li>\n</ol>",
        "id": 278020251,
        "sender_full_name": "Al Pivonka",
        "timestamp": 1649250374
    },
    {
        "content": "<p>I might think of <code>Logical</code> more like UML (maybe?).  It's intended more as a design and communication tool; conveying what information is important.  But it's not really intended to be the actual implementation.</p>",
        "id": 278025565,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1649252825
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span>, <br>\nI tried what's written in that part you mentioned before, but I get the following error: <br>\n<code>java.lang.Exception: Bad Resource Identity - should have the format [Type]/[id] where Type is a valid resource type:ZIELPatient/MyZIELPatient</code>.</p>",
        "id": 278032333,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1649255616
    },
    {
        "content": "<p>okay, wait, I'm rerunning with the corrected parameters...</p>",
        "id": 278032727,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1649255768
    },
    {
        "content": "<p>okay, my fault...</p>",
        "id": 278034872,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1649256638
    },
    {
        "content": "<p>By the way: for my former issue (Links in Mappings) I started a channel in <a class=\"stream\" data-stream-id=\"179252\" href=\"/#narrow/stream/179252-IG-creation\">#IG creation</a>.</p>",
        "id": 278518245,
        "sender_full_name": "Mareike Przysucha",
        "timestamp": 1649663231
    }
]