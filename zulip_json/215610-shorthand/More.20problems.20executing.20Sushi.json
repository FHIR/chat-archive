[
    {
        "content": "<p>I've got a wrapper around the IG publisher that runs the IG publisher and manages my workflow for me. Works fine on windows. but on unix systems, the IG publisher can't run sushi when I launch it myself. I suspect it's got something to do with non-interactive shells and not hooking NPM in, but (as always for unix) there is a myriad of proposed solutions, none of which seem like a general solution. <span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> am I making sense, and how would you recommend solving it. (the most general solutions seems to be 'set the BASH_ENV variable' but what do you set it too?)</p>",
        "id": 267686672,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641968761
    },
    {
        "content": "<p>Hmmm... I use Mac (not Linux) and I don't generally have to do anything special, but I'm not running your wrapper either.  That said, the <code>_genonce.sh</code> script is a wrapper of sorts, and it \"just works\".  Is your wrapper a shell script or something else? What is the specific error you get when IG Publisher fails to launch SUSHI?</p>",
        "id": 267722939,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641993830
    },
    {
        "content": "<p>it's not a shell script, it's an exe file. And the error is that fsh is an unknown command.</p>",
        "id": 267756068,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1642007836
    },
    {
        "content": "<p>Do you mean that <code>sushi</code> is an unknown command?  Or is it really saying <code>fsh</code> is an unknown command?  And, pardon my ignorance, but if it is an exe then how are you running it on Linux?</p>",
        "id": 267756865,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1642008120
    },
    {
        "content": "<p>fsh?  not sushi?</p>",
        "id": 267756868,
        "sender_full_name": "David Pyke",
        "timestamp": 1642008121
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- did you get past this?  If it's still a problem, could you provide a little more info (by clarifying some of my questions above)?  And if there is a way to reproduce, that would be cool.</p>",
        "id": 269574569,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1643291666
    },
    {
        "content": "<p>sushi not fsh. I haven't got back to this - too many other problems to look at. It's certainly something to do with a non-interactive shell though</p>",
        "id": 269623602,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1643311211
    },
    {
        "content": "<p>this is now jumped to the very top of my todo list. I've switched to OSX, which is much more traumatic than I expected. grr. But I can't run sushi from eclipse. I can run it from the terminal:</p>",
        "id": 271335098,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644435374
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code> sushi\ninfo  path-to-fsh-defs defaulted to current working directory\ninfo  Running SUSHI v2.2.6 (implements FHIR Shorthand specification v1.2.0)\ninfo  Arguments:\ninfo    /Users/grahamegrieve\n</code></pre></div>",
        "id": 271335130,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644435393
    },
    {
        "content": "<p>but trying to run it from the IG publisher under the debugger gives:</p>",
        "id": 271335163,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644435413
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Sushi couldn&#39;t be run. Complete output from running Sushi :                      (00:00.0025)\nNote: Check that Sushi is installed correctly (&quot;npm install -g fsh-sushi&quot;. On windows, get npm from https://www.npmjs.com/get-npm) (00:00.0025)\nException: Cannot run program &quot;sushi&quot; (in directory &quot;/Users/grahamegrieve/temp/igs/swissnoso&quot;): error=2, No such file or directory (00:00.0025)\nPublishing Content Failed: Cannot run program &quot;sushi&quot; (in directory &quot;/Users/grahamegrieve/temp/igs/swissnoso&quot;): error=2, No such file or directory (00:00.0026)\n</code></pre></div>",
        "id": 271335192,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644435429
    },
    {
        "content": "<p>this presumably is the answer: <a href=\"https://stackoverflow.com/questions/40503074/how-to-run-npm-command-in-java-using-process-builder\">https://stackoverflow.com/questions/40503074/how-to-run-npm-command-in-java-using-process-builder</a></p>",
        "id": 271338135,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644436568
    },
    {
        "content": "<p>answer 2</p>",
        "id": 271338170,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644436582
    },
    {
        "content": "<p>but what should the hardcoded path be?</p>",
        "id": 271338198,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644436596
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I don't have any suggestions for you, but I've got sushi working on my mac. Let me know if there's anything you'd like me to try out.</p>",
        "id": 271355026,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1644444651
    },
    {
        "content": "<p>I don't know how the publisher tries to invoke SUSHI, but if you think answer 2 in the stack overflow article is right, then you can find out where your npm lives by running <code>which npm</code> in your terminal.  E.g., for me it is:</p>\n<p><a href=\"/user_uploads/10155/10OZlhG1ZVcz9W1xKF0ZppuR/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/10OZlhG1ZVcz9W1xKF0ZppuR/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/10OZlhG1ZVcz9W1xKF0ZppuR/image.png\"></a></div><p>... so I would want /Users/cmoesel/.nvm/versions/node/bin` in my env path.  But this is of course very user-specific, so if you're looking for something that will work for everyone, we'd need to find a more robust solution.</p>\n<p>I am using Mac.  Is this something I can easily reproduce?  I've never tried running IGP in Eclipse or a debugger.</p>",
        "id": 271355206,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1644444747
    },
    {
        "content": "<p>hmm <code>which npm</code> gives me /user/local/bin/npm.</p>",
        "id": 271356028,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1644445125
    },
    {
        "content": "<p>Right.  The location is user-specific, depending on how you installed node (and what version).  This is why I said we'd need to find a more robust solution if Grahame needs something that will work for everyone.  On the other hand, if he only needs something that will work for his own personal debugging, this might get him by.</p>",
        "id": 271359199,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1644446886
    },
    {
        "content": "<p>well, it needs to work for anyone who runs the IG publisher from a GUI application, not from terminal</p>",
        "id": 271365233,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644450501
    },
    {
        "content": "<p>and setting environment variables is just crazy hard - if not impossible - on a mac.</p>",
        "id": 271365274,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644450526
    },
    {
        "content": "<p>that is, system wide environment variables that GUI applications can see</p>",
        "id": 271365304,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644450554
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- I think you implied in another thread that you resolved the SUSHI issue.  Is that true?  Or is there still more to be done here?</p>",
        "id": 271461779,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1644512791
    },
    {
        "content": "<p>actually, I did. From the next release, there's a file ~/.fhir/fhir-tool-settings.conf, which in format is a windows ini file. If you put the npm pathway in there, the IG publisher will add that path when running sushi.</p>\n<div class=\"codehilite\" data-code-language=\"INI\"><pre><span></span><code><span class=\"k\">[paths]</span><span class=\"w\"></span>\n<span class=\"na\">npm</span><span class=\"o\">=</span><span class=\"s\">/Users/grahamegrieve/.nvm/versions/node/v17.4.0/bin</span><span class=\"w\"></span>\n<span class=\"na\">ruby</span><span class=\"o\">=</span><span class=\"s\">/Users/grahamegrieve/.gem/ruby/3.1.0/bin:/Users/grahamegrieve/.gem/ruby/3.1.0/bin:/opt/homebrew/opt/ruby/bin:/Users/grahamegrieve/.nvm/versions/node/v17.4.0/bin:/opt/homebrew/bin:/opt/homebrew/sbin</span><span class=\"w\"></span>\n<span class=\"na\">tests</span><span class=\"o\">=</span><span class=\"s\">/Users/grahamegrieve/work/test-cases</span><span class=\"w\"></span>\n<span class=\"na\">compare</span><span class=\"o\">=</span><span class=\"s\">opendiff</span><span class=\"w\"></span>\n<span class=\"na\">temp</span><span class=\"o\">=</span><span class=\"s\">/Users/grahamegrieve/temp</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 271488752,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644524450
    },
    {
        "content": "<p><a href=\"https://confluence.hl7.org/display/FHIR/Using+fhir-tool-settings.conf\">https://confluence.hl7.org/display/FHIR/Using+fhir-tool-settings.conf</a></p>",
        "id": 271504969,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644532291
    },
    {
        "content": "<p>I was suggesting in an earlier thread, it would be nice to allow a flag for location of sushi binary, rather than relying on path resolution for unqualified <code>sushi</code></p>",
        "id": 271859965,
        "sender_full_name": "Nick George",
        "timestamp": 1644859824
    },
    {
        "content": "<p>well i think this is what you were looking for</p>",
        "id": 271870766,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1644864721
    }
]