[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191368\">@Brett Esler</span> looking at the AU Patient profile, the coding is assigned fixed values at system/code level. It's necessary, when you're slicing, to the put the fixed values where the discriminator is stated e.g. pattern with code &amp; system</p>",
        "id": 159979325,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551765408
    },
    {
        "content": "<p>Thanksi <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  so  instead of <strong>Patient.identifier</strong> slice on  <strong>type</strong> would I slice on <strong>type.coding.code</strong> and <strong>type.coding.system</strong>  or is pattern the way to go?  I think we steered away from pattern due to  some of the mixed mandatory and optional elements (text + coding)  but think that issue has gone away with changes. <span class=\"user-mention\" data-user-id=\"191367\">@Brian Postlethwaite</span>  could you comment on the status of pattern validation in the .NET validator?</p>",
        "id": 160035793,
        "sender_full_name": "Brett Esler",
        "timestamp": 1551816527
    },
    {
        "content": "<p>pattern is the right thing to use</p>",
        "id": 160035934,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551816615
    },
    {
        "content": "<p>In the spec, it says that <em>pattern</em> is mostly used with CodeableConcept - the example for <em>value</em> is Patient.telecom.system, which is kinda close to identifier...</p>",
        "id": 160060694,
        "sender_full_name": "David Hay",
        "timestamp": 1551839329
    },
    {
        "content": "<p>well, this slices on both system, which would be value - and type, which would be a pattern</p>",
        "id": 160060717,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551839399
    },
    {
        "content": "<p>That suggests that value is just a subset of pattern... - ie the example given in the spec for <em>value</em> could equally be <em>pattern</em>...</p>",
        "id": 160060878,
        "sender_full_name": "David Hay",
        "timestamp": 1551839626
    },
    {
        "content": "<p>the interpretation is different. It's not really about subset</p>",
        "id": 160060954,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551839711
    },
    {
        "content": "<p>I'll go think about it a bit more :)</p>",
        "id": 160061012,
        "sender_full_name": "David Hay",
        "timestamp": 1551839770
    },
    {
        "content": "<p>So - assuming I wanted to slice Patient.identifier on system, adding a single optional NHI and any number of others, is this the correct discriminator (value)?</p>\n<div class=\"codehilite\"><pre><span></span> &lt;differential&gt;\n    &lt;element id=&quot;Patient.identifier&quot;&gt;\n      &lt;path value=&quot;Patient.identifier&quot; /&gt;\n      &lt;slicing&gt;\n        &lt;discriminator&gt;\n          &lt;type value=&quot;value&quot; /&gt;\n          &lt;path value=&quot;system&quot; /&gt;\n        &lt;/discriminator&gt;\n        &lt;rules value=&quot;open&quot; /&gt;\n      &lt;/slicing&gt;\n    &lt;/element&gt;\n    &lt;element id=&quot;Patient.identifier:NHI&quot;&gt;\n      &lt;path value=&quot;Patient.identifier&quot; /&gt;\n      &lt;sliceName value=&quot;NHI&quot; /&gt;\n      &lt;max value=&quot;1&quot; /&gt;\n    &lt;/element&gt;\n    &lt;element id=&quot;Patient.identifier:NHI.system&quot;&gt;\n      &lt;path value=&quot;Patient.identifier.system&quot; /&gt;\n      &lt;fixedUri value=&quot;https://standards.digital.health.nz/nhi&quot; /&gt;\n    &lt;/element&gt;\n    &lt;element id=&quot;Patient.identifier:Others&quot;&gt;\n      &lt;path value=&quot;Patient.identifier&quot; /&gt;\n      &lt;sliceName value=&quot;Others&quot; /&gt;\n    &lt;/element&gt;\n  &lt;/differential&gt;\n</pre></div>",
        "id": 160062006,
        "sender_full_name": "David Hay",
        "timestamp": 1551841127
    },
    {
        "content": "<p>I think so</p>",
        "id": 160062929,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551842316
    },
    {
        "content": "<p>good oh! btw - I get this error when I build the IG:</p>\n<p>StructureDefinition/nzpatient: StructureDefinition.differential error   No slicing on the root element [element.first().slicing.empty()]</p>\n<p>The profile was generated using Forge...</p>",
        "id": 160063327,
        "sender_full_name": "David Hay",
        "timestamp": 1551842826
    },
    {
        "content": "<p>(from the qa.html file that gets generated...)</p>",
        "id": 160063340,
        "sender_full_name": "David Hay",
        "timestamp": 1551842848
    },
    {
        "content": "<p>aiming for perfection :)</p>",
        "id": 160063342,
        "sender_full_name": "David Hay",
        "timestamp": 1551842860
    },
    {
        "content": "<p>btw - the error goes away if I make a change on an element that appears before identifier (ie language) so I suspect an error with the validator...</p>",
        "id": 160063667,
        "sender_full_name": "David Hay",
        "timestamp": 1551843273
    },
    {
        "content": "<p>put in a base entry</p>\n<p>&lt;element&gt;  &lt;path value=\"Patient\"&gt; &lt;/element&gt;</p>",
        "id": 160065256,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551845433
    },
    {
        "content": "<p>The error isn't with the validator but with the rule defined on the structure definition</p>",
        "id": 160065274,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551845457
    },
    {
        "content": "<p>you make a task for us to sort that</p>",
        "id": 160065284,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551845467
    },
    {
        "content": "<p>does this mean can only discriminate by pattern or value - but not both - some slices by pattern ,some by fixed value?</p>",
        "id": 160066070,
        "sender_full_name": "Brett Esler",
        "timestamp": 1551846642
    },
    {
        "content": "<p>pattern or value is assigned y the discriminator, not the slice</p>",
        "id": 160067454,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551848751
    },
    {
        "content": "<p>I can only really get this to work by having pattern defined on all the slices for type - and slice will not be selected unless the type is set (regardless of system  being a match) - this leads me to mandating 1..1 Patient.identifier.type with a pattern on each slice and Patient.system becomes  not required for a slice match  at all - so effectively every slice needs a type defined and required</p>",
        "id": 160152452,
        "sender_full_name": "Brett Esler",
        "timestamp": 1551916014
    },
    {
        "content": "<p>can not see a way around that</p>",
        "id": 160152463,
        "sender_full_name": "Brett Esler",
        "timestamp": 1551916022
    },
    {
        "content": "<p>it does make the definitions much simpler and easier to understand</p>",
        "id": 160152498,
        "sender_full_name": "Brett Esler",
        "timestamp": 1551916049
    },
    {
        "content": "<blockquote>\n<p>I can only really get this to work by having pattern defined on all the slices for type </p>\n</blockquote>\n<p>why?</p>",
        "id": 160152504,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1551916054
    },
    {
        "content": "<p>if I don't have pattern defined ig builder errors - one tic will commit to show</p>",
        "id": 160152586,
        "sender_full_name": "Brett Esler",
        "timestamp": 1551916103
    },
    {
        "content": "<p>take that back - things look okay ... will report if any other issues...</p>",
        "id": 160152902,
        "sender_full_name": "Brett Esler",
        "timestamp": 1551916422
    }
]