[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> I have updated my FHIR build and the fhir-cda repositories and now I'm unsure how to run the validator to do transforms.   In the past, I pointed the validator at the fhir-cda/resources/structuredefinition to get the CDA logical model, but you removed that directory and now you can't point the validator at just the resources directory because of the directories and other things in there.  Can you clue me in on how you're running the transformations?  thanks.</p>",
        "id": 153968073,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1528476844
    },
    {
        "content": "<p>what did I remove?</p>",
        "id": 153968109,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528488928
    },
    {
        "content": "<p>You moved all of the StructureDefinitions from a resources/structuredefinition to up at the resources level.  i.e. resources/structuredefinition/AD.xml to resources/AD.xml</p>",
        "id": 153968173,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1528499039
    },
    {
        "content": "<p>so now you can't just point the transformer at the resources/structuredefinition directory. <br>\nBasically, i'd like the steps that you are using to run the transformations so I can document them for the task force and others.</p>",
        "id": 153968174,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1528499113
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> any progress on documenting how you ran your transformations so I can progress my stuff?  I also had some issues I sent in an email that I really need help with.  Thanks.</p>",
        "id": 153975059,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1531457566
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> courtesy of a pair of bug fixes, you must delete your local package hl7.fhir.cda-0.0.1 before running the transform next</p>",
        "id": 153978230,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1532588463
    },
    {
        "content": "<p>where would I find that?  i just ran the transformer an it appeared to work</p>",
        "id": 153978367,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1532619220
    },
    {
        "content": "<p>On windows, it's in c:/users/[account]/.fhir/packages</p>",
        "id": 153978421,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1532629228
    },
    {
        "content": "<p>cmon now, you know i don't do windows! :)</p>",
        "id": 153978424,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1532629746
    },
    {
        "content": "<p>but i found it. thanks. :)</p>",
        "id": 153978425,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1532629779
    },
    {
        "content": "<p>I did know.  I trusted you to figure out what the weird Mac-ish equivalent was :)</p>",
        "id": 153978433,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1532630580
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> <a href=\"http://wiki.hl7.org/index.php?title=Using_the_FHIR_Validator_to_transform_content\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=Using_the_FHIR_Validator_to_transform_content\">http://wiki.hl7.org/index.php?title=Using_the_FHIR_Validator_to_transform_content</a></p>",
        "id": 154011234,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540247489
    },
    {
        "content": "<p>That is a good instructions page.  If you are referencing my CCDA to FHIR maps, the URL isn't right.</p>",
        "id": 154011245,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1540248867
    },
    {
        "content": "<p>do you want to fix it?</p>",
        "id": 154011267,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540260297
    },
    {
        "content": "<p>Yep, done.</p>",
        "id": 154011269,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1540260508
    },
    {
        "content": "<p>thanks</p>",
        "id": 154011272,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540261786
    },
    {
        "content": "<p>so how do people got hold of the latest maps if they want to run them?</p>",
        "id": 154011273,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540261809
    },
    {
        "content": "<p>They are on HL7's GitHub.  I included a link in the instructions as well.</p>",
        "id": 154011278,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1540264686
    },
    {
        "content": "<p>great thanks</p>",
        "id": 154011288,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540275793
    },
    {
        "content": "<p>ok, I'm adding a test to the FHIR build to ensure the validator works doing transforms per the documentation, and I'm getting this error:</p>",
        "id": 154011312,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540286734
    },
    {
        "content": "<p>...Failure: No matches found for rule for '<a href=\"http://hl7.org/fhir/cda/StructureDefinition/IVL_TS\" target=\"_blank\" title=\"http://hl7.org/fhir/cda/StructureDefinition/IVL_TS\">http://hl7.org/fhir/cda/StructureDefinition/IVL_TS</a> to dateTime' from <a href=\"http://hl7.org/fhir/cda/mapping/cdaAllergyIntolerance\" target=\"_blank\" title=\"http://hl7.org/fhir/cda/mapping/cdaAllergyIntolerance\">http://hl7.org/fhir/cda/mapping/cdaAllergyIntolerance</a>, from rule 'effectiveTime'</p>",
        "id": 154011313,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540286735
    },
    {
        "content": "<p>is this a known issue?</p>",
        "id": 154011314,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540286743
    },
    {
        "content": "<p>apparently not. I added this:</p>\n<div class=\"codehilite\"><pre><span></span>group for types IVLTSDateTime extends Any\n    input source: IVL_TS as source\n    input target: dateTime as target\n\n    low: for source.low as s then TSDateTime(s, target)\nendgroup\n</pre></div>",
        "id": 154011317,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540287215
    },
    {
        "content": "<p>but this and the IVLTSPeriod look underdone to me, given the complexities of IVL_TS - is this something we should work on?</p>",
        "id": 154011318,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540287245
    },
    {
        "content": "<p>and also, would you like me to convert these to the new format?</p>",
        "id": 154011319,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540287254
    },
    {
        "content": "<p>(I haven't committed anything yet...)</p>",
        "id": 154011320,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540287269
    },
    {
        "content": "<p>The mappings have a bunch of issues that were left unaddressed because we simply ran out of time.    So yes we should work on all of the datatype conversions at some point in time.</p>",
        "id": 154011601,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1540328400
    },
    {
        "content": "<p>hmm. Wayne has asked to me to revisit this work - I guess it's more than a little overdue...</p>",
        "id": 154011620,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1540331483
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"*\">@all</span> I referenced this stream in the FHIR foundation monthly report and forgot it's not public. Can I make it public?</p>",
        "id": 157384080,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549053701
    },
    {
        "content": "<p>Don't see any reason not to, as far as I'm concerned.</p>",
        "id": 157385720,
        "sender_full_name": "Sean McIlvenna",
        "timestamp": 1549055067
    },
    {
        "content": "<p>Fine with me</p>",
        "id": 157390710,
        "sender_full_name": "Rick Geimer",
        "timestamp": 1549059343
    },
    {
        "content": "<p>Let me add some swear words first :)</p>",
        "id": 157390723,
        "sender_full_name": "Rick Geimer",
        "timestamp": 1549059355
    },
    {
        "content": "<p>ok public now</p>",
        "id": 157406976,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1549081978
    },
    {
        "content": "<p>I've seen some references to CCDA to FHIR R5 resources being a focus of the R5 release. Are these the mappings that will be used for that work <a href=\"https://github.com/HL7/ccda-to-fhir/tree/master/mappings\" target=\"_blank\" title=\"https://github.com/HL7/ccda-to-fhir/tree/master/mappings\">https://github.com/HL7/ccda-to-fhir/tree/master/mappings</a>? Are they someplace else? Just looking for a place to start and to see what the current progress is with the work. Thanks!</p>",
        "id": 181649752,
        "sender_full_name": "Joseph Athman",
        "timestamp": 1574437692
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192948\">@Joseph Athman</span>  The latest mapping for C-CDA are here I think: <a href=\"https://github.com/HL7/ccda-to-fhir\" target=\"_blank\" title=\"https://github.com/HL7/ccda-to-fhir\">https://github.com/HL7/ccda-to-fhir</a> <br>\nI'm working on CDA (not CCDA) maps to FHIR, starting from the CCDA maps. I presented the results yesterday at devdays, see <a href=\"https://github.com/ahdis/cda-core-2.0/blob/develop/tutorial.md\" target=\"_blank\" title=\"https://github.com/ahdis/cda-core-2.0/blob/develop/tutorial.md\">https://github.com/ahdis/cda-core-2.0/blob/develop/tutorial.md</a>. I got the feedback that the maps are not yet in R4 syntax, so I will convert them in the next days from STU3 and update them here <a href=\"https://github.com/ahdis/cda-core-2.0/tree/develop\" target=\"_blank\" title=\"https://github.com/ahdis/cda-core-2.0/tree/develop\">https://github.com/ahdis/cda-core-2.0/tree/develop</a>.</p>",
        "id": 181708781,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1574502418
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> thank you. Thatâ€™s very helpful. Is this the same work that <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> discussed at his R5 presentation at DevDays?</p>",
        "id": 181763917,
        "sender_full_name": "Joseph Athman",
        "timestamp": 1574607368
    },
    {
        "content": "<p>I don't know what Lloyd discussed because the tracks were at at same time ...</p>",
        "id": 181764325,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1574608076
    },
    {
        "content": "<p>Yes, I was referring to the CCDA-to-FHIR work.  I wasn't aware of the CDA work - cool :)</p>",
        "id": 181764932,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1574609103
    },
    {
        "content": "<blockquote>\n<p>Yes, I was referring to the CCDA-to-FHIR work.  I wasn't aware of the CDA work - cool :)</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  is this the current CCDA to FHIR work? it just hasn't had any updates in like 18 months, I assumed there would be something newer: <a href=\"https://github.com/HL7/ccda-to-fhir\" target=\"_blank\" title=\"https://github.com/HL7/ccda-to-fhir\">https://github.com/HL7/ccda-to-fhir</a></p>",
        "id": 181867486,
        "sender_full_name": "Joseph Athman",
        "timestamp": 1574718958
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191407\">@Rick Geimer</span></p>",
        "id": 181892363,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1574747120
    },
    {
        "content": "<p>I (IHE) am also very interested in the FHIR R4 version of ccda-on-FHIR</p>",
        "id": 182042727,
        "sender_full_name": "John Moehrke",
        "timestamp": 1574877193
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191410\">@Brett Marquard</span> <span class=\"user-mention\" data-user-id=\"191529\">@Corey Spears</span> <span class=\"user-mention\" data-user-id=\"191407\">@Rick Geimer</span></p>",
        "id": 182042812,
        "sender_full_name": "John Moehrke",
        "timestamp": 1574877243
    },
    {
        "content": "<p>I just converted the c-cda maps to R4, see <a href=\"https://github.com/HL7/ccda-to-fhir/pull/1\" target=\"_blank\" title=\"https://github.com/HL7/ccda-to-fhir/pull/1\">https://github.com/HL7/ccda-to-fhir/pull/1</a>, <span class=\"user-mention\" data-user-id=\"192900\">@Alexander Zautke</span> <span class=\"user-mention\" data-user-id=\"191363\">@Vadim Peretokin</span> can you check the mappings?</p>",
        "id": 182114926,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1574953162
    },
    {
        "content": "<p>We (Lantana) created C-CDA to FHIR transforms under an ONC grant for the Care Plan document type, then later updated them to cover most of C-CDA. However, they are for FHIR STU3. <br>\n<a href=\"https://github.com/lantanagroup/PhCP-Public-Transforms\" target=\"_blank\" title=\"https://github.com/lantanagroup/PhCP-Public-Transforms\">https://github.com/lantanagroup/PhCP-Public-Transforms</a></p>",
        "id": 183205217,
        "sender_full_name": "Rick Geimer",
        "timestamp": 1576100735
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> sorry for the delay, looking into reviewing it now. How are you running the transforms?</p>",
        "id": 183255288,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576155094
    },
    {
        "content": "<p>i'm using the cda core logical model and java jar validator, see steps here: <a href=\"https://github.com/ahdis/cda-core-2.0/tree/develop\" target=\"_blank\" title=\"https://github.com/ahdis/cda-core-2.0/tree/develop\">https://github.com/ahdis/cda-core-2.0/tree/develop</a></p>",
        "id": 183258909,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1576157900
    },
    {
        "content": "<p>i'm in the process of packaging that together, but that's not quite ready</p>",
        "id": 183259011,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1576157998
    },
    {
        "content": "<p>thanks! was doing archeology on zulip and confluence to piece the steps together...</p>",
        "id": 183259098,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576158037
    },
    {
        "content": "<p>So your fork of <code>cda-core-2.0</code> has the PR from <code>ccda-to-fhir</code> already integrated?</p>",
        "id": 183259481,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576158306
    },
    {
        "content": "<p>hm, no, <code>mappings</code> looks healthier.</p>",
        "id": 183260420,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576158701
    },
    {
        "content": "<p>yes that's correct just look at mappings, i used them in the cda-core-2.0 only for inspiration :-)</p>",
        "id": 183260905,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1576159004
    },
    {
        "content": "<p>Do you know what's wrong?</p>\n<div class=\"codehilite\"><pre><span></span>vadi@volga:~/Programs/ccda-to-fhir$ java -jar org.hl7.fhir.validator.jar ../cda-core-2.0/resources/examples/ccda.xml -transform http://hl7.org/fhir/cda/mapping/ClinicalDocumentToFHIR -version 4.0.1 -ig package.tgz -ig mappings -log test.txt -output bundle.xml\nFHIR Validation tool Version 4.1.23-SNAPSHOT (Git# ea7f3a795711). Built 2019-12-12T10:34:18.271+11:00 (14 hours old)\nDetected Java version: 1.8.0_131 from /usr/lib/jvm/java-8-oracle/jre on amd64 (64bit). 3541MB available\nArguments: ../cda-core-2.0/resources/examples/ccda.xml -transform http://hl7.org/fhir/cda/mapping/ClinicalDocumentToFHIR -version 4.0.1 -ig package.tgz -ig mappings -log test.txt -output bundle.xml\nDirectories: Current = /home/vadi/Programs/ccda-to-fhir, Package Cache = /home/vadi/.fhir/packages\n  .. FHIR Version 4.0, definitions from hl7.fhir.r4.core#4.0.1\n  .. connect to tx server @ http://tx.fhir.org\n    (v4.0.1)\n+  .. load IG from package.tgz\n+  .. load IG from mappings\n* load file: CDAtoFHIRTypes.txt - ignored due to error:  (null - NPE)\n* load file: CDAAllergyIntolerance.txt - ignored due to error:  (null - NPE)\n* load file: Bundle.txt - ignored due to error:  (null - NPE)\n* load file: CCDToCDA.txt - ignored due to error:  (null - NPE)\n* load file: ClinicalDocument.txt - ignored due to error:  (null - NPE)\n* load file: DischargeSummaryToCDA.txt - ignored due to error:  (null - NPE)\n* load file: CCDAToFHIR.txt - ignored due to error:  (null - NPE)\n* load file: FHIRtoCDATypes.txt - ignored due to error:  (null - NPE)\nException in thread &quot;main&quot; java.lang.Error: Unable to find map http://hl7.org/fhir/cda/mapping/ClinicalDocumentToFHIR (Known Maps = [http://hl7.org/fhir/StructureMap/supplyrequest-transform, supplyrequest-transform, http://hl7.org/fhir/StructureMap/example|0.1, http://hl7.org/fhir/StructureMap/example, example])\n    at org.hl7.fhir.r5.validation.ValidationEngine.transform(ValidationEngine.java:1228)\n    at org.hl7.fhir.r5.validation.ValidationEngine.transform(ValidationEngine.java:1218)\n    at org.hl7.fhir.r5.validation.Validator.main(Validator.java:592)\nvadi@volga:~/Programs/ccda-to-fhir$ head mappings/ClinicalDocument.map\nmap &quot;http://hl7.org/fhir/cda/mapping/ClinicalDocumentToFHIR&quot; = &quot;CDA Document to FHIR&quot;\n\nuses &quot;http://hl7.org/fhir/cda/StructureDefinition/ClinicalDocument&quot; alias ClinicalDocument as source\nuses &quot;http://hl7.org/fhir/cda/StructureDefinition/AssignedAuthor&quot; alias AssignedAuthor as queried\nuses &quot;http://hl7.org/fhir/cda/StructureDefinition/AssignedEntity&quot; alias AssignedEntity as queried\nuses &quot;http://hl7.org/fhir/cda/StructureDefinition/CustodianOrganization&quot; alias CustodianOrganization as queried\n</pre></div>",
        "id": 183261493,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576159346
    },
    {
        "content": "<p>I do pass it <code>-ig mappings</code> where the map is</p>",
        "id": 183261548,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576159389
    },
    {
        "content": "<p>OK, perhaps the problem is this, hah:</p>\n<div class=\"codehilite\"><pre><span></span>+  .. load IG from mappings\n* load file: CDAtoFHIRTypes.txt - ignored due to error:  (null - NPE)\njava.lang.NullPointerException\n    at org.hl7.fhir.r4.utils.FHIRPathEngine.&lt;init&gt;(FHIRPathEngine.java:251)\n    at org.hl7.fhir.r4.utils.StructureMapUtilities.&lt;init&gt;(StructureMapUtilities.java:253)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadResourceByVersion(ValidationEngine.java:853)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadFileWithErrorChecking(ValidationEngine.java:819)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadIg(ValidationEngine.java:796)\n    at org.hl7.fhir.r5.validation.Validator.main(Validator.java:567)\n* load file: CDAAllergyIntolerance.txt - ignored due to error:  (null - NPE)\njava.lang.NullPointerException\n    at org.hl7.fhir.r4.utils.FHIRPathEngine.&lt;init&gt;(FHIRPathEngine.java:251)\n    at org.hl7.fhir.r4.utils.StructureMapUtilities.&lt;init&gt;(StructureMapUtilities.java:253)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadResourceByVersion(ValidationEngine.java:853)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadFileWithErrorChecking(ValidationEngine.java:819)\n    at org.hl7.fhir.r5.validation.ValidationEngine.loadIg(ValidationEngine.java:796)\n    at org.hl7.fhir.r5.validation.Validator.main(Validator.java:567)\n* load file: Bundle.txt - ignored due to error:  (null - NPE)\n</pre></div>\n\n\n<p>It thinks mappings files are .txt (maybe unrelated) and is failing to load them.</p>",
        "id": 183261907,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576159626
    },
    {
        "content": "<p>Should have used your build to begin with :) it gets further.</p>",
        "id": 183262267,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576159872
    },
    {
        "content": "<p>yes you need to use the jar version, sorry i was as assuming that you run the maps through your infrastructure</p>",
        "id": 183263454,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1576160662
    },
    {
        "content": "<p>... the jar version available in <a href=\"https://github.com/ahdis/cda-core-2.0/releases\" target=\"_blank\" title=\"https://github.com/ahdis/cda-core-2.0/releases\">https://github.com/ahdis/cda-core-2.0/releases</a></p>",
        "id": 183263494,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1576160699
    },
    {
        "content": "<blockquote>\n<p>No matches found for rule for '<a href=\"http://hl7.org/fhir/cda/StructureDefinition/IVL_TS\" target=\"_blank\" title=\"http://hl7.org/fhir/cda/StructureDefinition/IVL_TS\">http://hl7.org/fhir/cda/StructureDefinition/IVL_TS</a> to dateTime'</p>\n</blockquote>\n<p>is that expected? A quick scan only revealed IVL_TS to period, not dateTime</p>",
        "id": 183264356,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576161326
    },
    {
        "content": "<p>Eh, I see now why it shouldn't work, all good :)</p>",
        "id": 183265107,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1576161813
    }
]