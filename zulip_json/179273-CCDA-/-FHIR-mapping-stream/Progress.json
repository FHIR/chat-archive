[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> I'm home and recovering from the WGM, and actually working now.... where are we with this?</p>",
        "id": 153963805,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526853530
    },
    {
        "content": "<p>The most important things are:<br>\n1) CDA.Narrative to/from FHIR.xhtml<br>\n2) ConceptMap translations - could be my syntax<br>\n3) getting my source where condition clauses working right</p>\n<p>For #3, see above where I give you my mapping that isn't working<br>\nFor #2, you think I'm using them the \"wrong way around\", so I'd need to know what I'm doing wrong<br>\nAnd #1 needs to be done but I'm now not sure that it should be done in code.</p>",
        "id": 153963806,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1526854412
    },
    {
        "content": "<p>#1 - ok why not in code?</p>",
        "id": 153963807,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526854649
    },
    {
        "content": "<p>#2 - the translations are unidirectional - from FHIR to CDA. but you're invoking them as if they are from CDA to FHIR</p>",
        "id": 153963808,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526854676
    },
    {
        "content": "<p>#3 - the conditions work for me but they have to start with a variable name</p>",
        "id": 153963809,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526854705
    },
    {
        "content": "<p>okay, for #2 - I guess we (and when I say we, I probably mean my team) need to create the CDA-&gt;FHIR mappings?</p>",
        "id": 153963810,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1526855024
    },
    {
        "content": "<p>#3 - I do have variable names.  see above to see what I've done</p>",
        "id": 153963811,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1526855037
    },
    {
        "content": "<p>#2 yes, for now.  guess we should normalise this into the spec?</p>",
        "id": 153963812,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526855064
    },
    {
        "content": "<p>#1 - the mapping language and the maps are, right now, tool agnostic.  anyone can potentially write a mapping engine and then execute any maps.  that seems to me to argue that all maps should be done via map files and not be built-in to any tool.  basically, if you write the narrative text transform into the validator code, then anyone else who wants to build a mapping engine is going to have to replicate that code in their engine.</p>",
        "id": 153963813,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1526855183
    },
    {
        "content": "<p>thus whatever you write in code needs to be totally documented so that others can replicate it.  wouldn't the best way to document that be via a mapping file?</p>",
        "id": 153963814,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1526855222
    },
    {
        "content": "<p>well, it would sure be the most comprehensive mapping. but is is the most effective? That I'm not sure about. Here's what we have for mapping at the moment:</p>",
        "id": 153963924,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526937158
    },
    {
        "content": "<p><a href=\"http://wiki.hl7.org/index.php?title=CDA_Narrative_to_html_mapping\" target=\"_blank\" title=\"http://wiki.hl7.org/index.php?title=CDA_Narrative_to_html_mapping\">http://wiki.hl7.org/index.php?title=CDA_Narrative_to_html_mapping</a></p>",
        "id": 153963925,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526937197
    },
    {
        "content": "<p>i would hope that others would chime in on this.</p>",
        "id": 153963951,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1526943321
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191407\">@Rick Geimer</span> volunteered to look at it.</p>",
        "id": 153963952,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526943364
    },
    {
        "content": "<p>i looked at it and updated it a bit.  it's not the mapping itself but rather whether this should be done in code or external that I'd love more than you and I to decide.</p>",
        "id": 153963957,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1526943592
    },
    {
        "content": "<p>thinking more about it... the problem with doing it in the mapping is that then I have to  work up models for both xhtml and Struc.TExt</p>",
        "id": 153964060,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526991248
    },
    {
        "content": "<p>that sounds like a heavy lift and is outside what I expected to do in the short term</p>",
        "id": 153964080,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1526992770
    },
    {
        "content": "<p><a href=\"https://build.fhir.org/ig/HL7/fhir-cda/\" target=\"_blank\" title=\"https://build.fhir.org/ig/HL7/fhir-cda/\">https://build.fhir.org/ig/HL7/fhir-cda/</a></p>",
        "id": 153964113,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1527007581
    },
    {
        "content": "<p>that's nice.</p>",
        "id": 153964117,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1527008209
    },
    {
        "content": "<p>could be made very nice if someone wanted to. e.g. could replace the existing CDA guide - start with the RMIM and all. Just a matter of how much someone wants to invest</p>",
        "id": 153964121,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1527010734
    },
    {
        "content": "<p>And any progress on Narrative &lt;-&gt; XHTML?</p>",
        "id": 153965443,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1527655096
    },
    {
        "content": "<p>so looking at the wiki page...</p>",
        "id": 153966650,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528100001
    },
    {
        "content": "<p>what</p>",
        "id": 153966651,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528100014
    },
    {
        "content": "<p>what's the right thing to happen with referencedObject?</p>",
        "id": 153966652,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528100022
    },
    {
        "content": "<p>hey Jean - one of your test documents has this in it:</p>",
        "id": 153966825,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528159653
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>                        &lt;substanceAdministration classCode=&quot;SBADM&quot; moodCode=&quot;INT&quot;&gt;\n                            &lt;templateId root=&quot;2.16.840.1.113883.10.20.22.4.16&quot;/&gt;\n                            &lt;id root=&quot;a0e312da-2007-4f4b-b8ed-3973e93b948d&quot;/&gt;\n                            &lt;text&gt;\n                                &lt;reference value=&quot;#medication920000875889&quot;/&gt;\n                            &lt;/text&gt;\n                            &lt;comments&gt;\n                                &lt;reference value=&quot;#medcommentsmedication920000875889&quot;/&gt;\n                            &lt;/comments&gt;\n</pre></div>",
        "id": 153966826,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528159655
    },
    {
        "content": "<p>I don't recognise the comments element?</p>",
        "id": 153966827,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528159667
    },
    {
        "content": "<p>.. I'm doing round trip testing on the CDA documents...</p>",
        "id": 153966828,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528159804
    },
    {
        "content": "<p>ok. committed. Round-tripping CDA -&gt; logical model -&gt; CDA looks good to me (attributes get re-ordered, of course, but everything is preserved that is valid CDA). That means that CDA narrative will not map correctly.</p>",
        "id": 153966856,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528170712
    },
    {
        "content": "<p>the way the FHIR framework works, doing the mapping by the mapping language is actually very difficult; it's not about the mapping language, but about the way StructureDefinition has been set up to handle CDA narrative - we effectively already decided that it would be converted by magic.</p>",
        "id": 153966857,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528170777
    },
    {
        "content": "<p>but the code is actually pretty simple, since there's no context to carry around (yet!):</p>",
        "id": 153966858,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528170791
    },
    {
        "content": "<p><a href=\"https://gforge.hl7.org/svn/fhir/trunk/build/implementations/java/org.hl7.fhir.utilities/src/org/hl7/fhir/utilities/xhtml/CDANarrativeFormat.java\" target=\"_blank\" title=\"https://gforge.hl7.org/svn/fhir/trunk/build/implementations/java/org.hl7.fhir.utilities/src/org/hl7/fhir/utilities/xhtml/CDANarrativeFormat.java\">https://gforge.hl7.org/svn/fhir/trunk/build/implementations/java/org.hl7.fhir.utilities/src/org/hl7/fhir/utilities/xhtml/CDANarrativeFormat.java</a></p>",
        "id": 153966860,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528171090
    },
    {
        "content": "<p>by product of testing out the CDA round-tripping: CDA in Json....</p>",
        "id": 153966869,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528174104
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/ZxrnDFd08NFRr_tLvRPs4gWF/testdocuments.zip\" target=\"_blank\" title=\"testdocuments.zip\">testdocuments.zip</a></p>",
        "id": 153966870,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528174174
    },
    {
        "content": "<p>what is this?</p>\n<div class=\"codehilite\"><pre><span></span>              <span class=\"nt\">&lt;doseQuantity/&gt;</span>\n              <span class=\"nt\">&lt;doseQuantity</span> <span class=\"na\">unit=</span><span class=\"s\">&quot;Tablet(s)&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span><span class=\"nt\">/&gt;</span>\n              <span class=\"nt\">&lt;doseQuantity</span> <span class=\"na\">unit=</span><span class=\"s\">&quot;MG&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;300-30&quot;</span><span class=\"nt\">/&gt;</span>\n</pre></div>",
        "id": 153966875,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528174523
    },
    {
        "content": "<p>in what world is that valid?</p>",
        "id": 153966876,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528174563
    },
    {
        "content": "<p>we can have RDF CDA documents too ;-)</p>",
        "id": 153966878,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528175029
    },
    {
        "content": "<p><a href=\"/user_uploads/10155/gnc-WAAnIaBGm1hSuER2w0Sc/testdocuments.zip\" target=\"_blank\" title=\"testdocuments.zip\">testdocuments.zip</a></p>",
        "id": 153966879,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528175036
    },
    {
        "content": "<p>though the only thing that shows is that RDf is pretty much the worst way to say anything useful</p>",
        "id": 153966880,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528175082
    },
    {
        "content": "<p>btw, the CDA Implementation guide - as opposed to the CCDA on FHIR implementation guide... needs some love. We kind of need to figure out how far we want to take it... if we really wanted to, it could replace the CDA spec (R2.1, I guess....) . We probably don't want to... but we need to base artifact, so we need to decided how much to do with it</p>",
        "id": 153967264,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1528261309
    }
]