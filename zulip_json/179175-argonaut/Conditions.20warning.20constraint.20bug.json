[
    {
        "content": "<p>Hello, I think there's a bug in the UsCoreCondition warning constraint:<br>\n<code>where(category.memberOf('http://hl7.org/fhir/us/core/ValueSet/us-core-condition-category')).exists()</code></p>\n<p>AFAIKT, memberOf is not defined for repeated fields.</p>\n<p>Should this instead be<br>\n<code>category.where(memberOf('http://hl7.org/fhir/us/core/ValueSet/us-core-condition-category')).exists()</code><br>\n?</p>",
        "id": 273902879,
        "sender_full_name": "Nick George",
        "timestamp": 1646267776
    },
    {
        "content": "<p>@GG ? or any other FHIR path wizards can you confirm?</p>",
        "id": 273993223,
        "sender_full_name": "Eric Haas",
        "timestamp": 1646323021
    },
    {
        "content": "<p>from <a href=\"https://hl7.org/fhirpath/#functions\">https://hl7.org/fhirpath/#functions</a></p>\n<blockquote>\n<p>With a few minor exceptions (e.g. the today() function), functions in FHIRPath always operate on a collection of values (referred to as the input collection) and produce another collection as output (referred to as the output collection), even though these may be collections of just a single item.</p>\n</blockquote>",
        "id": 274037654,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1646340598
    },
    {
        "content": "<p>but i'm not actually sure if that applies here or not.  i've always been confused about when you need a .where and when you dont</p>",
        "id": 274038298,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1646340884
    },
    {
        "content": "<p>FWIW, I checked our implementation and our memberOf function wants a singleton input collection as well, so I think nick is right that <code>category.where(memberOf('http://hl7.org/fhir/us/core/ValueSet/us-core-condition-category')).exists()</code> would be the better option. <br>\nwould still be interested in hearing confirmation that this is \"correct\" though</p>",
        "id": 274041065,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1646342109
    },
    {
        "content": "<p>If we assume that <code>category.memberOf</code> returns a collection, it would presumably be like <code>{true, false, false}</code>.... I still think <br>\n<code>where({true, false, false})</code><br>\nwould be invalid?  I.e., the arg to where should be a condition to evaluate per element, not a collection of bools, IIUC</p>",
        "id": 274043275,
        "sender_full_name": "Nick George",
        "timestamp": 1646343103
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 274058340,
        "sender_full_name": "Nick George",
        "timestamp": 1646351499
    },
    {
        "content": "<p>Should I file this as an issue in Jira?  pull request in github?  sorry, haven't contributed much to US core yet...</p>",
        "id": 274423356,
        "sender_full_name": "Nick George",
        "timestamp": 1646672906
    },
    {
        "content": "<p>Jira tracker please</p>",
        "id": 274428430,
        "sender_full_name": "Eric Haas",
        "timestamp": 1646674746
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"196561\">@Nick George</span> did you ever open an issue for this one?  I re-raised it at <a href=\"#narrow/stream/179266-fhirpath/topic/do.20all.20functions.20work.20on.20repeating.20fields.3F\">https://chat.fhir.org/#narrow/stream/179266-fhirpath/topic/do.20all.20functions.20work.20on.20repeating.20fields.3F</a> but didn't open anything yet (for either \"what should functions do by default when its not specified what to do for an input collection\" or for this particular expression)</p>",
        "id": 275545573,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1647450637
    },
    {
        "content": "<p>I was reminded of it because I found another US Core expression with a similar issue (provenance-1)...I did open an issue for that one</p>",
        "id": 275545686,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1647450674
    },
    {
        "content": "<p>please log a tracker</p>",
        "id": 275689384,
        "sender_full_name": "Eric Haas",
        "timestamp": 1647535503
    },
    {
        "content": "<p><a href=\"http://jira.hl7.org/browse/FHIR-36328\">FHIR-36328</a> is the one I had opened for that provenance-1 issue.</p>\n<p>Now I submitted <a href=\"http://jira.hl7.org/browse/FHIR-36336\">FHIR-36336</a> for this Condition one, but I accidentally hit submit before finishing the title.  should be \"Problematic fhirpath in Condition Profile constraint us-core-1\"</p>",
        "id": 275707493,
        "sender_full_name": "Lee Surprenant",
        "timestamp": 1647542448
    }
]