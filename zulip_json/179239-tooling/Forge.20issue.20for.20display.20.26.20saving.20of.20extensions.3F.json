[
    {
        "content": "<p>I was trying to view the <a href=\"http://www.hl7.org/fhir/uv/ips/STU1/StructureDefinition-MedicationStatement-uv-ips.html\">STU1 IPS MedicationStatement profile</a> in Forge and noticed something strange. Somehow, the data-absent-reason extension on the <code>effective[x]</code> element was being displayed at the top level.</p>\n<p><a href=\"/user_uploads/10155/iydhPxIwprezqrO4VYrvu3wl/Screenshot-2021-03-09-at-14.01.24.png\">Screenshot-2021-03-09-at-14.01.24.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/iydhPxIwprezqrO4VYrvu3wl/Screenshot-2021-03-09-at-14.01.24.png\" title=\"Screenshot-2021-03-09-at-14.01.24.png\"><img src=\"/user_uploads/10155/iydhPxIwprezqrO4VYrvu3wl/Screenshot-2021-03-09-at-14.01.24.png\"></a></div><p>In <code>StructureDefinition.differential</code>, this extension is declared like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;id&quot;: &quot;MedicationStatement.effective[x].extension&quot;,\n    &quot;path&quot;: &quot;MedicationStatement.effective[x].extension&quot;,\n    &quot;short&quot;: &quot;effective[x] absence reason&quot;,\n    &quot;definition&quot;: &quot;Provides a reason why the effectiveTime is missing.&quot;,\n    &quot;max&quot;: &quot;1&quot;,\n    &quot;type&quot;: [{\n        &quot;code&quot;: &quot;Extension&quot;,\n        &quot;profile&quot;: [\n            &quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;\n         ]\n     }],\n    &quot;mustSupport&quot;: true\n}\n</code></pre></div>\n<p>What is more,  if I made a change and saved it (I have saving snapshots option on), the extension would completely disappear from the StructureDefinition (snapshot &amp; diff)! <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> is this a known issue?</p>",
        "id": 229473826,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1615295641
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"194703\">@Morten Ernebjerg</span> ,<br>\nThank  you for pointing this out. When a StructureDefinition contains an extension on a variant (e.g. Observation.value[x]), this extension is not correctly processed by the SnapshotGenerator. It is moved to the observation's root 'extension' element definitions, while it would be expected to remain in the Observation.value[x].extension element definitions. Forge previously did not support extensions on variants; that's why this problem probably never popped up before. <br>\nWe first need to resolve this issue in the .NET SDK: <a href=\"https://github.com/FirelyTeam/firely-net-sdk/issues/1619\">https://github.com/FirelyTeam/firely-net-sdk/issues/1619</a>. After this is implemented we expect this to be implemented in Forge in one of the upcoming sprints. We can keep you posted on the progress if you like?</p>",
        "id": 229644702,
        "sender_full_name": "Matthijs van der Wielen",
        "timestamp": 1615377707
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"259036\">@Matthijs van der Wielen</span> Thanks for the update, would be great if you could keep me posted!</p>",
        "id": 229692390,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1615392882
    }
]