[
    {
        "content": "<p>Not sure where to post this, since it may impact IG tooling , templates, and sushi and other tools- <br>\nIn order to prepare for eventual support for multiple versions of assets, should we have a file naming convention?</p>",
        "id": 189048078,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582656229
    },
    {
        "content": "<p>I.e. if I have a patient id=001, which has versions 0, 1 and 2, I need to store the jsons somewhere in my file system, and I don't want then all to be called patient-001.json.<br>\nhow about patient-001#0.json, patient-001#1.json, patient-001#2.json ?</p>",
        "id": 189048323,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582656367
    },
    {
        "content": "<p>Are Windows, Mac and Unix file systems comfortable with '#' in a filename?  (It'd be super surprising to me if any were, let alone all of them.)</p>",
        "id": 189049546,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582657244
    },
    {
        "content": "<p>windows is</p>",
        "id": 189049626,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582657305
    },
    {
        "content": "<p>linux is</p>",
        "id": 189049842,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582657440
    },
    {
        "content": "<p>and mac is unix, so I expect it to be as well</p>",
        "id": 189049909,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582657462
    },
    {
        "content": "<p>(the fhir package cache uses that notation also to support versions)</p>",
        "id": 189049959,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582657495
    },
    {
        "content": "<p>it will be an issue in a url, i think. but i'm not sure that matters - or any other idea?</p>",
        "id": 189050314,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582657742
    },
    {
        "content": "<p><code>#</code> is ok on windows|unix|mac. But the tooling isn't ok with it anywhere</p>",
        "id": 189053252,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582659748
    },
    {
        "content": "<p>i understand no  tooling supports it yet. But if we have an agreement on this then tooling can evolve to that</p>",
        "id": 189056933,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582661948
    },
    {
        "content": "<blockquote>\n<p>The problem is we often have URLs that point to stuff inside a file - and the syntax for that uses '#'</p>\n</blockquote>\n<p>(<span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> i presume you meant to post here)<br>\nok I can see an issue if we want to download a file called patient001#001.json</p>",
        "id": 189061244,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582664847
    },
    {
        "content": "<p>I don't know what OS support is for <code>|</code> -- but using that as a version separator would be consistent w/ <code>canonical</code> and has the advantage of not being mistaken as a URL fragment identifier.  The downside is that it's considered an \"unsafe\" character in URLs, so must be escaped in that context.</p>",
        "id": 189061279,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1582664882
    },
    {
        "content": "<p>so neither of these work in urls.</p>",
        "id": 189061408,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582664959
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span> Sorry if I miss the backstory, but is there an important use for multiple version of the same resource in one project/folder/ig/package? If these are different versions of the resource corresponding to different versions of a project/ig/package I guess they could just live in different branches or folders?</p>",
        "id": 189099797,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1582711114
    },
    {
        "content": "<p>Hi. Yes, this is needed for anything that is providing guidance on workflows or dynamic behaviour (whether it is important or not, depends on where you stand).<br>\nExample: CarePlan001 has a first version with status Draft, then have an update with different status. At this moment I cnnot create those in an IG, like I would have on a server.</p>",
        "id": 189115362,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582725362
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span>, so these versions reflect the example instance as it would be in different stages of the workflow. Then they indeed need to be in the same project/ig/package, it's not a <code>|</code> versioning situation.</p>",
        "id": 189116317,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1582725972
    },
    {
        "content": "<p>the # and the | (I think I prefer the # ) is just the file name. If they are all called CarePlan001, it does not work on a file system</p>",
        "id": 189117169,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582726568
    },
    {
        "content": "<p>an alternative:<br>\nwe could use the / as separator</p>",
        "id": 189117226,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582726584
    },
    {
        "content": "<p>or abandon hope of maintaining human understandable filenames. The goal is laudable, but you will notice in systems like google drive and confluence and others; there comes a point when everything breaks down and GUIDs are used... preferring external (or internal) means to take over</p>",
        "id": 189118457,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582727321
    },
    {
        "content": "<p>the problem still applies if we use uuid - at least in the file name if the filename is the same as the identifier</p>",
        "id": 189118633,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582727421
    },
    {
        "content": "<p>you can have careteam \"a2b8555d-622e-43f2-8412-baf0e22bb050.json\" but you need two versions, and those two files cannot be called \"a2b8555d-622e-43f2-8412-baf0e22bb050.json\"</p>",
        "id": 189118730,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582727504
    },
    {
        "content": "<p>exactly correct. both would be different guids, from the filename perspective there is no relationship. The relationship is only internally as part of the FHIR model, or externally as part of your test scenario</p>",
        "id": 189118880,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582727594
    },
    {
        "content": "<p>so as an alternative we could have something like:<br>\n|  resourceid  | version  | filename  |<br>\n| careteam001  | v0  |  a2b8555d-622e-43f2-8412-baf0e22bb050.json |<br>\n| careteam001  | v1  |  825d4a5c-56c7-4a0e-ade6-a2e6ee28f699.json |<br>\n| careteam001  | v2  |  7762306b-c276-4049-a4d1-54abb3a28893.json |</p>",
        "id": 189119163,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582727767
    },
    {
        "content": "<p>this?</p>",
        "id": 189119201,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582727788
    },
    {
        "content": "<p>not saying I like it.. Just noting that many web tools try to maintain human readable filenames, but get to a point where they totally breakdown and become completely opaque. So, just setting the stage that we might not be able to invent what many others have tried to invent and failed.</p>",
        "id": 189119334,
        "sender_full_name": "John Moehrke",
        "timestamp": 1582727882
    },
    {
        "content": "<p>we do use # so far, it works where we need it to work</p>",
        "id": 189120140,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1582728326
    },
    {
        "content": "<p>the point is that that the tools already allow you to vary the file name in the input, but are completely driven by resource id internally, and so are unable to manage having 2 different instances of the same thing. This applies to all internal reasoning, and also to to the way that the web output is generated.</p>",
        "id": 189135579,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582737576
    },
    {
        "content": "<p>trying to change that is pulling the logical carpet from under everything I've ever done</p>",
        "id": 189135602,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582737590
    },
    {
        "content": "<p>It would be useful to have multiple versions of the same instance for examples.  I believe the tooling <em>can</em> handle that when the content is inside a Bundle.  Perhaps we could find a way to drive the publication of multiple instances from within a Bundle?</p>",
        "id": 189140212,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1582740319
    },
    {
        "content": "<p>Should \"resource#v1\" be acceptable as an identifier.value?</p>",
        "id": 189700972,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583335114
    },
    {
        "content": "<p>Identifier.value is a string.  So long as it's less than a megabyte, it can contain any combination of UTF-8 characters you like.</p>",
        "id": 189713243,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1583342273
    },
    {
        "content": "<p>Consumers will treat it as a string though - no one will recognize or parse the #v1 as having any meaning and it would be bad practice to require systems to do so.</p>",
        "id": 189713315,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1583342308
    },
    {
        "content": "<p>when I tried it, the IG Publisher was giving me a \"....must be a valid identifier...\"</p>",
        "id": 189715920,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583343935
    },
    {
        "content": "<p>and a correction: I actually had \"resource#1\", not \"resource#v1\"</p>",
        "id": 189716083,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583344034
    },
    {
        "content": "<p>I'm just looking for a consistent / sensible way to represent resource versions. If the tools do not support it yet, that is OK. <br>\nBut if we have one syntax, then the tools can catch up (if the toolsmiths want).</p>",
        "id": 189716224,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583344117
    },
    {
        "content": "<p>If you're pointing to resources, you ought to be using Reference, not Identifier</p>",
        "id": 189716779,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1583344428
    },
    {
        "content": "<p>in the ig.xml?</p>",
        "id": 189718128,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583345217
    },
    {
        "content": "<p>the issue I had was when I told the IG that the resource was found like this:<br>\n      &lt;reference&gt;<br>\n         &lt;reference value=\"CareTeam/dzop-team-0002#2\"/&gt;<br>\n      &lt;/reference&gt;</p>",
        "id": 189718195,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583345256
    },
    {
        "content": "<p>You said identifier.value.  What you're showing now is reference.value.  reference.value is appropriate.  Right now, the IGPublisher doesn't support version-specific references.  There's an expectation that there's only one version of each resource instance in-scope for the publication process.  Changing that will involve a significant refactoring of the publisher.</p>",
        "id": 189723730,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1583348704
    },
    {
        "content": "<p>Yes, I understand that, and that was why I put identifier instead of reference:<br>\nI wanted to get around this issue by actually creating different resources with different identifiers and filenames, but where those names would have a syntax like resource#version.<br>\nThe file system is ok with that name, but the IG publisher is not happy with having a resource with a '#'.<br>\n(which to me may mean it's a version but for the IG it should be a completely independent resource)</p>",
        "id": 189724297,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583349087
    },
    {
        "content": "<blockquote>\n<p>....must be a valid identifier...</p>\n</blockquote>\n<p>What's the exact error? I gt no matches for that text in the code</p>",
        "id": 189725613,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583349938
    },
    {
        "content": "<p>I just had a resource called  dzop-team-002.v0 (filename and id) and it worked</p>",
        "id": 189726555,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583350519
    },
    {
        "content": "<p>now I renamed it to dzop-team-002#0 - changed the filename, the id, also changed the reference in the IG:</p>\n<div class=\"codehilite\"><pre><span></span>    <span class=\"nt\">&lt;resource&gt;</span>\n      <span class=\"nt\">&lt;reference&gt;</span>\n         <span class=\"nt\">&lt;reference</span> <span class=\"na\">value=</span><span class=\"s\">&quot;CareTeam/dzop-team-0002#0&quot;</span><span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;/reference&gt;</span>\n</pre></div>",
        "id": 189726673,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583350585
    },
    {
        "content": "<p>now I get</p>\n<div class=\"codehilite\"><pre><span></span>Load Content                                                                     (00:25.0276)\nPublishing Content Failed: Bad Source Reference &#39;CareTeam/dzop-team-0002#0&#39; - should have the format [Type]/[id] where id is a valid FHIR id type (00:27.0435)\n                                                                                 (00:27.0446)\nUse -? to get command line help                                                  (00:27.0449)\n                                                                                 (00:27.0450)\nStack Dump (for debugging):                                                      (00:27.0469)\njava.lang.Exception: Bad Source Reference &#39;CareTeam/dzop-team-0002#0&#39; - should have the format [Type]/[id] where id is a valid FHIR id type\n        at org.hl7.fhir.igtools.publisher.SimpleFetcher.fetch(SimpleFetcher.java:181)\n        at org.hl7.fhir.igtools.publisher.Publisher.load(Publisher.java:2683)\n        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:801)\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:666)\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6933)\n</pre></div>",
        "id": 189726685,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583350600
    },
    {
        "content": "<p>ok. that's the right message. it's from the publisher enforcing it's internal business rules</p>",
        "id": 189728626,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583351788
    },
    {
        "content": "<p>'cause # is not valid in an id?</p>",
        "id": 189731224,
        "sender_full_name": "David Hay",
        "timestamp": 1583353352
    },
    {
        "content": "<p>right</p>",
        "id": 189731927,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1583353830
    },
    {
        "content": "<p>just a thought: if # is not a valid id, can we use just that to signal the versions? in other words:<br>\nwould it make sense to use it as a convention to name versions, and prepare the tooling to (gracefully) reject those ids, and eventually as tools catch up (if ever) then we keep the same convention?</p>",
        "id": 190198582,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1583860164
    }
]