[
    {
        "content": "<p>When using firely terminal (2.5.0-beta-7) install on a file, Firely Terminal seems to bake the whole cache?</p>\n<div class=\"codehilite\"><pre><span></span><code>fhir install packages/molit.fhir.common-terminology-0.2.0.tgz --file\nAdded: molit.fhir.common-terminology 0.2.0.\nBaked de.basisprofil.r4@1.2.0.\nBaked hl7.fhir.r4.core@4.0.1.\nBaked de.gematik.isik-basismodul@1.0.3-alpha1.\nBaked kbv.mio.ueberleitungsbogen@1.0.0-kommentierung.\nBaked kbv.basis@1.2.0.\nBaked molit.fhir.common-terminology@0.2.0.\nRestore completed.\n</code></pre></div>\n<p>fyi: <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span></p>",
        "id": 271423763,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644496012
    },
    {
        "content": "<p>did not know that what you can bake with <img alt=\":fhir:\" class=\"emoji\" src=\"https://zulip-avatars.s3.amazonaws.com/10155/emoji/images/1.png\" title=\"fhir\"> , but cool name for creating snaphshots <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span> , is baking <a href=\"mailto:hl7.fhir.r4.core@4.0.1\">hl7.fhir.r4.core@4.0.1</a>. not dangerous?</p>",
        "id": 271425115,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1644496882
    },
    {
        "content": "<p>yes the bake command is quite new, install now also bakes by default</p>",
        "id": 271429013,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644499103
    },
    {
        "content": "<p>hl7.fhir.r4.core is already containing snapshots, so yes it is dangerous.</p>",
        "id": 271429065,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644499133
    },
    {
        "content": "<p>Bake keeps track, so it doesn't bake twice. But it does by default (try to) bake all dependencies on a new install</p>",
        "id": 271437775,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1644503055
    },
    {
        "content": "<p>so, no good for \"twice baked potatoes\"...</p>",
        "id": 271438156,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644503228
    },
    {
        "content": "<p>We could do a</p>\n<div class=\"codehilite\"><pre><span></span><code>&gt;  fhir bake --potato-style\n</code></pre></div>",
        "id": 271448241,
        "sender_full_name": "Martijn Harthoorn",
        "timestamp": 1644507350
    },
    {
        "content": "<p>propose that for an April 1st release</p>",
        "id": 271448790,
        "sender_full_name": "John Moehrke",
        "timestamp": 1644507573
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> is right though.  It probably shouldn't overwrite snapshots in packages that are shipped w/ the snapshots already (e.g., packages published by HL7), right?</p>",
        "id": 271449324,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1644507798
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> Are you sure this is the whole cache and not only packages within the scope (your installed packages, its dependencies and their dependencies)?</p>",
        "id": 271449546,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1644507888
    },
    {
        "content": "<p>I'm not sure if there's already a common way to indicate that a package has been baked/has snapshots for all its resources.</p>",
        "id": 271449665,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1644507947
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"203235\">Ward Weistra</span> <a href=\"#narrow/stream/179239-tooling/topic/Firely.20Terminal.3A.20install.20bakes.20everything/near/271449665\">said</a>:</p>\n<blockquote>\n<p>I'm not sure if there's already a common way to indicate that a package has been baked/has snapshots for all its resources.</p>\n</blockquote>\n<p>maybe place a .file in the package folder?</p>",
        "id": 271453889,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644509519
    },
    {
        "content": "<p>I would think that usually a package either has snapshots for ALL its resources or NONE.  It seems it would be uncommon for a package to be published with a mix of SDs with and without snapshots.  If that's a fair assumption, then I would think you can just look at the first SD you find and check if it has a snapshot or not.</p>",
        "id": 271461131,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1644512515
    },
    {
        "content": "<p>Or the bake command could just check all files as it does now and ignore the files already having a snapshot. Not sure what the current behavior is. <span class=\"user-mention\" data-user-id=\"191335\">@Martijn Harthoorn</span></p>",
        "id": 271462274,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1644513002
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"203235\">Ward Weistra</span> <a href=\"#narrow/stream/179239-tooling/topic/Firely.20Terminal.3A.20install.20bakes.20everything/near/271449546\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"191451\">Patrick Werner</span> Are you sure this is the whole cache and not only packages within the scope (your installed packages, its dependencies and their dependencies)?</p>\n</blockquote>\n<p>yes. These aren't sub-dependencies.</p>",
        "id": 271467727,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1644515351
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> Ok, that's not as intended. We'll reproduce and fix.</p>",
        "id": 271571850,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1644584335
    },
    {
        "content": "<p>Also checking whether bake recreates snapshots for resources that already have them. If so I'll see if that can be optional and not recalculate existing snapshots by default.</p>",
        "id": 271571954,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1644584390
    }
]