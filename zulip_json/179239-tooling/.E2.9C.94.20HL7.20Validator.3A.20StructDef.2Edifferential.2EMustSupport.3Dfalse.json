[
    {
        "content": "<p>If a profile (StructDef) declares only a Differential without a Snapshot, and there is an element where differential.element[x].mustSupport=false, HL7 Validator will generate the following error when loading the profile as part of the IG:</p>\n<blockquote>\n<p>Get set... Unable to generate snapshot for ca-on-ps-profile-procedure from Procedure because Profile ProcedurePSON  (<a href=\"http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure\">http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure</a>), element Procedure (PS-ON).Procedure.bodySite. Error generating snapshot: Illegal constraint [must-support = false] when [must-support = true] in the base profile<br>\norg.hl7.fhir.exceptions.DefinitionException: Profile ProcedurePSON (<a href=\"http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure\">http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure</a>), element Procedure (PS-ON).Procedure.bodySite. Error generating snapshot: Illegal constraint [must-support = false] when [must-support = true] in the base profile<br>\n       at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:819)<br>\n       at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:786)<br>\n       at org.hl7.fhir.r5.context.SimpleWorkerContext.allStructures(SimpleWorkerContext.java:669)<br>\n      at org.hl7.fhir.validation.ValidationEngine.prepare(ValidationEngine.java:606)<br>\n       at org.hl7.fhir.validation.cli.services.ValidationService.initializeValidator(ValidationService.java:359)<br>\n       at org.hl7.fhir.validation.cli.services.ValidationService.initializeValidator(ValidationService.java:310)<br>\n       at org.hl7.fhir.validation.ValidatorCli.doValidation(ValidatorCli.java:238)<br>\n     at org.hl7.fhir.validation.ValidatorCli.main(ValidatorCli.java:164)</p>\n</blockquote>\n<p>Note that the profile is NOT derived from another profile, despite the error message (see <a href=\"https://simplifier.net/ON-PatientSummary/ProcedurePSON/~json\">https://simplifier.net/ON-PatientSummary/ProcedurePSON/~json</a>). In this case, the Procedure.bodysite has been declared with MustSupport = False in the differential.</p>",
        "id": 273172859,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1645751750
    },
    {
        "content": "<p>This was on FHIR Validation tool Version 5.6.35 (Git# 685ea98d37c9)., running with -version 4.0.1</p>",
        "id": 273172954,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1645751833
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"192143\">@Ken Sinn</span> , I think you may be getting your error because Procedure.bodySite is profiled to use CodeableConcept (PS-ON) which is must-support on it's root element, which turns bodySite into MS = true. You're essentially saying that the element is both MS and not MS.</p>\n<p>I also suspect the PS-ON CodeableConcept root element is MS because you copied it from IPS. As you know IPS will be removing many of their MS flags. There is also a pending JIRA ticket (<a href=\"http://jira.hl7.org/browse/FHIR-34347\">J#34347</a>) to clarify adding MS to a root element is against best practice. I suggest you remove the MS flag from PS-ON CodeableConcept (and if needed add it back to <strong>uses</strong> of PS-ON CodedableConcept).</p>",
        "id": 273173936,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1645752804
    },
    {
        "content": "<p>Got it. Thanks <span class=\"user-mention\" data-user-id=\"191380\">@Elliot Silver</span> - that would explain some of the inconsistent behaviour I'm seeing.</p>",
        "id": 273174392,
        "sender_full_name": "Ken Sinn",
        "timestamp": 1645753275
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192143\">Ken Sinn</span> has marked this topic as resolved.</p>",
        "id": 273174396,
        "sender_full_name": "Notification Bot",
        "timestamp": 1645753278
    }
]