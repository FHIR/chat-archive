[
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> ,<br>\nThe Netherlands now has a nice national terminology server (the Ontoserver)! We would like to use it for validation purposes as this would solve a lot of validator errors/warnings due to the  Dutch SNOMED extension sets we use. <br>\nHowever, to use the Ontoserver we require authentication based on bearer tokens. I believe the HL7 validator currently does not support authentication? Are there any plans to add such a feature?</p>",
        "id": 228409201,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1614691889
    },
    {
        "content": "<p>\"HL7 Validator\" also means \"IG Publisher\" in this context ;)</p>",
        "id": 228409584,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1614692046
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> please add this to your list. and I would propose:</p>\n<ul>\n<li>you can provide a bearer token in the parameters</li>\n<li>or you can it in .fhir/validator.config  or similar</li>\n</ul>",
        "id": 228472281,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1614714080
    },
    {
        "content": "<p>Okay, this will fit in with the other HTTP library work I want to do</p>",
        "id": 228472408,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1614714125
    },
    {
        "content": "<p>Nice! :D Thanks</p>",
        "id": 228578250,
        "sender_full_name": "Ardon Toonstra",
        "timestamp": 1614772106
    },
    {
        "content": "<p>+1 for this request , ie. hl7validator to support OAuth2 over HTTPS against a 3rd-party FHIR TX instance</p>\n<p>supply the OAuth2 access token to the hl7validator - assuming it is obtained out-of-band in one of the OAuth2 flows</p>\n<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 246576087,
        "sender_full_name": "David Simons",
        "timestamp": 1626783377
    },
    {
        "content": "<p>The core validator does token based auth as of now</p>",
        "id": 246581280,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626786577
    },
    {
        "content": "<p>OAuth2 would be a little more difficult to set up</p>",
        "id": 246581345,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1626786604
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"248736\">Mark Iantorno</span> <a href=\"#narrow/stream/179239-tooling/topic/HL7.20Validator.20authentication.20support.20for.20terminology.20service/near/246581280\">said</a>:</p>\n<blockquote>\n<p>The core validator does token based auth as of now</p>\n</blockquote>\n<p>Can you elaborate a bit more, please, what that means, or where documented? Glad to test drive!<br>\n(I did not see it under <a href=\"https://github.com/hapifhir/org.hl7.fhir.core\">https://github.com/hapifhir/org.hl7.fhir.core</a> )</p>\n<p>If it means, supply the hl7validator CLI with an OAuth2 Bearer  access token, obtained separately (out-of-band), like \"MTQ0NjJkZmQ5OTM2NDE1ZTZjNGZmZjI3\", and using it in the FHIR-REST calls to the TX, even without refresh, in the HTTP Authorization request header, that'd be great already!</p>",
        "id": 246585732,
        "sender_full_name": "David Simons",
        "timestamp": 1626788721
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> - is there a feature branch we can look at / contribute to?</p>\n<p>PS: are you our sick? get well soon!</p>",
        "id": 247196996,
        "sender_full_name": "David Simons",
        "timestamp": 1627303774
    },
    {
        "content": "<p>I was sick last week, feeling better now, thanks.</p>",
        "id": 247205676,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627307936
    },
    {
        "content": "<p>repo is here:  <a href=\"https://github.com/hapifhir/org.hl7.fhir.validator-wrapper\">https://github.com/hapifhir/org.hl7.fhir.validator-wrapper</a></p>",
        "id": 247205726,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627307968
    },
    {
        "content": "<p>that one is for the website that hosts the validator</p>",
        "id": 247205818,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627308005
    },
    {
        "content": "<p>actual validator is in the core library</p>",
        "id": 247205833,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627308012
    },
    {
        "content": "<p><a href=\"https://github.com/hapifhir/org.hl7.fhir.core\">https://github.com/hapifhir/org.hl7.fhir.core</a></p>",
        "id": 247205855,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627308022
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194580\">@David Simons</span></p>",
        "id": 247205867,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1627308026
    },
    {
        "content": "<p>Thanks and yes - I scrutinized that latter repo - but could not find any use of the <code>headers</code> argument in the <code>org.hl7.fhir.core\\org.hl7.fhir.r4\\src\\main\\java\\org\\hl7\\fhir\\r4\\utils\\client\\ClientUtils.java</code>, yet, for example, trickling down from the <br>\n<code>org.hl7.fhir.validation\\src\\main\\java\\org\\hl7\\fhir\\validation\\cli\\utils\\Params.java</code></p>\n<div class=\"codehilite\"><pre><span></span><code>public &lt;T extends Resource&gt; ResourceRequest&lt;T&gt; issuePostRequest(URI resourceUri,\n                                                                  byte[] payload,\n                                                                  String resourceFormat,\n                                                                  Headers headers,\n                                                                  String message,\n                                                                  long timeout)\n</code></pre></div>\n<p>e.g. a <code>public static final String TERMINOLOGY_AUTH = \"-txAuth\";</code> for a bearer token to be ingested as a HTTP Authorization request header. :)</p>",
        "id": 247215361,
        "sender_full_name": "David Simons",
        "timestamp": 1627311996
    },
    {
        "content": "<p>created a DRAFT pull request <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/566/files\">https://github.com/hapifhir/org.hl7.fhir.core/pull/566/files</a> - let me see how far I get myself :)</p>",
        "id": 247323005,
        "sender_full_name": "David Simons",
        "timestamp": 1627387013
    },
    {
        "content": "<p>was able to get the OAuth2 Bearer access token to be passed to TX, from CLI via parameter like<code>-txAccessToken e5f81bb4-4cb8-47a7-9ee4-03b049dacbbb </code>, on that branch/PR.</p>\n<p>Now trying to overcome (customizing):</p>\n<ul>\n<li>missing api-version: 1 HTTP header</li>\n<li>missing CapabilityStatement from TX, upon <code>metadata?_summary=true</code>, and <code>metadata?mode=terminology</code></li>\n<li><code>java.lang.IllegalStateException: Invalid use of BasicClientConnManager: connection still allocated. Make sure to release the connection before allocating another one</code> in the R4 ClientUtils on the httpclient.execute(request). This is probably related to the required work on the HTTP client in the hl7validator.</li>\n</ul>",
        "id": 247679945,
        "sender_full_name": "David Simons",
        "timestamp": 1627631900
    },
    {
        "content": "<p>Hopefully this work item to productize can be prioritized :) <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/issues/588\">https://github.com/hapifhir/org.hl7.fhir.core/issues/588</a></p>",
        "id": 251355937,
        "sender_full_name": "David Simons",
        "timestamp": 1630402117
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"248736\">@Mark Iantorno</span> yes but we need to get a new version out asap</p>",
        "id": 251357514,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630402980
    },
    {
        "content": "<p>working on this today</p>",
        "id": 251381306,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630415353
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> do you mean you want me to publish a new version of the core before doing this</p>",
        "id": 251381353,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630415377
    },
    {
        "content": "<p>or just do this, then publish a new version of the core?</p>",
        "id": 251381376,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630415387
    },
    {
        "content": "<p>well, I'd really like to have you sort out your merge thing, then I can commit a bunch of code, and then we get a release out later today your time</p>",
        "id": 251382229,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630415734
    },
    {
        "content": "<p>All my merges accept for the one I need James to assist with are closed?</p>",
        "id": 251382726,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630415929
    },
    {
        "content": "<p>Which one do you mean?</p>",
        "id": 251382740,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630415936
    },
    {
        "content": "<p>The validation one you said you had to merge with the code I committed on Friday</p>",
        "id": 251382982,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630416022
    },
    {
        "content": "<p>I pushed the changes the PR you had made</p>",
        "id": 251383069,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630416062
    },
    {
        "content": "<p>and merged that</p>",
        "id": 251383099,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630416069
    },
    {
        "content": "<p>ok. I'll merge when I wake up tomorrow and we'll do a release</p>",
        "id": 251383299,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1630416136
    },
    {
        "content": "<p>sounds goood</p>",
        "id": 251383318,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630416145
    },
    {
        "content": "<p>I'll start on the issue 588</p>",
        "id": 251383332,
        "sender_full_name": "Mark Iantorno",
        "timestamp": 1630416152
    }
]