[
    {
        "content": "<p>I have just upgraded my Mac to Big Sur and now the Zulip client needs to be refreshed every time that a new message notification arises.  I've asked a couple of others and they seem to have the same problem.  Has anyone else experienced this and found the solution?</p>",
        "id": 217228850,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605760289
    },
    {
        "content": "<p>I think you've found my solution -- yet another reason to hold off on Big Sur.</p>",
        "id": 217228900,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1605760342
    },
    {
        "content": "<p>I'm having the same thing. No solution that I've found yet</p>",
        "id": 217229705,
        "sender_full_name": "Jim Steel",
        "timestamp": 1605761619
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192151\">@Tim Abbott</span></p>",
        "id": 217232186,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1605765019
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192166\">Jean Duteau</span> <a href=\"#narrow/stream/179160-social/topic/Macs.2C.20Big.20Sur.2C.20and.20Zulip.20client/near/217228850\">said</a>:</p>\n<blockquote>\n<p>I have just upgraded my Mac to Big Sur and now the Zulip client needs to be refreshed every time that a new message notification arises.  I've asked a couple of others and they seem to have the same problem.  Has anyone else experienced this and found the solution?</p>\n</blockquote>\n<p>same here, switched back to <a href=\"http://chat.fhir.org\">chat.fhir.org</a> in the mean time, there i get no gray screenb in big sur</p>",
        "id": 217234854,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1605768786
    },
    {
        "content": "<p>We're investigating this -- it does appear that Big Sur results in that grey screen behavior.  I'll update this thread when we have an updated version to test (we suspect it's an upstream issue and we just need to upgrade Electron/Chromium)</p>",
        "id": 217320145,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605814839
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span> <span class=\"user-mention\" data-user-id=\"191376\">@Jim Steel</span> <span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> are any of you around to test a potential fix?</p>",
        "id": 217320437,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605814999
    },
    {
        "content": "<p>We think it's about 50% likely that the issue is fixed in master, and we'd like someone to test a development build (<a href=\"https://github.com/zulip/zulip-desktop/blob/master/development.md\">https://github.com/zulip/zulip-desktop/blob/master/development.md</a> has instructions) to confirm whether that is sufficient.</p>",
        "id": 217320522,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605815039
    },
    {
        "content": "<p>(Or anyone else who's upgraded to Big Sur and seen this issue; it seems possible the original reporters might be asleep right now)</p>",
        "id": 217320714,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605815118
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192151\">@Tim Abbott</span> I am and willing</p>",
        "id": 217321681,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605815549
    },
    {
        "content": "<p>testing now....</p>",
        "id": 217322216,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605815813
    },
    {
        "content": "<p>Awesome!</p>",
        "id": 217323773,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605816549
    },
    {
        "content": "<p>so far it appears to be working - it seemed like the previous version would grey screen whenever a new message appeared and it's not doing that now</p>",
        "id": 217323862,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605816596
    },
    {
        "content": "<p>The bug with the previous version was with desktop notifications <span class=\"user-mention\" data-user-id=\"192166\">@Jean Duteau</span>, so you may not see it until someone mentions you (or a PM or a stream you've configured notifications for).</p>",
        "id": 217324540,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605816924
    },
    {
        "content": "<p>well, you just mentioned me and it didn't happen.  :)</p>",
        "id": 217324637,
        "sender_full_name": "Jean Duteau",
        "timestamp": 1605816963
    },
    {
        "content": "<p>Great!</p>",
        "id": 217324686,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605816978
    },
    {
        "content": "<p>happy to test if still needed</p>",
        "id": 217324854,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1605817072
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> if you can also try following the instructions in <a href=\"https://github.com/zulip/zulip-desktop/blob/master/development.md\">https://github.com/zulip/zulip-desktop/blob/master/development.md</a> to install the development version and confirm whether the issue is resolved for you, that'll be great.</p>",
        "id": 217352121,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605835329
    },
    {
        "content": "<p>We believe that we've fixed the issue in master but additional confirmation would be very helpful.</p>",
        "id": 217352134,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605835346
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192151\">@Tim Abbott</span> it cannot reproduce the error anymore and receive new messages without a gray screen.<br>\ni  get an error message on the console during startup, but  don't know if that is in anyway related:</p>\n<div class=\"codehilite\"><pre><span></span><code>npm start\n\n&gt; zulip@5.4.3 start /Users/oliveregger/Documents/github/zulip-desktop\n&gt; tsc &amp;&amp; electron .\n\nTypeError: Error processing argument at index 0, conversion failure from null\n    at IpcMainImpl.&lt;anonymous&gt; (/Users/oliveregger/Documents/github/zulip-desktop/app/main/index.js:161:13)\n    at IpcMainImpl.emit (events.js:310:20)\n    at WebContents.&lt;anonymous&gt; (electron/js2c/browser_init.js:157:8362)\n    at WebContents.emit (events.js:310:20)\nTypeError: Error processing argument at index 0, conversion failure from null\n    at IpcMainImpl.&lt;anonymous&gt; (/Users/oliveregger/Documents/github/zulip-desktop/app/main/index.js:161:13)\n    at IpcMainImpl.emit (events.js:310:20)\n    at WebContents.&lt;anonymous&gt; (electron/js2c/browser_init.js:157:8362)\n    at WebContents.emit (events.js:310:20)\nobjc[4552]: Class NotificationCenterDelegate is implemented in both /Users/oliveregger/Documents/github/zulip-desktop/node_modules/electron/dist/Electron.app/Contents/Frameworks/Electron Framework.framework/Versions/A/Electron Framework (0x10fc8d0c0) and /Users/oliveregger/Documents/github/zulip-desktop/node_modules/node-mac-notifier/build/Release/Notification.node (0x11342ca20). One of the two will be used. Which one is undefined.\n2020-11-20 11:25:00.920 Electron[4487:346647] Warning: Expected min height of view: (&lt;NSPopoverTouchBarItemButton: 0x7fd4d85e41f0&gt;) to be less than or equal to 30 but got a height of 32.000000. This error will be logged once per view in violation.\n2020-11-20 11:26:38.682 Electron[4487:346647] Incorrect NSStringEncoding value 0x8000100 detected. Assuming NSASCIIStringEncoding. Will stop this compatibility mapping behavior in the near future.\n2020-11-20 11:26:38.682 Electron[4487:346647] Incorrect NSStringEncoding value 0x8000100 detected. Assuming NSASCIIStringEncoding. Will stop this compatibility mapping behavior in the near future.\n2020-11-20 11:26:46.539 Electron[4487:346647] Warning: Expected min height of view: (&lt;NSPopoverTouchBarItemButton: 0x7fd4693c89c0&gt;) to be less than or equal to 30 but got a height of 32.000000. This error will be logged once per view in violation.\n</code></pre></div>",
        "id": 217383875,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1605868133
    },
    {
        "content": "<p>on no, i have the gray screen back after beeing back from lunch, with the following message in the terminal:</p>\n<div class=\"codehilite\"><pre><span></span><code>objc[87760]: Class NotificationCenterDelegate is implemented in both /Users/oliveregger/Documents/github/zulip-desktop/node_modules/electron/dist/Electron.app/Contents/Frameworks/Electron Framework.framework/Versions/A/Electron Framework (0x10974d0c0) and /Users/oliveregger/Documents/github/zulip-desktop/node_modules/node-mac-notifier/build/Release/Notification.node (0x10a806a20). One of the two will be used. Which one is undefined.\n2020-11-20 12:59:45.015 Electron Helper (Renderer)[87760:612009] *** Terminating app due to uncaught exception &#39;NSInternalInconsistencyException&#39;, reason: &#39;Critical error: required built-in appearance SystemAppearance not found&#39;\n*** First throw call stack:\n(\n    0   CoreFoundation                      0x00007fff204826af __exceptionPreprocess + 242\n    1   libobjc.A.dylib                     0x00007fff201ba3c9 objc_exception_throw + 48\n    2   CoreFoundation                      0x00007fff20482513 +[NSException raise:format:] + 189\n    3   libdispatch.dylib                   0x00007fff201657c7 _dispatch_client_callout + 8\n    4   libdispatch.dylib                   0x00007fff2016696b _dispatch_once_callout + 20\n    5   AppKit                              0x00007fff22be9a9c +[NSAppearance _initializeCoreUI] + 35\n    6   AppKit                              0x00007fff22be964f +[NSAppearance _darkAquaAppearance] + 47\n    7   AppKit                              0x00007fff22be93ca +[NSAppearance appearanceNamed:] + 21\n    8   AppKit                              0x00007fff22be90be _NSAppearanceCurrentSystemAppearance + 178\n    9   AppKit                              0x00007fff22be8e64 -[NSSystemAppearanceProxy init] + 81\n    10  AppKit                              0x00007fff22be8e0a __38+[NSSystemAppearanceProxy systemProxy]_block_invoke + 16\n    11  libdispatch.dylib                   0x00007fff201657c7 _dispatch_client_callout + 8\n    12  libdispatch.dylib                   0x00007fff2016696b _dispatch_once_callout + 20\n    13  AppKit                              0x00007fff22be8df8 +[NSSystemAppearanceProxy systemProxy] + 42\n    14  AppKit                              0x00007fff22c0d03c +[NSAppearance _applicationAppearance] + 88\n    15  AppKit                              0x00007fff22d67504 -[NSImage bestRepresentationForRect:context:hints:] + 670\n    16  AppKit                              0x00007fff22d67223 -[NSImage _usingBestRepresentationForRect:context:hints:body:] + 86\n    17  AppKit                              0x00007fff22d66b1e -[NSImage CGImageForProposedRect:context:hints:] + 770\n    18  Foundation                          0x00007fff213f6862 _imageDataForImage + 318\n    19  Foundation                          0x00007fff213f6f2b -[_NSConcreteUserNotification setContentImage:] + 99\n    20  Notification.node                   0x000000010a803a0d _ZN15MacNotificationC2EPN3Nan10Utf8StringES2_S2_S2_S2_S2_bS2_ + 513\n    21  Notification.node                   0x000000010a802dc1 _ZN15MacNotification3NewERKN3Nan20FunctionCallbackInfoIN2v85ValueEEE + 615\n    22  Notification.node                   0x000000010a804730 _ZN3Nan3impL23FunctionCallbackWrapperERKN2v820FunctionCallbackInfoINS1_5ValueEEE + 220\n    23  Electron Framework                  0x0000000102ca1fea _ZN2v88internal9Accessors12MakeAccessorEPNS0_7IsolateENS0_6HandleINS0_4NameEEEPFvNS_5LocalINS_4NameEEERKNS_20PropertyCallbackInfoINS_5ValueEEEEPFvS9_NS7_ISB_EERKNSA_INS_7BooleanEEEE + 17498\n    24  Electron Framework                  0x0000000102ca1281 _ZN2v88internal9Accessors12MakeAccessorEPNS0_7IsolateENS0_6HandleINS0_4NameEEEPFvNS_5LocalINS_4NameEEERKNS_20PropertyCallbackInfoINS_5ValueEEEEPFvS9_NS7_ISB_EERKNSA_INS_7BooleanEEEE + 14065\n    25  Electron Framework                  0x0000000102ca0cfa _ZN2v88internal9Accessors12MakeAccessorEPNS0_7IsolateENS0_6HandleINS0_4NameEEEPFvNS_5LocalINS_4NameEEERKNS_20PropertyCallbackInfoINS_5ValueEEEEPFvS9_NS7_ISB_EERKNSA_INS_7BooleanEEEE + 12650\n    26  Electron Framework                  0x00000001037aa5d8 _ZN2v88internal20SetupIsolateDelegate9SetupHeapEPNS0_4HeapE + 488696\n    27  Electron Framework                  0x000000010373b6c5 _ZN2v88internal20SetupIsolateDelegate9SetupHeapEPNS0_4HeapE + 34277\n)\nlibc++abi.dylib: terminating with uncaught exception of type NSException\n</code></pre></div>",
        "id": 217394081,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1605875135
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> awesome, that exception is very helpful; we're working with the upstream maintainers to get that bug fixed.</p>",
        "id": 217451860,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1605902446
    },
    {
        "content": "<p>glad if it helps, just let me know if i should do another test round</p>",
        "id": 217494108,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1605952184
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192151\">@Tim Abbott</span> with the latest update zulip to 5.5.0 the gray screen is not showing up anymore and i can use the app again, thanks  a lot!</p>",
        "id": 218614796,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1606940979
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> thanks for confirming the fix! :)</p>",
        "id": 219036654,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1607308367
    }
]