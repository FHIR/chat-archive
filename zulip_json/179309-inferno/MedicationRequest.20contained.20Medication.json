[
    {
        "content": "<p>For IV orders we use a contained Medication within MedicationRequest and are currently receiving two errors in Inferno.  I don't get any errors using the FHIR Validator or other validation tools.  Any assistance is appreciated.</p>\n<p>USCMR-10: MedicationRequest resources returned from previous search conform to the US Core MedicationRequest Profile. <br>\nMedicationRequest/id-ORDER.58.0.10018045.1: MedicationRequest.medication.ofType(Reference): Unable to find matching profile for #1 among choices: <a href=\"http://hl7.org/fhir/us/core/StructureDefinition/us-core-medication\">http://hl7.org/fhir/us/core/StructureDefinition/us-core-medication</a></p>\n<p>USCMR-11: Medication resources returned conform to US Core v3.1.1 profiles<br>\nMedication/1: Medication.ingredient[0].item.ofType(Reference): Unable to resolve resource '#2'&lt;br/&gt; Medication/1: Medication.ingredient[0].item.ofType(Reference): ref-1: SHALL have a contained resource if a local reference is provided ( (url: 2; ids: )) [(reference = '#') or reference.startsWith('#').not() or (reference.substring(1).trace('url') in %rootResource.contained.id.trace('ids'))]</p>\n<p>{<br>\n  \"resourceType\": \"MedicationRequest\",<br>\n  \"id\": \"id-ORDER.58.0.10018045.1\",<br>\n  \"contained\": [<br>\n    {<br>\n      \"resourceType\": \"Medication\",<br>\n      \"id\": \"1\",<br>\n      \"code\": {<br>\n        \"coding\": [<br>\n          {<br>\n            \"system\": \"<a href=\"http://hl7.org/fhir/sid/ndc\">http://hl7.org/fhir/sid/ndc</a>\",<br>\n            \"code\": \"9999999999\",<br>\n            \"display\": \"DEXTROSE 5%-WATER IV SOLN: 1000ML JC\"<br>\n          }<br>\n        ],<br>\n        \"text\": \"DEXTROSE 5%-WATER IV SOLN: 1000ML JC\"<br>\n      },<br>\n      \"ingredient\": [<br>\n        {<br>\n          \"itemReference\": {<br>\n            \"reference\": \"#2\"<br>\n          },<br>\n          \"strength\": {<br>\n            \"numerator\": {<br>\n              \"value\": 1000,<br>\n              \"unit\": \"ML\"<br>\n            },<br>\n            \"denominator\": {<br>\n              \"value\": 1,<br>\n              \"unit\": \"bag\"<br>\n            }<br>\n          }<br>\n        }<br>\n      ]<br>\n    },<br>\n    {<br>\n      \"resourceType\": \"Medication\",<br>\n      \"id\": \"2\",<br>\n      \"code\": {<br>\n        \"coding\": [<br>\n          {<br>\n            \"system\": \"<a href=\"http://hl7.org/fhir/sid/ndc\">http://hl7.org/fhir/sid/ndc</a>\",<br>\n            \"code\": \"9999999999\",<br>\n            \"display\": \"DEXTROSE 5%-WATER IV SOLN: 1000ML JC\"<br>\n          }<br>\n        ],<br>\n        \"text\": \"DEXTROSE 5%-WATER IV SOLN: 1000ML JC\"<br>\n      }<br>\n    }<br>\n  ],<br>\n  \"status\": \"active\",<br>\n  \"intent\": \"order\",<br>\n  \"reportedBoolean\": false,<br>\n  \"medicationReference\": {<br>\n    \"reference\": \"#1\"<br>\n  },<br>\n  \"subject\": {<br>\n    \"reference\": \"Patient/id-58.58.14477\"<br>\n  },<br>\n  \"encounter\": {<br>\n    \"reference\": \"Encounter/id-58.10018045\"<br>\n  },<br>\n  \"authoredOn\": \"2021-07-29T16:34:00-05:00\",<br>\n  \"requester\": {<br>\n    \"reference\": \"Practitioner/id-58.58.0.0.jameswd.778899.0\",<br>\n    \"display\": \"DINSMORE JAMES\"<br>\n  },<br>\n  \"dosageInstruction\": [<br>\n    {<br>\n      \"text\": \"40 ml/hr IV PIGGY\",<br>\n      \"additionalInstruction\": [<br>\n        {<br>\n          \"coding\": [<br>\n            {<br>\n              \"display\": \"PREDEFINED NS TIME OF\"<br>\n            },<br>\n            {<br>\n              \"display\": \"1000\"<br>\n            }<br>\n          ],<br>\n          \"text\": \"PREDEFINED NS TIME OF 1000\"<br>\n        }<br>\n      ],<br>\n      \"timing\": {<br>\n        \"code\": {<br>\n          \"coding\": [<br>\n            {<br>\n              \"system\": \"<a href=\"http://thrive.com/frequency-code\">http://thrive.com/frequency-code</a>\",<br>\n              \"code\": \"DAILY\",<br>\n              \"display\": \"DAILY\"<br>\n            }<br>\n          ]<br>\n        }<br>\n      },<br>\n      \"route\": {<br>\n        \"coding\": [<br>\n          {<br>\n            \"system\": \"<a href=\"http://snomed.info/sct\">http://snomed.info/sct</a>\",<br>\n            \"display\": \"IV PIGGY\"<br>\n          },<br>\n          {<br>\n            \"system\": \"<a href=\"http://thrive.com/medication-route\">http://thrive.com/medication-route</a>\",<br>\n            \"code\": \"IV\",<br>\n            \"display\": \"IV PIGGY\"<br>\n          } <br>\n        ],<br>\n        \"text\": \"IV PIGGY\"<br>\n      },<br>\n      \"doseAndRate\": [<br>\n        {<br>\n          \"doseQuantity\": {<br>\n            \"value\": 40,<br>\n            \"unit\": \"ml/hr\"<br>\n          }<br>\n        }<br>\n      ]<br>\n    }<br>\n  ],<br>\n  \"dispenseRequest\": {<br>\n    \"validityPeriod\": {<br>\n      \"start\": \"2021-07-29T16:34:00-05:00\"<br>\n    },<br>\n    \"numberOfRepeatsAllowed\": 0,<br>\n    \"quantity\": {<br>\n      \"value\": 0<br>\n    }<br>\n  }<br>\n}</p>",
        "id": 250040011,
        "sender_full_name": "James Dinsmore",
        "timestamp": 1629402673
    },
    {
        "content": "<p>Hello <span class=\"user-mention\" data-user-id=\"236436\">@James Dinsmore</span> I run some tests using the MedicationRequest you provided. I could not reproduce the error on USCMR-10 while I did get the same on USCMR-11. <a href=\"/user_uploads/10155/t8wJf544qBDqVAUMxzmrLP32/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/t8wJf544qBDqVAUMxzmrLP32/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/t8wJf544qBDqVAUMxzmrLP32/image.png\"></a></div><p>If you have other MedicationRequest resource that fails on USCMR-10, I could take a look again.</p>\n<p>The problem for USCMR-11 is based on the cross reference between these two contained Medications where the Medication.1 has a reference to Medcation.2. <br>\nThough this is kindly correct in MedicationRequest, Inferno has to take those contained resources out and send them <strong>one at time</strong> to validator in order to validate them against US Core profiles. When validator test Medication.1, it sees that Medicaiton.1 has a local reference to contained resource \"#2\" but it could not find contained resource in Medication.1.  </p>\n<p>I understand your use case but such usage of contained resource is not recommended by FHIR standard. As FHIR spec <a href=\"http://build.fhir.org/references.html#contained\">states</a> that </p>\n<blockquote>\n<p>Resources can only be contained in other resources if there is a reference from the resource to the contained resource, or if the contained resource references the container resource. </p>\n</blockquote>\n<p>In the example you provided, there is no reference from the container resource MedicationRequest to the contained resource Medicaiton.2 and there is not reference from the contained Medicaiton.2 to its container MedicationRequest.<br>\nSo the reference between contained resources is tricky. I would suggest not using that practice.</p>",
        "id": 250051145,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1629408124
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span>.  It appears that the issue we are seeing with USCMR-10 must be fixed in 1.6.1 or 1.6.2 as our Inferno server is still on 1.6.  As for the contained references I understand and will change ingredient.itemReference to ingredient.itemCodeableConcept.</p>",
        "id": 250142240,
        "sender_full_name": "James Dinsmore",
        "timestamp": 1629477679
    }
]