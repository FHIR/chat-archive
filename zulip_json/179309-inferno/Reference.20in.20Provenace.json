[
    {
        "content": "<p>Hello,<br>\nIn Provenance, since the reference to an Author(Practitioner) and an Organization can be external to our EHR system, can I display the reference as a \"Contained resource\"? Instead of using a relative URL to the resource? <br>\nI have the name and NPI of the practitioner and resource. <br>\nThank you.</p>",
        "id": 231183351,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1616289072
    },
    {
        "content": "<p>The references are for the \"US Core Practitioner\" and \"US Core Organization\" profiled version of the resources specifically, which I believe means you cannot have a contained reference for those resource types.  Our tests may be more flexible than that right now, and may only require you to demonstrate that you can support non-contained references there (vs. requiring only non-contained references), but I'd have to check.  <span class=\"user-mention\" data-user-id=\"191410\">@Brett Marquard</span> <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span> what does FHIR/US Core say about it now?</p>",
        "id": 231218540,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1616335739
    },
    {
        "content": "<p>we added revised language surrounding containment in the balloted version here: <a href=\"http://build.fhir.org/ig/HL7/US-Core/general-guidance.html#contained-resources\">http://build.fhir.org/ig/HL7/US-Core/general-guidance.html#contained-resources</a>.  In general don't use contained resources.</p>",
        "id": 231220575,
        "sender_full_name": "Eric Haas",
        "timestamp": 1616338191
    },
    {
        "content": "<p>Thank you. So a contained resource cannot be a US Core Practitioner or a US Core Organization? If I have a name and an NPI,  isn't the data sufficient to represent the resource? The link above says \"If referencing a contained resource in a US Core Profile, the contained resource SHOULD be a US Core Profile if a US Core Profile exists for the resource type. \".  The reason I am asking this is to represent the \"last hop\" provenance data when data is coming into our system through an HIE for say Labs. In that case, I need to represent the external Organization and external Practitioner in the provenance resource. I am not sure how to create a relative reference to it.</p>",
        "id": 231253402,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1616375818
    },
    {
        "content": "<p>I don't know your internal design. If server can save those as contained resource,  why server cannot save those as regular FHIR resource?</p>",
        "id": 231310639,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1616420251
    },
    {
        "content": "<blockquote>\n<p>In that case, I need to represent the external Organization and external Practitioner in the provenance resource. I am not sure how to create a relative reference to it</p>\n</blockquote>\n<p>Probably an <strong>extremely</strong> naive question but bear with me: when ingesting from an HIE, why not check to see if the organization/practitioner with that NPI is already a resource in your system, and if it is, point the reference to that resource?  And if not, create a new resource?</p>",
        "id": 231318737,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1616423290
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"192576\">@Robert Scanlon</span> <span class=\"user-mention\" data-user-id=\"191506\">@Yunwei Wang</span> . Our FHIR server does not have the ability to POST resources. It is a facade that GETs data from our EHR system and outputs FHIR resources. When we make a request to say Practitioner/&lt;id&gt;, we look to see if such a practitioner with the &lt;id&gt; is present in our database and then we get the related  information such as NPI, name, address etc.  When we don't have information related to the organization or practitioner in our database, I was wondering if we can reference using a contained resource.</p>",
        "id": 231336114,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1616428870
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191506\">Yunwei Wang</span> <a href=\"#narrow/stream/179309-inferno/topic/Reference.20in.20Provenace/near/231310639\">said</a>:</p>\n<blockquote>\n<p>I don't know your internal design. If server can save those as contained resource,  why server cannot save those as regular FHIR resource?</p>\n</blockquote>\n<p>I wasn't planning on saving the contained resource, just creating a FHIR response with the data.</p>",
        "id": 231336737,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1616429053
    },
    {
        "content": "<p>I remember there were several discussions on <a class=\"stream\" data-stream-id=\"179166\" href=\"/#narrow/stream/179166-implementers\">#implementers</a> stream about how to handle reference as an information broker/middle-man. A broker should be able to handle client's request though it does not hold the resource itself.</p>",
        "id": 231343080,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1616431066
    },
    {
        "content": "<blockquote>\n<p>When we don't have information related to the organization or practitioner in our database, I was wondering if we can reference using a contained resource</p>\n</blockquote>\n<p>This is confusing to me, because you do have name &amp; NPI, which is information related to the organization &amp; practitioner.  You just mean that you are not currently storing it like your other Practitioner/Organization information that you expose via the Practitioner/[id] and Organization/[id] queries, right?  Or am I misunderstanding.</p>",
        "id": 231355518,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1616435652
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"192576\">Robert Scanlon</span> <a href=\"#narrow/stream/179309-inferno/topic/Reference.20in.20Provenace/near/231355518\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>When we don't have information related to the organization or practitioner in our database, I was wondering if we can reference using a contained resource</p>\n</blockquote>\n<p>This is confusing to me, because you do have name &amp; NPI, which is information related to the organization &amp; practitioner.  You just mean that you are not currently storing it like your other Practitioner/Organization information that you expose via the Practitioner/[id] and Organization/[id] queries, right?  Or am I misunderstanding.</p>\n</blockquote>\n<p>Sorry for the confusion. You are correct. We are storing this information in the database (as part of provenance for HIE system records), just not in our organization and practitioner table. I have to take it back to our team and mention that this data needs to be part of Organization and Practitioner tables so that they can be accessed by FHIR as a reference. Your input and comments were helpful. Thank you!</p>",
        "id": 231360191,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1616437537
    },
    {
        "content": "<p>Thanks. We will look at our server and the API manager in front of it.</p>",
        "id": 231657983,
        "sender_full_name": "Santosh Pai",
        "timestamp": 1616601011
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>  - In reference to your reply related to contained resources in Provenance, the link that that you pointed to says \" If referencing a contained resource in a US Core Profile, the contained resource SHOULD be a US Core Profile if a US Core Profile exists for the resource type.\". Bear with me... :) If say I create a contained resource of type Organization or Practitioner in a Provenance resource, is it invalid even though Organization and Practitioner are US core profiles? The reason I ask is that while it is not impossible for us to implement saving Organization and Practitioner when data (like Lab results) is being received from an external organization, the implementation is not ideal. The reason being, we are supposed to display provenance data as-is from an external system. Extracting the organization/practitioner data from the provenance info and storing it in an organization table in order to create a FHIR logical reference may break the integrity of the provenance data. Thanks!</p>",
        "id": 232910159,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1617376400
    },
    {
        "content": "<p>Sorry I missed your update!  From a g10 certification test tool perspective, if use of contained resources is \"just\" strongly discouraged (and not strictly disallowed) then the automated ONC g10 certification test tool shouldn't fail you outright, unless ONC provides additional requirements on top of the specifications. But ONC recently updated their <a href=\"https://www.healthit.gov/test-method/standardized-api-patient-and-population-services#ccg\">CCG</a> to provide leniency with respect to externally-originated and legacy data:</p>\n<blockquote>\n<p>Information originating from the (g)(10)-certified Health IT Module must conform to the requirements included in the criterion, but legacy information and information from outside systems is not required to be mapped to the United States Core Data for Interoperability (USCDI) “Applicable Standards” and the US Core IG terminologies and value sets.</p>\n</blockquote>\n<p>The <a href=\"#narrow/stream/179166-implementers/topic/References.20in.20Provenance\">question you asked in implementers</a> may get a different response from a human-review \"test\" perspective though (does NPI counts as 'identifying' information?).  I'm curious if anyone says anything.</p>\n<p>I should have asked you this up front: does Inferno FAIL you today if you used contained resources for those elements in Provenance?  I would have thought that our tests would have allowed this, but perhaps there is something in there that blocks it.  Could you provide a sample resource for me to try?</p>",
        "id": 233370286,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617735272
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192576\">@Robert Scanlon</span> - I didn't implement it yet, so I don't know if the tool will fail. Prior to implementing, I wanted to make sure I was doing it right. I just read the replies in Implementers stream and it looks like the consensus is not to have contained resource. I am probably unable to explain this properly, but the reason I am leaning towards \"contained\" is from what my interoperability/HIE resource is telling me that when provenance data comes from an external system with an NPI, Name etc.. that information may or may not be correct. In sense, it is possible that an NPI could point to an incorrect organization because there is a bug in the external system. But our system is supposed to display the provenance data as is;  Hence I cannot take that incorrect NPI-name combination and store it in a master table to use as a reference. I don't know how likely this occurs, but that's what I was told.</p>",
        "id": 233417961,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1617760051
    },
    {
        "content": "<p>Yes, I can understand all the practical issues involved here.  Introducing dirty data into an area that your systems very much rely on being validated &amp; correct could be problematic.  And I can see provenance metadata being a lot more messy than the 'regular' data being exchanged, because it is of less practical importance -- making sure that data is accurate isn't free, and is validating/deduping/etc this particular information how you want to be spending limited resources?</p>",
        "id": 233490900,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617803548
    },
    {
        "content": "<p>I can think of plenty of technical solutions that present a 'correct' FHIR interface while keeping this data separate behind the scenes so it doesn't mess up existing rules about what is stored in your master practitioner table. For example, you could format your ids in such a way that you know to look for Practitioner/provenance-XYZ over in the provenance store, and just parse out the practitioner information of the XYZ provenance record and send it back.  Or for a more FHIR-aligned method, store provenance information about that newly created practitioner itself, so you know that it comes from a highly dubious source (the HIE), and then upgrade existing systems to pay attention to provenance information so they can filter out untrusted sources if necessary.  All of this is complexity though.  And I can't say what makes sense for your product technically given your users / business / goals / etc.</p>",
        "id": 233494535,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617804748
    },
    {
        "content": "<p>My general feeling, today, is that if you work around this issue on the facade level (either by using contained resources, or by doing some fancy ID parsing and routing), instead of migrating your systems to be closer to 'native fhir', you'll probably be accruing some technical debt.  However, taking on technical debt might be the right choice for your product.  It buys you time and lets you see if FHIR continues to gain momentum before making a bigger investment in aligning your systems internally to fhir.</p>",
        "id": 233497646,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617805795
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192576\">@Robert Scanlon</span> - I appreciate your detailed reply.  We are leaning towards this suggestion of yours - \"you could format your ids in such a way that you know to look for Practitioner/provenance-XYZ over in the provenance store, and just parse out the practitioner information of the XYZ provenance record and send it back\". Just that the implementation is a little messy with our current provenance data storage (but doable) :) Which is why I wanted to see what the FHIR community has to say. Thank you!</p>",
        "id": 233508025,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1617808531
    },
    {
        "content": "<p>Yeah, I worry a little bit that we are encouraging workarounds for compliance sake that functionally do not provide any value from a semantic interop perspective.  I suppose it is slightly better syntactically, since there is more consistency if nobody uses 'contained' resources here (it is easier for clients if they can always expect a URL to follow instead of knowing to look for contained resources too).  But now you are going to have lots of duplicated practitioners exposed out of the /Practitioner endpoint... since /Practitioner/100 may be the same as /Practitioner/provenance-4594, and /Practitioner/provenance-4352344 and /Practitioner/provenance-324234dd... which doesn't seem right.</p>",
        "id": 233510294,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617809220
    },
    {
        "content": "<p>Exactly!</p>",
        "id": 233511027,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1617809458
    },
    {
        "content": "<p>So what clients may gain in slightly simpler parsing rules they pay for when they do a practitioner search by NPI.  All of the sudden they will be given all of these duplicate phantom practitioner records that only exist because they are linked from provenance records.  You could choose to simply not search those provenance-practitioner records in the NPI search (or simply forget to because the data is now in two spots, not one), but then you run afoul of FHIR by not exposing that data because technically you have it.</p>",
        "id": 233518116,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1617811938
    },
    {
        "content": "<p>ah, yes. That could a problem. The consuming app won't be able to search using NPI for provenance (external) practitioners or organizations because we will be ignoring them in search; just read will be supported for this particular type of practitioner/organization. Something for us to consider. Thank you.</p>",
        "id": 233527690,
        "sender_full_name": "Lakshmi Bhamidipati",
        "timestamp": 1617815646
    }
]