[
    {
        "content": "<p>Anyone actively using the <a href=\"https://wiki.hl7.org/Using_the_FHIR_Validator\" target=\"_blank\" title=\"https://wiki.hl7.org/Using_the_FHIR_Validator\">FHIR Validator</a> on Questionnaire resources?  I've run into an issue where the validator chokes when multiple <code>enableWhen</code> elements are included in a single <code>item</code>.  The problem I'm seeing is probably best illustrated with an example.  If I take an <a href=\"http://hl7.org/fhir/R4/questionnaire-zika-virus-exposure-assessment.json.html\" target=\"_blank\" title=\"http://hl7.org/fhir/R4/questionnaire-zika-virus-exposure-assessment.json.html\">example Questionnaire</a> and run the validator it passes with some expected (and some unexpected) warnings.  If I update the example JSON so that the <code>item</code> with <code>linkId=4</code> includes more than one <code>enableWhen</code>:</p>\n<div class=\"codehilite\"><pre><span></span>&quot;enableWhen&quot;: [\n  {\n    &quot;question&quot;: &quot;1&quot;,\n    &quot;operator&quot;: &quot;=&quot;,\n    &quot;answerBoolean&quot;: false\n  },\n  {\n    &quot;question&quot;: &quot;2&quot;,\n    &quot;operator&quot;: &quot;=&quot;,\n    &quot;answerBoolean&quot;: false\n  }\n],\n&quot;enableBehavior&quot;: &quot;all&quot;\n</pre></div>\n\n\n<p>I get the following error:</p>\n<div class=\"codehilite\"><pre><span></span>&gt;&gt; java -jar org.hl7.fhir.validator.jar example.json -version 4.0 -ig hl7.fhir.uv.sdc\nFHIR Validation tool Version 4.1.61-SNAPSHOT (Git# b6ba504320f6). Built 2020-02-07T10:55:33.966+11:00 (5 days old)\n  .. FHIR Version 4.0, definitions from hl7.fhir.r4.core#4.0.1\n  .. connect to tx server @ http://tx.fhir.org\n    (v4.0.1)\n+  .. load IG from hl7.fhir.uv.sdc\n   ... Using version 2.7.0\n  .. validate [example.json]\nException in thread &quot;main&quot; java.lang.Error: Attempt to read a single element when there is more than one present (enableWhen)\n</pre></div>\n\n\n<p>Wondering if this is a bug in the validator or if I'm misunderstanding how to define multiple <code>enableWhen</code> conditions.</p>",
        "id": 188047147,
        "sender_full_name": "David Winters",
        "timestamp": 1581537042
    },
    {
        "content": "<p>That sounds like a validator bug.  enableWhen has been allowed to repeat since it was introduced in STU3.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 188050715,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1581539548
    },
    {
        "content": "<p>I've just stumbled into a pile of bugs here. So much for test cases</p>",
        "id": 188051482,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1581540232
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , thanks <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> .  It's good to get confirmation that my thinking was not way out of line.  Let me know if you need any further information.</p>",
        "id": 188052140,
        "sender_full_name": "David Winters",
        "timestamp": 1581540749
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> , confirming this issue is fixed in the latest version of the validator (4.1.63).</p>",
        "id": 188104911,
        "sender_full_name": "David Winters",
        "timestamp": 1581599959
    }
]