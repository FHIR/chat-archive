[
    {
        "content": "<p>In my post on Grouping Questionnaire Responses, the syntax of the workflow-researchStudy extension was discussed and appeared to be correct.</p>\n<p>Since then, I have tried multiple times to use that syntax provided by creating a Questionnaire Response with this workflow extension, but I am having issues. I am testing on the R4 public UHN HAPI server at <a href=\"http://hapi.fhir.org/\">http://hapi.fhir.org/</a></p>\n<p>The extension that I am trying is:</p>\n<p>\"extension\":<br>\n     [{<br>\n        \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/workflow-researchStudy\">http://hl7.org/fhir/StructureDefinition/workflow-researchStudy</a>\",<br>\n        \"value\": {<br>\n            \"reference\": \"<a href=\"http://hapi.fhir.org/baseR4/ResearchStudy/2126240\">http://hapi.fhir.org/baseR4/ResearchStudy/2126240</a>\",<br>\n            \"display\": \"2126240\"<br>\n            }<br>\n    }]</p>\n<p>Each time, I get apparent success (201 created), but when I look at the Questionnaire Response (eg. 2379536), the extension is not there. </p>\n<p>So, I tried this:</p>\n<p>\"extension\":<br>\n    [{              <br>\n        \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/workflow-researchStudy\">http://hl7.org/fhir/StructureDefinition/workflow-researchStudy</a>\",<br>\n            \"valueUrl\": \"<a href=\"http://hapi.fhir.org/baseR4/ResearchStudy/2126240\">http://hapi.fhir.org/baseR4/ResearchStudy/2126240</a>\" <br>\n    }]</p>\n<p>which seems better in that the Questionnaire Response (eg. 2379538) has the extension.  But, I don't think it is correct, because when I try to validate the Questionnaire Response, I get the error: </p>\n<p>\"severity\": \"error\",<br>\n    \"code\": \"processing\",<br>\n \"diagnostics\": \"The Extension '<a href=\"http://hl7.org/fhir/StructureDefinition/workflow-researchStudy\">http://hl7.org/fhir/StructureDefinition/workflow-researchStudy</a>' definition allows for the types [Reference] but found type url\"     </p>\n<p>What am I doing wrong?  Why is my extension disappearing?</p>",
        "id": 244505397,
        "sender_full_name": "Diane",
        "timestamp": 1625099116
    },
    {
        "content": "<p>The first is correct.  <span class=\"user-mention\" data-user-id=\"191319\">@James Agnew</span> ?</p>",
        "id": 244513196,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625108221
    },
    {
        "content": "<p>I am still having no success with workflow-researchStudy extension.<br>\nThe syntax that Lloyd says is correct is:</p>\n<p>\"extension\":<br>\n[{<br>\n    \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/workflow-researchStudy\">http://hl7.org/fhir/StructureDefinition/workflow-researchStudy</a>\",<br>\n    \"value\": {<br>\n        \"reference\": \"<a href=\"http://hapi.fhir.org/baseR4/ResearchStudy/2126240\">http://hapi.fhir.org/baseR4/ResearchStudy/2126240</a>\",<br>\n        \"display\": \"2126240\"<br>\n    }<br>\n}]</p>\n<p>Each time, I get apparent success (201 created) in the HAPI server (either our organization's HAPI server or the HAPI test server, but when I look at the Questionnaire Response (eg. 2379536), the workflow-researchStudy extension is not there.</p>\n<p>This other syntax allows the extension to be created in the Questionnaire Response:</p>\n<p>\"extension\" : {<br>\n        \"url\" : \"<a href=\"http://hl7.org/fhir/StructureDefinition/workflow-researchStudy\">http://hl7.org/fhir/StructureDefinition/workflow-researchStudy</a>\",<br>\n        \"valueUrl\" : \"<a href=\"http://hapi.fhir.org/baseR4/ResearchStudy/2126240\">http://hapi.fhir.org/baseR4/ResearchStudy/2126240</a>\"<br>\n    }</p>\n<p>but then the Questionnaire Response won't validate.</p>",
        "id": 246477135,
        "sender_full_name": "Diane",
        "timestamp": 1626711693
    },
    {
        "content": "<p>It should be \"valueReference\", not \"value\"</p>",
        "id": 246477274,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1626711761
    },
    {
        "content": "<p>Thank you.  This syntax has fixed everything.    In case anyone else needs the workflow-researchStudy extension, this is the correct syntax:<br>\n      [<br>\n                   {<br>\n                       \"url\" : \"<a href=\"http://hl7.org/fhir/StructureDefinition/workflow-researchStudy\">http://hl7.org/fhir/StructureDefinition/workflow-researchStudy</a>\",<br>\n                       \"valueReference\" : {<br>\n                            \"reference\" : \"<a href=\"http://hapi.fhir.org/baseR4/ResearchStudy/2126240\">http://hapi.fhir.org/baseR4/ResearchStudy/2126240</a>\",<br>\n                            \"display\" : \"2126240\"<br>\n                        }<br>\n            }<br>\n    ]</p>",
        "id": 246524024,
        "sender_full_name": "Diane",
        "timestamp": 1626734273
    }
]