[
    {
        "content": "<p>How to define an enable-when for a group according another group's score  ?</p>\n<p>For example, Group 1 and Group 2. </p>\n<p>Group 2 only show when the score of Group 1 is more than 10.</p>",
        "id": 254646608,
        "sender_full_name": "SAM TSAI",
        "timestamp": 1632455659
    },
    {
        "content": "<p>I think that might be a combination of calculatedExpression to score the groups, and enableWhenExpression to evaluate the score and show/hide  group 2 accordingly. If you don't care about the score for group 1 as an individual field/variable then you could potentially also bake the scoring into the enableWhenExpression.</p>",
        "id": 254713093,
        "sender_full_name": "Tilo Christ",
        "timestamp": 1632493691
    },
    {
        "content": "<p>Typically if you have a score for group 1, you'll have a read-only (or maybe hidden) question that has the score as an answer.  However, you could just calculate it in a variable if you wished.  If it's a question, you can access it the same way you access any question answer.  If it's a variable, the variable needs to be defined on a common ancestor of group 1 and group 2 so that it's available in the context that group 2's enableWhen is evaluated in</p>",
        "id": 254714704,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1632494284
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192169\">@Tilo Christ</span> <br>\n Do you define a calculatedExpression under a group by adding \"modifierExtension\" with sdc-questionnaire-calculatedExpression ?<br>\nLike this:<br>\n{<br>\n  \"code\": [<br>\n    {<br>\n      \"code\": \"DemoGroup081721\",<br>\n      \"display\": \"DemoGroup\"<br>\n    }<br>\n  ],<br>\n  \"item\": [<br>\n    {<br>\n      \"key\": 0,<br>\n      \"code\": [<br>\n        {<br>\n          \"code\": \"714DemoYesNo\",<br>\n          \"display\": \"Are you taking prescription medications?\"<br>\n        }<br>\n      ],<br>\n      \"text\": \"Are you taking prescription medications?\",<br>\n      \"type\": \"boolean\",<br>\n      \"linkId\": \"714DemoYesNo\",<br>\n      \"required\": false,<br>\n      \"extension\": [<br>\n        {<br>\n          \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl\">http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl</a>\",<br>\n          \"valueCodeableConcept\": {<br>\n            \"coding\": [<br>\n              {<br>\n                \"code\": \"radio-button\",<br>\n                \"system\": \"<a href=\"http://hl7.org/fhir/questionnaire-item-control\">http://hl7.org/fhir/questionnaire-item-control</a>\",<br>\n                \"display\": \"Radio Button\"<br>\n              }<br>\n            ]<br>\n          }<br>\n        }<br>\n      ],<br>\n      \"answerOption\": [<br>\n        {<br>\n          \"extension\": [<br>\n            {<br>\n              \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/ordinalValue\">http://hl7.org/fhir/StructureDefinition/ordinalValue</a>\",<br>\n              \"valueDecimal\": \"1\"<br>\n            }<br>\n          ],<br>\n          \"valueCoding\": {<br>\n            \"code\": \"false\",<br>\n            \"display\": \"No\"<br>\n          }<br>\n        },<br>\n        {<br>\n          \"extension\": [<br>\n            {<br>\n              \"url\": \"<a href=\"http://hl7.org/fhir/StructureDefinition/ordinalValue\">http://hl7.org/fhir/StructureDefinition/ordinalValue</a>\",<br>\n              \"valueDecimal\": \"2\"<br>\n            }<br>\n          ],<br>\n          \"valueCoding\": {<br>\n            \"code\": \"true\",<br>\n            \"display\": \"Yes\"<br>\n          }<br>\n        }<br>\n      ],<br>\n      \"groupDisplay\": true<br>\n    }<br>\n  ],<br>\n  \"text\": \"DemoGroup\",<br>\n  \"type\": \"group\",<br>\n  \"linkId\": \"DemoGroup081721\",<br>\n  \"required\": false,<br>\n  \"groupDisplay\": true,<br>\n  \"modifierExtension\": {<br>\n    \"url\": \"<a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression</a>\",<br>\n    \"value\": \"??\"<br>\n  }<br>\n}</p>",
        "id": 255127576,
        "sender_full_name": "SAM TSAI",
        "timestamp": 1632780210
    },
    {
        "content": "<p>calculatedExpression is not a modifier extension.  It doesn't change the meaning of other elements</p>",
        "id": 255128590,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1632780722
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <br>\nIs this correct ?</p>\n<p>\"text\": \"DemoGroup\",<br>\n  \"type\": \"group\",<br>\n  \"linkId\": \"DemoGroup081721\",<br>\n  \"required\": false,<br>\n  \"groupDisplay\": true,<br>\n  \"extension\": [<br>\n    {<br>\n      \"url\": \"<a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression</a>\",<br>\n      \"valueExpression\": {<br>\n        \"language\": \"text/fhirpath\",<br>\n        \"expression\": \"%resource.repeat(item).where(linkId='4.3.b').item.answer.oridinalValue().aggregate($this +$total,0)\",<br>\n        \"description\": \"Total score\"<br>\n      }<br>\n    }<br>\n  ]</p>",
        "id": 255148855,
        "sender_full_name": "SAM TSAI",
        "timestamp": 1632793797
    },
    {
        "content": "<p>What is 'groupDisplay'?  And you can't put a calculatedExpression on a 'group' item - it has to be a question item that can actually hold the value as an answer.</p>",
        "id": 255149850,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1632794614
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <br>\nok. got it. Thanks a lot!</p>",
        "id": 255150606,
        "sender_full_name": "SAM TSAI",
        "timestamp": 1632795270
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"192169\">@Tilo Christ</span> <br>\n\"If you don't care about the score for group 1 as an individual field/variable then you could potentially also bake the scoring into the enableWhenExpression.\" </p>\n<p>Do you mean I can just reply on enableWhenExpression defined in group 2 to complete this whole functionality? <br>\nLike this: </p>\n<p>{<br>\n  \"code\": [<br>\n    {<br>\n      \"code\": \"G2\",<br>\n      \"display\": \"Multiple Levels Branching Sample\"<br>\n    }<br>\n  ],<br>\n  \"text\": \"Prescription drugs - ENABLE WHEN -New\",<br>\n  \"type\": \"group\",<br>\n  \"linkId\": \"G2\",<br>\n  \"required\": false,<br>\n  \"extension\": [<br>\n    {<br>\n      \"url\": \"<a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression</a>\",<br>\n      \"valueExpression\": {<br>\n        \"language\": \"text/fhirpath\",<br>\n        \"expression\": \"%resource.repeat(item).where(linkId='G1').item.answer.oridinalValue().aggregate($this +$total,0) &gt; 10\"<br>\n      }<br>\n    }<br>\n  ]<br>\n}</p>",
        "id": 255150675,
        "sender_full_name": "SAM TSAI",
        "timestamp": 1632795354
    },
    {
        "content": "<p>Yup, that should work if you have no need to actually capture the score in the QuestionnaireResponse.</p>",
        "id": 255150818,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1632795461
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <br>\nThanks a lot!<br>\nThis is super helpful!</p>",
        "id": 255150946,
        "sender_full_name": "SAM TSAI",
        "timestamp": 1632795563
    }
]