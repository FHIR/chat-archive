[
    {
        "content": "<p>I have questionnaire examples I would like to validate.  How would one use the java validator to do that?  I tried:<br>\n<code>java -jar ~/tmp/org.hl7.fhir.publisher.jar -version 4.0.1  -ig http://hl7.org/fhir/uv/sdc -profile http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire sample.json</code><br>\nbut I get 'Unable to find the nominated IG', so I guess at the least I have the URI for the sdc ig wrong.  (I looked around <a href=\"https://build.fhir.org/ig/HL7/sdc/\">https://build.fhir.org/ig/HL7/sdc/</a>, but could not find a statement as to what IG URI is supposed to be.)</p>",
        "id": 201209095,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592433208
    },
    {
        "content": "<p>you could grab the package.tgz file from the CI build and specify the file location for that as your 'ig' parameter - that should work.</p>",
        "id": 201209361,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1592433392
    },
    {
        "content": "<p>Would that be the \"here\" link at <a href=\"https://build.fhir.org/ig/HL7/sdc/downloads.html\">https://build.fhir.org/ig/HL7/sdc/downloads.html</a>?  It downloads full-ig.zip, which did not make the validator happy.  (Error Reading JSON Config file at /.../full-ig.zip)</p>",
        "id": 201209639,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592433611
    },
    {
        "content": "<p>you should never need to download a .tgz file</p>",
        "id": 201209681,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592433637
    },
    {
        "content": "<p>that set of parameters works for me</p>",
        "id": 201209698,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592433660
    },
    {
        "content": "<p>what version of the validator are you using? what's the full log?</p>",
        "id": 201209713,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592433677
    },
    {
        "content": "<p>It would be <a href=\"https://build.fhir.org/ig/HL7/sdc/package.tgz\">https://build.fhir.org/ig/HL7/sdc/package.tgz</a></p>",
        "id": 201209793,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1592433726
    },
    {
        "content": "<p>I downloaded it from here:  <a href=\"https://wiki.hl7.org/Using_the_FHIR_Validator\">https://wiki.hl7.org/Using_the_FHIR_Validator</a> (<a href=\"https://storage.googleapis.com/ig-build/org.hl7.fhir.publisher.jar\">https://storage.googleapis.com/ig-build/org.hl7.fhir.publisher.jar</a>)</p>",
        "id": 201209794,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592433727
    },
    {
        "content": "<p>that doesn't answer my question</p>",
        "id": 201209960,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592433878
    },
    {
        "content": "<p>The full output is:<br>\nFHIR IG Publisher Version 1.0.100-SNAPSHOT (Git# 6c6b419dd19f). Built 2020-06-07T09:06:40.927+10:00 (10 days old)<br>\nDetected Java version: 1.8.0_252 from /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.252.b09-2.el7_8.x86_64/jre on amd64 (64bit). 3543MB available<br>\nParameters: -version 4.0.1 -ig package.tgz -profile <a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire</a> weight-height-questionnaire.json<br>\ndir = /home/plynch/project/lforms-fhir-app/e2e-tests/data/R4, path = /home/plynch/node-v10.15.2-linux-x64/bin:/bin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/etc:/home/plynch/project/lforms-fhir-app/node_modules/.bin:/opt/puppetlabs/bin<br>\nRun time = Wednesday, June 17, 2020 6:44:26 PM EDT (2020-06-17T18:44:26-04:00)<br>\nPackage Cache: /home/plynch/.fhir/packages                                       (00:00.0047)<br>\nLoad Configuration from /home/plynch/project/lforms-fhir-app/e2e-tests/data/R4/package.tgz (00:00.0181)<br>\nPublishing Content Failed: Error Reading JSON Config file at /home/plynch/project/lforms-fhir-app/e2e-tests/data/R4/package.tgz: Error parsing JSON source: Unexpected char '' in json stream at Line 1 (path=[null]) (00:00.0273)<br>\n                                                                                 (00:00.0273)<br>\nUse -? to get command line help                                                  (00:00.0274)<br>\n                                                                                 (00:00.0274)<br>\nStack Dump (for debugging):                                                      (00:00.0274)<br>\njava.lang.Exception: Error Reading JSON Config file at /home/plynch/project/lforms-fhir-app/e2e-tests/data/R4/package.tgz: Error parsing JSON source: Unexpected char '' in json stream at Line 1 (path=[null])<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.initializeFromJson(Publisher.java:1860)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1329)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:692)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7533)<br>\nCaused by: java.io.IOException: Error parsing JSON source: Unexpected char '' in json stream at Line 1 (path=[null])<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.error(JsonTrackingParser.java:205)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.next(JsonTrackingParser.java:337)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.start(JsonTrackingParser.java:230)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser$Lexer.&lt;init&gt;(JsonTrackingParser.java:141)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:404)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:400)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:392)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser.parse(JsonTrackingParser.java:388)<br>\n        at org.hl7.fhir.utilities.json.JsonTrackingParser.parseJsonFile(JsonTrackingParser.java:384)<br>\n        at org.hl7.fhir.igtools.publisher.Publisher.initializeFromJson(Publisher.java:1858)</p>",
        "id": 201210100,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592434001
    },
    {
        "content": "<p>oh.</p>",
        "id": 201210173,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592434068
    },
    {
        "content": "<p>you're running the wrong thing, and the link is wrong</p>",
        "id": 201210242,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592434095
    },
    {
        "content": "<p>The confluence version of that page (<a href=\"https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Validator\">https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Validator</a>) has the right link.  I will try that.  Should I file an issue against the page with the wrong link, which says it has been migrated?</p>",
        "id": 201210622,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592434419
    },
    {
        "content": "<p>well, that's still the wrong link, but it's only the wrong version and probably not wrong enough to matter.</p>",
        "id": 201210740,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592434510
    },
    {
        "content": "<p>I'll fix both of them</p>",
        "id": 201210752,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592434514
    },
    {
        "content": "<p>Now I am getting \"Must provide at least one source file\" but I think I am:<br>\n$ java -jar org.hl7.fhir.validator.jar -version 4.0.1  -ig <a href=\"http://hl7.org/fhir/uv/sdc\">http://hl7.org/fhir/uv/sdc</a> -profile <a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire</a>  ./weight-height-questionnaire.json <br>\nFHIR Validation tool Version 5.0.7-SNAPSHOT (Git# 6bc790d98b04). Built 2020-06-07T08:35:37.25+10:00 (11 days old)<br>\nDetected Java version: 1.8.0_252 from /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.252.b09-2.el7_8.x86_64/jre on amd64 (64bit). 3543MB available<br>\nArguments: -version 4.0.1 -ig <a href=\"http://hl7.org/fhir/uv/sdc\">http://hl7.org/fhir/uv/sdc</a> -profile <a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire</a> ./weight-height-questionnaire.json<br>\nDirectories: Current = /home/plynch/project/lforms-fhir-app/e2e-tests/data/R4, Package Cache = /home/plynch/.fhir/packages<br>\nException in thread \"main\" java.lang.Exception: Must provide at least one source file<br>\n        at org.hl7.fhir.validation.cli.utils.Params.loadCliContext(Params.java:215)<br>\n        at org.hl7.fhir.validation.Validator.main(Validator.java:171)</p>",
        "id": 201210879,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592434661
    },
    {
        "content": "<p>that's a bug I just fixed but on that release, you must put the -profile command last</p>",
        "id": 201210942,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1592434690
    },
    {
        "content": "<p>Okay, that worked, thanks!  Now I just have some issues to fix with my sample questionnaire.</p>",
        "id": 201211213,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592434876
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span> Inferno team created a UI wrapper for validator.jar making it easier to use. <a href=\"https://inferno.healthit.gov/validator\">https://inferno.healthit.gov/validator</a></p>",
        "id": 201270942,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1592488605
    },
    {
        "content": "<p>Thanks.  It is a nice UI, but it looks like it is missing the SDC IG (I guess because the new one is not yet published.)</p>",
        "id": 201272210,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1592489162
    },
    {
        "content": "<p>it supports at profile level. If the profile is resolvable, like most of the US Core, validator will download profile automatically. Otherwise, you can save the profile, such as  <a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire</a> StructureDefinition, to a JOSN file and upload/paste to the profile section. There is a limitation that it can only upload one profile, which means, you cannot validate most of the extensions in a resource. Inferno team is working on that.</p>",
        "id": 201275356,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1592490543
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179255-questionnaire/topic/Validating.20an.20SDC.20Questionnaire/near/201209793\">said</a>:</p>\n<blockquote>\n<p>It would be <a href=\"https://build.fhir.org/ig/HL7/sdc/package.tgz\">https://build.fhir.org/ig/HL7/sdc/package.tgz</a></p>\n</blockquote>\n<p>Where does one find that link in the <a href=\"https://build.fhir.org/ig/HL7/sdc/\">implementation guide</a>?  I thought it must the on the \"downloads\" <a href=\"https://build.fhir.org/ig/HL7/sdc/downloads.html\">page</a> but couldn't find it.</p>",
        "id": 202149381,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1593209802
    },
    {
        "content": "<p>We don't expose it anywhere because the general expectation is that tools will simply resolve to the one in the HL7 registry</p>",
        "id": 202150858,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593210741
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179255-questionnaire/topic/Validating.20an.20SDC.20Questionnaire/near/202150858\">said</a>:</p>\n<blockquote>\n<p>the one in the HL7 registry</p>\n</blockquote>\n<p>Is that at <a href=\"https://registry.fhir.org/guides\">https://registry.fhir.org/guides</a>?  I don't see links to package.tgz files there either.</p>",
        "id": 202157684,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1593216773
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span></p>",
        "id": 202160254,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1593220301
    },
    {
        "content": "<p>you never need the .tgz file directly, but there's links here: <a href=\"http://hl7.org/fhir/uv/sdc/history.html\">http://hl7.org/fhir/uv/sdc/history.html</a></p>",
        "id": 202215587,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1593310934
    },
    {
        "content": "<p>While implementing the validations on this specific questionnaire</p>\n<div class=\"codehilite\"><pre><span></span><code> &lt;Questionnaire xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n  &lt;item&gt;\n    &lt;linkId value=&quot;q1&quot; /&gt;\n    &lt;type value=&quot;string&quot; /&gt;\n    &lt;required value=&quot;true&quot; /&gt;\n  &lt;/item&gt;\n&lt;/Questionnaire&gt;\n</code></pre></div>\n<p>With this response...</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;QuestionnaireResponse xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n  &lt;item&gt;\n    &lt;linkId value=&quot;q1&quot; /&gt;\n    &lt;answer&gt;\n      &lt;valueString value=&quot;a1&quot; /&gt;\n    &lt;/answer&gt;\n    &lt;answer&gt;\n      &lt;valueString value=&quot;a2&quot; /&gt;\n    &lt;/answer&gt;\n  &lt;/item&gt;\n&lt;/QuestionnaireResponse&gt;\n</code></pre></div>\n<p>Would this OperationOutcome seem reasonable?</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;OperationOutcome xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n  &lt;issue&gt;\n    &lt;severity value=&quot;error&quot; /&gt;\n    &lt;code value=&quot;business-rule&quot; /&gt;\n    &lt;details&gt;\n      &lt;coding&gt;\n        &lt;system value=&quot;http://fhir.forms-lab.com/CodeSystem/errors&quot; /&gt;\n        &lt;code value=&quot;repeats&quot; /&gt;\n        &lt;display value=&quot;multiple values&quot; /&gt;\n      &lt;/coding&gt;\n      &lt;text value=&quot;q1: Provided 2 answers for a question that only permits 1 answer&quot; /&gt;\n    &lt;/details&gt;\n    &lt;location value=&quot;linkId=&#39;q1&#39;&quot; /&gt;\n    &lt;expression value=&quot;QuestionnaireResponse.item[0]&quot; /&gt;\n  &lt;/issue&gt;\n&lt;/OperationOutcome&gt;\n</code></pre></div>\n<p>The specific part I'm not 100% sure on what I should have in the expression there, it could also have these...</p>\n<div class=\"codehilite\"><pre><span></span><code>    &lt;expression value=&quot;QuestionnaireResponse.item[0].answer[0].value&quot; /&gt;\n    &lt;expression value=&quot;QuestionnaireResponse.item[0].answer[1].value&quot; /&gt;\n</code></pre></div>",
        "id": 276603958,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648206757
    },
    {
        "content": "<p>Reason for this would be important would be for the renderer to be able to include the error message with the appropriate field...</p>",
        "id": 276604140,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648206874
    },
    {
        "content": "<p>There are no expectations around if or how location and expression are populated - because different systems will have different abilities to detect location.</p>",
        "id": 276629380,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1648219723
    },
    {
        "content": "<p>location is deprecated, so don't really consider that one, but the expression I would have thought was pretty specific, and quite processable.</p>",
        "id": 276686568,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648246810
    },
    {
        "content": "<p>I'm implementing the Choice type validations now and reviewing the extension <code>http://hl7.org/fhir/extension-11179-permitted-value-valueset.html</code> for inclusion, and I'm not understanding if this applied to choice questions (if this, what's different to answerValueSet?), or just string values? (and if so, is it matching the <code>display</code> or <code>code</code> value?)</p>",
        "id": 276749691,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648334223
    },
    {
        "content": "<p>It's about \"how is the data stored in the database\".  I don't know why you'd want to support it.  It's very much a data element thing, not so much a questionnaire thing.</p>",
        "id": 276764234,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1648355248
    },
    {
        "content": "<p>Cool, its on the set of extensions on questionnaire, hence the question.</p>",
        "id": 276773836,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648367905
    },
    {
        "content": "<p>I thought maybe it was the one where you can bind a string to a valueset (such as town or postcode) but in a questionnaire I'd just use a choice or open-choice with autocomplete.</p>",
        "id": 276773871,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648367970
    },
    {
        "content": "<p>Validating an attachment type, there is a maxLength property that you can use to limit the length of an attachment, can you use the minLength extension to also restrict the minimum length of an attachment?<br>\n(for cases where you might want to use that to verify that an image is of a sufficient size e.g. &gt; 4k to ensure that not attaching corrupt content)</p>",
        "id": 276990861,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648553509
    },
    {
        "content": "<p>There's a maxSize, not a maxLength.  We don't have a minSize.  But I suppose we could define one...</p>",
        "id": 277017837,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1648566008
    },
    {
        "content": "<p>Thanks. Will cleanup my code.</p>",
        "id": 277053169,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1648581644
    }
]