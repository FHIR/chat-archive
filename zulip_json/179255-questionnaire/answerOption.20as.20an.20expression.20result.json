[
    {
        "content": "<p>In a questionnaire, I want to use a calculated expression like if the answer to question 1 or 2 is x,  then populate question 3 with \"Approved\", but I don't want the string \"Approved\", I want the coding from the answerOption for question 3. </p>\n<p>A. Which of these do I want my fhirpath expression to return?</p>\n<ol>\n<li>\n<p>[{\"system\":\"www.terminologyexample.com\",\"code\":\"Approved\",\"display\":\"Approved\"}]</p>\n</li>\n<li>\n<p>[{\"valueCoding\":{\"system\":\"www.terminologyexample.com\",\"code\":\"Approved\",\"display\":\"Approved\"}}]</p>\n</li>\n<li>\n<p>\"answerOption\":[{\"valueCoding\":{\"system\":\"www.terminologyexample.com\",\"code\":\"Approved\",\"display\":\"Approved\"}}]</p>\n</li>\n</ol>\n<p>B. For the syntax, this is what seems to work in the fhirpath tester,  but it doesn't work in LHC Forms:</p>\n<p>iif(conditional for Question1 or Question2, %questionnaire.item.where(linkId = 'Question3').answerOption.where(valueCoding.display = 'Approved'))</p>\n<p>Since I am referring to the answerOption for question 3 from an extension on question 3, should my expression be more local like:</p>\n<p>iif(conditional for Question1 or Question2,  %item.answerOption.where(valueCoding.display = 'Approved'))</p>\n<p>or</p>\n<p>iif(conditional for Question1 or Question2,  %answerOption.where(valueCoding.display = 'Approved'))</p>\n<p>C. And how do I know if I need a % or not?   Should the syntax be %item.answerOption...   or item.answerOption...</p>",
        "id": 274329910,
        "sender_full_name": "Diane",
        "timestamp": 1646603148
    },
    {
        "content": "<p>a) you would want #2.  However, there should be an \"http://\" at the start of your system.<br>\nb) driving off 'display' is usually a bad idea - it's supposed to be for human consumption and it can change at any time without any expectation it'll impact code.  Is there a reason you can't know what the 'code' is for approved?<br>\nc) '%' is used when you're referencing a context variable.  So if you're referring to an element name within context, you don't need/want it.  When you're referring to a special context variable (%context, %resource, %questionnaire, etc.) you do.</p>",
        "id": 274333698,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1646607871
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  I think the answer to (a) is #1.  That is the Coding.</p>",
        "id": 274472513,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1646694627
    }
]