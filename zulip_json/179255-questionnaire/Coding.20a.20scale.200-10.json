[
    {
        "content": "<p>I want to code the visual analogue scale (VAS) for pain intensity. It is a value between 0 \"no pain\" to 10 \"worst imaginable pain\". Its LOINC code, for example, would be 38214-3, see <a href=\"https://loinc.org/38214-3/\" target=\"_blank\" title=\"https://loinc.org/38214-3/\">https://loinc.org/38214-3/</a>.</p>\n<p>I wonder how to code that value. I was looking at an example for QuestionnnaireResponse (<a href=\"http://hl7.org/fhir/STU3/questionnaireresponse-example-gcs.json\" target=\"_blank\" title=\"http://hl7.org/fhir/STU3/questionnaireresponse-example-gcs.json\">http://hl7.org/fhir/STU3/questionnaireresponse-example-gcs.json</a>) that encodes the Glasgow Coma Score. The example suggests to use the valueCoding element of an answer element to provide e.g. the LOINC code for VAS and then extend the valueCoding element to also hold the decimal / integer value for the VAS. </p>\n<ol>\n<li>Is that how it should be done?</li>\n<li>How would I encode the fact that only values between 0 and 10 are allowed for an answer element in the QuestionnaireResponse?</li>\n</ol>",
        "id": 183647420,
        "sender_full_name": "Marco Wedekind",
        "timestamp": 1576589043
    },
    {
        "content": "<p>w.r.t. 2) Structured Data Capture, <a href=\"http://hl7.org/fhir/uv/sdc/2019May/\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/sdc/2019May/\">http://hl7.org/fhir/uv/sdc/2019May/</a>, defines extensions for minValue and maxValue of data elements. I guess this is the way to go then?</p>",
        "id": 183650310,
        "sender_full_name": "Marco Wedekind",
        "timestamp": 1576591209
    },
    {
        "content": "<p>Are there images that go along with the choices?</p>\n<p>You could use answerOption with valueInteger and enumerate the options.</p>",
        "id": 183677987,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1576608509
    },
    {
        "content": "<p>There's an ability to capture images (or a mix of images and text) using the HTML extension extension on the options</p>",
        "id": 183700678,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1576623265
    },
    {
        "content": "<p><a href=\"https://www.hl7.org/fhir/extension-rendering-xhtml.html\" target=\"_blank\" title=\"https://www.hl7.org/fhir/extension-rendering-xhtml.html\">https://www.hl7.org/fhir/extension-rendering-xhtml.html</a></p>",
        "id": 183704536,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1576626236
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> This page: <a href=\"http://build.fhir.org/ig/HL7/sdc/rendering.html#text-appearance\" target=\"_blank\" title=\"http://build.fhir.org/ig/HL7/sdc/rendering.html#text-appearance\">http://build.fhir.org/ig/HL7/sdc/rendering.html#text-appearance</a> does not mention answerOption as a place rendering-xhtml can be.</p>",
        "id": 183704771,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1576626454
    },
    {
        "content": "<p>It can appear anywhere there's a string.  I've submitted a change request to add it to choice.</p>",
        "id": 183714626,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1576637225
    },
    {
        "content": "<blockquote>\n<p>w.r.t. 2) Structured Data Capture, <a href=\"http://hl7.org/fhir/uv/sdc/2019May/\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/sdc/2019May/\">http://hl7.org/fhir/uv/sdc/2019May/</a>, defines extensions for minValue and maxValue of data elements. I guess this is the way to go then?</p>\n</blockquote>\n<p>I think the SDC extensions are the way to go. The Questionaire could look like this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"p\">{</span>\n    <span class=\"nt\">&quot;status&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;draft&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;resourceType&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Questionnaire&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;meta&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;profile&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s2\">&quot;http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire|2.7&quot;</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"nt\">&quot;item&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;type&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;decimal&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;38214-3&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;display&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Pain severity Score VAS&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;system&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://loinc.org&quot;</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">],</span>\n        <span class=\"nt\">&quot;extension&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">&quot;url&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://hl7.org/fhir/StructureDefinition/minValue&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;valueDecimal&quot;</span><span class=\"p\">:</span> <span class=\"mi\">0</span>\n          <span class=\"p\">},</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">&quot;url&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://hl7.org/fhir/StructureDefinition/maxValue&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;valueDecimal&quot;</span><span class=\"p\">:</span> <span class=\"mi\">10</span>\n          <span class=\"p\">},</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">&quot;url&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://hl7.org/fhir/StructureDefinition/questionnaire-unit&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;valueCoding&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">&quot;display&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;{score}&quot;</span>\n            <span class=\"p\">}</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">],</span>\n        <span class=\"nt\">&quot;required&quot;</span><span class=\"p\">:</span> <span class=\"kc\">false</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;linkId&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;/38214-3&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;text&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Pain severity Score VAS&quot;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">}</span>\n</pre></div>\n\n\n<p>and the QuestionnaireResponse like this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"p\">{</span>\n    <span class=\"nt\">&quot;resourceType&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;QuestionnaireResponse&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;meta&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"nt\">&quot;profile&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s2\">&quot;http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaireresponse|2.7&quot;</span>\n      <span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"nt\">&quot;status&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;completed&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;authored&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;2019-12-18T08:51:00.439Z&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;item&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;linkId&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;/38214-3&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;text&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Pain severity Score VAS&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;answer&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">&quot;valueDecimal&quot;</span><span class=\"p\">:</span> <span class=\"mi\">3</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">}</span>\n</pre></div>",
        "id": 183733468,
        "sender_full_name": "Julian Sass",
        "timestamp": 1576661616
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"194952\">@Julian Sass</span> Note that the \"decimal\" type would allow for a response of \"3.25\".  (Perhaps that is okay?)</p>",
        "id": 183759429,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1576682650
    },
    {
        "content": "<blockquote>\n<p>It can appear anywhere there's a string.  I've submitted a change request to add it to choice.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> What is the change request number?  Although rendering-xhtml itself says it can apply to any string, there is nothing in the SDC specification to cause one to expect support for rendering-xhtml except in the enumerated cases.</p>",
        "id": 183759521,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1576682743
    },
    {
        "content": "<p><a href=\"http://jira.hl7.org/browse/FHIR-25388\" target=\"_blank\" title=\"http://jira.hl7.org/browse/FHIR-25388\">J#25388</a></p>",
        "id": 183766137,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1576686812
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"194952\">Julian Sass</span> Note that the \"decimal\" type would allow for a response of \"3.25\".  (Perhaps that is okay?)</p>\n</blockquote>\n<p>You're right <span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span>. This should be an integer type to only allow 0-10 for a response.</p>",
        "id": 183770462,
        "sender_full_name": "Julian Sass",
        "timestamp": 1576689756
    },
    {
        "content": "<p>How do we mark a VAS question that it should be rendered as VAS?</p>",
        "id": 209077536,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599215514
    },
    {
        "content": "<p>VAS?</p>",
        "id": 209084751,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1599220773
    },
    {
        "content": "<p><a href=\"https://en.wikipedia.org/wiki/Visual_analogue_scale\">Visual Analog Scale</a>, a \"psychometric response scale which can be used in questionnaires\" (from link)</p>",
        "id": 209091479,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1599225048
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191451\">@Patrick Werner</span> We also also discussing exactly this at the moment. We are looking at reported pain values and encode the question using <a href=\"https://loinc.org/72514-3/\">LOINC 72514-3 (Pain severity - 0-10 verbal numeric rating [Score] - Reported)</a>. That code has the associated answer set <a href=\"https://loinc.org/LL2335-9/\">LOINC LL2335-9 (Numeric rating scale from 0-10 / Score of 0-10)</a>, which is the ValueSet with canonical <a href=\"http://loinc.org/vs/LL2335-9\">http://loinc.org/vs/LL2335-9</a>. I suppose one could take the use of this value set as the set of answers to a question as a hint to renders it as a 0-10 scale. However, as discussed in <a href=\"#narrow/stream/179202-terminology/topic/Dealing.20with.20value.20sets.20with.20an.20intrinsic.20ordering\">this recent thread in <a class=\"stream\" data-stream-id=\"179202\" href=\"/#narrow/stream/179202-terminology\">#terminology</a> </a>, the ValueSet does not carry the ordinal-value extension to indicate the numerical equivalent of each code, so the UI would have to know the (numeric) meaning of each code.</p>\n<p>We are currently leaning toward the rather crude solution of using the <a href=\"http://hl7.org/fhir/R4/extension-questionnaire-itemcontrol.html\">item-control extension</a> on the question, with a custom code to indicate that this is exactly such a scale result (and assume that the UI is clever enough to understand what that means, including the meaning of each LOINC code for 0-10). But I would also be happy to in hear about alternatives.</p>",
        "id": 209092814,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1599225836
    },
    {
        "content": "<p>Structured Data Capture provides guidance on the use of an extension to allow you to send parallel XHTML for the question.  The XHTML can include an image reference.  See the example here: <a href=\"http://build.fhir.org/ig/HL7/sdc/examples.html#using-answeroption-and-rendering-xhtml\">http://build.fhir.org/ig/HL7/sdc/examples.html#using-answeroption-and-rendering-xhtml</a></p>",
        "id": 209093794,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1599226358
    },
    {
        "content": "<p>0-10 numeric is different from a analog scale. (Pain VAS is often captured as a Integere from 0-100, as this represents the mm Value of the marked position.)</p>",
        "id": 209094694,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599226908
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179255-questionnaire/topic/Coding.20a.20scale.200-10/near/209093794\">said</a>:</p>\n<blockquote>\n<p>Structured Data Capture provides guidance on the use of an extension to allow you to send parallel XHTML for the question.  The XHTML can include an image reference.  See the example here: <a href=\"http://build.fhir.org/ig/HL7/sdc/examples.html#using-answeroption-and-rendering-xhtml\">http://build.fhir.org/ig/HL7/sdc/examples.html#using-answeroption-and-rendering-xhtml</a></p>\n</blockquote>\n<p>Thanks, this is great for numeric scales, but doesn't cover analog scales.</p>",
        "id": 209094811,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599226964
    },
    {
        "content": "<p>As i didn't find a proper extension, we are currently thinking about a custom extension, containing a CC to express the desired \"render-style\"</p>",
        "id": 209094919,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599227019
    },
    {
        "content": "<p>Sorry for not fully reading the answer properly.  So the issue is you want to use a 'scale' control, even though the answers will technically be codes.  If the associated codes have ordinal values, that could probably work - though we'd want to add some clarifying language in the item-control extension specifically highlighting that that was an allowed use.</p>",
        "id": 209110490,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1599234784
    },
    {
        "content": "<p>Yes i want to express that the questionnaire should be rendered as a VAS. Answer would be Integer with min and max values.</p>",
        "id": 209117746,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599238953
    },
    {
        "content": "<p>example: <a href=\"/user_uploads/10155/JL0OBg0peCZtTaamM_UuUGJU/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/JL0OBg0peCZtTaamM_UuUGJU/image.png\" title=\"image.png\"><img src=\"/user_uploads/10155/JL0OBg0peCZtTaamM_UuUGJU/image.png\"></a></div>",
        "id": 209117766,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599238967
    },
    {
        "content": "<p>the image above would be optional.</p>",
        "id": 209117807,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599238996
    },
    {
        "content": "<p>Is that a linear slider control with no tics, or one that stops at exactly the 0,1,2..9,10 values from a coding?</p>",
        "id": 209140649,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1599253375
    },
    {
        "content": "<p>I think it would be good to have support for a VAS without having to do an image</p>",
        "id": 209159576,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1599277092
    },
    {
        "content": "<p>except that there's no way that's going to happen for the pain scale above. they're kind of special thouh</p>",
        "id": 209159581,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1599277131
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191367\">Brian Postlethwaite</span> <a href=\"#narrow/stream/179255-questionnaire/topic/Coding.20a.20scale.200-10/near/209140649\">said</a>:</p>\n<blockquote>\n<p>Is that a linear slider control with no tics, or one that stops at exactly the 0,1,2..9,10 values from a coding?</p>\n</blockquote>\n<p>no tics.</p>",
        "id": 209169228,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599296966
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179255-questionnaire/topic/Coding.20a.20scale.200-10/near/209159581\">said</a>:</p>\n<blockquote>\n<p>except that there's no way that's going to happen for the pain scale above. they're kind of special thouh</p>\n</blockquote>\n<p>It is. For the pain scale the \"render this as VAS\" and the image would have to be combined. Our primary use-case is just having a way to express VAS items in the Questionnaire, without any images.</p>",
        "id": 209169278,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1599297062
    },
    {
        "content": "<p>Is my understanding correct that you want to use a numeric scale control for data display/capture, but the data themselves are codes?</p>",
        "id": 209179308,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1599314356
    },
    {
        "content": "<p>Normally a VAS reports its values as integer 0-100 or float: 0,0-10,0, so it is not coded data</p>",
        "id": 213262843,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1602666638
    }
]