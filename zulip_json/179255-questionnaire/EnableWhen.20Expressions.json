[
    {
        "content": "<p><a href=\"http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983\">http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983</a></p>",
        "id": 198169287,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1589964131
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"217312\">@Joee Garcia</span> Do we have one for this yet?</p>",
        "id": 198211401,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1589987027
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> , I've just added the demo questionnaire I'm working on for advanced form behavior here: <a href=\"http://build.fhir.org/ig/HL7/sdc/behavior.html#example\">http://build.fhir.org/ig/HL7/sdc/behavior.html#example</a> .  It has an example on how to use enableWhenExpression.</p>",
        "id": 198236540,
        "sender_full_name": "Joee Garcia",
        "timestamp": 1589998377
    },
    {
        "content": "<p>When looking at the example (I think the url is now: <a href=\"http://build.fhir.org/ig/HL7/sdc/examples.html#using-enablewhen-enablebehavior-and-enablewhenexpression\">http://build.fhir.org/ig/HL7/sdc/examples.html#using-enablewhen-enablebehavior-and-enablewhenexpression</a>) I noticed that it uses <code>%resource.repeats(item).where(...)</code>. As I understand <code>%resource</code> is the same for all items in the Questionnaire and when items can repeat this may be a problem. I think I found a nice solution and posted it in the mentioned thread (this reply: <a href=\"http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983/8\">http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983/8</a>) Since there has not yet been a reply to this post, I would like to ask if there are people here who could look at it.</p>",
        "id": 203932813,
        "sender_full_name": "Bas Harmsen",
        "timestamp": 1594805173
    },
    {
        "content": "<p>That example should be \"repeat(item)\" not \"repeats(item)\".  It is using the repeat function in FHIRPath: <a href=\"http://hl7.org/fhirpath/#repeatprojection-expression-collection\">http://hl7.org/fhirpath/#repeatprojection-expression-collection</a>, not item.repeats.</p>",
        "id": 203972160,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1594827611
    },
    {
        "content": "<p>Reading my message again I see that it's a little bit confusing. I'm aware of the <code>repeat</code> function but I forgot that it's called <code>repeat</code> and not <code>repeats</code>. So the first repeats in my message refers to the FHIRpath <code>repeat</code>-function and the second one to the <code>repeats</code>-element in a Questionnaire.</p>\n<p>The problem I see is that there is no context when using <code>%resource.repeat(item).where(...)</code> and the <code>repeats</code> element is set to true for some group-item. When a group can repeat and one of the items should only be enabled in the case that a given item in the same group meets some condition then the expression should be evaluated in a certain context. It seems to me that<code>'%resource.repeat(item).where(...)</code> refers 'globally' to all elements that meet the condition and not just to the item relative to the item for which enableWhenExpression is evaluated.<br>\nEdit: I’m aware that in the example in the implementation guide the item cannot repeat but I’d like to know if my solution for the case that it may repeat is correct.</p>",
        "id": 203981326,
        "sender_full_name": "Bas Harmsen",
        "timestamp": 1594831652
    },
    {
        "content": "<p>Yes, using variables is the appropriate solution when using enableWhen inside repeating groups.</p>",
        "id": 204020146,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1594851613
    },
    {
        "content": "<p>Thanks for your answer.</p>",
        "id": 204059822,
        "sender_full_name": "Bas Harmsen",
        "timestamp": 1594889788
    },
    {
        "content": "<p>The tracker #33295 - Having discussed and reviewed this with Paul, looks like the description is actually now different to invariants - which I don't think was intended.</p>",
        "id": 253465292,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1631730868
    },
    {
        "content": "<p><a href=\"https://github.com/FirelyTeam/firely-net-common/blob/d652305916bcc7fdc32337e5cb71bf8a763c91c3/src/Hl7.FhirPath/FhirPath/CompiledExpression.cs#L28\">https://github.com/FirelyTeam/firely-net-common/blob/d652305916bcc7fdc32337e5cb71bf8a763c91c3/src/Hl7.FhirPath/FhirPath/CompiledExpression.cs#L28</a></p>",
        "id": 253465471,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1631730949
    }
]