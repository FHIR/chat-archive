[
    {
        "content": "<p>Does LHCForms parse quantity type? I don't get it to display the value and units, only a string entry</p>",
        "id": 270764462,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644004414
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span> ?</p>",
        "id": 270772386,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644008669
    },
    {
        "content": "<p>Yes, it does handle valueQuantity.  I will look for an example.</p>",
        "id": 270776831,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1644010844
    },
    {
        "content": "<p><a href=\"https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/R4/vital-sign-questionnaire.json\">https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/R4/vital-sign-questionnaire.json</a></p>",
        "id": 270777274,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1644011133
    },
    {
        "content": "<p>If you upload that to <a href=\"https://lhcforms.nlm.nih.gov/lforms-fhir-app/?server=https%3A%2F%2Flforms-fhir.nlm.nih.gov%2FbaseR4\">https://lhcforms.nlm.nih.gov/lforms-fhir-app/?server=https%3A%2F%2Flforms-fhir.nlm.nih.gov%2FbaseR4</a>, you can save a QR and load it back in.</p>",
        "id": 270777369,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1644011181
    },
    {
        "content": "<p>I see. It only shows up when there's a unitOption - shouldn't we be able to have questionnaire quantities without defining the unit valueset (i.e. leave it open?)</p>",
        "id": 270875360,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644131941
    },
    {
        "content": "<p>And specify the unit as text?</p>",
        "id": 270895847,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644162121
    },
    {
        "content": "<p>Yes</p>",
        "id": 270905005,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644173470
    },
    {
        "content": "<p>Or open choice</p>",
        "id": 270905010,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644173481
    },
    {
        "content": "<p>We ran across this issue as well.  We have study procedures that are done x times  per week,    y times per month, etc  and these fit nicely with the standardized unit valuesets.  But we have other study procedures that are done once per study phase  or two times per treatment cycle, where the length of the study phase or treatment cycle cannot be known ahead of time, because it might depend on how long it takes to recruit participants or how long it takes before there is any response to the treatment.   So, we thought that it would be useful for the use to be able to specify the units such as \"study phase\"  or \"treatment cycle\".     Another example might be a longitudinal study of women over 10 years, where they will be given a test once per pregnancy over a 10 year observation period, where the number and frequency of pregnancies is unknown up front and the unit should be \"pregnancy\".</p>",
        "id": 270912034,
        "sender_full_name": "Diane",
        "timestamp": 1644181824
    },
    {
        "content": "<p>Those aren't units and can't go into Quantity.unit.  Units need to be countable, predictable things that can be added, multiplied and converted to other units.</p>",
        "id": 270914521,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644185069
    },
    {
        "content": "<p>This is sounding more like multiple questions in the form, not use of a quantity.<br>\none for value, and another for coding (optional) and you get a similar outcome.</p>",
        "id": 270917234,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1644188975
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  for explaining how Quantity.unit   is intended to be used.</p>\n<p>We have struggled with this one a bit, because the table of procedures for the research study is a repeating group (gtable) like this (including sample data).  The requirement is that it needs to be shown to the participant with all of the procedures listed by frequency, so that the participants know what they are signing themselves into.</p>\n<div class=\"codehilite\"><pre><span></span><code>procedure                     qty.        unit\n___________________________________________________________\nblood draws             6               year\nbiopsy                      2            year\nvital signs check       4              month\nCTScan                  1            study\nMRI                 1               treatment cycle\nxray                   1             replacement knee\n</code></pre></div>\n<p>Since not all of the units are standard (years, months, weeks, etc.),  we are currently just letting the users free-form type the frequency of the procedures such as \"6 per year\"   or \"4/month\"  or \"1 xray after each replacement knee surgery\") , knowing that the data will be messy.</p>\n<p>However, I have just found this example using the already existing unitOpen extension:</p>\n<p><a href=\"https://build.fhir.org/ig/HL7/sdc/examples.html#using-unitoption-unitopen-and-unitsupplementalsystem\">https://build.fhir.org/ig/HL7/sdc/examples.html#using-unitoption-unitopen-and-unitsupplementalsystem</a></p>\n<p>The extension is at <a href=\"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-unitOpen\">http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-unitOpen</a></p>\n<p>So, I think that we could have the users pick from a list of standard measurements like in the example or pick the ...  for other   and then have them input a string like \"treatment cycle\"  for the unit.</p>\n<p><span class=\"user-mention\" data-user-id=\"191832\">@Jose Costa Teixeira</span>      what are you trying to do with your units?</p>",
        "id": 270919656,
        "sender_full_name": "Diane",
        "timestamp": 1644192566
    },
    {
        "content": "<p>year and month are units.  study, treatment cycle and replacement knee are not.  You can't express those in Quantity.unit or Quantity.code.</p>",
        "id": 270920101,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644193233
    },
    {
        "content": "<p>Yes.  You are right. It would be best to have the unit recorded as weeks, months, years or  \"none\"   and then capture study, treatment cycle or replacement knees  psuedo-unit in a different data field.</p>",
        "id": 270928069,
        "sender_full_name": "Diane",
        "timestamp": 1644204182
    },
    {
        "content": "<p>My questionnaire item is \"amount\" and it can be 5 g, 4 spoons, 3 sips, 2 units...</p>",
        "id": 270944416,
        "sender_full_name": "Jose Costa Teixeira",
        "timestamp": 1644221439
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179255-questionnaire/topic/LHCForms.20-.20quantity.20display.3F/near/270920101\">said</a>:</p>\n<blockquote>\n<p>year and month are units.  study, treatment cycle and replacement knee are not.  You can't express those in Quantity.unit or Quantity.code.</p>\n</blockquote>\n<p>Could you explain why not?  Is there something in FHIR's definition of the term \"unit\" that prevents that?  Generally speaking, I think any noun could be unit.  You could write \"5 knees/surgeon\".</p>",
        "id": 270987079,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1644244767
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191832\">Jose Costa Teixeira</span> <a href=\"#narrow/stream/179255-questionnaire/topic/LHCForms.20-.20quantity.20display.3F/near/270905010\">said</a>:</p>\n<blockquote>\n<p>Or open choice</p>\n</blockquote>\n<p><a href=\"http://jira.hl7.org/browse/FHIR-20394\">FHIR-20394</a> said there is no open choice for unit lists.  I don't remember the reasoning, and nor why I would have moved to approve it.  <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ?</p>",
        "id": 270989047,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1644245626
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179255-questionnaire/topic/LHCForms.20-.20quantity.20display.3F/near/270895847\">said</a>:</p>\n<blockquote>\n<p>And specify the unit as text?</p>\n</blockquote>\n<p>That much seems to be allowable if there are no units provided.  See <a href=\"#narrow/stream/179255-questionnaire/topic/type.3Dquantity.20without.20questionnaire-unit\">https://chat.fhir.org/#narrow/stream/179255-questionnaire/topic/type.3Dquantity.20without.20questionnaire-unit</a> .   We would need to add that support to LHC-Forms.</p>",
        "id": 270989347,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1644245752
    },
    {
        "content": "<p>I may be letting some v3 rules seep in here, because you're right, Quantity isn't that tight.  I guess it's best to think of units as being on a scale - there are 'good' units, like 'cm' and 'tbsp' that are regular and safely interconvertable,   There are 'fuzzy' units like 'sip' and 'pea-sized blob' which don't have fixed dimensions but that can be evaluated and operated on mathematically without external context and certainly have an approximate equivalence across units.  And then there are things like \"twice per study\" which aren't really 'measurements' at all and which can be compared at all.  I.e. if there are two patients who have \"twice per study\", that could mean 2 months or 2 years.  Representing that last set as Quantity is extremely suspect.</p>",
        "id": 270993614,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644247338
    },
    {
        "content": "<p>Re: <a href=\"http://jira.hl7.org/browse/FHIR-20394\">FHIR-20394</a>, I think part of it is that we have no mechanism to distinguish whether open vs. closed is allowed.  The other aspect was limiting complexity.</p>",
        "id": 270993693,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1644247381
    }
]