[
    {
        "content": "<p>Questionnaires can depend on external value sets, the results of queries, passed in launch parameters, and resolving references.  Depending how they're used, the end result can be that someone looking at or validating the QuestionnaireResponse later may see different information or even have validation issues that the original author did not.</p>\n<p><a href=\"http://jira.hl7.org/browse/FHIR-36338\">FHIR#36338</a> proposes adding some guidance about strategies to minimize/reduce this issue, but it seems unlikely/impractical to eliminate it entirely.  It also raises the question of in what circumstances a calculatedValueExpression should actually be calculated.  Should it only happen if the QuestionnaireResponse is not yet completed?  What if it gets amended?  Are there situations where it's appropriate to adjust the display based on the 'current' context - e.g. showing duration based on the 'now' of the current viewer?</p>\n<p>Perhaps it's an unreasonable expectation that a QuestionnaireResponse that was valid when transitioned to 'complete' will always remain valid (as expansions of valuesets, retrieved search results, referenced resources, and/or launch parameters change)?</p>\n<p>This thread is for people to discuss their expectations around validity as well as when 'dynamic' elements in a form should cease being 'dynamic'.</p>",
        "id": 278240106,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1649374649
    },
    {
        "content": "<p>And another interesting result question would be if the result of the fhirpath expression <code>today()</code> should resolve to the value of the response... (meta.lastModified or <a href=\"http://QR.date\">QR.date</a>) - it's fine when it was originally saved, but then on edits later on.<br>\n(considering examples like an invariant where it checks that a review date is in the future, and you make an edit to the result later on)</p>",
        "id": 278242813,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1649376815
    },
    {
        "content": "<p>today() is always going to resolve to today.  That's not going to change.  If you need a snapshot of a 'specific' today(), you need to store it in the QR.</p>",
        "id": 278251092,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1649385772
    },
    {
        "content": "<p>That's going to be fun...</p>",
        "id": 278254496,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1649390414
    },
    {
        "content": "<p>A better thing would be a way to check the date in the QR.<br>\nI guess can try this out.</p>",
        "id": 278254611,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1649390530
    },
    {
        "content": "<p>I guess I could use this as the invariant/constraint expression <br>\n<code>(%resource.authored | today()).take(1)</code></p>",
        "id": 278255065,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1649391037
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191320\">Lloyd McKenzie</span> <a href=\"#narrow/stream/179255-questionnaire/topic/Guidance.20around.20dependencies.20on.20external.20sources/near/278240106\">said</a>:</p>\n<blockquote>\n<p>Perhaps it's an unreasonable expectation that a QuestionnaireResponse that was valid when transitioned to 'complete' will always remain valid </p>\n</blockquote>\n<p>I think that given that external dependencies can change or disappear, we can only require a QuestionnaireResponse to be valid at the time it was marked complete.</p>",
        "id": 278338982,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1649439974
    },
    {
        "content": "<p>Even that scenario could cause issues if a user filling out a form takes several days to do so, and something changes so that an answer picked from a list a few days earlier is no longer valid.  I guess is such situations the application might allow the user to \"finish\" the Questionnaire without it being marked completed.</p>",
        "id": 278339704,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1649440366
    }
]