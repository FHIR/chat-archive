[
    {
        "content": "<p>I have a Questionnaire with contained value set. The value set has <code>\"id\": \"valueset-1\"</code> and <code>\"url\": \"http://example.com/valueset-1\"</code>. What should I use in item.answerValueSet (which is type canonical)? <code> \"#id\"</code> or <code>\"http://example.com/valueset-1\"</code></p>",
        "id": 192086871,
        "sender_full_name": "Yunwei Wang",
        "timestamp": 1585347374
    },
    {
        "content": "<p>I <em>think</em> <code>#id</code>.  However, I'm not sure that using the canonical URL is wrong.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>, opinions?</p>",
        "id": 192088590,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1585348638
    },
    {
        "content": "<p>no you use the local - this is here: <a href=\"http://hl7.org/fhir/references.html#canonical-fragments\" title=\"http://hl7.org/fhir/references.html#canonical-fragments\">http://hl7.org/fhir/references.html#canonical-fragments</a></p>",
        "id": 192166959,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585477142
    },
    {
        "content": "<p>On that page, there is this example:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;valueSet value=&quot;http://fhir.acme.com/Questionnaire/example|1.0#vs1&quot;/&gt;\n</pre></div>\n\n\n<p>with the explanation: \"This is a reference to the value set with id \"vs1\" in version 1.0 of the identified questionnaire. \"</p>\n<p>Is that talking about one resource referencing a contained valueset inside a different resource (the Questionnaire)?  Or is it another way for the Questionnaire to refer to its contained ValueSet?</p>\n<p>I am confused by this example because I see this restriction on the same page: \"References to contained resources are never resolved outside the container resource.\"</p>",
        "id": 192300418,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1585594082
    },
    {
        "content": "<p>inside a different resource</p>",
        "id": 192303660,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585595508
    },
    {
        "content": "<p>How can that be, if there is this restriction:  \"References to contained resources are never resolved outside the container resource.\" ?</p>",
        "id": 192314692,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1585600960
    },
    {
        "content": "<p>if you see a reference that starts with # like #a, then the resolution of that reference will never be outside the containing resource</p>",
        "id": 192315205,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585601240
    },
    {
        "content": "<p>Well, okay, but I was quoting from <a href=\"http://hl7.org/fhir/references.html#contained\" title=\"http://hl7.org/fhir/references.html#contained\">http://hl7.org/fhir/references.html#contained</a>, which does not qualify that statement with respect to the format of the URI.</p>",
        "id": 192315522,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1585601395
    },
    {
        "content": "<p>well, you could create a task to clarify</p>",
        "id": 192315658,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585601434
    },
    {
        "content": "<p>Another needed clarification is needed on this statement on \"<a href=\"http://hl7.org/fhir/references.html#contained\" title=\"http://hl7.org/fhir/references.html#contained\">Canonical URLs</a>\": \"References to canonical URLs use the canonical type to refer to the url element\".   There no mention in this section that a canonical URL might be something else.  Should I make two tasks or one?</p>",
        "id": 192315976,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1585601610
    },
    {
        "content": "<p>two tasks.</p>",
        "id": 192320236,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585604041
    },
    {
        "content": "<p><a href=\"http://jira.hl7.org/browse/FHIR-26666\" title=\"http://jira.hl7.org/browse/FHIR-26666\">J#26666</a> and <a href=\"http://jira.hl7.org/browse/FHIR-26667\" title=\"http://jira.hl7.org/browse/FHIR-26667\">J#26667</a></p>",
        "id": 192324775,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1585606725
    },
    {
        "content": "<p>Is there a way to reference the valueset directly, and not via the canonical? (like we used to do in DSTU2/STU3)</p>",
        "id": 244408001,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625051987
    },
    {
        "content": "<p>Also, coming back to how the <code>http://fhir.acme.com/Questionnaire/example|1.0#vs1</code><br>\nIf that was a structureDefinition, doesn't that then refer to the element with id vs1?<br>\n<a href=\"http://hl7.org/fhir/r4/questionnaire-definitions.html#Questionnaire.item.definition\">http://hl7.org/fhir/r4/questionnaire-definitions.html#Questionnaire.item.definition</a><br>\nsays that this value <code>http://hl7.org/fhir/StructureDefinition/Observation#Observation.value[x]</code> doesn't refer to the contained resource, it's the element definition.<br>\n<span class=\"user-mention\" data-user-id=\"191407\">@Rick Geimer</span> <span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span></p>",
        "id": 244409042,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625052670
    },
    {
        "content": "<p>There is a <code>display</code> extension to add in the explicit display to show (like you would on a regular reference) but no excplicit reference link</p>",
        "id": 244409495,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625053002
    },
    {
        "content": "<p>The only option here is to include the <code>http://hl7.org/fhir/StructureDefinition/terminology-server</code>and the url for the valueset (can't just reference it)</p>",
        "id": 244409701,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625053166
    },
    {
        "content": "<p>Questionnaire only supports referencing by canonical, not by Reference.  We do have an extension that allows you to indicate preferred terminology server which presumably would allow you to indicate where to look for it.  Agree that's your only option right now.</p>\n<p>#vs1 says \"the element in this resource with id 'vs1'\".  Any element in a resource might have an id.  contained resources and snapshot and differential elements are required to have ids.  If you have a StructureDefinition with contained resources, so long as the id is unique, referencing it should work, though it's possible some software doesn't account for that.  (And it may be that we need to make the documentation clearer.)</p>",
        "id": 244434378,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625064311
    },
    {
        "content": "<p>Contained resources don't have to have element ids, but a resource Id (different thing) and that's my point.</p>",
        "id": 244495720,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625091253
    },
    {
        "content": "<p>see this:  <a href=\"http://hl7.org/fhir/references.html#canonical-fragments\">http://hl7.org/fhir/references.html#canonical-fragments</a></p>",
        "id": 244499183,
        "sender_full_name": "Eric Haas",
        "timestamp": 1625093944
    },
    {
        "content": "<p>Yes, it's the inconsistency where that refers to the contained resource ID, and the element Definition usage of the same format in the same type going to an elementID somewhere in the resource.</p>",
        "id": 244502668,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1625096502
    },
    {
        "content": "<p>I don't think there's inconsistency.  A hash-reference to a StructureDefinition could be a contained resource or an element or in theory even something like StructureDefinition.title if it happened to have an id on it.</p>",
        "id": 244513265,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1625108304
    }
]