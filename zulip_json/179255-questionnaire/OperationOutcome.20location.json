[
    {
        "content": "<p>When validating a QuestionnaireResponse, what is the location that is to be used in the output?<br>\nMy engine has been using a location like <code>linkId=\"Q1\"</code> but know this isn't really right, but since haven't been working with others not really an issue, and is quite easy to process, except where the question (or chain) has a repeating section in it.<br>\nAnd now that there are more players, want to get the value of this field correct, so that all can do the same thing, and when their UI is displaying errors from my server, they will be attached to the correct control(s).<br>\nCould this be to the answer, the question or the group, or any of these?<br>\n<code>QuestionnaireResponse.item[0].item[0].answer[0].value</code>    // a specific value is wrong (e.g. date format etc)<br>\n<code>QuestionnaireResponse.item[0].item[0].answer[0]</code>                // don't think this one can happen?<br>\n<code>QuestionnaireResponse.item[0].item[0].answer</code>                     // should this be here if there is no answer, or should that be the one below?<br>\n<code>QuestionnaireResponse.item[0].item[0]</code>                                     // required field has no answer? (what would happen if the required item wasn't in the response at all?)</p>\n<p>e.g. </p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;resourceType&quot;: &quot;OperationOutcome&quot;,\n  &quot;id&quot;: &quot;$validate&quot;,\n  &quot;issue&quot;: [\n    {\n      &quot;severity&quot;: &quot;warning&quot;,\n      &quot;code&quot;: &quot;invariant&quot;,\n      &quot;details&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;code&quot;: &quot;inv3&quot;\n          }\n        ],\n        &quot;text&quot;: &quot;Question 3 must be answered with a3&quot;\n      },\n      &quot;diagnostics&quot;: &quot;QuestionnaireResponse.item.item.where(linkId=&#39;Q3&#39;).answer.value = &#39;a3&#39;&quot;,\n      &quot;location&quot;: [\n        &quot;linkId=\\&quot;Q3\\&quot;&quot;,\n        &quot;QuestionnaireResponse.item[0].item[2].answer[0].value&quot;\n      ]\n    },\n    {\n      &quot;severity&quot;: &quot;error&quot;,\n      &quot;code&quot;: &quot;invariant&quot;,\n      &quot;details&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;code&quot;: &quot;inv2&quot;\n          }\n        ],\n        &quot;text&quot;: &quot;Question 2 must be answered with a2&quot;\n      },\n      &quot;diagnostics&quot;: &quot;QuestionnaireResponse.item.item.where(linkId=&#39;Q2&#39;).answer.value = &#39;a2&#39;&quot;,\n      &quot;location&quot;: [\n        &quot;linkId=\\&quot;Q2\\&quot;&quot;,\n        &quot;QuestionnaireResponse.item[0].item[1].answer[0].value&quot;\n      ]\n    },\n    {\n      &quot;severity&quot;: &quot;error&quot;,\n      &quot;code&quot;: &quot;invariant&quot;,\n      &quot;details&quot;: {\n        &quot;coding&quot;: [\n          {\n            &quot;code&quot;: &quot;inv1&quot;\n          }\n        ],\n        &quot;text&quot;: &quot;Question 1 must be answered with a1&quot;\n      },\n      &quot;diagnostics&quot;: &quot;QuestionnaireResponse.item.item.where(linkId=&#39;Q1&#39;).answer.value = &#39;a1&#39;&quot;,\n      &quot;location&quot;: [\n        &quot;linkId=\\&quot;Q1\\&quot;&quot;,\n        &quot;QuestionnaireResponse.item[0].item[0].answer[0].value&quot;\n      ]\n    }\n  ]\n}\n</code></pre></div>",
        "id": 222258174,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610337549
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span> have you attempted this area at all yet?</p>",
        "id": 222258183,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610337573
    },
    {
        "content": "<p>Also we need to clarify how the location field for <a href=\"http://hl7.org/fhir/R4/extension-questionnaire-constraint.html\">http://hl7.org/fhir/R4/extension-questionnaire-constraint.html</a> is to be used (since I was using the linkID directly, wasn't an issue, but since this needs to be relative to the QR, then it kinda needs to be \"re-evaluated\" at some stage.</p>",
        "id": 222258372,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610337824
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191367\">Brian Postlethwaite</span> <a href=\"#narrow/stream/179255-questionnaire/topic/OperationOutcome.20location/near/222258183\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"195344\">Paul Lynch</span> have you attempted this area at all yet?</p>\n</blockquote>\n<p>No, I haven't.  I was also having trouble finding documentation for that location field.  There is one example using it on <a href=\"https://www.hl7.org/fhir/resource-operation-validate.html\">https://www.hl7.org/fhir/resource-operation-validate.html</a>, but that is all I could find.</p>",
        "id": 222336164,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1610389162
    },
    {
        "content": "<p>While I'm here, I've noticed that my paths there don't have answers at all the levels, should they? I don't recall.<br>\nI know they are needed where a group repeats to hold the repitition, but otherwise?<br>\n<span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span></p>",
        "id": 222411002,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610445781
    },
    {
        "content": "<p>Not quite following the question...</p>",
        "id": 222460812,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610470559
    },
    {
        "content": "<p>The relationship between Questionnaire and response and the item/answer pairs. (linkID in brackets to help illustration)<br>\nQuestionniare.item(G1).item(G1-1).item(Q1)<br>\n=&gt; QuestionnaireResponse.item(G1).answer.item(G1-1).answer.item(Q1).answer</p>",
        "id": 222508193,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610492283
    },
    {
        "content": "<p>The likes of this example show that it doesn't need to have the extra answers for all groups.<br>\n<a href=\"http://hl7.org/fhir/questionnaireresponse-example-f201-lifelines.xml.html\">http://hl7.org/fhir/questionnaireresponse-example-f201-lifelines.xml.html</a><br>\nShould we imply that this is only required where a group is repeating?</p>",
        "id": 222511073,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610494198
    },
    {
        "content": "<p>Or should we just repeat the group item again in the QR. in which case, groups don't have answers.</p>",
        "id": 222511153,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610494241
    },
    {
        "content": "<p>Nested items within a question must appear inside an answer.  Nested items within a group appear inside the group</p>",
        "id": 222532607,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610512563
    },
    {
        "content": "<p>So repeat the group item itself like this then <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ?</p>\n<div class=\"codehilite\"><pre><span></span><code>QuestionnaireResponse\n  .item(root)\n    .item(G1-1)\n      .item(Q1).answer: &#39;Brian&#39;\n      .item(Q2).answer: &#39;10&#39;\n    .item(G1-1)\n      .item(Q1).answer: &#39;Lloyd&#39;\n      .item(Q2).answer: &#39;9&#39;\n</code></pre></div>\n<p>Where the G1-1 group item is repeated for the 2 rows in the table.</p>",
        "id": 222533589,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610513637
    },
    {
        "content": "<p>(If so, then this is what I've been doing, phew)</p>",
        "id": 222533696,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610513733
    },
    {
        "content": "<p>y</p>",
        "id": 222534008,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1610514035
    },
    {
        "content": "<p>Thanks.</p>",
        "id": 222534860,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1610514868
    }
]