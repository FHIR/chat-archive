[
    {
        "content": "<p>I'm just  starting to play around with Questionnaire/QuestionnaireResponse  (for STU3) and have a question regarding responses to questionnaires with nested questions.</p>\n<p>I constructed the following Questionnaire with two questions, one nested within the other:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"p\">{</span>\n    <span class=\"nt\">&quot;resourceType&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Questionnaire&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;url&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://example.com/Questionnaire/practice-questionnaire-test2&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;status&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;draft&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;item&quot;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n        <span class=\"nt\">&quot;linkId&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;date&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;required&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;text&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Date of hospital visit&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;type&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;date&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;item&quot;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n            <span class=\"nt\">&quot;linkId&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;rating&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;required&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;text&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;What general score would you give the hospital on a scale from 1 to 10?&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;type&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;integer&quot;</span>\n        <span class=\"p\">}]</span>\n    <span class=\"p\">}]</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n\n<p>I expected the following to be a valid response:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"p\">{</span>\n    <span class=\"nt\">&quot;resourceType&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;QuestionnaireResponse&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;questionnaire&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;reference&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://example.com/Questionnaire/practice-questionnaire-test2&quot;</span>\n    <span class=\"p\">},</span>\n    <span class=\"nt\">&quot;status&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;completed&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;item&quot;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n        <span class=\"nt\">&quot;linkId&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;date&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;answer&quot;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n            <span class=\"nt\">&quot;valueDate&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;2020-03-23&quot;</span><span class=\"p\">,</span>\n            <span class=\"nt\">&quot;item&quot;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                <span class=\"nt\">&quot;linkId&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;rating&quot;</span><span class=\"p\">,</span>\n                <span class=\"nt\">&quot;answer&quot;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                    <span class=\"nt\">&quot;valueInteger&quot;</span><span class=\"p\">:</span> <span class=\"mi\">10</span>\n                <span class=\"p\">}]</span>\n            <span class=\"p\">}]</span>\n        <span class=\"p\">}]</span>\n    <span class=\"p\">}]</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n\n<p>But this gives an error upon validation (latest JAR) - the validator does not find the second answer:</p>\n<div class=\"codehilite\"><pre><span></span>java -jar org.hl7.fhir.validator.jar -version 3.0.2 -questionnaire required -ig practice-questionnaire-test2.json  practice-questionnaireresponse-test2.json\n(...)\n*FAILURE* validating practice-questionnaireresponse-test2.json:  error:1 warn:0 info:0\n  Error @ QuestionnaireResponse.item[0] (line 7, col15) : No response found for required item with id = &#39;rating&#39;\n</pre></div>\n\n\n<p>I tried various other ways of structuring the response but did not find one that worked. Any ideas as to what I am doing wrong?</p>",
        "id": 191634599,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1585066583
    },
    {
        "content": "<p>It may be you're not doing anything wrong.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> - I can't see anything wrong with these instances, do you??</p>",
        "id": 191638112,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1585067851
    },
    {
        "content": "<p>the problem here is the whole answer/question thing. The validator is validating the item.answer.item, but it's actually looking for item.item when it gives that error message</p>",
        "id": 192202638,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585530052
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> the source questionnaire doesn't say anything item.item vs item.answer.item does it? they're both the same (this is in R3)</p>",
        "id": 192202653,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585530097
    },
    {
        "content": "<p>item.item is used for children of groups, item.answer.item is used for children of questions.  We've approved a change request to make that more clear.</p>",
        "id": 192203575,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1585531482
    },
    {
        "content": "<p>does that apply retrospectively in R3 and R4?</p>",
        "id": 192203957,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585532172
    },
    {
        "content": "<p>Yes.  It was always the intention, just not always well documented other than a few examples.</p>",
        "id": 192203969,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1585532266
    },
    {
        "content": "<p>ok fixed next release</p>",
        "id": 192205908,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1585535667
    },
    {
        "content": "<p>Great, thanks! <span aria-label=\"confetti\" class=\"emoji emoji-1f38a\" role=\"img\" title=\"confetti\">:confetti:</span></p>",
        "id": 192223519,
        "sender_full_name": "Morten Ernebjerg",
        "timestamp": 1585555885
    }
]