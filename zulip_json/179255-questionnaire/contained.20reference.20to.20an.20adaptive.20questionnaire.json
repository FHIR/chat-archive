[
    {
        "content": "<p>RE: Adaptive Questionnaire. </p>\n<p>It seems in this IG, the contained Q should reference the AQ via the <code>url</code> <a href=\"http://fhir.org/guides/argonaut/questionnaire/adaptive.html#usage-1\" target=\"_blank\" title=\"http://fhir.org/guides/argonaut/questionnaire/adaptive.html#usage-1\">http://fhir.org/guides/argonaut/questionnaire/adaptive.html#usage-1</a>. However in this IG, the contained Q seems to use the <code>identifier</code> <a href=\"http://hl7.org/fhir/uv/sdc/2019May/adaptive.html\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/sdc/2019May/adaptive.html\">http://hl7.org/fhir/uv/sdc/2019May/adaptive.html</a> for this purpose. Which is it?</p>",
        "id": 185048105,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578427010
    },
    {
        "content": "<p>//reference to contained questionnaire<br>\n        \"questionnaire\": \"#q\",<br>\nis using a relative URL to point to the contained resource.  It's not pointing to the 'identifier'.  That said, we're inconsistent in the examples about whether \"questionnaire\" is declared and it should be in all of them.  Can you submit a change request?</p>",
        "id": 185126690,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578499076
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> -- here is a PR: <a href=\"https://github.com/HL7/sdc/pull/2\" target=\"_blank\" title=\"https://github.com/HL7/sdc/pull/2\">https://github.com/HL7/sdc/pull/2</a></p>",
        "id": 185222753,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578584185
    },
    {
        "content": "<p>Change requests to the SDC IG are usually made via a JIRA ticket.  That being said, the pull request really helped me understand that inconsistency you are seeing.  In the Argonaut IG, the contained Questionnaire resource has a  \"url\" field but no \"identifier\", and in the SDC IG example the contained Questionnaire resource has an \"identifier\" but no \"url\".</p>",
        "id": 185224407,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1578585055
    },
    {
        "content": "<p>Hi  <span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span> -- yes that's right! I prefer using url, so I hope that PR is approved :) ..  LMK if it would be helpful to create a ticket.</p>",
        "id": 185225348,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578585545
    },
    {
        "content": "<p>Another (maybe bigger) inconsistency is the operations for getting the next question.  In Argonaut:</p>\n<div class=\"codehilite\"><pre><span></span>POST [base]/Questionnaire/$next-question\n</pre></div>\n\n\n<p>but in SDC (note the ID):</p>\n<div class=\"codehilite\"><pre><span></span>POST [BaseURL]/Questionnaire/[id]/next-q\n</pre></div>",
        "id": 185225813,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1578585791
    },
    {
        "content": "<p>Oh yea, that is a big one. Generally speaking I saw Argonaut as a \"feeder\" into a ballot standard, and the SDC would be the one that will end up getting adopted. Is this the way I should be thinking?</p>",
        "id": 185225974,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578585866
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"252599\">@Brian Kaney</span> Please submit a Jira change proposal and point to your pull request.  Pull requests can't be considered without a Jira ticket.</p>",
        "id": 185226924,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578586425
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"252599\">@Brian Kaney</span> If you do submit a JIRA ticket, please post a link to it here so that people reading this thread can find it.</p>",
        "id": 185236914,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1578592060
    },
    {
        "content": "<p>Sure thing. I am waiting to get granted access to JIRA. (BTW the footer still refers to gforge)</p>",
        "id": 185239121,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578593409
    },
    {
        "content": "<p>Here it is, thanks! <a href=\"https://jira.hl7.org/browse/FHIR-25434\" target=\"_blank\" title=\"https://jira.hl7.org/browse/FHIR-25434\">https://jira.hl7.org/browse/FHIR-25434</a></p>",
        "id": 185240619,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578594400
    },
    {
        "content": "<p>I think either endpoint should work</p>",
        "id": 185249280,
        "sender_full_name": "Eric Haas",
        "timestamp": 1578599924
    },
    {
        "content": "<p>The servers are smart enough to figure it out</p>",
        "id": 185249346,
        "sender_full_name": "Eric Haas",
        "timestamp": 1578599979
    },
    {
        "content": "<p>Well, as an implementor/developer in one case you'd have to build an operation at the type-level (that would interrogate the body and the subsequently find the appropriate questionnaire), verses an instance-level operation. And it would be nice to not have to build the next-q(uestion) operation twice! </p>\n<p>(I prefer an instance-level operation, it's a simpler to build e.g. <code>/Questionnaire/[id]/$next-q</code>)</p>",
        "id": 185264904,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578609989
    },
    {
        "content": "<p>We can't always go with an instance-level operation because not all servers that support the operation will necessarily be Questionnaire repositories.</p>",
        "id": 185266920,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578611632
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Per <a href=\"http://hl7.org/fhir/uv/sdc/2019May/adaptive.html\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/sdc/2019May/adaptive.html\">http://hl7.org/fhir/uv/sdc/2019May/adaptive.html</a>, the instance-level next-q is the only operation for adaptive SDC Questionnaires.</p>",
        "id": 185267525,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1578612122
    },
    {
        "content": "<p>Hmm.  That's problematic.  I'll submit a change request.</p>",
        "id": 185267620,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578612215
    },
    {
        "content": "<p><a href=\"http://jira.hl7.org/browse/FHIR-25437\" target=\"_blank\" title=\"http://jira.hl7.org/browse/FHIR-25437\">GF#25437</a></p>",
        "id": 185267777,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578612358
    },
    {
        "content": "<p>Well in this case, it's more like \"instance-level-like\"... the service doesn't need to support FHIR instances, just this endpoint .. I think of it as putting the identifier to the Questionnaire in the URL segment instead of deeply nesting in the body.</p>",
        "id": 185267879,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578612433
    },
    {
        "content": "<p>The adaptive-Q server may treat all incoming traffic the same, it knows nothing a priori, and will start from scratch each time,  so its going to have to crack open the resource anyway, so it inspects the questionnaire's url to figure out what to do next.</p>\n<p>I'm not sure if Lloyd is correct  in what he said... I am not sure if the distinction of /Questionnaire$next-q  and /Questionnaire/[id}/$next-q  means that for the latter you have to have to be a FHIR Questionnaire repository.  To the operation it is just another endpoint and can be treated as a black box.   So the implementer can choose to have 1 general purpose endpoint or multiple specific endpoints. </p>\n<p>I would think is easier for the service to maintain one endpoint and manage the standing up of new and deprecating of questionnaire processing behind the curtain.  An easier for the client too.  As an implementer you can use the (much ignored and unloved) CapStatement to define what you support.</p>",
        "id": 185458163,
        "sender_full_name": "Eric Haas",
        "timestamp": 1578877462
    },
    {
        "content": "<p>A system might have <em>knowledge</em> of a Questionnaire without necessarily exposing it at a RESTful endpoint.  For some types of Questionnaires, the actual Questionnaire (with all of the logic about what questions are asked when, how they're scored, etc.) are never exposed to anyone.  Obviously the contained Questionnaire will be shared, but that wouldn't have the URL that would be used when invoking the operation - as every contained Questionnaire will be unique to a given QuestionnaireResponse.</p>",
        "id": 185459777,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578880713
    },
    {
        "content": "<p>in the Argo operation we document:  </p>\n<blockquote>\n<p>The Argo Adaptive QuestionnaireResponse Profile of the QuestionnaireResponse resource with a contained Questionnaire. The <code>url</code> element in the contained Questionnaire identifies which set of questions are being requested.</p>\n</blockquote>\n<p>and profile the url element to min =1 in both argo and sdc</p>\n<p>I don't understand why this can not be used to key which AQ to run.   Since the expectation is the AQ servers is stateless and starts from beginning every time. it only needs to know a starting point for its processing.  is there some extension the AQ server should key off of instead?</p>",
        "id": 185462256,
        "sender_full_name": "Eric Haas",
        "timestamp": 1578885759
    },
    {
        "content": "<p>So your question is why the Questionnaire/[id]/$next-question version is necessary given that on invocation you can pass in the url?  I'm thinking that it should be Questionnaire.derivedFrom, not Questionnaire.url though.  Because the latter would be the canonical URL of the contained questionnaire - which would be unique to this specific QuestionnaireResponse...</p>",
        "id": 185462873,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578886963
    },
    {
        "content": "<p>I guess I can by that the Questionnaire/[id] version isn't necessary.  Care to submit a change request?</p>",
        "id": 185462881,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578886983
    },
    {
        "content": "<p>OK so what you are saying the canonical is not the canonical for the proprietary AQ algorithm that company x produces ? but is rather the instance of the questionnaire that is regenerated each and every time the QR hits the endpoint?   That questionnaire exists only in the context of the answers so I my mind there is nothing canonical about it.   .derivedFrom makes sense based on the definition and should be min =1  question is should url be min=1?</p>",
        "id": 185463113,
        "sender_full_name": "Eric Haas",
        "timestamp": 1578887463
    },
    {
        "content": "<p>I don't see much point in having a URL on the contained questionnaire</p>",
        "id": 185464285,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578889891
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> Then what indicates <em>which</em> adaptive Questionnaire (not the partial, contained one) is the one for which answers are being submitted?</p>",
        "id": 185501661,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1578928415
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"195344\">@Paul Lynch</span> -- I think if it's an instance-level operation, the adaptive Questionnaire would be the one specified in the URL path. If it's a type-level operation, we would need to have the URL in the contained (dynamic/partial) one for sure.</p>",
        "id": 185503093,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578929184
    },
    {
        "content": "<p>To follow up, I just realized the SDC IG has the operation without a dollar sign (it's just <code>next-q</code>), is this a typo, I would have expected to follow FHIR conventions with <code>$next-q</code>.</p>",
        "id": 185503172,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578929229
    },
    {
        "content": "<p>The operation name doesn't included the dollar-sign.  When invoking, you lead with the $.  The notion is that when invoking next-question, you'd specify the Questionnaire.derivedFrom.</p>",
        "id": 185508447,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578932394
    },
    {
        "content": "<p>Though as I think about queries, when you're searching you'd want to find all questionnaireResponses where questionnaire='official URL for questionnaire' - so maybe using URL is better.  If we go that route, we're going to need to talk w/ FHIR-I about atypical use of a canonical reference...</p>",
        "id": 185508580,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578932464
    },
    {
        "content": "<blockquote>\n<p>If we go that route, we're going to need to talk w/ FHIR-I about atypical use of a canonical reference...</p>\n</blockquote>\n<p>I don't understand what is atypical.  The url defines the adaptive Q and by definition the instance will be defined by the questions + algorithm?</p>",
        "id": 185523716,
        "sender_full_name": "Eric Haas",
        "timestamp": 1578941447
    },
    {
        "content": "<p>The canonical is <em>supposed</em> to be for the Questionnaire itself.  Having different Questionnaire instances that share the same url (and the same version) even though they're contained may well be confusing.  <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>, opinions?</p>",
        "id": 185527692,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1578943544
    },
    {
        "content": "<p>In <a href=\"#narrow/stream/179166-implementers/topic/Promoting.20contained.20resources.20to.20standalone/near/185530612\" title=\"#narrow/stream/179166-implementers/topic/Promoting.20contained.20resources.20to.20standalone/near/185530612\">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Promoting.20contained.20resources.20to.20standalone/near/185530612</a>, Grahame wrote \"contained resources really shouldn't contain an identifier. that would be a clear marker for someone abusing contained resources\".  But, the SDC example of the contained Questionnaire has an identifier (<a href=\"http://hl7.org/fhir/uv/sdc/2019May/adaptive.html\" target=\"_blank\" title=\"http://hl7.org/fhir/uv/sdc/2019May/adaptive.html\">http://hl7.org/fhir/uv/sdc/2019May/adaptive.html</a>).  <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> ?</p>",
        "id": 185536635,
        "sender_full_name": "Paul Lynch",
        "timestamp": 1578948996
    },
    {
        "content": "<p>I think we need to use the <code>url</code> then if <code>identifier</code> is off the table per that recommendation if it's not an instance-level operation.</p>",
        "id": 185537786,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578949756
    },
    {
        "content": "<p>In other word, the contained questionnaire is supposed to be ephemeral, but unless we only support instance-level operation <code>/Questionnaire/:id/$next-q</code> we don't have to worry about identification of the \"authored\" questionnaire, as it is expressed in the URL route. Otherwise we need it somewhere in the contained questionnaire...</p>",
        "id": 185538691,
        "sender_full_name": "Brian Kaney",
        "timestamp": 1578950300
    },
    {
        "content": "<p>the URL does define the questionnaire. So each adaptive questionnaire instance will be different based on the process, and so have a different URL (a GUID, I'd expect). You'd use Questionnaire.identifier to link to the master definition for the Adaptive questionnaire</p>",
        "id": 185559968,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1578969328
    },
    {
        "content": "<p><a href=\"https://jira.hl7.org/browse/FHIR-25460\" target=\"_blank\" title=\"https://jira.hl7.org/browse/FHIR-25460\">https://jira.hl7.org/browse/FHIR-25460</a></p>",
        "id": 185571104,
        "sender_full_name": "Eric Haas",
        "timestamp": 1578987150
    },
    {
        "content": "<p>Someone correct me if I'm wrong, but isnt an adaptive Q still just a Q that dynamically gets questions?<br>\nOtherwise how do you know which one you're asking for?<br>\nAQ for mental health or AQ for home care or AQ for staff training?</p>",
        "id": 186972887,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1580381439
    },
    {
        "content": "<p>(essentially the catalog of start points)</p>",
        "id": 186972907,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1580381460
    },
    {
        "content": "<p>The contained questionnaire would be <code>derivedFrom</code> the authoritative Q</p>",
        "id": 187029419,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1580417619
    },
    {
        "content": "<p>Sure yes.</p>",
        "id": 187041455,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1580425823
    },
    {
        "content": "<p>But then is there anything authoratitive about an adaptive Q?</p>",
        "id": 187041478,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1580425859
    },
    {
        "content": "<p>The Q contained within the adaptive QR will be a 1-off.  It won't likely have an identifier or a canonical URL</p>",
        "id": 187052707,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1580438741
    }
]