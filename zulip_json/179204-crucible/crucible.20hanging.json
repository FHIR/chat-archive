[
    {
        "content": "<p>Hello again</p>\n<p>We've deployed a public server and are attempting to run crucible against it.  It seems to consistently get stuck after about half an hour, not always in exactly the same place.  Once it gets stuck we can see from the logs that we're no longer receiving http requests from it.  I've run a local crucible in docker-compose against it and that runs the tests to completion.</p>\n<p><a href=\"https://projectcrucible.org/servers/5c791f4404ebd07fa1000000\" target=\"_blank\" title=\"https://projectcrucible.org/servers/5c791f4404ebd07fa1000000\">https://projectcrucible.org/servers/5c791f4404ebd07fa1000000</a></p>\n<p>Last request from that run was at 13:07:42</p>",
        "id": 160002193,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1551792229
    },
    {
        "content": "<p>Hmmm, thanks Ben, we'll take a look.  Looks like it is hanging on 'Resource Test Supply Delivery' right now. <a href=\"/user_uploads/10155/i43lwejGHGzVvDnHaFXcec7i/Screen-Shot-2019-03-05-at-9.05.00-AM.png\" target=\"_blank\" title=\"Screen-Shot-2019-03-05-at-9.05.00-AM.png\">Screen-Shot-2019-03-05-at-9.05.00-AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/i43lwejGHGzVvDnHaFXcec7i/Screen-Shot-2019-03-05-at-9.05.00-AM.png\" target=\"_blank\" title=\"Screen-Shot-2019-03-05-at-9.05.00-AM.png\"><img src=\"/user_uploads/10155/i43lwejGHGzVvDnHaFXcec7i/Screen-Shot-2019-03-05-at-9.05.00-AM.png\"></a></div>",
        "id": 160005237,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551794792
    },
    {
        "content": "<p>In the past we have had some problems when running the full barrage of tests, though it wasn't consistent enough to replicate and track down the issue.  I believe our running hypothesis was either the JSON parsing or XML parsing libraries caused some kind of fatal error to occur.</p>",
        "id": 160005409,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551794966
    },
    {
        "content": "<p>From what you can tell, is it always failing on the same test?</p>",
        "id": 160005421,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551794991
    },
    {
        "content": "<p>We also should have a cleanup job that identifies stalled tests, kills them, and resumes when this type of thing happens, but if it has been stuck awhile then perhaps that isn't working either</p>",
        "id": 160005508,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551795050
    },
    {
        "content": "<p>From what I can tell, it's <em>not</em> always failing on the same test, but it does seem to be roughly in the same place, somewhere in the Base Resources / Clinical Resources / Financial Resources sections</p>\n<p>Let me know if I can provide any more information from our end.</p>",
        "id": 160005946,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1551795429
    },
    {
        "content": "<p>Turns out our process that identifies stalled jobs and restarts them had been disabled due a cron issue, I re-enabled it and now the test will get marked as a fatal 'Crucible Error', and Crucible will pick up on the next test in the run. <a href=\"/user_uploads/10155/iu2_p9gwpS25NT5svp6WVYUS/Screen-Shot-2019-03-05-at-12.37.05-PM.png\" target=\"_blank\" title=\"Screen-Shot-2019-03-05-at-12.37.05-PM.png\">Screen-Shot-2019-03-05-at-12.37.05-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/10155/iu2_p9gwpS25NT5svp6WVYUS/Screen-Shot-2019-03-05-at-12.37.05-PM.png\" target=\"_blank\" title=\"Screen-Shot-2019-03-05-at-12.37.05-PM.png\"><img src=\"/user_uploads/10155/iu2_p9gwpS25NT5svp6WVYUS/Screen-Shot-2019-03-05-at-12.37.05-PM.png\"></a></div>",
        "id": 160023099,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551807600
    },
    {
        "content": "<p>Not ideal, but at least Crucible gracefully recovers now.</p>",
        "id": 160023179,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551807633
    },
    {
        "content": "<p>... and the rest of the tests will be run.</p>",
        "id": 160023221,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551807666
    },
    {
        "content": "<p>thanks Robert!</p>",
        "id": 160076649,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1551861065
    },
    {
        "content": "<p>is it likely that the error was caused by something on our end?</p>",
        "id": 160076740,
        "sender_full_name": "Ben Spencer",
        "timestamp": 1551861167
    },
    {
        "content": "<p>We've seen this happen on other servers, so it is unlikely that you are doing anything wrong.  Let me know if things get stuck again -- I expect you'll still see the occasional 'Unrecoverable Crucible Error', but the tests shouldn't hang indefinitely any more</p>",
        "id": 160113198,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551891469
    },
    {
        "content": "<p>Thanks for reporting that issue!</p>",
        "id": 160113270,
        "sender_full_name": "Robert Scanlon",
        "timestamp": 1551891514
    }
]