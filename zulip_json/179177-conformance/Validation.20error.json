[
    {
        "content": "<p>What does the following error mean (from the hapi 4 validator):</p>\n<p><em>Could not match discriminator (url) for slice Patient.extension:dhb in profile <a href=\"http://clinfhir.com/fhir/StructureDefinition/MyPatient\" target=\"_blank\" title=\"http://clinfhir.com/fhir/StructureDefinition/MyPatient\">http://clinfhir.com/fhir/StructureDefinition/MyPatient</a> - does not have fixed value, binding or existence assertions</em></p>\n<p>I'm using forge to add a simple extension to a profile on Patient (I also used forge to create the extension, and then just added it to the profile and saved.</p>\n<p>Am I missing a step in Forge perhaps?</p>\n<p>here's the profile XML (from forge) with the extraneous bits removed for clarify:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;element id=&quot;Patient.extension&quot;&gt;\n        &lt;path value=&quot;Patient.extension&quot; /&gt;\n        &lt;slicing&gt;\n            &lt;discriminator&gt;\n                &lt;type value=&quot;value&quot; /&gt;\n                &lt;path value=&quot;url&quot; /&gt;\n            &lt;/discriminator&gt;\n            &lt;description value=&quot;Extensions are always sliced by (at least) url&quot; /&gt;\n            &lt;rules value=&quot;open&quot; /&gt;\n        &lt;/slicing&gt;\n\n        &lt;min value=&quot;0&quot; /&gt;\n        &lt;max value=&quot;*&quot; /&gt;\n        &lt;base&gt;\n            &lt;path value=&quot;DomainResource.extension&quot; /&gt;\n            &lt;min value=&quot;0&quot; /&gt;\n            &lt;max value=&quot;*&quot; /&gt;\n        &lt;/base&gt;\n        &lt;type&gt;\n            &lt;code value=&quot;Extension&quot; /&gt;\n        &lt;/type&gt;\n\n    &lt;/element&gt;\n    &lt;element id=&quot;Patient.extension:dhb&quot;&gt;\n        &lt;path value=&quot;Patient.extension&quot; /&gt;\n        &lt;sliceName value=&quot;dhb&quot; /&gt;\n\n        &lt;min value=&quot;0&quot; /&gt;\n        &lt;max value=&quot;1&quot; /&gt;\n        &lt;base&gt;\n            &lt;path value=&quot;DomainResource.extension&quot; /&gt;\n            &lt;min value=&quot;0&quot; /&gt;\n            &lt;max value=&quot;*&quot; /&gt;\n        &lt;/base&gt;\n        &lt;type&gt;\n            &lt;code value=&quot;Extension&quot; /&gt;\n            &lt;profile value=&quot;http://clinfhir.com/fhir/StructureDefinition/dhb&quot; /&gt;\n        &lt;/type&gt;\n\n    &lt;/element&gt;\n</pre></div>",
        "id": 172807981,
        "sender_full_name": "David Hay",
        "timestamp": 1565302561
    },
    {
        "content": "<p>and the sample patient:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;\n    &lt;id value=&quot;patientTest&quot;/&gt;\n    &lt;meta&gt;\n        &lt;versionId value=&quot;7&quot;/&gt;\n        &lt;lastUpdated value=&quot;2019-06-20T03:29:47.050+00:00&quot;/&gt;\n        &lt;profile value=&quot;http://clinfhir.com/fhir/StructureDefinition/MyPatient&quot;/&gt;\n    &lt;/meta&gt;\n    &lt;text&gt;\n        &lt;status value=&quot;generated&quot;/&gt;\n        &lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;Patient 2&lt;/div&gt;\n    &lt;/text&gt;\n\n    &lt;extension url=&quot;http://clinfhir.com/fhir/StructureDefinition/dhb&quot;&gt;\n        &lt;valueCodeableConcept&gt;\n            &lt;coding&gt;\n                &lt;system value=&quot;http://standards.digital.health.nz/fhir/CodeSystem/nzinfosource&quot;/&gt;\n                &lt;code value=&quot;BREG&quot;/&gt;\n            &lt;/coding&gt;\n\n        &lt;/valueCodeableConcept&gt;\n\n    &lt;/extension&gt;\n&lt;/Patient&gt;\n</pre></div>",
        "id": 172809639,
        "sender_full_name": "David Hay",
        "timestamp": 1565304218
    },
    {
        "content": "<p>Is it a problem if you use the stand alone validator (the current one)?</p>",
        "id": 172811271,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1565305912
    },
    {
        "content": "<p>Haven't checked - will download and have a try.</p>",
        "id": 172811533,
        "sender_full_name": "David Hay",
        "timestamp": 1565306172
    },
    {
        "content": "<p>Got it! the Extension.url element in the definition was missing the fixedUrl element. I added that manually and the error disappeared. So I need to figure out how to add that in forge...</p>",
        "id": 172811672,
        "sender_full_name": "David Hay",
        "timestamp": 1565306389
    },
    {
        "content": "<p>Indeed, there is a known bug in the latest Forge R4 release, which causes the (mandatory) <code>Extension.url</code> element in an Extension definition to be omitted from the generated output. According to FHIR, this is invalid. This bug will be fixed in the next release.</p>",
        "id": 173014232,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1565607721
    }
]