[
    {
        "content": "<p>Michel pointed out to me that Lloyd assumed StructureDefinition.context can be any kind of text. Indeed, this element is a <code>string</code>- but I doubt very much tools would expect prose here. The intention - as far as I know - is for this element to contain a path (at least when the context type is Resource or Datatype).  When would narrative be acceptable (if at all)?</p>",
        "id": 153911200,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506597777
    },
    {
        "content": "<p>Sorry for the confusion, here's Lloyd's earlier comments on extension context:</p>\n<p><a href=\"https://chat.fhir.org/#narrow/stream/implementers/subject/extensions\" target=\"_blank\" title=\"https://chat.fhir.org/#narrow/stream/implementers/subject/extensions\">https://chat.fhir.org/#narrow/stream/implementers/subject/extensions</a></p>\n<p>Lloyd McKenzie 04:35   <br>\n\"...If contextType is \"resource\", then the context must be a resource name or path. If contextType is \"datatype\" then the context must be a data type name or path. If contextType is extension, then the context must be the extension URL. I'm actually not sure how to refer to a sub-element within a complex extension...\"</p>\n<p><a href=\"https://chat.fhir.org/#narrow/stream/implementers/subject/extensions.20Patient.20Name.20Parts\" target=\"_blank\" title=\"https://chat.fhir.org/#narrow/stream/implementers/subject/extensions.20Patient.20Name.20Parts\">https://chat.fhir.org/#narrow/stream/implementers/subject/extensions.20Patient.20Name.20Parts</a></p>\n<p>\"2. Context must be a specific Resource path. It's computable.\"</p>\n<p>So the exception is when contextType equals extension, then the context property apparently should specify a canonical url instead of an element path.</p>",
        "id": 153911201,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1506598645
    },
    {
        "content": "<p>Ok, so I agree on all that ;-)   Maybe it wasn't Lloyd who thought it could by any text, then?</p>",
        "id": 153911202,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506598833
    },
    {
        "content": "<p>Found it, turns out the comment wasn't by Lloyd:</p>\n<p>\"Grahame Grieve 01:32   <br>\nthe conext can be any meaningful string, where meaning is specified by the contextType\"</p>",
        "id": 153911203,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1506598941
    },
    {
        "content": "<p>Funny, those 01:32 timestamps.  Makes ik look like \"The Gospel according to....\"</p>",
        "id": 153911204,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506599056
    },
    {
        "content": "<p>That's ok, as long as \"meaningful\" here means \"a FhirPath(?) path\" for type={resource,datatype}, \"uri\" for type={extension} etc....</p>",
        "id": 153911205,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506599119
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> does FHIRPath have any kind of hi/low complexity categories? As in, a context must be a <em>simple</em> FHIRPath expression? Or is the whole syntax always available?</p>",
        "id": 153911220,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1506603162
    },
    {
        "content": "<p>Also, note that URIs may include locators:</p>\n<p><code>http://example.com/StructureDefinition/my-extension#Extension.extension:firstPart.valueString</code></p>\n<p>Is this legal for context on extensions?</p>",
        "id": 153911221,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1506603243
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> does FHIRPath have any kind of hi/low complexity categories? As in, a context must be a <em>simple</em> FHIRPath expression? Or is the whole syntax always available?</p>\n</blockquote>\n<p>The notion of \"flavors\" of FHIRPath has been popping up a few times....e.g. in <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13711\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13711\">GF#13711</a>...</p>",
        "id": 153911223,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506603310
    },
    {
        "content": "<p>SearchParameters, discriminator paths, extension context....</p>",
        "id": 153911224,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506603363
    },
    {
        "content": "<p><img alt=\":+1:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f44d.png\" title=\":+1:\"></p>",
        "id": 153911226,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1506603381
    },
    {
        "content": "<p>Thinking about writing a native node.js snapshot generator/validator and FHIRPath makes my life very difficult</p>",
        "id": 153911228,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1506603446
    },
    {
        "content": "<p>Just a snapshot-&gt;FHIRPath translator and then an efficient FHIRPath engine would do ;-)   I had some philosophical discussions with Bryn about additions to FHIRPath to make the structural constraints in an SD translateable to FHIRPath.  But your error reporting to the user would probably be absymal.  Anyway, don't want to punish your brains any more than necessary ;-)</p>",
        "id": 153911230,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506603574
    },
    {
        "content": "<blockquote>\n<p>Also, note that URIs may include locators:</p>\n<p><code>http://example.com/StructureDefinition/my-extension#Extension.extension:firstPart.valueString</code></p>\n<p>Is this legal for context on extensions?</p>\n</blockquote>\n<p>Have not given that a thought yet....but in the links Michel included above, I see Lloyd wonder about how to specify a context within an extension. This might be it..</p>",
        "id": 153911231,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506603693
    },
    {
        "content": "<p>There are tiers of functionality (I think) in what profiles do and how they can be applied.  Things like:<br>\n- Converting a profile into search criteria to apply the profile to the whole server<br>\n- Using profiles (with slices) to create a better specified schema (Patient with an \"officialName\" element)<br>\n- Stream parsing of resources to avoid having to keep large resources in-memory<br>\nBecause there aren't (yet) public examples of any of these kinds of things, it's tempting to make really complex FHIRPath constraints, and those will keep these profiles from being used in highly optimizing parsers</p>",
        "id": 153911233,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1506603968
    },
    {
        "content": "<p>We should certainly document how to point to sub-elements within an extension.  Chris, do you want to submit a tracker on that?</p>",
        "id": 153911250,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506610225
    },
    {
        "content": "<p>I seem to remember that I wrote some logic in Forge or .NET API before concerning url's that walk into a complex extension using anchor notation. I think this aligns with the example above, but I'll check.</p>",
        "id": 153911251,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1506610480
    },
    {
        "content": "<p>I certainly intended for the context string to reference an element but it's id not by it's path - e.g. not FHIRPath. Not here.</p>",
        "id": 153911968,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1506999898
    },
    {
        "content": "<p>context is either an element but it's id, or it's canonical url.</p>",
        "id": 153911969,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1506999971
    },
    {
        "content": "<p>it could be cleaner to make it always a full URL that identifies an element authoritatively.</p>",
        "id": 153911970,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1506999995
    },
    {
        "content": "<p>So if I understand correctly, it is valid for the context property to specify an element id, e.g. \"Patient.identifier:ssn\"?</p>",
        "id": 153912035,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507027082
    },
    {
        "content": "<p>that would be problematic - which :ssn? that's why I was thinking about making it a full url</p>",
        "id": 153912043,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1507031069
    },
    {
        "content": "<p>So if I understand correctly, this would allow an extension definition to state: I am designed to be used in profiles derived from a specific base profile and on a specific slice? Advanced, but I see how this might be useful.</p>",
        "id": 153912053,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507032196
    },
    {
        "content": "<p>yes could do that. I would encourage to be a little more general, but people do want to be extremely specific</p>",
        "id": 153912054,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1507032497
    },
    {
        "content": "<p>Agreed. So maybe we should not proactively change this until there is sufficient demand from the community?</p>",
        "id": 153912055,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507032649
    },
    {
        "content": "<p>going normative in R4.</p>",
        "id": 153912056,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1507032667
    },
    {
        "content": "<p>I see, then I guess we have to define the proper format now.</p>",
        "id": 153912058,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1507032918
    },
    {
        "content": "<p>Format is set when we locked the format of <a href=\"http://elementdefinition.id\" target=\"_blank\" title=\"http://elementdefinition.id\">elementdefinition.id</a>.</p>\n<p><code>http://example.com/my-us-patient#Patient.identifier:ssn</code></p>",
        "id": 153912111,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1507059848
    }
]