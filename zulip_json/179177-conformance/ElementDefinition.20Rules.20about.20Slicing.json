[
    {
        "content": "<p><a href=\"http://build.fhir.org/elementdefinition.html#slicing\" target=\"_blank\" title=\"http://build.fhir.org/elementdefinition.html#slicing\">http://build.fhir.org/elementdefinition.html#slicing</a><br>\nThe last bullet point is just plain wrong...I think.  \"The first entry (the one having the slicing information) is understood to be the set of constraints to be used for the 'open' slice\" - no, that's the <code>@default</code> slice.  If you create a constraint on \"the first entry\" with the slicing information, you're constraining all slices.  If I'm not missing something, this is a must fix technical correction.  <span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span> <span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span></p>",
        "id": 153955994,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525457308
    },
    {
        "content": "<p>For some reason, there's an exception for min..max in this wording??</p>",
        "id": 153955995,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525457395
    },
    {
        "content": "<p>I'm confident this is wrong because the first entry with the slicing definition is where all the standard constraints live (e.g. bindings), and adding slices can't remove those (make them apply only to the 'open' slice).</p>",
        "id": 153955996,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525457497
    },
    {
        "content": "<p>Please submit a change request</p>",
        "id": 153955998,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1525457939
    },
    {
        "content": "<p>Agree it should be fixed</p>",
        "id": 153955999,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1525457953
    },
    {
        "content": "<p>Will do. Just wanted to check that I wasn't missing something.</p>",
        "id": 153956000,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525457971
    },
    {
        "content": "<p><a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16309\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16309\">GF#16309</a></p>",
        "id": 153956002,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525458279
    },
    {
        "content": "<p>the min..max exception is real and deliberate</p>",
        "id": 153956113,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1525496407
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191351\">@Chris Grenz</span> agreed, this seems to be an error in the specification and should be corrected.</p>",
        "id": 153956327,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1525685466
    },
    {
        "content": "<p>Don't know. This was written before we had <code>@default</code> and it seems correct in that context:  the first entry's constraints describe the constraints that must be satisfied by any instance of that element, whether it ends up in a named slice, the @default and the open slice, right?  So, if the slice is open, anything that matches these constraints, but not the ones on the slices ends up in the open slice. I think that is what the current text says, though this has become somewhat ambiguous now there's a @default slice (only if the slice is closed).  If the slice is closed, and you have a @default, it would still need to match these constraints, and any additional constraints the @default slice itself has.  Correct?  Maybe the text should just be expanded, don't think it's wrong.  Unless I have misunderstood.</p>",
        "id": 153956344,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1525694241
    },
    {
        "content": "<p>As I read it, the constraints on the first (slicing) element, which comes from the baseDefinition as an unsliced element, now only apply to instances <em>not</em> falling into a named slice (the \"open\" slice).  This is not correct - all constraints including min, max, bindings, etc. found on this element apply to all instances.</p>\n<p>I'm not sure what <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  is talking about?  min..max on the first element constrains the total number of instances regardless of slicing.  For example, if I profile CodeableConcept, and set <code>#CodeableConcept.coding</code>'s min..max to <code>1..3</code>, there can be only 1, 2, or 3 codings present in any conformant CodeableConcept, full stop.  No amount of slicing or re-slicing can override that.</p>",
        "id": 153956439,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525700432
    },
    {
        "content": "<blockquote>\n<p>As I read it, the constraints on the first (slicing) element, which comes from the baseDefinition as an unsliced element, now only apply to instances <em>not</em> falling into a named slice (the \"open\" slice).  This is not correct - all constraints including min, max, bindings, etc. found on this element apply to all instances.</p>\n</blockquote>\n<p>I never read that into it, but now you are saying it: I could if I wanted to ;-) Agree that it should not mean that, it's not just for the open slice.</p>\n<blockquote>\n<p>I'm not sure what <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  is talking about?  min..max on the first element constrains the total number of instances regardless of slicing.  For example, if I profile CodeableConcept, and set <code>#CodeableConcept.coding</code>'s min..max to <code>1..3</code>, there can be only 1, 2, or 3 codings present in any conformant CodeableConcept, full stop.  No amount of slicing or re-slicing can override that.</p>\n</blockquote>\n<p>\"total number of instances regardless of slicing\", yes that is what the spec says too, I think the two of you agree.</p>",
        "id": 153956442,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1525700725
    },
    {
        "content": "<p>The language of \"open\" slice should at least be replaced with \"all instances\" or something.  Frankly, I think we do a much better job of describing slicing over on profiling.html and this is just muddying the water.</p>",
        "id": 153956443,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525700863
    },
    {
        "content": "<p>I have always interpreted slicing rules as Chris explains them. Apparently the current wording is still ambiguous, so we should try to be crystal clear.</p>",
        "id": 153956459,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1525702683
    },
    {
        "content": "<p>If you set min=1 for the overall element, that does <em>not</em> set min each one on every slice.  It can't.</p>",
        "id": 153956465,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1525703221
    },
    {
        "content": "<p>Ah, I understand.</p>",
        "id": 153956466,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525703273
    },
    {
        "content": "<p>So it's really only min that's excepted.  Max would be the same (or less if specified)</p>",
        "id": 153956468,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525703335
    },
    {
        "content": "<p>Yes, I think that's true.</p>",
        "id": 153956469,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1525703391
    },
    {
        "content": "<p>Technically, a slice can specify conflicting cardinality constraints. For example, 1..1 on overal element and 2...2 on a named slice. This is a valid profile, however no instances will ever match. I consider this a very complicated way of describing the empty set. Like \"SELECT * FROM Persons WHERE 1=0\" is a valid SQL statement that will always returns the empty set. The validator could detect such conflicting constraints and emit a warning.</p>",
        "id": 153956476,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1525704599
    },
    {
        "content": "<p>I'd suggest that it's up to authoring tooling (or any other tooling so inclined) to determine if a set of constraints are exclusive.  It's up to the standard to define what's valid.  A 2..2 slice on a 1..1 element is not valid in that a constraint max cannot be larger than the base .  The min 2 being higher than 1 is OK, except that min must be &lt; max, and max of the profile cannot be larger than the base.</p>\n<p>So, in theory I agree with you, that profiles may construct empty sets, but not with your specific example.  A non-overlapping binding is probably a better example, although that also may get some dissent.</p>",
        "id": 153956477,
        "sender_full_name": "Chris Grenz",
        "timestamp": 1525705160
    }
]