[
    {
        "content": "<p>Issue <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/issues/235\">https://github.com/hapifhir/org.hl7.fhir.core/issues/235</a> relates to the profile <a href=\"https://simplifier.net/MedizininformatikInitiative-ModulPerson/PatientIn\">https://simplifier.net/MedizininformatikInitiative-ModulPerson/PatientIn</a>. Here's the relevant part of the definition:</p>",
        "id": 200303308,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591744641
    },
    {
        "content": "<p>(with commentary):</p>\n<div class=\"codehilite\"><pre><span></span><code>      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier:versicherungsnummer_gkv.type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier.type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;min&quot;</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;patternCodeableConcept&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n          <span class=\"nt\">&quot;coding&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n            <span class=\"p\">{</span>\n              <span class=\"nt\">&quot;system&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;http://fhir.de/CodeSystem/identifier-type-de-basis&quot;</span><span class=\"p\">,</span>\n              <span class=\"nt\">&quot;code&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;GKV&quot;</span>\n            <span class=\"p\">}</span>\n          <span class=\"p\">]</span>\n        <span class=\"p\">},</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n</code></pre></div>\n\n\n<p>ok, so we applied a pattern to <code>Patient.identifier.type</code>. Fine. But then what follows:</p>\n<div class=\"codehilite\"><pre><span></span><code>      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier:versicherungsnummer_gkv.type.coding&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier.type.coding&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n</code></pre></div>\n\n\n<p>ok, then we say that Patient.identifier.type.coding is must-support.</p>\n<div class=\"codehilite\"><pre><span></span><code>      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier:versicherungsnummer_gkv.type.coding:GKV-Type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier.type.coding&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;sliceName&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;GKV-Type&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n</code></pre></div>\n\n\n<p>wait - what? What's with the slice name? where's the slice definition? why is it sliced if we have a pattern?</p>\n<div class=\"codehilite\"><pre><span></span><code>      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier:versicherungsnummer_gkv.type.coding:GKV-Type.system&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier.type.coding.system&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier:versicherungsnummer_gkv.type.coding:GKV-Type.code&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;path&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Patient.identifier.type.coding.code&quot;</span><span class=\"p\">,</span>\n        <span class=\"nt\">&quot;mustSupport&quot;</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n      <span class=\"p\">}</span><span class=\"err\">,</span>\n</code></pre></div>\n\n\n<p>What is it trying to say here to say that these individual elements are must-support when we already imposed a pattern? (my german is rudimentary but I couldn't find any definition of what must-support means)</p>",
        "id": 200303817,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591745085
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> <span class=\"user-mention\" data-user-id=\"193430\">@Alexander Zautke</span> for your comment please</p>",
        "id": 200303831,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591745101
    },
    {
        "content": "<p>\"wait - what? What's with the slice name? where's the slice definition? why is it sliced if we have a pattern?\"<br>\n\"Patient.identifier:versicherungsnummer_gkv\" applies a type profile of \"<a href=\"http://fhir.de/StructureDefinition/identifier-kvid-10\">http://fhir.de/StructureDefinition/identifier-kvid-10</a>\" (See <a href=\"https://simplifier.net/basisprofil-de-r4/identifierkvid10\">https://simplifier.net/basisprofil-de-r4/identifierkvid10</a>). This profile contains a slicing definition for \"Identifier.type.coding\" on value(system). As well as all other definitions around \"GKV-Type\" (also all other slices of Patient.identifier).</p>",
        "id": 200423884,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1591799623
    },
    {
        "content": "<p>\"why is it sliced if we have a pattern?\"</p>\n<p>The identifier slice is open, I think I've added the pattern to indicate that all derived profiles, if they choose to add a new slice, should have a pattern on Identifier.type. The type profile identifier-kvid-10 on the other hand is mandatory as it's part of the German national base profiles.</p>",
        "id": 200423975,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1591799643
    },
    {
        "content": "<p>\"What is it trying to say here to say that these individual elements are must-support when we already imposed a pattern? (my german is rudimentary but I couldn't find any definition of what must-support means)\"</p>\n<p>I don't like the solution either, there is a link to the IPS rules on must-support (<a href=\"https://simplifier.net/guide/MedizininformatikInitiative-ModulPerson-ImplementationGuide/FHIR-Profile\">https://simplifier.net/guide/MedizininformatikInitiative-ModulPerson-ImplementationGuide/FHIR-Profile</a>). However, some implementers of these profiles have the opinion that they can throw everything away, when receiving the resources, that is not marked as must-support.</p>",
        "id": 200425057,
        "sender_full_name": "Alexander Zautke",
        "timestamp": 1591800078
    },
    {
        "content": "<p>not sure how much the IPS definition of must-support helps with that. Stupid people will be stupid anyway</p>",
        "id": 200513005,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591860723
    },
    {
        "content": "<p>my apologies for missing the type profile reference - I didn't look far enough back</p>",
        "id": 200513019,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591860742
    },
    {
        "content": "<p>Yes.  I think trying to use a single mustSupport tag on an element to define both sender and receiver expectations and requirements potentially leaves things open to some weird and unintended interpretations.  But it is what we have at the moment.  And implementers do need to apply some common sense. :)</p>",
        "id": 200554260,
        "sender_full_name": "Rob Hausam",
        "timestamp": 1591886941
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"193430\">@Alexander Zautke</span>  ok back to this, I investigated some more, and improved the error message :</p>\n<div class=\"codehilite\"><pre><span></span><code>Attempt to a slice an element that does not repeat: Reference.identifier/Reference.identifier from http://hl7.org/fhir/StructureDefinition/Reference in https://www.medizininformatik-initiative.de/fhir/core/StructureDefinition/Patient, at element Patient.identifier:versicherungsnummer_gkv.assigner.identifier (slice = iknr)\n</code></pre></div>",
        "id": 200618802,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591917065
    },
    {
        "content": "<p>that looks like a right error message to me. The profile does try to slice identifier, and it isn't something that can be sliced.</p>",
        "id": 200618813,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1591917096
    },
    {
        "content": "<p>Logged <a href=\"https://github.com/FirelyTeam/fhir-net-api/issues/1400\">https://github.com/FirelyTeam/fhir-net-api/issues/1400</a> for the <a class=\"stream\" data-stream-id=\"179171\" href=\"/#narrow/stream/179171-dotnet\">#dotnet</a>  API, feel free to add to it.</p>",
        "id": 201582668,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1592817233
    }
]