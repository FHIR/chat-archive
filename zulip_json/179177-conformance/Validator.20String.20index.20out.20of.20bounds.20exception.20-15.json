[
    {
        "content": "<p>For all composition profiles we get the same error in the Java validator. I ran through one them, disabling parts until I found the 'offending' part.</p>\n<p>It turns out that if you are two sections deep and starting talking about a section.code.coding, without marking section.code first, the validator looses track, so for example in <a href=\"https://simplifier.net/NictizSTU3-Zib2017-Develop/eOverdrachtOverdrachtsberichtKinderen1-18jaar\" target=\"_blank\" title=\"https://simplifier.net/NictizSTU3-Zib2017-Develop/eOverdrachtOverdrachtsberichtKinderen1-18jaar\">eOverdracht-overdrachtsbericht-kinderen-1-18-jaar</a> you cannot just say in the differential:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;element id=&quot;Composition.section:carePlan.section:patientsNeedsAndPreferences.code.coding&quot;&gt;\n  &lt;path value=&quot;Composition.section.section.code.coding&quot; /&gt;\n  &lt;min value=&quot;1&quot; /&gt;\n  &lt;max value=&quot;1&quot; /&gt;\n&lt;/element&gt;\n</pre></div>\n\n\n<p>You need to add:</p>\n<div class=\"codehilite\"><pre><span></span>&lt;element id=&quot;Composition.section:carePlan.section:patientsNeedsAndPreferences.code&quot;&gt;\n  &lt;path value=&quot;Composition.section.section.code&quot; /&gt;\n&lt;/element&gt;\n&lt;element id=&quot;Composition.section:carePlan.section:patientsNeedsAndPreferences.code.coding&quot;&gt;\n  &lt;path value=&quot;Composition.section.section.code.coding&quot; /&gt;\n  &lt;min value=&quot;1&quot; /&gt;\n  &lt;max value=&quot;1&quot; /&gt;\n&lt;/element&gt;\n</pre></div>\n\n\n<p>This seems like a validator bug to me. Is that soomething you can verify <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>? It's the same dev set you have been working on before.</p>\n<div class=\"codehilite\"><pre><span></span>Unable to generate snapshot for eOverdracht-overdrachtsbericht-kinderen-1-18-jaar from Composition because String index out of range: -15\njava.lang.StringIndexOutOfBoundsException: String index out of range: -15\n    at java.lang.String.substring(String.java:1931)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.fixedPathSource(ProfileUtilities.java:1498)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:643)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:685)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:787)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:970)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:970)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:666)\n    at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:472)\n    at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:616)\n    at org.hl7.fhir.r5.context.SimpleWorkerContext.allStructures(SimpleWorkerContext.java:479)\n    at org.hl7.fhir.r5.utils.FHIRPathEngine.&lt;init&gt;(FHIRPathEngine.java:254)\n    at org.hl7.fhir.r5.validation.ValidationEngine.messagesToOutcome(ValidationEngine.java:1199)\n    at org.hl7.fhir.r5.validation.ValidationEngine.validate(ValidationEngine.java:1124)\n    at org.hl7.fhir.r5.validation.ValidationEngine.validate(ValidationEngine.java:1037)\n    at org.hl7.fhir.r5.validation.Validator.main(Validator.java:653)\n</pre></div>",
        "id": 183140960,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1576057548
    },
    {
        "content": "<p>this is still on my todo list. I kind of hope that one day I won't spend all day down in the guts of the snapshot generator....</p>",
        "id": 183141477,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576058033
    },
    {
        "content": "<p>Got it. For now I've added the missing thing manually for all Composition profiles so the error is now gone. However: first Save in Forge will delete that part again as it contains no changes compared to the base, so we'll have to be extra careful there.</p>",
        "id": 183142161,
        "sender_full_name": "Alexander Henket",
        "timestamp": 1576058618
    },
    {
        "content": "<p>anyway, thanks for finding it, it will save me plenty of time</p>",
        "id": 183142502,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1576058897
    }
]