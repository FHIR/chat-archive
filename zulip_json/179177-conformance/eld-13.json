[
    {
        "content": "<p>Is there something wrong with the definition of invariant eld-13<br>\n<code>type.select(code&amp;profile&amp;targetProfile).isDistinct()</code><br>\nThe &amp; is a string concatenation of uri values, and then distinct on that.</p>",
        "id": 153909877,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1506066919
    },
    {
        "content": "<p>as select excepts a collection it seems to be wrong. Correct term would be:<br>\n<code>type.select(code,profile,targetProfile).isDistinct()</code><br>\nThe current invariant always resolves to a<code>{ }</code> collection after the type select, an then the isDistinct always returns true.</p>",
        "id": 153909878,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1506067649
    },
    {
        "content": "<p>Why would that be wrong?</p>",
        "id": 153909937,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1506094898
    },
    {
        "content": "<p>i'm no Fhirpath expert at all, but as pointed out by brian <code>&amp;</code>is a String concat.<br>\nImaginary Example:<br>\n<code>&lt;code value=\"HumanName\" /&gt;\n        &lt;profile value=\"http://fhir.de/StructureDefinition/humanname-de-basis\" /&gt;</code><br>\ngiven the existing eld-13 this will evaluate to:<br>\n<code>type.select(HumanNamehttp://fhir.de/StructureDefinition/humanname-de-basis).isDistinct()</code><br>\n--&gt; the select returns an empty collection --&gt; <code>{ }.isDistinct()</code>--&gt; <code>true</code></p>",
        "id": 153910059,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1506174742
    },
    {
        "content": "<p>after some more reading in the FHIRPath Spec i assume i missed the collection brackets.<br>\n<code>type.select({code,profile,targetProfile}).isDistinct()</code>is my best guess for the corrected invariant</p>",
        "id": 153910687,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1506433965
    },
    {
        "content": "<p>right.....did <code>type.select(code,profile,targetProfile).isDistinct()</code> not trigger an error (incorrect number of parameters) from the evaluator you are using?</p>",
        "id": 153910699,
        "sender_full_name": "Ewout Kramer",
        "timestamp": 1506434385
    },
    {
        "content": "<p>To my understanding (and I'm not a FHIRPath expert either), the current version of eld-13, using Patrick's example, would evaluate to</p>\n<div class=\"codehilite\"><pre><span></span>type.select(HumanNamehttp://fhir.de/StructureDefinition/humanname-de-basis).isDistinct()\n</pre></div>\n\n\n<p>while Patrick's version would evaluate to</p>\n<div class=\"codehilite\"><pre><span></span>type.select([&#39;HumanName&#39;, &#39;http://fhir.de/StructureDefinition/humanname-de-basis&#39;, null]).isDistinct()\n</pre></div>\n\n\n<p>IMHO this should result in the same behavior, but the string concatenated version has the caveat that it hypothetically might find duplicates where there are none.<br>\nE.g. </p>\n<div class=\"codehilite\"><pre><span></span>&lt;code value=&quot;HumanName&quot; /&gt;\n        &lt;targetProfile value=&quot;http://fhir.de/StructureDefinition/humanname-de-basis&quot; /&gt;\n</pre></div>\n\n\n<p>would have the same string result as Patrick's example. That, at least would be wrong.</p>",
        "id": 153910706,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1506435509
    },
    {
        "content": "<p>i did the validation via HAPI 2.5 (validation the whole StrucDef), i just tried:<br>\n<code>&lt;type&gt;\n        &lt;code value=\"Address\" /&gt;\n        &lt;profile value=\"http://fhir.de/StructureDefinition/address-de-basis\" /&gt;\n        &lt;targetProfile value=\"http://fhir.de/StructureDefinition/address-de-basis\"/&gt;\n      &lt;/type&gt;</code><br>\nwith the current eld-13 and it doesn't fail.<br>\nI still assume because:<br>\n<code>type.select(http://fhir.de/StructureDefinition/address-de-basishttp://fhir.de/StructureDefinition/humanname-de-basis).isDistinct()</code> --&gt; <code>{ }.isDistinct()</code> --&gt; <code>true</code></p>",
        "id": 153910712,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1506435941
    },
    {
        "content": "<p>I wouldn't expect an element with only one type to fail eld-13, so returning true seems correct to me</p>",
        "id": 153910734,
        "sender_full_name": "Stefan Lang",
        "timestamp": 1506438324
    },
    {
        "content": "<p>i got confused an thought that the FHIR Path Expression was on Elementdefinition.type<br>\nI now see, that it evaluates the distinctness of the Elements of a resource. Than the expression makes sense the way it is. The only theoretical problem was pointed out by Stefan. Sorry for the confusion.</p>",
        "id": 153910916,
        "sender_full_name": "Patrick Werner",
        "timestamp": 1506503922
    }
]