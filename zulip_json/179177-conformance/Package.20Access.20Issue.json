[
    {
        "content": "<p>I have a question about an issue raised here: <a href=\"https://stackoverflow.com/questions/70584768/errors-when-running-the-fhir-validator-on-the-us-core-patient-example\">https://stackoverflow.com/questions/70584768/errors-when-running-the-fhir-validator-on-the-us-core-patient-example</a></p>",
        "id": 267317502,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678162
    },
    {
        "content": "<p>what's happening is that parameters don't specify a version for the us core package:</p>\n<p><code>-ig hl7.fhir.us.core</code></p>",
        "id": 267317514,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678192
    },
    {
        "content": "<p>so the validator is using the latest version of the package, which is 4.1.0:</p>",
        "id": 267317518,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678212
    },
    {
        "content": "<blockquote>\n<p><code>  Load hl7.fhir.us.core#4.1.0 - 177 resources (00:00.0022)</code></p>\n</blockquote>",
        "id": 267317522,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678224
    },
    {
        "content": "<p>but that's a ballot version, and broken with regard to the terminology for race category. (I'll have to look into what's going on there at some stage <span class=\"user-mention\" data-user-id=\"191401\">@Eric Haas</span>)</p>",
        "id": 267317567,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678266
    },
    {
        "content": "<p>but what's happening is counter-intuitive. See the version history here:</p>",
        "id": 267317570,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678285
    },
    {
        "content": "<p><a href=\"http://hl7.org/fhir/us/core/history.html\">http://hl7.org/fhir/us/core/history.html</a></p>",
        "id": 267317575,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678295
    },
    {
        "content": "<p>\"current version\" is <code>4.0.0</code>, and so it would be natural to assume that the parameter <code>-ig hl7.fhir.us.core</code> would point to the current version. Only, it doesn't, because the validator uses <a href=\"http://packages.fhir.org\">packages.fhir.org</a>, and this is what looking up hl7.fhir.us.core returns:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;_id&quot;: &quot;hl7.fhir.us.core&quot;,\n    &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n    &quot;description&quot;: &quot;The US Core Implementation Guide is based on FHIR Version R4 and defines the minimum conformance requirements for accessing patient data. The Argonaut pilot implementations, ONC 2015 Edition Common Clinical Data Set (CCDS), and ONC U.S. Core Data for Interoperability (USCDI) v1 provided the requirements for this guide. The prior Argonaut search and vocabulary requirements, based on FHIR DSTU2, are updated in this guide to support FHIR Version R4. This guide was used as the basis for further testing and guidance by the Argonaut Project Team to provide additional content and guidance specific to Data Query Access for purpose of ONC Certification testing. These profiles are the foundation for future US Realm FHIR implementation guides. In addition to Argonaut, they are used by DAF-Research, QI-Core, and CIMI. Under the guidance of HL7 and the HL7 US Realm Steering Committee, the content will expand in future versions to meet the needs specific to the US Realm.\\nThese requirements were originally developed, balloted, and published in FHIR DSTU2 as part of the Office of the National Coordinator for Health Information Technology (ONC) sponsored Data Access Framework (DAF) project. For more information on how DAF became US Core see the US Core change notes. (built Mon, Dec 6, 2021 21:52+0000+00:00)&quot;,\n    &quot;dist-tags&quot;: {\n        &quot;latest&quot;: &quot;4.1.0&quot;\n    },\n    &quot;versions&quot;: {\n        &quot;0.0.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;0.0.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;716320373f2ad6a73c544e9faf162518e107104d&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/0.0.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;STU3&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/0.0.0&quot;\n        },\n        &quot;1.0.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;1.0.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;8dd6ac852c1d2cb4ac7312188d8d6ef7ccb65da6&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/1.0.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;STU3&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/1.0.0&quot;\n        },\n        &quot;1.0.1&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;1.0.1&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;7930a0bac34a349b8a300a7ccf01bd4b86379199&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/1.0.1&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;STU3&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/1.0.1&quot;\n        },\n        &quot;1.1.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;1.1.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;4decdb88979861f4bd72b6ad2c68f94244664d0f&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/1.1.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;STU3&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/1.1.0&quot;\n        },\n        &quot;2.0.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;2.0.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;a65e1f0e7004293c9991da2731dd3a944e09fd7c&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/2.0.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;STU3&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/2.0.0&quot;\n        },\n        &quot;2.1.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;2.1.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;8a9e2f72a7946aff047bc0a299c7b49a0f283b20&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/2.1.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/2.1.0&quot;\n        },\n        &quot;3.0.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;3.0.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;58efc3b6c4ed7436fb2de790ca31b4c082c7084e&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.0.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.0.0&quot;\n        },\n        &quot;3.0.1&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;3.0.1&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;20c8d5b480a13fd7ad3e9f41d6f52aad8afa2705&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.0.1&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.0.1&quot;\n        },\n        &quot;3.1.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;3.1.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;a193ba80f9d04e9d7325fbb37188b30c63462e6d&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.1.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.1.0&quot;\n        },\n        &quot;3.1.1&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;3.1.1&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.1.1&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.1.1&quot;\n        },\n        &quot;3.2.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;3.2.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.2.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/3.2.0&quot;\n        },\n        &quot;4.0.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;4.0.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;1ebbdd3bf31607bda1ba48966aba2ff983e07215&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/4.0.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/4.0.0&quot;\n        },\n        &quot;4.1.0&quot;: {\n            &quot;name&quot;: &quot;hl7.fhir.us.core&quot;,\n            &quot;version&quot;: &quot;4.1.0&quot;,\n            &quot;description&quot;: &quot;None.&quot;,\n            &quot;dist&quot;: {\n                &quot;shasum&quot;: &quot;2e04381242fdd8eae0ad60bb2ed314ff3cc004e7&quot;,\n                &quot;tarball&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/4.1.0&quot;\n            },\n            &quot;fhirVersion&quot;: &quot;R4&quot;,\n            &quot;url&quot;: &quot;https://packages.simplifier.net/hl7.fhir.us.core/4.1.0&quot;\n        }\n    }\n}\n</code></pre></div>",
        "id": 267317674,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678453
    },
    {
        "content": "<p>so you see that the validator has no grounds on which to decide that it's going to use 4.0.0 instead of 4.1.0</p>",
        "id": 267317727,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678505
    },
    {
        "content": "<p>The only place that the information to drive selecting 4.0.0 instead of 4.1.0 is published in the file <a href=\"http://hl7.org/fhir/us/core/package-list.json\">http://hl7.org/fhir/us/core/package-list.json</a>:</p>",
        "id": 267317812,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678649
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>  <span class=\"p\">{</span>\n    <span class=\"nt\">\"version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"4.1.0\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"descmd\"</span><span class=\"p\">:</span> <span class=\"s2\">\"&lt;snip&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"path\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core/2022Jan\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"status\"</span><span class=\"p\">:</span> <span class=\"s2\">\"ballot\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"sequence\"</span><span class=\"p\">:</span> <span class=\"s2\">\"STU5\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"fhirversion\"</span><span class=\"p\">:</span> <span class=\"s2\">\"4.0.1\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"date\"</span><span class=\"p\">:</span> <span class=\"s2\">\"2021-12-06\"</span>\n  <span class=\"p\">},</span>\n  <span class=\"p\">{</span>\n    <span class=\"nt\">\"version\"</span><span class=\"p\">:</span> <span class=\"s2\">\"4.0.0\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"descmd\"</span><span class=\"p\">:</span> <span class=\"s2\">\"&lt;snip&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"path\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/us/core/STU4\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"status\"</span><span class=\"p\">:</span> <span class=\"s2\">\"trial-use\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"sequence\"</span><span class=\"p\">:</span> <span class=\"s2\">\"STU4\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"fhirversion\"</span><span class=\"p\">:</span> <span class=\"s2\">\"4.0.1\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"date\"</span><span class=\"p\">:</span> <span class=\"s2\">\"2021-06-28\"</span><span class=\"p\">,</span>\n    <span class=\"nt\">\"current\"</span><span class=\"p\">:</span> <span class=\"kc\">true</span>\n  <span class=\"p\">},</span>\n</code></pre></div>",
        "id": 267317840,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678713
    },
    {
        "content": "<p>but the validator doesn't know about package-list.json, and the lookup from {package-id} to {canonical}/package-list.json isn't algorithmic. Let's see. I'd have to:</p>\n<ul>\n<li>look up the package id on the package server</li>\n<li>get the most recent version of the package </li>\n<li>open the package.json file, and find the canonical URL</li>\n<li>look at {canonical}/package-list.json. if it exists (will for all HL7 publications, but not necessarily in the general case)</li>\n<li>look up the current release in the package-list.json</li>\n<li>now get that package version</li>\n</ul>\n<p>And I'd need to do this... well, I check package currency once a day for #current, and this is pretty much the same idea. So this path would have to happen once a day</p>",
        "id": 267317998,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641678928
    },
    {
        "content": "<p>that's doesn't thrill me.</p>",
        "id": 267318425,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641679409
    },
    {
        "content": "<p>there's another solution to this going forward, which is that we've agreed that from now on, we'll be using <code>5.0.0-ballot1</code> instead of <code>4.1.0</code> - so the validator would ignore any staging releases when looking for the latest release. And any future ballot publications are going to work this way (I wasn't ready for that when US core 4.1.0 was released).</p>",
        "id": 267318516,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641679495
    },
    {
        "content": "<p>but that doesn't help with this problem for existing publications.</p>",
        "id": 267318531,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641679508
    },
    {
        "content": "<p>I'm interested in opinions about this</p>",
        "id": 267318557,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641679540
    },
    {
        "content": "<p>And also I don't know how this pattern would work for Simplifier IGs</p>",
        "id": 267318677,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641679645
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179177-conformance/topic/Package.20Access.20Issue/near/267318516\">said</a>:</p>\n<blockquote>\n<p>there's another solution to this going forward, which is that we've agreed that from now on, we'll be using <code>5.0.0-ballot1</code> instead of <code>4.1.0</code> - so the validator would ignore any staging releases when looking for the latest release. And any future ballot publications are going to work this way (I wasn't ready for that when US core 4.1.0 was released).</p>\n</blockquote>\n<p>I'm not sure that <code>5.0.0-ballot1</code> solves the issue (assuming you're suggesting that the <code>-ballot1</code> is the part that makes the different). Consider once 5.0.0 comes out, and work is going on for <code>5.1.0-ballot1</code> -- any 5.1 version is going to be more preferred than any 5.0 version, won't it?</p>\n<p>Edit - nevermind -- I just noticed the change to the validator that would go with that.</p>",
        "id": 267321397,
        "sender_full_name": "Elliot Silver",
        "timestamp": 1641683240
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> Indeed, I would suggest using the prerelease labels (version <code>1.2.3-anything</code>). For example, for package <a href=\"https://packages.fhir.org/nictiz.fhir.nl.stu3.images\">https://packages.fhir.org/nictiz.fhir.nl.stu3.images</a> the most recent package is <code>1.0.0-beta1</code>, but the package server will show as <code>latest</code> the latest stable version: <code>\"dist-tags\":{\"latest\":\"1.0.1\"}</code>.</p>\n<p>If no stable package is available, it will just list the most recent one, like <a href=\"https://packages.fhir.org/nictiz.fhir.nl.stu3.iwlz\">https://packages.fhir.org/nictiz.fhir.nl.stu3.iwlz</a>: <code>\"dist-tags\":{\"latest\":\"1.0.0-poc5\"}</code></p>",
        "id": 267463270,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1641832522
    },
    {
        "content": "<p>thanks <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span>  how does the server populate \"latest\"? And when are you going to fix the certiticate?</p>",
        "id": 267480112,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641839449
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> -- I'll chime in for <span class=\"user-mention\" data-user-id=\"203235\">@Ward Weistra</span> since he is offline now. <a href=\"#narrow/stream/215610-shorthand/topic/R5.20support/near/267443470\">Over in the #shorthand stream</a>, Ward said he was still waiting on the certificate information from you.  So... if you think you already sent it to him, perhaps try sending it again?</p>",
        "id": 267484760,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1641841590
    },
    {
        "content": "<p>I missed that because I'm so far behind in everything. in progress now</p>",
        "id": 267484862,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1641841638
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191469\">@Chris Moesel</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span> It's been applied!</p>",
        "id": 267563562,
        "sender_full_name": "Ward Weistra",
        "timestamp": 1641897682
    }
]