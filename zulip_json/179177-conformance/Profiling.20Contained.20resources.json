[
    {
        "content": "<p>I have a use case where I want to have a Patient and Practitioner contained in a MedicationRequest resource, using contained references. I'm struggling to get the slicing defined.<br>\nError in my guide is:<br>\n<code>Profile based discriminators must have a type with a profile</code></p>\n<p>This was my first assumption:</p>\n<div class=\"codehilite\"><pre><span></span>        &lt;element id=&quot;MedicationRequest.contained&quot;&gt;\n            &lt;path value=&quot;MedicationRequest.contained&quot; /&gt;\n            &lt;slicing&gt;\n                &lt;discriminator&gt;\n                    &lt;type value=&quot;profile&quot; /&gt;\n                    &lt;path value=&quot;resolve()&quot; /&gt;\n                &lt;/discriminator&gt;\n                &lt;rules value=&quot;closed&quot; /&gt;\n            &lt;/slicing&gt;\n            &lt;max value=&quot;2&quot; /&gt;\n            &lt;mustSupport value=&quot;true&quot; /&gt;\n        &lt;/element&gt;\n        &lt;element id=&quot;MedicationRequest.contained:patient&quot;&gt;\n            &lt;path value=&quot;MedicationRequest.contained&quot; /&gt;\n            &lt;sliceName value=&quot;patient&quot; /&gt;\n            &lt;min value=&quot;1&quot; /&gt;\n            &lt;max value=&quot;1&quot; /&gt;\n            &lt;type&gt;\n                &lt;code value=&quot;Resource&quot; /&gt;\n                &lt;profile value=&quot;http://fhir.fred.com.au/my-sl/StructureDefinition/mysl-patient&quot; /&gt;\n            &lt;/type&gt;\n            &lt;mustSupport value=&quot;true&quot; /&gt;\n        &lt;/element&gt;\n        &lt;element id=&quot;MedicationRequest.contained:practitioner&quot;&gt;\n            &lt;path value=&quot;MedicationRequest.contained&quot; /&gt;\n            &lt;sliceName value=&quot;practitioner&quot; /&gt;\n            &lt;min value=&quot;1&quot; /&gt;\n            &lt;max value=&quot;1&quot; /&gt;\n            &lt;type&gt;\n                &lt;code value=&quot;Resource&quot; /&gt;\n                &lt;profile value=&quot;http://hl7.org/fhir/StructureDefinition/Practitioner&quot; /&gt;\n            &lt;/type&gt;\n            &lt;mustSupport value=&quot;true&quot; /&gt;\n        &lt;/element&gt;\n</pre></div>",
        "id": 188517293,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1582090671
    },
    {
        "content": "<p>sound right to me</p>",
        "id": 188521709,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1582098045
    },
    {
        "content": "<p>Not sure, but might it work if you change the discriminator path to <code>$this.resolve()</code>?</p>",
        "id": 188552430,
        "sender_full_name": "Chris Moesel",
        "timestamp": 1582124937
    },
    {
        "content": "<p>Worked it out, makes sense now that I look at it again.<br>\n<em>(Just in case someone else finds this in the future and wondered what happened)</em><br>\nIssue was that I was using resolve() which is intended to follow a reference, not the inline content, so was expecting to have a targetProfile. <br>\nChanging the slicing from profile to type was the trick.</p>\n<p>So the error message could have been better to indicate that is must have a type with a <code>targetProfile</code> (not <code>profile</code>)</p>\n<div class=\"codehilite\"><pre><span></span>&lt;element id=&quot;MedicationRequest.contained&quot;&gt;\n            &lt;path value=&quot;MedicationRequest.contained&quot; /&gt;\n            &lt;slicing&gt;\n                &lt;discriminator&gt;\n                    &lt;type value=&quot;type&quot; /&gt;\n                    &lt;path value=&quot;$this&quot; /&gt;\n                &lt;/discriminator&gt;\n                &lt;rules value=&quot;closed&quot; /&gt;\n            &lt;/slicing&gt;\n            &lt;max value=&quot;2&quot; /&gt;\n            &lt;mustSupport value=&quot;true&quot; /&gt;\n        &lt;/element&gt;\n        &lt;element id=&quot;MedicationRequest.contained:patient&quot;&gt;\n            &lt;path value=&quot;MedicationRequest.contained&quot; /&gt;\n            &lt;sliceName value=&quot;patient&quot; /&gt;\n            &lt;min value=&quot;1&quot; /&gt;\n            &lt;max value=&quot;1&quot; /&gt;\n            &lt;type&gt;\n                &lt;code value=&quot;Patient&quot; /&gt;\n                &lt;profile value=&quot;http://fhir.fred.com.au/my-sl/StructureDefinition/mysl-patient&quot; /&gt;\n            &lt;/type&gt;\n            &lt;mustSupport value=&quot;true&quot; /&gt;\n        &lt;/element&gt;\n        &lt;element id=&quot;MedicationRequest.contained:practitioner&quot;&gt;\n            &lt;path value=&quot;MedicationRequest.contained&quot; /&gt;\n            &lt;sliceName value=&quot;practitioner&quot; /&gt;\n            &lt;min value=&quot;1&quot; /&gt;\n            &lt;max value=&quot;1&quot; /&gt;\n            &lt;type&gt;\n                &lt;code value=&quot;Practitioner&quot; /&gt;\n            &lt;/type&gt;\n            &lt;mustSupport value=&quot;true&quot; /&gt;\n        &lt;/element&gt;\n</pre></div>",
        "id": 188899260,
        "sender_full_name": "Brian Postlethwaite",
        "timestamp": 1582519981
    }
]