[
    {
        "content": "<p>Suppose I'm slicing Observation.component based on code.coding.code + code.coding.system. I then define my slices and I would like to say \"SHALL use at least this SNOMED CT concept as coding, but could have other concepts as well\". I could do either of the following:</p>\n<ul>\n<li>In each component slice I could slice the component.code.coding with one required slice for the SNOMED CT concept leaving other codings open</li>\n<li>In each component slice I could set a fixed component.code.coding.code and .system and leave coding set to 1..*</li>\n</ul>\n<p>Both options lead to different outcomes in the .Net validator 1.5.2 UI and the Java validator 3.8.0 CLI. The former leads to unrecognized slices. I.e. when you validate, it cannot match data to slice definitions. The latter solution works well, but disallows adding additional codings on any of the slices.</p>\n<p>Question:</p>\n<ul>\n<li>Is my setup possible at all and if so what would be the recommended profiling method?</li>\n</ul>",
        "id": 165629428,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1557845862
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"216303\">@Pieter Edelman</span>, both approaches are valid (with different behavior). Looks like a bug in the validator(s).<br>\n<span class=\"user-mention\" data-user-id=\"191328\">@Ewout Kramer</span>?<br>\nBTW I think there's a third option. You could put constraints on the default child elements of the slice introduction element (with the slicing discriminator). These constraints should apply to all slices. This prevents you from having to repeat the same constraints in each named slice. However, I'm not sure if the validator(s), or any other implementations, support this already...</p>",
        "id": 165649108,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1557859079
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"216303\">@Pieter Edelman</span> .  the validation error you describe for the java validator is described it in <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21472\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21472\">GF#21472</a>. But for your usecase I would suggest another profiling way.  Use pattern/code slicing and patternCodeableConcept within the components which requires that you have of  one of the mentioned codes in your slice. As an example to illustrate this, see the modified blood pressure profile: <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/blob/30803a7a410bec0d9c3f52b34dd799c5aa3a9830/org.hl7.fhir.validation/src/test/resources/validation-examples/observation-bp-profile.xml\" target=\"_blank\" title=\"https://github.com/hapifhir/org.hl7.fhir.core/blob/30803a7a410bec0d9c3f52b34dd799c5aa3a9830/org.hl7.fhir.validation/src/test/resources/validation-examples/observation-bp-profile.xml\">https://github.com/hapifhir/org.hl7.fhir.core/blob/30803a7a410bec0d9c3f52b34dd799c5aa3a9830/org.hl7.fhir.validation/src/test/resources/validation-examples/observation-bp-profile.xml</a> .</p>",
        "id": 165687355,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1557897798
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191478\">@Oliver Egger</span> The pattern slicing works brilliantly. I have one additional twist to the whole setup: we have a bigger lab use case where a component should contain 2 codings. One in LOINC and one in a Dutch system. For the Dutch system the equivalency is not necessarily 1..1 so I just want to say \"Use LOINC X + use a code from Dutch system\"</p>\n<p>A way to say this could have been:</p>\n<div class=\"codehilite\"><pre><span></span>      &lt;patternCodeableConcept&gt;\n        &lt;coding&gt;\n          &lt;system value=&quot;http://loinc.org&quot; /&gt;\n          &lt;code value=&quot;85354-9&quot; /&gt;\n        &lt;/coding&gt;\n        &lt;coding&gt;\n          &lt;system value=&quot;http://dutch.lab.system&quot; /&gt;\n        &lt;/coding&gt;\n      &lt;/patternCodeableConcept&gt;\n</pre></div>\n\n\n<p>But the Java quite elegantly says:</p>\n<p><code>Error @ Observation.component[1] (line 14, col16) : Unsupported CodeableConcept pattern - must be just one coding - for discriminator(code) for slice Observation.component:component1</code></p>\n<p>Does this mean it is legal to specify, but just not supported, or does it mean that it is illegal to specify that way? If illegal: what could be a solution here?</p>",
        "id": 165693247,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1557905964
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191336\">@Michel Rutten</span> We'll file something for the .Net validator unless it has already been filed (pattern slicing). For Forge you might want to check the visual behavior for Forge STU3. The pattern title lists \"no name\" when you specify just system. It updates when you list both system and code. Just a visual glitch. If specifying a system + code is required then maybe a check could be added for that. We did not try R4 for reference on this.</p>",
        "id": 165693426,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1557906193
    },
    {
        "content": "<p>you can submit a test case for the java validator... I'll be doing a run of validator work shortly</p>",
        "id": 165693437,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1557906211
    },
    {
        "content": "<blockquote>\n<p>you can submit a test case for the java validator... I'll be doing a run of validator work shortly</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  Do you have a ticketing system for the Java validator?</p>",
        "id": 165713938,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1557926744
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"216303\">@Pieter Edelman</span> <span class=\"user-mention\" data-user-id=\"191316\">@Grahame Grieve</span>  since i was working last week on <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21240\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21240\">GF#21240</a> for adding support to pattern[x] on elements  I added an example  to the validation suite and a pull request extending pattern[x]  support for slicing, see <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/23\" target=\"_blank\" title=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/23\">https://github.com/hapifhir/org.hl7.fhir.core/pull/23</a></p>",
        "id": 165728145,
        "sender_full_name": "Oliver Egger",
        "timestamp": 1557936741
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"216303\">@Pieter Edelman</span>, thanks for the feedback! Forge tries to generate a useful name from the available info, should be easy to fix the pattern.</p>",
        "id": 165740440,
        "sender_full_name": "Michel Rutten",
        "timestamp": 1557945031
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"216303\">@Pieter Edelman</span> <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/issues\" target=\"_blank\" title=\"https://github.com/hapifhir/org.hl7.fhir.core/issues\">https://github.com/hapifhir/org.hl7.fhir.core/issues</a></p>",
        "id": 165763494,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1557962018
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"216303\">Pieter Edelman</span> <span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span>  since i was working last week on <a href=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21240\" target=\"_blank\" title=\"http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21240\">GF#21240</a> for adding support to pattern[x] on elements  I added an example  to the validation suite and a pull request extending pattern[x]  support for slicing, see <a href=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/23\" target=\"_blank\" title=\"https://github.com/hapifhir/org.hl7.fhir.core/pull/23\">https://github.com/hapifhir/org.hl7.fhir.core/pull/23</a></p>\n</blockquote>\n<p>That's fast! Awesome :)</p>",
        "id": 165785389,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1557990328
    },
    {
        "content": "<blockquote>\n<p>Hi <span class=\"user-mention silent\" data-user-id=\"216303\">Pieter Edelman</span>, thanks for the feedback! Forge tries to generate a useful name from the available info, should be easy to fix the pattern.</p>\n</blockquote>\n<p>Cool! Do you need any additional info?</p>",
        "id": 165785980,
        "sender_full_name": "Pieter Edelman",
        "timestamp": 1557991114
    }
]