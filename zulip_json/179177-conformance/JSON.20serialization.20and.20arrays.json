[
    {
        "content": "<p>Hi all, I have a question about JSON serialization on primitive arrays.  By my reading on the <a href=\"http://hl7.org/fhir/json.html\">JSON Page</a>, primitive arrays are supposed to be serialized as <code>null</code> values if elements have extensions.</p>\n<p>Looking at the <code>administer-zika-virus-exposure-assessment.json</code> file in the R4 examples package, I see the following:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>  <span class=\"nt\">\"timingTiming\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"_event\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">\"extension\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">\"url\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/cqf-expression\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"valueExpression\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n              <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Now()\"</span>\n            <span class=\"p\">}</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">},</span>\n</code></pre></div>\n<p>I believe it should be serialized as:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>  <span class=\"nt\">\"timingTiming\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"event\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"kc\">null</span>\n    <span class=\"p\">],</span>\n    <span class=\"nt\">\"_event\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"p\">{</span>\n        <span class=\"nt\">\"extension\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n          <span class=\"p\">{</span>\n            <span class=\"nt\">\"url\"</span><span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/cqf-expression\"</span><span class=\"p\">,</span>\n            <span class=\"nt\">\"valueExpression\"</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n              <span class=\"nt\">\"language\"</span><span class=\"p\">:</span> <span class=\"s2\">\"text/cql\"</span><span class=\"p\">,</span>\n              <span class=\"nt\">\"expression\"</span><span class=\"p\">:</span> <span class=\"s2\">\"Now()\"</span>\n            <span class=\"p\">}</span>\n          <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">]</span>\n  <span class=\"p\">},</span>\n</code></pre></div>\n<p>Thoughts?</p>",
        "id": 240219458,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1621962403
    },
    {
        "content": "<p>lazy on the nulls; the last ones are dropped</p>",
        "id": 240222497,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1621963806
    },
    {
        "content": "<p>you could make a task for us to be more explicit about that</p>",
        "id": 240222521,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1621963816
    },
    {
        "content": "<p>So even on arrays, it should be removed?  If so, I'll add a ticket to update the documentation.</p>",
        "id": 240222560,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1621963837
    },
    {
        "content": "<p>well, I do remove it when writing but it's OK for it to be present when reading in my implementations</p>",
        "id": 240261562,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1621984042
    },
    {
        "content": "<p>Hmm. I’ll file a ticket for clarification either way - it’s normative, so we should be specific on the behavior</p>",
        "id": 240261945,
        "sender_full_name": "Gino Canessa",
        "timestamp": 1621984406
    }
]