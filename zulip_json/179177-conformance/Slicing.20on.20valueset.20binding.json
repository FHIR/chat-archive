[
    {
        "content": "<p>Hi all - looking for slicing options for the following, would like to slice a CodeableConcept 0..* element to support multiple slices bound to different ValueSets from a single CodeSystem hierarchy - how do i define discriminators so can determine which ValueSet binding is relevant since codes are all in the same CodeSystem (i.e. can't use Coding.system value to discriminate)?</p>",
        "id": 153920124,
        "sender_full_name": "Brett Esler",
        "timestamp": 1510883056
    },
    {
        "content": "<p>Yeah, it's pretty hard then. Could you give some context - why do you need to do this? Why not one valueset?</p>",
        "id": 153920168,
        "sender_full_name": "Vadim Peretokin",
        "timestamp": 1510916146
    },
    {
        "content": "<p>Just slice on the element that has the binding and declare the value set for each.  So long as the value sets are mutually exclusive (or at least all the codes you receive only exist in one of the value sets), validation should work.</p>",
        "id": 153920193,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510921179
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191363\">@Vadim Peretokin</span>  couple of example cases - Australian Medicines Terminology (SNOMED-CT AU Edition)  Medication.code.coding slices for Medicinal Product Pack and Trade Product Pack (0..1 of each)  both are SNOMED-CT but want to restrict to up to  one of each subset.   Another one Organization.type slices using ANZSIC (industry classification); there are two levels in this CodeSystem; want to allow up to one from each level in a profile.</p>",
        "id": 153920202,
        "sender_full_name": "Brett Esler",
        "timestamp": 1510923147
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> how would a validator know which slice  is to be applied? Is the discriminator then the 'code' value itself?  obviously this is more difficult for a validator as needs to check contained in ValueSet rather than a matched value</p>",
        "id": 153920210,
        "sender_full_name": "Brett Esler",
        "timestamp": 1510924901
    },
    {
        "content": "<p>The validator would evaluate the code against each slice.  If it finds 0 or more than one match, it yells.  If it only finds one, it knows what slice applies and then validates the rest accordingly.</p>",
        "id": 153920234,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1510938244
    },
    {
        "content": "<p>thanks <span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  will try this out</p>",
        "id": 153920256,
        "sender_full_name": "Brett Esler",
        "timestamp": 1510984213
    },
    {
        "content": "<blockquote>\n<p>Just slice on the element that has the binding and declare the value set for each.  So long as the value sets are mutually exclusive (or at least all the codes you receive only exist in one of the value sets), validation should work.<br>\n```so if I have valueset A = a,b,c   And valueset B = a,c,d,f.    It will yell if the code is a or c?</p>\n</blockquote>",
        "id": 153920265,
        "sender_full_name": "Eric Haas",
        "timestamp": 1511020252
    },
    {
        "content": "<p>Yup.  Because the element will match multiple slices and that's not (presently) allowed.</p>",
        "id": 153920284,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1511046137
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span> <br>\nAs I read the documentation on <a href=\"http://build.fhir.org/profiling.html#discriminator\" target=\"_blank\" title=\"http://build.fhir.org/profiling.html#discriminator\">discriminators</a> the slice's discriminator specifies the elements and method of testing used to test for slice membership, so if I slice Medication.code with discriminator Medication.code.coding.system, I can only have one slice for each value of system. That would prevent what Brett is asking for.</p>",
        "id": 153955614,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1525327317
    },
    {
        "content": "<p>You can also slice by valueset.  So long as the valuesets don't have overlapping codes (i.e. code + system the same), it's fine if they have codes from the same code system</p>",
        "id": 153955674,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1525349972
    },
    {
        "content": "<p>How do you slice by value set? It is obvious how to slice by CodeSystem: value of coding.system, but I cannot see how to slice by ValueSet.<br>\nWould I slice Medication.code with two discriminators, discriminator1 a 'value' on Medication.code.coding.system and discriminator2 a 'value' on Medication.code.coding.code and then the definitions for each slice specify a value for system, but not for code? That looks wrong.</p>",
        "id": 153955826,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1525386390
    },
    {
        "content": "<p>Slice by value and declare non-overlapping value sets (or fixed values) in your slices.  It looks like the documentation about this as an option could be better, so feel free to submit a change request.  So you'd slice on Medication.code and then in each slice you'd declare a different binding  for Medication.code</p>",
        "id": 153955827,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1525386687
    },
    {
        "content": "<p>Thanks<br>\n<a href=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16522\" target=\"_blank\" title=\"https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16522\">#16522</a> added</p>",
        "id": 153956874,
        "sender_full_name": "Richard Townley-O'Neill",
        "timestamp": 1525752098
    }
]