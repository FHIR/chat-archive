[
    {
        "content": "<p>Using the HAPI validator, for every entry in my Bundle I get:</p>\n<p><code>\"This element does not match any known slice defined in the profile http://kreftregisteret.no/fhir/StructureDefinition/colonoscopyreport-bundle-krg\"</code></p>\n<p>and for the required entries:</p>\n<p><code>\"Bundle.entry:Patient: minimum required = 1, but only found 0 (from http://kreftregisteret.no/fhir/StructureDefinition/colonoscopyreport-bundle-krg)\"</code></p>\n<p>Altough I'm sure that at least my Patient entry is correct.</p>\n<p>The slicing definition is:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n                &quot;id&quot;: &quot;Bundle.entry&quot;,\n                &quot;path&quot;: &quot;Bundle.entry&quot;,\n                &quot;slicing&quot;: {\n                    &quot;discriminator&quot;:  [\n                        {\n                            &quot;type&quot;: &quot;type&quot;,\n                            &quot;path&quot;: &quot;resource&quot;\n                        }\n                    ],\n                    &quot;rules&quot;: &quot;open&quot;\n                },\n                &quot;min&quot;: 3\n            },\n            {\n                &quot;id&quot;: &quot;Bundle.entry:Colonoscopy&quot;,\n                &quot;path&quot;: &quot;Bundle.entry&quot;,\n                &quot;sliceName&quot;: &quot;Colonoscopy&quot;,\n                &quot;min&quot;: 1,\n                &quot;max&quot;: &quot;1&quot;\n            },\n            {\n                &quot;id&quot;: &quot;Bundle.entry:Colonoscopy.resource&quot;,\n                &quot;path&quot;: &quot;Bundle.entry.resource&quot;,\n                &quot;min&quot;: 1,\n                &quot;type&quot;:  [\n                    {\n                        &quot;code&quot;: &quot;Resource&quot;,\n                        &quot;profile&quot;:  [\n                            &quot;http://kreftregisteret.no/fhir/StructureDefinition/colonoscopyreport-colonoscopy&quot;\n                        ]\n                    }\n                ]\n            }\nEtc...\n</code></pre></div>\n<p>something I'm doing wrong here?</p>",
        "id": 257181235,
        "sender_full_name": "Marten Smits",
        "timestamp": 1634034821
    },
    {
        "content": "<p>Is it maybe related to this discussion?<br>\n<a href=\"#narrow/stream/179252-IG-creation/topic/profiling.20a.20transaction/near/213392373\">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/profiling.20a.20transaction/near/213392373</a></p>",
        "id": 257184761,
        "sender_full_name": "Michaela Ziegler",
        "timestamp": 1634036915
    },
    {
        "content": "<p>Thanks for pointing that out. But I don't think so, unless discriminator type <code>type</code> should be <code>profile</code>. I thought <code>profile</code> differentiates on if the correct profile tag is present or not, and <code>type</code> actually checks if the resource conforms to the specified type in the slice ,including the profile</p>",
        "id": 257190350,
        "sender_full_name": "Marten Smits",
        "timestamp": 1634039958
    },
    {
        "content": "<p>Type only checks type, not profile.  Profile checks for a profile match - it doesn't care about the profile tag I don't think.  (Slicing by profile can be pretty heavy...)</p>",
        "id": 257199186,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634044018
    },
    {
        "content": "<p>Ah that explains the errors then. Thanks both!</p>",
        "id": 257212499,
        "sender_full_name": "Marten Smits",
        "timestamp": 1634049099
    },
    {
        "content": "<p>but did it actually explain the errors? </p>\n<p>typically, the errors in this case are buried in slicing info that isn't usually shown. I just changed the validator to display this by default in the case of slicing by profile - you need the latest version (5.5.7) and it's not part of HAPI yet</p>",
        "id": 257253339,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634064750
    },
    {
        "content": "<p>it might be useful to add discriminating by profile tag, as opposed to profile.</p>",
        "id": 257253483,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634064810
    },
    {
        "content": "<p>It did explain the errors, when I changed it from \"type\" to \"profile\" the validation succeeded. I suspect \"type\" checks on Resource, and flags when it's of anything else, which is fine, since type \"Resource\" isn't the best discriminator is it?</p>",
        "id": 257490066,
        "sender_full_name": "Marten Smits",
        "timestamp": 1634195631
    },
    {
        "content": "<p>I've tried the newest release, and the new information message are a nice add-on, thanks for that!</p>",
        "id": 257490167,
        "sender_full_name": "Marten Smits",
        "timestamp": 1634195676
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"191316\">Grahame Grieve</span> <a href=\"#narrow/stream/179177-conformance/topic/.E2.9C.94.20validation.3A.20can't.20find.20what's.20wrong.20with.20profile.20or.20exa.2E.2E.2E/near/257253483\">said</a>:</p>\n<blockquote>\n<p>it might be useful to add discriminating by profile tag, as opposed to profile.</p>\n</blockquote>\n<p>When you say this are you specifically referring to meta.profile? For some reason, I thought doing this was discouraged?</p>",
        "id": 258117171,
        "sender_full_name": "Sarah Gaunt",
        "timestamp": 1634599215
    },
    {
        "content": "<p>It's not <em>encouraged</em> - because it's resource intensive and can be slow.  It's better to slice by resolve().something by type, pattern or value set if there's a simple discriminator in the target resource, rather than checking a full-blown profile.  However, if profile is the only way, then profile is the only way.</p>",
        "id": 258128158,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1634607390
    },
    {
        "content": "<p>actually Sarah was asking about something else - and yes, it's not encouraged, but sometimes it's the right thing to do</p>",
        "id": 258129330,
        "sender_full_name": "Grahame Grieve",
        "timestamp": 1634608481
    }
]