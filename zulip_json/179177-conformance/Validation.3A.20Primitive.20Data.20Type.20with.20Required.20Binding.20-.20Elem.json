[
    {
        "content": "<p>I'm pretty sure I know the answer to this but wanted to double-check. When validating (Java Validation Engine) a resource that has a primitive data type of 'code' where that coded value has a 'required' binding strength to its ValueSet and that code element cardinality is 0..1 and has a null value (not defined) but has an extension, the Validation Engine throws the following error:</p>\n<p>\"No code provided, and a code is required from the value set\"</p>\n<p>My question is - should the presence of the extension allow for the code element to be valid?</p>\n<p>I believe the answer is \"no\" because of the 'required' binding but where do I find that in the specification? The Terminologies page definition of the <a href=\"http://hl7.org/fhir/terminologies.html#required\">Required binding</a> states the following about \"when profiling resources\":</p>\n<blockquote>\n<p>The other place where this is used is <strong>when profiling resources</strong>, and there is agreement within a context of use that a specified set of codes are the only ones that can be used. In these cases, the data type SHALL contain one of the values in the value set.</p>\n</blockquote>\n<p>Does that satisfy this requirement?</p>\n<hr>\n<p>The example I have is an Observation with the following effectiveTiming definition:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code>  <span class=\"nt\">\"effectiveTiming\"</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">\"repeat\"</span> <span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"nt\">\"dayOfWeek\"</span> <span class=\"p\">:</span> <span class=\"p\">[</span> <span class=\"kc\">null</span> <span class=\"p\">],</span>\n      <span class=\"nt\">\"_dayOfWeek\"</span> <span class=\"p\">:</span> <span class=\"p\">[</span> <span class=\"p\">{</span>\n        <span class=\"nt\">\"extension\"</span> <span class=\"p\">:</span> <span class=\"p\">[</span> <span class=\"p\">{</span>\n          <span class=\"nt\">\"url\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"http://hl7.org/fhir/StructureDefinition/data-absent-reason\"</span><span class=\"p\">,</span>\n          <span class=\"nt\">\"valueCode\"</span> <span class=\"p\">:</span> <span class=\"s2\">\"masked\"</span>\n        <span class=\"p\">}</span> <span class=\"p\">]</span>\n      <span class=\"p\">}</span> <span class=\"p\">]</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">},</span>\n</code></pre></div>\n<p>The Timing.repeat.dayOfWeek matches the criteria given above. Per my question above, is this valid or is the generated error correct?</p>\n<p>Thanks.</p>",
        "id": 245763364,
        "sender_full_name": "Richard Ettema",
        "timestamp": 1626132910
    },
    {
        "content": "<p>A required binding <em>must</em> be met for the element to be present at all.  You can't evade it with an extension or any other mechanism.</p>",
        "id": 245770789,
        "sender_full_name": "Lloyd McKenzie",
        "timestamp": 1626140732
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"191320\">@Lloyd McKenzie</span>  Thanks for the confirmation.  That's what I thought.</p>",
        "id": 245819665,
        "sender_full_name": "Richard Ettema",
        "timestamp": 1626180838
    }
]