---
layout: page
title: "FHIR Chat  · Changes to Bulk Data Proposal · bulk data"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/index.html">bulk data</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html">Changes to Bulk Data Proposal</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153931395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931395">(Jan 27 2018 at 20:56)</a>:</h4>
<p>Two changes to bulk data proposal based on our breakout session:</p>



<a name="153931397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931397">(Jan 27 2018 at 20:57)</a>:</h4>
<p>1. On the initial kick-off request, server should accept a "output-format" parameter indicating the format for the bulk data files. Currently, this must be "application/fhir+ndjson". The Accept header will indicate the format for an OperationOutcome response to the kick-off request itself (eg. in the case of a missing parameter).</p>



<a name="153931398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931398">(Jan 27 2018 at 20:57)</a>:</h4>
<p>2. On the final status request (response type of 200), return a body with the following json structure:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;transactionTime&quot;</span><span class="o">:</span> <span class="s2">&quot;[instant]&quot;</span><span class="p">,</span>  <span class="c1">//the server&#39;s time when the query is run (no resources that have a modified data after this instant should be in the response)</span>
  <span class="s2">&quot;request&quot;</span> <span class="o">:</span> <span class="s2">&quot;Patient/$everything?_type=Patient,Observation&quot;</span><span class="p">,</span> <span class="c1">//GET request that kicked-off the bulk data response</span>
  <span class="s2">&quot;secure&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//authentication is required to retrieve the files</span>
  <span class="s2">&quot;output&quot;</span> <span class="o">:</span> <span class="p">[{</span>
    <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;Patient&quot;</span><span class="p">,</span> <span class="c1">//resource type contained in the file</span>
    <span class="s2">&quot;url&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://serverpath2/patient_file_1.ndjson&quot;</span>
  <span class="p">},{</span>
    <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;Patient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;url&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://serverpath2/patient_file_2.ndjson&quot;</span>
  <span class="p">},{</span>
    <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;Observation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;url&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://serverpath2/observation_file_1.ndjson&quot;</span>
  <span class="p">}]</span>
<span class="p">}</span>
</pre></div>



<a name="153931451"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931451" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nagesh Bashyam <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931451">(Jan 27 2018 at 21:37)</a>:</h4>
<p>Dan - I am assuming the output-format is a parameter to the operation and is not part of the header ?</p>



<a name="153931455"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931455" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nagesh Bashyam <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931455">(Jan 27 2018 at 21:39)</a>:</h4>
<p>Also - for the next breakout, it might be worth talking about a polling interval for the status , have heard a few people mention last week at ONC that since it is an async request, it might take more than a few minutes to get the data ready, so it might be good to not continuously poll but poll at regular intervals that is specified by a server in its initial response with the content location</p>



<a name="153931456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931456">(Jan 27 2018 at 21:39)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="191414">@Dan Gottlieb</span> - when did we decide to make those changes?</p>



<a name="153931460"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931460" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931460">(Jan 27 2018 at 21:41)</a>:</h4>
<p><span class="user-mention" data-user-id="192017">@Nagesh Bashyam</span> Yup, -on the querystring.  Also, it would be good to discuss the polling. My initial thought is that we probably want to recommend <a href="https://en.wikipedia.org/wiki/Exponential_backoff" target="_blank" title="https://en.wikipedia.org/wiki/Exponential_backoff">https://en.wikipedia.org/wiki/Exponential_backoff</a></p>



<a name="153931465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931465">(Jan 27 2018 at 21:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> asap, but while leaving the link header in place and continuing to accept ndjson in the Accept header so they're non-breaking for now</p>



<a name="153931466"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931466" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931466">(Jan 27 2018 at 21:43)</a>:</h4>
<p>I'm not sure the change is non-breaking for me</p>



<a name="153931467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931467">(Jan 27 2018 at 21:44)</a>:</h4>
<p>In what way?</p>



<a name="153931469"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931469" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931469">(Jan 27 2018 at 21:44)</a>:</h4>
<p>the accept header change</p>



<a name="153931470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931470">(Jan 27 2018 at 21:44)</a>:</h4>
<p>I'm going to investigate</p>



<a name="153931472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931472">(Jan 27 2018 at 21:47)</a>:</h4>
<p>(deleted)</p>



<a name="153931522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Ignatov <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931522">(Jan 27 2018 at 22:34)</a>:</h4>
<p>The server at <a href="https://bulk-data.smarthealthit.org" target="_blank" title="https://bulk-data.smarthealthit.org">https://bulk-data.smarthealthit.org</a> was updated to implement these changes. Feedback is appreciated</p>



<a name="153931523"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931523" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931523">(Jan 27 2018 at 22:35)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="thumbs up">:thumbs_up:</span></p>



<a name="153931530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931530">(Jan 27 2018 at 22:54)</a>:</h4>
<p>Having a response body with clear type info for each resulting file is working really nicely here.</p>



<a name="153931560"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931560" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931560">(Jan 27 2018 at 23:28)</a>:</h4>
<p>Exponential backoff is fine as a recommendation, but I don't think this should be part of the spec. Different clients in different environments will poll their own way.</p>



<a name="153931561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Danielle Friend <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931561">(Jan 27 2018 at 23:29)</a>:</h4>
<blockquote>
<p>The server at <a href="https://bulk-data.smarthealthit.org" target="_blank" title="https://bulk-data.smarthealthit.org">https://bulk-data.smarthealthit.org</a> was updated to implement these changes. Feedback is appreciated</p>
</blockquote>
<p><span class="user-mention" data-user-id="193731">@Vladimir Ignatov</span> how do you handle multiple requests for $everything? When I make the $everything request multiple times (minutes apart or in quick succession), the response for each returns the same content-location. Are these generated per request/on the fly?</p>



<a name="153931577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Ignatov <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931577">(Jan 27 2018 at 23:42)</a>:</h4>
<p><span class="user-mention" data-user-id="191914">@Danielle Friend</span> Yes. This is a demo server. It does not really generate any files on it's file system. It just makes you wait a while and then gives you a list of files to download... In other words, multiple calls to $everything with the same parameters will result in the same content-location</p>



<a name="153931583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931583">(Jan 27 2018 at 23:45)</a>:</h4>
<p><span class="user-mention" data-user-id="191914">@Danielle Friend</span> <span class="user-mention" data-user-id="193731">@Vladimir Ignatov</span> - it seems like this may be the correct approach since on subsequent requests you're asking for  files that have already been generated...</p>



<a name="153931589"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931589" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nagesh Bashyam <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931589">(Jan 27 2018 at 23:47)</a>:</h4>
<p>I dont think that would work, because each request in the case of Targeted extract for a different set of patients. So some kind of request / response tracking is necessary on the server side which is what we implemented. Even in the case of Patient/$everything, new patients or their observations may change in the system and the previously generated data is not appropriate, unless i am not understanding.</p>



<a name="153931590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nagesh Bashyam <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931590">(Jan 27 2018 at 23:48)</a>:</h4>
<p>Quick comment on the Root URL recommended by Jason :  This is how we had defined it in DAF-Research, before bulk-api came into being. Also defined on the Root URL.</p>
<p><a href="http://hl7.org/fhir/us/daf-research/STU2/OperationDefinition-daf-extract.html" target="_blank" title="http://hl7.org/fhir/us/daf-research/STU2/OperationDefinition-daf-extract.html">http://hl7.org/fhir/us/daf-research/STU2/OperationDefinition-daf-extract.html</a></p>



<a name="153931792"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153931792" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nagesh Bashyam <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153931792">(Jan 28 2018 at 15:19)</a>:</h4>
<p>I updated my server with the changes recommended...Feel free to give it a shot.  </p>
<p><a href="http://52.70.192.201/open-fhir/fhir/Patient/$everything" target="_blank" title="http://52.70.192.201/open-fhir/fhir/Patient/$everything">http://52.70.192.201/open-fhir/fhir/Patient/$everything</a></p>



<a name="153932147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153932147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Toby Hu <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153932147">(Jan 28 2018 at 19:33)</a>:</h4>
<p>@Nagesh Bashyam for the initial query, i think the expected response status code should be 202, your server returns 200.</p>



<a name="153932158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153932158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nagesh Bashyam <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153932158">(Jan 28 2018 at 19:39)</a>:</h4>
<p>Toby, I looked into it and I will have to get a fix from James (for HAPI libraries) to override that status. I will take care of it on the next version.</p>



<a name="153932164"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153932164" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Toby Hu <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153932164">(Jan 28 2018 at 19:40)</a>:</h4>
<p>Sounds good. Thanks.</p>



<a name="153932174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Changes%20to%20Bulk%20Data%20Proposal/near/153932174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Toby Hu <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Changes.20to.20Bulk.20Data.20Proposal.html#153932174">(Jan 28 2018 at 19:45)</a>:</h4>
<p>I registered my client at <a href="http://snapp.clinfhir.com:4000/" target="_blank" title="http://snapp.clinfhir.com:4000/">http://snapp.clinfhir.com:4000/</a> and code can be found at <a href="https://github.com/toby-hu/test/tree/master/client" target="_blank" title="https://github.com/toby-hu/test/tree/master/client">https://github.com/toby-hu/test/tree/master/client</a> .<br>
Any server would like to try a connect?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
