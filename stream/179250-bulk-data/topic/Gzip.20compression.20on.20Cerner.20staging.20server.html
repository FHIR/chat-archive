---
layout: page
title: "FHIR Chat  · Gzip compression on Cerner staging server · bulk data"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/index.html">bulk data</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html">Gzip compression on Cerner staging server</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153995781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikhail Lapshin <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995781">(Sep 11 2018 at 16:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191356">@Jenni Syed</span> , do you consider to enable gzip http compression on Cerner staging Bulk API server? It will drastically decrease amounts of data being downloaded, from hundreds of megabytes to just tens.</p>



<a name="153995869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Patterson <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995869">(Sep 11 2018 at 19:28)</a>:</h4>
<p>The current testing implementation is returning static links to direct downloads from S3.  We could put those links behind CloudFront and enable gzip compression.  I think it's also possible to just upload gzipped data but that'd limit access to uncompressed data for anybody who'd want it</p>



<a name="153995871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995871">(Sep 11 2018 at 19:30)</a>:</h4>
<p>I think most of HTTP clients (including browsers) understand gzip :)</p>



<a name="153995873"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995873" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995873">(Sep 11 2018 at 19:34)</a>:</h4>
<p>part of this limitation is just because this is our beta implementation - not production ready. The gzip and several other http level "large file handling" considerations would be beneficial to add to considerations in the spec</p>



<a name="153995874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995874">(Sep 11 2018 at 19:34)</a>:</h4>
<p>eg: streaming :)</p>



<a name="153995875"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995875" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995875">(Sep 11 2018 at 19:34)</a>:</h4>
<p>this sounds like a good topic for the connectathon :)</p>



<a name="153995878"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995878" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995878">(Sep 11 2018 at 19:36)</a>:</h4>
<p>I know we've talked about chunking as well in the past, which is something we support on some of our other APIs for large file transfers (each chunk would then be gzip as well)</p>



<a name="153995882"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995882" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995882">(Sep 11 2018 at 19:44)</a>:</h4>
<p>Also, I know you mentioned megabytes because that's likely the amount of data we have here. What we've seen in other settings/more realistic production settings gets into the gig size ranges</p>



<a name="153995883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153995883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153995883">(Sep 11 2018 at 19:45)</a>:</h4>
<p>(with other bulk APIs we have that do similar types of operations)</p>



<a name="153996193"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996193" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikhail Lapshin <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996193">(Sep 12 2018 at 10:35)</a>:</h4>
<blockquote>
<p>The current testing implementation is returning static links to direct downloads from S3.  We could put those links behind CloudFront and enable gzip compression.  I think it's also possible to just upload gzipped data but that'd limit access to uncompressed data for anybody who'd want it</p>
</blockquote>
<p>S3 can properly serve pre-gzipped files, you just need to set 'Content Type' and 'Content Encoding' properties on S3 files as described in this post: <a href="https://medium.com/@graysonhicks/how-to-serve-gzipped-js-and-css-from-aws-s3-211b1e86d1cd" target="_blank" title="https://medium.com/@graysonhicks/how-to-serve-gzipped-js-and-css-from-aws-s3-211b1e86d1cd">https://medium.com/@graysonhicks/how-to-serve-gzipped-js-and-css-from-aws-s3-211b1e86d1cd</a></p>
<p>It took me almost a day to download all 5GBs of this dataset, that's why I'm so concerned :)</p>



<a name="153996268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996268">(Sep 12 2018 at 14:51)</a>:</h4>
<p>is there use of http/2 which includes multi-threading and automatic compression?</p>



<a name="153996285"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996285" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996285">(Sep 12 2018 at 15:32)</a>:</h4>
<p>We haven't talked about needing that yet in the spec (much like GZip, streaming, etc) and good discussion to have. I will say that HTTP 2 support is still a bit spotty. I think under 30% support it as of the last stat I heard? So it may not be the 100% win here.</p>



<a name="153996291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996291">(Sep 12 2018 at 15:44)</a>:</h4>
<p>understood, just wanting it on the stack of things to consider... especially when the group is considering gzip.</p>



<a name="153996643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Patterson <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996643">(Sep 13 2018 at 14:02)</a>:</h4>
<p>Set up a CloudFront instance in front of our S3 bucket to auto-compress.  Turns out they'll only do this for files smaller than 10MB, so not gonna help :).  We'll have to look at uploading pre-compressed contents</p>



<a name="153996669"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996669" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996669">(Sep 13 2018 at 15:05)</a>:</h4>
<p>Interesting -- and that would be an API change (i.e., it changes what's returned). I was assuming <code>Accept-Encoding: gzip</code> would get us where we needed to be, but evidently not with S3 http hosting?</p>



<a name="153996676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Patterson <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996676">(Sep 13 2018 at 15:10)</a>:</h4>
<p>Noting that this is all with pre-generated, mock data...  Per <span class="user-mention" data-user-id="191332">@Mikhail Lapshin</span> 's comments above, I think it'd be uploading the gzipped data, tell S3 to return Content-Encoding: gzip, and then when we return the list of files, they'd be able to be retrieved when requesting Accept-Encoding: gzip.  I think AWS' approach is more elaborate if you want to return various compressions (i.e. store them all pre-compressed in S3 and use Lambda@Edge to vary what gets returned according to Accept-Encoding...blah)</p>



<a name="153996690"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996690" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996690">(Sep 13 2018 at 15:22)</a>:</h4>
<p>In this scenario I think things would fail in the <em>absence</em> of <code>Accept-Encoding: gzip</code>-- because a client would get gzipped content regardless of what they requested.</p>



<a name="153996693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Patterson <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996693">(Sep 13 2018 at 15:26)</a>:</h4>
<p>Right, unless we did the work to support both, that's correct.  This would be a connectathon-only limitation for our server, but from the very presence of this thread, I'm guessing that's what most clients want :)</p>



<a name="153996694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Gzip%20compression%20on%20Cerner%20staging%20server/near/153996694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Gzip.20compression.20on.20Cerner.20staging.20server.html#153996694">(Sep 13 2018 at 15:27)</a>:</h4>
<p>It's definitely what most clients <em>should</em> want :-)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
