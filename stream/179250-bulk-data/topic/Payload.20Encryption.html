---
layout: page
title: "FHIR Chat  · Payload Encryption · bulk data"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/index.html">bulk data</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html">Payload Encryption</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154025952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154025952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154025952">(Dec 17 2018 at 16:36)</a>:</h4>
<p>Has anyone from the CMS side mentioned our work on adding in an additional layer of payload encryption to our bulk data server implementation?</p>



<a name="154025953"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154025953" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154025953">(Dec 17 2018 at 16:36)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="196495">@Sutton</span>, <span class="user-mention" data-user-id="196496">@Ryan Nagle</span></p>



<a name="154026128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026128">(Dec 18 2018 at 17:28)</a>:</h4>
<p>to add some color, we've been working on an encryption strategy that uses a public key provided by the API client to secure a payload so that it is protected on both sides of the transfer, only accessible to the party that possesses the corresponding private key.</p>



<a name="154026129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026129">(Dec 18 2018 at 17:31)</a>:</h4>
<p>the initial request/download process matches the current spec, but we've added some fields to responses from our job status endpoint to indicate the key used to protect each file</p>



<a name="154026130"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026130" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026130">(Dec 18 2018 at 17:32)</a>:</h4>
<p>we're planning on providing additional documentation to API consumers to explain how to handle the files once they're in their possession</p>



<a name="154026131"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026131" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026131">(Dec 18 2018 at 17:36)</a>:</h4>
<p>anyway, thought we'd share the idea here in the event anyone has thoughts/feedback for us</p>



<a name="154026132"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026132" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026132">(Dec 18 2018 at 17:38)</a>:</h4>
<p>happy to share more here or arrange a call, feel free to @-msg me <span class="emoji emoji-1f44d" title="thumbs up">:thumbs_up:</span></p>



<a name="154026139"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026139" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026139">(Dec 18 2018 at 18:42)</a>:</h4>
<p>Do you have a test server?</p>



<a name="154026140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026140">(Dec 18 2018 at 18:43)</a>:</h4>
<p>what is the risk that this payload encryption is protecting against? I am starting with the requirement for TLS, and OAuth client authentication/authorization. So I am not clear what risk this payload encryption is protecting against. Without understanding of the risk, it is hard to determine if this solution has reduced that risk. I am a fan of encryption, but it needs to be used properly. Adding more encryption does not always lower risk. For example a payload encryption presents an "Availability" risk caused by loss of keys.</p>



<a name="154026143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026143">(Dec 18 2018 at 18:55)</a>:</h4>
<p>currently, we do not have a public test server</p>



<a name="154026144"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026144" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026144">(Dec 18 2018 at 18:56)</a>:</h4>
<p>ok, thanks</p>



<a name="154026151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026151">(Dec 18 2018 at 20:04)</a>:</h4>
<p>one risk we've discussed is the exposure of client credentials. if a client's credentials are compromised and an attacker successfully queries for their data, the payload is effectively useless to them without also gaining access to the private key.</p>



<a name="154026152"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026152" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026152">(Dec 18 2018 at 20:06)</a>:</h4>
<p>it happens that this approach also satisfies some compliance with CMS acceptable risk safeguards with regard to protecting sensitive data at-rest</p>



<a name="154026153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026153">(Dec 18 2018 at 20:08)</a>:</h4>
<p>that's the gist of it, would love to hear from you all. thanks for the time!</p>



<a name="154026163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026163">(Dec 18 2018 at 20:41)</a>:</h4>
<p>it the client credentials are exposed, you can just repeat the query?</p>



<a name="154026176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026176">(Dec 18 2018 at 21:32)</a>:</h4>
<p>right -- for example, if the client is not aware their credentials have been compromised / they have not been revoked, an attacker could use the creds to initiate a new request</p>



<a name="154026184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026184">(Dec 18 2018 at 21:51)</a>:</h4>
<p>Hey Ryan, I <em>thought</em> the intent of the <a href="https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md#registering-a-smart-backend-service-communicating-public-keys" target="_blank" title="https://github.com/smart-on-fhir/fhir-bulk-data-docs/blob/master/authorization.md#registering-a-smart-backend-service-communicating-public-keys">Backend Services</a> spec was to limit the use of OAuth2 client_credentials to only "asymmetric" authentication mechanisms (e.g. public/private key pairs), which are further, optionally protected by rotating the certs referenced in the Json Web Key Set.</p>



<a name="154026185"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026185" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026185">(Dec 18 2018 at 21:51)</a>:</h4>
<p>The rotating JWK Set not only provides public/private key pairs as authentication within the existing spec, but also includes the ability to rotate these keys pretty quickly.</p>



<a name="154026186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026186">(Dec 18 2018 at 21:51)</a>:</h4>
<p>Do you think we should modify this section of the spec to also encrypt the payload?</p>



<a name="154026197"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026197" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026197">(Dec 18 2018 at 22:38)</a>:</h4>
<p>hey isaac, thanks for the reply</p>



<a name="154026198"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026198" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026198">(Dec 18 2018 at 22:39)</a>:</h4>
<p>i should've mention up front -- we're still exploring options for our auth/n/z strategy and don't know for sure if the backend services spec will 100% work for us.</p>



<a name="154026199"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026199" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026199">(Dec 18 2018 at 22:40)</a>:</h4>
<p>in my example above, i was assuming the typical client_credentials workflow (i.e., using a <code>client_id</code> and <code>client_secret</code>)</p>



<a name="154026200"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026200" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026200">(Dec 18 2018 at 22:41)</a>:</h4>
<p>in all events, i'm happy to share more re: our experience working with the backend services spec, but it'll probably be a while before we have coherent feedback :-)</p>



<a name="154026202"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026202" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026202">(Dec 18 2018 at 22:46)</a>:</h4>
<p>to answer your question, i don't think the spec should necessarily require payload encryption. it makes sense given our requirements, but might not work for others.</p>



<a name="154026203"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026203" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026203">(Dec 18 2018 at 22:54)</a>:</h4>
<p>i suppose i'm wondering where you all see these sorts of modifications/addenda for specifics use cases fitting in with the spec in general, if at all</p>



<a name="154026235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026235">(Dec 19 2018 at 03:15)</a>:</h4>
<blockquote>
<p>if the client is not aware their credentials have been compromised / they have not been revoked, an attacker could use the creds to initiate a new request</p>
</blockquote>
<p>So what does encryption achieve? not much....</p>



<a name="154026236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026236">(Dec 19 2018 at 03:22)</a>:</h4>
<p>I'm just catching up here -- thanks for the discussion. I'm on the same page as John: would definitely help to understand specific threats.</p>



<a name="154026237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026237">(Dec 19 2018 at 03:23)</a>:</h4>
<p>A few quick notes:</p>
<ul>
<li>
<p>The current Bulk Data spec is written independent of the Backend Services security spec (but they're designed to work well together).</p>
</li>
<li>
<p>Modifications/addenda are always the trick when it comes to standardizing an end-to-end system for data exchange. If you introduce a modification to a protocol, and it's <em>required</em> for clients who talk to your system, then your system is no longer compatible with generic clients.</p>
</li>
<li>
<p>This means that, especially for modifications/addenda that are general-purpose or important (or likely to be made <em>mandatory</em> by some servers), we'd like to understand these up-front as much as possible, and incorporate them into our initial design.</p>
</li>
</ul>



<a name="154026238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026238">(Dec 19 2018 at 03:24)</a>:</h4>
<p>As Isaac points out, the client's credentials never go over the wire in our current Backend Service spec; they're used only for asymmetric signatures, and can be rotated by the client.</p>



<a name="154026360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026360">(Dec 19 2018 at 16:50)</a>:</h4>
<p>It's also worth pointing out the <em>reason</em> we have compliance issues here that we're trying to address: In general, our risk mitigation policies aren't thrilled with the idea of "we have a server on the open internet sitting around with a ton of bulk data PII/PHI on it."</p>
<p>That leaves us only one remote code execution vulnerability away from "oops, someone just scraped all the waiting-for-delivery payloads off our disk and sent them to &lt;bad-actor-of-your-choice&gt;." And while that absolutely is a low probability event (those vulns don't come along very often), the pain if it happens is high enough to warrant extra mitigation effort. The reasonablest approach we could get agreement on was ensuring that files weren't sitting effectively-unencrypted at rest (disk-level or single-key encryption aren't helpful here).</p>
<p><span class="user-mention" data-user-id="196496">@Ryan Nagle</span> Is that an accurate summary of the compliance concerns?</p>



<a name="154026362"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026362" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026362">(Dec 19 2018 at 16:54)</a>:</h4>
<p>It would be good to describe technically how the approach you're outlining (re: per-client encryption) could be built on top of the current specs (which have the potential advantage that a client's public key is already known by a server at the time an export request is issued).</p>



<a name="154026364"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026364" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026364">(Dec 19 2018 at 16:56)</a>:</h4>
<p>(BTW, I really appreciate the background here -- thanks for engaging in the discussion!)</p>



<a name="154026365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026365">(Dec 19 2018 at 17:01)</a>:</h4>
<p><span class="user-mention" data-user-id="192789">@Karl M. Davis</span> accurate in my opinion, thanks for chiming in. <span class="emoji emoji-1f44d" title="thumbs up">:thumbs_up:</span></p>



<a name="154026366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026366">(Dec 19 2018 at 17:01)</a>:</h4>
<p>Isn't that risk usually addressed by operational security technology such as encrypting databases, encypting filesystems, etc? Things that don't need to affect the Interoperability layer?<br>
Further by indicating it is per-client encryption, this means that the data is available on that server in non-encrypted form so that it can be encrypted to a targeted client. <br>
What I am worried about is added complexity at the Interoperability layer caused by security-theater.</p>



<a name="154026367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026367">(Dec 19 2018 at 17:03)</a>:</h4>
<p>Is there a write-up on how you're approaching this from a technical perspective, <span class="user-mention" data-user-id="196496">@Ryan Nagle</span> ?</p>



<a name="154026368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026368">(Dec 19 2018 at 17:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> I agree it's important to nail down these details, with clear discussion about threats. In practice, one very common error (outside of remote code execution vulnerabilities on cloud VMs) is for a server to push files to a cloud storage bucket (for a client to fetch from) and then someone accidentally makes that bucket public. Plenty of stories in the news on this kind of misconfiguration, and the additional encryption <em>does</em> mitigate the risk. It all comes back to the threats we're most concerned about.</p>



<a name="154026369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026369">(Dec 19 2018 at 17:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> we're working on that as we speak, we should have a solid draft in the next few weeks</p>



<a name="154026370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026370">(Dec 19 2018 at 17:09)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> Those aren't effective mitigation strategies, because -- from the standpoint of an attacker with a code execution exploit -- the encryption doesn't exist. Filesystem, DB, etc. encryption only really protects from the, "someone robbed the data center and walked away with the disks," risk, which... <em>okay</em>, but isn't a real big concern.</p>



<a name="154026371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026371">(Dec 19 2018 at 17:09)</a>:</h4>
<p><span class="user-mention" data-user-id="196496">@Ryan Nagle</span> ok -- on the timing here, is there an intention to describe your approach as a "small diff" building on top of the specification we have today? I think it could be a useful exercise, but if you want to go this route it would be good to think about that from the beginning.</p>



<a name="154026372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026372">(Dec 19 2018 at 17:13)</a>:</h4>
<p>It's also worth mentioning that we here at CMS (and the VA and the DoD) have a very different risk profile from your average provider or payer considering use of the bulk data API.</p>



<a name="154026373"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026373" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026373">(Dec 19 2018 at 17:13)</a>:</h4>
<blockquote>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> I agree it's important to nail down these details, with clear discussion about threats. In practice, one very common error (outside of remote code execution vulnerabilities on cloud VMs) is for a server to push files to a cloud storage bucket (for a client to fetch from) and then someone accidentally makes that bucket public. Plenty of stories in the news on this kind of misconfiguration, and the additional encryption <em>does</em> mitigate the risk. It all comes back to the threats we're most concerned about.</p>
</blockquote>
<p>For this I would agree that encrypting the blob is a good a proper solution.</p>



<a name="154026374"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026374" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026374">(Dec 19 2018 at 17:15)</a>:</h4>
<p>(Actually, KMS is pretty awesome and does protect against the, "we just oopsed our S3 ACLs," risk. But the point, in general, is still a good one: there's lots of ways to footgun yourself and we have to take a defense-in-depth approach, which the payload encryption is a part of.)</p>



<a name="154026375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026375">(Dec 19 2018 at 17:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> that's more or less correct. in short, everything about the request and delivery process matches the current state of the bulk data spec, the difference comes in the "post-processing" of the payload.</p>



<a name="154026376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026376">(Dec 19 2018 at 17:18)</a>:</h4>
<p>Is there a negotiation or some protocol over the wire to determine what sort of encryption will be used, or to communicate to the client what has been used?</p>



<a name="154026379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026379">(Dec 19 2018 at 17:22)</a>:</h4>
<p>that's a good question. at present, we're using AES GCM and planned on specifying that in our documentation. i can't see us offering other options for encryption, since we're limited in what we can use cipher-wise for compliance. but, if it were generalized, i think communicating that as part of file delivery makes sense.</p>



<a name="154026380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026380">(Dec 19 2018 at 17:26)</a>:</h4>
<p>you mentioned the advantage of having a client pub key already in-hand -- this is exactly what we're hoping to leverage. but, like i said, we're still working on our story for client registration, client credentials workflow and so on. we'll have more we can share in the coming weeks.</p>



<a name="154026400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026400">(Dec 19 2018 at 17:40)</a>:</h4>
<p>Interesting ; so for the AES approach, you'll define some way to communicate a symmetrically shared AES key to the client. Will it be one AES key per client, or per export job, or per exported file? Given the threat model you outlined, I'd expect one AES key per job, which could be communicated directly as part of the JSON manifest file for the job when it's complete. If that's vaguely right, we'd be talking about something like adding a parameter to the manifest payload to communicate this key, which would be populated at the server's discretion when exported-file-encryption was enabled.</p>



<a name="154026414"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026414" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026414">(Dec 19 2018 at 18:23)</a>:</h4>
<p>If I was reading the spec right however many months ago, one area of potential non-compliance is that it specifically says the payload must be an NDJSON file, and doesn't it also call out a MIME type or two?</p>



<a name="154026415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026415">(Dec 19 2018 at 18:23)</a>:</h4>
<p>That's not hard to fix, I'm sure, but still worth noting.</p>



<a name="154026416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026416">(Dec 19 2018 at 18:27)</a>:</h4>
<p><span class="user-mention" data-user-id="196496">@Ryan Nagle</span> Are you still thinking of moving to streaming encryption at some point? Does that impact this conversation at all?</p>



<a name="154026417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026417">(Dec 19 2018 at 18:48)</a>:</h4>
<p><span class="user-mention" data-user-id="192789">@Karl M. Davis</span> yep, i believe you're right about the payload format. good point.</p>



<a name="154026418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026418">(Dec 19 2018 at 18:49)</a>:</h4>
<p>we're taking a pretty naive approach to payload encryption to start, encrypting the entire file as a single message</p>



<a name="154026419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026419">(Dec 19 2018 at 18:50)</a>:</h4>
<p>we're going to have to look at other options, including chunking large files into smaller contiguous messages so that both the server and client don't have to hold potentially very large files in memory to decrypt</p>



<a name="154026420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026420">(Dec 19 2018 at 18:56)</a>:</h4>
<p>i should say server side to encrypt, client side to decrypt</p>



<a name="154026421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026421">(Dec 19 2018 at 18:57)</a>:</h4>
<p>I would recommend the use of standards based enclosures that already have key management and algorithm communication. The standard I would recommend is CMS. I have written profiles in IHE that use CMS for end-to-end security. In the case of IHE (DEN profile), the mechanism fits within a Document Sharing environment, or used on portable media (CD-ROM, USB-Memory). This CMS standard is very flexible.</p>



<a name="154026422"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026422" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026422">(Dec 19 2018 at 18:59)</a>:</h4>
<p>this is the same standard that makes up the cryptography portion of S/MIME, leveraged by the USA specific Direct Project.</p>



<a name="154026423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026423">(Dec 19 2018 at 18:59)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> awesome, thank you. i'll read up!</p>



<a name="154026425"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026425" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026425">(Dec 19 2018 at 19:01)</a>:</h4>
<p>High level intro to the IHE DEN Profile <a href="https://wiki.ihe.net/index.php/Document_Encryption" target="_blank" title="https://wiki.ihe.net/index.php/Document_Encryption">https://wiki.ihe.net/index.php/Document_Encryption</a><br>
Formal normative text <a href="http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_DEN.pdf" target="_blank" title="http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_DEN.pdf">http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_DEN.pdf</a><br>
These are global standards. The standards are available to use... one must just select them.</p>



<a name="154026426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026426">(Dec 19 2018 at 19:03)</a>:</h4>
<p>so my ask about the risk is not because I am against encryption... I authored the IHE, and was the author of the security assessment of the Direct Project... I simply am making sure that the risk you are trying to address is worthy of the 'costs' of applying end-to-end encryption. I have too often seen excited people define end-to-end encryption only to find that it is very costly in terms of technology, management, and failure-modes.</p>



<a name="154026427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026427">(Dec 19 2018 at 19:06)</a>:</h4>
<p>I am also worried when we start to re-invent protocols such as SOAP which has end-to-end encryption and authenticity as a major benefit of using that technology over the more simple http/REST. One can do REST over SOAP. SOAP also has asynchronous modes and many other features. If that is desired, accessing the FHIR REST resources can be done leveraging those existing and well-implemented standards.</p>



<a name="154026428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026428">(Dec 19 2018 at 19:08)</a>:</h4>
<p>(and in this specific case, the use of end-to-end encryption is unique and therefore breaks current Backend Services / bulk data clients. )</p>



<a name="154026430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026430">(Dec 19 2018 at 19:08)</a>:</h4>
<p>i understand and i appreciate your questions and comments, this is been a tremendously valuable conversation for me.</p>



<a name="154026431"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026431" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026431">(Dec 19 2018 at 19:09)</a>:</h4>
<p>Ryan, the FHIR connectathon is a whole weekend of this type of feedback! Think you'll make it?</p>



<a name="154026433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026433">(Dec 19 2018 at 19:15)</a>:</h4>
<p><span class="user-mention" data-user-id="191864">@Isaac Vetter</span> i _might_ be able to, i'm not sure at the moment</p>



<a name="154026434"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026434" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026434">(Dec 19 2018 at 19:17)</a>:</h4>
<p>i only know that it is happening, but don't recall the dates</p>



<a name="154026435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026435">(Dec 19 2018 at 19:18)</a>:</h4>
<p>January 12-13, 2019 (<a href="http://www.hl7.org/events/working_group_meeting/2019/01/" target="_blank" title="http://www.hl7.org/events/working_group_meeting/2019/01/">http://www.hl7.org/events/working_group_meeting/2019/01/</a>)</p>



<a name="154026436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026436">(Dec 19 2018 at 19:19)</a>:</h4>
<p>thank you</p>



<a name="154026437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026437">(Dec 19 2018 at 19:25)</a>:</h4>
<p>Re: the mime type question, for encrypted payloads it's a good question. I think our protocol would still want to convey/negotiate what's inside (confirming NDJSON vs Parquet or whatever), as well an indication that the content is encrypted.</p>



<a name="154026442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026442">(Dec 19 2018 at 20:03)</a>:</h4>
<p>In the IHE DEN profile it is made clear that the contained object(s) that is encrypted can be of any mime-type, and that mime-type is recorded in the CMS header, while the CMS object it-self is described using the mime-type of "application/pkcs7-mime".<br>
That doesn't answer the question Josh is asking, which is more how does the client identify what type of payload they want.. Which seems to me could be simply use of the http negotiate mecahnism. Use the fhir type you see in the negotiation, and also see that application/pkcs7-mime is in negotiate.. right?</p>



<a name="154026443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154026443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154026443">(Dec 19 2018 at 20:04)</a>:</h4>
<p>Well, we don't use straight-up HTTP content-type negotiation because we're not negotiating the content-type of the <em>response manifest file</em> -- we're negotiating the content-type of the eventually-to-be-exported data files. But it's the same basic idea (i.e., the client passes along a parameter to the kick-off request saying "I want NDJSON out in the end, please").</p>



<a name="154243169"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154243169" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154243169">(Jan 03 2019 at 14:43)</a>:</h4>
<p>happy new year, all <span class="emoji emoji-1f44b" title="wave">:wave:</span></p>



<a name="154243254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154243254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154243254">(Jan 03 2019 at 14:44)</a>:</h4>
<p>as promised, a (draft) doc explaining how we implement per-client payload encryption: <a href="https://github.com/CMSgov/bcda-app/blob/master/ENCRYPTION.md" target="_blank" title="https://github.com/CMSgov/bcda-app/blob/master/ENCRYPTION.md">https://github.com/CMSgov/bcda-app/blob/master/ENCRYPTION.md</a></p>



<a name="154243306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Payload%20Encryption/near/154243306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Nagle <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Payload.20Encryption.html#154243306">(Jan 03 2019 at 14:45)</a>:</h4>
<p>appreciate any critique/feedback you are willing to offer</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
