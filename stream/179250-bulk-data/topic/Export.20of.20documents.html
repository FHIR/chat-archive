---
layout: page
title: "FHIR Chat  · Export of documents · bulk data"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/index.html">bulk data</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html">Export of documents</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="177805070"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177805070" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Veliyan Georgiev <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177805070">(Oct 10 2019 at 12:40)</a>:</h4>
<p>Hello everybody. We have the following use case. A client wants to export a large number of documents (10K+) from our system. The IDs of these documents are already known by the client ahead of time. The client wants the metadata and the actual content of the documents. <br>
We want to deliver this functionality using $export but we have 2 outstanding items:</p>
<ol>
<li>How to use the 10K+ IDs as part of the $export command? (we started looking at Group but group doesn't allow for DocumentReference to be a member yet)</li>
<li>How to return the content of the document in the ndjson?</li>
</ol>



<a name="177809535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177809535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177809535">(Oct 10 2019 at 13:29)</a>:</h4>
<p>For (1) create a group with the patients those documents belongs to and then use that for the export<br>
For (2) I remember some discussion  but not conclusions - but the document content can be inside the document themselves</p>



<a name="177809804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177809804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Veliyan Georgiev <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177809804">(Oct 10 2019 at 13:32)</a>:</h4>
<p>Thanks Michele. <br>
1) The client actually doesn't want all documents for a patient. The client has the actual document IDs of the documents of interest<br>
2) I'd love to dig deeper into it. I also remember conversations but not actual conclusion.</p>



<a name="177870614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177870614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177870614">(Oct 11 2019 at 01:45)</a>:</h4>
<p>Interesting. The export operation as currently defined doesn't have a good way to enumerate large numbers of individual resources, but the general pattern of async search might help for (1) --- which is, outside of $export in theory you could do a search for <code>DocumentReference?_id=1,2,3,500</code>, (or inside of $export, you could try the experimental <code>_typeFilter</code> parameter to pass through this kind of filter). Probably 10000 individual IDs will break in a single URL query.</p>
<p>For (2), we mostly talked about using FHIR Binary resources and returning using the standard async output mechanism, or just having the client issue a pile of parallel queries for the content if it's not modeled as Binary.</p>



<a name="177870662"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177870662" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177870662">(Oct 11 2019 at 01:46)</a>:</h4>
<p>(Clearly the use case you're describing isn't quite the thing $export is designed for, and it's a struggle to make it fit.)</p>



<a name="177871076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177871076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177871076">(Oct 11 2019 at 01:57)</a>:</h4>
<p>Is this part of a conversion?, what's the use case?, how does the client already know the document ids?<br>
This info may help to generalize the need.</p>



<a name="177901890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177901890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Veliyan Georgiev <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177901890">(Oct 11 2019 at 12:26)</a>:</h4>
<p>Josh - we thought of something similar and came to the same conclusion - GET will most likely break. Obviously making $export a POST request will get around the limitation and to some extent even represent the change in state more accurately (an export command is being created on the server). The subsequent status checks can be GET of course. <br>
On (2) - I think it is worth brainstorming on this one a bit more and even talk F2F next month. We proposed very similar workaround to the dev team and committed to starting this conversation here. Couple points that were brought up were - if we fast forward in the future - how would  a $import work using the output from $export? - a 2-step process of getting the metadata first and then the binaries might end up making the job of resolving references much harder if not impossible.</p>
<p>Isaac - this is a part of a payer workflow in which the "payer" selects only those documents that need to be presented as evidence (so it is not all documents per patient). The closest example that comes to mind is a shopping cart-style workflow - they browse the store (document repository) and select the products (documents) and eventually those products show up in a package (fhir export)</p>



<a name="177910704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177910704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177910704">(Oct 11 2019 at 14:16)</a>:</h4>
<p>But for a shopping cart, the numbers just aren't that large. Is there something about your process for selecting documents that causes you to go from having 0 documents of interest to having huge numbers all at once?</p>



<a name="177932158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/177932158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#177932158">(Oct 11 2019 at 18:00)</a>:</h4>
<p>For a folder of documents there is DocumentManifest and List. Both of these are used in interfacing with XDS/XCA/XDM/XDR environments. A DocumentManifest is the same as an XD* SubmissionSet, and a List is the same as a XD* Folder.</p>



<a name="178099770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/178099770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Veliyan Georgiev <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#178099770">(Oct 14 2019 at 12:50)</a>:</h4>
<p>Josh - yeah. There is a particular workflow. All documents are NLP-ed and the extracted information is what the user performs searches on. Once the user searches the NLP extract on let's say "give me all documents between these 2 dates that are radiology reports and have mention of nodules etc.." (which could be tens of thousands) - then the user will request an export of the underlying documents. The only thing the user has at this time is pointers to the original documents (those are also stored in the NLP metadata of course)</p>



<a name="178205216"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/178205216" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#178205216">(Oct 15 2019 at 15:38)</a>:</h4>
<p>As a data point on something similar, the Google Cloud DICOM store has a filtered export operation (in alpha) that takes a path to a cloud storage bucket containing a flat file with a list of studies/series/instances to export. This may not be easily standardized, but it's indicative of what we had to do to facilitate certain use cases.</p>
<p>In any kind of cohort selection process the user will often come up with a very large "shopping list" of items to get from the server. Even if the items are patient bundles and Group $export applies, FHIR needs a scalable pattern for communicating that group to the server. The discussion of paginated Group/List with $add/$remove operations is enough to make it possible, but doing 100,000 $add operations to build a temporary Group as a parameter to a one-off export is inefficient.</p>



<a name="178221224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/178221224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Veliyan Georgiev <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#178221224">(Oct 15 2019 at 18:32)</a>:</h4>
<p><span class="user-mention" data-user-id="197072">@Paul Church</span> I was just about to type up today that we have the exact same situation with our DICOM repo as well. Very interesting to see how Google is addressing it</p>



<a name="178559859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Export%20of%20documents/near/178559859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> natus <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Export.20of.20documents.html#178559859">(Oct 19 2019 at 19:30)</a>:</h4>
<p><span class="user-mention" data-user-id="197402">@Veliyan Georgiev</span>  i would simply use the <code>List</code> resource. </p>
<ol>
<li>create a list with the 10k documents</li>
<li>give the list <code>id</code> to your client.</li>
<li>the client use the <code>_list</code> parameter over the <code>Composition</code> resource</li>
</ol>
<p>in this scenario, there is no transfer of the 10k docuemnt ids.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
