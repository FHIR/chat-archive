---
layout: page
title: "FHIR Chat  · Can an auth server allow requests with no scope? · bulk data"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/index.html">bulk data</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html">Can an auth server allow requests with no scope?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="253445898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/253445898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#253445898">(Sep 15 2021 at 16:36)</a>:</h4>
<p>inferno <code>Auth-11: Token endpoint requires scope</code> claims that the server should reject requests to the token endpoint that do not specify a scope.</p>
<p>In my opinion, the bulk data spec requirement around supplying scope is really a requirement on the client.<br>
A server should be allowed to grant some set of default scopes even if the client has not explicitly requested them.<br>
I think this test should be removed from the suite.</p>



<a name="253446479"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/253446479" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Ignatov <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#253446479">(Sep 15 2021 at 16:39)</a>:</h4>
<p>To clarify, the test is intentionally omitting the <code>scope</code> parameter and expects the server to reply with an error instead of granting a "default scope".</p>



<a name="267638967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267638967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267638967">(Jan 11 2022 at 20:16)</a>:</h4>
<p>Our implementation is still failing this inferno test.  Is there anything we can do to help move this one forward?  Maybe open an issue on the inferno-community and/or bdt repos?</p>



<a name="267655823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267655823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267655823">(Jan 11 2022 at 22:29)</a>:</h4>
<p>That makes sense to me, but scope is a required request parameter in the IG. <span class="user-mention" data-user-id="191315">@Josh Mandel</span> is it valid to allow an empty string for scope in a backend services request (or in an app launch request for that matter)?</p>



<a name="267657760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267657760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267657760">(Jan 11 2022 at 22:48)</a>:</h4>
<blockquote>
<p>A server should be allowed to grant some set of default scopes even if the client has not explicitly requested them.</p>
</blockquote>
<p>We had this discussion for SMART App Launch and <a href="http://jira.hl7.org/browse/FHIR-32221">FHIR-32221</a> documents our choices (and what we chose <em>not</em> to say). Generally speaking: we want clients to request the scopes they need, but servers ultimately use this as  one (of potentially many) inputs into the decision about what scopes to grant.</p>



<a name="267657804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267657804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267657804">(Jan 11 2022 at 22:48)</a>:</h4>
<p>Trivially I believe that a client providing a scope parameter with an empty value meets the letter of our current spec.</p>



<a name="267658031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267658031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267658031">(Jan 11 2022 at 22:50)</a>:</h4>
<p>So test "Auth-11: The server should reject requests to the token endpoint that do not specify a scope" is valid, but test "Auth-12: The server should reject requests to the token endpoint that are requesting an empty scope" is not?</p>



<a name="267659884"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267659884" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267659884">(Jan 11 2022 at 23:07)</a>:</h4>
<p>I think that'd be my technical reading; and I don't hate that too much.</p>



<a name="267666573"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267666573" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267666573">(Jan 12 2022 at 00:21)</a>:</h4>
<p>i don't have any issue saying clients SHALL pass scopes.  but thats a little different than saying servers SHALL reject clients that don't.<br>
here inferno is acting as the client and violating this part of the spec, but since we're outside the spec anyway, I think our server should be allowed to assign some default scopes (or no scopes at all) instead of being forced to reject the request<br>
so i disagree that Auth-11 is a valid (or useful) test</p>



<a name="267747277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179250-bulk%20data/topic/Can%20an%20auth%20server%20allow%20requests%20with%20no%20scope%3F/near/267747277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/179250-bulk-data/topic/Can.20an.20auth.20server.20allow.20requests.20with.20no.20scope.3F.html#267747277">(Jan 12 2022 at 16:19)</a>:</h4>
<p>Fair point, seems reasonable to treat it as a requirement on the client to provide, but not on the sever to require.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
