---
layout: page
title: "FHIR Chat  · Audit Logging · Da Vinci PAS"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/index.html">Da Vinci PAS</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html">Audit Logging</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="211816985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/211816985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#211816985">(Sep 30 2020 at 20:38)</a>:</h4>
<p>Can anyone here help me out with a question about Audit logging for a PAS implementation. Following the HRex guide mutually authenticated TLS is an option for PAS. Does this certify the client IP Address or just the client certificate. In the AuditEvent.agent.network I don't see a type for any data included in the certificate. I can populate the IP Address but this can easily be spoofed. Has anyone else ran into this or know how to provide accurate audit logging for MA TLS?</p>



<a name="211827281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/211827281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#211827281">(Sep 30 2020 at 21:07)</a>:</h4>
<p>the AuditEvent.agent.network.address would be best to hold the hostname, the IP numeric value is less useful (especially in a NAT environment). Tied to this one should use BCP195 guidance which would force server-name-indication validation. Thus there is a strong relationship between the hostname you tried to connect to with the hostname declared in the certificate that was presented and authenticated. Thus it is really a set of steps that gives you the assurance, not just one string.</p>



<a name="211827345"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/211827345" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#211827345">(Sep 30 2020 at 21:07)</a>:</h4>
<p>see BCP195 - <a href="https://tools.ietf.org/html/bcp195">https://tools.ietf.org/html/bcp195</a></p>



<a name="212068691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/212068691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#212068691">(Oct 02 2020 at 12:44)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191404">@John Moehrke</span> - is the client hostname more reliable than the IP? If they access via a web client won't the hostname be null?</p>



<a name="212075547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/212075547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#212075547">(Oct 02 2020 at 13:41)</a>:</h4>
<p>Correct observation. The guidance given was more on "Server Name Indication", which is intended to make sure that the server you got connected to was the intended server. The client is much less reliant on hostnames, but still has the problem of NAT.  Are you using OAuth, or mutual-auth-TLS? In the case of OAuth, you would be better to record the client_id; as that is what is authenticated. The machine IP address is much less important.</p>



<a name="212076081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/212076081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#212076081">(Oct 02 2020 at 13:45)</a>:</h4>
<p>hmm, well, the codes allowed don't really have a good code for client_id..  might need to think about a CR to either expand and/or relax that binding.</p>



<a name="212076384"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/212076384" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#212076384">(Oct 02 2020 at 13:47)</a>:</h4>
<p>Note that the authentication step would be recorded as one auditEvent, where the transaction details would be recorded as a second event. Might be too focused on including in one AuditEvent the transaction details and the details of the authentication... Good discussion</p>



<a name="212082786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/212082786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#212082786">(Oct 02 2020 at 14:37)</a>:</h4>
<p>Yes the network types are very restrictive. I'm using mutually authenticated TLS not OAuth. So I will have the client certificate but not a client_id from the authentication. One thought was to use the IP in the network and then put the id in the altId field and the certificate CN in the name</p>



<a name="212096783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208874-Da%20Vinci%20PAS/topic/Audit%20Logging/near/212096783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/208874-Da-Vinci-PAS/topic/Audit.20Logging.html#212096783">(Oct 02 2020 at 16:21)</a>:</h4>
<p>so the successful TLS authentication should generate a standalone AuditEvent.  This is most true of TLS authentication failures. Sometimes the successful authentications are repressed as they would be very noisy.  The TLS driven AuditEvent can be more expressive. IHE has not defined an AuditEvent pattern for this TLS authentication as often this event is handled fully within general purpose IT layers and thus difficult to catch and duplicate in a healthcare specific audit log. Thus expected when this level of detail is needed, the system logs will be inspected. <br>
The AuditEvents from things that happen next (e.g. like a REST operation) would be a different AuditEvent. What is important is using the .network consistently between these two AuditEvents (or between how the AuditEvent looks and how the system logs for TLS look).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
