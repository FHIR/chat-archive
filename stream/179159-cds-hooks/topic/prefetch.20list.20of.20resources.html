---
layout: page
title: "FHIR Chat  · prefetch list of resources · cds hooks"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/index.html">cds hooks</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html">prefetch list of resources</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153892074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892074">(Jun 02 2017 at 09:45)</a>:</h4>
<p>Spec for prefetch says: <code>each value is a FHIR Bundle.entry indicating a response status and returned resource</code></p>
<p>A Bundle.entry is 0..*, so it's an array in FHIR, but in the spec text and example, it seems to be using Bundle.entry[1] directly</p>



<a name="153892075"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892075" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892075">(Jun 02 2017 at 09:47)</a>:</h4>
<p>There's just one example where the EHR would need to send a list, <code>"medications": "MedicationOrder?patient={{Patient.id}}"</code>, but the spec doesn't have an example for that. </p>
<p>I'll go with treating the prefetch objects value as an array of objects as using <code>Bundle.entry</code> would prescribe - but it would mean that it doesn't align with the text following it <code>indicating a response status and a returned resource</code> nor the provided examples</p>



<a name="153892076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892076">(Jun 02 2017 at 09:48)</a>:</h4>
<p>Can anyone confirm/deny the problem?</p>



<a name="153892123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Carlson <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892123">(Jun 02 2017 at 15:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191363">@Vadim Peretokin</span>  I just opened Zulip to ask exactly the same question.  Looking at <span class="user-mention" data-user-id="191368">@Brett Esler</span> redbook service definition that includes a prefetch -- "conditions": "Condition?patient={{Patient.id}}&amp;_count=1000".  This would return a bundle with multiple entries, each containing one resource.  Seems like the spec should require any array for prefetch objects (entries).</p>



<a name="153892131"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892131" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Esler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892131">(Jun 02 2017 at 15:54)</a>:</h4>
<p>I read this more 'like a FHIR Bundle.entry' and I expected the prefetch items that return multiple items to have 'resource' set to a Bundle (which is the resource returned by the prefetch statement)</p>



<a name="153892135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Carlson <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892135">(Jun 02 2017 at 16:09)</a>:</h4>
<p>Brett, with that interpretation, it would be most consistent for any prefetch based on a query to expect a Bundle resource. So, in your Redbook services, all prefetch other than "patient". Many of your prefetch queries include &amp;_count=1.  When invoking, how would I know whether your service is expecting a single resource or a Bundle, unless I parsed the query looking for _count=1 ?</p>



<a name="153892141"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892141" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Esler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892141">(Jun 02 2017 at 16:39)</a>:</h4>
<p>The prefetch would return a resource or a bundle as per FHIR API call so {emrbase}/Patient/{{Patient.id}} returns a single Patient resource with the id provided (FHIR read); something like "{emrbase}/Condition?patient={{Patient.id}}&amp;_count=1000" or "{emrbase}/Observation?patient={{Patient.id}}&amp;code=55284-4&amp;_count=1&amp;_sort:desc=date”  are FHIR searches so return a Bundle (even though there is only ever one result in the 2nd one; still a Bundle)</p>



<a name="153892143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Esler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892143">(Jun 02 2017 at 16:47)</a>:</h4>
<p>so just making the call on the EMR as stated in the pre-fetch; it might be good to say something about paging as expect the prefetch should provide all the pages available from the EMR - although can't see how to supply this for a CDS call as there would be multiple Bundles (pages); this kind of goes back to your original point... </p>



<a name="153892146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Carlson <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892146">(Jun 02 2017 at 17:05)</a>:</h4>
<p>Thanks Brett.  So, as I continue to build a test using your hooks service, you expect all prefetch values other than "patient" to send a Bundle in the request?</p>



<a name="153892195"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892195" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Esler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892195">(Jun 03 2017 at 00:54)</a>:</h4>
<p>I am just reading it as supply the response from the stated prefetch statement with the base url of the EMR - so the response will be a bundle for FHIR API search or a specific resource when a FHIR API read (based on the prefetch statement)  - the only way I can see there being a single resource (other than Bundle) is if one of the context variables is supplied like {{Patient.id}} - i.e. retrieve a specific resource like {emrBase}/{resourceType}/{{contextId}}</p>



<a name="153892196"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/prefetch%20list%20of%20resources/near/153892196" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Esler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/prefetch.20list.20of.20resources.html#153892196">(Jun 03 2017 at 00:54)</a>:</h4>
<p>so for redbook service you are right - Patient resource (read) and the rest are Bundles (search)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
