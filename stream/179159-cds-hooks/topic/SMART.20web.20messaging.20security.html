---
layout: page
title: "FHIR Chat  · SMART web messaging security · cds hooks"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/index.html">cds hooks</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html">SMART web messaging security</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="176768121"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/176768121" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#176768121">(Sep 27 2019 at 17:42)</a>:</h4>
<p>We've had a long-standing open issue about whether/how to address security in SMART Web Messaging. I've added <a href="https://github.com/smart-on-fhir/smart-web-messaging/pull/4/files?short_path=04c6e90#diff-04c6e90faac2675aa89e2176d2eec7d8to" target="_blank" title="https://github.com/smart-on-fhir/smart-web-messaging/pull/4/files?short_path=04c6e90#diff-04c6e90faac2675aa89e2176d2eec7d8to">https://github.com/smart-on-fhir/smart-web-messaging/pull/4/files?short_path=04c6e90#diff-04c6e90faac2675aa89e2176d2eec7d8to</a> document one approach -- namely, defining a <code>smart_web_messaging_token</code> that acts like a limited-purpose access token (specifically designed to be safely movable into the browser environment, even for apps that keep their full access_tokens on a secure server; and conferring limited access only to web messaging APIs).</p>
<p>Would love thoughts on this, and alternatives we should consider.</p>



<a name="176769661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/176769661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#176769661">(Sep 27 2019 at 17:57)</a>:</h4>
<p>with the idea being that the <code>smart_web_messaging_token</code> isn't exactly authentication, but rather a convenient way for the container to correlate a recently established OAuth session/set of granted scopes with the embedded app?</p>



<a name="176771836"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/176771836" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#176771836">(Sep 27 2019 at 18:21)</a>:</h4>
<p>That's correct. Correlation is exactly how I'd put it (correlating a specific browser window with the authorization context from the app launch).</p>



<a name="177250128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177250128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177250128">(Oct 03 2019 at 14:32)</a>:</h4>
<p>Line 199 is where my brain immediately jumps</p>



<a name="177250178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177250178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177250178">(Oct 03 2019 at 14:33)</a>:</h4>
<p>We now have a server auth token and a browser auth token, essentially. What makes the browser one more secure?</p>



<a name="177252270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177252270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177252270">(Oct 03 2019 at 14:54)</a>:</h4>
<p>Nothing makes it more secure -- it just comes with limited permissions, so apps that don't otherwise need to push an access token into the browser don't have to.</p>



<a name="177252455"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177252455" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177252455">(Oct 03 2019 at 14:56)</a>:</h4>
<p>The web messaging token is focused entirely on web messaging (i.e., helps the EHR correlate a given browser window with a session).</p>



<a name="177299870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177299870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177299870">(Oct 04 2019 at 00:04)</a>:</h4>
<p>Perhaps reusing the word "token" in a smart spec is a mistake. Inappropriate expectations and such. You really mean this to be a session id. Note that if you called it hub.topic, you'd potentially enable fhircast web messages.</p>



<a name="177377815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177377815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177377815">(Oct 04 2019 at 20:50)</a>:</h4>
<p>We can name it whatever, if we like that idea of having it in the first place...( <code>smart_web_messaging_handle</code> maybe). The main question I have is whether people like this approach.</p>



<a name="177574658"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177574658" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177574658">(Oct 08 2019 at 00:45)</a>:</h4>
<p>I like it</p>



<a name="177923557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177923557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177923557">(Oct 11 2019 at 16:23)</a>:</h4>
<p><span class="user-mention" data-user-id="191644">@Raj M</span> - does WK have insight or feedback on this?</p>



<a name="177936094"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/177936094" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raj M <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#177936094">(Oct 11 2019 at 18:38)</a>:</h4>
<p>we follow similar pattern internally between smart containers and apps running within the container. we call it appToken. I don't have any particular preference on the naming, smart_web_messaging_handle is good. one feedback we got from our security folks when we implemented it, is to have expiry logic (end of session) on the smart_web_messaging_handle which I guess is assumed but it will be good to elucidate that in the spec</p>



<a name="178122039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/178122039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#178122039">(Oct 14 2019 at 17:30)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191644">@Raj M</span>! I've updated the PR to include a quick description of expiration logic, and typing the handle to one window.  (<a href="https://github.com/smart-on-fhir/smart-web-messaging/pull/4/files?short_path=04c6e90#diff-04c6e90faac2675aa89e2176d2eec7d8" target="_blank" title="https://github.com/smart-on-fhir/smart-web-messaging/pull/4/files?short_path=04c6e90#diff-04c6e90faac2675aa89e2176d2eec7d8">See here</a>.)</p>



<a name="178293799"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/178293799" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raj M <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#178293799">(Oct 16 2019 at 14:24)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="180157679"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/SMART%20web%20messaging%20security/near/180157679" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/SMART.20web.20messaging.20security.html#180157679">(Nov 07 2019 at 18:05)</a>:</h4>
<p>Thanks to <span class="user-mention" data-user-id="191609">@Matt Randall</span> for a good discussion on threat models + what we're trying to enable with a smart_web_messaging_handle. I've <a href="https://github.com/smart-on-fhir/smart-web-messaging/pull/4/files#diff-04c6e90faac2675aa89e2176d2eec7d8to" target="_blank" title="https://github.com/smart-on-fhir/smart-web-messaging/pull/4/files#diff-04c6e90faac2675aa89e2176d2eec7d8to">merged the PR defining this feature</a>; let's plan to discuss here + in our argonaut calls before calling this a wrap.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
