---
layout: page
title: "FHIR Chat  · Dates in prefetch URLs · cds hooks"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/index.html">cds hooks</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html">Dates in prefetch URLs</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="242229856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/242229856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorge de la Garza <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#242229856">(Jun 10 2021 at 16:01)</a>:</h4>
<p>Hi, I have a CDS Hooks server that allows authors of services to specify relative dates in the FHIR queries utilized by that service.  For example, "Get all instances of a certain lab that the patient has had in the last 6 months..." or "Get all inpatient encounters the patient has had in the last 30 days".  When a client invokes a service and doesn't prefetch resources, my server can substitute these relative date expressions with an actual date.  The issue is that in the discovery response, I'm not aware of any way to specify a relative date in the prefetch URLs, and if I replace the relative date expressions with actual dates at the time discovery response is generated, then if the client caches the services in the discovery response, those prefetch URLs will grow "stale" over time.</p>
<p>Any idea how to handle this? Should servers avoid using date parameters in prefetch URLs? Should clients always hit the discovery endpoint before invoking a service to make sure prefetch URLs are fresh? Perhaps there could be a supported syntax to specify a relative date in prefetch URLs?</p>



<a name="242257975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/242257975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#242257975">(Jun 10 2021 at 19:28)</a>:</h4>
<p>This is a great use case; agreed it could be done through an enhancement to the prefetch syntax. (<a href="http://hl7.org/fhirpath/#subtraction-2">http://hl7.org/fhirpath/#subtraction-2</a> provides a standard and a syntax that we could embed if we wanted this.)</p>



<a name="242353555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/242353555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorge de la Garza <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#242353555">(Jun 11 2021 at 14:32)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191315">@Josh Mandel</span>. Should I enter this issue in Github or Jira or what is the process for this?</p>



<a name="242353816"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/242353816" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#242353816">(Jun 11 2021 at 14:34)</a>:</h4>
<p>Starting with discussion here to judge interest seems like the right first step.</p>



<a name="242472640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/242472640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#242472640">(Jun 12 2021 at 21:09)</a>:</h4>
<p>Doesn't fhirpath have something similar for fhirpath query?<br>
Where you can use {{today() - 6 month}}</p>



<a name="242488097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/242488097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#242488097">(Jun 13 2021 at 03:54)</a>:</h4>
<p>Indeed! (This is what I linked to in my post above.)</p>



<a name="244214202"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/244214202" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aziz Boxwala <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#244214202">(Jun 28 2021 at 22:47)</a>:</h4>
<p>We have a similar need for specifying relative date expressions in our prefetch template. +1 for this request <span class="user-mention" data-user-id="192535">@Jorge de la Garza</span>  and the proposed approach.</p>



<a name="254404552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/254404552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#254404552">(Sep 22 2021 at 17:19)</a>:</h4>
<p>Why wouldn't this be a change to the FHIR search parameters, instead of just CDS Hooks?</p>



<a name="254424028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/254424028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#254424028">(Sep 22 2021 at 19:27)</a>:</h4>
<p>You could take a look at the x-fhir-query specification <a href="http://build.fhir.org/ig/HL7/sdc/expressions.html#fhirquery">currently defined</a> in the SDC IG.  We could possibly migrate this into R5 if there was a desire to use it outside SDC.</p>



<a name="254428645"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Dates%20in%20prefetch%20URLs/near/254428645" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Dates.20in.20prefetch.20URLs.html#254428645">(Sep 22 2021 at 19:56)</a>:</h4>
<p>That's neat. We'd need to either change the current prefetch tokens to be valid FHIRpath, or change our {{ }} delimiters.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
