---
layout: page
title: "FHIR Chat  · Client side pre-conditions · cds hooks"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/index.html">cds hooks</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html">Client side pre-conditions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="188580373"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188580373" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rong Chen <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188580373">(Feb 19 2020 at 20:13)</a>:</h4>
<p>Has anyone encountered the need for some kind of pre-conditions of a cds-service? Say for a given hook, there is a specific cds service to check if the anti-coagulation treatment is given to an atrial fibrillation (AF) patient according to AF management clinical guidelines. The actual treatment compliance checking is quite involved, but the pre-condition (or inclusion criteria) for that is the patient has AF condition and can be easily determined at client side (EHR). Without some kind of pre-conditions checking/filtering at client side, about 96% of the cds-service calls are meaningless since AF is only about 4% prevalence in general population. </p>
<p>Other pre-conditions could be patient age group, gender or relevant medications. The point is to avoid unnecessary calls of remote cds-service unless some pre-defined conditions are met.</p>



<a name="188589177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188589177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carl Anderson <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188589177">(Feb 19 2020 at 21:48)</a>:</h4>
<p>I'm not sure there's been discussion about a mechanism to <em>suppress</em> calls, but I imagine that by pre-fetching the right resources in the hook definition you could make the calls lightweight enough.</p>



<a name="188589686"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188589686" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carl Anderson <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188589686">(Feb 19 2020 at 21:54)</a>:</h4>
<p>Let me know if this is helpful: <a href="https://cds-hooks.org/specification/current/#prefetch-template" target="_blank" title="https://cds-hooks.org/specification/current/#prefetch-template">https://cds-hooks.org/specification/current/#prefetch-template</a></p>



<a name="188615535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188615535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rong Chen <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188615535">(Feb 20 2020 at 07:27)</a>:</h4>
<p>Pre-fetching does help (that's actually what we use) a bit, but it doesn't avoid unnecessary calls (involving round-trip) of remote cds-services.</p>



<a name="188616165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188616165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rong Chen <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188616165">(Feb 20 2020 at 07:43)</a>:</h4>
<p>For inspiration, an optional predictions attribute could be added to the service definition:<br>
{<br>
      "hook": "patient-view",<br>
      "title": "Static CDS Service Example",<br>
      "description": "An example of a CDS Service that returns a static set of cards",<br>
      "id": "static-patient-greeter",<br>
      "prefetch": {<br>
        "patientToGreet": "Patient/{{context.patientId}}"<br>
      }<br>
      "preconditions": {<br>
        "patient.gender": "male"<br>
      }<br>
    }</p>
<p>To indicate that if the patient.gender isn't male, the client should not proceed to call at all. This does add a bit of complexity to the client-side to process the conditions. Since it's optional, similar to pre-fetch as an optimization, the client can still go ahead to call if it doesn't have the capability to process the pre-condictions.</p>



<a name="188646359"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188646359" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Patterson <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188646359">(Feb 20 2020 at 15:15)</a>:</h4>
<p><span class="user-mention" data-user-id="192736">@Rong Chen</span>  this had come up previously and was ultimately scoped out for 1.0, relying on the CDS Client underlying rules engine to handle when to invoke the CDS Service.  You can have a look at the discussion here - <a href="https://github.com/cds-hooks/docs/issues/6" target="_blank" title="https://github.com/cds-hooks/docs/issues/6">https://github.com/cds-hooks/docs/issues/6</a></p>



<a name="188652670"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188652670" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rong Chen <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188652670">(Feb 20 2020 at 16:18)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191358">@Dennis Patterson</span> . It's pity since this could bring significant potential for optimization. Any chance to bring it up for v1.1 considerations? If it's optional attribute (thus optional for client to process), it would fit in v1.1. Even with simple criteria like age, gender and single condition would be very useful.</p>



<a name="188753297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188753297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188753297">(Feb 21 2020 at 17:18)</a>:</h4>
<p>Are you suboptimal behavior in a production scenario today? Would be good to understand impact.</p>



<a name="188809665"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188809665" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rong Chen <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188809665">(Feb 22 2020 at 09:51)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> Yes, it is based on the observation of production use of our patient-view hook based cds alert for stroke prevention. The relevant clinical guideline is only applicable for atrial fibrillation patient, which is about 2-4 % in general population. In other words, 96-98% of cds-service calls aren't necessary at all if the patient has no documented AF condition. You can find more information about the design of the cds from this publication on the scientific evaluation of the CDS, <a href="https://www.ncbi.nlm.nih.gov/pubmed/29534063" target="_blank" title="https://www.ncbi.nlm.nih.gov/pubmed/29534063">https://www.ncbi.nlm.nih.gov/pubmed/29534063</a></p>
<p>For a regional EHR that covers half million population (include GPs &amp; specialists care which is perhaps unique in Sweden), this means 10k calls per day (again 96-98% is unnecessary if the client can process some kind of pre-condition or inclusion/exclusion criteria). This is just one service, if we continue to add 20-100 more cds-services one could easily see why the current design isn't optimal.</p>



<a name="188821564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/188821564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#188821564">(Feb 22 2020 at 15:23)</a>:</h4>
<p>Thanks! The design is assuredly not optimal -- I'm just trying to understand the real-world consequences today, and anticipated consequences down the line. The things we could talk abou are 1) is this slowing down EHR usage for folks? Can this be quantified? 2) is this costing extra $$ in bandwidth or compute? Can this be quantified? 3) Is this preventing adoption of a broader set of services, vs. say steering your organization toward adopting closer-to-the-edge or more-highly-aggregated CDS service deployments? 4) is this causing compliance challenges? Of what nature? </p>
<p>Other categories?</p>



<a name="189185922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/189185922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#189185922">(Feb 27 2020 at 04:23)</a>:</h4>
<p>Apologies for joining the conversation late, Rong. </p>
<blockquote>
<p>Has anyone encountered the need for some kind of pre-conditions of a cds-service?</p>
</blockquote>
<p>Yes, very much so.</p>



<a name="189185923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/189185923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#189185923">(Feb 27 2020 at 04:23)</a>:</h4>
<p>The widely deployed current state is that a CDS Hooks service can co-exist with local CDS rules exactly as you describe. (e.g. only call zika cds service if patient is female). It's not only appropriate, but also often desirable to intermix local CDS rules with remote CDS Hooks services to minimize traffic/compute/cost/UI time. Currently, these "pre-conditions" are also locally configured. Some systems/organizations use <a href="http://www.hl7.org/fhir/clinicalreasoning-module.html" target="_blank" title="http://www.hl7.org/fhir/clinicalreasoning-module.html">FHIR Clinical Reasoning</a> to also provide interoperable rules to define pre-conditions. I expect to see more of these "CQL Hooks" going forward.</p>



<a name="189185924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/189185924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#189185924">(Feb 27 2020 at 04:23)</a>:</h4>
<p>You should determine the cost/benefit analysis of simply documenting the requisite pre-conditions to healthsystems using your service versus building an interoperable description of those rules.</p>



<a name="189189057"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/189189057" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#189189057">(Feb 27 2020 at 05:52)</a>:</h4>
<p>I think that means that there isn't interoperability in the pre-conditions at this time.</p>



<a name="189189060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/189189060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#189189060">(Feb 27 2020 at 05:52)</a>:</h4>
<p>but it seems like a reasonable thing to desire to me</p>



<a name="189487562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/Client%20side%20pre-conditions/near/189487562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rong Chen <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/Client.20side.20pre-conditions.html#189487562">(Mar 02 2020 at 12:48)</a>:</h4>
<p>Thanks for the confirmation, <span class="user-mention" data-user-id="191864">@Isaac Vetter</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
