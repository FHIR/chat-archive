---
layout: page
title: "FHIR Chat  · &#x27;sub&#x27; key in JWT token · cds hooks"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/index.html">cds hooks</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html">&#x27;sub&#x27; key in JWT token</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153956935"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956935" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Olbrich <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956935">(May 08 2018 at 13:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191355">@Kevin Shekleton</span> what are your current thoughts about the 'sub' key in the JWT token?  There's a comment in the sandbox 2.0 issues where you suggest that it might get dropped from the standard.</p>



<a name="153956941"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956941" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956941">(May 08 2018 at 14:15)</a>:</h4>
<p><span class="user-mention" data-user-id="193229">@Kevin Olbrich</span> -  I logged a ballot comment regarding that -- I don't know what value it is providing today. I haven't sat down and really put a ton of thought into what the intention behind that value was trying to serve and any threats it was trying to mitigate. I plan to do that this week/next :)</p>



<a name="153956943"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956943" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Olbrich <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956943">(May 08 2018 at 14:21)</a>:</h4>
<p>We're trying to figure out how to associate a particular cds-hooks invocation to an organization.  The 'sub' (client_id) field would be one way for us to be able to do that since some of our partners are multi-tenant, which prevents us from just using the 'iss'.</p>



<a name="153956944"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956944" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956944">(May 08 2018 at 14:24)</a>:</h4>
<p>Ah, the same old SMART on FHIR issue too :-)</p>
<p>The way in which the <code>sub</code> field is documented today wouldn't necessary do what you're wanting to do. Today, it is documented as "Client_id of the EHR." The intention from our security auditor was that this is the OAuth 2 client id of the EHR from the Authorization Server (AS). I don't think it is a safe assumption that EHRs will have a client id with the AS.</p>



<a name="153956945"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956945" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956945">(May 08 2018 at 14:26)</a>:</h4>
<p>And by SMART on FHIR issue, I'm referring to this issue here: <a href="https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/133" target="_blank" title="https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/133">https://github.com/smart-on-fhir/smart-on-fhir.github.io/issues/133</a></p>



<a name="153956947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Olbrich <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956947">(May 08 2018 at 14:29)</a>:</h4>
<p>Hmmm... looks like that didn't actually come to any sort of resolution.</p>



<a name="153956950"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956950" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Olbrich <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956950">(May 08 2018 at 14:31)</a>:</h4>
<p>maybe we could just add an optional 'org' attribute and populate it with a FHIR Organization ID that is known to the cds-service provider.</p>



<a name="153956952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956952">(May 08 2018 at 14:34)</a>:</h4>
<p>Yeah, we couldn't agree on the name or the semantics of the value. It is just a tough issue because each vendor/app/service has different expectations for what the value should be.</p>



<a name="153956956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956956">(May 08 2018 at 14:37)</a>:</h4>
<p>Tagging along to your thoughts, perhaps our best chance to standardize is simply come up with an optional attribute with a name we all agree upon whose value is &lt;list of all of the ways in which apps/services need this similar type of value&gt;.</p>
<p>So, the field name is consistent and the value relates to these different uses everyone has for it. Whether that is a billing code, a logical identifier for the separation of data, an org/facility identifier, etc.</p>



<a name="153956958"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956958" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Cain <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956958">(May 08 2018 at 14:39)</a>:</h4>
<p>Yes, perhaps specify it as an optional opaque value that has whatever semantics that are meaningful to the consuming system.</p>



<a name="153956960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956960">(May 08 2018 at 14:47)</a>:</h4>
<p>Yeah, I agree <span class="user-mention" data-user-id="193245">@Jim Cain</span></p>



<a name="153956962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Cain <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956962">(May 08 2018 at 14:50)</a>:</h4>
<p>But then that sounds a bit like the ability to include in the payload any claims that are meaningful to the consuming system, so does that really need to be part of the standard?</p>



<a name="153956964"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956964" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956964">(May 08 2018 at 14:51)</a>:</h4>
<p>Now you're asking the questions that caused us to ultimately stop trying to standardize this in the SMART space :-)</p>



<a name="153956965"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956965" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956965">(May 08 2018 at 14:53)</a>:</h4>
<p>I think there may be value in having a consistent field/means in which we all communicate this value. Additionally, this need comes up continually -- both in SMART and here in CDS Hooks. So, addressing it (even if it is just in the documentation rather than some field) would help others see our discussion/thoughts on this, how we're handling it (or not), etc.</p>



<a name="153956967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Cain <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956967">(May 08 2018 at 15:09)</a>:</h4>
<p>Back on the standards argument: It seems like you would want a standard way during discovery to describe the contents of that secondary identifier field, so that integration partners don't have to make any additional development effort to support your hooks.</p>



<a name="153956971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/153956971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Olbrich <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#153956971">(May 08 2018 at 15:41)</a>:</h4>
<p>We could probably work around this limitation if the sandbox gave us the ability to 1) see the contents of the JWT token, and 2) add arbitrary key-value pairs to the token on a per hook basis.  Then individual service providers can specify which keys they need in an implementation guide.</p>



<a name="244623363"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/244623363" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bala Sultanov <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#244623363">(Jul 01 2021 at 20:37)</a>:</h4>
<p><span class="user-mention" data-user-id="191614">@Kevin Olbrich</span> I am in a similar situation where we are trying to identify the specific tenant that's generating the CDS-hook call. Have you guys figured this out. I would appreciate any help.</p>



<a name="246784164"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/246784164" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Patterson <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#246784164">(Jul 21 2021 at 21:49)</a>:</h4>
<p><span class="user-mention" data-user-id="400655">@Bala Sultanov</span>  CDS Clients can send a tenant in the Authorization header JWT payload sent to a CDS Service.  <a href="https://cds-hooks.hl7.org/1.0/#trusting-cds-clients">https://cds-hooks.hl7.org/1.0/#trusting-cds-clients</a></p>



<a name="246784931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179159-cds%20hooks/topic/%27sub%27%20key%20in%20JWT%20token/near/246784931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bala Sultanov <a href="https://fhir.github.io/chat-archive/stream/179159-cds-hooks/topic/&#x27;sub&#x27;.20key.20in.20JWT.20token.html#246784931">(Jul 21 2021 at 21:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191358">Dennis Patterson</span> <a href="#narrow/stream/179159-cds-hooks/topic/'sub'.20key.20in.20JWT.20token/near/246784164">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="400655">Bala Sultanov</span>  CDS Clients can send a tenant in the Authorization header JWT payload sent to a CDS Service.  <a href="https://cds-hooks.hl7.org/1.0/#trusting-cds-clients">https://cds-hooks.hl7.org/1.0/#trusting-cds-clients</a></p>
</blockquote>
<p>Hi Dennis, thanks for your reply. Really appreciate it. Do you guys practice that at Cerner for multi-tenant hospitals? If a specific hospital triggers a cds-service call do you guys send a unique id for that tenant as part of JWT payload? It is not the case for Epic CDS-Service calls and we have been trying to figure out a workaround for that. Appreciate your time.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
