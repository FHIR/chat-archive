---
layout: page
title: "FHIR Chat  · Consumer scenario for connectathon · FHIR at Scale Taskforce (FAST): Security"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/index.html">FHIR at Scale Taskforce (FAST): Security</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html">Consumer scenario for connectathon</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="263495579"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263495579" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263495579">(Dec 02 2021 at 20:23)</a>:</h4>
<p>From track plans in Jan (<a href="https://confluence.hl7.org/pages/viewpage.action?pageId=130482809">https://confluence.hl7.org/pages/viewpage.action?pageId=130482809</a>):</p>
<blockquote>
<ol>
<li>Trusted Dynamic Registration &amp; JWT-Based Authentication (Consumer Facing)<br>
Precondition: Client has user-level credentials for FHIR server and client's UDAP certificate is trusted<br>
Success Criteria:  Client app successfully registers, authenticates, and obtains FHIR data leveraging a trusted certificate. Client should validate server metadata per UDAP Server Metadata profile.</li>
</ol>
</blockquote>
<p>I'm confused by the language. Does the precondition mean that the client is asking for the user's credentials, and not doing an OAuth cdoe flow the way <a href="http://build.fhir.org/ig/HL7/fhir-udap-security-ig/consumer.html">http://build.fhir.org/ig/HL7/fhir-udap-security-ig/consumer.html</a> documents? Or is this language just a bit confusing?</p>



<a name="263783030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263783030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263783030">(Dec 05 2021 at 18:52)</a>:</h4>
<p>Also for this track, when working with an endorsement: if the client doesn't participate in mutual TLS, how does the endorsement's <code>sub</code> get populated? <a href="https://www.udap.org/udap-certifications-and-endorsements.html">https://www.udap.org/udap-certifications-and-endorsements.html</a> doesn't list the <code>sub</code> as optional, but the following suggests it's not required:</p>
<blockquote>
<p>To facilitate key rollover, binding using the sub claim URI is preferable to binding to a specific key.</p>
</blockquote>
<p><span class="user-mention" data-user-id="195299">@Luis Maas</span></p>



<a name="263783062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263783062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263783062">(Dec 05 2021 at 18:53)</a>:</h4>
<p>And when presenting an endorsement at registration time, how is a client expected to demonstrate possession of one (or more) keys in the JWKS? The requirement is specified but I don't see any mechanism specified.</p>



<a name="263932365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263932365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263932365">(Dec 06 2021 at 22:13)</a>:</h4>
<p>Also <span class="user-mention" data-user-id="195299">@Luis Maas</span> I think I understand <a href="http://build.fhir.org/ig/HL7/fhir-udap-security-ig/registration.html#request-body">http://build.fhir.org/ig/HL7/fhir-udap-security-ig/registration.html#request-body</a> but I don't understand  what the sections above ("Client Credentials" and "Authorization Code") are about. Are they copy/paste mistakes, or can you help me understand what they mean?</p>



<a name="263935286"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263935286" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luis Maas <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263935286">(Dec 06 2021 at 22:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> mutual TLS is not required for certifications;  the client would use a URI from the subjectAltName extension of their signing cert to populate <code>sub</code>. The <code>sub</code> field is required. Binding to a specific key is done by including  the <code>jwks</code> claim in the certification; the comment re: rollover means that including the <code>jwks</code> is <em>not</em> preferred in certifications and endorsements; rather, binding of the client to the certification or endorsement JWT is done by confirming <code>sub</code> matches a URI entry in the subjectAltName extension of the client's certificate and that the certificate is from a trusted issuer.</p>



<a name="263935814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263935814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luis Maas <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263935814">(Dec 06 2021 at 22:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> yes, the three introductory paragraphs one the page you noted ("Client Credentials" and "Authorization Code") are slated to be moved out of this section. Just haven't made the change yet ;)</p>



<a name="263936766"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263936766" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luis Maas <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263936766">(Dec 06 2021 at 22:57)</a>:</h4>
<p>re: presenting the endorsement, the client still supplies a signed software_statement in the POST body to the registration endpoint; if the endorsement contains a <code>jwks</code> value, then the client must use one of the corresponding private key to sign the software_statement or the endorsement will not be accepted by the OAuth server processing the registration. Similarly, all JWTs used in subsequent token requests must also be signed using one of the corresponding private keys. Note that this is in addition to validating the endorsement <code>sub</code> matches one of the URIs in the client certificate's subjectAltName extension.</p>



<a name="263938147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263938147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luis Maas <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263938147">(Dec 06 2021 at 23:10)</a>:</h4>
<p>sorry for answering out of order...<br>
re:</p>
<blockquote>
<p>I'm confused by the language. Does the precondition mean that the client is asking for the user's credentials, and not doing an OAuth cdoe flow the way <a href="http://build.fhir.org/ig/HL7/fhir-udap-security-ig/consumer.html">http://build.fhir.org/ig/HL7/fhir-udap-security-ig/consumer.html</a> documents? Or is this language just a bit confusing?</p>
</blockquote>
<p>Yes the language is confusing: It should say "User has user-level credentials..."</p>



<a name="263943714"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/263943714" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#263943714">(Dec 07 2021 at 00:21)</a>:</h4>
<p>Thanks for the responses! In your view is there a role for self signed certs on a software statement? (Looking at per device registration scenarios which I know are listed as future scoped, but wanted to build some prototypes. My take is that per device keys would be strictly better than a public client registration, and could work with self signed software statements and a locked down endorsement JWT )</p>



<a name="264009384"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/264009384" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#264009384">(Dec 07 2021 at 14:33)</a>:</h4>
<blockquote>
<p>if the endorsement contains a <code>jwks</code> value, then the client must use one of the corresponding private key to sign the software_statement </p>
</blockquote>
<p>Ah, so "one of" is all that's intended. Ok, that's unclear.</p>



<a name="264914716"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/294749-FHIR%20at%20Scale%20Taskforce%20%28FAST%29%3A%20Security/topic/Consumer%20scenario%20for%20connectathon/near/264914716" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/294749-FHIR-at-Scale-Taskforce-(FAST):-Security/topic/Consumer.20scenario.20for.20connectathon.html#264914716">(Dec 14 2021 at 19:42)</a>:</h4>
<p>See <a href="#narrow/stream/179247-Security-and.20Privacy/topic/Trusted.20app.20instance.20registration.20and.20UDAP">https://chat.fhir.org/#narrow/stream/179247-Security-and.20Privacy/topic/Trusted.20app.20instance.20registration.20and.20UDAP</a> with notes on this topic, given our deep dive last week.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
