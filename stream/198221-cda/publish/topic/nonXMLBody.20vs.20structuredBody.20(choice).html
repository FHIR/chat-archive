---
layout: page
title: "FHIR Chat  · nonXMLBody vs structuredBody (choice) · cda/publish"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/index.html">cda/publish</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html">nonXMLBody vs structuredBody (choice)</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="176107854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176107854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176107854">(Sep 19 2019 at 14:59)</a>:</h4>
<p>How would you recommend constraining ClinicalDocument.componentOf.nonXMLBody and ClinicalDocument.componentOf.structuredBody so that only one of the two is allowed. nonXMLBody and structuredBody are a choice in XML Schema... but, that isn't currently represented/supported in the cda-core-2.0 spec. Right now, both are allowed and both are optional, when only one of the two should be allowed and should be required...<br>
I'm guessing maybe a &lt;constraint&gt; with xpath or FhirPath that asserts that the <em>other</em> element does not exist?<br>
Ex:</p>
<div class="codehilite"><pre><span></span>&lt;element&gt;
  &lt;path value=&quot;ClinicalDocument.component.nonXMLBody&quot; /&gt;
  ...
  &lt;constraint&gt;
    &lt;key value=&quot;?&quot; /&gt;
    &lt;severity value=&quot;error&quot; /&gt;
    &lt;human value=&quot;When nonXMLBody is present, structuredBody SHALL NOT be present.&quot; /&gt;
    &lt;xpath value=&quot;not(../cda:structuredBody)&quot; /&gt;
  &lt;/constraint&gt;
&lt;/element&gt;
</pre></div>



<a name="176107963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176107963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176107963">(Sep 19 2019 at 15:00)</a>:</h4>
<p>not sure that xpath would work, though... not sure how it would know the "cda:" namespace prefix.</p>



<a name="176108675"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176108675" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176108675">(Sep 19 2019 at 15:07)</a>:</h4>
<p>I would suggest using fhirpath: (nonXMLBody | structuredBody).count()=1</p>



<a name="176108719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176108719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176108719">(Sep 19 2019 at 15:08)</a>:</h4>
<p>and put that FHIRPath on both the structuredBody and nonXMLBody elements?</p>



<a name="176108761"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176108761" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176108761">(Sep 19 2019 at 15:08)</a>:</h4>
<p>(basically, repeat it?)</p>



<a name="176108828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176108828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176108828">(Sep 19 2019 at 15:08)</a>:</h4>
<div class="codehilite"><pre><span></span>     &lt;constraint&gt;
        &lt;key value=&quot;choice-1&quot;/&gt;
        &lt;severity value=&quot;error&quot;/&gt;
        &lt;human value=&quot;Choice of the contained elements&quot;/&gt;
        &lt;expression value=&quot;(nonXMLBody | structuredBody).count()&lt;=1 and (nonXMLBody | structuredBody).count()&gt;=1&quot;/&gt;
     &lt;/constraint&gt;
</pre></div>



<a name="176108873"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176108873" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176108873">(Sep 19 2019 at 15:09)</a>:</h4>
<p>sorry, no one up, on the component level:<br>
      &lt;element id="ClinicalDocument.component"&gt;<br>
         &lt;path value="ClinicalDocument.component"/&gt;<br>
         &lt;min value="1"/&gt;<br>
         &lt;max value="1"/&gt;<br>
         &lt;type&gt;<br>
            &lt;code value="http://fhir.ch/ig/cda-r2/StructureDefinition/Component"/&gt;<br>
            &lt;profile value="http://fhir.ch/ig/cda-r2/StructureDefinition/Component"/&gt;<br>
         &lt;/type&gt;<br>
         &lt;constraint&gt;<br>
            &lt;key value="choice-1"/&gt;<br>
            &lt;severity value="error"/&gt;<br>
            &lt;human value="Choice of the contained elements"/&gt;<br>
            &lt;expression value="(nonXMLBody | structuredBody).count()&lt;=1 and (nonXMLBody | structuredBody).count()&gt;=1"/&gt;<br>
         &lt;/constraint&gt;<br>
      &lt;/element&gt;</p>



<a name="176109048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109048">(Sep 19 2019 at 15:10)</a>:</h4>
<p>I see.</p>



<a name="176109217"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109217" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109217">(Sep 19 2019 at 15:12)</a>:</h4>
<p>I have them autogenerated from the model i can provide  you with the expressions if you want to.</p>



<a name="176109282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109282">(Sep 19 2019 at 15:13)</a>:</h4>
<p>I have to use this instead:<br>
<code>&lt;expression value="(nonXMLBody | structuredBody).count() &lt;= 1 and (nonXMLBody | structuredBody).count() &gt;= 1"/&gt;</code><br>
(escape the &lt; and &gt; )</p>



<a name="176109294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109294">(Sep 19 2019 at 15:13)</a>:</h4>
<p>ugh</p>



<a name="176109299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109299">(Sep 19 2019 at 15:13)</a>:</h4>
<p>zulip unescaped my escaping</p>



<a name="176109313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109313">(Sep 19 2019 at 15:13)</a>:</h4>
<p>&amp;lt;=</p>



<a name="176109317"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109317" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109317">(Sep 19 2019 at 15:13)</a>:</h4>
<p>and</p>



<a name="176109325"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109325" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109325">(Sep 19 2019 at 15:13)</a>:</h4>
<p>&amp;gt;=</p>



<a name="176109387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109387">(Sep 19 2019 at 15:14)</a>:</h4>
<p>yes sorry, zulip conversion, i have them also escaped in the strucuredefintions ..</p>



<a name="176109410"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109410" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109410">(Sep 19 2019 at 15:14)</a>:</h4>
<p>cool</p>



<a name="176109414"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109414" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109414">(Sep 19 2019 at 15:14)</a>:</h4>
<p>np</p>



<a name="176109431"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109431" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109431">(Sep 19 2019 at 15:14)</a>:</h4>
<div class="codehilite"><pre><span></span>    &lt;element id=&quot;ClinicalDocument.component&quot;&gt;
      &lt;path value=&quot;ClinicalDocument.component&quot;/&gt;
      &lt;min value=&quot;1&quot;/&gt;
      &lt;max value=&quot;1&quot;/&gt;
      &lt;type&gt;
        &lt;code value=&quot;http://hl7.org/fhir/cda/StructureDefinition/Component2&quot;/&gt;
      &lt;/type&gt;
      &lt;constraint&gt;
        &lt;key value=&quot;body-choice&quot;/&gt;
        &lt;severity value=&quot;error&quot;/&gt;
        &lt;human value=&quot;Choice of the body required.&quot;/&gt;
        &lt;expression value=&quot;(nonXMLBody | structuredBody).count() &amp;lt;= 1 and (nonXMLBody | structuredBody).count() &amp;gt;= 1&quot;/&gt;
      &lt;/constraint&gt;
    &lt;/element&gt;
</pre></div>



<a name="176109432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176109432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176109432">(Sep 19 2019 at 15:14)</a>:</h4>
<p>yes?</p>



<a name="176110514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176110514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176110514">(Sep 19 2019 at 15:25)</a>:</h4>
<p>are we sure that works since "nonXMLBody" and "structuredBody" are not part of ClinicalDocument, and are instead part of the contained profile <a href="http://hl7.org/fhir/cda/StructureDefinition/Component2" target="_blank" title="http://hl7.org/fhir/cda/StructureDefinition/Component2">http://hl7.org/fhir/cda/StructureDefinition/Component2</a>?</p>



<a name="176110558"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176110558" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176110558">(Sep 19 2019 at 15:25)</a>:</h4>
<p>Should this instead be a &lt;constraint&gt; at the root element of Component2?</p>



<a name="176110620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176110620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176110620">(Sep 19 2019 at 15:26)</a>:</h4>
<p>ex:</p>



<a name="176110625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176110625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176110625">(Sep 19 2019 at 15:26)</a>:</h4>
<div class="codehilite"><pre><span></span>    &lt;element id=&quot;Component2&quot;&gt;
      &lt;path value=&quot;Component2&quot;/&gt;
      &lt;min value=&quot;1&quot;/&gt;
      &lt;max value=&quot;1&quot;/&gt;
      &lt;constraint&gt;
        &lt;key value=&quot;body-choice&quot;/&gt;
        &lt;severity value=&quot;error&quot;/&gt;
        &lt;human value=&quot;Choice of the body required.&quot;/&gt;
        &lt;expression value=&quot;(nonXMLBody | structuredBody).count() &amp;lt;= 1 and (nonXMLBody | structuredBody).count() &amp;gt;= 1&quot;/&gt;
      &lt;/constraint&gt;
    &lt;/element&gt;
</pre></div>



<a name="176130445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/198221-cda/publish/topic/nonXMLBody%20vs%20structuredBody%20%28choice%29/near/176130445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/198221-cda/publish/topic/nonXMLBody.20vs.20structuredBody.20(choice).html#176130445">(Sep 19 2019 at 18:56)</a>:</h4>
<p>thats the better place</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
