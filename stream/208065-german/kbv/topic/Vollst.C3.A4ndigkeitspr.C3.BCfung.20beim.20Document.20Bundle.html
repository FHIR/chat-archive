---
layout: page
title: "FHIR Chat  · Vollständigkeitsprüfung beim Document Bundle · german/kbv"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/208065-german/kbv/index.html">german/kbv</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/208065-german/kbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle.html">Vollständigkeitsprüfung beim Document Bundle</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="191587103"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208065-german/kbv/topic/Vollst%C3%A4ndigkeitspr%C3%BCfung%20beim%20Document%20Bundle/near/191587103" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/208065-german/kbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle.html#191587103">(Mar 24 2020 at 09:58)</a>:</h4>
<p>Wir hatten ja beim letzten Interop-Forum die Frage diskutiert ob und wenn ja wie man prüfen sollte, ob wirklich alle Referenzen einer Composition in einem Bundle enthalten sind. (<span class="user-mention" data-user-id="196115">@Mareike Przysucha</span> <span class="user-mention" data-user-id="191436">@Stefan Lang</span> )</p>
<p>Ich habe dazu jetzt zwei Varianten von Invarianten ( <span aria-label="smirk" class="emoji emoji-1f60f" role="img" title="smirk">:smirk:</span> ) erstellt und getestet:</p>
<ol>
<li><code>Bundle.entry.descendants().reference.distinct().subsetOf(%resource.entry.fullUrl)</code></li>
<li><code>Bundle.entry.resource.descendants().reference.all($this in %resource.entry.fullUrl)</code></li>
</ol>
<p>Beide scheinen nach ersten Tests korrekt erkennen zu können, wenn eine Referenz nicht im Bundle enthalten ist. In beiden Fällen wäre es <em>kein</em> Fehler, wenn das Bundle zusätzliche Entries enthalten würde (z.B. ein OperationOutcome oder ein Binary mit Stypesheet o.ä.)....</p>
<p>Ich habe zum Testen übrigens das Impfpass Beispiel-Bundle genommen und dabei sind mit zwei Dinge aufgefallen:<br>
Zum einen sind die urls in reference nicht identisch mit jenen in fullUrl (in ersterem sind es UUIDs, in letzterem absolute URLs) Das Beispiel wäre also ohnehin nicht valide und sollte korrigiert werden. <br>
Weiterhin haben die Composition und die Immunization die selbe UUID!<br>
(<span class="user-mention" data-user-id="195854">@Maximilian Reith</span> )</p>
<p>Falls die Referenzen nicht rekursiv überprüft werden sollen, sondern nur unmittelbare Referenzen der Composition, könnte man das mit dem Zusatz <code>Bundle.entry.ofType(Composition).reference...</code> erwirken.</p>
<p>Also: wer's braucht, bediene sich....</p>



<a name="191587376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208065-german/kbv/topic/Vollst%C3%A4ndigkeitspr%C3%BCfung%20beim%20Document%20Bundle/near/191587376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/208065-german/kbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle.html#191587376">(Mar 24 2020 at 10:00)</a>:</h4>
<p>wurde das mit dem Java Validator validiert?</p>



<a name="191587473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208065-german/kbv/topic/Vollst%C3%A4ndigkeitspr%C3%BCfung%20beim%20Document%20Bundle/near/191587473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/208065-german/kbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle.html#191587473">(Mar 24 2020 at 10:01)</a>:</h4>
<p>bzw. sollte der Validator dies nicht von sich aus, auch ohne invariants, bemängeln?</p>



<a name="191587807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208065-german/kbv/topic/Vollst%C3%A4ndigkeitspr%C3%BCfung%20beim%20Document%20Bundle/near/191587807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mareike Przysucha <a href="https://fhir.github.io/chat-archive/stream/208065-german/kbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle.html#191587807">(Mar 24 2020 at 10:04)</a>:</h4>
<p>Liebe <span class="user-mention" data-user-id="191450">@Simone Heckmann</span> , vielen herzlichen Dank!</p>



<a name="191596146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/208065-german/kbv/topic/Vollst%C3%A4ndigkeitspr%C3%BCfung%20beim%20Document%20Bundle/near/191596146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Maximilian Reith <a href="https://fhir.github.io/chat-archive/stream/208065-german/kbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle.html#191596146">(Mar 24 2020 at 11:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191450">Simone Heckmann</span> <a href="#narrow/stream/208065-german.2Fkbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle/near/191587103" title="#narrow/stream/208065-german.2Fkbv/topic/Vollst.C3.A4ndigkeitspr.C3.BCfung.20beim.20Document.20Bundle/near/191587103">said</a>:</p>
<blockquote>
<p>Wir hatten ja beim letzten Interop-Forum die Frage diskutiert ob und wenn ja wie man prüfen sollte, ob wirklich alle Referenzen einer Composition in einem Bundle enthalten sind. (<span class="user-mention silent" data-user-id="196115">Mareike Przysucha</span> <span class="user-mention silent" data-user-id="191436">Stefan Lang</span> )</p>
<p>Ich habe dazu jetzt zwei Varianten von Invarianten ( <span aria-label="smirk" class="emoji emoji-1f60f" role="img" title="smirk">:smirk:</span> ) erstellt und getestet:</p>
<ol>
<li><code>Bundle.entry.descendants().reference.distinct().subsetOf(%resource.entry.fullUrl)</code></li>
<li><code>Bundle.entry.resource.descendants().reference.all($this in %resource.entry.fullUrl)</code></li>
</ol>
<p>Beide scheinen nach ersten Tests korrekt erkennen zu können, wenn eine Referenz nicht im Bundle enthalten ist. In beiden Fällen wäre es <em>kein</em> Fehler, wenn das Bundle zusätzliche Entries enthalten würde (z.B. ein OperationOutcome oder ein Binary mit Stypesheet o.ä.)....</p>
<p>Ich habe zum Testen übrigens das Impfpass Beispiel-Bundle genommen und dabei sind mit zwei Dinge aufgefallen:<br>
Zum einen sind die urls in reference nicht identisch mit jenen in fullUrl (in ersterem sind es UUIDs, in letzterem absolute URLs) Das Beispiel wäre also ohnehin nicht valide und sollte korrigiert werden. <br>
Weiterhin haben die Composition und die Immunization die selbe UUID!<br>
(<span class="user-mention silent" data-user-id="195854">Maximilian Reith</span> )</p>
<p>Falls die Referenzen nicht rekursiv überprüft werden sollen, sondern nur unmittelbare Referenzen der Composition, könnte man das mit dem Zusatz <code>Bundle.entry.ofType(Composition).reference...</code> erwirken.</p>
<p>Also: wer's braucht, bediene sich....</p>
</blockquote>
<p>Also erstmal vielen Dank für die Invarianten und fürs Finden des "Fehlers", denn Simplifier meldet nur, dass zwei Referencen in zwei Extensions nicht aufgelöst werden können.  Aber ich denke auch das das Fehler sein müssten. Schaue ich mir an...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
