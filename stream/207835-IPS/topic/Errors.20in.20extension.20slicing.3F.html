---
layout: page
title: "FHIR Chat  · Errors in extension slicing? · IPS"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/index.html">IPS</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F.html">Errors in extension slicing?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="261834822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/207835-IPS/topic/Errors%20in%20extension%20slicing%3F/near/261834822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F.html#261834822">(Nov 17 2021 at 19:25)</a>:</h4>
<p>Looking at some of the IPS profiles, I think many of the slicing on extensions is wrong. For example, in MedicationStatement:</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot; : &quot;MedicationStatement.effective[x]&quot;,
        &quot;path&quot; : &quot;MedicationStatement.effective[x]&quot;,
        &quot;min&quot; : 1,
        &quot;max&quot; : &quot;1&quot;,
        &quot;mustSupport&quot; : true
      },
      {
        &quot;id&quot; : &quot;MedicationStatement.effective[x].extension&quot;,
        &quot;path&quot; : &quot;MedicationStatement.effective[x].extension&quot;,
        &quot;short&quot; : &quot;effective[x] absence reason&quot;,
        &quot;definition&quot; : &quot;Provides a reason why the effectiveTime is missing.&quot;,
        &quot;max&quot; : &quot;1&quot;,
        &quot;type&quot; : [
          {
            &quot;code&quot; : &quot;Extension&quot;,
            &quot;profile&quot; : [
              &quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;
            ]
          }
        ],
        &quot;mustSupport&quot; : true
      },
</code></pre></div>
<p>To me, this says "the only permitted extension on effective[x] is DAR, and only one occurrence is permitted."</p>
<p>Compare this to AllergyIntolerance, which because of the slice, says  "there shall be at most one extension of type DAR":</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot; : &quot;AllergyIntolerance.extension:abatement-datetime&quot;,
        &quot;path&quot; : &quot;AllergyIntolerance.extension&quot;,
        &quot;sliceName&quot; : &quot;abatement-datetime&quot;,
        &quot;short&quot; : &quot;Abatement datetime&quot;,
        &quot;definition&quot; : &quot;The date or estimated date that the condition resolved or went into remission.&quot;,
        &quot;max&quot; : &quot;1&quot;,
        &quot;type&quot; : [
          {
            &quot;code&quot; : &quot;Extension&quot;,
            &quot;profile&quot; : [
              &quot;http://hl7.org/fhir/uv/ips/StructureDefinition/abatement-dateTime-uv-ips&quot;
            ]
          }
        ],
        &quot;mustSupport&quot; : true
      },
</code></pre></div>
<p>Am I misreading this?</p>



<a name="262020746"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/207835-IPS/topic/Errors%20in%20extension%20slicing%3F/near/262020746" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F.html#262020746">(Nov 19 2021 at 02:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span>  any thoughts?</p>



<a name="262085162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/207835-IPS/topic/Errors%20in%20extension%20slicing%3F/near/262085162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F.html#262085162">(Nov 19 2021 at 15:56)</a>:</h4>
<p>HI, <span class="user-mention" data-user-id="191380">@Elliot Silver</span>.  I've looked at this, and yes, I think your analysis is correct.  That's a great pickup - thanks!  I finally located the relevant documentation in <a href="http://hl7.org/fhir/profiling.html#using-extensions">5.1.0.15.1 Using Extensions in Profiles</a>: </p>
<blockquote>
<p>To prescribe the use of an extension in an instance, the extension list on the resource needs to be sliced.</p>
</blockquote>
<p>I will fix this instance, and will look for any others that may be like it.  If you or anyone else are already aware of other instances, let me know.</p>



<a name="262096737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/207835-IPS/topic/Errors%20in%20extension%20slicing%3F/near/262096737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F.html#262096737">(Nov 19 2021 at 17:10)</a>:</h4>
<p>In IPS master:</p>
<ul>
<li>MedicationRequest.dispenseRequest.validityPeriod.extension</li>
</ul>
<p>However, I'm not sure if we need to include the discriminator definition or if that is inherited. If we need it, then it is missing from:</p>
<ul>
<li>AllergyIntolerance.extension:abatement-datetime</li>
<li>DeviceUseStatement.timing[x]:data-absent-reason</li>
<li>DiagnosticReport.effective[x]:data-absent-reason</li>
<li>Immunization.occurrence[x]:data-absent-reason</li>
<li>MedicationRequest.dispenseRequest.validityPeriod.extension</li>
<li>MedicationStatement.effective[x]:data-absent-reason</li>
<li>Observation.effective[x]:data-absent-reason (all profiles)</li>
<li>Procedure.performed[x]:data-absent-reason</li>
</ul>
<p>(i.e., all extensions except Coding.display.extension)</p>



<a name="262112971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/207835-IPS/topic/Errors%20in%20extension%20slicing%3F/near/262112971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F.html#262112971">(Nov 19 2021 at 18:59)</a>:</h4>
<p>Thanks for that.  Yes.  I think the the discriminator is implicit as the url for slicing on 'extension'.  But I don't know if that it is documented (or for certain if it's actually true).</p>



<a name="262113891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/207835-IPS/topic/Errors%20in%20extension%20slicing%3F/near/262113891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F.html#262113891">(Nov 19 2021 at 19:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191405">Rob Hausam</span> <a href="#narrow/stream/207835-IPS/topic/Errors.20in.20extension.20slicing.3F/near/262112971">said</a>:</p>
<blockquote>
<p>But I don't know if that it is documented (or for certain if it's actually true).</p>
</blockquote>
<p>That was my question too.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
