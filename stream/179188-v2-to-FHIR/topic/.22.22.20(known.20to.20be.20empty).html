---
layout: page
title: "FHIR Chat  · &quot;&quot; (known to be empty) · v2 to FHIR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/index.html">v2 to FHIR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html">&quot;&quot; (known to be empty)</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="164715937"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164715937" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164715937">(May 02 2019 at 15:06)</a>:</h4>
<p>In a v2-to-FHIR translation scenario, if one wanted to preserve the difference between || (value unknown) and |""| (value known to be empty), it seems one would have to add an extension to an element, something like "knownToBeEmpty, valueBoolean". It's not a dataAbsentReason/NullFlavor, and I'm unable to find any other extension in Simplifier which seems to fit the bill. Any other ideas/suggestions as to how to support this?</p>



<a name="164716123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164716123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164716123">(May 02 2019 at 15:09)</a>:</h4>
<blockquote>
<p>In a v2-to-FHIR translation scenario, if one wanted to preserve the difference between || (value unknown) and |""| (value known to be empty), it seems one would have to add an extension to an element, something like "knownToBeEmpty, valueBoolean". It's not a dataAbsentReason/NullFlavor, and I'm unable to find any other extension in Simplifier which seems to fit the bill. Any other ideas/suggestions as to how to support this?</p>
</blockquote>
<p>I don't think you need to do an extension as this would map differently: || (value unknown) would mean that the data element would not be present in the XML/JSON while |""| means that the element would be present, eg. &lt;description&gt;&lt;/description&gt;</p>



<a name="164716217"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164716217" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164716217">(May 02 2019 at 15:10)</a>:</h4>
<p>the XML representation of v2 did this &lt;CE.1&gt;&lt;/CE.1&gt; was equivalent to |""| while no CE.1 tag meant unknown</p>



<a name="164716692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164716692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164716692">(May 02 2019 at 15:15)</a>:</h4>
<p>In FHIR, the expectation is that you are always sending everything.  If that's not an assumption you can make when converting from v2, then v2 updates will have to be handled as PATCH rather than PUT.</p>



<a name="164720155"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164720155" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164720155">(May 02 2019 at 15:57)</a>:</h4>
<p>What would be the equivalent of this in JSON?  (the "knownToBeEmpty")</p>



<a name="164720603"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164720603" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164720603">(May 02 2019 at 16:02)</a>:</h4>
<p>XML vs. JSON doesn't matter</p>



<a name="164720625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164720625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164720625">(May 02 2019 at 16:03)</a>:</h4>
<p>If it's empty in FHIR, you omit the element - a missing element is <em>always</em> interpreted as "this element has no data".</p>



<a name="164720954"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164720954" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164720954">(May 02 2019 at 16:07)</a>:</h4>
<blockquote>
<p>What would be the equivalent of this in JSON?  (the "knownToBeEmpty")</p>
</blockquote>
<p>"description": ""</p>



<a name="164721209"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164721209" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164721209">(May 02 2019 at 16:10)</a>:</h4>
<p>note: that would be telling someone "the description exists, but it is currently empty" as opposed to the "description" tag not being present which is "there is no description".  I'm not sure when you'd ever want to say that the description existed and was empty, but you can in XML and JSON.</p>



<a name="164724184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164724184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164724184">(May 02 2019 at 16:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  -- this is coming from an HL7 V2 message perspective where "" implies something (like DBnull vs empty string).   <span class="user-mention" data-user-id="192166">@Jean Duteau</span>  answer makes more sense from a V2 perspective.   If my FHIR server implementation was using a relational DB I would need to clear out (DBnull) the field in the DB vs putting an a zero-length string.    Also, even if it was a noSQL storage, if I have a client with a pub/sub request on changes to a specific field that went from something (empty string) to nothing (DBnull), I'd need to notify that client.    With the 'just don't send it approach' that wouldn't be as deterministic because from the V2 message perspective, an empty field doesn't imply that the property should be "DBnull'd" just that a particular sender didn't know the value (of that field).</p>



<a name="164725606"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164725606" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164725606">(May 02 2019 at 17:05)</a>:</h4>
<p>You can't have empty strings in FHIR - it's not allowed.  so "description":"" is not permitted.</p>



<a name="164725716"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164725716" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164725716">(May 02 2019 at 17:06)</a>:</h4>
<p>To clear out something in FHIR, you send a copy of the resource that excludes the element.  If you have a Patient and specify no addresses, that says "delete all addresses you have for the patient".  There is no way to send a Patient in FHIR and say "I'm not telling you anything about addresses, so keep what you have" except by using PATCH.</p>



<a name="164727612"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164727612" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164727612">(May 02 2019 at 17:31)</a>:</h4>
<p>ah, Lloyd is right.  Quoting from the spec:</p>
<blockquote>
<p>Objects are never empty. If an element is present in the resource, it SHALL have properties as defined for its type, or 1 or more extensions<br>
String property values can never be empty. Either the property is absent, or it is present with at least one character of content</p>
</blockquote>
<p>So extension it is.</p>



<a name="164728020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164728020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164728020">(May 02 2019 at 17:35)</a>:</h4>
<p>Extension isn't appropriate here.  To make something go away, you don't need "null" in the v2 sense, you just omit it.  <em>Everything</em> omitted goes away.  The tricky part with FHIR is how to <em>not</em> make something go away but still not send it.  In that case, you'd need either a modifier extension or you'd need to use PATCH.</p>



<a name="164728126"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164728126" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164728126">(May 02 2019 at 17:36)</a>:</h4>
<blockquote>
<p>The tricky part with FHIR is how to <em>not</em> make something go away but still not send it.  In that case, you'd need either a modifier extension or you'd need to use PATCH.</p>
</blockquote>
<p>That is what I was meaning - for that use case, you'd need an extension.</p>



<a name="164729284"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164729284" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164729284">(May 02 2019 at 17:50)</a>:</h4>
<p>modifierExtension.  If a regular extension were there, systems that didn't recognize it would still strip the data.</p>



<a name="164736104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164736104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164736104">(May 02 2019 at 19:08)</a>:</h4>
<p>OK, but if the V2 source feed comes from multiple sources, some of which know the data (e.g. patient's address) and others which don't this approach becomes problematic.</p>



<a name="164742021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164742021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Flessner <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164742021">(May 02 2019 at 20:20)</a>:</h4>
<p>If you're doing a RESTful create or update operation in FHIR, yes the resource has to be complete. But in talking about converting v2 to FHIR, we've often been discussing messaging bundles which are handled by a FHIR server's $process-message operation "according to the definition of the event in the message header." That's pretty open-ended.</p>
<p>At Redox, we process V2 messages as FHIR message bundles full of resources with temporary ids. As a FHIR server, we take each resource from the bundle and either create a new permanent resource, or merge the data into an existing resource (using something like identifier to match). We do have different rules based on the source event (which drives MessageHeader.event). For example - a bundle containing a patient with no address on an ADT feed would likely "clear out" an existing patient who previously had an address, but a bundle with a similar address-less patient coming from an ORU feed would <em>not</em> strip out the address because we expect the demographics to be richer from ADT feeds than from ORU feeds.</p>
<p>This would be a great topic to explore in more depth this weekend in the V2-to-FHIR track or in future calls.  Can we create a clear way to differentiate a missing resource field as due to explicitly known to be empty vs simply not present (i.e. leave any existing data alone) ?</p>



<a name="164772197"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164772197" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164772197">(May 03 2019 at 06:51)</a>:</h4>
<p>I'd say one would probably ignore the entire PID received in an ORU, unless the patient was entirely unknown. This also requires server-side logic to determine which sending system is considered to be a "more reliable" source for particular categories of data. Things like allergies could be in contained in lots of message types - whom do you consider to be authoritative source(s), and what systems are likely to just echo older versions of data which they in turn received from those authoritative sources? I don't see a use case for PATCH here, this is more an issue of whether one wishes to use one "snapshot" or another "snapshot", depending on the source of the data.</p>



<a name="164787084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164787084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164787084">(May 03 2019 at 11:43)</a>:</h4>
<p>v2 to FHIR has two possible modes of operation.  One is you're converting a v2 message into a FHIR message.  In that case, you can theoretically embed into the event code count some of the same 'magic' as is found in the v2 space - though that also means that any resources you receive are not "safe" to be automatically turned into REST resources or document resources.  (And I'd argue that for safety purposes, you really should set the Resource.implicitRules flag.)  The othe possibility is that you're trying to process the message against a FHIR RESTful server.  In that case, you're going to need to use PATCH or will need to query the resource before updating it in order not to lose data.</p>



<a name="164787152"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164787152" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164787152">(May 03 2019 at 11:44)</a>:</h4>
<p>Obviously the first approach is easier than the second, but the second is going to let you share the data with a lot more servers.</p>



<a name="164858831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164858831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164858831">(May 04 2019 at 09:24)</a>:</h4>
<p>|""| is proof that the HL7 message is a patch. There's a variety of ways to handle it. but what you have is fundamentally a patch not a snapshot.</p>



<a name="164858832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164858832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164858832">(May 04 2019 at 09:24)</a>:</h4>
<p>though it may prove that you can ignore it's patchiness. But as far as I can see, making an extension for this is completely missing the point</p>



<a name="164863123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/%22%22%20%28known%20to%20be%20empty%29/near/164863123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/.22.22.20(known.20to.20be.20empty).html#164863123">(May 04 2019 at 10:57)</a>:</h4>
<p>Making an extension is reasonable, but only if you're shifting from processing in a traditional RESTful mode.   And I think even if you're using FHIR messaging, the presumption is that resources are "complete", which is why I lean to making people use Resource.implicitRules if they want to make FHIR behave like v2.  (And if you do that, then an extension to mark nulls is reasonable.)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
