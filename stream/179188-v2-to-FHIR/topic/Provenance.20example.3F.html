---
layout: page
title: "FHIR Chat  · Provenance example? · v2 to FHIR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/index.html">v2 to FHIR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html">Provenance example?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="198838323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/198838323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#198838323">(May 27 2020 at 00:27)</a>:</h4>
<p>I am looking for v2 to FHIR Provenance example instance for the transform.  I fashioned one  see below ... after the description in the FHIR spec, but I'd like to see what one from this project looks like....</p>



<a name="198838330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/198838330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#198838330">(May 27 2020 at 00:27)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># General Provenance resource relating to the transformation process:</span>
<span class="nt">resourceType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Provenance</span>
<span class="c1"># activity is a omh to FHIR transform there is no transform activity in the code system!</span>
<span class="nt">activity</span><span class="p">:</span>
  <span class="nt">coding</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">system</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://example.org/omh-to-fhir</span>
      <span class="nt">code</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">transform</span>
      <span class="nt">display</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Transform</span>
<span class="c1"># Provenance.target points to all transformed resources since this is contained</span>
<span class="c1"># in the target resource it will be &quot;#&quot;</span>
<span class="nt">target</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">reference</span><span class="p">:</span> <span class="s">&#39;#&#39;</span> <span class="c1">#Observation/omh-fhir-example</span>
<span class="c1"># Provenance.recorded indicates the instant the v2 message was transformed to FHIR resources</span>
<span class="nt">recorded</span><span class="p">:</span> <span class="s">&#39;2020-05-26T11:09:09-07:00&#39;</span>
<span class="c1"># Provenance.policy can optionally point to the rules used for the transformation such as the omh-fhir ig</span>
<span class="nt">policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://www.fhir.org/guides/mfhir/ImplementationGuide/openmhealth.mfhir-0.0.0</span>
<span class="nt">agent</span><span class="p">:</span>
  <span class="c1"># Provenance.agent.type = &quot;assembler&quot;</span>
  <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">coding</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">system</span><span class="p">:</span> <span class="s">&#39;http://terminology.hl7.org/CodeSystem/provenance-participant-type&#39;</span>
            <span class="nt">code</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">assembler</span>
            <span class="nt">display</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Assembler</span>
    <span class="c1"># Provenance.agent.who references the Organization or Device performing the transformation</span>
    <span class="nt">who</span><span class="p">:</span>
      <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Device/example-r24-server</span>
  <span class="c1"># source schema Provenance.agent.type = &quot;source&quot; see the entity for the actual schema instance</span>
  <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span>
      <span class="nt">text</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">omh-schema</span>
    <span class="c1"># Provenance.agent.who referencin the OMH schema</span>
    <span class="nt">who</span><span class="p">:</span>
        <span class="nt">identifier</span><span class="p">:</span>
          <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blood-glucose-2.0</span>
<span class="c1"># Provenance.entity can optionally contain the whole omh schema instance as a</span>
<span class="c1"># DocumentReference in .what and a .role of &quot;derivation&quot;</span>
<span class="nt">entity</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">role</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">derivation</span>
    <span class="nt">what</span><span class="p">:</span>
      <span class="nt">identifier</span><span class="p">:</span>
        <span class="nt">system</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">urn:ietf:rfc:3986</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">243c773b-8936-407e-9c23-270d0ea49cc4</span>
    <span class="nt">agent</span><span class="p">:</span>
      <span class="c1"># Provenance.agent.type = &quot;Author&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">coding</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="nt">system</span><span class="p">:</span> <span class="s">&#39;http://terminology.hl7.org/CodeSystem/provenance-participant-type&#39;</span>
                <span class="nt">code</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AUT</span>
                <span class="nt">display</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Author</span>
        <span class="c1"># Provenance.agent.who references the originating Device from</span>
        <span class="c1"># header.acquisition_provenance.source_name and</span>
        <span class="c1"># header.acquisition_provenance.source_data_point_id</span>
        <span class="c1"># this is the same as in Observation.Device and Observation.identifier</span>
        <span class="nt">who</span><span class="p">:</span>
          <span class="c1"># reference: Device/acme-patient-device</span>
          <span class="nt">display</span><span class="p">:</span> <span class="s">&quot;Acme</span><span class="nv"> </span><span class="s">BG</span><span class="nv"> </span><span class="s">API&quot;</span>
</code></pre></div>



<a name="198920539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/198920539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#198920539">(May 27 2020 at 16:56)</a>:</h4>
<p>You hare using an example codesystem for the .activity, why not use lifecycle 'transform' activity? This seems the activity you are doing. right?</p>
<blockquote>
<p><a href="http://terminology.hl7.org/CodeSystem/iso-21089-lifecycle#transform">http://terminology.hl7.org/CodeSystem/iso-21089-lifecycle#transform</a></p>
</blockquote>



<a name="198920697"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/198920697" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#198920697">(May 27 2020 at 16:57)</a>:</h4>
<p>Not clear why you want to use .entity.agent.... and I think you need to refer to one of your .agent entries. not inline an agent. (I have never understood this part)  -- <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ?</p>



<a name="198920869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/198920869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#198920869">(May 27 2020 at 16:59)</a>:</h4>
<p>if you want to say that the v2 message was authored by  a given agent, then you indicate that .agent details as .agent.type=SORUCE</p>



<a name="198920951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/198920951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#198920951">(May 27 2020 at 16:59)</a>:</h4>
<p>see <a href="http://build.fhir.org/provenance.html#import">http://build.fhir.org/provenance.html#import</a></p>



<a name="198921164"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/198921164" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#198921164">(May 27 2020 at 17:01)</a>:</h4>
<p>clearly some improvement opportunities for the text found in the Provenance page... lets work on that.</p>



<a name="199335398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/199335398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#199335398">(Jun 01 2020 at 04:13)</a>:</h4>
<blockquote>
<p>You hare using an example codesystem for the .activity, why not use lifecycle 'transform' activity? This seems the activity you are doing. right?</p>
</blockquote>
<p>this was not  in FHIR R4</p>



<a name="199336231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/199336231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#199336231">(Jun 01 2020 at 04:34)</a>:</h4>
<p>updated based on John's input:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># General Provenance resource relating to the transformation process:</span>
<span class="nt">resourceType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Provenance</span>
<span class="c1"># activity is a omh to FHIR transform there is no transform activity in the code system!</span>
<span class="nt">activity</span><span class="p">:</span>
  <span class="nt">coding</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">system</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://terminology.hl7.org/CodeSystem/iso-21089-lifecycle</span>
      <span class="nt">code</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">transform</span>
      <span class="nt">display</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Transform</span>
<span class="c1"># Provenance.target points to all transformed resources since this is contained</span>
<span class="c1"># in the target resource it will be &quot;#&quot;</span>
<span class="nt">target</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">reference</span><span class="p">:</span> <span class="s">&#39;#&#39;</span> <span class="c1">#Observation/omh-fhir-example</span>
<span class="c1"># Provenance.recorded indicates the instant the v2 message was transformed to FHIR resources</span>
<span class="nt">recorded</span><span class="p">:</span> <span class="s">&#39;2020-05-26T11:09:09-07:00&#39;</span>
<span class="c1"># Provenance.policy can optionally point to the rules used for the transformation such as the omh-fhir ig</span>
<span class="nt">policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://www.fhir.org/guides/mfhir/ImplementationGuide/openmhealth.mfhir-0.0.0</span>
<span class="nt">agent</span><span class="p">:</span>
  <span class="c1"># Provenance.agent.type = &quot;assembler&quot;</span>
  <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">coding</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">system</span><span class="p">:</span> <span class="s">&#39;http://terminology.hl7.org/CodeSystem/provenance-participant-type&#39;</span>
            <span class="nt">code</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">assembler</span>
            <span class="nt">display</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Assembler</span>
    <span class="c1"># Provenance.agent.who references the Organization or Device performing the transformation</span>
    <span class="nt">who</span><span class="p">:</span>
      <span class="nt">reference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Device/example-r24-server</span>
  <span class="c1"># source schema Provenance.agent.type = &quot;source&quot; see the entity for the actual schema instance</span>
  <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span>
      <span class="nt">text</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">omh-schema</span>
    <span class="c1"># Provenance.agent.who referencin the OMH schema</span>
    <span class="nt">who</span><span class="p">:</span>
        <span class="nt">identifier</span><span class="p">:</span>
          <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blood-glucose-2.0</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">coding</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">system</span><span class="p">:</span> <span class="s">&#39;http://terminology.hl7.org/CodeSystem/provenance-participant-type&#39;</span>
              <span class="nt">code</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AUT</span>
              <span class="nt">display</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Author</span>
      <span class="c1"># Provenance.agent.who references the originating Device from</span>
      <span class="c1"># header.acquisition_provenance.source_name and</span>
      <span class="c1"># header.acquisition_provenance.source_data_point_id</span>
      <span class="c1"># this is the same as in Observation.Device and Observation.identifier</span>
      <span class="nt">who</span><span class="p">:</span>
        <span class="c1"># reference: Device/acme-patient-device</span>
        <span class="nt">display</span><span class="p">:</span> <span class="s">&quot;Acme</span><span class="nv"> </span><span class="s">BG</span><span class="nv"> </span><span class="s">API&quot;</span>
<span class="c1"># Provenance.entity can optionally contain the whole omh schema instance as a</span>
<span class="c1"># DocumentReference in .what and a .role of &quot;derivation&quot;</span>
<span class="nt">entity</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">role</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">derivation</span>
    <span class="nt">what</span><span class="p">:</span>
      <span class="nt">identifier</span><span class="p">:</span>
        <span class="nt">system</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">urn:ietf:rfc:3986</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">243c773b-8936-407e-9c23-270d0ea49cc4</span>
</code></pre></div>



<a name="199366448"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/199366448" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Buitendijk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#199366448">(Jun 01 2020 at 13:11)</a>:</h4>
<p>Have you looked at the v2-to-FHIR mapping spreadsheets that map to Provenance?  <a href="https://docs.google.com/spreadsheets/d/1PaFYPSSq4oplTvw_4OgOn6h2Bs_CMvCAU9CqC4tPBgk/edit#gid=484860251">https://docs.google.com/spreadsheets/d/1PaFYPSSq4oplTvw_4OgOn6h2Bs_CMvCAU9CqC4tPBgk/edit#gid=484860251</a>.  Look for anything that has Provenance in the name.</p>



<a name="199828875"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Provenance%20example%3F/near/199828875" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Provenance.20example.3F.html#199828875">(Jun 05 2020 at 01:44)</a>:</h4>
<blockquote>
<p>I think you need to refer to one of your .agent entries. not inline an agent. (I have never understood this part)</p>
</blockquote>
<p>It's easier if you don't refer to it, until the same agent appears more than once. I don't recall the trade-offs ever being explicit discussed. I copied the W3C prov to get the initial design</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
