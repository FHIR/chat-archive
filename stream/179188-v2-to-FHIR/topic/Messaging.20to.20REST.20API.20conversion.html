---
layout: page
title: "FHIR Chat  · Messaging to REST API conversion · v2 to FHIR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/index.html">v2 to FHIR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html">Messaging to REST API conversion</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="260140054"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/260140054" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#260140054">(Nov 03 2021 at 14:18)</a>:</h4>
<p>Is the v2 to FHIR group only focused on mapping the v2  data models to FHIR?  Or is there also work to map the messaging exchange model to a REST API model?   It seems like data model conversion is the easy part.  We've seen folks work on "v2 to FHIR" thinking that they just need to map data, but the sticking point is that the intermediary always has to do the query/match/create/update/delete process to convert from snapshot content in a message to a set of interactions on the REST API.  </p>
<p>For example, in order to convert GT1 from a message to Account in the REST API, you need to:</p>
<ol>
<li>Gather the list of GT1s from the message.</li>
<li>Gather the list of Accounts from the REST API server.</li>
<li>Match the GT1 records to Account records.</li>
<li>Delete any Accounts on the FHIR server that are not in the GT1 list.</li>
<li>Update any Accounts on the FHIR server that are in the GT1 list.</li>
<li>Create any Accounts that are in the  GT1 list but not on the FHIR server.</li>
<li>Roll back if anything in this whole process failed.</li>
</ol>
<p>Since you need to do this same thing for basically every set of segments (or at least snapshot-mode style segment), this gets <em>really</em> chatty on the wire.</p>
<p>Or were we hoping that v2 to FHIR would be using FHIR messaging?</p>



<a name="260147595"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/260147595" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#260147595">(Nov 03 2021 at 15:08)</a>:</h4>
<p>Even if we were to use FHIR messaging, the receiving FHIR server (one that supports FHIR messaging) would still have to do all of the above. This is highly contextual business layer stuff, so other than best practices it's unlikely that HL7 will ever provide detailed guidance in this area.</p>



<a name="260165305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/260165305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#260165305">(Nov 03 2021 at 17:04)</a>:</h4>
<p>Yeah - that makes sense to me too.  I just think folks (or at least some) have a perception that "v2 to FHIR" is something that will make it relatively straightforward to do a "v2 message" to "FHIR API" conversion.</p>



<a name="260237080"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/260237080" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#260237080">(Nov 04 2021 at 07:37)</a>:</h4>
<p>The work by HL7 to create a segment-to-resource mapping is tremendously helpful, but even there one will need tweaks because of variability in usage of v2. But the hard parts lie elsewhere. </p>
<p>FHIR to v2 has an entirely different set of challenges assiciated with it, but IMHO in general that'll probably be easier to implement than v2 to FHIR.</p>



<a name="260277544"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/260277544" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Buitendijk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#260277544">(Nov 04 2021 at 14:33)</a>:</h4>
<p>The purpose of the project is to focus on the data mapping using a FHIR message as the target to ensure all data is considered. Then it is up to the mapper/receiver to determine whether to actually just use to to persist the FHIR resources, continue as a FHIR Message, switch into a chatty RESTFul API mode, or whatever.  The project team is not providing any guidance for each of those more specifically.  It is also not setting an expectation that it is relatively easy to go to FHIR APIs, assuming you mean with that "individual resource level API granularity" rather than "message level API coarseness" which are both FHIR APIs.  That term is assumed to be fairly limited in scope by most.</p>
<p>Agreed that attempting to switch from a v2 message paradigm into a chatty, resource at a time API approach (RESTful or otherwise) is a bit strange. The intent of a message to begin with is to get all the relevant data across in one go.  Clearly you can still use RESTful APIs for that (i.e., a RESTFul API need not be at the granular resource level, although that is what most seem to assume.  Writing a Bundle of type message to an API still could use a RESTFul API I guess), but the more fundamental question would be how to have different interactions using non-messaging to enable a full workflow that otherwise would be done using HL7 v2 messaging.  That is not part of the v2-FHIR project.  Just strictly ensuring that those interested to tap into existing HL7 v2 streams to understand how to map out of that, and in the future how to map into that using existing v2 and FHIR terminology.  That could then also be used to help understand implementers figure out how their internal structures now map to FHIR where they are already familiar with v2.</p>



<a name="274163547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274163547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig McClendon <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274163547">(Mar 04 2022 at 17:42)</a>:</h4>
<p>To add to <span class="user-mention" data-user-id="191764">@Cooper Thompson</span> 's comments, repeating segments aren't the only difficult challenge. Handling of not-populated elements, explicit nulls, and repeating segment groups are also challenging. </p>
<p>From the v2 spec:</p>
<div class="codehilite"><pre><span></span><code>A field may exist in one of three population states in an HL7 message:
Populated. (Synonyms: valued, non-blank, not blank, not empty.) The sending system sends a value in the field. For example, if a sending system includes medical record number, that would be communicated as |1234567^^^MR^KP-CA|. Note that the field might be populated with a code that means &quot;no information&quot; or &quot;unknown&quot;.

Not populated. (Synonyms: unpopulated, not valued, unvalued, blank, empty, not present, missing.) The sending system does not supply a value for the field. The Sender might or might not have a value for the field. The receiving system can make no inference regarding the absence of an element value if there is not a conformance profile governing the implementation. However, if there is a Conformance Message Profile in effect, then special rules apply; see section 2.B, &quot;Conformance Using Message Profiles&quot;.

Null. Any existing value for the corresponding data base element in the receiving application should be deleted. This is symbolically communicated as two double-quotes between the delimiters (i.e., |&quot;&quot;|).Employing consecutive double quote characters as the only content of a field for other purposes is prohibited.
</code></pre></div>
<p>You essentially need merge logic to update existing resources in place to handle these things. For the case of explicit NULL values, you can't carry that into a blindly transformed FHIR resource - i.e. can't put "" into a dateTime attribute. I suppose you could come up with extensions that carry some of the v2 semantics and tooling that knows how to interpret and merge an intermediary v2-transformed resource into an existing resource on a FHIR server, or perhaps using FHIR patch.</p>



<a name="274171754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274171754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274171754">(Mar 04 2022 at 18:42)</a>:</h4>
<p>However, the use of "" in v2 is exceedingly rare, and quite often the fields/components that are populated with ""(in a given context) are relatively well known.</p>



<a name="274176481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274176481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig McClendon <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274176481">(Mar 04 2022 at 19:20)</a>:</h4>
<p>Thanks for the context <span class="user-mention" data-user-id="191372">@René Spronk</span>  - it's something I've wondered about as far as how common that may be in the wild. Does that imply that not populating previously sent elements is also rare?  For instance sending patient IDs but not full demographics in some messages? Or is that something that would be more dictated by the trigger event?</p>



<a name="274190118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274190118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274190118">(Mar 04 2022 at 21:23)</a>:</h4>
<p>We (Epic) do use "" as a deletion indicator in several of our v2 interfaces.  I'll admit it isn't universally implemented across all our fields on all message types, but several fields do use it.  And since those interfaces are fairly commonly used by many healthcare systems, I think "irregularly used" might be a better description than "exceedingly rare".</p>



<a name="274231563"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274231563" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274231563">(Mar 05 2022 at 09:10)</a>:</h4>
<p>Messaging is 'snapshot' in nature, so a sender sends everything they have/know, time and time and time again. Messaging is also making works case assumptions: the receiver may never have heard from this sender before, nor anything about this patient. The use of "" kind of assumes the receiver already has some data which we want to explicitly delete. So "" is a bit of a strange beast in v2, and is "irregularly used". If I were to create a v2-FHIR transformation I'd be working on the assumption that the use of "" is very low, so PATCH would not be the default way of handling v2-FHIR mappings.</p>



<a name="274233489"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274233489" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Oemig <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274233489">(Mar 05 2022 at 09:57)</a>:</h4>
<p>The two double quotes are NOT equal to null. That are two distinct concepts. We are fighting for years to clarify that. Some tables, which are also weird, have values equal to null, or at least similar, like UNK.<br>
The "" are 'delete indicators': the recipient must delete the information he has. <br>
With null values the recipient can keep them. <br>
A null value on V2 is an empty field/component.<br>
The "" are used erroneously when fields are marked as R, and/but no information is available.<br>
That in return indicates, that v2x combines a core framework with aka basic profiles. For V2+ I have tried to separate that, allowing for cleaner specs.<br>
My question here: would that be appreciated or endorsed?</p>



<a name="274240445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274240445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274240445">(Mar 05 2022 at 12:22)</a>:</h4>
<p>Sure - in training courses we state that "" means "known to be empty", as in the example: this patient is known not to have any academic titles (thus using "" in the academic title component of a patient name). </p>
<p>|| and ^^ are null flavours (for some reason a normal value [which includes ""] isn't known nor available when sending a message). Other than educating the HL7v2 community I don't see how we could improve the understanding of these two different concepts. Profiling would allow one to state whether null flavours are allowed or not, off the top of my head I don't really see a use case for it in the v2 space however. R means: no null flavours, there has to be a normal value (which could be "" if the value is known to be empty).</p>



<a name="274260241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274260241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Oemig <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274260241">(Mar 05 2022 at 19:18)</a>:</h4>
<p>R means to get a value which "" is not. If you extend your notion to the maximum that would mean to send only "" which seems weird.<br>
Again, null flavors and delete something are not the same concepts. With "" the recipient has to delete what he has, with a null flavor he can keep it.</p>



<a name="274295163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274295163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274295163">(Mar 06 2022 at 09:14)</a>:</h4>
<p>To qoute v2 (which does indeed indicate my wording to be erroneous, 2.7 ch. 2.5.3.0):</p>
<p>A field may exist in one of three population states in an HL7 message:</p>
<ol>
<li>
<p>Populated. (Synonyms: valued, non-blank, not blank, not empty.)  The sending system sends a value in the field.  For example, if a sending system includes medical record number, that would be communicated as |1234567^^^MR^KP-CA|. Note that the field might be populated with a code that means "no information" or "unknown".</p>
</li>
<li>
<p>Not populated.  (Synonyms:  unpopulated, not valued, unvalued, blank, empty, not present, missing.)  The sending system does not supply a value for the field. The Sender might or might not have a value for the field. The receiving system can make no inference regarding the absence of an element value if there is not a conformance profile governing the implementation. However, if there is a Conformance Message Profile in effect, then special rules apply; see section 2.B, "Conformance Using Message Profiles".</p>
</li>
<li>
<p>Null. Any existing value for the corresponding data base element in the receiving application should be deleted. This is symbolically communicated as two double-quotes between the delimiters (i.e., |""|).Employing consecutive double quote characters as the only content of a field for other purposes is prohibited.</p>
</li>
</ol>



<a name="274295789"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274295789" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274295789">(Mar 06 2022 at 09:30)</a>:</h4>
<p>In my example of a persons academic titles: sending ^^ would indicate not knowing if a person has academic titles. "" indicates (as a creator of a message) that I'm aware the person has no academic titles (and if you as the receiver have academic titles in your database, you'd better delete them). That use is somewhat wider than the more limited definition:</p>
<p>Given the definition of "" one could state that "" shall only be used by a sender if they know they've sent erroneous information in the past which they want to explicitly delete. That's a fairly narrow use case, which calls for a lot of complexity on the sender's side. 'To null' in the sense of 'canceling out' some earlier value. </p>
<p>Going back to the formal definition: Populated includes the notion of what in v3 we'd call nullFlavours.  The Not Populated option would also be nullFlavours. The only option that doesn't allow nullFlavours is .. Null. </p>
<p>Some updating of the wording may be in order, nit to redefine the meaning, but to align it more with terminology used in subsequent HL7 standards.</p>



<a name="274406677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274406677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274406677">(Mar 07 2022 at 15:23)</a>:</h4>
<p>We can continue down the rabbit hole of deletion indicators and null flavors, but what I'm really interested in is whether anyone (implementer) is planning to handle this in a v2 to FHIR product.  I'm still really curious what happens when we get the v2 field to FHIR property mapping done.  Will that actually be usable?  Only usable when doing v2 message -&gt; FHIR messages?  Or is anyone realistically thinking they'll be doing v2 messages to REST API?</p>



<a name="274420036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274420036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274420036">(Mar 07 2022 at 16:48)</a>:</h4>
<p>It will be usable as a reference mapping, a starting point for defining ones own contextual mapping. It doesn't help when it comes to all sorts of issues one will have to deal with when going from messaging to REST ("" just being a very tiny example of this). Which people are already doing, given the plethora of v2 stuff out there this is probably a must for any large scale project.</p>



<a name="274439859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274439859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274439859">(Mar 07 2022 at 18:52)</a>:</h4>
<p>I am really interested in knowing what people are actually doing this.  I've heard of folks <em>trying</em> to do this for the various cloud data warehouse imports, but I haven't heard of those projects going well.</p>



<a name="274650501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274650501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Oemig <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274650501">(Mar 09 2022 at 07:11)</a>:</h4>
<p>We have to think about the mechanics, how it should be, and not what people have done to solve an issue. There are a lot of quick fixes - for good reasons, but those are not helpful in the end.<br>
And one problem are the statements if early days that use improper technical terminology. <br>
V2 has no notion of null flavors. We have some code in tables for that purpose. I know the sentences in the standard, they are misleading. And trying to fix that failed for years...</p>



<a name="274651802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/274651802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#274651802">(Mar 09 2022 at 07:33)</a>:</h4>
<p>Luckily at least FHIR uses 'dataAbsentReason' instead of nullFlavour, this helps to some degree to avoid the confusion. Doesn't help in the case of v2, though. But we can't retrofit a legacy standard..</p>



<a name="276347400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179188-v2%20to%20FHIR/topic/Messaging%20to%20REST%20API%20conversion/near/276347400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea Pitkus, PhD, MLS(ASCP)CM, CSM <a href="https://fhir.github.io/chat-archive/stream/179188-v2-to-FHIR/topic/Messaging.20to.20REST.20API.20conversion.html#276347400">(Mar 23 2022 at 15:08)</a>:</h4>
<p>From a content perspective, I can see this being a bit issue in cancer and pathology reporting as there are many "flavors of null" in the CAP electronic Cancer Checklists (CAP eCC) content.  For example if a field is blank, does it mean it doesn't apply, wasn't seen in the specimen,  or did the pathologist skip the question/miss answering, etc.?   This assumes the data are messaged discretely.  Some may be captured discretely in synoptic reports, but it may not be sent discretely and isn't encoded in a number of cases (although some fields are).  Work is occurring in this area....</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
