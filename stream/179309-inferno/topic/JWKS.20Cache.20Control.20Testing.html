---
layout: page
title: "FHIR Chat  · JWKS Cache Control Testing · inferno"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/index.html">inferno</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html">JWKS Cache Control Testing</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="234891366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/234891366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#234891366">(Apr 16 2021 at 17:23)</a>:</h4>
<p>There is a g10 test script entry for validating that the JWKS URL is not cached for longer than the provided Cache-Control header. Does Inferno have either a config option that defines what Cache-Control it uses on the jkws.json hosted by Inferno? Does that get rotated at all? Is there an easy way to monitor when the system under test hits that jkws.json URL (which would indicate a cache miss/expiration?</p>



<a name="234899434"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/234899434" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#234899434">(Apr 16 2021 at 18:20)</a>:</h4>
<p>Inferno's g10 tests do not have the capability of testing that right now in an automated way. It added enough complexity that we decided to push that off into the 'Other &gt; Visual Inspection and Attestation' section, and have this text box in there: <a href="/user_uploads/10155/pYx6LE7tAUEKHzq3rPVJdsUB/Screen-Shot-2021-04-16-at-2.07.52-PM.png">Screen-Shot-2021-04-16-at-2.07.52-PM.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/pYx6LE7tAUEKHzq3rPVJdsUB/Screen-Shot-2021-04-16-at-2.07.52-PM.png" title="Screen-Shot-2021-04-16-at-2.07.52-PM.png"><img src="/user_uploads/10155/pYx6LE7tAUEKHzq3rPVJdsUB/Screen-Shot-2021-04-16-at-2.07.52-PM.png"></a></div><p>There are probably clever ways that we could test this automatically, and if there is concern that implementers will ignore the requirement or get it wrong without an Inferno test, then we could revisit this.</p>



<a name="234900296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/234900296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#234900296">(Apr 16 2021 at 18:26)</a>:</h4>
<p>We aim to have complete coverage of the test procedure though, and made sure that anything that wasn't automated is represented in the 'Visual Inspection and Attestation' step at the very end.  You can see how our tests mapped to the TP in the matrix we provide in every release (e.g. <a href="https://github.com/onc-healthit/inferno-program/releases/download/v1.5.0P/onc_program_matrix_1_5_0.xlsx">https://github.com/onc-healthit/inferno-program/releases/download/v1.5.0P/onc_program_matrix_1_5_0.xlsx</a> )</p>



<a name="234900605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/234900605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#234900605">(Apr 16 2021 at 18:28)</a>:</h4>
<p>That excel document also pulls out metadata from every test, and the text content of every test procedure step, which you may find helpful as you do your own reviews.  See tabs 2 and 3.  I'd love feedback on that file, too (useful, not useful, errors, etc).</p>



<a name="234923914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/234923914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#234923914">(Apr 16 2021 at 21:23)</a>:</h4>
<p>Yeah - we saw the visual inspection, I was just thinking that would involve visual inspection of the Inferno JWU.  Though now that I look, you aren't actually returning a Cache-Control header, so I expect that means that we'll need to spin up our own JKU endpoint, specify Cache-Control, and demonstrate using that.</p>



<a name="234924066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/234924066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#234924066">(Apr 16 2021 at 21:24)</a>:</h4>
<p>Inferno is great because it does just about all the certification work for us.  I won't complain if we have to do a <em>little</em> work ourselves to get certified  <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span> .</p>



<a name="234927583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/234927583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#234927583">(Apr 16 2021 at 21:59)</a>:</h4>
<p>Hmm... related question, though maybe more for ONC than Inferno, but the <a href="https://www.healthit.gov/test-method/standardized-api-patient-and-population-services">test procedure</a> says this:<br>
<code>The health IT developer demonstrates that the Health IT Module does not cache a JWK Set received via a TLS-protected URL for longer than the “cache-control” header received by an application indicates.</code></p>
<p>I think this should say "for no longer than the "cache-control" header <em>sent</em> by the application"?    Inferno re-worded that, and the Inferno wording seems right.  The ONC test procedure wording seems backwards.  The app isn't receiving the header, the app is sending it.  It could either be "received from" or "sent by".</p>



<a name="235256528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/235256528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#235256528">(Apr 19 2021 at 22:00)</a>:</h4>
<p>Yes, it seems like this is an issue with the test procedure.  Thanks for finding this discrepancy.</p>



<a name="238812346"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/JWKS%20Cache%20Control%20Testing/near/238812346" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/JWKS.20Cache.20Control.20Testing.html#238812346">(May 14 2021 at 18:49)</a>:</h4>
<p><span class="user-mention" data-user-id="191764">@Cooper Thompson</span> ONC put out an <a href="https://www.healthit.gov/test-method/standardized-api-patient-and-population-services#test-procedure">update to the test procedure</a>, and changed the line to "sent by":</p>
<blockquote>
<p>The health IT developer demonstrates that the Health IT Module does not cache a JWK Set received via a TLS-protected URL for longer than the “cache-control” header sent by an application indicates.</p>
</blockquote>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
