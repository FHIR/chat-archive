---
layout: page
title: "FHIR Chat  · No Encounter references found from the prior searches · inferno"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/index.html">inferno</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html">No Encounter references found from the prior searches</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="208751828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208751828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208751828">(Sep 01 2020 at 21:33)</a>:</h4>
<p>I am having an issue with Encounter Tests not finding encounter references in resources. This is in the program edition online version. The reported message is "No Encounter references found from the prior searches".</p>
<p>I know that at least two types of resources have encounters - conditions and medicationrequest.</p>
<div class="codehilite"><pre><span></span><code>{
  &quot;resource&quot;: {
    &quot;resourceType&quot;: &quot;Condition&quot;, [...]
    }, [...]
    &quot;encounter&quot;: {
      &quot;reference&quot;: &quot;Encounter/200007-Encounter-10001&quot;
    }
  }
}
</code></pre></div>


<p>and</p>
<div class="codehilite"><pre><span></span><code>{
  &quot;resource&quot;: {
    &quot;resourceType&quot;: &quot;MedicationRequest&quot;, [...]
    }, [...]
    &quot;encounter&quot;: {
      &quot;reference&quot;: &quot;Encounter/200007-Encounter-10001&quot;
    },
},
</code></pre></div>


<p>Any advice on what the issue might be or how to debug this?</p>



<a name="208762847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208762847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208762847">(Sep 01 2020 at 23:42)</a>:</h4>
<p><span class="user-mention" data-user-id="191473">@Matthew Dugal</span> This github issue explained how Encounter reference works: <a href="https://github.com/onc-healthit/inferno-program/issues/153">https://github.com/onc-healthit/inferno-program/issues/153</a></p>



<a name="208825397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208825397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208825397">(Sep 02 2020 at 13:44)</a>:</h4>
<p>This is helpful. Thank you!</p>



<a name="208828080"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208828080" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208828080">(Sep 02 2020 at 14:02)</a>:</h4>
<p>I believe that mixing US Core Encounter references and base FHIR Encounter references in US Core like this was unintentional and is fixed in the upcoming US Core Errata release.  But in the meantime you should add at least one Encounter reference in a spot that expects US Core Encounters (as described in the above ticket).</p>



<a name="208869467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208869467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208869467">(Sep 02 2020 at 18:46)</a>:</h4>
<p>I added encounter to the DocumentReference.context (as mentioned in the github issue) and still no luck getting my encounters recognized.</p>
<div class="codehilite"><pre><span></span><code>{
  &quot;resource&quot;: {
    &quot;resourceType&quot;: &quot;DocumentReference&quot;, [...]
    }, [...]
    &quot;context&quot;: {
      &quot;encounter&quot;: [ {
          &quot;reference&quot;: &quot;Encounter/200007-Encounter-10001&quot;
        }
      ],
 [...]
</code></pre></div>


<p>Any ideas?</p>



<a name="208872122"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208872122" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208872122">(Sep 02 2020 at 19:04)</a>:</h4>
<p>Strange!  In our test data it appears that a reference in DocumentReference.context.encounter is a reference that is used in the Encounter tests  later.  Did you 'Rerun All Tests'?  Or just the skipped ones?</p>



<a name="208872911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208872911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208872911">(Sep 02 2020 at 19:10)</a>:</h4>
<p>It's a new test altogether navigating to the home page and starting over. We do have at least one document reference test not passing. Maybe it's using that particular one?</p>



<a name="208873219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208873219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208873219">(Sep 02 2020 at 19:12)</a>:</h4>
<p>Do you know if it is all test cases or just specific ones?</p>



<a name="208901821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208901821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208901821">(Sep 02 2020 at 23:29)</a>:</h4>
<p>Ok. DocumentReference test _definitely_ sees my encounter. I see it requesting the encounter resource in test #14 "USCDR-14: Every reference within DocumentReference resources can be read."</p>
<p>But Encounter Tests still shows "No Encounter references found from the prior searches".</p>
<p>Is github the best place to report an issue?</p>



<a name="208906925"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208906925" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208906925">(Sep 03 2020 at 00:32)</a>:</h4>
<p>Right, if it attempts to resolve that resource within USCDR-14, then we know that it has been sent to Inferno and it should be saved for additional checks later.  It's a long shot, but you just confirm that reference isn't mistakenly in some other spot (other than <code>context.encounter</code>).  If that isn't the case, then a github issue would be great and we can track it there.  Thanks!</p>



<a name="208954168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208954168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208954168">(Sep 03 2020 at 11:44)</a>:</h4>
<p>is this test a basic existence test? Or is it hampered by security token that has been scoped to only DocumentReference and thus not the Encounter?</p>



<a name="208963884"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208963884" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208963884">(Sep 03 2020 at 13:11)</a>:</h4>
<p>A precondition of this test is a bearer token with sufficient scope to read any references that are provided, and the test should fail if the server returns anything other than OK and content that we expect.  This issue is something separate though and has to do with whether or not a client can expect a reference to conform to a US Core Profile, or just the base FHIR specification.  For non-USCDI, US Core resource references (e.g. Encounter), the way we structured the tests is to collect all US Core Encounter references in the USCDI US Core tests (which are always run first) and provide those references as an input to a dedicated US Core Encounter test which then performs a read and validates them against the US Core Encounter profile.  For some reason that collection appears to not be working as intended in this case, so the US Core Encounter test isn't receiving any references to read and validate as an input.</p>



<a name="208964648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208964648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208964648">(Sep 03 2020 at 13:16)</a>:</h4>
<p>well, Postel's Law would be a good thing to follow, it is considered the key to the success of the Internet and core Internet protocols... so one should never expect to get well behaved data. This does not mean you can process it as well as well behaved data, but it does mean that you must try hard to process it successfully and when it is so badly formatted, fail gracefully.  Thus the test tools should always go to the edge of the conformance and beyond.</p>



<a name="208965362"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208965362" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208965362">(Sep 03 2020 at 13:21)</a>:</h4>
<p>What do you mean by 'to the edge of the conformance and beyond'?</p>



<a name="208966867"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208966867" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208966867">(Sep 03 2020 at 13:32)</a>:</h4>
<p>See Postel's Law -- <a href="https://en.wikipedia.org/wiki/Robustness_principle">https://en.wikipedia.org/wiki/Robustness_principle</a></p>



<a name="208967087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/208967087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#208967087">(Sep 03 2020 at 13:34)</a>:</h4>
<p>We've applied this to our test design in that we often will fail earlier steps if we receive bad data, but try really hard to move on and execute later tests if possible instead of just stopping the tests (that's harder than you'd think).  But you will still fail overall until the system has demonstrated it is capable of sending 100% valid (and complete by our definition) data.  Whether or not this happens when deployed, and using real data, is out of scope of our testing.</p>



<a name="209039374"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/209039374" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#209039374">(Sep 03 2020 at 23:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="192576">Robert Scanlon</span> <a href="#narrow/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches/near/208963884">said</a>:</p>
<blockquote>
<p>For some reason that collection appears to not be working as intended in this case, so the US Core Encounter test isn't receiving any references to read and validate as an input.</p>
</blockquote>
<p>Any guesses? Or suggestion on how to debug?</p>



<a name="209097047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/209097047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#209097047">(Sep 04 2020 at 14:03)</a>:</h4>
<p>If you're using the version at <a href="http://inferno.healthit.gov">inferno.healthit.gov</a>, I can take a look next week if you send me a link to a failing run.</p>



<a name="209517683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/209517683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#209517683">(Sep 09 2020 at 14:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="225612">Stephen MacVicar</span><br>
Thank you for the offer. I did get pivoted to a new task but I am hearing from the team that encounters are populating and passing. So either something you or the team did resolved this issue. Thank you and everyone for your help!</p>



<a name="211265905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/211265905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fred Harmon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#211265905">(Sep 25 2020 at 14:36)</a>:</h4>
<p>I'm having this same issue when running inferno locally.  I see it for both Practitioner and Encounter.  In my example, I have a Condition that in a previous search or read returns references to both a Practitioner and an Encounter.  When I run either of those tests that expect to use previously found references it tells me that it can't find any from previous searches.  </p>
<p>Does anyone know if this is still an issue or if there was a resolution?</p>



<a name="211273230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/211273230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#211273230">(Sep 25 2020 at 15:28)</a>:</h4>
<p>Not yet, though we were able to reproduce the issue at the Connectathon.  I'll take a look.</p>



<a name="211291401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/211291401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#211291401">(Sep 25 2020 at 17:53)</a>:</h4>
<p>We found the problem and identified a fix, we'll have it in there for the next release.  There was a bug that occurred for non-USCDI US Core references, if they were located within an array in the resource, that caused us to not save them for the later tests.   US Core DocumentReference.context.encounter is constrained down to 0..1, from 0..* in the base spec, which obscured the bug.</p>



<a name="211296540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/211296540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fred Harmon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#211296540">(Sep 25 2020 at 18:34)</a>:</h4>
<p>Awesome.  I'll watch for the next release and try it out.  Thanks <span class="user-mention" data-user-id="192576">@Robert Scanlon</span> .</p>



<a name="213452012"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/No%20Encounter%20references%20found%20from%20the%20prior%20searches/near/213452012" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/No.20Encounter.20references.20found.20from.20the.20prior.20searches.html#213452012">(Oct 15 2020 at 16:33)</a>:</h4>
<p><span class="user-mention" data-user-id="329482">@Fred Harmon</span> -- our most recent release should fix this issue.  Could you give it a try when you have a chance?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
