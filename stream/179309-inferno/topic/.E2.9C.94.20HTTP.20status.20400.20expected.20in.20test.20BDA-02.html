---
layout: page
title: "FHIR Chat  · ✔ HTTP status 400 expected in test BDA-02 · inferno"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/index.html">inferno</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/.E2.9C.94.20HTTP.20status.20400.20expected.20in.20test.20BDA-02.html">✔ HTTP status 400 expected in test BDA-02</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="255792891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/%E2%9C%94%20HTTP%20status%20400%20expected%20in%20test%20BDA-02/near/255792891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Randall <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/.E2.9C.94.20HTTP.20status.20400.20expected.20in.20test.20BDA-02.html#255792891">(Oct 01 2021 at 19:07)</a>:</h4>
<p>Hello,</p>
<p>We encountered an error that we did not expect (based on our understanding of RFC 6749) in test BDA-02 Bulk Data Authorization.</p>
<p>In short, part of the test sends an HTTP request to the token endpoint without an appropriate content-type header, then expects an HTTP status of 400 and a corresponding OAuth error response as described in section 5.2 of RFC 6749.  We think this expectation is a misinterpretation of the specification, with reasoning as follows:</p>
<p>RFC 6479 describes a token request using the following wording:</p>
<blockquote>
<p>The client MUST use the HTTP "POST" method when making access token<br>
   requests.</p>
</blockquote>
<p>(Section 3.2)</p>
<blockquote>
<p>The client makes a request to the token endpoint by sending the<br>
   following parameters using the "application/x-www-form-urlencoded"<br>
   format per Appendix B with a character encoding of UTF-8 in the HTTP<br>
   request entity-body:</p>
</blockquote>
<p>(Section 4.1.3)</p>
<p>As such, a token request is defined as an HTTP POST to the token endpoint using <code>application/x-www-form-urlencoded</code> format with character encoding of UTF-8.  A "malformed" token request would be any request whose request entity-body does not match the expected structure as defined in section 4.1.3.</p>
<p>Test BDA-02 seems to expect that the server returns an access token error response (with status 400) for payloads whose content-type is not <code>application/x-www-form-urlencoded</code>.  This may conflict with other future OAuth2-based RFCs that expect standard response codes for this situation.  For example, the RFC draft "OAuth 2.0 JSON Request" states the following for clients sending token request payloads as JSON:</p>
<blockquote>
<p>If the request is rejected with 415 Unsupported Media Type, the requester MAY repeat the request using form encoding instead.</p>
</blockquote>
<p>Our expectation is that a token endpoint receiving a request that contains an unexpected content-type would simply be rejected with a 415 response code, just as an HTTP PUT operation to the token endpoint would be expected to return a 405 status code.</p>
<p>Please advise.</p>



<a name="255794685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/%E2%9C%94%20HTTP%20status%20400%20expected%20in%20test%20BDA-02/near/255794685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/.E2.9C.94.20HTTP.20status.20400.20expected.20in.20test.20BDA-02.html#255794685">(Oct 01 2021 at 19:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191609">@Matt Randall</span> I think this is reasonable. Would you mind to create a Github Issue on <a href="https://github.com/onc-healthit/inferno-program/issues">Infenro repo</a>? Thanks</p>



<a name="255794888"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/%E2%9C%94%20HTTP%20status%20400%20expected%20in%20test%20BDA-02/near/255794888" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Randall <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/.E2.9C.94.20HTTP.20status.20400.20expected.20in.20test.20BDA-02.html#255794888">(Oct 01 2021 at 19:23)</a>:</h4>
<p>Will do</p>



<a name="255797423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/%E2%9C%94%20HTTP%20status%20400%20expected%20in%20test%20BDA-02/near/255797423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/.E2.9C.94.20HTTP.20status.20400.20expected.20in.20test.20BDA-02.html#255797423">(Oct 01 2021 at 19:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191609">Matt Randall</span> has marked this topic as resolved.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
