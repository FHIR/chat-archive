---
layout: page
title: "FHIR Chat  · unrequested scope fails touchstone · inferno"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/index.html">inferno</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html">unrequested scope fails touchstone</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="201879530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201879530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201879530">(Jun 24 2020 at 17:38)</a>:</h4>
<p>I was testing smart app launch with a new identity server and I found that it is including an unrequested scope in its token response.  I think this is permitted (per <a href="https://tools.ietf.org/html/rfc6749">https://tools.ietf.org/html/rfc6749</a> at least), but it causes Inferno to mark the test failed:</p>
<blockquote>
<p>Token response contained unrequested scopes: &lt;bad_scope_here&gt;</p>
</blockquote>



<a name="201879649"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201879649" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201879649">(Jun 24 2020 at 17:39)</a>:</h4>
<p>is inferno being overly-strict, or is this behavior actually prohibited in SMART (or somewhere else)?</p>



<a name="201907596"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201907596" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201907596">(Jun 24 2020 at 21:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191676">@Lee Surprenant</span> did you observe this on Inferno Program or Community and which specific test was it?  Just want to make sure I'm looking at the right thing</p>
<p>For token refresh the scopes must be a strict subset of the scopes granted in the original launch (<a href="https://github.com/onc-healthit/inferno/issues/245">additional details here on this previous issue</a>).  If you're seeing this on another test then there may be a bug or some other requirement that I have forgotten, but that we should have included in the test description (and should update if we haven't).</p>



<a name="201908222"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201908222" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201908222">(Jun 24 2020 at 21:50)</a>:</h4>
<p>This was on community edition Version 2.9.0</p>



<a name="201908240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201908240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201908240">(Jun 24 2020 at 21:50)</a>:</h4>
<p>I will review that issue in a moment, thanks</p>



<a name="201909992"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201909992" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201909992">(Jun 24 2020 at 22:10)</a>:</h4>
<p>ok, i reviewed that isssue and I think it is different</p>



<a name="201910005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201910005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201910005">(Jun 24 2020 at 22:10)</a>:</h4>
<p>my issue is during the initial token request</p>



<a name="201910129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201910129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201910129">(Jun 24 2020 at 22:12)</a>:</h4>
<p><code>SLS-08: Token exchange response body contains required information encoded in JSON</code></p>



<a name="201910153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201910153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201910153">(Jun 24 2020 at 22:12)</a>:</h4>
<p>specifically this part: </p>
<blockquote>
<p>scope must be a strict subset of the requested scopes, or empty.</p>
</blockquote>



<a name="201910196"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201910196" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201910196">(Jun 24 2020 at 22:13)</a>:</h4>
<p>I'm not even saying its wrong, I'm just wondering where that requirement is coming from</p>



<a name="201977684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201977684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201977684">(Jun 25 2020 at 14:39)</a>:</h4>
<p>That is wrong, I believe. As stated/linked, OAuth allows the server to completely override what the client asks for.</p>



<a name="201980863"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201980863" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201980863">(Jun 25 2020 at 15:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191676">@Lee Surprenant</span> Yes. That is bug in Inferno. Do you mind to create a github issue? Thank you.</p>



<a name="201982956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/unrequested%20scope%20fails%20touchstone/near/201982956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/unrequested.20scope.20fails.20touchstone.html#201982956">(Jun 25 2020 at 15:18)</a>:</h4>
<p>thanks jenni and yunwei.  <a href="https://github.com/onc-healthit/inferno/issues/464">https://github.com/onc-healthit/inferno/issues/464</a><br>
i do think it should verify that you can get some set of SMART scope back, but not sure exactly how that should work</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
