---
layout: page
title: "FHIR Chat  · New refresh token · inferno"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/index.html">inferno</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html">New refresh token</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="206189292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206189292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206189292">(Aug 06 2020 at 19:58)</a>:</h4>
<p>There's a test in inferno that fails if a new refresh token isn't supplied on token refresh... I assume that should be looking for a new access token... not a new refresh token? OAuth 2 states a server <em>can</em> create a new refresh token, but doesn't have to</p>



<a name="206189324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206189324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206189324">(Aug 06 2020 at 19:59)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="191315">@Josh Mandel</span> to make sure I didn't miss something in SMART</p>



<a name="206189363"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206189363" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206189363">(Aug 06 2020 at 19:59)</a>:</h4>
<p>Test in question: "SPD-TR-06: Server supplies new refresh token as required by ONC certification criteria"</p>



<a name="206189860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206189860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206189860">(Aug 06 2020 at 20:03)</a>:</h4>
<p>I thought the only requirement from ONC was how long the refresh token was good for after refresh</p>



<a name="206189893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206189893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206189893">(Aug 06 2020 at 20:03)</a>:</h4>
<p>Agreed <span class="user-mention" data-user-id="191356">@Jenni Syed</span> -- this is a decision servers make. SMART says:</p>
<blockquote>
<p>The refresh token issued by the authorization server. If present, the app should discard any previosu (sic!) refresh_token associated with this launch, replacing it with this new value.</p>
</blockquote>



<a name="206195969"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206195969" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206195969">(Aug 06 2020 at 20:57)</a>:</h4>
<p>This is very specifically an ONC requirement, not an OAuth or SMART requirement.  We isolated it into its own test to separate it from SMART &amp; OAuth reqs.</p>



<a name="206196099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206196099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206196099">(Aug 06 2020 at 20:59)</a>:</h4>
<p>Paragraph (10)(v)(A)(2)</p>
<blockquote>
<p>For subsequent connections, access must be granted to patient data in accordance with the implementation specification adopted in § 170.215(a)(3) without requiring re-authorization and re-authentication when a valid refresh token is supplied by the application. Additionally, an application capable of storing a client secret must be issued a new refresh token valid for a new period of no less than three months.</p>
</blockquote>



<a name="206196432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206196432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206196432">(Aug 06 2020 at 21:02)</a>:</h4>
<p>And in the test procedure:</p>
<blockquote>
<p>The health IT developer demonstrates the ability of the Health IT Module to issue a new refresh token valid for a period of no shorter than three months without requiring re-authentication and re-authorization when a valid refresh token is supplied by the application according to the implementation specification adopted in § 170.215(a)(3).</p>
</blockquote>



<a name="206196583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206196583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206196583">(Aug 06 2020 at 21:03)</a>:</h4>
<p>Ok, we'll log something for clarification with ONC. I assume the important part of that was how long the refresh token is good for. The spec doesn't require a new token get issued, and ours are already good for more than the required time.</p>



<a name="206197604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206197604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206197604">(Aug 06 2020 at 21:13)</a>:</h4>
<p>That sounds right Jenni!  I think the important functional requirement is: after a refresh, the app now has a refresh token with life of at least 3 months. Whether it's the same or different from the previous refresh token should be in implementation detail.</p>



<a name="206198896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/New%20refresh%20token/near/206198896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/New.20refresh.20token.html#206198896">(Aug 06 2020 at 21:24)</a>:</h4>
<p>Thanks Jenni -- providing feedback to ONC is the way to go so they can provide guidance if they think its necessary.  The inferno team did very intentionally write this test based on the language in the rule, knowing it is not an OAuth requirement.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
