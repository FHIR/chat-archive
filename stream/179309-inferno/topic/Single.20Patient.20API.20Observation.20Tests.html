---
layout: page
title: "FHIR Chat  · Single Patient API Observation Tests · inferno"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/index.html">inferno</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html">Single Patient API Observation Tests</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="215353634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215353634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215353634">(Nov 02 2020 at 17:47)</a>:</h4>
<p>I'm currently trying to pass the all Observation tests in the Single Patient API collection. When using only Observations with "effectiveDateTime", I get an (expected) warning saying that no resource was provided with effectivePeriod in it. However, as soon as I upload an Observation using effectivePeriod, I get the following error message:</p>
<p>"Invalid Observation: Observation.effective.ofType(Period): vs-1: if Observation.effective[x] is dateTime and has a value then that value shall be precise to the day [($this as dateTime).toString().length() &gt;= 8]"</p>
<p>The needed precision  is given. Any pointers on what might cause the issue? <a href="/user_uploads/10155/6bgX4U6Oh95izNath90jmE1T/pediatric-weight-for-height-test.json">pediatric-weight-for-height-test.json</a></p>



<a name="215354874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215354874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215354874">(Nov 02 2020 at 17:56)</a>:</h4>
<p>This is a constraint defined in <a href="http://hl7.org/fhir/R4/vitalsigns.html#10.1.20.2.3">FHIR Vital Sign Profile</a>: <br>
<a href="/user_uploads/10155/YMIdq4YjsaHYcXW92uPN-TTO/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/YMIdq4YjsaHYcXW92uPN-TTO/image.png" title="image.png"><img src="/user_uploads/10155/YMIdq4YjsaHYcXW92uPN-TTO/image.png"></a></div>



<a name="215355157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215355157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215355157">(Nov 02 2020 at 17:58)</a>:</h4>
<p>I am not sure if this FHIRPath is correct. When the value is Period type, <code>($this as dateTime)</code> would return empty based on my limited knowledge about FHIRPath. Maybe <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  can weight in on this</p>



<a name="215600436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215600436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215600436">(Nov 04 2020 at 15:53)</a>:</h4>
<p>What would be the recommendation going forward?</p>



<a name="215617246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215617246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215617246">(Nov 04 2020 at 17:48)</a>:</h4>
<p>We are still looking into this.  We had just updated our reference data set to include effectivePeriod, and ran into the exact problem you are seeing, which makes me think it is a problem with the FHIRPath in the vital-sign profile, or the HL7 Validator (and not your data).  But we are still looking into it.</p>



<a name="215617367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215617367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215617367">(Nov 04 2020 at 17:49)</a>:</h4>
<p>Thank you for the update!</p>



<a name="215617594"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215617594" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215617594">(Nov 04 2020 at 17:51)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> -- does this invariant look right to you?</p>



<a name="215621620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215621620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215621620">(Nov 04 2020 at 18:22)</a>:</h4>
<p>I'm no fhirpath expert but lemme test it and see. ( Suprised it has been undiscovered this long.)</p>



<a name="215628048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215628048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215628048">(Nov 04 2020 at 19:13)</a>:</h4>
<p>I think it needs  to be:</p>
<p><code>Observation.effectiveDateTime implies Observation.effectiveDateTime.toString().length() &gt;= 8</code></p>
<p>I am not in front of a PC to test it out  (not aware of OSX testing tools)</p>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  ?</p>
<p>Made a tracker to correct <a href="http://jira.hl7.org/browse/FHIR-29654">J#29654</a></p>



<a name="215631630"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215631630" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215631630">(Nov 04 2020 at 19:43)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191401">@Eric Haas</span>!  Not to jump ahead, but assuming this is the problem/solution, would fixing this require a FHIR v4.0.2 be published?</p>



<a name="215633547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215633547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215633547">(Nov 04 2020 at 19:58)</a>:</h4>
<p>this is a FHIR4b or FHIR5</p>



<a name="215719455"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215719455" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215719455">(Nov 05 2020 at 14:37)</a>:</h4>
<p>There is a similar discussion <a href="#narrow/stream/179166-implementers/topic/Observation.20FHIRPath.20expressions.3F">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Observation.20FHIRPath.20expressions.3F</a></p>



<a name="215722238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215722238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215722238">(Nov 05 2020 at 14:55)</a>:</h4>
<p>I am concerned how long this will take to make it back into US Core <span class="user-mention" data-user-id="191401">@Eric Haas</span>, if this kind of fix is targeted at FHIR4b/FHIR5.  I assume it will be some time before US Core is updated to point to FHIR4b/FHIR5?  And in the meantime the use of Observation.effectivePeriod is non-conformant (assuming the FHIRPath is wrong as we suspect).</p>



<a name="215723561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215723561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215723561">(Nov 05 2020 at 15:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> We also found the same FHIRPath is used in us-core-1 constraint in US Core Lab Result profile<br>
I created <a href="http://jira.hl7.org/browse/FHIR-29658">FHIR-29658</a> for US Core. Can you put it in discussion at next US Core call?</p>



<a name="215738950"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215738950" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215738950">(Nov 05 2020 at 16:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="192576">Robert Scanlon</span> <a href="#narrow/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests/near/215722238">said</a>:</p>
<blockquote>
<p>I am concerned how long this will take to make it back into US Core <span class="user-mention silent" data-user-id="191401">Eric Haas</span>, if this kind of fix is targeted at FHIR4b/FHIR5.  I assume it will be some time before US Core is updated to point to FHIR4b/FHIR5?  And in the meantime the use of Observation.effectivePeriod is non-conformant (assuming the FHIRPath is wrong as we suspect).</p>
</blockquote>
<p>I cannot do anything to speed up the process, w can't just change the core.   So need to deal with as a known issue.</p>



<a name="215887411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/215887411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#215887411">(Nov 06 2020 at 18:43)</a>:</h4>
<p>Here is the information I collected from different sources:</p>
<ul>
<li>Next FHIR release is R4B which will fix the the vs-1 constraint</li>
<li>Next US Core release is Q2 2021 which will fix the us-core-1 constraint</li>
<li>US Core 2021 release is based on R4 v4.0.1, not R4B<br>
Unless there is way to back port this fix to R4 v4.0.1, this issue will not be fully addressed before US Core 2022 release.</li>
</ul>



<a name="216451992"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179309-inferno/topic/Single%20Patient%20API%20Observation%20Tests/near/216451992" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179309-inferno/topic/Single.20Patient.20API.20Observation.20Tests.html#216451992">(Nov 12 2020 at 10:43)</a>:</h4>
<p>I agree that the FHIRPath is wrong</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
