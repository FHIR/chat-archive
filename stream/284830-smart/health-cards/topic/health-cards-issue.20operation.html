---
layout: page
title: "FHIR Chat  · health-cards-issue operation · smart/health-cards"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/index.html">smart/health-cards</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html">health-cards-issue operation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="252036703"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252036703" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252036703">(Sep 05 2021 at 00:26)</a>:</h4>
<p>This operation doesn't have a formal definition anywhere yet?</p>



<a name="252037770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252037770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252037770">(Sep 05 2021 at 00:46)</a>:</h4>
<p>It has a JSON operation definition</p>



<a name="252037811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252037811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252037811">(Sep 05 2021 at 00:47)</a>:</h4>
<p>Here in the optimistically pluralized and not widely advertised artifacts directory <a href="https://github.com/smart-on-fhir/health-cards/tree/main/docs/artifacts">https://github.com/smart-on-fhir/health-cards/tree/main/docs/artifacts</a></p>



<a name="252037890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252037890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252037890">(Sep 05 2021 at 00:49)</a>:</h4>
<p>(I don't know if anyone is using this to directly drive any kind of behavior, so I expect it'll turn out to be broken some ways.)</p>



<a name="252038217"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252038217" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252038217">(Sep 05 2021 at 00:55)</a>:</h4>
<p>so this will live in the IG eventually, right? The canonical URL will be <code>http://hl7.org/fhir/uv/shc-vaccination/OperationDefinition/health-cards-issue</code> ?</p>



<a name="252038281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252038281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252038281">(Sep 05 2021 at 00:56)</a>:</h4>
<p>I just decided not to generate from it too ;-)  (which means I just want the canonical URL, though I can always make a temporary one)</p>



<a name="252038824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252038824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252038824">(Sep 05 2021 at 01:06)</a>:</h4>
<p>The Vaccination/Testing IG is particular to the data profiling, so it's not where we <em>think</em> a general purpose issuance operation belongs. We still need to bring the core framework through HL7 process.</p>



<a name="252039211"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252039211" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252039211">(Sep 05 2021 at 01:14)</a>:</h4>
<p>ok. well, I can change it later.</p>



<a name="252039215"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252039215" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252039215">(Sep 05 2021 at 01:14)</a>:</h4>
<p>this is a bit odd for me:</p>



<a name="252039217"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252039217" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252039217">(Sep 05 2021 at 01:14)</a>:</h4>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Parameters"</span><span class="p">,</span>
  <span class="nt">"parameter"</span><span class="p">:</span> <span class="p">[{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"verifiableCredential"</span><span class="p">,</span>
    <span class="nt">"valueString"</span><span class="p">:</span> <span class="s2">"&lt;&lt;Health Card as JWS&gt;&gt;"</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"resourceLink"</span><span class="p">,</span>
    <span class="nt">"part"</span><span class="p">:</span> <span class="p">[{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"vcIndex"</span><span class="p">,</span>
        <span class="nt">"valueInteger"</span><span class="p">:</span> <span class="mi">0</span>
      <span class="p">},</span> <span class="p">{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"bundledResource"</span><span class="p">,</span>
        <span class="nt">"valueUri"</span><span class="p">:</span> <span class="s2">"resource:2"</span>
      <span class="p">},</span> <span class="p">{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"hostedResource"</span><span class="p">,</span>
        <span class="nt">"valueUri"</span><span class="p">:</span> <span class="s2">"https://fhir.example.org/Immunization/123"</span>
    <span class="p">}]</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div>



<a name="252039220"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252039220" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252039220">(Sep 05 2021 at 01:14)</a>:</h4>
<p>wouldn't this be better:</p>



<a name="252039319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252039319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252039319">(Sep 05 2021 at 01:16)</a>:</h4>
<p>this seems more natural:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Parameters"</span><span class="p">,</span>
  <span class="nt">"parameter"</span><span class="p">:</span> <span class="p">[{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"verifiableCredential"</span><span class="p">,</span>
    <span class="nt">"part"</span><span class="p">:</span> <span class="p">[{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"signedCredential"</span><span class="p">,</span>
        <span class="nt">"valueString"</span><span class="p">:</span> <span class="s2">"&lt;&lt;Health Card as JWS&gt;&gt;"</span>
      <span class="p">},</span> <span class="p">{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"resourceLink"</span><span class="p">,</span>
        <span class="nt">"part"</span><span class="p">:</span> <span class="p">[{</span>
          <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"bundledResource"</span><span class="p">,</span>
          <span class="nt">"valueUri"</span><span class="p">:</span> <span class="s2">"resource:2"</span>
        <span class="p">},</span> <span class="p">{</span>
          <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"hostedResource"</span><span class="p">,</span>
          <span class="nt">"valueUri"</span><span class="p">:</span> <span class="s2">"https://fhir.example.org/Immunization/123"</span>
      <span class="p">}]</span>
    <span class="p">}]</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div>



<a name="252039344"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252039344" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252039344">(Sep 05 2021 at 01:17)</a>:</h4>
<p>group the card with the links, and get rid of vcIndex</p>



<a name="252039629"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252039629" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252039629">(Sep 05 2021 at 01:23)</a>:</h4>
<p><a href="https://github.com/smart-on-fhir/health-cards/issues/88">https://github.com/smart-on-fhir/health-cards/issues/88</a> has discussion; short answer is we didn't want to break our API at the point when we introduced these properties</p>



<a name="252040599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252040599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252040599">(Sep 05 2021 at 01:44)</a>:</h4>
<p>If no results are available, a Parameters resource without any parameter is returned:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Parameters"</span>
<span class="p">}</span>
</code></pre></div>



<a name="252040830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252040830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252040830">(Sep 05 2021 at 01:49)</a>:</h4>
<p>That's what we say... is this not kosher?</p>



<a name="252040997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252040997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252040997">(Sep 05 2021 at 01:53)</a>:</h4>
<p>I think it is, and I'm sure we've specifically discussed this before - it's the only circumstance where you have an empty resource. But it feels to me like it would be appropriate for the server side to return some string message in these cases, so that a user can be communicated with concerning why. And if the server doesn't want to say anything of substance, it can pick it's own non-descript wording to present to the user.</p>



<a name="252041086"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252041086" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252041086">(Sep 05 2021 at 01:55)</a>:</h4>
<p>I'm thinking this will minimise human support needed. ("I don't get any cards, just a message that 'there's no results' - I didn't want any results, just my card!")</p>



<a name="252041119"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252041119" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252041119">(Sep 05 2021 at 01:55)</a>:</h4>
<p>It's analogous to an empty search result in my thinking; if the system has no data, it's not necessarily something that needs explaining. But for sure we could add an optional param</p>



<a name="252041222"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252041222" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252041222">(Sep 05 2021 at 01:57)</a>:</h4>
<p>Users aren't going to be calling this API any more than they call a search API. Health apps will ask for data of all kinds on behalf of the user without explicitly showing the user anything if there's no data.</p>



<a name="252042510"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252042510" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252042510">(Sep 05 2021 at 02:21)</a>:</h4>
<p>me, I'm thinking that's not so true. Users will <em>want</em> their cards. They'll really need them. I'm imagining it will be a specific operation, not just something done in the background by the app. "Get me my cards." Perhaps I'm wrong.</p>



<a name="252044229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252044229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252044229">(Sep 05 2021 at 02:55)</a>:</h4>
<p>That's fair; most experience today with users explicitly requesting health cards has been downloading via state public health portals rather than connecting an app to call this operation via SMART on FHIR. For cases where the API is supported, It has been as part of generic patient APIs from healthcare providers (who may have all kinds of USCDI data and won't necessarily be expected to have health cards for most patients, unlike the state portals which can offer cards to the whole population).</p>



<a name="252044428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252044428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252044428">(Sep 05 2021 at 02:59)</a>:</h4>
<p>I'm not sure what kind of message would really cut down on support calls if a user was expecting their health app to fetch a card and it couldn't, but I'm certainly in favor of adding optional response properties to ensure issuers can pass back a message if they want to. (As an alternative or additionally, I'd  think about having issuers statically advertise a URL for health cards support.)</p>



<a name="252050846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252050846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252050846">(Sep 05 2021 at 05:08)</a>:</h4>
<p>more that it might cut down the difficulty of resolving the support call, rather than their frequency. But: yes, search can return messages that inform about issues, and I think this could too</p>



<a name="252050887"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252050887" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252050887">(Sep 05 2021 at 05:08)</a>:</h4>
<p>and agree about support info - in the .well-known?</p>



<a name="252079180"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252079180" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252079180">(Sep 05 2021 at 14:11)</a>:</h4>
<p>Field in [FHIRServer base].well-known/smart-configuration would work for API based issuers, We might want to provide an ".healthCardIss" property in that file, and then push other health cards issuer data into a file that's discoverable relative to the health card iss url, so the same format could be used for issuers that don't support the API. Some discussion at <a href="https://github.com/the-commons-project/vci-directory/issues/52">https://github.com/the-commons-project/vci-directory/issues/52</a> (<code>website</code> field for example) about what these metadata might be.  (That conversation is about metadata in the directory, but as Paul points out it could just as well apply to metadata published by issuers.)</p>



<a name="252100781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252100781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252100781">(Sep 05 2021 at 20:44)</a>:</h4>
<p>with regard to credential types, I can't currently request both immunization and lab test covid cards, right? I can say 'all covid cards', but not more than one type of covid card?</p>



<a name="252101105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252101105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252101105">(Sep 05 2021 at 20:51)</a>:</h4>
<p>One of the things that's come up a lot with search is unrecognised parameter values. Given that the health-cards operation is taking a Parameters resource as a post, there's no reason for it to contain added parameters from the stack anywhere, and so unrecognised parameters should cause an error. Or at least, the expected behavior should be clarified somewhere</p>



<a name="252105847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252105847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252105847">(Sep 05 2021 at 22:23)</a>:</h4>
<p>In a single API call, you supply a list of types that the server ANDs together. If you need other cards, you make another API call. (You can always just ask the server for all health cards it has by passing a generic type like <code>#health-card</code>.)</p>



<a name="252114135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252114135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252114135">(Sep 06 2021 at 01:03)</a>:</h4>
<p>I can. The idea that the card meanings intersect, while having different and orthogonal granularities... it's kind of screwy, really. if there's another type added (like conditions) the logic will suddenly get much more intricate. I don't have any suggestions, but if more sub-types are added, we'll need to be more specific about groupings and logic</p>



<a name="252114811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252114811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252114811">(Sep 06 2021 at 01:17)</a>:</h4>
<p>Are you thinking from the issuance perspective or the sharing perspective? The aim has been to get issuers to classify cards up front so that downstream selection logic can work even for wallet apps without a deep understanding of FHIR (i.e., all they need to know is that every card has types). If we relax this goal, we could just have queries written as fhirpath expressions over bundles and ask wallets to evaluate those against all cards stored, to figure out what matches.</p>



<a name="252115156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252115156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252115156">(Sep 06 2021 at 01:25)</a>:</h4>
<p>I was just thinking in terms of responding to the operation. The logic is a bit screwy. Her'</p>



<a name="252115168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252115168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252115168">(Sep 06 2021 at 01:25)</a>:</h4>
<p>here's my pseudo-code:</p>



<a name="252116249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116249">(Sep 06 2021 at 01:48)</a>:</h4>
<div class="codehilite"><pre><span></span><code>boolean covid = is https://smarthealth.cards#covid19 in credentials?
if (https://smarthealth.cards#health-card or https://smarthealth.cards#immunization) and not (https://smarthealth.cards#laboratory) then
  makeImmunizationCard(...)
if (https://smarthealth.cards#health-card or https://smarthealth.cards#immunization) and not (https://smarthealth.cards#immunization) then
  makeLmmunizationCard(...)
</code></pre></div>



<a name="252116260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116260">(Sep 06 2021 at 01:48)</a>:</h4>
<p>unless I have it wrong. But I don't think I do. But each new credentialType is going to complicate that logic significantly.</p>



<a name="252116288"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116288" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116288">(Sep 06 2021 at 01:49)</a>:</h4>
<p>I thoroughly endorse making wallet apps simple, and the credential type is fine. it's just the weird mix in the request that will be difficult to manage going forward</p>



<a name="252116476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116476">(Sep 06 2021 at 01:52)</a>:</h4>
<p>I don't think you need to explicitly check for the #health-card type in your logic, since all health cards will have it. otherwise looks right to me (and if we wind up having loads more types, let's think about how to structure more cleanly.)</p>



<a name="252116508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116508">(Sep 06 2021 at 01:54)</a>:</h4>
<blockquote>
<p>since all health cards will have it</p>
</blockquote>
<p>But not all requests to $health-cards-issue will have it? I wasn't sure how to think about that.</p>



<a name="252116565"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116565" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116565">(Sep 06 2021 at 01:54)</a>:</h4>
<p>Requests can omit this if they're supplying a subtype like #imnunization becsuse the supertype is logically implied</p>



<a name="252116566"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116566" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116566">(Sep 06 2021 at 01:54)</a>:</h4>
<p>(the other thing you can do is to always pregenerate cards for the types you support whenever new data arrives, and at issuance API call time just select among them the same way a wallet would.)</p>



<a name="252116599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116599">(Sep 06 2021 at 01:55)</a>:</h4>
<blockquote>
<p>Requests can omit this if they're supplying a subtype like #imnunization becsuse it's logically implies.</p>
</blockquote>
<p>What does it mean if you don't specify it, and just specify https://smarthealth.cards#covid19? Nothing will be returned?</p>



<a name="252116702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116702">(Sep 06 2021 at 01:57)</a>:</h4>
<p>If you ask for #covid19 as your only request type, that's equivalent to asking for #covid19 and #health-card together. You should receive any Covid immunization cards and any Covid lab result cards that the server can provide.</p>



<a name="252116768"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116768" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116768">(Sep 06 2021 at 01:58)</a>:</h4>
<p><a href="https://spec.smarthealth.cards/vocabulary">https://spec.smarthealth.cards/vocabulary</a> describes the types/subtypes</p>



<a name="252116772"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116772" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116772">(Sep 06 2021 at 01:58)</a>:</h4>
<p>so asking for https://smarthealth.cards#health-card or not is irrelevant? It's a useless parameter, even though the example says you provide it</p>



<a name="252116851"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116851" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116851">(Sep 06 2021 at 02:00)</a>:</h4>
<p>I think it's useless if you're already supplying another type that's a subtype, since "A intersect with B" is the same as "B" if B is a subset of A.</p>



<a name="252116921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116921">(Sep 06 2021 at 02:00)</a>:</h4>
<p>well, I think that should be documented, since it's not obvious.</p>



<a name="252116944"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116944" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116944">(Sep 06 2021 at 02:01)</a>:</h4>
<p>(It's arguably useless also if it's the only parameter, but it's explicit, and allows for a future where we change up the type system.)</p>



<a name="252116950"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252116950" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252116950">(Sep 06 2021 at 02:01)</a>:</h4>
<p>the other issue is that correct processing of the request requires for you to not ignore credentialTypes you do not recognise</p>



<a name="252117053"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117053" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117053">(Sep 06 2021 at 02:02)</a>:</h4>
<p>That's certainly true (it's an "issue" to make sure that's documented/understood, but I don't think it's a design problem - agreed?)</p>



<a name="252117098"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117098" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117098">(Sep 06 2021 at 02:03)</a>:</h4>
<p>(understanding all requested types is implied, since every card you return needs to include all of the requested types.)</p>



<a name="252117109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117109">(Sep 06 2021 at 02:03)</a>:</h4>
<p>well, I feel like it's both. Sure, we could call ourselves happy with that design, but it feels fragile to me - resistant to graceful forward change</p>



<a name="252117184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117184">(Sep 06 2021 at 02:04)</a>:</h4>
<p>You can't satisfy the request if you don't understand it.</p>



<a name="252117222"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117222" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117222">(Sep 06 2021 at 02:05)</a>:</h4>
<p>generally, we aim for you satisfy the request to the degree you do understand it. That's not always safe, but it's must more robust if things can be designed that way. This piece of API doesn't have that resilience to my way of thinking</p>



<a name="252117226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117226">(Sep 06 2021 at 02:05)</a>:</h4>
<p>Advertising supported types (per the VCI modeling issue linked above) and failing if a client requests something unsupported shouldn't (?) be fragile.</p>



<a name="252117306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117306">(Sep 06 2021 at 02:06)</a>:</h4>
<p>Clients can always just ask for "all health cards" and generally do/should just do that.</p>



<a name="252117347"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117347" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117347">(Sep 06 2021 at 02:07)</a>:</h4>
<p>All this fancy issuance-time type specificity is already in "do we need it" territory IMO.</p>



<a name="252117424"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117424" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117424">(Sep 06 2021 at 02:08)</a>:</h4>
<p>well, it's for privacy reasons, right?</p>



<a name="252117462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117462">(Sep 06 2021 at 02:09)</a>:</h4>
<p>I just don't like the intersection part. Just make the client list the card-types they want, with fully coordinated codes that are specific. Then it's simple for both client and server</p>



<a name="252117479"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117479" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117479">(Sep 06 2021 at 02:09)</a>:</h4>
<blockquote>
<p>privacy reasons</p>
</blockquote>
<p>No, health apps are generally running under a user's control and in any case are limited by their authz scopes.</p>
<blockquote>
<p>Fully coordinated codes</p>
</blockquote>



<a name="252117595"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117595" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117595">(Sep 06 2021 at 02:10)</a>:</h4>
<p>Fair enough, re: intersections. Might be overkill to have two axes (I just think intersections <em>are</em> simple -- I realize I'm not in the mainstream on this.)</p>



<a name="252117694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117694">(Sep 06 2021 at 02:12)</a>:</h4>
<p>I was getting to the interplay around authz scopes. I'd be perfectly happy with we simplified to just use authz scopes, but I'm trying not to comment on requirements, since I don't have real world ones, I'm just exercising the API.</p>



<a name="252117705"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/health-cards-issue%20operation/near/252117705" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/health-cards-issue.20operation.html#252117705">(Sep 06 2021 at 02:12)</a>:</h4>
<p>and regarding intersections: sure, testing intersections is ok. It's the process around them that complicates things</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
