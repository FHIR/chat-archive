---
layout: page
title: "FHIR Chat  · app to app on android: what intent filters are apps using? · smart/health-cards"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/index.html">smart/health-cards</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html">app to app on android: what intent filters are apps using?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="257431066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257431066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257431066">(Oct 13 2021 at 20:19)</a>:</h4>
<p>We've noticed that some wallet apps don't successfully launch with our .smart-health-card file export on Android. The spec only states the MIME type to use (<a href="https://spec.smarthealth.cards/#via-file-download">application/smart-health-card</a>). What Android intents and intent filters are people using?</p>
<p>cc / <span class="user-mention" data-user-id="410376">@Oliver Pang</span></p>



<a name="257431525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257431525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257431525">(Oct 13 2021 at 20:22)</a>:</h4>
<p>Ours is something like: </p>
<div class="codehilite"><pre><span></span><code>Intent intent = new Intent();
intent.setAction(Intent.ACTION_SEND);
intent.setDataAndType(uri, &quot;application/smart-health-card&quot;);
intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivityForResult(Intent.createChooser(intent, ...
</code></pre></div>



<a name="257432570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257432570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257432570">(Oct 13 2021 at 20:29)</a>:</h4>
<p><span class="user-mention" data-user-id="365368">@James Kizer</span></p>



<a name="257441283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257441283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Kizer <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257441283">(Oct 13 2021 at 21:29)</a>:</h4>
<p>Based on our read of the Android docs, <code>ACTION_VIEW</code> seems like the more appropriate choice. </p>
<p>The description of <code>ACTION_VIEW</code> is:</p>
<blockquote>
<p>Display the data to the user. This is the most common action performed on data -- it is the generic action you can use on a piece of data to get the most reasonable thing to occur. For example, when used on a contacts entry it will view the entry; when used on a mailto: URI it will bring up a compose window filled with the information supplied by the URI; when used with a tel: URI it will invoke the dialer.</p>
</blockquote>
<p>Our take on that is to "display this data in another app"</p>
<p>The description of <code>ACTION_SEND</code> is:</p>
<blockquote>
<p>Deliver some data to someone else. Who the data is being delivered to is not specified; it is up to the receiver of this action to ask the user where the data should be sent. </p>
</blockquote>
<p>Our take on that is "send this data to another person"</p>
<p>Regardless of which intent you ultimately choose, CommonHealth is set up handle both <code>ACTION_VIEW</code> and <code>ACTION_SEND</code>. We created a test app to ensure that CommonHealth can handle these intents and including code below for how we configure them.</p>
<p>For <code>ACTION_VIEW</code>:</p>
<div class="codehilite"><pre><span></span><code>        val shareableUri = SHCContentProvider.createShareableUri()

        return Intent(Intent.ACTION_VIEW).apply {
            setDataAndType(shareableUri, &quot;application/smart-health-card&quot;)
            addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION)
        }
</code></pre></div>
<p>For <code>ACTION_SEND</code>:</p>
<div class="codehilite"><pre><span></span><code>        val shareableUri = SHCContentProvider.createShareableUri()

        return Intent(Intent.ACTION_SEND).apply {
            putExtra(Intent.EXTRA_STREAM, shareableUri)
            type = &quot;application/smart-health-card&quot;
            addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION)
        }
</code></pre></div>
<p>After updating the <code>ACTION_SEND</code> code to use <code>setDataAndType</code> rather than <code>putExtra(Intent.EXTRA_STREAM, shareableUri)</code> and <code>type = "application/smart-health-card"</code>, CommonHealth was no longer listed as an application capable handling the intent. Also, comparing your implementation against the docs <a href="https://developer.android.com/training/sharing/send#send-binary-content">here</a>, I'd suggest trying the <code>putExtra(Intent.EXTRA_STREAM, shareableUri)</code> and <code>type = "application/smart-health-card"</code> approach.</p>
<p>Also note that we use <code>startActivity</code> instead of <code>startActivityForResult</code> as well.</p>



<a name="257441493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257441493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Kizer <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257441493">(Oct 13 2021 at 21:30)</a>:</h4>
<p>We've also seen some reports of users having trouble exporting data from their MyChart app into CommonHealth, so it would be great if we could hop on a call to debug</p>



<a name="257446889"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257446889" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Pang <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257446889">(Oct 13 2021 at 22:10)</a>:</h4>
<p>Appreciate the writeup! The EXTRA_STREAM approach does seem more in-line with the docs so we'll definitely try it and let you know how it goes. </p>
<p>Regarding  ACTION_VIEW vs ACTION_SEND,  We've personally chose ACTION_SEND as we're sending the user SHC data to another app for ownership. ACTION_VIEW does definitely make sense as well - especially reading this excerpt</p>
<blockquote>
<p>It is the generic action you can use on a piece of data to get the most reasonable thing to occur. </p>
</blockquote>
<p>Curious if we have other opinions in this chat as well</p>



<a name="257456581"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257456581" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257456581">(Oct 13 2021 at 23:46)</a>:</h4>
<p>I think it'd be worth including notes in the spec, once we get a shared perspective ironed out.</p>



<a name="257732840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257732840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Pang <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257732840">(Oct 15 2021 at 17:15)</a>:</h4>
<p>Worked like a charm James!<br>
Verified I was able to export my SHC to CommonHealth with my personal MyChart account using that tweak.</p>
<p>From a bit of testing - I'd propose we prefer the ACTION_SEND approach over ACTION_VIEW.<br>
ACTION_SEND  seems to be supported by a variety of apps (e.g. Google Drive, GMail, OneDrive) for sharing or uploading to cloud - whereas view lacks that. It'll be a bit more flexible for the user.</p>
<p>It may be worthwhile to include a suggested intent filter config as well  in the spec- to be extra explicit.</p>



<a name="257746591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257746591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257746591">(Oct 15 2021 at 18:51)</a>:</h4>
<p>Oliver, James, would that be something like ... ?</p>
<div class="codehilite"><pre><span></span><code>&lt;activity android:name=&quot;ShareActivity&quot; android:exported=&quot;false&quot;&gt;
    &lt;!-- This activity handles &quot;SEND&quot; actions with text data --&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;android.intent.action.SEND&quot;/&gt;
        &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;
        &lt;data android:mimeType=&quot;application/smart-health-card&quot;/&gt;
    &lt;/intent-filter&gt;
</code></pre></div>



<a name="257753097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257753097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Kizer <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257753097">(Oct 15 2021 at 19:40)</a>:</h4>
<p>RE: ACTION_SEND vs ACTION_VIEW, that's fine, but we also need to make wallets aware that other applications on the device (i.e., Files, Gmail) utilize the ACTION_VIEW intent. Also, sometimes the mime type come through as <code>application/octet-stream</code> from some applications (e.g., from Files), so we might want to include that.</p>
<p>Our intent filters to support this functionality are as follows:</p>
<div class="codehilite"><pre><span></span><code>&lt;intent-filter&gt;
    &lt;action android:name=&quot;android.intent.action.VIEW&quot; /&gt;
    &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
    &lt;category android:name=&quot;android.intent.category.BROWSABLE&quot; /&gt;

    &lt;data android:host=&quot;*&quot; android:scheme=&quot;content&quot; android:mimeType=&quot;application/smart-health-card&quot; /&gt;
    &lt;data android:host=&quot;*&quot; android:scheme=&quot;content&quot; android:mimeType=&quot;application/octet-stream&quot; /&gt;
&lt;/intent-filter&gt;
&lt;intent-filter&gt;
    &lt;action android:name=&quot;android.intent.action.SEND&quot; /&gt;
    &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
    &lt;data android:mimeType=&quot;application/smart-health-card&quot; /&gt;
&lt;/intent-filter&gt;
</code></pre></div>



<a name="257757427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257757427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257757427">(Oct 15 2021 at 20:08)</a>:</h4>
<p><span class="user-mention" data-user-id="365368">@James Kizer</span> , <span class="user-mention" data-user-id="410376">@Oliver Pang</span> -- how's this look: <a href="https://github.com/smart-on-fhir/health-cards/pull/197">https://github.com/smart-on-fhir/health-cards/pull/197</a> ?</p>



<a name="257758118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257758118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Kizer <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257758118">(Oct 15 2021 at 20:12)</a>:</h4>
<p>Thanks for putting this PR up <span class="user-mention" data-user-id="191864">@Isaac Vetter</span>, left some feedback</p>



<a name="257758323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/app%20to%20app%20on%20android%3A%20what%20intent%20filters%20are%20apps%20using%3F/near/257758323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Pang <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/app.20to.20app.20on.20android.3A.20what.20intent.20filters.20are.20apps.20using.3F.html#257758323">(Oct 15 2021 at 20:14)</a>:</h4>
<p>Good point James - I did notice that during initial testing as well. Good thing to note.</p>
<p>I don't have any concerns with the PR Isaac. Agreed with the PR comments from James</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
