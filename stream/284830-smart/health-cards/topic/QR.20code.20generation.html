---
layout: page
title: "FHIR Chat  · QR code generation · smart/health-cards"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/index.html">smart/health-cards</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html">QR code generation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="239476667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239476667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239476667">(May 19 2021 at 18:45)</a>:</h4>
<p>Is this right? (should correspond to <a href="https://smarthealth.cards/examples/example-00-a-fhirBundle.json">https://smarthealth.cards/examples/example-00-a-fhirBundle.json</a>)<br>
<a href="/user_uploads/10155/cQcLpFrig1_Z9haeqcijN05-/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/cQcLpFrig1_Z9haeqcijN05-/image.png" title="image.png"><img src="/user_uploads/10155/cQcLpFrig1_Z9haeqcijN05-/image.png"></a></div>



<a name="239477006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Lee <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477006">(May 19 2021 at 18:47)</a>:</h4>
<p>I scanned it into the microsoft validator tool(<a href="https://demo-portals.smarthealth.cards/VerifierPortal.html">https://demo-portals.smarthealth.cards/VerifierPortal.html</a>) and it says the QR code is using version 29(should be 22)</p>



<a name="239477175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Lee <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477175">(May 19 2021 at 18:49)</a>:</h4>
<p>The payload does have a FHIR bundle with a <code>Patient</code> resource and 2 <code>Immunization</code> resources.</p>



<a name="239477247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477247">(May 19 2021 at 18:49)</a>:</h4>
<p>Likely a problem with numeric encoding here.</p>



<a name="239477366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477366">(May 19 2021 at 18:50)</a>:</h4>
<p>Though if that's the case I'd expect two validation errors: one for V29 code (&gt;22) and one for non-numeric encoding (if that's what's happening).</p>



<a name="239477669"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477669" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477669">(May 19 2021 at 18:52)</a>:</h4>
<p>Thanks Daniel and Josh<br>
I checked the numeric encoding and it matched the <a href="https://smarthealth.cards/examples/example-00-f-qr-code-numeric-value-0.txt">https://smarthealth.cards/examples/example-00-f-qr-code-numeric-value-0.txt</a></p>



<a name="239477760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477760">(May 19 2021 at 18:53)</a>:</h4>
<p>So, the <em>string of digits</em> is right, but you're not creating a QR with a numeric-mode segment (I'm guessing).</p>



<a name="239477875"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477875" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477875">(May 19 2021 at 18:54)</a>:</h4>
<p>It's like what I'd get if I changed <a href="https://github.com/smart-on-fhir/health-cards/blob/main/generate-examples/src/index.ts#L180">this line</a> of the example generator to say <code>mode: "bytes"</code> (not sure if this helps you, but just want to give you a concrete sense of what may be happening).</p>



<a name="239477957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477957">(May 19 2021 at 18:54)</a>:</h4>
<p>Thanks, yes, probably that's the issue. It seems that the library I am using does not have that option, let me check</p>



<a name="239477988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239477988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239477988">(May 19 2021 at 18:55)</a>:</h4>
<p>What language are you using?</p>



<a name="239478022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239478022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239478022">(May 19 2021 at 18:55)</a>:</h4>
<p>JavaScript</p>



<a name="239478055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239478055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239478055">(May 19 2021 at 18:55)</a>:</h4>
<p>Using <a href="http://davidshimjs.github.io/qrcodejs/">http://davidshimjs.github.io/qrcodejs/</a></p>



<a name="239478096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239478096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Lee <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239478096">(May 19 2021 at 18:55)</a>:</h4>
<p><a href="https://www.npmjs.com/package/qrcode">https://www.npmjs.com/package/qrcode</a> , this library is what most of us are using, it allows you to mix and match modes</p>



<a name="239478211"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239478211" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239478211">(May 19 2021 at 18:56)</a>:</h4>
<p>Thanks, I'll try that one</p>



<a name="239478254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239478254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239478254">(May 19 2021 at 18:56)</a>:</h4>
<p>+1 for <a href="https://www.npmjs.com/package/qrcode">https://www.npmjs.com/package/qrcode</a> if you're writing in JS -- and <a href="https://github.com/nayuki/QR-Code-generator">https://github.com/nayuki/QR-Code-generator</a>  has a high quality set of libraries in multiple languages (including JS, python, Java, and C)</p>



<a name="239478367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239478367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239478367">(May 19 2021 at 18:57)</a>:</h4>
<p>Lack of support for multi-segment QR generation is a common "gotcha" is less-than-full-featured QR generation libraries.</p>



<a name="239478459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239478459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239478459">(May 19 2021 at 18:58)</a>:</h4>
<p>(On the plus side, all <em>reader</em> libraries we've found can read these QRs.)</p>



<a name="239497078"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239497078" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239497078">(May 19 2021 at 21:15)</a>:</h4>
<p>Small follow up: I looked into moving the QR code generation server-side (we have iOS / Android / Web front-end, so that would make things easier), but cannot find a C# library that support specifying multiple segments and the mode to use for each (or even the mode to use for everything - seems to use always byte)</p>



<a name="239499579"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239499579" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239499579">(May 19 2021 at 21:37)</a>:</h4>
<p><a href="https://codecrete.net/QrCodeGenerator/api/Net.Codecrete.QrCodeGenerator.QrCode.html">https://codecrete.net/QrCodeGenerator/api/Net.Codecrete.QrCodeGenerator.QrCode.html</a> seems to allow a List of segments, each with a mode.</p>
<blockquote>
<p>Mid level: Custom-make a list of QrSegment instances</p>
</blockquote>
<p>This is from <a href="https://www.nuget.org/packages/Net.Codecrete.QrCodeGenerator/">https://www.nuget.org/packages/Net.Codecrete.QrCodeGenerator/</a></p>



<a name="239504384"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239504384" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239504384">(May 19 2021 at 22:24)</a>:</h4>
<p>Thanks (again!) Josh, I'll try that</p>



<a name="239593427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239593427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239593427">(May 20 2021 at 13:44)</a>:</h4>
<p>Got this now:<br>
<a href="/user_uploads/10155/_h6ns2_o2ql06UMRtXg4b5cj/qrcode.png">qrcode.png</a> <br>
...that scans ok and looks to be of the right size, but it still not identical to <a href="https://smarthealth.cards/examples/example-00-g-qr-code-0.svg">https://smarthealth.cards/examples/example-00-g-qr-code-0.svg</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/_h6ns2_o2ql06UMRtXg4b5cj/qrcode.png" title="qrcode.png"><img src="/user_uploads/10155/_h6ns2_o2ql06UMRtXg4b5cj/qrcode.png"></a></div>



<a name="239620845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239620845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239620845">(May 20 2021 at 16:30)</a>:</h4>
<p>If you've got this right data encoded, and the right segments (one with bytes mode for the prefix, and one with numeric mode for the main content) then you should be good to go. There are a couple of underlying reasons why your output might differ from someone else's even for the same data: you may be applying a higher level of error correction (which is okay as long as you fit within a v22 symbol) or your library may be choosing masking patterns differently (this shouldn't happen as far as I know, but I could imagine libraries might be less than perfect on this).</p>



<a name="239779756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/239779756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#239779756">(May 21 2021 at 16:41)</a>:</h4>
<p>John Anyperson for the first QR code, and Ashley Goodwin for the second.</p>
<p><a href="/user_uploads/10155/4vnk8A6F8RYdurrR8E0JlCk2/IMG_8006.PNG">IMG_8006.PNG</a> <a href="/user_uploads/10155/hOGnatk3QNDgIP_9DphKItFT/IMG_8005.PNG">IMG_8005.PNG</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/4vnk8A6F8RYdurrR8E0JlCk2/IMG_8006.PNG" title="IMG_8006.PNG"><img src="/user_uploads/10155/4vnk8A6F8RYdurrR8E0JlCk2/IMG_8006.PNG"></a></div><div class="message_inline_image"><a href="/user_uploads/10155/hOGnatk3QNDgIP_9DphKItFT/IMG_8005.PNG" title="IMG_8005.PNG"><img src="/user_uploads/10155/hOGnatk3QNDgIP_9DphKItFT/IMG_8005.PNG"></a></div>



<a name="240208837"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/240208837" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh V S <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#240208837">(May 25 2021 at 15:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191912">Michele Mottini</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/QR.20code.20generation/near/239593427">said</a>:</p>
<blockquote>
<p>Got this now:<br>
<a href="/user_uploads/10155/_h6ns2_o2ql06UMRtXg4b5cj/qrcode.png">qrcode.png</a> <br>
...that scans ok and looks to be of the right size, but it still not identical to <a href="https://smarthealth.cards/examples/example-00-g-qr-code-0.svg">https://smarthealth.cards/examples/example-00-g-qr-code-0.svg</a></p>
</blockquote>
<p>One thing I noticed is that the health card you shared doesn't have an issuer. See the out put from a scanner app.</p>
<p><a href="/user_uploads/10155/V8fn4ocBHVY6n2tH6u0fTrT2/image.png">image.png</a><br>
<a href="/user_uploads/10155/minp_Zn3Q3zcRdJVcxaqSKEz/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/V8fn4ocBHVY6n2tH6u0fTrT2/image.png" title="image.png"><img src="/user_uploads/10155/V8fn4ocBHVY6n2tH6u0fTrT2/image.png"></a></div><div class="message_inline_image"><a href="/user_uploads/10155/minp_Zn3Q3zcRdJVcxaqSKEz/image.png" title="image.png"><img src="/user_uploads/10155/minp_Zn3Q3zcRdJVcxaqSKEz/image.png"></a></div>



<a name="240210138"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/QR%20code%20generation/near/240210138" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/QR.20code.20generation.html#240210138">(May 25 2021 at 15:59)</a>:</h4>
<p>Yes, the sample I was using does not have an issuer</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
