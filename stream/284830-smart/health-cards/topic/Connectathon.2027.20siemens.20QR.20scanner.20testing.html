---
layout: page
title: "FHIR Chat  · Connectathon 27 siemens QR scanner testing · smart/health-cards"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/index.html">smart/health-cards</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html">Connectathon 27 siemens QR scanner testing</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="239253367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239253367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239253367">(May 18 2021 at 13:28)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="306186">@Vijayendra Prabhakar</span> I'm trying to test out your verifier app, but am getting an unexpected "Signature is invalid" error.</p>
<p>It works with one of the QR codes we've generated, (e.g. <a href="https://connectathon.vci.org/patients/1">https://connectathon.vci.org/patients/1</a>)</p>
<p><a href="/user_uploads/10155/fcoFl4nPcIZu75y7dX7YVZju/Screen-Shot-2021-05-18-at-9.26.48-AM.png">Screen-Shot-2021-05-18-at-9.26.48-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/fcoFl4nPcIZu75y7dX7YVZju/Screen-Shot-2021-05-18-at-9.26.48-AM.png" title="Screen-Shot-2021-05-18-at-9.26.48-AM.png"><img src="/user_uploads/10155/fcoFl4nPcIZu75y7dX7YVZju/Screen-Shot-2021-05-18-at-9.26.48-AM.png"></a></div><p>but not with <a href="https://smarthealth.cards/examples/example-00-g-qr-code-0.svg">the first spec example</a></p>
<p><a href="/user_uploads/10155/CiOs3WaSJVI-dHxzKQV61O7P/Screen-Shot-2021-05-18-at-9.20.01-AM.png">Screen-Shot-2021-05-18-at-9.20.01-AM.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/CiOs3WaSJVI-dHxzKQV61O7P/Screen-Shot-2021-05-18-at-9.20.01-AM.png" title="Screen-Shot-2021-05-18-at-9.20.01-AM.png"><img src="/user_uploads/10155/CiOs3WaSJVI-dHxzKQV61O7P/Screen-Shot-2021-05-18-at-9.20.01-AM.png"></a></div><p>Any ideas on why the spec example QR is failing?</p>



<a name="239253945"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239253945" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Paquin <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239253945">(May 18 2021 at 13:32)</a>:</h4>
<p>(deleted)</p>



<a name="239254017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239254017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239254017">(May 18 2021 at 13:32)</a>:</h4>
<p>This is failing when I try to scan: <a href="https://smarthealth.cards/examples/example-00-g-qr-code-0.svg">https://smarthealth.cards/examples/example-00-g-qr-code-0.svg</a></p>



<a name="239254130"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239254130" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239254130">(May 18 2021 at 13:33)</a>:</h4>
<p>Link to the verifier: <a href="https://smart-health-vault-siemens-healthineers.azurewebsites.net/verifier">https://smart-health-vault-siemens-healthineers.azurewebsites.net/verifier</a></p>



<a name="239254941"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239254941" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vijayendra Prabhakar <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239254941">(May 18 2021 at 13:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197651">Reece Adamson</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239253367">said</a>:</p>
<blockquote>
<p>Hey <span class="user-mention silent" data-user-id="306186">Vijayendra Prabhakar</span> I'm trying to test out your verifier app, but am getting an unexpected "Signature is invalid" error.</p>
<p>It works with one of the QR codes we've generated, (e.g. <a href="https://connectathon.vci.org/patients/1">https://connectathon.vci.org/patients/1</a>)</p>
<p><a href="/user_uploads/10155/fcoFl4nPcIZu75y7dX7YVZju/Screen-Shot-2021-05-18-at-9.26.48-AM.png">Screen-Shot-2021-05-18-at-9.26.48-AM.png</a></p>
<p>but not with <a href="https://smarthealth.cards/examples/example-00-g-qr-code-0.svg">the first spec example</a></p>
<p><a href="/user_uploads/10155/CiOs3WaSJVI-dHxzKQV61O7P/Screen-Shot-2021-05-18-at-9.20.01-AM.png">Screen-Shot-2021-05-18-at-9.20.01-AM.png</a> </p>
<p>Any ideas on why the spec example QR is failing?</p>
</blockquote>
<p>Hey <span class="user-mention" data-user-id="197651">@Reece Adamson</span>  we support only PNGs for the moment and not SVGs.  Also the issuer from the example is not a valid public issuer which is also one of the reasons why it is failing.</p>



<a name="239255333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239255333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239255333">(May 18 2021 at 13:40)</a>:</h4>
<p>I was scanning using the camera on my mac so I don't think that the SVG should be a problem.</p>



<a name="239255653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239255653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Maruthi M <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239255653">(May 18 2021 at 13:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197651">Reece Adamson</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239255333">said</a>:</p>
<blockquote>
<p>I was scanning using the camera on my mac so I don't think that the SVG should be a problem.</p>
</blockquote>
<p>Hi, What vijay was trying say is that, we support only png file selection in verfier.</p>



<a name="239258307"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239258307" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239258307">(May 18 2021 at 14:00)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="386409">@Maruthi M</span> I might be mis-understanding, but I am using the "Scan QR" option, not the "Choose Files Option".</p>



<a name="239259254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239259254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vijayendra Prabhakar <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239259254">(May 18 2021 at 14:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197651">Reece Adamson</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239258307">said</a>:</p>
<blockquote>
<p>Hey <span class="user-mention silent" data-user-id="386409">Maruthi M</span> I might be mis-understanding, but I am using the "Scan QR" option, not the "Choose Files Option".</p>
</blockquote>
<p>Hey <span class="user-mention" data-user-id="197651">@Reece Adamson</span>  we understand what you are doing. The thing is the QR codes from the examples does not contain a valid issuer url. It starts with "<a href="https://smarthealth.cards/examples/issuer">https://smarthealth.cards/examples/issuer</a>" which is not a accessible url from which we could get the  public keys( JWKS)</p>



<a name="239260292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239260292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239260292">(May 18 2021 at 14:13)</a>:</h4>
<p>Ah I see. The public keys do exist at <a href="https://smarthealth.cards/examples/issuer/.well-known/jwks.json">https://smarthealth.cards/examples/issuer/.well-known/jwks.json</a>, but there isn't a requirement that the base <code>iss</code> url resolves. <span class="user-mention" data-user-id="191315">@Josh Mandel</span> not sure if you have any thoughts on this (i.e. does it matter if the <code>iss</code> resolves as long as <code>{iss}/.well-known/jwks.json</code> resolves)?</p>



<a name="239260773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239260773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Paquin <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239260773">(May 18 2021 at 14:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306186">Vijayendra Prabhakar</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239259254">said</a>:</p>
<blockquote>
<p>Hey <span class="user-mention silent" data-user-id="197651">Reece Adamson</span>  we understand what you are doing. The thing is the QR codes from the examples does not contain a valid issuer url. It starts with "<a href="https://smarthealth.cards/examples/issuer">https://smarthealth.cards/examples/issuer</a>" which is not a accessible url from which we could get the  public keys( JWKS)</p>
</blockquote>
<p>The spec examples are properly signed, and the public keys are published <a href="https://smarthealth.cards/examples/issuer/.well-known/jwks.json">here</a> (adding <code>.well-known/jwks.json</code> to the issuer URL.</p>



<a name="239262106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239262106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239262106">(May 18 2021 at 14:24)</a>:</h4>
<blockquote>
<p>there isn't a requirement that the base iss url resolves</p>
</blockquote>
<p>fyi - our iss doesn't resolve to anything as of right now, further, it's unclear what it should resolve to ... a web page explaining stuff?</p>



<a name="239263259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239263259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Paquin <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239263259">(May 18 2021 at 14:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197651">Reece Adamson</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239260292">said</a>:</p>
<blockquote>
<p>Ah I see. The public keys do exist at <a href="https://smarthealth.cards/examples/issuer/.well-known/jwks.json">https://smarthealth.cards/examples/issuer/.well-known/jwks.json</a>, but there isn't a requirement that the base <code>iss</code> url resolves.</p>
</blockquote>
<p>There is no requirement for the issuer URL to resolve.</p>



<a name="239266675"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239266675" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239266675">(May 18 2021 at 14:50)</a>:</h4>
<blockquote>
<p>there isn't a requirement that the base iss url resolves</p>
</blockquote>
<p>It's true there's no <em>requirement</em> for <code>iss</code> itself to resolve, but we do kind of hope/expect that <code>iss</code> represents a consumer-facing recognizable brand (to the extent that the issuer has such a brand). It might be worth adding language to encourage this.</p>



<a name="239267035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239267035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239267035">(May 18 2021 at 14:52)</a>:</h4>
<p>Like, for a pharmacy issuing health cards, the <code>iss</code> could be the pharmacy's public, widely recognized domain. This promotes transparency and trust in linking issuers, so for example even without any formal trust framework you might show a user a message like "This Health Card was issued by <a href="https://mypharmacy.example.org">https://mypharmacy.example.org</a>. Please proceed only if you recognize and trust this issuer." (This a lot harder if the <code>iss</code> is something like "<a href="https://proxy-gateway-01.hc.ec-us.cloud.example.org">https://proxy-gateway-01.hc.ec-us.cloud.example.org</a>")</p>



<a name="239267043"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239267043" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vijayendra Prabhakar <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239267043">(May 18 2021 at 14:52)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="385047">@Christian Paquin</span>  one query here, if iss  is not resolved then how will the verifier access .well-known/jwks.json ?</p>



<a name="239267755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239267755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Paquin <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239267755">(May 18 2021 at 14:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306186">Vijayendra Prabhakar</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239267043">said</a>:</p>
<blockquote>
<p>Hey <span class="user-mention silent" data-user-id="385047">Christian Paquin</span>  one query here, if iss  is not resolved then how will the verifier access .well-known/jwks.json ?</p>
</blockquote>
<p>The full url ending with <code>.well-known/jwks.json</code> must resolve to the issuer key set, but the base one doesn't need to. Just like the spec examples: <code>https://smarthealth.cards/examples/issuer/</code> is 404 but <code>https://smarthealth.cards/examples/issuer/.well-known/jwks.json</code> provides the key set.</p>



<a name="239268290"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239268290" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vijayendra Prabhakar <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239268290">(May 18 2021 at 14:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="385047">Christian Paquin</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239267755">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="306186">Vijayendra Prabhakar</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239267043">said</a>:</p>
<blockquote>
<p>Hey <span class="user-mention silent" data-user-id="385047">Christian Paquin</span>  one query here, if iss  is not resolved then how will the verifier access .well-known/jwks.json ?</p>
</blockquote>
<p>The full url ending with <code>.well-known/jwks.json</code> must resolve to the issuer key set, but the base one doesn't need to. Just like the spec examples: <code>https://smarthealth.cards/examples/issuer/</code> is 404 but <code>https://smarthealth.cards/examples/issuer/.well-known/jwks.json</code> provides the key set.</p>
</blockquote>
<p>Oh ok thanks. Even we are verifying the full url ending with .well-known/jwks.json. Like the one in the example <a href="https://smarthealth.cards/examples/issuer/.well-known/jwks.json">https://smarthealth.cards/examples/issuer/.well-known/jwks.json</a></p>



<a name="239324699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239324699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239324699">(May 18 2021 at 20:56)</a>:</h4>
<p>Just tested the holder and successfully imported a health card as a QR code and then was able to subsequently scan the regenerated QR code and verify the signature. QR codes from the original issuer and on the app are the same</p>
<p>See Patient "Dewayne, Anderson" on the siemens holder. The patient can be found here at the issuer: <a href="https://connectathon.vci.org/patients/14">https://connectathon.vci.org/patients/14</a></p>



<a name="239437276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239437276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239437276">(May 19 2021 at 14:47)</a>:</h4>
<p><span class="user-mention" data-user-id="306186">@Vijayendra Prabhakar</span> I just tested out the multiple QR code scanning with <a href="https://smarthealth.cards/examples/">Example 2 from the spec</a> and was able to get it to successfully scan the 3 QR codes and verify the signature. <a href="/user_uploads/10155/bqYBYmzqDOZnWmdsbmV8tcRC/Screen-Shot-2021-05-19-at-10.44.42-AM.png">Screen-Shot-2021-05-19-at-10.44.42-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/bqYBYmzqDOZnWmdsbmV8tcRC/Screen-Shot-2021-05-19-at-10.44.42-AM.png" title="Screen-Shot-2021-05-19-at-10.44.42-AM.png"><img src="/user_uploads/10155/bqYBYmzqDOZnWmdsbmV8tcRC/Screen-Shot-2021-05-19-at-10.44.42-AM.png"></a></div>



<a name="239437535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239437535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239437535">(May 19 2021 at 14:48)</a>:</h4>
<p>It looks like it still can't verify the second example from the spec. Are these keys manually loaded at the moment (the second example is signed with a different key from the same JWKS)?</p>



<a name="239438624"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239438624" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Paquin <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239438624">(May 19 2021 at 14:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197651">Reece Adamson</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239437535">said</a>:</p>
<blockquote>
<p>It looks like it still can't verify the second example from the spec. Are these keys manually loaded at the moment (the second example is signed with a different key from the same JWKS)?</p>
</blockquote>
<p>What do you call 2nd example? Is is example 01? If so, yes, it is signed by a different key in the jwks (see <a href="https://github.com/smart-on-fhir/health-cards/blob/main/generate-examples/src/index.ts#L18">key selection on line 18</a> of the generation spec, index number selects the key). Examples 00 and 02 are signed by the same key. The key for example 01 contains a x5c field.</p>



<a name="239439572"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239439572" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239439572">(May 19 2021 at 15:00)</a>:</h4>
<p><span class="user-mention" data-user-id="385047">@Christian Paquin</span> Yes, I'm referring to example 01. (e.g. <a href="https://smarthealth.cards/examples/example-01-g-qr-code-0.svg">this QR code</a>)</p>



<a name="239439771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239439771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239439771">(May 19 2021 at 15:01)</a>:</h4>
<p>And what I meant by <em>I</em> can't verify it, I meant that I couldn't verify it using <a href="https://smart-health-vault-siemens-healthineers.azurewebsites.net/verifier">https://smart-health-vault-siemens-healthineers.azurewebsites.net/verifier</a> (sorry if it wasn't clear)</p>



<a name="239441924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239441924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239441924">(May 19 2021 at 15:12)</a>:</h4>
<p>Tested the multiple QRs with the <a href="https://github.com/microsoft/health-cards-validation-SDK">validation-sdk</a> it also looks like there are a few errors/warnings. One that stands out to me is that it looks like the <code>kid</code> for <a href="https://smart-health-issuer.azurewebsites.net/issuer/.well-known/jwks.json">this JWK</a> is not calculated/assigned correctly. I double checked with <a href="https://rubygems.org/gems/health_cards">our Ruby library</a> and which agrees with the validation-sdk as <code>Dcgz_ncijpuFTy9FSiRX_L2tyHIu6KfmQu7ixrPMqzU</code> being the correct thumbprint for the key in the JWK.</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>&gt; node . --path ~/Downloads/smart-health-card-29715b32-d684-45a0-a665-bca0075072e9_0.png --path ~/Downloads/smart-health-card-29715b32-d684-45a0-a665-bca0075072e9_1.png --path ~/Downloads/smart-health-card-29715b32-d684-45a0-a665-bca0075072e9_2.png --type qr

SMART Health Card Validation SDK v1.0.0-1


QR images <span class="o">(</span><span class="m">3</span><span class="o">)</span>
   │
   └─ QR numeric <span class="o">(</span><span class="m">3</span><span class="o">)</span>
         │
         └─ JWS-compact
               │
                 ...
               ├─ Error
               │    · key<span class="o">[</span>996ce4e1-59dc-4390-9666-ccc049a48279<span class="o">]</span>: <span class="s1">'kid'</span> does not match thumbprint <span class="k">in</span> issuer key. expected: Dcgz_ncijpuFTy9FSiRX_L2tyHIu6KfmQu7ixrPMqzU, actual: 996ce4e1-59dc-4390-9666-ccc049a48279
               │    · key<span class="o">[</span>996ce4e1-59dc-4390-9666-ccc049a48279<span class="o">]</span>: <span class="s1">'alg'</span> missing <span class="k">in</span> issuer key
                 ...
</code></pre></div>



<a name="239454023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239454023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vijayendra Prabhakar <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239454023">(May 19 2021 at 16:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197651">Reece Adamson</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239439771">said</a>:</p>
<blockquote>
<p>And what I meant by <em>I</em> can't verify it, I meant that I couldn't verify it using <a href="https://smart-health-vault-siemens-healthineers.azurewebsites.net/verifier">https://smart-health-vault-siemens-healthineers.azurewebsites.net/verifier</a> (sorry if it wasn't clear)</p>
</blockquote>
<p><span class="user-mention" data-user-id="197651">@Reece Adamson</span>  if there are multiple public keys, we were verifying with the first key. This is now being handled to verify with multiple public keys in the key array.</p>



<a name="239454957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239454957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239454957">(May 19 2021 at 16:25)</a>:</h4>
<div class="codehilite"><pre><span></span><code>actual: 996ce4e1-59dc-4390-9666-ccc049a48279
               │    · key[996ce4e1-59dc-4390-9666-ccc049a48279]: &#39;alg&#39; missing in issuer key
</code></pre></div>
<p>Yeah, looks like a UUID slipped in here as a <code>kid</code>.</p>



<a name="239456040"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239456040" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vijayendra Prabhakar <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239456040">(May 19 2021 at 16:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing/near/239454957">said</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code>actual: 996ce4e1-59dc-4390-9666-ccc049a48279
               │    · key[996ce4e1-59dc-4390-9666-ccc049a48279]: &#39;alg&#39; missing in issuer key
</code></pre></div>
<p>Yeah, looks like a UUID slipped in here as a <code>kid</code>.</p>
</blockquote>
<p><span class="user-mention" data-user-id="197651">@Reece Adamson</span>  <span class="user-mention" data-user-id="191315">@Josh Mandel</span>  Please dont worry about this because this is one of the smart cards that we have imported to test our issuer API that we created as a POC.</p>



<a name="239456997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Connectathon%2027%20siemens%20QR%20scanner%20testing/near/239456997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Connectathon.2027.20siemens.20QR.20scanner.20testing.html#239456997">(May 19 2021 at 16:38)</a>:</h4>
<p>Got it. Just so you are aware the <code>kid</code> is incorrect in the <a href="https://smart-health-issuer.azurewebsites.net/issuer/.well-known/jwks.json">hosted JWK</a> as well.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
