---
layout: page
title: "FHIR Chat  · Public key · smart/health-cards"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/index.html">smart/health-cards</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html">Public key</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="237251770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237251770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Whitney <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237251770">(May 04 2021 at 00:37)</a>:</h4>
<p>We're leveraging AWS KMS to create the necessary asymmetric key in order to sign the smart card. How can I go from this:</p>
<p>-----BEGIN PUBLIC KEY-----<br>
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEVo94oTHAMQIFSajYapXtx7WzuoY7<br>
8WHnDPtREwrTbT3BIRK6vKUdFIq+FRiyrHtaYnOgoba7yLrT3aWggXIggw==<br>
-----END PUBLIC KEY-----</p>
<p>to this format:</p>
<p>{<br>
  "kty": "EC",<br>
  "use": "sig",<br>
  "crv": "P-256",<br>
  "kid": "1234",<br>
  "x": "oBUyo8CQAFPeYPvv78ylh5MwFZjTCLQeb042TjiMJxE=",<br>
  "y": "vvQyxZkUjJQUPU/0bCy3Pj5qQdfu8jwEfqEeYGZ95CU=",<br>
  "alg": "ES256"<br>
}</p>
<p>Also, is it possible to generate the sha256 _public_ key fingerprint or would I need the private key to do so?</p>
<p>Thanks</p>



<a name="237253091"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237253091" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237253091">(May 04 2021 at 00:55)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="179170" href="/#narrow/stream/179170-smart/topic/Public.20key">#smart &gt; Public key</a> by <span class="user-mention silent" data-user-id="191315">Josh Mandel</span></p>



<a name="237253156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237253156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Whitney <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237253156">(May 04 2021 at 00:56)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="191315">@Josh Mandel</span></p>



<a name="237253175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237253175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237253175">(May 04 2021 at 00:56)</a>:</h4>
<p>The sha256 thumbprint can be calculated from the public JWK alone. To get a JWK the keywords you want are: "convert from PEM to JWK".</p>



<a name="237253267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237253267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237253267">(May 04 2021 at 00:58)</a>:</h4>
<p>Depending on your language of choice, <a href="https://www.jvt.me/posts/2019/01/10/x509-pkcs8-pem-key-to-jwks-node/">https://www.jvt.me/posts/2019/01/10/x509-pkcs8-pem-key-to-jwks-node/</a> may be a helpful tutorial</p>



<a name="237255277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237255277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Whitney <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237255277">(May 04 2021 at 01:25)</a>:</h4>
<p>Sweet! Output:<br>
{<br>
    "keys": [<br>
        {<br>
            "kty": "EC",<br>
            "kid": "HEEpaVqRJ8y4OCE7BKnqEPo-eCz44JpF_quM609TRDw",<br>
            "crv": "P-256",<br>
            "x": "Tg3UZ-kOp8kZV_okaO_MaEGzLfPykGoKTvCW-3hZT2A",<br>
            "y": "PconlrnIFK6Jh_cA1ejeaQ5AuQ4rDAJ-KiZY4TX7vdE"<br>
        }<br>
    ]<br>
}</p>
<p>Is this sufficient to add to .well-known/jwks.json?</p>
<p>Thanks again <span class="user-mention" data-user-id="191315">@Josh Mandel</span></p>



<a name="237257451"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237257451" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237257451">(May 04 2021 at 01:55)</a>:</h4>
<p>Looks pretty good, though it's missing <code>alg</code> and <code>use</code> -- the validation SDK at <a href="https://smarthealth.cards/#what-testing-tools-are-available-to-validate-smart-health-cards-implementations">https://smarthealth.cards/#what-testing-tools-are-available-to-validate-smart-health-cards-implementations</a> will review this for you in detail.</p>



<a name="237322822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237322822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Paquin <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237322822">(May 04 2021 at 13:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="269724">Stephen Whitney</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Public.20key/near/237251770">said</a>:</p>
<blockquote>
<p>Also, is it possible to generate the sha256 _public_ key fingerprint or would I need the private key to do so?</p>
</blockquote>
<p>The key fingerprint <code>kid</code> only depends on the fields <code>crv</code>, <code>kty</code>, <code>x</code>, and <code>y</code> (see <a href="https://tools.ietf.org/html/rfc7638#section-3.2">section 3.2 of RFC7638</a>), so you can generate this from the public key.  What platform/ language are you using for development? There should be a library handy to convert a PEM-formatted key into a JWK, and also calculate the <code>kid</code>.</p>



<a name="237335144"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237335144" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Whitney <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237335144">(May 04 2021 at 14:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="385047">Christian Paquin</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Public.20key/near/237322822">said</a>:</p>
<div class="codehilite"><pre><span></span><code>The key fingerprint `kid` only depends on the fields `crv`, `kty`, `x`, and `y` (see [section 3.2 of RFC7638](https://tools.ietf.org/html/rfc7638#section-3.2)), so you can generate this from the public key.  What platform/ language are you using for development? There should be a library handy to convert a PEM-formatted key into a JWK, and also calculate the `kid`.
</code></pre></div>
<p>Thanks <span class="user-mention" data-user-id="385047">@Christian Paquin</span>. We're using python as our development language. I'm not sure python-jose or pyjwt will convert PEM-formatted key into a JWK so I used Node as mentioned by Josh to generate the JWK outside of our codebase.</p>



<a name="237336518"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237336518" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237336518">(May 04 2021 at 14:44)</a>:</h4>
<p><span class="user-mention" data-user-id="365368">@James Kizer</span> or <span class="user-mention" data-user-id="391350">@Alan Viars</span>  may be able to point to some reference code in python as well. We should create a wiki page with links to these kinds of reference examples, because I think people find them pretty helpful.</p>



<a name="237355825"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237355825" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alan Viars <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237355825">(May 04 2021 at 16:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Public.20key/near/237336518">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="365368">James Kizer</span> or <span class="user-mention silent" data-user-id="391350">Alan Viars</span>  may be able to point to some reference code in python as well. We should create a wiki page with links to these kinds of reference examples, because I think people find them pretty helpful.</p>
</blockquote>
<p>Here is my fork of James' code: <a href="https://github.com/TransparentHealth/healthcards_python_sample_scripts">https://github.com/TransparentHealth/healthcards_python_sample_scripts</a>   The only changes I made were: 1. to make this pip installable,  2.make scripts get installed as scripts, 3.) to make shc a package module for easy import.  I see I should update the README too.  To install with pip just type "pip install shc".  The code in each files "def main():" should provide adequate examples for use.  I made the pip/package so I could do a simple import into my Django-based implementation.</p>



<a name="237361893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/284830-smart/health-cards/topic/Public%20key/near/237361893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Denning <a href="https://fhir.github.io/chat-archive/stream/284830-smart/health-cards/topic/Public.20key.html#237361893">(May 04 2021 at 17:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/284830-smart.2Fhealth-cards/topic/Public.20key/near/237336518">said</a>:</p>
<div class="codehilite"><pre><span></span><code>We should create a wiki page with links to these kinds of reference examples ...
</code></pre></div>
<p><a href="https://confluence.hl7.org/display/PHWG/SMART+Health+Cards+Implementation+Tools">https://confluence.hl7.org/display/PHWG/SMART+Health+Cards+Implementation+Tools</a> added</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
