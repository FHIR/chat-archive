---
layout: page
title: "FHIR Chat  · ✔ HL7 Validator: StructDef.differential.MustSupport=false · tooling"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/index.html">tooling</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/.E2.9C.94.20HL7.20Validator.3A.20StructDef.2Edifferential.2EMustSupport.3Dfalse.html">✔ HL7 Validator: StructDef.differential.MustSupport=false</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="273172859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/%E2%9C%94%20HL7%20Validator%3A%20StructDef.differential.MustSupport%3Dfalse/near/273172859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ken Sinn <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/.E2.9C.94.20HL7.20Validator.3A.20StructDef.2Edifferential.2EMustSupport.3Dfalse.html#273172859">(Feb 25 2022 at 01:15)</a>:</h4>
<p>If a profile (StructDef) declares only a Differential without a Snapshot, and there is an element where differential.element[x].mustSupport=false, HL7 Validator will generate the following error when loading the profile as part of the IG:</p>
<blockquote>
<p>Get set... Unable to generate snapshot for ca-on-ps-profile-procedure from Procedure because Profile ProcedurePSON  (<a href="http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure">http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure</a>), element Procedure (PS-ON).Procedure.bodySite. Error generating snapshot: Illegal constraint [must-support = false] when [must-support = true] in the base profile<br>
org.hl7.fhir.exceptions.DefinitionException: Profile ProcedurePSON (<a href="http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure">http://ontariohealth.ca/fhir/StructureDefinition/ca-on-ps-profile-procedure</a>), element Procedure (PS-ON).Procedure.bodySite. Error generating snapshot: Illegal constraint [must-support = false] when [must-support = true] in the base profile<br>
       at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:819)<br>
       at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:786)<br>
       at org.hl7.fhir.r5.context.SimpleWorkerContext.allStructures(SimpleWorkerContext.java:669)<br>
      at org.hl7.fhir.validation.ValidationEngine.prepare(ValidationEngine.java:606)<br>
       at org.hl7.fhir.validation.cli.services.ValidationService.initializeValidator(ValidationService.java:359)<br>
       at org.hl7.fhir.validation.cli.services.ValidationService.initializeValidator(ValidationService.java:310)<br>
       at org.hl7.fhir.validation.ValidatorCli.doValidation(ValidatorCli.java:238)<br>
     at org.hl7.fhir.validation.ValidatorCli.main(ValidatorCli.java:164)</p>
</blockquote>
<p>Note that the profile is NOT derived from another profile, despite the error message (see <a href="https://simplifier.net/ON-PatientSummary/ProcedurePSON/~json">https://simplifier.net/ON-PatientSummary/ProcedurePSON/~json</a>). In this case, the Procedure.bodysite has been declared with MustSupport = False in the differential.</p>



<a name="273172954"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/%E2%9C%94%20HL7%20Validator%3A%20StructDef.differential.MustSupport%3Dfalse/near/273172954" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ken Sinn <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/.E2.9C.94.20HL7.20Validator.3A.20StructDef.2Edifferential.2EMustSupport.3Dfalse.html#273172954">(Feb 25 2022 at 01:17)</a>:</h4>
<p>This was on FHIR Validation tool Version 5.6.35 (Git# 685ea98d37c9)., running with -version 4.0.1</p>



<a name="273173936"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/%E2%9C%94%20HL7%20Validator%3A%20StructDef.differential.MustSupport%3Dfalse/near/273173936" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/.E2.9C.94.20HL7.20Validator.3A.20StructDef.2Edifferential.2EMustSupport.3Dfalse.html#273173936">(Feb 25 2022 at 01:33)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="192143">@Ken Sinn</span> , I think you may be getting your error because Procedure.bodySite is profiled to use CodeableConcept (PS-ON) which is must-support on it's root element, which turns bodySite into MS = true. You're essentially saying that the element is both MS and not MS.</p>
<p>I also suspect the PS-ON CodeableConcept root element is MS because you copied it from IPS. As you know IPS will be removing many of their MS flags. There is also a pending JIRA ticket (<a href="http://jira.hl7.org/browse/FHIR-34347">J#34347</a>) to clarify adding MS to a root element is against best practice. I suggest you remove the MS flag from PS-ON CodeableConcept (and if needed add it back to <strong>uses</strong> of PS-ON CodedableConcept).</p>



<a name="273174392"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/%E2%9C%94%20HL7%20Validator%3A%20StructDef.differential.MustSupport%3Dfalse/near/273174392" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ken Sinn <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/.E2.9C.94.20HL7.20Validator.3A.20StructDef.2Edifferential.2EMustSupport.3Dfalse.html#273174392">(Feb 25 2022 at 01:41)</a>:</h4>
<p>Got it. Thanks <span class="user-mention" data-user-id="191380">@Elliot Silver</span> - that would explain some of the inconsistent behaviour I'm seeing.</p>



<a name="273174396"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/%E2%9C%94%20HL7%20Validator%3A%20StructDef.differential.MustSupport%3Dfalse/near/273174396" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/.E2.9C.94.20HL7.20Validator.3A.20StructDef.2Edifferential.2EMustSupport.3Dfalse.html#273174396">(Feb 25 2022 at 01:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="192143">Ken Sinn</span> has marked this topic as resolved.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
