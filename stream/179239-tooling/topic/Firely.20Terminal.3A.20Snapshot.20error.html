---
layout: page
title: "FHIR Chat  · Firely Terminal: Snapshot error · tooling"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/index.html">tooling</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/Firely.20Terminal.3A.20Snapshot.20error.html">Firely Terminal: Snapshot error</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="274131011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/Firely%20Terminal%3A%20Snapshot%20error/near/274131011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Declan Kieran <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/Firely.20Terminal.3A.20Snapshot.20error.html#274131011">(Mar 04 2022 at 13:52)</a>:</h4>
<p>Hi, I was able to generate a snapshot from a r4 StructureDefinition with only a diiferential by</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>fhir install hl7.fhir.r4.core
fhir push &lt;sd_file&gt;
fhir snapshot
</code></pre></div>
<p>I then tried to generate one for an stu3 StructureDefinition by doing</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>fhir install hl7.fhir.r3.core
fhir push &lt;sd_file&gt;
fhir snapshot
</code></pre></div>
<p>but I'm then I got an error</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>One or more errors occurred. <span class="o">(</span>While building a POCO: Literal <span class="s1">'3.0.2'</span> is not a valid value <span class="k">for</span> enumeration <span class="s1">'FHIRVersion'</span> <span class="o">(</span>as StructureDefinition.fhirVersion<span class="o">[</span><span class="m">0</span><span class="o">]))</span>
</code></pre></div>
<p>So I tried going back to see if I could still generate the R4 snapshot and I'm still getting the same error, even after removing the r3 package to remove it from the scope</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>fhir uninstall hl7.fhir.r3.core
</code></pre></div>
<p>It seems my install is in a bad state, is there an easy way to reset it, is there local files I could clear to reset it to fresh?</p>



<a name="274697828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/Firely%20Terminal%3A%20Snapshot%20error/near/274697828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/Firely.20Terminal.3A.20Snapshot.20error.html#274697828">(Mar 09 2022 at 14:49)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="456074">@Declan Kieran</span>, a few pointers:</p>
<ul>
<li>Firely Terminal has a setting for the current FHIR version you are working with, which you can see with <code>fhir spec</code>.  Try setting that to the desired FHIR version with <code>fhir spec R3</code> etc.</li>
<li>With <code>fhir scope</code> you can see what packages are currently installed in the scope. You can also see in the package.json file in a folder what packages are set as dependencies for this scope, restore them (install them) with <code>fhir restore</code> and in fhirpkg.lock.json you can see the results of that. Try not to mix different FHIR versions in one folder.</li>
<li><code>fhir cache</code> shows all packages installed in your global FHIR package cache (or find them on disk: <a href="https://confluence.hl7.org/display/FHIR/FHIR+Package+Cache">https://confluence.hl7.org/display/FHIR/FHIR+Package+Cache</a>). You can safely delete them since they will be re-downloaded. But in this case, I don't expect the issue to be there.</li>
<li>With <code>fhir stack</code> you can see what you currently have on the stack, to make sure it's the resource you expect.</li>
</ul>



<a name="274707019"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/Firely%20Terminal%3A%20Snapshot%20error/near/274707019" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Declan Kieran <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/Firely.20Terminal.3A.20Snapshot.20error.html#274707019">(Mar 09 2022 at 15:51)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="203235">@Ward Weistra</span> </p>
<p>I had checked fhir spec, and also tried restore as well as bake and unbake in various combinations.  I also did have a look at the cache output and it seemed like the packages were being recognised ok.  <span class="user-mention" data-user-id="192158">@Dave Barnet</span> is going to raise an issue with the files that are mentioned below.</p>
<hr>
<p><strong>Debian11 error</strong></p>
<p>dotget sdks installed </p>
<p>dotnet --list-sdks<br>
3.1.416 [/usr/share/dotnet/sdk]<br>
6.0.200 [/usr/share/dotnet/sdk]</p>
<p>fhir scope<br>
hl7.fhir.r4.core 4.0.1</p>
<p>fhir push UKCoreAllergyIntolerance.json<br>
fhir snapshot</p>
<p>fhir snapshot<br>
Fhir version  cannot be determined</p>
<p>Two spaces between 'version' and 'cannot' are as is</p>
<hr>
<p><strong>Windows error</strong></p>
<p>Snapshot was generated for UKCoreAllergyIntolerance.json, although I've a different set of sdk's installed on the windows machine</p>
<p>dotnet --list-sdks <br>
3.1.416 [C:\Program Files\dotnet\sdk]<br>
3.1.416 [C:\Program Files\dotnet\sdk]<br>
5.0.102 [C:\Program Files\dotnet\sdk]<br>
5.0.102 [C:\Program Files\dotnet\sdk]<br>
5.0.400 [C:\Program Files\dotnet\sdk]<br>
5.0.400 [C:\Program Files\dotnet\sdk]</p>
<p>Procedure followed as before</p>
<p>Then tried to generate a snapshot for a version 3.0 resource</p>
<p>I removed hl7.fhir.r4.core</p>
<p>fhir remove hl7.fhir.r4.core</p>
<p>and installed hl7.fhir.r4.core</p>
<p>fhir install hl7.fhir.r3.core</p>
<p>Followed procedure as before and got error </p>
<p>One or more errors occurred. (While building a POCO: Literal '3.0.2' is not a valid value for enumeration 'FHIRVersion' (as StructureDefinition.fhirVersion[0]))</p>
<p>Now when trying to go back and generate the first snaphot, I get the same error.</p>



<a name="274807077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/Firely%20Terminal%3A%20Snapshot%20error/near/274807077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/Firely.20Terminal.3A.20Snapshot.20error.html#274807077">(Mar 10 2022 at 09:03)</a>:</h4>
<p><span class="user-mention" data-user-id="456074">@Declan Kieran</span> Perfect we'll take them from there.<br>
In your Windows ticket: It seems from the description as you are trying to create a R4 (with success) and STU3 (with error) snapshot both from the same UKCoreAllergyIntolerance resource?</p>



<a name="274811398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/Firely%20Terminal%3A%20Snapshot%20error/near/274811398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Declan Kieran <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/Firely.20Terminal.3A.20Snapshot.20error.html#274811398">(Mar 10 2022 at 09:46)</a>:</h4>
<p><span class="user-mention" data-user-id="203235">@Ward Weistra</span>  Ah sorry, I never mentioned that in the description.  It was for the CareConnect-AllergyIntolerance-1 profile </p>
<p><a href="https://simplifier.net/hl7fhircareconnectbaselineforstu3/careconnect-allergyintolerance-1">https://simplifier.net/hl7fhircareconnectbaselineforstu3/careconnect-allergyintolerance-1</a></p>
<p>Which has a snapshot, but I had removed just to test it.  The ticket that was raised included the StructureDefintion that was used, where the snapshot was removed.   I've attached the files here, which also has the badly word description!  <a href="/user_uploads/10155/kGGBPtLROPAX_y0W33vOLUgY/firely.terminal-issues.zip">firely.terminal-issues.zip</a></p>



<a name="274811598"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/Firely%20Terminal%3A%20Snapshot%20error/near/274811598" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Declan Kieran <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/Firely.20Terminal.3A.20Snapshot.20error.html#274811598">(Mar 10 2022 at 09:48)</a>:</h4>
<p>Once I had tried to generate a snapshot for CareConnect-AllergyIntolerance-1, I was unable to then generate it again for UKCoreAllergyIntolerance, even after using clear, restore, unbake and removing and reinstalling the packages.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
