---
layout: page
title: "FHIR Chat  · packages: index.json · tooling"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/index.html">tooling</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html">packages: index.json</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="259261765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259261765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259261765">(Oct 27 2021 at 15:58)</a>:</h4>
<p>Couple of questions regarding index.json of the <a href="https://confluence.hl7.org/display/FHIR/NPM+Package+Specification#NPMPackageSpecification-.index.json">FHIR packages spec</a> :</p>
<p>In the dotnet package tooling, we have been struggling with returning the right file when searching a package by canonicalUrl:<br>
In this case we have a package that has dependencies to <code>hl7.fhir.r3.core</code> and <code>hl7.fhir.r3.expansions</code>. <br>
When searching for a valueset, say: <code>administrative-gender</code>, we would like to return the expanded ValueSet, but there is currently no way to know based on the <code> index.json</code> file, both files would look exactly the same index.json.<br>
The same goes for the theoretical case where there are dependencies to multiple packages containing the same StructureDefinition, one with a snapshot, and one without, we would always like to return the snapshot one, but there is no way to know.</p>
<p>Therefor I'd like to suggest to add the following fields to index.json:</p>
<ul>
<li><code>hasSnapshot</code> - a boolean stating whether a file contains a snapshot or not</li>
<li><code>hasExpansion</code> - a boolean stating wether a file is a valueset that has been expanded</li>
</ul>
<p>When looking at the <a href="https://confluence.hl7.org/display/FHIR/NPM+Package+Specification#NPMPackageSpecification-.index.json">confluence page</a> : I see each folder needs a index.json, I think it would be better if we have 1 index for the whole package, but it's probably too late for that. It also states that examples are found in a sibling folder, but looking at the existing packages, I see both sibling and child folders named <code>example</code>, or <code>openapi</code>, and <code>other</code>. I think the child folders are better in this case, shall I update it on the page?</p>
<p>Also, I don't think the current version of index.json has <code>index-version</code> 1 right? What's the latest version? And what does it look like? I'm willing to update the documentation myself if someone can tell me what the latest version looks like.</p>



<a name="259442100"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259442100" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259442100">(Oct 28 2021 at 19:46)</a>:</h4>
<p>i think it's a bad idea to have dependencies on both hl7.fhir.r3.core and hl7.fhir.r3.expansions. the expansions package was only published as a convenience to code generators, and shouldn't be a dependency anywhere.</p>



<a name="259442162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259442162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259442162">(Oct 28 2021 at 19:47)</a>:</h4>
<p>It's certainly not a replacement for a terminology service that generates expansions on request</p>



<a name="259442337"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259442337" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259442337">(Oct 28 2021 at 19:48)</a>:</h4>
<p>but if we're going to put expansion in .index.json, we should put the expansion id, since there could be more than one expansion per value set</p>



<a name="259442382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259442382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259442382">(Oct 28 2021 at 19:48)</a>:</h4>
<p>is there any rationale use case for having both with and without a snapshot? I can't think of any</p>



<a name="259442468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259442468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259442468">(Oct 28 2021 at 19:49)</a>:</h4>
<p>I agree that it's too late to have just one .index.json file for the entire package</p>



<a name="259442693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259442693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259442693">(Oct 28 2021 at 19:51)</a>:</h4>
<p>and please update the documentation - originally we said sibling folders, but we realised a few years ago that wasn't valid against the NPM spec, and so we had to change to child folders. I thought we updated the documentation at the time</p>



<a name="259442778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259442778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259442778">(Oct 28 2021 at 19:51)</a>:</h4>
<p>I don't understand the question about index-version?</p>



<a name="259489680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259489680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259489680">(Oct 29 2021 at 07:09)</a>:</h4>
<p>But we have to run the $expand operation everytime we want to access to actual codes from a ValueSet then? I don't think that's good practice at all. Packages are supposed the be frozen right? But you can get different outcomes each time you run $expand. Same would be to be running the snapshot generator each time, doesn't seem good practice either.</p>



<a name="259489821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259489821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259489821">(Oct 29 2021 at 07:11)</a>:</h4>
<p>I don't know if there is any use for having profiles with and without snapshots, but it's probably going to happen somewhere and I want to prepare for it.</p>



<a name="259489844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259489844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259489844">(Oct 29 2021 at 07:11)</a>:</h4>
<p>I'll update the documentaton about the sibling/child folders</p>



<a name="259489973"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259489973" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259489973">(Oct 29 2021 at 07:13)</a>:</h4>
<p>The question about index-version: What's the latest version? Is it still 1? Just like it says on the confluence page? Or have there been undocumented changes already? If so, what are they, and which version are we now on?</p>



<a name="259515097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259515097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259515097">(Oct 29 2021 at 12:09)</a>:</h4>
<blockquote>
<p>But we have to run the $expand operation everytime we want to access to actual codes from a ValueSet then? I don't think that's good practice at all.</p>
</blockquote>
<p>No, it's extremely necessary practice. The definition of the value set will define whether you should get different outcomes or not, and the terminology server better be reliable.</p>



<a name="259515214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259515214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259515214">(Oct 29 2021 at 12:10)</a>:</h4>
<p>and which one will you choose if you find multiple different expansions? How will you know which one matches the expansion conditions that you've been asked for? You need a terminology server, not to try to solve this in the packaging system</p>



<a name="259515256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259515256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259515256">(Oct 29 2021 at 12:11)</a>:</h4>
<p>I'm still not convinced about snapshots. Why would it be done when you can just remove the snapshot it you want one without</p>



<a name="259515456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259515456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259515456">(Oct 29 2021 at 12:13)</a>:</h4>
<p>index-version: still "1" - the last change we made was the addition of the supplements flag, and that didn't cause an increment in the version</p>



<a name="259531393"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/259531393" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#259531393">(Oct 29 2021 at 14:22)</a>:</h4>
<p>I totally agree that the use case of adding just profiles without snapshots. I even think that shouldn't be allowed. But then again, I can see this happening, and I want to make sure that I select the profile with the snapshot instead of the one without.</p>



<a name="260356413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/260356413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#260356413">(Nov 05 2021 at 01:22)</a>:</h4>
<p>so where are we with this? we could register ValueSet.expansion.identifier in the .index.json, but I don't think it's going to do much good. you need the parameters</p>



<a name="260376255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179239-tooling/topic/packages%3A%20index.json/near/260376255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179239-tooling/topic/packages.3A.20index.2Ejson.html#260376255">(Nov 05 2021 at 08:19)</a>:</h4>
<p>After reading your arguments, I think we don't need to change anything right now. We'll solve it in a different way. Thanks!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
