---
layout: page
title: "FHIR Chat  · Extension on effective with FHIR Mapping Language · mapping-framework"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/index.html">mapping-framework</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Extension.20on.20effective.20with.20FHIR.20Mapping.20Language.html">Extension on effective with FHIR Mapping Language</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="233021582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Extension%20on%20effective%20with%20FHIR%20Mapping%20Language/near/233021582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Dimitrov <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Extension.20on.20effective.20with.20FHIR.20Mapping.20Language.html#233021582">(Apr 03 2021 at 18:00)</a>:</h4>
<p>Hello, I'm trying to map the data-absent-reason extension on the effective Element from the IPS profile with the FHIR mapping language: <br>
<a href="/user_uploads/10155/sWR9A26PDR-FOjwhrNM12ifd/Bildschirmfoto-2021-04-03-um-19.50.14.png">Bildschirmfoto-2021-04-03-um-19.50.14.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/sWR9A26PDR-FOjwhrNM12ifd/Bildschirmfoto-2021-04-03-um-19.50.14.png" title="Bildschirmfoto-2021-04-03-um-19.50.14.png"><img src="/user_uploads/10155/sWR9A26PDR-FOjwhrNM12ifd/Bildschirmfoto-2021-04-03-um-19.50.14.png"></a></div><p>I'm not really sure how exactly to do this, but here is how I tried:</p>
<div class="codehilite"><pre><span></span><code>src -&gt; tgt.effective = create(&#39;extension&#39;) as dataAbsentReason
</code></pre></div>
<p>Unfortunately, I am getting the following error:</p>
<div class="codehilite"><pre><span></span><code>&lt;diagnostics value=&quot;Failed to call access method: org.hl7.fhir.exceptions.FHIRException: Exception executing transform tgt.effective = create(&#39;extension&#39;) as dataAbsentReason on Rule &amp;quot;effectiveTime-width&amp;quot;: null&quot;&gt;&lt;/diagnostics&gt;
</code></pre></div>
<p>Does anyone know how to fill the data-absent-reason extension on effective with the FHIR Mapping Language? Thanks in advance!</p>



<a name="233026848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Extension%20on%20effective%20with%20FHIR%20Mapping%20Language/near/233026848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Extension.20on.20effective.20with.20FHIR.20Mapping.20Language.html#233026848">(Apr 03 2021 at 19:25)</a>:</h4>
<p>can you provide the map somewhere? I think you are a level to high, maybe try:</p>
<div class="codehilite"><pre><span></span><code>src -&gt; tgt.effective = create(&#39;Period&#39;) as effective, effective.extension as dataAbsenReson, ...
</code></pre></div>



<a name="233064003"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Extension%20on%20effective%20with%20FHIR%20Mapping%20Language/near/233064003" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Dimitrov <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Extension.20on.20effective.20with.20FHIR.20Mapping.20Language.html#233064003">(Apr 04 2021 at 07:41)</a>:</h4>
<p>thanks for the help <span class="user-mention" data-user-id="191478">@Oliver Egger</span>, I changed the rule to the following and it seems to be generating it correctly now:</p>
<div class="codehilite"><pre><span></span><code>substanceAdministration.effectiveTime as effectiveTime where (width.where(value.exists())) -&gt; tgt.effective = create(&#39;Period&#39;) as effective then {
                effectiveTime.width as width -&gt; effective.extension as dataabsentReason, dataabsentReason.url = &#39;http://hl7.org/fhir/StructureDefinition/data-absent-reason&#39;, dataabsentReason.value = create(&#39;code&#39;) as code then {
                    width -&gt; code.value = &#39;unknown&#39; &quot;code-value&quot;;
                }&quot;coding&quot;;
            }&quot;effectiveTime-width&quot;;
</code></pre></div>
<p>Snippet of the generated resource:</p>
<p><a href="/user_uploads/10155/mqtoCqxd1WDRibfN6rOsO4PG/Bildschirmfoto-2021-04-04-um-09.40.21.png">Bildschirmfoto-2021-04-04-um-09.40.21.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/mqtoCqxd1WDRibfN6rOsO4PG/Bildschirmfoto-2021-04-04-um-09.40.21.png" title="Bildschirmfoto-2021-04-04-um-09.40.21.png"><img src="/user_uploads/10155/mqtoCqxd1WDRibfN6rOsO4PG/Bildschirmfoto-2021-04-04-um-09.40.21.png"></a></div>



<a name="233067588"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Extension%20on%20effective%20with%20FHIR%20Mapping%20Language/near/233067588" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Extension.20on.20effective.20with.20FHIR.20Mapping.20Language.html#233067588">(Apr 04 2021 at 08:59)</a>:</h4>
<p><span class="user-mention" data-user-id="367809">@Alexander Dimitrov</span>  now you only have to decide if you want to have an effectivePeriod or an effectiveDateTime which is unknown <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
