---
layout: page
title: "FHIR Chat  · Unable to find StructureDefinition for target type · mapping-framework"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/index.html">mapping-framework</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Unable.20to.20find.20StructureDefinition.20for.20target.20type.html">Unable to find StructureDefinition for target type</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="239803747"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Unable%20to%20find%20StructureDefinition%20for%20target%20type/near/239803747" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Unable.20to.20find.20StructureDefinition.20for.20target.20type.html#239803747">(May 21 2021 at 19:47)</a>:</h4>
<p>Hi, I am trying to transform a QuestionnaireResponse (QR) into a US Core Patient Resource (<a href="https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-patient.html">https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-patient.html</a>). <br>
Before this, I had a StructureMap that would transform the QR into a Patient resource (<a href="https://www.hl7.org/fhir/patient.html">https://www.hl7.org/fhir/patient.html</a>).<br>
From some examples of mapping files + "<a href="https://www.hl7.org/fhir/mapping-language.html">https://www.hl7.org/fhir/mapping-language.html</a>", I think the solution is to change the structure definition resources in my mapping file.<br>
Originally I had "uses "<a href="http://hl7.org/fhir/StructureDefinition/Patient">http://hl7.org/fhir/StructureDefinition/Patient</a>" as target"<br>
Which I changed to "uses "<a href="http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient">http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</a>" alias usCorePatient as target"<br>
However after converting to a StructureMap and using that StructureMap with the FHIR validator to transform the QR, I get the error</p>
<div class="codehilite"><pre><span></span><code>Unable to find StructureDefinition for target type (&#39;http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient&#39;)
org.hl7.fhir.exceptions.FHIRException: Unable to find StructureDefinition for target type (&#39;http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient&#39;)
</code></pre></div>
<p>I found one post which may be relevant (<a href="#narrow/stream/179170-smart/topic/US-Core.20profiles.20for.20validation">https://chat.fhir.org/#narrow/stream/179170-smart/topic/US-Core.20profiles.20for.20validation</a>), and that post mentions "You can't necessarily expect most servers to have awareness of the US Core profiles - even if they support SMART on FHIR", but I'm not sure what servers are involved with the transformation I am trying to do.<br>
EDIT: After reading some output of the FHIR validator, namely "Terminology server <a href="http://tx.fhir.org">http://tx.fhir.org</a>", would this be the server the validator is using for StructureDefintions and that this server "does not have awarness of the US Core profiles" as such the comment from before?</p>



<a name="239807643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Unable%20to%20find%20StructureDefinition%20for%20target%20type/near/239807643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Unable.20to.20find.20StructureDefinition.20for.20target.20type.html#239807643">(May 21 2021 at 20:18)</a>:</h4>
<p>From a transformation perspective, you're fine using the base 'Patient' StructureDefinition.  us-core-patient adds constraints, but doesn't change the structure - and then you don't have to worry about making the StructureMap execution engine aware of the profile.  (It's probably possible, but there's no real value in doing it.)</p>



<a name="239809107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Unable%20to%20find%20StructureDefinition%20for%20target%20type/near/239809107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Unable.20to.20find.20StructureDefinition.20for.20target.20type.html#239809107">(May 21 2021 at 20:31)</a>:</h4>
<p>I'm trying to set the birthsex field (since it's a field for us-core-patient) while using the base 'Patient' StructureDefinition with the mapping rule</p>
<div class="codehilite"><pre><span></span><code>src -&gt; patient.birthsex = &#39;male&#39;;
</code></pre></div>
<p>This results in the following error</p>
<div class="codehilite"><pre><span></span><code>Exception in thread &quot;main&quot; java.lang.Error: Cannot set property birthsex on null
</code></pre></div>
<p>and I am not sure if it is due to me using the base 'Patient' StructureDefinition or if my rule is incorrectly written.<br>
I know 'src -&gt; patient.gender = 'male'' works and both the .gender for Patient and .birthsex for us-core-patient are of type code so that's why I used that syntax.<br>
However, I wanted to confirm what you mean is that since the structure is not changed between Patient and us-core-patient (as in us-core-patient really only adds three fields: us-core-race, ethnicity, birthsex), as long as I can add those three fields while using the base 'Patient' StructureDefinition it should still be accepted as a us-core-patient.</p>



<a name="239829301"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Unable%20to%20find%20StructureDefinition%20for%20target%20type/near/239829301" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Unable.20to.20find.20StructureDefinition.20for.20target.20type.html#239829301">(May 22 2021 at 00:25)</a>:</h4>
<p>There is no 'birthsex' element in us-core.  There's an slice on extension that mandates support for a particular extension.  So your path will need to be patient.extension('whatever-the-url-is').value = 'male'</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
