---
layout: page
title: "FHIR Chat  · Adding a &#x27;let&#x27; statement · mapping-framework"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/index.html">mapping-framework</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Adding.20a.20&#x27;let&#x27;.20statement.html">Adding a &#x27;let&#x27; statement</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="173672638"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Adding%20a%20%27let%27%20statement/near/173672638" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Adding.20a.20&#x27;let&#x27;.20statement.html#173672638">(Aug 20 2019 at 16:24)</a>:</h4>
<p>Yesterday during the FHIR-I teleconf, we discussed <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21642" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21642">GF#21642</a>, asking for the addition of a "const" or "let" to the mapping language, so you can define, say, a named constant for an often-used extension url in your mapping.</p>
<p>like so:</p>
<div class="codehilite"><pre><span></span>let TariffFormExtensionUrl = &#39;http://uk-koeln.de/fhir/StructureDefinition/Extension/nNGM/pkvTarifform/0.1&#39;
</pre></div>


<p>We have several things we want to discuss before we decide on adding this:</p>
<ul>
<li>Where do we allow a let?  Just at the top of the mapping file with a global scope?  Inside each group or nested set of dependent rules?</li>
<li>The <code>let</code> would just define a read-only label, you cannot re-assign another value to it later on.  </li>
<li>It would need to be defined at the beginning of a group, it makes no sense to insert a let between rules.</li>
<li>Would this only work with constant values?  E.g. should we let the right hand side of the let contain function calls? Or refer to variables/aliases defined in the parent scope of the <code>let</code>?</li>
<li>If a constant, shall we call it 'const'?</li>
</ul>
<p>Currently, my engine supports constant values only, and they need to be included just before the first group in a map.  When serialized to a StructureMap, I emit an extension:</p>
<div class="codehilite"><pre><span></span>&lt;StructureMap xmlns=&quot;http://hl7.org/fhir&quot;&gt;
    &lt;extension url=&quot;http://hl7.org/fhir/5.0/StructureDefinition/extension-StructureMap.let&quot;&gt;
        &lt;extension url=&quot;name&quot;&gt;
            &lt;valueString value=&quot;TariffFormExtensionUrl&quot; /&gt;
        &lt;/extension&gt;
        &lt;extension url=&quot;value&quot;&gt;
            &lt;valueString value=&quot;http://uk-koeln.de/fhir/StructureDefinition/Extension/nNGM/pkvTarifform/0.1&quot; /&gt;
        &lt;/extension&gt;
    &lt;/extension&gt;
    &lt;url value=&quot;http://fire.ly/tests/AllFeatures&quot; /&gt;
</pre></div>



<a name="173824401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Adding%20a%20%27let%27%20statement/near/173824401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Adding.20a.20&#x27;let&#x27;.20statement.html#173824401">(Aug 21 2019 at 19:23)</a>:</h4>
<p>what type can it have? primitive only?</p>



<a name="173824450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Adding%20a%20%27let%27%20statement/near/173824450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Adding.20a.20&#x27;let&#x27;.20statement.html#173824450">(Aug 21 2019 at 19:24)</a>:</h4>
<p>can it be defined at group scope?</p>



<a name="175819321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Adding%20a%20%27let%27%20statement/near/175819321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Adding.20a.20&#x27;let&#x27;.20statement.html#175819321">(Sep 16 2019 at 14:50)</a>:</h4>
<p>right hand side should allow at least the function uuid().<br>
When your target is a Bundle, you may want to assign fullUrls to your entries that you can later use within different grous to link your resources together.</p>



<a name="182629590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Adding%20a%20%27let%27%20statement/near/182629590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Adding.20a.20&#x27;let&#x27;.20statement.html#182629590">(Dec 05 2019 at 05:39)</a>:</h4>
<p>global scope would mean that they could all go at the top of the mapping file, making them easier to see. Would also support use across different groups...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
