---
layout: page
title: "FHIR Chat  · Simple form example · mapping-framework"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/index.html">mapping-framework</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html">Simple form example</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="172677251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172677251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172677251">(Aug 07 2019 at 13:25)</a>:</h4>
<p>I am trying to wrap my head around <a href="https://www.hl7.org/fhir/mapping-language.html#simple" target="_blank" title="https://www.hl7.org/fhir/mapping-language.html#simple">https://www.hl7.org/fhir/mapping-language.html#simple</a> and the long form equivalent and could use some help...</p>
<p>In the long example, I see that the <code>create</code> transform takes a <code>type</code> parameter, which is a string of a type that is known (somehow). This example uses the string 'type'. Then the dependent invocation of the rule is spelled <code>defaultMappingGroup</code>. Is this a special kind of invocation? Most of the examples I've seen the spelling of the invocation corresponds to the spelling of the type parameter in the transform of the rule target. Or refer to some other group.</p>



<a name="172677713"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172677713" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172677713">(Aug 07 2019 at 13:30)</a>:</h4>
<p>Let's say that src.element is of type CodeableConcept and tgt.element is of type v3CE.  Further, let's assume you've defined a group called mapCodeableConceptTov3CE that maps CodeableConcept to v3CE and is declared with (types) which means that its the default mapping for those two types.  Then the short form becomes equivalent to:<br>
src.element as vvs -&gt; tgt.element = create('v3CE') as vvt then mapCodeableConceptTov3CE(vvs, vvt)</p>



<a name="172679514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172679514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172679514">(Aug 07 2019 at 13:51)</a>:</h4>
<p>Okay. So this example assumes a group called <code>defaultMappingGroup</code> to exist? I guess I am trying to understand how we go from the shorthand to the long form here...</p>



<a name="172679684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172679684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172679684">(Aug 07 2019 at 13:53)</a>:</h4>
<p>No, it does not need to be called "defaultMappingGroup".  That part is just saying that what ever group has been defined as the default mapping group for the src.element and the tgt.element types will be called.  That is what it states that right after the long form:<br>
Where the name of the type given as a parameter to 'create' and the group invoked by the 'then' are determined by the context of src.element and tgt.element and the selected default mapping group, as documented in the next section.</p>



<a name="172679900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172679900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172679900">(Aug 07 2019 at 13:56)</a>:</h4>
<p>As I said earlier, if this group was present in your set of mappings: <br>
group mapCodeableConceptToV3CE(source src:CodeableConcept, target tgt:v3CE) &lt;&lt;types&gt;&gt; { mapping stuff goes here}</p>
<p>then the long form equivalent becomes:<br>
src.element as vvs -&gt; tgt.element = create('v3CE') as vvt then mapCodeableConceptTov3CE(vvs, vvt)</p>



<a name="172680531"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172680531" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172680531">(Aug 07 2019 at 14:03)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="192166">@Jean Duteau</span> for bearing with me -- just so I am clear, what would the long form of the first rule of the R3-&gt;R4 of the  Basic resource (<a href="https://www.hl7.org/fhir/basic-version-maps.html#2.34.13.1" target="_blank" title="https://www.hl7.org/fhir/basic-version-maps.html#2.34.13.1">https://www.hl7.org/fhir/basic-version-maps.html#2.34.13.1</a>) be, e.g.<code>src.identifier -&gt; tgt.identifier</code>?</p>



<a name="172680640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172680640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172680640">(Aug 07 2019 at 14:04)</a>:</h4>
<p>src.identifier as vvs -&gt; tgt.identifier = create('Identifier' as vvt then whateverTheNameOfTheDefaultIdentifierToIdentiferMappingIs(vvs, vvt);</p>



<a name="172680786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/172680786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#172680786">(Aug 07 2019 at 14:06)</a>:</h4>
<p>src.identifier as vvs -&gt; tgt.identifier = create('Identifier') as vvt then Identifier(vvs, vvt);   (I looked and saw that was the name of the default mapping of IdentifierR3 to Identifier)  (<a href="https://www.hl7.org/fhir/datatypes-version-maps.html#identifier" target="_blank" title="https://www.hl7.org/fhir/datatypes-version-maps.html#identifier">https://www.hl7.org/fhir/datatypes-version-maps.html#identifier</a>)</p>



<a name="173849360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/173849360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#173849360">(Aug 22 2019 at 03:16)</a>:</h4>
<p>And as I dig deeper, I am trying to understand the implication of <code>&lt;&lt;types&gt;&gt;</code> vs <code>&lt;&lt;type+&gt;&gt;</code> for default groups.</p>
<p>Why was it decided that <code>group string2id</code> should have <code>&lt;&lt;types&gt;&gt;</code> while <code>group id2string</code> a group type of <code>&lt;&lt;type+&gt;&gt;</code> (see <a href="https://github.com/HL7/fhir/blob/master/implementations/r3maps/R4toR3/primitives.map" target="_blank" title="https://github.com/HL7/fhir/blob/master/implementations/r3maps/R4toR3/primitives.map">https://github.com/HL7/fhir/blob/master/implementations/r3maps/R4toR3/primitives.map</a>)?</p>



<a name="173852610"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/181579-mapping-framework/topic/Simple%20form%20example/near/173852610" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/181579-mapping-framework/topic/Simple.20form.20example.html#173852610">(Aug 22 2019 at 04:47)</a>:</h4>
<p>The section on default mappings talks about the difference:  <a href="http://hl7.org/implement/standards/fhir/mapping-language.html#7.7.0.9" target="_blank" title="http://hl7.org/implement/standards/fhir/mapping-language.html#7.7.0.9">http://hl7.org/implement/standards/fhir/mapping-language.html#7.7.0.9</a></p>
<p>&lt;&lt;types&gt;&gt; is used when you want the source and the target to match exactly.<br>
&lt;&lt;type+&gt;&gt; is used when you only need the source to match and the target will just get cast/converted to the target type.</p>
<p>So string2id is marked as &lt;&lt;types&gt;&gt; because we only want this transform to be called when the source is a string and the target is an idR3.  It won't get called in any situtation.</p>
<p>OTOH id2string is marked as &lt;&lt;type+&gt;&gt; because it is sort of the fallback for when the source is an id and the target isn't something more specific (id2oid for instance) and the target can be converted to a string.  so it will handle id2code, id2markdown, and id2string.  NOTE: it won't handle id2id even though id is a type of string, because we have a group that matches id, id already specified.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
