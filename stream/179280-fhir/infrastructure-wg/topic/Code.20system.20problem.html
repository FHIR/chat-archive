---
layout: page
title: "FHIR Chat  · Code system problem · fhir/infrastructure-wg"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/index.html">fhir/infrastructure-wg</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html">Code system problem</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153976922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976922">(Jul 20 2018 at 21:51)</a>:</h4>
<p>So at this time, it's not possible to put a contained code system inside a value set.</p>



<a name="153976923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976923">(Jul 20 2018 at 21:51)</a>:</h4>
<p>I think that this is a problem - it should be possible to do that.</p>



<a name="153976924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976924">(Jul 20 2018 at 21:51)</a>:</h4>
<p>the reason is because there's no trackable internal reference from the value set to the code system.</p>



<a name="153976925"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976925" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976925">(Jul 20 2018 at 21:52)</a>:</h4>
<p>the issue is this invariant:</p>



<a name="153976926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976926">(Jul 20 2018 at 21:52)</a>:</h4>
<div class="codehilite"><pre><span></span>contained.where(((&#39;#&#39;+id in (
  %resource.descendants().reference |
  %resource.descendants().as(canonical))) or
  descendants().where(reference = &#39;#&#39;).exists() or
  descendants().where(as(canonical) = &#39;#&#39;
).exists()).not()).trace(&#39;unmatched&#39;, id).empty())
</pre></div>



<a name="153976927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976927">(Jul 20 2018 at 21:54)</a>:</h4>
<p>so I think that this invariant should say:</p>



<a name="153976928"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976928" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976928">(Jul 20 2018 at 21:55)</a>:</h4>
<div class="codehilite"><pre><span></span>contained.where(((&#39;#&#39;+id in (
  %resource.descendants().reference |
  %resource.descendants().as(canonical) |
  %resource.descendants().as(uri) |
  %resource.descendants().as(url))
 ) or  descendants().where(reference = &#39;#&#39;).exists()
).exists()).not()).trace(&#39;unmatched&#39;, id).empty())
</pre></div>



<a name="153976929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976929">(Jul 20 2018 at 21:55)</a>:</h4>
<p>two changes: there's no reason to look for a canonical reference of # to the containing resource. I just can't see how that would be valid</p>



<a name="153976930"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976930" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976930">(Jul 20 2018 at 21:55)</a>:</h4>
<p>and the other case is to allow a contained resource referenced by uri or url - e.g. a code system or a binary in a document reference</p>



<a name="153976946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976946">(Jul 20 2018 at 23:52)</a>:</h4>
<p>Canonical reference of # to the containing reference - code system pointing to its definitional value set?</p>



<a name="153976949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976949">(Jul 21 2018 at 00:08)</a>:</h4>
<p>the code system is not referred to by it's definitional value set that contains it?</p>



<a name="153976959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976959">(Jul 21 2018 at 00:18)</a>:</h4>
<p>It would be, but the Code System would refer to the ValueSet too.</p>



<a name="153976960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976960">(Jul 21 2018 at 00:26)</a>:</h4>
<p>so the question is not, 'what is valid?', but 'what satisfies the contained resource requirement?'</p>



<a name="153976963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976963">(Jul 21 2018 at 00:44)</a>:</h4>
<p>A contained resource pointing to the container by canonical would meet the requirement.  Perhaps a Concept map contained within a ValueSet?</p>



<a name="153976964"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976964" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976964">(Jul 21 2018 at 00:45)</a>:</h4>
<p>(on the grounds that the two must be maintained together and managed in sync)</p>



<a name="153976969"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Code%20system%20problem/near/153976969" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Code.20system.20problem.html#153976969">(Jul 21 2018 at 07:52)</a>:</h4>
<p>this, it turns out, is <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17330" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17330">GF#17330</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
