---
layout: page
title: "FHIR Chat  · Reference search parameter and resource versions · fhir/infrastructure-wg"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/index.html">fhir/infrastructure-wg</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html">Reference search parameter and resource versions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="242379758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/242379758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#242379758">(Jun 11 2021 at 17:47)</a>:</h4>
<p>In a discussion in <a class="stream" data-stream-id="179166" href="/#narrow/stream/179166-implementers">#implementers</a> , we got to a use case where there is a reference that is likely to point to a specific version of a resource (in the particular  case <a href="http://Provenance.target">Provenance.target</a>). If I want to find all instances of a resource that references <strong>any</strong> version of the referenced resource, how do we search for it?</p>
<p>It seems that the following is the most straight-forward (assuming that <code>target</code> is the reference parameter):</p>
<ol>
<li>Obtain the un-versioned referenced resource. The latest version is available in the ETag.</li>
<li>Use a parameter search: GET [base]/MainResource?target:below=[base]/ReferencedResource/[id]/_history/[latest version]</li>
</ol>
<p>The problem is that the :below modifier is <a href="http://build.fhir.org/search.html#versions">explicitly described</a> working with versions for canonical references. Would it apply to regular references?</p>
<p>Alternatively, what is the result if a search is using a non-versioned reference - is it supposed to match versioned and un-versioned  references, or only un-versioned ones?</p>
<p><span class="user-mention" data-user-id="197072">@Paul Church</span> <span class="user-mention" data-user-id="191380">@Elliot Silver</span>  (who were part of the previous discussion) <span class="user-mention" data-user-id="191404">@John Moehrke</span> (because this seems to be something <a href="http://Provenance.target">Provenance.target</a> really needs).</p>



<a name="242380914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/242380914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#242380914">(Jun 11 2021 at 17:57)</a>:</h4>
<p>Aah, canonical... you had to throw that extra wrench in there -- do you want to search against the business version or the resource history version? Perhaps overloading :below for both isn't the best approach.</p>



<a name="242382255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/242382255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#242382255">(Jun 11 2021 at 18:06)</a>:</h4>
<p>Our interpretation was that an un-versioned search only matches un-versioned references, and :below doesn't apply here.</p>
<p>This does sound like a useful search, especially for <a href="http://Provenance.target">Provenance.target</a> (find all provenances applying to any version of the resource). I can't think of any way to construct that search using my current interpretations.</p>
<p>I think there's some ambiguity if we made un-versioned search match versioned references....the un-versioned name of a resource is the identity of the current version, so matching references to past versions might not be what the client wants.</p>
<p>Adding :below is a possibility but with it already applying to canonical and URI, will there be cases that don't make sense?</p>



<a name="242638340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/242638340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#242638340">(Jun 14 2021 at 18:13)</a>:</h4>
<p>I don't know.  I think I heard that if you requested a historic version, you would be given the current, unless you did something special to force retriavl of that specific historic version....</p>



<a name="242638350"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/242638350" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#242638350">(Jun 14 2021 at 18:13)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ?  <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> ?</p>



<a name="242638798"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/242638798" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#242638798">(Jun 14 2021 at 18:16)</a>:</h4>
<p>I don't knbow</p>



<a name="277873811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/277873811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#277873811">(Apr 05 2022 at 12:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197072">Paul Church</span> <a href="#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions/near/242382255">said</a>:</p>
<blockquote>
<p>Our interpretation was that an un-versioned search only matches un-versioned references, and :below doesn't apply here. [...]</p>
</blockquote>
<p>Is this the interpretation that most other implementations follow? Our server behaves exactly like this. We just received a customer request questioning that behaviour, exactly for the same use case outlined above.</p>



<a name="277916074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/277916074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#277916074">(Apr 05 2022 at 17:36)</a>:</h4>
<p>Would there be sufficient support from others to clarify that unversioned references should only match unversioned references in the instance?</p>



<a name="277938525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/277938525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#277938525">(Apr 05 2022 at 20:24)</a>:</h4>
<p>Not sure what you mean.  References match instances, not other references...</p>



<a name="277978507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/277978507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#277978507">(Apr 06 2022 at 05:58)</a>:</h4>
<p>I meant that it’s clarified that if you have a unversioned reference as the search parameter value, this search only matches if there is an unversioned reference in the instance. If the instance has a versioned reference in it, there should be no match.</p>



<a name="278018173"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278018173" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278018173">(Apr 06 2022 at 12:49)</a>:</h4>
<p>maybe you need to provide an example. I am confused on what you are describing as "unversioned reference as the search parameter value". I am not confused by each word, but by the string of words you use. -- a search on an unversioned reference will get you the latest, indeed it is hard to get anything but the latest, as the default for a versioned reference is to give you the latest.</p>



<a name="278019387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278019387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278019387">(Apr 06 2022 at 13:00)</a>:</h4>
<p>Say you have a Provenance instance with a versioned reference as the target:</p>
<div class="codehilite"><pre><span></span><code>{
  &quot;resourceType&quot;: &quot;Provenance&quot;,
  &quot;target&quot;: [{
     &quot;reference&quot;: &quot;Patient/example/_history/1234&quot;
   }]
}
</code></pre></div>
<p>Now you are executing a search on that target: </p>
<div class="codehilite"><pre><span></span><code>[base]/Provenance?target=Patient/example
</code></pre></div>
<p>Should this match the instance or not?</p>



<a name="278019553"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278019553" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278019553">(Apr 06 2022 at 13:00)</a>:</h4>
<p>In the thread above it was indicated that it should not match. However, as far as I can see, the spec is silent about it.</p>



<a name="278021117"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278021117" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278021117">(Apr 06 2022 at 13:13)</a>:</h4>
<p>Your example</p>
<blockquote>
<p>[base]/Provenance?target=Patient/example<br>
is just a normal search. You  should get the latest instance of that Patient resource... regardless of how many versions are available.</p>
</blockquote>
<p>Note your search example has nothing to do with the Provenance instance you give. Or, I am not understanding the relationship you are seeing.</p>
<p>Where do you see in the FHIR specification statements different than that?</p>



<a name="278022535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278022535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278022535">(Apr 06 2022 at 13:24)</a>:</h4>
<p>This was the first question raised by <span class="user-mention silent" data-user-id="192685">Vassil Peytchev</span> <a href="#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions/near/242379758">said</a>:</p>
<blockquote>
<p>Alternatively, what is the result if a search is using a non-versioned reference - is it supposed to match versioned and un-versioned  references, or only un-versioned ones?</p>
</blockquote>



<a name="278022685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278022685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278022685">(Apr 06 2022 at 13:26)</a>:</h4>
<p>My question was if everyone follows the interpretation of <span class="user-mention silent" data-user-id="197072">Paul Church</span> <a href="#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions/near/242382255">said</a>:</p>
<blockquote>
<p>Our interpretation was that an un-versioned search only matches un-versioned references, and :below doesn't apply here.</p>
</blockquote>



<a name="278022820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278022820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278022820">(Apr 06 2022 at 13:27)</a>:</h4>
<p>There is nothing in the spec indicate if it should match or not</p>



<a name="278024077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278024077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278024077">(Apr 06 2022 at 13:36)</a>:</h4>
<p>I would expect that the Provenance instance is returned if I search using</p>
<div class="codehilite"><pre><span></span><code>[base]/Provenance?target=Patient/example/_history/1234
</code></pre></div>
<p>Should the instance also be returned if I use the latest / unversioned reference</p>



<a name="278024693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278024693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278024693">(Apr 06 2022 at 13:41)</a>:</h4>
<p>Also note that the first paragraph of section <a href="https://www.hl7.org/fhir/search.html#reference">"3.1.1.4.12 reference"</a> does not say that you are allowed to have history part in the search parameter value.</p>



<a name="278025352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278025352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278025352">(Apr 06 2022 at 13:45)</a>:</h4>
<p>Does this clarify the question or am I missing something essential here?</p>



<a name="278028455"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278028455" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278028455">(Apr 06 2022 at 14:07)</a>:</h4>
<p>I think the question is clear.  I'll say from a client perspective, if I'm trying to find all (current) Observations referencing Patient 123, it'd be confusing (and beyond my control) if some Observations weren't returned simply because they were referencing Patient 123 in a more specific way. (Note of course that even a version specific reference to Patient 123 might currently be pointing to the <em>latest version</em>, which surely every client searching by reference would want to find).</p>



<a name="278028739"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278028739" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278028739">(Apr 06 2022 at 14:08)</a>:</h4>
<p>I guess that is why i was confused on the question... because I agree with <span class="user-mention" data-user-id="191315">@Josh Mandel</span> that there is no possible way for this to be anyother way.</p>



<a name="278045878"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278045878" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278045878">(Apr 06 2022 at 15:59)</a>:</h4>
<p>A quick test against different test servers result in different behaviour here. So I think it would be good to clarify this.</p>



<a name="278045880"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278045880" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278045880">(Apr 06 2022 at 15:59)</a>:</h4>
<p><a href="https://jira.hl7.org/browse/FHIR-36716">https://jira.hl7.org/browse/FHIR-36716</a></p>



<a name="278045898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278045898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278045898">(Apr 06 2022 at 15:59)</a>:</h4>
<p><a href="https://jira.hl7.org/browse/FHIR-36715">https://jira.hl7.org/browse/FHIR-36715</a></p>



<a name="278049132"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278049132" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278049132">(Apr 06 2022 at 16:20)</a>:</h4>
<p>I feel like there is a pitfall here, but I am not quite sure how to express it... apologies and thanks as I work through this in stream  =).</p>
<p>I guess I am trying to figure out why/when resources are pinned to a specific version, and if it is safe to assume version resolution.</p>
<p>For example, if you are resolving the target of an AuditEvent, it is likely <em>important</em> that it resolves only the exact version referenced (returning the current version would be wrong and could cause legal trouble).  So if I want to know exactly who accessed <code>Patient/example/_history/1234</code>, I do not want the records for version <code>1233</code>, nor do I want logs for version <code>1235</code>.</p>
<p>In Josh's example, <em>why</em> would someone pin an Observation to a specific version of a patient?  If a system/app/user does that, is it safe for us to assume any other version is okay?</p>



<a name="278050225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278050225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278050225">(Apr 06 2022 at 16:28)</a>:</h4>
<p>This is not a question about when a version specific reference is a query parameter, I understood it as a question when a non-version specific reference is a query parameter, which is also different than a GET of a URL that is version or non-version specific (not search, read/vread).</p>



<a name="278050388"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278050388" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278050388">(Apr 06 2022 at 16:29)</a>:</h4>
<p>if a version specific reference is in a query parameter, surely one should just return resources with that version specific reference (like the Provenance example). right?</p>



<a name="278050496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278050496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278050496">(Apr 06 2022 at 16:30)</a>:</h4>
<p>If you search for prescriptions for Patient 123, you should get all MedicationRequests with a subject of Patient 123 - regardless of whether the references are version-specific or not.</p>



<a name="278050536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278050536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278050536">(Apr 06 2022 at 16:30)</a>:</h4>
<p>agree</p>



<a name="278050620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278050620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278050620">(Apr 06 2022 at 16:31)</a>:</h4>
<p>and I think that is the first example Alex provides.</p>



<a name="278050778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278050778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278050778">(Apr 06 2022 at 16:32)</a>:</h4>
<p>the second perspective, that Gino is focused on, is where  search parameter includes a version specific value... that seems should only return for THAT version matching, not all. so what you specify in the search matters.</p>



<a name="278051094"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278051094" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278051094">(Apr 06 2022 at 16:34)</a>:</h4>
<p>so</p>
<blockquote>
<p>[base]/Provenance?target=Patient/example/_history/1234</p>
</blockquote>
<p>should return only Provenance instances where .target has specifically version 1234 in it... not others.</p>
<p>but</p>
<blockquote>
<p>[base]/Provenance?target=Patient/example</p>
</blockquote>
<p>should return ALL Provenance with any version of Patient/example</p>



<a name="278051210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278051210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278051210">(Apr 06 2022 at 16:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="193430">Alexander Zautke</span> <a href="#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions/near/278022685">said</a>:</p>
<blockquote>
<p>My question was if everyone follows the interpretation of <span class="user-mention silent" data-user-id="197072">Paul Church</span> <a href="#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions/near/242382255">said</a>:</p>
<blockquote>
<p>Our interpretation was that an un-versioned search only matches un-versioned references, and :below doesn't apply here.<br>
</p>
</blockquote>
</blockquote>
<p>so this seems wrong</p>



<a name="278053855"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278053855" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278053855">(Apr 06 2022 at 16:55)</a>:</h4>
<p>Thanks!</p>
<p>Regarding the <code>below</code> modifier, we just 'audited' the modifier &lt;-&gt; type mappings (<a href="http://jira.hl7.org/browse/FHIR-36684">FHIR-36684</a>), and <code>reference</code> does not have a definition for them.  Note that it doesn't mean it is not implementable (e.g., server-specific behavior), just that behavior is undefined according to the spec.</p>
<p>I think the behavior of version searching needs to be clarified before the modifiers can be discussed though.  For example, if <code>target=Patient/example</code> implicitly includes references of <code>Patient/example/_history/x</code>, then the type already includes behavior equivalent to the <code>uri</code> definition of <code>below</code>.</p>



<a name="278061472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278061472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278061472">(Apr 06 2022 at 17:53)</a>:</h4>
<p>Re: uri search behavior vs reference search behalf... While canonical resources have an explicit notion of resource.version, this is different than resource.meta.versionId -- I'm not sure we want to conflate these</p>



<a name="278064746"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278064746" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278064746">(Apr 06 2022 at 18:16)</a>:</h4>
<p>Yes, I was referring to how <code>above</code> and <code>below</code> are already defined on <a href="http://build.fhir.org/search.html#uri">uri</a>.  Namely that  <code>[Resource]/[id]</code> is hierarchically defined to exist above <code>[Resource]/[id]/_history/[version]</code> per a pathing mechanic on the uri.</p>



<a name="278064953"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278064953" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278064953">(Apr 06 2022 at 18:16)</a>:</h4>
<p>It does <em>not</em> do anything about actual version references (e.g., you cannot ask for versions above/below '3')</p>



<a name="278066726"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278066726" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278066726">(Apr 06 2022 at 18:30)</a>:</h4>
<p>is that needed? I understand an academic argument that it is possible, but struggle with real use-case.</p>



<a name="278068047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Reference%20search%20parameter%20and%20resource%20versions/near/278068047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Reference.20search.20parameter.20and.20resource.20versions.html#278068047">(Apr 06 2022 at 18:40)</a>:</h4>
<p><span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span>  No idea on need/use, just noting that it is there and normative.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
