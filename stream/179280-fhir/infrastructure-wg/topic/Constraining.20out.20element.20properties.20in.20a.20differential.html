---
layout: page
title: "FHIR Chat  · Constraining out element properties in a differential · fhir/infrastructure-wg"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/index.html">fhir/infrastructure-wg</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html">Constraining out element properties in a differential</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="271894273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/271894273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#271894273">(Feb 14 2022 at 21:50)</a>:</h4>
<p>On today's FHIR-I call, we spent a good chunk of time discussing <a href="http://jira.hl7.org/browse/FHIR-20385">FHIR#20385</a>, which proposes a mechanism to allow certain element properties (or property repetitions) to be removed from the snapshot by setting flags in the differential.  The specific elements to be controlled are StructureDefinition.mapping and ElementDefinition.code, comment, requirements, alias, example, and mapping.  Further discussion to take place here.</p>



<a name="271936725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/271936725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#271936725">(Feb 15 2022 at 07:44)</a>:</h4>
<p>taking mappings as example: would the flag be "remove all mappings" or would we have a way to say "remove all mappings that meet this condition"? Or would we apply the flag to each mapping we want to remove?</p>



<a name="271989010"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/271989010" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#271989010">(Feb 15 2022 at 15:19)</a>:</h4>
<p>Proposal is 3 options - remove all mappings, remove all mappings with a particular id (e.g. all v2, all CDA, etc.) or remove a specific mapping from a specific element.  (Mapping is the only one where you can remove all with a particular id, as the other candidates for removal don't share an id across elements.)</p>



<a name="273638812"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/273638812" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#273638812">(Mar 01 2022 at 13:22)</a>:</h4>
<p>Forge currently has a setting whether to inherit the mapping definitions in the profile metadata (not diff/snapshot) from a parent profile: <a href="/user_uploads/10155/qPXCBPcI3bwnmGW1B-4nhxmx/image.png">image.png</a><br>
Other than that these extensions will have impact on the snapshot generator and rendering engine. <span class="user-mention" data-user-id="191334">@Marten Smits</span>, what are your thoughts?</p>
<div class="message_inline_image"><a href="/user_uploads/10155/qPXCBPcI3bwnmGW1B-4nhxmx/image.png" title="image.png"><img src="/user_uploads/10155/qPXCBPcI3bwnmGW1B-4nhxmx/image.png"></a></div>



<a name="273640401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/273640401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#273640401">(Mar 01 2022 at 13:33)</a>:</h4>
<p>I'd prefer not to mess with snapshot generation functionality but adding extensions with flags like: "don't display" to the snapshot (using the differential).<br>
Rendering tooling like in simplifier and the IG Publisher can then handle the display of those elements.</p>
<p>Messing with snapshot generation functionality is a terrible idea in my opinion, it's already too complicated as it is</p>



<a name="273651748"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/273651748" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#273651748">(Mar 01 2022 at 14:51)</a>:</h4>
<p>This is definitely not about "don't display", it's about "remove entirely" - we don't want the mappings, comments, examples, etc. to be in the differential at all - because they're "wrong" in the constrained context.  I understand that snapshot generation is miserable, but would the proposed approach be that hard to implement?</p>



<a name="273777452"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/273777452" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#273777452">(Mar 02 2022 at 09:23)</a>:</h4>
<p>The snapshot generator is hard to maintain as a whole. Maybe this approach is not that complicated (I would have to take a deep dive into that code again) but this introduces new behaviour and mechanisms to an already complicated piece of software, which I thought was "normative" by now, or at least, it should be.</p>
<p>Removal of certain aspects of an ElementDefinition from the base currently only happens for ElementDefiinition.type I think, by always adding the entire list of types to the differential. Why not use that same approach for .code .mapping, .alias, and .example? Propably because it'll break already existing profiles?<br>
I don't see the use case for comment and requirements entirely, they can just be overwritten by the differential now.</p>
<p>Btw, would this proposal be for all snapshot generation? Or only for R4B+?</p>



<a name="273842423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/273842423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#273842423">(Mar 02 2022 at 17:17)</a>:</h4>
<p>Snapshot generation is a 'process'.  It doesn't get to be 'normative' :)  StructureDefinition can't have breaking changes, but it can absolutely have new capabilities introduced.  And the issue is that the absence of this new capability results in models that don't make sense.  Seeing "alternate names" of 'Vital Signs" on a profile for a hemoglobin is a problem.  So is seeing guidance about the use of 'Timing' or 'Period' in the Observation.effective comment when the profile has constrained the element to only use 'date'.  Similar problems exist elsewhere.  The solution to data elements that are outright wrong isn't "keep them and don't display them", it's "allow them to be removed".</p>
<p>There's no funky inheritance or slicing or other weirdness we have to worry about here.  You simply run the snapshot process and, at the end, if there's an extension present that says 'wipe this', then you wipe it.</p>



<a name="273969429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Constraining%20out%20element%20properties%20in%20a%20differential/near/273969429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marten Smits <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Constraining.20out.20element.20properties.20in.20a.20differential.html#273969429">(Mar 03 2022 at 13:09)</a>:</h4>
<p>I agree that this is "broken" in the current snapshots and I fully understand the use case. </p>
<p>I just think we need to be careful when it comes to altering snapshot generation logic. Especially since alterations may cause snapshots that users who are currently working on profiles or want to publish a new version (modelers/profilers) don't expect. This is not the case in the current use case since users actively have to add these extensions to trigger the removal, so I can agree to this.</p>
<p>Question I still have: where will this new feature be documented? And will it apply to all FHIR versions?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
