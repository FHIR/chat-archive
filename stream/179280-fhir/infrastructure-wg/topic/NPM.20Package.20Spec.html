---
layout: page
title: "FHIR Chat  · NPM Package Spec · fhir/infrastructure-wg"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/index.html">fhir/infrastructure-wg</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html">NPM Package Spec</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="177187742"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/177187742" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#177187742">(Oct 02 2019 at 20:12)</a>:</h4>
<p>Topic for next call: <a href="https://wiki.hl7.org/FHIR_NPM_Package_Spec" target="_blank" title="https://wiki.hl7.org/FHIR_NPM_Package_Spec">https://wiki.hl7.org/FHIR_NPM_Package_Spec</a> describes a tooling specification that the toolsmiths need to be stable. At Atlanta firely and I discussed this and said we'd make a round of edits on the page, and then ask FHIR-I to formally take control of the spec, so that any further changes must be approved through committee. </p>
<p>That time has now come.</p>



<a name="177189247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/177189247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#177189247">(Oct 02 2019 at 20:28)</a>:</h4>
<p>Motion: that we leave this spec on the wiki, but add a note that any further non-trivial changes need to be approved by FHIR-I</p>
<p>Alternative motion is to move it into the main spec, but it's very oblique to the spec. Orsome spec somewhere else. I don't feel strongly about this</p>



<a name="177189264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/177189264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#177189264">(Oct 02 2019 at 20:29)</a>:</h4>
<p>I won't be on the call (travelling)</p>



<a name="178440343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/178440343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#178440343">(Oct 18 2019 at 03:25)</a>:</h4>
<p>I think it's time that this page moved to formal FHIR-I mgmt, and to some sort of 'tooling standard' point. (not sure what it's formal HL7 standard should be). But anyway, no changes without FHIR-I agreement now on:</p>
<p><a href="https://wiki.hl7.org/FHIR_NPM_Package_Spec" target="_blank" title="https://wiki.hl7.org/FHIR_NPM_Package_Spec">https://wiki.hl7.org/FHIR_NPM_Package_Spec</a></p>
<p>(see  <a href="#narrow/stream/179166-implementers/topic/FHIR.20NPM.20packages" title="#narrow/stream/179166-implementers/topic/FHIR.20NPM.20packages">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/FHIR.20NPM.20packages</a>)</p>
<p>Also <a href="https://wiki.hl7.org/FHIR_Package_Cache" target="_blank" title="https://wiki.hl7.org/FHIR_Package_Cache">https://wiki.hl7.org/FHIR_Package_Cache</a> and <a href="https://wiki.hl7.org/FHIR_IG_PackageList_doco" target="_blank" title="https://wiki.hl7.org/FHIR_IG_PackageList_doco">https://wiki.hl7.org/FHIR_IG_PackageList_doco</a> too (<span class="user-mention" data-user-id="191335">@Martijn Harthoorn</span> )</p>



<a name="178458996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/178458996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#178458996">(Oct 18 2019 at 09:46)</a>:</h4>
<p>Sounds right.</p>



<a name="178952859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/178952859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#178952859">(Oct 24 2019 at 13:46)</a>:</h4>
<p>Under package content there is a line "All resources have a filename of [Type]-[id].json". I remember we choose to write that as a SHOULD, because it's good as a best practice, but we should refrain from making it mandatory - since it would lead to tooling having it as expectation - and that will lead to future inflexibility.</p>



<a name="178952889"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/178952889" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#178952889">(Oct 24 2019 at 13:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="178975644"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/178975644" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#178975644">(Oct 24 2019 at 17:24)</a>:</h4>
<p>no it must be a SHALL</p>



<a name="178975719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/178975719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#178975719">(Oct 24 2019 at 17:25)</a>:</h4>
<p>there's no reason for flexibility on this in a package, and a reason for not: it makes it much much quicker to load a package - something you are are usually very concerned with</p>



<a name="179030619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179030619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179030619">(Oct 25 2019 at 08:19)</a>:</h4>
<p>My thoughts on this:<br>
-  In our tools we use .index.json to load a package<br>
<a href="#narrow/stream/179177-conformance/topic/Package.20rework/near/168938409" title="#narrow/stream/179177-conformance/topic/Package.20rework/near/168938409">https://chat.fhir.org/#narrow/stream/179177-conformance/topic/Package.20rework/near/168938409</a><br>
- Id is scoped and can be re-assigned per server. A package trancends that scope.<br>
- Id has a cardinality of 0..1 and It is very common for draft conformance resources to not (yet) have an Id.</p>



<a name="179032219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179032219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179032219">(Oct 25 2019 at 08:47)</a>:</h4>
<p>Requiring both a mandatory index file and mandatory file name patterns seems redundant? I'd prefer to require an index file and not restrict file names.</p>



<a name="179034703"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179034703" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179034703">(Oct 25 2019 at 09:26)</a>:</h4>
<p>Does Forge set an id on a StructureDefinition?</p>



<a name="179036848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179036848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179036848">(Oct 25 2019 at 10:03)</a>:</h4>
<p>Forge allows authors to specify a Resource Id. However when uploading to a FHIR server, the server may reject the specified ID and assign another one. After publishing a profile to a FHIR server/Simplifier, Forge updates the <code>Resource.id</code> and publishing date values. If the server assigned a (new/other) id, then Forge will mark the Resource as "dirty" (i.e. having unsaved changes), to ensure that users save back the updated resource with the newly assigned id to local disk.</p>



<a name="179047677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179047677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179047677">(Oct 25 2019 at 13:11)</a>:</h4>
<p>Before we lock it, it should be moved to Confluence.</p>



<a name="179085194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179085194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179085194">(Oct 25 2019 at 20:16)</a>:</h4>
<p>using .index.json is not a substitute for an organised naming strategy. The key thing - absolutely critical - is that you don't have to read every resource in the package to find out what kind of resource it is. You just scan the directory for the resource types you are looking for. What is proposed for .index.json doesn't substitute for that.</p>



<a name="179085241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179085241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179085241">(Oct 25 2019 at 20:16)</a>:</h4>
<p>This is mandatory for me</p>



<a name="179085322"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179085322" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179085322">(Oct 25 2019 at 20:17)</a>:</h4>
<p>I don't understand either of these points:</p>
<blockquote>
<p>- Id is scoped and can be re-assigned per server. A package trancends that scope.</p>
</blockquote>
<p>uh what? I don't see how that matters. the id is fixed in the package itself</p>
<blockquote>
<p>- Id has a cardinality of 0..1 and It is very common for draft conformance resources to not (yet) have an Id.</p>
</blockquote>
<p>then they can't be part of a package since it means they are not stored anywhere</p>



<a name="179085456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179085456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179085456">(Oct 25 2019 at 20:18)</a>:</h4>
<p>I don't understand why it's an issue either. Humans don't read the packages</p>



<a name="179085683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179085683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179085683">(Oct 25 2019 at 20:21)</a>:</h4>
<p>I see that I overlooked adding anything about .index.json to the package spec btw</p>



<a name="179130609"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179130609" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179130609">(Oct 26 2019 at 15:40)</a>:</h4>
<p>I understand the performance requirements.</p>
<p>Indexing based on mandatory file name patterns is indeed the fastest and easiest solution, at the cost of being inflexible and brittle. Package authors lose the original resource file names, depending on their internal workflow. And the proposed file name pattern provide only resource type &amp; id, whereas clients need to index other metadata as well.</p>
<p>The metadata harvesting logic in the open source .NET API is much more flexible and sufficiently fast for us not to have to rely on file name patterns. The Forge project explorer depends on it. As this demonstrates that the perceived performance problems can be addressed, I'd much rather see a recommendation for a file name pattern instead of a hard requirement.</p>



<a name="179147318"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179147318" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179147318">(Oct 27 2019 at 00:18)</a>:</h4>
<blockquote>
<p>The metadata harvesting logic in the open source .NET API is much more flexible and sufficiently fast for us not to have to rely on file name patterns</p>
</blockquote>
<p>this is in .index.json? All that is in there at the moment is canonical URLs. If we can add to that, then that would be basis for going forwards</p>



<a name="179147483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179147483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179147483">(Oct 27 2019 at 00:25)</a>:</h4>
<p>for instance, if we had this:</p>



<a name="179147523"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179147523" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179147523">(Oct 27 2019 at 00:26)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;index-version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;canonicals&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;[url]&quot;</span><span class="p">:</span> <span class="s2">&quot;[filename]&quot;</span><span class="p">,</span>
    <span class="err">etc..</span>
  <span class="p">},</span>
  <span class="nt">&quot;types&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;[type}&quot;</span> <span class="err">:</span> <span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="s2">&quot;filename&quot;</span><span class="p">],</span>
    <span class="err">etc..</span>
  <span class="p">],</span>
  <span class="nt">&quot;date&quot;</span> <span class="p">:</span> <span class="s2">&quot;[date]&quot;</span>
<span class="p">}</span>
</pre></div>



<a name="179147530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179147530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179147530">(Oct 27 2019 at 00:27)</a>:</h4>
<p>index-version = 1 fixed value. if you see anything different, rebuild the .index.json<br>
canonicals = a list of canonical URLs in the package<br>
types = a list of resources by type<br>
date = date the file was added to the cache it is in (purely for display purposes)</p>



<a name="179147536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179147536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179147536">(Oct 27 2019 at 00:27)</a>:</h4>
<p>if we had that, I wouldn't care what the files are called</p>



<a name="179147701"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179147701" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179147701">(Oct 27 2019 at 00:33)</a>:</h4>
<p>also, the canonicals should have a version using the |[ver] format</p>



<a name="179153184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179153184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179153184">(Oct 27 2019 at 03:46)</a>:</h4>
<p>so example of what I'm talking about - I populated all the packages here <a href="https://github.com/FHIR/packages" target="_blank" title="https://github.com/FHIR/packages">https://github.com/FHIR/packages</a></p>



<a name="179153519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179153519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179153519">(Oct 27 2019 at 03:59)</a>:</h4>
<p>they all have a .index.json now</p>



<a name="179157707"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179157707" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179157707">(Oct 27 2019 at 06:33)</a>:</h4>
<p>emerging issue: should examples have it's own .index.json?</p>



<a name="179178359"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179178359" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179178359">(Oct 27 2019 at 17:00)</a>:</h4>
<p>Sounds good.</p>
<p>Maybe it's more convenient to restructure the index as a list of complex file info nodes? Each node would represent a single file and contain a set of metadata properties (filename, canonical url, resource type, ...). This would also allow for additional polymorphic metadata, e.g. depending on the resource type. Clients can easily generate lookup tables from the index file, e.g. profiles by url, examples by profile etc. The format is also easily extensible by adding new metadata properties.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;index-version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;date&quot;</span> <span class="p">:</span> <span class="s2">&quot;[date]&quot;</span><span class="p">,</span>
  <span class="nt">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;nl-core-patient.json&quot;</span><span class="p">,</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;nl-core-patient&quot;</span><span class="p">,</span>
      <span class="nt">&quot;resourcetype&quot;</span><span class="p">:</span> <span class="s2">&quot;StructureDefinition&quot;</span>
      <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://fhir.nl/fhir/StructureDefinition/nl-core-patient&quot;</span><span class="p">,</span>
      <span class="nt">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;Resource&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Patient&quot;</span><span class="p">,</span>
      <span class="err">etc..</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;nl-core-address-official.json&quot;</span><span class="p">,</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;nl-core-address-official&quot;</span><span class="p">,</span>
      <span class="nt">&quot;resourcetype&quot;</span><span class="p">:</span> <span class="s2">&quot;StructureDefinition&quot;</span><span class="p">,</span>
      <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://fhir.nl/fhir/StructureDefinition/nl-core-address-official&quot;</span><span class="p">,</span>
      <span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="s2">&quot;complex-type&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Extension&quot;</span><span class="p">,</span>
      <span class="err">etc..</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;nl-core-patient-example-1.json&quot;</span><span class="p">,</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;nl-core-patient-example-1&quot;</span><span class="p">,</span>
      <span class="nt">&quot;resourcetype&quot;</span><span class="p">:</span> <span class="s2">&quot;Patient&quot;</span><span class="p">,</span>
      <span class="nt">&quot;profile&quot;</span><span class="p">:</span> <span class="s2">&quot;http://fhir.nl/fhir/StructureDefinition/nl-core-patient&quot;</span><span class="p">,</span>
      <span class="err">etc...</span>
    <span class="p">},</span>
    <span class="err">etc..</span>
  <span class="p">],</span>
<span class="p">}</span>
</pre></div>


<p><span class="user-mention" data-user-id="191335">@Martijn Harthoorn</span> ?</p>



<a name="179188022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179188022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179188022">(Oct 27 2019 at 21:33)</a>:</h4>
<p>I don't mind this, though I worry about complexity and size</p>



<a name="179189387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179189387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179189387">(Oct 27 2019 at 22:12)</a>:</h4>
<p>I regenerated the base packages - about twice the size. committed them, so you can look at them</p>



<a name="179246155"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179246155" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179246155">(Oct 28 2019 at 16:10)</a>:</h4>
<p>Grahame, <br>
Assuming you can live without a mandatory type-id.json format<br>
Technically I think the package spec and the package cache spec are good to go. <br>
There are some textual improvements (without technical implications) still possible (like removing some duplications).</p>



<a name="179274298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179274298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179274298">(Oct 28 2019 at 20:50)</a>:</h4>
<p>Yes I no longer care about the name of the file</p>



<a name="179296735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179296735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179296735">(Oct 29 2019 at 03:13)</a>:</h4>
<p>ok I update the wiki page, consistent with what I think the decision was.</p>



<a name="179296996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179296996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179296996">(Oct 29 2019 at 03:19)</a>:</h4>
<p>We'll pretend that happened before the FHIR-I WG locked the page.  Any further changes require a vote.</p>



<a name="179297074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179297074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179297074">(Oct 29 2019 at 03:22)</a>:</h4>
<p>ok we can pretend that</p>



<a name="179501759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179501759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179501759">(Oct 31 2019 at 04:58)</a>:</h4>
<p>so...... immediately after agreeing that the package specification was under FHIR-I control, I've had to make emergency changes to the spec in order to get the technical corrections published.</p>



<a name="179501772"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179501772" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179501772">(Oct 31 2019 at 04:59)</a>:</h4>
<p>- I added a 'fhir-version-list' property to the npm package.json file, an array of string</p>
<p>This is added so that a tool an always tell what fhir-versions the package is for. This was necessary because in the past, the package would simply refer to the core dependency, even if the package it was referring to didn't- and would never - exist. Now, they can't refer to packages that don't exist. So package references can no longer tell you what FHIR version except for the major releases. And many of our balloted IGs don't depend on a major release. This won't be possible in the future anyway, so there'll be no more new IGs like this</p>
<p>- I added "sub-packages" - array of string - to package-list.json</p>
<p>This was because we now publish the main spec as a set of packages, and I had to know about them somewhere - it's only a message to the publishing tool that builds the package RSS feed</p>



<a name="179501822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179501822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179501822">(Oct 31 2019 at 05:00)</a>:</h4>
<p>FHIR-I please approve these on Monday's call. (and sorry, but I'm cleaning up an old mess and adding functionality we already agreed to, but I hadn't seen the ramifications of)</p>



<a name="179501844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179501844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179501844">(Oct 31 2019 at 05:01)</a>:</h4>
<p>I already updated the documentation</p>



<a name="179517256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517256">(Oct 31 2019 at 10:14)</a>:</h4>
<p>It's not problematic to add custom properties to the package.json, as long as they can safely be ignored by other tools and don't overlap with existing properties.</p>



<a name="179517275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517275">(Oct 31 2019 at 10:15)</a>:</h4>
<p>And with the fhir-version-list i agree.</p>



<a name="179517403"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517403" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517403">(Oct 31 2019 at 10:16)</a>:</h4>
<p>Would it be more inline with other properties to just call the property fhirVersions?</p>



<a name="179517564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517564">(Oct 31 2019 at 10:18)</a>:</h4>
<p>there was no camel case elements, so I wasn't sure. It's kind of hard to change it now</p>



<a name="179517699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517699">(Oct 31 2019 at 10:20)</a>:</h4>
<p>devDependencies</p>



<a name="179517741"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517741" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517741">(Oct 31 2019 at 10:20)</a>:</h4>
<p>?</p>



<a name="179517805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517805">(Oct 31 2019 at 10:21)</a>:</h4>
<p>is an example of a camel case property in package.json</p>



<a name="179517817"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517817" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517817">(Oct 31 2019 at 10:21)</a>:</h4>
<p>I'm not familiar with it?</p>



<a name="179517897"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517897" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517897">(Oct 31 2019 at 10:22)</a>:</h4>
<p>Neither am I. We don't use it for the fhir package spec. But it shows the pattern.</p>



<a name="179517991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179517991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179517991">(Oct 31 2019 at 10:23)</a>:</h4>
<p>oh, I only looked at what we used. If I'm going to change it, I have to change it now...</p>



<a name="179518008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179518008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179518008">(Oct 31 2019 at 10:23)</a>:</h4>
<p>It will ease your concsiousness ;)</p>



<a name="179518013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179518013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179518013">(Oct 31 2019 at 10:23)</a>:</h4>
<p>hah. it will cost me time...</p>



<a name="179519525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179519525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179519525">(Oct 31 2019 at 10:45)</a>:</h4>
<p>but done anyway</p>



<a name="179522426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179522426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179522426">(Oct 31 2019 at 11:30)</a>:</h4>
<p>I will add it to our (new) packages too.</p>



<a name="179535810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179535810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179535810">(Oct 31 2019 at 14:24)</a>:</h4>
<p>What will the format of the fhir version be? "3.0.1" or "r3" or just 3?</p>



<a name="179554896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179554896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179554896">(Oct 31 2019 at 17:27)</a>:</h4>
<p>whihc bit are you asking aout?</p>



<a name="179618330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179618330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179618330">(Nov 01 2019 at 11:39)</a>:</h4>
<p>The bit in package.json - fhirVersions property.</p>



<a name="179621972"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179621972" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179621972">(Nov 01 2019 at 12:39)</a>:</h4>
<p>3.0.1 - full 3 parts</p>



<a name="179622058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/179622058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#179622058">(Nov 01 2019 at 12:40)</a>:</h4>
<p>for me, r2 | r2b | r3 | r4 | r5 are codes for a 3 letter version e.g. 1.0, 1.4, 3.0, 4.0, and 4.1. These are independent of patch. But version references in packages are always version referenced. (at the moment)</p>



<a name="181766179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181766179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181766179">(Nov 24 2019 at 16:00)</a>:</h4>
<p>at DevDays, <span class="user-mention" data-user-id="192833">@Hans Buurman</span> (I think) claimed to me that the NPM Spec is invalid because it allows siblings directories to \packages, and we have made extensive use of them</p>



<a name="181766512"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181766512" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181766512">(Nov 24 2019 at 16:09)</a>:</h4>
<p>And indeed, from <a href="http://wiki.commonjs.org/wiki/Packages/1.0#Package_File_Format" target="_blank" title="http://wiki.commonjs.org/wiki/Packages/1.0#Package_File_Format">http://wiki.commonjs.org/wiki/Packages/1.0#Package_File_Format</a>: </p>
<blockquote>
<p>The archive must have a single top level directory.</p>
</blockquote>



<a name="181766941"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181766941" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181766941">(Nov 24 2019 at 16:19)</a>:</h4>
<p>So what I propose:</p>
<ul>
<li>update the FHIR NPM Package spec to also say this, and say that sub-folders of the package spec are not described (instead of siblings)</li>
<li>regenerate all the packages on <a href="http://hl7.org/fhir.org" target="_blank" title="http://hl7.org/fhir.org">hl7.org/fhir.org</a> to use subfolders instead of sibling folders</li>
<li>reload on <a href="http://packages.fhir.org" target="_blank" title="http://packages.fhir.org">packages.fhir.org</a></li>
</ul>
<p><span class="user-mention" data-user-id="191335">@Martijn Harthoorn</span> - thoughts?</p>



<a name="181774220"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181774220" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181774220">(Nov 24 2019 at 19:37)</a>:</h4>
<p>we should also clarify that the name of the filename in .index.json is local to the same directory as the .index.json file, and that there is one .index.json file per directory (and that it is not mandatory for directories)</p>



<a name="181774223"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181774223" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181774223">(Nov 24 2019 at 19:37)</a>:</h4>
<p>(inside the package)</p>



<a name="181775442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181775442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181775442">(Nov 24 2019 at 20:06)</a>:</h4>
<p>also, reviewing the packages (again) - some old SDC versions didn't use semver. I think I should retrospectively update them - both package, resources, and html files - to use semver. <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> </p>
<p>1.6 -&gt; 1.6.0<br>
2 -&gt; 2.0<br>
1.6 -&gt; 1.6.0<br>
2 - 2.0.0</p>



<a name="181775699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181775699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181775699">(Nov 24 2019 at 20:12)</a>:</h4>
<p>Ok</p>



<a name="181775719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181775719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181775719">(Nov 24 2019 at 20:13)</a>:</h4>
<p>Does the change to npm impact the way folders need to be organized in IG templates?</p>



<a name="181778224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181778224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181778224">(Nov 24 2019 at 21:14)</a>:</h4>
<p>no</p>



<a name="181778227"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181778227" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181778227">(Nov 24 2019 at 21:14)</a>:</h4>
<p>it's all generated</p>



<a name="181807347"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181807347" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181807347">(Nov 25 2019 at 10:09)</a>:</h4>
<p>This was <span class="user-mention" data-user-id="218569">@Hans van Amstel</span>'s comment <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span> Would be great to add his voice  to this conversation, as well that of the guys from Black Pear who had an opinion on this (<span class="user-mention" data-user-id="191325">@Dunmail</span>?)</p>



<a name="181808460"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181808460" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dunmail <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181808460">(Nov 25 2019 at 10:27)</a>:</h4>
<p>It was me! <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="181810075"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181810075" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dunmail <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181810075">(Nov 25 2019 at 10:49)</a>:</h4>
<p>As JS developer, making FHIR profiles available in packages that can be natively used in JS will be a massive leap forward because we have definitive source artefacts to use as the basis for tooling etc.</p>
<p>We understand the decision to provide the packages via a different repository. This is OK. </p>
<p>We have confirmed that we can use npm to pull a root package from the FHIR repo. However, the dependencies don't come down <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>
<p>I wonder if we could do something clever with a post-install script - any intention to use these for FHIR packages?</p>



<a name="181818103"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181818103" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181818103">(Nov 25 2019 at 12:38)</a>:</h4>
<p>It was that Hans yes</p>



<a name="181818184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181818184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181818184">(Nov 25 2019 at 12:39)</a>:</h4>
<p>We’ve said that we will prohibit scripts - security nightmare</p>



<a name="181819963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181819963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dunmail <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181819963">(Nov 25 2019 at 13:02)</a>:</h4>
<blockquote>
<p>We’ve said that we will prohibit scripts - security nightmare</p>
</blockquote>
<p>Fair enough. Will keep thinking!</p>



<a name="181820806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181820806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dunmail <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181820806">(Nov 25 2019 at 13:14)</a>:</h4>
<blockquote>
<p>We’ve said that we will prohibit scripts - security nightmare</p>
</blockquote>
<p>Next line of attack!</p>
<p>If the publisher adds a <code>package-lock.json</code>, the dependencies should resolve correctly using npm.<br>
<code>package.json</code>:</p>
<div class="codehilite"><pre><span></span>{
  &quot;name&quot;: &quot;fhir-package&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;dependencies&quot;: {
    &quot;hl7.fhir.r3.profiles&quot;: &quot;^3.0.1-preview2&quot;
  }
}
</pre></div>


<p><code>package-lock.json</code>:</p>
<div class="codehilite"><pre><span></span>{
  &quot;name&quot;: &quot;fhir-package&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;lockfileVersion&quot;: 1,
  &quot;requires&quot;: true,
  &quot;dependencies&quot;: {
    &quot;hl7.fhir.r3.profiles&quot;: {
      &quot;version&quot;: &quot;3.0.1-preview2&quot;,
      &quot;resolved&quot;: &quot;https://packages.simplifier.net//hl7.fhir.r3.profiles/-/hl7.fhir.r3.profiles-3.0.1-preview2.tgz&quot;,
      &quot;integrity&quot;: &quot;sha512-zPU5H8lWyM1D/6cWWYG6TXBHJGEPEwVi8GsOkkrh5bbjYSMdVM0ZABOC0Xbdxtxoln3RChZekdFx9Cz1eDL5gQ==&quot;,
      &quot;requires&quot;: {
        &quot;hl7.fhir.r3.profiles.extensions&quot;: &quot;3.0.1-preview1&quot;,
        &quot;hl7.fhir.r3.profiles.others&quot;: &quot;3.0.1-preview1&quot;,
        &quot;hl7.fhir.r3.profiles.resources&quot;: &quot;3.0.1-preview1&quot;,
        &quot;hl7.fhir.r3.profiles.types&quot;: &quot;3.0.1-preview1&quot;
      }
    },
    &quot;hl7.fhir.r3.profiles.extensions&quot;: {
      &quot;version&quot;: &quot;3.0.1-preview1&quot;,
      &quot;resolved&quot;: &quot;https://packages.simplifier.net//hl7.fhir.r3.profiles.extensions/-/hl7.fhir.r3.profiles.extensions-3.0.1-preview1.tgz&quot;,
      &quot;integrity&quot;: &quot;sha512-uzc1Zn6/RF3UBTSJ2m+/Auxd3Ma+PIJGIJksniSWUJtuJ1pN8COwn1IbuMWkTcHDzDkg5HXUvVUlbNz4nWl5sg==&quot;
    },
    &quot;hl7.fhir.r3.profiles.others&quot;: {
      &quot;version&quot;: &quot;3.0.1-preview1&quot;,
      &quot;resolved&quot;: &quot;https://packages.simplifier.net//hl7.fhir.r3.profiles.others/-/hl7.fhir.r3.profiles.others-3.0.1-preview1.tgz&quot;,
      &quot;integrity&quot;: &quot;sha512-GlscITM9wBAL92e4JI2GSnHO0sM6cYIIjMur+gXKeoyh8WE0aahupCq+jNeJ6Buglrq2EYc7v2I05HHzMiA7Uw==&quot;
    },
    &quot;hl7.fhir.r3.profiles.resources&quot;: {
      &quot;version&quot;: &quot;3.0.1-preview1&quot;,
      &quot;resolved&quot;: &quot;https://packages.simplifier.net//hl7.fhir.r3.profiles.resources/-/hl7.fhir.r3.profiles.resources-3.0.1-preview1.tgz&quot;,
      &quot;integrity&quot;: &quot;sha512-HRRUd3T/AdR4B4JJc9YPOxcqFGf8CxwtwEojpBPVnafg4+0KizF3DINmYgNtnYdaJq/JUhrhd9NKqL6jeMBpPQ==&quot;
    },
    &quot;hl7.fhir.r3.profiles.types&quot;: {
      &quot;version&quot;: &quot;3.0.1-preview1&quot;,
      &quot;resolved&quot;: &quot;https://packages.simplifier.net//hl7.fhir.r3.profiles.types/-/hl7.fhir.r3.profiles.types-3.0.1-preview1.tgz&quot;,
      &quot;integrity&quot;: &quot;sha512-Si02FU/olOVGONL6n0Ac2acmaR3Uwlq/ewYf0FjPBzzsbcK4+4OqN8y2bprB8qDG63UGBgrw+ykbpTUE4itZyA==&quot;
    }
  }
}
</pre></div>



<a name="181820814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181820814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181820814">(Nov 25 2019 at 13:14)</a>:</h4>
<p>The problem I have with the current format is that it does not allow me to use the default NPM tooling like: <code>nmp publish</code> and <code>npm pack</code>. Also having the package.json in the same folder as the resources is not really desirable as it contains different content as the other json files. </p>
<p>Which tools, commands did you use for creating the hl7 packages?</p>
<p>I agree it is not clearly written in the documentation. A package is created from a directory that contains a package.json file and the content. When creating a package of a directory that contains a package.json file a package directory is created by the npm tools that contains all the files and directories including the package.json file. This package directory is then the main entry point of the npm package, as shown below.  The directory name is used as the package name. <br>
This is described in: <a href="https://docs.npmjs.com/cli/publish" target="_blank" title="https://docs.npmjs.com/cli/publish">https://docs.npmjs.com/cli/publish</a>, <a href="https://docs.npmjs.com/creating-a-package-json-file" target="_blank" title="https://docs.npmjs.com/creating-a-package-json-file">https://docs.npmjs.com/creating-a-package-json-file</a> and <a href="https://docs.npmjs.com/misc/developers" target="_blank" title="https://docs.npmjs.com/misc/developers">https://docs.npmjs.com/misc/developers</a></p>
<p>I would like to propose the following package structure:<br>
<strong>&lt;package-name&gt;</strong><br>
-   <strong>package</strong><br>
- -<strong>json</strong> Mandatory (json snapshots)<br>
- - <strong>xml</strong> optional (xml snapshots)<br>
- -<strong>customSubdir</strong> optional (n times)<br>
- -<strong>package.json</strong> mandatory</p>
<p>The in between package folder is added by the tools. I used <code>npm install</code> and <code>npm pack</code> on the following directory structure to create the above package:</p>
<p><strong>&lt;package-name&gt;</strong><br>
-   <strong>json</strong> Mandatory (json snapshots)<br>
-   <strong>xml</strong> optional (xml snapshots)<br>
-   <strong>customSubdir</strong> optional (n times)<br>
-   <strong>package.json</strong></p>



<a name="181822299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181822299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dunmail <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181822299">(Nov 25 2019 at 13:34)</a>:</h4>
<blockquote>
<p>The problem I have with the current format is that it does not allow me to use the default NPM tooling like: <code>nmp publish</code> and <code>npm pack</code>. </p>
</blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="181835933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181835933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181835933">(Nov 25 2019 at 16:04)</a>:</h4>
<blockquote>
<p>The problem I have with the current format is that it does not allow me to use the default NPM tooling like: nmp publish and npm pack</p>
</blockquote>
<p><span class="user-mention" data-user-id="218569">@Hans van Amstel</span> <span class="user-mention" data-user-id="191325">@Dunmail</span> do the changes I proposed above resolve this?</p>



<a name="181835983"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181835983" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181835983">(Nov 25 2019 at 16:04)</a>:</h4>
<p>I don't understand the bit about package-lock.json. Why is package.json not sufficient?</p>



<a name="181841072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181841072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dunmail <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181841072">(Nov 25 2019 at 16:55)</a>:</h4>
<blockquote>
<p>I don't understand the bit about package-lock.json. Why is package.json not sufficient?</p>
</blockquote>
<p>npm is configured with a default package repository.<br>
npm can install a package from an alternate repository (e.g. <a href="http://simplifier.net" target="_blank" title="http://simplifier.net">simplifier.net</a>) but will try to resolve any dependencies in package.json from the default package repository (typically <a href="http://npmjs.com" target="_blank" title="http://npmjs.com">npmjs.com</a>).<br>
In this case, npm fails to install dependencies.</p>
<p>package-lock.json has supplementary info including the location from which the dependency was resolved. <br>
npm will use this information to resolve the dependencies from the the location described in package-lock.json (e.g. <a href="http://simplifier.net" target="_blank" title="http://simplifier.net">simplifier.net</a>)<br>
In this case, npm installs the dependencies.</p>
<p>I think it would be relatively easy to add package-lock.json as a step in the <a href="http://simplifier.net" target="_blank" title="http://simplifier.net">simplifier.net</a> publish service.</p>
<p>Happy to put a pair of demo packages onto <a href="http://npmjs.com" target="_blank" title="http://npmjs.com">npmjs.com</a> if that helps!</p>



<a name="181896621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181896621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181896621">(Nov 26 2019 at 07:39)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  Where can I see these proposed changes?</p>



<a name="181896764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181896764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181896764">(Nov 26 2019 at 07:43)</a>:</h4>
<blockquote>
<p>What I propose:<br>
1. update the FHIR NPM Package spec to also say this, and say that sub-folders of the package spec are not described (instead of siblings)<br>
2. regenerate all the packages on <a href="http://hl7.org/fhir.org" target="_blank" title="http://hl7.org/fhir.org">hl7.org/fhir.org</a> to use subfolders instead of sibling folders<br>
3. reload on <a href="http://packages.fhir.org" target="_blank" title="http://packages.fhir.org">packages.fhir.org</a></p>
</blockquote>



<a name="181896815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181896815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181896815">(Nov 26 2019 at 07:44)</a>:</h4>
<p>turns out that i accidentally uploaded the revised packages overnight - so you can check say <a href="http://hl7.org/fhir/us/core/package.tgz" target="_blank" title="http://hl7.org/fhir/us/core/package.tgz">http://hl7.org/fhir/us/core/package.tgz</a> to see the change in practice</p>



<a name="181908743"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181908743" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181908743">(Nov 26 2019 at 10:38)</a>:</h4>
<p>The structure that is used in <a href="http://hl7.org/fhir/us/core/package.tgz" target="_blank" title="http://hl7.org/fhir/us/core/package.tgz">http://hl7.org/fhir/us/core/package.tgz</a>, to have the content under the package folder instead of siblings, works well with <code>npm pack</code> and <code>npm install</code>. <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> <br>
What is the reason to not have a json sub folder as now the the package.json file is somewhere in the list of json fhir resources. For the tooling it does not matter but tools using the resources must now filter out the package.json file. I have no real preferences other than that it looks a bit cleaner. </p>
<p><span class="user-mention" data-user-id="191325">@Dunmail</span>  Why is a <code>package-lock.json</code> in the package needed.  According to the documentation it is recommended not to publish this. If the problem is that the dependencies are not pulled for the fhir repo you can try <code>npm config set registry &lt;FHIRrepoURL&gt; </code> before installing. This will make <code>npm install</code> try to pull all the dependencies from the registry at &lt;FHIRrepoURL&gt;. One of the big drawbacks when using <code>package-lock.json</code> is is that it only works for the top package. This means that when I have a package that depends on a package which contains a <code>package-lock.json</code> this <code>package-lock.json</code> from the dependency is ignored and the original problem remains.</p>



<a name="181909428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181909428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dunmail <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181909428">(Nov 26 2019 at 10:48)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="191325">Dunmail</span>  Why is a <code>package-lock.json</code> in the package needed.  According to the documentation it is recommended not to publish this. If the problem is that the dependencies are not pulled for the fhir repo you can try <code>npm config set registry &lt;FHIRrepoURL&gt; </code> before installing. This will make <code>npm install</code> try to pull all the dependencies from the registry at &lt;FHIRrepoURL&gt;. One of the big drawbacks when using <code>package-lock.json</code> is is that it only works for the top package. This means that when I have a package that depends on a package which contains a <code>package-lock.json</code> this <code>package-lock.json</code> from the dependency is ignored and the original problem remains.</p>
</blockquote>
<p><span class="user-mention" data-user-id="218569">@Hans van Amstel</span><br>
We'd like to create a service that includes a mix of FHIR packages and standard packages so resetting the npm registry isn't a practical option.</p>
<p>It's possible that a <code>package-lock.json</code> isn't the solution!</p>



<a name="181915924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181915924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martijn Harthoorn <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181915924">(Nov 26 2019 at 12:26)</a>:</h4>
<p>I am <br>
- fine with moving the folders to be subfolders of /package/<br>
- careful to negative about moving resources to /package/json, because it would break all packages that have already been produced.<br>
- "regenerate all the packages on <a href="http://hl7.org/fhir.org" target="_blank" title="http://hl7.org/fhir.org">hl7.org/fhir.org</a>" is not really a thing in the world of packes. People depend on it. With some effort, we can make it work once, but I strongly hope this is not going to be a regular practice.</p>



<a name="181921886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181921886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181921886">(Nov 26 2019 at 13:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191335">@Martijn Harthoorn</span> I agree that this should not be regular practice. But the structure as defined was in proposal, as I understood from the DevDays2019 talk. <br>
About moving the resources to /package/json I do not have a real preference but as the packages needs to be regenerated it can be done in one go. </p>
<p><span class="user-mention" data-user-id="191325">@Dunmail</span> I get the need for this we actually have the same need and use for this a setup with a virtual registry that contains a local registry and a remote one. This has the added advantage that it also functions as a caching proxy and therefore are less depended on packages to not change just before doing a release for example. But I think this is beyond the discussion of the package format.</p>



<a name="181928023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181928023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181928023">(Nov 26 2019 at 14:51)</a>:</h4>
<blockquote>
<p>Regenerate all the packages </p>
</blockquote>
<p>I agree that this is not something we should do regularly. And in fact, I only propose this because I don’t care whether it gets distributed or not. But it would be good to get them into <a href="http://packages.fhir.org" target="_blank" title="http://packages.fhir.org">packages.fhir.org</a></p>



<a name="181957109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/NPM%20Package%20Spec/near/181957109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/NPM.20Package.20Spec.html#181957109">(Nov 26 2019 at 19:51)</a>:</h4>
<blockquote>
<p>careful to negative about moving resources to /package/json, because it would break all packages that have already been produced.</p>
</blockquote>
<p>I basically agree with this. Sure, we could do it, but it's not hard to separate out package.json and .index.json (and .index.json will still exist)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
