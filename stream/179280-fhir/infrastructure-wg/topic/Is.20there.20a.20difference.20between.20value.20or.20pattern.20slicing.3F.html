---
layout: page
title: "FHIR Chat  · Is there a difference between value or pattern slicing? · fhir/infrastructure-wg"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/index.html">fhir/infrastructure-wg</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html">Is there a difference between value or pattern slicing?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="178950150"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178950150" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marco Visser <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178950150">(Oct 24 2019 at 13:16)</a>:</h4>
<p>When I read the specs at <a href="https://www.hl7.org/fhir/profiling.html#discriminator" target="_blank" title="https://www.hl7.org/fhir/profiling.html#discriminator">https://www.hl7.org/fhir/profiling.html#discriminator</a> I noticed that when we are doing value slicing or pattern slicing that  </p>
<div class="codehilite"><pre><span></span>then the element definition must use either:
- ElementDefinition.fixed[x], or
- ElementDefinition.pattern[x], or
- if the element has a terminology binding, a required binding with a Value Set that enumerates the list of possible codes in the value set (&quot;extensional definition&quot;)
</pre></div>


<p>I read that as follows: each ElementDefinition defining the slice must either have a fixed[x] or pattern[x] or binding constraint. If that is the case, what is then the difference between  value slicing and pattern slicing?</p>
<p>In the FHIR .NET Api, we only allow the fixed[x] and binding constraint for a value slicing and a pattern[x] constraint for the pattern slicing. But I have the feeling that is not correct. Am I right?</p>



<a name="178965606"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178965606" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178965606">(Oct 24 2019 at 15:45)</a>:</h4>
<p>Value must match exactly - no extra elements or extensions.  Pattern must match what's specified but is free to have extra elements including extra repetitions.  As a result, pattern is usually better.</p>



<a name="178969777"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178969777" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178969777">(Oct 24 2019 at 16:26)</a>:</h4>
<p>Note however that the <a href="http://hl7.org/fhir/R4/elementdefinition-definitions.html#ElementDefinition.pattern_x_" target="_blank" title="http://hl7.org/fhir/R4/elementdefinition-definitions.html#ElementDefinition.pattern_x_">documentation for pattern[x]</a> states:</p>
<blockquote>
<p>In general, pattern[x] is not intended for use with primitive types, where is has the same meaning as fixed[x].</p>
</blockquote>
<p>So if you're fixing a primitive, <code>fixed[x]</code> is preferred.</p>



<a name="178969981"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178969981" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178969981">(Oct 24 2019 at 16:28)</a>:</h4>
<p>As it relates to slicing, it's also helpful to consider that if you're fixing more than one part of a complex type (like <code>code</code> and <code>system</code> in a <code>CodeableConcept</code> or <code>Coding</code>), then using <code>pattern[x]</code> allows you to have a simpler (single) discriminator rather than two discriminators.  It also prevents you from needing to use slicing when fixing <code>code</code>/<code>system</code> of a <code>CodeableConcept</code>.</p>



<a name="178972407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178972407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178972407">(Oct 24 2019 at 16:52)</a>:</h4>
<p>It doesn't <em>quite</em> have the same meaning as 'fixed.  A pattern would allow extensions on the primitive.  A fixed value would not.</p>



<a name="178975622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178975622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178975622">(Oct 24 2019 at 17:24)</a>:</h4>
<p>I feel as though we haven't actually answered the question. I don't know off the top of my head what the validator does, but I agree with this in principle:</p>
<blockquote>
<p>we only allow the fixed[x] and binding constraint for a value slicing and a pattern[x] constraint for the pattern slicing</p>
</blockquote>



<a name="178988486"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178988486" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178988486">(Oct 24 2019 at 19:32)</a>:</h4>
<blockquote>
<p>It doesn't quite have the same meaning as 'fixed. A pattern would allow extensions on the primitive. A fixed value would not.</p>
</blockquote>
<p>Right -- which is why it probably says "in general".  But in practice, I haven't seen too many primitives with a <code>pattern[x]</code>.  That said, I think it might be helpful to actually state that meaningful distinction in the spec itself so people understand exactly what they're disallowing when using <code>fixed[x]</code> with a primitive.</p>



<a name="178989194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178989194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178989194">(Oct 24 2019 at 19:39)</a>:</h4>
<p>I might go so far as to raise a warning when someone slices be value instead of by pattern.</p>



<a name="178989387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178989387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178989387">(Oct 24 2019 at 19:41)</a>:</h4>
<blockquote>
<p>I don't know off the top of my head what the validator does, but I agree with this in principle:</p>
<blockquote>
<p>we only allow the fixed[x] and binding constraint for a value slicing and a pattern[x] constraint for the pattern slicing</p>
</blockquote>
</blockquote>
<p><a href="http://hl7.org/fhir/R4/profiling.html#discriminator" target="_blank" title="http://hl7.org/fhir/R4/profiling.html#discriminator">Section 5.1.0.11</a> makes it fairly clear that the <code>pattern</code> discriminator type must be accompanied by the <code>pattern[x]</code> construct.  In the first table it says:</p>
<blockquote>
<p>pattern: The slices have different values in the nominated element, as determined by testing them against the applicable ElementDefinition.pattern[x].</p>
</blockquote>
<p>It doesn't state that <code>value</code> corresponds directly (and only) to <code>fixed[x]</code> however.  And the following language makes it sound kind of ambiguous:</p>
<blockquote>
<p>If the type is value, or pattern, then the element definition must use either:<br>
- ElementDefinition.fixed[x], or<br>
- ElementDefinition.pattern[x], or<br>
- if the element has a terminology binding, a required binding with a Value Set that enumerates the list of possible codes in the value set ("extensional definition")</p>
</blockquote>
<p>I think associating <code>value</code> to <code>fixed[x]</code> makes sense (and is most implementable) -- but it would complicate a hypothetical situation in which a set of elements uses <code>pattern[x]</code> to apply expected codes (<code>Coding</code> or <code>CodeableConcept</code>) but the slices should discriminate on the code <code>system</code> only.</p>



<a name="178994419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178994419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178994419">(Oct 24 2019 at 20:33)</a>:</h4>
<p>note from the <a class="stream" data-stream-id="179177" href="/#narrow/stream/179177-conformance">#conformance</a> stream - there's a use case for mixing pattern and binding?</p>



<a name="178994515"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/178994515" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#178994515">(Oct 24 2019 at 20:33)</a>:</h4>
<p>I'm not actually sure that differentiating pattern and value on the discriminator makes sense - we can delegate that to the slices, and decide that value and pattern are effectively synonyms?</p>



<a name="179009820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179009820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179009820">(Oct 24 2019 at 23:56)</a>:</h4>
<p>Not sure I understand what you're proposing <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>?</p>



<a name="179010071"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179010071" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179010071">(Oct 25 2019 at 00:00)</a>:</h4>
<p>at present there is no way to mix pattern and value set binding in a single set of slices</p>



<a name="179010113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179010113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179010113">(Oct 25 2019 at 00:01)</a>:</h4>
<p>but we also have an anti-pattern here: we say at the start of the slicing whether it's a value or a pattern, and then have value or pattern fields - I can't see how that's useful.</p>



<a name="179011857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179011857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179011857">(Oct 25 2019 at 00:31)</a>:</h4>
<p>So your proposal is to merge the slicing types (or more specifically to deprecate one, given that it's already normative) and to allow valueset, fixed and pattern to all be used by the same slicing type?  I could live with that.  (Would still like to spit out warnings or at least "good practice" alerts whenever someone uses 'fixed'.</p>



<a name="179012648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179012648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179012648">(Oct 25 2019 at 00:42)</a>:</h4>
<p>I think that something like that would make more sense</p>



<a name="179042181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179042181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179042181">(Oct 25 2019 at 11:48)</a>:</h4>
<p>The proposal sounds ok to me. So wich type is normative, value?<br>
( I believe we described a use case for mixing pattern and valueset binding here: <a href="#narrow/stream/179177-conformance/topic/Slicing.20and.20value.20sets" title="#narrow/stream/179177-conformance/topic/Slicing.20and.20value.20sets">zulip chat</a> )</p>



<a name="179046936"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179046936" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179046936">(Oct 25 2019 at 13:01)</a>:</h4>
<p>Both are.  We'll have to deprecated one.   And if we see it, we'll treat it the same as the other</p>



<a name="179306641"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179306641" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179306641">(Oct 29 2019 at 07:43)</a>:</h4>
<p>Shall I create a gforge ticket? Or does one already exists?</p>



<a name="179311312"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/179311312" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#179311312">(Oct 29 2019 at 09:12)</a>:</h4>
<p>I don't think one does</p>



<a name="180507420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/180507420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#180507420">(Nov 12 2019 at 11:46)</a>:</h4>
<p><a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=25206" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=25206">gForge id 25206</a></p>



<a name="189312720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/189312720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#189312720">(Feb 28 2020 at 14:10)</a>:</h4>
<p>Here the link to the ticket on Confluence:  <a href="https://jira.hl7.org/browse/FHIR-25206" target="_blank" title="https://jira.hl7.org/browse/FHIR-25206">https://jira.hl7.org/browse/FHIR-25206</a><br>
<span class="user-mention" data-user-id="191316">@Grahame Grieve</span> , do you know the status of this issue? Wasn't this already discussed with FHIR-I?</p>



<a name="189338295"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/189338295" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#189338295">(Feb 28 2020 at 18:41)</a>:</h4>
<p>doesn't look like it?</p>



<a name="189432387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Is%20there%20a%20difference%20between%20value%20or%20pattern%20slicing%3F/near/189432387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Is.20there.20a.20difference.20between.20value.20or.20pattern.20slicing.3F.html#189432387">(Mar 01 2020 at 12:52)</a>:</h4>
<p>Could we discuss this issue in one of the next FHIR-I calls? <span class="user-mention" data-user-id="192301">@Ardon Toonstra</span> and I could make sure that everyone relevant for the discussion from Firely is present.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
