---
layout: page
title: "FHIR Chat  · Sorting versions of knowledge artifacts · fhir/infrastructure-wg"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/index.html">fhir/infrastructure-wg</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html">Sorting versions of knowledge artifacts</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="267550454"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/267550454" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bas van den Heuvel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#267550454">(Jan 11 2022 at 08:30)</a>:</h4>
<p>Knowledge resources are identified by their cannonical <em>url</em> and the <em>version</em>. The specification states that when the <em>version</em>is not specified, the "most recent" version should be used. The specification does not specify how to order the versions.<br>
This topic is related to the topic raised in <a href="https://jira.hl7.org/browse/FHIR-26370">https://jira.hl7.org/browse/FHIR-26370</a>. Which was discussed in the FHIR-i telco of 2022-01-10, in which a possible solution was proposed on which we would like to receive feedback.</p>
<p>FHIR versions use semantic versioning (<a href="http://hl7.org/fhir/r4/versions.html#versions">http://hl7.org/fhir/r4/versions.html#versions</a>) to identify the version of the specification.<br>
This would work as well for knowledge resources such as ValueSets, CodeSystems, PlanDefinitions, .... Mandating this would be tricky as some parties are likely to use other versioning mechanisms such as: string sort, numbers, dates, ...</p>
<p>Yet without knowledge of the sorting algorithm to use, the most recent version cannot be found.</p>
<p>I propose that we resolve this issues in the following manner:</p>
<p>Knowledge artifacts will use semantic versioning for their version numbers unless a different algorithm is specified using an extension. </p>
<p>An initial proposal for such extension could be:</p>
<p><strong>Extension:</strong> SortAlgorithmExtension<br>
<strong>Id:</strong> sort-algorithm<br>
<strong>Title:</strong> Sorting Algorithm Extension<br>
<strong>Description:</strong> """<br>
This extension defines the algorithm to be used to determine the most recent version of a knowledge artifact. The algorithm indicates in what manner the version of this knowledge artifact can be compared to previous versions.<br>
For default algoritihms, a default set of values have been defined. More advanced use cases can use an fhirpath expression.</p>
<p>In the case the fhirpath expression is used, the context will be knowledge artifact holding, the extension. The variable %previousVersion refers to the version it is compared to. The FHIRpath expression SHALL evaluate to a boolean. The value true indicates the version of the ValueSet holding the extension is more recent than the ValueSet it compares to.<br>
"""</p>
<ul>
<li>value[x] only Coding or string</li>
<li>valueCoding from SortingAlgorithms (extensible)</li>
</ul>
<p><strong>ValueSet:</strong> SortingAlgorithms<br>
<strong>Title:</strong> "Sorting Algorithms"<br>
<strong>Description:</strong> "Algorithms used for sorting versions"</p>
<ul>
<li>$HL7#integer "Value represents an integer version."</li>
<li>$HL7#date    "Value represents an ISO8601 date."</li>
<li>$HL7#string  "Value represents a string and string sort should be used to order them."</li>
<li>$HL7#integer "Value represents an integer version."</li>
</ul>



<a name="267589674"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/267589674" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#267589674">(Jan 11 2022 at 14:36)</a>:</h4>
<p>integer is listed twice?  We should also clarify string sort, as there are multiple string sorting algorithms (e.g. how are accented characters or upper and lower case ordered).   Date should also allow for partial date.  E.g. YYYY or YYYY-MM, but we might want to dictate that different schemes can't intermix.  E.g. you can't use both YYYY-MM and YYYY-DDD or YYYY-MM-DD and YYYYMMDD (all of which are valid 8601 syntaxes)</p>
<p>Even HL7 is sort of moving away from SEMVER.  We're going to be moving to something like 5.1.0-ballot1 and 5.1.0-draft.  The 'sort' order of those is going to get messy...</p>



<a name="267591344"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/267591344" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#267591344">(Jan 11 2022 at 14:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179280-fhir.2Finfrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts/near/267589674">said</a>:</p>
<blockquote>
<p>Even HL7 is sort of moving away from SEMVER.  We're going to be moving to something like 5.1.0-ballot1 and 5.1.0-draft.  The 'sort' order of those is going to get messy...</p>
</blockquote>
<p>Actually, I think HL7 is moving <em>closer</em> to SEMVER, as this approach (adding a <code>-label</code> at the end) <em>is</em> the SEMVER way of doing pre-releases (as opposed to what HL7 was doing before, which violated SEMVER).  See: <a href="https://semver.org/#spec-item-9">https://semver.org/#spec-item-9</a>.</p>
<p>The SEMVER spec does indicate how sorting should happen with pre-releases.  See step 11 <a href="https://semver.org/#semantic-versioning-specification-semver">here</a>.  Now... we've chosen non-standard prerelease identifiers, so... you're right -- sorting might still be messy unless it just sort of works out by chance.</p>



<a name="267592841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/267592841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#267592841">(Jan 11 2022 at 14:57)</a>:</h4>
<p>We haven't talked about what our labels will be, so I guess we could theoretically avoid messing it up...</p>



<a name="268778788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/268778788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#268778788">(Jan 21 2022 at 00:32)</a>:</h4>
<p>I notice that the tracker for the operation to request for this passed (good) but still need answer to this to evaluate.<br>
I like the valueset proposed.<br>
And wonder where this extension would live, and what would happen if the extension value was different in different versions?</p>



<a name="268782681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/268782681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#268782681">(Jan 21 2022 at 01:12)</a>:</h4>
<p>If it's different in different versions, then I'd probably return an error.  Extension could live at the root or on version.  Preferences?</p>



<a name="269053701"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269053701" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269053701">(Jan 24 2022 at 02:27)</a>:</h4>
<p>Still no detail on how to call the API and request to resolve the latest resource, the disposition only covers the data to store about the algorithm, not how to call it.<br>
I'm not a fan of the proposal in the tracker, do we need to log another tracker, or is there another already there?<br>
I like the idea of an operation for this e.g.<br>
<code>[base]/ValueSet/$resolve?url=http://hl7.org/fhir/ValueSet/marital-status&amp;version=4.0.1&amp;mode=exact&amp;status=active,retired</code><br>
where mode could be exact, exactOrCurrent, current, <br>
version is optional<br>
status is optional and provides a list of statuses to consider</p>



<a name="269054303"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269054303" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269054303">(Jan 24 2022 at 02:39)</a>:</h4>
<p>If you have version, no need to call an operation - just do a search...</p>



<a name="269054351"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269054351" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269054351">(Jan 24 2022 at 02:40)</a>:</h4>
<p>Don't understand the purpose of mode=exact.</p>



<a name="269054574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269054574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269054574">(Jan 24 2022 at 02:46)</a>:</h4>
<p>Searching doesn't help you find the most recent, and doesn't consider statuses in a predictable way.</p>



<a name="269054672"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269054672" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269054672">(Jan 24 2022 at 02:48)</a>:</h4>
<p>And we'd need to change the version search parameter to something different, there is nothing in search-token about text values and modifiers.</p>



<a name="269054754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269054754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269054754">(Jan 24 2022 at 02:50)</a>:</h4>
<p>If you're specifying a version, you're not going to find the most recent.<br>
My expectation was <code>[base]/ValueSet/$most-recent?url=http//hl7.org/fhir/ValueSet/marital-status&amp;status=active,retired</code>.  I don't see a need for other parameters.  Response would either be a ValueSet instance or an OperationOutcome.</p>



<a name="269054779"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269054779" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269054779">(Jan 24 2022 at 02:51)</a>:</h4>
<p>I didn't see anything about a $most-recent anywhere, have I missed something?</p>



<a name="269054885"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269054885" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269054885">(Jan 24 2022 at 02:54)</a>:</h4>
<p>Actually, I guess the proposed name is $current-canonical.  <a href="http://jira.hl7.org/browse/FHIR-35834">FHIR#35834</a></p>



<a name="269055032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269055032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269055032">(Jan 24 2022 at 02:57)</a>:</h4>
<p>Thanks, that's what I was missing, looks ok to me.</p>



<a name="269055089"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179280-fhir/infrastructure-wg/topic/Sorting%20versions%20of%20knowledge%20artifacts/near/269055089" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179280-fhir/infrastructure-wg/topic/Sorting.20versions.20of.20knowledge.20artifacts.html#269055089">(Jan 24 2022 at 02:58)</a>:</h4>
<p>So all resolved and I can implement that and try things out.<br>
Thanks</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
