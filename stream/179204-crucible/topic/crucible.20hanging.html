---
layout: page
title: "FHIR Chat  · crucible hanging · crucible"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/index.html">crucible</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html">crucible hanging</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="160002193"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160002193" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Spencer <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160002193">(Mar 05 2019 at 13:23)</a>:</h4>
<p>Hello again</p>
<p>We've deployed a public server and are attempting to run crucible against it.  It seems to consistently get stuck after about half an hour, not always in exactly the same place.  Once it gets stuck we can see from the logs that we're no longer receiving http requests from it.  I've run a local crucible in docker-compose against it and that runs the tests to completion.</p>
<p><a href="https://projectcrucible.org/servers/5c791f4404ebd07fa1000000" target="_blank" title="https://projectcrucible.org/servers/5c791f4404ebd07fa1000000">https://projectcrucible.org/servers/5c791f4404ebd07fa1000000</a></p>
<p>Last request from that run was at 13:07:42</p>



<a name="160005237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160005237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160005237">(Mar 05 2019 at 14:06)</a>:</h4>
<p>Hmmm, thanks Ben, we'll take a look.  Looks like it is hanging on 'Resource Test Supply Delivery' right now. <a href="/user_uploads/10155/i43lwejGHGzVvDnHaFXcec7i/Screen-Shot-2019-03-05-at-9.05.00-AM.png" target="_blank" title="Screen-Shot-2019-03-05-at-9.05.00-AM.png">Screen-Shot-2019-03-05-at-9.05.00-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/i43lwejGHGzVvDnHaFXcec7i/Screen-Shot-2019-03-05-at-9.05.00-AM.png" target="_blank" title="Screen-Shot-2019-03-05-at-9.05.00-AM.png"><img src="/user_uploads/10155/i43lwejGHGzVvDnHaFXcec7i/Screen-Shot-2019-03-05-at-9.05.00-AM.png"></a></div>



<a name="160005409"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160005409" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160005409">(Mar 05 2019 at 14:09)</a>:</h4>
<p>In the past we have had some problems when running the full barrage of tests, though it wasn't consistent enough to replicate and track down the issue.  I believe our running hypothesis was either the JSON parsing or XML parsing libraries caused some kind of fatal error to occur.</p>



<a name="160005421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160005421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160005421">(Mar 05 2019 at 14:09)</a>:</h4>
<p>From what you can tell, is it always failing on the same test?</p>



<a name="160005508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160005508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160005508">(Mar 05 2019 at 14:10)</a>:</h4>
<p>We also should have a cleanup job that identifies stalled tests, kills them, and resumes when this type of thing happens, but if it has been stuck awhile then perhaps that isn't working either</p>



<a name="160005946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160005946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Spencer <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160005946">(Mar 05 2019 at 14:17)</a>:</h4>
<p>From what I can tell, it's <em>not</em> always failing on the same test, but it does seem to be roughly in the same place, somewhere in the Base Resources / Clinical Resources / Financial Resources sections</p>
<p>Let me know if I can provide any more information from our end.</p>



<a name="160023099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160023099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160023099">(Mar 05 2019 at 17:40)</a>:</h4>
<p>Turns out our process that identifies stalled jobs and restarts them had been disabled due a cron issue, I re-enabled it and now the test will get marked as a fatal 'Crucible Error', and Crucible will pick up on the next test in the run. <a href="/user_uploads/10155/iu2_p9gwpS25NT5svp6WVYUS/Screen-Shot-2019-03-05-at-12.37.05-PM.png" target="_blank" title="Screen-Shot-2019-03-05-at-12.37.05-PM.png">Screen-Shot-2019-03-05-at-12.37.05-PM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/iu2_p9gwpS25NT5svp6WVYUS/Screen-Shot-2019-03-05-at-12.37.05-PM.png" target="_blank" title="Screen-Shot-2019-03-05-at-12.37.05-PM.png"><img src="/user_uploads/10155/iu2_p9gwpS25NT5svp6WVYUS/Screen-Shot-2019-03-05-at-12.37.05-PM.png"></a></div>



<a name="160023179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160023179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160023179">(Mar 05 2019 at 17:40)</a>:</h4>
<p>Not ideal, but at least Crucible gracefully recovers now.</p>



<a name="160023221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160023221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160023221">(Mar 05 2019 at 17:41)</a>:</h4>
<p>... and the rest of the tests will be run.</p>



<a name="160076649"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160076649" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Spencer <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160076649">(Mar 06 2019 at 08:31)</a>:</h4>
<p>thanks Robert!</p>



<a name="160076740"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160076740" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Spencer <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160076740">(Mar 06 2019 at 08:32)</a>:</h4>
<p>is it likely that the error was caused by something on our end?</p>



<a name="160113198"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160113198" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160113198">(Mar 06 2019 at 16:57)</a>:</h4>
<p>We've seen this happen on other servers, so it is unlikely that you are doing anything wrong.  Let me know if things get stuck again -- I expect you'll still see the occasional 'Unrecoverable Crucible Error', but the tests shouldn't hang indefinitely any more</p>



<a name="160113270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179204-crucible/topic/crucible%20hanging/near/160113270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Scanlon <a href="https://fhir.github.io/chat-archive/stream/179204-crucible/topic/crucible.20hanging.html#160113270">(Mar 06 2019 at 16:58)</a>:</h4>
<p>Thanks for reporting that issue!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
