---
layout: page
title: "FHIR Chat  · Using liquid · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html">Using liquid</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="193854219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193854219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193854219">(Apr 14 2020 at 06:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191387">@Keith Boone</span> asked for more documentation about how to use liquid. So here goes:</p>



<a name="193854257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193854257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193854257">(Apr 14 2020 at 06:23)</a>:</h4>
<p>in your IG you define a parameter <code>path-liquid</code> that points to a directory where you have liquid templates. E.g. <code>path-liquid</code>=<code>liquid</code></p>



<a name="193854319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193854319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193854319">(Apr 14 2020 at 06:24)</a>:</h4>
<p>then, in that directory, you have a series of files like  <code>Patient.liquid</code> - .e.g with the name of the resource that they are the template for</p>



<a name="193854342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193854342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193854342">(Apr 14 2020 at 06:25)</a>:</h4>
<p>the liquid template will be executed automatically when generating the narrative for any resource of that type.</p>



<a name="193854349"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193854349" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193854349">(Apr 14 2020 at 06:25)</a>:</h4>
<p>the liquid spec is found here: <a href="https://confluence.hl7.org/display/FHIR/FHIR+Liquid+Profile" title="https://confluence.hl7.org/display/FHIR/FHIR+Liquid+Profile">https://confluence.hl7.org/display/FHIR/FHIR+Liquid+Profile</a></p>



<a name="193854351"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193854351" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193854351">(Apr 14 2020 at 06:25)</a>:</h4>
<p>here's an example:</p>



<a name="193854913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193854913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193854913">(Apr 14 2020 at 06:34)</a>:</h4>
<div class="codehilite"><pre><span></span>&lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
  &lt;table&gt;
  &lt;tbody&gt;
   &lt;tr&gt;
    &lt;td&gt; Name&lt;/td&gt;
    &lt;td&gt;
<span class="p">{%</span><span class="nt">loop</span><span class="w"> </span>name<span class="w"> </span>in<span class="w"> </span>Patient.name<span class="p">%}</span>
 &lt;b&gt;<span class="p">{{</span><span class="nv">name</span><span class="p">.</span><span class="nv">family</span><span class="p">}}</span>&lt;/b&gt;, <span class="p">{{</span><span class="nv">name</span><span class="p">.</span><span class="nv">given</span><span class="p">}}</span> &lt;/br&gt;
<span class="p">{%</span><span class="nt">endloop</span><span class="p">%}</span>
    &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt; Address&lt;/td&gt;
    &lt;td&gt;<span class="p">{{</span><span class="nv">Patient</span><span class="p">.</span><span class="nv">address</span><span class="p">.</span><span class="nv">text</span><span class="p">}}</span>&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt; Contacts&lt;/td&gt;
    &lt;td&gt; Home: unknown. Work: (03) 5555 6473&lt;/td&gt;
  &lt;/tr&gt;
  <span class="p">{%</span><span class="kr">if</span><span class="w"> </span><span class="nv">Patient</span><span class="p">.</span><span class="nv">identifier</span><span class="p">.</span><span class="nv">exists</span><span class="err">()</span><span class="p">%}</span>
  &lt;tr&gt;
    &lt;td&gt; Id&lt;/td&gt;
    &lt;td&gt; <span class="p">{{</span><span class="nv">identifier</span><span class="err">[</span><span class="mi">0</span><span class="err">].</span><span class="nv">type</span><span class="p">.</span><span class="nv">text</span><span class="p">}}</span>: <span class="p">{{</span><span class="nv">identifier</span><span class="err">[</span><span class="mi">0</span><span class="err">].</span><span class="nv">value</span><span class="p">}}</span>&lt;/td&gt;
  &lt;/tr&gt;
  <span class="p">{%</span><span class="kr">endif</span><span class="p">%}</span>
  &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;
</pre></div>



<a name="193855162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193855162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193855162">(Apr 14 2020 at 06:38)</a>:</h4>
<p>there's a rather useful FHIRPath function defined in the IG publisher called <code>.render() </code> which applies to data types which takes a lot of the finickity work out of this - you can use it on any data type, and it will generate the text that it think best represents the data type</p>



<a name="193855204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193855204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193855204">(Apr 14 2020 at 06:39)</a>:</h4>
<p>e.g. the fragment above, you want to render and address... well, you can write liquid for all the possible combinations of Address... you can just do .render() and let my code do it.. and mostly my code is pretty robust</p>



<a name="193855261"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193855261" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193855261">(Apr 14 2020 at 06:40)</a>:</h4>
<p>Keith - let me know if you want more... and it would be lovely if someone turned this into doco somewhere,,,?</p>



<a name="193860394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193860394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193860394">(Apr 14 2020 at 07:47)</a>:</h4>
<p>Somewhere = the guidance IG?</p>



<a name="193874310"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193874310" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193874310">(Apr 14 2020 at 09:59)</a>:</h4>
<p>probably confluence for thta</p>



<a name="193874329"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/193874329" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#193874329">(Apr 14 2020 at 09:59)</a>:</h4>
<p>though an example in the guidance IG would also be excellent</p>



<a name="199809115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199809115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199809115">(Jun 04 2020 at 21:13)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  will  .render()  work for references and url so that you get a link?  It currently causes an error when I try to use it like so...</p>
<div class="codehilite"><pre><span></span><code>&lt;ul&gt;
<span class="p">{%</span><span class="w"> </span><span class="nt">for</span><span class="w"> </span>var<span class="w"> </span>in<span class="w"> </span>Subscription.modifierExtension<span class="w"> </span><span class="p">%}</span>
&lt;li&gt;(&lt;strong&gt;url:&lt;/strong&gt; <span class="p">{{</span><span class="nv">var</span><span class="p">.</span><span class="nv">url</span><span class="p">.</span><span class="nv">render</span><span class="err">()</span><span class="p">}}</span>, &lt;strong&gt;value: &lt;/strong&gt;<span class="p">{{</span><span class="nv">var</span><span class="p">.</span><span class="nv">valueUri</span><span class="p">.</span><span class="nv">render</span><span class="err">()</span><span class="p">}}</span>)&lt;/li&gt;
<span class="p">{%</span><span class="w"> </span><span class="nt">endfor</span><span class="w"> </span><span class="p">%}</span>
&lt;/ul&gt;
</code></pre></div>



<a name="199809219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199809219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199809219">(Jun 04 2020 at 21:14)</a>:</h4>
<p>there is a " not yet implemented error" error</p>



<a name="199809763"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199809763" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199809763">(Jun 04 2020 at 21:19)</a>:</h4>
<p>have you got a full stack?</p>



<a name="199810834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199810834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199810834">(Jun 04 2020 at 21:30)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Load Content                                                                     (00:56.0332)
Processing Conformance Resources                                                 (00:56.0852)
Publishing Content Failed: Not done yet (IGPublisherHostServices.resolveFunction) (00:58.0736)
                                                                                 (00:58.0737)
Use -? to get command line help                                                  (00:58.0737)
                                                                                 (00:58.0737)
Stack Dump (for debugging):                                                      (00:58.0738)
org.apache.commons.lang3.NotImplementedException: Not done yet (IGPublisherHostServices.resolveFunction)
    at org.hl7.fhir.igtools.publisher.Publisher$IGPublisherHostServices.resolveFunction(Publisher.java:377)
    at org.hl7.fhir.r5.utils.LiquidEngine.resolveFunction(LiquidEngine.java:623)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parseExpression(FHIRPathEngine.java:902)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parseExpression(FHIRPathEngine.java:938)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parseExpression(FHIRPathEngine.java:938)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parse(FHIRPathEngine.java:369)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parse(FHIRPathEngine.java:362)
    at org.hl7.fhir.r5.utils.LiquidEngine$LiquidStatement.evaluate(LiquidEngine.java:141)
    at org.hl7.fhir.r5.utils.LiquidEngine$LiquidFor.evaluate(LiquidEngine.java:268)
    at org.hl7.fhir.r5.utils.LiquidEngine.evaluate(LiquidEngine.java:102)
    at org.hl7.fhir.r5.renderers.LiquidRenderer.render(LiquidRenderer.java:65)
    at org.hl7.fhir.r5.renderers.ResourceRenderer.render(ResourceRenderer.java:76)
    at org.hl7.fhir.igtools.publisher.Publisher.generateNarratives(Publisher.java:1032)
    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3605)
    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:834)
    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:696)
    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7430)
(venv37) Erics-MacBook-Air-2:subscription-backport-ig ehaas$
</code></pre></div>



<a name="199810942"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199810942" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199810942">(Jun 04 2020 at 21:31)</a>:</h4>
<p>it could be user error or misuse.  i am not sure what it would do for a url.</p>



<a name="199831481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199831481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199831481">(Jun 05 2020 at 02:50)</a>:</h4>
<p>I got this to work on Patient and Subscription but not on Bundle.  Is there a reason why can't use on Bundles?</p>



<a name="199831563"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199831563" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199831563">(Jun 05 2020 at 02:53)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ?</p>



<a name="199832744"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199832744" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199832744">(Jun 05 2020 at 03:25)</a>:</h4>
<p>narrative generation won't work for bundles since they don't have narrative</p>



<a name="199918727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199918727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199918727">(Jun 05 2020 at 18:44)</a>:</h4>
<p>Ah stupid me...the Ig publisher is generating a display for them nonetheless, is that a template used by the publisher and can that be customized?</p>



<a name="199932244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/199932244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#199932244">(Jun 05 2020 at 20:48)</a>:</h4>
<p>to some degree - some bundles are rendered differently, but other than the special cases, the rendering is a series of html fragments separated by &lt;hr/&gt;, and where the default renderer is used for each entry. So liquid would apply</p>



<a name="227102824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227102824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227102824">(Feb 20 2021 at 16:40)</a>:</h4>
<p>I need to use this to render PlanDefinitions, but only a specific profile of PlanDefinitions.</p>



<a name="227102964"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227102964" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227102964">(Feb 20 2021 at 16:43)</a>:</h4>
<p>Is this a big change to ask?</p>



<a name="227514754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227514754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227514754">(Feb 23 2021 at 22:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> the reason for me to ask this is:<br>
I want to render some resources using some liquid templates. For this, I need to tell the publisher:</p>
<ul>
<li>resource type A, profile 1 - liquid template X</li>
<li>resource type A, profile 2 - liquid template Y</li>
<li>resource type B, profile 1 - liquid template Z<br>
For this I need to tell the template what to do for each. Currently I'd have to do a big IF THEN ELSE.</li>
</ul>



<a name="227514796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227514796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227514796">(Feb 23 2021 at 22:19)</a>:</h4>
<p>Some of these resources are expected to be custom resources, so i need to differentiate the flavours</p>



<a name="227542203"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227542203" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227542203">(Feb 24 2021 at 03:23)</a>:</h4>
<p>at the moment you can't have different liquid templates for different profiles</p>



<a name="227551501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227551501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227551501">(Feb 24 2021 at 05:48)</a>:</h4>
<p>Is that something we could expose? Or too much work?</p>



<a name="227552395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227552395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227552395">(Feb 24 2021 at 06:03)</a>:</h4>
<p>I don't know. I haven't really thought about it</p>



<a name="227554827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227554827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227554827">(Feb 24 2021 at 06:38)</a>:</h4>
<p>If in my liquid folder I have not only <code>plandefinition.liquid</code> but also <code>plandefinition-homecare.liquid</code> and <code>plandefinition-medicationtreatment.liquid</code> and if the publisher would know the difference (i.e. <code>homecare</code>and <code>medicationtreatment</code> are the profile ids) that would be helpful</p>



<a name="227717963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227717963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227717963">(Feb 25 2021 at 04:57)</a>:</h4>
<p>Is there a way to discover which liquid variables are defined in an IG?<br>
I have found <a href="https://confluence.hl7.org/display/FHIR/FHIR+Liquid+Profile">https://confluence.hl7.org/display/FHIR/FHIR+Liquid+Profile</a> but values like {{ page.title }} are not mentioned.</p>



<a name="227718092"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227718092" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227718092">(Feb 25 2021 at 04:58)</a>:</h4>
<p>you can read the jekyll documentation ,and look in the _data directory</p>



<a name="227718096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227718096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227718096">(Feb 25 2021 at 04:58)</a>:</h4>
<p>because that's what jekyll gets access too,</p>



<a name="227718102"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227718102" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227718102">(Feb 25 2021 at 04:58)</a>:</h4>
<p>if that's what you mean by liquid.</p>



<a name="227718346"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227718346" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227718346">(Feb 25 2021 at 05:01)</a>:</h4>
<p>Thanks<br>
I found some stuff in temp\pages\_data<br>
Where is the FHIR IG docco?</p>



<a name="227719289"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227719289" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227719289">(Feb 25 2021 at 05:13)</a>:</h4>
<p>actually, I'm not sure what you're asking about. there's 2 different contexts in which liquid is used - in jekyll, when building an IG, and in the IG publisher, when creating resource narratives. The work differnetly</p>



<a name="227719388"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227719388" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227719388">(Feb 25 2021 at 05:14)</a>:</h4>
<p>Thanks. I did not know that. I'm looking at variable for creating resource narratives.</p>



<a name="227719451"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227719451" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227719451">(Feb 25 2021 at 05:15)</a>:</h4>
<p>I'm after a variable for the title of a resource. I've found one for the name, but I want to put the title in documentation.</p>



<a name="227719521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227719521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227719521">(Feb 25 2021 at 05:16)</a>:</h4>
<p>I thought it would be easy. Now it is a rabbit hole. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="227719611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227719611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227719611">(Feb 25 2021 at 05:18)</a>:</h4>
<p>I can get the name from {{ site.data.structuredefinitions.&lt;RESOURCE ID&gt;.name }}, but there is no title.<br>
I'll do it with text instead of a variable.</p>



<a name="227719781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227719781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227719781">(Feb 25 2021 at 05:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191682">@Richard Townley-O'Neill</span> I'm in the rabbit hole (it's nice and cozy and it's dangerous out there). What do you need?</p>



<a name="227721008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227721008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227721008">(Feb 25 2021 at 05:41)</a>:</h4>
<p>We have an IG not using the template approach built using the ig.json approach.<br>
On -intro pages for profiles we put the title of the profile at the start. I thought it would be nice to use a variable instead of remembering to change it when the resource gets a new title during development. I found a variable for the ig's title : {{ site.data.fhir.ig.title }}<br>
but for the resource all I could find was a name: {{ site.data.structuredefinitions.&lt;RESOURCE ID&gt;.name }} </p>
<p>I expect there is no such vartiable.</p>



<a name="227721223"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227721223" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227721223">(Feb 25 2021 at 05:44)</a>:</h4>
<p>what about site.data.pages?</p>



<a name="227721270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227721270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227721270">(Feb 25 2021 at 05:45)</a>:</h4>
<p>if you have a pages.json file, does it contain the info?</p>



<a name="227721366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227721366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227721366">(Feb 25 2021 at 05:46)</a>:</h4>
<p>also site.data.resources should have that info</p>



<a name="227721584"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227721584" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227721584">(Feb 25 2021 at 05:50)</a>:</h4>
<p>pages.json has almost nothing. It has what is in  <a href="http://ImplementationGuide.definition.page">ImplementationGuide.definition.page</a>, and that is just a stub.</p>



<a name="227722290"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227722290" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227722290">(Feb 25 2021 at 06:02)</a>:</h4>
<p>if you're generating narrative, you only have what's in the resource that is being generated. If theres's no title in the resource, you can't use it when generating narrative</p>



<a name="227722461"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227722461" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227722461">(Feb 25 2021 at 06:05)</a>:</h4>
<p>The structure definition has a title, which I can see in site.data.resources <br>
With site.data.resources I tried {{ site.data.resources.StructureDefinition/sra-match-record.title}}<br>
and got nothing.<br>
Maybe I need to escape the "/".</p>



<a name="227722875"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227722875" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227722875">(Feb 25 2021 at 06:11)</a>:</h4>
<p>I think you're confused. Are you writing liquid for jekyll to process, or for generating narrative?</p>



<a name="227722940"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227722940" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227722940">(Feb 25 2021 at 06:12)</a>:</h4>
<p>but if you're writing for a structure definition, the liquid will (or should) never be called - the IG publisher renders that itself</p>



<a name="227723483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227723483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227723483">(Feb 25 2021 at 06:21)</a>:</h4>
<p>I am writing for the narrative. I want the circled bit to be a variable <br>
<a href="/user_uploads/10155/XYofDUknXIvbvUxRuzLuvM1V/image.png">image.png</a> <br>
from <a href="https://sra.digitalhealth.gov.au/fhir/currentdraft/StructureDefinition-sra-organization.html">https://sra.digitalhealth.gov.au/fhir/currentdraft/StructureDefinition-sra-organization.html</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/XYofDUknXIvbvUxRuzLuvM1V/image.png" title="image.png"><img src="/user_uploads/10155/XYofDUknXIvbvUxRuzLuvM1V/image.png"></a></div>



<a name="227723501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227723501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227723501">(Feb 25 2021 at 06:21)</a>:</h4>
<p>Gotta go.</p>



<a name="227724614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227724614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227724614">(Feb 25 2021 at 06:38)</a>:</h4>
<p>there's no variables - you just have access to what's in the resource</p>



<a name="227760767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227760767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227760767">(Feb 25 2021 at 12:46)</a>:</h4>
<p>If anyone is trying to get this to work in a SUSHI project, this worked for me:</p>
<p>1) Add the following to sushi-config.yaml:</p>
<div class="codehilite"><pre><span></span><code>parameters:
  &quot;liquid-path&quot;: &quot;liquid&quot;
</code></pre></div>
<p>2) Create a folder <code>input/liquid/</code> and add a file like <code>Patient.liquid</code> as Grahame describes above</p>



<a name="227760864"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227760864" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227760864">(Feb 25 2021 at 12:47)</a>:</h4>
<p>When I add my own <code>Patient.liquid</code> file, is there a place I can see the template I'm overriding?</p>



<a name="227761890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227761890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227761890">(Feb 25 2021 at 12:55)</a>:</h4>
<p>I believe that when you add a Patient.liquid, you are not overriding the template, you are telling the Java code to let it go</p>



<a name="227762376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227762376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227762376">(Feb 25 2021 at 13:00)</a>:</h4>
<p>Ah ok, that makes sense</p>



<a name="227763304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227763304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227763304">(Feb 25 2021 at 13:07)</a>:</h4>
<p>I have yet to find an object that <code>render()</code> actually works on. For example, <code>Observation.value.render()</code>, <code>Observation.value.coding.render()</code>, <code>Observation.value.coding.code.render()</code> all produce the following exception:</p>
<div class="codehilite"><pre><span></span><code>org.apache.commons.lang3.NotImplementedException: Not done yet (IGPublisherHostServices.resolveFunction)
    at org.hl7.fhir.igtools.publisher.Publisher$IGPublisherHostServices.resolveFunction(Publisher.java:385)
    at org.hl7.fhir.r5.utils.LiquidEngine.resolveFunction(LiquidEngine.java:623)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parseExpression(FHIRPathEngine.java:1038)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parseExpression(FHIRPathEngine.java:1079)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parseExpression(FHIRPathEngine.java:1079)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parse(FHIRPathEngine.java:431)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.parse(FHIRPathEngine.java:423)
    at org.hl7.fhir.r5.utils.LiquidEngine$LiquidStatement.evaluate(LiquidEngine.java:141)
    at org.hl7.fhir.r5.utils.LiquidEngine.evaluate(LiquidEngine.java:102)
    at org.hl7.fhir.r5.renderers.LiquidRenderer.render(LiquidRenderer.java:75)
    at org.hl7.fhir.r5.renderers.ResourceRenderer.render(ResourceRenderer.java:84)
    at org.hl7.fhir.igtools.publisher.Publisher.generateNarratives(Publisher.java:1152)
    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3826)
    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:877)
    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:732)
    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:8417)
</code></pre></div>
<p>Is this truly not implemented, or am I just doing something silly?</p>



<a name="227807595"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227807595" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227807595">(Feb 25 2021 at 17:45)</a>:</h4>
<p>truly not implemented.</p>



<a name="227807627"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227807627" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227807627">(Feb 25 2021 at 17:45)</a>:</h4>
<p>apparently I overlooked hooking something up</p>



<a name="227808270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227808270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227808270">(Feb 25 2021 at 17:49)</a>:</h4>
<p>Well having briefly attempted to replicate the behavior of <code>render()</code> in Liquid, I can definitely see the value of <code>render()</code> <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="227808314"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227808314" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227808314">(Feb 25 2021 at 17:49)</a>:</h4>
<p>y.</p>



<a name="227808370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227808370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227808370">(Feb 25 2021 at 17:50)</a>:</h4>
<p>it's now on my list</p>



<a name="227808399"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/227808399" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#227808399">(Feb 25 2021 at 17:50)</a>:</h4>
<p>Thanks!!</p>



<a name="272339520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/272339520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#272339520">(Feb 17 2022 at 23:32)</a>:</h4>
<p>I have a similar setup and having problems with <code>include</code>.</p>
<p>I would like to create a partial and include it in Patient.liquid. However any attempt at <code>{% include 'test' %}</code> fails in the rendered output with an inline error </p>
<div class="codehilite"><pre><span></span><code>Exception generating Narrative: Script template: Error reading include: &quot;test&quot;
</code></pre></div>
<p>I think it is happening here <a href="https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.r5/src/main/java/org/hl7/fhir/r5/utils/LiquidEngine.java#L494-L521">https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.r5/src/main/java/org/hl7/fhir/r5/utils/LiquidEngine.java#L494-L521</a>, but really can't make any sense of what that code is doing.</p>
<p>Any suggestions? Is there an example somewhere of a successful <code>include</code>?</p>



<a name="272728178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/272728178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#272728178">(Feb 21 2022 at 19:40)</a>:</h4>
<p>There is this testcase in the fhir-test-cases repository: <a href="https://github.com/FHIR/fhir-test-cases/blob/master/r5/liquid/liquid-tests.json#L46">https://github.com/FHIR/fhir-test-cases/blob/master/r5/liquid/liquid-tests.json#L46</a></p>



<a name="272739830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/272739830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#272739830">(Feb 21 2022 at 22:13)</a>:</h4>
<p>It looks like the LiquidEngine that is being used at that point for the narrative generation doesn't have an implementation of the IncludeResolver, so it doesn't know how to get the templates. I've sketched what I _think_ will work here:</p>



<a name="272739832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/272739832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#272739832">(Feb 21 2022 at 22:13)</a>:</h4>
<p><a href="https://github.com/cqframework/org.hl7.fhir.core/pull/2">https://github.com/cqframework/org.hl7.fhir.core/pull/2</a></p>



<a name="272739890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/272739890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#272739890">(Feb 21 2022 at 22:14)</a>:</h4>
<p>But it's a change down in core to the LiquidRenderer</p>



<a name="272739949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/272739949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#272739949">(Feb 21 2022 at 22:15)</a>:</h4>
<p>But I can't get a good build locally due to some seemingly unrelated package cache tests failing</p>



<a name="273029256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/273029256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#273029256">(Feb 23 2022 at 23:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> I don't understand this - the test passes?</p>



<a name="273031999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/273031999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#273031999">(Feb 24 2022 at 00:31)</a>:</h4>
<p>It does, but that's because it sets a includeTemplateResolver in the test setup. When the Liquid Engine is used in the publisher to generate the narratives, it doesn't have an includeTemplateResolver set. We can see in the debug that the templates are loaded in the template provider, but there's no glue from the LiquidEngine to be able to resolve the templates there. So that's what this proposed PR does, just adds a class that implements the template resolver interface using the template provider in the context, and sets the LiquidEngine's include resolver to that instance.</p>



<a name="273032727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/273032727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#273032727">(Feb 24 2022 at 00:41)</a>:</h4>
<p>ok well make it as a PR then</p>



<a name="273041096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Using%20liquid/near/273041096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Using.20liquid.html#273041096">(Feb 24 2022 at 02:57)</a>:</h4>
<p><a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/750">https://github.com/hapifhir/org.hl7.fhir.core/pull/750</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
