---
layout: page
title: "FHIR Chat  · DSTU2 invalid ids · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html">DSTU2 invalid ids</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154013514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154013514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154013514">(Oct 30 2018 at 02:02)</a>:</h4>
<p>I'm experimenting w/ creating DSTU2 profiles.  When I run the IG publisher, the QA reports an error about an invalid id for every element in every structure definition.  For example:</p>
<div class="codehilite"><pre><span></span>id value &#39;Extension:myTestExt&#39; is not valid
id value &#39;Extension:myTestExt.id&#39; is not valid
...
</pre></div>


<p>I tried removing the name (e.g., <em>myTestExt</em>) from the root and that eliminated many of the errors, but whenever I have slices with a slicename in the id, I still get the error.  For example:</p>
<div class="codehilite"><pre><span></span>id value &#39;Condition.extension:someExt&#39; is not valid
</pre></div>


<p>Furthermore, ids with [x] are also marked as invalid.  For example:</p>
<div class="codehilite"><pre><span></span>id value &#39;Condition.onset[x]&#39; is not valid
</pre></div>


<p>Does DSTU2 have different rules for ids (like only alphanumeric characters)?  If so, is there a recommended approach for slice ids and choice ids?</p>



<a name="154013849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154013849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154013849">(Oct 30 2018 at 21:02)</a>:</h4>
<p>Looking into this further, the Argonaut Data Query profiles use ids very similar to this, for example:</p>
<div class="codehilite"><pre><span></span>&quot;id&quot; : &quot;Condition:argoprofile&quot;,
</pre></div>


<div class="codehilite"><pre><span></span>&quot;id&quot; : &quot;Condition:argoprofile.id&quot;,
</pre></div>


<div class="codehilite"><pre><span></span>&quot;id&quot; : &quot;Condition:argoprofile.onset[x]&quot;,
</pre></div>


<p>I think this means that one of the following must be the case:</p>
<ul>
<li>it's valid and there is a bug in the publisher that incorrectly flags it as an error</li>
<li>it's invalid in DSTU2, but Argonaut got away with it</li>
</ul>
<p>Any insight on this, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ?</p>



<a name="154013899"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154013899" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154013899">(Oct 30 2018 at 22:25)</a>:</h4>
<p>its an error in the IG.  Argonaut got away with it because is predated to changes in the validator</p>



<a name="154013902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154013902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154013902">(Oct 30 2018 at 22:26)</a>:</h4>
<p>can you create an issue on GitHub?</p>



<a name="154013903"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154013903" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154013903">(Oct 30 2018 at 22:26)</a>:</h4>
<p>For Argonaut DQ guide</p>



<a name="154014055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154014055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154014055">(Oct 31 2018 at 11:56)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> -- OK.  Do you know what the guidance is regarding how it <em>should</em> be done (since the STU3 way of doing choices and slices in ids is apparently illegal)?  I couldn't find anything in the DSTU2 spec, but it's possible I missed it.  The base resource StructureDefinitions don't use <code>id</code> at all, so they're not much help.</p>



<a name="154014140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154014140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154014140">(Oct 31 2018 at 15:49)</a>:</h4>
<p>Here is  some guidelines it the spec:  <a href="http://build.fhir.org/elementdefinition.html#id" target="_blank" title="http://build.fhir.org/elementdefinition.html#id">http://build.fhir.org/elementdefinition.html#id</a></p>



<a name="154014170"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154014170" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154014170">(Oct 31 2018 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> -- I'm aware of that guidance, but it is R4.  If you follow that guidance in DSTU2, the IG publisher will spit out errors for any <code>id</code>s that specify slices with a <code>:</code> or that contain <code>[x]</code> for choice elements.  DSTU2 seems to have a much stricter set of rules, although I couldn't find anything in the DSTU2 spec that actually called them out.</p>



<a name="154014176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154014176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154014176">(Oct 31 2018 at 16:20)</a>:</h4>
<p>Hmmm... this is interesting.  According to the DSTU2 spec, <code>id</code> should actually be <code>_id</code> in the JSON representation: <a href="http://hl7.org/fhir/DSTU2/element.html#json" target="_blank" title="http://hl7.org/fhir/DSTU2/element.html#json">http://hl7.org/fhir/DSTU2/element.html#json</a><br>
In STU3, the <code>_</code> was removed.  In my DSTU2 JSON StructureDefinitions, I'm using <code>id</code> instead of <code>_id</code>.  I wonder if that has anything to do with it...</p>



<a name="154014203"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154014203" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154014203">(Oct 31 2018 at 16:57)</a>:</h4>
<p>No I am not aware.  I based all of my work on the tooling.</p>



<a name="154015209"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154015209" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154015209">(Nov 02 2018 at 17:22)</a>:</h4>
<p>So the DSTU2 limitations on <code>id</code> were under my nose the whole time.  I just had to go to the definition of the <code>id</code> primitive, which apparently changed.</p>



<a name="154015210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154015210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154015210">(Nov 02 2018 at 17:26)</a>:</h4>
<blockquote>
<p>Any combination of upper or lower case ASCII letters ('A'..'Z', and 'a'..'z', numerals ('0'..'9'), '-' and '.', with a length limit of 64 characters.<br>
<a href="http://hl7.org/fhir/DSTU2/datatypes.html#id" target="_blank" title="http://hl7.org/fhir/DSTU2/datatypes.html#id">http://hl7.org/fhir/DSTU2/datatypes.html#id</a></p>
</blockquote>



<a name="154017040"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154017040" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154017040">(Nov 09 2018 at 06:35)</a>:</h4>
<p>I'm not sure about this. It's going to be hard for to resolve, that's for sure. do you have a worked example I can experiment with?</p>



<a name="154018101"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154018101" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154018101">(Nov 13 2018 at 18:30)</a>:</h4>
<p>Well... the limitation on allowed characters is built right into the spec (as I discovered in my last comment on this thread), so I don't think that's something that can change.  I was just wondering if there was any guidance around how slice names and specific choices should be reflected in the id since <code>:</code>, <code>[</code> and <code>]</code> are all disallowed.  If there is no guidance/convention, I suppose I can make something up.</p>
<p>I noticed that the FHIR core definitions don't even include <code>id</code>s in the snapshot/differential elements -- so maybe they're not even important for DSTU2 profiles?</p>



<a name="154018285"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154018285" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154018285">(Nov 14 2018 at 02:47)</a>:</h4>
<p>it's an issue in the r2/r4 conversions. I might be able to do something... maybe.</p>



<a name="154018286"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154018286" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154018286">(Nov 14 2018 at 02:47)</a>:</h4>
<p>have you seen the test IGs? do you want to extend those with some breaking things?</p>



<a name="154018433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154018433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154018433">(Nov 14 2018 at 14:37)</a>:</h4>
<p>I haven't seen the test IGs.  I'll see if I can find them.  If not, I'll ask for a pointer.</p>



<a name="154018463"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/DSTU2%20invalid%20ids/near/154018463" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/DSTU2.20invalid.20ids.html#154018463">(Nov 14 2018 at 15:40)</a>:</h4>
<p>/test/ig in the build</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
