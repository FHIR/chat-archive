---
layout: page
title: "FHIR Chat  · Error in snapshot generation · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html">Error in snapshot generation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="198922052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198922052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198922052">(May 27 2020 at 17:06)</a>:</h4>
<p>What does this IG Publisher error mean?<br>
I have a clean sushi build, but IG Publisher sez:</p>
<p>Error in snapshot generation: The profile <a href="http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization">http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization</a> has 5 elements in the differential (id: <a href="http://Organization.identifier.id">Organization.identifier.id</a>, id: Organization.identifier.use, id: Organization.identifier.type, id: Organization.identifier.period, id: Organization.identifier.assigner) that don't have a matching element in the snapshot: check that the path and definitions are legal in the differential (including order) (</p>
<p>Relates to this fsh:  <a href="https://github.com/HL7/davinci-pdex-plan-net">https://github.com/HL7/davinci-pdex-plan-net</a></p>
<p>The relevant FSH input is:</p>
<ul>
<li><a href="http://identifier.id">identifier.id</a> MS</li>
<li>identifier.use MS</li>
<li>identifier.system MS</li>
<li>identifier.type MS</li>
<li>identifier.value MS</li>
<li>identifier.period MS</li>
<li>identifier.assigner MS</li>
</ul>
<p>PlanNetOrganization is a profile of USCore-Organization, which has two (open) slices of identifier (NPI and CLIA).<br>
Could that be contributing to a sushi or IG Publisher issue?</p>



<a name="198926843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198926843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198926843">(May 27 2020 at 17:46)</a>:</h4>
<p>I've taken a look at this, and one thing I am noticing is that SUSHI will add an empty <code>Practitioner.identifier</code>element to the differential so that the differential is not sparse:<br>
<a href="/user_uploads/10155/ksySPPrOjwqZAf9ANOvOKxnm/image.png">image.png</a><br>
But if that empty <code>Practitioner.identifier</code> element is taken out, it looks like this error goes away. We didn't think having an empty diff element like this would be a problem, but it seems to be a problem in this case for some reason.</p>
<div class="message_inline_image"><a href="/user_uploads/10155/ksySPPrOjwqZAf9ANOvOKxnm/image.png" title="image.png"><img src="/user_uploads/10155/ksySPPrOjwqZAf9ANOvOKxnm/image.png"></a></div>



<a name="198931717"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198931717" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198931717">(May 27 2020 at 18:23)</a>:</h4>
<p>ok here is what sushi generates:</p>
<div class="codehilite"><pre><span></span><code>      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier&quot;</span>
      <span class="p">}</span><span class="err">,</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.id&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.id&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mustSupport&quot;</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">}</span><span class="err">,</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.use&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.use&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mustSupport&quot;</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">}</span><span class="err">,</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.type&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.type&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mustSupport&quot;</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">}</span><span class="err">,</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.period&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.period&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mustSupport&quot;</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">}</span><span class="err">,</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.assigner&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.identifier.assigner&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mustSupport&quot;</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">}</span><span class="err">,</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.active&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.active&quot;</span><span class="p">,</span>
        <span class="nt">&quot;patternBoolean&quot;</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">}</span><span class="err">,</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.type&quot;</span><span class="p">,</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Organization.type&quot;</span><span class="p">,</span>
        <span class="nt">&quot;binding&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;strength&quot;</span><span class="p">:</span> <span class="s2">&quot;required&quot;</span><span class="p">,</span>
          <span class="nt">&quot;valueSet&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/us/davinci-pdex-plan-net/ValueSet/OrgTypeVS&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span><span class="err">,</span>
</code></pre></div>



<a name="198932030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198932030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198932030">(May 27 2020 at 18:26)</a>:</h4>
<p>they are all mustSupport, I don't see how this can be about sparse or exhaustive differentials.</p>



<a name="198932196"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198932196" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198932196">(May 27 2020 at 18:26)</a>:</h4>
<p><span class="user-mention" data-user-id="239822">@Nick Freiter</span> you are saying about Practitioner, but the issue reported is in the Organization...?</p>



<a name="198932475"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198932475" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198932475">(May 27 2020 at 18:28)</a>:</h4>
<blockquote>
<p>they are all mustSupport, I don't see how this can be about sparse or exhaustive differentials.</p>
</blockquote>
<p>The sparse/exhaustive part is referring to the fact that we include an element for <code>Organization.identifier</code> even though it has no changes.  A sparse differential is when the full path to an element isn't represented in the differential (e.g., if there is an element for <code>Organization.identifier.id</code> but not for its parent, <code>Organization.identifier</code>).</p>
<p>I'm thinking that this probably has to do with the parent profile having a <code>slicing</code> on <code>Organization.identifier</code> -- and in this profile we're trying to apply constraints to the "all slices" part of the slicing -- but the publisher is confused about that.</p>



<a name="198932600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198932600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198932600">(May 27 2020 at 18:29)</a>:</h4>
<p><span class="user-mention" data-user-id="215604">@Saul Kravitz</span> are you using the latest version of the publisher?</p>



<a name="198932755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198932755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198932755">(May 27 2020 at 18:30)</a>:</h4>
<p>@Nick Freiter confirmed to me in an earlier message that this issue exists for both the <code>Organization</code> and <code>Practitioner</code>-based profiles in Saul's IG.  He probably just copied the wrong one in here.</p>



<a name="198933028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198933028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198933028">(May 27 2020 at 18:33)</a>:</h4>
<p>ok</p>



<a name="198933837"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198933837" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198933837">(May 27 2020 at 18:39)</a>:</h4>
<p>Just updated to:  FHIR IG Publisher Version 1.0.97-SNAPSHOT (Git# 9433f4baf940). Built 2020-05-27T11:06:47.451+10:00 (17 hours old)</p>
<p>Still get:<br>
Error in snapshot generation: The profile <a href="http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization">http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Organization</a> has 5 elements in the differential (id: <a href="http://Organization.identifier.id">Organization.identifier.id</a>, id: Organization.identifier.use, id: Organization.identifier.type, id: Organization.identifier.period, id: Organization.identifier.assigner) that don't have a matching element in the snapshot: check that the path and definitions are legal in the differential (including order)</p>
<p>and<br>
Error in snapshot generation: The profile <a href="http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Practitioner">http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-Practitioner</a> has 5 elements in the differential (id: <a href="http://Practitioner.identifier.id">Practitioner.identifier.id</a>, id: Practitioner.identifier.use, id: Practitioner.identifier.type, id: Practitioner.identifier.period, id: Practitioner.identifier.assigner) that don't have a matching element in the snapshot: check that the path and definitions are legal in the differential (including order)</p>



<a name="198934342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198934342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198934342">(May 27 2020 at 18:42)</a>:</h4>
<p>are you slicing  organization.identifier?</p>



<a name="198934393"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198934393" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198934393">(May 27 2020 at 18:43)</a>:</h4>
<p>ah, sorry. on the parent profile...</p>



<a name="198934577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198934577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198934577">(May 27 2020 at 18:44)</a>:</h4>
<p>ok I understand now, <span class="user-mention" data-user-id="191469">@Chris Moesel</span> the parent profile has the slices , but the child profile is trying to apply a MS to all slices.</p>



<a name="198935728"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/198935728" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#198935728">(May 27 2020 at 18:53)</a>:</h4>
<p>Right -- including the "open" part of the slicing (e.g., elements that don't fall into a slice).</p>
<p>I've tried adding the "slicing" definition in the differential as well as adding the missing slices (e.g., NPI, etc) -- and nothing makes this error go away except removing the root <code>identifier</code> element.</p>



<a name="199017718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20snapshot%20generation/near/199017718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20snapshot.20generation.html#199017718">(May 28 2020 at 12:54)</a>:</h4>
<p>so it means there was a but in the differential processing code. Fixed next release</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
