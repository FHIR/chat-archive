---
layout: page
title: "FHIR Chat  · Reference is required resource or identifier reference · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Reference.20is.20required.20resource.20or.20identifier.20reference.html">Reference is required resource or identifier reference</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="246552457"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Reference%20is%20required%20resource%20or%20identifier%20reference/near/246552457" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Reference.20is.20required.20resource.20or.20identifier.20reference.html#246552457">(Jul 20 2021 at 07:16)</a>:</h4>
<p>Wondering about the best way to enforce this?</p>
<p>What I'm doing is adding a constraint expression on Reference like:</p>
<div class="codehilite"><pre><span></span><code>(reference.exists() or (identifier.exists() and display.exists()))
</code></pre></div>
<p>That works and ensures resources vaidate ok. <br>
It also works for rest and message exchanges. However for some messages I want to force one option. At present what I doing is using MessageDefinition.focus e.g. for prescriptionorder's</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code> <span class="nt">&lt;focus&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"MedicationRequest"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">"https://fhir.nhs.uk/StructureDefinition/NHSDigital-MedicationRequest"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">"4"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/focus&gt;</span>
    <span class="nt">&lt;focus&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"Patient"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">"https://fhir.nhs.uk/StructureDefinition/NHSDigital-Patient"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/focus&gt;</span>
</code></pre></div>
<p>I don't think focus is the right way of doing this, the focus is really just the MedicationRequest but its clear what the payload requirements are and we as we use MessageDefinitions in our FHIR Validation it can be tested.<br>
It also means we can use the same MedicationRequest profile for both restful and message.</p>



<a name="246604854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Reference%20is%20required%20resource%20or%20identifier%20reference/near/246604854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Reference.20is.20required.20resource.20or.20identifier.20reference.html#246604854">(Jul 20 2021 at 15:13)</a>:</h4>
<p>The focus <em>must</em> be pointed to by Reference.reference as the reference must be resolvable and must be in the Bundle</p>



<a name="246650673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Reference%20is%20required%20resource%20or%20identifier%20reference/near/246650673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Reference.20is.20required.20resource.20or.20identifier.20reference.html#246650673">(Jul 20 2021 at 21:07)</a>:</h4>
<p>Yes but I'm not convinced thats the easiest way of telling a developer what should be in the Message Bundle. (I am biased and coming from a v2 background - I'm used to seeing messages broken down by segments and MessageDefinition can be used the same way)  <br>
Plus its not a lot of code to alter HAPI Validation to take into account the MessageDefinition.</p>



<a name="246651629"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Reference%20is%20required%20resource%20or%20identifier%20reference/near/246651629" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Reference.20is.20required.20resource.20or.20identifier.20reference.html#246651629">(Jul 20 2021 at 21:13)</a>:</h4>
<p>MessageDefinition focus only points to the focus of the message, <strong>NOT</strong> all of the resources in the Bundle.  If you want to specify all the resources, you either put a profile on focus that cascades through profiles on other resources to define what's in the Bundle vs. not or you use the .graph element.</p>



<a name="246651769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Reference%20is%20required%20resource%20or%20identifier%20reference/near/246651769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Reference.20is.20required.20resource.20or.20identifier.20reference.html#246651769">(Jul 20 2021 at 21:14)</a>:</h4>
<p>For example, if you're doing a message where the event is a patient discharge, the only resource that can be a focus is a single Encounter.  Focus can't be anything else - because Encounter is the status change trigger.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
