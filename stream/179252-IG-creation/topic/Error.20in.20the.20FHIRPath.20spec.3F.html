---
layout: page
title: "FHIR Chat  · Error in the FHIRPath spec? · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html">Error in the FHIRPath spec?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="257863999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257863999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257863999">(Oct 16 2021 at 21:47)</a>:</h4>
<p>Looking at <a href="https://hl7.org/fhir/fhirpath.html#simple">Section 2.9.4</a> of the FHIRPath spec, it defines the 'simple' FHIRPath syntax we use for things like defining slicing discriminators.  The wording says:<br>
<code>All statements SHALL start with the name of the context element (e.g. on a Patient resource, Patient.contact.name.), or SHALL be simply "$this" to refer to the element that has focus</code><br>
However, I know for a fact that none of the tools allow this.  If you're starting at Patient and want to specify a discriminator of patient contact name, then the discriminator path is "<a href="http://contact.name">contact.name</a>", not "<a href="http://Patient.contact.name">Patient.contact.name</a>".  I.e. you never include the name of the 'current' element as part of the path - that's one of the reasons we need $this.</p>
<p>Am I correct that this wording is in error?  (<span class="user-mention" data-user-id="191316">@Grahame Grieve</span>)</p>
<p>(The fact it's a SHALL statement is going to make it more fun to fix...)</p>



<a name="257864115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257864115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257864115">(Oct 16 2021 at 21:49)</a>:</h4>
<p>I don't think that the statement is wrong. where don't the tools support it?</p>



<a name="257864351"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257864351" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257864351">(Oct 16 2021 at 21:53)</a>:</h4>
<p>Simple example:</p>
<div class="codehilite"><pre><span></span><code>    &lt;element id=&quot;Task.input&quot;&gt;
      &lt;path value=&quot;Task.input&quot;/&gt;
      &lt;slicing&gt;
        &lt;discriminator&gt;
          &lt;type value=&quot;pattern&quot;/&gt;
          &lt;path value=&quot;type&quot;/&gt;
        &lt;/discriminator&gt;
        &lt;rules value=&quot;open&quot;/&gt;
      &lt;/slicing&gt;
      &lt;mustSupport value=&quot;true&quot;/&gt;
    &lt;/element&gt;
</code></pre></div>



<a name="257864378"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257864378" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257864378">(Oct 16 2021 at 21:53)</a>:</h4>
<p>According to the text in the spec, my discriminator ought to be "Task.input.pattern" (or maybe "input.pattern"?)</p>



<a name="257864565"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257864565" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257864565">(Oct 16 2021 at 21:56)</a>:</h4>
<p>it won't work there - you'll need $this.</p>



<a name="257865918"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257865918" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257865918">(Oct 16 2021 at 22:16)</a>:</h4>
<p>I don't need $this - a discriminator of "pattern" works just fine...</p>



<a name="257865946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257865946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257865946">(Oct 16 2021 at 22:17)</a>:</h4>
<p>I only need $this if the discriminator is the same as the element being sliced.</p>



<a name="257866351"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257866351" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257866351">(Oct 16 2021 at 22:23)</a>:</h4>
<p>you'll need $this to be compliant with the rule</p>



<a name="257866838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20the%20FHIRPath%20spec%3F/near/257866838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20the.20FHIRPath.20spec.3F.html#257866838">(Oct 16 2021 at 22:31)</a>:</h4>
<p>Right - but if tools don't enforce the rule, and there's no need for the rule, why do we have the rule?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
