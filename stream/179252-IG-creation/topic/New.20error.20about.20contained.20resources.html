---
layout: page
title: "FHIR Chat  · New error about contained resources · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html">New error about contained resources</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="255757112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/255757112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#255757112">(Oct 01 2021 at 14:56)</a>:</h4>
<p>I just updated my IG publisher from 1.1.73 to 1.1.81 and I'm getting a new error around contained resources and I'm pretty sure that the error is incorrect, but I'll welcome a change in my understanding.  In a repository that ran clean before (<br>
<a href="https://github.com/hl7/fhir-spl">https://github.com/hl7/fhir-spl</a>), the new error I'm getting is:</p>
<div class="codehilite"><pre><span></span><code>ref-1: &#39;SHALL have a contained resource if a local reference is provided&#39; &#39;SHALL have a contained resource if a local reference is provided&#39; ( (url: usagent; ids: ))
</code></pre></div>
<p>The resource in question has three contained resources.  One OrganizationAffilation references the containing resource and references another contained resource:</p>
<div class="codehilite"><pre><span></span><code>{
      &quot;resourceType&quot; : &quot;OrganizationAffiliation&quot;,
      &quot;id&quot; : &quot;SampleLabelerUSAgentAffiliation&quot;,
      &quot;meta&quot; : {
        &quot;profile&quot; : [
          &quot;http://hl7.org/fhir/us/spl/StructureDefinition/USAgentAffiliation&quot;
        ]
      },
      &quot;organization&quot; : {
        &quot;reference&quot; : &quot;#&quot;
      },
      &quot;participatingOrganization&quot; : {
        &quot;reference&quot; : &quot;#usagent&quot;
      },
      &quot;code&quot; : [
        {
          &quot;coding&quot; : [
            {
              &quot;system&quot; : &quot;http://ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl&quot;,
              &quot;code&quot; : &quot;C73330&quot;,
              &quot;display&quot; : &quot;Foreign Facility&#39;s United States Agent&quot;
            }
          ]
        }
      ]
    },
</code></pre></div>
<p>This is the resource that is getting the error and from the error message, I'm assuming that it's taking the #usagent and expecting that to be in a contained resource within the resource itself.  But a) contained resources can't contain resources and b) the relative link is intended to be to other contained resources.</p>



<a name="255772368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/255772368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#255772368">(Oct 01 2021 at 16:38)</a>:</h4>
<p>And #usagent exists as a resource in a sibling contained resource?</p>



<a name="255783515"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/255783515" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#255783515">(Oct 01 2021 at 17:57)</a>:</h4>
<p>Yep, it's in the same array of contained resources. <a href="/user_uploads/10155/z-IjPYROsdLL9_bxNN-lSMuh/Organization-SampleLabelerOrganization.json">Organization-SampleLabelerOrganization.json</a></p>



<a name="255830061"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/255830061" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#255830061">(Oct 02 2021 at 01:30)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="256001536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/256001536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#256001536">(Oct 04 2021 at 03:31)</a>:</h4>
<p>well this one is weird. Certainly nothing has changed in the validation layer that has anything to do with this</p>



<a name="256002470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/256002470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#256002470">(Oct 04 2021 at 03:48)</a>:</h4>
<p>like I said, it wasn't an error in 1.1.73 but it is in 1.1.81</p>



<a name="256003838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/256003838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#256003838">(Oct 04 2021 at 04:10)</a>:</h4>
<p>oh this might be Lloyd's changes around invariant validation</p>



<a name="256003931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/256003931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#256003931">(Oct 04 2021 at 04:12)</a>:</h4>
<p>Did I mess up, or is it just now checking something it wasn't before?</p>



<a name="256004095"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/256004095" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#256004095">(Oct 04 2021 at 04:15)</a>:</h4>
<p>well, the error actually happens when it's checking slicing. So it shouldn't be recorded (as well as it shouldn't happen)</p>



<a name="256004368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/256004368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#256004368">(Oct 04 2021 at 04:19)</a>:</h4>
<p>the underlying issue is that conformsTo() jumps into the bundle in the contained resource, without the context, so the contained references can't be resolved.</p>



<a name="256008072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/256008072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#256008072">(Oct 04 2021 at 05:23)</a>:</h4>
<p>fixed next release. Seems like some sort of discovered check, because the issue has always been there</p>



<a name="263061704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/263061704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramandeep Dhanoa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#263061704">(Nov 29 2021 at 20:10)</a>:</h4>
<p>I feel like I have similar scenario here. I have QuestionnaireResponse who has 2 contained resources - Questionnaire and ValueSet. Questionnaire contained resource is referencing ValueSet as #VSPHQ9 (where VSPHQ9 is the id of the contained ValueSet). In QA - I am getting this warning message "ValueSet #VSPHQ9 not found by validator" - Any insights on why this might be happening?</p>



<a name="263062149"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/263062149" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#263062149">(Nov 29 2021 at 20:14)</a>:</h4>
<p>no. how would I reproduce?</p>



<a name="263063417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/263063417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramandeep Dhanoa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#263063417">(Nov 29 2021 at 20:26)</a>:</h4>
<p>I have pushed the example in the CI-build. Here is the example: <a href="https://build.fhir.org/ig/HL7/sdc/QuestionnaireResponse-adaptive-questionnaireresponse-sdc-example-phq9.html">https://build.fhir.org/ig/HL7/sdc/QuestionnaireResponse-adaptive-questionnaireresponse-sdc-example-phq9.html</a><br>
and warning message:<br>
<a href="https://build.fhir.org/ig/HL7/sdc/qa.html#_scratch_ig-build-temp-1S9L3Q_repo_input_examples_adaptive-questionnaireresponse-sdc-profile-example-PHQ9">https://build.fhir.org/ig/HL7/sdc/qa.html#_scratch_ig-build-temp-1S9L3Q_repo_input_examples_adaptive-questionnaireresponse-sdc-profile-example-PHQ9</a></p>



<a name="263386975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/263386975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#263386975">(Dec 02 2021 at 02:44)</a>:</h4>
<p>fixed next release, though you'll get lots of validation errors once it's fixed.</p>



<a name="264882911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/264882911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#264882911">(Dec 14 2021 at 16:21)</a>:</h4>
<p>did this get fixed? I seem to have this showing up</p>



<a name="264908247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/264908247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#264908247">(Dec 14 2021 at 18:58)</a>:</h4>
<p>what specifically is showing up?</p>



<a name="264934654"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/New%20error%20about%20contained%20resources/near/264934654" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/New.20error.20about.20contained.20resources.html#264934654">(Dec 14 2021 at 22:16)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> I am getting errors using "rel-1" where I have contained resoruces. I don't know how to make it more contained than it already is.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
