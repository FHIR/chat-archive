---
layout: page
title: "FHIR Chat  · how to slice effective[x] · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/how.20to.20slice.20effective.5Bx.5D.html">how to slice effective[x]</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154020128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/how%20to%20slice%20effective%5Bx%5D/near/154020128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/how.20to.20slice.20effective.5Bx.5D.html#154020128">(Nov 21 2018 at 12:09)</a>:</h4>
<p>I am at a lost at how to 'slice' effective[x] or if I even need to slice it. In my profile, the Observation.effective[x] must exist, but it can be either effectiveDateTime or effectivePeriod. Which one of the two depends upon what a medical device reports.<br>
My effort is as follows:</p>
<div class="codehilite"><pre><span></span>    &lt;element id=&quot;Observation.effective[x]&quot;&gt;
      &lt;path value=&quot;Observation.effective[x]&quot; /&gt;
      &lt;slicing&gt;
        &lt;discriminator&gt;
          &lt;type value=&quot;type&quot; /&gt;
          &lt;path value=&quot;$this&quot; /&gt;
        &lt;/discriminator&gt;
        &lt;rules value=&quot;open&quot; /&gt;
      &lt;/slicing&gt;
      &lt;definition value=&quot;The time or time-period the observed value is asserted as being true. It is a time period if a Measure-Active-Period (duration) attribute is part of the metric measurement sent by the PHD. Otherwise it is the time stamp sent by the PHD or the time of reception by the PHG if the PHD sent no time stamp.&quot; /&gt;
      &lt;min value=&quot;1&quot; /&gt;
      &lt;!-- The base Observation profile specifies that max=1. However, if you do not re-specify it here, you will get a slicing on non-repeating element error unless
      you have a constraint that restricts the total number. Here I end up stating both since the constraint makes it clearer to the implementer that not only can
      only one exists but that has to be at least one. --&gt;
      &lt;max value=&quot;1&quot; /&gt;
      &lt;type&gt;
        &lt;code value=&quot;dateTime&quot;/&gt;
      &lt;/type&gt;
      &lt;type&gt;
        &lt;code value=&quot;Period&quot;/&gt;
      &lt;/type&gt;
      &lt;constraint&gt;
        &lt;key value=&quot;phd-obs-1&quot;/&gt;
        &lt;!-- Some time stamp SHALL be present --&gt;
        &lt;severity value=&quot;error&quot;/&gt;
        &lt;human value=&quot;Either an effectiveDateTime or effectivePeriod shall be present&quot;/&gt;
        &lt;expression value=&quot;effectiveDateTime.exists() or effectivePeriod.exists().exists()&quot;/&gt;
      &lt;/constraint&gt;
    &lt;/element&gt;
</pre></div>


<p>I do not really understand the &lt;path value="$this"/&gt; as I obtained it from another guide which seemed to do what I needed to do but I have not found anything about it on the FHIR pages. In any case, the IG Publisher validator does not like it and reports an error for every example resource I have (no surprise as the element is required). The error is</p>
<div class="codehilite"><pre><span></span>Profile http://hl7.org/fhir/uv/phd/StructureDefinition/PhdCoincidentTimeStampObservation, Element matches more than one slice - , dateTime
</pre></div>


<p>which indicates to me the '$this' is not doing what I thought it was supposed to do. <br>
Is it sufficient just to have the constraint in the element?</p>



<a name="154020183"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/how%20to%20slice%20effective%5Bx%5D/near/154020183" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stefan Karl <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/how.20to.20slice.20effective.5Bx.5D.html#154020183">(Nov 21 2018 at 15:35)</a>:</h4>
<p>I got a similar error which was discussed <a href="#narrow/stream/99-IG-creation/subject/QA.20error.20on.20type.20slicing" title="#narrow/stream/99-IG-creation/subject/QA.20error.20on.20type.20slicing">here</a>. Not sure if it has been fixed.</p>



<a name="154020198"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/how%20to%20slice%20effective%5Bx%5D/near/154020198" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/how.20to.20slice.20effective.5Bx.5D.html#154020198">(Nov 21 2018 at 16:10)</a>:</h4>
<p>I don't think that needs to be profiled at all.  It sounds like the base resource does the trick</p>



<a name="154020254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/how%20to%20slice%20effective%5Bx%5D/near/154020254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/how.20to.20slice.20effective.5Bx.5D.html#154020254">(Nov 21 2018 at 17:44)</a>:</h4>
<p>What are you doing with your slices?  The invariant is declared on the wrong element.  You can't check if effective is present within the context of effective</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
