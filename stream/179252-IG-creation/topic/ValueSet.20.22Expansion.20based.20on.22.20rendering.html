---
layout: page
title: "FHIR Chat  · ValueSet &quot;Expansion based on&quot; rendering · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html">ValueSet &quot;Expansion based on&quot; rendering</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="192018852"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/192018852" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#192018852">(Mar 27 2020 at 13:47)</a>:</h4>
<p>I pulled this out of Valueset Rendering and made it a separate topic.  We have some GPS value sets now in IPS that combine contents from two different SNOMED CT releases.  In these cases the vast majority of the content is from the July 2019 release, but there are also a few of the new coronavirus concepts included from the March 9 2020 release.  So the value set definition contains two compose.include.version element instances.  But the rendering of that in the expansion right now is ignoring the first instance (for July 2019) and states only that "Expansion based on SNOMED CT International edition 09-Mar 2020".  I think what it needs to do instead is list both of them as separate lines (within the same box), so it would be:</p>
<div class="codehilite"><pre><span></span>Expansion based on SNOMED CT International edition 31-Jul 2019
Expansion based on SNOMED CT International edition 09-Mar 2020
</pre></div>


<p>I don't think that it will matter if you can tell in the expansion results which of the concepts came from which system and version (you can figure that out separately if you need to), but I think that it does matter that all of them are included in the display rendering.</p>



<a name="192151259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/192151259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#192151259">(Mar 29 2020 at 01:54)</a>:</h4>
<p>Submitted <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/160" title="https://github.com/hapifhir/org.hl7.fhir.core/pull/160">PR#160</a> on org.hl7.fhir.core. <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="192196105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/192196105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#192196105">(Mar 29 2020 at 21:55)</a>:</h4>
<p>Fixed a bug in the PR - submitted new <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/161" title="https://github.com/hapifhir/org.hl7.fhir.core/pull/161">PR#161</a>. <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="192268272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/192268272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#192268272">(Mar 30 2020 at 15:01)</a>:</h4>
<p>One more PR -  <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/162" title="https://github.com/hapifhir/org.hl7.fhir.core/pull/162">PR#162</a>.  This removes extra r5.model imports that somehow (via Eclipse?) crept into the r4 NarrativeGenerator.  Build is fixed now.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="193535701"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/193535701" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#193535701">(Apr 10 2020 at 03:39)</a>:</h4>
<p>I'm bringing this back up again.  The previous fix is working well for our original use case in IPS for our value sets where the expansion is based on codes that are being included from more than one version of a code system.  This is an <a href="/user_uploads/10155/JgXuiZUoXoGNw5YDjNMIyL40/Screen-Shot-2020-04-08-at-22.38.14.png" title="Screen-Shot-2020-04-08-at-22.38.14.png">example</a> of how it looks for this <a href="http://build.fhir.org/ig/HL7/fhir-ips/branches/master/ValueSet-organism-gps-uv-ips.html" title="http://build.fhir.org/ig/HL7/fhir-ips/branches/master/ValueSet-organism-gps-uv-ips.html">value set</a>.  So that's good.</p>
<div class="message_inline_image"><a href="/user_uploads/10155/JgXuiZUoXoGNw5YDjNMIyL40/Screen-Shot-2020-04-08-at-22.38.14.png" title="example"><img src="/user_uploads/10155/JgXuiZUoXoGNw5YDjNMIyL40/Screen-Shot-2020-04-08-at-22.38.14.png"></a></div><p>But it's not looking so good with other different value sets that we have which are defined by including multiple other value sets.  This is an <a href="/user_uploads/10155/mnhLgvtdth0sFvtcFBcE4r4M/Screen-Shot-2020-04-09-at-22.26.01.png" title="Screen-Shot-2020-04-09-at-22.26.01.png">example</a> of how it looks for this <a href="http://build.fhir.org/ig/HL7/fhir-ips/branches/master/ValueSet-result-coded-value-lab-gps-uv-ips.html" title="http://build.fhir.org/ig/HL7/fhir-ips/branches/master/ValueSet-result-coded-value-lab-gps-uv-ips.html">value set</a>.  In this case the codes are all coming from the same two versions of SNOMED CT as in the previous example.  So theoretically I believe that the two displays of the "expansion source" should be exactly the same, but in this case the displayed text is all convoluted - and I think it's incomprehensible and parts of it appear likely to be incorrect (if you can actually understand how to parse it to be able to determine that).  Even with the contributions from the three value sets, I don't see a reason why there should be this level of redundancy and multiple odd combinations and confusing orders.  Hopefully it's something that can be fixed without too much difficulty. <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>?</p>
<div class="message_inline_image"><a href="/user_uploads/10155/mnhLgvtdth0sFvtcFBcE4r4M/Screen-Shot-2020-04-09-at-22.26.01.png" title="example"><img src="/user_uploads/10155/mnhLgvtdth0sFvtcFBcE4r4M/Screen-Shot-2020-04-09-at-22.26.01.png"></a></div>



<a name="193536151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/193536151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#193536151">(Apr 10 2020 at 03:52)</a>:</h4>
<p>It's also interesting to note that in the result-coded-value-lab-gps-uv-ips value set (based on the other three value sets) the concept count is being reported incorrectly.  The count of 1018 concepts that is shown is apparently based on the truncated 1000 concepts that are shown in the expansion display for the organism-gps-uv-ips value set (that value set actually contains 4082 concepts) plus the 8 concepts in lab-blood-abo-rh-grp-gps-uv-ips and the 9 concepts in lab-absence-presence-gps-uv-ips (plus 1 additional concept from somewhere?).</p>



<a name="193614096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/193614096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#193614096">(Apr 10 2020 at 20:29)</a>:</h4>
<p>Another <a href="/user_uploads/10155/LLCPoAk2RsvRGRoeTUC6-DQ9/Screen-Shot-2020-04-10-at-15.22.50.png" title="Screen-Shot-2020-04-10-at-15.22.50.png">screen shot</a>  that shows (much more clearly, I think) the issues with the "expansion source" display - in this case in the <a href="https://build.fhir.org/ig/HL7/fhir-ips/ValueSet-imaging-txtobs-code-uv-ips.html" title="https://build.fhir.org/ig/HL7/fhir-ips/ValueSet-imaging-txtobs-code-uv-ips.html">imaging-txtobs-code-uv-ips</a> value set, with content from multiple code systems, rather than multiple versions.</p>
<div class="message_inline_image"><a href="/user_uploads/10155/LLCPoAk2RsvRGRoeTUC6-DQ9/Screen-Shot-2020-04-10-at-15.22.50.png" title="screen shot"><img src="/user_uploads/10155/LLCPoAk2RsvRGRoeTUC6-DQ9/Screen-Shot-2020-04-10-at-15.22.50.png"></a></div>



<a name="193646643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/193646643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#193646643">(Apr 11 2020 at 07:13)</a>:</h4>
<p>ok all fixed next release</p>



<a name="193995594"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/193995594" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#193995594">(Apr 15 2020 at 07:56)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> It turns out that it wasn't quite all fixed. :(  The update broke the ability to render the expansion notice for multiple versions of the same code system.  But I've just submitted <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/174" title="https://github.com/hapifhir/org.hl7.fhir.core/pull/174">PR#174</a> to fix that.</p>



<a name="194016576"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/194016576" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#194016576">(Apr 15 2020 at 11:42)</a>:</h4>
<p>I'll look at it</p>



<a name="194019676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/ValueSet%20%22Expansion%20based%20on%22%20rendering/near/194019676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/ValueSet.20.22Expansion.20based.20on.22.20rendering.html#194019676">(Apr 15 2020 at 12:13)</a>:</h4>
<p>thanks</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
