---
layout: page
title: "FHIR Chat  · Bug in Snapshot Generation of Type Slices? · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Bug.20in.20Snapshot.20Generation.20of.20Type.20Slices.3F.html">Bug in Snapshot Generation of Type Slices?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="265234984"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Bug%20in%20Snapshot%20Generation%20of%20Type%20Slices%3F/near/265234984" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Bug.20in.20Snapshot.20Generation.20of.20Type.20Slices.3F.html#265234984">(Dec 16 2021 at 23:31)</a>:</h4>
<p>Given this differential:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"Observation.value[x]"</span><span class="p">,</span>
    <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"Observation.value[x]"</span><span class="p">,</span>
    <span class="nt">"slicing"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"discriminator"</span><span class="p">:</span> <span class="p">[{</span> <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"type"</span><span class="p">,</span> <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"$this"</span> <span class="p">}],</span>
      <span class="nt">"ordered"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nt">"rules"</span><span class="p">:</span> <span class="s2">"open"</span>
    <span class="p">},</span>
    <span class="nt">"type"</span><span class="p">:</span> <span class="p">[{</span> <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"CodeableConcept"</span> <span class="p">}]</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"Observation.value[x]:valueCodeableConcept"</span><span class="p">,</span>
    <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"Observation.value[x]"</span><span class="p">,</span>
    <span class="nt">"sliceName"</span><span class="p">:</span> <span class="s2">"valueCodeableConcept"</span><span class="p">,</span>
    <span class="nt">"min"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">"max"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span>
    <span class="nt">"mustSupport"</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<p>the IG publisher creates this:<br>
<a href="/user_uploads/10155/8w6TjLEFRhOV9P3cdMrPmuQ4/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/8w6TjLEFRhOV9P3cdMrPmuQ4/image.png" title="image.png"><img src="/user_uploads/10155/8w6TjLEFRhOV9P3cdMrPmuQ4/image.png"></a></div><p>Notice that the type slice has ALL the types in it.  Since <code>value[x]</code> was already type constrained to only CodeableConcept, then shouldn't the slice also be type constrained to CodeableConcept (without having to put it in the differential)?  It doesn't make sense for a type slice to support more types than its slice base, but this is what the snapshot generator is doing...  That's not right, is it?</p>



<a name="265241457"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Bug%20in%20Snapshot%20Generation%20of%20Type%20Slices%3F/near/265241457" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Bug.20in.20Snapshot.20Generation.20of.20Type.20Slices.3F.html#265241457">(Dec 17 2021 at 00:55)</a>:</h4>
<p>It's not right, but the question is whether we expect the base information to be propagated into slices.  I believe the answer is "no".  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ?</p>



<a name="265296880"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Bug%20in%20Snapshot%20Generation%20of%20Type%20Slices%3F/near/265296880" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Bug.20in.20Snapshot.20Generation.20of.20Type.20Slices.3F.html#265296880">(Dec 17 2021 at 13:46)</a>:</h4>
<p>Why shouldn't the snapshot generator use the base slice element as its starting point (rather than the unconstrained element from the core resource)?  If authors have to manually duplicate all their constraints into each slice, then there will undoubtedly be mistakes -- and it can potentially introduce a lot of noise into the differential as well.  Is this a technical limitation in the snapshot generator or an intentional design choice?</p>



<a name="265313908"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Bug%20in%20Snapshot%20Generation%20of%20Type%20Slices%3F/near/265313908" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Bug.20in.20Snapshot.20Generation.20of.20Type.20Slices.3F.html#265313908">(Dec 17 2021 at 15:48)</a>:</h4>
<p>I'll let <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> answer that.  I think some of it has to do with constraints around constraining slices.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
