---
layout: page
title: "FHIR Chat  · Profile constraints being pulled into slice · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Profile.20constraints.20being.20pulled.20into.20slice.html">Profile constraints being pulled into slice</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="243218787"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Profile%20constraints%20being%20pulled%20into%20slice/near/243218787" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Profile.20constraints.20being.20pulled.20into.20slice.html#243218787">(Jun 19 2021 at 00:29)</a>:</h4>
<p>If you want to see what I'm talking about below - <a href="https://github.com/HL7/fhir-spl/">https://github.com/HL7/fhir-spl/</a></p>
<p>I have an Organization profile where I slice Organization.contact.telecom based on the system.  On each slice, I indicate that the contact.telecom must conform to a ContactPoint profile I've created:</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot;: &quot;Organization.contact.telecom&quot;,
        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,
        &quot;slicing&quot;: {
          &quot;discriminator&quot;: [
            {
              &quot;type&quot;: &quot;value&quot;,
              &quot;path&quot;: &quot;system&quot;
            }
          ],
          &quot;rules&quot;: &quot;open&quot;,
          &quot;description&quot;: &quot;Require a telephone number and an email address.&quot;
        },
        &quot;min&quot;: 2,
        &quot;mustSupport&quot;: true
      },
      {
        &quot;id&quot;: &quot;Organization.contact.telecom:Phone&quot;,
        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,
        &quot;sliceName&quot;: &quot;Phone&quot;,
        &quot;min&quot;: 1,
        &quot;max&quot;: &quot;1&quot;,
        &quot;type&quot;: [
          {
            &quot;code&quot;: &quot;ContactPoint&quot;,
            &quot;profile&quot;: [
              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;
            ]
          }
        ],
        &quot;mustSupport&quot;: true
      },
      {
        &quot;id&quot;: &quot;Organization.contact.telecom:Phone.system&quot;,
        &quot;path&quot;: &quot;Organization.contact.telecom.system&quot;,
        &quot;patternCode&quot;: &quot;phone&quot;
      },
      {
        &quot;id&quot;: &quot;Organization.contact.telecom:Email&quot;,
        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,
        &quot;sliceName&quot;: &quot;Email&quot;,
        &quot;min&quot;: 1,
        &quot;max&quot;: &quot;1&quot;,
        &quot;type&quot;: [
          {
            &quot;code&quot;: &quot;ContactPoint&quot;,
            &quot;profile&quot;: [
              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;
            ]
          }
        ],
        &quot;mustSupport&quot;: true
      },
      {
        &quot;id&quot;: &quot;Organization.contact.telecom:Email.system&quot;,
        &quot;path&quot;: &quot;Organization.contact.telecom.system&quot;,
        &quot;patternCode&quot;: &quot;email&quot;
      },
      {
        &quot;id&quot;: &quot;Organization.contact.address&quot;,
        &quot;path&quot;: &quot;Organization.contact.address&quot;,
        &quot;min&quot;: 1,
        &quot;type&quot;: [
          {
            &quot;code&quot;: &quot;Address&quot;,
            &quot;profile&quot;: [
              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLAddress&quot;
            ]
          }
        ],
        &quot;mustSupport&quot;: true
      }
</code></pre></div>
<p>After generation by the IG Publisher, all of the constraints expressed on my ContactPoint profile are being "moved up" into the Organization profile.  The profile specifies that contact.telecom must conform to SPLContactPoint, but it also duplicates all of the constraints as well.</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot;: &quot;Organization.contact.telecom:Phone&quot;,
        &quot;path&quot;: &quot;Organization.contact.telecom&quot;,
        &quot;sliceName&quot;: &quot;Phone&quot;,
        &quot;short&quot;: &quot;Details of a Technology mediated contact point (phone, fax, email, etc.)&quot;,
        &quot;definition&quot;: &quot;Details for all kinds of technology mediated contact points for a person or organization, including telephone, email, etc.&quot;,
        &quot;requirements&quot;: &quot;People have (primary) ways to contact them in some way such as phone, email.&quot;,
        &quot;min&quot;: 1,
        &quot;max&quot;: &quot;1&quot;,
        &quot;base&quot;: {
          &quot;path&quot;: &quot;Organization.contact.telecom&quot;,
          &quot;min&quot;: 0,
          &quot;max&quot;: &quot;*&quot;
        },
        &quot;type&quot;: [
          {
            &quot;code&quot;: &quot;ContactPoint&quot;,
            &quot;profile&quot;: [
              &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;
            ]
          }
        ],
...
          {
            &quot;key&quot;: &quot;spl-2.1.7.x&quot;,
            &quot;severity&quot;: &quot;error&quot;,
            &quot;human&quot;: &quot;Telephone and fax numbers are formatted properly&quot;,
            &quot;expression&quot;: &quot;(system = &#39;phone&#39; or system = &#39;fax&#39;) implies value.matches(&#39;^\\\\+[0-9]{1,3}-[0-9]{1,3}-[0-9]{3,4}-[0-9]{4}(;ext=[0-9]+)?$&#39;)&quot;,
            &quot;source&quot;: &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;
          },
          {
            &quot;key&quot;: &quot;spl-2.1.7.11&quot;,
            &quot;severity&quot;: &quot;error&quot;,
            &quot;human&quot;: &quot;Emails are formatted properly&quot;,
            &quot;expression&quot;: &quot;system = &#39;email&#39; implies value.matches(&#39;^[a-zA-Z0-9.!#$%&amp;’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(\\\\.[a-zA-Z0-9-]+)*$&#39;)&quot;,
            &quot;source&quot;: &quot;http://hl7.org/fhir/us/spl/StructureDefinition/SPLContactPoint&quot;
          }
</code></pre></div>
<p>This effectively duplicates the profile constraints.  I'm not sure that it should be doing that.</p>



<a name="243434030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Profile%20constraints%20being%20pulled%20into%20slice/near/243434030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Profile.20constraints.20being.20pulled.20into.20slice.html#243434030">(Jun 21 2021 at 19:52)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> should the snapshot be pulling the constraints from the datatype profile into the main profile?  I'm wondering if it is doing that because my discriminator is on the ContactPoint.system?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
