---
layout: page
title: "FHIR Chat  · Local IG Building against R4B · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html">Local IG Building against R4B</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="247754211"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247754211" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247754211">(Jul 30 2021 at 19:55)</a>:</h4>
<p>Hi all, I'm trying to sort out how to build an IG locally against an R4B build.  I've been moving files around in <code>.fhir/packages</code> but haven't found any magic way of getting it to go through.  Any help / direction would be appreciated, thanks!</p>



<a name="247759069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247759069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247759069">(Jul 30 2021 at 20:40)</a>:</h4>
<p><span class="user-mention" data-user-id="248736">@Mark Iantorno</span> What's the version id to use to build against the R4B CI-build?</p>



<a name="247759129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247759129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247759129">(Jul 30 2021 at 20:41)</a>:</h4>
<p>Are you talking release number?</p>



<a name="247759135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247759135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247759135">(Jul 30 2021 at 20:41)</a>:</h4>
<p>On github?</p>



<a name="247759330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247759330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247759330">(Jul 30 2021 at 20:42)</a>:</h4>
<p>FHIR release version number</p>



<a name="247759686"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247759686" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247759686">(Jul 30 2021 at 20:46)</a>:</h4>
<p>I do not know that, sorry.</p>



<a name="247932681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247932681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247932681">(Aug 02 2021 at 15:26)</a>:</h4>
<p>Post-weekend bump - if anyone knows how to build an IG against R4B, I'd appreciate it.  Thanks!</p>



<a name="247935396"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247935396" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247935396">(Aug 02 2021 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-id="191415">@Giorgio Cangioli</span> ?</p>



<a name="247937338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247937338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giorgio Cangioli <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247937338">(Aug 02 2021 at 16:12)</a>:</h4>
<p>I've not rebuilt recently the guide, but last time I did I had to copy the hl7.fhir.r4b.core#4.1.0 package into hl7.fhir.r5.core#4.1.0 to make sushi  happy ..... but maybe this was not the question</p>



<a name="247937497"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247937497" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giorgio Cangioli <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247937497">(Aug 02 2021 at 16:13)</a>:</h4>
<p>..and I had a lot of broken links errors...</p>



<a name="247937792"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247937792" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247937792">(Aug 02 2021 at 16:17)</a>:</h4>
<p>Thanks Giorgio, that's similar to what I'm tinkering with now - manually putting the package into <code>.fhir/packages</code> and adding dev dependencies.  If I manage a working setup I'll be sure to comment here.</p>



<a name="247937900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247937900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247937900">(Aug 02 2021 at 16:18)</a>:</h4>
<p>We've updated support in SUSHI (in the SUSHI 2.0.0 betas) to support FHIR R4B Ballot #1 edition.  To use that, you set <code>fhirVersion: 4.1.0</code> in <code>sushi-config.yaml</code>.  IIRC, that works out to <code>hl7.fhir.r4b.core#4.1.0</code>.  If you want a <em>more current</em> build than ballot #1, however, I'm not sure that's possible without a lot of hacking.</p>



<a name="247939048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247939048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247939048">(Aug 02 2021 at 16:29)</a>:</h4>
<p>Thanks Chris, but that's exactly what I need.  I have a branch of R4B that hasn't been merged in yet, and I need to build the IG against it (modelling changes from ballot reconciliation of R4B and the IG - yuck).  I am hesitantly hopeful that this process works:</p>
<ul>
<li>Locally build R4B</li>
<li>Expand the R4B package into <code>~/.fhir/packages</code> as <code>hl7.fhir.r4b.code#dev</code></li>
<li>Add the <code>hl7.fhir.r4b.core: dev</code> dependency to <code>sushi-config.yaml</code></li>
</ul>
<p>There were a <em>lot</em> of changes to the IG to support this change, so I am working through all of the errors right now, but it <em>looks</em> like it may work.</p>



<a name="247940004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247940004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247940004">(Aug 02 2021 at 16:40)</a>:</h4>
<p>Hmmm... Yeah, I don't know for sure if that will work.  It might?  The problem is that SUSHI does not treat FHIR Core exactly the same as a dependency.  You will still need to declare a <code>fhirVersion</code> in your <code>sushi-config.yaml</code> -- and whatever your declare there (4.0.1, 4.1.0, etc) will be available <em>in addition to</em> whatever gets pulled in via the dependencies.</p>
<p>I think that the approach that is more likely to work (with SUSHI, anyway) would be to expand your local build package into <code>~/.fhir/packages/hl7.fhir.r4b.core#4.1.0</code> (replacing the real 4.1.0).  Then SUSHI is not loading multiple builds of FHIR Core.  BUT... I don't know how the IG Publisher would deal with that (might be fine?).  And, of course, you're setting yourself up for all kinds of trouble if you forget that you did this and leave it like that in your package cache.  AND (while I'm at it), this will of course fail pretty miserably in the Auto Build CI.</p>



<a name="247947871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247947871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247947871">(Aug 02 2021 at 17:44)</a>:</h4>
<p>Thanks Chris, testing through that now.  Yes, this is frustrating, and hopefully not common...  For the subscriptions backport IG, there are two new resources we added in R4B, so it has a dependency on that.  But, I can't build the IG so we can't evaluate the changes.</p>
<p>Even when the resources are merged into R4B (soon), it will only be on the CI build so that's another issue.  But I'm not worrying about that today  =).</p>



<a name="247954869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247954869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247954869">(Aug 02 2021 at 18:47)</a>:</h4>
<p>Ok, for posterity I'll document the steps here:</p>
<ul>
<li>Build local R4B</li>
<li>Extract <code>.../publish/hl7.fhir.r4b.core.tgz</code> to <code>~/.fhir/packages/hl7.fhir.r4b.core#4.1.0</code></li>
<li>Extract <code>.../publish/hl7.fhir.r4b.expansions.tgz</code> to <code>~/.fhir/packages/hl7.fhir.r4b.expansions#4.1.0</code></li>
<li>Set the <code>fhirVersion</code> in <code>sushi-config.yaml</code> to <code>4.1.0</code></li>
<li>Set the <code>version</code> in <code>ig.ini</code> to <code>hl7.fhir.r4b.core#4.1.0</code></li>
</ul>
<p>As a note, the branch I have had an error in an example (<code>Questionnaire-qs1.json</code>) that prevented the build from working.  I deleted that file and removed it from <code>~/.fhir/packages/hl7.fhir.r4b.core#4.1.0/package/.index.json</code>.  I'd assume nothing like that <em>should</em> be needed, but since I'm not working on Questionnaire at all, I assume anyone doing a local build will run into the same error.</p>
<p>Thanks everyone for all the assistance!</p>



<a name="247960727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247960727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giorgio Cangioli <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247960727">(Aug 02 2021 at 19:32)</a>:</h4>
<p>Thanks a lot Gino and Chris, very useful information for my next steps :-)</p>



<a name="247962912"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/247962912" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#247962912">(Aug 02 2021 at 19:50)</a>:</h4>
<p><del>Blah.  As a note, this no longer works for sushi (e.g., some earlier step worked, then manually running the ig builder worked), so I don't have a single config that works for both..</del></p>
<p>edit: it does, I'm just doing too many things at once  <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span></p>



<a name="249557240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249557240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249557240">(Aug 16 2021 at 07:27)</a>:</h4>
<p>So ... I also got it working locally ... - but what voodoo is needed for R4B to be supported in the CI build pipeline? Log can be seen here: <a href="https://build.fhir.org/ig/hl7-eu/gravitate-health/branches/master/failure/build.log">https://build.fhir.org/ig/hl7-eu/gravitate-health/branches/master/failure/build.log</a></p>
<p>The essential part is this: <code>Sushi: error Failed to load hl7.fhir.r4b.core#4.1.0: connect ETIMEDOUT 35.184.92.126:80 (02:11.0167)</code></p>



<a name="249557312"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249557312" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249557312">(Aug 16 2021 at 07:28)</a>:</h4>
<p>Is it <span class="user-mention" data-user-id="191315">@Josh Mandel</span> I need to send some flowers and chocolates to?</p>



<a name="249595441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249595441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249595441">(Aug 16 2021 at 14:26)</a>:</h4>
<p>No, I don't really know how this works. From your log, looks like sushi is trying to connect to a server called 35.184.92.126 which is a (non-tls-protected?!) connection to the VM running a service called packages2-fhir-org in our GCP console. And neither <a href="http://packages2.fhir.org/">http://packages2.fhir.org/</a> and <a href="https://packages2.fhir.org/">https://packages2.fhir.org/</a> seems to be working.</p>



<a name="249602278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249602278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249602278">(Aug 16 2021 at 15:16)</a>:</h4>
<p><span class="user-mention" data-user-id="191427">@Jens Villadsen</span> FWIW, I'm grabbing the output folder and putting it on a <a href="http://github.io">github.io</a> (edit: GitHub Pages) for the near term.  Not as good as CI, but it gives a public endpoint for review for now.</p>



<a name="249614663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249614663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249614663">(Aug 16 2021 at 16:52)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> Im 'just' using the CI stuff here. <span class="user-mention" data-user-id="191469">@Chris Moesel</span> who's sushi trying to dial up here?</p>



<a name="249621629"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249621629" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249621629">(Aug 16 2021 at 17:41)</a>:</h4>
<p>Makes sense; in turn, the CI infrastructure is "just" executing the same tools you run locally (sushi + IG publisher), albeit from a "blank slate" (no saved prior build state, empty FHIR cache, etc).</p>



<a name="249621655"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249621655" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249621655">(Aug 16 2021 at 17:41)</a>:</h4>
<p>The issue seems to be that <a href="http://packages2.fhir.org">packages2.fhir.org</a> is down.</p>



<a name="249624839"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249624839" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249624839">(Aug 16 2021 at 18:04)</a>:</h4>
<p>Right  - ephemeral containers all the way. - and I could have done the reverse IP lookup myself <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span></p>



<a name="249678537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249678537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249678537">(Aug 17 2021 at 04:53)</a>:</h4>
<p>I don't think that the IG publisher supports building against your local dev branch of a FHIR base specification. At least, it's <em>never</em> been on my roadmap for it to do so</p>



<a name="249709270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249709270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249709270">(Aug 17 2021 at 12:14)</a>:</h4>
<p>It does, in a way.  Since it checks the local cache, you can set your version (e.g., 4.1.0) and manually put your local build there.  It complains because various URLs don’t resolve, but the build works.</p>



<a name="249741360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249741360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249741360">(Aug 17 2021 at 16:11)</a>:</h4>
<p><span class="user-mention" data-user-id="191427">@Jens Villadsen</span> -- R4B and R5 ballot editions are only available on <a href="http://packages2.fhir.org">packages2.fhir.org</a> (as opposed to official R4 that is available on <a href="http://packages.fhir.org">packages.fhir.org</a>).  So SUSHI is trying to dial up <a href="http://packages2.fhir.org">packages2.fhir.org</a>.</p>



<a name="249757640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249757640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249757640">(Aug 17 2021 at 18:19)</a>:</h4>
<p>Hmmm ... <span class="user-mention" data-user-id="222054">@Gino Canessa</span> I tried to follow your steps but it doesn't seem to work. I've added the R4B to the locale package registry and it looks like it resolves ok, but Sushi chokes on the example resource I have present with the message:</p>
<div class="codehilite"><pre><span></span><code>warn  SUSHI support for pre-release versions of FHIR is experimental. Use at your own risk!
info  Checking local cache for hl7.fhir.uv.ips#current...
info  Found hl7.fhir.uv.ips#current in local cache.
info  Checking local cache for hl7.fhir.r4b.core#4.1.0...
info  Found hl7.fhir.r4b.core#4.1.0 in local cache.
info  Loaded package hl7.fhir.r4b.core#4.1.0
...
Unknown resource type: MedicinalProductDefinition
</code></pre></div>



<a name="249758082"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249758082" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249758082">(Aug 17 2021 at 18:22)</a>:</h4>
<p>That might be more down <span class="user-mention" data-user-id="191469">@Chris Moesel</span> 's alley.  - and <span class="user-mention" data-user-id="222054">@Gino Canessa</span> the following is also logged</p>
<div class="codehilite"><pre><span></span><code>warn  Your gravitate-health/ig.ini file contains the following unsupported properties: version. These are no longer supported in ig.ini and should be removed.  See the following link for details: https://github.com/HL7/ig-template-base/releases/tag/0.0.2
</code></pre></div>



<a name="249758148"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249758148" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249758148">(Aug 17 2021 at 18:23)</a>:</h4>
<p>Meaning that setting the version in ig.ini probably don't do much</p>



<a name="249758375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249758375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249758375">(Aug 17 2021 at 18:24)</a>:</h4>
<p>Yes, it needs to be set as <code>fhirVersion</code> in <code>sushi-config.yaml</code> now.  I assume yours is correct since it looks like it is finding the package.</p>
<p>If you look in your <code>~/.fhir/pacakges/hl7.fhir.r4b.core#4.1.0/package</code> folder, is the <code>StructureDefinition-MedicinalProductDefinition.json</code> file there?</p>



<a name="249758493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249758493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249758493">(Aug 17 2021 at 18:25)</a>:</h4>
<p>yep</p>



<a name="249758786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249758786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249758786">(Aug 17 2021 at 18:27)</a>:</h4>
<p>Is there a repo I can pull to see if I can build it here?  Those steps have worked for me to access <code>SubscriptionTopic</code> and <code>SubscriptionStatus</code>, so I assume they should work for <code>MedicinalProductDefinition</code> as well.</p>



<a name="249758952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249758952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249758952">(Aug 17 2021 at 18:28)</a>:</h4>
<p>That would be <a href="https://github.com/hl7-eu/gravitate-health">https://github.com/hl7-eu/gravitate-health</a></p>



<a name="249762353"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249762353" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249762353">(Aug 17 2021 at 18:53)</a>:</h4>
<p>Ohhhhhhh...  I think I know what is happening here.  Your example is an XML file (not FSH) -- <code>medicinalproductdefinition-example.xml</code>.  SUSHI tries to read in all of the other files in <code>input</code> -- but since it uses JSON internally, it attempts to translate the XML into JSON using the <a href="https://github.com/lantanagroup/FHIR.js">FHIR.js</a> library.  BUT... by default, that library only supports FHIR 4.0.  There are instructions in its README for supporting other FHIR versions (which requires loading the fhir-definitions package) -- but SUSHI is not doing that.  So... in order to make this error go away, either (a) you need to store that example in your project as JSON instead of XML (or even better, as FSH) or (b) we need to update SUSHI to load up FHIR.js w/ other versions of FHIR.  If you're trying to get this done soon, then <em>(a)</em> would be your better option.</p>



<a name="249762901"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249762901" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249762901">(Aug 17 2021 at 18:57)</a>:</h4>
<p>Yep, was just typing that up.  I didn't port the complete example, but making it a FSH instance gets past that hurdle of the build:</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">Instance:     GravitateHealthMedicinalProductDefinitionAuthorized</span>
<span class="go">InstanceOf:   MedicinalProductDefinition</span>
<span class="go">Usage:        #example</span>
<span class="go">Title:        "Authorized"</span>
<span class="go">Description:  "Example of an Authorized Medicinal Product Definition"</span>
<span class="go">* id        = "medicinalproductdefinition-authorized"</span>
</code></pre></div>
<p>So, the above works (though is obviously not equivalent).  Once that was fixed, it came across another error:</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">Sushi couldn't be run. Complete output from running Sushi : warn  The name "Example-sections-PL" may not be suitable for machine processing applications such as code generation. Valid names start with an upper-case ASCII letter ('A'..'Z') followed by any combination of upper- or lower-case ASCII letters ('A'..'Z',  (01:17.0104)</span>
<span class="go">Note: Check that Sushi is installed correctly ("npm install -g fsh-sushi". On windows, get npm from https://www.npmjs.com/get-npm) (01:17.0107)</span>
<span class="go">Exception: Process exited with an error: 1 (Exit value: 1)                       (01:17.0109)</span>
<span class="go">Publishing Content Failed: Process exited with an error: 1 (Exit value: 1)       (01:17.0110)</span>
</code></pre></div>
<p>Which I believe <em>shouldn't</em> actually exit, but having seen things like this in the past I assume correcting the warnings will get everything through.</p>



<a name="249764412"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249764412" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249764412">(Aug 17 2021 at 19:09)</a>:</h4>
<p>I had a suspicion about that ... Thanks for clarifying - both of you :)</p>



<a name="249772807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249772807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249772807">(Aug 17 2021 at 20:14)</a>:</h4>
<p><span class="user-mention" data-user-id="222054">@Gino Canessa</span> FWIW - I've thrown a docker image up on <a href="https://hub.docker.com/r/trifork/ig-publisher-base/tags?page=1&amp;ordering=last_updated">https://hub.docker.com/r/trifork/ig-publisher-base/tags?page=1&amp;ordering=last_updated</a></p>



<a name="249772916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249772916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249772916">(Aug 17 2021 at 20:14)</a>:</h4>
<p>the source is at <a href="https://github.com/hl7-eu/gravitate-health/tree/master/docker">https://github.com/hl7-eu/gravitate-health/tree/master/docker</a></p>



<a name="249773034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249773034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249773034">(Aug 17 2021 at 20:15)</a>:</h4>
<p>and I've added the workflow (<a href="https://github.com/hl7-eu/gravitate-health/blob/master/.github/workflows/main.yml">https://github.com/hl7-eu/gravitate-health/blob/master/.github/workflows/main.yml</a>) so that it renders on (<a href="https://hl7-eu.github.io/gravitate-health/">https://hl7-eu.github.io/gravitate-health/</a>)</p>



<a name="249823098"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249823098" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249823098">(Aug 18 2021 at 08:58)</a>:</h4>
<p>Ooops ... looks like I forgot to push the changes ... that will be done later today</p>



<a name="249823154"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Local%20IG%20Building%20against%20R4B/near/249823154" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Local.20IG.20Building.20against.20R4B.html#249823154">(Aug 18 2021 at 08:59)</a>:</h4>
<p><span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
