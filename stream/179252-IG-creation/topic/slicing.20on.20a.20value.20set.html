---
layout: page
title: "FHIR Chat  · slicing on a value set · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html">slicing on a value set</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="159329147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159329147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159329147">(Feb 25 2019 at 11:05)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span>  Can you tell me how to slice on a value set or a binding? Can I do that in a pattern? Do I need to use a pattern to do that? Right now it appears I have to re-list the codes contained in the value set in a patternCodeableConcept for example.</p>



<a name="159349713"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159349713" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159349713">(Feb 25 2019 at 16:18)</a>:</h4>
<p>Slice by value.  When you slice by value, the process checks for either a fixed value or a fixed value set binding on the discriminator</p>



<a name="159350859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159350859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159350859">(Feb 25 2019 at 16:32)</a>:</h4>
<blockquote>
<p>Slice by value.  When you slice by value, the process checks for either a fixed value or a fixed value set binding on the discriminator</p>
</blockquote>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <br>
So is this correct way to slice on system and value set?</p>
<p><code>    &lt;element id="Device.property"&gt;
      &lt;path value="Device.property" /&gt;
      &lt;slicing&gt;
        &lt;!-- The type.system and the type of value (code or quantity) are needed to distinguish entrants. The BITs properties
        (time capabilities and regulation status) will have a fixed system ASN1-url with a coded value. The remaining entrants
        will have the same fixed 10101-url with either a single-coded, multiple-coded, or quantity entry. --&gt;
        &lt;discriminator&gt;
          &lt;type value="value" /&gt;
 &lt;!-- system being used in value set value set --&gt;
          &lt;path value="system" /&gt;
        &lt;/discriminator&gt;
        &lt;discriminator&gt;
          &lt;type value="value" /&gt;
 &lt;!-- codes specified by value set --&gt;
          &lt;path value="code" /&gt;
        &lt;/discriminator&gt;
        &lt;rules value="open" /&gt;
      &lt;/slicing&gt;
    &lt;/element&gt;
    &lt;element id="Device.property:quantitiesProperty"&gt;
      &lt;path value="Device.property" /&gt;
      &lt;sliceName value="quantitiesProperty" /&gt;
      &lt;short value="The device properties represented by quantities such as clock resolution" /&gt;
      &lt;definition value="This element represents all those time properties that are a quantity such as the various clock resolutions and synchronization accuracy." /&gt;
      &lt;comment value="If the PHD reports that one of these given properties are unknown, this element shall not be populated for that property." /&gt;
    &lt;/element&gt;
    &lt;element id="Device.property:quantitiesProperty.type"&gt;
      &lt;path value="Device.property.type" /&gt;
      &lt;short value="The type of time quantity" /&gt;
      &lt;binding&gt; 
        &lt;strength value="required"/&gt;
        &lt;!-- These are the codes that identify this Quantities property --&gt;
        &lt;valueSet value="http://hl7.org/fhir/uv/phd/ValueSet/Quantity11073MDC"/&gt; 
      &lt;/binding&gt;
    &lt;/element&gt;
    &lt;element id="Device.property:quantitiesProperty.type.text"&gt;
      &lt;path value="Device.property.type.text" /&gt;
      &lt;definition value="It is recommended to display at least the MDC reference identifier for the MDC code" /&gt;
    &lt;/element&gt;
    &lt;!-- Slice the coding to allow one to express the same concept in another coding system --&gt;
    &lt;element id="Device.property:quantitiesProperty.type.coding"&gt;
      &lt;path value="Device.property.type.coding" /&gt;
      &lt;slicing&gt;
        &lt;discriminator&gt;
          &lt;type value="value" /&gt;
          &lt;path value="system" /&gt;
        &lt;/discriminator&gt;
        &lt;rules value="open" /&gt;
      &lt;/slicing&gt;
      &lt;min value="1" /&gt;
    &lt;/element&gt;
    &lt;element id="Device.property:quantitiesProperty.type.coding:MDCType"&gt;
      &lt;path value="Device.property.type.coding" /&gt;
      &lt;sliceName value="MDCType" /&gt;
      &lt;short value="The 11073-10101 MDC code for the type" /&gt;
      &lt;min value="1" /&gt;
      &lt;max value="1" /&gt;
    &lt;/element&gt;
    &lt;!-- The system value is fixed --&gt;
    &lt;element id="Device.property:quantitiesProperty.type.coding:MDCType.system"&gt;
      &lt;path value="Device.property.type.coding.system" /&gt;
      &lt;min value="1" /&gt;
      &lt;fixedUri value="urn:iso:std:iso:11073:10101" /&gt;
    &lt;/element&gt;
    &lt;!-- These code shall be from the value set --&gt;
    &lt;element id="Device.property:quantitiesProperty.type.coding:MDCType.code"&gt;
      &lt;path value="Device.property.type.coding.code" /&gt;
      &lt;definition value="The MDC code representing the property" /&gt;
      &lt;min value="1" /&gt;
    &lt;/element&gt;</code></p>



<a name="159351528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159351528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159351528">(Feb 25 2019 at 16:40)</a>:</h4>
<p>The discriminator should be the CodeableConcept element or possibly a coding, not the individual system and code as the value set always deals with the combination</p>



<a name="159351736"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159351736" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159351736">(Feb 25 2019 at 16:42)</a>:</h4>
<blockquote>
<p>The discriminator should be the CodeableConcept element or possibly a coding, not the individual system and code as the value set always deals with the combination</p>
</blockquote>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <br>
 Oh yes, that was carelessness on my quick creation of the descriminators - <strong>and the binding is in the 'type' element</strong><br>
It should be like this:<br>
<code>      &lt;slicing&gt;
        &lt;discriminator&gt;
          &lt;type value="value" /&gt;
 &lt;!-- system being used in value set value set --&gt;
          &lt;path value="type.coding.system" /&gt;
        &lt;/discriminator&gt;
        &lt;discriminator&gt;
          &lt;type value="value" /&gt;
 &lt;!-- codes specified by value set --&gt;
          &lt;path value="type.coding.code" /&gt;
        &lt;/discriminator&gt;
        &lt;rules value="open" /&gt;
      &lt;/slicing&gt;</code></p>



<a name="159353939"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159353939" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159353939">(Feb 25 2019 at 17:10)</a>:</h4>
<p>I'd expect it to be this:<br>
    &lt;slicing&gt;<br>
      &lt;discriminator&gt;<br>
        &lt;type value="value"/&gt;<br>
        &lt;path value="type"/&gt;<br>
      &lt;/discriminator&gt;<br>
    &lt;/slicing&gt;</p>



<a name="159353974"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159353974" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159353974">(Feb 25 2019 at 17:11)</a>:</h4>
<p>If you're slicing by value set, no reason to reach inside to .coding or .system/.code</p>



<a name="159354088"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159354088" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159354088">(Feb 25 2019 at 17:12)</a>:</h4>
<blockquote>
<p>I'd expect it to be this:<br>
    &lt;slicing&gt;<br>
      &lt;discriminator&gt;<br>
        &lt;type value="value"/&gt;<br>
        &lt;path value="type"/&gt;<br>
      &lt;/discriminator&gt;<br>
    &lt;/slicing&gt;</p>
</blockquote>
<p>Hmm... That's what I had to start with ... and the validator is complaining. I must have something else sick then.</p>



<a name="159354369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159354369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159354369">(Feb 25 2019 at 17:16)</a>:</h4>
<p>You have fixed value sets declared on the "type" elements in your slices?</p>



<a name="159354508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159354508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159354508">(Feb 25 2019 at 17:18)</a>:</h4>
<blockquote>
<p>You have fixed value sets declared on the "type" elements in your slices?</p>
</blockquote>
<p>I believe so: I have this on the first slice:<br>
<code>    &lt;element id="Device.property:bitProperties"&gt;
      &lt;path value="Device.property" /&gt;
      &lt;sliceName value="bitProperties" /&gt;
      &lt;short value="Properties reported in BITs fields" /&gt;
      &lt;definition value="For each bit setting reported a BITs value, a bitProperties element is used." /&gt;
      &lt;comment value="A BITs measurement is a 16 or 32-bit ASN1 BITs value where each bit means something. " /&gt;
    &lt;/element&gt;
    &lt;!-- The bitProperties type: It will contain at least one coding element using the ASN1 system with one of
    the ASN1 codes. Currently the MdsTimeInfo capabilities and RegCertDataList regulation status are reported as BITS  --&gt;
    &lt;element id="Device.property:bitProperties.type"&gt;
      &lt;path value="Device.property.type" /&gt;
      &lt;short value="Tells what the BITs item is" /&gt;
      &lt;definition value="One of the capabilities reported in the Mds-Time-Info.mds-time-caps-state or Reg-Cert-Data-List.regulation-status field." /&gt;
      &lt;comment value="Only set 'event' types need be reported. Both set and cleared 'state' types need to be reported. The regulation status is as state type. All time capabilities are event types" /&gt;
      &lt;binding&gt; 
        &lt;strength value="required"/&gt; 
        &lt;valueSet value="http://hl7.org/fhir/uv/phd/ValueSet/ASN1attribute"/&gt; 
      &lt;/binding&gt;
    &lt;/element&gt;</code></p>



<a name="159354651"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159354651" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159354651">(Feb 25 2019 at 17:20)</a>:</h4>
<p>That looks right.  What error are you getting?</p>



<a name="159355081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159355081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159355081">(Feb 25 2019 at 17:26)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> We (IPS) got errors with this approach (multiple variations of it), too.  The issue that I see is that this isn't slicing by value.  There is no value in the instance itself that can be used to discriminate and validate that the chosen code came from a particular value set - that is not (normally) carried in the instance.  And I don't understand what the syntax '&lt;path value="type"/&gt;' would actually by trying to say (and I'm pretty sure I haven't seen it documented).</p>



<a name="159355279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159355279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159355279">(Feb 25 2019 at 17:30)</a>:</h4>
<p>The validator will check the instance against all of the slices, checking the value set.  If only one matches, you're good.  If more than one matches, it'll raise an error</p>



<a name="159355704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159355704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159355704">(Feb 25 2019 at 17:36)</a>:</h4>
<p>I know that's what it is intended to do.  That was the premise we started working on but we weren't able to get it to work.  So far I haven't seen an example where it actually does work for validating instance data.  Can you share or point to an example that does work?</p>



<a name="159385219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159385219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159385219">(Feb 26 2019 at 00:12)</a>:</h4>
<blockquote>
<p>That looks right.  What error are you getting?</p>
</blockquote>
<p>The error (well warning) is </p>
<p><code>Device/phg-ecde3d4e58532d31.000000000000: Device.property[1]: This element does not match any known slice for the profile http://hl7.org/fhir/uv/phd/StructureDefinition/PhgDevice</code></p>
<p>I get this warning for every property element in the Device resource for all my Device resources; well, slight variations of course but the idea is the same.</p>



<a name="159396484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159396484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159396484">(Feb 26 2019 at 04:10)</a>:</h4>
<p>The code system and value set are both defined within the IG?  May need to run that through the IG publisher in debug mode to see what's going on.  (Unfortunately that's unlikely to happen until the end of the week.)  Where is your stuff committed again?</p>



<a name="159410995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159410995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159410995">(Feb 26 2019 at 09:36)</a>:</h4>
<blockquote>
<p>The code system and value set are both defined within the IG?  May need to run that through the IG publisher in debug mode to see what's going on.  (Unfortunately that's unlikely to happen until the end of the week.)  Where is your stuff committed again?</p>
</blockquote>
<p>Yes, the value sets are defined in the IG and contain subsets of the MDC code system and the codes are listed in the value sets. Location <a href="https://github.com/HL7/PHD" target="_blank" title="https://github.com/HL7/PHD">https://github.com/HL7/PHD</a></p>



<a name="159435574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159435574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159435574">(Feb 26 2019 at 16:12)</a>:</h4>
<p>Yes, that's what we see, as well.  It's not much consolation that it's a warning rather than an error, because it's indicating that it doesn't actually work.</p>



<a name="159435617"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159435617" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159435617">(Feb 26 2019 at 16:13)</a>:</h4>
<blockquote>
<p>Yes, that's what we see, as well.  It's not much consolation that it's a warning rather than an error, because it's indicating that it doesn't actually work.</p>
</blockquote>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  Any idea why that is happening?</p>



<a name="159436260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159436260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159436260">(Feb 26 2019 at 16:21)</a>:</h4>
<p>Not yet :(</p>



<a name="159862511"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20on%20a%20value%20set/near/159862511" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20on.20a.20value.20set.html#159862511">(Mar 03 2019 at 20:01)</a>:</h4>
<p>do we have a test case for this?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
