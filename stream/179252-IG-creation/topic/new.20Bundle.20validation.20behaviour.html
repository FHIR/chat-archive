---
layout: page
title: "FHIR Chat  · new Bundle validation behaviour · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html">new Bundle validation behaviour</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="264860060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264860060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264860060">(Dec 14 2021 at 13:54)</a>:</h4>
<p>I have re-built an IG, just to keep up-to-date, but now I am getting errors on example Bundles having content that is not matching profiles. This was working before, i think it is still right, but not now.<br>
Did something changed in the rules the IG build is enforcing regarding Bundles? Profiles?</p>



<a name="264882498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264882498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264882498">(Dec 14 2021 at 16:19)</a>:</h4>
<p>seems "ref-1" is being enforced differently now than before?</p>



<a name="264908194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264908194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264908194">(Dec 14 2021 at 18:58)</a>:</h4>
<p>no change</p>



<a name="264935019"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264935019" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264935019">(Dec 14 2021 at 22:20)</a>:</h4>
<p>I have not changed my IG source. The sushi output, with new sushi, is logically identical to before. But now the IG publisher throws "ref-1" errors. The only thing I change is to get the new publisher. I get a couple of errors with the following pattern.</p>
<div class="codehilite"><pre><span></span><code>Bundle.entry[0] (l17/c6)    error   This element does not match any known slice defined in the profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.ProvideBundle and slicing is CLOSED: Bundle.entry[0]: Does not match slice &#39;SubmissionSet&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.SubmissionSet, Bundle.entry[0]: Does not match slice &#39;DocumentRefs&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.DocumentReference, Bundle.entry[0]: Does not match slice &#39;Documents&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://hl7.org/fhir/StructureDefinition/Binary, Bundle.entry[0]: Does not match slice &#39;Folders&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.Folder, Bundle.entry[0]: Does not match slice &#39;Patient&#39;, Bundle.entry[0]: Details for Bundle matching against Profile http://hl7.org/fhir/StructureDefinition/Patient
Bundle (l1/c2)  error   Bundle.entry:SubmissionSet: minimum required = 1, but only found 0 (from http://profiles.ihe.net/ITI/MHD/StructureDefinition/IHE.MHD.Minimal.ProvideBundle)
Bundle.entry[0].resource.extension[1].value.ofType(Reference) (l57/c14) error   ref-1: &#39;SHALL have a contained resource if a local reference is provided&#39; &#39;SHALL have a contained resource if a local reference is provided&#39; ( (url: in-practitioner2; ids: ))
</code></pre></div>



<a name="264935069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264935069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264935069">(Dec 14 2021 at 22:21)</a>:</h4>
<p>I am fine with being told that XYZ is now more strict, and that I had been taking advantage of liberal previous version of the IG builder..</p>



<a name="264935099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264935099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264935099">(Dec 14 2021 at 22:21)</a>:</h4>
<p>But, when I inspect the structure definitions and the examples, they look good to me.</p>



<a name="264936294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264936294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264936294">(Dec 14 2021 at 22:32)</a>:</h4>
<p>hm, my testBundle project does not have the problem... that one assembles similar bundles, but does not have any profiling.</p>



<a name="264936594"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264936594" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264936594">(Dec 14 2021 at 22:35)</a>:</h4>
<p>the project that is failing is a profiled bundle using #profile slicing discriminator</p>



<a name="264937791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264937791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264937791">(Dec 14 2021 at 22:47)</a>:</h4>
<p>nope. not an issue with #profile slicing. just migrated that to testBundle without failure</p>



<a name="264942481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/264942481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#264942481">(Dec 14 2021 at 23:16)</a>:</h4>
<p>I can't figure out why it built perfectly a month ago, but now fails on bundles with the ref-1 error<br>
<a href="https://github.com/IHE/ITI.MHD">https://github.com/IHE/ITI.MHD</a></p>



<a name="265050539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/265050539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#265050539">(Dec 15 2021 at 18:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> (I hope the fish were large and challenging) - I too was FSHing. I have isolated the bug. I have created a testBundle IG that isolates the problem.<br>
<a href="https://github.com/JohnMoehrke/testBundle">https://github.com/JohnMoehrke/testBundle</a><br>
cI-Build <br>
<a href="http://build.fhir.org/ig/JohnMoehrke/testBundle/branches/main/index.html">http://build.fhir.org/ig/JohnMoehrke/testBundle/branches/main/index.html</a></p>



<a name="265050910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/265050910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#265050910">(Dec 15 2021 at 18:10)</a>:</h4>
<p>The errors are thrown when... I have a Bundle that is profiled, that bundle profile is by #profile, and a resource in the bundle has a contained resource.<br>
See fshFood.fsh. comment out like 91 and 92 (the contained Practitioner); and no error will be thrown.</p>



<a name="265051609"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/265051609" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#265051609">(Dec 15 2021 at 18:14)</a>:</h4>
<p>note, it does not help for the profile of that resource to mandate contained resource. (line 80)</p>



<a name="265166769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/265166769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#265166769">(Dec 16 2021 at 14:53)</a>:</h4>
<p><a href="https://github.com/HL7/fhir-ig-publisher/issues/357">https://github.com/HL7/fhir-ig-publisher/issues/357</a></p>



<a name="265250369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/265250369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#265250369">(Dec 17 2021 at 03:37)</a>:</h4>
<p>fixed next release</p>



<a name="265914780"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/new%20Bundle%20validation%20behaviour/near/265914780" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/new.20Bundle.20validation.20behaviour.html#265914780">(Dec 23 2021 at 13:08)</a>:</h4>
<p>latest publisher does seem to work for this issue.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
