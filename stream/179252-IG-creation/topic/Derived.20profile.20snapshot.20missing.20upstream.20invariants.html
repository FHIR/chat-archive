---
layout: page
title: "FHIR Chat  · Derived profile snapshot missing upstream invariants · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html">Derived profile snapshot missing upstream invariants</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="175288929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/175288929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Eastwood <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#175288929">(Sep 09 2019 at 22:23)</a>:</h4>
<p>Not sure if this is the most suitable stream.</p>
<p>Have noticed that a derived profile, derived from another profile, does not show the first profile's invariants in the 2nd profile's snapshot table. They are in the generated structure definition xml snapshot, just not rendered in the table. To demonstrate:</p>
<p>The HL7 AU R4 <a href="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-organization.html" target="_blank" title="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-organization.html">AU Base Organization Profile</a> has a number of identifier slices most of which have invariants to control the quality of the identifier values. For example, the invariant <a href="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-organization-definitions.html#Organization.identifier:hpio" target="_blank" title="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-organization-definitions.html#Organization.identifier:hpio">inv-hpio-0 on the HPI-O slice</a>.</p>
<p>A profile derived from the above profile, the HL7 AU <a href="http://build.fhir.org/ig/hl7au/au-fhir-pd/StructureDefinition-au-pd-organisation.html" target="_blank" title="http://build.fhir.org/ig/hl7au/au-fhir-pd/StructureDefinition-au-pd-organisation.html">Australian Organisation Directory Entry Profile</a> includes a few constraints as demonstrated by its differential table view (noting that the identifier slice with the above invariant only has a must support). The differential of course does not display the invariant inv-hpio-0, but neither does the snapshot table, which was unexpected. However, the invariant is found in the generated snapshot and is shown on the <a href="http://build.fhir.org/ig/hl7au/au-fhir-pd/StructureDefinition-au-pd-organisation-definitions.html#Organization.identifier:hpio" target="_blank" title="http://build.fhir.org/ig/hl7au/au-fhir-pd/StructureDefinition-au-pd-organisation-definitions.html#Organization.identifier:hpio">detailed descriptions page</a>.</p>
<p>This may be by design, but having searched in zulip, I could find nothing related. A few colleagues are of the view that this is a feature of the snapshot table to keep it simpler. So raising to clarify.</p>
<p>Also note that I have experienced the same rendering with other derived profiles, generated via the IG publisher v0.9.69.</p>



<a name="176628151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/176628151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#176628151">(Sep 26 2019 at 04:39)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Is supressing inherited invariants in Snapshot Tables a feature of the IG Publisher?<br>
Is there a switch to turn supression off?</p>



<a name="176754808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/176754808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#176754808">(Sep 27 2019 at 15:09)</a>:</h4>
<p>It shouldn't be a feature unless it's warnings or "best practice" messages - and even then, it should be handled on an invariant by invariant baais</p>



<a name="177581085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/177581085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#177581085">(Oct 08 2019 at 03:23)</a>:</h4>
<p>I think that the snapshot view produced by ig publisher should show invariants inherited from other profiles.<br>
The snapshot shows all inherited elements, their bindings and cardinalities etc. so I am surprised that the inherited invariants are not also displayed.</p>



<a name="177581092"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/177581092" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#177581092">(Oct 08 2019 at 03:23)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="177581133"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/177581133" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#177581133">(Oct 08 2019 at 03:24)</a>:</h4>
<p>because every element ever has invariants, and displaying them was overwhelming.</p>



<a name="177583959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/177583959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#177583959">(Oct 08 2019 at 04:44)</a>:</h4>
<p>I have just noticed that the StructureDefinition of the R4 build of <a href="http://hl7.org/fhir/r4/clinicaldocument.profile.xml.html" target="_blank" title="http://hl7.org/fhir/r4/clinicaldocument.profile.xml.html">ClinicalDocument</a> has 13 constraints while the current build of <a href="http://build.fhir.org/clinicaldocument.profile.xml.html" target="_blank" title="http://build.fhir.org/clinicaldocument.profile.xml.html">ClinicalDocument</a> has 67. The R4 one includes ele-1 for only a few elements, while the newer one has ele-1 on very many elements.<br>
I assume that the newer one is correct.<br>
Displaying ele-1 on every element would be overwhelming.</p>



<a name="177584304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/177584304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#177584304">(Oct 08 2019 at 04:55)</a>:</h4>
<p><a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=24911" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=24911">#24911</a> raised to clarify in docco that inherited constraints are not displayed in the snapshot tab.</p>



<a name="177607831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/177607831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#177607831">(Oct 08 2019 at 12:25)</a>:</h4>
<p>Note that the <code>SnapshotGenerator</code> implementation in the FHIR .NET API includes all element constraints inherited from base profile &amp; type profiles into the generated snapshot. Almost all elements inherit Invariant <code>ele-1</code> from base class <code>Element</code> and the generated snapshot reflects that.</p>



<a name="177607991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/177607991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#177607991">(Oct 08 2019 at 12:27)</a>:</h4>
<p>The validator actually needs all these invariants, so the snapshot must contain them. For display purposes, rendering logic could hide some "noisy" constraints, depending on the intended target audience.</p>



<a name="186952718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186952718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186952718">(Jan 30 2020 at 03:37)</a>:</h4>
<p>The profiles in my IG don't have snapshots, so it's the IG Publisher creating them, and I'm now seeing ele-1 etc for every element...</p>



<a name="186952847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186952847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186952847">(Jan 30 2020 at 03:41)</a>:</h4>
<p><a href="https://mysl-hl7-sydney.azurewebsites.net/ig/StructureDefinition-mysl-patient.html" target="_blank" title="https://mysl-hl7-sydney.azurewebsites.net/ig/StructureDefinition-mysl-patient.html">https://mysl-hl7-sydney.azurewebsites.net/ig/StructureDefinition-mysl-patient.html</a></p>



<a name="186954877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186954877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186954877">(Jan 30 2020 at 04:42)</a>:</h4>
<p>that's a change I made months go as part of reconcilation with the dotnet snapshot generator</p>



<a name="186954881"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186954881" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186954881">(Jan 30 2020 at 04:42)</a>:</h4>
<p>I don't like it, and neither do others</p>



<a name="186955305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186955305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186955305">(Jan 30 2020 at 04:57)</a>:</h4>
<p>Something I could contribute to in the publisher?</p>



<a name="186955360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186955360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186955360">(Jan 30 2020 at 04:59)</a>:</h4>
<p>I hadn't fussed over it as I hadn't had any self defined ones in the profiles I'd been putting together, now they are lost in the sea of ele-1s</p>



<a name="186955926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186955926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186955926">(Jan 30 2020 at 05:15)</a>:</h4>
<p>hmm they shouldn't appear in the rendering like that</p>



<a name="186955972"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186955972" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186955972">(Jan 30 2020 at 05:16)</a>:</h4>
<p>what xhtml fragment are you including for that</p>



<a name="186956041"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186956041" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186956041">(Jan 30 2020 at 05:18)</a>:</h4>
<p>{% include {{[type]}}-{{[id]}}-inv.xhtml %}</p>



<a name="186956338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186956338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186956338">(Jan 30 2020 at 05:27)</a>:</h4>
<p>Just peeking in another that was built recently, looks the same.<br>
<a href="http://build.fhir.org/ig/HL7/fhir-mCODE-ig/branches/master/StructureDefinition-CancerPatient.html" target="_blank" title="http://build.fhir.org/ig/HL7/fhir-mCODE-ig/branches/master/StructureDefinition-CancerPatient.html">http://build.fhir.org/ig/HL7/fhir-mCODE-ig/branches/master/StructureDefinition-CancerPatient.html</a></p>



<a name="186957843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/186957843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#186957843">(Jan 30 2020 at 06:12)</a>:</h4>
<p>ok. from next release, the parameter show-inherited-invariants in either the json or the ig will control whether these inherited constraints appear. show-inherited-default value is true (default is no change)</p>



<a name="187041161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/187041161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#187041161">(Jan 30 2020 at 23:06)</a>:</h4>
<p>Thanks, works like a charm.</p>



<a name="187041252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Derived%20profile%20snapshot%20missing%20upstream%20invariants/near/187041252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Derived.20profile.20snapshot.20missing.20upstream.20invariants.html#187041252">(Jan 30 2020 at 23:07)</a>:</h4>
<p>For those that want to see, here's an example<br>
<a href="https://mysl-hl7-sydney.azurewebsites.net/ig/StructureDefinition-mysl-consent.html" target="_blank" title="https://mysl-hl7-sydney.azurewebsites.net/ig/StructureDefinition-mysl-consent.html">https://mysl-hl7-sydney.azurewebsites.net/ig/StructureDefinition-mysl-consent.html</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
