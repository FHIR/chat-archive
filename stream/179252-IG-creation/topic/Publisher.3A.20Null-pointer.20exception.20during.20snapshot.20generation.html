---
layout: page
title: "FHIR Chat  · Publisher: Null-pointer exception during snapshot generation · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html">Publisher: Null-pointer exception during snapshot generation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="192778484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192778484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pétur Valdimarsson <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192778484">(Apr 03 2020 at 09:30)</a>:</h4>
<p>Hi! Not sure if this is by design or a newly introduced bug, but running later IG-publishers, I'm getting a null-pointer exception if mapping for an element is a blank string. From what I have seen this happens both with an empty string and a whitespace.</p>
<p>Example snippet from differential:</p>
<div class="codehilite"><pre><span></span>{
        &quot;id&quot;: &quot;Observation.valueQuantity.value&quot;,
        &quot;path&quot;: &quot;Observation.valueQuantity.value&quot;,
        &quot;mapping&quot;: [
          {
            &quot;identity&quot;: &quot;v2&quot;,
            &quot;map&quot;: &quot;SN.2  / CQ - N/A&quot;
          },
          {
            &quot;identity&quot;: &quot;other-mapping&quot;,
            &quot;map&quot;: &quot;&quot;
          }
        ]
      }
</pre></div>


<p>The stacktrace:</p>
<div class="codehilite"><pre><span></span>java.lang.Exception: Error generating snapshot for ExampleProfile(example-profile): Unable to generate snapshot for http://example.com/StructureDefinition/example-profile in ..
        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:4019)
        at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3448)
        at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:796)
        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:657)
        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7062)
Caused by: org.hl7.fhir.exceptions.FHIRException: Unable to generate snapshot for http://example.com/StructureDefinition/example-profile in ..
        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:4072)
        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:4017)
        ... 4 more
Caused by: java.lang.NullPointerException
        at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:591)
        at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:4070)
        ... 5 more
Exception in thread &quot;main&quot; java.lang.NullPointerException
        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7085)
</pre></div>


<p>I haven't done too much debugging, but can see that the ElementDefinitionMappingComponent.map is null which causes a null-pointer due to the trim call in <code>mm.setMap(mm.getMap().trim())</code>. I don't know if the fix, if one is to be done, should be to ensure that the ElementDefinitionMappingComponent.map is not null, to compensate for the possibility of it being null before <code>mm.setMap(mm.getMap().trim())</code> or to throw a more verbose exception. Until then, I've ensured that the map always has some none-whitespace content in my profiles.</p>



<a name="192778815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192778815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192778815">(Apr 03 2020 at 09:34)</a>:</h4>
<p>well, ok, I'll fix that next release. But "map" : "" is illegal</p>



<a name="192778916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192778916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pétur Valdimarsson <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192778916">(Apr 03 2020 at 09:35)</a>:</h4>
<p>Yes, it was in my profiles due to a sushi-workaround. I think just a more descriptive exception would be quite sufficient.</p>



<a name="192778970"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192778970" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192778970">(Apr 03 2020 at 09:35)</a>:</h4>
<p>not having a problem in the first place would be even better</p>



<a name="192779101"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192779101" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pétur Valdimarsson <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192779101">(Apr 03 2020 at 09:37)</a>:</h4>
<p>Indeed true.</p>



<a name="192796382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192796382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192796382">(Apr 03 2020 at 12:35)</a>:</h4>
<blockquote>
<p>Yes, it was in my profiles due to a sushi-workaround</p>
</blockquote>
<p><span class="user-mention" data-user-id="193397">@Pétur Valdimarsson</span> -- what is this SUSHI workaround?  Something we need to address on our side?</p>



<a name="192796572"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192796572" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pétur Valdimarsson <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192796572">(Apr 03 2020 at 12:37)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span>  This may alrady have been fixed, have not tried since before 0.11 came out:</p>



<a name="192796578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Publisher%3A%20Null-pointer%20exception%20during%20snapshot%20generation/near/192796578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pétur Valdimarsson <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Publisher.3A.20Null-pointer.20exception.20during.20snapshot.20generation.html#192796578">(Apr 03 2020 at 12:37)</a>:</h4>
<p><a href="#narrow/stream/215610-shorthand/topic/Mapping.20value.5Bx.5D.2Eproperty" title="#narrow/stream/215610-shorthand/topic/Mapping.20value.5Bx.5D.2Eproperty">https://chat.fhir.org/#narrow/stream/215610-shorthand/topic/Mapping.20value.5Bx.5D.2Eproperty</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
