---
layout: page
title: "FHIR Chat  · Validation failure when value[x] is integer or code · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html">Validation failure when value[x] is integer or code</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="273896038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/273896038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#273896038">(Mar 02 2022 at 23:33)</a>:</h4>
<p>I'm having validation issues during publication when a field is defined as either integer or code (also date/code).  The error message says that the value only allows for one type, when it is clearly defined for two.</p>
<p>Observation.value.ofType(dateTime).extension[0].extension[3] (l58/c12)  error   The Extension '<a href="http://hl7.org/fhir/us/vrdr/StructureDefinition/Date-Time">http://hl7.org/fhir/us/vrdr/StructureDefinition/Date-Time</a>' <strong>definition allows for the types [code] but found type time</strong><br>
Observation.value.ofType(dateTime).extension[0].extension[3].value.ofType(time) (l61/c12)   error   This element does not match any known slice defined in the profile <a href="http://hl7.org/fhir/us/vrdr/StructureDefinition/Date-Time">http://hl7.org/fhir/us/vrdr/StructureDefinition/Date-Time</a> and slicing is CLOSED: Observation.value.ofType(dateTime).extension[0].extension[3].value.ofType(time): Does not match slice 'valueCode'</p>
<p>The value of the extension is:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://hl7.org/fhir/us/vrdr/StructureDefinition/Date-Time"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">"valueTime"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"12:01:02"</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> </p>
<p>The definition is:   <a href="http://build.fhir.org/ig/HL7/vrdr/branches/validationbug/StructureDefinition-Date-Time.html">http://build.fhir.org/ig/HL7/vrdr/branches/validationbug/StructureDefinition-Date-Time.html</a></p>
<p>See <a href="http://build.fhir.org/ig/HL7/vrdr/branches/validationbug/qa.html#_scratch_ig-build-temp-MKD9WW_repo_fsh-generated_resources_Observation-DeathDate-Example1">http://build.fhir.org/ig/HL7/vrdr/branches/validationbug/qa.html#_scratch_ig-build-temp-MKD9WW_repo_fsh-generated_resources_Observation-DeathDate-Example1</a>. </p>
<p>Or, here is the FSH and JSON:<br>
<a href="https://fshschool.org/FSHOnline/#/share/36TljQ1">https://fshschool.org/FSHOnline/#/share/36TljQ1</a></p>



<a name="273915430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/273915430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#273915430">(Mar 03 2022 at 03:12)</a>:</h4>
<p>Extension is defined incorrectly.  There should be no 'valueCode' element.  If you want to constrain the code slice, it MUST be value[x] with an appropriate id and slice name.</p>



<a name="273992541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/273992541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#273992541">(Mar 03 2022 at 15:53)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> - SUSHI still outputs all extensions like this and they generally don't cause problems.  IG Publisher handles them well since this was an approach that was previously supported (and maybe even encouraged?).  SUSHI will switch to useing <code>value[x]</code> and slicenames in SUSHI 3.0 (since it is a major change).</p>
<p>That said, when Saul initially asked me about this privately, I thought it might be related to id/path as well.  So I manually modified it to use the <code>Extension.value[x]:valueCode</code> id and <code>Extension.value[x]</code> path instead -- but still got the <em>same exact</em> error.  So I don't think that is it.</p>



<a name="274018638"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/274018638" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#274018638">(Mar 03 2022 at 18:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="274912237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/274912237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#274912237">(Mar 10 2022 at 23:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
Is this:<br>
  a) acknowledged as an IGP defect?    (from <span class="user-mention" data-user-id="191469">@Chris Moesel</span> exploration, it seems like it may be)<br>
  b) if yes to a, likely to be fixed?</p>
<p>Just trying to decide whether I can have real examples, or just examples in the narrative.</p>
<p>thx</p>



<a name="274912621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/274912621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#274912621">(Mar 10 2022 at 23:49)</a>:</h4>
<p>it's still on my todo list</p>



<a name="275359821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/275359821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#275359821">(Mar 15 2022 at 11:26)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> I get this trying to run that branch referred to above:</p>



<a name="275359823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/275359823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#275359823">(Mar 15 2022 at 11:26)</a>:</h4>
<div class="codehilite"><pre><span></span><code>onGenerate.jira.generate:
     [xslt] Processing /Users/grahamegrieve/temp/igs/vrdr/template/package-list.tmp.xml to /Users/grahamegrieve/temp/igs/vrdr/template/package-list.xml
     [xslt] Loading stylesheet /Users/grahamegrieve/temp/igs/vrdr/template/scripts/onGenerate.package-list.xslt
     [xslt] Processing /Users/grahamegrieve/temp/igs/vrdr/template/jira.tmp.xml to /Users/grahamegrieve/temp/igs/vrdr/template/jira.xml
     [xslt] Loading stylesheet /Users/grahamegrieve/temp/igs/vrdr/template/scripts/onGenerate.jira.xslt
**WARNING** Jira file generation will not be correct because multiple artifacts have the same name (ignoring content in &quot;()&quot;): Date Day
**WARNING** Jira file generation will not be correct because multiple artifacts have the same name (ignoring content in &quot;()&quot;): Date Month
**WARNING** Jira file generation will not be correct because multiple artifacts have the same name (ignoring content in &quot;()&quot;): Date Year
**WARNING** Jira file generation will not be correct because multiple artifacts have the same name (ignoring content in &quot;()&quot;): Partial Date
**WARNING** Jira file generation will not be correct because multiple artifacts have the same name (ignoring content in &quot;()&quot;): Filing Format
**WARNING** Jira file generation will not be correct because multiple artifacts have the same name (ignoring content in &quot;()&quot;): Manner of Death
**WARNING** Jira file generation will not be correct because multiple artifacts have the same name (ignoring content in &quot;()&quot;): Place of Injury
Found multiple candidates for artifact ValueSet-vrdr-manner-of-death in previous jira-spec-info&lt;artifact xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; id=&quot;StructureDefinition/vrdr-manner-of-death&quot; key=&quot;StructureDefinition-VRDR-Manner-of-Death&quot; name=&quot;Manner of Death&quot;/&gt;&lt;artifact xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; id=&quot;ValueSet/vrdr-manner-of-death&quot; key=&quot;ValueSet-vrdr-Manner-of-Death&quot; name=&quot;Manner of Death VS&quot;/&gt;
     [xslt] /Users/grahamegrieve/temp/igs/vrdr/template/scripts/onGenerate.jira.xslt:111:7: Fatal Error! Processing terminated by xsl:message at line 111 in onGenerate.jira.xslt
     [xslt] Failed to process /Users/grahamegrieve/temp/igs/vrdr/template/jira.tmp.xml
Publishing Content Failed: Fatal error during transformation using /Users/grahamegrieve/temp/igs/vrdr/template/scripts/onGenerate.jira.xslt: Processing terminated by xsl:message at line 111 in onGenerate.jira.xslt; SystemID: file:/Users/grahamegrieve/temp/igs/vrdr/template/scripts/onGenerate.jira.xslt; Line#: 111; Column#: 7 (02:40.0486)
                                                                                 (02:40.0488)
This error was created by the template                                           (02:40.0488)
</code></pre></div>



<a name="275359833"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/275359833" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#275359833">(Mar 15 2022 at 11:26)</a>:</h4>
<p>this looks like an error in the template to me</p>



<a name="275369657"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/275369657" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#275369657">(Mar 15 2022 at 13:05)</a>:</h4>
<p>That seems to be a pretty clear error message.  Do we know that the names are unique and that there aren't duplicates in the committed jira-spec file?</p>



<a name="275426961"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/275426961" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#275426961">(Mar 15 2022 at 19:55)</a>:</h4>
<p>don't know, but the build shouldn't fail completely for that reason</p>



<a name="277358717"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277358717" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277358717">(Apr 01 2022 at 00:53)</a>:</h4>
<p>anyway <span class="user-mention" data-user-id="215604">@Saul Kravitz</span> I'll look at this when it builds</p>



<a name="277361756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277361756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277361756">(Apr 01 2022 at 01:47)</a>:</h4>
<p>You don't have control over it failing there Grahame.  The transform deliberately chokes with a fatal error.</p>



<a name="277364528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277364528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277364528">(Apr 01 2022 at 02:40)</a>:</h4>
<p>I don't think it should. It should be error in qa.html</p>



<a name="277368538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277368538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277368538">(Apr 01 2022 at 04:01)</a>:</h4>
<p>There's no ability there to spit out a QA error.</p>



<a name="277369235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277369235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277369235">(Apr 01 2022 at 04:16)</a>:</h4>
<p>we could create one.</p>



<a name="277419618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277419618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277419618">(Apr 01 2022 at 13:43)</a>:</h4>
<p>It's an XSLT that's spits out something else.  With XSLT 1.0, a given transform can only spit out one thing.  We could set up the transform to run in two different modes, one that spits out errors and one that spits out the desired file, then call it twice.  I'm not sure why we'd bother adding that complexity when the problem identified is one that has to be fixed.</p>



<a name="277472146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277472146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277472146">(Apr 01 2022 at 20:13)</a>:</h4>
<p>what does it spit out?</p>



<a name="277484736"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277484736" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277484736">(Apr 01 2022 at 22:14)</a>:</h4>
<p>The target Jira spec file</p>



<a name="277484828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277484828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277484828">(Apr 01 2022 at 22:15)</a>:</h4>
<p>I could look at that file and pick up errors if it's an OperationOutcome?</p>



<a name="277499747"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Validation%20failure%20when%20value%5Bx%5D%20is%20integer%20or%20code/near/277499747" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Validation.20failure.20when.20value.5Bx.5D.20is.20integer.20or.20code.html#277499747">(Apr 02 2022 at 02:16)</a>:</h4>
<p>I guess the normalization process we use for comparison could strip out OperationOutcomes</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
