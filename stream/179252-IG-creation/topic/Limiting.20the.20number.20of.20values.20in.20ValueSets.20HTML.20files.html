---
layout: page
title: "FHIR Chat  · Limiting the number of values in ValueSets HTML files · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html">Limiting the number of values in ValueSets HTML files</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="197637951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/197637951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Meen Chul Kim <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#197637951">(May 15 2020 at 01:07)</a>:</h4>
<p>Hi,</p>
<p>Our resources refer to multiple ontologies including HPO. Each of these ontologies is often very large, so rather than creating <code>CodeSystem</code> resources in our FHIR model , we have been trying to reference <code>CodeSystem</code>s in an external terminology server (especially Ontoserver).</p>
<p>To this end, we've tried to point to Ontoserver for resources validation, executing the following command:</p>
<p><code>java -jar org.hl7.fhir.publisher.jar -ig site_root/ig.ini -tx https://r4.ontoserver.csiro.au/fhir</code></p>
<p>This command ended up running into <code>java.lang.OutOfMemoryError: Java heap space</code> error when generating output HTML files. I talked to external collaborators and figured that the above command tries to load all values (referred by Ontoserver) in ValueSets into output HTML files. The HPO CodeSystem alone includes at least 20,000 concepts and is therefore huge. After looking into the <a href="https://www.hl7.org/fhir/implementationguide.html"><code>ImplementationGuide</code></a> resource, it seems like using <a href="https://www.hl7.org/fhir/codesystem-guide-parameter-code.html#guide-parameter-code-expansion-parameter"><code>"expansion-parameter"</code></a> for <code>"parameter"</code> under <code>"definition"</code> may be a right way to control the numbers of values in <code>ValueSet</code>s rendered in the output HTML files. So, as far as I understand, I may add the following snippets to our <code>IG.json</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
  <span class="err">...</span>
  <span class="nt">&quot;definition&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;parameter&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;expansion-parameter&quot;</span><span class="p">,</span>
        <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;some value&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
  <span class="err">...</span>
<span class="p">}</span>
</code></pre></div>


<p>Based on the documentation, the value for the <code>"expansion-parameter"</code> code should be a "named type", and it is really hard to find some relevant examples for this implementation. I wonder if I am looking into a right resource to limit the number of <code>ValueSet</code>'s values rendered in an output HTML file. If so, can I get some advice to properly implement this?</p>



<a name="197638051"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/197638051" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#197638051">(May 15 2020 at 01:09)</a>:</h4>
<p>well, first we should talk about what you are doing and wanting to do.</p>



<a name="197638064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/197638064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#197638064">(May 15 2020 at 01:09)</a>:</h4>
<p>20000 isn't that much. We've had bigger. How much memory are you making available to the ig publisehr?</p>



<a name="197961902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/197961902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#197961902">(May 18 2020 at 16:40)</a>:</h4>
<p>Hi Graham, I work with Meen ^. We don't explicitly set the JVM heap space arguments, but from the publisher logs it looks like 1.6 GB is available to the publisher. Do you have recommendations for JVM min/max heap size?</p>



<a name="197981561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/197981561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#197981561">(May 18 2020 at 19:03)</a>:</h4>
<p>that's plenty of memory. so that's not the issue. The parameter you need is <code>path-expansion-params</code> documented here: <a href="https://confluence.hl7.org/display/FHIR/Implementation+Guide+Parameters">https://confluence.hl7.org/display/FHIR/Implementation+Guide+Parameters</a></p>



<a name="197981596"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/197981596" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#197981596">(May 18 2020 at 19:03)</a>:</h4>
<p>though even then, I'm not sure that'll solve your problem.Can I reproduce this?</p>



<a name="198079115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/198079115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Meen Chul Kim <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#198079115">(May 19 2020 at 15:01)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>!</p>
<p>What confuses me actually is that on the official FHIR documentation (as I've linked in the initial message), there is no parameter code <code>"path-expansion-params"</code>, but <code>"expansion-parameter"</code>, and the latter is repeating whereas the former is said not to be repeating on Confluence. And <code>"expansion-parameter"</code> should have a <code>"value"</code> which is a named type (according to the documentation. I am not sure how it actually works though) while <code>"path-expansion-params"</code> has a path to a parameter resource as a <code>"value"</code>. When running validation with these two cases, <code>"path-expansion-params"</code> returns a build error, so it seems deprecated. So, I wonder if the use of <code>"expansion-parameter"</code> is the right use case for limiting the number of rendered values in an output HTML file. If so, I also wonder about how to set <code>"value"</code>.</p>



<a name="198113161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/198113161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#198113161">(May 19 2020 at 19:13)</a>:</h4>
<blockquote>
<p>When running validation</p>
</blockquote>
<p>So you're not talking about publishing an IG?</p>



<a name="198205967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/198205967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#198205967">(May 20 2020 at 14:25)</a>:</h4>
<p>We use the publisher for both validation of conformance resources and publishing the IG</p>



<a name="198253628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/198253628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#198253628">(May 20 2020 at 20:33)</a>:</h4>
<p>the IG Publisher can be started in one of 2 ways :</p>
<ul>
<li>ig.json (deprecated): Specific parameters supported: <code>sct-edition</code> and <code>activeOnly</code></li>
<li>ig.ini (preferred): only <code>path-expansion-params</code> is supported</li>
</ul>



<a name="198253658"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/198253658" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#198253658">(May 20 2020 at 20:33)</a>:</h4>
<blockquote>
<p>"path-expansion-params" returns a build error</p>
</blockquote>
<p>What's the issue?</p>



<a name="199123407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/199123407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Meen Chul Kim <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#199123407">(May 29 2020 at 07:51)</a>:</h4>
<p>In our IG, I tried:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;path-expansion-params&quot;</span><span class="p">,</span>
  <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;input/resources/terminology/Parameters-kfdrc-ontoserver.json&quot;</span>
<span class="p">}</span>
</code></pre></div>


<p>But, the publisher returns the following error:</p>
<div class="codehilite"><pre><span></span><code>java.io.FileNotFoundException: input/resources/terminology/Parameters-kfdrc-ontoserver.json (No such file or directory)
        at java.io.FileInputStream.open0(Native Method)
        at java.io.FileInputStream.open(FileInputStream.java:195)
        at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:138)
        at org.hl7.fhir.utilities.TextFile.fileToBytes(TextFile.java:199)
        at org.hl7.fhir.r4.formats.FormatUtilities.loadFile(FormatUtilities.java:166)
        at org.hl7.fhir.igtools.publisher.Publisher.initializeFromIg(Publisher.java:1701)
        at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:1322)
        at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:690)
        at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:7383)
</code></pre></div>


<p>When not including the above parameter, all other resources are loaded fine and the validation passes.</p>



<a name="199123504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/199123504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Meen Chul Kim <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#199123504">(May 29 2020 at 07:52)</a>:</h4>
<p>And <code>"input/resources/terminology/Parameters-kfdrc-ontoserver.json"</code> is like:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;Parameters&quot;</span><span class="p">,</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;kfdrc-ontoserver&quot;</span><span class="p">,</span>
  <span class="nt">&quot;parameter&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span>
      <span class="nt">&quot;valueInteger&quot;</span><span class="p">:</span> <span class="mi">100</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>



<a name="199209504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/199209504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#199209504">(May 29 2020 at 20:42)</a>:</h4>
<p>hmm. evidently no one has tried to do this before, because the code is clearly wrong here</p>



<a name="199213306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/199213306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#199213306">(May 29 2020 at 21:17)</a>:</h4>
<p>this will work next release (and the relative path will be relative to the ig resource)</p>



<a name="199391213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/199391213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Meen Chul Kim <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#199391213">(Jun 01 2020 at 16:33)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>! Looking forward to the next release!</p>



<a name="199414633"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Limiting%20the%20number%20of%20values%20in%20ValueSets%20HTML%20files/near/199414633" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Limiting.20the.20number.20of.20values.20in.20ValueSets.20HTML.20files.html#199414633">(Jun 01 2020 at 19:51)</a>:</h4>
<p>it's now done. Track releases on <a class="stream" data-stream-id="217600" href="/#narrow/stream/217600-tooling.2Freleases">#tooling/releases</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
