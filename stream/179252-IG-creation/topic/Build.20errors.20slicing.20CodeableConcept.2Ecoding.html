---
layout: page
title: "FHIR Chat  · Build errors slicing CodeableConcept.coding · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html">Build errors slicing CodeableConcept.coding</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="260583147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260583147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260583147">(Nov 07 2021 at 16:31)</a>:</h4>
<p>I have an IG where we are looking to require 2 codes be provided from the same CodeSystem on a CodeableConcept element with a base cardinality of 1..1. We want to require the granular code (in or use case it is an RxNorm code that includes ingredient, strength, and form) and a less granular code (RxNorm ingredient and form) in order to allow for searching across strengths.<br>
The way I am trying to address this is to slice the CodeableConcept with a pattern match on code with each slice bound to a different ValueSet. Both of these use the RxNorm codeSystem, but have different non-overlapping properties.</p>
<p>I am getting a build error: <code>Slicing cannot be evaluated: Could not match discriminator ([code]) for slice MedicationKnowledge.code.coding:semantic-drug-form-group in profile http://hl7.org/fhir/us/davinci-drug-formulary/StructureDefinition/usdf-FormularyDrug - the discriminator [code] does not have fixed value, binding or existence assertions</code></p>
<p>What am I doing wrong here?</p>
<p>Profile: <a href="http://build.fhir.org/ig/HL7/davinci-pdex-formulary/StructureDefinition-usdf-FormularyDrug.html">http://build.fhir.org/ig/HL7/davinci-pdex-formulary/StructureDefinition-usdf-FormularyDrug.html</a><br>
Granular VS: <a href="http://build.fhir.org/ig/HL7/davinci-pdex-formulary/ValueSet-SemanticDrugVS.html">http://build.fhir.org/ig/HL7/davinci-pdex-formulary/ValueSet-SemanticDrugVS.html</a><br>
General VS: <a href="http://build.fhir.org/ig/HL7/davinci-pdex-formulary/ValueSet-SemanticDrugFormGroupVS.html">http://build.fhir.org/ig/HL7/davinci-pdex-formulary/ValueSet-SemanticDrugFormGroupVS.html</a><br>
QA report: <a href="http://build.fhir.org/ig/HL7/davinci-pdex-formulary/branches/master/MedicationKnowledge-FormularyDrug-1541228.html">http://build.fhir.org/ig/HL7/davinci-pdex-formulary/branches/master/MedicationKnowledge-FormularyDrug-1541228.html</a></p>



<a name="260622292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260622292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260622292">(Nov 08 2021 at 07:32)</a>:</h4>
<p>I do not know if these are the cause of your problem, but<br>
1/ System and code are optional in both slices, so an instance with neither will satisfy both slices. <br>
2/ In the slice semantic-drug you bind the coding.code and in the other slice you bind the coding. That looks strange.</p>



<a name="260702715"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260702715" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260702715">(Nov 08 2021 at 18:59)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191682">@Richard Townley-O'Neill</span>, That got me part of the way there.<br>
It looks like my issue now is not with slicing, but with a valueSet binding on RxNorm with property TTY. I have been working with Lloyd on this and he said this might be an issue to raise with Grahame.</p>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, have you seen this problem?<br>
I have a simple binding of MedicationKnowledge.code (CodeableConcept) to a ValueSet with RxNorm code with a matching property requirement. The ValueSet expeansion has the code "753532" in it, but when I include it in the example it fails validation stating <code>None of the codings provided are in the value set http://hl7.org/fhir/us/davinci-drug-formulary/ValueSet/SemanticDrugVS (http://hl7.org/fhir/us/davinci-drug-formulary/ValueSet/SemanticDrugVS), and a coding from this value set is required) (codes = http://www.nlm.nih.gov/research/umls/rxnorm#753532)</code></p>
<p>QA error here: <a href="http://build.fhir.org/ig/HL7/davinci-pdex-formulary/branches/master/qa.html#_scratch_ig-build-temp-6ONJIC_repo_fsh-generated_resources_MedicationKnowledge-FormularyDrug-1541228">http://build.fhir.org/ig/HL7/davinci-pdex-formulary/branches/master/qa.html#_scratch_ig-build-temp-6ONJIC_repo_fsh-generated_resources_MedicationKnowledge-FormularyDrug-1541228</a></p>



<a name="260754877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260754877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260754877">(Nov 09 2021 at 05:17)</a>:</h4>
<p>the answer is that you've referred directly to a vsac value set, and the server doesn't have access to that vsac value set definition. And it's part of the generally 'vsac is broken' problem that's on my todo list, but it's a big problem</p>



<a name="260760375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260760375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260760375">(Nov 09 2021 at 06:54)</a>:</h4>
<p>Unfortunately that is not the case. I had removed use of that ValueSet before starting to work on this. I see the vsac dependency was still listed.  It is now removed. Still not able to determine that it is in the VS.</p>



<a name="260760399"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260760399" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260760399">(Nov 09 2021 at 06:55)</a>:</h4>
<p>where's the value set defined?</p>



<a name="260806046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260806046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260806046">(Nov 09 2021 at 14:37)</a>:</h4>
<p>I went ahead and simplified the examples and binding in order to remove other possible variables. It now has a regular (non-sliced) binding, and I only include 1 example.<br>
VS Definition: <a href="http://build.fhir.org/ig/HL7/davinci-pdex-formulary/ValueSet-SemanticDrugVS.html">http://build.fhir.org/ig/HL7/davinci-pdex-formulary/ValueSet-SemanticDrugVS.html</a><br>
Example: <a href="https://build.fhir.org/ig/HL7/davinci-pdex-formulary/MedicationKnowledge-FormularyDrug-993804.json.html">https://build.fhir.org/ig/HL7/davinci-pdex-formulary/MedicationKnowledge-FormularyDrug-993804.json.html</a></p>



<a name="260885270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260885270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260885270">(Nov 10 2021 at 00:47)</a>:</h4>
<p>bug in the server - will be fixed by this time tomorrow</p>



<a name="260921584"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Build%20errors%20slicing%20CodeableConcept.coding/near/260921584" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Build.20errors.20slicing.20CodeableConcept.2Ecoding.html#260921584">(Nov 10 2021 at 02:58)</a>:</h4>
<p>Sorry we did not find this earlier. It just was identified as a requirement on Friday.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
