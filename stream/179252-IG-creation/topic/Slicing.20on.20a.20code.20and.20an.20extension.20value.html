---
layout: page
title: "FHIR Chat  · Slicing on a code and an extension value · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html">Slicing on a code and an extension value</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="235908147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Slicing%20on%20a%20code%20and%20an%20extension%20value/near/235908147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html#235908147">(Apr 23 2021 at 21:02)</a>:</h4>
<p>I want to slice my Questionnaire items based on their type and then, within a type, based on the value of an extension.  I think I finally got the definition of my slice discriminator right:</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot;: &quot;Questionnaire.item&quot;,
        &quot;path&quot;: &quot;Questionnaire.item&quot;,
        &quot;slicing&quot;: {
          &quot;discriminator&quot;: [
            {
              &quot;type&quot;: &quot;value&quot;,
              &quot;path&quot;: &quot;type&quot;
            },
            {
              &quot;type&quot;: &quot;value&quot;,
              &quot;path&quot;: &quot;extension(&#39;http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl&#39;).value&quot;
            }
          ],
          &quot;rules&quot;: &quot;closed&quot;,
          &quot;description&quot;: &quot;Slice based on type to restrict the different types of answers allowed.&quot;
        },
</code></pre></div>



<a name="235908839"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Slicing%20on%20a%20code%20and%20an%20extension%20value/near/235908839" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html#235908839">(Apr 23 2021 at 21:04)</a>:</h4>
<p>I am getting an error when running the publisher and I think it might be because this discriminator might be doing more than I think it is.  I don't want to have to specify the extension on every item, only on those items that have the same type.  My 'string', 'text', and 'date' item types don't need the extension, but the 'radio-button', 'check-box',  and 'drop-down' choice items do.</p>



<a name="235909614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Slicing%20on%20a%20code%20and%20an%20extension%20value/near/235909614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html#235909614">(Apr 23 2021 at 21:08)</a>:</h4>
<p>Here is the error that I'm getting:</p>
<div class="codehilite"><pre><span></span><code>java.lang.IndexOutOfBoundsException: Index 0 out of bounds for length 0
    at java.base/jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:64)
    at java.base/jdk.internal.util.Preconditions.outOfBoundsCheckIndex(Preconditions.java:70)
    at java.base/jdk.internal.util.Preconditions.checkIndex(Preconditions.java:248)
    at java.base/java.util.Objects.checkIndex(Objects.java:372)
    at java.base/java.util.ArrayList.get(ArrayList.java:458)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.evaluateDefinition(FHIRPathEngine.java:5479)
    at org.hl7.fhir.validation.instance.InstanceValidator.getCriteriaForDiscriminator(InstanceValidator.java:2991)
    at org.hl7.fhir.validation.instance.InstanceValidator.sliceMatches(InstanceValidator.java:3486)
    at org.hl7.fhir.validation.instance.InstanceValidator.matchSlice(InstanceValidator.java:4831)
</code></pre></div>



<a name="235909909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Slicing%20on%20a%20code%20and%20an%20extension%20value/near/235909909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html#235909909">(Apr 23 2021 at 21:10)</a>:</h4>
<p>Here is the definition of my SingleLine slice:</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot;: &quot;Questionnaire.item:SingleLine&quot;,
        &quot;path&quot;: &quot;Questionnaire.item&quot;,
        &quot;sliceName&quot;: &quot;SingleLine&quot;,
        &quot;min&quot;: 0,
        &quot;max&quot;: &quot;*&quot;
      },
      {
        &quot;id&quot;: &quot;Questionnaire.item:SingleLine.type&quot;,
        &quot;path&quot;: &quot;Questionnaire.item.type&quot;,
        &quot;patternCode&quot;: &quot;string&quot;
      },
      {
        &quot;id&quot;: &quot;Questionnaire.item:SingleLine.initial&quot;,
        &quot;path&quot;: &quot;Questionnaire.item.initial&quot;,
        &quot;max&quot;: &quot;1&quot;,
        &quot;mustSupport&quot;: true
      },
      {
        &quot;id&quot;: &quot;Questionnaire.item:SingleLine.initial.value[x]&quot;,
        &quot;path&quot;: &quot;Questionnaire.item.initial.value[x]&quot;,
        &quot;slicing&quot;: {
          &quot;discriminator&quot;: [
            {
              &quot;type&quot;: &quot;type&quot;,
              &quot;path&quot;: &quot;$this&quot;
            }
          ],
          &quot;ordered&quot;: false,
          &quot;rules&quot;: &quot;open&quot;
        },
        &quot;type&quot;: [
          {
            &quot;code&quot;: &quot;string&quot;
          }
        ]
      },
      {
        &quot;id&quot;: &quot;Questionnaire.item:SingleLine.initial.valueString&quot;,
        &quot;path&quot;: &quot;Questionnaire.item.initial.valueString&quot;,
        &quot;min&quot;: 1,
        &quot;max&quot;: &quot;1&quot;,
        &quot;mustSupport&quot;: true
      },
</code></pre></div>



<a name="235911476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Slicing%20on%20a%20code%20and%20an%20extension%20value/near/235911476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html#235911476">(Apr 23 2021 at 21:20)</a>:</h4>
<p>my question is thus - if you specify a multi-part discriminator, do all parts of the discriminator have to appear in each slice?</p>



<a name="235911642"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Slicing%20on%20a%20code%20and%20an%20extension%20value/near/235911642" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html#235911642">(Apr 23 2021 at 21:22)</a>:</h4>
<p>They're not supposed to, but it's possible the tooling doesn't handle that in all cases.  Are you able to share a trimmed down version of the profile as a test case?</p>



<a name="235911689"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Slicing%20on%20a%20code%20and%20an%20extension%20value/near/235911689" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Slicing.20on.20a.20code.20and.20an.20extension.20value.html#235911689">(Apr 23 2021 at 21:23)</a>:</h4>
<p>i might be able to.  Let me see if I can make a simple two slice profile that fails the same way</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
