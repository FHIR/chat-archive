---
layout: page
title: "FHIR Chat  · Contained resources in PlanDefinition · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html">Contained resources in PlanDefinition</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="205300275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205300275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205300275">(Jul 28 2020 at 22:52)</a>:</h4>
<p>I'm wanting to contain a couple of ActivityDefinition resources in a PlanDefinition, but as the reference from the PlanDefinition.actiondefinition[x] is a canonical datatype rather than a Reference, the IG publisher is complaining. Example is <a href="http://build.fhir.org/ig/HL7NZ/cca/branches/master/PlanDefinition-coloRectal.html">here</a></p>



<a name="205304929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205304929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205304929">(Jul 28 2020 at 23:59)</a>:</h4>
<p>are you referring to this? </p>
<blockquote>
<p>dom-3: If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource ( (unmatched: ActTragacanth)) [contained.where(((('#' + id) in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()]</p>
</blockquote>



<a name="205310807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205310807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205310807">(Jul 29 2020 at 01:59)</a>:</h4>
<p>yep</p>



<a name="205312509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205312509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205312509">(Jul 29 2020 at 02:33)</a>:</h4>
<p>do you think it's wrong?</p>



<a name="205313382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205313382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205313382">(Jul 29 2020 at 02:53)</a>:</h4>
<p>Yes, it's wrong.  I don't think we can write an invariant that enforces our genuine rule, which is "every contained resource must be connected via a reference path to the containing resource".  That path could involve container pointing to containedA which points to containedB which is pointed to by containedC.  That would still meet our fundamental need - and there are situations where a direct connection between container and contained isn't appropriate.  But we can't write an invariant that would do that - anymore than we could write one that said that all message resources need to connect somehow to the MessageHeader.  We had to write that one in code (and it took a while to get it right).</p>



<a name="205313896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205313896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205313896">(Jul 29 2020 at 03:02)</a>:</h4>
<p>it doesn't prevent two contained resources from referring to each other but not referring to the container or vice versa, yes. but it's not clear to me how how it's wrong in regards to canonical resources</p>



<a name="205660729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205660729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205660729">(Aug 01 2020 at 03:02)</a>:</h4>
<p>Is it OK for a resource to have contained resources where the 'reference' from the parent to the contained is a canonical url - in this case  PlanDefinition.action.definitionCanonical? If it is OK, then it is being incorrectly marked as an error by the IG publisher. I can hide the error of course, but wanted to be sure I have the right behaviour...</p>



<a name="205661320"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205661320" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205661320">(Aug 01 2020 at 03:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="205745065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Contained%20resources%20in%20PlanDefinition/near/205745065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Contained.20resources.20in.20PlanDefinition.html#205745065">(Aug 02 2020 at 21:32)</a>:</h4>
<p>yes- see <a href="http://hl7.org/fhir/references.html#canonical-fragments">http://hl7.org/fhir/references.html#canonical-fragments</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
