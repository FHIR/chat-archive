---
layout: page
title: "FHIR Chat  · How do I slice this to get the behaviour I want? · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html">How do I slice this to get the behaviour I want?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="219422429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219422429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219422429">(Dec 10 2020 at 01:19)</a>:</h4>
<p>I'm trying to slice my Questionnaire.items to specify constraints on different types of items.  I have constraints on the following "types" of questions that I want to make: Single Line, TextArea, DateTime, RadioGroup, Checkboxes, Dropdowns, Slider, Integer Text.  I put "types" because some of these have the same item.type and I use the itemControl extension to differentiate (i.e RadioGroup, Checkboxes, Dropdowns are all type=choice with different itemControl codes).</p>
<p>I wasn't sure how to make a single slice with a discriminator of type + extension(itemControl).value because not every slice would have the extension.  Right now, I have an initial slice on type to get SingleLine, TextArea, DateTime, Choices, Integers.  I then further slice Choices and Integers on extension(itemControl).value to get the different types of choices and integers.</p>
<p>That gets me the following in my SD:</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot;: &quot;Questionnaire.item&quot;,
        &quot;path&quot;: &quot;Questionnaire.item&quot;,
        &quot;slicing&quot;: {
          &quot;discriminator&quot;: [
            {
              &quot;type&quot;: &quot;value&quot;,
              &quot;path&quot;: &quot;type&quot;
            }
          ],
          &quot;rules&quot;: &quot;closed&quot;,
          &quot;description&quot;: &quot;Slice based on type to restrict the different types of answers allowed.&quot;
        },
        &quot;mustSupport&quot;: true
      }
</code></pre></div>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot;: &quot;Questionnaire.item:Choices&quot;,
        &quot;path&quot;: &quot;Questionnaire.item&quot;,
        &quot;sliceName&quot;: &quot;Choices&quot;,
        &quot;slicing&quot;: {
          &quot;discriminator&quot;: [
            {
              &quot;type&quot;: &quot;value&quot;,
              &quot;path&quot;: &quot;extension(&#39;http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl&#39;).value&quot;
            }
          ],
          &quot;rules&quot;: &quot;closed&quot;,
          &quot;description&quot;: &quot;Slice based on type to restrict the different types of answers allowed.&quot;
        },
        &quot;min&quot;: 0,
        &quot;max&quot;: &quot;*&quot;
      },
</code></pre></div>
<p>That seems to me that it should give me the behaviour that I want but I'm getting validation errors that don't make sense.  With the following item:</p>
<div class="codehilite"><pre><span></span><code>            {
              &quot;extension&quot;: [
                {
                  &quot;url&quot;: &quot;http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/extension-itemTitle&quot;,
                  &quot;valueString&quot;: &quot;Single Line Text&quot;
                },
                {
                  &quot;url&quot;: &quot;http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/extension-itemSASVariableName&quot;,
                  &quot;valueString&quot;: &quot;SLT&quot;
                },
                {
                  &quot;url&quot;: &quot;http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/extension-itemRequiredText&quot;,
                  &quot;valueMarkdown&quot;: &quot;Please answer this&quot;
                },
              &quot;type&quot;: &quot;string&quot;,
              &quot;linkId&quot;: &quot;d635f126-e754-3f5b-2cff-f713a3b2e42d&quot;,
              &quot;required&quot;: true,
              &quot;text&quot;: &quot;Enter some text&quot;,
              &quot;initial&quot;: [
                {
                  &quot;valueString&quot;: &quot;placeholder text&quot;
                }
              ]
            },
</code></pre></div>
<p>I'm getting these errors:</p>
<div class="codehilite"><pre><span></span><code>  Error @ Bundle.entry[1].resource.ofType(Questionnaire).item[0] (line 67, col11) : Profile http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/ibm-fda-shape-questionnaire, Element matches more than one slice - SingleLine, Choices/Checkbox
  Error @ Bundle.entry[1].resource.ofType(Questionnaire).item[0] (line 67, col11) : Profile http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/ibm-fda-shape-questionnaire, Element matches more than one slice - SingleLine, Choices/Dropdown
  Error @ Bundle.entry[1].resource.ofType(Questionnaire).item[0] (line 67, col11) : Profile http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/ibm-fda-shape-questionnaire, Element matches more than one slice - SingleLine, Choices/RadioGroup
  Error @ Bundle.entry[1].resource.ofType(Questionnaire).item[0] (line 67, col11) : Profile http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/ibm-fda-shape-questionnaire, Element matches more than one slice - SingleLine, Integers/Range
  Error @ Bundle.entry[1].resource.ofType(Questionnaire).item[0] (line 67, col11) : Profile http://hl7.org/fhir/us/icsr-ae-reporting/StructureDefinition/ibm-fda-shape-questionnaire, Element matches more than one slice - SingleLine, Integers/Slider
</code></pre></div>
<p>And I'm getting similar errors on my other items.</p>



<a name="219422824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219422824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219422824">(Dec 10 2020 at 01:26)</a>:</h4>
<p>I'll have to debug this. Is this for ballot?</p>



<a name="219422832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219422832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219422832">(Dec 10 2020 at 01:26)</a>:</h4>
<p>nope.</p>



<a name="219422839"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219422839" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219422839">(Dec 10 2020 at 01:26)</a>:</h4>
<p>i'm adding it to an HL7 guide of mine so that you can take a look if you want.</p>



<a name="219422868"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219422868" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219422868">(Dec 10 2020 at 01:27)</a>:</h4>
<p>I'll look next week</p>



<a name="219422942"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219422942" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219422942">(Dec 10 2020 at 01:28)</a>:</h4>
<p>what?  you're not going to drop everything to solve my problem?!?  how dare you!  :)</p>
<p>I was actually hoping that someone less busier than you could help me and tell me what I'm obviously doing wrong ;)</p>



<a name="219424145"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219424145" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ryan moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219424145">(Dec 10 2020 at 01:50)</a>:</h4>
<p>element.slicing should only be for the root element, all the element definitions for the individual slices should have fixedCode or something similar right?<br>
it looks like from your excerpts that you have a slicing definition in both the root element (Questionnaire.item) and the slice (Questionnaire.item:Choices) but no actual definition of any particular slice</p>
<p>But do you want a discriminator that can define a slice based on the combination of questionnaire.item.value and questionnaire.item.extension(itemControl).value? if so my only thought is using patternBackboneElement but I have no idea if you can do that..</p>



<a name="219430327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/How%20do%20I%20slice%20this%20to%20get%20the%20behaviour%20I%20want%3F/near/219430327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/How.20do.20I.20slice.20this.20to.20get.20the.20behaviour.20I.20want.3F.html#219430327">(Dec 10 2020 at 04:11)</a>:</h4>
<p>You can check out my ICSR guide - fhir-icsr-ae-reporting - to see what I'm trying to do.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
