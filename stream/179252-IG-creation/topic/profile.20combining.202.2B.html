---
layout: page
title: "FHIR Chat  · profile combining 2+ · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html">profile combining 2+</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="259868042"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/259868042" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#259868042">(Nov 01 2021 at 14:11)</a>:</h4>
<p>Is there a way to have a profile combining the constaints of two (or more) other profiles? The structureDefinition.baseDefinition is limited to 0..1. I do understand that combining might need combining rules. So I just wondered if there was a solution.<br>
In my case I have two standalone profiles that each have their own use-cases, but I also want to show the resulting profile of grouping them. (e.g. AuditEvent for RESTful activities + AuditEvent impact on OAuth credentials identifying the .agent participant).</p>



<a name="259869004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/259869004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#259869004">(Nov 01 2021 at 14:18)</a>:</h4>
<p>The only thing you can do is inherit from one and mandate that meta.profile contains the URL for the second - and that's not a super attractive solution.</p>
<p>Combining profiles is a <em>tremendously</em> difficult thing to do.</p>



<a name="259869989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/259869989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#259869989">(Nov 01 2021 at 14:26)</a>:</h4>
<p>understood. :-(</p>



<a name="259897034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/259897034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#259897034">(Nov 01 2021 at 17:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179252-IG-creation/topic/profile.20combining.202.2B/near/259869004">said</a>:</p>
<blockquote>
<p>Combining profiles is a <em>tremendously</em> difficult thing to do.</p>
</blockquote>
<p>Do you mean conceptually difficult, or that we've made it tremendously difficult to do?</p>



<a name="259917815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/259917815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#259917815">(Nov 01 2021 at 20:39)</a>:</h4>
<p>both</p>



<a name="259917864"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/259917864" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#259917864">(Nov 01 2021 at 20:39)</a>:</h4>
<p>simple cases are simple, but the last 10% rapidly turn into an intractable nightmare</p>



<a name="259922870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/259922870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#259922870">(Nov 01 2021 at 21:17)</a>:</h4>
<p>E.g. two profiles that have sliced (or better yet, re-sliced) the same element with different discriminators.  Especially if the slices overlap.  Misery...</p>



<a name="260009319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260009319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260009319">(Nov 02 2021 at 15:12)</a>:</h4>
<p>I expected as such.</p>



<a name="260009433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260009433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260009433">(Nov 02 2021 at 15:13)</a>:</h4>
<p>in my case I know the two profiles are not conflicting.  So need to figure out some other way to replicate the profiling.</p>



<a name="260009572"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260009572" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260009572">(Nov 02 2021 at 15:14)</a>:</h4>
<p>IHE often has cases where multiple IGs are combined to a bigger capability. Sometimes we need to expresess specific behaviours "when grouped"</p>



<a name="260011413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260011413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260011413">(Nov 02 2021 at 15:26)</a>:</h4>
<p>the current model in FHIR allows me to linearly combine profiles into bigger ones. But this forces a specific build sequence. In IHE we have layered approach that allows grouping. This enables more distinct modularity at content, vs transport, vs identity, vs security, vs privacy, etc.</p>



<a name="260028653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260028653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260028653">(Nov 02 2021 at 17:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/179252-IG-creation/topic/profile.20combining.202.2B/near/260009572">said</a>:</p>
<blockquote>
<p>IHE often has cases where multiple IGs are combined to a bigger capability. Sometimes we need to expresess specific behaviours "when grouped"</p>
</blockquote>
<p>Lots of organizations have this need. Even HL7 has this need (try profiling vital signs).</p>



<a name="260029031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260029031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260029031">(Nov 02 2021 at 17:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179252-IG-creation/topic/profile.20combining.202.2B/near/259922870">said</a>:</p>
<blockquote>
<p>E.g. two profiles that have sliced (or better yet, re-sliced) the same element with different discriminators.  Especially if the slices overlap.  Misery...</p>
</blockquote>
<p>Could we just detect the edge cases and throw an error? If we can detect an error on validation for adding in meta.profile, shouldn't we be able to detect it here? "Multiple base profiles may conflict, please reprofile with one base"</p>



<a name="260087280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260087280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260087280">(Nov 03 2021 at 03:51)</a>:</h4>
<p>Generating snapshots is already a nightmare.  Generating snapshots when you have two bases would be quite horrendous, though I guess it would be done in two phases - first, try to merge the two base snapshots, then apply the differential.  So the 'merge' process would be net new code.  Having multiple parents would have to be extension space because the cardinality of 'base' is already normative.  If we limited the "additional" profiles to not permitting slicing, then perhaps it wouldn't be too bad. However, there'd be lots of other gotchas - if the definitions, comments, etc. are different - which one wins?  For a start, perhaps someone should write up a detailed algorithm (probably on a confluence page) that describes the algorithm for merging two sibling profiles going through all of the core elements and standard extensions that can be defined on StructureDefinition and ElementDefinition.  <em>If</em> the algorithm isn't a nightmare and the restrictions it imposes don't rule out most of the use-cases people have for doing this, then I guess there's at least a theoretical possibility of it happening.</p>



<a name="260087362"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260087362" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260087362">(Nov 03 2021 at 03:52)</a>:</h4>
<p>there's a simpler way to half solve this: a profile can nominate additional profiles that a resource must also conform to. Doesn't merge the rules, but can be tested and rendered</p>



<a name="260087459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260087459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260087459">(Nov 03 2021 at 03:55)</a>:</h4>
<p>Can you do  that without slicing meta.profile and requiring declarations?</p>



<a name="260087478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260087478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260087478">(Nov 03 2021 at 03:55)</a>:</h4>
<p>sure. it'd be an extension in the profile itself that the validator and the renderer know about</p>



<a name="260087489"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260087489" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260087489">(Nov 03 2021 at 03:55)</a>:</h4>
<p>I mean, you could declare it in meta.profile, but you wouldn't need to</p>



<a name="260087545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260087545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260087545">(Nov 03 2021 at 03:56)</a>:</h4>
<p>Technically, you could do it now without an extension - just assert the profile as an invariant</p>



<a name="260087568"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260087568" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260087568">(Nov 03 2021 at 03:57)</a>:</h4>
<p>i guess. But it would be a lot more computable as a direct declaration</p>



<a name="260092049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260092049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260092049">(Nov 03 2021 at 05:43)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> 's suggestion would address a majority of the use cases.</p>
<p>Actually, it probably would address all the use cases I can think of, since it would let you solve the complex cases <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> is referring to:</p>
<ul>
<li>Given complex profile B with base A, complex profile C with base A, and the desire for profile D "inheriting" B and C</li>
<li>You could have D be based on B, and also conform to C</li>
<li>You could have D be based on C, and also conform to B</li>
<li>You could have D be based on A, and also conform to B and C<br>
Which you pick would probably be based on which element descriptions/slicing were closest to how you wanted your profile to look (look, not behave).</li>
</ul>



<a name="260095703"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/profile%20combining%202%2B/near/260095703" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/profile.20combining.202.2B.html#260095703">(Nov 03 2021 at 07:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179252-IG-creation/topic/profile.20combining.202.2B/near/260087545">said</a>:</p>
<blockquote>
<p>Technically, you could do it now without an extension - just assert the profile as an invariant</p>
</blockquote>
<p>we do that approach on our ig's where our national ig is depending on the core and the ihe ig's. see example here: <a href="http://fhir.ch/ig/ch-epr-mhealth/StructureDefinition-ch-mhd-providedocumentbundle-comprehensive-definitions.html#Bundle.entry:DocumentRefs.resource">http://fhir.ch/ig/ch-epr-mhealth/StructureDefinition-ch-mhd-providedocumentbundle-comprehensive-definitions.html#Bundle.entry:DocumentRefs.resource</a> it works, however the constraint is quite hidden then and not obvious for implementers.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
