---
layout: page
title: "FHIR Chat  · not the right kind of structure to generate schematrons for · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/not.20the.20right.20kind.20of.20structure.20to.20generate.20schematrons.20for.html">not the right kind of structure to generate schematrons for</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154015261"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/not%20the%20right%20kind%20of%20structure%20to%20generate%20schematrons%20for/near/154015261" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/not.20the.20right.20kind.20of.20structure.20to.20generate.20schematrons.20for.html#154015261">(Nov 02 2018 at 19:31)</a>:</h4>
<p>Running a somewhat recent (Oct 1) IG publisher on a DSTU2 IG and I'm getting these errors on all my profiles:</p>
<div class="codehilite"><pre><span></span>Exception generating resource /Users/cmoesel/dev/standardhealth/shr-cli/out/fhir/guide/resources/structuredefinition-shr-simple-Observation::StructureDefinition/shr-simple-Observation: not the right kind of structure to generate schematrons for (29.0935sec)
org.hl7.fhir.exceptions.DefinitionException: not the right kind of structure to generate schematrons for
    at org.hl7.fhir.r4.conformance.ProfileUtilities.generateSchematrons(ProfileUtilities.java:3171)
    at org.hl7.fhir.igtools.publisher.Publisher.generateOutputsStructureDefinition(Publisher.java:4460)
    at org.hl7.fhir.igtools.publisher.Publisher.generateHtmlOutputs(Publisher.java:4055)
    at org.hl7.fhir.igtools.publisher.Publisher.generate(Publisher.java:2775)
    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:581)
    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:510)
    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4895)
   org.hl7.fhir.r4.conformance.ProfileUtilities.generateSchematrons(ProfileUtilities.java:3171) (29.0935sec)
   org.hl7.fhir.igtools.publisher.Publisher.generateOutputsStructureDefinition(Publisher.java:4460) (29.0935sec)
   org.hl7.fhir.igtools.publisher.Publisher.generateHtmlOutputs(Publisher.java:4055) (29.0935sec)
   org.hl7.fhir.igtools.publisher.Publisher.generate(Publisher.java:2775)        (29.0935sec)
   org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:581)         (29.0935sec)
   org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:510)          (29.0935sec)
   org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4895)            (29.0936sec)
</pre></div>


<p>It seems to work fine when generating STU3 IGs, but (obviously) not on DSTU2 IGs.  Looking at the source code it references, it appears that error is thrown when <code>structure.getDerivation() != TypeDerivationRule.CONSTRAINT</code>.  In DSTU2, <code>StructureDefinition</code> doesn't have a <code>derivation</code> element (it was added in STU3).  Might that be the problem?</p>



<a name="154017047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/not%20the%20right%20kind%20of%20structure%20to%20generate%20schematrons%20for/near/154017047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/not.20the.20right.20kind.20of.20structure.20to.20generate.20schematrons.20for.html#154017047">(Nov 09 2018 at 06:42)</a>:</h4>
<p>problem in my converter then - how do I reproduce this?</p>
<p>(btw, sorry for the tardiness on this stream - I had a long weekend last week and then I've been closing out the main build)</p>



<a name="154018099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/not%20the%20right%20kind%20of%20structure%20to%20generate%20schematrons%20for/near/154018099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/not.20the.20right.20kind.20of.20structure.20to.20generate.20schematrons.20for.html#154018099">(Nov 13 2018 at 18:24)</a>:</h4>
<p>I'll try to get you something to reproduce.  I was out at AMIA last week, so I'm catching up as well.</p>



<a name="154019618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/not%20the%20right%20kind%20of%20structure%20to%20generate%20schematrons%20for/near/154019618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/not.20the.20right.20kind.20of.20structure.20to.20generate.20schematrons.20for.html#154019618">(Nov 19 2018 at 17:33)</a>:</h4>
<p>I've looked into this one further and determined the cause of the issue.  Although I was setting the <code>base</code> to the URL for the resource I was profiling, I was <em>not</em> setting the <code>constrainedType</code> to the name of the resource I was profiling.  Once I added <code>constrainedType</code>, the schematron issue went away.</p>



<a name="178748535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/not%20the%20right%20kind%20of%20structure%20to%20generate%20schematrons%20for/near/178748535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/not.20the.20right.20kind.20of.20structure.20to.20generate.20schematrons.20for.html#178748535">(Oct 22 2019 at 12:07)</a>:</h4>
<p>I have the same issue (in 4.0.0). I am just trying to create a datatype - a string with up to 320 characters. <br>
Any idea on what to look for or how to fix this?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
