---
layout: page
title: "FHIR Chat  · slicing question for patterns on bindings · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html">slicing question for patterns on bindings</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="262739726"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262739726" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262739726">(Nov 25 2021 at 20:43)</a>:</h4>
<p>based on this:</p>
<blockquote>
<p>Each slice must use the element definition for the element(s) in the discriminator(s) to ensure that the slices are clearly differentiated by assigning an appropriate value domain, depending on the discriminator type. If the type is value, or pattern, then the element definition must use either:</p>
</blockquote>
<blockquote>
<p>ElementDefinition.fixed[x], or<br>
ElementDefinition.pattern[x], or<br>
<strong>if the element has a terminology binding, a required binding with a Value Set that enumerates the list of possible codes in the value set ("extensional definition")</strong>  (my highlighting )</p>
</blockquote>
<p>I did this ...</p>
<div class="codehilite" data-code-language="YAML"><pre><span></span><code><span class="c1">#....</span>
    <span class="p p-Indicator">-</span> <span class="nt">id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DiagnosticReport.category</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DiagnosticReport.category</span>
      <span class="nt">slicing</span><span class="p">:</span>
        <span class="nt">discriminator</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pattern</span>    <span class="c1">#&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
            <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$this</span>          <span class="c1">#&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
        <span class="nt">rules</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">open</span>
      <span class="nt">min</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">mustSupport</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="p p-Indicator">-</span> <span class="nt">id</span><span class="p">:</span> <span class="s">'DiagnosticReport.category:us-core'</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DiagnosticReport.category</span>
      <span class="nt">sliceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">us-core</span>
      <span class="nt">min</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">mustSupport</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">binding</span><span class="p">:</span>  <span class="c1">#&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
        <span class="nt">strength</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">extensible</span>  <span class="c1">#&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
        <span class="nt">valueSet</span><span class="p">:</span> <span class="s">'http://hl7.org/fhir/us/core/ValueSet/us-core-diagnosticreport-category'</span>  <span class="c1">#&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</code></pre></div>
<p>which is causing this validation error:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code>1. ERROR: DiagnosticReport/bone-density-report: DiagnosticReport.category[0]: Slicing cannot be evaluated: Could not match discriminator ([$this]) for slice DiagnosticReport.category:us-core in profile http://hl7.org/fhir/us/core/StructureDefinition/us-core-diagnosticreport-note - the discriminator [$this] does not have fixed value, binding or existence assertions
</code></pre></div>

</blockquote>



<a name="262739823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262739823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262739823">(Nov 25 2021 at 20:45)</a>:</h4>
<p>I want this slice to be an extensible binding and to replicate the same binding rules as an extensible binding on CodeableConcept behaves - i.e., at least one of the Categories contains a value from the extensible binding.</p>
<p>how do I fix it ?</p>
<ul>
<li>Does the binding need to be required?  ()</li>
</ul>
<p>What does "extensional definition" in the documentation above mean exactly ("a required binding with a Value Set that enumerates the list of possible codes in the value set ("extensional definition")?</p>



<a name="262741408"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262741408" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262741408">(Nov 25 2021 at 21:16)</a>:</h4>
<p>I think the definition is pretty clear: a required binding</p>



<a name="262741429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262741429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262741429">(Nov 25 2021 at 21:16)</a>:</h4>
<p>extensional: see <a href="https://www.hl7.org/fhir/valueset.html#int-ext">https://www.hl7.org/fhir/valueset.html#int-ext</a></p>



<a name="262743526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262743526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262743526">(Nov 25 2021 at 22:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings/near/262741408">said</a>:</p>
<blockquote>
<p>I think the definition is pretty clear: a required binding</p>
</blockquote>
<p>My question <em>really</em>  is the parenthetic "extensional definition" makes no sense in in the context of this  documentation : "a required binding with a Value Set that enumerates the list of possible codes in the value set ("extensional definition")"   Why is it there ? </p>
<p>Second, I want this slice to be an extensible binding and to replicate the same binding rules as an extensible binding on CodeableConcept behaves - i.e., at least one of the Categories contains a value from the extensible binding.  how do I do that?   In other words how does validation behave for extensible bindings on CodeableConcepts?  it would be the same as that for slicing.</p>



<a name="262743664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262743664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262743664">(Nov 25 2021 at 22:03)</a>:</h4>
<p>for example,  I have a value set A  = 'foo', 'bar'.  I would like a slice for element bound to value set A but also allow for 'baz' if that is a local extension of the valueset.</p>



<a name="262743865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262743865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262743865">(Nov 25 2021 at 22:07)</a>:</h4>
<p>I don't know how the documentation could be more clear: you can only slice by a required binding</p>



<a name="262743926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262743926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262743926">(Nov 25 2021 at 22:08)</a>:</h4>
<p>and the vocabulary committee don't think "extensional definition" makes no sense. it's just what we call 'a value set that enumerates the list of possible codes in the value set' is</p>



<a name="262762040"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262762040" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262762040">(Nov 26 2021 at 05:46)</a>:</h4>
<p>If the binding is extensible, there's no way for the engine to know when the slice doesn't apply - because any code you send could potentially fall into the 'extensible' space.  (And it would take a human being to figure out whether it did or not.)</p>



<a name="262835071"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835071" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835071">(Nov 26 2021 at 21:10)</a>:</h4>
<p>IMO This is an academic argument that doesn't reflect the real world and is bad for actual implementation.</p>



<a name="262835106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835106">(Nov 26 2021 at 21:11)</a>:</h4>
<p>no. using an extensible binding for a slice discriminator would be bad for actual implementation</p>



<a name="262835113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835113">(Nov 26 2021 at 21:11)</a>:</h4>
<p>and what about CodeableConcept with extensiblible bindings - how does that work today?</p>



<a name="262835256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835256">(Nov 26 2021 at 21:14)</a>:</h4>
<p>works moderately badly, but what's the relationship?</p>



<a name="262835279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835279">(Nov 26 2021 at 21:14)</a>:</h4>
<p>We  assumed incorrectly that an extensibly bound element would behave that way too.  but alas it does not.  So it turns out slicing does not get you that  either.  This is a gap</p>



<a name="262835291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835291">(Nov 26 2021 at 21:15)</a>:</h4>
<p>moderately good or badly?</p>



<a name="262835346"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835346" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835346">(Nov 26 2021 at 21:16)</a>:</h4>
<p>I'm not sure what you're saying here. if your question is, 'can a slice have an extensible binding?' then the answer is yes, of course it can. Just like if it wasn't sliced. But if you question is 'can you discriminate a slice based on an extensible binding?' then the answer is no, you can't discriminate like that</p>



<a name="262835433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835433">(Nov 26 2021 at 21:18)</a>:</h4>
<p>(and slices that can't be discriminated are bad for implementers)</p>



<a name="262835647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262835647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262835647">(Nov 26 2021 at 21:22)</a>:</h4>
<p>So one solution could be to describe the discriminator and let Inferno figure it out for certification ... <span class="user-mention" data-user-id="191506">@Yunwei Wang</span>  heads up</p>



<a name="262836304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262836304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262836304">(Nov 26 2021 at 21:35)</a>:</h4>
<p>How exactly would you expect the engine to discriminate on an extensible binding <span class="user-mention" data-user-id="191401">@Eric Haas</span>?  In what circumstances would an instance not <em>always</em> match the slice with that binding?</p>



<a name="262837459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262837459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262837459">(Nov 26 2021 at 22:00)</a>:</h4>
<blockquote>
<p>So one solution could be to describe the discriminator and let Inferno figure it out for certification </p>
</blockquote>
<p>well, FMG isn't going to approve of that, and inferno couldn't figure it out</p>



<a name="262848755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262848755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262848755">(Nov 27 2021 at 02:24)</a>:</h4>
<p>These value set are not designed to be required as there is not <em>agreement within a context of use that a specified set of codes are the only ones that can be used.</em> and a required bindings on category slice would imply this.    Hopefully we can figure something out.</p>



<a name="262857282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262857282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262857282">(Nov 27 2021 at 06:17)</a>:</h4>
<p>well, you can have an extensible binding. you just can't slice by it</p>



<a name="262857283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262857283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262857283">(Nov 27 2021 at 06:17)</a>:</h4>
<p>what's the details?</p>



<a name="262897917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262897917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262897917">(Nov 27 2021 at 23:11)</a>:</h4>
<p>(deleted)</p>



<a name="262901107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262901107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262901107">(Nov 28 2021 at 00:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings/near/262857282">said</a>:</p>
<blockquote>
<p>well, you can have an extensible binding. you just can't slice by it</p>
</blockquote>
<p>We have several instances of extensible bindings on if the element <code>category</code> which usually repeats for example <code>DiagnosticReport.category</code> then <em>If an extensible binding is applied to an element with maximum cardinality &gt; 1, the binding applies to all the elements.</em> (<a href="http://hl7.org/fhir/R4/terminologies.html#extensible">http://hl7.org/fhir/R4/terminologies.html#extensible</a>)  That was not our intent and has led to the current situation:</p>
<ol>
<li>Our intent is only single repeat be bound to the valueset.  To illustrate this problem , look at <a href="http://build.fhir.org/ig/HL7/fhir-sdoh-clinicalcare/StructureDefinition-SDOHCC-Condition.html">SDOHCC Condition</a> a derived profile from USCore Condition - there <em>SDOH</em> slice which is technically invalid since it does not contain the US Core valueset concepts.    </li>
<li>In  addition we know our valuesets are incomplete so making it <em>required</em>  prohibits other local valid category concepts.</li>
</ol>
<p>I understand the technical difficulty with this but I can imagine defining multiple orthogonal categorization schemes that could be defined with orthogonal not-fully-realized valuesets at time of publishing.</p>



<a name="262934018"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262934018" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262934018">(Nov 28 2021 at 15:22)</a>:</h4>
<p>The rules with slicing are simple - the discriminators must discriminate.  I.e. no two slices can allow overlapping values for the set of declared discriminators.  Two extensible bindings will <em>always</em> overlap even if the base value sets don't because "extensible" means that codes not found within the value set are also allowed. </p>
<p>The best way to accomplish what you're trying to do is have 0..1 must support slices with required bindings.  That says "you must be capable of sending and receiving content that looks like this, but it's ok if the category doesn't apply and you're free to send other categories too.  Also, you can't have multiple categories from this value set."  (Personally, I think that last statement is questionable - if you're going to say that you must ensure that there's never a circumstance where more than one of the codes could apply at the same time.)</p>



<a name="262950857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/262950857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#262950857">(Nov 28 2021 at 22:03)</a>:</h4>
<p>generally agree with Lloyd - but it sounds like you really want a pretty general binding and a 'must-support' value set tied to a functional context?</p>



<a name="263018834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263018834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263018834">(Nov 29 2021 at 14:57)</a>:</h4>
<p>Having a required <em>or</em> extensible binding across all category repetitions in US-Core is an error.  That's saying that every repetition must satisfy the binding, which isn't what you want.  If you make category 1..* overall and have a 0..1 required mustSupport slice with your current value set, you'll accomplish your desired outcome.  I.e. "Must always have a category.  Must send one of our category codes if one of them applies".</p>



<a name="263022866"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263022866" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263022866">(Nov 29 2021 at 15:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings/near/263018834">said</a>:</p>
<blockquote>
<p>Having a required <em>or</em> extensible binding across all category repetitions in US-Core is an error.  That's saying that every repetition must satisfy the binding, which isn't what you want.  If you make category 1..* overall and have a 0..1 required mustSupport slice with your current value set, you'll accomplish your desired outcome.  I.e. "Must always have a category.  Must send one of our category codes if one of them applies".</p>
</blockquote>
<p>I agree and that is what i stated earlier twice and why we are stuck using the more opaque  slicing structure</p>



<a name="263024568"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263024568" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263024568">(Nov 29 2021 at 15:39)</a>:</h4>
<p>OK after stewing on this over the weekend.</p>
<p>element 1..*   with 1..* slice on <em>extensible</em> binding ( which we can't do <span aria-label="rage" class="emoji emoji-1f621" role="img" title="rage">:rage:</span>) ~= element 1..*   with 0..* slice on <em>required</em> binding </p>
<p>The meaning of a required binding is compromised to allow for slicing in this case and folks reading us core are going to see required and have a cow.  We are going to have to document how a required binding slice with a combination of cardinality is really an extensible binding in disguise.</p>



<a name="263032706"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263032706" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263032706">(Nov 29 2021 at 16:33)</a>:</h4>
<p>I'm confused about the rules for discriminators -- I thought they were technically optional (i.e., without a discriminator, the semantics of slicing still work, just in a less computationally tractable way) per <a href="http://build.fhir.org/profiling.html#discriminator">http://build.fhir.org/profiling.html#discriminator</a> .</p>



<a name="263050624"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263050624" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263050624">(Nov 29 2021 at 18:41)</a>:</h4>
<p>yes that's right, so why confused?</p>



<a name="263073221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263073221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263073221">(Nov 29 2021 at 21:59)</a>:</h4>
<p>If you just express the rules with a description, you still need to express the rules in a way that can meet the requirements - i.e. every slice can be discriminated and every instance repetition matches against no more than one slice.  If you've got multiple slices with extensible bindings, that's not possible.</p>



<a name="263073350"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263073350" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263073350">(Nov 29 2021 at 22:00)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> Not sure what you mean by "the meaning of a required binding is compromised".  I don't think there's any compromise here?</p>



<a name="263073834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263073834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263073834">(Nov 29 2021 at 22:04)</a>:</h4>
<p>So there's (intentionally) no way to use slicing to say:</p>
<ul>
<li>Need at least one Coding from {"A", "B", "C"}</li>
<li>Need at least one Coding from {"C", "D", "E"}</li>
</ul>
<p>... and satisfy the slicing validator with a single Coding "C"?</p>



<a name="263074016"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263074016" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263074016">(Nov 29 2021 at 22:06)</a>:</h4>
<p>Right.  Slices must be disjoint.</p>



<a name="263074143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263074143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263074143">(Nov 29 2021 at 22:07)</a>:</h4>
<p>Can you help me with the intuition for why? Is it that use cases like the example above don't really exist? Or that supporting such things would introduce  complexities elsewhere?</p>



<a name="263075123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263075123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263075123">(Nov 29 2021 at 22:15)</a>:</h4>
<p>hey no</p>



<a name="263075162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263075162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263075162">(Nov 29 2021 at 22:15)</a>:</h4>
<p>slices don't have to be disjoint, but discriminators have to be disjoint. But slices that are not disjoint are... not anticipated or desired</p>



<a name="263075319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263075319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263075319">(Nov 29 2021 at 22:16)</a>:</h4>
<p>the point of having slices is so that you can describe them differently.</p>



<a name="263075811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263075811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263075811">(Nov 29 2021 at 22:21)</a>:</h4>
<p>the specification does not rule out having over-lapping slices, because we never thought that would be a thing, really. The langauge is written for it not to be a thing, but it's not stated explicitly. E.g. </p>
<blockquote>
<p>In this case, the "code" element in the target resource can be used to determine which slice that target refers to</p>
</blockquote>
<p>It's always singular - an element fits into one slice. But it's only on discriminators that we say:</p>
<blockquote>
<p>When a constraining structure designates one or more discriminators, it SHALL ensure that the possible values for each slice are different and non-overlapping, so that the slices can easily be distinguished</p>
</blockquote>
<p>Note, though, that the reason is so that slices can <em>easily</em> be distinguished. Not so that they can be distinguished at all, since the language assumes that each element is in at most, one slice. Which is also how the validator is implemented - it allocates elements to slices, and then validates them against their slice (singular)</p>



<a name="263075840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263075840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263075840">(Nov 29 2021 at 22:21)</a>:</h4>
<p>I'm not in a hurry to change that either - slicing is the most difficult code I've ever written (both the snapshot generation, and the validation)</p>



<a name="263075994"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263075994" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263075994">(Nov 29 2021 at 22:23)</a>:</h4>
<blockquote>
<p>slices don't have to be disjoint, but discriminators have to be disjoint. But slices that are not disjoint are... not anticipated or desired</p>
</blockquote>
<p>How can disjoint discriminators result in nondisjoint slices?  At this point I'm just trying to follow the logic, not arguing for anything in particular.</p>



<a name="263076612"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263076612" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263076612">(Nov 29 2021 at 22:29)</a>:</h4>
<p>I don't understand how a slice can avoid being disjoint if the discriminators are disjoint?  Can you give an example Grahame?</p>



<a name="263076771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263076771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263076771">(Nov 29 2021 at 22:30)</a>:</h4>
<p>if there is no discriminators</p>



<a name="263077202"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263077202" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263077202">(Nov 29 2021 at 22:35)</a>:</h4>
<p>the point of discriminators is to discriminate, so if there are any, then conformant slices will be disjoint - they must be. </p>
<p>but if there's no discriminators, then all bets are off. The spec anticipates that they are still disjoint, but it does not say so explicitly. And the validator implements that they are disjoint, but has no way to test that they are, other than trying to match. I guess I'll have to add a test case to find out what happens to my todo list</p>



<a name="263080338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263080338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263080338">(Nov 29 2021 at 23:07)</a>:</h4>
<p>If there are no discriminators, isn't the discrimination process defined in text - but still expected to actually discriminate?</p>



<a name="263081176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263081176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263081176">(Nov 29 2021 at 23:15)</a>:</h4>
<p>doesn't have to be defined in text. if it's not, then it's purely based on validation against the slices.</p>



<a name="263081208"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263081208" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263081208">(Nov 29 2021 at 23:16)</a>:</h4>
<p>as for </p>
<blockquote>
<p>expected to actually discriminate</p>
</blockquote>
<p>yes. it's expected to - at least, we expected it to when we wrote the spec, but we failed to be explicit about it</p>



<a name="263081963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263081963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263081963">(Nov 29 2021 at 23:24)</a>:</h4>
<p><a href="http://jira.hl7.org/browse/FHIR-34387">FHIR#34387</a></p>



<a name="263083877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263083877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263083877">(Nov 29 2021 at 23:49)</a>:</h4>
<p>re "the meaning of a required binding is compromised"</p>
<p>required binding definition: "The other place where this is used is when profiling resources, and there is agreement within a context of use that a specified set of codes are the only ones that can be used. In these cases, the data type SHALL contain one of the values in the value set." ( <a href="http://hl7.org/fhir/terminologies.html#required">http://hl7.org/fhir/terminologies.html#required</a> )</p>
<p>required binding definition when slicing by valueset : "The other place where this is used is when slicing by valueset.  Because it is necessary to define disjoint slices only a specified set of codes <em>even if there is not agreement within a context of use that a specified set of codes are the only ones that can be used</em>"   ( my interpretation.)</p>



<a name="263094235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/slicing%20question%20for%20patterns%20on%20bindings/near/263094235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/slicing.20question.20for.20patterns.20on.20bindings.html#263094235">(Nov 30 2021 at 02:12)</a>:</h4>
<p>But the point is - within the slice, it <em>is</em> the only set of codes that can be used.  You just have other slices that allow for other things too.  The meaning of 'required' isn't any different.  You're just using it (appropriately) in a more constrained space.  Outside that space, the 'required' has no force.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
