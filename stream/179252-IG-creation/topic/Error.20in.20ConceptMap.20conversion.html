---
layout: page
title: "FHIR Chat  · Error in ConceptMap conversion · IG creation"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/index.html">IG creation</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html">Error in ConceptMap conversion</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="188402542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188402542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188402542">(Feb 17 2020 at 19:42)</a>:</h4>
<p>My input ConceptMap contains:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;element&gt;</span>
    <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;55561003&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">&quot;Active&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;target&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;active&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">&quot;Active&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;equivalence</span> <span class="na">value=</span><span class="s">&quot;equal&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;element&gt;</span>
    <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;55561003&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">&quot;Active&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;target&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;recurrence&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">&quot;Recurrence&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;equivalence</span> <span class="na">value=</span><span class="s">&quot;specializes&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>


<p>The html rendering displays:</p>
<div class="codehilite"><pre><span></span>55561003 (Active) equivalent active
55561003 (Active) narrower recurrence
</pre></div>


<p>And the QA page says:</p>
<div class="codehilite"><pre><span></span>ConceptMap/ProbleemStatusCodelijst-to-Condition-Clinical-Status-Codes: ConceptMap.jurisdiction[0].coding[0] information Code System URI &#39;urn:iso:std:iso:3166&#39; is unknown so the code cannot be validated
ConceptMap/ProbleemStatusCodelijst-to-Condition-Clinical-Status-Codes: ConceptMap.group[0].element[1].target[0] error cmd-1: If the map is narrower or inexact, there SHALL be some comments [comment.exists() or equivalence.empty() or ((equivalence != &#39;narrower&#39;) and (equivalence != &#39;inexact&#39;))]
</pre></div>


<p>I can sure enough add a comment to satisfy the complaint, but is it correct to phrase a different equivalence value than the STU3 ConceptMap has?</p>



<a name="188402723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188402723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188402723">(Feb 17 2020 at 19:46)</a>:</h4>
<p>Secondly: the <a href="http://hl7.org/fhir/STU3/conceptmap-definitions.html#ConceptMap.group.element.target.equivalence" target="_blank" title="http://hl7.org/fhir/STU3/conceptmap-definitions.html#ConceptMap.group.element.target.equivalence">STU3 ConceptMap</a> says that equivalence serves to state relationship <em>from target to source</em>, not the other way around</p>
<p><em>The equivalence between the source and target concepts (counting for the dependencies and products). The equivalence is read from target to source (e.g. the target is 'wider' than the source).</em></p>



<a name="188406421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188406421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188406421">(Feb 17 2020 at 21:01)</a>:</h4>
<p>For R5 we're in the process of cleaning up the ConceptMap "equivalence" codes (replacing them with a simpler set of "relationship" codes) and fixing the language and the codes themselves to more clearly and unambiguously indicate the direction for the "narrower" and "wider/broader" codes.  In this case, 'specializes' in STU3/R4 is converted to 'narrower' in the current CI build - but that is going to be changed (very soon) to 'source_is_broader_than_target' (or 'source-is-broader-than-target'), based on our continuing discussions prior to and in Sydney and our vote last week on these proposed ConceptMap changes for R5.</p>



<a name="188412814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188412814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188412814">(Feb 17 2020 at 23:23)</a>:</h4>
<p>but that is R5, <span class="user-mention" data-user-id="191375">@Alexander Henket</span>'s point is quite valid</p>



<a name="188422714"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188422714" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188422714">(Feb 18 2020 at 04:19)</a>:</h4>
<p>Sure.  I agree that 'specializes' shouldn't be changed to 'narrower' for an instance in STU3 (or R4).  I mentioned R5 because that conversion <strong>would</strong> be applied in going from STU3 or R4 to the current CI build (although the 'narrower' code is going to be changed soon), and at first that triggered the thought that the conversion code may have been applied incorrectly - but that appears to be a coincidence.</p>



<a name="188423298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188423298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188423298">(Feb 18 2020 at 04:38)</a>:</h4>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span> / <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> there are two points here:</p>
<ul>
<li>
<p>you’d expect an STU3 ConceptMap to be rendered as an STU3 ConceptMap. Current rendering has all characteristics of R5. I think Grahame indicates he’s going to look into that?</p>
</li>
<li>
<p>Vocab aims to reverse the semantics of the equivalence from target-to-source to source-to-target in R5. I think that is going to make  the conversion process a lot harder. In fact for people not using the IG Publisher it might be a gem they overlook and a source of confusion and bugs. I would vote against this change. It aims to end confusion but in doing so will add more (is my expectation). Target-to-source has been explicitly documented for the longest time, it was never ambiguous, just overlooked.</p>
<ul>
<li>Afterthought on why conversion might even be impossible: the IG Publisher requests a comment that tells something about the equivalence. I've just added these comments, but those make a whole lot less sense if the direction of the equivalence is reversed.</li>
</ul>
</li>
</ul>
<p>I see that the new <em><a href="http://build.fhir.org/conceptmap-definitions.html#ConceptMap.group.element.target.relationship" target="_blank" title="http://build.fhir.org/conceptmap-definitions.html#ConceptMap.group.element.target.relationship">relationship</a></em> element still has the same semantics by the way: <em>The relationship is read from target to source (e.g. the target is 'broader' than the source).</em></p>



<a name="188426691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188426691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188426691">(Feb 18 2020 at 06:27)</a>:</h4>
<p>As product director, I will insist on asking the implementers about reversing the direction. I'm.. ambivalent... myself</p>



<a name="188426749"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188426749" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188426749">(Feb 18 2020 at 06:29)</a>:</h4>
<p>I will fix the rendering. <span class="user-mention" data-user-id="191405">@Rob Hausam</span> I think that this is arguing against the changes vocb has made there</p>



<a name="188426793"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188426793" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188426793">(Feb 18 2020 at 06:30)</a>:</h4>
<p>and yes, I'm fixing the rendering</p>



<a name="188491961"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188491961" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188491961">(Feb 18 2020 at 21:14)</a>:</h4>
<p>should be fixed next release</p>



<a name="188540326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188540326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188540326">(Feb 19 2020 at 12:42)</a>:</h4>
<p>ConceptMap says </p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;element&gt;</span>
  <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;55561003&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">&quot;Active&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;target&gt;</span>
    <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;recurrence&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">&quot;Recurrence&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;equivalence</span> <span class="na">value=</span><span class="s">&quot;specializes&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;comment</span> <span class="na">value=</span><span class="s">&quot;When problem is recurring, ...&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>


<p>While the xml means <em>recurrence specializes active</em>, the html seems to be saying the opposite. Could it be that vocab is aiming to reverse the direction of relationship because of the HTML rendering?</p>
<p><a href="/user_uploads/10155/nFrC363JZas8VUDzYhDJmlmv/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/nFrC363JZas8VUDzYhDJmlmv/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/nFrC363JZas8VUDzYhDJmlmv/pasted_image.png"></a></div>



<a name="188544244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188544244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188544244">(Feb 19 2020 at 13:38)</a>:</h4>
<p>Yes, that's part of it.  It should read with the correct semantics when it's presented in a <code>source | relationship | target</code> table format - which it would if the relationship was <code>has-narrower-target</code>.  But the decision in Vocab is that the relationship will now become <code>source_is_broader_than_target</code> (or possibly <code>source-is-broader-than-target</code>), so the table display rendering (leaving off the fourth column) would become  <code>55561003 (Active) | source-is-broader-than-target | recurrence</code>.</p>



<a name="188556116"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188556116" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188556116">(Feb 19 2020 at 15:48)</a>:</h4>
<p>But if the HTML rendering is off you fix the HTML rendering, right? What's been decided effectively retrofits the ConceptMap into the rendering thereof.</p>



<a name="188556225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188556225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188556225">(Feb 19 2020 at 15:49)</a>:</h4>
<p>the rendering is for humans. The ConceptMap is for tools. You break the connection between tooling and ConceptMaps to please the human eye :-)</p>



<a name="188601867"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188601867" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188601867">(Feb 20 2020 at 01:01)</a>:</h4>
<p>ok so how about <br>
<a href="/user_uploads/10155/CHcT-yjwd66Qi9m0gslJoKm9/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/CHcT-yjwd66Qi9m0gslJoKm9/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/CHcT-yjwd66Qi9m0gslJoKm9/pasted_image.png"></a></div>



<a name="188623764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188623764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188623764">(Feb 20 2020 at 09:54)</a>:</h4>
<p>Works for me. I like it. <span class="user-mention" data-user-id="191405">@Rob Hausam</span> ?</p>



<a name="188654364"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188654364" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188654364">(Feb 20 2020 at 16:40)</a>:</h4>
<p>I'm not seeing this as helpful - and I think it probably is going in the wrong direction.  For mapping, I think that 'equivalent' (not 'equal') and 'broader' or 'narrower' (rather than 'subsumes' or 'specializes') are the semantics that are the most appropriate (in whatever specific permutations of the actual code strings we decide to use).  That's what we did in the new simplified code system and value set (that Alexander said he agreed with earlier).  I think I still prefer to stay with those changes and to finish nailing down the specific codes to use for the "broader" and "narrower" cases.  I think you can only rarely (if ever) talk meaningfully and definitively about subsumption relationships between concepts in different code systems, which still is the primary use case for terminology mapping generally and specifically for the ConceptMap resource.</p>



<a name="188673939"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188673939" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188673939">(Feb 20 2020 at 20:21)</a>:</h4>
<p>so first of all, you're on the wrong track with what you are commenting about.</p>



<a name="188673977"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188673977" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188673977">(Feb 20 2020 at 20:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191375">@Alexander Henket</span> (who's off for a week) and I are working on the rendering of an R3 concept map, not interested in the R5 changes. So first I'll comment on that</p>



<a name="188674107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188674107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188674107">(Feb 20 2020 at 20:23)</a>:</h4>
<p>Alexander's criticism was around the presentation of the directionality of the relationships - because the renderer simply renders the code, the presentation is mis-leading. So I've provided substitute wording to convey the directionality in the rendering, and that was what I was asking about</p>



<a name="188674258"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188674258" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188674258">(Feb 20 2020 at 20:25)</a>:</h4>
<p>On the subject of the R5 changes:</p>
<ul>
<li>when it comes to big public terminologies like snomed etc, you're right about rarely talking about subsumption</li>
<li>but when it comes to private codes around status etc, it's actually pretty common to be able to say definitely that concepts are subsumed. I feel as though Vocab is ignoring the actual use of ConceptMap here</li>
</ul>



<a name="188674738"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188674738" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188674738">(Feb 20 2020 at 20:31)</a>:</h4>
<p>Well, sorry about that.  There has been some discussion in the topic about the proposed R5 changes.  I see now that your rendering of the relationship was a description rather than the code, but without an explanation of that I'm not sure that was particularly clear.  Anyway, I get what you are trying to do.  And I think we do (or will) need to consider where we'll end up on this for R5.</p>



<a name="188675641"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188675641" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188675641">(Feb 20 2020 at 20:43)</a>:</h4>
<p>I did the same for R5 - convey the directionality in the description (where it matters)</p>



<a name="188675688"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188675688" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188675688">(Feb 20 2020 at 20:44)</a>:</h4>
<p>if the directionality flips over then the descriptions will have to flip</p>



<a name="188675734"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188675734" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188675734">(Feb 20 2020 at 20:44)</a>:</h4>
<p>right - thanks</p>



<a name="188684916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188684916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188684916">(Feb 20 2020 at 22:19)</a>:</h4>
<p>I agree that having the directionality in the displayed description/definition text is where it is really needed, if that is sufficiently clear (and this will help).  I'm not sure that we need to (or should) also force all of those semantics into the codes themselves (we already don't have meaningless identifiers, but this would take us even farther in the other direction).</p>



<a name="188687157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188687157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188687157">(Feb 20 2020 at 22:45)</a>:</h4>
<p>I'm not proposing to change the codes</p>



<a name="188687387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188687387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188687387">(Feb 20 2020 at 22:48)</a>:</h4>
<p>Yes, I understand that you are not - at first I thought that was what you were doing, hence my reaction (apologies for the confusion).</p>



<a name="188735694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188735694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giorgio Cangioli <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188735694">(Feb 21 2020 at 14:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion/near/188674107" title="#narrow/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion/near/188674107">said</a>:</p>
<blockquote>
<p>Alexander's criticism was around the presentation of the directionality of the relationships - because the renderer simply renders the code, the presentation is mis-leading. So I've provided substitute wording to convey the directionality in the rendering, and that was what I was asking about</p>
</blockquote>
<p>why do not "just" invert the order of the columns in the shown html (i.e. target - relationship - source) and keep the codes as they are now ? <br>
or do you think that also this may be misleading in term of directionality of the map?</p>



<a name="188735774"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188735774" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giorgio Cangioli <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188735774">(Feb 21 2020 at 14:29)</a>:</h4>
<p>BTW, is there any specific reason why "equivalent" and "equal" are both shown as "equivalent" ?</p>



<a name="188736183"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188736183" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188736183">(Feb 21 2020 at 14:33)</a>:</h4>
<p>In the CI build (for R5) there is only 'equivalent', and when converting an instance from an earlier version to CI/R5 'equal' will be converted to 'equivalent'.  But that shouldn't be happening if the rendering is being done in R4 or STU3.</p>



<a name="188737985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188737985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giorgio Cangioli <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188737985">(Feb 21 2020 at 14:51)</a>:</h4>
<p>Working with R4, but not a problem to use only the "equivalent" concept..thanks</p>



<a name="188762146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/188762146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#188762146">(Feb 21 2020 at 18:49)</a>:</h4>
<blockquote>
<p>is there any specific reason why "equivalent" and "equal" are both shown as "equivalent"</p>
</blockquote>
<p>That should no longer be the case as of the last release</p>



<a name="200999035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/200999035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#200999035">(Jun 16 2020 at 11:06)</a>:</h4>
<p>In a previous incarnation of our mapping tool, we rendered maps as <code>source | relationship | target</code> -- we continually had problems with a subgroup of our users who would not read this left-to-right because they were very close to their workflow of creating maps where the relationship is about the target.</p>
<p>When we migrated our tooling to FHIR, we changed the rendering of maps to be <code>source | target | relationship</code> -- this satisfied that subgroup of users, and we've not had negative feedback from anyone else. </p>
<p>However, I think it would be naive to think that this "solved" the problem.  I rather suspect that it removed the dissonance created when people mis-understood the intended direction of the relationship and thus concealed the issue.</p>
<p>The root cause of the problem, IMO, is that the relationship codes in R4 and prior have implicit direction (target to source) and are thus open to misunderstanding and misuse.  The only safe way to correct this is to clearly indicate the direction <strong>in the code</strong> (and it's display), rather than relying on the context of a rendering (be it human or technical; JSON/XML/...)</p>



<a name="200999406"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/200999406" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#200999406">(Jun 16 2020 at 11:11)</a>:</h4>
<p>So have we achieved that (at least reasonably) with the recent updates that we have now in the current CI build (projected R5)?</p>



<a name="201044635"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201044635" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201044635">(Jun 16 2020 at 16:58)</a>:</h4>
<p>those also reversed the direction of the meaning, which was not necessary to solve it</p>



<a name="201065529"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201065529" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201065529">(Jun 16 2020 at 19:53)</a>:</h4>
<p>Agree.</p>



<a name="201088345"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201088345" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201088345">(Jun 16 2020 at 23:59)</a>:</h4>
<p>Maybe, if we had something like 'source_narrower' and 'target_narrower'  then we might let implementations determine the direction of the relationship, rather than attempting to herd them all in one direction?</p>



<a name="201089559"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201089559" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201089559">(Jun 17 2020 at 00:18)</a>:</h4>
<p>I think that truly sounds unsafe, where the same code could mean the diametrically opposite thing in different implementations</p>



<a name="201102602"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201102602" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201102602">(Jun 17 2020 at 05:19)</a>:</h4>
<p>hmm - if you expanded those codes to 'source_narrower_than_target' and 'target_narrower_than_source', I fail to see how that's any more unsafe than what's currently in R5. That is, unless you believe we can finally reach a consensus on a single direction. </p>
<p>The two codes that I've suggested would certainly fit my use case which is translating between different NZ Ethnicity Code Levels - but admittedly that is quite a simplistic one as the direction is implicit in the levels of the source and target.</p>



<a name="201107156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201107156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201107156">(Jun 17 2020 at 07:02)</a>:</h4>
<p>I must misunderstand you - we have to get consensus on a single direction.</p>



<a name="201113557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201113557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201113557">(Jun 17 2020 at 08:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion/near/201107156">said</a>:</p>
<blockquote>
<p>I must misunderstand you - we have to get consensus on a single direction.</p>
</blockquote>
<p>Well, if anyone can achieve that, I guess that person might just be you. :)</p>



<a name="201228521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201228521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201228521">(Jun 18 2020 at 05:05)</a>:</h4>
<p>The CODE tells you the direction.  It is the only way that works - we cannot rely on the context of use of the code to indicate direction (what we had up to and including R4).<br>
I don't see any problem with choosing the code <code>source-is-narrower-than-target</code> over <code>target-is-broader-than-source</code> -- they both mean the same thing.<br>
While the latter, <code>target-is-broader-than-source</code>, is the replacement for R4's <code>broader</code> so it might seem a better choice, there was a strong preference for a code that "read" from left to right.<br>
That is, <code>123 source-is-narrower-than-target abc</code> was preferred over <code>123 target-is-broader-than-source abc</code> because in both cases <code>123</code> is the source, but the second rendering can be misunderstood.</p>



<a name="201228645"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/201228645" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#201228645">(Jun 18 2020 at 05:09)</a>:</h4>
<p>FWIW I think the Definition for <code>not-related-to</code> should be revised to use wording that is not directional.<br>
e.g., This is an explicit assertion that the concepts are not related to each other.</p>



<a name="202296089"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/202296089" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#202296089">(Jun 29 2020 at 11:13)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> I am concerned that you think the direction has been reversed?</p>
<p>The underlying ConceptMap structure is the same and the code <code>broader</code> (with the meaning "target is broader than source") has been replaced by the code <code>source-is-narrower-than-target</code> (which has the same meaning).  This also aligns with your desired rendering.  I don't see any direction reversing, only clarification of ambiguity.</p>



<a name="202365865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/202365865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#202365865">(Jun 29 2020 at 20:46)</a>:</h4>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span> and I reversed all the codes in all the instances as part of the change</p>



<a name="202366687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179252-IG%20creation/topic/Error%20in%20ConceptMap%20conversion/near/202366687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179252-IG-creation/topic/Error.20in.20ConceptMap.20conversion.html#202366687">(Jun 29 2020 at 20:54)</a>:</h4>
<p>I think I would say rather that we <strong>updated</strong> all of the codes, in accordance with the changes as Michael described.  The intended <strong>direction</strong> of the maps is still the same (although there are a small number of cases where it was wrong, and I believe those still need to be updated).  What has changed is how we are reading and describing the direction, not the direction itself - and now the codes explicitly state the direction in accordance with the reading "from source to target".</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
