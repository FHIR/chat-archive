---
layout: page
title: "FHIR Chat  · Questionnaire item extensions · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html">Questionnaire item extensions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="211952827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211952827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211952827">(Oct 01 2020 at 18:23)</a>:</h4>
<p>I am trying to use this extension <a href="http://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-questionnaire-behave-definitions.html#Questionnaire.item.extension:unitOption">http://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-questionnaire-behave-definitions.html#Questionnaire.item.extension:unitOption</a> on a questionnaire.item.item:</p>
<div class="codehilite"><pre><span></span><code>Alias: $sdc-questionnaire-unitOption = http://hl7.org/fhir/StructureDefinition/questionnaire-unitOption
...
* item[0].item[0].extension[$sdc-questionnaire-unitOption].valueCoding = #d
</code></pre></div>


<p>And get the "does not exist" failure:</p>
<div class="codehilite"><pre><span></span><code>error The element or path you referenced does not exist: item.item[1].extension[$sdc-questionnaire-unitOption].valueCoding
</code></pre></div>


<p>But it works if I use it on the 1st layer, e.g.:</p>
<div class="codehilite"><pre><span></span><code>* item.extension[$sdc-questionnaire-unitOption].valueCoding = #d
</code></pre></div>


<p>Any ideas?</p>



<a name="211957450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211957450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211957450">(Oct 01 2020 at 18:56)</a>:</h4>
<p>This is in an <code>Instance</code> not a <code>Profile</code>, right?</p>



<a name="211958844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211958844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211958844">(Oct 01 2020 at 19:06)</a>:</h4>
<p>Correct, I am making an instance of a Questionnaire</p>



<a name="211961600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211961600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211961600">(Oct 01 2020 at 19:26)</a>:</h4>
<p>OK.  So I'm guessing that this instance is based on a profile that declares the extension on <code>item</code>?  Because if I try it with <code>InstanceOf: Questionnaire</code>,  then even the "1st layer" example doesn't work.  It has to be an instance of a profile that declares that extension on <code>item</code>.</p>
<p>I discovered that if I updated the profile to include:</p>
<div class="codehilite"><pre><span></span><code>* item.item.extension contains $sdc-questionnaire-unitOption named sdc 0..1
</code></pre></div>


<p><em>then</em> your original example worked too.</p>
<p>So the extension in the profile isn't propagating to the recursive <code>item</code> children.  At one point it was unclear if it should because the FHIR doc was ambiguous about that.</p>
<p>So this leads to two more questions:</p>
<ol>
<li>Shouldn't you be able to use an extension in an instance even if that extension isn't declared in the profile?  I think yes, but obviously SUSHI thinks no.  <span class="user-mention" data-user-id="191447">@Mark Kramer</span> ?  <span class="user-mention" data-user-id="239822">@Nick Freiter</span>?  Would you agree that you should be able to do <code>* somepath.extension[http://example.org/arbitraryextension].valueString = "Foo"</code> in an instance of even a base resource?</li>
<li>Should extension declarations propagate through <em>contentreferences</em>?  I'll have to try to dig up some old threads to see if we resolved that.</li>
</ol>



<a name="211962126"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211962126" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211962126">(Oct 01 2020 at 19:30)</a>:</h4>
<p>OK.  Looks like the answer to #2 is <a href="#narrow/stream/179252-IG-creation/topic/Clarification.20on.20contentReference/near/204963141">yes, it should propagate</a>.</p>



<a name="211962435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211962435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211962435">(Oct 01 2020 at 19:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span>  -- incidentally, when I try this one <a href="http://hl7.org/fhir/StructureDefinition/questionnaire-unitOption">http://hl7.org/fhir/StructureDefinition/questionnaire-unitOption</a> I have the same problem (only working on <code>item</code> and fails on <code>item.item</code>). In this case, they specify the extension on Questionnaire.item and Questionnaire.item.item.</p>



<a name="211962777"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211962777" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211962777">(Oct 01 2020 at 19:35)</a>:</h4>
<p>(e.g. see the context as specified -- <a href="https://www.hl7.org/fhir/extension-questionnaire-unitoption.json.html">https://www.hl7.org/fhir/extension-questionnaire-unitoption.json.html</a>)</p>



<a name="211962935"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211962935" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Kramer <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211962935">(Oct 01 2020 at 19:36)</a>:</h4>
<p>It should be possible to add ad hoc extensions to an instance, certainly.</p>



<a name="211962990"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211962990" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211962990">(Oct 01 2020 at 19:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191782">@Brian Kaney</span> -- I meant declared on the profile itself -- not via the extension context.  For example, this is the FSH I used to test it:</p>
<div class="codehilite"><pre><span></span><code>Alias: $sdc-questionnaire-unitOption = http://hl7.org/fhir/StructureDefinition/questionnaire-unitOption

Profile: MyQuestionnaireProfile
Parent: Questionnaire
* item.extension contains $sdc-questionnaire-unitOption named sdc 0..1
* item.item.extension contains $sdc-questionnaire-unitOption named sdc 0..1

Instance: MyQuestionnaire
InstanceOf: MyQuestionnaireProfile
* item.extension[$sdc-questionnaire-unitOption].valueCoding = #d
* item[0].text = &quot;A&quot;
* item[0].item[0].text = &quot;B&quot;
* item[0].item[0].extension[$sdc-questionnaire-unitOption].valueCoding = #d
</code></pre></div>


<p>Again, not saying this is how it <em>should</em> be -- just saying how it currently appears to be working.</p>



<a name="211963827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211963827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211963827">(Oct 01 2020 at 19:43)</a>:</h4>
<p>Right. I think the question here is more of a general profiling one and not a sushi one. I would have expected the behavior to automatically apply to all nested children. Then, if you want to constrain to a particular level you would create an invariant.</p>
<p>The way it is now, you end up with things like <a href="http://hl7.org/fhir/StructureDefinition/questionnaire-unitOption">http://hl7.org/fhir/StructureDefinition/questionnaire-unitOption</a> where it seems to arbitrarily go 2-levels deep...</p>



<a name="211963951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211963951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211963951">(Oct 01 2020 at 19:44)</a>:</h4>
<p>Questionnaire.item, PlanDef.action, RequestGroup.action, etc.</p>



<a name="211964546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211964546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211964546">(Oct 01 2020 at 19:49)</a>:</h4>
<p>Just in reference to the question of adding extensions on an <code>Instance</code> that do not exist on the corresponding profile, that is definitely a bug. If you do the following:</p>
<div class="codehilite"><pre><span></span><code>Instance: MyQ
InstanceOf: Questionnaire
* extension[us-core-race].id = &quot;string&quot;
* item[0].extension[us-core-race].id = &quot;string&quot;
* item[0].item[0].extension[us-core-race].id = &quot;string&quot;
</code></pre></div>


<p>the first line works correctly, while the second two fail.</p>



<a name="211966495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/211966495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#211966495">(Oct 01 2020 at 20:03)</a>:</h4>
<p>Tracked here: <a href="https://github.com/FHIR/sushi/issues/621">https://github.com/FHIR/sushi/issues/621</a></p>



<a name="216143049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/216143049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#216143049">(Nov 09 2020 at 21:08)</a>:</h4>
<p>I am still having problems on this, and deeply nested structure more generally..</p>
<p>I feel like there is misunderstanding (likely me being confused) on profiling deeply nested structures. I see this sort of problem present with Questionnaire.item, QuestionnaireResponse.item, PlanDefinition.action, RequestGroup.action, etc. Initially (from before), I would have thought when you define an extension to Questionnaire.item, it should apply to all <code>*.item</code>, no matter how deep. And if you want to constrain to a certain depth, you would add an invariant rule. But this does not seem to be the case? Right?</p>
<p>Here is an example today (sushi 0.16.0 and IGPublisher v1.1.39). Looking at <a href="https://www.hl7.org/fhir/questionnaire-profiles.html">https://www.hl7.org/fhir/questionnaire-profiles.html</a>. We see some extensions only applied to <code>.item</code> (e.g. does <code>maxSize</code> really only apply if the item at root level? is this really the intention of the author of the extension?) While others are on <code>.item</code> and <code>.item.item</code> (for instance, <code>questionnaire-minOccurs</code>, why only one-nesting, why not two or more?). So what I find myself doing, in the case of <code>minValue</code> where I need it to be nested (e.g. the item is in a group), is explicitly adding (via sushi):</p>
<div class="codehilite"><pre><span></span><code>Profile: AdvancedQuestionnaire
Parent: Questionnaire
* item.item.extension contains
  minValue named minValue
  0..1 MS
</code></pre></div>
<p>This passes sushi build just fine, but then IGPublisher gives me an error:</p>
<div class="codehilite"><pre><span></span><code>Questionnaire/MyQuestionnaire: Questionnaire.item[0].item[0]    error   The extension http://hl7.org/fhir/StructureDefinition/minValue is not allowed to be used at this point (allowed = e:Questionnaire.item; this element is [[Questionnaire.item.item, BackboneElement.item, BackboneElement])
</code></pre></div>
<p>This leads me to creating a new duplicate extension but with a slightly different name, like <code>myMinValue</code>. Is there a better way to do this? I hope!</p>



<a name="216144371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/216144371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#216144371">(Nov 09 2020 at 21:21)</a>:</h4>
<p>I see that it should propagate, from <a href="#narrow/stream/179252-IG-creation/topic/Clarification.20on.20contentReference/near/204963141">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Clarification.20on.20contentReference/near/204963141</a> .. (if so, why do we see explicitly profiled <code>.item.item</code>?). </p>
<p>But in any case, the tooling fails if I only add to the root (sushi error):</p>
<div class="codehilite"><pre><span></span><code>Profile: AdvancedQuestionnaire
Parent: Questionnaire
* item.extension contains
  minValue named minValue
  0..1 MS

Instance: MyQuestionnaire
InstanceOf: AdvancedQuestionnaire
* item.item.extension[minValue].valueInteger = 130
</code></pre></div>
<p>Fails sushi build with:</p>
<div class="codehilite"><pre><span></span><code>The element or path you referenced does not exist: item.item.extension[minValue].valueInteger
  File: /Users/bkaney/code/myig/fsh/test.fsh
  Line: 25
</code></pre></div>



<a name="220379149"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220379149" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220379149">(Dec 18 2020 at 14:41)</a>:</h4>
<p>Back on my hobbyhorse here about nested structures...</p>
<p>Is this a feature/bug in FSH or FHIR to have to explicitly define depth? From before, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> said "the extension automatically applies to the recursive instances"[1], so it looks like a bug?</p>
<p><a href="/user_uploads/10155/Oe8UoWcCTqRUCVQ8crOhnpkA/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/Oe8UoWcCTqRUCVQ8crOhnpkA/image.png" title="image.png"><img src="/user_uploads/10155/Oe8UoWcCTqRUCVQ8crOhnpkA/image.png"></a></div><p>[1]:<a href="#narrow/stream/179252-IG-creation/topic/Clarification.20on.20contentReference/near/204963141">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Clarification.20on.20contentReference/near/204963141</a></p>



<a name="220386064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220386064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220386064">(Dec 18 2020 at 15:36)</a>:</h4>
<p>Thanks for bringing this up again <span class="user-mention" data-user-id="191782">@Brian Kaney</span>.  I think we lost the thread on this one, and for that I apologize.  I'll add it to our backlog -- but given the time of year, it probably won't get scheduled for someone to actually do until after January 4.</p>



<a name="220386412"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220386412" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220386412">(Dec 18 2020 at 15:38)</a>:</h4>
<p>NP! I am generally confused as to what the behavior is supposed to be in FHIR, let alone FSH...</p>



<a name="220386504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220386504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220386504">(Dec 18 2020 at 15:39)</a>:</h4>
<p>It's still not totally clear to me exactly what constraints do and don't get inherited by recursive content references, but as you noted, Grahame at least confirmed that extensions <em>do</em> carry over -- so we'll make that happen.</p>



<a name="220386770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220386770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220386770">(Dec 18 2020 at 15:41)</a>:</h4>
<p>Right, but if that's the case, why do we see explicit nesting specified in the FHIR spec (<a href="https://www.hl7.org/fhir/questionnaire-profiles.html">https://www.hl7.org/fhir/questionnaire-profiles.html</a>)?</p>
<p><a href="/user_uploads/10155/8dn4sugsajZuM_AQr5nG51IZ/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/8dn4sugsajZuM_AQr5nG51IZ/image.png" title="image.png"><img src="/user_uploads/10155/8dn4sugsajZuM_AQr5nG51IZ/image.png"></a></div>



<a name="220386859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220386859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220386859">(Dec 18 2020 at 15:41)</a>:</h4>
<p>¯\_(ツ)_/¯</p>



<a name="220386987"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220386987" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220386987">(Dec 18 2020 at 15:42)</a>:</h4>
<blockquote>
<p>¯\_(ツ)_/¯</p>
</blockquote>
<p>correct!</p>



<a name="220387102"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/220387102" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#220387102">(Dec 18 2020 at 15:43)</a>:</h4>
<p><a href="https://github.com/FHIR/sushi/issues/699">SUSHI #699</a></p>



<a name="243767372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/243767372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#243767372">(Jun 24 2021 at 10:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> Stumbled over this topic &amp; fell right into the same confusions everyone else, so sorry if am repeating old stuff here <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> My use case is also that I have a profile on QuestionnaireI and want to add a given extension to <code>Questionnaire.item</code>, <code>Questionnaire.item.item</code> etc. recursively. The extension has both <code>Questionnaire.item</code> and <code>Questionnaire.item.item</code> as allowed context. Adding the extension to only <code>Questionnaire.item</code> in FSH does not propagate them - at least when I look at the generated profile in firely Forge, it does not show the extension on <code>item/item</code>. Conversely, explicitly adding the extension to <code>Questionnaire.item.item</code> in addition causes Forge to give a warning about the generated profile: </p>
<blockquote>
<p>Message : If the element definition has a contentReference, it cannot have type, defaultValue, fixed, pattern, example, minValue, maxValue, maxLength, or binding.</p>
</blockquote>
<p>I saw that you have a non-FHS solution for this <a href="#narrow/stream/179252-IG-creation/topic/Clarification.20on.20contentReference">this IG creation thread</a>. But I am not sure how to achieve this in FSH - is that possible or are there other approaches?</p>



<a name="243779643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/243779643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#243779643">(Jun 24 2021 at 12:46)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="194703">@Morten Ernebjerg</span> -- we added support for this in <a href="https://github.com/FHIR/sushi/releases/tag/v2.0.0-beta.1">SUSHI 2.0.0 Beta 1</a> (release notes have some details).  But basically, you will do something like this to set it up:</p>
<div class="codehilite"><pre><span></span><code>* Questionnaire.item ^type.profile = http://example.org/StructureDefinition/MyQuestionnaire
* Questionnaire.item ^type.profile.extension.url = http://hl7.org/fhir/StructureDefinition/elementdefinition-profile-element
* Questionnaire.item ^type.profile.extension.valueString = &quot;Questionnaire.item&quot;
</code></pre></div>
<p>Then constrain <code>Questionnaire.item</code> further as you wish.  That said, I don't know if the constraints (like item.extensions that you add) will actually be visible in rendered views of <code>Questionnaire.item.item</code> in Forge or in the documentation produced by the publisher.  This is a fairly advanced feature.  In SUSHI, however, when we do any processing on <code>Questionnaire.item.item</code> (or further sub-items), we'll recognize the constraints as being there and act appropriately.</p>



<a name="243792917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/243792917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#243792917">(Jun 24 2021 at 14:19)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191469">@Chris Moesel</span>! I will look forward to 2.0, then, and keep the declaration in the profile to the top <code>item</code> level for simplicity (seeing how tooling support for full recursion seems limited ATM).</p>



<a name="243795907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/243795907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#243795907">(Jun 24 2021 at 14:40)</a>:</h4>
<p>OK.  Just in case it is not clear, however, you can use SUSHI 2.0.0 beta 1 now.  Instructions for installing it are in the release notes (as well as how to tell IG Publisher to use it in auto builds).</p>



<a name="243798465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20item%20extensions/near/243798465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20item.20extensions.html#243798465">(Jun 24 2021 at 14:57)</a>:</h4>
<p>Ah, OK <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
