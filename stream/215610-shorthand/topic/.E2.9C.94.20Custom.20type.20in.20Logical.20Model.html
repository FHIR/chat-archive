---
layout: page
title: "FHIR Chat  · ✔ Custom type in Logical Model · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html">✔ Custom type in Logical Model</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="252820015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252820015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252820015">(Sep 10 2021 at 17:19)</a>:</h4>
<p>Hi - how would one set the type of a new element to a custom (logical) data type? Expecting:</p>
<div class="codehilite"><pre><span></span><code>Alias: WidgetLogicalType = http://example.com/far/far/away/widget

Logical: Basket
* contents 0..* WidgetLogicalType &quot;Widgets in the basket&quot;
</code></pre></div>
<p>But alas, error!</p>



<a name="252820140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252820140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252820140">(Sep 10 2021 at 17:20)</a>:</h4>
<p>Also:</p>
<div class="codehilite"><pre><span></span><code>Logical: Basket
* contents 0..* &quot;http://example.com/far/far/away/widget&quot; &quot;Widgets in the basket&quot;
</code></pre></div>
<p>is no-go...</p>



<a name="252820264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252820264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252820264">(Sep 10 2021 at 17:21)</a>:</h4>
<p>A new element is implemented as an Extension: <a href="https://www.hl7.org/fhir/extensibility.html">https://www.hl7.org/fhir/extensibility.html</a></p>



<a name="252820878"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252820878" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252820878">(Sep 10 2021 at 17:26)</a>:</h4>
<p>I don't think I need to use an extension in a logical model, no?</p>



<a name="252820952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252820952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252820952">(Sep 10 2021 at 17:26)</a>:</h4>
<p>Interestingly enough, this:</p>
<div class="codehilite"><pre><span></span><code>      {
        &quot;id&quot;:&quot;Member.name&quot;,
        &quot;path&quot;:&quot;Member.name&quot;,
        &quot;min&quot;:0,
        &quot;max&quot;:&quot;*&quot;,
        &quot;type&quot;: [{
          &quot;code&quot;:&quot;http://example.com/mbr&quot;
        }]
      }
</code></pre></div>
<p>reverses into this FSH:</p>
<div class="codehilite"><pre><span></span><code>* name 0..* http://example.com/mbr
</code></pre></div>
<p>but errors on a round-trip.</p>



<a name="252825692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252825692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252825692">(Sep 10 2021 at 18:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> Thoughts?</p>



<a name="252834270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252834270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252834270">(Sep 10 2021 at 19:04)</a>:</h4>
<p><span class="user-mention" data-user-id="191351">@Chris Grenz</span> - Hmmm... If the logical model is defined in your IG, then you can directly refer to it by name:</p>
<div class="codehilite"><pre><span></span><code>Logical: WidgetLogicalType
// ...

Logical: Basket
* contents 0..* WidgetLogicalType &quot;Widgets in the basket&quot;
</code></pre></div>
<p>If the logical model is outside of your IG, then it ideally should exist in one of your declared dependencies.  If it does, then the alias approach should work as long as the URL is correct.  You can also use the name/id of the logical model (again, only if it is in one of your declared dependency packages).</p>
<p>If the logical model is outside of your IG <em>and</em> it is not in one of your dependencies, then SUSHI will not process it because it doesn't know how to apply it.  <code>ElementDefinition.type</code> has <code>code</code>, <code>profile</code>, and <code>targetProfile</code> properties -- and those get populated differently depending on what the target type is (LM, profile, etc). SUSHI needs to be able to resolve the URL to a definition to determine what it is and how it gets encoded into the <code>ElementDefinition.type</code> -- but if the alias doesn't point to something inside the IG or its dependencies, SUSHI can't resolve it to a definition.</p>
<p>All that said, there is a hack you could apply to get what you want (maybe I should have led with that?).  Basically declare a supported type first and then use a caret rule to overwrite the type in the <code>ElementDefinition</code>.  E.g.:</p>
<div class="codehilite"><pre><span></span><code>Alias: WidgetLogicalType = http://example.com/far/far/away/widget

Logical: Basket
// Initially declare w/ a supported type to meet SUSHI&#39;s syntax requirements
* contents 0..* Element &quot;Widgets in the basket&quot;
// Then use a caret rule to overwrite the type in the element
* contents ^type.code = WidgetLogicalType
</code></pre></div>
<p><a href="https://fshschool.org/FSHOnline/#/share/3hmGk86">Above example in FSH Online</a></p>
<p>But... if you try to constrain anything in the WidgetLogicalType, you'll run into problems again since SUSHI doesn't know anything about that type at all if it isn't in your IG or dependencies.</p>



<a name="252835245"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252835245" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252835245">(Sep 10 2021 at 19:12)</a>:</h4>
<p>I'm not sure I'm convinced that a URL in type.code would create problems in creating the JSON StructureDefinition. You don't need any information about the type to refer to it. If you constrain it, yes. If you extend it, yes. But not just to give an element a type...</p>



<a name="252835401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252835401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252835401">(Sep 10 2021 at 19:13)</a>:</h4>
<p>Effectively<br>
<code>* contents 0..* http://example.com/far/far/away/widget</code><br>
should just act like the "hack" IMO. No error unless you "go inside" the type you can't resolve.</p>



<a name="252835490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252835490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252835490">(Sep 10 2021 at 19:14)</a>:</h4>
<p>In any case, thank you!</p>



<a name="252844280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252844280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252844280">(Sep 10 2021 at 20:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191351">Chris Grenz</span> has marked this topic as resolved.</p>



<a name="252845835"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/252845835" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#252845835">(Sep 10 2021 at 20:29)</a>:</h4>
<p>Maybe I did not explain myself well.  Let me try again...</p>
<p>If the type of an element is a logical model or resource, then its URL goes in <code>type.code</code>.  But if the type of an element is a profile, then the profile's base type goes in <code>type.code</code> and the profile URL goes in <code>type.profile</code>.   If I only have a URL, I do not know if it is a profile, so I do not know if the URL goes in <code>type.code</code> or <code>type.profile</code> (and if the latter, then without a definition, I have no idea what should go in <code>type.code</code>).</p>
<p>For example, consider the (intentionally strange) FSH below:</p>
<div class="codehilite"><pre><span></span><code>Alias: QuantityType = http://hl7.org/fhir/StructureDefinition/Quantity
Alias: SimpleQuantityType = http://hl7.org/fhir/StructureDefinition/SimpleQuantity

Logical: MyLogical
* quantity 0..1 QuantityType &quot;Quantity&quot;
* simpleQuantity 0..1 SimpleQuantityType &quot;SimpleQuantity&quot;
</code></pre></div>
<p>The resulting <code>quantity</code> element has <code>"type": { "code": "Quantity" }</code>.</p>
<p>The resulting <code>simpleQuantity</code> element has <code>"type": { "code": "Quantity", "profile": ["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"] }</code>.</p>
<p>If SUSHI blindly put URLs just in <code>target.code</code>, then <code>simpleQuantity</code> would be wrong.  It needs to know the definition behind the URL to distinguish where the URL goes in the <code>type</code>.</p>
<p>The above example can be loaded in FSH Online <a href="https://fshschool.org/FSHOnline/#/share/3hmbaOc">here</a>, but if you prefer an example that does not use core FHIR types, I've also made a contrived example with LM's <a href="https://fshschool.org/FSHOnline/#/share/3tuYzx1">here</a> that also shows why the details of the type being assigned to the element matters.</p>



<a name="253106756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/%E2%9C%94%20Custom%20type%20in%20Logical%20Model/near/253106756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/.E2.9C.94.20Custom.20type.20in.20Logical.20Model.html#253106756">(Sep 13 2021 at 15:15)</a>:</h4>
<p>Thanks Chris - makes sense. I'd still default to just taking the value as <code>type.code</code> if it can't be resolved to open up the default case, maybe with a warning.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
