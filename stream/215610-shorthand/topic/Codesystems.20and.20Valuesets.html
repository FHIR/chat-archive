---
layout: page
title: "FHIR Chat  · Codesystems and Valuesets · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html">Codesystems and Valuesets</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="194499488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194499488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194499488">(Apr 17 2020 at 21:02)</a>:</h4>
<p>I'm not sure where to post this, but I thought I'd start here since I'm using FSH/Sushi, but it could also be because of my limited understanding of codesystems and valuesets in general. I have a toy IG that binds a value to a valueset, but the publisher doesn't seem to recognize it. I tried to create a codesystem in IG that it refers to, but doesn't seem to help. I keep getting </p>
<blockquote>
<p>None of the codes provided are in the value set <a href="http://example.org/ig/vscs/ValueSet/hla-geneid-valueset" title="http://example.org/ig/vscs/ValueSet/hla-geneid-valueset">http://example.org/ig/vscs/ValueSet/hla-geneid-valueset</a> (<a href="http://example.org/ig/vscs/ValueSet/hla-geneid-valueset" title="http://example.org/ig/vscs/ValueSet/hla-geneid-valueset">http://example.org/ig/vscs/ValueSet/hla-geneid-valueset</a>), and a code from this value set is required) (codes = <a href="http://www.genenames.org/geneId#HGNC:4931" title="http://www.genenames.org/geneId#HGNC:4931">http://www.genenames.org/geneId#HGNC:4931</a>)</p>
</blockquote>
<p>and </p>
<blockquote>
<p>The code system "<a href="http://www.genenames.org/geneId" title="http://www.genenames.org/geneId">http://www.genenames.org/geneId</a>" is not known (encountered paired with code = "HGNC:4931"); The code provided (<a href="http://www.genenames.org/geneId#HGNC:4931" title="http://www.genenames.org/geneId#HGNC:4931">http://www.genenames.org/geneId#HGNC:4931</a>) is not valid in the value set All codes known to the system for "<a href="http://www.genenames.org/geneId#HGNC:4931" title="http://www.genenames.org/geneId#HGNC:4931">http://www.genenames.org/geneId#HGNC:4931</a>"</p>
</blockquote>
<p>I posted the published IG at <a href="http://fhir.b12x.org/ig/vscs" title="http://fhir.b12x.org/ig/vscs">http://fhir.b12x.org/ig/vscs</a>, and you can see the <a href="http://fhir.b12x.org/ig/vscs/qa.html" title="http://fhir.b12x.org/ig/vscs/qa.html">qa.html</a>.</p>
<p>Here's <a href="/user_uploads/10155/K0zHPaeHy7SNR-UDL0Qge4yo/vscs.fsh" title="vscs.fsh">my fsh file</a> </p>
<p>Any insight will be appreciated.</p>



<a name="194501605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194501605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194501605">(Apr 17 2020 at 21:23)</a>:</h4>
<p>I don't really know anything about the gene-related terminologies, so forgive me if these questions are naive, but...</p>
<p>The FHIR spec already defines a code system for HGNC with the canonical url: <code>http://www.genenames.org</code> (see <a href="http://hl7.org/fhir/R4/terminologies-systems.html#genetics" title="http://hl7.org/fhir/R4/terminologies-systems.html#genetics">CS doc</a>).  Is there a reason you are not using that?  Is it different?</p>
<p>FHIR also defines a value set for all codes in the HGNC code system.  The canonical url for that value set is: <code>http://hl7.org/fhir/ValueSet/genenames</code> (see <a href="http://hl7.org/fhir/R4/valueset-genenames.html" title="http://hl7.org/fhir/R4/valueset-genenames.html">VS doc</a>). Again, is that different than the VS you're trying to define?</p>



<a name="194502211"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194502211" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194502211">(Apr 17 2020 at 21:29)</a>:</h4>
<p>Also note, however, that if you look at the doc for the genenames value set, you'll also see "Error from server: Unable to provide support for code system <a href="http://www.genenames.org" title="http://www.genenames.org">http://www.genenames.org</a>" -- so I guess it is expected that the FHIR publication tooling doesn't support that value set.  You can suppress these expected errors by adding the warning messages to your <code>ig-data/input/ignoreWarnings.txt</code> file (as <a href="https://github.com/FHIR/sample-ig/blob/master/input/ignoreWarnings.txt" title="https://github.com/FHIR/sample-ig/blob/master/input/ignoreWarnings.txt">demonstrated in the sample-ig</a>).</p>



<a name="194502323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194502323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194502323">(Apr 17 2020 at 21:30)</a>:</h4>
<p>yeah, those need to be updated. <code>www.genenames.org</code> isn't specific enough. We need to distinguish be gene names (codes that have a HGNC: prefix) and gene groups (codes without a prefix). The Clinical Genomics workgroup is using <code>http://www.genenames.org/geneIds</code> and <code>http://www.genenames/genegroup</code> in the <a href="http://hl7.org/fhir/uv/genomics-reporting/valueset-hgnc.html" title="http://hl7.org/fhir/uv/genomics-reporting/valueset-hgnc.html">Genomics-Reporting IG</a></p>



<a name="194502398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194502398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194502398">(Apr 17 2020 at 21:31)</a>:</h4>
<p>I thought that if I created codesystems in the IG, it would find them there and use them.<br>
<span class="user-mention" data-user-id="191451">@Patrick Werner</span></p>



<a name="194502794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194502794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194502794">(Apr 17 2020 at 21:34)</a>:</h4>
<p>Ah.  OK.  So... here is what I think is happening w/ the code system you defined in the IG... You forced the canonical URL to be <code>http://www.genenames.org/geneId</code>, which is outside of your IG's canonical URL base.  But when you reference the code system in your value set by name, SUSHI is assuming the default canonical URL for that system instead (which would be <code>{ig-canonical}/CodeSystem/{code-system-id}</code>) instead of the external canonical you overrode it with.</p>



<a name="194503225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194503225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194503225">(Apr 17 2020 at 21:38)</a>:</h4>
<p>At one point, defining a CodeSystem in an IG with a canonical URL outside of that IG's canonical URL was discouraged (or even not supported).  I'm not sure if that's still the case or not -- but I noticed the publisher didn't actually complain about <em>that</em>, so maybe it is OK now.  Let me see if I can tweak your FSH to make something work.  If not, and if this is actually a FHIR-supported scenario, we'll need to update SUSHI so it doesn't assume that all CodeSystems defined in the IG actually use the IG canonical URL.</p>



<a name="194503507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194503507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194503507">(Apr 17 2020 at 21:40)</a>:</h4>
<p>ok, thanks!  I touched on this subject in <a href="#narrow/stream/179252-IG-creation/topic/Use.20of.20NamingSystem.20in.20an.20IG.3F" title="#narrow/stream/179252-IG-creation/topic/Use.20of.20NamingSystem.20in.20an.20IG.3F">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Use.20of.20NamingSystem.20in.20an.20IG.3F</a> where it sounded like Lloyd was saying it was okay.</p>



<a name="194506259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194506259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194506259">(Apr 17 2020 at 22:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191469">Chris Moesel</span> <a href="#narrow/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets/near/194503225" title="#narrow/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets/near/194503225">said</a>:</p>
<blockquote>
<p>At one point, defining a CodeSystem in an IG with a canonical URL outside of that IG's canonical URL was discouraged (or even not supported).  I'm not sure if that's still the case or not -- but I noticed the publisher didn't actually complain about <em>that</em>, so maybe it is OK now.  Let me see if I can tweak your FSH to make something work.  If not, and if this is actually a FHIR-supported scenario, we'll need to update SUSHI so it doesn't assume that all CodeSystems defined in the IG actually use the IG canonical URL.</p>
</blockquote>
<p>I think that update will be essential - unless you are referring to CodeSystem resources that are only used within the domain of a particular, project-based IG and are 'owned' by that project. In reality the canonical URL of a Code System is likely to have a base endpoint belonging to the owner of that Code System and that organisation may well not be the publisher of the IG - e.g. a national medicines terminology, or other code systems owned by public authorities.</p>
<p>Further thoughts <span class="user-mention" data-user-id="191321">@David Hay</span> ?</p>



<a name="194506670"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194506670" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194506670">(Apr 17 2020 at 22:13)</a>:</h4>
<p>I found that the <a href="https://confluence.hl7.org/display/FHIR/Implementation+Guide+Parameters" title="https://confluence.hl7.org/display/FHIR/Implementation+Guide+Parameters">Implementation Guide Parameters</a> doc defines a parameter called <code>special-url</code> with this description:</p>
<blockquote>
<p>If a canonical resource in the IG should actually have a URL that isn't the one implied by the canonical URL for the IG itself, it must be listed here explicitly (as well as defined in the resource itself). It must be listed here to stop it accidentally being different. Each canonical url must be listed in full as present on the resource; it is not possible to specify a pattern.</p>
</blockquote>
<p>So... it seems that if we set that parameter in the ImplementationGuide JSON w/ the special canonical for the code system, that it _should_ work.  But... I tried that an it seemed to make no difference as far as I could tell.</p>



<a name="194507910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194507910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194507910">(Apr 17 2020 at 22:27)</a>:</h4>
<p>Well, I've been creating codesystems and specifying the url (which we need in our implementation) - and the IG publisher doesn't seem to complain...</p>



<a name="194508025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194508025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194508025">(Apr 17 2020 at 22:29)</a>:</h4>
<p><span class="user-mention" data-user-id="191364">@Peter Jordan</span> said:</p>
<blockquote>
<p>I think that update will be essential - unless you are referring to CodeSystem resources that are only used within the domain of a particular, project-based IG and are 'owned' by that project. In reality the canonical URL of a Code System is likely to have a base endpoint belonging to the owner of that Code System and that organisation may well not be the publisher of the IG - e.g. a national medicines terminology, or other code systems owned by public authorities.</p>
</blockquote>
<p>Just to ensure we're all on the same page -- we're talking about <em>defining</em> the content of external code systems not referencing or using external code systems.</p>
<p>I think the question is more of a human one than a technical one: should it be easy for IG authors to define resources that represent concepts that do not belong to the IG (or any of its authors), and furthermore should it be easy for them to assign those resource definitions canonical URLs using the real code system owner's domain as their base?  Isn't that kind of a form of domain squatting, but in the standards space?</p>
<p>Or on the other end of the spectrum, what if the owner of the codes doesn't care, so five different IGs all publish different versions of that code system but every single one uses the same canonical URL?  Isn't that a recipe for disaster?</p>
<p>Sorry... I think I'm getting philosophical now!  But anyway, sticking strictly to the technical bit of this, it feels like the <code>special-url</code> IG parameter should all for this, but that doesn't seem to be working when I try it.  Either that or the publisher isn't checking to see if Code Systems are defined in the IG before asking the tx server about them.</p>



<a name="194508156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194508156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194508156">(Apr 17 2020 at 22:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191321">David Hay</span> <a href="#narrow/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets/near/194507910" title="#narrow/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets/near/194507910">said</a>:</p>
<blockquote>
<p>Well, I've been creating codesystems and specifying the url (which we need in our implementation) - and the IG publisher doesn't seem to complain...</p>
</blockquote>
<p>Is that because they are all have a base URL of <a href="https://standards.digital.health.nz/" title="https://standards.digital.health.nz/">https://standards.digital.health.nz/</a> ?</p>



<a name="194508439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194508439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194508439">(Apr 17 2020 at 22:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191469">Chris Moesel</span> <a href="#narrow/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets/near/194508025" title="#narrow/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets/near/194508025">said</a>:</p>
<blockquote>
<p>Just to ensure we're all on the same page -- we're talking about <em>defining</em> the content of external code systems not referencing or using external code systems.</p>
</blockquote>
<p>Thanks for the swift reply <span class="user-mention" data-user-id="191469">@Chris Moesel</span> . I suspected that we might be on separate pages, but it would make more sense to me if you were talking about defining the content of internal (to the IG) code systems. I'm not sure how you'd go about doing that for external Code Systems. In an IG you're more likely to be defining subsets of an external Code System in ValueSet resources.</p>



<a name="194508774"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194508774" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194508774">(Apr 17 2020 at 22:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span></p>



<a name="194510088"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194510088" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194510088">(Apr 17 2020 at 22:59)</a>:</h4>
<p>Nope - I assign the url directly to the one - eg, in the Codesystem definition I have the following</p>
<blockquote>
<ul>
<li>^url = <a href="https://standards.digital.health.nz/cs/dhb" title="https://standards.digital.health.nz/cs/dhb">https://standards.digital.health.nz/cs/dhb</a></li>
</ul>
</blockquote>
<p>The base Url for the IG is <a href="http://hl7.org.nz/fhir/StructureDefinition/NHI" title="http://hl7.org.nz/fhir/StructureDefinition/NHI">http://hl7.org.nz/fhir/StructureDefinition/NHI</a></p>



<a name="194518945"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194518945" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194518945">(Apr 18 2020 at 01:18)</a>:</h4>
<p>The canonical URLs of code systems are allowed to diverge from the base URL of your value set, but I believe you need to set a special extension to have the publisher not yell at you.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ?</p>



<a name="194625556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194625556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194625556">(Apr 20 2020 at 00:50)</a>:</h4>
<p>catching up on this:</p>
<ul>
<li>the canonical URL can be different from the base. But you have to say that you know what you are doing by using the <code>special-url</code> parameter. No extension necessary</li>
<li>it doesn't need to be easy to do it, but it does need to be possible. </li>
<li>FMG will usually review any that are different to ensure that some of the policy concerns <span class="user-mention" data-user-id="191469">@Chris Moesel</span> raised are being handled ok</li>
<li>looking back at what Bob is doing... sounds like it should be discussed on the terminology track to see what should be done. Typically, these gene terminologies are very large, and you can't simply define them </li>
<li>more likely, I'll need to do implementation work on <a href="http://tx.fhir.org" title="http://tx.fhir.org">tx.fhir.org</a> to support these kinds of terminologies</li>
<li>I don't know what this means</li>
</ul>
<blockquote>
<p>that doesn't seem to be working when I try it</p>
</blockquote>



<a name="194674516"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194674516" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194674516">(Apr 20 2020 at 13:29)</a>:</h4>
<blockquote>
<p>that doesn't seem to be working when I try it</p>
</blockquote>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> -- I assumed that if Bob defined a code system in the IG w/ URL <code>http://www.genenames.org/geneId</code> and the codes were enumerated in that CodeSystem definition, <em>and</em> he added <code>http://www.genenames.org/geneId</code> as a <code>special-url</code> in the IG parameters, that the IG publisher would <em>not</em> complain about not supporting the <code>http://www.genenames.org/geneId</code> CodeSystem since it is fully defined in the IG (e.g., not an external dependency).  But... when I tried it, the IG Publisher still complained about it.</p>



<a name="194674739"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194674739" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194674739">(Apr 20 2020 at 13:31)</a>:</h4>
<p>what was the complaint?</p>



<a name="194845391"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194845391" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194845391">(Apr 21 2020 at 18:44)</a>:</h4>
<p>I tried editing the <code>ImplemenationGuide-vscs.json</code> file that sushi created, by adding this to <code>definition.parameter</code></p>
<div class="codehilite"><pre><span></span>      {
        &quot;code&quot;: &quot;special-url&quot;,
        &quot;value&quot;: &quot;http://www.genenames.org/geneId&quot;
      }
</pre></div>


<p>but the <a href="http://fhir.b12x.org/ig/vscs/qa.html" title="http://fhir.b12x.org/ig/vscs/qa.html">qa.html</a> file still contained the same errors.</p>



<a name="194846796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194846796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194846796">(Apr 21 2020 at 18:56)</a>:</h4>
<p>I also added an additional <code>special-url</code> for <code>http://glstring.org</code>, but again no change in the <code>qa.html</code> file generated by the publisher.</p>
<div class="codehilite"><pre><span></span>      {
        &quot;code&quot;: &quot;special-url&quot;,
        &quot;value&quot;: &quot;http://www.genenames.org/geneId&quot;
      },
      {
        &quot;code&quot;: &quot;special-url&quot;,
        &quot;value&quot;: &quot;http://glstring.org&quot;
      }
</pre></div>



<a name="194853220"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194853220" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194853220">(Apr 21 2020 at 19:56)</a>:</h4>
<p>that should work ( the first one). I'll have to debug</p>



<a name="194853283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194853283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194853283">(Apr 21 2020 at 19:56)</a>:</h4>
<p>how do I do that?</p>



<a name="194855306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194855306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194855306">(Apr 21 2020 at 20:12)</a>:</h4>
<p>You can find the build files of this example here. <br>
<a href="https://github.com/bmilius-nmdp/fshing/tree/master/test/build" title="https://github.com/bmilius-nmdp/fshing/tree/master/test/build">https://github.com/bmilius-nmdp/fshing/tree/master/test/build</a><br>
The <code>input/ImplementationGuide-vscs.json</code> file was hand-edited after sushi generated it.</p>



<a name="194868946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194868946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194868946">(Apr 21 2020 at 22:18)</a>:</h4>
<p>ok so I fixed one issue, but you have two issues remaining:</p>
<ul>
<li>Code System URI "<a href="http://glstring.org" title="http://glstring.org">http://glstring.org</a>" is unknown so the code cannot be validated - because you defined it as <a href="http://www.glstring.org" title="http://www.glstring.org">http://www.glstring.org</a></li>
<li>None of the codes provided are in the value set <a href="http://example.org/ig/vscs/ValueSet/hla-geneid-valueset" title="http://example.org/ig/vscs/ValueSet/hla-geneid-valueset">http://example.org/ig/vscs/ValueSet/hla-geneid-valueset</a> - looks like you need to update the system value in that value set
*</li>
</ul>



<a name="194880527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194880527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194880527">(Apr 22 2020 at 01:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Thank you! </p>
<ul>
<li>I fixed the system in the valueset and don't see the "<a href="http://glstring.org" title="http://glstring.org">http://glstring.org</a>" warning anymore. </li>
<li>I still get the  2 errors. When you said you fixed one issue, will this be in the next release of the publisher?</li>
</ul>



<a name="194880667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194880667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194880667">(Apr 22 2020 at 01:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> I had to change the system in the valueset from <code>http://example.org/ig/vscs/CodeSystem/hla-genename-codesystem</code>to <code>http://www.genenames.org/geneId</code> in valueset SD to get rid of the warning msg. This was generated by sushi. I did set it in my fsh file, but it looks like sushi overwrote it.</p>



<a name="194880779"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194880779" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194880779">(Apr 22 2020 at 01:43)</a>:</h4>
<p>yes next release</p>



<a name="194928381"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194928381" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194928381">(Apr 22 2020 at 13:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191916">@ Bob Milius</span> said:</p>
<blockquote>
<p>This was generated by sushi. I did set it in my fsh file, but it looks like sushi overwrote it.</p>
</blockquote>
<p>I'm looking at the FSH you posted before and I think I see the issue (if it's the same as you're using now):</p>
<div class="codehilite"><pre><span></span>ValueSet:  HLAGeneIdVS
Title: &quot;HLA Gene Name Value Set&quot;
Id: hla-geneid-valueset
Description:  &quot;HLA HGNC GeneIds Valueset&quot;
* codes from system HGNCGeneIdCS
* HLAGeneIdCS#HGNC:4931   &quot;HLA-A&quot;
* HLAGeneIdCS#HGNC:4932   &quot;HLA-B&quot;
* HLAGeneIdCS#HGNC:4933   &quot;HLA-C&quot;
// ... cut out the rest
</pre></div>


<p>This line references the external value set and essentially says the VS is comprised of <em>all codes</em> from that value set:</p>
<div class="codehilite"><pre><span></span>* codes from system HGNCGeneIdCS
</pre></div>


<p>That's fine, but then you also have lines like this:</p>
<div class="codehilite"><pre><span></span>* HLAGeneIdCS#HGNC:4931   &quot;HLA-A&quot;
</pre></div>


<p>This says to <em>also include</em> this specific code, but note that the CodeSystem you reference here is the alias <code>HLAGeneIdCS</code> which points to your <em>local</em> definition of the code system.  So SUSHI is putting that local CS in the VS because you individually specified codes from the local CS.  I expect that if you look at the exported VS, it actually contains references to both the external code system <em>and</em> the local one.</p>



<a name="194939225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194939225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194939225">(Apr 22 2020 at 14:28)</a>:</h4>
<p>Yes, you're right. Here's a snippet my exported VS.</p>
<div class="codehilite"><pre><span></span>...snip...
  &quot;url&quot;: &quot;http://example.org/ig/vscs/ValueSet/hla-geneid-valueset&quot;,
  &quot;compose&quot;: {
    &quot;include&quot;: [
      {
        &quot;system&quot;: &quot;http://www.genenames.org/geneId&quot;
      },
      {
        &quot;system&quot;: &quot;http://example.org/ig/vscs/CodeSystem/hla-genename-codesystem&quot;,
        &quot;concept&quot;: [
          {
            &quot;code&quot;: &quot;HGNC:4931&quot;,
            &quot;display&quot;: &quot;HLA-A&quot;
          },
...snip...
</pre></div>


<p>I removed the <code>* codes from system HGNCGeneIdCS</code> line from the fsh file and sushi removed the first <code>"system": "http://www.genenames.org/geneId"</code> and left the local system. </p>
<div class="codehilite"><pre><span></span>...snip...
&quot;url&quot;: &quot;http://example.org/ig/vscs/ValueSet/hla-geneid-valueset&quot;,
  &quot;compose&quot;: {
    &quot;include&quot;: [
      {
        &quot;system&quot;: &quot;http://example.org/ig/vscs/CodeSystem/hla-genename-codesystem&quot;,
        &quot;concept&quot;: [
          {
            &quot;code&quot;: &quot;HGNC:4931&quot;,
            &quot;display&quot;: &quot;HLA-A&quot;
          },
...snip...
</pre></div>


<p>But now I have to edit that system to <code>http://www.genenames.org/geneId</code> to remove the qa warning for the example. How do I tell sushi to use that in the VS? The CS I have is a local fragment of the <code>http://www.genenames.org/geneId</code>.  (Sorry for what I'm sure are naive questions)</p>



<a name="194943929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194943929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194943929">(Apr 22 2020 at 14:58)</a>:</h4>
<p>I'm not 100% sure I understand what you're looking to do...  I <em>think</em> you're wanting to use a local CodeSystem definition to define an external code system (w/ an external canonical URL) and then create a value set of all the codes defined there?  Is that right?</p>



<a name="194949859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194949859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194949859">(Apr 22 2020 at 15:39)</a>:</h4>
<p>Yes, and also to have the publisher/validator not produce errors with an proper example. I edited the <code>system</code> in the VS to <code>http://genenames.org/geneId</code>, ran publisher, and posted the output <a href="http://fhir.b12x.org/ig/vscs/index.html" title="http://fhir.b12x.org/ig/vscs/index.html">here</a>. You can see the <a href="http://fhir.b12x.org/ig/vscs/ValueSet-hla-geneid-valueset.html" title="http://fhir.b12x.org/ig/vscs/ValueSet-hla-geneid-valueset.html">VS</a> has found the local fragment of the <a href="http://fhir.b12x.org/ig/vscs/CodeSystem-hla-genename-codesystem.html" title="http://fhir.b12x.org/ig/vscs/CodeSystem-hla-genename-codesystem.html">CS</a>, and even populated the definitions which weren't in the VS structuredefinition. The <a href="http://fhir.b12x.org/ig/vscs/qa.html" title="http://fhir.b12x.org/ig/vscs/qa.html">qa.html</a> still shows errors though. <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> said he fixed something in the publisher, but I don't think it's in the current release.</p>



<a name="194951711"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194951711" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194951711">(Apr 22 2020 at 15:53)</a>:</h4>
<p>btw, I just tried removing the individual codes from the VS fsh, and only use the <code>* codes from system HGNCGeneIdCS</code>. That worked in removing the warning without further editing of the VS, and the expansion from the local CS is seen in the <a href="http://fhir.b12x.org/ig/vscs2/ValueSet-hla-geneid-valueset.html" title="http://fhir.b12x.org/ig/vscs2/ValueSet-hla-geneid-valueset.html">rendered page</a>, so that may be the way to go. But the same errors are still in the <a href="http://fhir.b12x.org/ig/vscs2/qa.html" title="http://fhir.b12x.org/ig/vscs2/qa.html">qa.html</a>.</p>



<a name="194959882"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Codesystems%20and%20Valuesets/near/194959882" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Codesystems.20and.20Valuesets.html#194959882">(Apr 22 2020 at 16:54)</a>:</h4>
<p>OK.  I think there may be somewhere in our code that assumes a locally defined CS has a URL based on the IG canonical -- so it's also possible you've run into that during one of these variations of your FSH code.  I'm going to file an issue for us to look into that.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
