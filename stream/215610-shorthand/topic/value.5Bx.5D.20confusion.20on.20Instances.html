---
layout: page
title: "FHIR Chat  · value[x] confusion on Instances · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html">value[x] confusion on Instances</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="226310538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226310538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226310538">(Feb 14 2021 at 15:46)</a>:</h4>
<p>I got a weird issue with constrains on value[x] in an Extension. What i did:</p>
<ul>
<li>created a Profile on Money for Euro: <a href="https://simplifier.net/erezeptabgabedaten/dav-pr-erp-preisangabeeur">https://simplifier.net/erezeptabgabedaten/dav-pr-erp-preisangabeeur</a></li>
<li>used this in an Extension: <a href="https://simplifier.net/erezeptabgabedaten/davexerpkostenversicherter">https://simplifier.net/erezeptabgabedaten/davexerpkostenversicherter</a> (extension[Kostenbetrag].value[x])</li>
</ul>
<p>When now trying to create Instances on these sushi converts this:</p>
<div class="codehilite"><pre><span></span><code>* lineItem[=].priceComponent.extension[KostenVersicherter].extension[Kostenbetrag].valueMoney.value = 5.00
* lineItem[=].priceComponent.extension[KostenVersicherter].extension[Kostenbetrag].valueMoney.currency = #EUR
</code></pre></div>
<p>to this:</p>
<div class="codehilite"><pre><span></span><code>                   &quot;extension&quot;: [
                      {
                        &quot;url&quot;: &quot;Kategorie&quot;,
                        &quot;valueCodeableConcept&quot;: {
                          &quot;coding&quot;: [
                            {
                              &quot;code&quot;: &quot;0&quot;
                            }
                          ]
                        }
                      },
                      {
                        &quot;url&quot;: &quot;Kostenbetrag&quot;,
                        &quot;value[x]&quot;: {
                          &quot;currency&quot;: &quot;EUR&quot;
                        },
                        &quot;valueMoney&quot;: {
                          &quot;currency&quot;: &quot;EUR&quot;,
                          &quot;value&quot;: 5
                        }
                      }
                    ]
</code></pre></div>



<a name="226310559"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226310559" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226310559">(Feb 14 2021 at 15:47)</a>:</h4>
<p>i think the value[x] should be valueMoney in the Instance. Is this a bug? Or am i missing smth?</p>



<a name="226373695"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226373695" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226373695">(Feb 15 2021 at 11:45)</a>:</h4>
<p>Tried to replicate with defining the extension and profile in FSH, works:<br>
<a href="https://fshschool.org/FSHOnline/#/share/2N78gko">https://fshschool.org/FSHOnline/#/share/2N78gko</a></p>



<a name="226373698"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226373698" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226373698">(Feb 15 2021 at 11:45)</a>:</h4>
<p>will dig deeper</p>



<a name="226380495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226380495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226380495">(Feb 15 2021 at 12:57)</a>:</h4>
<p>Changed the fhs created Example to a complex extension -&gt; no change.<br>
<a href="https://fshschool.org/FSHOnline/#/share/3jRrZAt">https://fshschool.org/FSHOnline/#/share/3jRrZAt</a></p>



<a name="226380538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226380538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226380538">(Feb 15 2021 at 12:58)</a>:</h4>
<p>FSH seemst to work, i think this is some side effect from another issue</p>



<a name="226386860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226386860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226386860">(Feb 15 2021 at 13:56)</a>:</h4>
<p>And i managed to reproduce! :<br>
<a href="https://fshschool.org/FSHOnline/#/share/2Zhcys3">https://fshschool.org/FSHOnline/#/share/2Zhcys3</a></p>



<a name="226387137"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226387137" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226387137">(Feb 15 2021 at 13:59)</a>:</h4>
<p>I agree that the first output (w/ <code>value[x]</code> in the instance) definitely looks wrong.  But if we cannot reproduce it, it will be hard to fix it.  First things first -- are you running the latest version of SUSHI?</p>



<a name="226387201"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226387201" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226387201">(Feb 15 2021 at 13:59)</a>:</h4>
<p>Oh!  Our messages crossed paths.  I see you reproduced it now!</p>



<a name="226387829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226387829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226387829">(Feb 15 2021 at 14:04)</a>:</h4>
<p>Actually... that's not reproducing the same problem, is it?  I don't see any <code>value[x]</code> in the instance.  What I do see is an error about cardinality, which actually seems to be caused by a different issue: the top-level "test" extension in the instance is missing the extension URL.  This is a different bug that we're aware of and currently working on.</p>



<a name="226387910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226387910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226387910">(Feb 15 2021 at 14:04)</a>:</h4>
<p><del><a href="https://github.com/FHIR/sushi/issues/751">SUSHI #751</a></del></p>
<p><em>EDIT: Nope.  Not the same issue at 751.  I looked at it too quickly.  The real problem is that the two FSH statements that should be modifying the same instance of <code>valueMoney</code> are actually creating/modifying two separate extensions.  That's a new bug (but still not the same as the one originally reported).</em></p>



<a name="226387932"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226387932" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226387932">(Feb 15 2021 at 14:05)</a>:</h4>
<p>ah you are right, i'll keep investigating</p>



<a name="226389378"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226389378" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226389378">(Feb 15 2021 at 14:19)</a>:</h4>
<p>Logged the new double-extension issue as <a href="https://github.com/FHIR/sushi/issues/759">SUSHI#759</a>.</p>



<a name="226391915"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226391915" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226391915">(Feb 15 2021 at 14:43)</a>:</h4>
<p>Alright.  I just reproduced the <code>value[x]</code> bug by bringing in your exact profile definitions (as JSON) and then creating a FSH Instance that uses them.  I haven't had time to look into it -- but I guess it may have to do specifically w/ how the extension is defined. <a href="/user_uploads/10155/8rZ-tP-SNMMctnJLrLngAPrj/ValueXBug.zip">ValueXBug.zip</a></p>



<a name="226392175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226392175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226392175">(Feb 15 2021 at 14:45)</a>:</h4>
<p>thats also my current guess. Thanks for the "confirmation" <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="226399773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/value%5Bx%5D%20confusion%20on%20Instances/near/226399773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/value.5Bx.5D.20confusion.20on.20Instances.html#226399773">(Feb 15 2021 at 15:52)</a>:</h4>
<p>Alright, and that bug is now tracked as <a href="https://github.com/FHIR/sushi/issues/760">SUSHI#760</a>.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
