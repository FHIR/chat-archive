---
layout: page
title: "FHIR Chat  · Proposal: Indent Blocks · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html">Proposal: Indent Blocks</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="229783720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229783720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229783720">(Mar 11 2021 at 02:41)</a>:</h4>
<p>We've previously discussed the idea of supporting path-based context for rules via keywords such as <code>with</code> and modified rule markers such as <code>**</code>, <code>***</code>, etc. But... we never quite felt we had landed on the right solution. Over the past few weeks, we've continued to iterate over different syntaxes trying to find the best solution -- and <em>now</em> have something to propose. We think that those of you who enjoy YAML (ahem, <span class="user-mention" data-user-id="191401">@Eric Haas</span>) will probably like this proposal. We're interested in what the rest of you think (and you too, Eric).</p>
<p>In short, the proposal is to indicate path context and structure via indented blocks of rules.  As an example, these FSH STU1 rules:</p>
<div class="codehilite"><pre><span></span><code>* name 1..*
* name.given 1..*
* name.family 1..1
* active 1..1
</code></pre></div>
<p>could be written using "indent blocks" like this:</p>
<div class="codehilite"><pre><span></span><code>* name 1..*
  * given 1..*
  * family 1..1
* active 1..1
</code></pre></div>
<p>This means whitespace before <code>*</code> becomes <em>significant</em>, but we like it because it reminds us of markdown lists (with nested items) and, as previously noted, YAML.</p>



<a name="229783910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229783910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229783910">(Mar 11 2021 at 02:44)</a>:</h4>
<p>We also propose using this syntax to expand the <code>CodeSystem</code> grammar to allow access to other concept properties (<code>e.g., designation</code>) and to author hierarchical code systems.  Using a <em>very abbreviated</em> version of US Core's <a href="http://www.hl7.org/fhir/us/core/CodeSystem-cdcrec.html">Race &amp; Ethnicity CDC</a> code system, for example:</p>
<div class="codehilite"><pre><span></span><code>CodeSystem: RaceAndEthnicityCDC
* ^property.code = #abstract
* ^property.description = &quot;True if an element is considered &#39;abstract&#39;&quot;
* ^property.type = #boolean
* #1000-9 &quot;Race&quot; &quot;Race, Note that this is an abstract &#39;grouping&#39; concept and not for use as a real concept&quot;
  * ^property.code = #abstract
  * ^property.valueBoolean = true
  * #1002-5 &quot;American Indian or Alaska Native&quot; &quot;American Indian or Alaska Native&quot;
    * #1004-1 &quot;American Indian&quot; &quot;American Indian&quot;
    * #1735-0 &quot;Alaska Native&quot; &quot;Alaska Native&quot;
  * #2028-9 &quot;Asian&quot; &quot;Asian&quot;
    * #2029-7 &quot;Asian Indian&quot; &quot;Asian Indian&quot;
    * #2030-5 &quot;Bangladeshi&quot; &quot;Bandgladeshi&quot;
* #2133-7 &quot;Ethnicity&quot; &quot;Ethnicity Note that this is an abstract &#39;grouping&#39; concept and not for use as a real concept&quot;
  * ^property.code = #abstract
  * ^property.valueBoolean = true
  * #2135-2 &quot;Hispanic or Latino&quot; &quot;Hispanic or Latino&quot;
    * #2137-8 &quot;Spaniard&quot; &quot;Spaniard&quot;
    * #2148-5 &quot;Mexican&quot; &quot;Mexican&quot;
  * #2186-5 &quot;Not Hispanic or Latino&quot; &quot;&quot;&quot;
      Note that this term remains in the table for completeness, even though within HL7, the notion of
      &quot;not otherwise coded&quot; term is deprecated.
      &quot;&quot;&quot;
</code></pre></div>



<a name="229783982"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229783982" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229783982">(Mar 11 2021 at 02:45)</a>:</h4>
<p>For a more complete description and further examples, see our <a href="https://github.com/HL7/fhir-shorthand/wiki/Proposed-STU2-Feature:-Indent-Blocks">Proposed STU2 Feature: Indent Blocks</a> wiki page.</p>



<a name="229856143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229856143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229856143">(Mar 11 2021 at 14:25)</a>:</h4>
<p>Can we change to 4spaces/1 tab (despite Eric's love for YAML)?  That's a convention far beyond YAML and makes life easier for users.</p>



<a name="229856313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229856313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229856313">(Mar 11 2021 at 14:26)</a>:</h4>
<p>In general, like this proposal.  It makes things easier on everyone.</p>



<a name="229857500"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229857500" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229857500">(Mar 11 2021 at 14:33)</a>:</h4>
<p>YAML actually is not prescriptive about the number of spaces (it's up to the author and YAML interpreters just adjust to what they see) -- so in that way, variable spaces would be more like YAML.  OTOH, YAML specifically forbids tabs.</p>
<p>I think 2 spaces vs 4 spaces is definitely a personal preference.  I exclusively use 2 spaces for all markup style languages (and many non-markup languages) -- and I know I'm not alone.  So I'd personally lean more toward making it flexible (so authors can use their preference) rather than changing the requirement from 2 to 4 spaces outright.  Thanks for the feedback!</p>



<a name="229858682"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229858682" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229858682">(Mar 11 2021 at 14:40)</a>:</h4>
<p>+1 on 2</p>



<a name="229874648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229874648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229874648">(Mar 11 2021 at 16:05)</a>:</h4>
<p>I'm not a fan of languages like YAML that depend on spaces to infer meaning.   In many editors it's hard to see spaces (vs tabs) and it seems somewhat 'obscure' to depend on spacing/indentation to imply meaning.  Is there something that could be used that is more obvious?</p>



<a name="229874874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229874874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229874874">(Mar 11 2021 at 16:06)</a>:</h4>
<p>obviously not a Python programmer! :)</p>



<a name="229875394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229875394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229875394">(Mar 11 2021 at 16:08)</a>:</h4>
<p>Yeh, did one of those online "Learn Python" classes and felt the spacing stuff made learning the language more painful that it should be! ;-).  (Yes, a good language-sensitive editor can help but WHY depend on white space that's 'invisible'?)</p>



<a name="229876374"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229876374" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229876374">(Mar 11 2021 at 16:11)</a>:</h4>
<p>I think it makes sense and it more Markdown like than YAML like and who doesn't embrace markdown.  It makes is a bit more readable too IMO</p>



<a name="229892288"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229892288" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229892288">(Mar 11 2021 at 17:35)</a>:</h4>
<p>indentation or <code>** </code>are fine for me. I'll get used to either (would prefer **)</p>



<a name="229892373"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229892373" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229892373">(Mar 11 2021 at 17:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> in your analysis you mention ambiguous or nonsensical indexing - did you find a case for ambiguity?</p>



<a name="229892632"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229892632" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229892632">(Mar 11 2021 at 17:36)</a>:</h4>
<p>(that was the reason for the<code>with</code> - to avoid ambiguity.)</p>



<a name="229899726"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229899726" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229899726">(Mar 11 2021 at 18:19)</a>:</h4>
<p>Here's an example: If I have a questionnaire,</p>
<div class="codehilite"><pre><span></span><code>* item[+].id = &quot;question1&quot;
* item[+].id = &quot;question2&quot;
* item[+].item[+].id = &quot;question2-1&quot;
* item[+].item[+].item[+].id = &quot;question2-1-1&quot;
* item[+].item[+].item[+].item[+].id = &quot;question2-1-1-1&quot;
* item[+].item[+].id = &quot;question2-2&quot;
</code></pre></div>
<p>How would this look like?</p>
<div class="codehilite"><pre><span></span><code>* item[+]
  *id = &quot;question1&quot;
  * item[+]
    * id = &quot;question2&quot;
    * item[+]
      * id = &quot;question2-1&quot;
      * item[+]
        * id = &quot;question2-1-1&quot;
        * item[+]
          * id = &quot;question2-1-1-1&quot;
  * item[+]
    * id = &quot;question2-2&quot;
</code></pre></div>



<a name="229902210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229902210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229902210">(Mar 11 2021 at 18:35)</a>:</h4>
<p>I like the proposal and find it interesting (or telling, depending on your point of view) that most of the discussion so far is about whitespace, rather than the meat of the change. I also like the related insert rules change.</p>



<a name="229902654"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229902654" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229902654">(Mar 11 2021 at 18:37)</a>:</h4>
<p>The one thing I note is that you introduce the situation of having an element name without saying anything further about it. Is there a requirement that if you have</p>
<div class="codehilite"><pre><span></span><code>* item
</code></pre></div>
<p>that there must be an indent block after it?</p>



<a name="229902783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229902783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229902783">(Mar 11 2021 at 18:38)</a>:</h4>
<p><span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> -- Since question 1 and question 2 are siblings, they should be at the same indent level (i.e., question 2 is not a child of question 1).  So if I were to write your original FSH using the new indent block syntax, I would write it as:</p>



<a name="229903656"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229903656" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229903656">(Mar 11 2021 at 18:43)</a>:</h4>
<p>Wait, <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> .  Actually, I'm not sure your original FSH is really what you want, I think you have a few too many <code>[+]</code> in there.  I think you want some of those to be<code>[=]</code>.  So, if the original FSH is:</p>
<div class="codehilite"><pre><span></span><code>* item[+].id = &quot;question1&quot;
* item[+].id = &quot;question2&quot;
* item[=].item[+].id = &quot;question2-1&quot;
* item[=].item[=].item[+].id = &quot;question2-1-1&quot;
* item[=].item[=].item[=].item[+].id = &quot;question2-1-1-1&quot;
* item[=].item[+].id = &quot;question2-2&quot;
</code></pre></div>
<p>then the indented version is:</p>
<div class="codehilite"><pre><span></span><code>* item[+].id = &quot;question1&quot;
* item[+]
  * id = &quot;question2&quot;
  * item[+]
    * id = &quot;question2-1&quot;
    * item[+]
      * id = &quot;question2-1-1&quot;
      * item[+].id = &quot;question2-1-1-1&quot;
  * item[+].id = &quot;question2-2&quot;
</code></pre></div>
<p>or if you choose to just use indenting even where there is only one child (which is technically not necessary but maybe you like the consistency) then:</p>
<div class="codehilite"><pre><span></span><code>* item[+]
  * id = &quot;question1&quot;
* item[+]
  * id = &quot;question2&quot;
  * item[+]
    * id = &quot;question2-1&quot;
    * item[+]
      * id = &quot;question2-1-1&quot;
      * item[+]
        * id = &quot;question2-1-1-1&quot;
  * item[+]
    * id = &quot;question2-2&quot;
</code></pre></div>



<a name="229903975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229903975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229903975">(Mar 11 2021 at 18:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191380">Elliot Silver</span> <a href="#narrow/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks/near/229902654">said</a>:</p>
<blockquote>
<p>The one thing I note is that you introduce the situation of having an element name without saying anything further about it. Is there a requirement that if you have</p>
<div class="codehilite"><pre><span></span><code>* item
</code></pre></div>
<p>that there must be an indent block after it?</p>
</blockquote>
<p>Without a following indent block, that rule would essentially be a no-op.  I'm not sure if we would <em>disallow</em> it, but it's probably worthy of a warning since it adds no value.</p>



<a name="229905341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229905341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229905341">(Mar 11 2021 at 18:54)</a>:</h4>
<p>Makes sense. What about:</p>
<div class="codehilite"><pre><span></span><code>* item[+]
</code></pre></div>



<a name="229906063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229906063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229906063">(Mar 11 2021 at 18:59)</a>:</h4>
<p>Ha.  Yeah, I guess that is <em>not</em> a no-op, and perhaps some authors might prefer to use a rule <em>only</em> to increment an index (and then use <code>item[=]</code> in rules after).   I hadn't thought of that, but it seems valid.</p>



<a name="229907243"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229907243" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229907243">(Mar 11 2021 at 19:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="298707">John Silva</span> <a href="#narrow/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks/near/229874648">said</a>:</p>
<blockquote>
<p>I'm not a fan of languages like YAML that depend on spaces to infer meaning.   In many editors it's hard to see spaces (vs tabs) and it seems somewhat 'obscure' to depend on spacing/indentation to imply meaning.  Is there something that could be used that is more obvious?</p>
</blockquote>
<p>Yeah, I get that -- meaningful whitespace can be a controversial topic.  I'm also not a fan in many contexts, but in some cases it feels more natural than others.  This seems like a tangent, but... In last week's HL7 CDS Workgroup meeting, someone shared a Word document with a draft of the MetadataResource in it.  We were already narrowing in on proposing indents for structure -- but looking at this document confirmed that it is a <em>natural</em> way that people think about and sketch out these things.  In fact, I was very surprised to realize that the structure looked <em>almost exactly</em> like it would in FSH if we combined the logical model and indent block proposals.  I just had to take a screenshot: <br>
<a href="/user_uploads/10155/T1se-0-OJcO-MKBbGXD_osgy/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/T1se-0-OJcO-MKBbGXD_osgy/image.png" title="image.png"><img src="/user_uploads/10155/T1se-0-OJcO-MKBbGXD_osgy/image.png"></a></div>



<a name="229907547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229907547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229907547">(Mar 11 2021 at 19:08)</a>:</h4>
<p>Ultimately we want FSH to feel natural.  We tried lots of things (multiple <code>*</code>, various <em>placeholders</em>, path aliases, etc) -- and in the end, this is what felt most natural to us.  But this is why we bring it to the community -- to see if it's <em>just us</em> or if others feel the same way.</p>



<a name="229907959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229907959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229907959">(Mar 11 2021 at 19:11)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> You are right, I had too many [+], some of them were [=].</p>



<a name="229907993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229907993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229907993">(Mar 11 2021 at 19:11)</a>:</h4>
<p>From a practical standpoint, many editors can be configured to show whitespace characters (in a <em>fairly</em> unobtrusive way).  But I'd also note that what we are proposing is an <em>optional</em> syntax.  Authors can still choose to use the long-form syntax.  (With one exception -- we didn't propose a long-form syntax for the new <code>CodeSystem</code> features yet, but I was actually just tossing around some ideas for that this morning).</p>



<a name="229908042"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229908042" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229908042">(Mar 11 2021 at 19:11)</a>:</h4>
<p>About the no-op, should we do the yaml thing and add a <code>:</code>?</p>



<a name="229908076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229908076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229908076">(Mar 11 2021 at 19:11)</a>:</h4>
<p>or it's the indentation that will work?</p>



<a name="229908186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229908186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229908186">(Mar 11 2021 at 19:12)</a>:</h4>
<p>The indentation is <em>enough</em> for us to correctly process it, but if we felt we wanted to require a <code>:</code> to make the author's intent clear ("I <em>meant</em> to do this") then I think that's a possibility.</p>



<a name="229908204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229908204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229908204">(Mar 11 2021 at 19:12)</a>:</h4>
<p>danger with indentation is that IDEs sometimes think they know the indentation we want. And Python suffers a bit with that.</p>



<a name="229908324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229908324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229908324">(Mar 11 2021 at 19:13)</a>:</h4>
<p>Ok the <code>: </code> is more to give a sense of what we are going to do next, so that when copy-pasting lines the whole thing still makes sense.</p>



<a name="229908348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229908348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229908348">(Mar 11 2021 at 19:13)</a>:</h4>
<p>i mean it as a suggestion</p>



<a name="229908473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229908473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229908473">(Mar 11 2021 at 19:14)</a>:</h4>
<p>Re: IDEs.  Yeah, that's a blessing and a curse.  Editor-assist for indentation can be really useful!  Sometimes it's nice to hit enter and have it already be indented for me.  But yeah, that also means the editor is guessing what you want -- and sometimes you really want to outdent.</p>



<a name="229909803"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/229909803" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#229909803">(Mar 11 2021 at 19:23)</a>:</h4>
<p>The good (?) thing about indents in this context (vs python) is that most incorrect indents would be caught by SUSHI because they often result in invalid paths.  My issue w/ space-sensitive programming languages is that I always ended up messing up the scope of my for-loops, and those errors were never apparent until runtime (if at all).  Luckily FSH wouldn't suffer from that as much (although <code>item</code> is arguably one place where you could run into that).</p>



<a name="230588531"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230588531" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230588531">(Mar 16 2021 at 20:48)</a>:</h4>
<p>Just bumping this up one more time to see if there is any more feedback.  If not, this is a Standard for <em>Trial</em> Use after all, so perhaps we will just <em>try</em> it to see how it works out (possibly adjusting for the feedback we've received so far).  As with any HL7 standard, it will need to go through ballot before it is official anyway.  But still, we like to get things right the first time since we have active users who <em>will</em> integrate these features into their IGs <em>before</em> ballot.  So... anyone else have thoughts?</p>



<a name="230589786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230589786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230589786">(Mar 16 2021 at 20:56)</a>:</h4>
<p>"So... anyone else have thoughts?" or "So... anyone have more thoughts?" ? <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="230589967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230589967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230589967">(Mar 16 2021 at 20:57)</a>:</h4>
<p>I'd make sure there's no chance for ambiguity to be a problem in the future (on nested elements in questionnaires,  plandefinitions, etc)</p>



<a name="230591619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230591619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230591619">(Mar 16 2021 at 21:08)</a>:</h4>
<p>Ha.  <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> -- I'm interested in further thoughts if you have them too -- but so far only 7 people have weighed in at all and I'd love to get some additional data points and perspectives.</p>



<a name="230592608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230592608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230592608">(Mar 16 2021 at 21:15)</a>:</h4>
<p>:) For me it's fine, and I think it's good to have insight from more people.</p>



<a name="230597178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230597178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ryan moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230597178">(Mar 16 2021 at 21:53)</a>:</h4>
<p>personally I'm not sure if I'll actually use it because I'm not a huge fan of indentation levels as code rather than ease-of-eyes formatting, but I see the draw so I have no reason to stop this from happening. Regardless of that I had a couple questions I've been stewing on</p>
<p>if how much whitespace means one indent is dependent on how the author uses said whitespace, does this run into any issues with rulesets injecting in code? can one ruleset be used in different indentation levels? how would that look if yes? if no could you pass in the amount of whitespace to use as a base in a parameter? could that be inherited based on how much whitespace is before an "insert" rule?<br>
how do multi-line strings work with these indentations? does the opening stay indented and the rest just sit weirdly left-aligned? (now looking at the spec thus-far you should be able to indent as much as you want and just have the shared indent removed during processing so it shouldn't be an issue)<br>
And also I feel like this got answered but I can't find it anymore, is space the only whitespace character allowed for these indents? or would tab work too? (and if so what happens if you have mixed space+tab indents? an error? an assumed conversion rate?)</p>



<a name="230599472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230599472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230599472">(Mar 16 2021 at 22:05)</a>:</h4>
<p>Good point <span class="user-mention" data-user-id="237342">@ryan moehrke</span> <br>
I think the impact on rules and multiline strings should be clarified. <br>
For tabs / spaces, I would follow the yaml rule - no tabs</p>



<a name="230633679"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/230633679" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#230633679">(Mar 17 2021 at 03:46)</a>:</h4>
<p>I think the behavior presented for rules was that the rule invocation inherits the indent level of where it is inserted. </p>
<p>I would hypothesize that It isn't possible for rule contents to be less indented than where it was invoked. And, that It is possible to indent further within a rule, but it is never (irrespective of use of rule) permissible to skip indent levels.</p>
<p>I have a certain reluctance around whitespace-sensitive languages too, but I recognize that FSH is already in that category, so am willing to embrace it.</p>



<a name="241642691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/241642691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Kramer <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#241642691">(Jun 05 2021 at 15:49)</a>:</h4>
<p>Just to bring this thread to a satisfying close, this feature has been added to SUSHI 2.0 and is now available, with description <a href="http://build.fhir.org/ig/HL7/fhir-shorthand/reference.html#indented-rules">located here</a>. Thank you all for the very vigorous and helpful discussion.</p>



<a name="242514854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242514854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242514854">(Jun 13 2021 at 14:55)</a>:</h4>
<p>I can't make indentation work with rules.</p>



<a name="242514896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242514896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242514896">(Jun 13 2021 at 14:56)</a>:</h4>
<p>has this been considered as part of the previous discussion?</p>



<a name="242514926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242514926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242514926">(Jun 13 2021 at 14:56)</a>:</h4>
<p>here's one example which tries too hard to get indentation and rule working:<br>
<a href="https://fshschool.org/FSHOnline/#/share/35hnIQk">https://fshschool.org/FSHOnline/#/share/35hnIQk</a></p>



<a name="242514979"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242514979" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242514979">(Jun 13 2021 at 14:57)</a>:</h4>
<p>I may be missing something. If not, I think this language feature should include these cases. As a language, FSH should be consistent, right?</p>



<a name="242515021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242515021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242515021">(Jun 13 2021 at 14:58)</a>:</h4>
<p>Perhaps it is just the parser that does not do anything yet, but what are the FHIR Shorthand rules around this?</p>



<a name="242591193"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242591193" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242591193">(Jun 14 2021 at 12:51)</a>:</h4>
<p>Indentation is not supposed to work in that context. From the <a href="http://build.fhir.org/ig/HL7/fhir-shorthand/branches/master/reference.html#indented-rules">spec</a>:</p>
<blockquote>
<p>The full path of all rules is resolved from the context specified by indentation before any rules are applied.</p>
</blockquote>
<p>This means that indentation is resolved <em>before</em> an <code>insert</code> rule is applied.</p>



<a name="242593918"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242593918" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242593918">(Jun 14 2021 at 13:10)</a>:</h4>
<p>We felt it would be too confusing to have RuleSets with rules that <em>start</em> indented -- because they're so far from the context in which they are used.  That said, we have discussed the possibility of allowing the <code>insert</code> rule itself to be indented to indicate that's the context in which the RuleSet rules should be applied.  I see you tried to do that at the end of your example; so that's something that we might (probably will) address.</p>



<a name="242597400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242597400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242597400">(Jun 14 2021 at 13:35)</a>:</h4>
<p>Something to consider though is that in the example <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span>  linked it looks like he wanted to use the rules from one <code>insert</code> rule to set the context in the second <code>insert</code> rule. I'm not sure exactly how that fits into the possibility <span class="user-mention" data-user-id="191469">@Chris Moesel</span>  mentioned. And I'm interested to hear what you think about that case Chris.</p>



<a name="242613042"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242613042" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242613042">(Jun 14 2021 at 15:17)</a>:</h4>
<p><span class="user-mention" data-user-id="239822">@Nick Freiter</span> - Ah, I don't think I realized that was what he was going for.  I think that RuleSets should not "leak" context; i.e., any context in the RuleSet ends at the end of the RuleSet.  That way when you're looking at a set of rules with <code>insert</code> rules, it's still easy to see the overall structure without needing to know the details of the RuleSet being applied.  I think it would be confusing otherwise.  So... I think the part of the spec you quoted above still applies.</p>



<a name="242613284"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242613284" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242613284">(Jun 14 2021 at 15:19)</a>:</h4>
<p>But maybe we need to call that out even more explicitly in the spec so it is crystal clear.  Since we sometimes refer to <code>insert</code> like <em>copy-pasting</em> the RuleSet right in place, I can see why there might be confusion.</p>



<a name="242653236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242653236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242653236">(Jun 14 2021 at 20:13)</a>:</h4>
<p>this may be a better example:<br>
<a href="https://fshschool.org/FSHOnline/#/share/3zowzxv">https://fshschool.org/FSHOnline/#/share/3zowzxv</a></p>



<a name="242653252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242653252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242653252">(Jun 14 2021 at 20:13)</a>:</h4>
<p>I should not have indented things inside the ruleset</p>



<a name="242653343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242653343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242653343">(Jun 14 2021 at 20:14)</a>:</h4>
<p>but my purpose is to add an insert inside another insert</p>



<a name="242653359"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242653359" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242653359">(Jun 14 2021 at 20:14)</a>:</h4>
<p>so indent the calling of rulesets</p>



<a name="242655379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242655379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242655379">(Jun 14 2021 at 20:32)</a>:</h4>
<p>Yes, <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span>, if I understand your example correctly, this is something we hope to support as part of STU2; we just have not got there yet.  But I think in real use, we would simplify your example even further to something like this, right? <a href="https://fshschool.org/FSHOnline/#/share/3xkbaDR">https://fshschool.org/FSHOnline/#/share/3xkbaDR</a></p>



<a name="242658648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242658648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242658648">(Jun 14 2021 at 21:02)</a>:</h4>
<p>yes, that's it. In my original idea I had 2 attempts at doing that. The simpler one is the one that would work best.</p>



<a name="242658658"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242658658" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242658658">(Jun 14 2021 at 21:02)</a>:</h4>
<p>Is that compatible with the syntax defined?</p>



<a name="242662151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242662151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242662151">(Jun 14 2021 at 21:35)</a>:</h4>
<p>Right now, the spec on <a href="http://build.fhir.org">build.fhir.org</a> says that you cannot indent <code>insert</code> rules, because thus far, insert rules have not been allowed to be applied to specific paths (e.g., right now <code>insert</code> rules are always "path-less").  The indent syntax <em>would</em> allow for what I showed in the example linked above, but first we need to introduce a form of <code>insert</code> that allows for insertion at a path, and then we can extend the specification of the indent syntax to leverage that.</p>



<a name="242662377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242662377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242662377">(Jun 14 2021 at 21:37)</a>:</h4>
<p><strong>No.  Wait.  I take that back.</strong> Sorry, I was a bit distracted and hadn't fully thought through that.  My example above is not quite right because it still leverages paths introduced by the insert rule above it.  We don't (and likely won't) allow that.  Let me draft a better example for you.</p>



<a name="242662916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242662916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242662916">(Jun 14 2021 at 21:42)</a>:</h4>
<p>Since <code>item</code> is actually the thing that is variable (could be any level deep), it's best to actually not include that in the RuleSet definition, but rather specify it as part of the path to which the RuleSet is applied.  E.g.: <a href="https://fshschool.org/FSHOnline/#/share/35jTe03">https://fshschool.org/FSHOnline/#/share/35jTe03</a></p>



<a name="242666778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242666778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242666778">(Jun 14 2021 at 22:28)</a>:</h4>
<p>looks almost like a "with" statement but on the other end :)</p>



<a name="242666877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242666877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242666877">(Jun 14 2021 at 22:30)</a>:</h4>
<p>so instead of putting the context in the beginning as I was thinking for the with, you pass the context when calling the rule?</p>



<a name="242666922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242666922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242666922">(Jun 14 2021 at 22:30)</a>:</h4>
<p>i.e. the logic for this is:</p>



<a name="242667181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242667181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242667181">(Jun 14 2021 at 22:33)</a>:</h4>
<p>the insert rule takes its context from where it is called, if there is an explicit declaration of context.<br>
<code>* insert Rule(a,b,c)</code> - there's no context, so this is top level<br>
<code>* context insert Rule(a,b,c)</code> there is a context here, so the parser will determine that context and then apply the rule<br>
<code>   * context insert Rule(a,b,c)</code> there is a context and indentation here, so the parser will determine where that context applies and then apply the rule</p>



<a name="242667186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242667186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242667186">(Jun 14 2021 at 22:33)</a>:</h4>
<p>is that what you mean?</p>



<a name="242667960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242667960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242667960">(Jun 14 2021 at 22:43)</a>:</h4>
<p>I think there may still a problem with this: won't the insert of a ruleset create a context itself? What happens?<br>
<a href="https://fshschool.org/FSHOnline/#/share/2TptEEh">https://fshschool.org/FSHOnline/#/share/2TptEEh</a></p>



<a name="242731168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242731168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242731168">(Jun 15 2021 at 13:23)</a>:</h4>
<p>If we do add support for paths in an <code>insert</code> rule, the context for subsequent rules indented below an <code>insert</code> rule will take their context from the explicit path on that <code>insert</code> rule, <em>not</em> from the implicit paths being inserted. So in this example:</p>
<div class="codehilite"><pre><span></span><code>* item[0] insert Question(patient,Patient,group,false)
  * item[0] insert Question(status,IndentedStatus,group,false)
</code></pre></div>
<p>It is equivalent to saying:</p>
<div class="codehilite"><pre><span></span><code>* item[0] insert Question(patient,Patient,group,false)
* item[0].item[0] insert Question(status,IndentedStatus,group,false)
</code></pre></div>
<p>The paths are resolved <em>before</em> applying the <code>insert</code> rule, so the insert of the <code>RuleSet</code> does not create any context.</p>



<a name="242791593"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242791593" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242791593">(Jun 15 2021 at 20:05)</a>:</h4>
<p>I think that rule makes sense</p>



<a name="242791745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242791745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242791745">(Jun 15 2021 at 20:06)</a>:</h4>
<p>as for the syntax, wouldn't it be better to delimit the context?</p>



<a name="242791869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242791869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242791869">(Jun 15 2021 at 20:07)</a>:</h4>
<p>in the example, <code>item[0]</code> is not a keyword, so perhaps isolate that? as in </p>
<div class="codehilite"><pre><span></span><code>* item[0]: insert Question(patient,Patient,group,false)
  * item[0]: insert Question(status,IndentedStatus,group,false)
</code></pre></div>



<a name="242792066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242792066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242792066">(Jun 15 2021 at 20:08)</a>:</h4>
<p>that would also help in those rare cases where the attribute has the same name as a fsh keyword</p>



<a name="242952252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242952252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242952252">(Jun 16 2021 at 22:38)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span>.  TBH, I'm not sure if the trailing <code>:</code> adds much.  Other rules w/ infix keywords don't use it (e.g., <code>identifier obey inv-2</code>, <code>component contains systolic 1..1</code>). I also don't think we need the <code>:</code> to disambiguate anything in the grammar (even in the rare case of a path named <code>insert</code>).  So... I feel like it would be easier for users to remember if it just did the same as other rules: <code>path keyword value(s)</code>.  E.g.:</p>
<div class="codehilite"><pre><span></span><code>* item[0] insert Question(patient,Patient,group,false)
  * item[0] insert Question(status,IndentedStatus,group,false)
</code></pre></div>



<a name="242952661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/242952661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#242952661">(Jun 16 2021 at 22:42)</a>:</h4>
<p>For anyone who wants to track this, this capability is (more or less) covered by <a href="https://github.com/FHIR/sushi/issues/828">SUSHI#828</a>.</p>



<a name="249825613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/249825613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#249825613">(Aug 18 2021 at 09:29)</a>:</h4>
<p>How do I use indentation here?<br>
<a href="https://fshschool.org/FSHOnline/#/share/3k3gjeD">https://fshschool.org/FSHOnline/#/share/3k3gjeD</a></p>



<a name="249826187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/249826187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#249826187">(Aug 18 2021 at 09:36)</a>:</h4>
<p>I am trying to indent a process.step inside  another process.step, not inside the process.step.operation</p>



<a name="249847025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/249847025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#249847025">(Aug 18 2021 at 13:15)</a>:</h4>
<p>Here is an <a href="https://fshschool.org/FSHOnline/#/share/37QUMjF">example</a> that matches yours, but used indentation to nest a <code>process.step</code> inside <code>process.step</code>. A similar pattern could be followed with the rest of the file. The indented part starts on line 65</p>



<a name="249901492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Proposal%3A%20Indent%20Blocks/near/249901492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Proposal.3A.20Indent.20Blocks.html#249901492">(Aug 18 2021 at 19:38)</a>:</h4>
<p>great. I thought that every line would need to assign a value to a property. if not, that solves the issue. <br>
Thanks!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
