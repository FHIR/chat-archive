---
layout: page
title: "FHIR Chat  · Accessing meta attributes · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html">Accessing meta attributes</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="210164601"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210164601" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210164601">(Sep 15 2020 at 17:53)</a>:</h4>
<p>I'm trying to create a profile of Observation that requires the instance declare conformance with a particular profile:</p>
<div class="codehilite"><pre><span></span><code>* meta.profile[0] = Canonical(MyObservation)
</code></pre></div>


<p>But this line is failing with:</p>
<div class="codehilite"><pre><span></span><code>Sushi: error No element found at path meta.profile[0] for SpecializedObservation, skipping rule (00:04.0512)
</code></pre></div>


<p>Can I access meta elements in sushi? Interestingly, <code>^meta.profile</code> doesn't give an error, but I believe that sets the meta for the profile itself (ie. the StructureDefinition), not on instances of the profile.</p>
<p>(I know I should do this with slicing rather than hardcoding the slots -- I'll get to that once I've proved the concept.)</p>



<a name="210165309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210165309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210165309">(Sep 15 2020 at 17:58)</a>:</h4>
<p>It's not great practice to force the declaration to be in a specific order.  It would be better to assert meta.where(profile=foo) - so that the assertion can be in any position.  Otherwise, you're going to force people to expose custom instances to each recipient.  As a rule, if order doesn't have a defined semantic meaning, profiles should be tolerant of desired data appearing in any order.</p>



<a name="210165591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210165591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210165591">(Sep 15 2020 at 18:00)</a>:</h4>
<p>Agree. And I'll change this to slicing shortly, but for now, it was failing on simply trying to set meta.profile.</p>



<a name="210180496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210180496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210180496">(Sep 15 2020 at 19:46)</a>:</h4>
<p><span class="user-mention" data-user-id="191380">@Elliot Silver</span> -- Lloyd's concerns aside, from a <em>technical</em> standpoint, it seems that what you're attempting to do <em>should</em> be supported.  So, this appears to be a bug in SUSHI.  I've file <a href="https://github.com/FHIR/sushi/issues/601">#601</a> for this one.</p>



<a name="210253782"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210253782" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210253782">(Sep 16 2020 at 12:29)</a>:</h4>
<p>I think this one may not be a bug. If you are writing this line:</p>
<div class="codehilite"><pre><span></span><code>* meta.profile[0] = Canonical(MyObservation)
</code></pre></div>


<p>on a <code>Profile</code>, it is expected that SUSHI would not find <code>meta.profile[0]</code>, because on a <code>Profile</code>, you cannot constrain specific array elements by their numerical index. You could set up an ordered slicing if you truly wanted to constrain the first element to be <code>Canonical(MyObservation)</code>.</p>



<a name="210256191"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210256191" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210256191">(Sep 16 2020 at 12:50)</a>:</h4>
<p>Yes, of course, <span class="user-mention" data-user-id="239822">@Nick Freiter</span> is right.  Brain lapse on my part.  As Lloyd said, however, an <em>ordered</em> slice is probably not ideal, so you probably want something like this:</p>
<div class="codehilite"><pre><span></span><code>Profile: MyObservation
Parent: Observation
* meta.profile ^slicing.discriminator.path = &quot;$this&quot;
* meta.profile ^slicing.discriminator.type = #value
* meta.profile ^slicing.ordered = false
* meta.profile ^slicing.rules = #open
* meta.profile contains myobservation 1..1
* meta.profile[myobservation] = Canonical(MyObservation) (exactly)
</code></pre></div>



<a name="210460836"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210460836" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210460836">(Sep 17 2020 at 22:48)</a>:</h4>
<p>Thanks -- this looks like it works (with the correction that <code>Profile: MyObservation</code> and <code>Canonical(MyObservation)</code> should be different profiles).</p>
<p>Interestingly, the snapshot only shows the constraints applied in the MyObservation profile (i.e. the requirement to claim the base profile), and none of the constraints from the base profiles. That seems both right and wrong at the same time.</p>



<a name="210513417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210513417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210513417">(Sep 18 2020 at 12:52)</a>:</h4>
<p>What do you mean by "constraints" exactly?  What specifically from the base profile is not showing up?  (If it's a lot, you don't need to list it all, but a few examples would help).</p>



<a name="210536652"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210536652" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210536652">(Sep 18 2020 at 15:35)</a>:</h4>
<blockquote>
<p>Thanks -- this looks like it works (with the correction that Profile: MyObservation and Canonical(MyObservation) should be different profiles).</p>
</blockquote>
<p>So you want to have a profile that requires instances of it to declare that they conform to a <em>different</em> profile?  I guess that's possible, it's just not what I expected.</p>



<a name="210560165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210560165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210560165">(Sep 18 2020 at 18:45)</a>:</h4>
<blockquote>
<p>So you want to have a profile that requires instances of it to declare that they conform to a different profile? I guess that's possible, it's just not what I expected.</p>
</blockquote>
<p>Yes, what I'm trying to do is achieve multiple inheritance of profiles. Given profiles A and B based on Observation, I want a new profile C that incorporates both A and B. Profile C may or may not impose additional constraints. I've approached this by declaring the parent of C is Observation, and C requires instances to claim conformance to A and B.</p>
<blockquote>
<p>What do you mean by "constraints" exactly? What specifically from the base profile is not showing up? (If it's a lot, you don't need to list it all, but a few examples would help).</p>
</blockquote>
<p>Profile C displays that meta.profile is required include A and B, which is absolutely expected. What I'm not seeing are the constraints from A and B showing up in the display of C. As I said, I can see this makes perfect sense--all the C profile is requiring is that profiles A and B are claimed, not that the constraints of A and B are implemented. The fact that claiming A and B without meeting the constraints of A and B is a conformance error is separate from the display of the C profile. However, from an implementer's point of view, it would be helpful if display of the C profile showed the constraints imposed by A and B.</p>
<p>By the way, none of this are FSH or sushi issues. Also, based on comments from Lloyd in the IG stream, I may need to rethink the approach.</p>



<a name="210561222"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210561222" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210561222">(Sep 18 2020 at 18:54)</a>:</h4>
<p>Ah, OK.  Thanks for the clarification.  I get it now...  As you said, your profile C is really only requiring others <em>claim</em> conformance to A and B.  I didn't follow the other thread, but could the FHIRPath <code>conformsTo</code> function be used to more explicitly require this?  Something like <code>$this conformsTo('http://canonical/for/A') and $this.conformsTo('http://canonical/for/B')</code>?  I expect that still might be tricky for implementors though.</p>



<a name="210561823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210561823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210561823">(Sep 18 2020 at 18:59)</a>:</h4>
<p>Here is another approach, powered by RuleSets that might accomplish what you're looking for:</p>
<div class="codehilite"><pre><span></span><code>RuleSet: ConstraintsForA
* code from http://foo.org

Profile: A
Parent: Observation
* insert ConstraintsForA

RuleSet: ConstraintsForB
* value[x] only CodeableConcept

Profile: B
Parent: Observation
* insert ConstraintsForB

Profile: C
Parent: Observation
* insert ConstraintsForA
* insert ConstraintsForB
</code></pre></div>


<p>In this case, if you wanted to make the relationship explicit you could then add the <code>meta.profile</code> declarations -- but the constraints themselves force the relationship.</p>



<a name="210561998"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210561998" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210561998">(Sep 18 2020 at 19:01)</a>:</h4>
<p>In an early version of FSH we allowed profiles to act like RuleSets (so you could <code>insert A</code> directly), but I guess we dropped that.  I don't remember intentionally dropping it, but it's not in the spec and not supported by SUSHI.  Still, having the extra RuleSets isn't too bad.</p>



<a name="210562248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210562248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210562248">(Sep 18 2020 at 19:03)</a>:</h4>
<p>I thought about that before and it would work if we were publishing one IG that defined all of A, B, and C. However, the situation is a little more complex. I'm about to hop on a call -- I'll be back in a bit with details.</p>



<a name="210563264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210563264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210563264">(Sep 18 2020 at 19:12)</a>:</h4>
<p>Well, shoot.  You've reminded me of <em>why</em> we supported profiles as RuleSets in early versions of FSH.  We supported it precisely because we wanted people to be able to "mix in" profiles from regional IGs.  For example, you might want to base your <code>Condition</code> on a Condition profile defined in a clinical IG, but "mix in" constraints from US Core Condition to ensure you're aligned with US requirements.  That's only possible if we allow something like: <code>insert http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition</code>.</p>



<a name="210563441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210563441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210563441">(Sep 18 2020 at 19:14)</a>:</h4>
<p>And now I'm also remembering why we don't support it... because it's <em>hard</em>!  I think we decided to push it off and consider it for FSH STU2.</p>



<a name="210579134"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210579134" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210579134">(Sep 18 2020 at 21:48)</a>:</h4>
<p>That is exactly the situation I'm dealing with. There are existing profiles for a US project, based on US Core, published by a separate group We want to do an international project, not using US Core, covering much of the same ground. We are in discussion with the US project about how they could restructure to allow us to leverage their content. The way I've been visualizing this is they publish an abstract USBaseObservation profile, an abstract ClinicalObservation profile, and a concrete USClinicalObservation profile that "inherits" from both of those; we publish an abstract InternationalBaseObservation, and a concrete InternationalClinicalObservation that inherits from the InternationalBaseObservation and the ClinicalObservation profiles.</p>



<a name="210620413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210620413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210620413">(Sep 19 2020 at 15:25)</a>:</h4>
<p>some of that was done with core vitalsigns... What you need to do is propose these changes to the workgroup owning the resource to be profiled to create a FHIR core profile. Even a CR with your recommended FSH Profile would go a long way to making it happen.</p>



<a name="210622207"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210622207" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210622207">(Sep 19 2020 at 16:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span>,  I don’t understand. None of this work is being done inside HL7, and I don’t think we can influence already published US Core, but most importantly, I don’t know how to solve the multiple inheritance issue. I done think a new HL7 core profile changes anything.</p>



<a name="210625879"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210625879" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210625879">(Sep 19 2020 at 17:32)</a>:</h4>
<p>US-Core is a project within HL7</p>



<a name="210625895"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210625895" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210625895">(Sep 19 2020 at 17:32)</a>:</h4>
<p>and these are global profiles that are inside of core FHIR <a href="http://build.fhir.org/observation-profiles.html">http://build.fhir.org/observation-profiles.html</a></p>



<a name="210625909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210625909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210625909">(Sep 19 2020 at 17:33)</a>:</h4>
<p>I was just mentioning that if that is not enough, then you can propose more</p>



<a name="210625920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210625920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210625920">(Sep 19 2020 at 17:33)</a>:</h4>
<p>ANYONE can submit a CR to the FHIR Core</p>



<a name="210625971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210625971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210625971">(Sep 19 2020 at 17:34)</a>:</h4>
<p>I agree with all of those. But it doesn't address my issue.</p>



<a name="210626268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Accessing%20meta%20attributes/near/210626268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Accessing.20meta.20attributes.html#210626268">(Sep 19 2020 at 17:41)</a>:</h4>
<p>A third party is working on profiles derived from US Core. We want to do similar profiles, except not based on US Core. I'm looking for ways that the third party (who we are talking to) can structure one of their profiles to separate the "clinical" part from the US Core-base. We could then take that "clinical" part and mix it in with our "not-US core" content.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
