---
layout: page
title: "FHIR Chat  · need better error than null object · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html">need better error than null object</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="217902332"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217902332" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217902332">(Nov 25 2020 at 15:55)</a>:</h4>
<p>Please provide more information when this error is given. I am catching on that it is usually caused by a link to a missing  object, but what link?</p>
<div class="codehilite"><pre><span></span><code>Sushi: error SUSHI encountered the following unexpected error: Cannot convert undefined or null to object (00:08.0208)
</code></pre></div>



<a name="217909219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217909219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217909219">(Nov 25 2020 at 16:42)</a>:</h4>
<p>The problem is that this was an "unexpected" error, which usually means the error occurred in a low level of code, but we only caught it in higher-level error handling.  This particular error message does not come from SUSHI code, so it probably comes from Node.js or one of our dependency libraries.  So... we likely only have whatever information bubbled up with the error.</p>



<a name="217909365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217909365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217909365">(Nov 25 2020 at 16:44)</a>:</h4>
<p>If you can identify a specific use case (or line of FSH) that causes this error, and/or if you can provide a stack trace for it, we can investigate and see if we can catch it in the deeper code and provide a more useful error message.</p>



<a name="217909625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217909625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217909625">(Nov 25 2020 at 16:46)</a>:</h4>
<p>I think I see these errors most often on incorrect array indexes. (1, 2, 4,...)</p>



<a name="217913027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217913027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217913027">(Nov 25 2020 at 17:10)</a>:</h4>
<p>well, I am constantly confused by the array indexes...  that is what I am tracking down now</p>



<a name="217918473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217918473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217918473">(Nov 25 2020 at 17:55)</a>:</h4>
<p>FWIW I had this exact same error yesterday related to me messing up array indices -- specifically trying to assign <code>something[1]</code> when <code>something[0]</code> didn't exist.</p>



<a name="217920860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217920860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217920860">(Nov 25 2020 at 18:18)</a>:</h4>
<p>yes, would be nice to catch these with more helpful error message.... why sometimes starts at zero and other times starts at one?</p>



<a name="217922967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217922967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217922967">(Nov 25 2020 at 18:37)</a>:</h4>
<p>I think all indexes start at zero. </p>
<p>My problem is when moving things around I sometimes forget to renumber correctly. (It happens when you have an  80 element StructureDefinition with manually maintained numbering. )</p>



<a name="217923558"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217923558" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217923558">(Nov 25 2020 at 18:43)</a>:</h4>
<p>I am not sure it is that clear... the first one is not numbered, the second one is numbered 1... unless you number the first one, then you start at 1</p>



<a name="217923680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217923680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217923680">(Nov 25 2020 at 18:44)</a>:</h4>
<p>I actually hadn’t realized that you don’t need to number the first one. Any time I have a repeating element, I start with index 0.</p>



<a name="217923687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217923687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217923687">(Nov 25 2020 at 18:44)</a>:</h4>
<p>then if you have slices,you must use the slice identifier... and then what numbers do you use after that?</p>



<a name="217923754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217923754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217923754">(Nov 25 2020 at 18:45)</a>:</h4>
<p>Ooh, good question.</p>



<a name="217924398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217924398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217924398">(Nov 25 2020 at 18:51)</a>:</h4>
<p>I didn't think it mattered as long as they were sequential.  Is that not the case?</p>



<a name="217932996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217932996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Masnick <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217932996">(Nov 25 2020 at 20:07)</a>:</h4>
<p>I think the FSH team is considering a feature to dynamically assign indices rather than having to manually specify them, which would resolve this sort of problem</p>



<a name="217938790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217938790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217938790">(Nov 25 2020 at 21:01)</a>:</h4>
<p>I thought that made it into V1.0?  Oh well, good thing I didnt' test it</p>



<a name="217939759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217939759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217939759">(Nov 25 2020 at 21:09)</a>:</h4>
<ol>
<li>
<p>The soft-indexing feature that <span class="user-mention" data-user-id="322501">@Max Masnick</span> referred to is in the works but is not yet released.  As Max suggested, it will help w/ these issues a lot.</p>
</li>
<li>
<p>Indexes always start at <code>[0]</code>, but if you reference an array path and _don't_ include an index, then <code>[0]</code> is assumed.  This is to make statements like <code>*name.given = "Chris"</code> less awkward (vs. <code>* name[0].given[0] = "Chris"</code>)</p>
</li>
<li>
<p>Slices do make this interesting for sure.  If you have a slice that allows multiple cardinality, then you index into the slice's sub-section using indexes after the slicename.  E.g., <code>component[sliceA][0]</code>, <code>component[sliceA][1]</code>, <code>component[sliceB][0]</code>, etc.</p>
</li>
<li>
<p>In the example above, if you also want to add items that don't fit into a defined slice (so you can't reference them by name), I think you probably have to do math and figure out the right index to use.  Following from the example in (3) above, I think the next component is <code>component[3]</code>.</p>
</li>
<li>
<p>Thanks for hints regarding where to track down some of these unhelpful error messages.  We'll see what we can do about that.</p>
</li>
</ol>



<a name="217944935"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/217944935" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#217944935">(Nov 25 2020 at 22:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191469">Chris Moesel</span> <a href="#narrow/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object/near/217939759">said</a>:</p>
<blockquote>
<ol start="3">
<li>
<p>Slices do make this interesting for sure.  If you have a slice that allows multiple cardinality, then you index into the slice's sub-section using indexes after the slicename.  E.g., <code>component[sliceA][0]</code>, <code>component[sliceA][1]</code>, <code>component[sliceB][0]</code>, etc.</p>
</li>
<li>
<p>In the example above, if you also want to add items that don't fit into a defined slice (so you can't reference them by name), I think you probably have to do math and figure out the right index to use.  Following from the example in (3) above, I think the next component is <code>component[3]</code>.</p>
</li>
</ol>
</blockquote>
<p><span aria-label="scared" class="emoji emoji-1f628" role="img" title="scared">:scared:</span></p>



<a name="218132890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/218132890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#218132890">(Nov 27 2020 at 22:14)</a>:</h4>
<p>Along with detecting skipped array indices, it would be nice to detect repeated assignment and/or duplicated indices. For example, if I have the following line in my questionnaire twice, it is probably an error.</p>
<div class="codehilite"><pre><span></span><code>* item[4].item[2].type    =  ...
</code></pre></div>
<p>Two occurrences of this line likely mean: </p>
<ul>
<li>I've misnumbered something and the two occurrences should be referring to different items</li>
<li>The assigned values are identical, and one occurrence is therefore redundant</li>
<li>The assigned values are different, and one occurrence is therefore misleading.</li>
<li>It is an erroneous attempt to set multiple values in an array.</li>
</ul>
<p>Although I first thought of this in the array context, I don't see why it wouldn't also apply to any assignments.</p>
<p>I don't have a use case for why someone would want to have duplicate assignment, but I suggest only making this a warning, just in case.</p>



<a name="218227173"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/218227173" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#218227173">(Nov 29 2020 at 19:47)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191380">@Elliot Silver</span> -- I can think of one use case, but really it's almost more of an artifact of how SUSHI is implemented.  If a <code>RuleSet</code> has several rules, including assignments, then maybe someone would want to insert the rule set and then override one or more of the assignments.  Looking at the FSH where the rule set is used, you would not see the duplication -- but after expansion, it is there.  That said, we could probably be smart enough to detect that specific case and not warn on it.</p>



<a name="218227190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/need%20better%20error%20than%20null%20object/near/218227190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/need.20better.20error.20than.20null.20object.html#218227190">(Nov 29 2020 at 19:47)</a>:</h4>
<p>If this is a feature you would like, please feel free to log an issue over at <a href="https://github.com/FHIR/sushi/issues">https://github.com/FHIR/sushi/issues</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
