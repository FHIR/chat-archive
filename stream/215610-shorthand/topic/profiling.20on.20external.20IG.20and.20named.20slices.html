---
layout: page
title: "FHIR Chat  · profiling on external IG and named slices · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html">profiling on external IG and named slices</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="187535182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187535182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187535182">(Feb 06 2020 at 10:12)</a>:</h4>
<p>I'm trying to create a profile based on an external profile (genomics-reporting). So I add this to the package.json</p>
<div class="codehilite"><pre><span></span>&quot;dependencies&quot;: {
    &quot;hl7.fhir.r4.core&quot;: &quot;4.0.1&quot;,
    &quot;hl7.fhir.uv.genomics-reporting&quot;: &quot;1.0.0&quot;
  },
</pre></div>


<p>and then create a fsh file that requires a named slice of a component (gene-studied) that's optional in the parent profile.</p>
<div class="codehilite"><pre><span></span>Profile:        Mygenotype
Parent:         genotype
Id:             mygenotype
Title:          &quot;My Profile of Genotype Observation&quot;
Description:    &quot;Profiling genotype observation&quot;

* component contains gene-studied 1..1
</pre></div>


<p>Sushi runs without any error, but when I go to build the IG, I get a </p>
<div class="codehilite"><pre><span></span>Publishing Content Failed: Unable to generate snapshot for http://example.org/fhir/hla-reporting/StructureDefinition/mygenotype in /Users/bmilius/Documents/src/fsh/hla/build/input/resources/structuredefinition-mygenotype (00:17.0464)
</pre></div>


<p>that's rather uninformative. Am I doing something wrong?</p>



<a name="187548631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187548631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187548631">(Feb 06 2020 at 13:46)</a>:</h4>
<p>I can't speak to the IG publisher, but I think the FSH should be changed to:</p>
<div class="codehilite"><pre><span></span>Profile:        Mygenotype
Parent:         genotype
Id:             mygenotype
Title:          &quot;My Profile of Genotype Observation&quot;
Description:    &quot;Profiling genotype observation&quot;

* component[gene-studied] 1..1
</pre></div>


<p>Since the <code>gene-studied</code> slice already exists via the parent resource, you don't need to use the <code>contains</code> keyword, since that keyword is used to create slices. You can just directly access the slice and set its cardinality using the syntax shown above.</p>
<p>It looks like if you do use the <code>contains</code> keyword, we actually generate a new slice called <code>gene-studied</code> alongside the already existing slice, so you end up with two <code>gene-studied</code> slices. We should've been emitting an error to warn you this was happening incorrectly, so I'll track that as a bug in SUSHI.</p>



<a name="187584856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187584856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187584856">(Feb 06 2020 at 20:21)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="239822">@Nick Freiter</span>  That makes sense. I made the change but am still getting the IG publisher error.</p>



<a name="187585699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187585699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> May Terry <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187585699">(Feb 06 2020 at 20:31)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191916">@ Bob Milius</span> - have you included the profile name into the ImplementationGuide JSON file?  I think you need to manually configure that.  This file would be in the ./build/input directory.<br>
As an example, below is a snippet of how we included the mCODE <code>CancerGeneticVariant</code> profile in our ./build/input/ImplementationGuide-fhir.us.mcode.json file:  </p>
<div class="codehilite"><pre><span></span>        {
          &quot;reference&quot;: {
            &quot;reference&quot;: &quot;StructureDefinition/CancerGeneticVariant&quot;
          },
          &quot;name&quot;: &quot;Cancer Genetic Variant&quot;,
          &quot;description&quot;: &quot;Records an alteration in the most common DNA nucleotide sequence. The term variant can be used to describe an alteration that may be benign, pathogenic, or of unknown significance. The term variant is increasingly being used in place of the term mutation.&quot;,
          &quot;exampleBoolean&quot;: false
        }
</pre></div>



<a name="187586537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187586537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a>  Bob Milius <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187586537">(Feb 06 2020 at 20:41)</a>:</h4>
<p><span class="user-mention" data-user-id="192302">@May Terry</span> , thanks, but yes it's already included</p>
<div class="codehilite"><pre><span></span>      {
        &quot;reference&quot;: {
          &quot;reference&quot;: &quot;StructureDefinition/mygenotype&quot;
        },
        &quot;name&quot;: &quot;My Profile of Genotype Observation&quot;,
        &quot;description&quot;: &quot;Profiling genotype observation&quot;,
        &quot;exampleBoolean&quot;: false
      }
</pre></div>


<p>btw, I just noticed this msg from the IG publisher output:</p>
<div class="codehilite"><pre><span></span>Dependency &#39;hl7.fhir.uv.genomics-reporting&#39; has no id, so can&#39;t be referred to in markdown in the IG (00:16.0880)
</pre></div>



<a name="187589171"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187589171" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187589171">(Feb 06 2020 at 21:10)</a>:</h4>
<p>I've seen that last error before and it <em>seems</em> to be harmless.  I'll take a look at this <span class="user-mention" data-user-id="191916">@ Bob Milius</span>.  If I can reproduce it on my side I might be able to figure out what's going on.</p>



<a name="187589210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187589210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187589210">(Feb 06 2020 at 21:11)</a>:</h4>
<p>it's significance depends on what you are doing. If you don't want to refer to the dependency in the markdown, then you don't need an id.</p>



<a name="187591822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187591822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187591822">(Feb 06 2020 at 21:42)</a>:</h4>
<p>That makes sense -- and the message is pretty clear about that.  I guess I meant that it shouldn't have an effect on things like what Bob is currently reporting.  But... I think we can get the <code>id</code> in there too, so people can refer to them in markdown if they'd like.</p>



<a name="187593723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187593723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187593723">(Feb 06 2020 at 22:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> -- I'm having trouble determining the problem here.  The profile that SUSHI generates seems valid to me, but the IG publisher crashes on it.  Here is the SD (I removed our generated snapshot to ensure that's not the issue -- and it still fails):</p>
<div class="codehilite"><pre><span></span>{
  &quot;resourceType&quot;: &quot;StructureDefinition&quot;,
  &quot;id&quot;: &quot;mygenotype&quot;,
  &quot;url&quot;: &quot;http://hl7.org/fhir/sushi-test/StructureDefinition/mygenotype&quot;,
  &quot;version&quot;: &quot;0.1.0&quot;,
  &quot;name&quot;: &quot;Mygenotype&quot;,
  &quot;title&quot;: &quot;My Profile of Genotype Observation&quot;,
  &quot;status&quot;: &quot;active&quot;,
  &quot;description&quot;: &quot;Profiling genotype observation&quot;,
  &quot;fhirVersion&quot;: &quot;4.0.1&quot;,
  &quot;mapping&quot;: [
    {
      &quot;identity&quot;: &quot;v2-cg-results&quot;,
      &quot;uri&quot;: &quot;http://unknown.org/V2-CG-Results&quot;,
      &quot;name&quot;: &quot;V2-CG-Results&quot;
    },
    {
      &quot;identity&quot;: &quot;workflow&quot;,
      &quot;uri&quot;: &quot;http://hl7.org/fhir/workflow&quot;,
      &quot;name&quot;: &quot;Workflow Pattern&quot;
    },
    {
      &quot;identity&quot;: &quot;sct-concept&quot;,
      &quot;uri&quot;: &quot;http://snomed.info/conceptdomain&quot;,
      &quot;name&quot;: &quot;SNOMED CT Concept Domain Binding&quot;
    },
    {
      &quot;identity&quot;: &quot;v2&quot;,
      &quot;uri&quot;: &quot;http://hl7.org/v2&quot;,
      &quot;name&quot;: &quot;HL7 v2 Mapping&quot;
    },
    {
      &quot;identity&quot;: &quot;rim&quot;,
      &quot;uri&quot;: &quot;http://hl7.org/v3&quot;,
      &quot;name&quot;: &quot;RIM Mapping&quot;
    },
    {
      &quot;identity&quot;: &quot;w5&quot;,
      &quot;uri&quot;: &quot;http://hl7.org/fhir/fivews&quot;,
      &quot;name&quot;: &quot;FiveWs Pattern Mapping&quot;
    },
    {
      &quot;identity&quot;: &quot;sct-attr&quot;,
      &quot;uri&quot;: &quot;http://snomed.org/attributebinding&quot;,
      &quot;name&quot;: &quot;SNOMED CT Attribute Binding&quot;
    }
  ],
  &quot;kind&quot;: &quot;resource&quot;,
  &quot;abstract&quot;: false,
  &quot;type&quot;: &quot;Observation&quot;,
  &quot;baseDefinition&quot;: &quot;http://hl7.org/fhir/uv/genomics-reporting/StructureDefinition/genotype&quot;,
  &quot;derivation&quot;: &quot;constraint&quot;,
  &quot;differential&quot;: {
    &quot;element&quot;: [
      {
        &quot;id&quot;: &quot;Observation.component&quot;,
        &quot;path&quot;: &quot;Observation.component&quot;,
        &quot;min&quot;: 1
      },
      {
        &quot;id&quot;: &quot;Observation.component:gene-studied&quot;,
        &quot;path&quot;: &quot;Observation.component&quot;,
        &quot;min&quot;: 1,
        &quot;max&quot;: &quot;1&quot;
      }
    ]
  }
}
</pre></div>


<p>As you can see, the diff is pretty straight-forward.  And here is the exception:</p>
<div class="codehilite"><pre><span></span>org.hl7.fhir.exceptions.FHIRException: Unable to generate snapshot for http://hl7.org/fhir/sushi-test/StructureDefinition/mygenotype in /Users/cmoesel/dev/fsh/bob-ig/build/input/resources/structuredefinition-mygenotype
    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3958)
    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshots(Publisher.java:3910)
    at org.hl7.fhir.igtools.publisher.Publisher.loadConformance(Publisher.java:3343)
    at org.hl7.fhir.igtools.publisher.Publisher.createIg(Publisher.java:804)
    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:665)
    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:6937)
Caused by: java.lang.NullPointerException
    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:1427)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:523)
    at org.hl7.fhir.igtools.publisher.Publisher.generateSnapshot(Publisher.java:3956)
    ... 5 more
</pre></div>



<a name="187593853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187593853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187593853">(Feb 06 2020 at 22:08)</a>:</h4>
<p>For reference, here is the baseDefinition profile that it is based on: <a href="http://hl7.org/fhir/uv/genomics-reporting/genotype.html" target="_blank" title="http://hl7.org/fhir/uv/genomics-reporting/genotype.html">http://hl7.org/fhir/uv/genomics-reporting/genotype.html</a></p>



<a name="187593894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187593894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187593894">(Feb 06 2020 at 22:09)</a>:</h4>
<p>And here is a simple FSH project (already built w/ SUSHI) that I used to demonstrate it.  The buildable IG is in the <code>build</code> folder. <a href="/user_uploads/10155/X4noJUeUu9K7IKN8MZAnruVH/mygenotype-ig.zip" target="_blank" title="mygenotype-ig.zip">mygenotype-ig.zip</a></p>



<a name="187610241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187610241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Kramer <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187610241">(Feb 07 2020 at 03:23)</a>:</h4>
<p>(deleted)</p>



<a name="187830549"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187830549" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187830549">(Feb 10 2020 at 16:17)</a>:</h4>
<p><span class="user-mention" data-user-id="239822">@Nick Freiter</span> just noticed that this bug looks a lot like another bug that was reported to us over the weekend (<a href="https://github.com/FHIR/sushi/issues/207" target="_blank" title="https://github.com/FHIR/sushi/issues/207">SUSHI #207</a>).  So it's likely that this bug has the same root cause as the other: we (SUSHI) are not repeating inherited slice names in the differential.  Look for a fix in a future version of SUSHI.</p>



<a name="187984462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/187984462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#187984462">(Feb 12 2020 at 06:13)</a>:</h4>
<p>the problem was a missing slice name. Next release won't give you an NPE, but the missing slice name will still cause an error</p>



<a name="188010528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/profiling%20on%20external%20IG%20and%20named%20slices/near/188010528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/profiling.20on.20external.20IG.20and.20named.20slices.html#188010528">(Feb 12 2020 at 13:45)</a>:</h4>
<p>Thanks for the confirmation, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> -- we're already on it!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
