---
layout: page
title: "FHIR Chat  · SUSHI / IG Publisher Integration Proposal · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html">SUSHI / IG Publisher Integration Proposal</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="205978827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/205978827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#205978827">(Aug 05 2020 at 01:06)</a>:</h4>
<p>We've been thinking about how to improve the SUSHI / IG Publisher integration.  Here is a proposal to start some discussion.  We'd love your feedback.  <em>Full Disclosure: I am going on two weeks vacation tomorrow, but please discuss anyway -- <span class="user-mention" data-user-id="191447">@Mark Kramer</span> and others on the SUSHI/FSH team can engage.</em></p>
<p><strong>Goal</strong>: To allow FHIR Shorthand (FSH) to be more easily integrated into FHIR Implementation Guides using the <em>standard FHIR IG template</em> project structure, avoiding the need for special folders like <code>ig-data</code>.</p>
<p><strong>BLUF:</strong></p>
<ul>
<li>Authors maintain <code>.fsh</code> files in <code>input/fsh</code></li>
<li>The <code>config.yaml</code> is maintained in the root folder (but is <em>optional</em> for FSH-only users)<ul>
<li>If <code>config.yaml</code> is provided, SUSHI will generate the <code>ImplementationGuide</code> JSON and other IG files (as indicated in the <code>config.yaml</code> file), in addition to the FHIR definitions</li>
<li>If <code>config.yaml</code> is <em>not</em> provided, SUSHI will generate FHIR definitions only and will use the provided <code>ImplementationGuide</code> JSON to determine the <code>canonical</code>.</li>
</ul>
</li>
<li>SUSHI writes all output to the locations IG Publisher expects. This means that some generated files may be intertwined with author-maintained (non-generated) files.</li>
<li>SUSHI provides two new capabilities to help authors manage generated files:<ul>
<li><code>sushi --clean</code> deletes all generated files, allowing authors to perform "clean builds"</li>
<li><code>sushi --update-ignore</code> updates the <code>.gitignore</code> file to ignore all generated files (so they aren't checked in)</li>
</ul>
</li>
</ul>
<p><strong>PLEASE FOLLOW THIS LINK FOR EXAMPLES AND DETAILS -----&gt;</strong> <a href="https://gist.github.com/cmoesel/af6c05e008f726a89dd55505a8190f4b">https://gist.github.com/cmoesel/af6c05e008f726a89dd55505a8190f4b</a></p>



<a name="205989901"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/205989901" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#205989901">(Aug 05 2020 at 05:35)</a>:</h4>
<ol>
<li>How are generated files? how does sushi detect them for the --clean?<br>
For example I was using sushi to generate a first codesystem, but then had to update it separately to create translations.</li>
</ol>



<a name="205990276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/205990276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#205990276">(Aug 05 2020 at 05:45)</a>:</h4>
<ol start="2">
<li>I would prefer a post-processing step rather , but that is probably because I don't understand the .gitignore. I do want my committed files to look exactly like those I have in my local build</li>
</ol>



<a name="206252647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206252647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206252647">(Aug 07 2020 at 12:51)</a>:</h4>
<ol>
<li>If the file is defined as FSH, sushi would consider that a generated file. I think in your case of the CodeSystem, sushi would detect it and try to <code>clean</code> it. The separate updates would be overwritten. But in this context, couldn't you solve that problem by letting sushi generate the CodeSystem once, and then commenting out that section of FSH?</li>
<li>I'm not sure what you mean by preferring  a "post-processing" step. You prefer this in comparison to what?</li>
</ol>



<a name="206258084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206258084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206258084">(Aug 07 2020 at 13:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239822">Nick Freiter</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206252647">said</a>:</p>
<blockquote>
<ol>
<li>If the file is defined as FSH, sushi would consider that a generated file. I think in your case of the CodeSystem, sushi would detect it and try to <code>clean</code> it. The separate updates would be overwritten. But in this context, couldn't you solve that problem by letting sushi generate the CodeSystem once, and then commenting out that section of FSH?</li>
</ol>
</blockquote>
<p>Thanks. I can comment it out, but how can I use it in a valueset? I think I would have to copy the codesystem.json to my input folder (ig-data) as a BYOJ.</p>



<a name="206258230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206258230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206258230">(Aug 07 2020 at 13:46)</a>:</h4>
<p>i guess I just don't see what is the .gitignore doing. Is it just telling github to ignore some local files and not push them to github?</p>



<a name="206258318"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206258318" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206258318">(Aug 07 2020 at 13:47)</a>:</h4>
<p>If so, that will likely get the local build and CI build misaligned more often than not... which I think is a bad idea.</p>



<a name="206258848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206258848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206258848">(Aug 07 2020 at 13:52)</a>:</h4>
<p>by post-processing I mean something like: </p>
<ol>
<li>sushi should do its work as a parser in a constant way - always same behaviour - fsh +BYOx in, json out.</li>
<li>after that processing, sushi should generate the ig content in sushi's --output folder, (called <code>input</code> folder)</li>
<li>finally, what was already defined in the IG (BYOx and ig.ini etc) should just (optionally) be carried over to the sushi's --output folder</li>
</ol>



<a name="206266472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206266472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206266472">(Aug 07 2020 at 14:53)</a>:</h4>
<p>I'm just looking for a way that sushi can be working to create a part of an already existing IG. I don't know exactly how this should work but my concernsare :</p>
<ul>
<li>command line parameters cannot be used in the CI build or it's hard to pass them via the IG publisher. all should be autonomous.</li>
<li>sushi can be run standalone or be part of the IG chain. like most tools, the hard part is to support the latter</li>
</ul>



<a name="206275185"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206275185" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206275185">(Aug 07 2020 at 16:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191832">Jose Costa Teixeira</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206258230">said</a>:</p>
<blockquote>
<p>i guess I just don't see what is the .gitignore doing. Is it just telling github to ignore some local files and not push them to github?</p>
</blockquote>
<p>Yes.  and most repositories use the .gitignore both FHIR and non-FHIR.  As an example, I don't check in any of the temp directories or any of the .DS_Store files that Macs create.  I put that in the .gitignore.</p>



<a name="206277015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206277015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206277015">(Aug 07 2020 at 16:16)</a>:</h4>
<p>Sorry, I meant I know what it does. I don't know what good will bring 'ignore all generated files'</p>



<a name="206277270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206277270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206277270">(Aug 07 2020 at 16:18)</a>:</h4>
<p>Just seems to create a nice setup for people to go asking 'this works on my machine but the ci publisher says it's missing a file. Must be something with the publisher, because my machine works fine' - and those issues will be very hard to help debug, right?</p>



<a name="206287773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206287773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206287773">(Aug 07 2020 at 17:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191832">Jose Costa Teixeira</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206277270">said</a>:</p>
<blockquote>
<p>Just seems to create a nice setup for people to go asking 'this works on my machine but the ci publisher says it's missing a file. Must be something with the publisher, because my machine works fine' - and those issues will be very hard to help debug, right?</p>
</blockquote>
<p>Well, the idea would be that the .gitignore file would only ignore JSON files generated by sushi. When the IG Publisher runs sushi locally and those files are present, they will be overwritten. When the IG Publisher runs sushi on the ci, those files would not be present, since they would be ignored, so they would be generated freshly by sushi.</p>



<a name="206289920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206289920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206289920">(Aug 07 2020 at 18:00)</a>:</h4>
<p>Ok, I see it now. I think this is a complicated way and a small in rent - I'd rather se a more robust (redesign)</p>



<a name="206454309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206454309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206454309">(Aug 10 2020 at 12:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191832">Jose Costa Teixeira</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206289920">said</a>:</p>
<blockquote>
<p>Ok, I see it now. I think this is a complicated way and a small in rent - I'd rather se a more robust (redesign)</p>
</blockquote>
<p>Which aspects of this approach do you feel aren't robust? Is it the part with <code>.gitignore</code> excluding generated files from being checked in? To be clear, that is an optional feature. If someone wants their generated files to be checked into source control, they do not have to use the <code>--update-ignore</code> script.</p>



<a name="206457518"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206457518" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206457518">(Aug 10 2020 at 13:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239822">Nick Freiter</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206454309">said</a>:</p>
<blockquote>
<p>Which aspects of this approach do you feel aren't robust? Is it the part with <code>.gitignore</code> excluding generated files from being checked in? To be clear, that is an optional feature. If someone wants their generated files to be checked into source control, they do not have to use the <code>--update-ignore</code> script.</p>
</blockquote>
<p>Thanks. First, by "small in rent" i meant " small increment" - I mean that the ig-data feels like it was designed for sushi to be fully autonomous in providing the entirety of the content, and not designed for the fact that sushi is one component in the IG publishing chain. So these seem like local optimisations, but I would rather step back and see would be a way to do fsh parsing and IG preparation - if we did not have that ig-data folder, would we do things the same way?</p>



<a name="206457616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206457616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206457616">(Aug 10 2020 at 13:03)</a>:</h4>
<p>I do not know why .gitignore thing - I'm sure there are legitimate use cases, but this may create a big confusion between local build and remote build.</p>



<a name="206460536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206460536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206460536">(Aug 10 2020 at 13:33)</a>:</h4>
<p>Well to us, this proposal does seem like a way of making SUSHI a part of the IG Publisher chain. If someone does not want to manage IG Publisher files via SUSHI, they would only have to put FSH files in <code>input/fsh</code>, and SUSHI would use the <code>ImplementationGuide</code> JSON file to get the information it needs to process those FSH files into JSON. That seems like it is essentially as minimally invasive as possible.</p>



<a name="206471847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206471847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206471847">(Aug 10 2020 at 15:09)</a>:</h4>
<p>I appreciate the direction. What I've been experiencing is that it's not as simple as putting fsh file in the input/fsh. Those are my challenges.<br>
It's ok to have some command line options, but in a CI build the user will not be able to add those.</p>



<a name="206471978"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206471978" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206471978">(Aug 10 2020 at 15:10)</a>:</h4>
<p>the .gitignore I fail to see the purpose, honestly.</p>



<a name="206476964"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206476964" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206476964">(Aug 10 2020 at 15:50)</a>:</h4>
<p>concrete improvement suggestions:</p>
<ol>
<li>
<p>in the integration, we could use the -o parameter to let sushi write its output to a "sushi-generated" folder - we don't have to mix them with the existing files in the <code>input/*</code> folder. That additional folder is quite easy to manage by any of the tools.<br>
1.1. instead of gitignore on file level, we can just -gitignore that folder.</p>
</li>
<li>
<p>Would it be interesting to we add a parameter to sushi for "additional folder for BYOx"? <br>
2.1 Perhaps that would even have <code>input/</code> as default, and not need this at all all sushi stuff is in a separate folder</p>
</li>
</ol>



<a name="206477896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206477896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206477896">(Aug 10 2020 at 15:58)</a>:</h4>
<p>Your second suggestion is a part of this proposal, SUSHI would just look in the surrounding <code>input/</code> folders for the BYO content, so we agree that something along those lines could be useful.</p>



<a name="206478967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206478967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206478967">(Aug 10 2020 at 16:07)</a>:</h4>
<p>The first suggestion would also be simpler than a complicated.gitignore and --clean, I think. But if this starts working I can propose to put this in the template for example</p>



<a name="206490151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206490151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206490151">(Aug 10 2020 at 17:42)</a>:</h4>
<p>We are also wary of requiring other parts of the IG Publisher toolchain to do more work to support sushi. The proposal above would only require that the IG Publisher runs sushi if it sees an <code>input/fsh</code> folder (as opposed to the current behavior of running sushi if it sees a <code>fsh</code> folder), and then sushi would take care of the rest, and the IG Publisher could run as normal. If we were to make a <code>sushi-generated</code> folder, the IG Publisher would now have to look through that folder for definitions.</p>



<a name="206498552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206498552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206498552">(Aug 10 2020 at 18:53)</a>:</h4>
<p>Looking in an additional folder is easy - it's one parameter that can be added to the template.</p>



<a name="206498862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206498862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206498862">(Aug 10 2020 at 18:56)</a>:</h4>
<p>I'm looking for the minimal changes to sushi that provide the ease for most users but reserve power to advanced users</p>



<a name="206500283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206500283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206500283">(Aug 10 2020 at 19:06)</a>:</h4>
<p>Sushi would only need to implement something like my suggestion 2. #1 we can do in the integration - you don't need to mess with .gitignore or perhaps even the -clean option.</p>



<a name="206501835"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206501835" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206501835">(Aug 10 2020 at 19:19)</a>:</h4>
<p>It could be a <em>bit</em> confusing to have a <code>sushi-generated</code> folder, because some people will still use sushi  to generate things like <code>ImplementationGuide</code> JSON,<code>ig.ini</code>, and <code>menu.xml</code> based on <code>config.yaml</code>, and those will not be in that folder. That being said, it would provide a more clean separation between author maintained (non-generated) files and generated files, which is an admitted weakness of Chris's proposal above. If it is easy enough for the IG Pub to just look in one more folder, I can't speak for the rest of the team, but to me it seems that is more simple than intermixing definitions among non-generated resource. If any other users have feedback on how this could influence their usage of sushi, we would love to hear it as well.</p>



<a name="206501919"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206501919" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206501919">(Aug 10 2020 at 19:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191469">Chris Moesel</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/205978827">said</a>:</p>
<blockquote>
<p>We've been thinking about how to improve the SUSHI / IG Publisher integration.  Here is a proposal to start some discussion.  We'd love your feedback.  <em>Full Disclosure: I am going on two weeks vacation tomorrow, but please discuss anyway -- <span class="user-mention silent" data-user-id="191447">Mark Kramer</span> and others on the SUSHI/FSH team can engage.</em></p>
</blockquote>
<p>I really like this proposal.  I have a couple of questions but overall this makes complete sense to me and goes much further towards a decent IGPublisher integration.</p>
<p>1) I don't understand what the line "In addition, the --clean flag can be used when building FSH source to establish a clean build." is referring to in the section on sushi --clean.<br>
2) Would it be possible, if I wanted to segregate my FSH files that way, to put FSH files in the various input directories?  i.e. if myfile1.fsh only has profiles, could I put it in input/profiles and have SUSHI generate appropriate JSONs from that?  That's not how I currently build my FSH files but I can see someone wanting a one-to-one correspondence between artifacts and FSH files.</p>



<a name="206503629"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206503629" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206503629">(Aug 10 2020 at 19:35)</a>:</h4>
<p>1) I am also unsure about this actually. I think what this is meant to mean is that you can do <code>sushi --clean</code> to delete all sushi generated files, or you can do <code>sushi --clean /path/to/project</code> to delete and then rebuild all sushi generated files. But, since sushi overwrites files anyway, I'm not sure why you would need to delete all the files and then rebuild, as opposed to just overwriting.<br>
2) We've considered structures like this in the past. On the sushi end, sushi already works by recursively looking for <code>.fsh</code> files, so it would not be hard for sushi to just search through a set of folders for <code>.fsh</code> files instead of a single folder. But I think this would complicate things for the Publisher. Instead of triggering a sushi run if there is a <code>fsh</code> (or <code>input/fsh</code>) folder, the Publisher would have to search through all folders for <code>.fsh</code> files, and trigger a run of sushi based on that.</p>



<a name="206503751"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206503751" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206503751">(Aug 10 2020 at 19:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239822">Nick Freiter</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206501835">said</a>:</p>
<blockquote>
<p>It could be a <em>bit</em> confusing to have a <code>sushi-generated</code> folder, because some people will still use sushi  to generate things like <code>ImplementationGuide</code> JSON,<code>ig.ini</code>, and <code>menu.xml</code> based on <code>config.yaml</code>, and those will not be in that folder. </p>
</blockquote>
<p>Depends. If we want to be thorough, we could make <code>sushi-generated</code> contain a <code>input</code> folder for the generated conformance resources only, and the other files in the parent folder.<br>
In my view, those other files don't need to be regenerated every time that sushi runs. For me, creating those files is something that you do once on setup or every time you change the corresponding input. I'd suggest separating that (setup file generation) from the conformance resource generation. (check <span class="user-mention" data-user-id="192166">@Jean Duteau</span> 's suggestion a few weeks ago to have sushi default to FSHOnly or accept it as a command line parameter)</p>



<a name="206505051"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206505051" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206505051">(Aug 10 2020 at 19:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239822">Nick Freiter</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206503629">said</a>:</p>
<blockquote>
<p>But I think this would complicate things for the Publisher. Instead of triggering a sushi run if there is a <code>fsh</code> (or <code>input/fsh</code>) folder, the Publisher would have to search through all folders for <code>.fsh</code> files, and trigger a run of sushi based on that.</p>
</blockquote>
<p>If sushi can get all the *.fsh files in the --input folder and subfolders, I don't see why the publisher needs to do something.</p>



<a name="206506006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206506006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206506006">(Aug 10 2020 at 19:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191832">Jose Costa Teixeira</span> <a href="#narrow/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal/near/206505051">said</a>:</p>
<blockquote>
<p>If sushi can get all the *.fsh files in the --input folder and subfolders, I don't see why the publisher needs to do something.</p>
</blockquote>
<p>How would the IG Publisher know to run sushi in the first place? Currently as far as I know, the running of sushi is triggered by the presence of the <code>fsh</code> folder. If <code>.fsh</code> files are all spread out, the Publisher needs to look through all folders to see if any <code>.fsh</code> files are present, so that it can know sushi should even run.</p>



<a name="206506154"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206506154" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206506154">(Aug 10 2020 at 19:58)</a>:</h4>
<p>can we not safe-run sushi and have sushi exit with "0 - nothing to do" ?</p>



<a name="206519714"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206519714" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206519714">(Aug 10 2020 at 22:12)</a>:</h4>
<blockquote>
<p>We are also wary of requiring other parts of the IG Publisher toolchain to do more work to support sushi</p>
</blockquote>
<p>I don't mind if it makes for a better experience for users</p>



<a name="206521329"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206521329" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206521329">(Aug 10 2020 at 22:35)</a>:</h4>
<p>From what I learned today, a few changes that I think would make for a better integration:</p>
<ol>
<li>Make sushi work by default (or via command line option) in FSHOnly mode.</li>
<li>Make the <code>ig-data</code> folder a command line parameter (remains the folder that contains non-fsh stuff like the BYOx, or the ig.ini, ig.xml, or package.json(?)...)</li>
<li>Get sushi to exit gracefully if there are no fsh folders in the input folder (so that you can always run sushi without having to detect an fsh folder)</li>
<li>Eventually add more input folders? Not sure if needed.</li>
<li>Change the command line in the publisher accordingly: sushi [-FSHOnly] [-ig-data=.] ./input [-o sushi-generated]</li>
<li>Change the template to add "sushi-generated" as a resource folder</li>
</ol>



<a name="206600440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206600440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206600440">(Aug 11 2020 at 16:58)</a>:</h4>
<p>One other thing we considered is trying to rename files that are generated by sushi to indicate as such. Aka a StructureDefinition generated by sushi may be in a file called <code>StructureDefinition-Foo-generated.json</code> instead of <code>StructureDefinition-Foo.json</code>. Is something like that possible with the IG Publisher? In experimenting it seems we couldn't do this, due to the Publisher requiring files to follow the format <code>resource-id.json</code> (or a related format).</p>



<a name="206604101"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206604101" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206604101">(Aug 11 2020 at 17:25)</a>:</h4>
<p>yes, that will be an issue. see<br>
<a href="#narrow/stream/215610-shorthand/topic/Resource.20filename.20prefix">https://chat.fhir.org/#narrow/stream/215610-shorthand/topic/Resource.20filename.20prefix</a></p>



<a name="206604242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206604242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206604242">(Aug 11 2020 at 17:27)</a>:</h4>
<p>(sorry, sent wrong link before)</p>



<a name="206604292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206604292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206604292">(Aug 11 2020 at 17:27)</a>:</h4>
<p>using a separate folder would be easy on both sides, I guess. I don't know if it has significant downsides.</p>



<a name="206619111"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/SUSHI%20/%20IG%20Publisher%20Integration%20Proposal/near/206619111" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/SUSHI.20.2F.20IG.20Publisher.20Integration.20Proposal.html#206619111">(Aug 11 2020 at 19:21)</a>:</h4>
<p><span class="user-mention" data-user-id="239822">@Nick Freiter</span> I could modify the IG publisher to support that, but I'm not convinced it's the right solution</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
