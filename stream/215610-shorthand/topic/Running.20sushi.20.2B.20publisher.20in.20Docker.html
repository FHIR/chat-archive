---
layout: page
title: "FHIR Chat  · Running sushi + publisher in Docker · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html">Running sushi + publisher in Docker</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="207283157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207283157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207283157">(Aug 18 2020 at 16:39)</a>:</h4>
<p>Is there already a docker container that I can volume-mount a local dir into and have sushi + IG Publisher both run and do their thing? (i.e., with Java + Jekyll/ruby + node all installed/configured?) I can make one, but figured I'd check here first.</p>



<a name="207463783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207463783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207463783">(Aug 19 2020 at 21:29)</a>:</h4>
<p>OK, I put together a dev wrapper at <a href="https://github.com/FHIR/auto-ig-builder/tree/master/images/ig-publisher-base">https://github.com/FHIR/auto-ig-builder/tree/master/images/ig-publisher-base</a>. Demo: coming...</p>



<a name="207463933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207463933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207463933">(Aug 19 2020 at 21:31)</a>:</h4>
<p>Quick question: if I run <code>_genonce.sh</code> before ig.ini exists, the publisher fails. I need to manually run <code>sushi</code> first, and <em>then</em> <code>_genonce.sh</code> succeeds. Is this expected?</p>



<a name="207471483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207471483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207471483">(Aug 19 2020 at 23:01)</a>:</h4>
<p>OK, wrapped in docker for local dev:</p>
<div class="codehilite"><pre><span></span><code>$ git clone -b move-to-fsh https://github.com/hl7/smart-app-launch
$ cd smart-app-launch

$ docker run \
    --rm -it \
    -v $(pwd):/home/publisher/ig \
    hl7fhir/ig-publisher-base

$ sushi # This shouldn&#39;t be necessary but currently it is, the first time
$ _updatePublisher.sh # If you haven&#39;t done it before

$ _genonce.sh
</code></pre></div>


<p>(<span class="user-mention" data-user-id="191414">@Dan Gottlieb</span> would love to make sure this works for you; I don't have a good way to test on Mac OS.)</p>



<a name="207527109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207527109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gottlieb <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207527109">(Aug 20 2020 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>  The image works great on Mac! Building the Bulk Data IG fails though, I think because of incompatibilities with the latest version of the publisher that I'll need to track down...</p>



<a name="207555253"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207555253" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207555253">(Aug 20 2020 at 18:11)</a>:</h4>
<blockquote>
<p>Quick question: if I run <a href="http://_genonce.sh">_genonce.sh</a> before ig.ini exists, the publisher fails. I need to manually run sushi first, and then <a href="http://_genonce.sh">_genonce.sh</a> succeeds. Is this expected?</p>
</blockquote>
<p>Yeah, I think that's expected if you run it using <code>_genonce.sh</code>.  On the HL7 auto-build, it's not necessary because that runs the publisher with the <code>-auto-ig-build</code> flag -- and Grahame does some special magic to accommodate the missing <code>ig.ini</code> when that flag is used.  If you updated the image to call the publisher directly (w/ <code>-auto-ig-build</code>) it would work -- but I don't know if there are any additional undesirable side effects in that case.</p>



<a name="207555331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207555331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207555331">(Aug 20 2020 at 18:11)</a>:</h4>
<p>Sorry, forgot to tag you, <span class="user-mention" data-user-id="191315">@Josh Mandel</span>.  Don't know if you follow this channel regularly.</p>



<a name="207556145"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207556145" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207556145">(Aug 20 2020 at 18:18)</a>:</h4>
<p>Thanks Chris! I guess I'll leave this as-is for the moment, but it's good to know I can emulate the auto-build behavior if needed.</p>



<a name="207573829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207573829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207573829">(Aug 20 2020 at 20:59)</a>:</h4>
<p>there's several side effects from running it with the -auto-ig-build flag, and I certainly wouldn't want to see people do that regularly. But I don't understand this anyway - if the problem is with <a href="http://_genonce.sh">_genonce.sh</a>, and you work around it by running the Ig publisher directly, you don't need the -auto-ig-build flag when you do that</p>



<a name="207574580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207574580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207574580">(Aug 20 2020 at 21:06)</a>:</h4>
<p>The problem with <code>_genonce.sh</code> is that it does not use the <code>-auto-ig-build</code> flag.  The workaround is to run the IG Publisher directly <em>with the -auto-ig-build flag</em> -- so if that's not a recommended approach for end-users, then there is no workaround except to run SUSHI before you run the publisher.  OR to manually manage the ig.ini file instead of having SUSHI generate it (which, really, isn't that much of a lift).</p>



<a name="207575471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207575471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207575471">(Aug 20 2020 at 21:14)</a>:</h4>
<p>I don't understand then. Why is this required?</p>



<a name="207577574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207577574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207577574">(Aug 20 2020 at 21:38)</a>:</h4>
<p>When run normally, the IG publisher expects an <code>ig.ini</code> file at the root -- and checks for that first thing (before running SUSHI).  But some FSH projects depend on SUSHI to <em>generate</em> the <code>ig.ini</code> file -- so it won't be there when the IG Publisher checks for it.  This causes a problem for those projects -- requiring them to run SUSHI manually first, and then run the IG Publisher (which happily finds the <code>ig.ini</code> now and then runs SUSHI <em>again</em>).</p>



<a name="207584239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207584239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207584239">(Aug 20 2020 at 22:59)</a>:</h4>
<p>I don't see this. I take an existing guide, and delete everything except for the fsh directory, and run the publisher on it directly, and it all succeeds ok</p>



<a name="207597504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207597504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207597504">(Aug 21 2020 at 03:31)</a>:</h4>
<p>If I understand well, the problem is that the _genOnce does not work when there is no ig.ini created.</p>



<a name="207597545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207597545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207597545">(Aug 21 2020 at 03:32)</a>:</h4>
<p>if that is true, that is by design. _genOnce is not to setup a new IG (create ig.ini, etc). _genOnce is to build the IG.</p>



<a name="207597566"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207597566" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207597566">(Aug 21 2020 at 03:33)</a>:</h4>
<p>I don't think we should mix the 2 modes of operation</p>
<ol>
<li>setup a new IG, (re)create the entire ig.ini etc</li>
<li>update content like a page or an example</li>
</ol>



<a name="207597723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207597723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207597723">(Aug 21 2020 at 03:36)</a>:</h4>
<p>If my understanding of the challenge is correct, then I don't think this is a problem.</p>



<a name="207597771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207597771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207597771">(Aug 21 2020 at 03:38)</a>:</h4>
<p>(i have suggested elsewhere to separate the activities of setting up an ig from sushi vs parsing fsh)</p>



<a name="207601706"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207601706" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207601706">(Aug 21 2020 at 05:30)</a>:</h4>
<p>why does _genOnce care about the ig.ini?</p>



<a name="207602447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207602447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207602447">(Aug 21 2020 at 05:52)</a>:</h4>
<p>_genonce simply does java -jar -ig ig.ini</p>



<a name="207602472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207602472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207602472">(Aug 21 2020 at 05:53)</a>:</h4>
<p>it cares that it exists, not the content</p>



<a name="207602561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207602561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207602561">(Aug 21 2020 at 05:55)</a>:</h4>
<p>why does it do that?</p>



<a name="207602575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207602575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207602575">(Aug 21 2020 at 05:55)</a>:</h4>
<p>it should do java -jar -ig .</p>



<a name="207603490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207603490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207603490">(Aug 21 2020 at 06:20)</a>:</h4>
<p>i don't know if there's a reason. we can wait for Lloyd to confirm, if there was any. but perhaps we can change  that.</p>



<a name="207603509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207603509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207603509">(Aug 21 2020 at 06:22)</a>:</h4>
<p>i didn't know that -ig.ini . worked - it does. Will it cause any issues if we change it?</p>



<a name="207603566"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207603566" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207603566">(Aug 21 2020 at 06:23)</a>:</h4>
<p>i.e. what could go wrong if we change it? Perhaps that would be an issue if someone had 2 ini files in the root folder (...why ever?).</p>



<a name="207603921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207603921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207603921">(Aug 21 2020 at 06:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> if you agree you can merge this  PR<br>
<a href="https://github.com/FHIR/sample-ig/pull/40">https://github.com/FHIR/sample-ig/pull/40</a></p>



<a name="207605028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207605028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207605028">(Aug 21 2020 at 06:57)</a>:</h4>
<p>merged. Can't be more than on functional ini file that matters</p>



<a name="207624642"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207624642" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207624642">(Aug 21 2020 at 11:42)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> and <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> -- and my apologies for misunderstanding who is requiring what where and when!</p>



<a name="207626613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207626613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207626613">(Aug 21 2020 at 12:10)</a>:</h4>
<p>Awesome! And in the process I learned where sushi sources these _gen*.sh scripts from ;-)</p>



<a name="207784313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207784313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207784313">(Aug 23 2020 at 18:01)</a>:</h4>
<p>The ig.ini points to the ig.  The ig.ini is in a predictable place with a predictable name.  The ig is not.  We don't want the .bat files changing from project to project.</p>



<a name="207791570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207791570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207791570">(Aug 23 2020 at 21:11)</a>:</h4>
<p>I don't understand that comment but the ig.ini has turned out not to be a predictable place</p>



<a name="207804474"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/207804474" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#207804474">(Aug 24 2020 at 03:29)</a>:</h4>
<p>The publisher requires the ig.ini to be in the root folder, no?</p>



<a name="208738153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208738153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208738153">(Sep 01 2020 at 19:47)</a>:</h4>
<p>Did this end up resulting in a change? For a clean build of a FSH IG, are the required steps still run sushi before running _genonce (which runs sushi again)? Is there an option I can pass to _genonce to supress  running sushi the second time?</p>



<a name="208738507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208738507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208738507">(Sep 01 2020 at 19:50)</a>:</h4>
<p>_genonce isn't running sushi.  The IG publisher finds a fsh folder and then runs sushi.  you don't have to run sushi the first time if you provide an ig.ini in the root directory that points to the ig and defines the template to use.</p>



<a name="208738710"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208738710" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208738710">(Sep 01 2020 at 19:52)</a>:</h4>
<p>Right, should have been clearer. Is there an option I can pass to _genonce that will get passed on to the publisher to suppress the publisher from running sushi the second time?</p>



<a name="208738763"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208738763" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208738763">(Sep 01 2020 at 19:52)</a>:</h4>
<p>don't name your fsh folder "fsh".  i'm pretty sure that's how the ig publisher detects that sushi should run</p>



<a name="208739102"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208739102" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208739102">(Sep 01 2020 at 19:55)</a>:</h4>
<p>i think that the easiest option for now is to create/check in the ig.ini file so that it is there from the beginning.  then you don't have to run sushi the first time.</p>



<a name="208739189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208739189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208739189">(Sep 01 2020 at 19:56)</a>:</h4>
<p>so your source repository would have the bat/sh scripts, the fsh directory, and the ig.ini file</p>



<a name="208739227"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208739227" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208739227">(Sep 01 2020 at 19:56)</a>:</h4>
<p>hmm, just found a -no-sushi parameter for the publisher.</p>



<a name="208739240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208739240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208739240">(Sep 01 2020 at 19:56)</a>:</h4>
<p>really?  cool!</p>



<a name="208739428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/208739428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#208739428">(Sep 01 2020 at 19:58)</a>:</h4>
<p>Yay! It works:</p>
<div class="codehilite"><pre><span></span><code>./_genonce.sh -no-sushi
</code></pre></div>



<a name="233373353"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/233373353" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Larry Shields <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#233373353">(Apr 06 2021 at 19:16)</a>:</h4>
<p>Thank you for this image <span class="user-mention" data-user-id="191315">@Josh Mandel</span> . This really helps to get an environment ready to build FSH items within a Container using Dev Containers in VSCode.</p>



<a name="233374868"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/233374868" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#233374868">(Apr 06 2021 at 19:28)</a>:</h4>
<p>Sure thing! I haven't don't much (anything) to keep it up to date, so let me know if there are any issues! (Or better yet, propose a fix in a PR ;-))</p>



<a name="242412239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/242412239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#242412239">(Jun 11 2021 at 22:42)</a>:</h4>
<p>Here is that docker image I shared at DevDays (I added a wrapper script called <code>nori</code> ) - <a href="https://github.com/Vermonster/shorthand-docker">https://github.com/Vermonster/shorthand-docker</a> </p>
<p>It has all the requirements to run sushi and IG Publisher. The idea is to help local development for people who don't want to install all the system requirements, but the image could also be used as a basis for CI/CD.</p>



<a name="261675277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Running%20sushi%20%2B%20publisher%20in%20Docker/near/261675277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Rouhana <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Running.20sushi.20.2B.20publisher.20in.20Docker.html#261675277">(Nov 16 2021 at 17:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> - the <a href="https://github.com/FHIR/auto-ig-builder/blob/master/images/ig-publisher-base/Dockerfile">ig-publisher-base image</a> seems to be exhibiting strange behavior. It doesn't actually update SUSHI until the <code>ENTRYPOINT</code>, so trying to build on top of the image and <code>RUN sushi .</code> during the build results in an older version of SUSHI being used:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>docker run --rm -it hl7fhir/ig-publisher-base:latest
. . .
publisher@92e879a8d4da:~/ig$ sushi --version
SUSHI v2.2.0 <span class="o">(</span>implements FHIR Shorthand specification v1.2.0<span class="o">)</span>
</code></pre></div>
<p>vs</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>docker build -t new-ig .
<span class="o">[</span>+<span class="o">]</span> Building <span class="m">11</span>.3s <span class="o">(</span><span class="m">12</span>/15<span class="o">)</span>
. . .
 <span class="o">=</span>&gt; <span class="o">[</span>ig-publisher <span class="m">1</span>/7<span class="o">]</span> FROM docker.io/hl7fhir/ig-publisher-base:lates  <span class="m">0</span>.0s
 <span class="o">=</span>&gt; CACHED <span class="o">[</span>ig-publisher <span class="m">2</span>/7<span class="o">]</span> WORKDIR /home/publisher/ig               <span class="m">0</span>.0s
 <span class="o">=</span>&gt; CACHED <span class="o">[</span>ig-publisher <span class="m">3</span>/7<span class="o">]</span> COPY src/. .                             <span class="m">0</span>.0s
 <span class="o">=</span>&gt; ERROR <span class="o">[</span>ig-publisher <span class="m">5</span>/7<span class="o">]</span> RUN sushi .                               <span class="m">8</span>.8s
------
 &gt; <span class="o">[</span>ig-publisher <span class="m">5</span>/7<span class="o">]</span> RUN sushi .:
<span class="c1">#12 2.000 info  Running SUSHI v2.0.1 (implements FHIR Shorthand specification v1.2.0)</span>
</code></pre></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
