---
layout: page
title: "FHIR Chat  · Snapshot versus Differential in FSH · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Snapshot.20versus.20Differential.20in.20FSH.html">Snapshot versus Differential in FSH</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="268612066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Snapshot%20versus%20Differential%20in%20FSH/near/268612066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hank Lenzi <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Snapshot.20versus.20Differential.20in.20FSH.html#268612066">(Jan 19 2022 at 22:20)</a>:</h4>
<p>Say I have a full spec (see below, for an Immunization profile template). The question is: is I define the <em>whole spec</em> (by which I mean: all the elements composing the Immunization Resource), then do I have a Snapshot? And if I <em>only</em> define some, then is is what I have a Differential?</p>
<div class="codehilite"><pre><span></span><code>// Following the tutorial:  https://www.youtube.com/watch?v=gPt_ZSpZlCc&amp;t=425s
// https://simplifier.net/DevDaysImmunization/ImmunizationProfile/~overview
// Modifies: https://www.hl7.org/fhir/immunization.html
// It seems sushiconfig.yaml already defines a lot of stuff, so how much should we put of metadata here???
// AAAAAHHHH → what sushi-yaml defines are IMPLEMENTATION GUIDE PROPERTIES. IT SAYS SO IN THE FILE ITSELF
// THE AUTHOR OF THE TUTORIAL IS USING ANOTHER TOOL - WE&#39;LL DO AS HE SAYS
Profile: ImmunizationProfile  // Name
Parent: Immunization
Id: immunization-profile
Title: &quot;Immunization profile&quot;
Description: &quot;This profile represents the contraints applied to the RESOURCE Immunization as determined by the medical regulatory authorities&quot;
// metadata: https://www.hl7.org/fhir/structuredefinition.html#metadata

* ^meta.lastUpdated = &quot;2022-02-18T19:37:00.003+00:00&quot;
* ^language = #pt-BR
* ^url = &quot;http://hank.lenzi.55/fhir/StructureDefinition/Immunization&quot;
* ^version = &quot;202201A&quot;
* ^status = #draft // draft | active | retired | unknown See: https://www.hl7.org/fhir/valueset-publication-status.html
* ^experimental = true // SD was drafted for education purposes
* ^date = &quot;2020-03-11T18:20:06.3399184+00:00&quot;
* ^publisher = &quot;Hank Lenzi&quot;
* ^purpose = &quot;Learn FHIR through FSH&quot;
// content = #complete
// contact
// useContext 0..
// jurisdiction 0..
// keyword 0..
// copyright 0..1
// fhirVersion 0..1
// mapping 0..
// kind 1..1 (primitive-type | complex-type | resource | logical)  Type: StructureDefinitionKind // It&#39;s implicitely a Resource, becasue the Parent is the RESOURCE  Immunization. This ain&#39;t JSON!
// type data Type is a &quot;uri&quot;. If it were JSON, you wold say: &quot;type&quot;: &quot;Immunization&quot;. This is implicit in FSH.
// context 0.. IF AN EXTENSION. This is a PROFILE
// contextInvariant 0..
// derivation - if this were JSON: &quot;derivation&quot;: &quot;contraint&quot;,
// description (markdown)
// ---------------------------------- END OF COMMON PART FOR STRUCTURE DEFINTIONS --------------------------------------------//
// ---------------------------------------------------------------------------------------------------------------------------//
// NOTE: WHAT YOU HAVE TO MATCH FROM HERE DOWN IS THE &quot;IMMUNIZATION&quot; RESOURCE https://www.hl7.org/fhir/immunization.html
// NOTE: The first item on the Resource Immunization structure is the DomainResource - which is the very Immunization resource.
// NOTE: The Resource Immunization page also duments the TERMINOLOGY BINDINGS for it: https://www.hl7.org/fhir/immunization.html#tx
// NOTE: The following Terminology bindings apply:
// Immunization.status  A set of codes indicating the current status of an Immunization.    Required    ImmunizationStatusCodes
// Immunization.statusReason    The reason why a vaccine was not administered.  Example ImmunizationStatusReasonCodes
// Immunization.vaccineCode The code for vaccine product administered.  Example VaccineAdministeredValueSet
// Immunization.reportOrigin    The source of the data for a record which is not from a primary source. Example ImmunizationOriginCodes
// Immunization.site    The site at which the vaccine was administered. Example CodesForImmunizationSiteOfAdministration
// Immunization.route   The route by which the vaccine was administered.    Example ImmunizationRouteCodes
// Immunization.performer.function  The role a practitioner or organization plays in the immunization event.    Extensible  ImmunizationFunctionCodes
// Immunization.reasonCode  The reason why a vaccine was administered.  Example ImmunizationReasonCodes
// Immunization.subpotentReason The reason why a dose is considered to be subpotent.    Example ImmunizationSubpotentReason
// Immunization.programEligibility  The patient&#39;s eligibility for a vaccation program.  Example ImmunizationProgramEligibility
// Immunization.fundingSource   The source of funding used to purchase the vaccine administered.    Example ImmunizationFundingSource
// Immunization.protocolApplied.targetDisease   The vaccine preventable disease the dose is being administered for. Example ImmunizationTargetDiseaseCodes
// EXAMPLE (INSTANCE): See below.
// We just go to the page for the Resource Immunization and copy stuff here
// identifier 0..
// -------------------------------------------- MANDATORY --------------------------------------------------------/
// status 1..1 ?!(←isMOdifier) (completed | entered-in-error | not-done) Type: code Immunization Status Codes
status 1..1
// --------------------------------------------------------------------------------------------------------------/

// statusReason 0..1 Type: CodeableConcept Immunization Status Reason Codes

// -------------------------------------------- MANDATORY --------------------------------------------------------/
// vaccineCode 1..1 Type: CodeableConcept Vaccine Administered Value Set
vaccineCode 1..1
// --------------------------------------------------------------------------------------------------------------/

// -------------------------------------------- MANDATORY --------------------------------------------------------/
// patient 1..1 Type: Reference(Patient)
patient 1..1
// --------------------------------------------------------------------------------------------------------------/

// encounter 0..1 Type: Reference(Encounter)

// -------------------------------------------- MANDATORY --------------------------------------------------------/
// occurrence[x] 1..1
//      +---------------&gt; occurrenceDateTime Type: dateTime
//      +---------------&gt; occurrenceString   Type: string
occurrence[x]
// --------------------------------------------------------------------------------------------------------------/

// recorded 0..1  Type: dateTime
// primarySource 0..1 Type: boolean
// reportOrigin 0..1 CodeableConcept
// location 0..1 Reference(Location)
// manufacturer 0..1 Reference(Organization)
// lotNumber 0..1 Type: string
// expirationDate 0..1 Type: date
// site 0..1 Type: CodeableConcept Codes for Immunization Site of Administration
// route 0..1 Type: CodeableConcept Immunization Route Codes
// doseQuantity 0..1 Type: SimpleQuantity

// ------------------------------    PART OF THE PROFILING SPECIFICATION ----------------------------------------/
// performer 0.. Type: BackboneElement
//      +--------------&gt; function 0..1 Type: CodeableConcept Immunization Function Codes (Extensible)
//      +--------------&gt; actor 1..1 Type: Reference(Practitioner | PractitionerRole | Organization)
* performer 1..1  // there must be a performer
* performer.function 0..1
* performer.actor only Reference(PractitionerRole)  // the performer must be played by the PratictionerRole
// --------------------------------------------------------------------------------------------------------------/

// note 0.. Type: Annotation
// reasonCode 0.. Type: CodeableConcept Immunization Reason Codes
// subpotentReason 0.. CodeableConcept Immunization Subpotent Reason

// ------------------------------    PART OF THE PROFILING SPECIFICATION ----------------------------------------/
// education 0.. Type: BackboneElement
//      +--------------&gt; documentType 0..1 Type: string
//      +--------------&gt; reference 0..1 Type: uri
//      +--------------&gt; publicationDate 0..1 Type: dateTime
//      +--------------&gt; presentationDate 0..1 Type: dateTime
* education 0..0
// --------------------------------------------------------------------------------------------------------------/

// programEligibility 0.. CodeableConcept Immunization Program Eligibility
// fundingSource 0..1 //      +--------------&gt; Type: CodeableConcept Immunization Funding Source

// ------------------------------    PART OF THE PROFILING SPECIFICATION ----------------------------------------/
// reaction     0..*    BackboneElement
//      +--------------&gt;  data      0..1    dateTime
//      +--------------&gt;  detail    0..1    Reference(Observation)
//      +--------------&gt;  reported  0..1    boolean
// --------------------------------------------------------------------------------------------------------------/

// protocolApplied  0..*    BackboneElement
//      +--------------&gt; series         0..1    string
//      +--------------&gt; authority      0..1    Reference(Organization)
//      +--------------&gt; targetDisease  0..*    CodeableConcept Immunization Target Disease Codes
//      +--------------&gt; doseNumber[x] 1..1
//                             +--------------&gt; doseNumberPositiveInt   positiveInt
//                             +--------------&gt; doseNumberString        string
//      +--------------&gt; seriesDoses[x] 0..1
//                             +--------------&gt; seriesDosesPositiveInt positiveInt
//                             +--------------&gt; seriesDosesString string
//
</code></pre></div>
<p>Thanks.<br>
-- Hank</p>



<a name="268618900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Snapshot%20versus%20Differential%20in%20FSH/near/268618900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Snapshot.20versus.20Differential.20in.20FSH.html#268618900">(Jan 19 2022 at 23:23)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="437401">@Hank Lenzi</span>.  I'm not sure if I fully understood your question, but basically:</p>
<p>The <strong>differential</strong> should contain only those things that are <em>different</em> from the parent.  For example, if you change a cardinality from <code>0..1</code> to <code>1..1</code> then the differential will contain that element (by <code>id</code> and <code>path</code>) with the new <code>min</code> value of <code>1</code>.  It does not need to contain anything else.  Some authors/tools may put unchanged data in the differential, but this is generally not necessary (except in some very limited edge cases where the IG Publisher needs it).</p>
<p>The <strong>snapshot</strong> contains every element in the structure with all the properties that were defined on each element.  It also reflects any of the changed values (from the differential) alongside all the unchanged values.  The snapshot is helpful for tooling that wants the whole picture.</p>
<p>So, in FSH, when you define profiles, you're usually specifying only what goes in the differential (w/ the exception of top-level properties like <code>^publisher</code>, <code>^purpose</code>, etc. that sit outside of the snapshot and differential).  When you run SUSHI, it will generate only the differential elements by default.  And then when you run the IG Publisher, it will generate the snapshot elements by merging the differential elements into the parent definition.  Does that help?</p>



<a name="268679872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Snapshot%20versus%20Differential%20in%20FSH/near/268679872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hank Lenzi <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Snapshot.20versus.20Differential.20in.20FSH.html#268679872">(Jan 20 2022 at 11:45)</a>:</h4>
<p>Gotcha! Thanks!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
