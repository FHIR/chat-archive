---
layout: page
title: "FHIR Chat  · adding extension to Instance · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html">adding extension to Instance</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="217768273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217768273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217768273">(Nov 24 2020 at 15:25)</a>:</h4>
<p>I'm trying to add an extension to Questionnaire.item:</p>
<div class="codehilite"><pre><span></span><code>item[0].extension[http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl].valueCoding = http://molit.eu/fhir/CodeSystem/questionnaire-codes-tbd#vas
</code></pre></div>



<a name="217768416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217768416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217768416">(Nov 24 2020 at 15:26)</a>:</h4>
<p>and getting: </p>
<blockquote>
<p>error The element or path you referenced does not exist: item.extension[http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl].valueCoding<br>
  File: /Users/patrickwerner/Downloads/fsh-tutorial-master/FishExampleComplete/input/fsh/Questionnaire.fsh<br>
  Line: 6<br>
error Cannot read property 'children' of undefined</p>
</blockquote>



<a name="217768855"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217768855" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217768855">(Nov 24 2020 at 15:29)</a>:</h4>
<p>Can't find the correct syntax for adding the extension content</p>



<a name="217787889"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217787889" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217787889">(Nov 24 2020 at 17:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191451">Patrick Werner</span> <a href="#narrow/stream/215610-shorthand/topic/adding.20extension.20to.20Instance/near/217768416">said</a>:</p>
<blockquote>
<p>and getting: </p>
<blockquote>
<p>error The element or path you referenced does not exist: item.extension[http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl].valueCoding<br>
  File: /Users/patrickwerner/Downloads/fsh-tutorial-master/FishExampleComplete/input/fsh/Questionnaire.fsh<br>
  Line: 6<br>
error Cannot read property 'children' of undefined</p>
</blockquote>
</blockquote>
<p>did you define the extension before in the questionnaire? What is this an instanceOf? <br>
and I think extensions can be referred to by id or name, not by url.</p>



<a name="217788025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217788025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217788025">(Nov 24 2020 at 17:37)</a>:</h4>
<p>If you haven't defined the extension, this should work:</p>
<ul>
<li>item[0].extension[0].valueCoding = <a href="http://molit.eu/fhir/CodeSystem/questionnaire-codes-tbd#vas">http://molit.eu/fhir/CodeSystem/questionnaire-codes-tbd#vas</a></li>
<li>item[0].extension[0].url = "<a href="http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl">http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl</a>"</li>
</ul>



<a name="217795311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217795311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217795311">(Nov 24 2020 at 18:32)</a>:</h4>
<p>I was running into a similar problem a week or two ago. You may be running into the fact that using the url for the array index only works in sushi 1+.</p>



<a name="217796001"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217796001" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217796001">(Nov 24 2020 at 18:37)</a>:</h4>
<p>i'm using SUSHI v1.0.1</p>



<a name="217796427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217796427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217796427">(Nov 24 2020 at 18:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191832">Jose Costa Teixeira</span> [said](<a href="#narrow/stream/215610-">https://chat.fhir.org/#narrow/stream/215610-</a><br>
did you define the extension before in the questionnaire? What is this an instanceOf? </p>
<p>no i didn't as it is a core extension, defined in the FHIR spec.<br>
So the syntax: <code>item[0].extension[http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl].valueCoding = http://molit.eu/fhir/CodeSystem/questionnaire-codes-tbd#vas</code>is not compliant to the FSH spec?</p>
<p>If yes, i'd like to make the proposal to add this syntax. Would be very neat to be able to add an Extension into an Instance with a single line statement.</p>



<a name="217796435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217796435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217796435">(Nov 24 2020 at 18:40)</a>:</h4>
<p>Well, that rules that issue out.</p>



<a name="217796704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217796704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217796704">(Nov 24 2020 at 18:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191832">Jose Costa Teixeira</span> <a href="#narrow/stream/215610-shorthand/topic/adding.20extension.20to.20Instance/near/217788025">said</a>:</p>
<blockquote>
<p>If you haven't defined the extension, this should work:</p>
<ul>
<li>item[0].extension[0].valueCoding = <a href="http://molit.eu/fhir/CodeSystem/questionnaire-codes-tbd#vas">http://molit.eu/fhir/CodeSystem/questionnaire-codes-tbd#vas</a></li>
<li>item[0].extension[0].url = "<a href="http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl">http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl</a>"</li>
</ul>
</blockquote>
<p>works. Thanks <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span></p>



<a name="217796831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217796831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217796831">(Nov 24 2020 at 18:43)</a>:</h4>
<p>What I did was</p>
<div class="codehilite"><pre><span></span><code>Alias: $ext-element-minValue    = http://hl7.org/fhir/StructureDefinition/minValue
...
* item[7].item[8].extension[$ext-element-minValue].valueInteger = 0
</code></pre></div>
<p>And this seems to work well.</p>



<a name="217798160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217798160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217798160">(Nov 24 2020 at 18:55)</a>:</h4>
<p>reading the FSH spec <code>{Extension name|id|url}</code> should be usable here, so i assume FSH allows it, but SUSHI isn't supporting it (yet)?<br>
Or am i missing a part of the spec which restricts the reference to an Extension to be name-only?</p>



<a name="217810587"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217810587" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217810587">(Nov 24 2020 at 20:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span> -- there are two issues at play here:</p>
<ol>
<li><code>questionnaire-itemControl</code>'s value is a <code>CodeableConcept</code>, so you must use <code>valueCodeableConcept</code>, not <code>valueCoding</code></li>
<li>I think you <em>should</em> be able to use the full URL there, but as you noted, it's not working in SUSHI.  As <span class="user-mention" data-user-id="191380">@Elliot Silver</span> suggested above, however, it works if you assign the URL to an alias and then reference the alias.</li>
</ol>
<p>Working example:</p>
<div class="codehilite"><pre><span></span><code>Alias: $item-control = http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl

Instance: MyQ
InstanceOf: Questionnaire
* status = #active
* item[0].extension[$item-control].valueCodeableConcept = http://molit.eu/fhir/CodeSystem/questionnaire-codes-tbd#vas
* item[0].linkId = &quot;foo&quot;
* item[0].type = #group
</code></pre></div>
<p>I'll log a bug about the URL not working directly.</p>



<a name="217811110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217811110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217811110">(Nov 24 2020 at 20:46)</a>:</h4>
<p><a href="https://github.com/FHIR/sushi/issues/674">SUSHI #674</a></p>



<a name="217813876"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/adding%20extension%20to%20Instance/near/217813876" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/adding.20extension.20to.20Instance.html#217813876">(Nov 24 2020 at 21:09)</a>:</h4>
<p>thx for the response and for creating the issue, wasn't 100% sure if i understood the FSH grammar correctly <span class="user-mention" data-user-id="191469">@Chris Moesel</span> <br>
i already changed the item to valueCodeableConcept (noticed during validation).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
