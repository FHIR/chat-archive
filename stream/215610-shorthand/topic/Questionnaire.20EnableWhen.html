---
layout: page
title: "FHIR Chat  · Questionnaire EnableWhen · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20EnableWhen.html">Questionnaire EnableWhen</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="272702998"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20EnableWhen/near/272702998" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marieke Span <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20EnableWhen.html#272702998">(Feb 21 2022 at 15:32)</a>:</h4>
<p>Does any of you know how to insert multiple EnableWhen elements in a questionnaire in FSH?</p>
<p>In a questionnaire I want to add 2 enablewhen elements. But when I insert two constrains by using EnableWhen, only the last one is set as a constraint. To make it clearer, here’s a simplified example of what I try  to do:</p>
<p>I have 2 attributes:<br>
Seasonality: In season, not in season<br>
Fruit type: Apple, Pear, Lemon, Strawberry, Pineapple</p>
<p>Some questions need to be enabled based on both attributes. E.g. :<br>
Question 1:<br>
Enable when "in season" and "apple, pear or lime"</p>
<p>I have tried the following type of code:</p>
<div class="codehilite"><pre><span></span><code>* enableWhen
  * question = &quot;Seasonality&quot;
  * operator = #=
  * answerCoding = SeasonalityCodeSystem#0       // SeasonalityCodeSystem#0 = “in season” 
* enableWhen
  * question = &quot;Fruit-Type&quot;
  * operator = #=
  * answerCoding = FruittypeCodeSystem#3             // FruittypeCodeSystem#3 = “apple”
* enableBehavior = #all
</code></pre></div>

<p>In this case I only used the FruitTypecode for apple but I want to use a list of codes (so with the codes for pear and lime), but I don’t know how. This also doesn't work since it only uses the fruittype = apple as a constraints.</p>



<a name="272712660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20EnableWhen/near/272712660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20EnableWhen.html#272712660">(Feb 21 2022 at 16:53)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="479768">@Marieke Span</span>.  Since <code>enableWhen</code> is multi-cardinality (e.g., <code>0..*</code> or an <em>array</em>), then you need to specify <em>indices</em> for each item.  In FHIR Shorthand, lists start at index <code>0</code> (an approach familiar to computer scientists, but perhaps less familiar to others).  So... you could do what you want like this:</p>
<div class="codehilite"><pre><span></span><code>* enableWhen[0]
  * question = &quot;Seasonality&quot;
  * operator = #=
  * answerCoding = SeasonalityCodeSystem#0       // SeasonalityCodeSystem#0 = “in season”
* enableWhen[1]
  * question = &quot;Fruit-Type&quot;
  * operator = #=
  * answerCoding = FruittypeCodeSystem#3             // FruittypeCodeSystem#3 = “apple”
* enableBehavior = #all
</code></pre></div>
<p>The reason for the behavior you were seeing is that FSH defaults the index to <code>0</code> if no index is provided.  So the first rule with <code>enableWhen</code> was interpreted as <code>enableWhen[0]</code>, but then when you wrote another rule with <code>enableWhen</code>, it was also interpreted as <code>enableWhen[0]</code> (overwriting the same element in the list).</p>



<a name="272713030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20EnableWhen/near/272713030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20EnableWhen.html#272713030">(Feb 21 2022 at 16:56)</a>:</h4>
<p>BUT... FSH also provides a simpler syntax for working with arrays so that you don't need to keep track of the numbers.  In this syntax, you use <code>[+]</code> to indicate you want to increment to the next index in the list.  If you use <code>[=]</code>, then that means you want to stay at the current index in the list.  The first time you use <code>[+]</code>, it will be interpreted as <code>[0]</code> (if you didn't add any items to the list before that).</p>
<p>So you also could have written your FSH like this:</p>
<div class="codehilite"><pre><span></span><code>* enableWhen[+]
  * question = &quot;Seasonality&quot;
  * operator = #=
  * answerCoding = SeasonalityCodeSystem#0       // SeasonalityCodeSystem#0 = “in season”
* enableWhen[+]
  * question = &quot;Fruit-Type&quot;
  * operator = #=
  * answerCoding = FruittypeCodeSystem#3             // FruittypeCodeSystem#3 = “apple”
* enableBehavior = #all
</code></pre></div>
<p>This is all documented in the FSH spec starting here: <a href="http://hl7.org/fhir/uv/shorthand/reference.html#array-paths-using-numerical-indices">http://hl7.org/fhir/uv/shorthand/reference.html#array-paths-using-numerical-indices</a></p>



<a name="272774988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Questionnaire%20EnableWhen/near/272774988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marieke Span <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Questionnaire.20EnableWhen.html#272774988">(Feb 22 2022 at 08:55)</a>:</h4>
<p>Thank you so much, that was very helpful and it makes total sense! I can now fin-fish my questionnaires!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
