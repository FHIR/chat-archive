---
layout: page
title: "FHIR Chat  · Bug: Slice name equals Resource type · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Bug.3A.20Slice.20name.20equals.20Resource.20type.html">Bug: Slice name equals Resource type</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="273253855"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Bug%3A%20Slice%20name%20equals%20Resource%20type/near/273253855" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yannick Börner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Bug.3A.20Slice.20name.20equals.20Resource.20type.html#273253855">(Feb 25 2022 at 16:55)</a>:</h4>
<p>Before opening an issue on Github, I'd just like to check whether this is intended behaviour. Suppose the slice name equals a resource type, like this: </p>
<div class="codehilite"><pre><span></span><code>* subject 1.. MS
  * ^slicing.discriminator.type = #type
  * ^slicing.discriminator.path = &quot;resolve()&quot;
  * ^slicing.rules = #open
* subject contains Patient 1..1 MS
* subject[Patient] only Reference(Patient)
</code></pre></div>
<p>SUSHI will not actually generate a <code>type</code> element in the StructureDefinition, so the type is not restricted to Patient in this slice. I am wondering whether this is not supposed to work in the first place (i.e. slice name == resource type) or if this is indeed a bug?</p>



<a name="273258783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Bug%3A%20Slice%20name%20equals%20Resource%20type/near/273258783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Bug.3A.20Slice.20name.20equals.20Resource.20type.html#273258783">(Feb 25 2022 at 17:29)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="260054">@Yannick Börner</span>.  Can you provide a little more information about what you are trying to do?  If this is for <code>Observation.subject</code>, then <code>Observation.subject</code> is not a list.  Since it seems like you are saying that the Patient reference is <code>1..1 MS</code>, then isn't that basically the same as this?</p>
<div class="codehilite"><pre><span></span><code>* subject 1..1 MS
* subject only Reference(Patient)
</code></pre></div>
<p>Or is there some other nuance I am missing?</p>



<a name="273510251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Bug%3A%20Slice%20name%20equals%20Resource%20type/near/273510251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yannick Börner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Bug.3A.20Slice.20name.20equals.20Resource.20type.html#273510251">(Feb 28 2022 at 15:54)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191469">@Chris Moesel</span> , certainly! The profile in question is <a href="https://simplifier.net/isik-basis-2/isikabrechnungsfall">this profile on Account</a>. What I am trying to achieve is the following: </p>
<ul>
<li>Allow several subject references</li>
<li>However, a minimum of one Patient reference must exist </li>
</ul>
<p>In my understanding, the FSH above should cover these requirements. That's where I stumbled upon the above error, where the <code>type</code> element is not generated if the slice is called 'Patient'. If I rename it to something other than a resource type, everything works.</p>



<a name="273690709"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Bug%3A%20Slice%20name%20equals%20Resource%20type/near/273690709" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Bug.3A.20Slice.20name.20equals.20Resource.20type.html#273690709">(Mar 01 2022 at 18:47)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="260054">@Yannick Börner</span>.  Now that I think of it, I bet you're running into an unintended consequence of our <a href="http://hl7.org/fhir/uv/shorthand/reference.html#reference-paths">reference path syntax</a>.  When you say <code>subject[Patient]</code> it thinks you are referring to the <code>Patient</code> <em>reference</em> in the <code>subject</code> element, not the <code>Patient</code> <em>slice</em>.  That's unfortunate (especially since reference paths actually have very limited use) -- but I don't see any way around it.  So I guess we <em>do</em> have a limitation that you can't name a slice something that is also the name of a resource when that element also has a reference to the same resource.  Sorry about that!</p>



<a name="273973114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Bug%3A%20Slice%20name%20equals%20Resource%20type/near/273973114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yannick Börner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Bug.3A.20Slice.20name.20equals.20Resource.20type.html#273973114">(Mar 03 2022 at 13:38)</a>:</h4>
<p>All fine and dandy, this is why I wanted to ask before opening an issue :-) Thank you for looking into it! Should we improve the error message though?</p>



<a name="273979826"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Bug%3A%20Slice%20name%20equals%20Resource%20type/near/273979826" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Bug.3A.20Slice.20name.20equals.20Resource.20type.html#273979826">(Mar 03 2022 at 14:26)</a>:</h4>
<p>Yeah, I'll have to see if we can easily detect that situation and warn on it.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
