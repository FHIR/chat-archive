---
layout: page
title: "FHIR Chat  · sushi: issues with pattern slicing and complex extensions · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html">sushi: issues with pattern slicing and complex extensions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="225142544"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225142544" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225142544">(Feb 04 2021 at 10:34)</a>:</h4>
<p>I'm trying to create an example Instance of this profile: <a href="https://simplifier.net/erezeptabgabedaten/abrechnungszeilen-duplicate-2">https://simplifier.net/erezeptabgabedaten/abrechnungszeilen-duplicate-2</a></p>



<a name="225142576"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225142576" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225142576">(Feb 04 2021 at 10:35)</a>:</h4>
<p>lineItem.chargeItemCodeableConcept is sliced by pattern, all Codings are 0..1</p>



<a name="225142665"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225142665" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225142665">(Feb 04 2021 at 10:36)</a>:</h4>
<p>sushi complains about the Coding: </p>
<div class="codehilite"><pre><span></span><code>error Cannot assign [object Object] to this element; a different Coding is already assigned: {&quot;system&quot;:&quot;http://TA1.abda.de&quot;}.
  File: /Users/patrickwerner/IdeaProjects/shushi-playground/input/fsh/abrechnungszeilen.fsh
  Line: 9
</code></pre></div>



<a name="225142725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225142725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225142725">(Feb 04 2021 at 10:37)</a>:</h4>
<p><a href="http://TA1.abda.de">http://TA1.abda.de</a> is also a valid system uri from another slice. If i change it to this system, sushi now complains about another system.uri of the 3 slices.</p>



<a name="225142883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225142883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225142883">(Feb 04 2021 at 10:39)</a>:</h4>
<p><a href="https://github.com/patrick-werner/shushi-playground/blob/main/input/fsh/abrechnungszeilen.fsh">https://github.com/patrick-werner/shushi-playground/blob/main/input/fsh/abrechnungszeilen.fsh</a></p>



<a name="225142903"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225142903" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225142903">(Feb 04 2021 at 10:39)</a>:</h4>
<p>You can check out the whole project, needed snapshot of profile already included.</p>



<a name="225142988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225142988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225142988">(Feb 04 2021 at 10:40)</a>:</h4>
<p>Second Issue: <br>
This profile uses this Extension: <a href="https://simplifier.net/erezeptabgabedaten/zusatzattribute">https://simplifier.net/erezeptabgabedaten/zusatzattribute</a></p>



<a name="225145159"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225145159" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225145159">(Feb 04 2021 at 11:05)</a>:</h4>
<p>sushi can't find the element: </p>
<div class="codehilite"><pre><span></span><code> The element or path you referenced does not exist: lineItem.extension[http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/Zusatzattribute].extension[ZusatzattributFAM].extension[Markt].extension[Gruppe].valueCodeableConcept
</code></pre></div>



<a name="225145304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225145304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225145304">(Feb 04 2021 at 11:07)</a>:</h4>
<p>but this is the correct path (i think)</p>



<a name="225145592"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225145592" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225145592">(Feb 04 2021 at 11:10)</a>:</h4>
<p>fsh file: <a href="https://github.com/patrick-werner/shushi-playground/blob/main/input/fsh/abrechnungszeilen-Extension.fsh">https://github.com/patrick-werner/shushi-playground/blob/main/input/fsh/abrechnungszeilen-Extension.fsh</a></p>



<a name="225145651"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225145651" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225145651">(Feb 04 2021 at 11:11)</a>:</h4>
<p>git link: git@github.com:patrick-werner/shushi-playground.git</p>



<a name="225154135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225154135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225154135">(Feb 04 2021 at 12:47)</a>:</h4>
<p>It looks like the first issue is some sort of bug, we will need to investigate more to figure out exactly what is going on, but I think you can accomplish what you want by doing this:</p>
<div class="codehilite"><pre><span></span><code>* lineItem[0].chargeItemCodeableConcept.coding[PZN] = http://fhir.de/CodeSystem/ifa/pzn#1
</code></pre></div>
<p>For the second issue, it looks like there is no definition available to SUSHI for the <a href="http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/Zusatzattribute">http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/Zusatzattribute</a> extension. SUSHI needs to have the definition of that extension (and any sub extensions) available, in the same way you've made the Abrechnungszeilen profile available.</p>



<a name="225161986"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225161986" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225161986">(Feb 04 2021 at 13:57)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="239822">@Nick Freiter</span> !!!</p>



<a name="225172145"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225172145" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225172145">(Feb 04 2021 at 15:13)</a>:</h4>
<p>Ok i applied the first work around, works, thanks again <span class="user-mention" data-user-id="239822">@Nick Freiter</span> <br>
I now also included the whole underlying IG (including the Extension in question) as snapshots into the project, still the same error on the extension: </p>
<div class="codehilite"><pre><span></span><code>error The element or path you referenced does not exist: lineItem.extension[http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/Zusatzattribute].extension[ZusatzattributFAM].extension[Markt].extension[Gruppe].valueCodeableConcept
  File: /Users/patrickwerner/IdeaProjects/shushi-playground/input/fsh/abrechnungszeilen-Extension.fsh
  Line: 10
</code></pre></div>



<a name="225175483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225175483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225175483">(Feb 04 2021 at 15:34)</a>:</h4>
<p>path from the Extension StrucDef: <code>"id": "Extension.extension:ZusatzattributFAM.extension:Markt.extension:Gruppe"</code></p>



<a name="225178905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225178905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225178905">(Feb 04 2021 at 15:58)</a>:</h4>
<p>It looks like the URL for the first extension may be different from the URL in the StructureDefinition you are loading in. Does this work:</p>
<div class="codehilite"><pre><span></span><code>* lineItem[=].extension[http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/Extension-Zusatzattribute].extension[ZusatzattributFAM].extension[Markt].extension[Gruppe].valueCodeableConcept = http://fhir.abda.de/eRezeptAbgabedaten/CodeSystem/Zusatzattribut-Gruppe#1
</code></pre></div>
<p>You should also be able to just simply reference the Extension more simply by name: </p>
<div class="codehilite"><pre><span></span><code>* lineItem[=].extension[Zusatzattribute].extension[ZusatzattributFAM].extension[Markt].extension[Gruppe].valueCodeableConcept = http://fhir.abda.de/eRezeptAbgabedaten/CodeSystem/Zusatzattribut-Gruppe#1
</code></pre></div>



<a name="225208818"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225208818" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225208818">(Feb 04 2021 at 19:22)</a>:</h4>
<p>oh the url got changed and i missed it. <span class="user-mention" data-user-id="239822">@Nick Freiter</span> thanks so much again.</p>



<a name="225208926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225208926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225208926">(Feb 04 2021 at 19:23)</a>:</h4>
<p>problem of a mixed Forge/Sushi project. Will convince my client to fully move to sushi.</p>



<a name="225209352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/sushi%3A%20issues%20with%20pattern%20slicing%20and%20complex%20extensions/near/225209352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/sushi.3A.20issues.20with.20pattern.20slicing.20and.20complex.20extensions.html#225209352">(Feb 04 2021 at 19:26)</a>:</h4>
<p>What do you think about giving out a dedicated warning/error if an Instance references something unknown? Instead of reporting the non-existing element, the fact that the referenced StrucDef is missing would be nice and direct people to the causing issue.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
