---
layout: page
title: "FHIR Chat  · Slicing cardinalits validation Error · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html">Slicing cardinalits validation Error</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="253733978"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/253733978" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#253733978">(Sep 17 2021 at 12:28)</a>:</h4>
<p>I think i found a bug in the slicing valdidation:<br>
If you set a sliced element to 0..0 and the element contains slices sushi reports an error:</p>
<blockquote>
<p>error No individual slice may have max &gt; max of sliced element, but max of slice valueQuantity (1) &gt; max of sliced element (0).</p>
</blockquote>
<p><a href="https://www.hl7.org/fhir/profiling.html#slice-cardinality">https://www.hl7.org/fhir/profiling.html#slice-cardinality</a> enforces this rule for the min card.. but not the max cardinality.<br>
Created an issue:<br>
<a href="https://github.com/FHIR/sushi/issues/918">https://github.com/FHIR/sushi/issues/918</a></p>



<a name="253736364"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/253736364" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#253736364">(Sep 17 2021 at 12:49)</a>:</h4>
<p>Thanks for reporting...  I think the main thing SUSHI is trying to enforce is that if an array can only have <em>x</em> elements, then it's wrong to say that any slice within it can have <em>x+1</em> elements.  For example, it doesn't make sense to say "no components allowed" but also say "up to one systolic component is allowed and up to one diastolic component is allowed".</p>
<p>This error is most helpful when an author is adding slices to an array whose cardinality has already been constrained -- because their new slice constraint is obviously incorrect.  But I agree that it's a bit more confusing when it happens because you card-constrain an array that is <em>already</em> sliced (and the new array constraint allows fewer elements than some of the slices do).  I guess the questions are (a) would the author still want to know that (in case it is unintentional)? (b) Should we force the other to also reconstrain the slices to fit within the overall array max? (c) Should SUSHI reconstrain those slices for them? Or (d) should we just let it go as-is even though it introduces inconsistency between the slices and container?</p>



<a name="253941656"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/253941656" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#253941656">(Sep 19 2021 at 12:25)</a>:</h4>
<p>Would it be possible for SUSHI to distinguish between (a)  the case where there is a contradiction in the slice/element cardinalities defined within a <em>single</em> profile, and (b) the case where the contradiction is between constraints in a base and a derived profile? If I read the example from <span class="user-mention" data-user-id="191451">@Patrick Werner</span> correctly, he is talking about case (b) where my feeling is that a warning would do. However, I also think that an error is still appropriate in case (a) since I cannot imagine a case where a cardinality-contradiction is on purpose in that scenario.</p>



<a name="254012340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254012340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254012340">(Sep 20 2021 at 08:09)</a>:</h4>
<p>+1 to all what <span class="user-mention" data-user-id="194703">@Morten Ernebjerg</span>  said.</p>



<a name="254012515"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254012515" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254012515">(Sep 20 2021 at 08:10)</a>:</h4>
<p>I only would make it a warning in either way as this isn't forbidden by the FHIR spec.</p>



<a name="254527575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254527575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254527575">(Sep 23 2021 at 12:39)</a>:</h4>
<p>i assume there is no workaround, and we have to wait for the next version?</p>



<a name="254536174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254536174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254536174">(Sep 23 2021 at 13:37)</a>:</h4>
<p>Well... the workaround is to add rules to restrict the card of the slices so they fit within the overall card of the container.  But if you're asking for a workaround to remove the error... no, I don't think we have one at this point.  We haven't started working on a solution for this yet, but we start a new development sprint today, so we'll try to fit it into the list for the next two weeks.</p>



<a name="254538809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254538809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254538809">(Sep 23 2021 at 13:55)</a>:</h4>
<p>that would be wonderful. <br>
Unfortunately i'm deriving from another Profile, defining these slices, but i need to set the whole element to 0..0</p>



<a name="254538896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254538896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254538896">(Sep 23 2021 at 13:56)</a>:</h4>
<p>I think this is a very common use-case, will provide structured comments in the issue</p>



<a name="254549431"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254549431" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254549431">(Sep 23 2021 at 14:56)</a>:</h4>
<p>Updated the Issue with expected behaviour</p>



<a name="254553611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254553611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254553611">(Sep 23 2021 at 15:20)</a>:</h4>
<blockquote>
<p>Unfortunately i'm deriving from another Profile, defining these slices, but i need to set the whole element to 0..0</p>
</blockquote>
<p>Yeah, but just to be clear, you should still be able to zero out the inherited slices via something like:</p>
<div class="codehilite"><pre><span></span><code>* component[inheritedSliceName] 0..0
</code></pre></div>
<p>You might have to do that <em>before</em> setting the sliced element to 0..0.  But that should get you around the error for now.</p>



<a name="254670865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/254670865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#254670865">(Sep 24 2021 at 08:41)</a>:</h4>
<p>thanks for the workaround, so obvious</p>



<a name="256234340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/256234340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#256234340">(Oct 05 2021 at 12:14)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span> - I re-read that part of the spec you linked to and realized that it seemed like it <em>does</em> say that the slice max cannot be greater than the element max.  It just doesn't say it very clearly.  So I asked about it separately and Grahame confirmed the intent: "slice max can't be greater than element max".  So SUSHI is, in fact, enforcing FHIR spec here...  So now I'm wondering if we run into this situation if we should just issue a warning and automatically reduce all maxes to be no greater than the element max.</p>



<a name="256250487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/256250487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#256250487">(Oct 05 2021 at 14:02)</a>:</h4>
<p>Thanks for your effort <span class="user-mention" data-user-id="191469">@Chris Moesel</span></p>



<a name="256250595"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/256250595" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#256250595">(Oct 05 2021 at 14:03)</a>:</h4>
<p>I agree , if the outcome of the other thread is: you have to set each slice to 0..0 manually.</p>



<a name="256250727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slicing%20cardinalits%20validation%20Error/near/256250727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slicing.20cardinalits.20validation.20Error.html#256250727">(Oct 05 2021 at 14:04)</a>:</h4>
<p>Sushi issuing a warning and automatically setting all slices to 0..0 would be very convinient</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
