---
layout: page
title: "FHIR Chat  · Issue creating Bundle instance · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html">Issue creating Bundle instance</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="188350838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188350838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alejandro Metke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188350838">(Feb 17 2020 at 03:45)</a>:</h4>
<p>I am trying to create an instance of a Bundle in FSH but I am getting errors in Sushi. Here is a fragment of my FSH file:</p>
<div class="codehilite"><pre><span></span>Instance: RareDiseaseBundle
InstanceOf: Bundle
Title: &quot;Rare Disease Bundle&quot;
* type = #document
* identifier.system = &quot;http://ga4gh.org/fhir/phenopackets/&quot;
* identifier.value = &quot;1&quot;
* entry[0].resource = RareDiseasePhenopacket
* entry[1].resource = Proband
</pre></div>


<p>RareDiseasesPhenopacket is a Composition instance and Proband is a Patient instance. Here is the error message that I get:</p>
<div class="codehilite"><pre><span></span>error: mismatched input &#39;RareDiseasePhenopacket&#39; expecting {&#39;true&#39;, &#39;false&#39;, STRING, MULTILINE_STRING, NUMBER, CODE, DATETIME, TIME, REFERENCE}
  File: /Users/met045/CSIRO/workspaces/projects/fhir-phenopackets/phenopackets-examples.fsh
  Line: 128
</pre></div>


<p>Note that the entries are not references to the resources but the actual resources that are meant to be contained in the bundle. Is this supported by Sushi or am I missing something?</p>



<a name="188375855"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188375855" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188375855">(Feb 17 2020 at 12:57)</a>:</h4>
<p>SUSHI doesn't support that type of syntax. To SUSHI, <code>entry</code> is an array of type <code>Resource</code>, so each entry can only have the fields defined on <code>Resource</code> itself (<code>id</code>, <code>meta</code>, <code>implicitRules</code>, <code>language</code>). So a valid <code>Bundle</code> could look something like this:</p>
<div class="codehilite"><pre><span></span>Instance: MyBundle
InstanceOf: Bundle
* entry[0].resource.id = &quot;resource-1&quot;
* entry[1].resource.id = &quot;resource-2&quot;
</pre></div>


<p>This issue has also recently come up in the context of contained resources, <a href="#narrow/stream/215610-shorthand/topic/contained.20resources" title="#narrow/stream/215610-shorthand/topic/contained.20resources">https://chat.fhir.org/#narrow/stream/215610-shorthand/topic/contained.20resources</a>, and one of the approaches we are considering is the one you attempted to use here, allowing <code>Instances</code> to be inserted inline into another <code>Instance</code> that has a field of type <code>Resource</code>. It's helpful to see that that seemed like a natural approach for you.  But we are tracking this and plan to address it.</p>



<a name="188378247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188378247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188378247">(Feb 17 2020 at 13:34)</a>:</h4>
<p>It's interesting that no one has tried to do this yet until now, and in the last few days we've received reports from three separate people.  It sounds like we should try to fast-track a solution on this one.</p>



<a name="188378337"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188378337" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188378337">(Feb 17 2020 at 13:36)</a>:</h4>
<p>this = you mean contained resources?</p>



<a name="188378473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188378473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188378473">(Feb 17 2020 at 13:39)</a>:</h4>
<p>this = creating instances w/ inlined (not referenced) resources -- which applies to both <code>contained</code> as well a <code>bundle</code> entries.  I thinking whatever approach we use for one will likely apply to the other as well.</p>



<a name="188381432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188381432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188381432">(Feb 17 2020 at 14:22)</a>:</h4>
<p>that is the same thing, right?</p>



<a name="188381496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188381496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188381496">(Feb 17 2020 at 14:22)</a>:</h4>
<p>Both DomainResource and Bundle have elements whose type is Resource</p>



<a name="188396131"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188396131" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188396131">(Feb 17 2020 at 17:46)</a>:</h4>
<blockquote>
<p>entry is an array of type Resource, </p>
</blockquote>
<p>Just being pedantic - entry is a Backbone element so the array type is not Resource - right? And you can set the other entry elements (I checked) :) ...</p>



<a name="188397302"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188397302" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188397302">(Feb 17 2020 at 18:04)</a>:</h4>
<p>Right -- the <code>resource</code> is actually a field in each bundle entry.</p>



<a name="188410730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188410730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alejandro Metke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188410730">(Feb 17 2020 at 22:31)</a>:</h4>
<p>Great! Glad that you are thinking about a way to address this. It's not critical for me at the moment but definitively a nice to have.</p>



<a name="188584218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188584218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188584218">(Feb 19 2020 at 20:52)</a>:</h4>
<p>So I've thought of this a bit more and wanted to get some input.  I'm thinking we probably want to support a by-reference approach (like <span class="user-mention" data-user-id="191345">@Alejandro Metke</span> tried to do) and an inline approach.</p>



<a name="188584329"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188584329" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188584329">(Feb 19 2020 at 20:54)</a>:</h4>
<p>For the By-Reference approach, we'd also want a way to flag that the inlined instances should not result in indepedendent instances being exported (we only want the top-level instance), so maybe something like:</p>
<div class="codehilite"><pre><span></span>Instance: ShortyBundle
InstanceOf: Bundle
* type = #collection
* entry[0].resource = Shorty
* entry[1].resource = Ick

Instance: Shorty
InlineInstanceOf: Patient
* name[0].given[0] = &quot;Shorty&quot;
* name[0].family = &quot;Fish&quot;

Instance: Ick
InlineInstanceOf: Condition
* code = SCT#12345 &quot;Ick&quot;
</pre></div>



<a name="188584428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188584428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188584428">(Feb 19 2020 at 20:55)</a>:</h4>
<p>For the inline approach, we need a way to indicate to SUSHI what the inlined type is.  So maybe something like this:</p>
<div class="codehilite"><pre><span></span>Instance: ShortyBundle
InstanceOf: Bundle
* type = #collection
* entry[0].resource instanceOf Patient
* entry[0].resource.id = &quot;Shorty&quot;
* entry[0].resource.name[0].given[0] = &quot;Shorty&quot;
* entry[0].resource.name[0].family = &quot;Fish&quot;
* entry[1].resource instanceOf Condition
* entry[1].resource.id = &quot;Ick&quot;
* entry[1].resource.code = SCT#12345 &quot;Ick&quot;
</pre></div>



<a name="188584640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188584640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188584640">(Feb 19 2020 at 20:58)</a>:</h4>
<p>Both of these would also apply to things like <code>contained</code> -- but also in cases where you want an instance to use a profile as a path value (e.g., in an instance of Observation, make <code>valueQuantity</code> an instance of a specific profile on Quantity).</p>



<a name="188584714"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188584714" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188584714">(Feb 19 2020 at 20:59)</a>:</h4>
<p>Anyway, feedback is welcome and appreciated.</p>



<a name="188585353"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188585353" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Kramer <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188585353">(Feb 19 2020 at 21:06)</a>:</h4>
<p>I think you have this backwards:</p>
<div class="codehilite"><pre><span></span>Instance: Ick
InlineInstanceOf: Condition
</pre></div>


<p>It seems more clear as:</p>
<div class="codehilite"><pre><span></span>InlineInstance: Ick
InstanceOf: Condition
</pre></div>


<p>Would <code>ContainedInstance</code> be better?</p>



<a name="188606924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188606924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188606924">(Feb 20 2020 at 03:11)</a>:</h4>
<p>Which is the parent resource? It can't be Bundle...</p>



<a name="188607175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188607175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188607175">(Feb 20 2020 at 03:18)</a>:</h4>
<blockquote>
<p>I think you have this backwards:</p>
</blockquote>
<p>Actually, the reason I suggested it that way was for consistency w/ how we're treating example.  I believe that the consensus was that:</p>
<p>Conformance instances should be:</p>
<div class="codehilite"><pre><span></span>Instance: MyCapabilityStatement
InstanceOf: CapabilityStatement
</pre></div>


<p>and examples should be:</p>
<div class="codehilite"><pre><span></span>Instance: MyCondition
ExampleOf: Condition
</pre></div>


<p>So... it seems like the consistent approach is that ALL instances are <code>Instance</code>s, but that the second keyword (<code>InstanceOf</code>, <code>ExampleOf</code>, <code>InlineInstanceOf</code>) indicates the context.</p>



<a name="188607322"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188607322" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188607322">(Feb 20 2020 at 03:23)</a>:</h4>
<p>That said, we haven't implemented that for examples yet, so I am 100% fine with walking that back and changing it such that we have:</p>
<div class="codehilite"><pre><span></span>ConformanceInstance: MyCapabilityStatement
InstanceOf: CapabilityStatement
//...

Example: MyCondition
InstanceOf: Condition
//...

ContainedInstance: MyContainedCondition
InstanceOf: Condition
//...
</pre></div>


<p>In fact, I think I personally prefer something like that (but can't decide exactly on the names <code>Instance</code> vs <code>ConformanceInstance</code> vs <code>Conformance</code> -- or <code>ContainedInstance</code> vs <code>Contained</code>)...</p>



<a name="188607398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188607398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188607398">(Feb 20 2020 at 03:25)</a>:</h4>
<p>Another approach:</p>
<div class="codehilite"><pre><span></span>Instance: MyCapabilityStatement
InstanceOf: CapabilityStatement
Type: Conformance
//...

Instance: MyCondition
InstanceOf: Condition
Type: Example
//...

Instance: MyContainedCondition
InstanceOf: Condition
Type: Contained // or Inline
//...
</pre></div>


<p>Oh.  I think I like that one best, even if it is more lines of FSH.  I feel like it is easier to remember.</p>



<a name="188632051"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188632051" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188632051">(Feb 20 2020 at 12:20)</a>:</h4>
<p>I'd vote for that last syntax,. Maybe we make <code>Type: Example</code> the default? Since that has pretty much been the default so far.</p>



<a name="188632316"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188632316" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188632316">(Feb 20 2020 at 12:24)</a>:</h4>
<p>How can we make a contained resource inside a resource inside a bundle?</p>



<a name="188632321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188632321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188632321">(Feb 20 2020 at 12:24)</a>:</h4>
<p>I think whatever syntax it is, must support that</p>



<a name="188632333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188632333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188632333">(Feb 20 2020 at 12:25)</a>:</h4>
<p>must/should (but I think Must)</p>



<a name="188637483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188637483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188637483">(Feb 20 2020 at 13:41)</a>:</h4>
<blockquote>
<p>How can we make a contained resource inside a resource inside a bundle?</p>
</blockquote>
<p>I think either syntax (the by-reference or inline syntax) would support this.  You're just reapplying the same approach at a different level of the path.  Do you want an example, or does that make sense as I described it?</p>



<a name="188641214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641214">(Feb 20 2020 at 14:25)</a>:</h4>
<p>I struggle with the "Type". And where do we indicate what is it contained in?</p>



<a name="188641240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641240">(Feb 20 2020 at 14:25)</a>:</h4>
<p>Say we have a bundle of 2 prescriptions, each with contained medication</p>



<a name="188641255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641255">(Feb 20 2020 at 14:25)</a>:</h4>
<p>what will the fsh look like?</p>



<a name="188641324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641324">(Feb 20 2020 at 14:26)</a>:</h4>
<p>how do we say that prescription 1 has medication 1 and prescription 2 has medication 2?</p>



<a name="188641348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641348">(Feb 20 2020 at 14:26)</a>:</h4>
<p>I was thinking that this is done by nesting or pointing to the parent.</p>



<a name="188641383"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641383" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641383">(Feb 20 2020 at 14:27)</a>:</h4>
<p>(in which case "Type=contained" is redundant, right?)</p>



<a name="188641413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641413">(Feb 20 2020 at 14:27)</a>:</h4>
<p>and actually while typing this i realized:</p>



<a name="188641567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641567">(Feb 20 2020 at 14:29)</a>:</h4>
<p>Yes, please give an example FSH (can be the example I mention). <br>
Normally I would not ask that because it could be a lot of work to make and read those resources,  but that is no longer a big issue with FSH.</p>



<a name="188641670"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188641670" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188641670">(Feb 20 2020 at 14:30)</a>:</h4>
<p>Which is really cool, and I'm grateful .You made it easier to share examples in FSH form, so yes, let's see it.</p>



<a name="188642903"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188642903" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188642903">(Feb 20 2020 at 14:41)</a>:</h4>
<p>So if you use the proposed syntax that allows you to define a "contained" resource separately (with <code>Type: Contained</code>) -- that "contained" resource is re-usable.  <em>It</em> doesn't point to the instance that contains it.  Rather, the instance that contains it explicitly references it by name.  I can provide an example later, but right now have to head into some meetings.  That said, your question has given me another idea as well -- so I'll see if I can work that idea into the example too.</p>



<a name="188644616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188644616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188644616">(Feb 20 2020 at 14:57)</a>:</h4>
<p>Also -- I think that since these instances can be used in <code>contained</code> (literally <em>contained</em>) as well as in other places that allow inline resource instances -- maybe it makes sense for the <code>Type</code> to be <code>Inline</code>, otherwise there might be confusion.</p>



<a name="188648129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188648129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188648129">(Feb 20 2020 at 15:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> -- here is an example of your scenario using one of the proposed syntaxes:</p>
<div class="codehilite"><pre><span></span>Instance: PrescriptionBundle
InstanceOf: Bundle
Type: Example
* entry[0].resource = Prescription1
* entry[1].resource = Prescription2
// ... more rules

Instance: Prescription1
InstanceOf: MedicationRequest
Type: Inline
* contained[0] = Medication1
* medicationReference = &quot;#Medication1&quot;
// ... more rules

Instance: Prescription2
InstanceOf: MedicationRequest
Type: Inline
* contained[0] = Medication2
* medicationReference = &quot;#Medication2&quot;
// ... more rules

Instance: Medication1
InstanceOf: Medication
Type: Inline
* code = RXNORM#12345
// ... more rules

Instance: Medication2
InstanceOf: Medication
Type: Inline
* code = RXNORM#67890
// ... more rules
</pre></div>



<a name="188648342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188648342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188648342">(Feb 20 2020 at 15:34)</a>:</h4>
<p>Since all but the bundle have <code>Type: Inline</code> -- the only resource that is actually exported is the bundle -- but it has <code>Prescription1</code> and <code>Prescription2</code> inlined in the <code>entry.resource</code> array, <code>Medication1</code> inlined in <code>Prescription1</code>'s <code>contained</code> array, and <code>Medication2</code> inlined in <code>Prescription2</code>'s <code>contained</code> array.</p>



<a name="188648397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188648397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188648397">(Feb 20 2020 at 15:35)</a>:</h4>
<p>(deleted)</p>



<a name="188648613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188648613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188648613">(Feb 20 2020 at 15:37)</a>:</h4>
<p>But this led me to the idea that this is needlessly verbose:</p>
<div class="codehilite"><pre><span></span>Instance: Prescription1
InstanceOf: MedicationRequest
Type: Inline
* contained[0] = Medication1
* medicationReference = &quot;#Medication1&quot;
// ... more rules
</pre></div>


<p>We could support using the reference directly like this as well:</p>
<div class="codehilite"><pre><span></span>Instance: Prescription1
InstanceOf: MedicationRequest
Type: Inline
* medicationReference = Medication1
// ... more rules
</pre></div>


<p>SUSHI would be smart enough to see that <code>Medication1</code> has type <code>Inline</code>, so it would know to automatically add it to the <code>contained</code> array and make the reference a local reference to <code>Medication1</code>.</p>



<a name="188649531"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188649531" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188649531">(Feb 20 2020 at 15:46)</a>:</h4>
<p>And... since no one asked... here is what that same scenario looks like using the syntax that defines all the inline resources inline in the FSH:</p>
<div class="codehilite"><pre><span></span>Instance: PrescriptionBundle
InstanceOf: Bundle
Type: Example
* entry[0].resource instanceOf MedicationRequest
* entry[0].resource.id = &quot;Prescription1&quot;
* entry[0].resource.contained[0] instanceOf Medication
* entry[0].resource.contained[0].id = &quot;Medication1&quot;
* entry[0].resource.contained[0].code = RXNORM#12345
// ... more entry[0].resource.contained[0] rules
* entry[0].resource.medicationReference = &quot;#Medication1&quot;
// ... more entry[0].resource rules
* entry[1].resource instanceOf MedicationRequest
* entry[1].resource.id = &quot;Prescription2&quot;
* entry[1].resource.contained[0] instanceOf Medication
* entry[1].resource.contained[0].id = &quot;Medication2&quot;
* entry[1].resource.contained[0].code = RXNORM#67890
// ... more entry[1].resource.contained[0] rules
* entry[1].resource.medicationReference = &quot;#Medication2&quot;
// ... more entry[1].resource rules
</pre></div>



<a name="188650341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188650341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Kramer <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188650341">(Feb 20 2020 at 15:54)</a>:</h4>
<p>Very interesting discussion.  Here's my take:<br>
1) The "Type" keyword is much cleaner than trying to generalize "InstanceOf" to "ExampleOf", "InlineInstanceOf" etc. Thumbs up for "Type"<br>
2) The inline syntax is just hard to read. I'm not in favor of introducing an "instanceOf" rule. Thumbs down on "* foo instanceOf bar"<br>
3) I agree SUSHI should be smart enough to figure out the population of "contained" itself. Thumbs up on the direct assignment of an inline Type to a reference.</p>



<a name="188652708"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188652708" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188652708">(Feb 20 2020 at 16:19)</a>:</h4>
<p>I'm personally in favor of the inline syntax if for no other reason than it is consistent with our approach elsewhere (we allow other things inline) and it allows for an instance in FSH to be fully self-contained.  I also feel like it would be useful elsewhere.</p>
<p>Consider that there are other places where an author may want a specific property to be an instance of a profile, <em>not</em> an instance of the vanilla type declared by the property.  Here is a contrived example...  Imagine a user wants to create an instance of <code>Invoice</code>.  And in the invoice they are creating multiple <code>lineItem</code>s.  They want their instance to create instances of <code>USMoney</code> (a profile on <code>Money</code>) -- but <code>Invoice</code> only declares the field as normal <code>Money</code>.  Here is how they do it w/ the inline syntax:</p>
<div class="codehilite"><pre><span></span>* lineItem[0].priceComponent[0].amount instanceOf USMoney
* lineItem[0].priceComponent[0].amount.value = 2.00
* lineItem[1].priceComponent[0].amount instanceOf USMoney
* lineItem[1].priceComponent[0].amount.value = 2.50
* lineItem[2].priceComponent[0].amount instanceOf USMoney
* lineItem[2].priceComponent[0].amount.value = 3.00
</pre></div>


<p>Without the inline syntax, they would need to create a separate <code>Instance:</code> entity for every single USDollar amount they want in that instance.  If they have 20 line items, that gets pretty cluttered.</p>



<a name="188652828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188652828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188652828">(Feb 20 2020 at 16:20)</a>:</h4>
<p>That said, I had to talk <span class="user-mention" data-user-id="239822">@Nick Freiter</span> into the inline syntax too, and he's a pretty smart guy as well.  So... I realize that I may be in the minority on this one.  That being the case, unless others are clamoring for it, I'd propose we support the other (by-reference) syntax first and only support the inline-defined syntax if people start asking for it.</p>



<a name="188674413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188674413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188674413">(Feb 20 2020 at 20:27)</a>:</h4>
<p>on the subject of verbose...</p>



<a name="188674416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188674416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188674416">(Feb 20 2020 at 20:27)</a>:</h4>
<div class="codehilite"><pre><span></span>Instance: Prescription1
InstanceOf: MedicationRequest
</pre></div>



<a name="188674459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188674459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188674459">(Feb 20 2020 at 20:27)</a>:</h4>
<p>for any one used to text based languages, this is clunky. Why not</p>
<div class="codehilite"><pre><span></span>Instance Prescription of MedicationRequest?
</pre></div>



<a name="188675475"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188675475" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188675475">(Feb 20 2020 at 20:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> your example seems to introduce one limitation - the contained resources cannot both be called Medication1 (which i presume is possible in FHIR)</p>



<a name="188675498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188675498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188675498">(Feb 20 2020 at 20:41)</a>:</h4>
<p>this is not really important but makes me think: How will all of this work with resource versions?</p>



<a name="188675567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188675567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188675567">(Feb 20 2020 at 20:42)</a>:</h4>
<p>in my IG i have a care plan with 3 versions - but this is not supported so I have to have 3 different care plan IDs</p>



<a name="188675690"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188675690" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188675690">(Feb 20 2020 at 20:44)</a>:</h4>
<p>How much of this syntax breaks when we need to have multiple resource instances with id=careplan001 and versions 1, 2, 3.. ?</p>



<a name="188675901"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188675901" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188675901">(Feb 20 2020 at 20:46)</a>:</h4>
<ol>
<li>I think I like more the message when you went "since no one asked" <span class="user-mention" data-user-id="191469">@Chris Moesel</span></li>
</ol>



<a name="188675952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188675952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188675952">(Feb 20 2020 at 20:47)</a>:</h4>
<ol start="2">
<li>would it be interesting to do </li>
</ol>
<div class="codehilite"><pre><span></span>* entry[0].resource.contained[0] instanceOf Medication alias Medication1
</pre></div>


<p>and then use that alias everywhere?</p>



<a name="188676268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188676268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188676268">(Feb 20 2020 at 20:50)</a>:</h4>
<blockquote>
<div class="codehilite"><pre><span></span>Instance Prescription of MedicationRequest
</pre></div>


</blockquote>
<p>I like this. I'd read it better if it were Prescription=instance(MedicationRequest) or Prescription=example(MedicationRequest) but I don't think that is how the shorthand grammar is being defined</p>



<a name="188689915"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/188689915" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Kramer <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#188689915">(Feb 20 2020 at 23:24)</a>:</h4>
<p>The verbosity, if it is that, comes from the structure of Shorthand items. Each item starts with a set of keyword declarations, followed by a set of rules. The declarations are the part that goes:</p>
<div class="codehilite"><pre><span></span>Instance: Foo
InstanceOf: Bar
Description: &quot;Blah blah blah&quot;
</pre></div>


<p>These declarations set the stage for the defining the rules (statements that begin with a bullet *) that actually do the profiling, fixing, or binding.  It might not be the absolute most compact way to do things, but this basic arrangement is very clear to users.</p>



<a name="191894907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/191894907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#191894907">(Mar 26 2020 at 14:48)</a>:</h4>
<p>I have this issue right now and I see talk of a solution, but I can't tell from browsing the issue log if this ever got added or if we are still discussing.  If this hasn't been added, is there a workaround on how to set the bundle.entry.resource to be different instances?</p>



<a name="191909461"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/191909461" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#191909461">(Mar 26 2020 at 16:16)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="192166">@Jean Duteau</span> -- support for inline instances (which is what you need here) will be in our next release of SUSHI.  We're aiming for tomorrow afternoon, although it might be early next week if we hit any snags. The basic approach is you define instances you want in the bundle the normal way but with this additional metadata: <code>Usage: #inline</code>.  Then in your bundle, you can say: <code>bundle.entry[0].resource = MyResource</code>.</p>



<a name="191909792"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/191909792" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#191909792">(Mar 26 2020 at 16:18)</a>:</h4>
<p>okay, i thought I might have to wait.  will this work if I want to have the instance exist as a separate example as well?  i.e. I have a Composition instance that I want to exist as a Composition example in my IG.  I also want to just have the Bundle include that already-defined Composition instance as one of its entries.</p>



<a name="191910297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/191910297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#191910297">(Mar 26 2020 at 16:22)</a>:</h4>
<p>Yes, in that case, you'd set the <code>Usage:</code> to <code>#example</code> and it would export as a separate example <em>and</em> be inlined in your bundle.</p>



<a name="191910459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/191910459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#191910459">(Mar 26 2020 at 16:23)</a>:</h4>
<p>muchas gracias!</p>



<a name="193414381"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/193414381" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Etienne Cantineau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#193414381">(Apr 09 2020 at 07:18)</a>:</h4>
<p>Hello,  i have understood how to create bundle with bundle.entry[0].resource = MyResource and inline instances but now i'm working on a bundle with sliced mandatory entries, one is patient and i'm trying this: bundle.entry[patient].resource = patient1 with an inline instance of Patient  profile. I receive the error: Cannot fix Resource value: patient1. Value does not match element type: Patient. Any idea what's wrong?</p>



<a name="193442642"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/193442642" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#193442642">(Apr 09 2020 at 12:29)</a>:</h4>
<p>What you are trying to do makes sense, but isn't possible yet due to a limitation of SUSHI. We currently only support setting fixed inline instances on elements of type Resource, not specific sub-types of Resource, such as Patient in your case. We do plan to extend this so that we support setting inline instances to sub-types of Resource, but haven't been able to address it yet. I've created an issue here <a href="https://github.com/FHIR/sushi/issues/347" title="https://github.com/FHIR/sushi/issues/347">https://github.com/FHIR/sushi/issues/347</a> to track this task.</p>



<a name="193446497"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/193446497" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Etienne Cantineau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#193446497">(Apr 09 2020 at 13:03)</a>:</h4>
<p><span class="user-mention" data-user-id="239822">@Nick Freiter</span> Thank you for your answer. I'll follow that</p>



<a name="194214114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194214114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194214114">(Apr 15 2020 at 19:14)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="243697">@Etienne Cantineau</span> - this is fixed in the newly released SUSHI 0.12.1.</p>



<a name="194266474"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194266474" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Etienne Cantineau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194266474">(Apr 16 2020 at 07:37)</a>:</h4>
<p>Thank you, it can now reach correctly my inline instances! That lead me to another problem! <br>
I have my patient inline instance with Usage: #inline, i've read that it doesn't create xml/json files and then, i receive the message from the IG "Publishing content failed: unable to find the source file for Patient/Patient1: not specified, so tried Patient-Patient1.xml, json etc".<br>
Why is the publisher still looking for a file? Or am i missing something?<br>
I didn't encounter that problem when i tested bundle creation because in my previous test without Usage keyword, sushi had created a json file of my patient instance.</p>



<a name="194292730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194292730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194292730">(Apr 16 2020 at 12:03)</a>:</h4>
<p>It looks like the Patient1 resource is incorrectly being added by SUSHI to the ImplementationGuide.json file, even though it is specified as inline, I've logged this as an issue here <a href="https://github.com/FHIR/sushi/issues/366" title="https://github.com/FHIR/sushi/issues/366">https://github.com/FHIR/sushi/issues/366</a>. Sorry to fix one issue only to have you run into another, but thanks for reporting so we can fix this!</p>



<a name="194293636"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194293636" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Etienne Cantineau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194293636">(Apr 16 2020 at 12:12)</a>:</h4>
<p>Ok, no problem, i'm not in a hurry!</p>



<a name="194651090"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194651090" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Etienne Cantineau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194651090">(Apr 20 2020 at 09:25)</a>:</h4>
<p>The problem is well solved! I see that the inline instances are counted in the sushi results report,  maybe they shouldn't as they are not standalone files unlike the other resources of the report.</p>



<a name="194661767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194661767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Etienne Cantineau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194661767">(Apr 20 2020 at 11:26)</a>:</h4>
<p>One more thing about these bundles: i got an error from the publisher "org.hl7.fhir.exceptions.FHIRException: No fullUrl on entry #1 in Bundle slicedbundle1". This element fullUrl is however 0..1. After investigations, i found i only get errors from the instances that have references. <br>
If i put in comment the lines where i use a reference, i don't get my error anymore.<br>
You can see the profile and example here: <a href="https://github.com/ec-ehealth/Bundle-example" title="https://github.com/ec-ehealth/Bundle-example">https://github.com/ec-ehealth/Bundle-example</a></p>



<a name="194673382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194673382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194673382">(Apr 20 2020 at 13:20)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="243697">@Etienne Cantineau</span> -- it looks like the FHIR spec requires <code>fullUrl</code> in order to resolve relative references.  See: <a href="http://hl7.org/fhir/R4/bundle.html#references" title="http://hl7.org/fhir/R4/bundle.html#references">http://hl7.org/fhir/R4/bundle.html#references</a></p>
<p>So, it looks like you'll need to add <code>fullUrl</code> values to your bundle as well...</p>



<a name="194683233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Issue%20creating%20Bundle%20instance/near/194683233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Etienne Cantineau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Issue.20creating.20Bundle.20instance.html#194683233">(Apr 20 2020 at 14:33)</a>:</h4>
<p>Ok thank you, i didn't know it was mandatory in that case. No problem, i'll add that!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
