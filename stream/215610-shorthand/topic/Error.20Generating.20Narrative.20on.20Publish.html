---
layout: page
title: "FHIR Chat  · Error Generating Narrative on Publish · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Error.20Generating.20Narrative.20on.20Publish.html">Error Generating Narrative on Publish</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="229510983"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Error%20Generating%20Narrative%20on%20Publish/near/229510983" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stuart Cox <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Error.20Generating.20Narrative.20on.20Publish.html#229510983">(Mar 09 2021 at 16:55)</a>:</h4>
<p>I am attempting to create an extension.  The extensions is a bit unusual for me, in that this is the first time I have created an extension that uses a metadata   type instead of a primitive or general-purpose  type.  In this case the ParameterDefinition profile.  I am attempting to add a measure-parameter-definition extension to the my measure profile.</p>
<p>This appears to work, sushi compiles successfully, and IG is produced. However when I create an example, it throws an error when the profiler is Generating Narratives for the example.</p>
<p>Error I'm getting is: <br>
Generating Narratives<br>
org.apache.commons.lang3.NotImplementedException: type org.hl7.fhir.r5.model.ParameterDefinition not handled - should not be here</p>
<p><a href="/user_uploads/10155/IrgiwLaEMZfta_Nyz3vYk1RX/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/IrgiwLaEMZfta_Nyz3vYk1RX/image.png" title="image.png"><img src="/user_uploads/10155/IrgiwLaEMZfta_Nyz3vYk1RX/image.png"></a></div><p>The IG publishes with the error, but does have a nice red section on the example html page where the narrative is normally displayed.  Not so much worried about that, but more concerned about other consequences we might encounter later.</p>
<p>A few questions on this:<br>
1) Is there anything wrong with my approach?  Is there any problem with using meta-data types  as an extension value in this way?<br>
2) Am I doing it correctly?<br>
3) Will the narrative error result in any other issues when using this profile, or is it just a bug with the narrative generation?</p>
<p>Here is my stripped down fsh code to reproduce the error:</p>
<div class="codehilite"><pre><span></span><code>Extension:      MeasureParameterDefinition
Id:             measure-parameter-definition
Title:          &quot;Measure Parameter Definition&quot;
* value[x] only ParameterDefinition

Profile:        QualityMeasure
Parent:         Measure
Id:             quality-measure
Title:          &quot;Quality Measure&quot;
* extension contains MeasureParameterDefinition named measureParameterDefinition 0..*

Instance:       QualityMeasureExample
InstanceOf:     QualityMeasure
Usage:          #example
Title:          &quot;Quality Measure Example&quot;
* status = #active
* extension[measureParameterDefinition].valueParameterDefinition.name = #measurePeriod
* extension[measureParameterDefinition].valueParameterDefinition.use = #out
* extension[measureParameterDefinition].valueParameterDefinition.type = #Period
</code></pre></div>
<p>Thank you!</p>



<a name="229520696"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Error%20Generating%20Narrative%20on%20Publish/near/229520696" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Error.20Generating.20Narrative.20on.20Publish.html#229520696">(Mar 09 2021 at 17:47)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="285362">@Stuart Cox</span>.  To answer your questions:</p>
<p>1) I don't see anything wrong with your approach.  The <a href="http://hl7.org/fhir/R4/extensibility.html#extension">definition of Extension</a> shows that <code>value[x]</code> is an <a href="http://hl7.org/fhir/R4/datatypes.html#open">open type element</a>, which allows <code>ParameterDefinition</code> -- so I don't see any reason why you shouldn't be able to use it.  In fact, that extension definition (previously linked) even lists <code>valueParameterDefinition</code> as a valid instantiated value name.</p>
<p>2) I think you are doing it correctly.  The FSH looks valid and the FHIR it produces looks valid too (at least to me).</p>
<p>3) This seems like it is just a bug with narrative generation, but I'm not an expert in the inner workings of the IG Publisher, so I'd want <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> to confirm that. Grahame -- if you want to see the resulting FHIR definitions, click <a href="https://fshschool.org/FSHOnline/#/share/3bteTXG">this link</a> to view it in FSH Online and then click the "Run" button.</p>



<a name="229530479"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Error%20Generating%20Narrative%20on%20Publish/near/229530479" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stuart Cox <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Error.20Generating.20Narrative.20on.20Publish.html#229530479">(Mar 09 2021 at 18:44)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="191469">@Chris Moesel</span> for your quick response.   Love the FSH online tool!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
