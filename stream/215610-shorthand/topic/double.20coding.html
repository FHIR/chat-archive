---
layout: page
title: "FHIR Chat  · double coding · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html">double coding</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="241544946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241544946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241544946">(Jun 04 2021 at 14:38)</a>:</h4>
<p>I have run across a problem with sushi. I say problem, you might say I am using the tool wrong.<br>
Given a Profile on Observation includes this constraint</p>
<div class="codehilite"><pre><span></span><code>* category 1..1
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
</code></pre></div>
<p>And an example using that Profile includes this</p>
<div class="codehilite"><pre><span></span><code>* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
</code></pre></div>
<p>When I run sushi<br>
Then I get an example json object with</p>
<div class="codehilite"><pre><span></span><code>  &quot;category&quot; : [
    {
      &quot;coding&quot; : [
        {
          &quot;system&quot; : &quot;http://terminology.hl7.org/CodeSystem/observation-category&quot;,
          &quot;code&quot; : &quot;vital-signs&quot;
        }
      ]
    },
    {
      &quot;coding&quot; : [
        {
          &quot;system&quot; : &quot;http://terminology.hl7.org/CodeSystem/observation-category&quot;,
          &quot;code&quot; : &quot;vital-signs&quot;
        }
      ]
    }
  ],
</code></pre></div>



<a name="241545548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241545548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241545548">(Jun 04 2021 at 14:43)</a>:</h4>
<p>I get that I should not need to put the category in my examples, but it feels like the right thing to do for explicitness.  Why would sushi presume this -second- category should be automatically promoted to category[+]?</p>



<a name="241545808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241545808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241545808">(Jun 04 2021 at 14:44)</a>:</h4>
<p>I agree, that doesn't seem right.  In fact, I'm surprised, because I thought SUSHI did something different here.  We recently fixed a bug in some code tangentially related to this -- I might try this with our not-yet-released version to see if it is still an issue.</p>



<a name="241546341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241546341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241546341">(Jun 04 2021 at 14:48)</a>:</h4>
<p>Actually, when I run that with the latest released version of SUSHI (1.3.2) on FSH Online, I'm not seeing the duplicate category: <a href="https://fshschool.org/FSHOnline/#/share/3gfr23M">https://fshschool.org/FSHOnline/#/share/3gfr23M</a></p>



<a name="241547076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241547076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241547076">(Jun 04 2021 at 14:53)</a>:</h4>
<p>scary... I just checked... whew.. I have fresh sushi...</p>



<a name="241547306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241547306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241547306">(Jun 04 2021 at 14:54)</a>:</h4>
<p>the profile in my above is also a profile off of core vitalsigns</p>
<div class="codehilite"><pre><span></span><code>Parent:         http://hl7.org/fhir/StructureDefinition/vitalsigns
</code></pre></div>



<a name="241551314"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241551314" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241551314">(Jun 04 2021 at 15:22)</a>:</h4>
<p>Ah, yes.  That is the difference.</p>
<p>I think this is because the parent profile fixes the category by slicing <code>code.coding</code> and then specifying a <code>coding</code> slice with the <code>system</code> and <code>code</code> each independently fixed to separate values.  Your profile, however, takes an entirely different approach by using a patternCodeableConcept at the <code>code</code> level to specify a single pattern to apply (that holds the coding system and code in it).</p>
<p>Those two are basically trying to accomplish the same thing, but doing it in <em>very</em> different ways.  SUSHI knows how to handle both ways, but doesn't recognize them as equivalent -- so it applies the required slice and its child fixed values from the parent and <em>also</em> applies the pattern from your profile.  TBH, this would probably be fairly tricky to detect and resolve in a robust way.</p>
<p>The intent of profiling is usually to describe what is <em>different</em> from the thing you are profiling.  In this case, I think you will be better off and cause less confusion for our tool (and probably others) if you don't double-define that fixed category in the profile.  If your approach to it was the same as the parent's approach to it, it might just work out -- but trouble comes in because your duplicated constraint is constraining using an entirely different mechanism than the parent.</p>



<a name="241551803"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241551803" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241551803">(Jun 04 2021 at 15:26)</a>:</h4>
<p>that is what I feared</p>



<a name="241551901"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241551901" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241551901">(Jun 04 2021 at 15:26)</a>:</h4>
<p>My profile is specifically mandating 1..1</p>



<a name="241551994"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241551994" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241551994">(Jun 04 2021 at 15:27)</a>:</h4>
<p>I can remove the second line mandating the code.. with precognition by human (not computable) that it is the same.</p>



<a name="241552010"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241552010" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241552010">(Jun 04 2021 at 15:27)</a>:</h4>
<p>so much for 'profiles are great because they are computable'</p>



<a name="241552234"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241552234" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241552234">(Jun 04 2021 at 15:29)</a>:</h4>
<p>this means my profiles need to be different pattern when they are based on core vitalsigns, vs when they are deviating for some business reason.</p>



<a name="241553296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241553296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241553296">(Jun 04 2021 at 15:36)</a>:</h4>
<p>I can confirm that removing that from my profile did fix the problem.</p>



<a name="241555059"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241555059" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241555059">(Jun 04 2021 at 15:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/215610-shorthand/topic/double.20coding/near/241552234">said</a>:</p>
<blockquote>
<p>this means my profiles need to be different pattern when they are based on core vitalsigns, vs when they are deviating for some business reason.</p>
</blockquote>
<p>Well, by declaring another profile (outside of your control) as a parent, you are already introducing approaches that may not be consistent w/ your own approaches.  You can't remove the inherited slicing logic from the parent, so you're kind of stuck with it.  IMO, it's better to let it be than to layer on another constraint using a different approach that says the same thing.</p>
<p>Your other option would be to declare your own vital-signs profile with similar constraints such that any instance that conforms to your profile also conforms to the official vital-signs profile (even though there is not a <em>formal</em> relationship). But creating duplicate profiles that are semantically the same is also generally discouraged... :-/</p>



<a name="241555640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241555640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241555640">(Jun 04 2021 at 15:53)</a>:</h4>
<p>agreed. and I understand why vitalsigns core is that way. They don't want to forbid other category codes in addtion to vitalsigns</p>



<a name="241555673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241555673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241555673">(Jun 04 2021 at 15:53)</a>:</h4>
<p>my profile simply needs to say 1..1... so, i have</p>



<a name="241555843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241555843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241555843">(Jun 04 2021 at 15:55)</a>:</h4>
<p>note that the other places where I did this... a few months ago.. I learned thru the build errors that it was a bad idea.. so those already had this line commented out with a reason for the comment. But clearly I am too old to remember this lesson, so I learned it again.</p>



<a name="241556047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241556047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241556047">(Jun 04 2021 at 15:56)</a>:</h4>
<p>I like to add counters to comments like that, so that I can see how many times it takes for me to actually learn it  =)</p>



<a name="241557336"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241557336" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241557336">(Jun 04 2021 at 16:05)</a>:</h4>
<p>it is 4 for me</p>



<a name="241557712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241557712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241557712">(Jun 04 2021 at 16:08)</a>:</h4>
<p>It is 4 for you... so far  :-P</p>



<a name="241558078"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241558078" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241558078">(Jun 04 2021 at 16:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/215610-shorthand/topic/double.20coding/near/241555640">said</a>:</p>
<blockquote>
<p>agreed. and I understand why vitalsigns core is that way. They don't want to forbid other category codes in addtion to vitalsigns</p>
</blockquote>
<p>This is true of their approach, but it is also true of patterns.  If a pattern contains an array, it allows for other values in the array as well.  The pattern just indicates the minumum requirements for the array.  But I don't think patterns were used or understood much back when the vital-signs profiles were created.</p>



<a name="241558853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241558853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241558853">(Jun 04 2021 at 16:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/215610-shorthand/topic/double.20coding/near/241547076">said</a>:</p>
<blockquote>
<p>scary... I just checked... whew.. I have fresh sushi...</p>
</blockquote>
<p>Thank goodness. That three-day old, mall sushi is scary.</p>



<a name="241561809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241561809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241561809">(Jun 04 2021 at 16:38)</a>:</h4>
<p>especially in the midwest... vs Vancouver.</p>



<a name="241563105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241563105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241563105">(Jun 04 2021 at 16:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191380">Elliot Silver</span> <a href="#narrow/stream/215610-shorthand/topic/double.20coding/near/241558853">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/215610-shorthand/topic/double.20coding/near/241547076">said</a>:</p>
<blockquote>
<p>scary... I just checked... whew.. I have fresh sushi...</p>
</blockquote>
<p>Thank goodness. That three-day old, mall sushi is scary.</p>
</blockquote>
<p>Yumm...stale dry rice with shrimp that has shrivelled up a bit.  That's really the most adventurous sushi!</p>



<a name="241563178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241563178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241563178">(Jun 04 2021 at 16:49)</a>:</h4>
<p>I avoid that by only buying from the gas station on the corner.  That's fresh every day or two.</p>



<a name="241571349"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/double%20coding/near/241571349" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/double.20coding.html#241571349">(Jun 04 2021 at 17:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="192587">David Pyke</span> <a href="#narrow/stream/215610-shorthand/topic/double.20coding/near/241563178">said</a>:</p>
<blockquote>
<p>I avoid that by only buying from the gas station on the corner.  That's fresh every day or two.</p>
</blockquote>
<p>Sorry, no gas station sushi for me. If I'm looking to be killed by my sushi, I'm going with nothing less than fugu.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
