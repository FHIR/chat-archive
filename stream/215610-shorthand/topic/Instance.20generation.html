---
layout: page
title: "FHIR Chat  · Instance generation · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html">Instance generation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="185037399"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185037399" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185037399">(Jan 07 2020 at 18:12)</a>:</h4>
<p>Do aliases work in instance generation? Adding an Alias seems to produce an empty resource (resourceType only)</p>
<div class="codehilite"><pre><span></span>Instance:   drDoolittleGP
InstanceOf: Practitioner
Alias: extQualStatus = http://hl7.org.nz/fhir/StructureDefinition/practitioner-qualification-status


* extension[0].url = &quot;http://hl7.org.nz/fhir/StructureDefinition/nzethnicity&quot;
* extension[0].valueCodeableConcept.coding[0].system = &quot;https://standards.digital.health.nz/codesystem/ethnic-group-level-4&quot;
* extension[0].valueCodeableConcept.coding[0].code = #32114
* extension[0].valueCodeableConcept.text = &quot;Manihiki Islander&quot;
</pre></div>



<a name="185039226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185039226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185039226">(Jan 07 2020 at 18:32)</a>:</h4>
<p>In general, SUSHI will expect the rules about an instance to immediately follow the declaration of the instance. In this example the Instance <code>drDoolittleGP</code> is declared, but then instead of getting a list of rules like it expects, SUSHI gets the <code>Alias</code>,  so it doesn't associate those rules with the Instance you are declaring. I think if you try like this:</p>
<div class="codehilite"><pre><span></span>Alias: extQualStatus = http://hl7.org.nz/fhir/StructureDefinition/practitioner-qualification-status

Instance:   drDoolittleGP
InstanceOf: Practitioner
* extension[0].url = &quot;http://hl7.org.nz/fhir/StructureDefinition/nzethnicity&quot;
* extension[0].valueCodeableConcept.coding[0].system = &quot;https://standards.digital.health.nz/codesystem/ethnic-group-level-4&quot;
* extension[0].valueCodeableConcept.coding[0].code = #32114
* extension[0].valueCodeableConcept.text = &quot;Manihiki Islander&quot;
</pre></div>


<p>You should get the resource being generated correctly,  and that Alias is still defined and can be used within the definition of the Instance.</p>



<a name="185042377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185042377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185042377">(Jan 07 2020 at 19:01)</a>:</h4>
<p><span class="user-mention" data-user-id="191321">@David Hay</span> -- did SUSHI report any errors when you put the alias between the Instance metadata and the Instance rules.  I think <span class="user-mention" data-user-id="239822">@Nick Freiter</span> was correct in his analysis, but I would have expected SUSHI to spit out an error about those rules.</p>



<a name="185043046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185043046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185043046">(Jan 07 2020 at 19:07)</a>:</h4>
<p>No error when around the wrong way - but it did work ok when I re-ordered it - thanks!</p>
<p>And for my next question :)</p>
<p>This line:</p>
<div class="codehilite"><pre><span></span> * extension[0].valueCodeableConcept = systemEthnicity#32114 &quot;Manihiki Islander&quot;
</pre></div>


<p>results in</p>
<div class="codehilite"><pre><span></span>{
      &quot;url&quot;: &quot;http://hl7.org.nz/fhir/StructureDefinition/nzethnicity&quot;,
      &quot;valueCodeableConcept&quot;: {
        &quot;coding&quot;: [
          {
            &quot;code&quot;: &quot;32114&quot;,
            &quot;system&quot;: &quot;https://standards.digital.health.nz/codesystem/ethnic-group-level-4&quot;
          }
        ]
      }
    }
</pre></div>


<p>Shouldn't the text element be present? And is it possible to emit the code display using the shorthand?</p>



<a name="185051931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185051931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185051931">(Jan 07 2020 at 20:35)</a>:</h4>
<p>Yes, it should put in the text.  That looks like a bug.  It's probably because we share some some of the code between setting codes in instances and fixing codes in profiles -- and in profiles we purposefully omit the text because usually you wouldn't want a fixed code to _require_ specific text/display.</p>



<a name="185052033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185052033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185052033">(Jan 07 2020 at 20:36)</a>:</h4>
<p>One question we have to answer though, is when you set a CodeableConcept as you did above, would you expect that text to be reflected in the CodeableConcept.text, in the CodeableConcept.coding.display, or both?</p>



<a name="185052085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185052085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185052085">(Jan 07 2020 at 20:37)</a>:</h4>
<p>Actually, display makes more sense I guess. Better to set the text explicitly...</p>



<a name="185055439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185055439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185055439">(Jan 07 2020 at 21:13)</a>:</h4>
<p>Where is the syntax for instances creation?</p>



<a name="185055876"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185055876" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185055876">(Jan 07 2020 at 21:18)</a>:</h4>
<p>I just copied what I was using for profiles - just used the InstanceOf keyword...  There is more info apparently, but the IG is currently down...</p>



<a name="185056088"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056088" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056088">(Jan 07 2020 at 21:21)</a>:</h4>
<p>There is some documentation on the wiki: <a href="https://github.com/HL7/fhir-shorthand/wiki/3.7-Instances" target="_blank" title="https://github.com/HL7/fhir-shorthand/wiki/3.7-Instances">https://github.com/HL7/fhir-shorthand/wiki/3.7-Instances</a></p>
<p>Note that referring to slices by name (in instances) does not currently work and referring to extensions still requires the <code>extension.</code> prefix (as opposed to the shorter syntax in some of the wiki examples).</p>



<a name="185056189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056189">(Jan 07 2020 at 21:22)</a>:</h4>
<p>ok i just had one question. Array index- are they necessary?</p>



<a name="185056225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056225">(Jan 07 2020 at 21:22)</a>:</h4>
<p>If you leave out the index then it assumes index <code>[0]</code>.</p>



<a name="185056235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056235">(Jan 07 2020 at 21:23)</a>:</h4>
<p>i mean for the others as well</p>



<a name="185056273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056273">(Jan 07 2020 at 21:23)</a>:</h4>
<p>Yeah, if you want to do anything other than the first one, then you need the indexes.  Are you suggesting that if we see a path repeated we could just assume to increment the index?</p>



<a name="185056415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056415">(Jan 07 2020 at 21:25)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="nt">name</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="nt">family</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Costa</span>
   <span class="nt">given</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Jose</span>
 <span class="p p-Indicator">-</span> <span class="nt">family</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Sanches</span>
   <span class="nt">given</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Jose</span>
</pre></div>



<a name="185056534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056534">(Jan 07 2020 at 21:26)</a>:</h4>
<p>That would be interesting, but we could run into trouble when you have two array elements in the same path.  For example, what would we do with this?</p>
<div class="codehilite"><pre><span></span>* name.given = &quot;Steven&quot;
* name.given = &quot;Brian&quot;
</pre></div>


<p>How do we know if the second one should be <code>name[0].given[1]</code> or <code>name[1].given[0]</code>?</p>



<a name="185056556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056556">(Jan 07 2020 at 21:27)</a>:</h4>
<p>not that syntax, look at my syntax above</p>



<a name="185056725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056725">(Jan 07 2020 at 21:28)</a>:</h4>
<p>(I understand you may already have some syntax pattern, apologies if I am rocking the boat, but whenever possible, YAML should allows simple syntax, right?)</p>



<a name="185056742"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056742" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056742">(Jan 07 2020 at 21:28)</a>:</h4>
<p>Oh, I see... I missed your follow-up when I was writing that...  People have suggested something like a YAML syntax before.  There were mixed opinions.  We played with it a little early on and it felt like it didn't add a lot of value over JSON.  But I think we could revisit it at some point.</p>



<a name="185056791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185056791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185056791">(Jan 07 2020 at 21:29)</a>:</h4>
<p>It's certainly a lot less typing!</p>



<a name="185057136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/185057136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#185057136">(Jan 07 2020 at 21:33)</a>:</h4>
<p>just take it as input. I think things like [indexes] make it less short-handy.</p>



<a name="186111673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/186111673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#186111673">(Jan 20 2020 at 15:36)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="nt">Instance</span><span class="p">:</span>   <span class="l l-Scalar l-Scalar-Plain">PatientPia</span>
<span class="nt">InstanceOf</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Patient</span>
<span class="nt">Id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pia</span>
<span class="nt">Title</span><span class="p">:</span>  <span class="s">&quot;Patient</span><span class="nv"> </span><span class="s">Pia&quot;</span>
<span class="err">*</span> <span class="l l-Scalar l-Scalar-Plain">name[0].family = &quot;AnyWoman&quot;</span>
<span class="err">*</span> <span class="l l-Scalar l-Scalar-Plain">name[0].given[0] = &quot;Pia&quot;</span>
</pre></div>


<p>This generates an empty patient resource, no names. Am I missing something obvious?</p>



<a name="186120220"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/186120220" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#186120220">(Jan 20 2020 at 17:24)</a>:</h4>
<p>If you remove the Id: it seems to work...</p>



<a name="186185641"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/186185641" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#186185641">(Jan 21 2020 at 14:08)</a>:</h4>
<p>Instances don't support the <code>Id</code> metadata field.  So I think that's choking up the parser.  We have a separate bug to figure out why sometimes the parser fails silently.</p>
<p>Since this is an instance, and <code>id</code> is a field on <code>Patient</code>, you can accomplish what you want via a normal instance setter:</p>
<div class="codehilite"><pre><span></span>* id = &quot;pia&quot;
</pre></div>


<p>I think we didn't support a separate <code>Id:</code> metadata field because we thought that whatever you put after <code>Instance: </code> could be / would be used as the id -- since instances don't really have anywhere to put a <em>name</em> (so we'd re-use it as <em>id</em>).  That said, it looks like we don't actually do that (export the <em>name</em> as the <em>id</em>)...  So, this seems like a good thing to discuss:</p>
<ul>
<li>Should we support a separate <code>Id:</code> field?</li>
<li>If so, what does the _name_ after <code>Instance:</code> signify?  Just a handle for referencing it from other FSH instances?</li>
<li>Or should we treat the <em>name</em> (after <code>Instance:</code>) as the <em>id</em> and leave it at that?</li>
</ul>



<a name="186207528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/186207528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#186207528">(Jan 21 2020 at 17:42)</a>:</h4>
<p>Interestingly, this extension definition does have Id: and seems to work fine (the SD has both a name and an id field, both populated with 'hpiLocation-established'. Is there a list of 'FSH metadata' and what they do in the spec? (I couldn't find it)</p>
<div class="codehilite"><pre><span></span>Extension: hpiLocation-established
Id: hpiLocation-established
Description: &quot;The period over which the location is open&quot;
//These files were generated by a script

* extension 0..0
* value[x] only Period
</pre></div>



<a name="186230218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/186230218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#186230218">(Jan 21 2020 at 21:31)</a>:</h4>
<blockquote>
<p>Oh, I see... I missed your follow-up when I was writing that...  People have suggested something like a YAML syntax before.  There were mixed opinions.  We played with it a little early on and it felt like it didn't add a lot of value over JSON.  But I think we could revisit it at some point.</p>
</blockquote>
<p>on this: not sure if relevant but besides less typing, it is easier on the eyes and easier on diff's for example</p>



<a name="186233828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Instance%20generation/near/186233828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Instance.20generation.html#186233828">(Jan 21 2020 at 22:12)</a>:</h4>
<blockquote>
<p>Interestingly, this extension definition does have Id: and seems to work fine (the SD has both a name and an id field, both populated with 'hpiLocation-established'. Is there a list of 'FSH metadata' and what they do in the spec? (I couldn't find it)</p>
</blockquote>
<p>Right -- <code>Extension</code> supports both a name and an id because FHIR StructureDefinition has discrete fields for each.  Unfortunately, the same can't be said for instances -- there is no obvious place to put the _name_ of an instance within the instance itself.</p>
<p>The potential metadata fields really depend on what you're writing; what is available is based on the thing you're defining (e.g., Profile vs Extension vs ValueSet vs CodeSystem vs Instance).  So... there is no one set of FSH metadata fields -- although we try to provide consistency where we can.  Currently, I think that you'd need to go to the appropriate section of the documentation for each type of FSH thing to see what its available metadata fields are for it.  We could potentially update the <a href="https://build.fhir.org/ig/HL7/fhir-shorthand/#keywords" target="_blank" title="https://build.fhir.org/ig/HL7/fhir-shorthand/#keywords">Keywords</a> part of the documentation to list where each is valid, however.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
