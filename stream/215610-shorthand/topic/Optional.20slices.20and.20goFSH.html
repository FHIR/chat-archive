---
layout: page
title: "FHIR Chat  · Optional slices and goFSH · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Optional.20slices.20and.20goFSH.html">Optional slices and goFSH</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="241756994"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Optional%20slices%20and%20goFSH/near/241756994" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Optional.20slices.20and.20goFSH.html#241756994">(Jun 07 2021 at 10:41)</a>:</h4>
<p>Hi <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> I'm using goFSH tool to turn an existing Composition profile designed in Forge into FSH. The profile slices <code>Composition.section</code> and one of those slices is optional (<code>0..*</code>, to be precise). The corresponding entry in the StructureDefinition has neither <code>min</code> nor <code>max</code> fields:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"Composition.section:questionnaire"</span><span class="p">,</span>
    <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"Composition.section"</span><span class="p">,</span>
    <span class="nt">"sliceName"</span><span class="p">:</span> <span class="s2">"questionnaire"</span><span class="p">,</span>
    <span class="nt">"short"</span><span class="p">:</span> <span class="s2">"Questionnaires used in the software"</span>
<span class="p">}</span>
</code></pre></div>
<p>In addition, two fields in the <code>entry</code> element are defined as required in that slice. However, running goFSH on this gives a <em>required</em> slice in FSH:</p>
<div class="codehilite"><pre><span></span><code>* section contains
    [other slices]
    questionnaire 1..* and
    [other slices]
</code></pre></div>
<p>which indeed compiles into an a slice entry like the above, except that it explicitly sets <code>min</code> and <code>max</code> to 1 and *, respectively. So it seems goFSH assumes that the default minimum slice cardinality is 1. I didn't see any statement on this (or the contrary) in the <a href="https://www.hl7.org/fhir/elementdefinition.html#ElementDefinition">ElementDefinition documentation</a> - was this a deliberate choice?</p>



<a name="241774076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Optional%20slices%20and%20goFSH/near/241774076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Optional.20slices.20and.20goFSH.html#241774076">(Jun 07 2021 at 13:14)</a>:</h4>
<p>I don't think that is a deliberate choice.  It may be a bug.  Is there a public FHIR JSON/XML representation we can look at to try to reproduce this?</p>



<a name="241799456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Optional%20slices%20and%20goFSH/near/241799456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Optional.20slices.20and.20goFSH.html#241799456">(Jun 07 2021 at 16:02)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191469">@Chris Moesel</span>, here is a minimal example that leads to this behavior - the <em>quest</em> slice should be optional but gets converted into a required slice.</p>
<ul>
<li><a href="/user_uploads/10155/Jd1Ue19cDxtSDe7bOf_7hPDQ/Composition-prof.StructureDefinition.json">Composition-prof.StructureDefinition.json</a></li>
</ul>
<p>I discovered that this is related to the fact that the profile also sets the cardinality of <code>Composition.section</code> to <code>1..*</code>. If that cardinality is set to <code>0..*</code>,  the slice remains optional  (is set to <code>0..*</code>). However, since the slicing is open, it is of course valid to only have an optional slice.</p>



<a name="241808297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Optional%20slices%20and%20goFSH/near/241808297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Optional.20slices.20and.20goFSH.html#241808297">(Jun 07 2021 at 17:04)</a>:</h4>
<p>Thanks... we're a bit tied up at the moment trying to get some last minute things in for FHIR DevDays, but hopefully we can take a look at this soon.  Your example and analysis is very helpful.  Thank you!</p>



<a name="241816249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Optional%20slices%20and%20goFSH/near/241816249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Optional.20slices.20and.20goFSH.html#241816249">(Jun 07 2021 at 18:02)</a>:</h4>
<p>A worthy cause - after all, I myself learned FSH from your session at the last DevDays <span aria-label="nerd" class="emoji emoji-1f913" role="img" title="nerd">:nerd:</span></p>



<a name="242950361"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Optional%20slices%20and%20goFSH/near/242950361" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Optional.20slices.20and.20goFSH.html#242950361">(Jun 16 2021 at 22:17)</a>:</h4>
<p>I've logged this as <a href="https://github.com/FHIR/GoFSH/issues/135">GoFSH#135</a>. We hope to fix this in the next two-week sprint (which starts tomorrow).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
