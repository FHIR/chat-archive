---
layout: page
title: "FHIR Chat  · How make field conform to an external profile · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html">How make field conform to an external profile</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="231293567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231293567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Körlinge <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231293567">(Mar 22 2021 at 11:17)</a>:</h4>
<p>Hi!<br>
I am trying to create a profile on Condition where the "code" should be an ICD-10 code from the german basis profile, more specifically the profile here: <a href="https://simplifier.net/Basisprofil-DE-R4/CodingICD10GM-duplicate-2/~overview">https://simplifier.net/Basisprofil-DE-R4/CodingICD10GM-duplicate-2/~overview</a><br>
How do I specify this? I'm looking for something like</p>
<div class="codehilite"><pre><span></span><code>Profile: MyProfile
Parent: Condition
* code 1..1
* code.coding from http://fhir.de/StructureDefinition/CodingICD10GM // or only, or extends, or something that links to the profile
* code.coding.code = icd-10-valueset-uri#F17.2
* code.coding.version = &quot;2020&quot; // or something
</code></pre></div>
<p>I have tried a few keywords but they don't quite get me there, I am beginning to think I am doing the wrong thing. What I actually want to do is to end up assigning  the code as ICD-10 "F17.2", which is part of a codesystem/valueset somewhere, but I thought that I need to first say that "this code is an instance of this profile". Could you point me in the right direction? =)</p>



<a name="231294273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231294273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Körlinge <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231294273">(Mar 22 2021 at 11:24)</a>:</h4>
<p>It sems to me like 'only' would fit here but the generator tells me "Internal error in location for message: 'Error @1, 1: Found ? expecting a token name', loc = '?pkp-1?', err = 'The reference <a href="http://fhir.de/StructureDefinition/CodingICD10GM">http://fhir.de/StructureDefinition/CodingICD10GM</a> could not be resolved'" then and I don't know how to proceed from there</p>



<a name="231304962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231304962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231304962">(Mar 22 2021 at 12:57)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="397998">@Max Körlinge</span>.  Since <code>http://fhir.de/StructureDefinition/CodingICD10GM</code> is a profile on <code>Coding</code>, then I think one approach would be:</p>
<div class="codehilite"><pre><span></span><code>* code.coding only http://fhir.de/StructureDefinition/CodingICD10GM
</code></pre></div>
<p>If SUSH says it cannot find that definition then I would double-check to make sure that it really is defined in one of your dependency IGs (paying attention to version as well).  Because if it is in a dependency IG, then I think it should work.</p>
<p>That said, that will require every instance of <code>Coding</code> to match the profile.  If you only want to require that at least one <code>Coding</code> matches the profile, you'd have to create an open <code>slicing</code> and declare one slice that is restricted to that profile.</p>



<a name="231305504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231305504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231305504">(Mar 22 2021 at 13:01)</a>:</h4>
<p>One other issue I see is in this line:</p>
<div class="codehilite"><pre><span></span><code>* code.coding.code = icd-10-valueset-uri#F17.2
</code></pre></div>
<p>The part before <code>#</code> needs to refer to a <code>CodeSystem</code>, not a <code>ValueSet</code>.  I noticed that in the profile on <code>Coding</code> that you are wanting to use, it fixes <code>system</code> to: <code>http://fhir.de/CodeSystem/dimdi/icd-10-gm</code>, so that is presumably what you'd want before the <code>#</code> when fixing that code.</p>



<a name="231305677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231305677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231305677">(Mar 22 2021 at 13:02)</a>:</h4>
<p>And of course you can define an alias for that system (if you're going to use it multiple times) so you don't have to type the full thing every time.</p>



<a name="231308862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231308862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Körlinge <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231308862">(Mar 22 2021 at 13:26)</a>:</h4>
<p>Thanks. I think perhaps most of my issues are with the package which is an alpha version. I checked the contents of the package and the IG itself says its version is 1.0.0-alpha1, but the same problem persists if I tell sushi to use that version instead.<br>
I can derive a profile from that uri like this</p>
<div class="codehilite"><pre><span></span><code>Profile: MyProfile
Parent: http://fhir.de/StructureDefinition/CodingICD10GM
</code></pre></div>
<p>and the generator and sushi don't complain, but the link on the IG website to that profile goes to <code>../output/null</code>.</p>
<p>I am using snapshots downloaded manually like we discussed in the "Dependencies" thread. When I check the package, it does include this uri (<a href="http://fhir.de/StructureDefinition/CodingICD10GM">http://fhir.de/StructureDefinition/CodingICD10GM</a>) in a separate file. The json file with the IG itself doesn't seem to contain this URI though. Should the IG (in this case, <code>basisprofil-de-r4.json</code>) contain a reference to it somewhere? It just seems to refer to a bunch of markdown files. If it should, I guess that is the problem</p>



<a name="231311909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231311909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231311909">(Mar 22 2021 at 13:45)</a>:</h4>
<p>No, I don't think the IG JSON needs to refer to it for SUSHI to find it.  SUSHI <em>should</em> be able to find it as long as its formal JSON definition is available in the IG package.  It's also not a problem that the URL doesn't resolve to a valid location in your browser.  While that's generally considered a best practice in FHIR, it is not a requirement and SUSHI does not rely on it.</p>
<p>If that URL is working as the value of a <code>Parent</code> then I don't know why it's not working as the value of an <code>only</code> rule.  I will have to try to reproduce locally in order to figure out what's going on.</p>



<a name="231313427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20make%20field%20conform%20to%20an%20external%20profile/near/231313427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Körlinge <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20make.20field.20conform.20to.20an.20external.20profile.html#231313427">(Mar 22 2021 at 13:54)</a>:</h4>
<p><a href="/user_uploads/10155/LaWK5qJ7h-8B4u0GANG3gvZJ/Skärmavbild-2021-03-22-kl.-14.48.43.png">Skärmavbild-2021-03-22-kl.-14.48.43.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/LaWK5qJ7h-8B4u0GANG3gvZJ/Skärmavbild-2021-03-22-kl.-14.48.43.png" title="Skärmavbild-2021-03-22-kl.-14.48.43.png"><img src="/user_uploads/10155/LaWK5qJ7h-8B4u0GANG3gvZJ/Skärmavbild-2021-03-22-kl.-14.48.43.png"></a></div><p>from this</p>
<div class="codehilite"><pre><span></span><code>* code.coding ^slicing.discriminator.type = #pattern
* code.coding ^slicing.discriminator.path = &quot;coding&quot;
* code.coding ^slicing.rules = #open
* code.coding contains icd10 1..1 MS
* code.coding[icd10] only http://fhir.de/StructureDefinition/CodingICD10GM
* code.coding[icd10].code = http://fhir.de/CodeSystem/dimdi/icd-10-gm#F17.2
</code></pre></div>
<p>It looks like the "Type" is not recognized but the "code" is since the description is correct. Maybe I'm just somehow using the wrong structure definition URI for the profile, since the code uri worked well</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
