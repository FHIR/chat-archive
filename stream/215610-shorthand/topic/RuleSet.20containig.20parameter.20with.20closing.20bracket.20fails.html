---
layout: page
title: "FHIR Chat  · RuleSet containig parameter with closing bracket fails · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/RuleSet.20containig.20parameter.20with.20closing.20bracket.20fails.html">RuleSet containig parameter with closing bracket fails</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="236457619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/RuleSet%20containig%20parameter%20with%20closing%20bracket%20fails/near/236457619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Nau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/RuleSet.20containig.20parameter.20with.20closing.20bracket.20fails.html#236457619">(Apr 28 2021 at 06:39)</a>:</h4>
<p>Hello,<br>
I'm using RuleSets for simplifying Questionnaire-Definitions, so I can remove repetitive code from the item definitions.</p>
<p>I found a bug where <code>RuleSet</code>-paramaters cannot have values containing closing brackets <code>)</code>.</p>
<div class="codehilite"><pre><span></span><code>RuleSet: Question(linkId, title)
* item[+].linkId = &quot;{linkId}&quot;
* item[=].type = #string
* item[=].text = {title}

Instance: MyQuestionnaire
InstanceOf: Questionnaire
Title: &quot;My Questionnaire&quot;
Usage: #definition
Description: &quot;An example for bug report.&quot;
* status = #active
* date = 2021-04-27
* publisher = &quot;Me&quot;
* id = &quot;my-questionnaire&quot;
* subjectType = #Patient
* title = &quot;My Questionnaire&quot;
* name = &quot;MyQuestionnaire&quot;
* purpose = &quot;An example for bug report.&quot;

// this works:
* insert Question(link1, &quot;Some text (without closing bracket?&quot;)
// this fails:
* insert Question(link2, &quot;Some text (with closing bracket)?&quot;)

// use this for a workaround of above issue:
/*
* insert Question(link2, &quot;overwriteme&quot;)
* item[=].text = &quot;Some text (with closing bracket)?&quot;
*/
</code></pre></div>
<p>This will lead to sushi output with error <code>error extraneous input '?")' expecting {&lt;EOF&gt;, KW_ALIAS, KW_PROFILE, KW_EXTENSION, KW_INSTANCE, KW_INVARIANT, KW_VALUESET, KW_CODESYSTEM, KW_RULESET, KW_MAPPING, KW_LOGICAL, KW_RESOURCE}</code></p>
<p>See my example here: <a href="https://fshschool.org/FSHOnline/#/share/2R6t7pK">https://fshschool.org/FSHOnline/#/share/2R6t7pK</a></p>



<a name="236457788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/RuleSet%20containig%20parameter%20with%20closing%20bracket%20fails/near/236457788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Nau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/RuleSet.20containig.20parameter.20with.20closing.20bracket.20fails.html#236457788">(Apr 28 2021 at 06:41)</a>:</h4>
<p>What is strange for me, that this only fails when using rulesets. If I set any text field directly to a value containing a closing bracket, everything is fine.</p>



<a name="236503119"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/RuleSet%20containig%20parameter%20with%20closing%20bracket%20fails/near/236503119" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/RuleSet.20containig.20parameter.20with.20closing.20bracket.20fails.html#236503119">(Apr 28 2021 at 13:06)</a>:</h4>
<p>In this case, I believe SUSHI treats <code>)</code> like a special character, so if you want to include it in a parameter, escaping it with <code>\</code> should do the trick. Here is a very slightly modified version of the example you set: <a href="https://fshschool.org/FSHOnline/#/share/3nrI5CA">https://fshschool.org/FSHOnline/#/share/3nrI5CA</a>. Note that there I've escaped the <code>)</code>, and it runs without error.</p>



<a name="236504586"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/RuleSet%20containig%20parameter%20with%20closing%20bracket%20fails/near/236504586" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Nau <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/RuleSet.20containig.20parameter.20with.20closing.20bracket.20fails.html#236504586">(Apr 28 2021 at 13:16)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="239822">@Nick Freiter</span> ! Worked for me.<br>
I'm wondering why one needs to escape <code>)</code>  in strings when using in rule sets but when I try escaping them without using rulesets, it will fail. Strange. <br>
But thanks for your solution!</p>



<a name="236505097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/RuleSet%20containig%20parameter%20with%20closing%20bracket%20fails/near/236505097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/RuleSet.20containig.20parameter.20with.20closing.20bracket.20fails.html#236505097">(Apr 28 2021 at 13:20)</a>:</h4>
<p>I believe it is because SUSHI is very permissive in what it accepts as params to a RuleSet. It basically accepts any and all characters in any order. So the characters that split apart and contain those parameters <code>,</code> and <code>()</code> need special treatment.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
