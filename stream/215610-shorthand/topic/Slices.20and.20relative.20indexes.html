---
layout: page
title: "FHIR Chat  · Slices and relative indexes · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html">Slices and relative indexes</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="264889468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264889468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264889468">(Dec 14 2021 at 17:02)</a>:</h4>
<p>In the latest sushi, if I have two entries (e.g., us-core-practitioner identifiers) and one is a slice and the second uses relative indexing, the indexed on overwrites the slice named one.  <br>
e.g.,</p>
<div class="codehilite"><pre><span></span><code>* identifier[NPI].value = &quot;9941339108&quot;
* identifier[+].system = &quot;http://www.acme.org/practitioners&quot;
* identifier[=].value = &quot;25456&quot;
</code></pre></div>



<a name="264889504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264889504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264889504">(Dec 14 2021 at 17:02)</a>:</h4>
<p>will show only the second identifier</p>



<a name="264889558"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264889558" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264889558">(Dec 14 2021 at 17:02)</a>:</h4>
<p>if I use normal indexing, then both show up.</p>



<a name="264889615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264889615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264889615">(Dec 14 2021 at 17:03)</a>:</h4>
<p>Is that intentional?</p>



<a name="264889640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264889640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264889640">(Dec 14 2021 at 17:03)</a>:</h4>
<p>I hope not</p>



<a name="264889911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264889911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264889911">(Dec 14 2021 at 17:04)</a>:</h4>
<p>I think someone else will be carving the roast fish at the Who Feast</p>



<a name="264902268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264902268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264902268">(Dec 14 2021 at 18:21)</a>:</h4>
<p>I think this is how it has always worked, but you said "in the latest SUSHI" -- so I just want to be sure: was this working differently in a prior version of SUSHI?</p>
<p>Currently, when SUSHI sees a <code>[+]</code> without any prior <code>[+]</code> or specific index (e.g., <code>[1]</code>), it assumes <code>[0]</code>.  It doesn't take prior slice instances into account.  I'm not saying this is how it <em>should</em> work, but I think this is how it <em>does</em> work right now.</p>
<p>The spec says this:</p>
<blockquote>
<p>In soft indexing, [+] is used to increment the last referenced index by 1, and [=] is used to reference the same index that was last referenced. When an array is empty, [+] refers to the first element ([0]). FSH also allows for soft and numerical indices to be mixed.</p>
</blockquote>
<p>In your case, there technically isn't any "last referenced index", and the array is not empty, so... there is some room for interpretation (which is probably not great).  I think we've recently discussed the idea that if <code>[+]</code> is used w/ no prior <code>[+]</code> or <code>[n]</code>, it appends to the end of the array.  That would probably help here.  Or we could say that <code>[+]</code> increments after the last referenced index _or slice_.  We'd need to think about the implications of each approach.</p>
<p>For now, you would need to explicitly set the first index after the slice and then you could use <code>[+]</code> after that:</p>
<div class="codehilite"><pre><span></span><code>* identifier[NPI].value = &quot;9941339108&quot;
* identifier[1].system = &quot;http://www.acme.org/practitioners&quot;
* identifier[=].value = &quot;25456&quot;
* identifier[+].system = &quot;http://www.foo.org/practitioners&quot;
* identifier[=].value = &quot;36567&quot;
</code></pre></div>



<a name="264904293"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264904293" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264904293">(Dec 14 2021 at 18:36)</a>:</h4>
<p>It would be good if the slices were counted as part of the indexing order and then we can use it the way that seems to make sense to me.  But at least now I know that it's failing successfully now.</p>



<a name="264908678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264908678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264908678">(Dec 14 2021 at 19:00)</a>:</h4>
<p>Alternately, an error message telling me that there's no first index and sushi is wiping out my slice entry would be good.</p>



<a name="264934095"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264934095" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264934095">(Dec 14 2021 at 22:11)</a>:</h4>
<p>im with Dave. Either these slice instances are an implied [+]; or there should be an error.</p>



<a name="264934187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264934187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264934187">(Dec 14 2021 at 22:12)</a>:</h4>
<p>I do recall this working that way at some point, but I don't recall it working that way a few months ago.</p>



<a name="264934653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264934653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264934653">(Dec 14 2021 at 22:16)</a>:</h4>
<p>Yeah, I think that being aware of (and compensating for) previous slices makes sense.  We'll just have to see how hard that is to implement!</p>



<a name="264935529"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/Slices%20and%20relative%20indexes/near/264935529" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/Slices.20and.20relative.20indexes.html#264935529">(Dec 14 2021 at 22:25)</a>:</h4>
<p><a href="https://github.com/FHIR/sushi/issues/983">SUSHI#983</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
