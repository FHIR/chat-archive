---
layout: page
title: "FHIR Chat  · My slices aren&#x27;t working on AuditEvent · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/My.20slices.20aren&#x27;t.20working.20on.20AuditEvent.html">My slices aren&#x27;t working on AuditEvent</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="189000129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/My%20slices%20aren%27t%20working%20on%20AuditEvent/near/189000129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/My.20slices.20aren&#x27;t.20working.20on.20AuditEvent.html#189000129">(Feb 25 2020 at 08:32)</a>:</h4>
<p>I'm trying to create slices on agent in audit event, where the slices are on the values of role and requestor.</p>
<p>First I set up the discriminators thus:</p>
<ul>
<li>agent ^slicing.discriminator[0].type = #pattern</li>
<li>agent ^slicing.discriminator[0].path = "role"</li>
<li>agent ^slicing.discriminator[1].type = #pattern</li>
<li>agent ^slicing.discriminator[1].path = "requestor"</li>
<li>agent ^slicing.description = "Slicing is based on role and requestor."</li>
<li>agent ^slicing.ordered = false</li>
<li>agent ^slicing.rules = #open</li>
</ul>
<p>Then I declare use of three slices in the profile:</p>
<ul>
<li>agent contains Source 1..1 and HumanRequestor 0..* and Destination 1..1</li>
</ul>
<p>Then I describe constraints on each slice inline, including on the discriminator fields:</p>
<ul>
<li>agent[Source].role =  <a href="http://dicom.nema.org/resources/ontology/DCM#110153" target="_blank" title="http://dicom.nema.org/resources/ontology/DCM#110153">http://dicom.nema.org/resources/ontology/DCM#110153</a> "Source"</li>
<li>agent[Source].requestor = false</li>
<li>agent[Source].altId 1..1</li>
<li>
<p>agent[Source].name 1..1</p>
</li>
<li>
<p>agent[HumanRequestor].requestor = true</p>
</li>
<li>agent[HumanRequestor].role 0..*</li>
<li>agent[HumanRequestor].altId 1..1</li>
<li>
<p>agent[HumanRequestor].name 1..1</p>
</li>
<li>
<p>agent[Destination].role =  <a href="http://dicom.nema.org/resources/ontology/DCM#110152" target="_blank" title="http://dicom.nema.org/resources/ontology/DCM#110152">http://dicom.nema.org/resources/ontology/DCM#110152</a> "Destination"</p>
</li>
<li>agent[Destination].requestor = false</li>
<li>agent[Destination].altId 1..1</li>
<li>agent[Destination].name 1..1</li>
</ul>
<p>The produced StructureDefinition doesn't include discriminators for agent at all.</p>



<a name="189019517"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/My%20slices%20aren%27t%20working%20on%20AuditEvent/near/189019517" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/My.20slices.20aren&#x27;t.20working.20on.20AuditEvent.html#189019517">(Feb 25 2020 at 13:36)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191387">@Keith Boone</span>.  That's odd.  We'll take a look.</p>



<a name="189019794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/My%20slices%20aren%27t%20working%20on%20AuditEvent/near/189019794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/My.20slices.20aren&#x27;t.20working.20on.20AuditEvent.html#189019794">(Feb 25 2020 at 13:39)</a>:</h4>
<p>Logged here: <a href="https://github.com/FHIR/sushi/issues/254" target="_blank" title="https://github.com/FHIR/sushi/issues/254">https://github.com/FHIR/sushi/issues/254</a></p>



<a name="189022903"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/My%20slices%20aren%27t%20working%20on%20AuditEvent/near/189022903" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/My.20slices.20aren&#x27;t.20working.20on.20AuditEvent.html#189022903">(Feb 25 2020 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191387">@Keith Boone</span> do you have the full FSH file? I tried to replicate this by just copying and pasting those rules:</p>
<div class="codehilite"><pre><span></span>Profile: MyAuditEvent
Parent: AuditEvent
* agent ^slicing.discriminator[0].type = #pattern
* agent ^slicing.discriminator[0].path = &quot;role&quot;
* agent ^slicing.discriminator[1].type = #pattern
* agent ^slicing.discriminator[1].path = &quot;requestor&quot;
* agent ^slicing.description = &quot;Slicing is based on role and requestor.&quot;
* agent ^slicing.ordered = false
* agent ^slicing.rules = #open
* agent contains Source 1..1 and HumanRequestor 0..* and Destination 1..1
* agent[Source].role = http://dicom.nema.org/resources/ontology/DCM#110153 &quot;Source&quot;
* agent[Source].requestor = false
* agent[Source].altId 1..1
* agent[Source].name 1..1
* agent[HumanRequestor].requestor = true
* agent[HumanRequestor].role 0..*
* agent[HumanRequestor].altId 1..1
* agent[HumanRequestor].name 1..1
* agent[Destination].role = http://dicom.nema.org/resources/ontology/DCM#110152 &quot;Destination&quot;
* agent[Destination].requestor = false
* agent[Destination].altId 1..1
* agent[Destination].name 1..1
</pre></div>


<p>And this did produce output with discriminators on the <code>AuditEvent.agent</code> element. So there may be a cause outside these rules alone.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
