---
layout: page
title: "FHIR Chat  · How can I auto-populate constrained fields in  Instances? · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20can.20I.20auto-populate.20constrained.20fields.20in.20.20Instances.3F.html">How can I auto-populate constrained fields in  Instances?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="227844631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20can%20I%20auto-populate%20constrained%20fields%20in%20%20Instances%3F/near/227844631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martin Höcker <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20can.20I.20auto-populate.20constrained.20fields.20in.20.20Instances.3F.html#227844631">(Feb 25 2021 at 21:47)</a>:</h4>
<p>Early on in my SUSHI-usage, I discovered that SUSHI can automatically populate some values in <code>Instance</code>s, like so:</p>
<div class="codehilite"><pre><span></span><code>Profile: MyPatient1
Parent: Patient
* name ^slicing.discriminator.path = &quot;family&quot;
* name ^slicing.discriminator.type = #pattern
* name contains bäcker 0..1
* name[bäcker].family = &quot;Bäcker&quot;

Instance: ExamplePatient1
InstanceOf: MyPatient1
* name[bäcker].given = &quot;Jürgen&quot;
</code></pre></div>
<p>In the output, the Patient's name "Jürgen Bäcker" is automatically given in full:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Patient"</span>
  <span class="err">...</span>
  <span class="nt">"name"</span><span class="p">:</span> <span class="p">[{</span>
      <span class="nt">"family"</span><span class="p">:</span> <span class="nt">"Bäcker"</span>
      <span class="nt">"given"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Jürgen"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>This feature delighted be, because it spared me from having to write "obvious", "already constrained" information twice. </p>
<p>But when discriminating on deeper paths, this feature did not work for me. For example:</p>
<div class="codehilite"><pre><span></span><code>Profile: MyPatient2
Parent: Patient
* contact ^slicing.discriminator.path = &quot;address.text&quot;
* contact ^slicing.discriminator.type = #pattern
* contact contains mars 0..1
* contact[mars].address.text = &quot;Mars&quot;

Instance: ExamplePatient2
InstanceOf: MyPatient2
* contact[mars].gender = #male
</code></pre></div>
<p>The output is</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Patient"</span><span class="p">,</span>
  <span class="err">...</span>
  <span class="nt">"contact"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"gender"</span><span class="p">:</span> <span class="s2">"male"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>Is there a way to ask SUSHI to automatically populate all fields that have a fixed value (or an unambiguous pattern value)?</p>



<a name="227846018"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20can%20I%20auto-populate%20constrained%20fields%20in%20%20Instances%3F/near/227846018" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20can.20I.20auto-populate.20constrained.20fields.20in.20.20Instances.3F.html#227846018">(Feb 25 2021 at 21:57)</a>:</h4>
<p>When adding this feature, we did not want to make it so that SUSHI would auto-populate incorrect values, since then a user would have very little way of removing those auto-populated values. So the automatic population is intentionally conservative. In this case, the <code>contact[mars].address.text</code> field is constrained to the value <code>Mars</code>, but this field has cardinality <code>0..1</code>, so SUSHI cannot know for sure that the value should be populated. Unfortunately there isn't a way to ask SUSHI to automatically populate all fixed values. The concern would be that such a feature could lead to many unwanted values being populated, because so many elements are optional.</p>



<a name="227847136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20can%20I%20auto-populate%20constrained%20fields%20in%20%20Instances%3F/near/227847136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martin Höcker <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20can.20I.20auto-populate.20constrained.20fields.20in.20.20Instances.3F.html#227847136">(Feb 25 2021 at 22:05)</a>:</h4>
<p>Ahh, thank you, I had missed the cardinality side of it. So now I understand why the following example only worked "sometimes" for me:</p>
<div class="codehilite"><pre><span></span><code>Profile: MyPatient1
Parent: Patient
* active = true
* active 1..1

Instance: ExamplePatient1
InstanceOf: MyPatient1
</code></pre></div>
<p>On some real-world examples, I did not have the corresponding element fixed to 1..1.</p>
<p>But coming back to the slicing-example, I would argue that by using the slice I show my intent that it should be a valid slice that corresponds to my discriminator, so I would kind-of expect that the constrained element should be there.  It's a minor issue though, since changing my code to </p>
<div class="codehilite"><pre><span></span><code>Profile: MyPatient2
Parent: Patient
* contact ^slicing.discriminator.path = &quot;address.text&quot;
* contact ^slicing.discriminator.type = #pattern
* contact contains mars 0..1
* contact[mars].address.text = &quot;Mars&quot;
* contact[mars].address 1..1

Instance: ExamplePatient2
InstanceOf: MyPatient2
* contact[mars].gender = #male
</code></pre></div>
<p>fixes the issue for me. Thank you for your help!</p>



<a name="227851447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20can%20I%20auto-populate%20constrained%20fields%20in%20%20Instances%3F/near/227851447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martin Höcker <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20can.20I.20auto-populate.20constrained.20fields.20in.20.20Instances.3F.html#227851447">(Feb 25 2021 at 22:37)</a>:</h4>
<p>Short addendum: The first example I posted also discriminates on an optional element, but in that example it is automatically populated (which is helpful, I think). My proposal would be to extend this behavior to deep paths, if and only if they are used in discriminators.</p>



<a name="227928790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/How%20can%20I%20auto-populate%20constrained%20fields%20in%20%20Instances%3F/near/227928790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/How.20can.20I.20auto-populate.20constrained.20fields.20in.20.20Instances.3F.html#227928790">(Feb 26 2021 at 13:42)</a>:</h4>
<p>That is a good point. Currently SUSHI does not really handle discriminators in a "smart" way. SUSHI doesn't do any sort of validation or interpretation of discriminator values. Ideally we would be able to detect that the constrained element should be there though.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
