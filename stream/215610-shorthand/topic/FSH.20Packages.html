---
layout: page
title: "FHIR Chat  · FSH Packages · shorthand"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/index.html">shorthand</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html">FSH Packages</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="188683154"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188683154" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188683154">(Feb 20 2020 at 22:01)</a>:</h4>
<p>Where does SUSHI resolve its packages from? <br>
I tried to add a package that was published on SImplifier at <a href="https://simplifier.net/packages" target="_blank" title="https://simplifier.net/packages">https://simplifier.net/packages</a> and it could not locate it.</p>



<a name="188686681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188686681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188686681">(Feb 20 2020 at 22:38)</a>:</h4>
<p>It loads <code>dev</code> versions from your local cache, <code>current</code> versions from <a href="http://build.fhir.org" target="_blank" title="http://build.fhir.org">http://build.fhir.org</a>, and all other versions from <a href="http://packages.fhir.org" target="_blank" title="http://packages.fhir.org">http://packages.fhir.org</a>.  We could probably update it to fall back to <a href="http://simplifier.net" target="_blank" title="http://simplifier.net">simplifier.net</a> if it can't find it in <a href="http://packages.fhir.org" target="_blank" title="http://packages.fhir.org">packages.fhir.org</a> (but we haven't implemented that currently).</p>



<a name="188687110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188687110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188687110">(Feb 20 2020 at 22:45)</a>:</h4>
<p><a href="http://packages.fhir.org" target="_blank" title="http://packages.fhir.org">packages.fhir.org</a> is just an alias for simplifier. You'll have to ask firely why a package isn't available</p>



<a name="188696921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188696921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188696921">(Feb 21 2020 at 01:37)</a>:</h4>
<p>Ah, OK.  I was thinking it was a separate instance of simplifier.  I didn't realize (or forgot) it was an alias.</p>



<a name="188696981"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188696981" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188696981">(Feb 21 2020 at 01:38)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> -- if you can tell us how you're referencing the package in package.json, we can look at it from our end.</p>



<a name="188712971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188712971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188712971">(Feb 21 2020 at 08:45)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191469">@Chris Moesel</span>  I was attempting to add this package <a href="https://simplifier.net/packages/uk.core.r4/1.0.0" target="_blank" title="https://simplifier.net/packages/uk.core.r4/1.0.0">https://simplifier.net/packages/uk.core.r4/1.0.0</a></p>
<p>I amended package.json to</p>
<div class="codehilite"><pre><span></span> &quot;dependencies&quot;: {
    &quot;hl7.fhir.r4.core&quot;: &quot;4.0.1&quot;,
    &quot;hl7.fhir.us.core&quot;: &quot;3.1.0&quot;,
    &quot;UK.Core.r4&quot;: &quot;1.0.0&quot;
 },
</pre></div>


<p>When I executed SUSHI the log showed</p>
<p>Found UK.Core.r4#1.0.0 in local cache.<br>
error Failed to add UK.Core.r4:1.0.0 to ImplementationGuide instance.  Could not determine its canonical URL from the FHIR cache.</p>



<a name="188728563"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188728563" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188728563">(Feb 21 2020 at 12:58)</a>:</h4>
<p>SUSHI expects that the ImplementationGuide resource  for this package in <code>hl7fhirukcoreimplementationguider4-january2020.json</code> does not declare a <code>packageId</code>. SUSHI expects that the package <code>UK.Core.r4#1.0.0</code> will have <code>packageId</code> set to <code>UK.Core.r4</code>, and <code>version</code> set to <code>1.0.0</code> in the ImplementationGuide resource. A workaround would be to set these values locally:<br>
1) Navigate to your local FHIR cache located at <code>~/.fhir/packages</code><br>
2) Find the <code>UK.Core.r4#1.0.0</code> folder,  and navigate to <code>~/.fhir/packages/UK.Core.r4#1.0.0/package</code><br>
3) Open the  <code>hl7fhirukcoreimplementationguider4-january2020.json</code> file in this folder<br>
4) Change the <code>version</code> field from <code>January 2020</code> to <code>1.0.0</code><br>
5)  Add a <code>packageId</code> field that is set to <code>UK.Core.r4</code></p>
<p>This should allow SUSHI to correctly find the <code>UK.Core.r4</code> package. It seems this package should come with a <code>packageId</code> already set, since that appears to be a required field on the ImplementationGuide resource. We have been assuming that the <code>version</code> field would match the numerical version given when specifying the dependency, but maybe that is an incorrect assumption on our end.</p>



<a name="188733271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188733271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188733271">(Feb 21 2020 at 14:02)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="239822">@Nick Freiter</span>  that seems to have helped a bit. I'm not sure why the package has these items missing.</p>
<p>I don't get the error message anymore, now I get a new one.</p>
<div class="codehilite"><pre><span></span>error Cannot read property &#39;children&#39; of undefined
</pre></div>


<p>My FSH file is</p>
<div class="codehilite"><pre><span></span>Instance:   RichardSMITH
InstanceOf: https://fhir.nhs.uk/R4/StructureDefinition/UKCore-Patient
Title: &quot;Richard SMITH&quot;
* gender = #female
* name.given = &quot;Richard&quot;
* name.family = &quot;SMITH&quot;
* name.use = &quot;official&quot;
</pre></div>


<p>I don't get any output from this file at all.</p>



<a name="188739019"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188739019" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Kramer <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188739019">(Feb 21 2020 at 15:01)</a>:</h4>
<p>The RichardSMITH output should be located in build/input/examples/Patient-RichardSMITH.json</p>



<a name="188740062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188740062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188740062">(Feb 21 2020 at 15:10)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191447">@Mark Kramer</span> the folder is empty. I have generated examples from other FSH files but I have removed them all to isolate the problem. I now only have the one FSH file and nothing gets generated. I guess it has to do with the error message I posted previously.</p>
<p>As I am using the UK Core package I can only imagine that there is an issue with the package.</p>



<a name="188740471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188740471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188740471">(Feb 21 2020 at 15:15)</a>:</h4>
<p>The following FSH generated OK  so it must be the package that is the issue.</p>
<div class="codehilite"><pre><span></span>Instance:   JohnSMITH
InstanceOf: Patient
Title: &quot;John SMITH&quot;
* gender = #male
* name.given = &quot;John&quot;
* name.family = &quot;SMITH&quot;
* name.use = #home
</pre></div>



<a name="188740936"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188740936" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188740936">(Feb 21 2020 at 15:19)</a>:</h4>
<p>The package was created using Simplifier not the HL7 IG Publisher - perhaps there are inconsistencies at the moment. <span class="user-mention" data-user-id="203235">@Ward Weistra</span>  are you aware of any?</p>



<a name="188741338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188741338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Freiter <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188741338">(Feb 21 2020 at 15:23)</a>:</h4>
<p>It looks like the <a href="https://fhir.nhs.uk/R4/StructureDefinition/UKCore-Patient" target="_blank" title="https://fhir.nhs.uk/R4/StructureDefinition/UKCore-Patient">https://fhir.nhs.uk/R4/StructureDefinition/UKCore-Patient</a> Structure Definition that comes from that package only has a differential, no snapshot. As of now, SUSHI is dependent on a snapshot being present in the Structure Definition. This is something we can consider addressing, but it would be complex to develop, since we would need to either modify a lot of our handling, or develop the ability to generate snapshots from differentials.</p>
<p>So far the assumption that IGs would have snapshots hasn't come back to bite us. Is having an IG without snapshots more common than we thought?</p>



<a name="188741663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188741663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188741663">(Feb 21 2020 at 15:26)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> , <span class="user-mention" data-user-id="203235">@Ward Weistra</span> -- is it safe to assume, in general, that IGs we retrieve from <a href="http://packages.fhir.org" target="_blank" title="http://packages.fhir.org">packages.fhir.org</a> will have snapshot populated in their SDs?</p>



<a name="188743368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188743368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188743368">(Feb 21 2020 at 15:42)</a>:</h4>
<p><span class="user-mention" data-user-id="239822">@Nick Freiter</span> I have manually forced the generation of the Snapshot for the profile that was having the issues and now it works.<br>
I'll feedback to the authors and hopefully, they will fix this in the next release.<br>
Thanks for your help.</p>



<a name="188752342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188752342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188752342">(Feb 21 2020 at 17:09)</a>:</h4>
<p>Thanks for troubleshooting this, gentlemen!</p>
<p><span class="user-mention" data-user-id="239822">@Nick Freiter</span> Why is SUSHI relying on the ImplementationGuide resource in a package? I don't think every package will have one.<br>
I'm surprised to indeed see packageId to be mandatory on the IG resource though. So I'll see how we can fill that at some point.</p>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> I'm afraid that that's not the case. Since calculating snapshots is compute intensive (and the logic changes now and then) we don't include them by default in new packages. It also feels a bit like duplicating content which is contained in the dependencies, although I see the convenience and have had the request before...</p>
<p>Sidenote: the package registry of course delivers packages, not IGs ;)</p>
<p>The spec states 'All FHIR Implementation Guides are published as NPM packages, one package for each IG.' but not every package needs to have an IG included. The IG publisher stack creates this one to one link, but it can't be expected from FHIR packages in general.</p>



<a name="188754125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188754125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188754125">(Feb 21 2020 at 17:27)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="203235">@Ward Weistra</span> -- we currently rely on an ImplementationGuide resource because when we build the <code>ImplementationGuide</code> for the SUSHI IG, we need to populate <code>dependsOn</code>.  Unfortunately, <code>dependsOn</code> requires (<code>1..1</code>) the <code>uri</code> property, which has type <code>canonical(ImplementationGuide)</code>.<br>
<a href="/user_uploads/10155/coGVKlpSBQbQEj2egL_fXOdq/image.png" target="_blank" title="image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/coGVKlpSBQbQEj2egL_fXOdq/image.png" target="_blank" title="image.png"><img src="/user_uploads/10155/coGVKlpSBQbQEj2egL_fXOdq/image.png"></a></div>



<a name="188754230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188754230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188754230">(Feb 21 2020 at 17:28)</a>:</h4>
<p>That's pretty hard to populate if there is no ImplementationGuide to point to.</p>



<a name="188754417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188754417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188754417">(Feb 21 2020 at 17:30)</a>:</h4>
<p>Seems like maybe a hiccup in the system if the intent is to allow dependencies on non-IG packages.</p>



<a name="188754636"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188754636" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188754636">(Feb 21 2020 at 17:32)</a>:</h4>
<blockquote>
<p>Since calculating snapshots is compute intensive (and the logic changes now and then)</p>
</blockquote>
<p>Ha.  This is exactly why we want to rely on the snapshot being there instead of having to compute it ourselves. ;-)  I guess if we need to support packages that don't include snapshots, we'll either need to revisit our approach to building SDs or we'll have to implement a snapshot generator (sigh).</p>



<a name="188755347"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188755347" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188755347">(Feb 21 2020 at 17:39)</a>:</h4>
<p>Thank <span class="user-mention" data-user-id="191469">@Chris Moesel</span>. Yes, that's interesting. You want to help your user to populate the <code>depends on</code> of their IG. But only in the HL7 balloting world there's the convention that the packages an IG depends on will have an IG in the package.</p>
<p>I guess the aim for FISH is to be there for a larger audience than just that world. There's no guarantee the user even wants to make an IG themselves I'd say. So possibly that logic to help create the IG resource could be optional.<br>
Or for dependency packages without an IG you could not include that package in <code>depends on</code> of the IG. It will still be in the package.json. Or allow the user to specify a list of <code>depends on</code>s if there are IG linked to those packages but they are not IN the packages (since that's not required).</p>



<a name="188762259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188762259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188762259">(Feb 21 2020 at 18:50)</a>:</h4>
<p>I believe that someone has already created a Snapshot Generator, although it might not be in your preferred programming language.  One possible solution would be to stand it up as a service somewhere though.</p>



<a name="188762512"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188762512" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188762512">(Feb 21 2020 at 18:53)</a>:</h4>
<p>Yeah, I think we'll need to think on it some more <span class="user-mention" data-user-id="203235">@Ward Weistra</span>.  SUSHI doesn't require you to produce an IG -- we only create the ImplementationGuide JSON if the FSH Tank has an <code>ig-data</code> folder in it.  Tanks without that folder will get the resource files only (without any IG stuff).  So this is only relevant for folks who <em>want</em> to create an IG.  But if they <em>do</em>, I think we still have an issue if they rely on a package that doesn't have an ImplementationGuide -- as the template-based publishing doesn't use the package.json; it only uses the ig.ini and ImplementationGuide JSON.</p>



<a name="188762691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188762691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188762691">(Feb 21 2020 at 18:55)</a>:</h4>
<p><span class="user-mention" data-user-id="203235">@Ward Weistra</span> is correct that packages do not require an Implementation Guide resource. OTOH, all implementation guide packages will have an one. The issue here is that there's no facility for a FHIR implementation guide to depend on profiles that are not published via an implementation guide. That's not a tooling limitation, that's baked into the definition of the implementation guide resource</p>



<a name="188762791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188762791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188762791">(Feb 21 2020 at 18:56)</a>:</h4>
<p>but if I track this discussion correctly, the intent is to depend on a package that is an implementation guide, but doesn't have an implementation guide resource, and there fore the problem is in the source package</p>



<a name="188762891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188762891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188762891">(Feb 21 2020 at 18:57)</a>:</h4>
<p>I think that we should have a rule that all implementation guide packages that represent a published implementation guide should include snapshots</p>



<a name="188763028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188763028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188763028">(Feb 21 2020 at 18:58)</a>:</h4>
<p>I think this conversation actually started w/ a dependency on a package that <em>had</em> an implementation guide, but that implementation guide was not conformant (missing the packageId property).  It also had resources without snapshots.  The conversation then morphed into the more general discussion about our reliance on dependency IGs.</p>



<a name="188763577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188763577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188763577">(Feb 21 2020 at 19:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191387">@Keith Boone</span> -- I'm aware of a snapshot generator in Java (part of the Publisher tooling I think) and one in .NET (part of Forge maybe?).  I don't know how separable they are, but standing one up as a service seems feasible.  I was going to say that the downside is that SUSHI could not run offline -- but we already require network if you need to download dependencies, so in theory we could do the snapshot generation immediately after that (and cache it somewhere).  Still, IMO, the fewer external network dependencies we have, the better...  Gonna have to think on this one.</p>



<a name="188764111"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188764111" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188764111">(Feb 21 2020 at 19:09)</a>:</h4>
<p>That said, even if I wanted to, I'm not sure I can justify building it myself just because I didn't want a network call.  That said, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> -- is there a published algorithm or approach for generating snapshots?  Are there only a few rules to keep in mind or are there lots of complexities and edge cases?  It's one of those things that sounds simple on the surface ("just a special merge") but I bet has lots of gremlins lurking beneath.</p>



<a name="188765940"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188765940" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188765940">(Feb 21 2020 at 19:29)</a>:</h4>
<p>loooots of gremlins hiding underneath.</p>



<a name="188765954"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188765954" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188765954">(Feb 21 2020 at 19:29)</a>:</h4>
<p>there's a set of test cases, and I shudder each time I have to revisit them</p>



<a name="188766052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188766052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188766052">(Feb 21 2020 at 19:30)</a>:</h4>
<p>agree it makes sense to generate the depedencies when installing the package. You don't need a network service for it; the validator can generate snapshots on reqeust</p>



<a name="188766212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188766212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188766212">(Feb 21 2020 at 19:32)</a>:</h4>
<p>We're TypeScript/JavaScript -- so we'd need to make a system call to call the validator -- and that would require the user to have Java installed.  Still, if they want to use the IG Publisher, I guess they need Java already anyway.</p>



<a name="188766427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188766427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188766427">(Feb 21 2020 at 19:34)</a>:</h4>
<p>one easy way is to die with an error if the package doesn't have snapshots and get the user to do it manually to the installed package, and I add a command line option to do that</p>



<a name="188823139"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188823139" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188823139">(Feb 22 2020 at 16:15)</a>:</h4>
<p>You might be able to use Google's JCL (<a href="https://www.infoq.com/news/2019/05/j2cl-java-javascript-transpiler/" target="_blank" title="https://www.infoq.com/news/2019/05/j2cl-java-javascript-transpiler/">https://www.infoq.com/news/2019/05/j2cl-java-javascript-transpiler/</a>) to transcode the Java one to JavaScript and run it inside Sushi.</p>



<a name="188832170"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188832170" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188832170">(Feb 22 2020 at 20:33)</a>:</h4>
<p>carumba. Given the scope of the dependencies for the validator (json xml rdf apache libraries) I wouldn't hold my breath</p>



<a name="188832343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188832343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188832343">(Feb 22 2020 at 20:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191469">Chris Moesel</span> <a href="#narrow/stream/215610-shorthand/topic/FSH.20Packages/near/188766212" title="#narrow/stream/215610-shorthand/topic/FSH.20Packages/near/188766212">said</a>:</p>
<blockquote>
<p>We're TypeScript/JavaScript -- so we'd need to make a system call to call the validator -- and that would require the user to have Java installed.  Still, if they want to use the IG Publisher, I guess they need Java already anyway.</p>
</blockquote>
<p>roll it in docker ... then you're off the hook</p>



<a name="188832404"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188832404" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188832404">(Feb 22 2020 at 20:42)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> we are some people that roll the entire setup in docker ... leaving the Java Runtime as well as Jekyll and Ruby inside the whale where it belongs</p>



<a name="188832464"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188832464" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188832464">(Feb 22 2020 at 20:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191387">Keith Boone</span> <a href="#narrow/stream/215610-shorthand/topic/FSH.20Packages/near/188823139" title="#narrow/stream/215610-shorthand/topic/FSH.20Packages/near/188823139">said</a>:</p>
<blockquote>
<p>You might be able to use Google's JCL (<a href="https://www.infoq.com/news/2019/05/j2cl-java-javascript-transpiler/" target="_blank" title="https://www.infoq.com/news/2019/05/j2cl-java-javascript-transpiler/">https://www.infoq.com/news/2019/05/j2cl-java-javascript-transpiler/</a>) to transcode the Java one to JavaScript and run it inside Sushi.</p>
</blockquote>
<p>The sun would have burned out long before you get that to succeed ... that would be my estimate</p>



<a name="188926104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188926104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188926104">(Feb 24 2020 at 13:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> -- Do we want to encourage users to modify their installed packages like that?  I assumed that, for the most part, we wanted packages to be managed more tightly than that?  And when you said "and I add a command line option to do that" -- do you mean you would add a command-line option to the validator to populate snapshots in an installed package?</p>
<p><span class="user-mention" data-user-id="191387">@Keith Boone</span> -- I actually hadn't seen J2CL before.  I'm intrigued!  Even if it doesn't work out here, it might be helpful for one of my JS-based CQL projects than needs to use the Java-based CQL-to-ELM translator.  Thanks for the pointer!</p>
<p><span class="user-mention" data-user-id="191427">@Jens Villadsen</span> -- Yes, Docker would certainly alleviate some of these concerns -- but some of the audience we're targeting probably isn't really the Docker type.  Still, we certainly could consider Docker as an option for those who do use it.</p>



<a name="188926880"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188926880" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188926880">(Feb 24 2020 at 13:45)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> - well ... my impression is that FSH pretty much targets both kinds of audience ;)</p>



<a name="188926930"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188926930" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188926930">(Feb 24 2020 at 13:45)</a>:</h4>
<p><span class="user-mention" data-user-id="191427">@Jens Villadsen</span> -- agreed.</p>



<a name="188933319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188933319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188933319">(Feb 24 2020 at 14:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> , I too am intrigued.  Let me know how well it works if you get to play with it before I do, and I'll do the same.</p>



<a name="188960564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188960564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188960564">(Feb 24 2020 at 20:02)</a>:</h4>
<blockquote>
<p>Do we want to encourage users to modify their installed packages like that?</p>
</blockquote>
<p>Not in principle, no. But the question here appears to be least worst approach overall. So it's an option</p>



<a name="188960578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/188960578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#188960578">(Feb 24 2020 at 20:02)</a>:</h4>
<blockquote>
<p>you would add a command-line option to the validator to populate snapshots in an installed package?</p>
</blockquote>
<p>yes</p>



<a name="189009292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/189009292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#189009292">(Feb 25 2020 at 10:59)</a>:</h4>
<p>I guess there's no need to 'edit the packages' themselves, but rather creating a set of temporary snapshots in the user's cache? Maybe just a phrasing difference, but lets keep packages immutable.</p>



<a name="189010533"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/215610-shorthand/topic/FSH%20Packages/near/189010533" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/215610-shorthand/topic/FSH.20Packages.html#189010533">(Feb 25 2020 at 11:17)</a>:</h4>
<p>yes they are immutable</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
