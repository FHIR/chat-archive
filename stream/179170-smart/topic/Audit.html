---
layout: page
title: "FHIR Chat  · Audit · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html">Audit</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="168206810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168206810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168206810">(Jun 15 2019 at 12:52)</a>:</h4>
<p>Has anyone defined auditEvent profiles for the smart activities? Do OAuth implementations record these events in a local text log, what does that log look like?</p>



<a name="168206813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168206813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168206813">(Jun 15 2019 at 12:52)</a>:</h4>
<p>I do, if that's worth anything.</p>



<a name="168210767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168210767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168210767">(Jun 15 2019 at 14:53)</a>:</h4>
<p>That is worth solid gold... Can you share?</p>



<a name="168218433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168218433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168218433">(Jun 15 2019 at 18:34)</a>:</h4>
<p>ok. login:</p>



<a name="168218488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168218488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168218488">(Jun 15 2019 at 18:36)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;resourceType&quot;</span> <span class="p">:</span> <span class="s2">&quot;AuditEvent&quot;</span><span class="p">,</span>
  <span class="nt">&quot;text&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;status&quot;</span> <span class="p">:</span> <span class="s2">&quot;generated&quot;</span><span class="p">,</span>
    <span class="nt">&quot;div&quot;</span> <span class="p">:</span> <span class="s2">&quot;snip!&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://nema.org/dicom/dcid&quot;</span><span class="p">,</span>
    <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;110114&quot;</span><span class="p">,</span>
    <span class="nt">&quot;display&quot;</span> <span class="p">:</span> <span class="s2">&quot;User Authentication&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;subtype&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://nema.org/dicom/dcid&quot;</span><span class="p">,</span>
      <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;110144&quot;</span><span class="p">,</span>
      <span class="nt">&quot;display&quot;</span> <span class="p">:</span> <span class="s2">&quot;Login&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;action&quot;</span> <span class="p">:</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span>
  <span class="nt">&quot;recorded&quot;</span> <span class="p">:</span> <span class="s2">&quot;2019-06-15T18:31:56.891Z&quot;</span><span class="p">,</span>
  <span class="nt">&quot;outcome&quot;</span> <span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;agent&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;who&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;identifier&quot;</span> <span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span><span class="p">,</span>
          <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;141&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&quot;altId&quot;</span> <span class="p">:</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;g (unknown)&quot;</span><span class="p">,</span>
      <span class="nt">&quot;requestor&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nt">&quot;network&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;4&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;site&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://local.fhir.org&quot;</span><span class="p">,</span>
    <span class="nt">&quot;observer&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;identifier&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;urn:ietf:rfc:3986&quot;</span><span class="p">,</span>
        <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/security-source-type&quot;</span><span class="p">,</span>
        <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
        <span class="nt">&quot;display&quot;</span> <span class="p">:</span> <span class="s2">&quot;Web Server&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>



<a name="168218491"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168218491" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168218491">(Jun 15 2019 at 18:36)</a>:</h4>
<p>a22611cd-0cb4-4cba-a7a4-23052e2909af is the internal identifier for this system</p>



<a name="168218494"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168218494" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168218494">(Jun 15 2019 at 18:36)</a>:</h4>
<p>logout:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;resourceType&quot;</span> <span class="p">:</span> <span class="s2">&quot;AuditEvent&quot;</span><span class="p">,</span>
  <span class="nt">&quot;text&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;status&quot;</span> <span class="p">:</span> <span class="s2">&quot;generated&quot;</span><span class="p">,</span>
    <span class="nt">&quot;div&quot;</span> <span class="p">:</span> <span class="s2">&quot;snip!&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://nema.org/dicom/dcid&quot;</span><span class="p">,</span>
    <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;110114&quot;</span><span class="p">,</span>
    <span class="nt">&quot;display&quot;</span> <span class="p">:</span> <span class="s2">&quot;User Authentication&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;subtype&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://nema.org/dicom/dcid&quot;</span><span class="p">,</span>
      <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;110123&quot;</span><span class="p">,</span>
      <span class="nt">&quot;display&quot;</span> <span class="p">:</span> <span class="s2">&quot;Logout&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;action&quot;</span> <span class="p">:</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span>
  <span class="nt">&quot;recorded&quot;</span> <span class="p">:</span> <span class="s2">&quot;2019-06-15T18:33:20.333Z&quot;</span><span class="p">,</span>
  <span class="nt">&quot;outcome&quot;</span> <span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;agent&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;who&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;identifier&quot;</span> <span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span><span class="p">,</span>
          <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;141&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&quot;altId&quot;</span> <span class="p">:</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;g (unknown)&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;network&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;2&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;source&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;site&quot;</span> <span class="p">:</span> <span class="s2">&quot;Health Intersections&quot;</span><span class="p">,</span>
    <span class="nt">&quot;observer&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;identifier&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;urn:ietf:rfc:3986&quot;</span><span class="p">,</span>
        <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;urn:uuid:a22611cd-0cb4-4cba-a7a4-23052e2909af&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;system&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/security-source-type&quot;</span><span class="p">,</span>
        <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
        <span class="nt">&quot;display&quot;</span> <span class="p">:</span> <span class="s2">&quot;Web Server&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>



<a name="168305968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168305968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168305968">(Jun 17 2019 at 12:37)</a>:</h4>
<p>Those are just the login and out events. Not really the OAuth events.  In using the lifecycle diagram from <span class="user-mention" data-user-id="191315">@Josh Mandel</span> presentations I was expecting some audit events at each point: 1. Register of an ID, 2. Launch + Discovery, 3. Authorize grant_type, 4. Query, and 5 Refresh.<br>
The logging of various CRUDE are done, but not specific enough to how the same auditEvent holds references to the token. Should be variations of these CRUDE that show a SMART token use? Seems it should be minimally the opaque token, leaving the details to the ( 3 ) Authorize grant_type auditEvent...</p>



<a name="168306047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168306047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168306047">(Jun 17 2019 at 12:38)</a>:</h4>
<p><a href="https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g5b4e43b18c_0_97" target="_blank" title="https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g5b4e43b18c_0_97">https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g5b4e43b18c_0_97</a></p>



<a name="168306526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168306526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168306526">(Jun 17 2019 at 12:44)</a>:</h4>
<p>In IHE we define the AuditEvent for various events... then in the IUA profile (The IHE profile of OAuth) we express how the presence of an IUA  token used to authorize ANY transaction or activity will augment that (ANY) transaction AuditEvent by adding an AuditEvent.agent. Thus the AuditEvent recorded for activity XYZ is the combination of the auditEvent pattern from activity XYZ + an AuditEvent.agent that expresses the security token used. This way activity XYZ (e.g. the CRUDE AuditEvent patterms given in FHIR) don't mention security, as security layer just augments the AuditEvent. This enables many security layer posibilities with consistency of AuditEvent for activity XYZ.</p>



<a name="168309367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168309367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168309367">(Jun 17 2019 at 13:18)</a>:</h4>
<p>We record only login in our system. We generate a session ID (GUID) that links the login event to the corresponding following CRUD events. It goes in a custom extension in AuditEvent</p>



<a name="168312509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168312509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168312509">(Jun 17 2019 at 13:58)</a>:</h4>
<p>why do you think you need a custom extension? What is the definition so that we can consider it a core or core-extension?</p>



<a name="168331126"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Audit/near/168331126" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Audit.html#168331126">(Jun 17 2019 at 17:43)</a>:</h4>
<p>I think it would be good to have a session id in AuditEvent. I don't audit the selection of scopes, and should. In fact, I should only log the login once the scopes are selected because it's not functional till then</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
