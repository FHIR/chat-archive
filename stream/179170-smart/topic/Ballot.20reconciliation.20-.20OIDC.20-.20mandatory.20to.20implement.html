---
layout: page
title: "FHIR Chat  · Ballot reconciliation - OIDC - mandatory to implement · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html">Ballot reconciliation - OIDC - mandatory to implement</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154005913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154005913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154005913">(Oct 04 2018 at 17:33)</a>:</h4>
<p>Per, <a href="http://build.fhir.org/ig/HL7/smart-app-launch/scopes-and-launch-context/index.html#scopes-for-requesting-identity-data" target="_blank" title="http://build.fhir.org/ig/HL7/smart-app-launch/scopes-and-launch-context/index.html#scopes-for-requesting-identity-data">Scopes for requesting Identity data</a> -&gt; <a href="https://openid.net/specs/openid-connect-core-1_0.html#ServerMTI" target="_blank" title="https://openid.net/specs/openid-connect-core-1_0.html#ServerMTI">OIDC 15.1</a>:</p>
<blockquote>
<p>OPs MUST support the prompt parameter, as defined in Section 3.1.2, including the specified user interface behaviors such as none and login.</p>
</blockquote>



<a name="154005914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154005914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154005914">(Oct 04 2018 at 17:33)</a>:</h4>
<p>Further, per <a href="https://openid.net/specs/openid-connect-core-1_0.html#AuthorizationEndpoint" target="_blank" title="https://openid.net/specs/openid-connect-core-1_0.html#AuthorizationEndpoint">OIDC 3.1.2.1</a> :</p>
<blockquote>
<p>prompt<br>
OPTIONAL. Space delimited, case sensitive list of ASCII string values that specifies whether the Authorization Server prompts the End-User for reauthentication and consent. The defined values are:<br>
none<br>
The Authorization Server MUST NOT display any authentication or consent user interface pages. An error is returned if an End-User is not already authenticated or the Client does not have pre-configured consent for the requested Claims or does not fulfill other conditions for processing the request. The error code will typically be login_required, interaction_required, or another code defined in Section 3.1.2.6. This can be used as a method to check for existing authentication and/or consent.<br>
login<br>
The Authorization Server SHOULD prompt the End-User for reauthentication. If it cannot reauthenticate the End-User, it MUST return an error, typically login_required.<br>
consent<br>
The Authorization Server SHOULD prompt the End-User for consent before returning information to the Client. If it cannot obtain consent, it MUST return an error, typically consent_required.<br>
select_account<br>
The Authorization Server SHOULD prompt the End-User to select a user account. This enables an End-User who has multiple accounts at the Authorization Server to select amongst the multiple accounts that they might have current sessions for. If it cannot obtain an account selection choice made by the End-User, it MUST return an error, typically account_selection_required.</p>
</blockquote>



<a name="154005915"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154005915" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154005915">(Oct 04 2018 at 17:34)</a>:</h4>
<p>Enabling advanced features such as prompt and display in order to claim the SMART <code>sso-openid-connect</code> capability feels like a large jump from what's actually implemented and tested at connectathons.</p>



<a name="154006178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154006178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154006178">(Oct 05 2018 at 03:40)</a>:</h4>
<p>I want to add that I would love to see more widespread support for the <code>prompt</code> parameter: it helps avoid weird saved-state situations logging in to different resource servers that use the same auth server. But I will defer to you EHR folks on whether it makes sense to make it mandatory or not.</p>



<a name="154006348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154006348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154006348">(Oct 05 2018 at 15:16)</a>:</h4>
<p>For the group here <span class="user-mention" data-user-id="191339">@Pascal Pfiffner</span> can you describe a bit more: what weird behavior do you see, and how does <code>prompt</code> help?</p>



<a name="154006913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154006913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154006913">(Oct 09 2018 at 00:22)</a>:</h4>
<p>Imagine you want to login to portal A and then login to portal B in order to receive access tokens to download your data. If these portals share the authorization server you may be logged in with portal A credentials when bringing up the login screen for portal B. You may see the username/password fields telling you that you have been logged out, which is confusing. You may also not even see the username/password fields but proceed to a nonfunctional "Authorize" page (because the user doesn't exist for portal B). To get out of this state you need to manually sign out and then sign back in with your portal B credentials. This process usually loses OAuth2 context so after entering portal B credentials it's unlikely that the redirect is being called correctly or you end up in the portal, rather than the "Authorize" screen. <code>prompt=login</code> can remediate these cases by always forcing a fresh login.</p>



<a name="154006914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154006914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154006914">(Oct 09 2018 at 00:22)</a>:</h4>
<p>-/-</p>



<a name="154006925"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154006925" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154006925">(Oct 09 2018 at 01:27)</a>:</h4>
<p>why is the client asking for that?</p>



<a name="154006926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154006926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154006926">(Oct 09 2018 at 01:50)</a>:</h4>
<p>Yeah, this feel like a broken authz service out of the gate.</p>



<a name="154007064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Ballot%20reconciliation%20-%20OIDC%20-%20mandatory%20to%20implement/near/154007064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Ballot.20reconciliation.20-.20OIDC.20-.20mandatory.20to.20implement.html#154007064">(Oct 09 2018 at 17:15)</a>:</h4>
<p>This may be a client that aggregates data from several portals, so you would login to portalA, the token would be used to grab your data, then you would login to portalB and so on. If it's the same authz service then I can see how it would keep a session as to not have the user log in again. I'm not sure the authz service could necessarily know that the already logged-in user doesn't exist for portalB, though I would presume it could (and therefore would prompt to login).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
