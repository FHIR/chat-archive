---
layout: page
title: "FHIR Chat  · Token Validity · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html">Token Validity</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="208950927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/208950927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aju Jacob <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#208950927">(Sep 03 2020 at 11:11)</a>:</h4>
<p>In the context of the 2021 CMS Patient Access rule, is there a requirement around how long the payer-issued token should be valid (refresh token)?</p>



<a name="208959020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/208959020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#208959020">(Sep 03 2020 at 12:31)</a>:</h4>
<p>I don't think there is a requirement from CMS. ONC rule has three months. Current CMS BlueButton refresh tokens never expire - so I'd say either never expire or long (&gt;= 3 months). We are doing 1 year</p>



<a name="208963482"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/208963482" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#208963482">(Sep 03 2020 at 13:08)</a>:</h4>
<p>And to be clear for the ONC rule: while individual refresh tokens need to last at least three months, the time resets when the refresh tokens are exercised so that an app can maintain persistent access until the user decides to stop this.</p>



<a name="208969503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/208969503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aju Jacob <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#208969503">(Sep 03 2020 at 13:50)</a>:</h4>
<p>This is good information. Thanks <span class="user-mention" data-user-id="191912">@Michele Mottini</span> and <span class="user-mention" data-user-id="191315">@Josh Mandel</span>!</p>



<a name="209565575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209565575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209565575">(Sep 09 2020 at 20:35)</a>:</h4>
<blockquote>
<p>the time resets when the refresh tokens are exercised</p>
</blockquote>
<p>Josh, Guys -- I was trying to re-validate this recently. Could you point to language in the rule that explicitly says this? </p>
<p>The <a href="https://www.federalregister.gov/d/2020-07419/p-3465">actual regulation text</a> doesn't actually say this.</p>



<a name="209566348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209566348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209566348">(Sep 09 2020 at 20:42)</a>:</h4>
<p>Let's see... It's subtle, so thanks for bringing this up:-)</p>
<p>As background, the clearest articulation is in commentary provided in the <a href="https://www.federalregister.gov/documents/2019/03/04/2019-02224/21st-century-cures-act-interoperability-information-blocking-and-the-onc-health-it-certification">proposed rule</a>:</p>
<blockquote>
<p>For example, if an application were issued a refresh token that was good for three months upon its first-ever connection and then subsequently connected to the FHIR server one month later, the FHIR server would need to enable that connection to occur without re-authentication and re-authorization, and it would need to issue a new refresh token for a new three-month period from that access date.</p>
</blockquote>
<p>Now in the final rule, the <a href="https://www.federalregister.gov/documents/2020/05/01/2020-07419/21st-century-cures-act-interoperability-information-blocking-and-the-onc-health-it-certification#p-3465">key language is here</a>: for "Subsequent connections...", the client <strong>"must be issued a new refresh token valid for a new period of no less than three months."</strong></p>



<a name="209566498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209566498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209566498">(Sep 09 2020 at 20:44)</a>:</h4>
<p>The term "new period" here is what clues you in to the fact that access periods are chained together indefinitely.</p>



<a name="209568604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209568604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209568604">(Sep 09 2020 at 21:05)</a>:</h4>
<p>I'm trying to answer the question -- what are the choices that a patient should have for length of persistent access during authorization?</p>
<p>The rule imagines that apps will only get a new refresh token when the user uses their app, but there's no technical method to enforce this and obviously won't be the case in reality. Most apps will likely simply ensure that persistent access is maintained for as long as possible, regardless. </p>
<p>Without an additional authorization decision by the patient, I don't understand how this jives with the patient's ability to determine the length of time an app should be able to access their data (unless the only choice presented to the patient is [] forever).</p>



<a name="209568758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209568758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209568758">(Sep 09 2020 at 21:06)</a>:</h4>
<p>You can give the patient all kinds of choices; the ONC rule requires that patients <em>can</em> choose to enable persistent access.</p>



<a name="209568853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209568853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209568853">(Sep 09 2020 at 21:07)</a>:</h4>
<p>And honestly, explaining to a patient "this app will be able to access your data until you withdraw permissions" and then sending periodic reminders like "Hey, the following apps have access to your record" is probably more effective than trying to explain this stuff about "Well, it's at 3 months, unless the app chooses to extend it, in which case it's longer..."</p>



<a name="209570810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209570810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209570810">(Sep 09 2020 at 21:25)</a>:</h4>
<p>Josh, are you really saying the rule doesn't allow a patient to specify the total amount of time an app can access their data? (But instead, can only legally control the amount of time that an app has to renew it's access?!?)</p>



<a name="209570874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209570874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209570874">(Sep 09 2020 at 21:26)</a>:</h4>
<p>I'm not saying that at all!</p>



<a name="209570890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209570890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209570890">(Sep 09 2020 at 21:26)</a>:</h4>
<p>The rule requires that patients be <em>able</em> to grant persistent access.</p>



<a name="209570940"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209570940" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209570940">(Sep 09 2020 at 21:27)</a>:</h4>
<p>The rule is a floor, not a ceiling: certified EHR products can offer additional options / capabilities that allow users to apply additional restrictions (beyond SMART scopes, beyond basic time limits, etc).</p>



<a name="209570993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209570993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209570993">(Sep 09 2020 at 21:27)</a>:</h4>
<p>where persistent means forever, yes, agreed. Do you agree that other valid options, for example, presented to the patient could be : 1 year, 3 months, 2 weeks, today ... ?</p>



<a name="209570999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209570999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209570999">(Sep 09 2020 at 21:27)</a>:</h4>
<p>My recommendation would be to make it easy to approve long-term sharing, and keep users informed about their choices over time.</p>



<a name="209571081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571081">(Sep 09 2020 at 21:28)</a>:</h4>
<p>and that those options would control how long an app could access the data and not merely, the amount of time between refreshes?</p>



<a name="209571115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571115">(Sep 09 2020 at 21:28)</a>:</h4>
<p>for example, this is how Google keeps me informed about location sharing -- by default, I can share my location with you "until I revoke it," but then every so often they remind me that I'm sharing my location with you. So it's low friction, but not quite set and <em>forget</em>, because you don't accidentally forget.</p>



<a name="209571167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571167">(Sep 09 2020 at 21:29)</a>:</h4>
<p>"amount of time between refreshes" is a meaningless concept, from the consumer PoV. I wouldn't try to explain it.</p>



<a name="209571225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571225">(Sep 09 2020 at 21:29)</a>:</h4>
<p>and yet, length of refresh is the only clear-cut patient-controlled aspect described:</p>
<blockquote>
<p>Refresh tokens are an OAuth 2.0 concept, and are largely opaque to the end user. However, we clarify that patients are not prohibited from changing the length of refresh tokens to the degree this option is available to them. </p>
</blockquote>
<p><a href="https://www.federalregister.gov/d/2020-07419/p-1254">https://www.federalregister.gov/d/2020-07419/p-1254</a></p>



<a name="209571282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571282">(Sep 09 2020 at 21:30)</a>:</h4>
<p>Specifically: it doesn't impact a consumer's decision, because the details of refresh token usage are unknown/unknowable to consumers (these are technical decisions implemented by an app, out of a user's control).</p>



<a name="209571350"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571350" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571350">(Sep 09 2020 at 21:30)</a>:</h4>
<p>Why do you say "and yet"? The excerpt you shared is 100% consistent with our discussion here.</p>



<a name="209571620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571620">(Sep 09 2020 at 21:33)</a>:</h4>
<p>alright - I understand what you're saying, Josh. I wish the rule were a bit more clear or sophisticated about the refresh process, but I agree with your description of the intent -- patients must be able to enable persistent access and should be able to choose other lengths of time.</p>



<a name="209571819"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571819" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571819">(Sep 09 2020 at 21:35)</a>:</h4>
<p>I don't think the rule opines on the "patients should be able to choose other lengths of time" question. But certainly they <em>MAY</em>, in conformance language :-)</p>
<blockquote>
<p>patients are not prohibited</p>
</blockquote>



<a name="209571966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Token%20Validity/near/209571966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Token.20Validity.html#209571966">(Sep 09 2020 at 21:37)</a>:</h4>
<p><span aria-label="thank you" class="emoji emoji-1f64f" role="img" title="thank you">:thank_you:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
