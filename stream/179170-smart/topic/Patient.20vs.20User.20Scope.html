---
layout: page
title: "FHIR Chat  · Patient vs User Scope · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html">Patient vs User Scope</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="222890209"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222890209" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222890209">(Jan 15 2021 at 17:09)</a>:</h4>
<p>Could someone please explain what the difference between patient and user scope is for a standalone launch? I'm on the Carin BlueButton track where we use SMART for a patient to authenticate to their payer to obtain EOBs etc. Would the user and patient scopes be the same here? Is it suffice to just support one (ie <code>patient/*.read</code> and not <code>user/*.read</code>)</p>



<a name="222890712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222890712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222890712">(Jan 15 2021 at 17:12)</a>:</h4>
<p>As a sort of follow up - is the patient scope just resources in the patient compartment? So if we wanted every user to be able to read all Organizations would that need to be <code>user/Organization.read</code> or would <code>patient/Organization.read</code> be suffice</p>



<a name="222896497"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222896497" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222896497">(Jan 15 2021 at 17:50)</a>:</h4>
<ul>
<li>
<p><code>patient/</code> scopes are appropriate when your app needs to get access to a specific patient record (the user will select which patient as part of the approval process).</p>
</li>
<li>
<p><code>user/</code> scopes are appropriate when your app needs access to all the records the approving user is allowed to access</p>
</li>
</ul>



<a name="222896588"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222896588" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222896588">(Jan 15 2021 at 17:51)</a>:</h4>
<p>For patient access API requirements, often <code>patient/</code> scopes are good enough</p>



<a name="222896770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222896770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222896770">(Jan 15 2021 at 17:52)</a>:</h4>
<p>Scopes aren't strictly tied to the FHIR "CompartmentDefinition" because the compartment definition is quite rigid and authorization servers are free to define access and more flexible ways (e.g., including additional data that is linked to by resources in the patient compartment)</p>



<a name="222918687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222918687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222918687">(Jan 15 2021 at 20:13)</a>:</h4>
<p>Hi Josh, this was really helpful. One follow up - since its not required for servers to publish which scopes they support is it just expected the client will need to determine how to deal scope errors (i.e. if a client requests a scope and the auth server returns an error its up to the client to figure out how to deal with that). Is there any guidance for how a client could go about this (if the supported scopes aren't published)?</p>



<a name="222919319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222919319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222919319">(Jan 15 2021 at 20:18)</a>:</h4>
<p>We recommend that servers publish in the .well-known/smart-configuration doc; in the real world, servers should publish in their documentation, fo humans to read too. And ultimately, apps need to be robust to unsupported scopes (like, come back and try again).</p>



<a name="222919444"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222919444" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222919444">(Jan 15 2021 at 20:19)</a>:</h4>
<p>Gotcha. Is there a reason its not a required field?</p>



<a name="222919662"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222919662" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222919662">(Jan 15 2021 at 20:20)</a>:</h4>
<p>It can be hard for a server to express <em>all scopes</em> it can support, since they can grow combinatorially.</p>



<a name="222919729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222919729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222919729">(Jan 15 2021 at 20:21)</a>:</h4>
<p>But for your specific use case, actually you can just check whether <code>permission-patient</code> or <code>permission-user</code> are listed in <code>capabilities[]</code>.</p>



<a name="222919766"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222919766" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222919766">(Jan 15 2021 at 20:21)</a>:</h4>
<p>So that's actually a much better answer, in this specific case.</p>



<a name="222919823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222919823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222919823">(Jan 15 2021 at 20:22)</a>:</h4>
<p>Clear, unambiguous documentation, even ;-)</p>



<a name="222920276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222920276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222920276">(Jan 15 2021 at 20:25)</a>:</h4>
<p>Also keep in mind a server could support a scope but the user could remove it (or the server could deny it). I wouldn't just keep retrying :)</p>



<a name="222920999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222920999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222920999">(Jan 15 2021 at 20:30)</a>:</h4>
<p>You definitely don't want to auto-retry, or keep retrying repeatedly; but between authz responses and user input, there are cases where you'll want to re-try with different/down-selected scopes.</p>



<a name="222938156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222938156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222938156">(Jan 15 2021 at 23:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179170-smart/topic/Patient.20vs.20User.20Scope/near/222896497">said</a>:</p>
<blockquote>
<ul>
<li>
<p><code>patient/</code> scopes are appropriate when your app needs to get access to a specific patient record (the user will select which patient as part of the approval process).</p>
</li>
<li>
<p><code>user/</code> scopes are appropriate when your app needs access to all the records the approving user is allowed to access</p>
</li>
</ul>
</blockquote>
<p>Need one clarification here. Does it mean the access token issued with patient scope with a specific patient (during approval) cannot be used for any FHIR API of another patient?</p>



<a name="222942620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222942620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222942620">(Jan 15 2021 at 23:54)</a>:</h4>
<p>Correct</p>



<a name="222983125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/222983125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#222983125">(Jan 16 2021 at 14:10)</a>:</h4>
<p>Thank you for clarification here. Also, if the app only has patient/ scopes, then how does the auth server know what patients to be shown in the picker? Is it up to the EHR/patient portal to determine user permissions here and accordingly display the list of patients?</p>



<a name="223016204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/223016204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#223016204">(Jan 17 2021 at 00:56)</a>:</h4>
<p>Up to the EHR. Usually it has a list of patient each user can access - like their family members or the likes</p>



<a name="223017085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/223017085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#223017085">(Jan 17 2021 at 01:21)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191912">@Michele Mottini</span>  for clarifying.</p>



<a name="225168555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/225168555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#225168555">(Feb 04 2021 at 14:49)</a>:</h4>
<p>I'm getting a lot of questions about the patient scoping requirements- and making sure I'm following the right path.  Right now my understanding from all of this discussion is that if I request a patient/ scope, and the user picks a patient at consent time.  This token will be rejected by the resource server if an attempt is made to access a different patient than was selected.  The piece I'm struggling with is- in the implementations where the access_token is opaque- how does the resource server know which patient a given token is bound to (and all downstream refreshed tokens as well)?</p>



<a name="225173762"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/225173762" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#225173762">(Feb 04 2021 at 15:23)</a>:</h4>
<p>The access token is opaque for the client, but the server must know how to validate it and what does it grant</p>



<a name="225183858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/225183858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#225183858">(Feb 04 2021 at 16:25)</a>:</h4>
<p>Gotcha- thank you <span class="user-mention" data-user-id="191912">@Michele Mottini</span> , so for example in a case where the resource server and the authorization server are part of the same product suite- there must be some communication within the components so that if authz server mints opaque token "12345abcd" for patient 6789, the resource server portion of that can look up that fact somewhere while validating/introspecting (and if the requested patient is not 6789- reject). Additionally, any refreshed access tokens would also be bound to patient 6789 and that same communication/lookup will occur. Is that right?</p>



<a name="225184390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/225184390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#225184390">(Feb 04 2021 at 16:28)</a>:</h4>
<p>Yes</p>



<a name="225185246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/225185246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#225185246">(Feb 04 2021 at 16:33)</a>:</h4>
<p>Thank you! Much appreciated!</p>



<a name="225454367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/225454367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#225454367">(Feb 07 2021 at 09:27)</a>:</h4>
<p>Not sure of that should be a 401 reject, or a 404 not found. Security considerations I expect here might result in either of these?</p>



<a name="225461711"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Patient%20vs%20User%20Scope/near/225461711" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Patient.20vs.20User.20Scope.html#225461711">(Feb 07 2021 at 12:23)</a>:</h4>
<p>403 or maybe 404, not 401</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
