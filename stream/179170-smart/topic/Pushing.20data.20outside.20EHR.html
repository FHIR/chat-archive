---
layout: page
title: "FHIR Chat  · Pushing data outside EHR · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html">Pushing data outside EHR</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153914238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914238">(Oct 17 2017 at 02:12)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> got a question about pushing data out of an EHR</p>



<a name="153914239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914239">(Oct 17 2017 at 02:14)</a>:</h4>
<p>once an EHR has set up a smart on FHIR service, the easiest way to refer a patient to an external service, with data, is via a smart on FHIR app - it loads up, loads data from the EHR, asks any additional questions that are relevant, and then submits the data. There's all sorts of uses for that, and it's way cool that the recipient can write the smart up without really needing to work with the EHR provider to do the integration</p>



<a name="153914240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914240">(Oct 17 2017 at 02:15)</a>:</h4>
<p>but what about the following scenario:</p>
<ul>
<li>once a clinician has used the SMART on FHIR application once, then additional changes to the patient's problem list or medication list should be pushed to the external recipient</li>
</ul>



<a name="153914241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914241">(Oct 17 2017 at 02:15)</a>:</h4>
<p>(of course, this assumes that appropriate consent etc has been gathered. Let's assume that happens)</p>



<a name="153914242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914242">(Oct 17 2017 at 02:16)</a>:</h4>
<p>I can't imagine how the recipient could implement this in smart on fhir application.... they'd be stuck back waiting for custom back end integration from the source EHR... or have I missed something?</p>



<a name="153914265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914265">(Oct 17 2017 at 02:53)</a>:</h4>
<p>Definitely a key use case. If I replace the phrase "should be pushed to" with "should be made available to", then long-term access with refresh tokens can help with this scenario.</p>



<a name="153914271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914271">(Oct 17 2017 at 02:56)</a>:</h4>
<p>umm I don't understand that second bit. How does a long term access /  refresh tokens help?</p>



<a name="153914273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Teirney <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914273">(Oct 17 2017 at 02:57)</a>:</h4>
<p>Assuming that there's a way for that application to continuously run. Some SMART on FHIR applications will only live for as long as they are being driven by the web browser instance that they were launched into. If there is any server component to that web application there's no guarantee that it will have any network connection between them and the EHR. The browser effectively acts like a proxy between EHR and whatever other backend the SMART on FHIR application connects to.</p>



<a name="153914275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914275">(Oct 17 2017 at 02:58)</a>:</h4>
<p>I guess that's where I'm stuck - I can make a long term access token, but where does the app run?</p>



<a name="153914281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Teirney <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914281">(Oct 17 2017 at 03:03)</a>:</h4>
<p>We've run into that integration challenge with an application running on a desktop and integrating with an EHR application through FHIR APIs (outside of SMART on FHIR launch). We had feedback that the person using the EHR would like to verify any information that was sent out to our backend (also FHIR based) to ensure only appropriate information was being sent to the other system via that mechanism.</p>



<a name="153914282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Teirney <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914282">(Oct 17 2017 at 03:05)</a>:</h4>
<p>Are there other parts of the FHIR ecosystem where this challenge resides as well? E.g. CDA push of Patient Summary documents at the end of an encounter within an EHR was hoped to ensure that a bunch of downstream systems were at least updated with core summary information. Not sure where CDA on FHIR is at but is that hoped to cover off part of this?</p>



<a name="153914285"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914285" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914285">(Oct 17 2017 at 03:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191355">@Kevin Shekleton</span> <span class="user-mention" data-user-id="191368">@Brett Esler</span> do you guys have arrangement for long running apps?</p>



<a name="153914286"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914286" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914286">(Oct 17 2017 at 03:09)</a>:</h4>
<p>though really, there's a difference here - the UI app is authorised for a single patient. You don't want 1000s of long running apps, one for each patient. This breaks down to a second app using the bulk data interface, I think</p>



<a name="153914290"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914290" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914290">(Oct 17 2017 at 03:17)</a>:</h4>
<p>We don't have any apps used by a practitioner that want to run longer than the user's session. As I'm sure you're already aware, we have a patient facing app (Sync4Science) that is doing this.</p>



<a name="153914291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914291">(Oct 17 2017 at 03:18)</a>:</h4>
<p>If you have a long running app like you're describing, the FHIR access needs to be moved to the server rather than the browser</p>



<a name="153914292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914292">(Oct 17 2017 at 03:20)</a>:</h4>
<p>.... and you don't currently support that except through the patient facing app? And if I think this through you don't have any infrastructure to link a clinician action to a patient OAuth consent - that'd be 2 entirely separate actions</p>



<a name="153914297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914297">(Oct 17 2017 at 03:26)</a>:</h4>
<p>Right now, we just support the really long lived access tokens with patient facing apps (simply because we haven't run into provider facing apps that need this yet)</p>



<a name="153914298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914298">(Oct 17 2017 at 03:27)</a>:</h4>
<p>Can you clarify what you mean by "you don't have any infrastructure to link a clinician action to a patient OAuth consent - that'd be 2 entirely separate actions"?</p>



<a name="153914303"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914303" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914303">(Oct 17 2017 at 03:36)</a>:</h4>
<p>well, in an ideal world - from the patient's POV - the fact that they consented to the sharing, and did share.. they then start again from scratch with consent and sharing on the patient portal... patient matching... ah....</p>



<a name="153914389"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914389" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914389">(Oct 17 2017 at 10:27)</a>:</h4>
<p>just looking at yet another proposal. The most natural sequence would be:<br>
- clinician uses a smart app to register a patient with [some clinical repository]<br>
- the smart app knows the patient portal for the system it's running in, and authorizes the [clinical repository] to access data from the patient portal<br>
- the patient can revoke that later if they want</p>



<a name="153914390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914390">(Oct 17 2017 at 10:27)</a>:</h4>
<p>I think we haven't actually nailed that workflow down, <span class="user-mention" data-user-id="191315">@Josh Mandel</span></p>



<a name="153914392"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914392" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914392">(Oct 17 2017 at 10:28)</a>:</h4>
<p>and also, there's a cds-hook that can prompt the clinician to talk to the user about registering an eligible patient</p>



<a name="153914398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914398">(Oct 17 2017 at 10:33)</a>:</h4>
<p>(that bit is already all hooked up)</p>



<a name="153914421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914421">(Oct 17 2017 at 13:43)</a>:</h4>
<p>We usually think about which user (or organization) is allowing access. In our current SMART approach, the answer is: someone who has access and is able to share. That is typically a provider working at an organization, or a patient -- what you're describing seems to be a hybrid <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, where a provider and <em>then also</em> a patient would need to allow access? Can you explain why this model looks important? If either party alone has the right to share, why require both together to enable the connection?</p>



<a name="153914422"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914422" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914422">(Oct 17 2017 at 13:47)</a>:</h4>
<p>Well, its more about workflow - the clinician makes the referral, but then data keeps flowing; the patient has control. Better to hand over seamlessly than to make the patient also make the connection again.</p>



<a name="153914423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914423">(Oct 17 2017 at 13:51)</a>:</h4>
<p>So this is supported. The way you'd accomplish it would be with two SMART app launches: one from the EHR, which a clinician approves; and the other a Standalone launch which the patient approves. How these two launches are tied together is not something the platform tries to solve. But for example the external registry could send an email to the patient to kick off the process continuation. Or the initiating provider could print out a sheet of paper with instructions on how to continue sign up. Or the clinician could give the patient a tablet for in-office use. Or any other method you could dream up.</p>



<a name="153914534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914534">(Oct 17 2017 at 22:34)</a>:</h4>
<p>I will think about this some more but I feel as though there's something missing from SMART here - and it's come up for me in a different context</p>



<a name="153914535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914535">(Oct 17 2017 at 22:34)</a>:</h4>
<p>I think that a smart app should be able to ask the authorization server to clone it's session, so that it can generate a new session that has different (derived) properties.</p>



<a name="153914536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914536">(Oct 17 2017 at 22:36)</a>:</h4>
<p>one use where I think this is very pertinent is with cds-hooks, where an application probably doesn't want the cds-hooks server to have all the same rights to access the patient record that it does. In fact, it very likely wants to retain the write level privileges for itself. But as things stand, there's no arrangement for it to get an access token that has different (less) privileges than it has.</p>



<a name="153914537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914537">(Oct 17 2017 at 22:36)</a>:</h4>
<p>and then this is another case - generate a long lasting session that has different (less) rights than the initial session</p>



<a name="153914538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914538">(Oct 17 2017 at 22:38)</a>:</h4>
<p>a related question that came up for me while thinking about this: the smart app launch spec is not specific about that you can use an authorization token only once...</p>



<a name="153914539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914539">(Oct 17 2017 at 22:38)</a>:</h4>
<p>is that meant to be the case? it's the case in my implementation...</p>



<a name="153914703"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914703" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914703">(Oct 18 2017 at 17:27)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> what do you mean that you can only use the authorization token once? That would lie in the purview of the OAuth spec - which says you can use the token until it expires</p>



<a name="153914709"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914709" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914709">(Oct 18 2017 at 17:31)</a>:</h4>
<p>EG: <a href="https://tools.ietf.org/html/rfc6749#section-1.4" target="_blank" title="https://tools.ietf.org/html/rfc6749#section-1.4">https://tools.ietf.org/html/rfc6749#section-1.4</a> and <a href="https://tools.ietf.org/html/rfc6750" target="_blank" title="https://tools.ietf.org/html/rfc6750">https://tools.ietf.org/html/rfc6750</a> (since we use Bearer tokens in SMART)</p>



<a name="153914710"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914710" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914710">(Oct 18 2017 at 17:32)</a>:</h4>
<p>expires or becomes otherwise invalid :) but usually that invalid (in my experience) is based on security features that would disable tokens that were compromised</p>



<a name="153914713"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914713" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914713">(Oct 18 2017 at 17:32)</a>:</h4>
<p>Something neither SMART nor the OAuth 2 Framework want to describe in detail - how that is controled is usually left up to the implementer. The spec allows you to communicate the expiry (if it applies) and errors if the token becomes otherwise invalid</p>



<a name="153914719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914719">(Oct 18 2017 at 17:35)</a>:</h4>
<p>As to the long running session having less permissions than the initial: Yeah, that's not specifically required by SMART nor OAuth (and I'm not sure if we want it to be), but the authorization server can choose to remove scopes when the token is refreshed, or the app can request fewer scopes when they get a new token.</p>



<a name="153914720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914720">(Oct 18 2017 at 17:36)</a>:</h4>
<p>In the S4S case: the app requests the scopes it needs for the long running session. We use those requested scopes to tell the patient what the app will use. S4S could request fewer scopes later, but we already told the patient they have access to more</p>



<a name="153914721"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914721" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914721">(Oct 18 2017 at 17:37)</a>:</h4>
<p>If S4S tried to ask for more, our server wouldn't let it, since the patient didn't authorize that (S4S would need to kick off a new authorization request somehow)</p>



<a name="153914772"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914772" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914772">(Oct 18 2017 at 21:28)</a>:</h4>
<p>Grahame's question of long-running apps and notification of updates actually looks like an issue <span class="user-mention" data-user-id="191864">@Isaac Vetter</span> should be considering with his Context Synchronization PSS (not yet approved).</p>



<a name="153914791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914791">(Oct 19 2017 at 02:23)</a>:</h4>
<blockquote>
<p>once a clinician has used the SMART on FHIR application once, then additional changes to the patient's problem list or medication list should be pushed to the external recipient</p>
</blockquote>
<p>In my opinion, S4S's model of periodically polling the FHIR server is technically (and understandably) flawed because it simply made use of the RESTful APIs that were being implemented. I believe strongly that periodic polling for event-based data is almost never the elegant design. </p>
<p>Rather, the technically correct approach for both S4S, and (I think), the scenario that you're describing, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> , is for the clinician-launched SMART app to both get a refresh_token and to create a Subscription.</p>



<a name="153914792"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914792" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914792">(Oct 19 2017 at 02:24)</a>:</h4>
<blockquote>
<p>I think that a smart app should be able to ask the authorization server to clone it's session, so that it can generate a new session that has different (derived) properties.</p>
</blockquote>
<p>This sounds awfully complicated. I'll reiterate <span class="user-mention" data-user-id="191315">@Josh Mandel</span> 's point that:</p>
<blockquote>
<p>The way you'd accomplish it would be with two SMART app launches: one from the EHR, which a clinician approves; and the other … which the patient approves … for example the external registry could send an email to the patient … or the initiating provider could print out a sheet of paper … or the clinician could give the patient a tablet for in-office use </p>
</blockquote>
<p>or the provider sends the patient a message from their EHR with a link to the app or the app can be launched from the patient's portal or …</p>



<a name="153914793"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914793" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914793">(Oct 19 2017 at 02:25)</a>:</h4>
<p>Overall -- </p>
<ul>
<li>Subscriptions is a great way to push updates. RESTful queries aren't.</li>
<li>We already do have a great model for either a clinician or a patient authorizing long-running data access to an app. It's refresh tokens via the SMART launch spec.</li>
<li>In-browser apps aren't good at long-running access -- this isn't a problem that should be solved by the authorization server. It's a simple matter of the app adding minimal, persistent app storage.</li>
</ul>



<a name="153914796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914796">(Oct 19 2017 at 02:30)</a>:</h4>
<p><span class="user-mention" data-user-id="191356">@Jenni Syed</span> I mean to refer to 'authorization code' - can you use that more than once. Sorry for that mistake</p>



<a name="153914797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914797">(Oct 19 2017 at 02:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191864">@Isaac Vetter</span>  I think I'd prefer a subscription, but what's the timeline for supporting that? But I think you overlooked an important part of my question - how can an EHR client that is itself an OAuth client invoke a cds-hook and provide it with some access to a server, but not all the access the client itself has? at present, we have no infrastructure for this, and I think this is a big security flaw in cds-hooks as it is</p>



<a name="153914798"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914798" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914798">(Oct 19 2017 at 02:33)</a>:</h4>
<p>nor do I think that the problem of long running apps can be solved by adding minimal, persistent storage. that might be useful, but where does this stuff <em>happen</em>?</p>



<a name="153914800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914800">(Oct 19 2017 at 02:33)</a>:</h4>
<p>as for subscriptions.. fine. I like that model... but what's a working model for long term subscriptions from a smart app that's not shot full of security holes or demands for heaps of admnistration?</p>



<a name="153914801"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914801" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914801">(Oct 19 2017 at 02:34)</a>:</h4>
<p>I think the S4S model is not terribly efficient, but administation is certainly simple</p>



<a name="153914802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914802">(Oct 19 2017 at 02:37)</a>:</h4>
<p>Grahame, yes, you're definitely right that I'm overlooking the complexity of your scenario and don't know your timelines. Subscriptions is how we should solve this general problem eventually. </p>
<blockquote>
<p>what's a working model for long term subscriptions from a smart app that's not shot full of security holes or demands for heaps of administration?</p>
</blockquote>
<p>I think that a working model could be that the FHIR server only accepts a new Subscription with an end datetime equal to or less than the expiration date of the app's token. The app would need to refresh or reauthorize to maintain it's subscription past that time.</p>



<a name="153914805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venkateswara R Davuluri <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914805">(Oct 19 2017 at 02:41)</a>:</h4>
<p>Not try to change the topic. But I have a question. How complex is to implement Subscriptions in an iOS or web client ? GraphQL vs RESTful vs Subsciptions, which one is better ?</p>



<a name="153914806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914806">(Oct 19 2017 at 02:46)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="192083">@Venkateswara R Davuluri</span>, there's a couple different "channel" methods defined in the <a href="https://www.hl7.org/fhir/subscription.html" target="_blank" title="https://www.hl7.org/fhir/subscription.html">spec</a>, which I think would influence what platform would be better.</p>
<p>I think that FHIR Subscriptions and REST/GraphQL have different use-cases and naturally complement one another.  Subscriptions is FHIR's pub/sub model.</p>



<a name="153914853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venkateswara R Davuluri <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914853">(Oct 19 2017 at 14:18)</a>:</h4>
<p>Dear <span class="user-mention" data-user-id="191864">@Isaac Vetter</span> Thank you for response. We are presently working on REST for an iOS application. we tried to use SubScriptions - but constant chaning client IP and How to handle the events in Server side are two limitation, I noticed.  Thank you.</p>



<a name="153914858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914858">(Oct 19 2017 at 14:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> you may be interested in <a href="https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-09" target="_blank" title="https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-09">https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-09</a> which is an effort at:</p>
<blockquote>
<p>defining how to request and obtain security tokens from OAuth 2.0 authorization servers, including security tokens employing impersonation and delegation.</p>
</blockquote>



<a name="153914859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914859">(Oct 19 2017 at 14:48)</a>:</h4>
<p>It's an interesting area, to be sure.</p>



<a name="153914860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153914860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153914860">(Oct 19 2017 at 14:49)</a>:</h4>
<p>When it comes to authorization codes: we don't technically require servers to treat these as one-time-use codes, but it is important for servers to prevent inappropriate replay. Our S4S test suite checks to make sure codes don't work more than once, and I think this the right approach. We could definitely add this as guidance.</p>



<a name="153915231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153915231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153915231">(Oct 22 2017 at 19:50)</a>:</h4>
<p>yes, that rfc is definitely interesting</p>



<a name="153915583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Pushing%20data%20outside%20EHR/near/153915583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Pushing.20data.20outside.20EHR.html#153915583">(Oct 24 2017 at 04:17)</a>:</h4>
<p>and yes, we should document that authorization codes are one use only.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
