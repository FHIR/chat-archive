---
layout: page
title: "FHIR Chat  · Should iat be required? · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html">Should iat be required?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="276245172"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276245172" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Zadok <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276245172">(Mar 22 2022 at 19:51)</a>:</h4>
<p>Hi All,</p>
<p>According to <a href="http://www.hl7.org/fhir/smart-app-launch/client-confidential-asymmetric.html#request">http://www.hl7.org/fhir/smart-app-launch/client-confidential-asymmetric.html#request</a> <code>exp</code> must be no more than five minutes in the future. We'd like to verify this when consuming jwts, but given the possibility of clock-skew this isn't really possible.  If <code>iat</code> is supplied we can easily compare those two claims to ensure the jwt conforms to the rule. </p>
<p>Does anyone else perform this, or a similar, check server-side? How does everyone feel about requiring <code>iat</code>?</p>



<a name="276247661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276247661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276247661">(Mar 22 2022 at 20:10)</a>:</h4>
<p>The expectation is that clocks should accurate within a tolerance that is significantly better than 5 minutes. EHRs implementing this specification are already required by other ONC certification criteria to support NTP client functionality to keep times accurate; is this not the case in your deployment environment?</p>



<a name="276247919"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276247919" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276247919">(Mar 22 2022 at 20:12)</a>:</h4>
<p>Looking at IAT, you would not necessarily be able to tell whether the requirements on expiration time were met. IAT only gives you an indication of what time the <em>client thought</em> it was when the client generated the token. You still need to assess whether the expiration time is valid with respect to your own server's understanding of the current time</p>



<a name="276248297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276248297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Zadok <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276248297">(Mar 22 2022 at 20:15)</a>:</h4>
<p>While we might be able to safely rely on the time on our server, <code>exp</code> is going to have the same "issue" of being what the <em>client thinks</em> five minutes in the future is, <code>exp-iat</code> can be used to confirm a valid five minute window was used when the token was generated, then we can just use <code>exp</code> to determine the token is still valid based solely on server time.</p>



<a name="276249680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276249680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276249680">(Mar 22 2022 at 20:27)</a>:</h4>
<p>Currently the only imperative on the server is to ensure that the expiration time on the token received is no more than 5 minutes beyond the time at which the server processes the token. The insurance time does not come into it. So knowing a client has started issuance time would not help you to meet this requirement.</p>
<p>(To be clear, I think there could be other reasons to look for issuance times, but they are beyond the current specification.)</p>



<a name="276251407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276251407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Zadok <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276251407">(Mar 22 2022 at 20:43)</a>:</h4>
<p>Could we require <code>iat</code> even if the specs don't say we have to?</p>



<a name="276253783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276253783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276253783">(Mar 22 2022 at 21:02)</a>:</h4>
<p>You as a server implementing support for the specification? No: because if you add additional requirements like this and impose them on clients, that means the clients will not be able to interoperably connect to your server without special effort. Assuming you're implementing this specification in the context of an EHR certification requirement, that is.</p>



<a name="276253910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Should%20iat%20be%20required%3F/near/276253910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Zadok <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Should.20iat.20be.20required.3F.html#276253910">(Mar 22 2022 at 21:03)</a>:</h4>
<p>Thank you</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
