---
layout: page
title: "FHIR Chat  · SMARTv2 Epic Endpoint · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html">SMARTv2 Epic Endpoint</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="222780749"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222780749" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222780749">(Jan 14 2021 at 20:40)</a>:</h4>
<p>When I authorize my client requesting <code>patient/Observation.rs</code>, I get:</p>
<div class="codehilite"><pre><span></span><code>  &quot;scope&quot;: &quot;Epic.Security.OAuth2.Introspect patient/Observation.c?category=vital-signs patient/Patient.r fhirUser openid&quot;,
</code></pre></div>

<p>... which has some surprising things:</p>
<ol>
<li>I didn't ask for "create" permissions, but I got them</li>
<li>I asked for "search" permissions, but I didn't get them</li>
<li>Even though I don't have "search" permissions, I can still successfully search for vital signs</li>
</ol>
<p>I think (1) and (2) are because Epic's server only looks at scopes the client is <em>registered for</em> rather than what is <em>requested</em>. (3) is more mysterious.</p>



<a name="222780967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222780967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222780967">(Jan 14 2021 at 20:42)</a>:</h4>
<p>When I try to call <code>https://connectathon.epic.com/Interconnect-Fhir-OAuth/oauth2/introspect</code> I get "Service is disabled or unsupported by security policy" -- I'm guessing this is related to <a href="https://docs.google.com/document/d/1bTJBmqYwePzjoYwvLq08puODUaHcuV1I9cScoGo2DF8/edit">this note</a></p>
<blockquote>
<p>We require Bearer token auth for the token introspection on this server.</p>
</blockquote>
<p>Does this mean I'm supposed to put the same token in a header and in the body before I can this call?</p>



<a name="222781000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222781000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222781000">(Jan 14 2021 at 20:42)</a>:</h4>
<p>(This feels like jumping through a hoop without clear benefit -- but I think I get it because in general the client calling the introspection endpoint may not be the client to whom the access token is issued, and you are managing authorization for that endpoint distinctly.)</p>



<a name="222782360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222782360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Fisher <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222782360">(Jan 14 2021 at 20:53)</a>:</h4>
<p>Yeah - it is actually configurable by each Epic site how they want to handle authentication for each service/endpoint. We have it set up to require Bearer auth in this environment for the reasons you guessed I believe.</p>



<a name="222782745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222782745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Fisher <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222782745">(Jan 14 2021 at 20:56)</a>:</h4>
<p>You're correct that the scopes returned are those that are statically registered, though now (as you may have seen) patients can choose which ones they want to allow the app to access. </p>
<p>That said, you should be getting create, search and read permissions for Observations?category=vital-signs for that app (or none of them if the patient doesn't want you to access vital-signs). </p>
<p>I'll take a look at what's going on there. We retooled how we inform the app of their scopes as part of the "patient selectable scopes" project and you're testing against dev that is not 100% through the dev+testing process so there could still be some quirks.</p>



<a name="222782796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222782796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222782796">(Jan 14 2021 at 20:56)</a>:</h4>
<p>Thanks for this info, and for looking into it</p>



<a name="222867140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222867140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Carlson <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222867140">(Jan 15 2021 at 14:53)</a>:</h4>
<p>The test patient portal login here seems to be broken, I'm getting a <code>You have reached the maximum failed login attempts</code> error. Can you reset the account <span class="user-mention" data-user-id="279701">@Jake Fisher</span> ?</p>



<a name="222878798"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222878798" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> adam strickland <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222878798">(Jan 15 2021 at 16:02)</a>:</h4>
<p><span class="user-mention" data-user-id="308473">@Keith Carlson</span> what happens if you try clearing cookies? I can look into it more need be, but if it's failed logins that might be a quick fix</p>



<a name="222879180"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222879180" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Fisher <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222879180">(Jan 15 2021 at 16:04)</a>:</h4>
<p><span class="user-mention" data-user-id="308473">@Keith Carlson</span> The account needed to be reset. It works again now.</p>



<a name="222915125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222915125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Carlson <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222915125">(Jan 15 2021 at 19:50)</a>:</h4>
<p>Does this server support PKCE with a patient facing app? It is currently not working for me</p>



<a name="222918404"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222918404" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222918404">(Jan 15 2021 at 20:11)</a>:</h4>
<p>(deleted)</p>



<a name="222918557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222918557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222918557">(Jan 15 2021 at 20:12)</a>:</h4>
<p>My bad; I think I used the wrong client ID; deleted my comment above :)</p>



<a name="222918656"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/222918656" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Fisher <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#222918656">(Jan 15 2021 at 20:13)</a>:</h4>
<p><span class="user-mention" data-user-id="308473">@Keith Carlson</span>  - yes it works for me: <br>
<a href="/user_uploads/10155/D7RHsBrDMBoudaKtpXFqSJCn/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/D7RHsBrDMBoudaKtpXFqSJCn/image.png" title="image.png"><img src="/user_uploads/10155/D7RHsBrDMBoudaKtpXFqSJCn/image.png"></a></div>



<a name="247202417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/247202417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gowtham <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#247202417">(Jul 26 2021 at 13:32)</a>:</h4>
<p>Hi ,<br>
Iam want to access <a href="http://patient.read">patient.read</a> api in fhir<br>
using Access token Iam going to access only <a href="http://patient.search">patient.search</a> .I not able to access <a href="http://patient.read">patient.read</a> and other API<br>
please help me, In the body field will we set scope for what are all api Iam going to access<br>
if yes please say the format for scope for accessing <a href="http://patient.read">patient.read</a> and <a href="http://observation.read">observation.read</a> Api</p>
<p>David Pyke: This channel is for social discussions. Technical discussions should be in #implementers</p>



<a name="247209737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/247209737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#247209737">(Jul 26 2021 at 14:29)</a>:</h4>
<p>What sort of error are you getting?</p>



<a name="247231099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMARTv2%20Epic%20Endpoint/near/247231099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMARTv2.20Epic.20Endpoint.html#247231099">(Jul 26 2021 at 17:03)</a>:</h4>
<p>What is your client ID? Do you have both <a href="http://patient.read">patient.read</a> and <a href="http://patient.search">patient.search</a> APIs registered for your  client?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
