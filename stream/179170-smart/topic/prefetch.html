---
layout: page
title: "FHIR Chat  · prefetch · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html">prefetch</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="209545262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209545262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209545262">(Sep 09 2020 at 17:50)</a>:</h4>
<p>So, I'm a big fan of the pre-fetch capability in the CDS-hooks spec.  Does anyone know if a pre-fetch has been considered for the SMART launch protocol?  we have an app that would really benefit from being able to launch with the data it needs already available.  In our case, it wouldn't need to reach back to the SMART server at all, which would provide a simplified launch method for host systems that may not actually have a FHIR server</p>



<a name="209545879"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209545879" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209545879">(Sep 09 2020 at 17:55)</a>:</h4>
<p>This is an interesting suggestion and I don't think it has come up before. One of the challenges with prefetch in CDS hooks has been server support -- we have seen pretty limited support for client prefetch which means that clients sometimes get what they want and sometimes don't.</p>



<a name="209545977"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209545977" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209545977">(Sep 09 2020 at 17:56)</a>:</h4>
<p>when you think about adding prefetch to smart, are you thinking that you would get the prefetch responses back as part of the access token response? It's a neat idea.</p>



<a name="209546026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546026">(Sep 09 2020 at 17:56)</a>:</h4>
<p>Yup, that's fair.  Similar to the lack of support for write back, it's a bit disappointing.  </p>
<p>.</p>



<a name="209546162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546162">(Sep 09 2020 at 17:57)</a>:</h4>
<p>To be honest, I'm not as familiar with the SMART protocol as I'd like to be.<br>
My thinking was it could be part of the initial launch request.  Along side the launch context.</p>



<a name="209546310"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546310" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546310">(Sep 09 2020 at 17:58)</a>:</h4>
<p>Thinking more deeply, I'm curious how often the FHIR server and the "host" application are independent.  Would the launching context even have the data on hand, or would it just have to call to the FHIR server itself?</p>



<a name="209546312"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546312" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546312">(Sep 09 2020 at 17:58)</a>:</h4>
<p>That has a few issues -- the launch as currently specified is just opening the browser to a certain url. The amount of data you can pass in a URL is pragmatically limited and the EHR is not authenticated to the app at this point.</p>



<a name="209546400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546400">(Sep 09 2020 at 17:59)</a>:</h4>
<p>Right. So the EHR needs to do the handshake first to ensure that the URL is still trustworthy, etc.</p>



<a name="209546402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546402">(Sep 09 2020 at 17:59)</a>:</h4>
<p>And yes, what you just described is a real challenge: in many architectures the authorization server or app container is not in a direct position to have all the data an app might want.</p>



<a name="209546543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546543">(Sep 09 2020 at 18:00)</a>:</h4>
<p>yup.  so including it with the token response is likely not reasonable because the server providing the token response is almost certain to not have access to the data requested in the pre-fetch</p>



<a name="209546679"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546679" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Varghese <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546679">(Sep 09 2020 at 18:01)</a>:</h4>
<p>The App is not authenticated to the EHR at the point of launch. So the SMART flow needs to happen. At that point, what is one additional web service request to get the same data? So would the value add obtained from this really justify the amount of effort and coordination on the part of the EHR to do this?</p>



<a name="209546685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546685">(Sep 09 2020 at 18:01)</a>:</h4>
<p>so, what makes the context of a CDS hook different?  Why can we trust the hook enough to send the pre-fetch data on initial call, but not the SMART app?  I'm assuming it's related to the auth mechanism for each?</p>



<a name="209546751"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546751" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546751">(Sep 09 2020 at 18:02)</a>:</h4>
<p>CDS hooks needs very very quick responses</p>



<a name="209546846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546846">(Sep 09 2020 at 18:03)</a>:</h4>
<p>and I think the idea was that if you were about to trigger 10 different CDS services that all needed the same data, it would make sense to put that in a common place (and CDS isn't coming from the auth server - it's coming from something typically more embedded in the system that has to speak FHIR)</p>



<a name="209546853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209546853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209546853">(Sep 09 2020 at 18:03)</a>:</h4>
<p>The trust model in CDS hooks includes a signed token as a header in the request period this works nicely because the request is not hitting a web browser, so there is a way to pass headers and hook + prefetch content in a post body.</p>



<a name="209547026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209547026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209547026">(Sep 09 2020 at 18:04)</a>:</h4>
<p>Got it.  that makes sense Josh.</p>



<a name="209547028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209547028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209547028">(Sep 09 2020 at 18:04)</a>:</h4>
<p>Matt is exactly correct that the opportunity to actually save time in a smart launch is quite limited. It's basically one round trip on a protocol that already requires at least three.</p>



<a name="209547140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209547140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209547140">(Sep 09 2020 at 18:05)</a>:</h4>
<p>Still I think this is a neat idea, especially for classes of apps that only ever need one set of data, like a simple calculator. these apps could get by without even needing an access token, if they had the right prefetch data. That said, I don't think this is a high-value target for standardization at this point.</p>



<a name="209547422"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209547422" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209547422">(Sep 09 2020 at 18:08)</a>:</h4>
<p>OK, so now let me go to the why, and see if you have a better way to solve my challenge.</p>
<p>We're finding that support for SMART is growing fast, but it's still pretty low.  As we go to partners and customers, few are there.  While SMART is pretty simple, it's not as easy as an authenticated web call.  Given that our app needs certain data up front, but then doesn't call back to the FHIR server after that initial data, we're trying to find a way to simplify things.</p>
<p>In effect, we want to setup a REST endpoint where you can POST a FHIR bundle, sign the request, and effectively launch a smart on fhir app.  This way, the host system doesn't have to support the full SMART or FHIR protocol.  Just the FHIR shape for the POST payload.</p>
<p>An easy button, so to speak.</p>
<p>Anyone do anything similar?</p>



<a name="209547769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209547769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209547769">(Sep 09 2020 at 18:11)</a>:</h4>
<p>The ude case makes sense. We have mostly been focused on standardizing core capabilities where standardizing will unlock a larger set of data and broader set of use cases -- and in the US anyway (because SMART is required by this year's onc regulations), we expect to see near universal support. We have avoided doing a lot of special case stuff.</p>



<a name="209547863"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209547863" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209547863">(Sep 09 2020 at 18:12)</a>:</h4>
<p>I haven't heard of any particularly clever approaches to this problem, but one thing you could consider would be building a bridge interface -- I believe your assumption is that you want to connect to a clinical data system that does not support smart but can create arbitrary correct fhir payloads matching data requests. In this case, you could build a generic bridge from the inputs you described into a smart API provider, and then just run a generic smart app that is launched by the bridge.</p>



<a name="209548467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209548467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209548467">(Sep 09 2020 at 18:18)</a>:</h4>
<p>makes sense.  That's been our approach so far, and may continue to be.  In our case, we're integrating with pharmacy systems, and in other contexts where the ONC rules don't always apply.</p>



<a name="209548525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209548525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209548525">(Sep 09 2020 at 18:19)</a>:</h4>
<p>nonetheless, it is comforting to hear other people suggest the same approach we're taking.</p>



<a name="209548538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209548538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209548538">(Sep 09 2020 at 18:19)</a>:</h4>
<p>thank you all for your time</p>



<a name="209548860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209548860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209548860">(Sep 09 2020 at 18:22)</a>:</h4>
<p>Sure thing! By the way, if you have implemented some specific capabilities in this space, have you considered whether it might make sense to open source this kind of bridge component?</p>



<a name="209564771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209564771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209564771">(Sep 09 2020 at 20:29)</a>:</h4>
<p>It was discussed, but I'll bring it up again.  I'm an engineer turned architect turned product person.  So I have influence, but not control over that sort of thing.  What we developed is a cache of sorts.  Internally we call it the FHIR cache, but we'd need approval to use that name publically.</p>
<p>In effect, you POST a FHIR bundle to it, get back a token, and then you can launch a SMART app and point the app back at the FHIR cache as your FHIR server.  It retains the bundle for a period of time, and scopes access to the token provided in the return from the original POST.</p>
<p>As a result, you don't need a FHIR server, capability statements, OATH handshakes, etc.  You basically just need to be able to provide syntactically correct FHIR objects (not sure we do much validation either), and only for those object types you know your SMART app will need.</p>



<a name="209564870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/209564870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tejay Cardon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#209564870">(Sep 09 2020 at 20:29)</a>:</h4>
<p>My guess is we'd be willing to give it to the community, but our use is limited enough that we probably can't commit to being good stewards of it.</p>



<a name="212788915"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/212788915" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bas van den Heuvel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#212788915">(Oct 09 2020 at 06:55)</a>:</h4>
<p>We have been playing with this topic on and off over the last year. The advantages of this approach is that launching an app in this way is much quicker than SmartOnFhir.  Because of security concerns, we restrict it to static content only. Is this something we may want to take further? If so what would be appropriate landing spot for it? CDShooks, Smart launch, or a separate (new) IG?</p>



<a name="212822195"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/212822195" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#212822195">(Oct 09 2020 at 13:02)</a>:</h4>
<p>Very interesting!</p>



<a name="212822309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/prefetch/near/212822309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/prefetch.html#212822309">(Oct 09 2020 at 13:03)</a>:</h4>
<p>Do you have a write-up or any details you can share? If this can be described as a set of techniques for making smart apps launch faster, I think it would make sense to take up under the banner of the smart app launch implementation guide. I think that would make the most sense for developers reading about it anyway.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
