---
layout: page
title: "FHIR Chat  · redirect_uri · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html">redirect_uri</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="253561990"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253561990" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Heath Frankel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253561990">(Sep 16 2021 at 10:54)</a>:</h4>
<p>Is it allow able to include a parameter or fragment in the redirect_uri in the auth request and have it returned to the app at the end of the authorisation sequence.<br>
I have tested this against the <a href="http://launch.smarthealthit.org">launch.smarthealthit.org</a> server and it doesn't return a code parameter in the redirect when I include a parameter but works fine when I include a fragment. <br>
Another Auth server just gives me an Invalid Redirect response.<br>
Example: redirect_uri=http%3A%2F%2Flocalhost%3A%23abc</p>



<a name="253629365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253629365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253629365">(Sep 16 2021 at 18:37)</a>:</h4>
<p>Hi Heath- this is what you can use the “state” parameter for. Its a value that you provide that will be returned untouched from the authz server. The main consideration though is that the state parameter is also used to help protect against various attacks on the protocol so therefore it cannot be a guessable value. So one approach would be to encode your desired value in a signed blob like a Jwt that you can use to both communicate information, but can also be validated</p>



<a name="253685542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253685542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Heath Frankel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253685542">(Sep 17 2021 at 03:52)</a>:</h4>
<p>Thanks Dan. I am using the SMART JS Client for the SMART Launch and the generation and management of state is buried deep inside the library. Although I could look at modifying the library, I'm reluctant to have to maintain a fork of it. </p>
<p>So I shouldn't use fragment in the redirect_uri for this purpose?</p>



<a name="253744990"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253744990" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253744990">(Sep 17 2021 at 13:51)</a>:</h4>
<blockquote>
<p>So I shouldn't use fragment in the redirect_uri for this purpose?</p>
</blockquote>
<p>Most server would reject that as an unregistered redirect URL, so it won't work</p>



<a name="253749115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253749115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253749115">(Sep 17 2021 at 14:18)</a>:</h4>
<p>The OAuth 2.0 Threat Model and Security Considerations explicitly states <a href="https://datatracker.ietf.org/doc/html/rfc6819#section-5.2.3.5">"the "redirect_uri" should be the full URI"</a>. So your ability to include a fragment is dependent upon servers disregarding this advice.</p>



<a name="253764761"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253764761" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Ignatov <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253764761">(Sep 17 2021 at 16:01)</a>:</h4>
<p>I think you should read that as "full URL and not a relative one".</p>



<a name="253766824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253766824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253766824">(Sep 17 2021 at 16:15)</a>:</h4>
<blockquote>
<p>So I shouldn't use fragment in the redirect_uri for this purpose?</p>
</blockquote>
<p>Correct; the only "variable" part of a redirect (i.e., the only part that changes across multiple launches) will be the auth-server-supplied query params (<code>code</code> and <code>state</code>), and of these, the only one you control is <code>state</code>. So the advice is: create a high-entropy random <code>state</code> value and attach any state you need to track to this value, within your client.</p>



<a name="253766853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/redirect_uri/near/253766853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/redirect_uri.html#253766853">(Sep 17 2021 at 16:15)</a>:</h4>
<p>That prevents external parties from "tricking" your app by injecting additional parameters.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
