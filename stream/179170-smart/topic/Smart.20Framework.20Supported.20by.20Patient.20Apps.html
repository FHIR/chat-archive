---
layout: page
title: "FHIR Chat  · Smart Framework Supported by Patient Apps · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html">Smart Framework Supported by Patient Apps</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="207422252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/207422252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aju Jacob <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#207422252">(Aug 19 2020 at 15:24)</a>:</h4>
<p>I apologize if this is a redundant question. What authentication framework does patient-centric apps like Apple Health follow? Is it the SMART App Launch framework #1 (Patients apps that launch standalone), where the app expects the Patient FHIR ID in the JWT response token?</p>



<a name="207424774"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/207424774" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#207424774">(Aug 19 2020 at 15:44)</a>:</h4>
<p>Yes, they use patient stand-alone launch. Note that the FHIR patient ID is not _inside_ the token (that does not have to be a JWT by the way), it is in the token response</p>



<a name="207445837"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/207445837" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#207445837">(Aug 19 2020 at 18:42)</a>:</h4>
<p>I will stress a point in Michele's response above, since there's confusion there: in OAuth the token is opaque to the app and you don't want to break that open/expect any format :) Make sure you're looking at the claims returned during token issuance instead (in their own fields in the token response)... otherwise you'll get broken</p>



<a name="207450140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/207450140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aju Jacob <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#207450140">(Aug 19 2020 at 19:18)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191912">@Michele Mottini</span> and <span class="user-mention" data-user-id="191356">@Jenni Syed</span>. This is very helpful. You're right, I meant including the FHIR Patient ID in the claims returned during token issuance.</p>



<a name="208714370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/208714370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#208714370">(Sep 01 2020 at 16:38)</a>:</h4>
<p>Thanks so much for the "stressed point." I've read <a href="http://hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#launch-context-arrives-with-your-access_token">"3.3. Launch context arrives with your access_token"</a> dozens of times, and I've been confused. On a careful reading <em>with</em> your <code>access_token</code>, not <em>in</em> your <code>access_token</code>, but it's easy to miss.</p>
<p>For <code>launch/patient</code>, I understand that the Auth server will include the <code>PatientId</code> in the token response. This is possible because the <code>PatientId</code> can be linked to the login identity; for example, with a custom attribute. <br>
URL: /token?scope=launch/patient<br>
{<br>
  access_token: &lt;jwt&gt;<br>
  Patient: 123<br>
}</p>
<p>However, for <code>launch/encounter</code> and the pending <a href="https://github.com/HL7/smart-app-launch/pull/308/files"><code>launch/appointment</code></a> PR, how would the Auth server know which encounter or appointment to use?</p>
<p>Is the encounter or appointment supposed to be passed in the token request URL?<br>
URL: /token?scope=launch/encounter&amp;encounter=123<br>
{<br>
  access_token: &lt;jwt&gt;<br>
  Encounter: 123<br>
}</p>



<a name="208720696"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/208720696" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#208720696">(Sep 01 2020 at 17:30)</a>:</h4>
<p>It is up to the server. It can ask the user to select one, or pick it up from current context in the case of embedded apps (that is the common use cases for those kind of scopes I guess)</p>



<a name="212607337"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212607337" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Smayda <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212607337">(Oct 07 2020 at 19:25)</a>:</h4>
<p>If the patientId is not within the <code>access_token</code> how will the Resource Server know what this user has access to?</p>
<p>If the patientId is not in the <code>access_token</code> I presume the Resource Server must query the AuthZ Server to get further required user information</p>
<p>Toy example: I get an access token from my AuthZ server and the SMART client app queries the Resource Server with <code>/Patient/{yourId}</code> instead of <code>/Patient/{myId}</code>. How does the Resource server 'block' the SMART client from doing this?</p>



<a name="212607766"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212607766" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212607766">(Oct 07 2020 at 19:29)</a>:</h4>
<p>as far as the standardization is concerned, smart is entirely about the relationship between the app and the EHR. We don't try to provide any requirements about how the different components of the EHR interact with each other.</p>



<a name="212607797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212607797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212607797">(Oct 07 2020 at 19:29)</a>:</h4>
<p>These components might agree on a token format such as json web tokens, or they might share a database where the resource server can look up information.</p>



<a name="212607895"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212607895" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212607895">(Oct 07 2020 at 19:30)</a>:</h4>
<p>We do recommend that the authorization server support a token introspection endpoint; and indeed this has become a requirement for any certified EHR under onc rules.</p>



<a name="212607913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212607913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212607913">(Oct 07 2020 at 19:30)</a>:</h4>
<p>We are working on some guidance to make it clear how the patient ID can be discovered from this token introspection endpoint.</p>



<a name="212607939"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212607939" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212607939">(Oct 07 2020 at 19:30)</a>:</h4>
<p>let me share a link to the draft guidance...</p>



<a name="212608194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212608194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212608194">(Oct 07 2020 at 19:32)</a>:</h4>
<p><a href="https://github.com/HL7/smart-app-launch/pull/306/files?short_path=c16e67a#diff-c16e67ab61d8d337cea376b288ffdf99">https://github.com/HL7/smart-app-launch/pull/306/files?short_path=c16e67a#diff-c16e67ab61d8d337cea376b288ffdf99</a></p>



<a name="212613946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212613946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Smayda <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212613946">(Oct 07 2020 at 20:18)</a>:</h4>
<p>Got it just to confirm - from SMART client point of view the contract is:</p>
<ul>
<li>When user is authorized the SMART client will have an <code>access_token</code> and any required context (i.e. patient id for launching patient information)</li>
<li>This required context will live outside of the <code>access_token</code> from the AuthZ response, but it may also be inside of the <code>access_token</code> (based on discretion of AuthZ server).</li>
<li>When SMART client makes request to Resource Server they add the <code>access_token</code> as the auth header and that additional context is either in the FHIR url (<code>/Patient/{id}</code>)or not provided to the Resource Server</li>
</ul>
<p>Thanks for looking this over!</p>



<a name="212614848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212614848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212614848">(Oct 07 2020 at 20:27)</a>:</h4>
<p>That's right! To be specific</p>
<ul>
<li>
<p>the patient context is communicated to the client in a "patient" property, which is a sibling of the "access_token" property of the access token response. And</p>
</li>
<li>
<p>the access token is included in an authorization header (but it's not the whole header; it's prefixed with <code>Bearer </code>)</p>
</li>
</ul>



<a name="212871860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212871860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212871860">(Oct 09 2020 at 20:26)</a>:</h4>
<p>Given that this is a kind of frequently asked question, I've recorded a video explaining some of this: <a href="https://www.youtube.com/watch?v=X2lmbHAeOMg">https://www.youtube.com/watch?v=X2lmbHAeOMg</a></p>
<div class="youtube-video message_inline_image"><a data-id="X2lmbHAeOMg" href="https://www.youtube.com/watch?v=X2lmbHAeOMg"><img src="https://i.ytimg.com/vi/X2lmbHAeOMg/default.jpg"></a></div><p>(I know some people really like this kind of video format and some people really don't! If you prefer text, please note that the expanded video description includes a write-up of the important takeaways under "TL;DR".)</p>



<a name="212879418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212879418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212879418">(Oct 09 2020 at 21:49)</a>:</h4>
<p>Nitpick: can you avoid 'EHR'? ...because then we fall into the 'I am a payer, this stuff does not apply to me' kind of deal</p>



<a name="212879537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212879537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212879537">(Oct 09 2020 at 21:50)</a>:</h4>
<p>(Also: thanks for doing this!)</p>



<a name="212879663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Smart%20Framework%20Supported%20by%20Patient%20Apps/near/212879663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Smart.20Framework.20Supported.20by.20Patient.20Apps.html#212879663">(Oct 09 2020 at 21:52)</a>:</h4>
<p>it's a good point. I can update the description and in the video itself I talk about EHR or Health Data system when I first bring it up, but it's just such a mouthful to say every time. Maybe I could try to settle on words like fhir server instead.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
