---
layout: page
title: "FHIR Chat  · Keycloak for SMART authz · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html">Keycloak for SMART authz</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="214251419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214251419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214251419">(Oct 22 2020 at 21:38)</a>:</h4>
<p>BTW <span class="user-mention" data-user-id="191676">@Lee Surprenant</span>, following discussion <a href="#narrow/stream/179309-inferno/topic/Is.20client.20id.20optional.20on.20a.20refresh.20request.3F/near/213974919">over here</a>: I'd love to get an overview of how you're using KeyCloak to implement a SMART authz server -- I think there's probably broad community interest in this point. Any chance you'd be up for a chat? (And if you're amenable, we could record / share for folks who want to catch up later.)</p>



<a name="214259473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214259473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214259473">(Oct 22 2020 at 23:26)</a>:</h4>
<p><span class="user-mention" data-user-id="191343">@Michael Lawley</span> and <span class="user-mention" data-user-id="191337">@Dion McMurtrie</span> and I would probably be interested in this. We're using Keycloak for some SMART stuff too.</p>



<a name="214305439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214305439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214305439">(Oct 23 2020 at 12:14)</a>:</h4>
<p>I am too interested on this. We have OAuth Server (built using spring security) on cloud and EHR as on-prem solution.  and we are planning to migrate over to KeyCloak for building OIDC and extending for SMART on FHIR from existing OAuth Server</p>



<a name="214317543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214317543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214317543">(Oct 23 2020 at 14:06)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191315">@Josh Mandel</span>, I'm happy to join a call and share where we're at with Keycloak on this effort.  I'm especially interested to hear from others using Keycloak (or RedHat SSO) for SMART-on-FHIR support.</p>



<a name="214317584"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214317584" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214317584">(Oct 23 2020 at 14:07)</a>:</h4>
<p>Does anyone know any of the folks involved with "igia" (<a href="https://igia.github.io/docs/igia-keycloak~introduction">https://igia.github.io/docs/igia-keycloak~introduction</a>)?</p>



<a name="214319027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214319027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214319027">(Oct 23 2020 at 14:18)</a>:</h4>
<p>I noticed some in the DaVinci community are using Keycloak as well.  <span class="user-mention" data-user-id="191506">@Yunwei Wang</span> <span class="user-mention" data-user-id="191434">@Andy Gregorowicz</span> I noticed you both have edited the keycloak section of the DaVinci CRD README...is this a subject you'd be interested in discussing?</p>



<a name="214322172"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214322172" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214322172">(Oct 23 2020 at 14:42)</a>:</h4>
<p>Super, <span class="user-mention" data-user-id="191676">@Lee Surprenant</span>! Let's see who else chimes in here as interested, and then try to schedule a time for a conversation late next week, if that works?</p>



<a name="214322305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/214322305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#214322305">(Oct 23 2020 at 14:43)</a>:</h4>
<p>works for me</p>



<a name="215084968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215084968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215084968">(Oct 30 2020 at 12:02)</a>:</h4>
<p>Just curious, if there was any conversation around this week on this topic?</p>



<a name="215117313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215117313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215117313">(Oct 30 2020 at 16:20)</a>:</h4>
<p>We didn't schedule one -- but let's do so for next week. <span class="user-mention" data-user-id="191676">@Lee Surprenant</span> are there times next Friday 11/6 that would work for you?</p>



<a name="215123659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215123659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215123659">(Oct 30 2020 at 17:10)</a>:</h4>
<p>I'm free most of the day.  Pretty much anything outside of 10-11 ET</p>



<a name="215130087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215130087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215130087">(Oct 30 2020 at 18:02)</a>:</h4>
<p>Great -- I just sent an invite for 2:30p ET. Anyone else who wants to (to lee, Sagar, Jim, Michael, Dion -- recognizing that the time will be really poor for some; we'll record it!)</p>



<a name="215130218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215130218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215130218">(Oct 30 2020 at 18:03)</a>:</h4>
<p>(Others please let me know if you want to be added to the invite)</p>



<a name="215130369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215130369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venkateswara R Davuluri <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215130369">(Oct 30 2020 at 18:04)</a>:</h4>
<p>Hi Josh, please send the invite to me also. (<a href="mailto:dr.davuluri@gmail.com">dr.davuluri@gmail.com</a>)</p>



<a name="215475407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215475407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215475407">(Nov 03 2020 at 16:15)</a>:</h4>
<p>(Note that we moved this later in the day, to 4p ET, to accommodate Australia <em>slightly</em> less terribly. Everyone on the invite should have seen an update.)</p>



<a name="215479616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215479616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215479616">(Nov 03 2020 at 16:46)</a>:</h4>
<p>I may be tentative around that time. But I am hoping this will be recorded and I can go though it later.</p>



<a name="215482212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215482212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215482212">(Nov 03 2020 at 17:04)</a>:</h4>
<p>Thanks -- we'll plan to record it (and for folks on the call: please remind me of this plan so I actually hit the button!)</p>



<a name="215508520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215508520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215508520">(Nov 03 2020 at 20:51)</a>:</h4>
<p>Can you please add me to the invite too? Thanks</p>



<a name="215508834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215508834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215508834">(Nov 03 2020 at 20:55)</a>:</h4>
<p>Done!</p>



<a name="215577439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215577439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian Bacher <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215577439">(Nov 04 2020 at 13:09)</a>:</h4>
<p>I'd also be interested in this discussion if it's possible to include me (<a href="mailto:ian_bacher@brown.edu">ian_bacher@brown.edu</a>). Thanks!</p>



<a name="215651643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215651643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215651643">(Nov 04 2020 at 22:55)</a>:</h4>
<p>Done!</p>



<a name="215843255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215843255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215843255">(Nov 06 2020 at 13:11)</a>:</h4>
<p>FYI I just posted a quick advert on the Keycloak Zulip instance (yes, they use Zulip too!)</p>



<a name="215843260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215843260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215843260">(Nov 06 2020 at 13:11)</a>:</h4>
<p><a href="https://keycloak.zulipchat.com/#narrow/stream/211273-user/topic/SMART.20App.20Launch">https://keycloak.zulipchat.com/#narrow/stream/211273-user/topic/SMART.20App.20Launch</a></p>



<a name="215902402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215902402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215902402">(Nov 06 2020 at 20:52)</a>:</h4>
<p>Meeting in 8min: <a href="https://teams.microsoft.com/dl/launcher/launcher.html?url=%2F_%23%2Fl%2Fmeetup-join%2F19%3Ameeting_Nzg4MWVmYTctMGQ1Mi00NjAwLTkzMWItNjVjOGU3N2IwMGUy%40thread.v2%2F0%3Fcontext%3D%257b%2522Tid%2522%253a%252272f988bf-86f1-41af-91ab-2d7cd011db47%2522%252c%2522Oid%2522%253a%252299f26c89-9bc7-4381-abb4-95b0804b27f3%2522%257d%26anon%3Dtrue&amp;type=meetup-join&amp;deeplinkId=2f71bf3c-2bb2-422d-948c-fccf9f7e6c2e&amp;directDl=true&amp;msLaunch=true&amp;enableMobilePage=true&amp;suppressPrompt=true">Teams link</a></p>



<a name="215911532"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215911532" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dion McMurtrie <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215911532">(Nov 06 2020 at 22:26)</a>:</h4>
<p>Thanks for the meeting <span class="user-mention" data-user-id="191315">@Josh Mandel</span> and particular thanks to <span class="user-mention" data-user-id="191676">@Lee Surprenant</span> for sharing.</p>
<p>As well as our efforts I'm aware of this <a href="https://github.com/itcr-uni-luebeck/ontoserver-keycloak">https://github.com/itcr-uni-luebeck/ontoserver-keycloak</a> so I think it would be great to provide a space for those who've done Keycloak + FHIR to share knowledge/approaches so we don't have to keep independently learning the same stuff. Mostly it is a journey of figuring out how to configure Keycloak to do what you want it to do, which is a bit of a learning curve.</p>



<a name="215912381"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215912381" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215912381">(Nov 06 2020 at 22:34)</a>:</h4>
<p>Thanks all for joining the discussion today! I've just uploaded the recording to <a href="https://youtu.be/Pp32GOOq0Vw">https://youtu.be/Pp32GOOq0Vw</a> (YouTube may take a few minutes to finish processing.)</p>
<div class="youtube-video message_inline_image"><a data-id="Pp32GOOq0Vw" href="https://youtu.be/Pp32GOOq0Vw"><img src="https://i.ytimg.com/vi/Pp32GOOq0Vw/default.jpg"></a></div><p>Thanks especially to <span class="user-mention" data-user-id="191676">@Lee Surprenant</span> for sharing the work you've done.</p>



<a name="215913352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215913352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215913352">(Nov 06 2020 at 22:44)</a>:</h4>
<p>Thank you for setting this up and providing very useful information. I also wanted bring up similar point, but could not bring it due to time constraint that Okta is working on similar initiative too by using AWS lambda as a SMART proxy that adds SMART on FHIR capabilities on top of its OIDC solution. That SMART proxy runs outside of the Auth Server solution of Okta, which is very similar to what <span class="user-mention" data-user-id="191676">@Lee Surprenant</span>  showed in his diagram. Thanks <span class="user-mention" data-user-id="191315">@Josh Mandel</span> for setting this up and sharing the recording</p>



<a name="215915202"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215915202" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215915202">(Nov 06 2020 at 23:04)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="344150">@Sagar Shah</span>  -- are their docs or any background reading on this approach with Okta?</p>



<a name="215915593"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215915593" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215915593">(Nov 06 2020 at 23:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>  I believe, there are some contractual obligations because of which I may not be able to share it at this point. But I can point to these 2 open source git hub repositories, that may provider some pointers <a href="https://github.com/dancinnamon-okta/okta-smartfhir-demo">https://github.com/dancinnamon-okta/okta-smartfhir-demo</a> and <a href="https://github.com/dancinnamon-okta/SoF-Demo">https://github.com/dancinnamon-okta/SoF-Demo</a>. Hope this is useful!</p>



<a name="215931118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215931118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215931118">(Nov 07 2020 at 04:17)</a>:</h4>
<p>Thanks for the recording, I couldn't make the meeting time but that was very interesting.</p>



<a name="215953428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/215953428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#215953428">(Nov 07 2020 at 12:47)</a>:</h4>
<p>FYI - I have a setup where we bridge SAML to OAuth in Keycloak ending up with a 'SMART'-like behaviour (<a href="https://ehealth-dk.atlassian.net/wiki/spaces/EDTW/pages/7045392/Security">https://ehealth-dk.atlassian.net/wiki/spaces/EDTW/pages/7045392/Security</a>) where the JWT more or less follows SMART - should it have any interest.</p>



<a name="216428719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/216428719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#216428719">(Nov 12 2020 at 05:11)</a>:</h4>
<p><span class="user-mention" data-user-id="344150">@Sagar Shah</span> <span class="user-mention" data-user-id="191315">@Josh Mandel</span> <span class="user-mention" data-user-id="191676">@Lee Surprenant</span> ,<br>
Shoot! I'm totally late to the party :). Saw the video from last week, and yes it does certainly look familiar to some of the research I've been doing- in my particular case using Okta as the authorization server- Lee sounds like you and I ran into a number of the very same issues and overcame some of the same hurdles. I'll also be checking what i'm doing with the "aud" input parameter, as I think I'm currently working in the same way you are.</p>



<a name="216920419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/216920419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#216920419">(Nov 16 2020 at 19:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> one thing we ran out of time to discuss in that call is the issue I hit where keycloak is expecting the client_id in the refresh token for public clients (whereas SMART says its not needed).<br>
Given that Keycloak is a certified OIDC provider, and that it shouldn't be burdensome for clients to include the client_id in the exchange (since they already use it elsewhere), would you be opposed to adding it into the corresponding exchange for SMART App Launch?  Should I open a JIRA ticket for it?</p>



<a name="217825433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/217825433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Łukasz Dywicki <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#217825433">(Nov 24 2020 at 23:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191676">Lee Surprenant</span> <a href="#narrow/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz/near/216920419">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> one thing we ran out of time to discuss in that call is the issue I hit where keycloak is expecting the client_id in the refresh token for public clients (whereas SMART says its not needed).</p>
</blockquote>
<p>Not sure if that's issue after all. Refresh token is something given to client and expected to be returned by it. I am not quite sure if client should bother at all about what refresh token is, just bring it back to obtain new tokens.</p>



<a name="218280522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218280522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218280522">(Nov 30 2020 at 12:32)</a>:</h4>
<p>My apologies for the sloppy language.  What I meant above is this:</p>
<blockquote>
<p>keycloak is expecting the client_id in the <em>request</em> to refresh the access token for public clients (whereas SMART says its not needed)</p>
</blockquote>



<a name="218323018"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218323018" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yogesh Dhimate <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218323018">(Nov 30 2020 at 18:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz/near/215912381">said</a>:</p>
<blockquote>
<p>Thanks all for joining the discussion today! I've just uploaded the recording to <a href="https://youtu.be/Pp32GOOq0Vw">https://youtu.be/Pp32GOOq0Vw</a> (YouTube may take a few minutes to finish processing.)</p>
<p>Thanks especially to <span class="user-mention silent" data-user-id="191676">Lee Surprenant</span> for sharing the work you've done.</p>
</blockquote>
<p>Thanks a lot for recording and sharing this. Is there a plugin/extension required to  support wildcard scopes in Keycloak? <br>
How does Keycloak know patient/*.read means patient/Observation.read AND patient/Immunization.read (etc...)</p>



<a name="218330103"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218330103" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218330103">(Nov 30 2020 at 19:01)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="329487">@Yogesh Dhimate</span> what we spent most of the time discussing is how to get the right context and scopes associated with the access token.  What we <em>did not</em> cover is how to actually enforce access controls based on the combination of the user context and the approved scopes.  It sounds like you are asking about the latter.</p>



<a name="218330765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218330765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218330765">(Nov 30 2020 at 19:06)</a>:</h4>
<blockquote>
<p>How does Keycloak know patient/*.read means patient/Observation.read AND patient/Immunization.read</p>
</blockquote>
<p>The authorization server does not really need to know that, doesn't it? Is the resource server that has to check that - 'I am getting a request for Patient, let me check if that's admissible based on the access token scopes: look for patient/Patient.read or patient/*.read etc.'</p>



<a name="218359620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218359620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yogesh Dhimate <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218359620">(Nov 30 2020 at 23:10)</a>:</h4>
<p>Thanks for your reply <span class="user-mention" data-user-id="191676">@Lee Surprenant</span>  Yes I was talking about the latter part of enforcing the access controls. </p>
<p>Hi <span class="user-mention" data-user-id="191912">@Michele Mottini</span>  - thanks for your input. That was my point, that if the resource server is  getting a request for patient/Immunization.read, but the scope being presented is patient/*.read, should it be the responsibility of the resource server to interpret the wildcard and allow/deny the request.</p>
<p>In my architecture we have an API gateway layer on top of the resource server. The API gateway layer protects the APIs by applying security policies like OpenID token enforcement etc. </p>
<p>Outside of SMART on FHIR, we haven't encountered the wildcard scopes, so the policy enforcement for scopes is verbatim.  The list of scopes can be configured for each API or a resource  endpoint when applying a policy.</p>
<p>e.g. API security policy for /Immunization resource can be configured with scopes like <code>openid fhirUser patient/Immunization.read </code><br>
With this configuration when a SMART app tries to access the resource, it must present a token which proves that it has been granted access to these scopes. </p>
<p>Since this validation/comparison of scopes at API policy level doesn't take into account wildcards, an app with these scopes <code>openid fhirUser patient/*.read</code> can't get past the security policy layer as the patient/*.read doesn't translate to patient/Immunization.read. </p>
<p>I was wondering whether authorization server should interpret the wildcard scopes and translate/return the appropriate scopes accordingly.</p>



<a name="218359912"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218359912" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218359912">(Nov 30 2020 at 23:14)</a>:</h4>
<p>Note that you can forbid wildcard scopes, and require apps to use always explicit ones (some existing server do that - eg Cerner)</p>



<a name="218372824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218372824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yogesh Dhimate <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218372824">(Dec 01 2020 at 02:08)</a>:</h4>
<p>Thanks for your response.  I didn't know that we can forbid specific scopes. If we were to forbid these scopes, how Is this information communicated to the client apps? Do we document in API documentation or it should be in the CapabilityStatement?</p>



<a name="218379471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218379471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218379471">(Dec 01 2020 at 04:21)</a>:</h4>
<p>Typically as part of the app registration there is a list of allowed scopes, or in some cases the app has to select which scopes it wants from a list of all the available ones.</p>



<a name="218379555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218379555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218379555">(Dec 01 2020 at 04:23)</a>:</h4>
<p>Here is an example from Cerner app registration:<br>
<a href="/user_uploads/10155/BRmG_p7PVZD_oL7Yd7z-2g7f/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/BRmG_p7PVZD_oL7Yd7z-2g7f/image.png" title="image.png"><img src="/user_uploads/10155/BRmG_p7PVZD_oL7Yd7z-2g7f/image.png"></a></div>



<a name="218432699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218432699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218432699">(Dec 01 2020 at 15:00)</a>:</h4>
<p>You can also advertise what scopes you support in the conformance doc for SMART</p>



<a name="218432811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218432811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218432811">(Dec 01 2020 at 15:01)</a>:</h4>
<p><a href="http://www.hl7.org/fhir/smart-app-launch/conformance/index.html">http://www.hl7.org/fhir/smart-app-launch/conformance/index.html</a></p>



<a name="218847325"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/218847325" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yogesh Dhimate <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#218847325">(Dec 04 2020 at 15:30)</a>:</h4>
<p>Perfect thank you.</p>



<a name="219577476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219577476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219577476">(Dec 11 2020 at 08:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191676">@Lee Surprenant</span> <span class="user-mention" data-user-id="222054">@Gino Canessa</span> <span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> <span class="user-mention" data-user-id="259065">@Ian Bacher</span> <span class="user-mention" data-user-id="191337">@Dion McMurtrie</span> <br>
Thanks so much for the informative talk!<br>
Y'all mentioned working on a cookbook for SMART on FHIR in Keycloak (~59 min). Did anything ever come of that effort?</p>



<a name="219577678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219577678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219577678">(Dec 11 2020 at 08:49)</a>:</h4>
<p><span class="user-mention" data-user-id="344150">@Sagar Shah</span> Would you consider presenting a similar talk on the Okta + API Gateway + Lambda's approach from <a href="https://github.com/dancinnamon-okta/okta-smartfhir-demo">https://github.com/dancinnamon-okta/okta-smartfhir-demo</a> ?</p>



<a name="219599756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219599756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219599756">(Dec 11 2020 at 12:30)</a>:</h4>
<p><span class="user-mention" data-user-id="300914">@Ryan Harrison</span>  - Wish, I could. I am not in a position to present a talk as we have not explored it except for understanding high level flow  and we are not planning to use it, as we are not going with Okta solution for OIDC. We just came across that as an option while exploring. I will try to put down the high level steps here soon here</p>



<a name="219613831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219613831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219613831">(Dec 11 2020 at 14:45)</a>:</h4>
<p><span class="user-mention" data-user-id="344150">@Sagar Shah</span> Thanks for the prompt response/clarification, and for bringing the Okta community configuration to the communities attention.</p>



<a name="219622892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219622892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219622892">(Dec 11 2020 at 15:58)</a>:</h4>
<p><span class="user-mention" data-user-id="300914">@Ryan Harrison</span>  Nothing from me on that front yet.  Still want to get to it though.  The latest news is <span class="user-mention" data-user-id="259065">@Ian Bacher</span> 's pull request got merged which will change things a bit (no more need for a token-response-rewriter)</p>



<a name="219623343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219623343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219623343">(Dec 11 2020 at 16:01)</a>:</h4>
<p><span class="user-mention" data-user-id="259065">@Ian Bacher</span> /@<strong>Lee Surprenant</strong>  - Is that available in 11.0.3 v of keycloak? or going to be part of next release?</p>



<a name="219625326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219625326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian Bacher <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219625326">(Dec 11 2020 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="344150">@Sagar Shah</span> The <a href="https://issues.redhat.com/browse/KEYCLOAK-15287">Jira ticket</a> indicates it will be included in the 12.0.0 release. Note that the changes are (to the best of my knowledge) not exposed through the Keycloak UI.</p>
<p>I'm still on board with helping get together a cookbook for SMART on FHIR in Keycloak, but probably in the new year.</p>



<a name="219625547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219625547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219625547">(Dec 11 2020 at 16:16)</a>:</h4>
<p>That will be a great help, <span class="user-mention" data-user-id="259065">@Ian Bacher</span> . Excited to see new release of keycloak of 12.0.0</p>



<a name="219626283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219626283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219626283">(Dec 11 2020 at 16:22)</a>:</h4>
<p>Here are the steps in general <span class="user-mention" data-user-id="300914">@Ryan Harrison</span> . Hope this helps!<br>
<strong>End-to-End Flow</strong></p>
<hr>
<ol>
<li>User accesses a SMART-enabled app.</li>
<li>App determines authz endpoints from metadata.</li>
<li>App opens the /authorize proxy endpoint. <em>(Note this is the proxy endpoint and not real auth server endpoint)</em></li>
<li>Authorize proxy caches original request and performs authz with patient picker app instead.</li>
<li>User logs in with Auth Server.</li>
<li>User is shown the patient picker app.</li>
<li>Patient, and downscoped scopes are combined with original request details and sent to Auth Server in a new /authorize request.</li>
<li>Auth server calls a token hook to validate that the request actually came from the patient picker, and to insert the selected patient into the token.</li>
<li>Auth Server returns authorization code to the authorize proxy. The authorize proxy redirects the browser to the OAuth2 callback url of the app.</li>
<li>App calls the /token proxy to obtain an access token.</li>
<li>/token proxy obtains the token from Auth Server, uses a private key to perform client authentication</li>
<li>/token proxy puts the proper launch response alongside the access token from Auth Server.</li>
<li>App accesses the FHIR API</li>
</ol>



<a name="219668131"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219668131" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219668131">(Dec 11 2020 at 22:03)</a>:</h4>
<p><span class="user-mention" data-user-id="344150">@Sagar Shah</span> Well that sequence list is the first step of the playbook. Then come the Keycloak (or Igia on Keycloak?) specific instructions for each step. Ideally backed by a repo with some automation (e.g. creating all the resource scopes and tedious configuration). Thank you!</p>



<a name="219996527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219996527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219996527">(Dec 15 2020 at 15:43)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="300914">@Ryan Harrison</span> - I'm the author of the Okta reference implementation- I'd be happy to do a presentation on it if people are interested.  I've made some updates to it in the past few weeks:<br>
1- I've provided some far more detailed documentation on it, contained here: <a href="https://github.com/dancinnamon-okta/okta-smartfhir-docs">https://github.com/dancinnamon-okta/okta-smartfhir-docs</a><br>
2- I just did a major refactor of the components earlier this week to separate out the Lambda specific pieces of it so if there's interest in releasing in another serverless technology (Azure functions, GCP functions, etc) that should be quick to do.  It leverages the serverless deployment framework so adjusting to other clouds should be seamless.</p>



<a name="219997203"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/219997203" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#219997203">(Dec 15 2020 at 15:47)</a>:</h4>
<p>I'd be super interested in a presentation about this, Dan!</p>



<a name="220184255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/220184255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#220184255">(Dec 16 2020 at 22:44)</a>:</h4>
<p>Great- perhaps we can shoot for a date later in January after connectathon. Whatever works.</p>



<a name="225166755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225166755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225166755">(Feb 04 2021 at 14:35)</a>:</h4>
<p>Good morning everyone- well it was a crazy January- not sure where the time went.  Is there still interest in covering the reference implementation I've done with SMART+Okta?  If so, I thought I'd propose some time during the week of 2/15 to have that session. Thoughts?</p>



<a name="225168153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225168153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venu Gopal <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225168153">(Feb 04 2021 at 14:46)</a>:</h4>
<p>Hi  Dan, I am a new comer to this chat, and I am implementing a solution for India. I'm interested, if you have time</p>



<a name="225174711"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225174711" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225174711">(Feb 04 2021 at 15:29)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span>  for checking. We have similar interests too in knowing what that SMART on FHIR proxy component works with AWS lambda works and Okta as an authz server (or any other auth server).</p>



<a name="225390282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225390282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225390282">(Feb 06 2021 at 06:35)</a>:</h4>
<p><span class="user-mention" data-user-id="361257">@Dan Cinnamon</span> Thanks for publishing your reference implementation! I would _enthusiastically_ attend a presentation the week of 2/15. Just say when (please @ me so I see it). <a href="https://meet.jit.si">https://meet.jit.si</a> is my goto for small to mid-sized meetings. Please record if you're comfortable [^1].</p>
<p>cc <span class="user-mention" data-user-id="336563">@Elijah</span><br>
[^1] The session Josh Mandel et al. recorded was fantastic: <a href="#narrow/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz/near/215912381">https://chat.fhir.org/#narrow/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz/near/215912381</a></p>



<a name="225433380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225433380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225433380">(Feb 06 2021 at 22:34)</a>:</h4>
<p>Yeah <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span> I'd be eager to join. Do you want to set up a time (or I'm happy to help!)</p>



<a name="225548385"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225548385" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225548385">(Feb 08 2021 at 14:06)</a>:</h4>
<p>Awesome- thanks everyone! <span class="user-mention" data-user-id="300914">@Ryan Harrison</span>  <span class="user-mention" data-user-id="191315">@Josh Mandel</span> <span class="user-mention" data-user-id="344150">@Sagar Shah</span> <span class="user-mention" data-user-id="251824">@Venu Gopal</span> - Right now Thursday the 18th looks wide open.  In efforts to select a time that's somewhat reasonable for our partners in India, I was thinking we could do 9am CST- does that time work? In terms of jitsi- I'd be glad to use that platform- however, would like to post a link here beforehand.  What's the best way to do that? I was thinking i'd just generate a GUID and use that as my meeting ID.</p>



<a name="225552692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225552692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225552692">(Feb 08 2021 at 14:39)</a>:</h4>
<p>That works for me! Re: jitsi I'd note that the built-in recording capabilities are limited, so we might want to see if someone can record from their desktop as a backup.</p>



<a name="225586540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225586540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225586540">(Feb 08 2021 at 18:25)</a>:</h4>
<p>yes Yes! :) </p>
<p>That time works for me (18 Feb @ 9 am CT).<br>
You can use any arbitrary room name you'd like.<br>
And a recording backup is a great idea.</p>



<a name="225598456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225598456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225598456">(Feb 08 2021 at 19:54)</a>:</h4>
<p>Works for me too. Thanks for checking <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span> !</p>



<a name="225698418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225698418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225698418">(Feb 09 2021 at 14:37)</a>:</h4>
<p>Great!  9am central time on 2/18 it is then.  We'll use <a href="https://meet.jit.si/smart-reference-review-with-dan">https://meet.jit.si/smart-reference-review-with-dan</a> for it.  I've also attached a .ics file for your calendar if you'd like. <a href="/user_uploads/10155/7HG53A-Y61zPVLBBmlp2JiKM/invite.ics">invite.ics</a><br>
<span class="user-mention" data-user-id="300914">@Ryan Harrison</span> <span class="user-mention" data-user-id="344150">@Sagar Shah</span> <span class="user-mention" data-user-id="251824">@Venu Gopal</span> <span class="user-mention" data-user-id="191315">@Josh Mandel</span> ^^</p>



<a name="225795842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225795842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Resendez <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225795842">(Feb 10 2021 at 05:24)</a>:</h4>
<p>Hi! Lurker here super interested in oauth, oidc, smart auth and fhir.  Implemented the fhir resource server and authorization server used in production by my company (an ehr vendor).   We've been looking at replacing our authorization infrastructure w/ something new (keycloak, gluu, okta, identityserver)</p>
<p>I'd really love the opportunity to tune in for the presentation... would that be okay?</p>



<a name="225842048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/225842048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#225842048">(Feb 10 2021 at 14:20)</a>:</h4>
<p>(I will answer for Dan because I happen to be reading this first.) Of course! that's why it's advertised here openly, to extend the invitation to everyone who is interested :-)</p>



<a name="226104627"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/226104627" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Harrison <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#226104627">(Feb 12 2021 at 07:19)</a>:</h4>
<p><span class="user-mention" data-user-id="308766">@Angus McAllister</span> Just in case you didn't notice this thread.<br>
<a href="#narrow/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz/near/225698418">https://chat.fhir.org/#narrow/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz/near/225698418</a></p>



<a name="226747496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/226747496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#226747496">(Feb 18 2021 at 00:06)</a>:</h4>
<p>Aw, I'm going to have to miss tomorrow morning's session (conflict that I can't move) but will look forward to watching  a recording if someone can make one. (My regrets, <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span> !)</p>



<a name="226749495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/226749495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#226749495">(Feb 18 2021 at 00:29)</a>:</h4>
<p>Shoot sorry to hear that but will definitely get a recording going!</p>



<a name="226856828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/226856828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#226856828">(Feb 18 2021 at 18:29)</a>:</h4>
<p>Thanks again <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span>  for the presentation this morning (and the work behind it)!  I was hoping to clarify / discuss a couple of points from it:</p>
<ul>
<li><em>Requiring</em> PKCE for clients means the implementation will not be SMART v1 compliant.<ul>
<li>One implication to keep in mind is for US customers and ONC patient-facing app requirements / certification (e.g., that won't pass).</li>
<li>Outside of that ruling, or as additional flows, this can and has been done (e.g., for a class of apps that aren't patient-facing).</li>
<li>I know that vendors have done this (feel free to chime in), but wanted to be clear on the limitations.</li>
</ul>
</li>
<li>This should/will* be different in SMART v2 (Coming Soon (tm)) (*: it is currently in the spec and has not been a point of contention - I'm leaving the 'should' because nothing is set in stone until publication).</li>
<li>Could you describe a bit more of the interaction between PKCE and refresh tokens (not allowing refresh tokens without PKCE / confidential client)?  AFAICT, this just prevents someone who snooped on the authorization code and was able to exchange for an access token from renewing it.  Is that correct, or am I missing something else?</li>
</ul>
<p>Also, my local recording did work.  It's via Jitsi, so your recording is likely better quality if it worked, but all the text appears readable and the audio came through clearly.  Please just let me know if you want/need it posted.</p>



<a name="226892471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/226892471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#226892471">(Feb 18 2021 at 22:20)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="222054">@Gino Canessa</span>! I did a quick gut check of my video, and it does look like it came through as well- I just wanted to do a little bit of cropping at the beginning and end and I'll post it before I begin the weekend. I'll let you know if I have issues though.</p>
<p>I appreciate the follow-up on the PKCE topic as well- I think your understanding there is accurate, in that both PKCE and confidential clients give us some confidence that the tokens actually wound up in the right hands (with confidential still being more secure if it's possible to be used).</p>
<p>So it has been Okta's stance that given the sensitivity of the refresh token that it's not something we're minting without the client falling into one of those 2 buckets (confidential, or public w/ PKCE).  </p>
<p>Part of my proxy architecture would allow me to bypass that requirement if needed, and it would do so by having the /token proxy performing client authentication on behalf of the public client that doesn't use PKCE (Okta wouldn't know it as a public client- it would know it as a confidential one).</p>



<a name="226906371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/226906371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venu Gopal <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#226906371">(Feb 19 2021 at 00:49)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span> for the presentation. I am implementing something similar for India. It isn't standard yet here, we are encouraged to learn from SMART (v1/v2) and are trying reference implementations. Most of the patient apps are mobile with a guidance to use PKCE. I have some questions for you. If these are answered before, please direct me there</p>
<p>1) Is there an introspection endpoint the FHIR resource server can access ?<br>
2) How would a device flow be ?<br>
3) How do you support opaque tokens ?<br>
4) Is there a plan to support EHR launch  ? <br>
Any guidance on "intent" of launch context is appreciated. For example, break the glass (BTG)/emergency access to a patient record without consent. I understand Audit security flag, but I am looking more in terms of how can a record be accessed ?  How can the requester be downscoped to access only that patient's record and not anything else, until the audit is on</p>
<p>Thanks again</p>



<a name="227023557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/227023557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#227023557">(Feb 19 2021 at 20:29)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="251824">@Venu Gopal</span> , welcome! (Sorry hit send too soon- i'll send response soon)</p>



<a name="227042894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/227042894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#227042894">(Feb 19 2021 at 22:58)</a>:</h4>
<p>1) Is there an introspection endpoint the FHIR resource server can access ?</p>
<p>Yep- there is an introspection endpoint that Okta offers out of the box that is called out in my metadata endpoints.</p>
<p>2) How would a device flow be ?</p>
<p>Can you clarify? Do you mean OAuth2 device code flow? Or machine to machine client credential flow?</p>
<p>3) How do you support opaque tokens ?</p>
<p>I'm not- I'm always using JSON web tokens.</p>
<p>4) Is there a plan to support EHR launch ?</p>
<p>Not at this time- I've given it some thought on how I might do it, so if there's big demand in the future I might take that leap.</p>
<p>Any guidance on "intent" of launch context is appreciated. For example, break the glass (BTG)/emergency access to a patient record without consent. I understand Audit security flag, but I am looking more in terms of how can a record be accessed ? How can the requester be downscoped to access only that patient's record and not anything else, until the audit is on</p>
<p>I have a feeling I'm not going to provide you with a sufficient answer right out of the gate, but here goes my first attempt (and maybe others with far more experience can jump in!):<br>
So in general, any of the launch response parameters, by themselves, are purely meant as "hints" to the application- and by themselves are not security enforcement.<br>
The "patient" response is special though, in that it does inform the application what patient the access token has access to- but it's still just a hint, the application can choose to ignore it (but won't be very useful if it does ignore it). <br>
The resource server is still responsible for introspecting the token, and furthermore checking/enforcing what "records" it can access. Exactly how that is determined is left to the implementation.<br>
In my particular implementation, since I'm using signed JWTs for my access tokens, I am also including the selected patient id as a claim within the access token, so it will be easy for the resource server to determine what patient the token is scoped to during the introspection process.<br>
For the intent response in particular, seems like it can be anything you want, and so I'd think to derive any value from that at all, the organization hosting the resource and authorization server would need to publish what their authorization server might send for it, so application developers can account for it in their applications.</p>



<a name="227271735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/227271735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alan Viars <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#227271735">(Feb 22 2021 at 14:14)</a>:</h4>
<p><span class="user-mention" data-user-id="361257">@Dan Cinnamon</span>  Can you share the recording?</p>



<a name="227271807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/227271807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alan Viars <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#227271807">(Feb 22 2021 at 14:14)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>   Yes please add me to the SMART Health Cards thing.</p>



<a name="227275433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/227275433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#227275433">(Feb 22 2021 at 14:36)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="391350">@Alan Viars</span>, definitely will.  I'm working with <span class="user-mention" data-user-id="222054">@Gino Canessa</span>  to see which of our recordings will be best to share.  I found out on Friday that my recording only has my audio in it (so the conversations are very one sided- ha).  So if Gino's recording is better, I'm hoping we can use his, otherwise mine is better than nothing and I'll share it!</p>



<a name="227511063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/227511063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#227511063">(Feb 23 2021 at 22:00)</a>:</h4>
<p>Hi all, <a href="https://openaccessvideos.blob.core.windows.net/openaccessvideos/20210218-SMART-Okta-720p.mp4">here</a> is a link to the recording of Dan's presentation I have.  I'll apologize that it doesn't have audio of me speaking (discovered a mic configuration issue), but on the balance I didn't say much =).</p>
<p>Cheers,<br>
-Gino</p>
<p>(tags for people I've seen ask: <span class="user-mention" data-user-id="391350">@Alan Viars</span> <span class="user-mention" data-user-id="191315">@Josh Mandel</span> <span class="user-mention" data-user-id="251824">@Venu Gopal</span> )</p>



<a name="228189932"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/228189932" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venu Gopal <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#228189932">(Mar 01 2021 at 07:17)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span> no problems. Thank you for your message and responses</p>
<p>The question on device flow - I was interested in device flow as there mayn't be an option to key in login information. For example a patient may be equipped with a IoT device (a glucometer) and sync with patient's mobile app. The glucometer may have to post Observations at frequent time intervals to the app. How would the device authenticate with the patient app ? Or would that be M2M ? I am not an expert of M2M. So if you can offer some insights that would be of help</p>



<a name="228245210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/228245210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Cinnamon <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#228245210">(Mar 01 2021 at 15:03)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="251824">@Venu Gopal</span>,</p>
<p>I see- so the device code flow is great in use cases where a headless device (or at least input limited device), has the ability to directly communicate with an API from your service. One of the best examples of this would be a smart TV- authenticating with your streaming service in a user friendly way by allowing the user to perform the actual login with a computer/mobile device rather than typing with their TV remote on a virtual keyboard. At the end of the device code flow process, the IoT device actually has OAuth tokens in hand that it can use for subsequent authorization directly to an API.</p>
<p>A few considerations on that though:<br>
1- For device code flow, the device does at least need to display a code to the user- perhaps 8 characters or so.  Will your device have any display at all? Even an old LCD panel like you might find on a 30 year old wrist watch will do- but it does require something.</p>
<p>2- Also in device code flow, the device does need to communicate directly with the authorization service to obtain tokens and make API calls.</p>
<p>I haven't designed a system like this personally, so please just take this as initial thoughts- but I think you should first start with who the actual OAuth2 client is (who/what is actually calling the FHIR API).  From your description, it sounds to me like perhaps your mobile app is the actual OAuth2 client to the FHIR API, and so the mobile app is the one that would do the SMART flow.</p>



<a name="229152770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/229152770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venu Gopal <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#229152770">(Mar 07 2021 at 03:44)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="361257">@Dan Cinnamon</span> you are right. I asked if more as a forward looking one. As of now the plan is to connect bluetooth enabled devices connect via the mobile app. Thank you so much for the insights</p>



<a name="242875608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Keycloak%20for%20SMART%20authz/near/242875608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz.html#242875608">(Jun 16 2021 at 12:55)</a>:</h4>
<p>A long while back, I took a TODO to open up some Keycloak extensions that we were using in support of SMART App Launch.  I did that a few months ago but never got around to announcing it here.  If you are interested in SMART support for Keycloak, please have a look and let me know what you think:  <a href="https://github.com/Alvearie/keycloak-extensions-for-fhir">https://github.com/Alvearie/keycloak-extensions-for-fhir</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
