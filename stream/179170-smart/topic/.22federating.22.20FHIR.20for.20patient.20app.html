---
layout: page
title: "FHIR Chat  · &quot;federating&quot; FHIR for patient app · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html">&quot;federating&quot; FHIR for patient app</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="193576182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193576182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193576182">(Apr 10 2020 at 14:44)</a>:</h4>
<p>I'm trying to reason through the architecture that Josh proposed a few years ago for patient apps being able to access imaging data directly from a proposed PACS FHIR server re-using the EHR auth server. This <a href="https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g595633b9aa_18_6" title="https://docs.google.com/presentation/d/1CqRCrNB17XXzeff0guDo1inM-gdy2k0aBc16OcdZKHM/present?slide=id.g595633b9aa_18_6">slidedeck</a> defines three mechanisms:<br>
<del>1. Don't have two FHIR servers, instead interface all the imaging data into the EHR</del><br>
<del>2. Clinical FHIR server proxies API requests for imaging data -- kind of an API Manager-type approach and a fairly tight integration</del></p>
<ol start="3">
<li>Shared authorization, but two distinct FHIR servers &amp; the PACS server is responsible for introspected the access token for each request.</li>
</ol>



<a name="193576200"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193576200" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193576200">(Apr 10 2020 at 14:45)</a>:</h4>
<p>For #3, the use of introspect by the 2nd RS is a great start. For an MVP --</p>
<p>As part of an EHR launch, the app gets an iss and an iss2, both /metadata point to the auth server. </p>
<p>For both standalone and EHR launch, the AS would need to tell the app two patient FHIR identifiers as urls. How should the app know of the second RS?</p>



<a name="193580182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193580182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikolai Schwertner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193580182">(Apr 10 2020 at 15:17)</a>:</h4>
<p>In our apps, the secondary FHIR endpoints the app might want to connect to (beyond the primary it was launched against ) are configuration settings for the app. I imagine these endpoints could also be disseminated via the FHIR server capabilities  statement, the SMART well-known endpoint, or even the OAUTH access token claims. Not sure which one would be ideal however.</p>



<a name="193580575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193580575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikolai Schwertner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193580575">(Apr 10 2020 at 15:21)</a>:</h4>
<p>As for the patient identifiers across federated servers, it would be ideal if they are in sync (i.e. identical). May not be realistic though without a national or even global unique patient identifier.</p>



<a name="193584760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193584760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193584760">(Apr 10 2020 at 15:56)</a>:</h4>
<p>Thanks, Nikolai! In cases where the patient ids are not the same, does the app simply perform demographics queries on the second RS following the launch?</p>



<a name="193586478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193586478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikolai Schwertner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193586478">(Apr 10 2020 at 16:11)</a>:</h4>
<p>That would be one approach, but it has two problems that come to mind: 1. The app would need to be granted user/system level read scope on the Patient resource to be able to query the demographics (which is bad from security perspective in the general case). 2. Demographics searches are not guaranteed to always produce a match even if one exists (with imperfect data) and there is always a possibility of getting multiple matches.</p>



<a name="193587575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193587575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikolai Schwertner <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193587575">(Apr 10 2020 at 16:21)</a>:</h4>
<p>Probably would be reasonable to expect that the mechanism that provides the secondary RS endpoint also provides a patient identifier for the secondary RS (if known)? In other words, ideally federation should involve some shared knowledge about patient identifier translations.</p>



<a name="193589840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193589840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193589840">(Apr 10 2020 at 16:42)</a>:</h4>
<p>yup, I think you're spot on, Nikolai. So, the patient identifier of the 2nd RS could be made available to the app either:</p>
<ol>
<li>as an additional business identifier on the Patient resource of the 1st RS</li>
<li>as an additional <code>patient</code> launch parameter alongside the access token. </li>
</ol>
<p>The problem with #2 is, for <em>nth</em> RS, associating the right patient id with the right RS. For #1, the patient id could have a codesystem of the nth RS's FHIR base url, or something like that.</p>



<a name="193591621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193591621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193591621">(Apr 10 2020 at 16:59)</a>:</h4>
<p>For the architecture we built in Sync for Science,the idea was that an imaging server would 1) rely on an EHR's authorization server and 2) rely on an EHR's patient identifiers for mapping to data in its on FHIR API</p>
<p>together this -- helps shield app developers from the complexity of mapping IDs.</p>



<a name="193591795"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193591795" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193591795">(Apr 10 2020 at 17:00)</a>:</h4>
<p>Are there circumstances where (1) would apply and (2) would not? How would access controls be enforced by these two servers without a common understanding of patient IDs?</p>



<a name="193592087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193592087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193592087">(Apr 10 2020 at 17:02)</a>:</h4>
<p>I guess the distinction is if the EHR needs to "know" the PACS patient ids, or if only the PACS needs to "know" the EHR's patient ids. (Obvious in hindsight, the PACS must understand the EHR patient ids to enact access control following the introspect call).</p>



<a name="193592182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193592182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193592182">(Apr 10 2020 at 17:03)</a>:</h4>
<p>The latter. Assumption is that PACS can look up patient ID at least for the patient associated with a specific access token / query.</p>



<a name="193592262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193592262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193592262">(Apr 10 2020 at 17:04)</a>:</h4>
<p>agreed, thank you Josh, Nikolai!</p>



<a name="193592265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193592265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193592265">(Apr 10 2020 at 17:04)</a>:</h4>
<p>And then building on that assumption: if the PACS FHIR server does "GET /Patient/123" from the EHR (or the EHR pre-supplies as part of the introspection response), there will be enough <code>Patient.identifier</code>s there, or other demographics, for the PACS to find a match to something it understands/tracks internally.</p>



<a name="193592368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193592368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193592368">(Apr 10 2020 at 17:05)</a>:</h4>
<p>(and patient identity, even within an enterprise is complicated)</p>



<a name="193598326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193598326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193598326">(Apr 10 2020 at 17:57)</a>:</h4>
<p><del>How does the PACS FHIR server get the FHIR Patient ID to GET?  Unless it is supplied via introspect, wouldn't it have to be supplied by the 3rd party app (and thus not be trustworthy)?  Unless I'm missing something, I'd think the mapping between patients would have to be handled via introspect.</del></p>



<a name="193598653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193598653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193598653">(Apr 10 2020 at 17:59)</a>:</h4>
<p>Nevermind.  If the PACS FHIR server is using the app-supplied access token when doing the GET to the EHR server, then the EHR server would reject requests for a patient that is not allowed by the access token.</p>



<a name="193598862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/%22federating%22%20FHIR%20for%20patient%20app/near/193598862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/.22federating.22.20FHIR.20for.20patient.20app.html#193598862">(Apr 10 2020 at 18:01)</a>:</h4>
<p>Yeah, that's exactly what our PoC implementation did.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
