---
layout: page
title: "FHIR Chat  · system + patient scopes · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html">system + patient scopes</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="177102264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177102264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Bonistalli <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177102264">(Oct 01 2019 at 22:07)</a>:</h4>
<p>Good evening everyone,</p>
<p>We have a patient-facing app that collects patient entered data and relies on the EMR to manage identities. Therefore we need patient/* scopes and we need the authorization code grant type for identity reasons. Except, we also wish to post a monthly summary report note back to the EMR, and hit a roadblock since most EMRs do not accept patient/DocumentReference.write nor (IMO) should they.</p>
<p>The right solution here is probably to create a secondary app with its own client ID and register this secondary app with a single system-level scope (system/DocumentReference.write) and use its credentials to write back notes. Keeping the system/* scopes and the patient/* scopes separate in each app.</p>
<p>Or is it? Wanted to see if incorporating system scopes and patient scopes in the same application is lunacy :)</p>



<a name="177102730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177102730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177102730">(Oct 01 2019 at 22:14)</a>:</h4>
<blockquote>
<p>if incorporating system scopes and patient scopes in the same application is lunacy</p>
</blockquote>
<p>I don't see why you want a system level scope. Why not patient/DocumentReference.write?</p>



<a name="177102740"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177102740" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177102740">(Oct 01 2019 at 22:14)</a>:</h4>
<p>how is system level better than patient level?</p>



<a name="177150822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177150822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177150822">(Oct 02 2019 at 13:42)</a>:</h4>
<p>One clarification: patient/DocumentReference.write doesn't mean that the patient is the user creating the document. It just means the token is scoped to a specific patient that was chosen at launch. Do you mean that most systems don't accept DocumentReferences that are authored by the patient themselves? If so, that's likely true. However, I question if that is what is going on here.</p>



<a name="177150920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177150920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177150920">(Oct 02 2019 at 13:43)</a>:</h4>
<p>Where is that DocumentReference coming from?</p>



<a name="177179545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177179545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Bonistalli <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177179545">(Oct 02 2019 at 18:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> We would prefer patient/DocumentReference.write, but have seen it not supported in some EHRs in their FHIR platforms. I think they are wary of including patient entered data in their EMR w/o clinician validation (understandable).<br>
<span class="user-mention" data-user-id="191356">@Jenni Syed</span> patient facing apps in Cerner aren't supporting any write scopes which means that an app that wishes to write back to the EMR may need to rely on some kind of system level access to post back a summary note.</p>



<a name="177181037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177181037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177181037">(Oct 02 2019 at 18:56)</a>:</h4>
<p>Right. But there's a difference between not allowing "patient entered data" (when the patient is authenticated) and not allowing patient/DocumentReference.write (which we do allow - when the <em>practitioner</em> is authenticated and providing the data).</p>



<a name="177181117"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177181117" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177181117">(Oct 02 2019 at 18:57)</a>:</h4>
<p>Who created the clinical note that is being sent back to the system? Did the patient themselves actually create it (eg: is it just a journal of something going on)?</p>



<a name="177190448"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177190448" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Bonistalli <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177190448">(Oct 02 2019 at 20:40)</a>:</h4>
<p>Patient enrolls for a study in which they enter some patient sourced data on a daily or weekly basis. Hospital systems are desiring that either A: scheduled summaries to be posted to the EHR or B: summaries to be posted to the EHR when the patient completes an action such as completing a pain score survey.</p>
<p>No practitioners are ever authenticated in this app. This is the root of the issue IMO - getting data into the EHR w/o practitioners needing to authenticate themselves and perform some action that triggers posting the note or observation.</p>
<p>My understanding is this is a case where introducing an additional system-level app might make sense because the note is not explicitly created by the patient or the clinician - it is generated by the application. I think this conversation answers my original question; it doesn't make sense to include system level scopes and patient level scopes within the same app, and instead these functions could be handled by two separate apps with separate scope levels.</p>



<a name="177191284"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177191284" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177191284">(Oct 02 2019 at 20:50)</a>:</h4>
<p>I think you are confusing different issues. a patient scope grants access to a particular patient record to some known user. Whether the source of any data being uploaded is the patient, a device, or some 3rd party, that's not related to the scope, it's a provenance issue</p>
<p>A system level scope grants access to the entire system, to upload documents for any patient (though a system typically will have additional permissions control)</p>
<p>I think that you want patient level access, and you want a further discussion with the vendors about provenance and permissions, which is not something that the scopes are baout</p>



<a name="177195142"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177195142" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Bonistalli <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177195142">(Oct 02 2019 at 21:41)</a>:</h4>
<p>Agreed - it's ultimately a permissions issue with the vendors and falls outside the bounds of scopes and probably this discussion stream. I imagine the use case is not unique and there may be other patient facing apps that need EHR write-back permissions for whatever reasons. Thanks!</p>



<a name="177195208"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177195208" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177195208">(Oct 02 2019 at 21:42)</a>:</h4>
<p>I actually question, from a security perspective, why the study system would be writing back data on behalf of the patient. Does this mean the system is passing around and storing bearer tokens per patient long term?</p>



<a name="177195242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177195242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177195242">(Oct 02 2019 at 21:42)</a>:</h4>
<p>Typically we try to isolate bearer tokens by use case, and if the systems are separate architectures, to isolate them to the purposes they have</p>



<a name="177195268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177195268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177195268">(Oct 02 2019 at 21:43)</a>:</h4>
<p>The questionaire side seems to be more like patient contributed data, and actually tied to the patient's session</p>



<a name="177195356"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177195356" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177195356">(Oct 02 2019 at 21:44)</a>:</h4>
<p>Other data that is produced by the study itself seems like a separate use case and could be contributed back directly by the study system itself</p>



<a name="177195567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177195567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Bonistalli <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177195567">(Oct 02 2019 at 21:46)</a>:</h4>
<p>Agreed on all accounts. Data produced by the study could be aggregated and pushed by the study system functioning as a system level application, isolating this bearer token from any patient-facing use case.<br>
And questionnaire info would be patient contributed data and probably should be posted using the patient's session and bearer token. This use case is tough as bearer tokens issued to patients don't have write permissions for most EHRs (I could be totally mistaken though as my source of information is external facing EHR documentation).</p>



<a name="177195636"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177195636" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177195636">(Oct 02 2019 at 21:47)</a>:</h4>
<p>Yes, that is a gap today :) I know it's one there's also interest in closing.</p>



<a name="177196308"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177196308" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Bonistalli <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177196308">(Oct 02 2019 at 21:56)</a>:</h4>
<p>It's an interesting discussion, the health systems we build FHIR apps for usually want some kind of write-back to the EHR; it fundamentally is the source of truth. But the .write scopes are quite broad and granting third party apps the freedom to let users write note after note after note comes with risk for the EHR.</p>



<a name="177196377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177196377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Bonistalli <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177196377">(Oct 02 2019 at 21:57)</a>:</h4>
<p>It'd be awesome to close that gap :) but I understand why it's not that simple</p>



<a name="177196798"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177196798" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177196798">(Oct 02 2019 at 22:01)</a>:</h4>
<p>I don't think that scopes are the question here. the scope is a authorization discussion between the record keeper, the application, and the user around what access <em>the user</em> wants to grant to the application. The discussion between the application and the record keeper is a different discussion that isn't limited to scopes and we shouldn't try and solve it with scopes</p>



<a name="177197112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197112">(Oct 02 2019 at 22:04)</a>:</h4>
<p>Sure, but when a patient authorizes an app to do something, they're authorizing the app to do it on behalf of them</p>



<a name="177197135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197135">(Oct 02 2019 at 22:04)</a>:</h4>
<p>They don't have the authority to authorize the app to do things as a clinical user</p>



<a name="177197174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197174">(Oct 02 2019 at 22:04)</a>:</h4>
<p>A practitioner doesn't typically authorize an app to act on their behalf (their system admin determines if that is an ok thing) - though there are exceptions</p>



<a name="177197190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197190">(Oct 02 2019 at 22:05)</a>:</h4>
<p>of course. a user can only authorise an application to do things that the record keeper is going to allow them to do (well, I mean, they can authorise more but that won't mean it's possible)</p>



<a name="177197204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197204">(Oct 02 2019 at 22:05)</a>:</h4>
<p>Which means the app can have no more privs beyond the original authorizer</p>



<a name="177197215"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197215" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197215">(Oct 02 2019 at 22:05)</a>:</h4>
<p>typically</p>



<a name="177197240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197240">(Oct 02 2019 at 22:05)</a>:</h4>
<p>(otherwise, in a web world, the user could likely just do it  - without requiring server sides and signed bodies, etc)</p>



<a name="177197308"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197308" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197308">(Oct 02 2019 at 22:06)</a>:</h4>
<p>I don't think he wants the <em>clinical</em> doc to follow the path we would follow if a patient handed us the same doc</p>



<a name="177197316"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197316" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197316">(Oct 02 2019 at 22:06)</a>:</h4>
<p>from a trust and validation perspective</p>



<a name="177197369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197369">(Oct 02 2019 at 22:07)</a>:</h4>
<p>indeed. but again, this is not a scope related issue</p>



<a name="177197376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197376">(Oct 02 2019 at 22:07)</a>:</h4>
<p>correct</p>



<a name="177197481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197481">(Oct 02 2019 at 22:08)</a>:</h4>
<p>Though an unfortunate side effect of doing B2B auth in SMART <em>is</em> that the system scopes are used. Which is confusing, and does cause a lot of this intermingling</p>



<a name="177197499"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197499" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197499">(Oct 02 2019 at 22:08)</a>:</h4>
<p>because the patient/ and user/ scopes just are tied to any "on behalf of any user" workflow</p>



<a name="177197518"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197518" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197518">(Oct 02 2019 at 22:08)</a>:</h4>
<p>So I can see where the confusion comes from</p>



<a name="177197556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177197556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177197556">(Oct 02 2019 at 22:09)</a>:</h4>
<p>y. on the system interface something totally different is required, but it's at app registration time.</p>



<a name="177198552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177198552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177198552">(Oct 02 2019 at 22:24)</a>:</h4>
<p>This has confused me, as I agree the app context can't have more rights than the user. So I have often wondered what the use of patient scope was.</p>



<a name="177198891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177198891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177198891">(Oct 02 2019 at 22:31)</a>:</h4>
<p>triggers a different pathway on the AS</p>



<a name="177203260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177203260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177203260">(Oct 02 2019 at 23:44)</a>:</h4>
<p>I heard the phrase "foreground SMART" yesterday used to make the distinction between b2b/backend/system/client_credentials and auth code/provider/patient-authorized. </p>
<p>I thought it was an interesting (and useful) term.</p>



<a name="177262902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177262902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177262902">(Oct 03 2019 at 16:45)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span>  the patient scopes limit that bearer token to a specific patient that was chosen at launch or before launch</p>



<a name="177262918"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177262918" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177262918">(Oct 03 2019 at 16:45)</a>:</h4>
<p>So even if the user can access 10,000 patients, the app can only access 1 of those</p>



<a name="177263890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177263890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177263890">(Oct 03 2019 at 16:56)</a>:</h4>
<p>as a security person, I would prefer that the specific <a href="http://Patient.id" target="_blank" title="http://Patient.id">Patient.id</a> be included in the token. seems improper security to assume that the launch context is  a security resource</p>



<a name="177264791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177264791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177264791">(Oct 03 2019 at 17:05)</a>:</h4>
<p>In our implementation, it is, but token and how resources interact with the auth server are outside the scope of standards. The launch is just how that patient id gets chosen/the app requests it.</p>



<a name="177264839"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177264839" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177264839">(Oct 03 2019 at 17:05)</a>:</h4>
<p>Other servers could choose to communicate token restrictions/scopes/etc in a different way and still enforce what is needed.</p>



<a name="177267174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177267174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177267174">(Oct 03 2019 at 17:31)</a>:</h4>
<blockquote>
<p>as a security person, I would prefer that the specific <a href="http://Patient.id" target="_blank" title="http://Patient.id">Patient.id</a> be included in the token. seems improper security to assume that the launch context is a security resource</p>
</blockquote>
<p>The token is <em>bound to</em> the patient ID in this case -- but the token itself is opaque the the client, so this information needs to be communicated in some standard way (either a launch context parameter that comes next to the token, or through a context resolution API call, like token introspection)</p>



<a name="177279643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177279643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177279643">(Oct 03 2019 at 19:42)</a>:</h4>
<p>at the moment the only way I know to do this is search patient, to see what you have access to</p>



<a name="177280185"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177280185" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177280185">(Oct 03 2019 at 19:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> are you talking about if it's a user level scope and NOT constrained to a single patient?</p>



<a name="177280340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177280340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177280340">(Oct 03 2019 at 19:49)</a>:</h4>
<p>or for the app to choose the patient in order to fulfill the launch/patient (or launch) that is required for a patient level scope?</p>



<a name="177281106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177281106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177281106">(Oct 03 2019 at 19:56)</a>:</h4>
<p>no for the app to find out what patient it's actually dealing with with a patient level scope</p>



<a name="177281341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177281341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177281341">(Oct 03 2019 at 19:58)</a>:</h4>
<p>Inspecting the launch context is the main way, right now (if you did a <em>single-patient</em> launch).</p>



<a name="177289354"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177289354" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177289354">(Oct 03 2019 at 21:19)</a>:</h4>
<p>what about stand-alone launch, which seems to me the more likely thing for patient/ access?</p>



<a name="177289827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177289827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177289827">(Oct 03 2019 at 21:25)</a>:</h4>
<p>Use launch/patient, get back id in token response</p>



<a name="177290165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177290165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177290165">(Oct 03 2019 at 21:29)</a>:</h4>
<p>it's always in the returned launch context to the app when a patient (or encounter) is requested</p>



<a name="177290230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177290230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177290230">(Oct 03 2019 at 21:30)</a>:</h4>
<p>our auth server errors if you use patient scopes and don't request the patient (via launch or launch/patient)</p>



<a name="177290279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177290279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177290279">(Oct 03 2019 at 21:31)</a>:</h4>
<blockquote>
<p>our auth server errors if you use patient scopes and don't request the patient</p>
</blockquote>
<p>how do you connect if you don't know the patient id - depend on the patient to identify themselves ?</p>



<a name="177292801"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177292801" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177292801">(Oct 03 2019 at 22:01)</a>:</h4>
<p>The patient has to login to authorize the app - then it picks up the patient if there are more than one he can access to (dependents etc) - and that is returned to the app and becomes the patient-in-context</p>



<a name="177293116"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177293116" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177293116">(Oct 03 2019 at 22:06)</a>:</h4>
<p>but that's not consistent with </p>
<blockquote>
<p>our auth server errors if you use patient scopes and don't request the patient</p>
</blockquote>



<a name="177293516"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177293516" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177293516">(Oct 03 2019 at 22:11)</a>:</h4>
<p>? If the app does request patient scopes and do not specify launch/patient the auth server will complain, otherwise everything works</p>



<a name="177293606"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177293606" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177293606">(Oct 03 2019 at 22:12)</a>:</h4>
<p>'pick up the patient' happens as part of the auth sequence, not via FHIR calls - if that's what you are asking</p>



<a name="177294269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177294269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177294269">(Oct 03 2019 at 22:22)</a>:</h4>
<p>I think I might have misunderstood </p>
<blockquote>
<p>don't request the patient</p>
</blockquote>



<a name="177351278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177351278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177351278">(Oct 04 2019 at 15:42)</a>:</h4>
<p>yeah, by "don't request the patient" I mean the app doesn't include the request for the SMART launch or launch/patient scopes (which drive a patient being chosen via the auth process/launch process before the token is issued)</p>



<a name="177351305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177351305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177351305">(Oct 04 2019 at 15:42)</a>:</h4>
<p>If it's "launch" - in our system, the patient would have been chosen before the app is launched. EG: in our native chart</p>



<a name="177351338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/system%20%2B%20patient%20scopes/near/177351338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/system.20.2B.20patient.20scopes.html#177351338">(Oct 04 2019 at 15:43)</a>:</h4>
<p>If it's launch/patient, our authorization server will require the selection of the patient <em>during</em> the authorization process (the app itself is not involved in this, the auth server does this workflow)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
