---
layout: page
title: "FHIR Chat  · SMART on FHIR with Document Bundles · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html">SMART on FHIR with Document Bundles</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="252372475"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252372475" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252372475">(Sep 07 2021 at 21:10)</a>:</h4>
<p>US Core has a DocumentReference profile which mentions that the server can support content.url which may be a reference to a document Bundle on the server. Using SMART on FHIR, how are server systems connecting a document bundle with a particular patient to make sure an authenticated patient gets access to their and only their Bundle resources?</p>



<a name="252373148"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252373148" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252373148">(Sep 07 2021 at 21:15)</a>:</h4>
<p>presumably that is a local authorization problem to be handled on the server.. There are mechanisms where the Binary can be found in the DocumentReference, and thus given the same access needs as the DocumentReference. There is also a Binary.securityContext that can explicitly point at the DocumentReference. And there is also the <a href="http://Binary.meta.security">Binary.meta.security</a> tags that could be used.... BUT all that said, it seems this is a problem for the server and the policies the server is expected to enforce to address.</p>



<a name="252374309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252374309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252374309">(Sep 07 2021 at 21:26)</a>:</h4>
<p>OK, So there is not a common means that servers are using to support this? Is this something that should be raised or defined in IGs or should it be left up to the implementations? I am curious how US Core implementers are managing this today. </p>
<p>Thought I would ask here before asking the implementers stream. Any implementers or other here that can share their experience?</p>



<a name="252385373"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252385373" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252385373">(Sep 07 2021 at 23:25)</a>:</h4>
<p>Never saw a server returning a FHIR Bundle there - usually is a C-CDA</p>



<a name="252392455"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252392455" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252392455">(Sep 08 2021 at 01:03)</a>:</h4>
<p>So would that be encoded in the DocumentReference resource in <code>content.attachement.data</code> or a <code>content.attachment.url</code> pointer to a Binary? If the latter, I would also like to know how that is handled as I think it would apply similarly to a document Bundle.</p>



<a name="252448932"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252448932" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252448932">(Sep 08 2021 at 12:12)</a>:</h4>
<p>I think I always saw pointer to Binary (our server can do either). We just do a GET with an accept header equal to the declared mime type and then store the result.</p>



<a name="252541278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252541278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Priya Mathew <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252541278">(Sep 08 2021 at 22:09)</a>:</h4>
<p>We're in the same boat, trying to figure out how we implement documentreference - I'll repeat the original question. Using SMART on FHIR, how are server systems connecting a document bundle with a particular patient to make sure an authenticated patient gets access to their and only their documents?</p>



<a name="252556244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252556244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252556244">(Sep 09 2021 at 01:03)</a>:</h4>
<p>This is below the abstraction barrier for SMART (how does a server maintain any access controls)? </p>
<p>(If you're using FHIR Binary internally, see <a href="http://build.fhir.org/binary-definitions.html#Binary.securityContext">http://build.fhir.org/binary-definitions.html#Binary.securityContext</a>)</p>



<a name="252615372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252615372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252615372">(Sep 09 2021 at 12:20)</a>:</h4>
<p>In IHE MHD implementation guide it is defined as using content.attachment.url ONLY, and that points at a Binary.</p>



<a name="252615532"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252615532" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252615532">(Sep 09 2021 at 12:22)</a>:</h4>
<p>http negotiation is allowed to enable the client to indicate they can handle CDA mime-type and thus they get the CDA xml not enclosed in a Binary.    Like specified in the FHIR Binary spec - <a href="http://hl7.org/fhir/binary.html#rest">http://hl7.org/fhir/binary.html#rest</a></p>



<a name="252615783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252615783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252615783">(Sep 09 2021 at 12:23)</a>:</h4>
<p>Binary.securityContext should not be needed. Yes one can move from Binary to the DocumentReference using this, but one can also do the very same by looking for the DocumentReference with an attachment.url that is the Binary id.  Having dual pointers is not recommended.</p>



<a name="252616114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252616114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252616114">(Sep 09 2021 at 12:25)</a>:</h4>
<p>however if your server wants to use Binary.securityContext... it certainly can. My point is that given your use-case, it should not be necessary.</p>



<a name="252616237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252616237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252616237">(Sep 09 2021 at 12:26)</a>:</h4>
<p>also, not uncommon for these documents to be simply served as URL endpoints.. not necessarily FHIR REST.</p>



<a name="252619194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252619194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252619194">(Sep 09 2021 at 12:49)</a>:</h4>
<blockquote>
<p>also, not uncommon for these documents to be simply served as URL endpoints.. not necessarily FHIR REST.</p>
</blockquote>
<p>Still with the same authz scheme though (otherwise you need a way to tell clients which seem to follow).</p>



<a name="252619378"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252619378" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252619378">(Sep 09 2021 at 12:50)</a>:</h4>
<p>yes, covered by the same OAuth service.</p>



<a name="252660795"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252660795" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Priya Mathew <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252660795">(Sep 09 2021 at 17:08)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191315">@Josh Mandel</span> . You've helped resolve the binary resource retrieval questions I had. I think our use case is different from Corey's. Let me start a new thread with our workflow.</p>



<a name="252667843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252667843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nancy Lush <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252667843">(Sep 09 2021 at 17:57)</a>:</h4>
<p>Staying with Corey's original question, we will rephrase again for clarity:  When a smart app is running in patient context, the user access is limited to the patient compartment.  In the ADI IG, there is a DocumentReference referencing a Bundle.  But the Bundle resource is not included in the patient compartment so the patient does not have access to it. The content of this bundle is FHIR resources, not CDAs as might be the case for a binary.</p>



<a name="252668226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252668226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252668226">(Sep 09 2021 at 18:00)</a>:</h4>
<p>I think that is a manufactured problem through the overly constrained view of the Patient Compartment.</p>



<a name="252668441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252668441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252668441">(Sep 09 2021 at 18:01)</a>:</h4>
<p>which that view of Patient Compartment would never be acceptable in a Privacy Policy as it does not recognize that there are many data that don't explicitly have a .patient/.subject element that are actually patient specific.</p>



<a name="252668805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252668805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252668805">(Sep 09 2021 at 18:03)</a>:</h4>
<p>see <a href="http://hl7.org/fhir/compartmentdefinition.html">http://hl7.org/fhir/compartmentdefinition.html</a></p>



<a name="252668832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252668832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252668832">(Sep 09 2021 at 18:03)</a>:</h4>
<blockquote>
<p>The patient compartment includes any resources where the subject of the resource is the patient, and some other resources that are directly linked to resources in the patient compartment</p>
</blockquote>



<a name="252669026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252669026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252669026">(Sep 09 2021 at 18:05)</a>:</h4>
<p>I can offer that this is true not just of Binary and Bundle, but also AuditEvent, Provenance, possibly others.</p>



<a name="252669109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252669109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252669109">(Sep 09 2021 at 18:05)</a>:</h4>
<p>also see <a href="http://hl7.org/fhir/security.html#SecPrivConsiderations">http://hl7.org/fhir/security.html#SecPrivConsiderations</a></p>



<a name="252674050"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/SMART%20on%20FHIR%20with%20Document%20Bundles/near/252674050" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/SMART.20on.20FHIR.20with.20Document.20Bundles.html#252674050">(Sep 09 2021 at 18:36)</a>:</h4>
<p>Also, in the generic SMART app, the user may NOT have access to the full patient compartment.  If the user is a parent access the chart of their teen daughter, then data in the patient compartment like pregnancy and STD test results, sexual history, etc. should not be available to the user.</p>
<p>Even if the user is the patient accessing their own chart, there might be reasons why content in the patient compartment should not be shown (e.g. a provider has individually reviewed a note or lab result as posing potential for self harm and has flagged it to be withheld).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
