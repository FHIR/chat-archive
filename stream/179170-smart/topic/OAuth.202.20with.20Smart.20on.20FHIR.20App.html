---
layout: page
title: "FHIR Chat  · OAuth 2 with Smart on FHIR App · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html">OAuth 2 with Smart on FHIR App</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="210879841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/210879841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#210879841">(Sep 22 2020 at 14:42)</a>:</h4>
<p>As I read through documentation, I see that we may need to support "patient" and "encounter" context information in the access token response. and the patient level scope applies to that patient. In view of that, as per SMART on FHIR, do we need to present patient (also encounter, if supported) field as a separate field other than access_token, refresh_token , scope fields in response to  OAuth token endpoint response? Can it not be put as a claim as part of access_token field itself?</p>



<a name="210880074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/210880074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#210880074">(Sep 22 2020 at 14:44)</a>:</h4>
<p>The "access token response" is the JSON payload that the authorization server returns to the client. In that response is an access token (opaque to the client) and other launch context properties like "patient" which are intended for the client to read and use.</p>



<a name="210880206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/210880206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#210880206">(Sep 22 2020 at 14:45)</a>:</h4>
<p>Because the access token itself is opaque to the client, it might just be a random number or database key; SMART can't (and so doesn't) try to specify anything about contents or "claims" inside the token (string) itself.</p>



<a name="210881698"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/210881698" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#210881698">(Sep 22 2020 at 14:55)</a>:</h4>
<p>Thanks for clarifying. So that means in general, we may have to provide this additional capability on top of Auth server (Keycloak, Okta, Ory Hydra, etc. which is being used) in order to support additional fields in the access token response, as none of the tools to my knowledge supports this out of the box.<br>
Is that a correct understanding?</p>



<a name="210883021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/210883021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#210883021">(Sep 22 2020 at 15:02)</a>:</h4>
<p>And once EHR launch is done and 3rd party App displays the relevant patient information, can the access token used in that flow be used to access other patient's data as well Or does that have to be restricted only for that patient which was returned as part of access token response?</p>



<a name="211012150"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/211012150" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#211012150">(Sep 23 2020 at 14:35)</a>:</h4>
<p>Yes the functionality needs to be implemented inside your authorization server. The scope of access for a given token will depend on what has been approved, as well as on the underlying permissions of the user doing the approving. For scopes like <code>patient/Condition.read</code>, these would be limited to a single patient; for scopes like <code>user/Condition.read</code>, these would provide access to any patients that the approving user has access to</p>



<a name="211029033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/211029033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#211029033">(Sep 23 2020 at 16:36)</a>:</h4>
<p>Correct! but once access token is obtained by the user having access to multiple patient, in that case App wont require to get another Access token when switching the patient, correct? Same patient level scope which was obtained earlier "patient/Condition.read" will be applicable to another patient, if user has access to that patient and that does not require App to obtain another access token, correct?<br>
Thanks again for your response!</p>



<a name="211033550"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/211033550" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#211033550">(Sep 23 2020 at 17:12)</a>:</h4>
<p>I'm not sure I understand the question. There are two levels of permissions: user level and patient level. If an app is using patient level permissions, it will need a new access token for every patient it accesses. If the app is using user level permissions, it can use one access token to fetch data about different patients.</p>



<a name="211041130"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/211041130" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sagar Shah <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#211041130">(Sep 23 2020 at 18:09)</a>:</h4>
<p>That clarified my question, I think. We are planning on supporting both patient facing app (patient level access) and provider facing app (user level access to multiple patients). My questions was mainly on later scenario where healthcare provider logs into to app and has access to multiple patient, but during EHR launch it acquired a token with a specific patient in context of EHR application. Can he use that same token in 3rd party app to access other patient related information as well? I believe answer to that scenario is yes reading from your previous post.</p>



<a name="211051080"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/211051080" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#211051080">(Sep 23 2020 at 19:26)</a>:</h4>
<p>Cool! Keep in mind that patient facing apps <em>just like provider facing apps</em> can be designed with patient levels permissions <em>or</em> user level permissions. The permission model isn't determined by the type of end-user.</p>



<a name="276805550"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/276805550" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erez Shalom <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#276805550">(Mar 27 2022 at 20:15)</a>:</h4>
<p>The current authorization method in our non-FHIR patient/provider apps is 2fa (hospital policy).<br>
Now we moving to FHIR and want to change the app to be smartonfhir. Is there a way to keep the 2fa process in the new smart process, or we need to change it?</p>



<a name="276817490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/276817490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#276817490">(Mar 28 2022 at 01:08)</a>:</h4>
<p>SMART on FHIR spec is silent on how users authenticate to the underlying EHR. If you're building an EHR, you should use what works for you.</p>



<a name="276817501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/OAuth%202%20with%20Smart%20on%20FHIR%20App/near/276817501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/OAuth.202.20with.20Smart.20on.20FHIR.20App.html#276817501">(Mar 28 2022 at 01:09)</a>:</h4>
<p>If you're building an app, you can perform your own authentication or use whatever authentication mechanism the EHR exposes to you by asking for OpenID Connect scopes when you launch.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
