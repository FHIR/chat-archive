---
layout: page
title: "FHIR Chat  · Clarification of requiring nonce in id_token if provided · smart"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/index.html">smart</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html">Clarification of requiring nonce in id_token if provided</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="173238613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173238613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Teirney <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173238613">(Aug 14 2019 at 20:23)</a>:</h4>
<p>I feel that some clarity is required regarding support for use of a nonce by a SMART on FHIR app.</p>
<p>We've just started testing integration with our solution being launched via SMART on FHIR. We're a confidential app that requires the identity of the user as we present content from our system and the EHR at the same time. We're using a standard OIDC Relying Party as part of our solution, which applies all security best practices - including the use of a nonce. We've had a 0 hit rate for that working so far.</p>
<p>One major EHR vendor has this to say. "The authorization code flow technically doesn't require it to be secure, and the SMART on FHIR specification didn't require it [use of the nonce]".</p>
<p>So, I'm seeking clarification here regarding whether complying with OIDC specification should be considered "par for the course" or whether the HL7 SMART on FHIR specification does need to call out some more things, like support for a nonce. And, as part of that, perhaps have examples that follow security best practices within the specification flow diagrams?</p>



<a name="173241088"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173241088" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173241088">(Aug 14 2019 at 20:50)</a>:</h4>
<p>In general we try to point to OIDC rather that re-stating content from OIDC; we only try to specify <em>extra</em> details. But 1) showing best practices in examples, 2) ensuring test suites like <a href="https://inferno.healthit.gov" target="_blank" title="https://inferno.healthit.gov">Inferno</a> test support, and 3) making any spot edits to content at <a href="http://hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#scopes-for-requesting-identity-data" target="_blank" title="http://hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#scopes-for-requesting-identity-data">http://hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#scopes-for-requesting-identity-data</a> all seem worthwhile.</p>



<a name="173241249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173241249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173241249">(Aug 14 2019 at 20:51)</a>:</h4>
<p>At the very least it'd be good to capture issues at <a href="https://github.com/hl7/smart-app-launch" target="_blank" title="https://github.com/hl7/smart-app-launch">https://github.com/hl7/smart-app-launch</a> and/or <a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemAdd&amp;tracker_id=677" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemAdd&amp;tracker_id=677">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemAdd&amp;tracker_id=677</a> so that when work begins for a v-next, we don't lose track.</p>



<a name="173241948"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173241948" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173241948">(Aug 14 2019 at 20:59)</a>:</h4>
<p>Is support for OIDC (or at least openid profile scopes) now required? It used to be optional...</p>



<a name="173243992"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173243992" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Teirney <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173243992">(Aug 14 2019 at 21:24)</a>:</h4>
<p>As a start I've created <a href="https://github.com/HL7/smart-app-launch/issues/295" target="_blank" title="https://github.com/HL7/smart-app-launch/issues/295">https://github.com/HL7/smart-app-launch/issues/295</a></p>



<a name="173244167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173244167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Teirney <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173244167">(Aug 14 2019 at 21:27)</a>:</h4>
<p><span class="user-mention" data-user-id="191912">@Michele Mottini</span> that's a good question as well. My read of the spec wasn't that it was optional, but rather a SMART on FHIR app could optionally request the openid scope. However, Epic doesn't support OIDC...</p>



<a name="173244628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173244628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173244628">(Aug 14 2019 at 21:35)</a>:</h4>
<p>Still optional? See <a href="http://hl7.org/fhir/smart-app-launch/conformance/index.html#smart-on-fhir-core-capabilities-and-capability-sets" target="_blank" title="http://hl7.org/fhir/smart-app-launch/conformance/index.html#smart-on-fhir-core-capabilities-and-capability-sets">http://hl7.org/fhir/smart-app-launch/conformance/index.html#smart-on-fhir-core-capabilities-and-capability-sets</a></p>



<a name="173246515"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173246515" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173246515">(Aug 14 2019 at 22:02)</a>:</h4>
<p>I think it's also worth while discussing what specific threat vector this protects/what the benefits are</p>



<a name="173246691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173246691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173246691">(Aug 14 2019 at 22:05)</a>:</h4>
<p>OAuth 2 state param seems to play a similar part in the SMART workflow</p>



<a name="173246921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173246921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173246921">(Aug 14 2019 at 22:08)</a>:</h4>
<p>OIDC is optional per SMART, but please note that ONC's proposed rule would adopt SMART App Launch <em>with</em> the OIDC feature.</p>



<a name="173586698"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173586698" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Teirney <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173586698">(Aug 19 2019 at 22:56)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> where's the best place to see what the ONC's proposed rules are?</p>



<a name="173586822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173586822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173586822">(Aug 19 2019 at 22:58)</a>:</h4>
<p><a href="http://healthit.gov/nprm" target="_blank" title="http://healthit.gov/nprm">healthit.gov/nprm</a> is a good place to start</p>



<a name="173626857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179170-smart/topic/Clarification%20of%20requiring%20nonce%20in%20id_token%20if%20provided/near/173626857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179170-smart/topic/Clarification.20of.20requiring.20nonce.20in.20id_token.20if.20provided.html#173626857">(Aug 20 2019 at 03:52)</a>:</h4>
<p>And inferno is the implementation of these rules: <a href="https://inferno.healthit.gov/inferno/" target="_blank" title="https://inferno.healthit.gov/inferno/">https://inferno.healthit.gov/inferno/</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
