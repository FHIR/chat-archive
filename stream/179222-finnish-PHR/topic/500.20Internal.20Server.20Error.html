---
layout: page
title: "FHIR Chat  · 500 Internal Server Error · finnish PHR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/index.html">finnish PHR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html">500 Internal Server Error</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153997588"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997588" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lauri Karppinen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997588">(Sep 18 2018 at 12:01)</a>:</h4>
<p>Hi,</p>
<p>I have been developing fhir json import and export to medical software. Patient information for import and export are already working (Our software gives validate FHIR json-file and that can be PUT to kanta test server). Now it's time to move on study information. My first idea was to create bundle containing all the different observations from our study data. Kanta does not seem to support bundle at all. The idea was be able to upload all the observations at once. Now I'm planning to do multiple observation resource files all referring to patient they belong. Is there any other way to do that? Or does someone have better idea to implement this?</p>
<p>While trying to figure out how to implement importing and exporting of study. I have been trying to upload simple observation for BMI. </p>
<p>I'm using POST to: <a href="http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation" target="_blank" title="http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation</a><br>
json:</p>
<p><code>{
  "resourceType": "Observation",
  "meta": {
    "profile": [
      "http://hl7.org/fhir/StructureDefinition/vitalsigns"
    ]
  },
  "text": {
    "status": "generated",
    "div": "&lt;div xmlns='http://www.w3.org/1999/xhtml'&gt;&lt;a name='mm'/&gt;&lt;/div&gt;"
  },
  "status": "final",
  "category": [
    {
      "coding": [
        {
          "code": "vital-signs",
          "system": "http://hl7.org/fhir/observation-category",
          "display": "Vital Signs"
        }
      ]
    }
  ],
  "subject": {
    "reference": "Patient/907e5750-0c82-1000-a37d-6c5500005666"
  },
  "performer": [
    {
      "reference": "Patient/907e5750-0c82-1000-a37d-6c5500005666"
    }
  ],
  "code": {
    "coding": [
      {
        "code": "39156-5",
        "system": "http://loinc.org",
        "display": "Body mass index (BMI) [Ratio]"
      }
    ],
    "text": "BMI ratio"
  },
  "issued": "2018-09-18T14:05:26+03:00",
  "valueQuantity": {
    "value": 16,
    "unit": "kg/m2"
  },
  "comment": "Some comment here"
}</code></p>
<p>This should be valid fhir and it can be uploaded to other test server.</p>
<p>Kanta test Server gives: 500 Internal Server Error as a return.<br>
A generic error message, given when no more specific message is suitable. </p>
<p>So I don't get any information what is wrong with this observation. Can anyone help and tell me what seems to be the problem with this resource? Am I missing something obvious here? Thanks!</p>



<a name="153997697"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997697" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997697">(Sep 18 2018 at 17:38)</a>:</h4>
<p>Not sure whether that's the issue, but I don't see a profile defined for BMI in <a href="https://simplifier.net/finnishphr/~resources?category=Profile" target="_blank" title="https://simplifier.net/finnishphr/~resources?category=Profile">https://simplifier.net/finnishphr/~resources?category=Profile</a>. There are profiles for body height and body weight, but not for BMI. I've understood you can't store anything in the Finnish PHR unless a suitable profile exists on the platform.</p>



<a name="153997699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997699">(Sep 18 2018 at 17:43)</a>:</h4>
<p>I tried to have a conversation especially on the vital signs on the platform in the past, as I had understood that that's the one single profile definition that should be implemented identically across all FHIR implementations, but that discussion did not really lead to anything...</p>



<a name="153997944"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997944" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997944">(Sep 19 2018 at 05:44)</a>:</h4>
<p>I can check the logs why you are getting the error if you message me with more precise point in time, but the correct POST should have /Observation as in  POST <a href="http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation" target="_blank" title="http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation">http://fhirsandbox.kanta.fi/phr-resourceserver/baseStu3/Observation</a> ?</p>



<a name="153997945"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997945" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997945">(Sep 19 2018 at 05:49)</a>:</h4>
<p>And yes, a resource needs to have a  <a href="http://phr.kanta.fi" target="_blank" title="http://phr.kanta.fi">http://phr.kanta.fi</a> -profile refrenced.</p>



<a name="153997946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lauri Karppinen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997946">(Sep 19 2018 at 06:00)</a>:</h4>
<p>Thanks! This seems to be the problem. I try to demo with height/weight today after I get other stuff done. It seems like we have lot of values in our software  which are not supported in Kanta. Thanks.</p>



<a name="153997947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lauri Karppinen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997947">(Sep 19 2018 at 06:03)</a>:</h4>
<p>I had "/Observation" in the link. Just forgot to put it in my chat post. By the way do you prefer using english in here?</p>



<a name="153997949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lauri Karppinen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997949">(Sep 19 2018 at 06:35)</a>:</h4>
<p>I tested with Body weight and I get the same error (500 Internal Server Error).  </p>
<p><code>{
  "resourceType": "Observation",
  "meta": {
    "profile": [
      "http://hl7.org/fhir/StructureDefinition/vitalsigns"
    ]
  },
  "text": {
    "status": "generated",
    "div": "&lt;div xmlns='http://www.w3.org/1999/xhtml'&gt;Weight&lt;a name='mm'/&gt;&lt;/div&gt;"
  },
  "subject": {
    "reference": "Patient/907e5750-0c82-1000-a37d-6c5500005666"
  },
  "code": {
    "coding": [
      {
        "code": "29463-7",
        "system": "http://loinc.org",
        "display": "Body weight"
      }
    ]
  },
  "valueQuantity": {
    "system": "http://unitsofmeasure.org",
    "value": "82",
    "unit": "kg"
  },
  "status": "final"
}</code></p>
<p>This should be valid FHIR and supported in: <a href="https://simplifier.net/finnishphr/fiphr-bodyweight-stu3" target="_blank" title="https://simplifier.net/finnishphr/fiphr-bodyweight-stu3">https://simplifier.net/finnishphr/fiphr-bodyweight-stu3</a></p>



<a name="153997950"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997950" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997950">(Sep 19 2018 at 06:40)</a>:</h4>
<p>The profile needs to be referenced in the meta,</p>
<p>"meta": {<br>
    "profile": [<br>
      "<a href="http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3" target="_blank" title="http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3">http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3</a>"<br>
    ]</p>
<p>this was just saved ok: </p>
<p>{<br>
  "resourceType": "Observation",<br>
  "meta": {<br>
    "profile": [<br>
      "<a href="http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3" target="_blank" title="http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3">http://phr.kanta.fi/StructureDefinition/fiphr-bodyweight-stu3</a>"<br>
    ]<br>
  },<br>
  "language": "fi",<br>
  "text": {<br>
    "status": "generated",<br>
    "div": "&lt;div&gt;Code: Body weight (29463-7)&lt;br /&gt;Time: 20.11.2017 11:46&lt;br /&gt;Result: 78 kg&lt;/div&gt;"<br>
  },<br>
  "identifier": [<br>
    {<br>
      "system": "urn:ietf:rfc:3986",<br>
      "value": "urn:uuid:3aa26139-13ed-4f2a-bdf4-11dd5fd40f0f"<br>
    }<br>
  ],<br>
  "status": "final",<br>
  "category": [<br>
    {<br>
      "coding": [<br>
        {<br>
          "code": "vital-signs",<br>
          "system": "<a href="http://hl7.org/fhir/observation-category" target="_blank" title="http://hl7.org/fhir/observation-category">http://hl7.org/fhir/observation-category</a>"<br>
        }<br>
      ]<br>
    }<br>
  ],<br>
  "code": {<br>
    "coding": [<br>
      {<br>
        "code": "29463-7",<br>
        "display": "Body weight",<br>
        "system": "<a href="http://loinc.org" target="_blank" title="http://loinc.org">http://loinc.org</a>"<br>
      }<br>
    ]<br>
  },<br>
  "subject": {<br>
    "reference": "Patient/91db836a-b62a-49af-8e7a-a94ed90a41d5"<br>
  },<br>
  "effectiveDateTime": "2017-11-20T11:46:00+02:00",<br>
  "issued": "2017-11-20T11:46:00+02:00",<br>
  "performer": [<br>
    {<br>
      "reference": "Patient/91db836a-b62a-49af-8e7a-a94ed90a41d5"<br>
    }<br>
  ],<br>
  "valueQuantity": {<br>
    "value": 78,<br>
    "unit": "kg",<br>
    "system": "<a href="http://unitsofmeasure.org" target="_blank" title="http://unitsofmeasure.org">http://unitsofmeasure.org</a>",<br>
    "code": "kg"<br>
  }<br>
}</p>



<a name="153997951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153997951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153997951">(Sep 19 2018 at 06:43)</a>:</h4>
<p>If you need more values supported they can be proposed by interested parties, see here: <a href="https://www.kanta.fi/en/system-developers/development-of-the-national-data-content" target="_blank" title="https://www.kanta.fi/en/system-developers/development-of-the-national-data-content">https://www.kanta.fi/en/system-developers/development-of-the-national-data-content</a> . Both English and Finnish are fine here.</p>



<a name="153998030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/500%20Internal%20Server%20Error/near/153998030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lauri Karppinen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/500.20Internal.20Server.20Error.html#153998030">(Sep 19 2018 at 08:58)</a>:</h4>
<p>Kiitos avusta! Viittasin tosiaan aivan väärään osoitteeseen structure defenitionin osalta. Ei ihme, ettei serveri osannut kertoa, mikä oli pielessä. Ja kiitos myös linkistä. Selvitän mille kaikelle tiedolle tarvitsemme tuen, ja teemme lisäysehdoitukset kantaan.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
