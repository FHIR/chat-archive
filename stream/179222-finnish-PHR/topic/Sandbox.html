---
layout: page
title: "FHIR Chat  · Sandbox · finnish PHR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/index.html">finnish PHR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html">Sandbox</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153913011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153913011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannu Korhonen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153913011">(Oct 09 2017 at 07:04)</a>:</h4>
<p>Hi,</p>
<p>why <a href="http://fhirsandbox.kanta.fi" target="_blank" title="http://fhirsandbox.kanta.fi">http://fhirsandbox.kanta.fi</a> is empty and create resources fails?</p>
<p>SOLVED - There was a confusion about how sandbox shows resources and search function not returning CodeSystems like our own HAPI server.</p>



<a name="153913098"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153913098" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mika Tuomainen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153913098">(Oct 09 2017 at 12:21)</a>:</h4>
<p>@</p>



<a name="153917039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153917039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jukka Pirinen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153917039">(Nov 01 2017 at 05:55)</a>:</h4>
<p>Terve, is authorization sandbox down or have there been some changes in accessing it? <a href="https://fhirsandbox2.kanta.fi/openid-connect-kela/registeruser" target="_blank" title="https://fhirsandbox2.kanta.fi/openid-connect-kela/registeruser">https://fhirsandbox2.kanta.fi/openid-connect-kela/registeruser</a> returns ERR_CONNECTION_RESET (Chrome)</p>



<a name="153917788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153917788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153917788">(Nov 06 2017 at 14:06)</a>:</h4>
<p>The address has changed to <a href="https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/" target="_blank" title="https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/">https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/</a>  <br>
This page has all the relevant addresses etc: <a href="http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille" target="_blank" title="http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille">http://www.kanta.fi/en/web/ammattilaisille/tarkeaa-tietoa-kehittajille</a></p>



<a name="153918432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153918432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannu Korhonen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153918432">(Nov 09 2017 at 07:53)</a>:</h4>
<p>Warning!<br>
Failed to load capability statement, error was: ca.uhn.fhir.rest.server.exceptions.InternalErrorException: HTTP 500 Internal Server Error</p>
<p>problems in sandbox environment?</p>



<a name="153918442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153918442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153918442">(Nov 09 2017 at 09:37)</a>:</h4>
<p>Not problems, but scheduled update to fix some findings from last week. Everything should be up and running right now!</p>
<p>The updates are announced here: <a href="http://www.kanta.fi/fi/web/ammattilaisille/omakannan-omatietovaranto" target="_blank" title="http://www.kanta.fi/fi/web/ammattilaisille/omakannan-omatietovaranto">http://www.kanta.fi/fi/web/ammattilaisille/omakannan-omatietovaranto</a></p>



<a name="153921434"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153921434" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Timo Aaltonen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153921434">(Nov 24 2017 at 09:59)</a>:</h4>
<p>The  server <a href="http://fhirsandbox2-auth.kanta.fi" target="_blank" title="http://fhirsandbox2-auth.kanta.fi">fhirsandbox2-auth.kanta.fi</a> does not seem to return OAuth refresh token. We are able to get only the access_token, whose TTL is one hour. Is this a bug or feature?</p>



<a name="153921789"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153921789" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153921789">(Nov 28 2017 at 09:45)</a>:</h4>
<p>Might be due to your client configuration, if you pm me the client id we'll check it! Or if you want to reconfigure it yourself check that it has "offline_access" scope and "refresh tokens are granted" checkbox  is set.</p>
<p>Edited to add: if it uses the professional grant type and not the authorization grant flow, then it is feature and as it should be.</p>



<a name="153922083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153922083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153922083">(Nov 29 2017 at 15:56)</a>:</h4>
<p><span class="user-mention" data-user-id="192813">@Eeva Turkka</span> <span class="user-mention" data-user-id="194314">@Timo Aaltonen</span>  I just noticed the same. Before, I got the token with "openid" "profile" "offline_access" all set, and was able to refresh that token too. I then added some other scopes, and fetched a new token. Now the authorization process seems to ignore those scopes, and always returns a token without any of them.</p>



<a name="153922084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153922084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153922084">(Nov 29 2017 at 15:57)</a>:</h4>
<p>Also, I wasn't able to get StructureDefinition.read / StructureDefinition.write scopes for the app, although I did add them to the client definition in the auth server, and also to the auth request.</p>



<a name="153922148"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153922148" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153922148">(Nov 29 2017 at 20:11)</a>:</h4>
<p>Did you list all of the scopes together including the offline_access from before when you added more scopes? Our regression set keeps getting refreshed tokens so I need a bit more info to figure this one out :)</p>



<a name="153922150"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153922150" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153922150">(Nov 29 2017 at 20:15)</a>:</h4>
<p>Yes. Before the change the app was specified as having scopes "patient/MedicationAdministration.write patient/MedicationAdministration.read openid offline_access profile patient/Observation.read patient/Observation.write" and the auth request requested for "openid profile patient/Observation.read patient/Observation.write patient/MedicationAdministration.read patient/MedicationAdministration.write offline_access".</p>



<a name="153922151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153922151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153922151">(Nov 29 2017 at 20:15)</a>:</h4>
<p>It used to work, but does not anymore. Even with that same configuration, the authorization process only yields the limited scope to the token.</p>



<a name="153922153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153922153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153922153">(Nov 29 2017 at 20:19)</a>:</h4>
<p>We'll try to reproduce this and if we cannot we'll ask for more details! (<span class="user-mention" data-user-id="197084">@Matti Uusitalo</span>  pinging you in case I forget to mention this tomorrow morning)</p>



<a name="153922238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153922238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153922238">(Nov 30 2017 at 07:28)</a>:</h4>
<p>We've managed to reproduce this, this is cause by a bug that doesn't authorize citizen-clients to use those scopes (but if they were authorized, they remain so, so new authorization request removes them.). This is not intended and will be fixed in next update!</p>



<a name="153923667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153923667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Juha Leppänen <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153923667">(Dec 08 2017 at 08:12)</a>:</h4>
<p>Has there been any changes in the authorization? It used to work in October when I last checked it. Now I am getting {"error":"unauthorized","error_description":"No AuthenticationProvider found for fi.kela.kanta.phr.auth.token.PhrOidAuthenticationToken"} when executing the 2nd phase i.e. <a href="https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/token" target="_blank" title="https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/token">https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/token</a>.</p>



<a name="153923673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153923673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153923673">(Dec 08 2017 at 09:10)</a>:</h4>
<p>I confirm this is now working, and I get 'openid', 'profile', and 'access_token' scopes as expected.</p>



<a name="153923674"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153923674" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153923674">(Dec 08 2017 at 09:11)</a>:</h4>
<p>I don't get scopes for reading and writing StructureDefinitions, though. So I assume I can't do that programmatically, rather I must use the user interface of the non-authenticating sandbox.</p>



<a name="153923675"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153923675" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Rinnetmäki <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153923675">(Dec 08 2017 at 09:12)</a>:</h4>
<p>(meant to say the issue with scopes is working, not to comment on PhrOidAuthenticationToken)</p>



<a name="153924231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179222-finnish%20PHR/topic/Sandbox/near/153924231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179222-finnish-PHR/topic/Sandbox.html#153924231">(Dec 11 2017 at 12:47)</a>:</h4>
<p>This looks very much like an issue we need to check! I've asked our testing to check if they can reproduce this, but if not I'll ask for more details.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
