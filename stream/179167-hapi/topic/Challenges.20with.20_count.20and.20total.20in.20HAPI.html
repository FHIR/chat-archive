---
layout: page
title: "FHIR Chat  · Challenges with _count and total in HAPI · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Challenges.20with.20_count.20and.20total.20in.20HAPI.html">Challenges with _count and total in HAPI</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="180177179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Challenges%20with%20_count%20and%20total%20in%20HAPI/near/180177179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Challenges.20with.20_count.20and.20total.20in.20HAPI.html#180177179">(Nov 07 2019 at 21:21)</a>:</h4>
<p>I'm working on pagination in my server (not using PaginationProvider), returning a Bundle.  It appears that HAPI is rewriting the bundle I return and changing the value of Total to -1 (one of my test cases is for _count=-1, which seems to be related).  I suspect I need to return an IBundleProvider or something, but thought I would mention the weird behavior.</p>



<a name="180177359"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Challenges%20with%20_count%20and%20total%20in%20HAPI/near/180177359" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Challenges.20with.20_count.20and.20total.20in.20HAPI.html#180177359">(Nov 07 2019 at 21:23)</a>:</h4>
<p>Issue appears to be in BaseMethodBinding.toResourceList() method.</p>



<a name="180180375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Challenges%20with%20_count%20and%20total%20in%20HAPI/near/180180375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Challenges.20with.20_count.20and.20total.20in.20HAPI.html#180180375">(Nov 07 2019 at 21:53)</a>:</h4>
<p>Tracked it back to BaseResourceReturningMethodBinding. doInvokeServer(IRestfulServer&lt;?&gt; theServer, RequestDetails theRequest)<br>
where:<br>
Integer count = RestfulServerUtils.extractCountParameter(theRequest);<br>
...<br>
And then:<br>
bundleFactory.addRootPropertiesToBundle(null, theRequest.getFhirServerBase(), linkSelf, null, null, count, getResponseBundleType(), lastUpdated);</p>
<p>BUT: count is clearly not theTotalResults, and in fact, there's really no way to know what that value SHOULD be based on the response unless Bundle.total is populated.  </p>
<p>I'll log a bug for this, and see what I can do to work around it.</p>



<a name="180180856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Challenges%20with%20_count%20and%20total%20in%20HAPI/near/180180856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Challenges.20with.20_count.20and.20total.20in.20HAPI.html#180180856">(Nov 07 2019 at 21:59)</a>:</h4>
<p><a href="https://github.com/jamesagnew/hapi-fhir/issues/1585" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/issues/1585">https://github.com/jamesagnew/hapi-fhir/issues/1585</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
