---
layout: page
title: "FHIR Chat  · JSON Validation · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html">JSON Validation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153863802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863802">(Dec 16 2016 at 23:26)</a>:</h4>
<p>I've been troubleshooting some places where our JSON seems to be parsing and validating, even though we don't think it should. Given this json:<br>
<code>{"resourceType": "Patient",
  "id": 123,
  "meta": {
    "versionId": "29",
    "lastUpdated": "2015-12-22T19:53:11.000Z"
  },
  "communication": {
    "language": {
      "coding": [
        {
          "system": "urn:ietf:bcp:47",
          "code": "hi",
          "display": "Hindi",
          "userSelected": false
        }],
      "text": "Hindi"
    },
    "preferred": true
  }
}</code></p>



<a name="153863804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863804">(Dec 16 2016 at 23:27)</a>:</h4>
<p>I would expect at least an error about the id not being a string, and the communication not being a list.</p>



<a name="153863805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863805">(Dec 16 2016 at 23:27)</a>:</h4>
<p>me too :-)</p>



<a name="153863806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863806">(Dec 16 2016 at 23:28)</a>:</h4>
<p>My context is set up with the StrictErrorHandler, and the SchemaBaseValidator and SchematronBaseValidator, and I've stepped into validation code and confirmed both end up in the validators list</p>



<a name="153863807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863807">(Dec 16 2016 at 23:30)</a>:</h4>
<p>I've tried a few ways to validate:</p>
<p><code>IBaseResource fakeresource = context.newJsonParser().parseResource(fakeBody);
ValidationResult validationResult = validator.validateWithResult(fakeBody);
ValidationResult otherResult = validator.validateWithResult(fakeresource);</code></p>



<a name="153863808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863808">(Dec 16 2016 at 23:32)</a>:</h4>
<p>All success/no issues. If I step through it, the JSON raw gets converted to XML. The XML ends up as:</p>
<div class="codehilite"><pre>&lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;
&lt;id value=“123&quot;/&gt;
&lt;meta&gt;
    &lt;versionId value=&quot;29&quot;/&gt;
    &lt;lastUpdated value=&quot;2015-12-22T19:53:11.000Z&quot;/&gt;
&lt;/meta&gt;
&lt;communication&gt;
    &lt;language&gt;
        &lt;coding&gt;
            &lt;system value=&quot;urn:ietf:bcp:47&quot;/&gt;
            &lt;code value=&quot;hi&quot;/&gt;
            &lt;display value=&quot;Hindi&quot;/&gt;
            &lt;userSelected value=&quot;false&quot;/&gt;
        &lt;/coding&gt;
        &lt;text value=&quot;Hindi&quot;/&gt;
    &lt;/language&gt;
    &lt;preferred value=&quot;true&quot;/&gt;
&lt;/communication&gt;
&lt;/Patient&gt;
</pre></div>



<a name="153863809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863809">(Dec 16 2016 at 23:33)</a>:</h4>
<p>Which is, unfortunately for us, valid</p>



<a name="153863810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863810">(Dec 16 2016 at 23:35)</a>:</h4>
<p>I'm not sure if there's a better way for me to run this through validation and have it actually catch these? And is this just an expected result since the source is JSON? It feels like a bug, but I know the validation logic is relatively recent.</p>



<a name="153863812"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863812" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863812">(Dec 16 2016 at 23:39)</a>:</h4>
<p>To make this more fun (and a warning to others): if you try to log the result of the client call (assuming it's in resource form and you call encodeResourceToString), the JSON will come back out valid since it starts from the resource. This makes sense, given that it's starting from the resource, but threw us for a loop since not only did the JSON parser not error, the JSON getting logged looked great :)</p>



<a name="153863813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863813">(Dec 17 2016 at 00:38)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> the validator validates JSON/stream/byte[] directly now - no need to convert to XML </p>



<a name="153863814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153863814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153863814">(Dec 17 2016 at 00:39)</a>:</h4>
<p>I'll have to check whether the underlying validator is right on this one</p>



<a name="153864015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864015">(Dec 19 2016 at 16:11)</a>:</h4>
<p><span class="user-mention" data-user-id="191356">@Jenni Syed</span> How are you setting up the validator? (ie. which modules are you feeding it)?</p>
<p>If you're using the <code>FhirInstanceValidator</code> I would expect it to catch these issues. You'd need to do the following to register that validator if you haven't already:</p>
<div class="codehilite"><pre><span></span><span class="n">FhirInstanceValidator</span> <span class="n">instanceValidator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FhirInstanceValidator</span><span class="o">();</span>
<span class="n">validator</span><span class="o">.</span><span class="na">registerValidatorModule</span><span class="o">(</span><span class="n">instanceValidator</span><span class="o">);</span>
</pre></div>


<p>If you're validating without that part, it's probably just running your JSON through the XSD validator and it does an automatic conversion to XML before proceeding with that.</p>
<p>I'm guessing this is related to your other question.. this gives me an idea. We have a server interceptor that automatically validates the raw request and response, but no such interceptor on the client. Sounds like that is exactly what you want really.</p>



<a name="153864020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864020">(Dec 19 2016 at 16:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> I was using the Schema/Schematron ones. I originally started this on an older version of HAPI, not sure if I saw the FHIRInstance option. I can try that out.</p>



<a name="153864022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864022">(Dec 19 2016 at 16:19)</a>:</h4>
<p>The interceptor would be nice, but the one line we have that is checking this isn't too cumbersome since we already do a lot with the requests/responses as is :)</p>



<a name="153864023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864023">(Dec 19 2016 at 16:23)</a>:</h4>
<p>hrm. Or I couldn't find it :) Having issues getting that class to resolve. I'll look around a bit.</p>



<a name="153864025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864025">(Dec 19 2016 at 16:25)</a>:</h4>
<p>If you're doing DSTU2, you need to add the <code>hapi-fhir-structures-dstu2-hl7org</code> dependency to your pom/project. The validator doesn't live in the same place as the DSTU2 structures in the pre-STU3 HAPI world..</p>



<a name="153864028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864028">(Dec 19 2016 at 16:27)</a>:</h4>
<p>which is different than hapi-fhir-structures-hl7org-dstu2?? or typo? (that's in the classpath)</p>



<a name="153864031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864031">(Dec 19 2016 at 16:28)</a>:</h4>
<p>oops, sorry that's just my typo.. you have the right one.</p>
<p>The class you're after is <code>org.hl7.fhir.instance.hapi.validation.FhirInstanceValidator</code> if that helps</p>



<a name="153864032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864032">(Dec 19 2016 at 16:30)</a>:</h4>
<p>How about org.hl7.fhir.instance.validation.InstanceValidator?</p>



<a name="153864033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864033">(Dec 19 2016 at 16:30)</a>:</h4>
<p>that's all I see in that jar, that's similar :)</p>



<a name="153864034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864034">(Dec 19 2016 at 16:31)</a>:</h4>
<p>well, at least I thought</p>



<a name="153864035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864035">(Dec 19 2016 at 16:32)</a>:</h4>
<p>Weeeeeird. You aren't on a super-old version of that JAR are you? Maven sees it in there as of 1.4:</p>
<p><a href="http://search.maven.org/#search%7Cga%7C1%7Cfc%3A%22org.hl7.fhir.instance.hapi.validation.FhirInstanceValidator%22" target="_blank" title="http://search.maven.org/#search%7Cga%7C1%7Cfc%3A%22org.hl7.fhir.instance.hapi.validation.FhirInstanceValidator%22">http://search.maven.org/#search%7Cga%7C1%7Cfc%3A%22org.hl7.fhir.instance.hapi.validation.FhirInstanceValidator%22</a></p>



<a name="153864036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864036">(Dec 19 2016 at 16:33)</a>:</h4>
<p>I think something is funky with my IDE-created classpath... let me play a bit with the maven resolution</p>



<a name="153864037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864037">(Dec 19 2016 at 16:34)</a>:</h4>
<p>It *thinks* i'm on 2.1, but it doesn't see that class</p>



<a name="153864038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864038">(Dec 19 2016 at 16:39)</a>:</h4>
<p>Ok, forced it to regenerate the classpath... seems to be finding it now, and I can see it.<br>
Do the schema/schematron validators do anything for me that the FHIRInstance one won't do?</p>



<a name="153864039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864039">(Dec 19 2016 at 16:43)</a>:</h4>
<p>I'm not getting errors with the FHIRInstanceValidator either, going to try cutting it back down to a smaller test case again</p>



<a name="153864045"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864045" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864045">(Dec 19 2016 at 16:57)</a>:</h4>
<p>Hmm, let me try plugging your example into a test case.</p>



<a name="153864046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864046">(Dec 19 2016 at 16:57)</a>:</h4>
<p>It looks like it's a warning/info. Though not seeing anything for the id</p>



<a name="153864048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864048">(Dec 19 2016 at 17:02)</a>:</h4>
<p>Hmm.. Yeah, I don't even see any relevant errors in the validator output. Weird. Let me dig into it... </p>
<div class="codehilite"><pre>12:00:17.288 [main] INFO  c.u.f.v.FhirInstanceValidatorTest [FhirInstanceValidatorTest.java:172] - Result 0: INFORMATION - /communication/language - Binding by URI reference cannot be checked
12:00:17.289 [main] INFO  c.u.f.v.FhirInstanceValidatorTest [FhirInstanceValidatorTest.java:172] - Result 1: INFORMATION - /communication/language/coding - Binding for path /communication/language/coding has no source, so can&#39;t be checked
</pre></div>



<a name="153864052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864052">(Dec 19 2016 at 17:15)</a>:</h4>
<p>Hmm, yeah. It seems like the DSTU2 validator doesn't catch either of these issues. Interestingly the STU3 validator catches the numeric ID but not the array one:</p>
<div class="codehilite"><pre><span class="p">{</span>
  <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;OperationOutcome&quot;</span><span class="p">,</span>
  <span class="nt">&quot;issue&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
      <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;processing&quot;</span><span class="p">,</span>
      <span class="nt">&quot;diagnostics&quot;</span><span class="p">:</span> <span class="s2">&quot;Error parsing JSON: the primitive value must be a string&quot;</span><span class="p">,</span>
      <span class="nt">&quot;location&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;/Patient/id&quot;</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span>
      <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;processing&quot;</span><span class="p">,</span>
      <span class="nt">&quot;diagnostics&quot;</span><span class="p">:</span> <span class="s2">&quot;None of the codes provided are in the value set http://hl7.org/fhir/ValueSet/languages (http://hl7.org/fhir/ValueSet/languages, and a code should come from this value set unless it has no suitable code) (codes = urn:ietf:bcp:47#hi)&quot;</span><span class="p">,</span>
      <span class="nt">&quot;location&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Patient.communication.language&quot;</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>



<a name="153864055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864055">(Dec 19 2016 at 17:26)</a>:</h4>
<p>It also doesn't seem to like hi for hindi in STU3?</p>



<a name="153864057"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864057" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864057">(Dec 19 2016 at 17:27)</a>:</h4>
<p>Yeah, there's no built-in BCP47 validator yet... Not sure why that's the error message it gives for that. </p>
<p>As a short-term fix, I'm just looking at cleaning up the JsonParser so that StrictErrorHandler will alos fail for these issues. It really should.</p>



<a name="153864058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864058">(Dec 19 2016 at 17:28)</a>:</h4>
<p>I have a unit test for this now too, so I can dig into why the instancevalidator isn't catching this stuff at some point..</p>



<a name="153864073"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864073" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864073">(Dec 19 2016 at 19:28)</a>:</h4>
<p><span class="user-mention" data-user-id="191356">@Jenni Syed</span> in STU3, there's nothing that schema/schematron test that isn't tested by the validator</p>



<a name="153864074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864074">(Dec 19 2016 at 19:28)</a>:</h4>
<p>What about DSTU2 (which is where I am right now)</p>



<a name="153864075"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864075" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864075">(Dec 19 2016 at 19:30)</a>:</h4>
<p>I can't remember when I started validating order in the instance validator </p>



<a name="153864076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864076">(Dec 19 2016 at 19:32)</a>:</h4>
<p>looks like the DSTU2 validator does not check order; it assumes that schema is used for that</p>



<a name="153864082"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864082" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864082">(Dec 19 2016 at 20:24)</a>:</h4>
<p>The errors for "has no source, so cannot be checked" - is that an error related to HAPI not knowing the system being returned? IE: its binding in core FHIR isn't required? </p>
<p>It seems that way, looking through some of the code. EG: <a href="https://github.com/jamesagnew/hapi-fhir/blob/191e3b6d4d29fd36c35bc8f0b5d9c08f8ce618a3/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/validation/InstanceValidator.java#L666" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/blob/191e3b6d4d29fd36c35bc8f0b5d9c08f8ce618a3/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/validation/InstanceValidator.java#L666">https://github.com/jamesagnew/hapi-fhir/blob/191e3b6d4d29fd36c35bc8f0b5d9c08f8ce618a3/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/validation/InstanceValidator.java#L666</a></p>



<a name="153864083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864083">(Dec 19 2016 at 20:26)</a>:</h4>
<p>er, no, marital status seems to be required but getting that error. So then - HAPI just doesn't know it?</p>



<a name="153864086"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864086" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864086">(Dec 19 2016 at 20:40)</a>:</h4>
<p>I think I have something else wrong in my config... I see some of these valuesets defined, and the codes for them, in the XML files. On to more troubleshooting! :)</p>



<a name="153864270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864270">(Dec 20 2016 at 14:15)</a>:</h4>
<p>This just appears to be a bug in the DSTU2 validator (which is already fixed in the STU3 one). I'm fixing it now.</p>
<p>Man, I'm really excited to see Grahame's "validate DSTU2 resources using the DSTU3 validator" module. Having one validator codebase is going to be awesome!</p>



<a name="153864275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864275">(Dec 20 2016 at 14:30)</a>:</h4>
<p>Argh, that "has no source" is a pain. I don't think it's going to get fixed now after all.. Presumably this would require a bunch of work, and it's probably not worth the effort since we're about to swap out the validator anyhow (and the message is just an INFO one, not an actual error). </p>
<p>Basically the validator sees the binding on <code>Patient.maritalStatus</code> but doesn't see it when it goes to validator <code>Patient.maritcalStatus.coding</code>. So the codes do get validated, you just get a spurious info message.</p>



<a name="153864292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864292">(Dec 20 2016 at 15:42)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span>  Thanks :) Now I just have to figure out how to ignore that one (and other similar ones that  I think are "fake") but still get the errors for the communication issue...</p>



<a name="153864293"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864293" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864293">(Dec 20 2016 at 15:44)</a>:</h4>
<p>Is there a way to use the new single code base yet, or is that still pending release (and when?? :) )?</p>



<a name="153864301"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864301" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864301">(Dec 20 2016 at 16:08)</a>:</h4>
<p>Grahame's got it in the RI codebase, so you could certainly pull that into your project... My aim is to release HAPI 2.2 today, and start working on getting the joined validator into the next snapshot building within a week or so, if that helps</p>



<a name="153864304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/JSON%20Validation/near/153864304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/JSON.20Validation.html#153864304">(Dec 20 2016 at 16:19)</a>:</h4>
<p>That will help - I'll watch for the newer snapshots and versions so we can upgrade</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
