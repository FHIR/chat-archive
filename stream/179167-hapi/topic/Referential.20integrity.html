---
layout: page
title: "FHIR Chat  · Referential integrity · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html">Referential integrity</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="241724894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241724894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241724894">(Jun 07 2021 at 03:33)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="191319">@James Agnew</span> I'm giving a talk about referential integrity on FHIR APIs at DevDays today.(/tomorrow)</p>
<p>I've got a question for you. HAPI has an interceptor that allows you to manage for some referential integrity constraints to be broken, but I was surprised that to my way of thinking, it only covers half the problem. You can say that you allow for resources to be deleted if <a href="https://hapifhir.io/hapi-fhir/docs/interceptors/built_in_server_interceptors.html#overridepathbasedreferentialintegrityfordeletesinterceptor">some paths would be broken</a>, but you can't say, 'this path X, I'm OK for whatever it points to be broken, but not other paths'. </p>
<p>Have I missed something?</p>



<a name="241726367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241726367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241726367">(Jun 07 2021 at 04:06)</a>:</h4>
<p>Has versioning been covered in there too?</p>



<a name="241728937"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241728937" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241728937">(Jun 07 2021 at 04:50)</a>:</h4>
<p>not my subject, so I'm not sure.</p>



<a name="241751039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241751039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241751039">(Jun 07 2021 at 09:39)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  I'm not sure Im actually getting the meat of your question, but:</p>
<p>We do also support all or nothing. I.e. you can turn on referential integrity so that all reference paths are enforced and you can't delete a resource unless nothing is pointing at it. This is the default behaviour. You can also globally turn it off so that you'll never be blocked from deleting resources because something points at the thing you're deleting. There is also a similar setting for creates, where you can configure the server to not prevent you from creating a resource if it has a reference to a target that doesn't actually exist (but this isn't the default either).</p>
<p>The interceptor was added based on a customer request, and the logic made sense to me - There are a few places where references don't actually need to indicate live links, they just need to indicate what the live link was at the time the resource was created. <a href="http://AuditEvent.target">AuditEvent.target</a> would be an example of that. So when you use the interceptor you could let a Patient be deleted if only an AuditEvent points at it, but you'd still be blocked if an Observation also does.</p>



<a name="241751881"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241751881" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241751881">(Jun 07 2021 at 09:46)</a>:</h4>
<p>I totally get what it does. it's what it doesn't do. I'd like to have an interceptor that let me say, require that Observation.subject is valid when a new Observation is posted, but decide that I don't care if DiagnosticReport.baseOn refers to a resource that I'll never get</p>



<a name="241758639"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241758639" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241758639">(Jun 07 2021 at 10:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="241783727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241783727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241783727">(Jun 07 2021 at 14:23)</a>:</h4>
<p>Oh I see.. So you're looking for the equivalent of the selective enforcement, but for resource creates as opposed to resource deletes.</p>
<p>That isn't supported, but would be easy enough to add for sure.</p>



<a name="241785435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241785435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241785435">(Jun 07 2021 at 14:34)</a>:</h4>
<p>ok thanks</p>



<a name="241789400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241789400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241789400">(Jun 07 2021 at 14:59)</a>:</h4>
<p>Eg. black/whitelist of ignored fields expressed in fhirpath?</p>



<a name="241790988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Referential%20integrity/near/241790988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Referential.20integrity.html#241790988">(Jun 07 2021 at 15:08)</a>:</h4>
<p>something like that</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
