---
layout: page
title: "FHIR Chat  · best practice for validation chain · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html">best practice for validation chain</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="195339520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/195339520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#195339520">(Apr 26 2020 at 15:36)</a>:</h4>
<p>As hapi 5.0.0 has some changes in the validation modules i'd like to ask for the best practice of creating a validation chain.</p>
<ul>
<li>SnapshotGeneratingValidationSupport know only takes the context, so no more wrapping -  just putting it into the chain would be sufficient. Right?</li>
<li>'the validator will try each module in the chain until one of them returns a non-null response.' So the order of the Modules is important.<br>
In the recipe: <a href="https://hapifhir.io/hapi-fhir/docs/validation/validation_support_modules.html#recipe-supplying-custom-definitions" title="https://hapifhir.io/hapi-fhir/docs/validation/validation_support_modules.html#recipe-supplying-custom-definitions">https://hapifhir.io/hapi-fhir/docs/validation/validation_support_modules.html#recipe-supplying-custom-definitions</a> default support is added before the PrePopulatedValidationSupport. To me this would mean that all validations are done by the DefaultProfileValidationSupport, as it supports all FHIR resource types, and PrePopulatedValidationSupport will never be called.</li>
</ul>



<a name="195339709"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/195339709" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#195339709">(Apr 26 2020 at 15:42)</a>:</h4>
<p>What is the proper order if i want to combine:</p>
<ul>
<li>DefaultProfileValidationSupport</li>
<li>PrePopulatedValidationSupport</li>
<li>InMemoryTerminologyServerValidationSupport &lt;- needed because DefaultProfileValidationSupport doesn't validate Terminology an more</li>
<li>SnapshotGeneratingValidationSupport</li>
<li>CommonCodeSystemsTerminologyService</li>
</ul>
<p>I then would wrap this whole chain in a CachingValidationSupport.<br>
Until now i was under the assumption that each validator is called after another and  is independent from the others. But seeing InMemoryTerminologyServerValidationSupport separated from DefaultProfileValidationSupport leads me to the idea that all modules are sharing all Conformance Resources?</p>



<a name="196313780"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196313780" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196313780">(May 05 2020 at 14:18)</a>:</h4>
<p><em>push</em></p>



<a name="196359468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196359468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196359468">(May 05 2020 at 20:01)</a>:</h4>
<p><span class="user-mention" data-user-id="248736">@Mark Iantorno</span></p>



<a name="196636986"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196636986" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196636986">(May 06 2020 at 13:50)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span> can we have a quick call either tomorrow or Friday just so I can clarify this with you?</p>



<a name="196637306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196637306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196637306">(May 06 2020 at 13:52)</a>:</h4>
<p>Sure. Friday after 12:00 CET works best for me.</p>



<a name="196637947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196637947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196637947">(May 06 2020 at 13:56)</a>:</h4>
<p>What email can I send the invite to?</p>



<a name="196638390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196638390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196638390">(May 06 2020 at 13:59)</a>:</h4>
<p><a href="mailto:pw@molit.eu" title="mailto:pw@molit.eu">pw@molit.eu</a></p>



<a name="196638397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196638397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196638397">(May 06 2020 at 13:59)</a>:</h4>
<p>thank you!</p>



<a name="196638667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196638667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196638667">(May 06 2020 at 14:01)</a>:</h4>
<p>Sent.</p>



<a name="196685592"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196685592" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196685592">(May 06 2020 at 19:35)</a>:</h4>
<p>Could you perchance capture a summery if your discussion somewhere? - I would be interested <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="196836985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196836985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196836985">(May 07 2020 at 22:12)</a>:</h4>
<p>I'm gonna take a crack at these...</p>
<blockquote>
<p>SnapshotGeneratingValidationSupport know only takes the context, so no more wrapping - just putting it into the chain would be sufficient. Right? 'the validator will try each module in the chain until one of them returns a non-null response.' So the order of the Modules is important.</p>
</blockquote>
<p>Correct. SnapshotGen gets a back-reference to the whole chain when it's called, so it can look for any other resources it needs. It will use the whole chain to find anything.</p>
<blockquote>
<p>In the recipe: <a href="https://hapifhir.io/hapi-fhir/docs/validation/validation_support_modules.html#recipe-supplying-custom-definitions" title="https://hapifhir.io/hapi-fhir/docs/validation/validation_support_modules.html#recipe-supplying-custom-definitions">https://hapifhir.io/hapi-fhir/docs/validation/validation_support_modules.html#recipe-supplying-custom-definitions</a> default support is added before the PrePopulatedValidationSupport. To me this would mean that all validations are done by the DefaultProfileValidationSupport, as it supports all FHIR resource types, and PrePopulatedValidationSupport will never be called.</p>
</blockquote>
<p>DefaultProfileValidationSupport gets tried first as you suggest, but it can only supply the base definitions so I wouldn't expect that to be a bad thing. I would expect people to use PrePopulatedValidationSupport to supply profiles and definitions that build on the base definitions, as opposed to replacing them.</p>



<a name="196837013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196837013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196837013">(May 07 2020 at 22:13)</a>:</h4>
<p>(Sorry, not trying to override your call, just getting some info down)</p>



<a name="196866396"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/best%20practice%20for%20validation%20chain/near/196866396" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain.html#196866396">(May 08 2020 at 07:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="194703">Morten Ernebjerg</span> <a href="#narrow/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain/near/196685592" title="#narrow/stream/179167-hapi/topic/best.20practice.20for.20validation.20chain/near/196685592">said</a>:</p>
<blockquote>
<p>Could you perchance capture a summery if your discussion somewhere? - I would be interested <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>
</blockquote>
<p>sure! Will try to extend/improve the documentation about it.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
