---
layout: page
title: "FHIR Chat  · getting wrong result from FhirInstanceValidator while val... · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/getting.20wrong.20result.20from.20FhirInstanceValidator.20while.20val.2E.2E.2E.html">getting wrong result from FhirInstanceValidator while val...</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="164718828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/getting%20wrong%20result%20from%20FhirInstanceValidator%20while%20val.../near/164718828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aditya <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/getting.20wrong.20result.20from.20FhirInstanceValidator.20while.20val.2E.2E.2E.html#164718828">(May 02 2019 at 15:40)</a>:</h4>
<p>I am trying to use FhirInstanceValidator with following configuration :</p>
<div class="codehilite"><pre><span></span>compile group: &#39;ca.uhn.hapi.fhir&#39;, name: &#39;hapi-fhir-base&#39;, version: &#39;2.5&#39;
compile group: &#39;ca.uhn.hapi.fhir&#39;, name: &#39;hapi-fhir-structures-dstu3&#39;, version: &#39;2.5&#39;
compile group:&#39;ca.uhn.hapi.fhir&#39;, name:&#39;hapi-fhir-validation&#39;, version:&#39;3.7.0&#39;
compile group:&#39;ca.uhn.hapi.fhir&#39;, name:&#39;hapi-fhir-validation-resources-dstu3&#39;, version:&#39;3.7.0&#39;
</pre></div>


<p>However, I get result as true (ideally it should be false as Observation.status is mandatory) after executing following :</p>
<div class="codehilite"><pre><span></span>FhirContext ctx = FhirContext.forDstu3();

    // Create a FhirInstanceValidator and register it to a validator
    FhirValidator validator = ctx.newValidator();
    FhirInstanceValidator instanceValidator = new FhirInstanceValidator();
    validator.registerValidatorModule(instanceValidator);


    Observation obs = new Observation();
    obs.getCode().addCoding().setSystem(&quot;http://loinc.org&quot;).setCode(&quot;12345-6&quot;);
    obs.setValue(new StringType(&quot;This is a value&quot;));

    // Validate
    ValidationResult result = validator.validateWithResult(obs);
</pre></div>


<p>I am getting following in logs :</p>
<div class="codehilite"><pre><span></span>Unable to load resource: /org/hl7/fhir/instance/model/dstu3/profile/profiles-resources.xml
</pre></div>


<p>It seems that the org.hl7.fhir.dstu3.hapi.validation.DefaultProfileValidationSupport.java  has following code :</p>
<div class="codehilite"><pre><span></span> loadStructureDefinitions(theContext, structureDefinitions, &quot;/org/hl7/fhir/instance/model/dstu3/profile/profiles-resources.xml&quot;);
  loadStructureDefinitions(theContext, structureDefinitions, &quot;/org/hl7/fhir/instance/model/dstu3/profile/profiles-types.xml&quot;);
  loadStructureDefinitions(theContext, structureDefinitions, &quot;/org/hl7/fhir/instance/model/dstu3/profile/profiles-others.xml&quot;);
</pre></div>


<p>In the above code, the path to profile xml contains "<strong>/instance</strong>" and the word "dstu3" after word "model" however, the actual profiles in jar - hapi-fhir-validation-resources-dstu3-3.0.0.jar are at location </p>
<p><strong>/org/hl7/fhir/dstu3/model/profile/profiles-resources.xml</strong></p>
<p>Is this a bug in HAPI ?</p>



<a name="164926442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/getting%20wrong%20result%20from%20FhirInstanceValidator%20while%20val.../near/164926442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/getting.20wrong.20result.20from.20FhirInstanceValidator.20while.20val.2E.2E.2E.html#164926442">(May 05 2019 at 16:32)</a>:</h4>
<p>HAPI is definitely not designed to work with different versions of the library on your classparth. You should replace the <code>2.5</code> with <code>3.7.0</code> for all dependencies.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
