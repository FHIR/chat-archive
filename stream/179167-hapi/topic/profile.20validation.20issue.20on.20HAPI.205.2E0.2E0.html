---
layout: page
title: "FHIR Chat  · profile validation issue on HAPI 5.0.0 · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html">profile validation issue on HAPI 5.0.0</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="197690434"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197690434" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Job Schipper <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197690434">(May 15 2020 at 13:32)</a>:</h4>
<p>I'm getting a strange result when validating a Patient resource against a profile on HAPI 5.0.0 (public test server):</p>
<div class="codehilite"><pre><span></span><code>curl -X POST \
  &#39;http://hapi.fhir.org/baseDstu3/Patient/$validate&#39; \
  -H &#39;Cache-Control: no-cache&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -d &#39;{
    &quot;resourceType&quot;: &quot;Patient&quot;,
    &quot;meta&quot;: {
        &quot;profile&quot;: [
            &quot;http://fhir.nl/fhir/StructureDefinition/nl-core-patient&quot;
        ]
    },
    &quot;birthDate&quot;: &quot;1996-11-23&quot;
}&#39;
</code></pre></div>


<p>gives response:</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;OperationOutcome&quot;,
    &quot;text&quot;: {
        &quot;status&quot;: &quot;generated&quot;,
        &quot;div&quot;: &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&lt;h1&gt;Operation Outcome&lt;/h1&gt;&lt;table border=\&quot;0\&quot;&gt;&lt;tr&gt;&lt;td style=\&quot;font-weight: bold;\&quot;&gt;ERROR&lt;/td&gt;&lt;td&gt;[Patient.birthDate, Line 9, Col 2]&lt;/td&gt;&lt;td&gt;&lt;pre&gt;This element is not allowed by the profile http://fhir.nl/fhir/StructureDefinition/nl-core-patient&lt;/pre&gt;&lt;/td&gt;\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t&lt;/tr&gt;\n\t\t&lt;/table&gt;\n\t&lt;/div&gt;&quot;
    },
    &quot;issue&quot;: [
        {
            &quot;severity&quot;: &quot;error&quot;,
            &quot;code&quot;: &quot;processing&quot;,
            &quot;diagnostics&quot;: &quot;This element is not allowed by the profile http://fhir.nl/fhir/StructureDefinition/nl-core-patient&quot;,
            &quot;location&quot;: [
                &quot;Patient.birthDate&quot;,
                &quot;Line 9, Col 2&quot;
            ]
        }
    ]
}
</code></pre></div>


<p>As far as I can tell, patient.birthDate should be allowed in the profile, <code>Patient.birthDate</code> is available in the <code>differential.element[]</code> </p>
<div class="codehilite"><pre><span></span><code>curl -X GET \
  http://hapi.fhir.org/baseDstu3/StructureDefinition/nl-core-patient \
  -H &#39;Cache-Control: no-cache&#39; \
  -H &#39;Content-Type: application/json&#39; \
</code></pre></div>


<p>Any idea what's going on here?</p>



<a name="197726575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197726575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197726575">(May 15 2020 at 17:40)</a>:</h4>
<p>you'll have to post the particular version of that profile that the server has so I can look at it</p>



<a name="197794562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197794562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Job Schipper <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197794562">(May 16 2020 at 12:56)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> </p>
<div class="codehilite"><pre><span></span><code>curl -X GET \
  http://hapi.fhir.org/baseDstu3/StructureDefinition/nl-core-patient \
  -H &#39;Cache-Control: no-cache&#39; \
  -H &#39;Postman-Token: 3095eead-ce35-845e-8805-97ec445d3364&#39;
</code></pre></div>


<p>response: (too big to paste fully, but you can try the above curl request as it is a public server)</p>
<div class="codehilite"><pre><span></span><code>{
&quot;resourceType&quot;: &quot;StructureDefinition&quot;,
    &quot;id&quot;: &quot;nl-core-patient&quot;,
    &quot;meta&quot;: {
        &quot;extension&quot;: [
            {
                &quot;url&quot;: &quot;http://hapifhir.io/fhir/StructureDefinition/resource-meta-source&quot;,
                &quot;valueUri&quot;: &quot;#wffxp4ixe6AQSRW6&quot;
            }
        ],
        &quot;versionId&quot;: &quot;4&quot;,
        &quot;lastUpdated&quot;: &quot;2020-05-15T10:58:55.491+00:00&quot;
    },
    &quot;url&quot;: &quot;http://fhir.nl/fhir/StructureDefinition/nl-core-patient&quot;,

 ...

  &quot;differential&quot;: {
        &quot;element&quot;: [
        ...
            {
                &quot;id&quot;: &quot;Patient.birthDate&quot;,
                &quot;path&quot;: &quot;Patient.birthDate&quot;,
                &quot;short&quot;: &quot;Patients date of birth. The date of birth is mandatory for a patient. An incomplete date, e.g. only year or only year + month, is permitted.&quot;,
                &quot;alias&quot;: [
                    &quot;Geboortedatum&quot;
                ],
                &quot;mapping&quot;: [
                    {
                        &quot;identity&quot;: &quot;hcim-patient-v2.0.1-2015EN&quot;,
                        &quot;map&quot;: &quot;NL-CM:0.1.10&quot;,
                        &quot;comment&quot;: &quot;DateOfBirth&quot;
                    },
                    {
                        &quot;identity&quot;: &quot;hcim-patient-v3.0-2016EN&quot;,
                        &quot;map&quot;: &quot;NL-CM:0.1.10&quot;,
                        &quot;comment&quot;: &quot;DateOfBirth&quot;
                    },
                    {
                        &quot;identity&quot;: &quot;hcim-patient-v3.1-2017EN&quot;,
                        &quot;map&quot;: &quot;NL-CM:0.1.10&quot;,
                        &quot;comment&quot;: &quot;DateOfBirth&quot;
                    }
                ]
            },

        ...
        ]
</code></pre></div>



<a name="197813743"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197813743" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197813743">(May 16 2020 at 20:32)</a>:</h4>
<p><span class="user-mention" data-user-id="248736">@Mark Iantorno</span> this works for me fine when I extract out these resources and run them in the validator directly. So I'm mystified as to why this error would arise here. Is it possible that HAPI is serving up the wrong version of the profile internally?</p>



<a name="197813832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197813832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197813832">(May 16 2020 at 20:34)</a>:</h4>
<p>I can look into it for sure. The wrapper in HAPI doesn't include all the fields that the wrapper in the core validator does. I noticed this when I was doing my first attempt at test migration. It <em>may</em> be related to that. But I would have to look as there is a lot going on under the hood.</p>



<a name="197813869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197813869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197813869">(May 16 2020 at 20:35)</a>:</h4>
<p>I'm stepping away for today, but I can look into it on Monday if that's okay?</p>



<a name="197813934"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197813934" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197813934">(May 16 2020 at 20:36)</a>:</h4>
<p>there is indeed a lot. We might have to debug it together; the cause of the problem is that there's no match for dateOfBirth in InstanceValidator.assignChildren, but it clearly exists in the profile in question; so I assume it's not getting served up the profile in question correctly</p>



<a name="197840706"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/197840706" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Job Schipper <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#197840706">(May 17 2020 at 09:53)</a>:</h4>
<p>thanks for looking into this!</p>



<a name="198039878"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/198039878" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Job Schipper <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#198039878">(May 19 2020 at 09:13)</a>:</h4>
<p>any new findings?</p>



<a name="198115444"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/198115444" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#198115444">(May 19 2020 at 19:32)</a>:</h4>
<p><span class="user-mention" data-user-id="294094">@Job Schipper</span> are you able to replicate this on <a href="http://hapi.fhir.org">hapi.fhir.org</a>? That might be helpful to help us create a test case</p>



<a name="198670106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/198670106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Job Schipper <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#198670106">(May 25 2020 at 13:42)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> I was, the example i posted was using that server. However, I just re-ran it and now the validation passes. Has there been a release in the meantime?</p>



<a name="198700283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/profile%20validation%20issue%20on%20HAPI%205.0.0/near/198700283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/profile.20validation.20issue.20on.20HAPI.205.2E0.2E0.html#198700283">(May 25 2020 at 20:29)</a>:</h4>
<p>Quite possibly- We redeploy fairly frequently and it's entirely possible that this has been fixed.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
