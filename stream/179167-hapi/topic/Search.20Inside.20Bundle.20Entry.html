---
layout: page
title: "FHIR Chat  · Search Inside Bundle Entry · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html">Search Inside Bundle Entry</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="217326566"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217326566" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chiranjiv Roy <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217326566">(Nov 19 2020 at 20:32)</a>:</h4>
<p>We have bundles stored in fhir server as 'document'. These bundles have resources of resourceType 'composition'. We want to search with identifier in these composite resources inside the bundle. Is it possible with hapi fhir?<br>
Example bundle: <a href="http://hapi.fhir.org/baseR4/Bundle/1680668">http://hapi.fhir.org/baseR4/Bundle/1680668</a><br>
We want to search resources inside this bundle that match this zdnumber:<br>
"identifier": {<br>
"system": "<a href="http://zorgdomein.nl/zdnumber/">http://zorgdomein.nl/zdnumber/</a>",<br>
"value": "ZP10006208"<br>
},</p>



<a name="217369580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217369580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bishakh Ghosh <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217369580">(Nov 20 2020 at 07:33)</a>:</h4>
<p>Interesting. Can somebody suggest something?</p>



<a name="217387712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217387712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217387712">(Nov 20 2020 at 11:09)</a>:</h4>
<p>I would suggest to not persist the whole bundle, but the individual resources. If you need the document, generate it with $document operation.</p>



<a name="217387845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217387845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217387845">(Nov 20 2020 at 11:10)</a>:</h4>
<p>Bundle has the searchParameter <code>composition</code>, this would work if hapi would support identifier references: <code>http://hapi.fhir.org/baseR4/Bundle?composition:identifier=ZP10006208</code></p>



<a name="217391917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217391917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217391917">(Nov 20 2020 at 11:59)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span> doesn't that only apply for the identifier of the document itself? It sounds like the need here is to search for references inside the document</p>



<a name="217392159"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217392159" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217392159">(Nov 20 2020 at 12:02)</a>:</h4>
<p>Ah, you are right. I thought the question was only about the composition identifier.</p>



<a name="217392190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217392190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217392190">(Nov 20 2020 at 12:02)</a>:</h4>
<p>Then i would go with individual resources</p>



<a name="217399242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217399242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217399242">(Nov 20 2020 at 13:18)</a>:</h4>
<p>Followed<span aria-label="fire" class="emoji emoji-1f525" role="img" title="fire">:fire:</span></p>



<a name="217442074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217442074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217442074">(Nov 20 2020 at 18:42)</a>:</h4>
<p>or ... add custom search indexes into the bundle according to your needs. We actually did that in an installation as the storing of the document was way faster compared to splitting it up and store the entries individually (there where roughly 200 entries in the document if I remember correctly).</p>



<a name="217442131"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217442131" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217442131">(Nov 20 2020 at 18:43)</a>:</h4>
<p>storing the document was a matter of millis - whereas storing 200 entries took around 2-3 secs</p>



<a name="217442262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217442262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217442262">(Nov 20 2020 at 18:44)</a>:</h4>
<p>and ofc. one could then create an async job to do the splitting afterwards ... but then we are talking a bit more complexity</p>



<a name="217487152"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217487152" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217487152">(Nov 21 2020 at 06:00)</a>:</h4>
<p>How about both storing the document (including the individual resource entries) and storing the entries?</p>



<a name="217487166"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217487166" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217487166">(Nov 21 2020 at 06:01)</a>:</h4>
<p>Is it allowable/permitted according to the FHIR spec?</p>



<a name="217488140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217488140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217488140">(Nov 21 2020 at 06:33)</a>:</h4>
<p>We add a facade in front of the hapi server which converts the message or document into a transaction bundle. <br>
This stored a lot faster in hapi</p>



<a name="217498820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217498820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217498820">(Nov 21 2020 at 11:59)</a>:</h4>
<p><span class="user-mention" data-user-id="191687">@Kevin Mayfield</span> you did that synchronously without a performance penalty?</p>



<a name="217501014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217501014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217501014">(Nov 21 2020 at 13:02)</a>:</h4>
<p>Sync, individually it was taking around 2-3 mins, afterwards less than  a minute</p>



<a name="217501106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217501106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217501106">(Nov 21 2020 at 13:05)</a>:</h4>
<p>Well ... I have 400 ms - but good to know others also have had a look at this</p>



<a name="217510175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217510175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Derek Ritz <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217510175">(Nov 21 2020 at 17:18)</a>:</h4>
<p>Please can I confirm what I think I'm understanding, here... If a <strong>document</strong> is persisted to the FHIR server (that includes a composition... such as an International Patient Summary, for example) -- then the resources <em>inside</em> the document, such as medication statement etc.,  are <strong>not</strong> individually searchable. Do I understand that correctly?</p>



<a name="217568302"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217568302" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217568302">(Nov 22 2020 at 20:28)</a>:</h4>
<p>Yes</p>



<a name="217773222"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217773222" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Derek Ritz <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217773222">(Nov 24 2020 at 15:58)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191687">@Kevin Mayfield</span> . Is it true that they are not searchable only within the document itself... or is it also true that they are not discoverable when looking for (for example) medication orders related to the patient?</p>



<a name="217782074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217782074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217782074">(Nov 24 2020 at 16:55)</a>:</h4>
<p>I understand it is stored in HAPI as a Bundle, so only the Bundle is searchable. Not it's contents, so I don't believe either would work. <br>
If you break up the bundle into it's component parts and store those in HAPI separately it would be searchable.</p>



<a name="217782818"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217782818" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217782818">(Nov 24 2020 at 17:00)</a>:</h4>
<p>yep - or add custom search parameters (as described pr. <a href="https://blog.smilecdr.com/2017/02/08/custom-search-parameters-in-hapi-fhir/">https://blog.smilecdr.com/2017/02/08/custom-search-parameters-in-hapi-fhir/</a>)</p>



<a name="217782892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217782892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217782892">(Nov 24 2020 at 17:01)</a>:</h4>
<p>that points inside the bundle that is - but that shouldn't be your first resort</p>



<a name="217949602"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20Inside%20Bundle%20Entry/near/217949602" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Derek Ritz <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20Inside.20Bundle.20Entry.html#217949602">(Nov 25 2020 at 23:08)</a>:</h4>
<p>Thanks, guys... this is helpful. <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
