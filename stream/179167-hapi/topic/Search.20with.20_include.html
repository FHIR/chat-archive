---
layout: page
title: "FHIR Chat  · Search with _include · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20with.20_include.html">Search with _include</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="273522066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20with%20_include/near/273522066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gordon Wilkinson <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20with.20_include.html#273522066">(Feb 28 2022 at 17:10)</a>:</h4>
<p>I am using JPA starter to handle FHIR CRUD and search requests.    <br>
My problem is that search requests with _include and _revinclude parameters do not return the resources referenced by EnrollmentRequest in the request response Bundle.   </p>
<p>For reference there are 2 EnrollmentRequest resources in my test FHIR db. </p>
<p>My search request is;</p>
<div class="codehilite" data-code-language="val"><pre><span></span><code>      .search()
      .forResource(classOf[EnrollmentRequest])
      .include(new Include("EnrollmentRequest:*", true))
      .revInclude(new Include("Provenance:target"))
      .returnBundle(classOf[Bundle])
      .execute() ```

The expected search parameters are generated;    ?_include%3Aiterate=EnrollmentRequest%3A*&amp;_revinclude=Provenance%3Atarget
          "link" : [
            {
              "relation" : "self",
              "url" : "http://fhir-server:8011/fhir/f5f48a7b-c1ce-40e6-88e7-bf9c13785b07/EnrollmentRequest?_include%3Aiterate=EnrollmentRequest%3A*&amp;_revinclude=Provenance%3Atarget"
            }
          ],


SearchBuilder logs indicate that the referenced resources (1 patient, 1 coverage, 2 coverage) for each of the 2 EnrollmentRequest stored in the FHIR db.
022-02-28 16:52:04.966 [http-nio-8080-exec-10] INFO  c.u.f.j.search.builder.SearchBuilder [SearchBuilder.java:966] Loaded 2 _revincludes in 1 rounds and 11 ms for search 93515fa3-3754-4e2f-88e9-8b9b854fe9b0
2022-02-28 16:52:04.983 [http-nio-8080-exec-10] INFO  c.u.f.j.search.builder.SearchBuilder [SearchBuilder.java:966] Loaded 8 _includes in 3 rounds and 17 ms for search 93515fa3-3754-4e2f-88e9-8b9b854fe9b0

2022-02-28 16:52:05.303 [http-nio-8080-exec-10] INFO  fhirtest.access [LoggingInterceptor.java:175] Path[/fhir] Source[] Operation[search-type  EnrollmentRequest] UA[HAPI-FHIR/5.5.1 (FHIR Client; FHIR 4.0.1/R4; apache)] Params[?_include%3Aiterate=EnrollmentRequest%3A*&amp;_revinclude=Provenance%3Atarget] ResponseEncoding[JSON] Operation[search-type  EnrollmentRequest] UA[HAPI-FHIR/5.5.1 (FHIR Client; FHIR 4.0.1/R4; apache)] Params[?_include%3Aiterate=EnrollmentRequest%3A*&amp;_revinclude=Provenance%3Atarget] ResponseEncoding[JSON]

Finally when I curl  &lt;base&gt;/&lt;partition&gt;/EnrollmentRequest/_search?_include=EnrollmentRequest%3A*&amp;_revinclude=Provenance%3Atarget
the response does includes the expected  referenced resources(Patient, Coverage, Organization resources).

Any direction appreciated.
</code></pre></div>



<a name="275748073"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20with%20_include/near/275748073" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20with.20_include.html#275748073">(Mar 18 2022 at 00:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453879">Gordon Wilkinson</span> has marked this topic as unresolved.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
