---
layout: page
title: "FHIR Chat  · Bundle search using composition attributes · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html">Bundle search using composition attributes</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="156684079"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156684079" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lars Rückert <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156684079">(Jan 23 2019 at 12:18)</a>:</h4>
<p>Hello,</p>
<p>I am trying to implement my own operation on the Bundle type, to retrieve document bundles for a given Patient.<br>
To do this I need to figure out how I can search on Bundles using the attributes of the composition, specifically the subject.<br>
According to what I understood reading the FHIR API it should be possible to search for this using chained parameters like so: &lt;url&gt;/Bundle?composition.subject=&lt;id&gt;.</p>
<p>This does however not work. I tried it on <a href="http://hapi.fhir.org/baseDstu3" target="_blank" title="http://hapi.fhir.org/baseDstu3">http://hapi.fhir.org/baseDstu3</a> using this example Bundle <a href="http://hapi.fhir.org/baseDstu3/Bundle/1230334" target="_blank" title="http://hapi.fhir.org/baseDstu3/Bundle/1230334">http://hapi.fhir.org/baseDstu3/Bundle/1230334</a>.<br>
(I also tried it using other bundles with the same result, in case this one didn't work.)</p>
<p>Some of the requests I tried:<br>
<a href="http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=941852" target="_blank" title="http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=941852">http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=941852</a> -&gt; 0 results<br>
<a href="http://hapi.fhir.org/baseDstu3/Bundle?composition.patient=941852" target="_blank" title="http://hapi.fhir.org/baseDstu3/Bundle?composition.patient=941852">http://hapi.fhir.org/baseDstu3/Bundle?composition.patient=941852</a> -&gt; 0 results<br>
<a href="http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=Patient/941852" target="_blank" title="http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=Patient/941852">http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=Patient/941852</a> -&gt; Error: "theResourceName must not be blank"<br>
I also tried variations with more type specifications or using the ID of the composition instead of the subject, but nothing worked.</p>
<p>However, using the example from the search reference of the STU3 search reference works:<br>
<a href="http://hapi.fhir.org/baseDstu3/DiagnosticReport?subject.name=peter" target="_blank" title="http://hapi.fhir.org/baseDstu3/DiagnosticReport?subject.name=peter">http://hapi.fhir.org/baseDstu3/DiagnosticReport?subject.name=peter</a> does yield results.</p>
<p>I would really appreciate some pointers on how I can get this search on the composition attributes to work, or if it is even possible.<br>
As I am implementing an Operation in the server, therefore I also have access to the BundleResourceProvider and the Dao.</p>
<p>Thanks</p>



<a name="156686512"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156686512" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156686512">(Jan 23 2019 at 13:00)</a>:</h4>
<p>Hi Lars,</p>
<p>$document is already implemented in hapi, so you don't have to implement it yourself</p>



<a name="156686654"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156686654" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156686654">(Jan 23 2019 at 13:02)</a>:</h4>
<p>the query you are looking for is: <a href="http://hapi.fhir.org/baseDstu3/Composition?subject=Patient/941852" target="_blank" title="http://hapi.fhir.org/baseDstu3/Composition?subject=Patient/941852">http://hapi.fhir.org/baseDstu3/Composition?subject=Patient/941852</a></p>



<a name="156686769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156686769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156686769">(Jan 23 2019 at 13:04)</a>:</h4>
<p>Then you parse the Composition resource and invoke $document like this:<br>
<a href="http://hapi.fhir.org/baseDstu3/Composition/1230333/$document" target="_blank" title="http://hapi.fhir.org/baseDstu3/Composition/1230333/$document">http://hapi.fhir.org/baseDstu3/Composition/1230333/$document</a></p>



<a name="156686821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156686821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156686821">(Jan 23 2019 at 13:05)</a>:</h4>
<p>We had a productive bof session at the dev days Amsterdam to create a custom operation which would allow to execute the search and the document creation in one call.</p>



<a name="156691963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156691963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lars Rückert <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156691963">(Jan 23 2019 at 14:19)</a>:</h4>
<p>Hi Patrick,</p>
<p>thank you for the answer, I think this will help.<br>
Unfortunately I currently have the bundle only as the self contained bundle, so there is no composition in my fhir server.<br>
Is there also the reverse operation of $document, which takes an incoming bundle and splits it up to store all the components of the document where they belong?</p>



<a name="156758952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156758952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156758952">(Jan 24 2019 at 09:16)</a>:</h4>
<p>Ahh, now i understand the problem. You are right <a href="http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=Patient/941852" target="_blank" title="http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=Patient/941852">http://hapi.fhir.org/baseDstu3/Bundle?composition.subject=Patient/941852</a> should work, but doesn't.<br>
I'll have a look at this issue.</p>



<a name="156759086"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/156759086" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lars Rückert <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#156759086">(Jan 24 2019 at 09:19)</a>:</h4>
<p>Thank you very much!</p>



<a name="157171455"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/157171455" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lars Rückert <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#157171455">(Jan 30 2019 at 08:51)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span> Any news on this issue?</p>



<a name="157197892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20search%20using%20composition%20attributes/near/157197892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20search.20using.20composition.20attributes.html#157197892">(Jan 30 2019 at 16:02)</a>:</h4>
<p>didn't had time to look into it yet :-/ I hope i'll  have some time this weekend.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
