---
layout: page
title: "FHIR Chat  · Chaining multi-level+Remote patient monitoring · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html">Chaining multi-level+Remote patient monitoring</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="220667213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220667213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220667213">(Dec 22 2020 at 08:13)</a>:</h4>
<p><strong>TL;DR</strong> </p>
<p><strong>Is there a query that can directly return me the practitioners and the careteam, given device ID</strong>? </p>
<hr>
<p>I've been working on a small learning goal, so that I can better accustom myself with FHIR. </p>
<p>The idea is, there's a bunch of devices that are with a patient, and the <code>device</code> is associated with a patient. Now, when a certain patient-limit is exceeded for a patient reading, I need to send notifications to practitioners in the patient's <code>careteam</code>. </p>
<p>What I did is, when I get a message from a device through a webhook callback, I lookup the FHIR device that has the device identifier, grab the patient ID, and then get the <code>careteam</code> and <code>practitioner</code>s in there. Once I have that, I am able to run some code that handles notifications (I fetch the practitioners, from the careteam too, since I store the notification IDs in the <code>Practitioner.identifier</code>). </p>
<p>Now, for some of the questions I have. </p>
<ul>
<li>Is there a query that can directly return me the practitioners and the careteam, given device ID? I'm currently making 3 hops (<code>device</code> -&gt; <code>careteam</code> (using <code>device.patientid</code>) -&gt; <code>practitioner</code>s). I plan to use a bundle so that I can get this all in a single API call, but wanted to know if there was a better way</li>
<li>I am storing the patent's limits in the device assigned to them as extensions, is that okay? </li>
<li>I also need to update the code to facilitate preferences for <code>careteam</code> notifications, in the sense that when a measurement is out of bounds, I must send notif to only those practitioners in this <code>careteam</code> that have <code>yes</code>  stored somewhere. Where do I store this preference? I was thinking perhaps as a <code>base64</code> string  under the <code>careteam</code> as an extension, so that I need only fetch the <code>practitioner</code>s that have yes stored here.</li>
</ul>



<a name="220674413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220674413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vibin_chander <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220674413">(Dec 22 2020 at 09:57)</a>:</h4>
<p>Im having some same problem but with different use-case. I used the _include &amp; _revinclude to solve them</p>



<a name="220674462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220674462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vibin_chander <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220674462">(Dec 22 2020 at 09:58)</a>:</h4>
<p>Can you also try using _include or _revinclude search param?</p>



<a name="220674514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220674514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vibin_chander <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220674514">(Dec 22 2020 at 09:59)</a>:</h4>
<p>But using these param too im unable to fetch more than 2 resources at a time. I dont see any straight forward solution for this use case .." List of all resources for a selected patient"</p>



<a name="220675169"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220675169" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220675169">(Dec 22 2020 at 10:08)</a>:</h4>
<p>Yeah <code>_include</code>! I'll give that a go thanks!</p>



<a name="220675969"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220675969" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220675969">(Dec 22 2020 at 10:21)</a>:</h4>
<p>Hmm so given a device ID, I can get both the device and the patient using <code>_include</code>, but what I really need are the practitioners. So I'm looking for a query that'll list <code>practitioner</code>s given a device ID, by possibly traversing <code>deviceID -&gt; patient -&gt; careteam -&gt; practitioners</code></p>



<a name="220676053"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220676053" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220676053">(Dec 22 2020 at 10:23)</a>:</h4>
<p>I'm trying <code>_has</code>, this works to get patients that have a deviceID <code>[base]/Patient?_has:Device:patient:_id=1722695</code></p>



<a name="220681535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220681535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220681535">(Dec 22 2020 at 11:48)</a>:</h4>
<p>Okay made some progress, given a patientID, to get practitioners that are in the careteam, can use this</p>
<p><code>http://hapi.fhir.org/baseR4/Practitioner?_has:CareTeam:participant:subject={patientId}</code></p>
<p>Now,  just need a way to just pass in the device ID and am good</p>



<a name="220681741"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220681741" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220681741">(Dec 22 2020 at 11:52)</a>:</h4>
<p>In general, I'm not sure I completely understand what the 3 parts of the <code>_has</code> are. From the docs, I think it has to be <br>
<code>[base]/Resource?_has:Something:Reference(s):query</code> such that <code>Something</code> references <code>Resource</code> (be it a single or multiple). Is that correct?</p>



<a name="220682653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220682653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220682653">(Dec 22 2020 at 12:06)</a>:</h4>
<p>Example <a href="https://www.hl7.org/fhir/search.html#has">here</a> seems to traverse 2 references: <code>patient</code>s have an<code>Observation</code> where it has an <code>audit event</code> from a specific user</p>
<p>Query is: <code>GET [base]/Patient?_has:Observation:patient:_has:AuditEvent:entity:user=MyUserId</code></p>
<p>On the same lines, practitioners that have careteams where it has a patient with a specific ID</p>
<p>I tried <code>GET [base]/Practitioner?_has:CareTeam:participant:_has:Device:patient:_id=deviceId</code>, but returns 0 resources. </p>
<p>Here's the resources I'm testing with. <br>
Patient id: 1714653<br>
Device id: 1722695<br>
CareTeam: 1714654</p>



<a name="220689140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220689140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220689140">(Dec 22 2020 at 13:34)</a>:</h4>
<p>I'm starting to think this isn't possible, or is it</p>



<a name="220691637"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220691637" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220691637">(Dec 22 2020 at 14:02)</a>:</h4>
<p>Nested _has statements may not be supported by the server. Please look at the 'self' link in the response bundle to verify which parts of your search URL are supported by the server.</p>



<a name="220760894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220760894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220760894">(Dec 23 2020 at 04:42)</a>:</h4>
<p>I'm using the public HAPI server (<a href="http://hapi.fhir.org/baseR4">http://hapi.fhir.org/baseR4</a>), I think it does support nesting</p>



<a name="220761682"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220761682" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220761682">(Dec 23 2020 at 05:05)</a>:</h4>
<p>Hmm Not sure if <code>hapi.fhir.org/baseR4</code> supports it, since the example for <code>Reverse Chaining</code> on the docs gives this error<br>
<code>Unknown parameter name: AuditEvent:user</code></p>



<a name="220762549"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220762549" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220762549">(Dec 23 2020 at 05:30)</a>:</h4>
<p>I can't seem to use <code>Bundle</code> either, to get resources together. I assumed <code>fullurl</code> would be used. </p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;Bundle&quot;,
    &quot;entry&quot;: [
        {
            &quot;fullUrl&quot;: &quot;urn:uuid:b8dea8f5-ef2a-45e4-8f4f-48b71a45e932&quot;,
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Device&quot;
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;Device?_id=1722695&quot;
            }
        },
        {
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Patient&quot;
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;Patient?_has:Device:patient:_id=urn:uuid:b8dea8f5-ef2a-45e4-8f4f-48b71a45e932&quot;
            }
        }
    ]
}
</code></pre></div>
<p>What I'm trying to do is, get the patient that the device refers to.  I could just use <code>_include</code>, but something like this is to see if I can reference the next resource to <code>GET</code> in the bundle based on the identity of the previous <code>GET</code> in the bundle. Is that possible?</p>



<a name="220763847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220763847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220763847">(Dec 23 2020 at 06:09)</a>:</h4>
<p>If that works, it'll be possible to create a request that <strong>returns me a careteam given a device ID associated with a patient</strong></p>



<a name="220764289"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220764289" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220764289">(Dec 23 2020 at 06:22)</a>:</h4>
<p>When I try this, I get this error </p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;Bundle&quot;,
    &quot;type&quot;: &quot;batch&quot;,
    &quot;entry&quot;: [
        {
            &quot;fullUrl&quot;: &quot;urn:uuid:8f2675f5-0961-4d11-bb81-398ffeae4d32&quot;,
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Device&quot;,
                &quot;id&quot;: &quot;urn:uuid:8f2675f5-0961-4d11-bb81-398ffeae4d32&quot;
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;Device?_id=1722695&quot;
            }
        },
        {
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Patient&quot;
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;Patient?_has:Device:patient:_id=urn:uuid:8f2675f5-0961-4d11-bb81-398ffeae4d32&quot;
            }
        }
    ]
}
</code></pre></div>
<p>First part  gives error <code>Invalid placeholder ID found: urn:uuid:8f2675f5-0961-4d11-bb81-398ffeae4d32 - Must be of the form 'urn:uuid:[uuid]' or 'urn:oid:[oid]'</code></p>



<a name="220768014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220768014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220768014">(Dec 23 2020 at 07:58)</a>:</h4>
<p>In a Bundle, the use of a urn:uuid: fullURL mostly indicates that the resource isn't actually available at a URL. The id would be just the UUID, without the urn:uuid: part. See Bundle for an explanation of this usage. <br>
How about: Patient?_has=Device:patient:_id=xxxx&amp;_revinclude=CareTeam:patient&amp;_include:iterate=CareTeam:participant:Practitioner ?</p>



<a name="220773705"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220773705" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220773705">(Dec 23 2020 at 09:36)</a>:</h4>
<p>Wow that's amazing! This works! <code>Patient?_has:Device:patient:_id=xxxx&amp;_revinclude=CareTeam:patient&amp;_include:iterate=CareTeam:participant:Practitioner</code></p>
<p>Removing the <code>urn:uuid</code> didn't work though... Did you mean something like this? But either way, is there a way I can reference a next <code>GET</code> based on the previous <code>GET</code>,  so that I can query the latter resource based on the results of the first one?</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;Bundle&quot;,
    &quot;type&quot;: &quot;batch&quot;,
    &quot;entry&quot;: [
        {
            &quot;fullUrl&quot;: &quot;urn:uuid:8f2675f5-0961-4d11-bb81-398ffeae4d32&quot;,
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Device&quot;,
                &quot;id&quot;: &quot;8f2675f5-0961-4d11-bb81-398ffeae4d32&quot;
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;Device?_id=1722695&quot;
            }
        },
        {
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Patient&quot;
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;Patient?_has:Device:patient:_id=urn:uuid:8f2675f5-0961-4d11-bb81-398ffeae4d32&quot;
            }
        }
    ]
}
</code></pre></div>



<a name="220774228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220774228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220774228">(Dec 23 2020 at 09:44)</a>:</h4>
<p>Not in one go, as e.g. a Batch. That's two separate GETs one would have to do as a client.</p>



<a name="220774736"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220774736" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220774736">(Dec 23 2020 at 09:52)</a>:</h4>
<p>Ahh okay, because that would be an excellent feature!</p>
<p>I'm now trying this. given a device ID, is it possible, in one request, to get the careteam? (devce -&gt; patient -&gt; careteam). I'm trying something like this, but I think that's not how <code>_has</code> works. <br>
<code>/CareTeam?subject:_has:Device:patient:_id=deviceId</code> returns nothing, but curiously, <br>
<code>/CareTeam?subject:_has:Device:patient:_id=patientId</code> returns the careteam with subject as <code>patientId</code></p>



<a name="220774909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220774909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220774909">(Dec 23 2020 at 09:55)</a>:</h4>
<p>That's a chained _has, which you tried and is not supported by your server. _revincludes are a good alternative, but it means your response bundle will have to be filtered by the client to select (only) the CareTeam resources.</p>



<a name="220775104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220775104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220775104">(Dec 23 2020 at 09:58)</a>:</h4>
<p>Actually, it's one forward reference and one reverse reference (my bad).</p>



<a name="220775343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220775343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220775343">(Dec 23 2020 at 10:02)</a>:</h4>
<p>Yeah one forward and one back, so I thought I could select on the subject and slap a <code>_has</code> there. But yes, if <code>_has</code> support isn't there, your approach is the way to go, thank you very much!</p>
<blockquote>
<p>not supported by your server</p>
</blockquote>
<p>HAPI doesn't have support for chained <code>_has</code>? How do I check this? I got the <code>CapabilityStatement</code>, can't find anything there on feature support. Is that the right place to look for?</p>



<a name="220775481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220775481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220775481">(Dec 23 2020 at 10:04)</a>:</h4>
<p>The CapStatement should list support for _has, but AFAIK there's no way to express the 'max chaining depth'. Search has many complex options that aren't fully expressed in the CapStatement.</p>



<a name="220775919"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220775919" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220775919">(Dec 23 2020 at 10:11)</a>:</h4>
<p>I can't seem to find it here <code>http://hapi.fhir.org/baseR4/CapabilityStatement</code>, nothing about <code>_has</code>, or <code>chain</code>. What am I missing?</p>



<a name="220784573"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220784573" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220784573">(Dec 23 2020 at 12:30)</a>:</h4>
<p><a href="http://rest.resource.searchParam.name">rest.resource.searchParam.name</a> can be "_has" for a particular resource type</p>



<a name="220848637"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220848637" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220848637">(Dec 24 2020 at 04:46)</a>:</h4>
<p>I see, okay. So I guess <code>http://hapi.fhir.org/baseR4/</code> does not have it, since I can't find "_has" anywhere.<br>
Your query workaround was brilliant! <br>
Thanks for the help!</p>



<a name="220848821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220848821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220848821">(Dec 24 2020 at 04:53)</a>:</h4>
<p>So for each patient, I want to setup limits per patient, in the sense that I am interested in knowing when a particular reading for a patient goes beyond the safe ranges for them. So, I'm thinking of storing these limits as extensions in the <code>Device</code> resource (since it's assigned to them, and no one else). Is that the right way to go about it?</p>



<a name="220854162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220854162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220854162">(Dec 24 2020 at 07:25)</a>:</h4>
<p>Well, if the device produces Observations, then we'd be talking about a reference range, which is part of Observation. If we're talking about device setting (e.g. an implantable device, e.g. pacemaker), then these would be device parameters. In the latter case I suggest you put your question on the #devices stream.</p>



<a name="220854283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220854283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220854283">(Dec 24 2020 at 07:29)</a>:</h4>
<p>It's not an implantable device (for now I guess), but things like BP machines etc. For the reference range, I'll need to what the ranges are to populate them in the <code>Observation</code>, correct? Where would I store these numbers? I thought I'd just store the ranges as a base64 string in the device info as an extension (doesn't feel right though), so that when I get an JSON payload from the device (just has values and an <code>identifier</code>), I can query the FHIR <code>Device</code> (based on <code>jsonPayload.identifier</code>), get the limits (from <code>Device.Extension</code>), check for limits, and if out of range, send notifications to practitioners (thanks to the query you've kindly formulated!)</p>



<a name="220854635"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220854635" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220854635">(Dec 24 2020 at 07:39)</a>:</h4>
<p>Assuming there is some clinical process, with a responsible clinician, for determining the reference ranges for a specific patient, you'd need to capture more than just a reference range, because you'd also need to capture who defined the reference range for a patient, and when they did so. So that makes it sound like you'd attach an Observation with as subject the Patient, Observation.device the reference to the device (or perhaps Observation.focus, given that the device is not used to observe its own reference range, which is implied by using Observation.device),  and with the value of the observation using the valueRange data type.</p>



<a name="220858330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220858330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220858330">(Dec 24 2020 at 09:13)</a>:</h4>
<p>My bad I should've mentioned this is remote patient monitoring.</p>
<p>Devices are assigned to a patient either by the 'admins', or <code>Practitioner</code>s from the patient's <code>CareTeam</code>.  Where do I store this info? Device doesn't seem to have an attribute for this (who assigned this device). </p>
<p>During assignment, they also add in the the ideal ranges for that patient-device pair. What do I do in this case? I'm capturing other parameters as you described (<code>valueRange</code> or <code>component</code>, <code>Device</code>,  <code>effectiveInstant</code>, so I got that right I guess :) )</p>



<a name="220861494"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220861494" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220861494">(Dec 24 2020 at 10:28)</a>:</h4>
<p>Well, this is getting beyond my area of expertise, so like you I'll await comments by those more in the know.</p>



<a name="220862038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220862038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220862038">(Dec 24 2020 at 10:41)</a>:</h4>
<p>No issues, thank you for helping me out so far!</p>



<a name="220866071"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220866071" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220866071">(Dec 24 2020 at 12:12)</a>:</h4>
<p>In C#, should I use the <code>decimal</code> or <code>double</code> for medical values? Looking the FhirDecimal, I think I must use <code>decimal</code></p>



<a name="220866358"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/220866358" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#220866358">(Dec 24 2020 at 12:19)</a>:</h4>
<p>Also, for some cases, a device gives multiple measurements. Such as systolic, diastolic and pulse. In this case, do I create a single <code>Observation</code> or multiple? From the example in the docs, I see that <code>Systolic</code> and <code>Diastolic</code> are grouped together in <code>component</code>, should pulse be included in that too?</p>



<a name="222062473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222062473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222062473">(Jan 08 2021 at 11:37)</a>:</h4>
<blockquote>
<p><a href="https://hapi.fhir.org/baseR4/Patient?_has:Device:patient:identifier=device_id&amp;_include:iterate=CareTeam:participant:Practitioner&amp;_revinclude=CareTeam:patient&amp;_include=Device">https://hapi.fhir.org/baseR4/Patient?_has:Device:patient:identifier=device_id&amp;_include:iterate=CareTeam:participant:Practitioner&amp;_revinclude=CareTeam:patient&amp;_include=Device</a></p>
</blockquote>
<p>I noticed just now that this returns all devices under that patient, how do I narrow this to just the specific device I want?</p>



<a name="222705894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222705894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222705894">(Jan 14 2021 at 11:30)</a>:</h4>
<p>I hope it's okay to tag you <span class="user-mention" data-user-id="191372">@René Spronk</span>. When possible, could you kindly help me out narrowing the above query down? Thank you very much!</p>



<a name="222708094"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222708094" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222708094">(Jan 14 2021 at 12:01)</a>:</h4>
<p>_include and _revinclude don't allow one to specify conditions. If you want a subset of Devices, then you would have to use Device as your focal resource. But that would mean rewriting the entire query URL..</p>



<a name="222708210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222708210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222708210">(Jan 14 2021 at 12:02)</a>:</h4>
<p>Yikes, thought so. Maybe there's a way I can use Bundle type request to get what I want? But I think there's no way to have a GET in a bundle that's dependent on what the previous GET had generated in the bundle</p>



<a name="222708678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222708678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222708678">(Jan 14 2021 at 12:08)</a>:</h4>
<p>correct. But you could use 2 GETs that both use the very same device_id as one of their parameters.</p>



<a name="222708931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222708931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222708931">(Jan 14 2021 at 12:12)</a>:</h4>
<p>Hmm that makes sense, maybe 2/3 GET based on your pattern to get the patient, careteam and the devices. I think I can just remove the _include from the query you kindly took the time to give me, and then a single query to get the device</p>



<a name="222712900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222712900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222712900">(Jan 14 2021 at 12:58)</a>:</h4>
<p>Yep this works, </p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;Bundle&quot;,
    &quot;entry&quot;: [
        {
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;/Device?identifier=DEVICE_IDENTIFIER&quot;
            }
        },
        {
            &quot;request&quot;: {
                &quot;method&quot;: &quot;GET&quot;,
                &quot;url&quot;: &quot;/Patient?_has:Device:patient:identifier=DEVICE_IDENTIFIER&amp;_include:iterate=CareTeam:participant:Practitioner&amp;_revinclude=CareTeam:patient&quot;
            }
        }
    ]
}
</code></pre></div>



<a name="222804877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/222804877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#222804877">(Jan 15 2021 at 00:31)</a>:</h4>
<p>Interesting<span aria-label="fire" class="emoji emoji-1f525" role="img" title="fire">:fire:</span></p>



<a name="226514905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/226514905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#226514905">(Feb 16 2021 at 13:53)</a>:</h4>
<p>I'm trying this now, given a patient, I want to get the <code>CareTeam</code>, <code>Practitioner</code>, and <code>PractitionerRole</code>, and I have this so far</p>
<div class="codehilite"><pre><span></span><code>https://hapi.fhir.org/baseR4/CareTeam
?subject=1852580
&amp;_include=CareTeam:subject
&amp;_include=CareTeam:participant
&amp;_revinclude=PractitionerRole:Practitioner
</code></pre></div>
<p>The last bit, retrieving the <code>PractitionerRole</code> doesn't work. I think the server supports revinclude since I recall a request where I could revinclude other resources. Specifically, this works <code>https://hapi.fhir.org/baseR4/Patient?_id=1852580&amp;_revinclude=CareTeam:subject</code>, and similar for getting a <code>PractitionerRole</code> that refers to a <code>Practitioner</code></p>



<a name="230033843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Chaining%20multi-level%2BRemote%20patient%20monitoring/near/230033843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Chaining.20multi-level.2BRemote.20patient.20monitoring.html#230033843">(Mar 12 2021 at 14:09)</a>:</h4>
<p>Alright, you could skip my reply in another thread.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
