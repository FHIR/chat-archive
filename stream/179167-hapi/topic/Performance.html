---
layout: page
title: "FHIR Chat  · Performance · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html">Performance</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153870820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870820">(Feb 09 2017 at 07:32)</a>:</h4>
<p>Hi,</p>



<a name="153870821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870821">(Feb 09 2017 at 07:34)</a>:</h4>
<p>Trying to continue the thread here: <a href="https://groups.google.com/forum/#!searchin/hapi-fhir/performance%7Csort:date/hapi-fhir/0GJNC7kvCGQ/aESUJtiGCQAJ" target="_blank" title="https://groups.google.com/forum/#!searchin/hapi-fhir/performance%7Csort:date/hapi-fhir/0GJNC7kvCGQ/aESUJtiGCQAJ">https://groups.google.com/forum/#!searchin/hapi-fhir/performance%7Csort:date/hapi-fhir/0GJNC7kvCGQ/aESUJtiGCQAJ</a> - hopefully more interactively.<br>
A few questions:<br>
1. Do you have performance numbers for HAPI FHIR?</p>



<a name="153870822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870822">(Feb 09 2017 at 07:34)</a>:</h4>
<p>2. What is a proper way to exchange files with you? (showing the performance data we've collected and the test code)</p>



<a name="153870823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870823">(Feb 09 2017 at 07:35)</a>:</h4>
<p>3. What features do you think may be configured differently / disabled / enabled to improve the performance of the server?</p>



<a name="153870824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870824">(Feb 09 2017 at 07:35)</a>:</h4>
<p>Switching from 1.4 to 2.2, we've experienced a major improvement in performance of resource creation, but also a major degradation of performance of resource queries.</p>



<a name="153870826"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870826" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870826">(Feb 09 2017 at 07:41)</a>:</h4>
<p>The current performance numbers we get are not acceptable for our use case</p>



<a name="153870828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870828">(Feb 09 2017 at 08:00)</a>:</h4>
<p><a href="/user_uploads/10155/lbHlqeK8ynOlfqERSLWnWIlM/1279112986.html" target="_blank" title="1279112986.html">1279112986.html</a> </p>



<a name="153870829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870829">(Feb 09 2017 at 08:02)</a>:</h4>
<p>Here's a sample of the performance data I got on my development machine. MySQL is used as the database of HAPI, and the test keeps running 6 concurrent threads. 3 of these threads create resources all the time (patients, diagnostic reports and observations), and the other 3 keep reading specific resources (using resource-type?_id=...).</p>



<a name="153870830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870830">(Feb 09 2017 at 08:03)</a>:</h4>
<p>The average read time, in this test, for an Observation is nearly a second, and there are some spikes of 4.5 seconds.</p>



<a name="153870831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870831">(Feb 09 2017 at 08:03)</a>:</h4>
<p>This test shows, however, that the read time does not depend on the number of resources in the system (which is expected).</p>



<a name="153870832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870832">(Feb 09 2017 at 08:10)</a>:</h4>
<p>I found out that by completely disabling the paging support, the test results became an order of magnitude better, and are acceptable. (The test now only reads specific resources, so no use for paging).</p>



<a name="153870833"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870833" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870833">(Feb 09 2017 at 08:11)</a>:</h4>
<p>So I guess the paging support should be somehow tweaked.</p>



<a name="153870834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870834">(Feb 09 2017 at 08:11)</a>:</h4>
<p><a href="/user_uploads/10155/DLaM865IZg8iiCunic6p23Zj/870714572.html" target="_blank" title="870714572.html">870714572.html</a> <br>
The results with no paging support.</p>



<a name="153870890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153870890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153870890">(Feb 09 2017 at 18:17)</a>:</h4>
<p>Interesting.</p>
<p>I don't have shareable performance numbers at this point. We've run loads of benchmarks over time, and I've spoken to a bunch of others who have but I don't think we've ever kept them in shareable form. I'm curious about how you generated the results you shared? Is that automated in some way? Any chance the methodology is shareable?</p>
<p>The easiest way to send me stuff is to email me at <a href="mailto:jamesagnew@gmail.com" title="mailto:jamesagnew@gmail.com">jamesagnew@gmail.com</a> . If it's too big for email let me know and I can share access to our secure file portal where you can upload bigger files.</p>
<p>In looking at the <code>DatabaseBackedPagingProvider</code> after the discussion on the list, and there is one thing I noticed- DatabaseBackedPagingProvider extends <code>FifoMemoryPagingProvider</code> which doesn't really make much sense, but it seems like that was just making up for a bug where <code>_history</code> calls weren't being paged to the database like they should be. I've just checked in a fix for that.</p>
<p>I'm baffled by your "nearly a second" time for reading an observation though. What type of load is the server under when you get that? Our public server reports response times in the &lt; 10ms range even under load (e.g. <a href="http://fhirtest.uhn.ca/baseDstu3/Observation/8524" target="_blank" title="http://fhirtest.uhn.ca/baseDstu3/Observation/8524">this query</a> ) . Is this a plain read you're doing? Certainly if you send your test harness my way I'm happy to see if I see similar results.</p>



<a name="153871127"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153871127" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153871127">(Feb 12 2017 at 07:41)</a>:</h4>
<p>Can you make the performance numbers shareable? Or are they confidential?</p>



<a name="153871128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153871128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153871128">(Feb 12 2017 at 07:42)</a>:</h4>
<p>We're doing plain reads. However, there are 3 concurrent plain reads, and at the same time, 3 concurrent resource creations.</p>



<a name="153871129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Performance/near/153871129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shlomy Reinstein <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Performance.html#153871129">(Feb 12 2017 at 07:54)</a>:</h4>
<p>I have just sent you an email with the code of the test we run. It's a Maven project so you should be able to import it easily to most IDEs.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
