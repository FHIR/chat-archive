---
layout: page
title: "FHIR Chat  · filter on $expand · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html">filter on $expand</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="187375548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187375548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187375548">(Feb 04 2020 at 16:49)</a>:</h4>
<p>We want to use the expand operation for searching the code of a display value in the front-end (<a href="#narrow/stream/179166-implementers/topic/Codesystem.3A.20get.20code.20for.20display" title="#narrow/stream/179166-implementers/topic/Codesystem.3A.20get.20code.20for.20display">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Codesystem.3A.20get.20code.20for.20display</a>).<br>
I just tried: <a href="https://fhir.molit.eu/r4/ValueSet/$expand?url=http://molit.eu/fhir/ValueSet/tumorboard-cancellation-reason&amp;filter=Sonstiger%20Grund" target="_blank" title="https://fhir.molit.eu/r4/ValueSet/$expand?url=http://molit.eu/fhir/ValueSet/tumorboard-cancellation-reason&amp;filter=Sonstiger%20Grund">https://fhir.molit.eu/r4/ValueSet/$expand?url=http://molit.eu/fhir/ValueSet/tumorboard-cancellation-reason&amp;filter=Sonstiger%20Grund</a> on our server with no success.<br>
Had also a very quick glimpse at the hapi code which looks good.</p>



<a name="187375605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187375605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187375605">(Feb 04 2020 at 16:50)</a>:</h4>
<p>is this a known issue or a sideffect of the _filter reworking?</p>



<a name="187375810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187375810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187375810">(Feb 04 2020 at 16:52)</a>:</h4>
<p>I also saw that <code>Enumerations.FilterOperator.EQUAL</code>was used. It would be nice to also have startswith or regex.<br>
Main use case for us is autocompletion &amp; code for a display lookup. So a starts-with as the Operator would be nice.</p>



<a name="187376218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187376218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187376218">(Feb 04 2020 at 16:57)</a>:</h4>
<p>Actually the best option for the frontend auto-complete use-case would be a :contains</p>



<a name="187386479"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187386479" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187386479">(Feb 04 2020 at 18:43)</a>:</h4>
<p>I get a ValueSet expansion back which contains 7 items. Also I noticed that the filter in ValueSet definition is the same filter parameter you used in $expand.</p>



<a name="187390109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187390109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187390109">(Feb 04 2020 at 19:16)</a>:</h4>
<p>Yes, but due to the filter it only should return one</p>



<a name="187390825"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187390825" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187390825">(Feb 04 2020 at 19:23)</a>:</h4>
<p>Does your source value set have display field?</p>



<a name="187461506"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187461506" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187461506">(Feb 05 2020 at 15:10)</a>:</h4>
<p>sure: <a href="https://fhir.molit.eu/r4/ValueSet?url=http://molit.eu/fhir/ValueSet/tumorboard-cancellation-reason" target="_blank" title="https://fhir.molit.eu/r4/ValueSet?url=http://molit.eu/fhir/ValueSet/tumorboard-cancellation-reason">https://fhir.molit.eu/r4/ValueSet?url=http://molit.eu/fhir/ValueSet/tumorboard-cancellation-reason</a></p>



<a name="187551765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187551765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcelo Cabello <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187551765">(Feb 06 2020 at 14:25)</a>:</h4>
<p>I'd experienced same issue in my local server (hapi-4.0). <br>
In my case I defined several CS and VS separately, 'cause the concepts have properties. In this case the expansion with filter works fine. Have you tried on Grahames's server?</p>



<a name="187553318"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187553318" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187553318">(Feb 06 2020 at 14:43)</a>:</h4>
<p>yes, Grahames Server throws an unsupported exception</p>



<a name="187553403"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187553403" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187553403">(Feb 06 2020 at 14:44)</a>:</h4>
<blockquote>
<p>In my case I defined several CS and VS separately, 'cause the concepts have properties. In this case the expansion with filter works fine. Have you tried on Grahames's server?</p>
</blockquote>
<p>could you elaborate? We also defined our own VS and CS, but expand with filter doesn't work</p>



<a name="187577396"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/187577396" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcelo Cabello <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#187577396">(Feb 06 2020 at 18:58)</a>:</h4>
<p>it seems a bug could be there. some days ago I got the right expansion. Now I can't do that. Using the ID instead the URL it's possible to get the right expansion  &lt;fhirUrl&gt;/ValueSet/[id]/$expand?filter=&lt;searchValue&gt;<br>
Of course, it's not the right solution, but ...<br>
In this thread another user expose the same behavior: <a href="https://groups.google.com/forum/#!searchin/hapi-fhir/ValueSet$20contains$20include$20criteria$20with$20no$20system$20defined%7Csort:date/hapi-fhir/NrrMqselTFk/2yaOYELZBwAJ" target="_blank" title="https://groups.google.com/forum/#!searchin/hapi-fhir/ValueSet$20contains$20include$20criteria$20with$20no$20system$20defined%7Csort:date/hapi-fhir/NrrMqselTFk/2yaOYELZBwAJ">https://groups.google.com/forum/#!searchin/hapi-fhir/ValueSet$20contains$20include$20criteria$20with$20no$20system$20defined%7Csort:date/hapi-fhir/NrrMqselTFk/2yaOYELZBwAJ</a></p>



<a name="190100221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/190100221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alejandro Lopez Osornio <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#190100221">(Mar 09 2020 at 18:15)</a>:</h4>
<p>I see the same bug on the HAPI version in the LOINC fhir server, this request fails:</p>
<p><a href="https://fhir.loinc.org/ValueSet/$expand?url=http://loinc.org/vs/top-2000-lab-observations-us&amp;filter=gluco" target="_blank" title="https://fhir.loinc.org/ValueSet/$expand?url=http://loinc.org/vs/top-2000-lab-observations-us&amp;filter=gluco">https://fhir.loinc.org/ValueSet/$expand?url=http://loinc.org/vs/top-2000-lab-observations-us&amp;filter=gluco</a></p>
<div class="codehilite"><pre><span></span>  &quot;severity&quot;: &quot;error&quot;,
  &quot;code&quot;: &quot;processing&quot;,
  &quot;diagnostics&quot;: &quot;ValueSet contains include criteria with no system defined&quot;
</pre></div>



<a name="193079347"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/filter%20on%20%24expand/near/193079347" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alejandro Lopez Osornio <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/filter.20on.20.24expand.html#193079347">(Apr 06 2020 at 18:05)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> , can you shed some light on this? Is that a valid request? Thanks!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
