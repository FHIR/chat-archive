---
layout: page
title: "FHIR Chat  · HAPI, Postgres, Azure - performance tuning · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.2C.20Postgres.2C.20Azure.20-.20performance.20tuning.html">HAPI, Postgres, Azure - performance tuning</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="158049120"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%2C%20Postgres%2C%20Azure%20-%20performance%20tuning/near/158049120" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Veliyan Georgiev <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.2C.20Postgres.2C.20Azure.20-.20performance.20tuning.html#158049120">(Feb 11 2019 at 17:43)</a>:</h4>
<p>Does anyone have any performance tips on getting HAPI 3.6+ to work with Postgres in Azure?<br>
I'm doing some initial testing and I'm getting really bad performance for queries like:</p>
<p><a href="https://hapi-x5lnjt7yu5yqe.azurewebsites.net/baseDstu3/Patient?gender=female&amp;birthdate=gt1950-07-01&amp;birthdate=lt1960-07-01&amp;_has:Condition:subject:code=http://snomed.info/sct%7C55822004" target="_blank" title="https://hapi-x5lnjt7yu5yqe.azurewebsites.net/baseDstu3/Patient?gender=female&amp;birthdate=gt1950-07-01&amp;birthdate=lt1960-07-01&amp;_has:Condition:subject:code=http://snomed.info/sct%7C55822004">https://hapi-x5lnjt7yu5yqe.azurewebsites.net/baseDstu3/Patient?gender=female&amp;birthdate=gt1950-07-01&amp;birthdate=lt1960-07-01&amp;_has:Condition:subject:code=http://snomed.info/sct%7C55822004</a></p>
<p>..what seems to break it is the _has param</p>
<p>LWLock buffer_io count is above 250K for the following SQL</p>
<div class="codehilite"><pre><span></span><span class="k">select</span> <span class="n">resourceta0_</span><span class="p">.</span><span class="n">RES_TYPE</span> <span class="k">as</span> <span class="n">col_0_0_</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">resourceta0_</span><span class="p">.</span><span class="n">RES_TYPE</span><span class="p">)</span> <span class="k">as</span> <span class="n">col_1_0_</span> <span class="k">from</span> <span class="n">HFJ_RESOURCE</span> <span class="n">resourceta0_</span> <span class="k">group</span> <span class="k">by</span> <span class="n">resourceta0_</span><span class="p">.</span><span class="n">RES_TYPE</span>
</pre></div>


<p>Here is the stack trace as well</p>
<div class="codehilite"><pre><span></span><span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">56.785</span> <span class="o">[</span><span class="n">qtp182639397</span><span class="o">-</span><span class="mi">27</span><span class="o">]</span> <span class="n">INFO</span> <span class="n">c</span><span class="o">.</span><span class="na">u</span><span class="o">.</span><span class="na">f</span><span class="o">.</span><span class="na">j</span><span class="o">.</span><span class="na">s</span><span class="o">.</span><span class="na">SearchCoordinatorSvcImpl</span> <span class="o">[</span><span class="n">SearchCoordinatorSvcImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">543</span><span class="o">]</span> <span class="n">Proceeding</span><span class="o">,</span> <span class="n">as</span> <span class="n">we</span> <span class="n">have</span> <span class="mi">250</span> <span class="n">results</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">57.385</span> <span class="o">[</span><span class="n">search_coord_1</span><span class="o">]</span> <span class="n">INFO</span> <span class="n">o</span><span class="o">.</span><span class="na">h</span><span class="o">.</span><span class="na">e</span><span class="o">.</span><span class="na">j</span><span class="o">.</span><span class="na">b</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">AbstractBatchImpl</span> <span class="o">[</span><span class="n">AbstractBatchImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">193</span><span class="o">]</span> <span class="n">HHH000010</span><span class="o">:</span> <span class="n">On</span> <span class="n">release</span> <span class="n">of</span> <span class="n">batch</span> <span class="n">it</span> <span class="n">still</span> <span class="n">contained</span> <span class="n">JDBC</span> <span class="n">statements</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">57.386</span> <span class="o">[</span><span class="n">search_coord_1</span><span class="o">]</span> <span class="n">ERROR</span> <span class="n">o</span><span class="o">.</span><span class="na">h</span><span class="o">.</span><span class="na">e</span><span class="o">.</span><span class="na">j</span><span class="o">.</span><span class="na">batch</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">BatchingBatch</span> <span class="o">[</span><span class="n">BatchingBatch</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">127</span><span class="o">]</span> <span class="n">HHH000315</span><span class="o">:</span> <span class="n">Exception</span> <span class="n">executing</span> <span class="n">batch</span> <span class="o">[</span><span class="n">java</span><span class="o">.</span><span class="na">sql</span><span class="o">.</span><span class="na">BatchUpdateException</span><span class="o">:</span> <span class="n">Batch</span> <span class="n">entry</span> <span class="mi">0</span> <span class="n">insert</span> <span class="n">into</span> <span class="nf">HFJ_SEARCH_RESULT</span> <span class="o">(</span><span class="n">SEARCH_ORDER</span><span class="o">,</span> <span class="n">RESOURCE_PID</span><span class="o">,</span> <span class="n">SEARCH_PID</span><span class="o">,</span> <span class="n">PID</span><span class="o">)</span> <span class="n">values</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1228</span><span class="o">,</span> <span class="mi">1152</span><span class="o">,</span> <span class="mi">50252</span><span class="o">)</span> <span class="n">was</span> <span class="n">aborted</span><span class="o">:</span> <span class="n">ERROR</span><span class="o">:</span> <span class="n">insert</span> <span class="n">or</span> <span class="n">update</span> <span class="n">on</span> <span class="n">table</span> <span class="s">&quot;hfj_search_result&quot;</span> <span class="n">violates</span> <span class="n">foreign</span> <span class="n">key</span> <span class="n">constraint</span> <span class="s">&quot;fk_searchres_search&quot;</span>
<span class="nl">Detail:</span> <span class="n">Key</span> <span class="o">(</span><span class="n">search_pid</span><span class="o">)=(</span><span class="mi">1152</span><span class="o">)</span> <span class="n">is</span> <span class="n">not</span> <span class="n">present</span> <span class="n">in</span> <span class="n">table</span> <span class="s">&quot;hfj_search&quot;</span><span class="o">.</span> <span class="n">Call</span> <span class="n">getNextException</span> <span class="n">to</span> <span class="n">see</span> <span class="n">other</span> <span class="n">errors</span> <span class="n">in</span> <span class="n">the</span> <span class="n">batch</span><span class="o">.],</span> <span class="n">SQL</span><span class="o">:</span> <span class="n">insert</span> <span class="n">into</span> <span class="nf">HFJ_SEARCH_RESULT</span> <span class="o">(</span><span class="n">SEARCH_ORDER</span><span class="o">,</span> <span class="n">RESOURCE_PID</span><span class="o">,</span> <span class="n">SEARCH_PID</span><span class="o">,</span> <span class="n">PID</span><span class="o">)</span> <span class="n">values</span> <span class="o">(?,</span> <span class="o">?,</span> <span class="o">?,</span> <span class="o">?)</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">57.386</span> <span class="o">[</span><span class="n">search_coord_1</span><span class="o">]</span> <span class="n">WARN</span> <span class="n">o</span><span class="o">.</span><span class="na">h</span><span class="o">.</span><span class="na">e</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">spi</span><span class="o">.</span><span class="na">SqlExceptionHelper</span> <span class="o">[</span><span class="n">SqlExceptionHelper</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">137</span><span class="o">]</span> <span class="n">SQL</span> <span class="n">Error</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span> <span class="n">SQLState</span><span class="o">:</span> <span class="mi">23503</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">57.386</span> <span class="o">[</span><span class="n">search_coord_1</span><span class="o">]</span> <span class="n">ERROR</span> <span class="n">o</span><span class="o">.</span><span class="na">h</span><span class="o">.</span><span class="na">e</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">spi</span><span class="o">.</span><span class="na">SqlExceptionHelper</span> <span class="o">[</span><span class="n">SqlExceptionHelper</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">142</span><span class="o">]</span> <span class="n">Batch</span> <span class="n">entry</span> <span class="mi">0</span> <span class="n">insert</span> <span class="n">into</span> <span class="nf">HFJ_SEARCH_RESULT</span> <span class="o">(</span><span class="n">SEARCH_ORDER</span><span class="o">,</span> <span class="n">RESOURCE_PID</span><span class="o">,</span> <span class="n">SEARCH_PID</span><span class="o">,</span> <span class="n">PID</span><span class="o">)</span> <span class="n">values</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1228</span><span class="o">,</span> <span class="mi">1152</span><span class="o">,</span> <span class="mi">50252</span><span class="o">)</span> <span class="n">was</span> <span class="n">aborted</span><span class="o">:</span> <span class="n">ERROR</span><span class="o">:</span> <span class="n">insert</span> <span class="n">or</span> <span class="n">update</span> <span class="n">on</span> <span class="n">table</span> <span class="s">&quot;hfj_search_result&quot;</span> <span class="n">violates</span> <span class="n">foreign</span> <span class="n">key</span> <span class="n">constraint</span> <span class="s">&quot;fk_searchres_search&quot;</span>
<span class="nl">Detail:</span> <span class="n">Key</span> <span class="o">(</span><span class="n">search_pid</span><span class="o">)=(</span><span class="mi">1152</span><span class="o">)</span> <span class="n">is</span> <span class="n">not</span> <span class="n">present</span> <span class="n">in</span> <span class="n">table</span> <span class="s">&quot;hfj_search&quot;</span><span class="o">.</span> <span class="n">Call</span> <span class="n">getNextException</span> <span class="n">to</span> <span class="n">see</span> <span class="n">other</span> <span class="n">errors</span> <span class="n">in</span> <span class="n">the</span> <span class="n">batch</span><span class="o">.</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">57.387</span> <span class="o">[</span><span class="n">search_coord_1</span><span class="o">]</span> <span class="n">ERROR</span> <span class="n">o</span><span class="o">.</span><span class="na">h</span><span class="o">.</span><span class="na">e</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">spi</span><span class="o">.</span><span class="na">SqlExceptionHelper</span> <span class="o">[</span><span class="n">SqlExceptionHelper</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">142</span><span class="o">]</span> <span class="n">ERROR</span><span class="o">:</span> <span class="n">insert</span> <span class="n">or</span> <span class="n">update</span> <span class="n">on</span> <span class="n">table</span> <span class="s">&quot;hfj_search_result&quot;</span> <span class="n">violates</span> <span class="n">foreign</span> <span class="n">key</span> <span class="n">constraint</span> <span class="s">&quot;fk_searchres_search&quot;</span>
<span class="nl">Detail:</span> <span class="n">Key</span> <span class="o">(</span><span class="n">search_pid</span><span class="o">)=(</span><span class="mi">1152</span><span class="o">)</span> <span class="n">is</span> <span class="n">not</span> <span class="n">present</span> <span class="n">in</span> <span class="n">table</span> <span class="s">&quot;hfj_search&quot;</span><span class="o">.</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">57.391</span> <span class="o">[</span><span class="n">search_coord_1</span><span class="o">]</span> <span class="n">ERROR</span> <span class="n">o</span><span class="o">.</span><span class="na">h</span><span class="o">.</span><span class="na">i</span><span class="o">.</span><span class="na">ExceptionMapperStandardImpl</span> <span class="o">[</span><span class="n">ExceptionMapperStandardImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">39</span><span class="o">]</span> <span class="n">HHH000346</span><span class="o">:</span> <span class="n">Error</span> <span class="n">during</span> <span class="n">managed</span> <span class="n">flush</span> <span class="o">[</span><span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">exception</span><span class="o">.</span><span class="na">ConstraintViolationException</span><span class="o">:</span> <span class="n">could</span> <span class="n">not</span> <span class="n">execute</span> <span class="n">batch</span><span class="o">]</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">57.442</span> <span class="o">[</span><span class="n">search_coord_1</span><span class="o">]</span> <span class="n">ERROR</span> <span class="n">c</span><span class="o">.</span><span class="na">u</span><span class="o">.</span><span class="na">f</span><span class="o">.</span><span class="na">j</span><span class="o">.</span><span class="na">s</span><span class="o">.</span><span class="na">SearchCoordinatorSvcImpl</span> <span class="o">[</span><span class="n">SearchCoordinatorSvcImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">702</span><span class="o">]</span> <span class="n">Failed</span> <span class="n">during</span> <span class="n">search</span> <span class="n">loading</span> <span class="n">after</span> <span class="mi">192175</span><span class="n">ms</span>
<span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">dao</span><span class="o">.</span><span class="na">DataIntegrityViolationException</span><span class="o">:</span> <span class="n">could</span> <span class="n">not</span> <span class="n">execute</span> <span class="n">batch</span><span class="o">;</span> <span class="n">SQL</span> <span class="o">[</span><span class="n">insert</span> <span class="n">into</span> <span class="nf">HFJ_SEARCH_RESULT</span> <span class="o">(</span><span class="n">SEARCH_ORDER</span><span class="o">,</span> <span class="n">RESOURCE_PID</span><span class="o">,</span> <span class="n">SEARCH_PID</span><span class="o">,</span> <span class="n">PID</span><span class="o">)</span> <span class="n">values</span> <span class="o">(?,</span> <span class="o">?,</span> <span class="o">?,</span> <span class="o">?)];</span> <span class="n">constraint</span> <span class="o">[</span><span class="n">fk_searchres_search</span><span class="o">];</span> <span class="n">nested</span> <span class="n">exception</span> <span class="n">is</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">exception</span><span class="o">.</span><span class="na">ConstraintViolationException</span><span class="o">:</span> <span class="n">could</span> <span class="n">not</span> <span class="n">execute</span> <span class="n">batch</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">orm</span><span class="o">.</span><span class="na">jpa</span><span class="o">.</span><span class="na">vendor</span><span class="o">.</span><span class="na">HibernateJpaDialect</span><span class="o">.</span><span class="na">convertHibernateAccessException</span><span class="o">(</span><span class="n">HibernateJpaDialect</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">259</span><span class="o">)</span>
<span class="n">at</span> <span class="n">ca</span><span class="o">.</span><span class="na">uhn</span><span class="o">.</span><span class="na">fhir</span><span class="o">.</span><span class="na">jpa</span><span class="o">.</span><span class="na">config</span><span class="o">.</span><span class="na">HapiFhirHibernateJpaDialect</span><span class="o">.</span><span class="na">convertHibernateAccessException</span><span class="o">(</span><span class="n">HapiFhirHibernateJpaDialect</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">59</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">orm</span><span class="o">.</span><span class="na">jpa</span><span class="o">.</span><span class="na">vendor</span><span class="o">.</span><span class="na">HibernateJpaDialect</span><span class="o">.</span><span class="na">translateExceptionIfPossible</span><span class="o">(</span><span class="n">HibernateJpaDialect</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">225</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">orm</span><span class="o">.</span><span class="na">jpa</span><span class="o">.</span><span class="na">JpaTransactionManager</span><span class="o">.</span><span class="na">doCommit</span><span class="o">(</span><span class="n">JpaTransactionManager</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">540</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">transaction</span><span class="o">.</span><span class="na">support</span><span class="o">.</span><span class="na">AbstractPlatformTransactionManager</span><span class="o">.</span><span class="na">processCommit</span><span class="o">(</span><span class="n">AbstractPlatformTransactionManager</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">746</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">transaction</span><span class="o">.</span><span class="na">support</span><span class="o">.</span><span class="na">AbstractPlatformTransactionManager</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">AbstractPlatformTransactionManager</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">714</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">transaction</span><span class="o">.</span><span class="na">support</span><span class="o">.</span><span class="na">TransactionTemplate</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">TransactionTemplate</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">152</span><span class="o">)</span>
<span class="n">at</span> <span class="n">ca</span><span class="o">.</span><span class="na">uhn</span><span class="o">.</span><span class="na">fhir</span><span class="o">.</span><span class="na">jpa</span><span class="o">.</span><span class="na">search</span><span class="o">.</span><span class="na">SearchCoordinatorSvcImpl$BaseTask</span><span class="o">.</span><span class="na">call</span><span class="o">(</span><span class="n">SearchCoordinatorSvcImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">676</span><span class="o">)</span>
<span class="n">at</span> <span class="n">ca</span><span class="o">.</span><span class="na">uhn</span><span class="o">.</span><span class="na">fhir</span><span class="o">.</span><span class="na">jpa</span><span class="o">.</span><span class="na">search</span><span class="o">.</span><span class="na">SearchCoordinatorSvcImpl$BaseTask</span><span class="o">.</span><span class="na">call</span><span class="o">(</span><span class="n">SearchCoordinatorSvcImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">449</span><span class="o">)</span>
<span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">concurrent</span><span class="o">.</span><span class="na">FutureTask</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">FutureTask</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">266</span><span class="o">)</span>
<span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">concurrent</span><span class="o">.</span><span class="na">ThreadPoolExecutor</span><span class="o">.</span><span class="na">runWorker</span><span class="o">(</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">1142</span><span class="o">)</span>
<span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">concurrent</span><span class="o">.</span><span class="na">ThreadPoolExecutor$Worker</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">617</span><span class="o">)</span>
<span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Thread</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">748</span><span class="o">)</span>
<span class="n">Caused</span> <span class="n">by</span><span class="o">:</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">exception</span><span class="o">.</span><span class="na">ConstraintViolationException</span><span class="o">:</span> <span class="n">could</span> <span class="n">not</span> <span class="n">execute</span> <span class="n">batch</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">exception</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">SQLStateConversionDelegate</span><span class="o">.</span><span class="na">convert</span><span class="o">(</span><span class="n">SQLStateConversionDelegate</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">112</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">exception</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">StandardSQLExceptionConverter</span><span class="o">.</span><span class="na">convert</span><span class="o">(</span><span class="n">StandardSQLExceptionConverter</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">42</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">spi</span><span class="o">.</span><span class="na">SqlExceptionHelper</span><span class="o">.</span><span class="na">convert</span><span class="o">(</span><span class="n">SqlExceptionHelper</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">113</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">batch</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">BatchingBatch</span><span class="o">.</span><span class="na">performExecution</span><span class="o">(</span><span class="n">BatchingBatch</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">128</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">batch</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">BatchingBatch</span><span class="o">.</span><span class="na">addToBatch</span><span class="o">(</span><span class="n">BatchingBatch</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">88</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">persister</span><span class="o">.</span><span class="na">entity</span><span class="o">.</span><span class="na">AbstractEntityPersister</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">AbstractEntityPersister</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">3165</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">persister</span><span class="o">.</span><span class="na">entity</span><span class="o">.</span><span class="na">AbstractEntityPersister</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">AbstractEntityPersister</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">3686</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">action</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">EntityInsertAction</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">EntityInsertAction</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">90</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">spi</span><span class="o">.</span><span class="na">ActionQueue</span><span class="o">.</span><span class="na">executeActions</span><span class="o">(</span><span class="n">ActionQueue</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">604</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">spi</span><span class="o">.</span><span class="na">ActionQueue</span><span class="o">.</span><span class="na">executeActions</span><span class="o">(</span><span class="n">ActionQueue</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">478</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">event</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">AbstractFlushingEventListener</span><span class="o">.</span><span class="na">performExecutions</span><span class="o">(</span><span class="n">AbstractFlushingEventListener</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">356</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">event</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">DefaultFlushEventListener</span><span class="o">.</span><span class="na">onFlush</span><span class="o">(</span><span class="n">DefaultFlushEventListener</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">39</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">SessionImpl</span><span class="o">.</span><span class="na">doFlush</span><span class="o">(</span><span class="n">SessionImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">1454</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">SessionImpl</span><span class="o">.</span><span class="na">managedFlush</span><span class="o">(</span><span class="n">SessionImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">511</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">SessionImpl</span><span class="o">.</span><span class="na">flushBeforeTransactionCompletion</span><span class="o">(</span><span class="n">SessionImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">3283</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">SessionImpl</span><span class="o">.</span><span class="na">beforeTransactionCompletion</span><span class="o">(</span><span class="n">SessionImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2479</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">JdbcCoordinatorImpl</span><span class="o">.</span><span class="na">beforeTransactionCompletion</span><span class="o">(</span><span class="n">JdbcCoordinatorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">473</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">resource</span><span class="o">.</span><span class="na">transaction</span><span class="o">.</span><span class="na">backend</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">JdbcResourceLocalTransactionCoordinatorImpl</span><span class="o">.</span><span class="na">beforeCompletionCallback</span><span class="o">(</span><span class="n">JdbcResourceLocalTransactionCoordinatorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">178</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">resource</span><span class="o">.</span><span class="na">transaction</span><span class="o">.</span><span class="na">backend</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">JdbcResourceLocalTransactionCoordinatorImpl</span><span class="o">.</span><span class="na">access$300</span><span class="o">(</span><span class="n">JdbcResourceLocalTransactionCoordinatorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">39</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">resource</span><span class="o">.</span><span class="na">transaction</span><span class="o">.</span><span class="na">backend</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">JdbcResourceLocalTransactionCoordinatorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">271</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">transaction</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">TransactionImpl</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">TransactionImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">98</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">orm</span><span class="o">.</span><span class="na">jpa</span><span class="o">.</span><span class="na">JpaTransactionManager</span><span class="o">.</span><span class="na">doCommit</span><span class="o">(</span><span class="n">JpaTransactionManager</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">536</span><span class="o">)</span>
<span class="o">...</span> <span class="mi">9</span> <span class="n">common</span> <span class="n">frames</span> <span class="n">omitted</span>
<span class="n">Caused</span> <span class="n">by</span><span class="o">:</span> <span class="n">java</span><span class="o">.</span><span class="na">sql</span><span class="o">.</span><span class="na">BatchUpdateException</span><span class="o">:</span> <span class="n">Batch</span> <span class="n">entry</span> <span class="mi">0</span> <span class="n">insert</span> <span class="n">into</span> <span class="nf">HFJ_SEARCH_RESULT</span> <span class="o">(</span><span class="n">SEARCH_ORDER</span><span class="o">,</span> <span class="n">RESOURCE_PID</span><span class="o">,</span> <span class="n">SEARCH_PID</span><span class="o">,</span> <span class="n">PID</span><span class="o">)</span> <span class="n">values</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1228</span><span class="o">,</span> <span class="mi">1152</span><span class="o">,</span> <span class="mi">50252</span><span class="o">)</span> <span class="n">was</span> <span class="n">aborted</span><span class="o">:</span> <span class="n">ERROR</span><span class="o">:</span> <span class="n">insert</span> <span class="n">or</span> <span class="n">update</span> <span class="n">on</span> <span class="n">table</span> <span class="s">&quot;hfj_search_result&quot;</span> <span class="n">violates</span> <span class="n">foreign</span> <span class="n">key</span> <span class="n">constraint</span> <span class="s">&quot;fk_searchres_search&quot;</span>
<span class="nl">Detail:</span> <span class="n">Key</span> <span class="o">(</span><span class="n">search_pid</span><span class="o">)=(</span><span class="mi">1152</span><span class="o">)</span> <span class="n">is</span> <span class="n">not</span> <span class="n">present</span> <span class="n">in</span> <span class="n">table</span> <span class="s">&quot;hfj_search&quot;</span><span class="o">.</span> <span class="n">Call</span> <span class="n">getNextException</span> <span class="n">to</span> <span class="n">see</span> <span class="n">other</span> <span class="n">errors</span> <span class="n">in</span> <span class="n">the</span> <span class="n">batch</span><span class="o">.</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">BatchResultHandler</span><span class="o">.</span><span class="na">handleError</span><span class="o">(</span><span class="n">BatchResultHandler</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">148</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">v3</span><span class="o">.</span><span class="na">QueryExecutorImpl</span><span class="o">.</span><span class="na">processResults</span><span class="o">(</span><span class="n">QueryExecutorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2184</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">v3</span><span class="o">.</span><span class="na">QueryExecutorImpl</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">QueryExecutorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">481</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">PgStatement</span><span class="o">.</span><span class="na">executeBatch</span><span class="o">(</span><span class="n">PgStatement</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">840</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">PgPreparedStatement</span><span class="o">.</span><span class="na">executeBatch</span><span class="o">(</span><span class="n">PgPreparedStatement</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">1538</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">commons</span><span class="o">.</span><span class="na">dbcp2</span><span class="o">.</span><span class="na">DelegatingStatement</span><span class="o">.</span><span class="na">executeBatch</span><span class="o">(</span><span class="n">DelegatingStatement</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">223</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">commons</span><span class="o">.</span><span class="na">dbcp2</span><span class="o">.</span><span class="na">DelegatingStatement</span><span class="o">.</span><span class="na">executeBatch</span><span class="o">(</span><span class="n">DelegatingStatement</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">223</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">engine</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">batch</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">BatchingBatch</span><span class="o">.</span><span class="na">performExecution</span><span class="o">(</span><span class="n">BatchingBatch</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">118</span><span class="o">)</span>
<span class="o">...</span> <span class="mi">27</span> <span class="n">common</span> <span class="n">frames</span> <span class="n">omitted</span>
<span class="n">Caused</span> <span class="n">by</span><span class="o">:</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">PSQLException</span><span class="o">:</span> <span class="n">ERROR</span><span class="o">:</span> <span class="n">insert</span> <span class="n">or</span> <span class="n">update</span> <span class="n">on</span> <span class="n">table</span> <span class="s">&quot;hfj_search_result&quot;</span> <span class="n">violates</span> <span class="n">foreign</span> <span class="n">key</span> <span class="n">constraint</span> <span class="s">&quot;fk_searchres_search&quot;</span>
<span class="nl">Detail:</span> <span class="n">Key</span> <span class="o">(</span><span class="n">search_pid</span><span class="o">)=(</span><span class="mi">1152</span><span class="o">)</span> <span class="n">is</span> <span class="n">not</span> <span class="n">present</span> <span class="n">in</span> <span class="n">table</span> <span class="s">&quot;hfj_search&quot;</span><span class="o">.</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">v3</span><span class="o">.</span><span class="na">QueryExecutorImpl</span><span class="o">.</span><span class="na">receiveErrorResponse</span><span class="o">(</span><span class="n">QueryExecutorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2440</span><span class="o">)</span>
<span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">v3</span><span class="o">.</span><span class="na">QueryExecutorImpl</span><span class="o">.</span><span class="na">processResults</span><span class="o">(</span><span class="n">QueryExecutorImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2183</span><span class="o">)</span>
<span class="o">...</span> <span class="mi">33</span> <span class="n">common</span> <span class="n">frames</span> <span class="n">omitted</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">02.643</span> <span class="o">[</span><span class="n">qtp182639397</span><span class="o">-</span><span class="mi">27</span><span class="o">]</span> <span class="n">INFO</span> <span class="n">ca</span><span class="o">.</span><span class="na">uhn</span><span class="o">.</span><span class="na">fhir</span><span class="o">.</span><span class="na">context</span><span class="o">.</span><span class="na">FhirContext</span> <span class="o">[</span><span class="n">FhirContext</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">171</span><span class="o">]</span> <span class="n">Creating</span> <span class="k">new</span> <span class="n">FHIR</span> <span class="n">context</span> <span class="k">for</span> <span class="n">FHIR</span> <span class="n">version</span> <span class="o">[</span><span class="n">DSTU3</span><span class="o">]</span>
<span class="mi">2019</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">02.736</span> <span class="o">[</span><span class="n">qtp182639397</span><span class="o">-</span><span class="mi">27</span><span class="o">]</span> <span class="n">INFO</span> <span class="n">ca</span><span class="o">.</span><span class="na">uhn</span><span class="o">.</span><span class="na">fhir</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">XmlUtil</span> <span class="o">[</span><span class="n">DependencyLogImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">75</span><span class="o">]</span> <span class="n">FHIR</span> <span class="n">XML</span> <span class="n">procesing</span> <span class="n">will</span> <span class="n">use</span> <span class="n">StAX</span> <span class="n">implementation</span> <span class="err">&#39;</span><span class="n">Woodstox</span> <span class="n">XML</span><span class="o">-</span><span class="n">processor</span><span class="err">&#39;</span> <span class="n">version</span> <span class="err">&#39;</span><span class="mf">4.4.1</span><span class="err">&#39;</span>
<span class="o">^</span><span class="n">C</span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span> <span class="n">Stopped</span> <span class="n">ServerConnector</span><span class="err">@</span><span class="mi">5</span><span class="n">eb1fd44</span><span class="o">{</span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="o">,[</span><span class="n">http</span><span class="o">/</span><span class="mf">1.1</span><span class="o">]}{</span><span class="mf">0.0.0.0</span><span class="o">:</span><span class="mi">8080</span><span class="o">}</span>
<span class="o">[</span><span class="n">INFO</span><span class="o">]</span> <span class="n">Stopped</span> <span class="n">scavenging</span>
<span class="o">[</span><span class="n">INFO</span><span class="o">]</span> <span class="n">Destroying</span> <span class="n">Spring</span> <span class="n">FrameworkServlet</span> <span class="err">&#39;</span><span class="n">spring</span><span class="err">&#39;</span>
</pre></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
