---
layout: page
title: "FHIR Chat  · Unexpected performance of Location search parameters · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Unexpected.20performance.20of.20Location.20search.20parameters.html">Unexpected performance of Location search parameters</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="214892503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Unexpected%20performance%20of%20Location%20search%20parameters/near/214892503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Unexpected.20performance.20of.20Location.20search.20parameters.html#214892503">(Oct 28 2020 at 20:20)</a>:</h4>
<p>Three searches, one using Location:address, and two variants on  Location:address-postalcode.   <br>
The first runs 20x faster than the other.   Thoughts?<br>
<strong>Fast:</strong><br>
<a href="https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address:contains=06040">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address:contains=06040</a></p>
<p><strong>Slow</strong><br>
<a href="https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode=06040">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode=06040</a></p>
<p><strong>Fast</strong><br>
<a href="https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode:contains=06040">https://davinci-plan-net-ri.logicahealth.org/fhir/Location?_has:OrganizationAffiliation:location:network=Organization/plannet-network-HPID010000&amp;_has:OrganizationAffiliation:location:role=pharmacy&amp;_revinclude=OrganizationAffiliation:location&amp;address-postalcode:contains=06040</a></p>



<a name="214908430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Unexpected%20performance%20of%20Location%20search%20parameters/near/214908430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Unexpected.20performance.20of.20Location.20search.20parameters.html#214908430">(Oct 28 2020 at 23:04)</a>:</h4>
<p>Check the indexes that might be used.  Different query parameters might result in different optimization decisions being used by the query optimizer.  That kind of speed difference is typically a result of indexing choices, and/or query optimization planning choices.</p>



<a name="214916844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Unexpected%20performance%20of%20Location%20search%20parameters/near/214916844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Unexpected.20performance.20of.20Location.20search.20parameters.html#214916844">(Oct 29 2020 at 01:17)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191387">@Keith Boone</span> -- dumb question, are those HAPI configuration options?</p>



<a name="215642404"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Unexpected%20performance%20of%20Location%20search%20parameters/near/215642404" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Unexpected.20performance.20of.20Location.20search.20parameters.html#215642404">(Nov 04 2020 at 21:16)</a>:</h4>
<p>Even dumber answer: I don't know, but I suspect that <span class="user-mention" data-user-id="191319">@James Agnew</span>  might be able to point you in the right direction.</p>



<a name="215642558"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Unexpected%20performance%20of%20Location%20search%20parameters/near/215642558" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Unexpected.20performance.20of.20Location.20search.20parameters.html#215642558">(Nov 04 2020 at 21:17)</a>:</h4>
<p>For what it's worth, the HAPI JPA Server does (or can) log the queries it is using if I remember correctly, and that might provide more insight.</p>



<a name="215719179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Unexpected%20performance%20of%20Location%20search%20parameters/near/215719179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian Bacher <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Unexpected.20performance.20of.20Location.20search.20parameters.html#215719179">(Nov 05 2020 at 14:35)</a>:</h4>
<p>I'm noticing that the two "fast" queries are both using <code>:contains</code>, which makes me think that the difference here is that the <code>:contains</code> queries are hitting the Lucene index  (which is used for full-text search and can be quite a bit faster), but I'm not really familiar enough with the JPA server search internals to be sure about that.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
