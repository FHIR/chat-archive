---
layout: page
title: "FHIR Chat  · Date and Time weirdness · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Date.20and.20Time.20weirdness.html">Date and Time weirdness</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="184834355"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Date%20and%20Time%20weirdness/near/184834355" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Date.20and.20Time.20weirdness.html#184834355">(Jan 05 2020 at 05:16)</a>:</h4>
<p>Working with the Java data types, I'm noticing quite a bit of unexpected behavior when manipulating dates.</p>
<ol>
<li>copy() doesn't behave as expected with respect to string value.</li>
<li>Making any changes to the date value reverts the string representation to the system default time zone.</li>
<li>Data arithmetic using calendar units doesn't appear to be behaving as expected.<br>
This is all with the HAPI 4.0.1 data types, but I know some of these bugs have been around for a bit.</li>
</ol>



<a name="184847171"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Date%20and%20Time%20weirdness/near/184847171" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Date.20and.20Time.20weirdness.html#184847171">(Jan 05 2020 at 12:34)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="184856074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Date%20and%20Time%20weirdness/near/184856074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Date.20and.20Time.20weirdness.html#184856074">(Jan 05 2020 at 17:01)</a>:</h4>
<p><span class="user-mention" data-user-id="191387">@Keith Boone</span> these sound like bugs but i'm not sure i understand any of them exactly.. are you able to provide test cases?</p>



<a name="184927340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Date%20and%20Time%20weirdness/near/184927340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Date.20and.20Time.20weirdness.html#184927340">(Jan 06 2020 at 17:34)</a>:</h4>
<p>Yes, they are bugs, and yes I can provide test case, and will file them.</p>
<p>In first case, load a date as string using a TZ different from your local default.  Change the precision, or set it exact same time from Date value , or use add function to change the value.  Note a different value.</p>
<p>In next case, make a copy of the date using copy() method.  Print string values of original and copy.  They should be equal but are not.</p>



<a name="184939719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Date%20and%20Time%20weirdness/near/184939719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Date.20and.20Time.20weirdness.html#184939719">(Jan 06 2020 at 19:53)</a>:</h4>
<p>Ah yeah, that one is known... Comes down to the use of a java Date object as the underlying data structure. We picked that back when we were still supporting Java 6. </p>
<p>We really ought to replace that Date with a javax.time.Instant now that we're on Java 8. That's a painful change though...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
