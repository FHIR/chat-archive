---
layout: page
title: "FHIR Chat  · supporting not-present code systems in Hapi 3.8.0 · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html">supporting not-present code systems in Hapi 3.8.0</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="167842675"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167842675" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167842675">(Jun 11 2019 at 11:56)</a>:</h4>
<p>We have a CodeSystem which refers to a huge external code system which is not practical to implement as a resource in Hapi. Before upgrading to 3.8.0 we could work around it by marking the codesystem as "not-present".<br>
With the new release we are facing problems as Hapi validator reports errors about invalid code sets:<br>
"None of the codes provided are in the value set <a href="http://phr.kanta.fi/ValueSet/fiphr-vs-vnrcode" target="_blank" title="http://phr.kanta.fi/ValueSet/fiphr-vs-vnrcode">http://phr.kanta.fi/ValueSet/fiphr-vs-vnrcode</a> (<a href="http://phr.kanta.fi/ValueSet/fiphr-vs-vnrcode" target="_blank" title="http://phr.kanta.fi/ValueSet/fiphr-vs-vnrcode">http://phr.kanta.fi/ValueSet/fiphr-vs-vnrcode</a>, and a code from this value set is required) (codes = urn:oid:1.2.246.537.6.55#168120)"</p>
<p>I had a look at the validator internals and there seems to be a possibility to support a ValueSetChecker which looks like it was meant to be used in these cases but I don't see a way to provide such an implementation so that Hapi would use it to validate my CodeableConcept.</p>
<p>How can I provide Hapi with an implementation which makes the validator accept any code and just check the system?<br>
This is an example of how the codeable concept looks like as a resource. The binding strength is REQUIRED as the values must be from the code system bound to the CodeableConcept.<br>
    "medicationCodeableConcept":{<br>
                "coding":[{<br>
                        "system": "urn:oid:1.2.246.537.6.55",<br>
                        "display":"Amoxicillin (substance)",<br>
                        "code": "168120"<br>
                    }],<br>
                "text": "SOMAC CONTROL"<br>
                },</p>



<a name="167857773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167857773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167857773">(Jun 11 2019 at 14:54)</a>:</h4>
<p>if the infrastructure doesn't know the code system at all, it will just create a hint saying it doesn't know it and can't validate it. Why not leave it like that?</p>



<a name="167858102"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167858102" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167858102">(Jun 11 2019 at 14:58)</a>:</h4>
<p><span class="user-mention" data-user-id="197084">@Matti Uusitalo</span> edit: re-read your question.</p>



<a name="167858418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167858418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167858418">(Jun 11 2019 at 15:01)</a>:</h4>
<p>i agree it would be good to at least check if the system was specified correct. You could alter your profile and remove the VS binding and add a fixed value for the system, but i assume this is not what you want.</p>



<a name="167858602"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167858602" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167858602">(Jun 11 2019 at 15:03)</a>:</h4>
<p>We have a similar use case with CodeSystems to big to include it into hapi, eventually we will delegate this part of the validation to an external Terminology Server. <br>
For the meantime it would be important to at least check the system value. Just ignore everything seems not the way to go</p>



<a name="167861325"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167861325" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167861325">(Jun 11 2019 at 15:33)</a>:</h4>
<p>you can't check the system value - so it's there, wrong? how do you know it's wrong?</p>



<a name="167916900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167916900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167916900">(Jun 12 2019 at 05:32)</a>:</h4>
<blockquote>
<p>if the infrastructure doesn't know the code system at all, it will just create a hint saying it doesn't know it and can't validate it. Why not leave it like that?</p>
</blockquote>
<p>We get error level issues from the validator. This wasn't the case with Hapi 3.6.0.</p>



<a name="167917283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167917283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167917283">(Jun 12 2019 at 05:42)</a>:</h4>
<blockquote>
<p>i agree it would be good to at least check if the system was specified correct. You could alter your profile and remove the VS binding and add a fixed value for the system, but i assume this is not what you want.</p>
</blockquote>
<p>Thanks for the suggestion, that's definitely worth checking out.</p>



<a name="167919573"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167919573" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167919573">(Jun 12 2019 at 06:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> If I use noTerminologyChecks flag this seems to work. Is that what you meant?</p>
<p>I have to check against our whole test suite before I can be sure, but at least my initial tests are promising.</p>



<a name="167924315"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167924315" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167924315">(Jun 12 2019 at 08:04)</a>:</h4>
<p>unfortunately we can't configure noTerminologyChecks to be true as it does not validate againts hl7 codesystems then</p>



<a name="167925100"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167925100" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167925100">(Jun 12 2019 at 08:19)</a>:</h4>
<blockquote>
<p>you can't check the system value - so it's there, wrong? how do you know it's wrong?</p>
</blockquote>
<p>i don't know if it is right, but i know if it is wrong (wrong system) . But if the profile has an required VS binding and the system doesn't match we could thrown a error. If the system is matching, but the CS is emtpy or missing it could be a warning.</p>



<a name="167925927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167925927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eeva Turkka <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167925927">(Jun 12 2019 at 08:33)</a>:</h4>
<p>This actually used to work like that with the "not-present" value set to the codesystem resource (<a href="https://www.hl7.org/fhir/valueset-codesystem-content-mode.html" target="_blank" title="https://www.hl7.org/fhir/valueset-codesystem-content-mode.html">https://www.hl7.org/fhir/valueset-codesystem-content-mode.html</a>). This is useful in cases when there are two codesystems that can be validated and then there are values from a third one that can't: <a href="https://simplifier.net/finnishphr/fiphr-vs-activitycode" target="_blank" title="https://simplifier.net/finnishphr/fiphr-vs-activitycode">https://simplifier.net/finnishphr/fiphr-vs-activitycode</a> .</p>



<a name="167951695"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/167951695" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#167951695">(Jun 12 2019 at 14:23)</a>:</h4>
<p>I Did not mean the noTerminologyChecks Flag. By default, if you use a code system that the validator doesn’t know, it will simply note that and move in. Is that not the right outcome?</p>



<a name="168015853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168015853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168015853">(Jun 13 2019 at 05:32)</a>:</h4>
<blockquote>
<p>I Did not mean the noTerminologyChecks Flag. By default, if you use a code system that the validator doesn’t know, it will simply note that and move in. Is that not the right outcome?</p>
</blockquote>
<p>That would be good. Unfortunately it is not what happens. Here's the reason, so far as I understand:<br>
Here's the loop which checks if the code is ok<br>
<a href="https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/hapi/ctx/HapiWorkerContext.java#L246" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/hapi/ctx/HapiWorkerContext.java#L246">https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/hapi/ctx/HapiWorkerContext.java#L246</a></p>
<p>Here's the part where the information aobut not present code system is returned<br>
<a href="https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/hapi/ctx/HapiWorkerContext.java#L298" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/hapi/ctx/HapiWorkerContext.java#L298">https://github.com/jamesagnew/hapi-fhir/blob/master/hapi-fhir-structures-dstu3/src/main/java/org/hl7/fhir/dstu3/hapi/ctx/HapiWorkerContext.java#L298</a></p>
<p>Unfortunately a ValidationResult without a ConceptDefinitionComponent returns false from isOk(). The upper loop then ends up returning a validation error.</p>



<a name="168037634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168037634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168037634">(Jun 13 2019 at 11:57)</a>:</h4>
<p>oh. you are using a very very old version of the validator. You should be using the latest R5 validator</p>



<a name="168037651"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168037651" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168037651">(Jun 13 2019 at 11:57)</a>:</h4>
<p>in hapi-core</p>



<a name="168059957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168059957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168059957">(Jun 13 2019 at 16:14)</a>:</h4>
<p>HAPI FHIR 3.8.0 uses the latest R4 validator (not the R5 one, we're going to make that switch during the current development cycle) but it's not hugely out of date either.</p>
<p>"Not present" doesn't mean "can't validate" to HAPI though. If you load LOINC/SCT/etc into the JPA server for example, you get a not-present CodeSystem because the content is loaded into non-FHIR tables in the JPA server.</p>
<p>You should probably be defining an IValidationSupport implementation that always accepts codes in your code system if you want them to be ignored.</p>



<a name="168112105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168112105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168112105">(Jun 14 2019 at 07:06)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191319">@James Agnew</span> Does having the R4 validator in HAPI 3.8 mean that when validating STU3 resources, one has to first transform the STU3 StructureDefs into R4 format? (this was my, possibly faulty, understanding of an earlier thread that I unfortunately cannot find now). If so, are there available examples for that?</p>



<a name="168112472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168112472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168112472">(Jun 14 2019 at 07:13)</a>:</h4>
<p><span class="user-mention" data-user-id="194703">@Morten Ernebjerg</span> this is done by hapi automatically for you.</p>



<a name="168113039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168113039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168113039">(Jun 14 2019 at 07:23)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="191451">@Patrick Werner</span> !</p>



<a name="168124495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168124495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168124495">(Jun 14 2019 at 10:39)</a>:</h4>
<blockquote>
<p>HAPI FHIR 3.8.0 uses the latest R4 validator (not the R5 one, we're going to make that switch during the current development cycle) but it's not hugely out of date either.</p>
<p>"Not present" doesn't mean "can't validate" to HAPI though. If you load LOINC/SCT/etc into the JPA server for example, you get a not-present CodeSystem because the content is loaded into non-FHIR tables in the JPA server.</p>
<p>You should probably be defining an IValidationSupport implementation that always accepts codes in your code system if you want them to be ignored.</p>
</blockquote>
<p>I don't fully understand how IValidationSupport can affect it, as HapiWorkerContext doesn't delegate checking codes to IValidationSupport. As far as I can tell it is the same in the R4 version. This is our current workaround to the problem in R3 HapiWorkerContext:</p>
<p><a href="https://github.com/jamesagnew/hapi-fhir/commit/1e53855efce5c06237dc4f42d82e0f44088e99ed#diff-54dbe8151297e1b5b53601cfa22f7601R303" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/commit/1e53855efce5c06237dc4f42d82e0f44088e99ed#diff-54dbe8151297e1b5b53601cfa22f7601R303">https://github.com/jamesagnew/hapi-fhir/commit/1e53855efce5c06237dc4f42d82e0f44088e99ed#diff-54dbe8151297e1b5b53601cfa22f7601R303</a></p>



<a name="168573624"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168573624" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168573624">(Jun 20 2019 at 07:45)</a>:</h4>
<p>I studied it further. We tried to implement a IValidationSupport which returns ok on the validate method. This does not help as Hapi actually validates the code in two places. I debugged the system and took two stacktraces where validateCode is called. Have  a look at this diff from the stacktraces:</p>
<p>&lt; HapiWorkerContext.validateCode(String, String, String, ValueSet) line: 297<br>
&lt; FhirInstanceValidator$WorkerContextWrapper.validateCode(String, ValueSet) line: 780<br>
&lt; InstanceValidator.checkPrimitiveBinding(List&lt;ValidationMessage&gt;, String, String, ElementDefinition, Element, StructureDefinition) line: 1681<br>
&lt; InstanceValidator.checkPrimitive(Object, List&lt;ValidationMessage&gt;, String, String, ElementDefinition, Element, StructureDefinition) line: 1599<br>
&lt; InstanceValidator.validateElement(ValidatorHostContext, List&lt;ValidationMessage&gt;, StructureDefinition, ElementDefinition, StructureDefinition, ElementDefinition, Element, Element, String, NodeStack, boolean) line: 3751</p>
<hr>
<blockquote>
<p>PhrValidationSupport.validateCode(FhirContext, String, String, String) line: 179<br>
ValidationSupportChain.validateCode(FhirContext, String, String, String) line: 158<br>
HapiWorkerContext.validateCode(String, String, String) line: 267<br>
FhirInstanceValidator$WorkerContextWrapper.validateCode(String, String, String) line: 748<br>
InstanceValidator.checkCode(List&lt;ValidationMessage&gt;, Element, String, String, String, String) line: 810<br>
InstanceValidator.checkCoding(List&lt;ValidationMessage&gt;, String, Element, StructureDefinition, ElementDefinition, boolean) line: 1051<br>
InstanceValidator.validateElement(ValidatorHostContext, List&lt;ValidationMessage&gt;, StructureDefinition, ElementDefinition, StructureDefinition, ElementDefinition, Element, Element, String, NodeStack, boolean) line: 3758<br>
InstanceValidator.validateElement(ValidatorHostContext, List&lt;ValidationMessage&gt;, StructureDefinition, ElementDefinition, StructureDefinition, ElementDefinition, Element, Element, String, NodeStack, boolean) line: 3843</p>
</blockquote>
<p>The first validation is done before our code gets called. Even thoug our IValidationSupport returns a 'ok' result it doesn't matter as the earlier validation rejects the code as non ok.</p>



<a name="168573694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168573694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168573694">(Jun 20 2019 at 07:46)</a>:</h4>
<p>are you able to create a test case for this?</p>



<a name="168585140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/supporting%20not-present%20code%20systems%20in%20Hapi%203.8.0/near/168585140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matti Uusitalo <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/supporting.20not-present.20code.20systems.20in.20Hapi.203.2E8.2E0.html#168585140">(Jun 20 2019 at 10:52)</a>:</h4>
<blockquote>
<p>are you able to create a test case for this?</p>
</blockquote>
<p>Certainly<br>
<a href="https://github.com/mattiuus/hapi-fhir/commit/456a849447f865dd5e72fc5977835df6ff63e63e" target="_blank" title="https://github.com/mattiuus/hapi-fhir/commit/456a849447f865dd5e72fc5977835df6ff63e63e">https://github.com/mattiuus/hapi-fhir/commit/456a849447f865dd5e72fc5977835df6ff63e63e</a></p>
<p>I added tests where the other one simulates our old IValidationSupport implementation and the other one the current.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
