---
layout: page
title: "FHIR Chat  · log4shell vulnerability · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html">log4shell vulnerability</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="264624734"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264624734" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264624734">(Dec 12 2021 at 13:57)</a>:</h4>
<p>A critical vulnerability in the Java logging library log4j was just discovered: <a href="https://snyk.io/blog/log4j-rce-log4shell-vulnerability-cve-2021-4428">CVE-2021-4428 aka log4shell</a>. This library is also used in HAPI and <a href="https://github.com/hapifhir/hapi-fhir/issues/3238">a GitHub ticket was already created</a>.  Are you able to estimate how long it will take for a patched version of HAPI will be released? Also, is there any HAPI-specific advice for users (beyond the <a href="https://github.com/advisories/GHSA-jfh8-c2jp-5v3q">generic guidance for dealing with this vulnerability</a>)?</p>



<a name="264624805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264624805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264624805">(Dec 12 2021 at 13:59)</a>:</h4>
<p>All good: <a href="https://www.smilecdr.com/our-blog/a-statement-on-log4shell-cve-2021-44228">https://www.smilecdr.com/our-blog/a-statement-on-log4shell-cve-2021-44228</a></p>



<a name="264625156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264625156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264625156">(Dec 12 2021 at 14:05)</a>:</h4>
<p>Thanks, good to know <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> I was looking at <a href="https://search.maven.org/artifact/ca.uhn.hapi.fhir/hapi-fhir/5.6.1/pom">the POM file for the latest release</a> and there log4j still appears. </p>
<p>Might any of the previous HAPI/JPA starter releases affected?</p>



<a name="264625327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264625327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264625327">(Dec 12 2021 at 14:09)</a>:</h4>
<p>JpaStarter used logback from the beginning (the log4j libraries are only included for compatibility). So if you didn‘t change that to Log4J  you should be good</p>



<a name="264641175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264641175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264641175">(Dec 12 2021 at 20:07)</a>:</h4>
<p>Would still be nice to bump the "pseudo-dependency" in HAPI to the patched version to avoid the vulnerable version showing up on the list of dependencies when using HAPI (which is what I saw).</p>



<a name="264641234"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264641234" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264641234">(Dec 12 2021 at 20:08)</a>:</h4>
<p>I thought about it in starter project</p>



<a name="264641756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264641756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264641756">(Dec 12 2021 at 20:21)</a>:</h4>
<p>Would b one less worry in the dependency jungle <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="264644913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264644913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264644913">(Dec 12 2021 at 21:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="194703">Morten Ernebjerg</span> <a href="#narrow/stream/179167-hapi/topic/log4shell.20vulnerability/near/264641175">said</a>:</p>
<blockquote>
<p>Would still be nice to bump the "pseudo-dependency" in HAPI to the patched version to avoid the vulnerable version showing up on the list of dependencies when using HAPI (which is what I saw).</p>
</blockquote>
<p>just created <a href="https://github.com/hapifhir/hapi-fhir/pull/3240">https://github.com/hapifhir/hapi-fhir/pull/3240</a></p>



<a name="264694540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264694540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264694540">(Dec 13 2021 at 11:43)</a>:</h4>
<p>and its already merged. Thanks <span class="user-mention" data-user-id="191319">@James Agnew</span> !</p>



<a name="264730271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264730271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264730271">(Dec 13 2021 at 16:18)</a>:</h4>
<p>FYI to anyone looking for more detail on why we're ok (a few people have asked for more detail on the blog post, I'm doing that today)</p>
<p>The general gist is that we only include log4j-api because Hibernate needs it. Hibernate's logging uses log4j (via log4j-api and then slf4j-over-log4j) and is therefore technically going through the vulnerable codebase. But Hibernate doesn't log any user-supplied messages in the way that HAPI FHIR uses it. So it would not be possible to exploit this vulnerability.</p>
<p>Outside of hibernate, all logging we do goes through directly through slf4j and therefore skips log4j entirely.</p>



<a name="264753910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264753910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264753910">(Dec 13 2021 at 19:00)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span>  I don't think log4j-api is vulnerable - it's log4j-core that is vulnerable, AFAIK.</p>



<a name="264896513"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264896513" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264896513">(Dec 14 2021 at 17:44)</a>:</h4>
<p>ah interesting <span class="user-mention" data-user-id="191427">@Jens Villadsen</span> - When I looked at the CVE writeup on Monday it specifically called out both <code>log4j-api</code> and <code>log4j-core</code> as being vulnerable.</p>
<p>That doesn't seem to be the case anymore, and the actual commit that fixes this only touches log4j-core: <a href="https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=001aaad">https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=001aaad</a></p>



<a name="264897887"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264897887" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264897887">(Dec 14 2021 at 17:52)</a>:</h4>
<p>Yep</p>



<a name="264929136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264929136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264929136">(Dec 14 2021 at 21:37)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> while I have your attention ... -&gt; you might wan't to update this: <a href="https://hapifhir.io/hapi-fhir/blog/">https://hapifhir.io/hapi-fhir/blog/</a> as it is a bit outdated</p>



<a name="264973625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264973625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264973625">(Dec 15 2021 at 07:32)</a>:</h4>
<p>History repeating: The fix in log4j v2.15 was incomplete cf. <a href="https://www.cve.org/CVERecord?id=CVE-2021-45046">CVE-2021-45046</a>. So 2.16 is the new 2.15 - <span class="user-mention" data-user-id="191451">@Patrick Werner</span> looks like another bump is needed to avoid red lights flashing....</p>



<a name="264973823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264973823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264973823">(Dec 15 2021 at 07:34)</a>:</h4>
<p>(assuming HAPI is at all affected)</p>



<a name="264973841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264973841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264973841">(Dec 15 2021 at 07:35)</a>:</h4>
<p>It aint</p>



<a name="264973856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264973856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264973856">(Dec 15 2021 at 07:35)</a>:</h4>
<p>HAPI uses logback</p>



<a name="264979793"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264979793" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264979793">(Dec 15 2021 at 08:51)</a>:</h4>
<p>Some people are alerted seeing log4j-api versions &lt; 2.16 in dependency, some CVE checkers are failing as well. I don't see harm in bumping the version to the latest, agreeing that this is an placebo.</p>



<a name="264980015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264980015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264980015">(Dec 15 2021 at 08:53)</a>:</h4>
<p><a href="https://jira.qos.ch/browse/LOGBACK-1591">https://jira.qos.ch/browse/LOGBACK-1591</a><br>
Newest logback removes JNDI and JDBC functions to mitigate a theoretical attack vector.</p>



<a name="264980048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264980048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264980048">(Dec 15 2021 at 08:53)</a>:</h4>
<p><a href="https://github.com/hapifhir/hapi-fhir/pull/3248">https://github.com/hapifhir/hapi-fhir/pull/3248</a></p>
<ul>
<li>bumps log4j-to-slf4j</li>
<li>update logback to newest version</li>
</ul>



<a name="264981126"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264981126" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264981126">(Dec 15 2021 at 09:05)</a>:</h4>
<p>There will always be someones CVE checker tool out there that fails</p>



<a name="264981419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/264981419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#264981419">(Dec 15 2021 at 09:08)</a>:</h4>
<p>I personally totally agree with your point. Unfortunately i know to many users of hapi which are irritated by seeing smth with log4j in the project.</p>



<a name="265007041"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/265007041" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#265007041">(Dec 15 2021 at 13:09)</a>:</h4>
<p>Right, lowering expectable developer stress is a worthy cause, even if it is unfounded <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="265153368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/log4shell%20vulnerability/near/265153368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/log4shell.20vulnerability.html#265153368">(Dec 16 2021 at 13:16)</a>:</h4>
<p>Yeah for sure I have no issues with bumping the log4j version even if it's unnecessary. If we're causing CVE checkers to flash, that's annoying stress for people using the library.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
