---
layout: page
title: "FHIR Chat  · How to dynamically specify client search criteria? · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20dynamically.20specify.20client.20search.20criteria.3F.html">How to dynamically specify client search criteria?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="207600800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20dynamically%20specify%20client%20search%20criteria%3F/near/207600800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Volker Wick <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20dynamically.20specify.20client.20search.20criteria.3F.html#207600800">(Aug 21 2020 at 05:01)</a>:</h4>
<p>I am implementing a FHIR server where I need to delegate a patient search query to another server backend. The server function that implements this search is called with three parameters <em>family</em>, <em>given</em> (both StringParam) and a <em>birthday</em> (DateParam)</p>
<p>My delegation code I have envisioned looks something like this ...</p>
<div class="codehilite"><pre><span></span><code>return fhirContext.newRestfulGenericClient(backendInstance)
    .search()
    .forResource(Patient.class)
    .where(criteria)   // ??? can&#39;t use .where(Patient.FAMILY.matches().value(family.getValue()))
    .execute();
</code></pre></div>


<p>However, I am not sure about how to fill the <em>criteria</em> parameter. Depending on whether family, given and birthday are present, criteria should be set accordingly. (That's why I can't use Patient.FAMILY.matches() ... or other similar functions here)</p>
<p>I did not get very far with the implementation of <em>where()</em> that accepts an <em>ICriterion&lt;...&gt;</em> object and was considering the alternative <em>where()</em> that takes a <em>Map&lt;String, List&lt;IQueryParameterType&gt;&gt;</em></p>
<p>Here is the code that sets up the criteria HashMap as I would guess how it might work. Unfortunately I am probably missing something as my code  does not yield any results (unless my search criteria are all empty):</p>
<div class="codehilite"><pre><span></span><code>    // family is a StringParam
    Map&lt;String, List&lt;IQueryParameterType&gt;&gt; criteria = new HashMap&lt;&gt;();
    if (family != null &amp;&amp; !family.isEmpty()) {
        criteria.put(&quot;family&quot;,  Arrays.asList(family));
    }
</code></pre></div>


<p>Can somebody point me in the right direction or post a documentation link that clears this up?</p>



<a name="207626008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20dynamically%20specify%20client%20search%20criteria%3F/near/207626008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Volker Wick <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20dynamically.20specify.20client.20search.20criteria.3F.html#207626008">(Aug 21 2020 at 12:02)</a>:</h4>
<p>Ok, so it turns out it works pretty much as I had outlined it in my question. A bug in my test backend had sent me on a wild goose chase and the approach was ok all along.</p>
<p>One additional point to note is that the string keys in the <em>criteria</em> map must match the corresponding search parameters, i.e. "family", "given" and "birthdate".</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
