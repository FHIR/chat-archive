---
layout: page
title: "FHIR Chat  · handling transactions · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html">handling transactions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="183169063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/183169063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#183169063">(Dec 11 2019 at 15:40)</a>:</h4>
<p>Through FHIR transactions it is possible to execute methods not exposed in the resource provider. If you eg. have removed the option to POST patients, it is still possible to do POST on a Patient resource in the transaction bundle as FHIR transactions is HAPI directly uses the underlying dao. Is this the intended behaviour? <span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="183169222"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/183169222" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#183169222">(Dec 11 2019 at 15:41)</a>:</h4>
<p>It seems a bit weird because if I try to create the Patient using ordinary creation using POST, the RestfulServer class will not allow it as it cannot find the proper binding. Could an interceptor that inspected the capability statement and whitelisted the operations be a proper solution?</p>



<a name="183170556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/183170556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#183170556">(Dec 11 2019 at 15:54)</a>:</h4>
<p>We don't support the ability to remove functionality from the JPA server,<br>
this is something you added isn't it?</p>
<p>The supported way to block operations completely from the JPA server is to<br>
use the AuthorizationInterceptor.</p>
<p>An alternate might be for you to add an interceptor that looks at<br>
transaction bundles and does some validation for whatever logic you want.</p>



<a name="183185379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/183185379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#183185379">(Dec 11 2019 at 18:25)</a>:</h4>
<blockquote>
<p>We don't support the ability to remove functionality from the JPA server,<br>
this is something you added isn't it?</p>
</blockquote>
<p>Yes, this is contained in <a href="https://github.com/jamesagnew/hapi-fhir/pull/1574" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/pull/1574">https://github.com/jamesagnew/hapi-fhir/pull/1574</a> in order for us to define fine grained control over what is supported and what isn't supported.</p>
<p>Now, besides using the JPA server capabilities, we have also added business validation rules inside our Resource Providers. We also (naturally) have an implementation of the authorization interceptor that authorizes according to our business rules - this is ofcourse invoked when running transactions as any other interceptor.</p>
<p>For us to support the current implementation of <code>transaction</code> that is going directly to the dao's probably requires us to rewrite all business validation logic that is currently carried out inside Resource Providers and instead put that logic inside the interceptors in the proper pointcuts, as the interceptors are still invoked when using the daos.</p>
<p>This is a bit of a surprise, but I understand the logic behind the design. I would therefore highly recommend that the documentation should be updated to state that putting business logic into resource providers when using the HAPI JPA is NOT be recommended if transactions should be supported.</p>
<p>Sounds reasonable?</p>



<a name="183262885"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/183262885" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#183262885">(Dec 12 2019 at 14:18)</a>:</h4>
<p>Yup, makes sense to me. PRs welcome.</p>



<a name="197568503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/197568503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#197568503">(May 14 2020 at 15:05)</a>:</h4>
<p>basic question - does hapi handle transactions ? Can I post one and watch the resources being created/deleted?</p>



<a name="197573282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/197573282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#197573282">(May 14 2020 at 15:35)</a>:</h4>
<p>yes</p>



<a name="197573457"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/197573457" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#197573457">(May 14 2020 at 15:36)</a>:</h4>
<p>assuming you are using a vanilla HAPI FHIR JPA setup</p>



<a name="197573681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/handling%20transactions/near/197573681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/handling.20transactions.html#197573681">(May 14 2020 at 15:37)</a>:</h4>
<p>thanks</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
