---
layout: page
title: "FHIR Chat  · Custom resources with JPA starter · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20resources.20with.20JPA.20starter.html">Custom resources with JPA starter</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="259425307"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20resources%20with%20JPA%20starter/near/259425307" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Young <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20resources.20with.20JPA.20starter.html#259425307">(Oct 28 2021 at 17:39)</a>:</h4>
<p>Hi all,</p>
<p>I'm currently working on a PoC with the JPA starter, but I can't seem to figure out the necessary pieces to get everything fully wired together.</p>
<p>What I have:</p>
<ul>
<li>I've created the resource class <code>FavouriteCookie</code> and have registered it with <code>context.registerCustomTypes(...)</code><ul>
<li>I followed the example here: <a href="https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#custom-resource-structure">https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#custom-resource-structure</a></li>
</ul>
</li>
<li>I've created <code>FavouriteCookieProvider</code> (patterned after <code>PatientResourceProvider</code>) and have <em>tried</em> to connect it up (example below)</li>
</ul>
<p>Customizations added in <code>JpaRestfulServer.java</code>:</p>
<div class="codehilite" data-code-language="Java"><pre><span></span><code><span class="n">BaseHapiFhirResourceDao</span><span class="o">&lt;</span><span class="n">FavouriteCookie</span><span class="o">&gt;</span> <span class="n">myDao</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JpaResourceDao</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="n">myDao</span><span class="p">.</span><span class="na">setResourceType</span><span class="p">(</span><span class="n">FavouriteCookie</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">myDao</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">fhirSystemDao</span><span class="p">.</span><span class="na">getContext</span><span class="p">());</span>
<span class="n">daoRegistry</span><span class="p">.</span><span class="na">register</span><span class="p">(</span><span class="n">myDao</span><span class="p">);</span>

<span class="n">JpaResourceProviderR4</span><span class="o">&lt;</span><span class="n">FavouriteCookie</span><span class="o">&gt;</span> <span class="n">favouriteCookieProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FavouriteCookieProvider</span><span class="p">();</span>
<span class="n">favouriteCookieProvider</span><span class="p">.</span><span class="na">setDao</span><span class="p">(</span><span class="n">myDao</span><span class="p">);</span>
<span class="n">favouriteCookieProvider</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
<span class="n">registerProviders</span><span class="p">(</span><span class="n">favouriteCookieProvider</span><span class="p">);</span>
</code></pre></div>
<p>What I'm missing:</p>
<ul>
<li>An example of how to get my custom resource fully connected up so I can interact with it on <code>/fhir/FavouriteCookie</code><ul>
<li>It recognizes that it's a resource, but I get an NPE when the search is called:<ul>
<li><code>Caused by: java.lang.NullPointerException: null at ca.uhn.fhir.jpa.dao.BaseHapiFhirResourceDao.search(BaseHapiFhirResourceDao.java:1398)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>I'm having some trouble tracking down when/where everything is created, so I'm assuming there's some piece I'm missing. The only examples I've seen in the docs seem to implement search or ID as a newly instantiated object that's returned immediately, rather than showing anything on how to connect it up to the DB. I'm obviously missing something, but I can't see what it is.</p>
<p>Is anyone able to provide some guidance?</p>



<a name="259427157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20resources%20with%20JPA%20starter/near/259427157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20resources.20with.20JPA.20starter.html#259427157">(Oct 28 2021 at 17:53)</a>:</h4>
<p>See <a href="https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#extending-fhir-resource-classes">https://hapifhir.io/hapi-fhir/docs/model/custom_structures.html#extending-fhir-resource-classes</a></p>



<a name="259433980"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20resources%20with%20JPA%20starter/near/259433980" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Young <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20resources.20with.20JPA.20starter.html#259433980">(Oct 28 2021 at 18:44)</a>:</h4>
<p>Sorry, I'm not sure I see the connection between that section and what I'm trying to do. I'm not looking to add an extension to an existing resource, I'm trying to create an entirely new resource.</p>



<a name="259434207"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20resources%20with%20JPA%20starter/near/259434207" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20resources.20with.20JPA.20starter.html#259434207">(Oct 28 2021 at 18:46)</a>:</h4>
<p>It more seems like you are trying to create a new resource type</p>



<a name="259435121"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20resources%20with%20JPA%20starter/near/259435121" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Young <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20resources.20with.20JPA.20starter.html#259435121">(Oct 28 2021 at 18:51)</a>:</h4>
<p>Is that not the same thing as a custom resource? Admittedly, I'm pretty new to FHIR, so I may not be using the correct terminology.</p>



<a name="259699754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20resources%20with%20JPA%20starter/near/259699754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20resources.20with.20JPA.20starter.html#259699754">(Oct 30 2021 at 00:24)</a>:</h4>
<p>Adding extensions to the Basic resource is the recommended mechanism for defining a custom data structure conformant with the FHIR spec.<br>
<a href="http://hl7.org/fhir/basic.html">http://hl7.org/fhir/basic.html</a></p>
<p>Notably,</p>
<blockquote>
<p>use of 'custom' resources is <strong>NOT</strong> considered to be conformant with FHIR</p>
</blockquote>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
