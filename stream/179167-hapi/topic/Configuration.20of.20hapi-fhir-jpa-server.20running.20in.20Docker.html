---
layout: page
title: "FHIR Chat  · Configuration of hapi-fhir-jpa-server running in Docker · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html">Configuration of hapi-fhir-jpa-server running in Docker</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="252885477"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252885477" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorrit <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252885477">(Sep 11 2021 at 05:56)</a>:</h4>
<p>Hi all, After about a year of experience with the FHIR REST-API I would now like to know more about the Operations (and hopefully not too much Development) side of HAPI FHIR. Yesterday I managed to get the hapi-fhir-jpa-server running in a local Docker container within a very short amount of time: great! Next step is that I want to do some partitioning-configuration on it. The documentation clearly definessome methods (<a href="https://hapifhir.io/hapi-fhir/docs/server_jpa_partitioning/enabling_in_hapi_fhir.html">https://hapifhir.io/hapi-fhir/docs/server_jpa_partitioning/enabling_in_hapi_fhir.html</a>) but I still don’t get it. How can I call configuration methods of a hapi-fhir-jpa-server running in Docker? It could be that my problem is caused by my lack of recent Java knowledge. But maybe there is still someone out there that wants to help this newbie out.</p>



<a name="252893489"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252893489" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252893489">(Sep 11 2021 at 08:31)</a>:</h4>
<p>You will need to dig into some Java development if you need to use partitions on the jpa-starter project  - and probably add some stuff around here: <a href="https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/java/ca/uhn/fhir/jpa/starter/BaseJpaRestfulServer.java">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/java/ca/uhn/fhir/jpa/starter/BaseJpaRestfulServer.java</a></p>



<a name="252964553"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252964553" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorrit <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252964553">(Sep 12 2021 at 06:44)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191427">@Jens Villadsen</span> for the reply. I was hoping there was a way to edit the configuration post-compilation. I understand now that configuration has to be done in the source code. It would be great if I can call the configuration-methods from within the initialize()-function of the BaseJpaRestfulServer-class. So my next step will be to install a Java JDK and get my hands dirty. I always knew that that Java-class on university back in 1999 would come in handy someday ;-).</p>



<a name="252978907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252978907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252978907">(Sep 12 2021 at 11:11)</a>:</h4>
<p><span class="user-mention" data-user-id="390795">@Jorrit</span> are you trying to get partitions working using docker or something more complex? It’s possible to get them working at least the basics.</p>



<a name="252979118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252979118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorrit <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252979118">(Sep 12 2021 at 11:15)</a>:</h4>
<p><span class="user-mention" data-user-id="194192">@Richard Stanley</span> I want to do a couple of configurations. First I’d like to enable partitioning to create a single instance multi tenant fhir server. Second I’d like to do some OAuth/SMART-configurations to connect the fhir server to an external OAuth-server.</p>



<a name="252981506"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252981506" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252981506">(Sep 12 2021 at 12:00)</a>:</h4>
<p>Ok, for the first task, here's what has worked for me, in a docker-compose...</p>
<div class="codehilite"><pre><span></span><code>  fhir:
    container_name: hapi-fhir
    image: hapiproject/hapi:latest
    ports:
      - &quot;8080:8080&quot;
    restart: always
    depends_on:
      - redis
    environment:
      - hapi.fhir.partitioning.enabled=true
      - hapi.fhir.partitioning.allow_references_across_partitions=false
      - hapi.fhir.partitioning.partitioning_include_in_search_hashes=false
</code></pre></div>
<p>The <code>hapi.fhir.partitioning.enabled=true</code> is not clear in the default application.yaml, but it is still picked up as a config. Ignore the redis line. See also:<br>
<a href="https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/227#issuecomment-879253206">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/issues/227#issuecomment-879253206</a><br>
Hope that helps. I don't know how to do the second task.</p>



<a name="252982574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252982574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252982574">(Sep 12 2021 at 12:20)</a>:</h4>
<p><span class="user-mention" data-user-id="194192">@Richard Stanley</span> - from what I know (from <a href="https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/15923edfd53980101ba73c517ea91e63fc3e47b1/src/main/java/ca/uhn/fhir/jpa/starter/FhirServerConfigCommon.java#L133">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/15923edfd53980101ba73c517ea91e63fc3e47b1/src/main/java/ca/uhn/fhir/jpa/starter/FhirServerConfigCommon.java#L133</a>) - setting <code>hapi.fhir.partitioning.enabled=true</code> does nothing. Setting eg. <code>api.fhir.partitioning.allow_references_across_partitions=false</code> enables partitioning.</p>



<a name="252982723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/252982723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#252982723">(Sep 12 2021 at 12:23)</a>:</h4>
<p>the point is that when you enable the details of partitioning - it automatically enables partitioning</p>



<a name="253066215"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Configuration%20of%20hapi-fhir-jpa-server%20running%20in%20Docker/near/253066215" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorrit <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Configuration.20of.20hapi-fhir-jpa-server.20running.20in.20Docker.html#253066215">(Sep 13 2021 at 10:21)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="194192">@Richard Stanley</span> and <span class="user-mention" data-user-id="191427">@Jens Villadsen</span>. I'm happy that I only have to edit hapi-fhir-jpaserver-starter/src/main/resources/application.yaml to enable partitioning, instead of actually editing one or more Java-classes.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
