---
layout: page
title: "FHIR Chat  · Custom SearchParameter multi scope · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20SearchParameter.20multi.20scope.html">Custom SearchParameter multi scope</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153901696"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20SearchParameter%20multi%20scope/near/153901696" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Broadbent <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20SearchParameter.20multi.20scope.html#153901696">(Aug 10 2017 at 18:20)</a>:</h4>
<p>Hi all,</p>
<p>I'm trying to author a search parameter that searches for the value of a reference within an extension that could be present at the root level of any resource (in my case, I have an organisation resource, which is referenced by all of the resources which are governed by it).</p>
<p>I've had a look in the docs for SearchParameters, and it suggests that it's possible to have a search parameter that has a scope of multiple resource types, and to do so you set the base to 'DomainResource'.   It doesn't say what the expression should be set to though, and when I try to upload it without an expression, I get an error from HAPI saying that it's missing.</p>
<p>I'm uploading to HAPI 2.5-snapshot, and my resource looks like this, however when I perform a search like this, I get an error back saying the search parameter does not exist:<br>
[base]/Basic?annotation=Basic/2</p>
<p>&lt;SearchParameter xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
    &lt;name value="Annotation"/&gt;<br>
    &lt;status value="active"/&gt;<br>
    &lt;code value="annotation"/&gt;<br>
    &lt;base value="DomainResource"/&gt;<br>
    &lt;type value="reference"/&gt;<br>
    &lt;xpath value="f:DocumentReference/f:extension[@url='http://www.elabdev.org/StructureDefinition/AnnotationRef']"/&gt; <br>
    &lt;xpathUsage value="normal"/&gt;<br>
 &lt;/SearchParameter&gt;</p>
<p>If I change the search parameter to look like this, the same search works and returns the expected resources:</p>
<p>&lt;SearchParameter xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
    &lt;name value="Annotation"/&gt;<br>
    &lt;status value="active"/&gt;<br>
    &lt;code value="annotation"/&gt;<br>
    &lt;base value="Basic"/&gt;<br>
    &lt;type value="reference"/&gt;<br>
    &lt;expression value="DocumentReference.extension('http://www.elabdev.org/StructureDefinition/AnnotationRef')"/&gt;<br>
    &lt;xpathUsage value="normal"/&gt;<br>
 &lt;/SearchParameter&gt;</p>
<p>However as expected I then cannot use this same search parameter to search for Patients which have the same extension in them.</p>
<p>Any ideas?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
