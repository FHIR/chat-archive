---
layout: page
title: "FHIR Chat  · Finding the patient corresponding to a resource generically · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html">Finding the patient corresponding to a resource generically</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153846184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Finding%20the%20patient%20corresponding%20to%20a%20resource%20generically/near/153846184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Jafari <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html#153846184">(Sep 02 2016 at 00:05)</a>:</h4>
<p>Working on a Consent enforcement interceptor for HAPI, a problem I encounter is to find which patient a resource pertains to in order to find the Consents filed by that patient (or her/his behalf). Right now I have to loop over different resource types, cast the resource to the subtype and call the corresponding method for getting the patient. Since this seems to be a I'm wondering if there is a generic way of doing this without casting the resource. I am aware of the terser method which works directly on the XML of a resource but I think it is not guaranteed to always give the correct answer in this case. CC: <span class="user-mention" data-user-id="191319">@James Agnew</span> </p>



<a name="153846185"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Finding%20the%20patient%20corresponding%20to%20a%20resource%20generically/near/153846185" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html#153846185">(Sep 02 2016 at 00:07)</a>:</h4>
<p>what does 'pertain to' mean?</p>



<a name="153846186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Finding%20the%20patient%20corresponding%20to%20a%20resource%20generically/near/153846186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Jafari <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html#153846186">(Sep 02 2016 at 00:11)</a>:</h4>
<p>Generally, the patient whose consent would be effective and applicable to releasing of the resource but I hear your point. I'm thinking maybe a nice way to implement this in a configurable way is to have a mapping between resource names and the corresponding field which would refer to such patient and have it as part of the configuration of the interceptor<br>
. </p>



<a name="153846191"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Finding%20the%20patient%20corresponding%20to%20a%20resource%20generically/near/153846191" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html#153846191">(Sep 02 2016 at 01:09)</a>:</h4>
<p>well, sounds like a interface + class combination to contribute to HAPI, so that James an write the hook point, and people can use your default contribution, or implement their own....?</p>



<a name="153846273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Finding%20the%20patient%20corresponding%20to%20a%20resource%20generically/near/153846273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html#153846273">(Sep 02 2016 at 13:42)</a>:</h4>
<p>This sounds like a case for compartments to me!</p>
<p>You could do something like:</p>
<div class="codehilite"><pre><span class="n">FhirTerser</span> <span class="n">t</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">newTerser</span><span class="o">();</span>
<span class="kt">boolean</span> <span class="n">pertains</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="na">isSourceInCompartmentForTarget</span><span class="o">(</span><span class="s">&quot;Patient&quot;</span><span class="o">,</span> <span class="n">condidateResource</span><span class="o">,</span> <span class="k">new</span> <span class="n">IdType</span><span class="o">(</span><span class="s">&quot;Patient/123&quot;</span><span class="o">));</span>
</pre></div>



<a name="153846329"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Finding%20the%20patient%20corresponding%20to%20a%20resource%20generically/near/153846329" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html#153846329">(Sep 02 2016 at 20:49)</a>:</h4>
<p>we don't make any promises about the relationship between the patient and the resource when we make the compartment link - we link for any reason at all; pertains is narrower</p>



<a name="153846917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Finding%20the%20patient%20corresponding%20to%20a%20resource%20generically/near/153846917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Jafari <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Finding.20the.20patient.20corresponding.20to.20a.20resource.20generically.html#153846917">(Sep 09 2016 at 22:57)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191319">@James Agnew</span> this seems an excellent place to start and definitely good enough for my demo. But I agree with Grahame that in the general case, this may be a more nuanced and perhaps jurisdiction-dependent matter.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
