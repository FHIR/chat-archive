---
layout: page
title: "FHIR Chat  · Search results in NullPointerException · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20results.20in.20NullPointerException.html">Search results in NullPointerException</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="234319885"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20results%20in%20NullPointerException/near/234319885" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ann Merete Duedal Jensen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20results.20in.20NullPointerException.html#234319885">(Apr 13 2021 at 12:59)</a>:</h4>
<p>Hi,</p>
<p>My team and I are using HAPI FHIR 5.1.0 with R4.<br>
For Encounters where one or more QuestionnaireResponses refer to the Encounter, we get a NullPointerException while doing this search:<br>
<a href="http://host:port/fhir/Encounter?_id=XXX&amp;_revinclude=*&amp;_include=*">http://host:port/fhir/Encounter?_id=XXX&amp;_revinclude=*&amp;_include=*</a></p>
<p>{<br>
    "resourceType": "OperationOutcome",<br>
    "issue": [<br>
        {<br>
            "severity": "error",<br>
            "code": "processing",<br>
            "diagnostics": "Failed to call access method: java.lang.NullPointerException"<br>
        }<br>
    ]<br>
}</p>
<p>I can reproduce the error on my local jetty server and here's a very small snippet from the log:</p>
<p>Caused by: java.lang.NullPointerException<br>
    at ca.uhn.fhir.rest.api.server.storage.ResourcePersistentId.hashCode(ResourcePersistentId.java:55)</p>
<p>I believe I know why we get the NullPointerException.<br>
Our QuestionnaireResponses doesn't contain a literal reference to a Questionnaire, but a reference by a canonical url as per definition.<br>
When looking in the database the TARGET_RESOURCE_ID (Persistent ID) is NULL in these cases and instead TARGET_RESOURCE_URL is populated in schema HFJ_RES_LINK.</p>
<p><a href="/user_uploads/10155/c1SSB9j1icYl-p5GV85dmAgN/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/c1SSB9j1icYl-p5GV85dmAgN/image.png" title="image.png"><img src="/user_uploads/10155/c1SSB9j1icYl-p5GV85dmAgN/image.png"></a></div><p>My questions: </p>
<p>Are any of you familiar with this error?</p>
<p>Does anyone of you know if this error also exists in HAPI FHIR 5.3.0? (I can't find anything in the HAPI FHIR changelog)<br>
FYI: I have tried to reproduce the error on the server <a href="http://hapi.fhir.org">hapi.fhir.org</a>, but I receive a valid response when creating the ressources and doing the search here.</p>



<a name="234321355"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20results%20in%20NullPointerException/near/234321355" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20results.20in.20NullPointerException.html#234321355">(Apr 13 2021 at 13:09)</a>:</h4>
<p>I would recommend to update latest stable - being 5.3.0 for now</p>



<a name="235153108"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20results%20in%20NullPointerException/near/235153108" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ann Merete Duedal Jensen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20results.20in.20NullPointerException.html#235153108">(Apr 19 2021 at 09:39)</a>:</h4>
<p>That what also my thought. Just wanted to check if someone knew if the problem still exists in 5.3.0.</p>



<a name="235489896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20results%20in%20NullPointerException/near/235489896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Signe Hejgaard Kristoffersen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20results.20in.20NullPointerException.html#235489896">(Apr 21 2021 at 10:59)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span>  Do you know if this issue has been fixed in 5.3.0? We cannot deduce it from the changelog</p>



<a name="235491258"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Search%20results%20in%20NullPointerException/near/235491258" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Search.20results.20in.20NullPointerException.html#235491258">(Apr 21 2021 at 11:10)</a>:</h4>
<p><span class="user-mention" data-user-id="256845">@Signe Hejgaard Kristoffersen</span>  <span class="user-mention" data-user-id="191319">@James Agnew</span>  - Not sure if this is related but in HAPI 5.0.2 (used by cqf-ruler) we were seeing NullPointerExceptions when performing .../ValueSet/&lt;valueSetId&gt;/$expand operations.   This seemed to happen after the CodeSystem associated with the ValueSet was expanded.   We recently switched to HAPI 5.3.0 and this problem went away.  (As I understand it, indices for CodeSystem expansions were stored on the file system in pre-5.3.0 HAPI but with 5.3.0 they are now stored in the database; maybe James could clarify or point us to the release notes that indicates this change.)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
