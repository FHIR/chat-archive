---
layout: page
title: "FHIR Chat  · TerminologyCapabilities · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html">TerminologyCapabilities</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="172276631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/172276631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#172276631">(Aug 02 2019 at 01:43)</a>:</h4>
<p>Has anyone tried to implement TerminologyCapabilities in HAPI? I'm having some trouble - the @Metadata annotation, which is how I'm responding to a /metadata request, won't let me return a resource of type TerminologyCapabilities (i.e. /metadata?mode=terminology)</p>



<a name="174923132"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/174923132" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#174923132">(Sep 04 2019 at 21:09)</a>:</h4>
<p>I don't think this is currently supported unfortunately. The implementation of the @Metadata method hasn't really been changed since DSTU2 days..</p>
<p>I'm assuming you're getting a clascastexception or something?</p>



<a name="174923154"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/174923154" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#174923154">(Sep 04 2019 at 21:09)</a>:</h4>
<p>(I do bet this would be really easy to fix, btw)</p>



<a name="174964361"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/174964361" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#174964361">(Sep 05 2019 at 11:28)</a>:</h4>
<p>Our "fix" was to extend <code>TerminologyCapabilities</code> and add in <code>implements IBaseConformance</code> :-)</p>



<a name="178926386"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/178926386" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#178926386">(Oct 24 2019 at 07:08)</a>:</h4>
<p>Bump. In my latest attempt at this (with HAPI 4.0.1), I was hoping that by implementing <code>@Metadata
getServerConformance(HttpServletRequest theRequest, RequestDetails theRequestDetails)</code> one of either <code>theRequest.getParameter("mode")</code> or <code>theRequestDetails.getAttribute("mode")</code> would give me the "mode=terminology" URL parameter that had been passed in.</p>
<p>Alas, both seem to be empty</p>



<a name="179777519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/179777519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#179777519">(Nov 04 2019 at 04:09)</a>:</h4>
<p>On further investigation, our problem seems to be caused by this change: <code>Server CapabilityStatement/Conformance repsonses from the /metadata endpoint will now be cached for 60 seconds always. This was previously a configurable setting on the ServerConformanceProvider, but it is now handled directly by the method binding so the provider now has no responsibility for caching.</code> The first request is coming in without any parameters, and the response is being cached and reused for a second request that comes in with <code>?mode=terminology</code></p>



<a name="179777562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/179777562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#179777562">(Nov 04 2019 at 04:10)</a>:</h4>
<p>Is there a way to turn off this caching?</p>



<a name="179920868"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/179920868" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#179920868">(Nov 05 2019 at 11:00)</a>:</h4>
<p>Oh man, interesting.</p>
<p>There is an attribute on <code>@Metadata</code> you can set to disable caching, but it's only in 4.1.0-SNAPSHOT</p>



<a name="179925356"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/179925356" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#179925356">(Nov 05 2019 at 12:09)</a>:</h4>
<p>yeah - we're hanging out for 4.1.0 (or a 4.0.4 :-)</p>



<a name="179925758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/179925758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#179925758">(Nov 05 2019 at 12:15)</a>:</h4>
<p>Would the right way to go here to be an additional attribute on <code>@Metadata</code> that specifies the mode that your specific method handles? That would be pretty easy to handle, and then you could keep the caching too</p>



<a name="179982864"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/179982864" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#179982864">(Nov 05 2019 at 22:03)</a>:</h4>
<p>Hmm, at the very least the caching needs to be parameter-sensitive, and in this case that's (at least) <code>mode</code>, noting that some values for <code>mode</code> act like <code>_summary</code> in that they subset the response, while others change it entirely.<br>
Adding the attribute sounds like a good plan -- would also assist with varying the type of the result, but <code>@Metadata</code> would also need to look for an interface as return type so that it can support a <code>TerminologyCapabilities</code> result in case one wants to handle all cases in one method.<br>
Re the caching, we would probably want to always handle that ourselves, but having the timeout attribute set to zero works for that.</p>



<a name="180034819"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/180034819" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#180034819">(Nov 06 2019 at 14:02)</a>:</h4>
<p>Yeah, I hear that.</p>
<p>In all honesty thinking about this more, I'm more inclined to drop the caching entirely from the CapabilityStatement method binding. It's useful for HAPI JPA servers because we dynamically generate some of the output based on stuff in the database (so caching is a big win there) but it seems like it's actively harmful to everyone else. The whole concept should probably be offloaded to an interceptor.</p>



<a name="187054566"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/187054566" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Williams <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#187054566">(Jan 31 2020 at 03:40)</a>:</h4>
<p>I've also been struggling with returning a TerminologyCapabilities resource, and raised <a href="https://github.com/jamesagnew/hapi-fhir/issues/1681" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/issues/1681">https://github.com/jamesagnew/hapi-fhir/issues/1681</a> to ask about the best way to do it.   I'll try extending the class as <span class="user-mention" data-user-id="191343">@Michael Lawley</span>  suggests above.   Thanks!</p>



<a name="219613911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/219613911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sanjay Kandula <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#219613911">(Dec 11 2020 at 14:45)</a>:</h4>
<p><span class="user-mention" data-user-id="351108">@Shreshta Balachandar</span>  <a class="stream" data-stream-id="179167" href="/#narrow/stream/179167-hapi">#hapi</a> <br>
Hi All,</p>
<p>Can some one please clarify us on below point. We are currently working on loading the terminology data to HAPI and exploring the options for the same.</p>
<ul>
<li>Is Hapi Fhir looking for any specific format when uploading the terminology data. We currently have the csv file and expecting the data to be stored in HL7 FHIR Json format. Or if there is any documentation around it, please let us know</li>
</ul>



<a name="219680887"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/TerminologyCapabilities/near/219680887" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/TerminologyCapabilities.html#219680887">(Dec 12 2020 at 01:09)</a>:</h4>
<p><a href="http://hl7.org/fhir/terminology-module.html">http://hl7.org/fhir/terminology-module.html</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
