---
layout: page
title: "FHIR Chat  · valueSet in search query · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html">valueSet in search query</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="233603404"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/233603404" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Moritz Kähler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#233603404">(Apr 08 2021 at 05:24)</a>:</h4>
<p>I'm trying to query resources based on a valueSet.<br>
Therefore I'm using following request:<br>
<a href="http://hapi.fhir.org/baseR4/Observation?code:in=http://hapi.fhir.org/baseR4/ValueSet/1160250">http://hapi.fhir.org/baseR4/Observation?code:in=http://hapi.fhir.org/baseR4/ValueSet/1160250</a></p>
<p>but I'm getting Unknown ValueSet: http%3A%2F%2Fhapi.fhir.org%2FbaseR4%2FValueSet%2F1160250</p>
<p>But the valueSet exists. And matching FHIR resources also exist.<br>
I tried the same with condition resource against an DSTU3 version, and it also does not work.<br>
There I did not receive an error, but the result was not filtered according to the valueSet.</p>
<p>Do I have a wrong understanding?<br>
Is it possible to query for resources with a valueSet like it is describe here: <a href="https://www.hl7.org/fhir/search.html">https://www.hl7.org/fhir/search.html</a> ?</p>



<a name="233603416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/233603416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Moritz Kähler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#233603416">(Apr 08 2021 at 05:24)</a>:</h4>
<p>(deleted)</p>



<a name="234146160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/234146160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Moritz Kähler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#234146160">(Apr 12 2021 at 12:09)</a>:</h4>
<p>does someone else face this problem?</p>



<a name="234305846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/234305846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Julian Sass <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#234305846">(Apr 13 2021 at 11:07)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="355911">@Moritz Kähler</span>, from your query it looks like you are using a literal reference to your ValueSet. You could try using a logical reference and use the canonical that's in ValueSet.url. That should work.</p>



<a name="234457192"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/234457192" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Moritz Kähler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#234457192">(Apr 14 2021 at 07:59)</a>:</h4>
<p>Thanks for you answer, but somehow it does not work.<br>
When using the canonical, I don't get an error, but it does not work as expected.</p>
<p>When I run following query<br>
<a href="http://hapi.fhir.org/baseR4/Observation?code:in=http://hl7.org/fhir/ValueSet/observation-vitalsignresult">http://hapi.fhir.org/baseR4/Observation?code:in=http://hl7.org/fhir/ValueSet/observation-vitalsignresult</a><br>
I get an empty result.<br>
But following query returns a result:<br>
<a href="http://hapi.fhir.org/baseR4/Observation?code=8302-2">http://hapi.fhir.org/baseR4/Observation?code=8302-2</a><br>
And the code 8302-2 is part of the valueSet observation-vitalsignresult.<br>
So the first query should not return an empty result.</p>



<a name="234480740"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/234480740" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#234480740">(Apr 14 2021 at 11:14)</a>:</h4>
<p>It you query the ValueSet, it is definitely there:<br>
<a href="https://hapi.fhir.org/baseR4/ValueSet/observation-vitalsignresult/$expand">https://hapi.fhir.org/baseR4/ValueSet/observation-vitalsignresult/$expand</a><br>
And, as you did, if you directly query for Observations that use one of the codes in that ValueSet they are there.<br>
So, I suspect it's either a HAPI bug or a configuration/setup issue on the public HAPI server?</p>
<p>I also tried with LOINC since the CodeSystem for it exists but the code:in doesn't.<br>
<a href="https://hapi.fhir.org/baseR4/CodeSystem?url=http://loinc.org">https://hapi.fhir.org/baseR4/CodeSystem?url=http://loinc.org</a>   (CodeSystem exists)<br>
<a href="https://hapi.fhir.org/baseR4/ValueSet?url=http://loinc.org">https://hapi.fhir.org/baseR4/ValueSet?url=http://loinc.org</a> (ValueSet doesn't)<br>
<a href="https://hapi.fhir.org/baseR4/Observation?code:in=http://loinc.org">https://hapi.fhir.org/baseR4/Observation?code:in=http://loinc.org</a>  (doesn't return any Obs)</p>



<a name="234831977"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/234831977" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Moritz Kähler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#234831977">(Apr 16 2021 at 10:46)</a>:</h4>
<p>This issue is already reported here: <a href="https://github.com/hapifhir/hapi-fhir/issues/1784">https://github.com/hapifhir/hapi-fhir/issues/1784</a><br>
But this thread is older than one year.</p>



<a name="269739039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/valueSet%20in%20search%20query/near/269739039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Moritz Kähler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/valueSet.20in.20search.20query.html#269739039">(Jan 28 2022 at 13:56)</a>:</h4>
<p>In Hapi 5.6 this is solved.<br>
More details see here: <br>
<a href="#narrow/stream/179167-hapi/topic/code.3Ain">https://chat.fhir.org/#narrow/stream/179167-hapi/topic/code.3Ain</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
