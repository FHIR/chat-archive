---
layout: page
title: "FHIR Chat  · fhir.parser.DataFormatException when searching for o · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/fhir.2Eparser.2EDataFormatException.20when.20searching.20for.20o.html">fhir.parser.DataFormatException when searching for o</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153867544"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/fhir.parser.DataFormatException%20when%20searching%20for%20o/near/153867544" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/fhir.2Eparser.2EDataFormatException.20when.20searching.20for.20o.html#153867544">(Jan 16 2017 at 13:36)</a>:</h4>
<p>For Fhir 2.2, DSTU2<br>
We have a named query returning a bundle of Patient and WalkInQueueItems. WalkInQueueItem is our own FHIR domain resources, and not a dstu2-ressource (surprise...).</p>
<p>In end-2-end test we test this by calling:<br>
        FhirContext ctx = FhirContext.forDstu2();<br>
        ctx.setParserErrorHandler(new NoLoggingErrorHandler());<br>
        client = ctx.newRestfulGenericClient("http://" + getUrl());<br>
        client.search()<br>
              .byUrl("Patient?_query=activeQueueItems")<br>
              .where(&lt;someClientParam))<br>
              .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)<br>
              .execute();<br>
(we are not happy about the byUrl-part, would have loved a "withQuery(String)"-possibility)</p>
<p>This results in the following error:<br>
Caused by: ca.uhn.fhir.parser.DataFormatException: DataFormatException at [[row,col {unknown-source}]: [1,893]]: Unknown resource name "WalkInQueueItem" (this name is not known in FHIR version "DSTU2")<br>
    at ca.uhn.fhir.parser.XmlParser.doXmlLoop(XmlParser.java:277)<br>
    at ca.uhn.fhir.parser.XmlParser.parseResource(XmlParser.java:1051)<br>
    at ca.uhn.fhir.parser.XmlParser.doParseResource(XmlParser.java:188)<br>
    at ca.uhn.fhir.parser.BaseParser.parseResource(BaseParser.java:644)<br>
    at ca.uhn.fhir.rest.client.BaseClient$ResourceResponseHandler.invokeClient(BaseClient.java:488)<br>
    at ca.uhn.fhir.rest.client.BaseClient$ResourceResponseHandler.invokeClient(BaseClient.java:440)<br>
    at ca.uhn.fhir.rest.client.BaseClient.invokeClient(BaseClient.java:320)<br>
    ... 33 more</p>
<p>I have tried with a extension of a DSTU2-ressource(location) in stead of WalkInQueueItem: same error<br>
I have tried with a standard DSTU2-ressource (appointment) in stead of WalkInQueueItem: no error</p>
<p>Seems to be a bug? Any workarounds?</p>



<a name="153868012"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/fhir.parser.DataFormatException%20when%20searching%20for%20o/near/153868012" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/fhir.2Eparser.2EDataFormatException.20when.20searching.20for.20o.html#153868012">(Jan 18 2017 at 09:21)</a>:</h4>
<p>Most of the samples on <a href="http://hapifhir.io/doc_extensions.html" target="_blank" title="http://hapifhir.io/doc_extensions.html">http://hapifhir.io/doc_extensions.html</a> assumes that the extended resource is defined as a class that is registered in the context using annotations. Is your server exposed somewhere?</p>



<a name="153868013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/fhir.parser.DataFormatException%20when%20searching%20for%20o/near/153868013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/fhir.2Eparser.2EDataFormatException.20when.20searching.20for.20o.html#153868013">(Jan 18 2017 at 09:40)</a>:</h4>
<p>We extend the dstu2 hapi classes.<br>
E.g extending Location:<br>
@ResourceDef(name = "ArrivalLocation")<br>
public class FhirArrivalLocation extends Location<br>
Eg. extending baseResource:<br>
@ResourceDef(name = "WalkInQueueItem")<br>
public class FhirWalkInQueueItem extends BaseResource</p>



<a name="153868014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/fhir.parser.DataFormatException%20when%20searching%20for%20o/near/153868014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/fhir.2Eparser.2EDataFormatException.20when.20searching.20for.20o.html#153868014">(Jan 18 2017 at 09:49)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> : any input on this?</p>



<a name="153868106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/fhir.parser.DataFormatException%20when%20searching%20for%20o/near/153868106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/fhir.2Eparser.2EDataFormatException.20when.20searching.20for.20o.html#153868106">(Jan 18 2017 at 16:38)</a>:</h4>
<p>Hi<br>
I needed to register the ressources: <br>
ctx.registerCustomTypes(Arrays.asList(FhirWalkInQueueItem.class));<br>
and it works :-)</p>



<a name="153868352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/fhir.parser.DataFormatException%20when%20searching%20for%20o/near/153868352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/fhir.2Eparser.2EDataFormatException.20when.20searching.20for.20o.html#153868352">(Jan 19 2017 at 09:37)</a>:</h4>
<p>Great ;)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
