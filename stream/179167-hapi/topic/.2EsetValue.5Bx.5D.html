---
layout: page
title: "FHIR Chat  · .setValue[x] · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html">.setValue[x]</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153940750"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153940750" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153940750">(Feb 26 2018 at 20:49)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> I am working on R3-R4 conversions using the java reference classes, and an issue has come up for me. Where we have .value[x], we generate typed hasValue and getValue accessors. And a plain unadorned .setValue. I'd like to modify the generated .setValue by checking the type when it's used, so that illegal types are not allowed. </p>
<p>thoughts?</p>



<a name="153942004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942004">(Mar 04 2018 at 02:05)</a>:</h4>
<p>That makes perfect sense to me</p>



<a name="153942005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942005">(Mar 04 2018 at 02:06)</a>:</h4>
<p>if you're going to tweak the value[x] getter/setter methods, do you have any thoughts on this: <a href="https://github.com/jamesagnew/hapi-fhir/issues/846" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/issues/846">https://github.com/jamesagnew/hapi-fhir/issues/846</a></p>



<a name="153942020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942020">(Mar 04 2018 at 04:51)</a>:</h4>
<p>should I also generate type specific setters too, yes?</p>



<a name="153942021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942021">(Mar 04 2018 at 04:56)</a>:</h4>
<p>as for gh issue.... interesting. I think it should return null if the value is null. I'll change the generator</p>



<a name="153942022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942022">(Mar 04 2018 at 04:56)</a>:</h4>
<p>I can't see that this will break anyone in a bad way?</p>



<a name="153942046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942046">(Mar 04 2018 at 13:27)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> I don't see a benefit to type-specific setters. The generic set can handle any types so there is no added convenience, and JavaDocs should take care of advertising what's allowable.</p>
<p>And agreed on the GH issue. Returning null seems safest, I really hope nobody is depending on the NPE there (they certainly shouldn't be, it isn't documented)</p>



<a name="153942069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942069">(Mar 04 2018 at 16:15)</a>:</h4>
<p>well, the thing is, if the type list changes, you get a compile error</p>



<a name="153942071"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942071" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942071">(Mar 04 2018 at 16:31)</a>:</h4>
<p>ok, so, I've updated the java generator:</p>



<a name="153942072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942072">(Mar 04 2018 at 16:31)</a>:</h4>
<div class="codehilite"><pre><span></span>        <span class="kr">public</span> <span class="nx">UriType</span> <span class="nx">getValueSetUriType</span><span class="p">()</span> <span class="kr">throws</span> <span class="nx">FHIRException</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">valueSet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">valueSet</span> <span class="k">instanceof</span> <span class="nx">UriType</span><span class="p">))</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">FHIRException</span><span class="p">(</span><span class="s2">&quot;Type mismatch: the type UriType was expected, but &quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">valueSet</span><span class="p">.</span><span class="nx">getClass</span><span class="p">().</span><span class="nx">getName</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; was encountered&quot;</span><span class="p">);</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">UriType</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueSet</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>



<a name="153942073"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942073" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942073">(Mar 04 2018 at 16:32)</a>:</h4>
<div class="codehilite"><pre><span></span>        <span class="kd">public</span> <span class="n">ElementDefinitionBindingComponent</span> <span class="nf">setValueSet</span><span class="o">(</span><span class="n">Type</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!(</span><span class="n">value</span> <span class="k">instanceof</span> <span class="n">UriType</span> <span class="o">||</span> <span class="n">value</span> <span class="k">instanceof</span> <span class="n">CanonicalType</span><span class="o">))</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">FHIRFormatError</span><span class="o">(</span><span class="s">&quot;Not the right type for ElementDefinition.binding.valueSet[x]: &quot;</span><span class="o">+</span><span class="n">value</span><span class="o">.</span><span class="na">fhirType</span><span class="o">());</span>
          <span class="k">this</span><span class="o">.</span><span class="na">valueSet</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
          <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
        <span class="o">}</span>
</pre></div>



<a name="153942074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942074">(Mar 04 2018 at 16:32)</a>:</h4>
<p>so I'm applying these changes to the r4 package. What do we need to do about the others?</p>



<a name="153942089"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942089" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942089">(Mar 04 2018 at 17:19)</a>:</h4>
<p>Re. the compile error, truthfully I don't see many people using these when the existing setter is shorter. I suppose we could just get rid of <code>setValueSet(Type)</code> and replace it with <code>setValueSet(CanonicalType)</code> and <code>setValueSet(UriType)</code>. Is that what you mean? That wouldn't break existing code (unless that code was wrong in the first place) so that wouldn't be so bad.</p>



<a name="153942090"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942090" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942090">(Mar 04 2018 at 17:20)</a>:</h4>
<p>I guess if someone had their CanonicalType or UriType in a variable of type <code>Type</code> it would break... I dunno, I'm 50/50 on that.</p>



<a name="153942091"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942091" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942091">(Mar 04 2018 at 17:20)</a>:</h4>
<p>Re the other packages, is it feasible to do the same for the R3 structures? I don't think it's worth doing anything to the previous versions.</p>



<a name="153942095"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942095" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942095">(Mar 04 2018 at 17:50)</a>:</h4>
<p>I could do that, sure. I guess the downside of generating setValueSet(CanonicalType) and setValueSet(UriType) is just more code in the dropdown prompt...?</p>



<a name="153942096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942096">(Mar 04 2018 at 17:55)</a>:</h4>
<p>although there's also plenty of places in the convertor where the signature is Type, so that would break a huge amount of my code, in fact</p>



<a name="153942097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942097">(Mar 04 2018 at 17:58)</a>:</h4>
<p>My vote is don't bother with new setters then. They will just be noise.</p>



<a name="153942099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/.setValue%5Bx%5D/near/153942099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/.2EsetValue.5Bx.5D.html#153942099">(Mar 04 2018 at 17:58)</a>:</h4>
<p>k</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
