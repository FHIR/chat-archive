---
layout: page
title: "FHIR Chat  · CustomSearchParameter, FHIR path, expression · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/CustomSearchParameter.2C.20FHIR.20path.2C.20expression.html">CustomSearchParameter, FHIR path, expression</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="206034760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/CustomSearchParameter%2C%20FHIR%20path%2C%20expression/near/206034760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marian Hummel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/CustomSearchParameter.2C.20FHIR.20path.2C.20expression.html#206034760">(Aug 05 2020 at 15:15)</a>:</h4>
<p>Hi everyone.</p>
<p>according to <a href="https://www.hl7.org/fhir/searchparameter-registry.html">https://www.hl7.org/fhir/searchparameter-registry.html</a> Section Appointment the path (expression) for parameter <em>practitioner</em> is   <em>Appointment.​participant.​actor.​where(resolve() is Practitioner)</em></p>
<p>Now i want to build one for relatedPersons as well.</p>
<p>My custom Parameter looks like this</p>
<div class="codehilite"><pre><span></span><code>            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">addBase</span><span class="p">(</span><span class="s">&quot;Appointment&quot;</span><span class="p">)</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">code</span> <span class="p">=</span> <span class="s">&quot;participatingRelatives&quot;</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">type</span> <span class="p">=</span> <span class="n">Enumerations</span><span class="p">.</span><span class="n">SearchParamType</span><span class="p">.</span><span class="n">REFERENCE</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">title</span> <span class="p">=</span> <span class="s">&quot;Appointment participating relatives&quot;</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">expression</span> <span class="p">=</span> <span class="s">&quot;participant.actor.where(resolve() is RelatedPerson)&quot;</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">xpathUsage</span> <span class="p">=</span> <span class="n">SearchParameter</span><span class="p">.</span><span class="n">XPathUsageType</span><span class="p">.</span><span class="n">NORMAL</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">status</span> <span class="p">=</span> <span class="n">Enumerations</span><span class="p">.</span><span class="n">PublicationStatus</span><span class="p">.</span><span class="n">DRAFT</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">addComparator</span><span class="p">(</span><span class="n">SearchParameter</span><span class="p">.</span><span class="n">SearchComparator</span><span class="p">.</span><span class="n">EQ</span><span class="p">)</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">addModifier</span><span class="p">(</span><span class="n">SearchParameter</span><span class="p">.</span><span class="n">SearchModifierCode</span><span class="p">.</span><span class="n">CONTAINS</span><span class="p">)</span>
</code></pre></div>


<p>This one can be created and used without error message, but it does not work as wanted.</p>
<p>My first intention was to set the expression at the xpath parameter</p>
<div class="codehilite"><pre><span></span><code>            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">xpath</span> <span class="p">=</span> <span class="s">&quot;participant.actor.where(resolve() is RelatedPerson)&quot;</span>
</code></pre></div>


<p>My next idea is to set a reference to parameter actor and use chained search parameters from here</p>
<div class="codehilite"><pre><span></span><code>            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">type</span> <span class="p">=</span> <span class="n">Enumerations</span><span class="p">.</span><span class="n">SearchParamType</span><span class="p">.</span><span class="n">REFERENCE</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">expression</span> <span class="p">=</span> <span class="s">&quot;participant.actor&quot;</span>
</code></pre></div>


<p>Unfortunately my approaches do not work, where am I wrong?</p>



<a name="206122341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/CustomSearchParameter%2C%20FHIR%20path%2C%20expression/near/206122341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marian Hummel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/CustomSearchParameter.2C.20FHIR.20path.2C.20expression.html#206122341">(Aug 06 2020 at 09:57)</a>:</h4>
<p>Now i went for</p>
<div class="codehilite"><pre><span></span><code>            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">type</span> <span class="p">=</span> <span class="n">Enumerations</span><span class="p">.</span><span class="n">SearchParamType</span><span class="p">.</span><span class="n">TOKEN</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">xpath</span> <span class="p">=</span> <span class="s">&quot;participant.actor&quot;</span>
            <span class="n">participantsSearchParameter</span><span class="p">.</span><span class="n">expression</span> <span class="p">=</span> <span class="s">&quot;Appointment.actor&quot;</span>
</code></pre></div>


<p>i can now search for general participants, but i cannot distinguish by type (Patient, Practitioner, RelatedPersons)</p>
<p>Its not ideal, but it would work. Any other ideas?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
