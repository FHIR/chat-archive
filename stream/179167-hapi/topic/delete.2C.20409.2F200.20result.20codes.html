---
layout: page
title: "FHIR Chat  · delete, 409/200 result codes · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html">delete, 409/200 result codes</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="157108964"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157108964" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157108964">(Jan 29 2019 at 14:35)</a>:</h4>
<p>During our FHIR training courses we ask the attendees to run a transaction (a bunch of clinical resources associated with their 'own' patient) on any of the public test servers. We've been doing this for a while now, but we took the precaution of adding a specific tag to those resources. I just wrote  script to delete all of these resources (DELETE http verb, obviously), but on HAPI (the dstu4 public server) I quite often get a 409 statuscode. Or: the return code is 200, but the resource hasn't been deleted (the latter currently causes my script to loop). Any suggestions?</p>



<a name="157109817"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157109817" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157109817">(Jan 29 2019 at 14:46)</a>:</h4>
<p>"If the server refuses to delete a resource because of reasons specific to that resource, such as referential integrity, it should return the 409 Conflict status code. " - hmm. Obviously if one attempts to delete a graph of resources there will be dangling references at some point in time. Is HAPI forcing me to use a transaction to delete a full graph (and better don't forget to include anything, for that could cause a dangling link) ?</p>



<a name="157116225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157116225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157116225">(Jan 29 2019 at 16:20)</a>:</h4>
<p>Does the HAPI server cache responses to queries? My script executes the sequence REPEAT [ a) query for all resources with a certain meta tag, b) if &gt;0 matches, delete them by means of the fullURLs ]. Problem being that the response to the query remains the same, as if the delete hasn't worked. But if I fetch one of the URLS using Postman, it returns an OperationOutcome to indicate that the resource was deleted..</p>



<a name="157117063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157117063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157117063">(Jan 29 2019 at 16:31)</a>:</h4>
<p>not too unexpected... delete, not just in HAPI or even FHIR, is a highly variable operation. True in databases as well as REST. Add to that the aversion Healthcare has to the concept of delete, given the regulated "medical records retention" requirements.  add to that the purge upon intended-use expiration...    seems your experience is proving to your students the proper lesson to expect the unexpected when it comes to delete. Policy and technology will get in the way of expectations.</p>



<a name="157123005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157123005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157123005">(Jan 29 2019 at 17:47)</a>:</h4>
<p>I'm not complaining about the 409, although HAPI is the only public test server (that we're using in our courses) to check for referential integrity. I'd like to know (according to whatever HAPI rules enforces when it comes to references) how to still delete stuff. Only those that developed HAPI will know the answer, or perhaps its actually documented somewhere.</p>
<p>Caching of search results, and serving those if the same requester sends the same query, that's bugging me a lot more - when deleting stuff, the search result is bogus upon the second query. So if there's caching, what's the timeout - so I can ensure to "wait" before querying again. Only those that developed HAPI will know the answer..</p>



<a name="157125883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157125883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157125883">(Jan 29 2019 at 18:25)</a>:</h4>
<p>FYI - I found out during this past connectathon that you can control HAPI's search behavior to not send cached results if you send the Cache-Control request header with a value of "no-cache".</p>



<a name="157169505"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157169505" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157169505">(Jan 30 2019 at 08:04)</a>:</h4>
<p><span class="user-mention" data-user-id="191370">@Richard Ettema</span> Thanks, this does seem to work to deal with the caching issue. I'll still have to deal with the 409s, but that may simply be  a matter of reordering the set of resource types I'm deleting, to ensure I hot the ones with 'outbound refs only' before heading for the leaf-nodes in the graph.</p>



<a name="157173810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157173810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157173810">(Jan 30 2019 at 09:39)</a>:</h4>
<p>Does the OperationOutcome include details of the issues? /with the 409 status)</p>



<a name="157175274"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157175274" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157175274">(Jan 30 2019 at 10:10)</a>:</h4>
<p>I haven't actually checked OperationOutcome.. reordering the sequence of deletes has solved the issue. I was thinking of writing a recursive procedure to delete resources in the correct order, but that would need a "find all resources (of any kind) that have a reference to the current resource" kind of functionality, and there's no easy way of doing that in FHIR.</p>



<a name="157178057"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157178057" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157178057">(Jan 30 2019 at 11:09)</a>:</h4>
<p>I thought that the OpOutcome along with the 409 might have included those details to help your job - it could also have been empty, but at least worth a look. Glad you've got it sorted now anyway.</p>



<a name="157263459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157263459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157263459">(Jan 31 2019 at 10:58)</a>:</h4>
<p>OperationOutcomes does note (in text) that another resource still references it, and also shows the name of the reference (e.g. Patient.managingOrganisation).</p>



<a name="157419531"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/delete%2C%20409/200%20result%20codes/near/157419531" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/delete.2C.20409.2F200.20result.20codes.html#157419531">(Feb 02 2019 at 11:20)</a>:</h4>
<p>I guess that's at least something ;)<br>
Good to know.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
