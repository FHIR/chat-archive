---
layout: page
title: "FHIR Chat  · HAPI Validation using derived profiles · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html">HAPI Validation using derived profiles</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="201353844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201353844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201353844">(Jun 19 2020 at 05:28)</a>:</h4>
<p>Does HAPI work with derived profiles? </p>
<p>FHIR Validator works fine, as does hapi with <a href="https://fhir.nhs.uk/R4/StructureDefinition/UKCore-PractitionerRole">https://fhir.nhs.uk/R4/StructureDefinition/UKCore-PractitionerRole</a>. <br>
but <a href="https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole">https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole</a> which is a derived profile returns <br>
<a href="https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole">https://fhir.nhs.uk/R4/StructureDefinition/DM-PractitionerRole</a></p>
<p>I can see the StructureDefinition being returned in the valiation chain. (I'm still debugging)</p>



<a name="201356072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201356072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201356072">(Jun 19 2020 at 06:16)</a>:</h4>
<p>This is getting weird. It's finding resources that are not in supplied packages but in ones I unofficially released using IG Publisher.</p>



<a name="201356175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201356175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201356175">(Jun 19 2020 at 06:18)</a>:</h4>
<p>note that the core HAPI validator is the same is the FHIR Validator, but the context it runs in is much more complicated than the FHIR validation because the context management gives you - the system integrator using HAPI - much more control, as befits an application library. </p>
<p>Also, which version of FHIR are you using? the package subsystem was re-written in HAPI 5</p>



<a name="201357006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201357006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201357006">(Jun 19 2020 at 06:36)</a>:</h4>
<p>on HAPI 5 but did have this working on earlier versions. I think I need to clear my cache - suspect I've got it looking there.</p>



<a name="201359380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201359380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201359380">(Jun 19 2020 at 07:24)</a>:</h4>
<p>Need to investigate more. It does seem the (simplifier) packages I'm using are be ignored for another source of packages somewhere in the process.</p>



<a name="201403385"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201403385" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201403385">(Jun 19 2020 at 15:13)</a>:</h4>
<p>snapshot?</p>



<a name="201405676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201405676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201405676">(Jun 19 2020 at 15:31)</a>:</h4>
<p>And the problem was the new person on the team not creating a snapshot profiles in the IG......</p>
<p>No names</p>



<a name="201433780"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201433780" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201433780">(Jun 19 2020 at 19:56)</a>:</h4>
<p><span class="user-mention" data-user-id="203235">@Ward Weistra</span> not sure if it’s a requirement for packages but issue above was caused by lack of snapshot in profile.</p>



<a name="201434027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201434027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201434027">(Jun 19 2020 at 19:59)</a>:</h4>
<p>the validator should just automatically populate the snapshot. So I would like to know why that's a problem</p>



<a name="201436628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201436628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201436628">(Jun 19 2020 at 20:28)</a>:</h4>
<p><span class="user-mention" data-user-id="194909">@Kevin Mayfield</span> Also, it's not a requirement yet, but we are moving there to prevent other tools needing to generate it.</p>



<a name="201459980"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201459980" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201459980">(Jun 20 2020 at 03:46)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> I'm going to look into that, that's my preferred option. The packages look fine and I think I just need a step to create the snapshot during load (which I think is a step the FHIR Validator does).</p>



<a name="201459988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201459988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201459988">(Jun 20 2020 at 03:46)</a>:</h4>
<p>well, I think that the HAPI context should sort that out</p>



<a name="201460054"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201460054" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201460054">(Jun 20 2020 at 03:48)</a>:</h4>
<p>It might be how I've created profiles. They are on top of UK Core profiles not base.</p>



<a name="201460072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201460072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201460072">(Jun 20 2020 at 03:49)</a>:</h4>
<p>shouldn't matter. my view is that the HAPI context should sort that out</p>



<a name="201518751"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201518751" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201518751">(Jun 21 2020 at 05:47)</a>:</h4>
<p>TERMINOLOGY  -  I think its my validationSupport at fault. It needs to expand ValueSets and create Snapshots. Looking at <a href="https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/BaseWorkerContext.java">https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/BaseWorkerContext.java</a> some of this is done there. I think my fetchResource needs to do this.</p>
<p>The HAPI RemoteTerminologyServiceValidationSupport seems to behave differently to BaseWorkerContext around SNOMED.</p>



<a name="201521729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201521729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201521729">(Jun 21 2020 at 07:22)</a>:</h4>
<p>SNAPSHOT - It appears the validation worker context would do that but I can't find a link to that in HAPI. <br>
I should be calling something like  ProfileUtilities in org.hl7.fhir.r4.conformance to generate the context.</p>



<a name="201527275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201527275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201527275">(Jun 21 2020 at 09:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> I think the context should look after snapshot generation automatically. Java user shouldn't have to think about this</p>



<a name="201548699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20Validation%20using%20derived%20profiles/near/201548699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20Validation.20using.20derived.20profiles.html#201548699">(Jun 21 2020 at 19:12)</a>:</h4>
<p>ProfileUtilities.generateSnapshot  worked for me. <br>
I roughly followed this <a href="https://github.com/hapifhir/org.hl7.fhir.core/blob/463a5574027473db99df732859c1b408e11f0423/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/SimpleWorkerContext.java#L582">https://github.com/hapifhir/org.hl7.fhir.core/blob/463a5574027473db99df732859c1b408e11f0423/org.hl7.fhir.r4/src/main/java/org/hl7/fhir/r4/context/SimpleWorkerContext.java#L582</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
