---
layout: page
title: "FHIR Chat  · Generating code for Profiles · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html">Generating code for Profiles</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="201089621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201089621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201089621">(Jun 17 2020 at 00:20)</a>:</h4>
<p>So this is a kind of FAQ and I'd like to see if I can progress this. A lot of people would like to see generated code for profiles.</p>



<a name="201089676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201089676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201089676">(Jun 17 2020 at 00:20)</a>:</h4>
<p>A first time knee jerk reaction is to think that you would generate a class model like we do for the base resources.</p>



<a name="201089720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201089720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201089720">(Jun 17 2020 at 00:21)</a>:</h4>
<p>but that's not the case. A resource may conform to multiple profiles, and it may or may not indicate that it does, and you may know that it does even though it doesn't claim to. And you may have code for various profiles, and the base resource - it's all the same information whatever</p>



<a name="201090139"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201090139" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201090139">(Jun 17 2020 at 00:29)</a>:</h4>
<p>so I've always thought a profile is a view onto a resource - that is, a set of generated classes that are a facade to the base resource. So something like</p>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProfileName</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">ProfileName</span> <span class="nf">wrap</span><span class="p">(</span><span class="o">[</span><span class="n">RT</span><span class="o">]</span> <span class="n">object</span><span class="p">,</span> <span class="n">IWorkerContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="kd">public</span> <span class="o">[</span><span class="n">RT</span><span class="o">]</span> <span class="nf">wrapped</span><span class="p">();</span>

  <span class="kd">public</span> <span class="n">Coding</span> <span class="nf">getRace</span><span class="p">();</span>
  <span class="kd">public</span> <span class="n">ProfileName</span> <span class="nf">setRace</span><span class="p">(</span><span class="n">Coding</span> <span class="n">code</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div>


<p>[RT] is the base resource type. </p>
<p>where the generated code would:</p>
<ul>
<li>have generated accessors that access the wrapped class for all existing properties</li>
<li>the generated accessors have reduced cardinality if the profile does (e.g. 1..* --&gt; 1..1)</li>
<li>the type would be reduced as per the </li>
<li>the access is also generated based on ElementDefinition.alias?</li>
<li>There would be accessors for named slices</li>
</ul>
<p>Note that the generated classes will need access to the context because there's quite a lot of magic behind the scenes to do with discriminators</p>



<a name="201090340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201090340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201090340">(Jun 17 2020 at 00:31)</a>:</h4>
<p>I have several questions</p>
<ul>
<li>should the generated code handle non-conformance in the base resource by blowing up? or by ignoring the content that is not conformant?</li>
<li>what would the package name be? is that somehow auto-generated or purely config?</li>
<li>how performant does it need to be? I think that the answer is: as fast as possible while being truly conformant. </li>
<li>But there's some corner cases where a terminology service is needed. That's the opposite of performant... not sure what to do there</li>
</ul>



<a name="201090390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201090390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201090390">(Jun 17 2020 at 00:32)</a>:</h4>
<ul>
<li>should the name be versioned? Or the package? Or is that delegated to configuration for the generator?</li>
</ul>



<a name="201090407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201090407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201090407">(Jun 17 2020 at 00:33)</a>:</h4>
<ul>
<li>is it better to generate one single large class with inner nested classes for each profile, or should it be a package for each profile?</li>
</ul>



<a name="201227492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Generating%20code%20for%20Profiles/near/201227492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Generating.20code.20for.20Profiles.html#201227492">(Jun 18 2020 at 04:38)</a>:</h4>
<p>This is more or less what I blogged about (for the dotnet usage in the same way - though we'd use extension methods)<br>
<a href="https://brianpos.com/2018/05/03/code-generation-fhir-custom-resources/">https://brianpos.com/2018/05/03/code-generation-fhir-custom-resources/</a><br>
As for what level to generate, I think that is probably something you'd have in configuration to the generator.<br>
Sometimes you might want to generate the entire package's profiles, other times just the one.<br>
Versioning, hadn't thought about at all - the dotnet libs use the same namespace for all versions, and have a trick to be able to use multiple at the same time.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
