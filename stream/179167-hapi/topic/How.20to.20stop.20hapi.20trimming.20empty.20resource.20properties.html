---
layout: page
title: "FHIR Chat  · How to stop hapi trimming empty resource properties · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html">How to stop hapi trimming empty resource properties</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153920984"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20stop%20hapi%20trimming%20empty%20resource%20properties/near/153920984" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Broadbent <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html#153920984">(Nov 22 2017 at 10:07)</a>:</h4>
<p>Hi all,  </p>
<p>I'm trying to create resources which have missing information, but have codings to represent why data is missing.  E.g. A patients birth weight is missing because they were under or over the scale limit.  <span class="user-mention" data-user-id="191393">@Igor Sirkovich</span> gave me advice in the implementer stream for how I should structure this, and it looks like this:</p>
<p>&lt;Patient xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
    &lt;meta&gt;<br>
       &lt;lastUpdated value="2017-11-21T17:01:46.879+00:00"/&gt;<br>
    &lt;/meta&gt;<br>
    &lt;extension url="<a href="https://purl.org/elab/fhir/network/StructureDefinition/1/BirthWeight" target="_blank" title="https://purl.org/elab/fhir/network/StructureDefinition/1/BirthWeight">https://purl.org/elab/fhir/network/StructureDefinition/1/BirthWeight</a>"&gt;<br>
       &lt;valueDecimal&gt;<br>
          &lt;extension url="<a href="http://www.hl7.org/fhir/extension-data-absent-reason.html" target="_blank" title="http://www.hl7.org/fhir/extension-data-absent-reason.html">http://www.hl7.org/fhir/extension-data-absent-reason.html</a>"&gt;<br>
             &lt;valueCoding&gt;<br>
                &lt;system value="http://hl7.org/fhir/ValueSet/birthweight"/&gt;<br>
                &lt;code value="Underweight"/&gt;<br>
                &lt;userSelected value="false"/&gt;<br>
             &lt;/valueCoding&gt;<br>
          &lt;/extension&gt;<br>
       &lt;/valueDecimal&gt;<br>
    &lt;/extension&gt;<br>
    &lt;extension url="<a href="https://purl.org/elab/fhir/StructureDefinition/1/ResourceGeneratorRef" target="_blank" title="https://purl.org/elab/fhir/StructureDefinition/1/ResourceGeneratorRef">https://purl.org/elab/fhir/StructureDefinition/1/ResourceGeneratorRef</a>"&gt;<br>
       &lt;valueReference&gt;<br>
          &lt;reference value="Basic/198"/&gt;<br>
       &lt;/valueReference&gt;<br>
    &lt;/extension&gt;<br>
    &lt;identifier&gt;<br>
       &lt;system value="https://purl.org/elab/fhir/network/StructureDefinition/1/EuroPrevallStudySubjects"/&gt;<br>
       &lt;value value="1"/&gt;<br>
    &lt;/identifier&gt;<br>
    &lt;gender value="female"/&gt;<br>
 &lt;/Patient&gt;</p>
<p>When I request the patient back from the server however, I get the following back:</p>
<p>&lt;Patient xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
    &lt;meta&gt;<br>
       &lt;lastUpdated value="2017-11-21T17:01:46.879+00:00"/&gt;<br>
    &lt;/meta&gt;<br>
    &lt;extension url="<a href="https://purl.org/elab/fhir/StructureDefinition/1/ResourceGeneratorRef" target="_blank" title="https://purl.org/elab/fhir/StructureDefinition/1/ResourceGeneratorRef">https://purl.org/elab/fhir/StructureDefinition/1/ResourceGeneratorRef</a>"&gt;<br>
       &lt;valueReference&gt;<br>
          &lt;reference value="Basic/198"/&gt;<br>
       &lt;/valueReference&gt;<br>
    &lt;/extension&gt;<br>
    &lt;identifier&gt;<br>
       &lt;system value="https://purl.org/elab/fhir/network/StructureDefinition/1/EuroPrevallStudySubjects"/&gt;<br>
       &lt;value value="1"/&gt;<br>
    &lt;/identifier&gt;<br>
    &lt;gender value="female"/&gt;<br>
 &lt;/Patient&gt;</p>
<p>I assume that hapi is trimming extensions which contain no value, and that the test for no value is 'has valueDecimal'.  Is there a way to fix this issue?  I'm guessing I could put a dummy decimal in place, however this feels like the wrong approach.</p>



<a name="153921119"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20stop%20hapi%20trimming%20empty%20resource%20properties/near/153921119" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html#153921119">(Nov 22 2017 at 21:29)</a>:</h4>
<p>That does look like a bug to me too.</p>



<a name="153921237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20stop%20hapi%20trimming%20empty%20resource%20properties/near/153921237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html#153921237">(Nov 23 2017 at 08:12)</a>:</h4>
<p>I can sort of see why it would be absent, you don't have a value, so why would it have an code. Can you alter the extension so the absent code is at the same level - i.e. not an extension to the valueDecimal?</p>



<a name="153921307"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20stop%20hapi%20trimming%20empty%20resource%20properties/near/153921307" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Broadbent <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html#153921307">(Nov 23 2017 at 15:42)</a>:</h4>
<p><span class="user-mention" data-user-id="194909">@Kevin Mayfield</span>  I can do in the case, but I'm trying to find a generic solution.  So for example if it was the gender that was missing, then the missing code would just appear in place where the value was.</p>



<a name="153921311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20stop%20hapi%20trimming%20empty%20resource%20properties/near/153921311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html#153921311">(Nov 23 2017 at 16:08)</a>:</h4>
<p>But doesn't unknown gender mean something different to not asked - in which case it would be empty?</p>



<a name="153921313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20stop%20hapi%20trimming%20empty%20resource%20properties/near/153921313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Broadbent <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html#153921313">(Nov 23 2017 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="194909">@Kevin Mayfield</span> Yes, sorry I'm struggling for a good example.  I make a tool which reads a csv and a (proprietary) annotation file, it then turns rows of the csv file into fhir resources based on the contents of the annotation file (this is why I need a generic way to do this).  Often in the data I'm seeing, users have coded values like 1 and 2 to represent things like male and female.  They also have codes like 99, 98, 97, which they consider to be exceptions to the normal data.  I'm trying to find a way to capture that exception data, and doing it in the same part of the xml as where the value is stored is computationally better for the tools which have to process the fhir resources further down the line.</p>



<a name="153921330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/How%20to%20stop%20hapi%20trimming%20empty%20resource%20properties/near/153921330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/How.20to.20stop.20hapi.20trimming.20empty.20resource.20properties.html#153921330">(Nov 23 2017 at 20:43)</a>:</h4>
<p>report the issue on the hapi mailing list. It is a bug in HAPI</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
