---
layout: page
title: "FHIR Chat  · Primitive validation with HAPI FHIR 5.X · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Primitive.20validation.20with.20HAPI.20FHIR.205.2EX.html">Primitive validation with HAPI FHIR 5.X</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="193210581"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Primitive%20validation%20with%20HAPI%20FHIR%205.X/near/193210581" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Roman Rodnin <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Primitive.20validation.20with.20HAPI.20FHIR.205.2EX.html#193210581">(Apr 07 2020 at 16:04)</a>:</h4>
<p>Hi,</p>
<p>I am using snapshot version of hapi-fhir library and trying to validate observation with body height profile (<a href="http://hl7.org/fhir/StructureDefinition/bodyheight" title="http://hl7.org/fhir/StructureDefinition/bodyheight">http://hl7.org/fhir/StructureDefinition/bodyheight</a>)<br>
Also i use <a href="https://r4.ontoserver.csiro.au/fhir" title="https://r4.ontoserver.csiro.au/fhir">https://r4.ontoserver.csiro.au/fhir</a> terminology service with RemoteTerminologyServiceValidationSupport<br>
When the library tries to validate valueQuantity of observation, it fails with 400 http status code and message: <em>If the code parameter is provided, the system parameter must also be provided.</em></p>
<p>Could you please check this issue, thx</p>



<a name="193255821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Primitive%20validation%20with%20HAPI%20FHIR%205.X/near/193255821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dion McMurtrie <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Primitive.20validation.20with.20HAPI.20FHIR.205.2EX.html#193255821">(Apr 07 2020 at 22:25)</a>:</h4>
<p><span class="user-mention" data-user-id="253983">@Roman Rodnin</span> can you post an example resource you're trying to validate?</p>



<a name="193264181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Primitive%20validation%20with%20HAPI%20FHIR%205.X/near/193264181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Primitive.20validation.20with.20HAPI.20FHIR.205.2EX.html#193264181">(Apr 08 2020 at 00:18)</a>:</h4>
<p>Note, the error mentioned means <code>$validate-code</code> is being called with a <code>code</code> parameter but no <code>system</code> parameter.<br>
This is kinda strange given that the bodyheight profile has a mandatory fixed value for <code>system</code></p>



<a name="193323466"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Primitive%20validation%20with%20HAPI%20FHIR%205.X/near/193323466" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Primitive.20validation.20with.20HAPI.20FHIR.205.2EX.html#193323466">(Apr 08 2020 at 13:58)</a>:</h4>
<p>I'm going to assume <span class="user-mention" data-user-id="253983">@Roman Rodnin</span> that you're using the new RemoteTerminologyServiceValidationSupport in 5.0.0-SNAPSHOT?</p>
<p>I have the same questions as the others, but I'm also just intertested to see this used in the wild already. :)</p>



<a name="193345951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Primitive%20validation%20with%20HAPI%20FHIR%205.X/near/193345951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Roman Rodnin <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Primitive.20validation.20with.20HAPI.20FHIR.205.2EX.html#193345951">(Apr 08 2020 at 16:37)</a>:</h4>
<p>yes, you are right.<br>
resource that i am trying to validate:</p>
<div class="codehilite"><pre><span></span>{
  &quot;resourceType&quot;: &quot;Observation&quot;,
  &quot;id&quot;: &quot;body-height&quot;,
  &quot;meta&quot;: {
    &quot;profile&quot;: [
      &quot;http://hl7.org/fhir/StructureDefinition/vitalsigns&quot;
    ]
  },
  &quot;text&quot;: {
    &quot;status&quot;: &quot;generated&quot;,
    &quot;div&quot;: &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&lt;p&gt;&lt;b&gt;Generated Narrative with Details&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;id&lt;/b&gt;: body-height&lt;/p&gt;&lt;p&gt;&lt;b&gt;meta&lt;/b&gt;: &lt;/p&gt;&lt;p&gt;&lt;b&gt;status&lt;/b&gt;: final&lt;/p&gt;&lt;p&gt;&lt;b&gt;category&lt;/b&gt;: Vital Signs &lt;span&gt;(Details : {http://terminology.hl7.org/CodeSystem/observation-category code &#39;vital-signs&#39; = &#39;Vital Signs&#39;, given as &#39;Vital Signs&#39;})&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;code&lt;/b&gt;: Body height &lt;span&gt;(Details : {LOINC code &#39;8302-2&#39; = &#39;Body height&#39;, given as &#39;Body height&#39;})&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;subject&lt;/b&gt;: &lt;a&gt;Patient/example&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;effective&lt;/b&gt;: 02/07/1999&lt;/p&gt;&lt;p&gt;&lt;b&gt;value&lt;/b&gt;: 66.899999999999991 in&lt;span&gt; (Details: UCUM code [in_i] = &#39;in_i&#39;)&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&quot;
  },
  &quot;status&quot;: &quot;final&quot;,
  &quot;category&quot;: [
    {
      &quot;coding&quot;: [
        {
          &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/observation-category&quot;,
          &quot;code&quot;: &quot;vital-signs&quot;,
          &quot;display&quot;: &quot;Vital Signs&quot;
        }
      ],
      &quot;text&quot;: &quot;Vital Signs&quot;
    }
  ],
  &quot;code&quot;: {
    &quot;coding&quot;: [
      {
        &quot;system&quot;: &quot;http://loinc.org&quot;,
        &quot;code&quot;: &quot;8302-2&quot;,
        &quot;display&quot;: &quot;Body height&quot;
      }
    ],
    &quot;text&quot;: &quot;Body height&quot;
  },
  &quot;subject&quot;: {
    &quot;reference&quot;: &quot;Patient/example&quot;
  },
  &quot;effectiveDateTime&quot;: &quot;1999-07-02&quot;,
  &quot;valueQuantity&quot;: {
    &quot;value&quot;: 66.899999999999991,
    &quot;unit&quot;: &quot;in&quot;,
    &quot;system&quot;: &quot;http://unitsofmeasure.org&quot;,
    &quot;code&quot;: &quot;[in_i]&quot;
  }
}
</pre></div>


<p>I spent some time debugging this problem, but it's really hard to understand what's going on in InstanceValidator<br>
I just found that in VersionSpecificWorkerContextWrapper line 450 there's codeSystem parameter is set to null</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
