---
layout: page
title: "FHIR Chat  · Validation error with R4 5.5.7 · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html">Validation error with R4 5.5.7</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="258013736"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/258013736" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marvin Kampf <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#258013736">(Oct 18 2021 at 11:30)</a>:</h4>
<p>Hey guys,<br>
I got the following error executing a unit test that uses hapi library for validation. With version 5.5.3 of R4 lib everything worked fine but now with the patch to 5.5.7, the following exception occurs:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="m">13</span> <span class="m">106</span>.5 ValidationTests &gt; mapProzedur<span class="o">()</span> FAILED
<span class="m">619</span><span class="c1">#13 106.5     java.lang.NoSuchMethodError: 'void org.hl7.fhir.utilities.validation.ValidationMessage.setSliceHtml(java.lang.String, java.lang.String[])'</span>
<span class="m">620</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.BaseValidator.slicingHint(BaseValidator.java:267)</span>
<span class="m">621</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.sliceMatches(InstanceValidator.java:3645)</span>
<span class="m">622</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.matchSlice(InstanceValidator.java:4933)</span>
<span class="m">623</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.assignChildren(InstanceValidator.java:4852)</span>
<span class="m">624</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validateElement(InstanceValidator.java:4377)</span>
<span class="m">625</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.checkChildByDefinition(InstanceValidator.java:4686)</span>
<span class="m">626</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.checkChild(InstanceValidator.java:4432)</span>
<span class="m">627</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validateElement(InstanceValidator.java:4384)</span>
<span class="m">628</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.startInner(InstanceValidator.java:4100)</span>
<span class="m">629</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.start(InstanceValidator.java:4008)</span>
<span class="m">630</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validateResource(InstanceValidator.java:5172)</span>
<span class="m">631</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validateContains(InstanceValidator.java:4277)</span>
<span class="m">632</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.checkChildByDefinition(InstanceValidator.java:4588)</span>
<span class="m">633</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.checkChild(InstanceValidator.java:4432)</span>
<span class="m">634</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validateElement(InstanceValidator.java:4384)</span>
<span class="m">635</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.checkChildByDefinition(InstanceValidator.java:4605)</span>
<span class="m">636</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.checkChild(InstanceValidator.java:4432)</span>
<span class="m">637</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validateElement(InstanceValidator.java:4384)</span>
<span class="m">638</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.startInner(InstanceValidator.java:4100)</span>
<span class="m">639</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.start(InstanceValidator.java:3964)</span>
<span class="m">640</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validateResource(InstanceValidator.java:5172)</span>
<span class="m">641</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:721)</span>
<span class="m">642</span><span class="c1">#13 106.5         at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:571)</span>
<span class="m">643</span><span class="c1">#13 106.5         at org.hl7.fhir.common.hapi.validation.validator.ValidatorWrapper.validate(ValidatorWrapper.java:158)</span>
<span class="m">644</span><span class="c1">#13 106.5         at org.hl7.fhir.common.hapi.validation.validator.FhirInstanceValidator.validate(FhirInstanceValidator.java:235)</span>
<span class="m">645</span><span class="c1">#13 106.5         at org.hl7.fhir.common.hapi.validation.validator.BaseValidatorBridge.doValidate(BaseValidatorBridge.java:22)</span>
<span class="m">646</span><span class="c1">#13 106.5         at org.hl7.fhir.common.hapi.validation.validator.BaseValidatorBridge.validateResource(BaseValidatorBridge.java:45)</span>
<span class="m">647</span><span class="c1">#13 106.5         at org.hl7.fhir.common.hapi.validation.validator.FhirInstanceValidator.validateResource(FhirInstanceValidator.java:25)</span>
<span class="m">648</span><span class="c1">#13 106.5         at ca.uhn.fhir.validation.FhirValidator.validateWithResult(FhirValidator.java:221)</span>
<span class="m">649</span><span class="c1">#13 106.5         at ca.uhn.fhir.validation.FhirValidator.validateWithResult(FhirValidator.java:191)</span>
<span class="m">650</span><span class="c1">#13 106.5         at org.miracum.streams.ume.kdbptofhir.ValidationTests.isValid(ValidationTests.java:97)</span>
<span class="m">651</span><span class="c1">#13 106.5         at org.miracum.streams.ume.kdbptofhir.ValidationTests.mapProzedur(ValidationTests.java:243)</span>
</code></pre></div>
<p>The code that triggers the exception is the following simple line:</p>
<div class="codehilite" data-code-language="Java"><pre><span></span><code><span class="kd">var</span> <span class="n">result</span> <span class="o">=</span> <span class="n">validator</span><span class="p">.</span><span class="na">validateWithResult</span><span class="p">(</span><span class="n">fhirBundle</span><span class="p">);</span>
</code></pre></div>
<p>with <code>validator</code> being initialized like:</p>
<div class="codehilite" data-code-language="Java"><pre><span></span><code><span class="kd">var</span> <span class="n">ctx</span> <span class="o">=</span> <span class="n">FhirContext</span><span class="p">.</span><span class="na">forR4</span><span class="p">();</span>
<span class="n">validator</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">.</span><span class="na">newValidator</span><span class="p">();</span>

<span class="kd">var</span> <span class="n">validationSupportChain</span> <span class="o">=</span>
        <span class="k">new</span> <span class="n">ValidationSupportChain</span><span class="p">(</span>
            <span class="k">new</span> <span class="n">DefaultProfileValidationSupport</span><span class="p">(</span><span class="n">ctx</span><span class="p">),</span>
            <span class="n">getProfiles</span><span class="p">(</span><span class="n">ctx</span><span class="p">),</span>
            <span class="k">new</span> <span class="n">SnapshotGeneratingValidationSupport</span><span class="p">(</span><span class="n">ctx</span><span class="p">),</span>
            <span class="k">new</span> <span class="n">InMemoryTerminologyServerValidationSupport</span><span class="p">(</span><span class="n">ctx</span><span class="p">),</span>
            <span class="k">new</span> <span class="n">CommonCodeSystemsTerminologyService</span><span class="p">(</span><span class="n">ctx</span><span class="p">));</span>

<span class="kd">var</span> <span class="n">instanceValidator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FhirInstanceValidator</span><span class="p">(</span><span class="n">validationSupportChain</span><span class="p">);</span>
<span class="n">validator</span><span class="p">.</span><span class="na">registerValidatorModule</span><span class="p">(</span><span class="n">instanceValidator</span><span class="p">);</span>
</code></pre></div>
<p>Thanks in advance for any help</p>



<a name="258013986"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/258013986" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marvin Kampf <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#258013986">(Oct 18 2021 at 11:32)</a>:</h4>
<p>I just realised, that I already had the same problem with a different version once: <a href="#narrow/stream/179167-hapi/topic/NoSuchMethodError.20setSliceHtml/near/245185167">https://chat.fhir.org/#narrow/stream/179167-hapi/topic/NoSuchMethodError.20setSliceHtml/near/245185167</a></p>



<a name="258187437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/258187437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marvin Kampf <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#258187437">(Oct 19 2021 at 12:43)</a>:</h4>
<p>Is this a bug? Should I raise an issue for hapi?</p>



<a name="258188563"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/258188563" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#258188563">(Oct 19 2021 at 12:52)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="258188608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/258188608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#258188608">(Oct 19 2021 at 12:52)</a>:</h4>
<p>Its likely not a bug in HAPI</p>



<a name="258347036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/258347036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#258347036">(Oct 20 2021 at 10:50)</a>:</h4>
<p>don't look at me. setSliceHtml is a very old method. But whatever issue it is, the problem is somewhere in the package dependencies</p>



<a name="258957372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/258957372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marvin Kampf <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#258957372">(Oct 25 2021 at 13:18)</a>:</h4>
<p>Same issue with 5.5.8...</p>



<a name="259001710"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/259001710" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#259001710">(Oct 25 2021 at 18:36)</a>:</h4>
<p><span class="user-mention" data-user-id="248736">@Mark Iantorno</span> ?</p>



<a name="259017064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/259017064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#259017064">(Oct 25 2021 at 20:36)</a>:</h4>
<p>Please tag me and send me the exact steps to reproduce this.</p>



<a name="259017072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/259017072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#259017072">(Oct 25 2021 at 20:36)</a>:</h4>
<p><span class="user-mention" data-user-id="196715">@Marvin Kampf</span></p>



<a name="259017097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Validation%20error%20with%20R4%205.5.7/near/259017097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Validation.20error.20with.20R4.205.2E5.2E7.html#259017097">(Oct 25 2021 at 20:36)</a>:</h4>
<p>What are you validating?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
