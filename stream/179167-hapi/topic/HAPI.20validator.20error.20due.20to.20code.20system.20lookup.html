---
layout: page
title: "FHIR Chat  · HAPI validator error due to code system lookup · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20validator.20error.20due.20to.20code.20system.20lookup.html">HAPI validator error due to code system lookup</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="158963023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20validator%20error%20due%20to%20code%20system%20lookup/near/158963023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20validator.20error.20due.20to.20code.20system.20lookup.html#158963023">(Feb 20 2019 at 10:10)</a>:</h4>
<p>I am seeing an error in HAPI 3.6 (and 3.7) related to a code-system lookup. Specifically, the server gives a 500 response and at the bottom of the  stack trace it says (the full error stack trace: <a href="/user_uploads/10155/54rm4s6qpvWx8MNJ0sa_GAHD/stacktrace.txt" target="_blank" title="stacktrace.txt">stacktrace.txt</a> ):</p>
<div class="codehilite"><pre><span></span>org.hl7.fhir.exceptions.TerminologyServiceException: unable to find code system urn:iso:std:iso:3166
</pre></div>


<p>I see this when validating against the <a href="https://simplifier.net/BasisprofilDE/patient-de-basis-0.2/" target="_blank" title="https://simplifier.net/BasisprofilDE/patient-de-basis-0.2/">German base Patient profile</a> with a minimal example like the one given at the bottom e.g. through the <code>$validate</code>operation. We're using a simple custom validation support along the lines of what the HAPI documentation describes (only loading the profiles, no custom handling of value sets or code systems). The error is provoked by the address field which must conform to the <a href="https://simplifier.net/BasisprofilDE/address-de-basis-0.2" target="_blank" title="https://simplifier.net/BasisprofilDE/address-de-basis-0.2">German Base address profile</a>  (also present on the server). The address profile, in turn, defines a preferred binding for the country field to the ValueSet<code>http://hl7.org/fhir/ValueSet/jurisdiction</code> (which includes all codes from <code>urn:iso:std:iso:3166</code>, as well as others).</p>
<p>I do not see this error when using the standalone JAR validator.Is there a known issue here - or maybe rather an issue with our validation support implementation?  (If more helpful, I 'd be happy to open a GForge/GitHub ticket).</p>
<p>Resource example: provoking error:</p>
<div class="codehilite"><pre><span></span>{
    &quot;resourceType&quot;: &quot;Patient&quot;,
    &quot;meta&quot;: {
        &quot;profile&quot;: [
            &quot;http://fhir.de/StructureDefinition/patient-de-basis/0.2&quot;
        ]
    },
    &quot;address&quot;: [
            &quot;country&quot;: &quot;DE&quot;
        }
    ]}
</pre></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
