---
layout: page
title: "FHIR Chat  · GraphQL support in HAPI 4.0.0 · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html">GraphQL support in HAPI 4.0.0</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="173407776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173407776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xiaocheng Luan <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173407776">(Aug 16 2019 at 21:09)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> It's exciting that HAPI 4.0 comes with so many new features. We briefly checked on the GraphQL feature but wasn't able to find much HAPI-specific documentation on that. It would help if you could help clarify a few things:<br>
(1) First of all, how would you characterize the maturity of HAPI's GraphQL support - I understand this is the first full roll out.<br>
(2) Overall, would any of the operations be faster with GraphQL than with the standard search API, I would think not but would like to hear your view.<br>
(3) HAPI's response to graphql does not seem to have the "wrapper" with a "data" element, is it intentional?<br>
A couple of minor/detailed issues we noticed:<br>
HAPI does not appear to support GET with graphql, is that the case (which isn't necessarily an issue)?<br>
With a query like "{Patient(id:xx-123){id,name{given,family}}}", HAPI does not seem to like the dash in the id, which is a valid id character?<br>
Thanks!<br>
<span class="user-mention" data-user-id="193152">@Ye Wang</span> <span class="user-mention" data-user-id="195344">@Paul Lynch</span></p>



<a name="173407922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173407922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173407922">(Aug 16 2019 at 21:11)</a>:</h4>
<p>(1) and (3) are for me, and on my list. I'll leave it to James to comment on (2)</p>



<a name="173408525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173408525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173408525">(Aug 16 2019 at 21:21)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="195343">@Xiaocheng Luan</span> </p>
<blockquote>
<p>(1) First of all, how would you characterize the maturity of HAPI's GraphQL support</p>
</blockquote>
<p>Definitely immature at this time. I very much doubt this feature has been heavily tested or brought into production by anyone yet. I am confident in the quality of the code and I certainly wouldn't call it a prototype or anything like that, but I'm also sure we'll find a few issues in the next little while as people start to use it.</p>
<blockquote>
<p>(2) Overall, would any of the operations be faster with GraphQL than with the standard search API, I would think not but would like to hear your view.</p>
</blockquote>
<p>The only difference I would expect is a savings due to the number of bytes going over the wire (which can be a significant savings in many cases). There are no specific database optimizations (yet) but there aren't any thing that would be slower there either.</p>
<blockquote>
<p>(3) HAPI's response to graphql does not seem to have the "wrapper" with a "data" element, is it intentional?</p>
</blockquote>
<p>Wow, well there's our first bug report. :) You are correct, we are missing that and it's not intentional. Will fix this.</p>
<blockquote>
<p>HAPI does not appear to support GET with graphql, is that the case (which isn't necessarily an issue)?</p>
</blockquote>
<p>I'm guessing you mean support for searching? That's coming very soon.</p>



<a name="173408544"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173408544" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173408544">(Aug 16 2019 at 21:22)</a>:</h4>
<p>(oops, didn't see Grahame's reply when I wrote mine)</p>



<a name="173408620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173408620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173408620">(Aug 16 2019 at 21:23)</a>:</h4>
<p>on (2)... you can make a massive request with graphQL - potentially covering 1000s of resources. The request could take a long time to process - but it's still faster than making the requests individually, and including the latency as well</p>



<a name="173408633"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173408633" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173408633">(Aug 16 2019 at 21:23)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> - on 3 - I didn't update the java implementation for the tests - see</p>



<a name="173408712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173408712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173408712">(Aug 16 2019 at 21:25)</a>:</h4>
<p>[hapi-core]\org.hl7.fhir.r5\src\test\resources\graphql\server-tests.json</p>



<a name="173409653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173409653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xiaocheng Luan <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173409653">(Aug 16 2019 at 21:38)</a>:</h4>
<p>Thanks for the quick and detailed response, <span class="user-mention" data-user-id="191319">@James Agnew</span> </p>
<div class="codehilite"><pre><span></span>&gt; HAPI does not appear to support GET with graphql, is that the case (which isn&#39;t necessarily an issue)?
I&#39;m guessing you mean support for searching? That&#39;s coming very soon.
</pre></div>


<p>I meant for a simple query like {name{family}}, POST works, but "graphql?query={name{family}}" does not :). Given the format of GraphQL I would think real code should use POST but GET may be handy for testing/examples.</p>



<a name="173409704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173409704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xiaocheng Luan <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173409704">(Aug 16 2019 at 21:39)</a>:</h4>
<blockquote>
<p>on (2)... you can make a massive request with graphQL - potentially covering 1000s of resources. The request could take a long time to process - but it's still faster than making the requests individually, and including the latency as well</p>
</blockquote>
<p>Thanks for the insight <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="173490611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173490611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173490611">(Aug 18 2019 at 15:13)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="195343">@Xiaocheng Luan</span> - What do you mean by POST working but not GET? As far as I can see doing a get works fine.. e.g. <a href="http://hapi.fhir.org/baseR4/Patient/cf-1558990251926/$graphql?query={name{text,given,family}}" target="_blank" title="http://hapi.fhir.org/baseR4/Patient/cf-1558990251926/$graphql?query={name{text,given,family}}">http://hapi.fhir.org/baseR4/Patient/cf-1558990251926/$graphql?query={name{text,given,family}}</a></p>



<a name="173490659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173490659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173490659">(Aug 18 2019 at 15:14)</a>:</h4>
<p>I do notice that we seem to be showing the wrong content type on that specific response.. but i think that's just the syntax highlighter getting it wrong.</p>



<a name="173567242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173567242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173567242">(Aug 19 2019 at 18:31)</a>:</h4>
<p>Interestingly, the link above works fine when I type it in a browser (or just click on the link) but get a status 500 with an empty OO when using PostMan...</p>



<a name="173568664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173568664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173568664">(Aug 19 2019 at 18:50)</a>:</h4>
<p>Might help to trace... in PostMan it works if you set the Accept header to text/html.  Fails with everything else.</p>



<a name="173582967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/173582967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#173582967">(Aug 19 2019 at 21:55)</a>:</h4>
<p>Ah, just replicated this. I'll push up a fix in the next day or so. Thanks for the heads up!</p>



<a name="177155068"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/177155068" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Toni Vaa <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#177155068">(Oct 02 2019 at 14:29)</a>:</h4>
<p>So should HAPI GraphQL work with POST? Everything I try seems to result in:<br>
{<br>
  "resourceType": "OperationOutcome",<br>
  "text": {<br>
    "status": "generated",<br>
    "div": "&lt;div xmlns=\"http://www.w3.org/1999/xhtml\"&gt;&lt;h1&gt;Operation Outcome&lt;/h1&gt;&lt;table border=\"0\"&gt;&lt;tr&gt;&lt;td style=\"font-weight: bold;\"&gt;ERROR&lt;/td&gt;&lt;td&gt;[]&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Unable to parse GraphQL Expression: java.lang.NullPointerException&lt;/pre&gt;&lt;/td&gt;\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t&lt;/tr&gt;\n\t\t&lt;/table&gt;\n\t&lt;/div&gt;"<br>
  },<br>
  "issue": [<br>
    {<br>
      "severity": "error",<br>
      "code": "processing",<br>
      "diagnostics": "Unable to parse GraphQL Expression: java.lang.NullPointerException"<br>
    }<br>
  ]<br>
}</p>
<p>... However GET seems to be working...</p>



<a name="177155616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/177155616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#177155616">(Oct 02 2019 at 14:35)</a>:</h4>
<p>Hmm... Yeah, that's almost certainly a HAPI bug. Can you file a ticket?</p>



<a name="177223178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/177223178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Toni Vaa <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#177223178">(Oct 03 2019 at 08:11)</a>:</h4>
<p>I created this to GitHub: <a href="https://github.com/jamesagnew/hapi-fhir/issues/1523" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/issues/1523">https://github.com/jamesagnew/hapi-fhir/issues/1523</a>. Will it suffice?</p>



<a name="178469822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/178469822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannes Ulrich <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#178469822">(Oct 18 2019 at 12:47)</a>:</h4>
<p>Does the new HAPI support GraphQL queries on system level without an ID? I would like to use GraphQL for quering all observations from a specific patient, e.g. query={Observation{id,subject{reference,resource(type:Patient(id:1))}}} ?</p>



<a name="186153621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/186153621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> dsh <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#186153621">(Jan 21 2020 at 05:01)</a>:</h4>
<p>Is there any documentation on GraphQL to see how HAPI 4.0 supports it ?</p>



<a name="186533593"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/186533593" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#186533593">(Jan 24 2020 at 21:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191783">@Daya Sharma</span> unfortunately not much.. This is where you enable it though: <a href="https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/hapi.properties#L58" target="_blank" title="https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/hapi.properties#L58">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/hapi.properties#L58</a></p>
<p>Highly recommended to use 4.1.0 if you're using GraphQL, lots of fixes happened btween the 4.0.0 and 4.1.0 releases.</p>



<a name="186539577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/186539577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> dsh <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#186539577">(Jan 24 2020 at 22:14)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="190934331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/190934331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#190934331">(Mar 18 2020 at 02:40)</a>:</h4>
<p>Tried to run a graphQL query on the hapi r4 server (R4 Endpoint: <a href="http://hapi.fhir.org/baseR4" target="_blank" title="http://hapi.fhir.org/baseR4">http://hapi.fhir.org/baseR4</a>) with the following query parameter </p>
<div class="codehilite"><pre><span></span>{&#39;query&#39;: &#39;{ObservationList(subject:example){id,valueQuantity{value,unit},effectivePeriod{start}}}&#39;}
</pre></div>


<p>and got the following error:</p>
<div class="codehilite"><pre><span></span>Response
Status Code = 500
{&#39;resourceType&#39;: &#39;OperationOutcome&#39;, &#39;text&#39;: {&#39;status&#39;: &#39;generated&#39;, &#39;div&#39;: &#39;
Operation Outcome

ERROR   []
Unable to execute GraphQL Expression: Encountered a selection set on a scalar field type
</pre></div>


<p>note that that this query parameter:</p>
<div class="codehilite"><pre><span></span>{&#39;query&#39;: &#39;{ObservationList(subject:example){id,valueQuantity{value,unit},effectivePeriod}}&#39;}
</pre></div>


<p>is successful despite the fact that the effectivePeriod is a complex element.</p>



<a name="190934580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/GraphQL%20support%20in%20HAPI%204.0.0/near/190934580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/GraphQL.20support.20in.20HAPI.204.2E0.2E0.html#190934580">(Mar 18 2020 at 02:47)</a>:</h4>
<p>(deleted)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
