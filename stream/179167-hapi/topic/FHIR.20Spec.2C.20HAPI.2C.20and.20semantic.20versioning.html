---
layout: page
title: "FHIR Chat  · FHIR Spec, HAPI, and semantic versioning · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html">FHIR Spec, HAPI, and semantic versioning</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="180388686"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180388686" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180388686">(Nov 11 2019 at 00:50)</a>:</h4>
<p>We have StructuredDefinitions from the IG Publisher that are stamped as FHIR 4.0.1, but are being rejected by HAPI (4.0.3) as "Unknown FHIRVersion code '4.0.1'"<br>
Is it unreasonable to expect (at least) patch versions to be forward compatible?</p>



<a name="180388902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180388902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180388902">(Nov 11 2019 at 00:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> this is about to an acute pressure point on HAPI. I hope that your imminent release supports 4.0.1. I think I've found and fixed all the points where my code needs to.</p>



<a name="180388948"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180388948" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180388948">(Nov 11 2019 at 00:58)</a>:</h4>
<p>but Michael has a deeper point in mind that I don't know how to solve around the FHIRVersion enumeration</p>



<a name="180390191"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180390191" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180390191">(Nov 11 2019 at 01:37)</a>:</h4>
<p>At the moment, 4.1.0-SNAPSHOT (from maven) is rejecting 4.0.1</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;OperationOutcome&quot;</span><span class="p">,</span>
    <span class="nt">&quot;issue&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;processing&quot;</span><span class="p">,</span>
            <span class="nt">&quot;diagnostics&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed to parse request body as JSON resource. Error was: Invalid attribute value \&quot;4.0.1\&quot;: Unknown FHIRVersion code &#39;4.0.1&#39;&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>



<a name="180394968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180394968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180394968">(Nov 11 2019 at 03:50)</a>:</h4>
<p>I note that the current (master) dependency from HAPI is <code>&lt;fhir_core_version&gt;4.0.26-SNAPSHOT&lt;/fhir_core_version&gt;</code> and not the latest: <code>&lt;fhir_core_version&gt;4.0.33-SNAPSHOT&lt;/fhir_core_version&gt;</code></p>



<a name="180395485"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180395485" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180395485">(Nov 11 2019 at 04:05)</a>:</h4>
<p>Updating to 4.0.33-SNAPSHOT and I now get:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;OperationOutcome&quot;</span><span class="p">,</span>
    <span class="nt">&quot;issue&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;processing&quot;</span><span class="p">,</span>
            <span class="nt">&quot;diagnostics&quot;</span><span class="p">:</span> <span class="s2">&quot;cvc-enumeration-valid: Value &#39;4.0.1&#39; is not facet-valid with respect to enumeration &#39;[0.01, 0.05, 0.06, 0.11, 0.0.80, 0.0.81, 0.0.82, 0.4.0, 0.5.0, 1.0.0, 1.0.1, 1.0.2, 1.1.0, 1.4.0, 1.6.0, 1.8.0, 3.0.0, 3.0.1, 3.3.0, 3.5.0, 4.0.0]&#39;. It must be a value from the enumeration.&quot;</span><span class="p">,</span>
            <span class="nt">&quot;location&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Line[1] Col[26685]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Line 1, Col 26685&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;processing&quot;</span><span class="p">,</span>
            <span class="nt">&quot;diagnostics&quot;</span><span class="p">:</span> <span class="s2">&quot;cvc-attribute.3: The value &#39;4.0.1&#39; of attribute &#39;value&#39; on element &#39;fhirVersion&#39; is not valid with respect to its type, &#39;FHIRVersion-list&#39;.&quot;</span><span class="p">,</span>
            <span class="nt">&quot;location&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Line[1] Col[26685]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Line 1, Col 26685&quot;</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>



<a name="180396290"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180396290" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180396290">(Nov 11 2019 at 04:21)</a>:</h4>
<p>this is a schema error</p>



<a name="180463808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180463808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180463808">(Nov 11 2019 at 21:59)</a>:</h4>
<p>updating <code>hapi-fhir-validation-resources-r4/src/main/resources/org/hl7/fhir/r4/model/schema/fhir-single.xsd</code> in co junction with changing <code>fhir_core_version</code> seems to fix this ; not sure if it creates other problems though</p>



<a name="180470671"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180470671" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180470671">(Nov 12 2019 at 00:06)</a>:</h4>
<p>The HAPI 4.1.0 release does support FHIR 4.0.1, confirmed this afternoon- The branch that updates to the latest core structures isn't merged yet, it's  likely the last merge before release.</p>
<p>this is a good point about the XSDs though, I did not update them and I should do that.</p>



<a name="180470691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180470691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180470691">(Nov 12 2019 at 00:07)</a>:</h4>
<p>And <span class="user-mention" data-user-id="191343">@Michael Lawley</span> no, that shouldn't cause any other issues.</p>



<a name="180470757"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180470757" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180470757">(Nov 12 2019 at 00:08)</a>:</h4>
<p>Is there also a change to be made to ensure that any subsequent change to 4.0.2 wouldn't break things?</p>



<a name="180470791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180470791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180470791">(Nov 12 2019 at 00:09)</a>:</h4>
<p>It's arguable that we shouldn't throw an exception when putting an invalid string into an Enumeration since that's a validation error. Currently though, 4.0.2 would be rejected.</p>



<a name="180470802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180470802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180470802">(Nov 12 2019 at 00:09)</a>:</h4>
<p>Yeah, that doesn't seem like very semantic versioning</p>



<a name="180470852"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180470852" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180470852">(Nov 12 2019 at 00:10)</a>:</h4>
<p>(if one could be said to be 'very' or 'somewhat' semantic!)</p>



<a name="180470945"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180470945" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180470945">(Nov 12 2019 at 00:12)</a>:</h4>
<p>I imagine this might be too late for 4.1.0, should I make a github issue for a later release?</p>



<a name="180472443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180472443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180472443">(Nov 12 2019 at 00:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span>  Thanks - running the tests throws up a bunch of errors relating to hard-coded expectations of 4.0.0 but also 3.0.1 vs 3.0.2 and the dstu3 XSD</p>



<a name="180475487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180475487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180475487">(Nov 12 2019 at 02:04)</a>:</h4>
<p>hmm. I think that there's a wider question than for HAPI about accepting these. it's FHIR that says these are not valid, not HAPI</p>



<a name="180478143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/FHIR%20Spec%2C%20HAPI%2C%20and%20semantic%20versioning/near/180478143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/FHIR.20Spec.2C.20HAPI.2C.20and.20semantic.20versioning.html#180478143">(Nov 12 2019 at 03:19)</a>:</h4>
<p>Ah, OK</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
