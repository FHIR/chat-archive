---
layout: page
title: "FHIR Chat  · Custom Profile Validation R4 is not working correctly · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20Profile.20Validation.20R4.20is.20not.20working.20correctly.html">Custom Profile Validation R4 is not working correctly</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="190375204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Custom%20Profile%20Validation%20R4%20is%20not%20working%20correctly/near/190375204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mukesh Sharma <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Custom.20Profile.20Validation.20R4.20is.20not.20working.20correctly.html#190375204">(Mar 12 2020 at 10:36)</a>:</h4>
<p>Hi,</p>
<p>I am using PrePopulatedValidationSupport to validate a resource against a custom profile(USCore_PatientProfile).<br>
Following is the code that I'm using to validate the input resource.</p>
<p>*FhirContext ctx = FhirContext.forR4();<br>
FhirValidator validator = ctx.newValidator(); <br>
org.hl7.fhir.r4.hapi.validation.PrePopulatedValidationSupport prePopulatedSupport = new org.hl7.fhir.r4.hapi.validation.PrePopulatedValidationSupport(myStructureDefinitionsR4,myValueSetsR4,myCodeSystemsR4);<br>
org.hl7.fhir.r4.hapi.ctx.DefaultProfileValidationSupport defaultSupport = new org.hl7.fhir.r4.hapi.ctx.DefaultProfileValidationSupport();<br>
org.hl7.fhir.r4.hapi.validation.ValidationSupportChain validationSupportChain = new org.hl7.fhir.r4.hapi.validation.ValidationSupportChain(prePopulatedSupport,defaultSupport);<br>
org.hl7.fhir.r4.hapi.validation.FhirInstanceValidator instanceValidator = new org.hl7.fhir.r4.hapi.validation.FhirInstanceValidator();<br>
instanceValidator.setValidationSupport(validationSupportChain);<br>
validator.registerValidatorModule(instanceValidator);<br>
ValidationResult result = validator.validateWithResult((String) resource);*</p>
<p>I have populated  myStructureDefinitionsR4 by parsing the structure definition from USCore_PatientProfile_STU3_V310_ballot. <a href="/user_uploads/10155/QG-LEdRUWM1zqWcBRMerd3Ap/USCore_PatientProfile_STU3_V310_ballot.xml" target="_blank" title="USCore_PatientProfile_STU3_V310_ballot.xml">USCore_PatientProfile_STU3_V310_ballot.xml</a><br>
The valuesets and codesystems are populated with FHIR valuesets and codesystems from org.hl7.fhir.r4.model.valueset in hapi-fhir-validation-resources-r4-4.1.0.jar.</p>
<p>Input provided to validate resource is from <a href="https://hl7.org/fhir/R4/patient-example.xml.html" target="_blank" title="https://hl7.org/fhir/R4/patient-example.xml.html">https://hl7.org/fhir/R4/patient-example.xml.html</a><br>
Output received is attached :<br>
<a href="/user_uploads/10155/eqVfZrf7erXQR_pTEijUp2G-/Patient_CustomProfile_Validation_OO.xml" target="_blank" title="Patient_CustomProfile_Validation_OO.xml">Patient_CustomProfile_Validation_OO.xml</a> </p>
<p>Please let me know where I'm going wrong. The Official FHIRValidator returns 'No issues found' but using the HAPI library classes I'm getting 19 issues. Please help.</p>
<p>Regards,<br>
Mukesh</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
