---
layout: page
title: "FHIR Chat  · HAPI FHIR Error 500 on questionnaire/-response · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response.html">HAPI FHIR Error 500 on questionnaire/-response</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="256204327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20FHIR%20Error%20500%20on%20questionnaire/-response/near/256204327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> peter stroessler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response.html#256204327">(Oct 05 2021 at 09:37)</a>:</h4>
<p>Hi all! On <a href="http://hapi.fhir.org/baseR4/QuestionnaireResponse?questionnaire=2535024&amp;_pretty=true">http://hapi.fhir.org/baseR4/QuestionnaireResponse?questionnaire=2535024&amp;_pretty=true</a>, I always get an error 500. What could be the reason? Such requests on public hapifhir worked already but not anymore. thank you for any help to solve this.</p>



<a name="256213524"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20FHIR%20Error%20500%20on%20questionnaire/-response/near/256213524" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response.html#256213524">(Oct 05 2021 at 10:48)</a>:</h4>
<p>I suppose it's because QuestionnaireResponse.questionnaire is of type canonical. It references Questionnaire.url instead of <a href="http://Questionnaire.id">Questionnaire.id</a>.</p>



<a name="256245283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20FHIR%20Error%20500%20on%20questionnaire/-response/near/256245283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> peter stroessler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response.html#256245283">(Oct 05 2021 at 13:30)</a>:</h4>
<p>2569991 is a vaid qestionnaire id for example. In the questoinnaire resource I can read for id on hapi fhir and get a 200 ok response...well the url is not updated to the actual website and points to an old url but this worked before without change. <a href="https://hapi.fhir.org/baseR4/QuestionnaireResponse?questionnaire=2569991&amp;_pretty=true&amp;_count=250">https://hapi.fhir.org/baseR4/QuestionnaireResponse?questionnaire=2569991&amp;_pretty=true&amp;_count=250</a> 500 (Server Error)</p>



<a name="256265165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20FHIR%20Error%20500%20on%20questionnaire/-response/near/256265165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response.html#256265165">(Oct 05 2021 at 15:21)</a>:</h4>
<p>Is it possible that "this worked before" refers to STU3? Because the type of QuestionnaireResponse.questionnaire has been changed from Reference to canonical between STU3 and R4.<br>
However I am not 100% certain how a search parameter of type reference on an element of type canonical is supposed to behave. <br>
I would expect it to match against Questionnaire.url not <a href="http://Questionnaire.id">Questionnaire.id</a>, but it might be both...</p>
<p>The spec says: </p>
<blockquote>
<p>The interpretation of a reference parameter is <strong>either</strong>:<br>
[parameter]=[id] the logical [id] of a resource using a local reference (i.e. a relative reference)<br>
[parameter]=[type]/[id] the logical [id] of a resource of a specified type using a local reference (i.e. a relative reference), for when the reference can point to different types of resources (e.g. Observation.subject)<br>
[parameter]=[url] where the [url] is an absolute URL - a reference to a resource by its absolute location, or by it's canonical URL</p>
</blockquote>
<p>I read that "either" as "if it's a canonical url it will <em>only</em> match against the url, <em>not</em> the id.</p>



<a name="256265249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20FHIR%20Error%20500%20on%20questionnaire/-response/near/256265249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response.html#256265249">(Oct 05 2021 at 15:21)</a>:</h4>
<p>Source: <a href="https://hl7.org/fhir/search.html#reference">https://hl7.org/fhir/search.html#reference</a></p>



<a name="256399276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/HAPI%20FHIR%20Error%20500%20on%20questionnaire/-response/near/256399276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> peter stroessler <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response.html#256399276">(Oct 06 2021 at 12:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191450">Simone Heckmann</span> <a href="#narrow/stream/179167-hapi/topic/HAPI.20FHIR.20Error.20500.20on.20questionnaire.2F-response/near/256265165">said</a>:</p>
<blockquote>
<p>Is it possible that "this worked before" refers to STU3? Because the type of QuestionnaireResponse.questionnaire has been changed from Reference to canonical between STU3 and R4.<br>
However I am not 100% certain how a search parameter of type reference on an element of type canonical is supposed to behave. <br>
I would expect it to match against Questionnaire.url not <a href="http://Questionnaire.id">Questionnaire.id</a>, but it might be both...</p>
<p>The spec says: </p>
<blockquote>
<p>The interpretation of a reference parameter is <strong>either</strong>:<br>
[parameter]=[id] the logical [id] of a resource using a local reference (i.e. a relative reference)<br>
[parameter]=[type]/[id] the logical [id] of a resource of a specified type using a local reference (i.e. a relative reference), for when the reference can point to different types of resources (e.g. Observation.subject)<br>
[parameter]=[url] where the [url] is an absolute URL - a reference to a resource by its absolute location, or by it's canonical URL</p>
</blockquote>
<p>I read that "either" as "if it's a canonical url it will <em>only</em> match against the url, <em>not</em> the id.</p>
</blockquote>
<p>No it refers to R4. Refers to Monday 3 p.m. same request url I guess, even I changed major things, not sure...Right now I get gateway timeout from the public hapi fhir, now for about  3 days. I made a workaround with dummy data for the 'statsistics' page for the presentation, so I'm  fine. Unfortunately the test server from uni isn't running anymore (referenced url, whose Id I don't  know before the resource is created. I think need to update the entry after creation?), I got it running locally but will not afford a webspace just for presetation purpose (background info). Thank you for the help &amp; reply.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
