---
layout: page
title: "FHIR Chat  · Intercepting outgoing Subscription requests · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Intercepting.20outgoing.20Subscription.20requests.html">Intercepting outgoing Subscription requests</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="262454465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Intercepting%20outgoing%20Subscription%20requests/near/262454465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joris Scharp <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Intercepting.20outgoing.20Subscription.20requests.html#262454465">(Nov 23 2021 at 13:24)</a>:</h4>
<p>Hi all,</p>
<p>I was wondering if it's possible to intercept outgoing Subscription calls before they are sent. So that I can execute logic that decides whether the notification is sent or not.</p>
<p>Some context: We apply search narrowing based on a given authorization. We also want to apply this logic runtime to calculate if the given Subscription should execute. We <em>could</em> also modify the <code>Subscription.criteria</code> on save. But we'd need to keep  changing it as the authorizations change. If the above isn't possible in HAPI, deciding between the two options will be easy!</p>



<a name="262472198"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Intercepting%20outgoing%20Subscription%20requests/near/262472198" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Intercepting.20outgoing.20Subscription.20requests.html#262472198">(Nov 23 2021 at 15:38)</a>:</h4>
<p>HAPI has an interceptor framework for doing this kind of thing.  Here's a link to some documentation on server pointcuts.<br>
<a href="https://hapifhir.io/hapi-fhir/docs/interceptors/server_pointcuts.html">https://hapifhir.io/hapi-fhir/docs/interceptors/server_pointcuts.html</a></p>



<a name="262556565"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Intercepting%20outgoing%20Subscription%20requests/near/262556565" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joris Scharp <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Intercepting.20outgoing.20Subscription.20requests.html#262556565">(Nov 24 2021 at 08:11)</a>:</h4>
<p>I  know about the primary interceptor hooks. But as far as I know, this is always based on an incoming request, which is not directly the case for sending a notification to existing <code>Subscription</code> resources right? Say someone executes a <code>PUT</code> on  a <code>Patient</code> resource, I don't see  any hook that lets  me inject logic on whether to or not to send the notification based  on <code>Subscription.criteria</code> that matches the updated <code>Patient</code> resource.</p>



<a name="262558471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Intercepting%20outgoing%20Subscription%20requests/near/262558471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Intercepting.20outgoing.20Subscription.20requests.html#262558471">(Nov 24 2021 at 08:34)</a>:</h4>
<p>I can't really speak to the subscription story, but the javadoc for the PointCut enum includes a bunch of  SUBSCRIPTION_xxx values.<br>
<a href="https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-base/ca/uhn/fhir/interceptor/api/Pointcut.html">https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-base/ca/uhn/fhir/interceptor/api/Pointcut.html</a></p>



<a name="262573020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Intercepting%20outgoing%20Subscription%20requests/near/262573020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joris Scharp <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Intercepting.20outgoing.20Subscription.20requests.html#262573020">(Nov 24 2021 at 10:58)</a>:</h4>
<p>Ah that's interesting <span class="user-mention" data-user-id="191926">@Joel Schneider</span>, thanks! I see some promissing <code>Pointcuts</code>. </p>
<p>I see a lot more hook types than shown in the server pointcuts diagrams. It would be great if HAPI could add all server hook types to <a href="https://hapifhir.io/hapi-fhir/docs/interceptors/server_pointcuts.html">https://hapifhir.io/hapi-fhir/docs/interceptors/server_pointcuts.html</a>, much easier to find that way!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
