---
layout: page
title: "FHIR Chat  · Conditional PUT not working · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Conditional.20PUT.20not.20working.html">Conditional PUT not working</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="244894271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Conditional%20PUT%20not%20working/near/244894271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Conditional.20PUT.20not.20working.html#244894271">(Jul 05 2021 at 04:51)</a>:</h4>
<p>My apologies, I created this thread in <a href="#narrow/stream/179166-implementers/topic/Conditional.20PUT.20not.20working/near/244541132">implementers</a> without checking. </p>
<p>How do I specify resource ID in PUT request of a bundle?</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;Bundle&quot;,
    &quot;type&quot;: &quot;transaction&quot;,
    &quot;entry&quot;: [
        {
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Group&quot;,
                &quot;id&quot;: &quot;4812&quot;,
                // other fields
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;PUT&quot;,
                &quot;url&quot;: &quot;Group?identifier=3.5&quot;
            }
        }
    ]
}
</code></pre></div>
<p>But this updates the resource which has the identifier<code>3.5</code> (<code>4809</code>). My intention is up update <code>4812</code> when there's no other resource that has the identifier <code>3.5</code>.</p>
<p>I expected this to have happened</p>
<blockquote>
<p><strong>One Match, resource id provided but does not match resource found:</strong><br>
The server returns a 400 Bad Request error indicating the client id specification was a problem preferably with an OperationOutcome</p>
</blockquote>
<p>I just noticed that normal PUT request doesn't work too. GET to <code>/Group?identifier=3.5</code> returns 1 resource with ID <code>4809</code>.</p>
<p>I'm trying to update resource <code>4812</code> only if there's no other resource with identifier <code>3.5</code>.</p>
<p>PUT to <code>/Group?identifier=3.5</code> updates <code>4809</code>, even though a group with that identifier exists (<code>4809</code>)</p>
<p>Body is</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;Group&quot;,
    &quot;id&quot;: &quot;4812&quot;,
    // other fields
}
</code></pre></div>



<a name="244935563"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Conditional%20PUT%20not%20working/near/244935563" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Conditional.20PUT.20not.20working.html#244935563">(Jul 05 2021 at 13:26)</a>:</h4>
<p>This fails too, conditional PATCH. </p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;Bundle&quot;,
    &quot;type&quot;: &quot;transaction&quot;,
    &quot;entry&quot;: [
        {
            &quot;fullUrl&quot;: &quot;urn:uuid:ad46ecad-dd94-11eb-af49-e0946771098e&quot;,
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;Patient&quot;,
                // patient info
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;POST&quot;,
                &quot;ifNoneExist&quot;: &quot;telecom=testuser@gmail.com&quot;
            }
        },
        {
            &quot;resource&quot;: {
                &quot;resourceType&quot;: &quot;CareTeam&quot;,
                &quot;identifier&quot;: [
                    {
                        &quot;value&quot;: &quot;CT33426163&quot;,
                        &quot;system&quot;: &quot;EXSYS&quot;
                    }
                ],
                &quot;subject&quot;: {
                    &quot;reference&quot;: &quot;urn:uuid:ad46ecad-dd94-11eb-af49-e0946771098e&quot;,
                    &quot;type&quot;: &quot;Patient&quot;
                },
                // other data
            },
            &quot;request&quot;: {
                &quot;method&quot;: &quot;POST&quot;,
                &quot;ifNoneExist&quot;: &quot;subject.telecom=testuser@gmail.com&quot;
            }
        }
    ]
}
</code></pre></div>
<div class="codehilite"><pre><span></span><code>&quot;Failed to call access method: org.springframework.dao.InvalidDataAccessApiUsageException:
 Invalid match URL format (must match &quot;[resourceType]?[params]&quot;);
nested exception is java.lang.IllegalArgumentException:
Invalid match URL format (must match &quot;[resourceType]?[params]&quot;)&quot;
</code></pre></div>
<p>I'm facing this issue on all query parameters that use conditionals in all transactions. This is causing all major endpoints on our API to fail, what do I do?</p>



<a name="245000243"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Conditional%20PUT%20not%20working/near/245000243" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Conditional.20PUT.20not.20working.html#245000243">(Jul 06 2021 at 06:33)</a>:</h4>
<p>Kindly help, thanks :)</p>



<a name="245183357"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Conditional%20PUT%20not%20working/near/245183357" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mirjam Baltus <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Conditional.20PUT.20not.20working.html#245183357">(Jul 07 2021 at 13:54)</a>:</h4>
<p>You say 'conditional PATCH', but your http verb is POST. In your request, the 'ifNoneExist' is can be used on a POST (not PUT or PATCH), so maybe you actually meant to do a conditional POST. But you do not have a url listed, which the server will need to check for the type you want to create.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
