---
layout: page
title: "FHIR Chat  · Query on extension · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html">Query on extension</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="217848069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/217848069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#217848069">(Nov 25 2020 at 06:14)</a>:</h4>
<p>Is there a way I can search for resources that have a certain extension value in them? For example, I'm storing a valueString in the Patient resource that can be YES or NO or MAYBE. How do I search for patients that have this value in the extension? The URL is 'baseURL/agree'</p>



<a name="217863778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/217863778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Sandberg <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#217863778">(Nov 25 2020 at 09:52)</a>:</h4>
<p>I'm pretty sure you should build your own search parameter for this; <a href="https://hl7.org/fhir/domainresource.html#search">https://hl7.org/fhir/domainresource.html#search</a></p>



<a name="217892442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/217892442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#217892442">(Nov 25 2020 at 14:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="280425">Marc Sandberg</span> <a href="#narrow/stream/179167-hapi/topic/Query.20on.20extension/near/217863778">said</a>:</p>
<blockquote>
<p>I'm pretty sure you should build your own search parameter for this; <a href="https://hl7.org/fhir/domainresource.html#search">https://hl7.org/fhir/domainresource.html#search</a></p>
</blockquote>
<p>correct</p>



<a name="217964569"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/217964569" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#217964569">(Nov 26 2020 at 04:25)</a>:</h4>
<p>But I read that for a search extension, I'll need to modify the server code?</p>



<a name="217968315"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/217968315" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#217968315">(Nov 26 2020 at 05:56)</a>:</h4>
<p>I think I was successful in making a search extension, how do I use it now?</p>



<a name="217969580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/217969580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#217969580">(Nov 26 2020 at 06:29)</a>:</h4>
<p>IIRC You create a SearchParameter resource and save to hapi. After that it will recognise the new search.</p>



<a name="217969906"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/217969906" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#217969906">(Nov 26 2020 at 06:38)</a>:</h4>
<p>I did create a search parameter (thanks for pointing me to the right resource!), but not sure if it's correct, and how to use it. May I paste the request body here?</p>



<a name="218045416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/218045416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#218045416">(Nov 26 2020 at 23:37)</a>:</h4>
<p>sure....</p>



<a name="218055857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/218055857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#218055857">(Nov 27 2020 at 04:21)</a>:</h4>
<p>{<br>
  "resourceType" : "SearchParameter",<br>
  "name" : "Patient search by accept",<br>
  "status" : "active",<br>
  "description" : "Search by patient accepted parameter",<br>
  "purpose" : "Search by patient accepted parameter",<br>
  "code" : "PatientAcceptSearch",<br>
  "base" : ["Patient"],<br>
  "type" : "string",<br>
  "xpath" : "f:Patient/f:extension[@url='<a href="https://hapi.fhir.org/baseR4/Accepted']">https://hapi.fhir.org/baseR4/Accepted']</a>",<br>
  "xpathUsage" : "normal",<br>
  "target" : ["Patient"],<br>
  "comparator" : ["eq"],<br>
  "modifier" : ["exact"]<br>
}</p>
<p>I used this to create the search parameter. How do I use this to search all patients that have "YES" in the extension?</p>



<a name="218113991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/218113991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#218113991">(Nov 27 2020 at 17:22)</a>:</h4>
<p>Have you tried [host]/Patient?PatientAcceptSearch=yes ? (after saving the resource on the server).  Note that this is just the way that hapi works - the spec doesn't require it AFAIK...</p>



<a name="218115411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/218115411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#218115411">(Nov 27 2020 at 17:39)</a>:</h4>
<p>Oh, and the name shouldn't have spaces ('computer friendly')...</p>



<a name="218263475"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/218263475" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#218263475">(Nov 30 2020 at 09:22)</a>:</h4>
<p>Wow that works! Thank you!</p>



<a name="219062356"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219062356" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219062356">(Dec 07 2020 at 10:25)</a>:</h4>
<p>Well, erm, I tried to search for another extension, and this doesn't work. What am I doing wrong?</p>
<p>Search parameter <a href="http://hapi.fhir.org/baseR4/SearchParameter/1704205">here</a></p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;SearchParameter&quot;,
    &quot;name&quot;: &quot;PractitionerRoleSearch&quot;,
    &quot;status&quot;: &quot;active&quot;,
    &quot;description&quot;: &quot;Search by Practitioner their role&quot;,
    &quot;purpose&quot;: &quot;Search by Practitioner by their role&quot;,
    &quot;code&quot;: &quot;PractitionerRoleSearch&quot;,
    &quot;base&quot;: [&quot;Practitioner&quot;],
    &quot;type&quot;: &quot;string&quot;,
    &quot;expression&quot;: &quot;Practitioner.extension(&#39;https://hapi.fhir.org/baseR4/Role&#39;)&quot;,
    &quot;xpath&quot;: &quot;f:Practitioner/f:extension[@url=&#39;https://hapi.fhir.org/baseR4/Role&#39;]&quot;,
    &quot;xpathUsage&quot;: &quot;normal&quot;,
    &quot;target&quot;: [&quot;Practitioner&quot;],
    &quot;comparator&quot;: [&quot;eq&quot;],
    &quot;modifier&quot;: [&quot;exact&quot; ]
}
</code></pre></div>
<p>I'm using it like so, <code>GET http://hapi.fhir.org/baseR4/Practitioner?PractitionerRoleSearch=Care Manager</code>, but I get an error saying <code>Unknown search parameter</code>.</p>



<a name="219186636"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219186636" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219186636">(Dec 08 2020 at 09:29)</a>:</h4>
<p>I played around with the JSON, still doesn't work, I'm not sure what I'm doing wrong</p>



<a name="219194029"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219194029" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219194029">(Dec 08 2020 at 11:02)</a>:</h4>
<p>Also, is there a way I can resolve references directly? Say I have a careteam I'm querying, is there a way I can resolve <code>subject</code> reference directly, meaning instead of <code>subject</code> having a reference, it just has the patient's data?</p>



<a name="219206757"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219206757" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mirjam Baltus <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219206757">(Dec 08 2020 at 13:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="359486">Dexter</span> <a href="#narrow/stream/179167-hapi/topic/Query.20on.20extension/near/219194029">said</a>:</p>
<blockquote>
<p>Also, is there a way I can resolve references directly? Say I have a careteam I'm querying, is there a way I can resolve <code>subject</code> reference directly, meaning instead of <code>subject</code> having a reference, it just has the patient's data?</p>
</blockquote>
<p>No, you cannot put the patient's data in the subject field. That would not be valid FHIR.<br>
You can however do a search and then include the Patient resource in the search result:<br>
<code>GET &lt;base&gt;/CareTeam?_id=&lt;careteam_id&gt;&amp;_include=CareTeam:patient</code></p>



<a name="219222376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219222376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219222376">(Dec 08 2020 at 15:48)</a>:</h4>
<p>Okay, so that's not possible, yeah makes sense. Thanks!</p>



<a name="219284082"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219284082" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219284082">(Dec 09 2020 at 00:39)</a>:</h4>
<p>In the model of CareTeam, the element subject has a type of Reference (Patient or Group).</p>



<a name="219296742"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219296742" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219296742">(Dec 09 2020 at 04:27)</a>:</h4>
<p>Any pointers on the search parameters?</p>



<a name="219417804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219417804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219417804">(Dec 10 2020 at 00:09)</a>:</h4>
<p>Not sure - <span class="user-mention" data-user-id="191319">@James Agnew</span> - it used to be (I thought) that if you created a searchParameter on the hapi server that it would automatically enable that search - am I confused (again?)</p>



<a name="219419024"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219419024" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219419024">(Dec 10 2020 at 00:27)</a>:</h4>
<p>Or was that in SMILE server rather than the public test server...</p>



<a name="219582102"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/219582102" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#219582102">(Dec 11 2020 at 09:36)</a>:</h4>
<p>I can't seem to query on the existing search parameters defined by others on the server, I think they're okay too, what is it that is leading to the error? <code>https://hapi.fhir.org/baseR4/SearchParameter</code></p>



<a name="237976104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Query%20on%20extension/near/237976104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Traven <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Query.20on.20extension.html#237976104">(May 08 2021 at 18:39)</a>:</h4>
<p>Hello <br>
I'm struggling with the same problem as <span class="user-mention" data-user-id="359486">@Dexter</span>  </p>
<p>Based on the previous conversation in this topic I tried this: </p>
<p>1) Generate a new search parameter "PatientAcceptSearch"  by following POST Command: <br>
<a href="/user_uploads/10155/viaIOElpZYGSZVAkG-273Ixb/image.png">image.png</a> <br>
-&gt; This seemed to work, since I found the ressource on the server: <br>
<a href="/user_uploads/10155/CilgiYDj7ka7cj0pasleXBxW/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/viaIOElpZYGSZVAkG-273Ixb/image.png" title="image.png"><img src="/user_uploads/10155/viaIOElpZYGSZVAkG-273Ixb/image.png"></a></div><div class="message_inline_image"><a href="/user_uploads/10155/CilgiYDj7ka7cj0pasleXBxW/image.png" title="image.png"><img src="/user_uploads/10155/CilgiYDj7ka7cj0pasleXBxW/image.png"></a></div><p>2) Query for Patients with that extensions <br>
<a href="http://hapi.fhir.org/baseR4/Patient?PatientAcceptSearch=yes">http://hapi.fhir.org/baseR4/Patient?PatientAcceptSearch=yes</a> <br>
-&gt; Not working, keep getting error  "Unknown search parameter \"PatientAcceptSearch\" for resource type \"Patient\". Valid search parameters for this search are: [_id, _language,.... " </p>
<p>Could someone tell me what I got wrong?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
