---
layout: page
title: "FHIR Chat  · Using SearchParameter and updating a resource · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Using.20SearchParameter.20and.20updating.20a.20resource.html">Using SearchParameter and updating a resource</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="270615679"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Using%20SearchParameter%20and%20updating%20a%20resource/near/270615679" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Atterberry <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Using.20SearchParameter.20and.20updating.20a.20resource.html#270615679">(Feb 03 2022 at 20:51)</a>:</h4>
<p>Also posted in implementers<br>
HAPI FHIR Version 5.4.0 on Mac/Linux</p>
<p>I'm using the following SearchParameter to eliminate duplicate Identifiers for a Patient resource.  It works fine until I try to update that resource using the identifier as part of the PUT command with URL <a href="http://localhost:3111/myfhir/Patient?identifier=urn:uuid:555|26828F0386673">http://localhost:3111/myfhir/Patient?identifier=urn:uuid:555|26828F0386673</a>. An error is returned</p>
<p>Can not create resource of type Patient as it would create a duplicate unique index matching query: Patient?identifier=urn%3Auuid%3A555%7C26828F0386673 (existing index belongs to Patient/391494aa-0cba-4e88-85c8-7539a5e9506f, new unique index created by SearchParameter/11d73d9c-b13a-4f70-9e7d-a7a916d80765)</p>
<p>If I use the id for the patient directly the update of the resource  works fine. <a href="http://localhost:3111/myfhir/Patient/391494aa-0cba-4e88-85c8-7539a5e9506f">http://localhost:3111/myfhir/Patient/391494aa-0cba-4e88-85c8-7539a5e9506f</a>.</p>
<p>Once I use a SearchParameter does that mean I can't use the identifier for the update?  What am I missing?</p>
<p>It's worth noting that in the HFJ_IDX_CMP_STRING_UNIQ table the IDX_STRING column always has an entry like Patient?identifier=urn%3Auuid%3A555%7C26828F0386673 no matter if the SearchParameter expression is Patient.identifier or Patient.identifer.value</p>
<p>Thanks.</p>
<p>The SearchParameter looks like:<br>
{<br>
"resourceType": "SearchParameter",<br>
"meta": {<br>
"lastUpdated": "2021-05-02T10:43:02.162-04:00",<br>
"tag": [ {<br>
"system": "<a href="https://my.health.com/x/Onc1C">https://my.health.com/x/Onc1C</a>",<br>
"code": "34a800fa-bba9-4cb9-77ed-0aa4d0eecef2",<br>
"display": "FHIR Implementation Team"<br>
} ]<br>
},<br>
"extension": [<br>
{<br>
"url": "<a href="http://hapifhir.io/fhir/StructureDefinition/sp-unique">http://hapifhir.io/fhir/StructureDefinition/sp-unique</a>",<br>
"valueBoolean": true<br>
}<br>
],<br>
"url": "<a href="http://health.com/fhir/SearchParameter/uniq-patient-identifier">http://health.com/fhir/SearchParameter/uniq-patient-identifier</a>",<br>
"name": "unique-patient-identifier",<br>
"status": "active",<br>
"description": "A unique patient identifier",<br>
"code": "unique-patient-identifier",<br>
"base": [<br>
"Patient"<br>
],<br>
"type": "token",<br>
"expression": "Patient",<br>
"component": [<br>
{<br>
"definition": "<a href="http://hl7.org/fhir/SearchParameter/patient-identifier">http://hl7.org/fhir/SearchParameter/patient-identifier</a>",<br>
"expression": "Patient.identifier"<br>
}<br>
]<br>
}</p>



<a name="270619788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Using%20SearchParameter%20and%20updating%20a%20resource/near/270619788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Flack <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Using.20SearchParameter.20and.20updating.20a.20resource.html#270619788">(Feb 03 2022 at 21:23)</a>:</h4>
<p>I've fixed my FHIR base URL, but I'm still getting "Failed to fetch API definition". This is a fresh HAPI deployment... can anyone help? <a href="/user_uploads/10155/cDf0h33v74zGzYQkDxtx0mpo/Screen-Shot-2022-02-03-at-4.22.46-PM.png">Screen-Shot-2022-02-03-at-4.22.46-PM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/cDf0h33v74zGzYQkDxtx0mpo/Screen-Shot-2022-02-03-at-4.22.46-PM.png" title="Screen-Shot-2022-02-03-at-4.22.46-PM.png"><img src="/user_uploads/10155/cDf0h33v74zGzYQkDxtx0mpo/Screen-Shot-2022-02-03-at-4.22.46-PM.png"></a></div>



<a name="270619845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Using%20SearchParameter%20and%20updating%20a%20resource/near/270619845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Flack <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Using.20SearchParameter.20and.20updating.20a.20resource.html#270619845">(Feb 03 2022 at 21:24)</a>:</h4>
<p><a href="http://20.119.216.32:8080/fhir/swagger-ui/">http://20.119.216.32:8080/fhir/swagger-ui/</a></p>



<a name="270745328"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Using%20SearchParameter%20and%20updating%20a%20resource/near/270745328" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Atterberry <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Using.20SearchParameter.20and.20updating.20a.20resource.html#270745328">(Feb 04 2022 at 17:21)</a>:</h4>
<p><span class="user-mention" data-user-id="423941">@Joe Flack</span> Not sure what swagger has to with my SearchParameter question</p>



<a name="270861165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Using%20SearchParameter%20and%20updating%20a%20resource/near/270861165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Flack <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Using.20SearchParameter.20and.20updating.20a.20resource.html#270861165">(Feb 06 2022 at 01:46)</a>:</h4>
<p>Nothing. I'm just not that familiar with Zulip. I didn't mean to reply to your thread.</p>



<a name="270901446"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Using%20SearchParameter%20and%20updating%20a%20resource/near/270901446" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Using.20SearchParameter.20and.20updating.20a.20resource.html#270901446">(Feb 06 2022 at 17:40)</a>:</h4>
<p>FWIW I am not able to reproduce this on <a href="http://hapi.fhir.org">hapi.fhir.org</a>, so I'm assuming this is an issue that's already fixed in 5.7.0-SNAPSHOT</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
