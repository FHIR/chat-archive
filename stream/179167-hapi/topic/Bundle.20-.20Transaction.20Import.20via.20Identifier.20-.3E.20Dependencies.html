---
layout: page
title: "FHIR Chat  · Bundle - Transaction Import via Identifier -&gt; Dependencies · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20-.20Transaction.20Import.20via.20Identifier.20-.3E.20Dependencies.html">Bundle - Transaction Import via Identifier -&gt; Dependencies</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="230342920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20-%20Transaction%20Import%20via%20Identifier%20-%3E%20Dependencies/near/230342920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Meyers <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20-.20Transaction.20Import.20via.20Identifier.20-.3E.20Dependencies.html#230342920">(Mar 15 2021 at 13:23)</a>:</h4>
<p>We currently import data via bundle into our HAPI server using the "?identifier" syntax and PUT. The problem: When sending the bundle, resources do not yet exist on the FHIR server which reference some of the resources. <br>
Prominent example: KdsMedikationsModul. The bundle basically contains the resources Medication, MedicationAdministration and MedicationStatement. MedicationAdministration and MedicationStatement reference Medication.Since the entry order in the processing on the server is random (?), it can of course happen that MedicationAdministration is processed first, at a time when Medication does not yet exist. </p>
<p>The first error message reads: <br>
"Invalid match URL \"Medication?identifier=55555\" - No resources match this search". <br>
(when re-executing / or trying to perform a batch operation, messages like "ConstraintViolentException" appear).</p>
<p>Is there a solution for this and is this a HAPI specific problem at all? I have attached a minimal example and it would be good if one of the experts could answer me whether this can work at all. <br>
One solution, of course, would be to disassemble the bundle, separate it by resources and run it separately, but that would be anything but a nice solution. <a href="/user_uploads/10155/Od88dbzKUK7k31m1Tq8czTTG/MedicationPUT_Example.json">MedicationPUT_Example.json</a></p>



<a name="230479280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20-%20Transaction%20Import%20via%20Identifier%20-%3E%20Dependencies/near/230479280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dexter <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20-.20Transaction.20Import.20via.20Identifier.20-.3E.20Dependencies.html#230479280">(Mar 16 2021 at 09:01)</a>:</h4>
<p>I think you can temporarily disable referential integrity when starting the server up in <code>application.yaml</code>. Specifically, these keys (are they called keys?). Relevant <a href="https://smilecdr.com/docs/configuration_categories/fhir_configuration.html">docs here</a>.</p>
<div class="codehilite"><pre><span></span><code># allow_external_references: true
allow_placeholder_references: true
enforce_referential_integrity_on_delete: false
enforce_referential_integrity_on_write: false
</code></pre></div>
<p>Example yaml <a href="https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/application.yaml">here</a></p>
<p>I could be wrong though, I'm barely scratching the surface of HAPI and FHIR. I hope this helps :)</p>



<a name="230519127"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Bundle%20-%20Transaction%20Import%20via%20Identifier%20-%3E%20Dependencies/near/230519127" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Meyers <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Bundle.20-.20Transaction.20Import.20via.20Identifier.20-.3E.20Dependencies.html#230519127">(Mar 16 2021 at 14:17)</a>:</h4>
<p>thx for that advice <span class="user-mention" data-user-id="359486">@Dexter</span> <br>
Weve tried this out, but unfortunately the issue type is still the same.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
