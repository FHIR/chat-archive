---
layout: page
title: "FHIR Chat  · Config in env vars for JPA - Docker · hapi"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/index.html">hapi</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html">Config in env vars for JPA - Docker</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="234954830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/234954830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#234954830">(Apr 17 2021 at 03:12)</a>:</h4>
<p>Hi folks. On HAPI JPA Server I'm trying to set environment variables for docker-compose files. I can confirm that this works with db configs, e.g. <code>spring.datasource.url: 'jdbc:postgresql://db:5432/hapi'</code> in docker-compose.yml files. But, what does not appear to work are configs in application.yml that are commented out, so <code>hapi.fhir.cql_enabled: "true"</code> does not work. Thoughts? (For the close observer, bools are enclosed in quotes in yml.)</p>
<p>Update: Doh, single quotes for the bool value worked. :)<br>
Update: How does one enable partitioning, e.g. <code>hapi.fhir.partitioning</code> because <code>multitenancy_enabled</code> has been removed from application.yaml?</p>



<a name="235021569"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235021569" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235021569">(Apr 17 2021 at 21:50)</a>:</h4>
<p>After some attempts, I'm not sure how multitenancy is enabled. Neither <code>hapi.fhir.partitioning.multitenancy_enabled</code> or <code>hapi.fhir.partitioning_multitenancy_enabled</code> are in 5.3 and master application.yaml</p>



<a name="235142600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235142600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jame Dang <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235142600">(Apr 19 2021 at 08:07)</a>:</h4>
<p>Hi all,<br>
I try to run the starter project with SpringBoot and the Rest Server is OK but for the Web Testpage UI (cannot run the hapi-fhir-testpage-overlay with SpringBoot).  I don't know how to config the path then it throws exception : Could not open ServletContext resource [/WEB-INF/templates/home.html (when I run with Jetty it is OK). Could you help me ?</p>



<a name="235188038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235188038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235188038">(Apr 19 2021 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191505">@Sean McIlvenna</span> I'm going through PRs and it seems you may be the expert on application.yaml. Can I ask for your help on starting HAPI JPA in multitenancy mode?</p>



<a name="235200212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235200212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235200212">(Apr 19 2021 at 15:26)</a>:</h4>
<p>Heh... Well, that's something I haven't done, yet. It's something that I would <em>also</em> like to know how to do, though.</p>



<a name="235200255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235200255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235200255">(Apr 19 2021 at 15:27)</a>:</h4>
<p>Let me take a look at and see if I can figure out a general direction to point you in...</p>



<a name="235200579"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235200579" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235200579">(Apr 19 2021 at 15:29)</a>:</h4>
<p>At first glance, it looks like partitioning is enabled by default</p>



<a name="235200670"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235200670" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235200670">(Apr 19 2021 at 15:30)</a>:</h4>
<p>(which is the same as multi-tenancy)</p>



<a name="235200737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235200737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235200737">(Apr 19 2021 at 15:30)</a>:</h4>
<p>And there are two <em>configurable</em> properties for partitioning:</p>
<ul>
<li>allow_references_across_partitions</li>
<li>partitioning_include_in_search_hashes</li>
</ul>



<a name="235201104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235201104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235201104">(Apr 19 2021 at 15:32)</a>:</h4>
<p>HAPI can be configured to have a pre-defined set of tenants... but, in the case of <code>hapi-fhir-jpaserver-starter</code>, it looks like it allows <em>any</em> tenant ID</p>



<a name="235201214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235201214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235201214">(Apr 19 2021 at 15:33)</a>:</h4>
<p>so, theoretically, you should just be able to GET/POST/PUT/DELETE with <code>/fhir/&lt;tenantID&gt;/&lt;resourceType&gt;/&lt;resourceId&gt;</code></p>



<a name="235201239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235201239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235201239">(Apr 19 2021 at 15:33)</a>:</h4>
<p>I'm going to test this out, now</p>



<a name="235202216"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235202216" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235202216">(Apr 19 2021 at 15:40)</a>:</h4>
<p>oh... partitioning is not on <em>by  default</em></p>



<a name="235202280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235202280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235202280">(Apr 19 2021 at 15:40)</a>:</h4>
<p>it is activated when the <code>partitioning:</code> property is present in the <code>application.yml</code> property</p>



<a name="235202331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235202331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235202331">(Apr 19 2021 at 15:40)</a>:</h4>
<p>i.e.</p>
<div class="codehilite"><pre><span></span><code>    partitioning:
      allow_references_across_partitions: false
      partitioning_include_in_search_hashes: false
</code></pre></div>



<a name="235202357"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235202357" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235202357">(Apr 19 2021 at 15:40)</a>:</h4>
<p>if that block is commented out, then partitioning is disabled</p>



<a name="235203348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235203348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235203348">(Apr 19 2021 at 15:47)</a>:</h4>
<p>Once partitioning is enabled, you can create partitions with the custom operation <code>$partition-management-create-partition</code>, as documented here:<br>
<a href="https://hapifhir.io/hapi-fhir/docs/server_jpa_partitioning/partitioning_management_operations.html">https://hapifhir.io/hapi-fhir/docs/server_jpa_partitioning/partitioning_management_operations.html</a></p>



<a name="235203376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235203376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235203376">(Apr 19 2021 at 15:47)</a>:</h4>
<p>This should be done against the DEFAULT partition</p>



<a name="235203442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235203442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235203442">(Apr 19 2021 at 15:48)</a>:</h4>
<p>i.e.: POST <a href="http://localhost:8080/fhir/DEFAULT/$partition-management-create-partition">http://localhost:8080/fhir/DEFAULT/$partition-management-create-partition</a></p>



<a name="235203480"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235203480" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235203480">(Apr 19 2021 at 15:48)</a>:</h4>
<p>After the partition is created, you can do whatever you want with it, like a normal FHIR server</p>



<a name="235203520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235203520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235203520">(Apr 19 2021 at 15:48)</a>:</h4>
<p>under a partition/tenant in the path of the url</p>



<a name="235203535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235203535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235203535">(Apr 19 2021 at 15:48)</a>:</h4>
<p>Hope that helps!</p>



<a name="235205640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179167-hapi/topic/Config%20in%20env%20vars%20for%20JPA%20-%20Docker/near/235205640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179167-hapi/topic/Config.20in.20env.20vars.20for.20JPA.20-.20Docker.html#235205640">(Apr 19 2021 at 16:01)</a>:</h4>
<p>Ok, interesting. I tried it with env vars and there's no way to toggle just partitioning on/off. This seems to be an anti-pattern for automated E2E/QA because the only solution is to hand edit the file and it is not explicit (See <a href="https://12factor.net/config">https://12factor.net/config</a>).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
