---
layout: page
title: "FHIR Chat  · docs / Issue #119 Move CDS Service request parameters pat... · cds hooks/github"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/index.html">cds hooks/github</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html">docs / Issue #119 Move CDS Service request parameters pat...</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153920858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920858">(Nov 21 2017 at 23:16)</a>:</h4>
<p>kpshek milestoned <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>



<a name="153920859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920859">(Nov 21 2017 at 23:16)</a>:</h4>
<p>kpshek opened <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>Today, the <code>patient</code> and <code>encounter</code> parameters are defined in the request to the CDS Service. However, what if we have hooks that:</p>
<ul>
<li>
<p>Do not have a patient in context. For instance, consider a hook <code>ehr-launch</code> that is invoked as soon as the user launches the EHR application.</p>
</li>
<li>
<p>Have more than one patient in context. For instance, consider a hook <code>patientlist-view</code> that is invoked when the user is viewing their patient list.</p>
</li>
</ul>
<p>In both of these scenarios, that current location of our <code>patient</code> and <code>encounter</code> parameters is not optimal. Either the parameters are <code>null</code> (or not set) or they are not set and instead superseded by a more appropriate parameter in the <code>context</code> in the CDS Service request.</p>
<p>The proposal to address this would be to remove <code>patient</code> and <code>encounter</code> from the CDS Service request and instead place these as parameters in the <code>context</code> object when appropriate for a given hook. For the three hooks we've defined and implemented today (<code>patient-view</code>, <code>medication-prescribe</code>, <code>order-review</code>), they would all include <code>patient</code> and <code>encounter</code>.</p>
<p>In offline discussion with @brynrhodes and @isaacvetter, we all agreed this would be a good change to make for 1.0. While this is technically a breaking change, it will serve us better down the road as we start implementing and supporting new hooks in which there is no patient or no single patient in context. Additionally, this is a minor change as we're simply just moving where in the JSON structure these parameters are read.</p>
<p>Given that it is a breaking change, we would appreciate thoughts from the rest of the community.</p>
</blockquote>



<a name="153920865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920865">(Nov 22 2017 at 00:27)</a>:</h4>
<p>kensaku-kawamoto <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346204665" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346204665">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>I think it's a reasonable change and a good idea.</p>
</blockquote>



<a name="153920866"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920866" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920866">(Nov 22 2017 at 00:37)</a>:</h4>
<p>grahamegrieve <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346206496" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346206496">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>so to be clear, this is a significant change because you are replacing the ids of the these things with the whole resource. That's.... potentially significant. I'm making sure that this is clear</p>
<p>I'm in favor of this change. It works for my existing use cases, that include some where patient and encounter are not in context, and some where they are </p>
</blockquote>



<a name="153920867"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920867" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920867">(Nov 22 2017 at 00:44)</a>:</h4>
<p>kpshek <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346207637" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346207637">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<blockquote>
<p>so to be clear, this is a significant change because you are replacing the ids of the these things with the whole resource. That's.... potentially significant. I'm making sure that this is clear</p>
</blockquote>
<p>That is <strong>not</strong> what I'm proposing. Both the <code>patient</code> and <code>encounter</code> parameters would continue to just be the ids still.</p>
</blockquote>



<a name="153920869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920869">(Nov 22 2017 at 01:06)</a>:</h4>
<p>brynrhodes <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346211384" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346211384">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<blockquote>
<p>so to be clear, this is a significant change because you are replacing the ids of the these things with the whole resource. That's.... potentially significant. I'm making sure that this is clear</p>
</blockquote>
<p>It would depend on the hook though, right? A hook could define the <code>patient</code> parameter as the resource, or it could define it as a <code>patientId</code> parameter. I see that as another advantage of this approach, it would be up to the hook to specify what it would actually provide.</p>
</blockquote>



<a name="153920870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920870">(Nov 22 2017 at 01:08)</a>:</h4>
<p>kpshek <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346211723" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346211723">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>Correct, each hook defines the <code>context</code> object as it sees fit. However, we're not proposing we start sending the full Patient and Encounter resource in place of the ids we're sending today. For the 3 hooks we've defined today, it would continue to be ids.</p>
</blockquote>



<a name="153920873"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920873" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920873">(Nov 22 2017 at 01:47)</a>:</h4>
<p>grahamegrieve <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346218079" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346218079">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<blockquote>
<p>That is not what I'm proposing</p>
</blockquote>
<p>but context is an array of resources....</p>
</blockquote>



<a name="153920879"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920879" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920879">(Nov 22 2017 at 02:33)</a>:</h4>
<p>jmandel <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346225302" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346225302">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>Not if we land#39 appropriately -- which I think is increasingly critical if we make sense the change proposed here. Doing this change without #39 would be very messy.</p>
</blockquote>



<a name="153920884"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920884" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920884">(Nov 22 2017 at 03:08)</a>:</h4>
<p>grahamegrieve <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346230258" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346230258">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>really? that's not evident to me from the description of #39 </p>
</blockquote>



<a name="153920954"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153920954" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153920954">(Nov 22 2017 at 08:04)</a>:</h4>
<p>kpshek <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346272584" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346272584">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<blockquote>
<p>but context is an array of resources....</p>
</blockquote>
<p>Today, we document it as "Hook-specific contextual data that the CDS service will need". #39 is going to clearly define how a new hook is defined. Related to this, <code>context</code> is an object with keys/values specific to each individual hook. From an earlier comment from me on #39:</p>
<blockquote>
<p>From <a href="https://chat.fhir.org/#narrow/stream/cds-hooks/subject/docs.20.2F.20Issue.20.2336.20Context.20as.20a.20list.20of.20FHIR.20Resources" target="_blank" title="https://chat.fhir.org/#narrow/stream/cds-hooks/subject/docs.20.2F.20Issue.20.2336.20Context.20as.20a.20list.20of.20FHIR.20Resources">some Zulip discussion on this issue</a>, we're proposing that context is always a JSON object. Furthermore, context is defined per hook which each hook defining the individual keys and values (both the JSON value type and the content) within the context JSON object.</p>
</blockquote>
</blockquote>



<a name="153921308"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153921308" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153921308">(Nov 23 2017 at 15:43)</a>:</h4>
<p>WWie <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-346650121" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-346650121">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>I am in favor of that change. The patient and encounter Ids are indeed context but not always part of the active context. Putting them in the context object as optional makes sense. And putting more work into defining what context objects are and where they are well-defined vs. customizable will go a long way making this framework more robust.</p>
<p>We are looking into various scenarios where we would want to invoke a hook where the context would be a "class of patients", e.g. "Any patient with diagnosis X , Y or Z and age between 50 and 75". Having to still put a value into a high-level attribute like patient or encounter would make it a bit awkward to use. So would having to ignore a high-level parameter in the hook call.</p>
</blockquote>



<a name="153929955"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153929955" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153929955">(Jan 22 2018 at 16:05)</a>:</h4>
<p>robs16 <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-359472035" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-359472035">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>How does this interact with the prefetch requirements for a <a href="http://Patient.id" target="_blank" title="http://Patient.id">Patient.id</a> replacement? I mean if you are going down the road of these items being part of the context (and I think that might be reasonable), it seems that the prefetch replacements need to be defined somewhat dynamically. </p>
</blockquote>



<a name="153932926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153932926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153932926">(Jan 29 2018 at 15:46)</a>:</h4>
<p>kpshek assigned <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>



<a name="153932927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153932927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153932927">(Jan 29 2018 at 15:47)</a>:</h4>
<p>kpshek <a href="https://github.com/cds-hooks/docs/issues/119#issuecomment-361287513" target="_blank" title="https://github.com/cds-hooks/docs/issues/119#issuecomment-361287513">commented</a> on <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>
<blockquote>
<p>This issue has been addressed by PR #109 and #153 </p>
</blockquote>



<a name="153932928"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179276-cds%20hooks/github/topic/docs%20/%20Issue%20%23119%20Move%20CDS%20Service%20request%20parameters%20pat.../near/153932928" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179276-cds-hooks/github/topic/docs.20.2F.20Issue.20.23119.20Move.20CDS.20Service.20request.20parameters.20pat.2E.2E.2E.html#153932928">(Jan 29 2018 at 15:47)</a>:</h4>
<p>kpshek closed <a href="https://github.com/cds-hooks/docs/issues/119" target="_blank" title="https://github.com/cds-hooks/docs/issues/119">Issue #119</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
