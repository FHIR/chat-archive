---
layout: page
title: "FHIR Chat  · Define type information · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Define.20type.20information.html">Define type information</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="253608922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Define%20type%20information/near/253608922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Sanders <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Define.20type.20information.html#253608922">(Sep 16 2021 at 16:24)</a>:</h4>
<p>My team has been poking around trying to figure out how to extract the return type information for a define from the CQL/ELM. At the point of translation, the type information is available in the ExpressionDef. This is how the Atom plugin/cql-language-server exposes this information. When we load that library up in the CQL Engine, however, the ExpressionDef no longer carries the type information. There is a getResultTypeName() property, but it always returns null. <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> / <span class="user-mention" data-user-id="194178">@JP</span> can you provide some context here? There are two different object hierarchies in play (org.hl7.elm.r1.ExpressionDef vs. org.cqframework.cql.elm.execution.ExpressionDef), so I get that there can be differences, but it would be useful to us to have the type information at the point of execution. Specifically, we want it to build the schema for a Spark dataset that we are outputting that contains the results of the CQL evaluation.</p>



<a name="253609374"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Define%20type%20information/near/253609374" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Define.20type.20information.html#253609374">(Sep 16 2021 at 16:27)</a>:</h4>
<p>including type information in the ELM is an option on the CQL translator when generating ELM. The Atom plugin essentially uses a set of options that includes a lot of information for editor support.</p>
<p><a href="https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/cql-to-elm/OVERVIEW.md#usage">https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/cql-to-elm/OVERVIEW.md#usage</a></p>
<p>You're looking for the "result-types" option.</p>



<a name="253610379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Define%20type%20information/near/253610379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Define.20type.20information.html#253610379">(Sep 16 2021 at 16:33)</a>:</h4>
<p>And if it's helpful for your team, here's a PoC app running the CQL Engine on Spark:<br>
<a href="https://github.com/DBCG/spark-cql-fhir">https://github.com/DBCG/spark-cql-fhir</a></p>



<a name="253615236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Define%20type%20information/near/253615236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Sanders <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Define.20type.20information.html#253615236">(Sep 16 2021 at 17:04)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="194178">@JP</span> I looked at the translator options before asking, but I completely missed it. Appreciate the link to the spark POC. We'll have a look.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
