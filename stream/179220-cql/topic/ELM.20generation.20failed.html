---
layout: page
title: "FHIR Chat  · ELM generation failed · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html">ELM generation failed</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="248168813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248168813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248168813">(Aug 03 2021 at 00:11)</a>:</h4>
<p>Hi. Can I have a hint as the way to troubleshoot this error: "ELM generation failed with the following error: Cannot determine expression for data requirement because source is not an AliasedQuerySource or LetClause". ELM generation from the Atom plugin shows no errors. The CQL seems to evaluate correctly with test data. (The error is reported out from running <a href="http://_refresh.sh">_refresh.sh</a>)</p>



<a name="248350087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248350087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248350087">(Aug 04 2021 at 13:33)</a>:</h4>
<p>Hi Richard, that's an issue I'm currently working on, we've recently added some data requirements analysis to the refresh and it (apparently) has some issues. Do you have a repro library I could use to make sure I address the issue for your case as well?</p>



<a name="248360408"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248360408" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248360408">(Aug 04 2021 at 14:48)</a>:</h4>
<p>Hi Bryn, thanks! It's KitchenSink.cql here: <a href="https://github.com/intrahealth/simple-hiv-ig/blob/master/input/cql/KitchenSink.cql">https://github.com/intrahealth/simple-hiv-ig/blob/master/input/cql/KitchenSink.cql</a></p>



<a name="248633207"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248633207" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248633207">(Aug 06 2021 at 16:24)</a>:</h4>
<p>Hi Richard, I believe I've fixes this, can you update your CQF Tooling and try again?</p>



<a name="248634930"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248634930" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248634930">(Aug 06 2021 at 16:36)</a>:</h4>
<p>Hi. Awesome. Indeed, it gets past that error now. I see an error with not seeing FHIR Helpers although it is copied into input/resources:</p>
<div class="codehilite"><pre><span></span><code>No paths found for the Directory /Users/richard/src/github.com/intrahealth/simple-hiv-ig/input/tests/measure/KitchenSink:
12:29:42.414 [main] WARN  o.o.cqf.tooling.utilities.LogUtils - Measure-HIVSimpleGenderSuppDataIndiv could not be processed:
          Resource could not be processed: KitchenSink
                    1 included cql Libraries not found:
FHIRHelpers MISSING
</code></pre></div>



<a name="248635176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248635176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248635176">(Aug 06 2021 at 16:38)</a>:</h4>
<p>Hmm.... do you have a FHIRHelpers.cql source file?</p>



<a name="248635225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248635225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248635225">(Aug 06 2021 at 16:38)</a>:</h4>
<p>You shouldn't need it, but it sounds like maybe the bundling we're doing is requiring it.</p>



<a name="248635342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248635342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248635342">(Aug 06 2021 at 16:39)</a>:</h4>
<p>Yeah, looking through different projects that are all known to be working right now, they all have a FHIRHelpers.cql source file.</p>



<a name="248635439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248635439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248635439">(Aug 06 2021 at 16:40)</a>:</h4>
<p>Sure, I'll get one and try it.</p>



<a name="248635453"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248635453" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248635453">(Aug 06 2021 at 16:40)</a>:</h4>
<p>Use the one from here as the source of truth:</p>



<a name="248635454"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248635454" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248635454">(Aug 06 2021 at 16:40)</a>:</h4>
<p><a href="https://github.com/cqframework/cqf/blob/master/input/cql/FHIRHelpers.cql">https://github.com/cqframework/cqf/blob/master/input/cql/FHIRHelpers.cql</a></p>



<a name="248637050"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248637050" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248637050">(Aug 06 2021 at 16:52)</a>:</h4>
<p>Ok, that seems to be accepted. Great. Next error :) </p>
<div class="codehilite"><pre><span></span><code>2 missing ValueSets:
http://fhir.org/guides/cqf/cqf-common/ValueSet/inactive-condition MISSING
http://fhir.org/guides/cqf/cqf-common/ValueSet/active-condition MISSING

12:51:19.145 [main] WARN  o.o.cqf.tooling.utilities.LogUtils - Measure will not be bundled because ValueSet bundling failed.
No paths found for the Directory /Users/richard/src/github.com/intrahealth/simple-hiv-ig/input/tests/measure/KitchenSink:
12:51:19.145 [main] WARN  o.o.cqf.tooling.utilities.LogUtils - Measure-HIVSimpleGenderSuppDataIndiv could not be processed:
          Resource could not be processed: KitchenSink
                    2 missing ValueSets:
http://fhir.org/guides/cqf/cqf-common/ValueSet/inactive-condition MISSING
http://fhir.org/guides/cqf/cqf-common/ValueSet/active-condition MISSING
</code></pre></div>



<a name="248637416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248637416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248637416">(Aug 06 2021 at 16:54)</a>:</h4>
<p>'inactive-condition' is in my FHIRCommon</p>



<a name="248638931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248638931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248638931">(Aug 06 2021 at 17:04)</a>:</h4>
<p>Is there a canonical fhir common to use?</p>



<a name="248639764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248639764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248639764">(Aug 06 2021 at 17:10)</a>:</h4>
<p>Weird, still seeing bundling errors with FHIR Helpers</p>
<div class="codehilite"><pre><span></span><code>java.lang.RuntimeException: /Users/richard/src/github.com/intrahealth/simple-hiv-ig/fsh-generated/resources/FHIRHelpers.json (No such file or directory)
    at org.opencds.cqf.tooling.utilities.IOUtils.readResource(IOUtils.java:240)
    at org.opencds.cqf.tooling.utilities.IOUtils.readResource(IOUtils.java:203)
    at org.opencds.cqf.tooling.utilities.ResourceUtils.getR4DepLibraryResources(ResourceUtils.java:219)
    at org.opencds.cqf.tooling.utilities.ResourceUtils.getDepLibraryResources(ResourceUtils.java:136)
    at org.opencds.cqf.tooling.library.LibraryProcessor.bundleLibraryDependencies(LibraryProcessor.java:67)
    at org.opencds.cqf.tooling.measure.MeasureProcessor.bundleMeasures(MeasureProcessor.java:124)
    at org.opencds.cqf.tooling.processor.IGBundleProcessor.bundleIg(IGBundleProcessor.java:25)
    at org.opencds.cqf.tooling.processor.IGProcessor.publishIG(IGProcessor.java:79)
    at org.opencds.cqf.tooling.operation.RefreshIGOperation.execute(RefreshIGOperation.java:34)
    at org.opencds.cqf.tooling.Main.main(Main.java:195)
13:09:27.870 [main] WARN  o.o.cqf.tooling.utilities.LogUtils - Measure will not be bundled because Library Dependency bundling failed.
</code></pre></div>



<a name="248641738"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248641738" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248641738">(Aug 06 2021 at 17:26)</a>:</h4>
<p>FHIRCommon in CQF is the source of truth.</p>



<a name="248641852"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248641852" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248641852">(Aug 06 2021 at 17:27)</a>:</h4>
<p>I can’t run refresh on your ig though because there’s no ig reaource; coming from sushi and I don’t have that</p>



<a name="248649580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ELM%20generation%20failed/near/248649580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ELM.20generation.20failed.html#248649580">(Aug 06 2021 at 18:26)</a>:</h4>
<p>After running sushi it will be in fsh-generated/resources. I'll try the only true and living fhircommon and see how that goes.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
