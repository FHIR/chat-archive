---
layout: page
title: "FHIR Chat  · models of Reference types · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/models.20of.20Reference.20types.html">models of Reference types</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="157759394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/models%20of%20Reference%20types/near/157759394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Georg Fette <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/models.20of.20Reference.20types.html#157759394">(Feb 07 2019 at 08:25)</a>:</h4>
<p>Hello,<br>
When using the xsd-to-model-converter in vanilla mode on the "fhir-single.xsd" all References with a scope (e.g. "Reference(Patient|Group)") are mapped to the unscoped type Reference. When I parse a CQL-query including such a reference (e.g. "[Patient] A with [Encounter] B such that B.subject = A") I get a parse exception stating that "Reference" is not compatible with "Patient". When I rename the type of "subject" in the model file to "System.Any" the parsing works. What is the advice to handle References in CQL ? Should all usages of References be changed to System.Any in the model ? I could live with the loss of the Reference-scope, although it would be nice to keep that scope.<br>
Greetings</p>



<a name="157900653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/models%20of%20Reference%20types/near/157900653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/models.20of.20Reference.20types.html#157900653">(Feb 08 2019 at 22:58)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="196537">@Georg Fette</span> , since references in FHIR are a structure, changing them to System.Any would work for the translator (because it effectively disables type checking for that comparison), but it would mean that the implementation would be given the task of resolving what "reference(patient) = Patient" means.</p>
<p>With a model that represents FHIR directly, you could say something like "[Patient] A with [Encounter] B such that GetId(B.subject.reference) = <a href="http://A.id" target="_blank" title="http://A.id">A.id</a>", where GetId is a function that gets the tail of a URI.</p>
<p>The approach I've been working towards is to instead have the model info specify reference attributes as attributes of the referenced types directly. So "subject : Reference(Patient | Group)" would be represented in the model info as "subject : Patient | Group". This gives the translator the opportunity to perform the type checking, but still pushes the resolution of the reference to the implementation.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
