---
layout: page
title: "FHIR Chat  · Using between, period, and onset/abatement datetime for i... · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Using.20between.2C.20period.2C.20and.20onset.2Fabatement.20datetime.20for.20i.2E.2E.2E.html">Using between, period, and onset/abatement datetime for i...</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="167260931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Using%20between%2C%20period%2C%20and%20onset/abatement%20datetime%20for%20i.../near/167260931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Rodriguez <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Using.20between.2C.20period.2C.20and.20onset.2Fabatement.20datetime.20for.20i.2E.2E.2E.html#167260931">(Jun 04 2019 at 06:15)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> , <span class="user-mention" data-user-id="191469">@Chris Moesel</span>  et al.</p>
<p>Thank you again for all your (continued) help and guidance with my other recent posts.  This new topic covers a third area in my cql exploration that I think will set me up to start drafting some experimental measures.</p>
<p>As mentioned in my other post about validating a code in a medicationRequest resource, my context is accessing FHIR data.  I've also been referencing existing eCQMs based on the QDM for inspiration and am now attempting to write a FHIR equivalent retrieve  for a case that has a temporal relationship between resources. (I'll also be looking at the other resources that I realized you sent me on the other topic while I was drafting this new post).</p>
<p>Here's a generic relational retrieve in QDM:</p>
<p><code>Define “Patient Encounter”:
[Encounter, Performed: “encounterValueSet”] patientEncounter</code></p>
<p><code>Define “Encounter with Diagnosis”:
“Patient Encounter” patientEncounter
with [Diagnosis: “diagnosisValueSet”] patientDiagnosis
such that patientDiagnosis.prevalencePeriod overlaps patientEncounter.relevantPeriod</code></p>
<p>Using (<a href="http://hl7.org/fhir/us/qicore/2018Jan/qdm-to-qicore.html" target="_blank" title="http://hl7.org/fhir/us/qicore/2018Jan/qdm-to-qicore.html">http://hl7.org/fhir/us/qicore/2018Jan/qdm-to-qicore.html</a>), it looks like:</p>
<p><code>Diagnosis: Prevalence Period</code> maps to <code> Condition.onset[x]</code> and <code>Condition.abatement[x]</code></p>
<p>and</p>
<p><code>Encounter, Performed: Relevant Period</code> maps to <code>Encounter.period</code></p>
<p>and</p>
<p><code>Encounter, Performed: Code</code> maps to <code>Encounter.class</code></p>
<p>Since the prevalence period for Diagnosis seems to be broken up into two data “pieces” in FHIR, and it is to be compared to a period with implied start/end datetimes, I’d like to know if the following retrieve could be considered the FHIR equivalent to the generic QDM example:</p>
<p><code>Define “Patient Encounter”:
[Encounter] patientEncounter
    where patientEncounter.class in “encounterValueSet”</code></p>
<p><code>Define “Patient Diagnosis”:
[Condition] patientCondition
    where patientCondition.code in “conditionValueSet”</code></p>
<p><code>Define “Encounter with Diagnosis”
“Patient Encounter” patientEncounter
    with “patientCondition” patientCondition
        such that patientEncounter.period overlaps between patientCondition.onsetDateTime and patientCondition.abatementDateTime</code></p>
<p>In my attempt to write the FHIR equivalent relational retrieve, I thought maybe the <code>between</code> comparison operator seemed appropriate.  I also assumed it was better for me to define the <code>"Patient Diagnosis"</code> retrieve here since I wasn't sure how this part would be written in the <code>"Encounter with Diagnosis"</code> the same way it was done in the QDM example.</p>
<p>Hoping you all can help confirm if these assumptions are correct or if there is a better method to use when two discrete datetimes are to be compared to a period (or even when two discrete datetimes are compared against two other discrete datetimes when an overlap or other interval comparison is needed).</p>
<p>As always, many many thanks!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
