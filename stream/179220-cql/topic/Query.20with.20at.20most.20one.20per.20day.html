---
layout: page
title: "FHIR Chat  · Query with at most one per day · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Query.20with.20at.20most.20one.20per.20day.html">Query with at most one per day</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153967509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Query%20with%20at%20most%20one%20per%20day/near/153967509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Query.20with.20at.20most.20one.20per.20day.html#153967509">(Jun 06 2018 at 16:56)</a>:</h4>
<p>I am having difficulty formulating a query. I need to select a list of data elements but at most one per day (preferably the last one to happen on that date). Any suggestions on how to write this query?</p>



<a name="153967848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Query%20with%20at%20most%20one%20per%20day/near/153967848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Query.20with.20at.20most.20one.20per.20day.html#153967848">(Jun 07 2018 at 14:36)</a>:</h4>
<p>I was never able to find any sort of grouping operator. So I came up with this.</p>
<p>[All Event] except [Events with another event on same day] union ([Events with another event on same day] except [Events with another event on same day that have an event starting after])</p>
<p>So it's all events removing everything that has same day stuff. Then adding back the all of the events that have another on the same day except for the ones that have another later in the day (leaving only the last event of the day).</p>



<a name="153967849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Query%20with%20at%20most%20one%20per%20day/near/153967849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Query.20with.20at.20most.20one.20per.20day.html#153967849">(Jun 07 2018 at 14:40)</a>:</h4>
<p>I don't see a lot of activity or interest here, but I thought I should post what I was able to find anyway. This is an interesting language.</p>



<a name="153967872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Query%20with%20at%20most%20one%20per%20day/near/153967872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Query.20with.20at.20most.20one.20per.20day.html#153967872">(Jun 07 2018 at 19:49)</a>:</h4>
<p>Sorry, this fell off my radar and I forgot to get back to it. :(</p>



<a name="153967874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Query%20with%20at%20most%20one%20per%20day/near/153967874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Query.20with.20at.20most.20one.20per.20day.html#153967874">(Jun 07 2018 at 19:50)</a>:</h4>
<p>Event E return { day: E.day, lastEvent: Last(Event I where I.day = E.day sort by date) }</p>



<a name="153968053"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Query%20with%20at%20most%20one%20per%20day/near/153968053" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Query.20with.20at.20most.20one.20per.20day.html#153968053">(Jun 08 2018 at 15:48)</a>:</h4>
<p>Hey. Thank you!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
