---
layout: page
title: "FHIR Chat  · Running AUDIT CQL in Sample IG · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Running.20AUDIT.20CQL.20in.20Sample.20IG.html">Running AUDIT CQL in Sample IG</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="239594455"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Running%20AUDIT%20CQL%20in%20Sample%20IG/near/239594455" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christa Wan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Running.20AUDIT.20CQL.20in.20Sample.20IG.html#239594455">(May 20 2021 at 13:50)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="194178">@JP</span> <span class="user-mention" data-user-id="195840">@David Winters</span> , </p>
<p>I am trying to run the AUDIT (<a href="https://cds.ahrq.gov/cdsconnect/artifact/alcohol-screening-using-usaudit-alcohol-use-disorders-identification-test">https://cds.ahrq.gov/cdsconnect/artifact/alcohol-screening-using-usaudit-alcohol-use-disorders-identification-test</a>) CQL in the sample-content-ig to build a bundle that can be uploaded to the CQF-Ruler. However, I am running into issues with the ValueSet-db.json where it cannot find resourceType element. Is there a sample of ValueSet-db.json that I could refer to? The FHIRHelper file that we were able to find in the repository (<a href="https://github.com/asbi-cds-tools/asbi-screening-app">https://github.com/asbi-cds-tools/asbi-screening-app</a>) was only available in JSON. Is there a method to convert this to a CQL version (or if there was a CQL version available)? </p>
<p><span class="user-mention" data-user-id="192545">@Alex Goel</span> </p>
<p>Thank you,<br>
Christa</p>



<a name="239600965"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Running%20AUDIT%20CQL%20in%20Sample%20IG/near/239600965" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Winters <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Running.20AUDIT.20CQL.20in.20Sample.20IG.html#239600965">(May 20 2021 at 14:28)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="400829">@Christa Wan</span>.  On <a href="https://github.com/asbi-cds-tools/asbi-screening-app">github</a> we checked in an empty value set json file because there are codes in the value sets which require a UMLS license.  You can find out more at the <a href="https://vsac.nlm.nih.gov/">Value Set Authority Center</a> but you'd need to sign up for a UMLS account, generate an API key, and then run a script to populate the value set json file.  More detailed instructions on this can be found <a href="https://github.com/asbi-cds-tools/asbi-screening-app#download-value-sets-from-vsac">here</a>.</p>



<a name="239601113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Running%20AUDIT%20CQL%20in%20Sample%20IG/near/239601113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Winters <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Running.20AUDIT.20CQL.20in.20Sample.20IG.html#239601113">(May 20 2021 at 14:29)</a>:</h4>
<p>You can find the original FHIRHelper CQL <a href="https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/quick/src/main/resources/org/hl7/fhir/FHIRHelpers-4.0.1.cql">here</a>.</p>



<a name="239601440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Running%20AUDIT%20CQL%20in%20Sample%20IG/near/239601440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Winters <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Running.20AUDIT.20CQL.20in.20Sample.20IG.html#239601440">(May 20 2021 at 14:31)</a>:</h4>
<p>Caveat emptor:  I've never tried running the AUDIT CQL with CQF-Ruler.  Would love to hear how that goes.</p>



<a name="239604257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Running%20AUDIT%20CQL%20in%20Sample%20IG/near/239604257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Winters <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Running.20AUDIT.20CQL.20in.20Sample.20IG.html#239604257">(May 20 2021 at 14:47)</a>:</h4>
<p>I use the javascript <a href="https://github.com/cqframework/cql-execution">cql-execution</a> library to execute the CQL in the AUDIT  SMART app.  You can see how the JSON is used <a href="https://github.com/asbi-cds-tools/cql-worker/blob/main/src/CqlProcessor.js#L22">here</a>, which could be different than what CQF Ruler is expecting.</p>



<a name="239631931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Running%20AUDIT%20CQL%20in%20Sample%20IG/near/239631931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Running.20AUDIT.20CQL.20in.20Sample.20IG.html#239631931">(May 20 2021 at 17:44)</a>:</h4>
<p>Hi Christa!</p>
<p>The cqf-ruler doesn't use the ValueSet-db.json file so you'll need to download the ValueSets and convert them manually. As David mentioned you can get the ValueSets from VSAC, which will export them in excel format. Each ValueSet you export can then be converted to fhir using the cqf-tooling operation that's here:<br>
<a href="https://github.com/cqframework/cqf-tooling/blob/master/src/main/java/org/opencds/cqf/tooling/Main.java#L32">https://github.com/cqframework/cqf-tooling/blob/master/src/main/java/org/opencds/cqf/tooling/Main.java#L32</a></p>
<p>That will output the ValueSets in the FHIR JSON format that the cqf-ruler can use. The ValueSets needed are the ones listed in the .cql file. Let me know if you have further questions. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
