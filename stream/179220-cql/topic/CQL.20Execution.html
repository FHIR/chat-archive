---
layout: page
title: "FHIR Chat  · CQL Execution · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html">CQL Execution</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="178540884"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178540884" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178540884">(Oct 19 2019 at 11:01)</a>:</h4>
<p>Does CQL execute similar to SAS and SQL where it will go down records and execute code against every record? If I have a exists([retrieve] query) will the CQL run the exists for every record from the retrieve &amp; query and only return records that meet the query's criteria or will it just return one Boolean value?</p>



<a name="178541239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178541239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178541239">(Oct 19 2019 at 11:10)</a>:</h4>
<p>The result of <code>exists([retrieve] query)</code> will be a single boolean value, but it the exists will evaluate all the results of the retrieve. A pipelined execution could stop an exists as soon as it saw one record, but that would be an optimization of the engine.</p>



<a name="178543297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178543297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178543297">(Oct 19 2019 at 12:06)</a>:</h4>
<p>Ok thank you for the explanation. I know in some languages each record is evaluated against the code but thats not the case in CQL.</p>



<a name="178651276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178651276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178651276">(Oct 21 2019 at 12:48)</a>:</h4>
<p>Right.  If you see something like <code>exists</code> that takes a <code>List</code> as its argument, the general expectation is that the function operates on the entire list.  How it does so is up to the implementor, however. I think the only place where you're definitely evaluating records one at a time is in the body of the query itself (i.e., <code>such that...</code>, <code>where...</code>, <code>return ...</code>, etc).</p>



<a name="178664097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178664097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178664097">(Oct 21 2019 at 15:06)</a>:</h4>
<p>If you use the exists() on a List it will still just return true or false, correct? It will operate on the entire List but if it finds any elements it returns true. Let's say the first object in the list is there exists() will return true?</p>



<a name="178664655"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178664655" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178664655">(Oct 21 2019 at 15:11)</a>:</h4>
<p>(deleted)</p>



<a name="178665002"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178665002" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178665002">(Oct 21 2019 at 15:14)</a>:</h4>
<p>The author documentation describes it as the opposite of an empty, so if the collection contains an object or record it should return true</p>



<a name="178666013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178666013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178666013">(Oct 21 2019 at 15:25)</a>:</h4>
<p>I think I finally understand even if it contains a null it returns true as long as it isn't empty?</p>



<a name="178669163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178669163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178669163">(Oct 21 2019 at 15:56)</a>:</h4>
<p>I think you've got it mostly right except that last bit.  According to <a href="https://cql.hl7.org/09-b-cqlreference.html#exists" target="_blank" title="https://cql.hl7.org/09-b-cqlreference.html#exists">https://cql.hl7.org/09-b-cqlreference.html#exists</a>,</p>
<blockquote>
<p>The exists operator returns true if the list contains any non-null elements.</p>
</blockquote>
<p>So if you had a list with <em>only</em> <code>null</code>, then exists would return <code>false</code>.  IIRC, this wasn't always the case, but recent versions of CQL clarified it to be so.</p>



<a name="178674498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178674498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178674498">(Oct 21 2019 at 16:53)</a>:</h4>
<blockquote>
<p>I think you've got it mostly right except that last bit.  According to <a href="https://cql.hl7.org/09-b-cqlreference.html#exists" target="_blank" title="https://cql.hl7.org/09-b-cqlreference.html#exists">https://cql.hl7.org/09-b-cqlreference.html#exists</a>,</p>
<blockquote>
<p>The exists operator returns true if the list contains any non-null elements.</p>
</blockquote>
<p>So if you had a list with <em>only</em> <code>null</code>, then exists would return <code>false</code>.  IIRC, this wasn't always the case, but recent versions of CQL clarified it to be so.</p>
</blockquote>
<p>Oh really <span class="user-mention" data-user-id="191469">@Chris Moesel</span> . Please have a look at <a href="http://www.hl7.org/dstucomments/showdetail_comment.cfm?commentid=1875" target="_blank" title="http://www.hl7.org/dstucomments/showdetail_comment.cfm?commentid=1875">http://www.hl7.org/dstucomments/showdetail_comment.cfm?commentid=1875</a> and <a href="https://github.com/HL7/cql/issues/52" target="_blank" title="https://github.com/HL7/cql/issues/52">https://github.com/HL7/cql/issues/52</a>.</p>



<a name="178678195"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178678195" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178678195">(Oct 21 2019 at 17:33)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="197470">@Alexander Kiel</span> -- TBH, I had to look it up myself because I couldn't remember which way it went.  But... it does appear that what I said above is true.  Looking at CQL version history, this was changed in CQL 1.3.0 in response to this comment: <a href="http://www.hl7.org/dstucomments/showdetail_comment.cfm?commentid=1435" target="_blank" title="http://www.hl7.org/dstucomments/showdetail_comment.cfm?commentid=1435">http://www.hl7.org/dstucomments/showdetail_comment.cfm?commentid=1435</a></p>



<a name="178693119"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178693119" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jerry Goodnough <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178693119">(Oct 21 2019 at 20:08)</a>:</h4>
<p>Is there any provision in CQL for associating a library with a canonical URL for that library? I</p>



<a name="178697415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178697415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178697415">(Oct 21 2019 at 20:51)</a>:</h4>
<p>The <a href="https://cql.hl7.org/examples/Example.RelatedContextRetrieve-0.1.0.xml" target="_blank" title="https://cql.hl7.org/examples/Example.RelatedContextRetrieve-0.1.0.xml">Mother Infant Measure</a> example shows how to do this</p>



<a name="178697482"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178697482" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178697482">(Oct 21 2019 at 20:52)</a>:</h4>
<p>Basically, we use the "system" element of the versioned identifier of the library.</p>



<a name="178752296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178752296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178752296">(Oct 22 2019 at 12:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> Thanks for the clarification.</p>



<a name="178776941"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178776941" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jerry Goodnough <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178776941">(Oct 22 2019 at 17:30)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> Thanks... I see it in the elm.xml, but there does not appear to be an equivalent in the CQL representation. Am I blind and missing something?</p>



<a name="178778059"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178778059" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178778059">(Oct 22 2019 at 17:41)</a>:</h4>
<p>You're right Jerry, it's not in the CQL, since it's actually defined outside the context of any particular library. The use in ELM is only a reference and needs to be provided external to the CQL library. The plan is to have it be a parameter to the translator, but that feature isn't yet part of the translator.</p>



<a name="178807297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178807297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jerry Goodnough <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178807297">(Oct 22 2019 at 23:06)</a>:</h4>
<p>So does it make sense to  extend the syntax of the definition to include and optional custodian clause that is followed by a URL?</p>



<a name="178821123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178821123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178821123">(Oct 23 2019 at 04:13)</a>:</h4>
<p>Well, the reason we didn't is because it's not defined per library, it's above the libraries, so we didn't want the possibility of the same namespace having different URLs in different libraries.</p>



<a name="178866717"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178866717" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jerry Goodnough <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178866717">(Oct 23 2019 at 15:42)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span>  Thanks - Is there a clear place besides here that I should note inconsistencies in the 1.4.1 spec?</p>



<a name="178866811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178866811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178866811">(Oct 23 2019 at 15:43)</a>:</h4>
<p>Yes, you can submit STU comments to the specification here: <a href="http://www.hl7.org/dstucomments/showdetail.cfm?dstuid=264" target="_blank" title="http://www.hl7.org/dstucomments/showdetail.cfm?dstuid=264">http://www.hl7.org/dstucomments/showdetail.cfm?dstuid=264</a></p>



<a name="178866934"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178866934" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178866934">(Oct 23 2019 at 15:44)</a>:</h4>
<p>(Which is linked through the "Propose a change" link in the footer of the spec, but not directly, you have to click through the View STU).</p>



<a name="178942327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/178942327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saoji Adhe <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#178942327">(Oct 24 2019 at 11:28)</a>:</h4>
<p>Hi ,<br>
i want to test cqf-ruler-0.1.13-SNAPSHOT.jar with hapi-fhir-3.8 , to test $evaluate-measure<br>
but it's not working with example given by hspc in there documentation<br>
anybody know about where i will get example related to $evaluate-measure, $apply, cds-hooks etc...<br>
Thank you in advance.</p>



<a name="179353806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/179353806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#179353806">(Oct 29 2019 at 17:39)</a>:</h4>
<p>How can someone access the same patient for a procedure in QDM? I know FHIR has procedure.subject but what about QDM?</p>



<a name="179354229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/179354229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#179354229">(Oct 29 2019 at 17:43)</a>:</h4>
<p>In the <code>Patient</code> context, all the data accessed is related to the current patient in context.</p>



<a name="179424955"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/179424955" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#179424955">(Oct 30 2019 at 12:12)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span></p>



<a name="179425053"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/179425053" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#179425053">(Oct 30 2019 at 12:13)</a>:</h4>
<p>So in FHIR the procedure.subject helps to further reference/access the Patient Identifier?</p>



<a name="179631805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CQL%20Execution/near/179631805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CQL.20Execution.html#179631805">(Nov 01 2019 at 14:44)</a>:</h4>
<p>In the patient context, the procedure.subject would be expected to match the current patient context, yes.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
