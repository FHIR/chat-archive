---
layout: page
title: "FHIR Chat  · CDS hook not generating from PlanDefinition · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CDS.20hook.20not.20generating.20from.20PlanDefinition.html">CDS hook not generating from PlanDefinition</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="249024030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CDS%20hook%20not%20generating%20from%20PlanDefinition/near/249024030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CDS.20hook.20not.20generating.20from.20PlanDefinition.html#249024030">(Aug 10 2021 at 19:23)</a>:</h4>
<p>Hi, we wrote a PlanDefinition, Library and ValueSet which can be found here: <a href="https://github.com/PuraJuniper/Ontario-Lung-Cancer-Screening-CCG">https://github.com/PuraJuniper/Ontario-Lung-Cancer-Screening-CCG</a><br>
and posted the PlanDefinition, Library and ValueSet to the CQF-Ruler. </p>
<div class="codehilite"><pre><span></span><code>        {
            &quot;hook&quot;: &quot;patient-view&quot;,
            &quot;name&quot;: &quot;LungCancerScreening&quot;,
            &quot;title&quot;: &quot;LungCancerScreening&quot;,
            &quot;description&quot;: &quot;This PlanDefinition identifies eligibility for lung cancer screening&quot;,
            &quot;id&quot;: &quot;103&quot;
        }
</code></pre></div>
<p>We're hoping for something like this: </p>
<div class="codehilite"><pre><span></span><code>{
&quot;hook&quot;: &quot;patient-view&quot;,
&quot;name&quot;: &quot;Example&quot;,
&quot;title&quot;: &quot;Example&quot;,
&quot;description&quot;: &quot;Example&quot;,
&quot;id&quot;: &quot;plandefinition-Example&quot;,
&quot;prefetch&quot;: {
&quot;item1&quot;: &quot;Patient?_id={{context.patientId}}&quot;,
&quot;item2&quot;: &quot;Observation?subject=Patient/{{context.patientId}}&amp;code=http://loinc.org|55284-4&quot;,
</code></pre></div>
<p>Is this something related to the valueset or is this completely generated from the PlanDefinition? We tried to follow what was here: <a href="https://github.com/DBCG/cqf-ruler/wiki/CDS-Hooks-Request-Processing">https://github.com/DBCG/cqf-ruler/wiki/CDS-Hooks-Request-Processing</a></p>
<p>The CQL tests correctly in Atom</p>



<a name="249106831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CDS%20hook%20not%20generating%20from%20PlanDefinition/near/249106831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CDS.20hook.20not.20generating.20from.20PlanDefinition.html#249106831">(Aug 11 2021 at 13:28)</a>:</h4>
<p>We figured it out. We needed to add the valueset references correctly to the library.</p>



<a name="249412143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/CDS%20hook%20not%20generating%20from%20PlanDefinition/near/249412143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/CDS.20hook.20not.20generating.20from.20PlanDefinition.html#249412143">(Aug 13 2021 at 20:45)</a>:</h4>
<p>We are having an issue with our Hook where the PD is generating a patient request as items 1 and 2. Duplication results in an error for the CQF-Ruler. The request works if we submit Items 1, 3, 4, 5. But we're curious why this duplication might of happened. </p>
<div class="codehilite"><pre><span></span><code>{
            &quot;hook&quot;: &quot;patient-view&quot;,
            &quot;name&quot;: &quot;LungCancerScreening&quot;,
            &quot;title&quot;: &quot;LungCancerScreening&quot;,
            &quot;description&quot;: &quot;This PlanDefinition identifies eligibility for lung cancer screening&quot;,
            &quot;id&quot;: &quot;plandefinition-LungCancerScreening&quot;,
            &quot;prefetch&quot;: {
                &quot;item1&quot;: &quot;Patient?_id={{context.patientId}}&quot;,
                &quot;item2&quot;: &quot;Patient?_id=Patient/{{context.patientId}}&quot;,
                &quot;item3&quot;: &quot;Observation?subject=Patient/{{context.patientId}}&amp;code=http://loinc.org|72166-2&quot;,
                &quot;item4&quot;: &quot;Condition?patient=Patient/{{context.patientId}}&amp;code=http://snomed.info/sct|363358000&quot;,
                &quot;item5&quot;: &quot;Observation?subject=Patient/{{context.patientId}}&amp;code=http://loinc.org|8663-7&quot;
            }
</code></pre></div>
<p>Link to our PD: <a href="https://github.com/PuraJuniper/Ontario-Lung-Cancer-Screening-CCG/blob/main/input/resources/plandefinition/plandefinition-LungCancerScreening.json">https://github.com/PuraJuniper/Ontario-Lung-Cancer-Screening-CCG/blob/main/input/resources/plandefinition/plandefinition-LungCancerScreening.json</a><br>
Link to our CQL: <a href="https://github.com/PuraJuniper/Ontario-Lung-Cancer-Screening-CCG/blob/main/input/cql/LungCancerScreening.cql">https://github.com/PuraJuniper/Ontario-Lung-Cancer-Screening-CCG/blob/main/input/cql/LungCancerScreening.cql</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
