---
layout: page
title: "FHIR Chat  · ValueSet without expansion? · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ValueSet.20without.20expansion.3F.html">ValueSet without expansion?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="227856504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ValueSet%20without%20expansion%3F/near/227856504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ValueSet.20without.20expansion.3F.html#227856504">(Feb 25 2021 at 23:21)</a>:</h4>
<p>When using $evaluate-measure with a ValueSet, if no expansion is provided in the ValueSet, does it try to figure out the expansion? Or, does CQF-Ruler require that any ValueSet referenced by CQL already have the ValueSet.expansion populated?</p>



<a name="227864770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ValueSet%20without%20expansion%3F/near/227864770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ValueSet.20without.20expansion.3F.html#227864770">(Feb 26 2021 at 00:47)</a>:</h4>
<p>The $evaluate-measure operation recently (as of HAPI 5.3.0) moved from the cqf-ruler (which is a set of plugins for HAPI) and was put into the hapi-fhir-jpaserver-cql project. That means that the cqf-ruler is no longer in the picture for $evaluate-measure. The hapi-fhir server now supports $evaluate-measure natively.</p>



<a name="227864961"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ValueSet%20without%20expansion%3F/near/227864961" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ValueSet.20without.20expansion.3F.html#227864961">(Feb 26 2021 at 00:49)</a>:</h4>
<p>The hapi-fhir server currently always ignores the ValueSet.expansion element, even if it's supplied on the resource. It will always attempt to compute the ValueSet expansion based on the available CodeSystems.</p>



<a name="227865096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ValueSet%20without%20expansion%3F/near/227865096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ValueSet.20without.20expansion.3F.html#227865096">(Feb 26 2021 at 00:50)</a>:</h4>
<p>There's an issue on the hapi-fhir git repo tracking adding support for the ValueSet.expansion element:</p>
<p><a href="https://github.com/hapifhir/hapi-fhir/issues/2376">https://github.com/hapifhir/hapi-fhir/issues/2376</a></p>



<a name="227865289"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ValueSet%20without%20expansion%3F/near/227865289" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ValueSet.20without.20expansion.3F.html#227865289">(Feb 26 2021 at 00:52)</a>:</h4>
<p>Because the ValueSet expansions are always computed you'll need appropriate CodeSystems loaded in order to do the expansion.</p>



<a name="228001045"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/ValueSet%20without%20expansion%3F/near/228001045" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/ValueSet.20without.20expansion.3F.html#228001045">(Feb 26 2021 at 21:55)</a>:</h4>
<p>Thanks for the explanation <span class="user-mention" data-user-id="194178">@JP</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
