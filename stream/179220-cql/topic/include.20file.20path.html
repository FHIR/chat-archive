---
layout: page
title: "FHIR Chat  · include file path · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html">include file path</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="191781872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/191781872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Whitley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#191781872">(Mar 25 2020 at 17:22)</a>:</h4>
<p>Is there a way to specify an the path of an included library?  </p>
<p>EX: I have several different measures in subdirectories and have a common library <code>MySharedStuff</code></p>
<ul>
<li>/Measure1/Measure1.cql</li>
<li>/Measure2/Measure2.cql</li>
<li>/Shared/MySharedStuff.cql</li>
</ul>
<p>What I want to do is have those individual measures be able to include the MySharedStuff library .</p>
<p>The examples I've seen for includes seem to assume that all of the files are in the same directory as there's no reference to a path.</p>
<p>Do I need to copy all shared files into each measure subdirectory or is there a way to refer to the library's path?</p>
<p>EX: <code>include "../Shared/MyShredStuff" version '1' called MySharedStuff</code></p>
<p>Any direction very much appreciated</p>



<a name="191803177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/191803177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#191803177">(Mar 25 2020 at 19:58)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="245789">@Eric Whitley</span> -- the CQL spec only allows for libraries to be included by their name and identifier.  It assumes that these are unique and that the implementing system has a mechanism for resolving them.  How they get resolved is considered an implementation detail not covered by the spec.  The spec itself doesn't say much about this, but there is a little blurb in the <a href="https://cql.hl7.org/07-physicalrepresentation.html#library-references" title="https://cql.hl7.org/07-physicalrepresentation.html#library-references">Physical Representation</a> section of the doc:</p>
<blockquote>
<p>The implementation environment must provide a mechanism for library references to be resolved based on their names and versions.</p>
</blockquote>



<a name="191803470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/191803470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#191803470">(Mar 25 2020 at 20:00)</a>:</h4>
<p>The reference implementation CQL-to-ELM translator, however, does have a specific approach to library resolution -- and if I recall, that approach requires all libraries to (a) have a a file name matching the library name, and (b) be in the same folder.  <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> can confirm or deny that one, however, as he's the primary maintainer of that code.</p>



<a name="191805778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/191805778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Whitley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#191805778">(Mar 25 2020 at 20:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> I really appreciate you taking the time to answer my question. That makes sense. I was trying to wrap my head around how that would be handled based on the docs. As I think about that now it actually makes way more sense. I was coming at it from the perspective of "script A is here and script B is here" and the resolution is in the script, but it seems like it's more like "library A is used" and then whatever tooling you're using is responsible for resolving where that version of the code is stored. Thanks again - I appreciate you explaining that.</p>



<a name="191808895"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/191808895" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#191808895">(Mar 25 2020 at 20:48)</a>:</h4>
<p><span class="user-mention" data-user-id="245789">@Eric Whitley</span> , yes Chris is right, the translator has a default implementation that assumes current directory, but it defines a LibrarySourceProvider interface that environments are expected to provide an implementation for. In the Atom plugin, we're just using the default resolver, so we typically organize around a single CQL directory. For example, in the connectathon repository: <a href="https://github.com/DBCG/connectathon/tree/master/fhir3/input/pagecontent/cql" title="https://github.com/DBCG/connectathon/tree/master/fhir3/input/pagecontent/cql">https://github.com/DBCG/connectathon/tree/master/fhir3/input/pagecontent/cql</a></p>



<a name="191808963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/191808963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#191808963">(Mar 25 2020 at 20:48)</a>:</h4>
<p>Within an environment like a FHIR server plugin, we have a resolver that actually references the Library resources available in the server to resolve libraries, and that happens by the canonical URL of the library (which is constructed from the name of the library).</p>



<a name="191810851"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/191810851" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Whitley <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#191810851">(Mar 25 2020 at 21:04)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="191469">@Chris Moesel</span>  and <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> . This is incredibly helpful. I really appreciate your responses on this. Helps me better understand how to approach thinking about this.</p>



<a name="194943589"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/194943589" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#194943589">(Apr 22 2020 at 14:56)</a>:</h4>
<p>Is filtering in CQL hash based or loop based? In terms of the Patient Context.</p>



<a name="194970267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/194970267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#194970267">(Apr 22 2020 at 18:10)</a>:</h4>
<p>The CQL specification itself doesn't prescribe how filtering is implemented, that's up to the implementation and depends on a lot of different factors. In the Java-based engine, the patient context filtering is passed to the data access layer, either using the subject parameter of a FhIR URL, or the equivalent subject parameter in the JPA layer of a HAPI FHIR server if it's running in process.</p>



<a name="194983584"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/194983584" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#194983584">(Apr 22 2020 at 19:58)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> !</p>



<a name="194992248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/194992248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#194992248">(Apr 22 2020 at 21:14)</a>:</h4>
<p>In the CoffeeScript/JavaScript cql-execution project, filtering is loop-based.  For example, <code>[Condition: "Diabetes"] C where C.status.value = 'active'</code> will loop through all Conditions in the passed in bundle, checking for conditions whose code is in the "Diabetes" VS and whose status is active.  It's not a very efficient approach, but it does allow CQL to be executed without a database backend.</p>



<a name="195005834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/195005834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#195005834">(Apr 23 2020 at 00:04)</a>:</h4>
<p>O ok, I was curious because someone I work with was concerned about Big O. Thanks <span class="user-mention" data-user-id="191469">@Chris Moesel</span> !</p>



<a name="195113074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/include%20file%20path/near/195113074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Afaq Khan <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/include.20file.20path.html#195113074">(Apr 23 2020 at 20:08)</a>:</h4>
<p>CHEF BRYN lol put us on a diet jk. #Chef’sGotTheFHIR</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
