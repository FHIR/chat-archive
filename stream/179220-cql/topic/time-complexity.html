---
layout: page
title: "FHIR Chat  · time-complexity · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/time-complexity.html">time-complexity</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="246270993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/time-complexity/near/246270993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marisa Hoenig <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/time-complexity.html#246270993">(Jul 16 2021 at 19:57)</a>:</h4>
<p>Does anyone know if there's information about the time complexity of CQL functions? I haven't been able to find anything.</p>
<p>Specifically, our application runs several functions that loop through long lists of valuesets to try to find a match, and we have a theory that this may be impacting our app's initial load time since it waits for CQL to finish running.</p>



<a name="246281856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/time-complexity/near/246281856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/time-complexity.html#246281856">(Jul 16 2021 at 21:21)</a>:</h4>
<p>CQL only rarely prescribes the specific algorithm for implementing operations or functions. That means that the time-complexity of a given function is frequently implementation specific. The Java engine doesn't have that information published anywhere, nor do I think we've actually done the analysis except in cases where we have seen performance hotspots.</p>
<p>If you're using the Java engine and can give me a repro  I'd be happy to take a look at it for you. I have less familiarity with the JS engine.</p>



<a name="246284437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/time-complexity/near/246284437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marisa Hoenig <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/time-complexity.html#246284437">(Jul 16 2021 at 21:46)</a>:</h4>
<p>Thanks JP. We will likely try to do some analysis ourselves since we think it might have to do with the number of codes we're looping through. We're using the JS engine and specifically talking about functions like these if you'd like to take a look: <a href="https://github.com/chronic-care/covid-ed-ig/blob/4af9853775a4241b1e267e7b10cdcf9f9b674a5d/input/cql/COVID19EmergencyDeptAssessment.cql#L638-L644">https://github.com/chronic-care/covid-ed-ig/blob/4af9853775a4241b1e267e7b10cdcf9f9b674a5d/input/cql/COVID19EmergencyDeptAssessment.cql#L638-L644</a></p>



<a name="246285900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/time-complexity/near/246285900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/time-complexity.html#246285900">(Jul 16 2021 at 22:01)</a>:</h4>
<p>A simple implementation of that would be ~ O(N * M) where N is the number of active conditions and M is the number of code in the set you're checking against, so it'd be pretty expensive.  I _think_ that's what the JS engine is doing here:</p>
<p><a href="https://github.com/cqframework/cql-execution/blob/96b472a3633f4389a4745b1b88e768c2b74cc50a/src/datatypes/clinical.js#L51">https://github.com/cqframework/cql-execution/blob/96b472a3633f4389a4745b1b88e768c2b74cc50a/src/datatypes/clinical.js#L51</a></p>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> ?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
