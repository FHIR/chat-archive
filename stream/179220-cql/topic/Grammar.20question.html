---
layout: page
title: "FHIR Chat  · Grammar question · cql"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/index.html">cql</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Grammar.20question.html">Grammar question</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="215949947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Grammar%20question/near/215949947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Adrian <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Grammar.20question.html#215949947">(Nov 07 2020 at 11:05)</a>:</h4>
<p>In the .g4 grammar for CQL,  the library statement's identifier is required to be a qualified identifier production and the ANTLR parser built from this grammar  seems to accept a qualified identifier of the form X.Y.Z.libraryName. However, there are no examples in the CQL spec where the library name is shown to be anything other than a simple identifier and when I try to use a qualified identifier in language processors presumably built on this syntax, a syntax error is thrown when one tries to use a qualified identifier in this context. Why is a qualified identifier production specified instead of a library identifier or a simple identifier production in the grammar, if the end result is an error message anyway?</p>



<a name="216295861"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Grammar%20question/near/216295861" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Grammar.20question.html#216295861">(Nov 11 2020 at 00:59)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="336710">@Frank Adrian</span>, qualified library identifiers were introduced in CQL 1.3 to support namespacing, but the environment that's translating the CQL has to provide the namespace information (because you can't declare it in a CQL library, it's necessarily outside the CQL. It shouldn't give you an error though, can you give some more details on what error you are seeing?</p>



<a name="216298038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179220-cql/topic/Grammar%20question/near/216298038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Adrian <a href="https://fhir.github.io/chat-archive/stream/179220-cql/topic/Grammar.20question.html#216298038">(Nov 11 2020 at 01:33)</a>:</h4>
<p>What I'm seeing is an inconsistency in the documentation and the .g4<br>
grammar.<br>
The ANTLR grammar defines the libraryDefinition as:<br>
libraryDefinition<br>
    : 'library' qualifiedIdentifier ('version' versionSpecifier)?<br>
    ;<br>
However, if you actually use a qualifiedIdentifier like<br>
AQualifier.MyLibName in this context, the compiler throws an error<br>
(Something about a syntax error at the "." which makes sense as there is no<br>
valid semantic meaning for a library name that is qualified as the main<br>
library name in the library declaration proper). This check seems to be<br>
done somewhere in the semantic checking for the CQL compiler. My question<br>
is whether or not this is the proper type of identifier production to be<br>
used in this context in the grammar. The unqualified libraryIdentifier<br>
production would work as well in this particular context and be clearer as<br>
to what is accepted legally in the language. I might be missing some<br>
semantic meaning of a library statement like "library AQualifier.MyLibrary<br>
version '2'", but I don't think so as there are no examples like this in<br>
the CQL standard and it's prohibited by something in the compiler anyway.<br>
So what was the rationale behind using a qualifiedIdentifier in this<br>
context rather than an unqualified libraryIdentifier? The code seems to go<br>
through more work to limit the identifier in this context and,<br>
grammar-wise, it's misleading at best.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
