---
layout: page
title: "FHIR Chat  · slicing dose[x] · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html">slicing dose[x]</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153900871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153900871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153900871">(Aug 08 2017 at 11:40)</a>:</h4>
<p>I'm trying to slice medicationStatement.dosage.dose[x] into ...doseRange and ...doseSimpleQuantity, so I can apply different constraints to there types, but somehow Forge doesn't seem to like that (I can't define a discriminator).<br>
Who's wrong? Me or Forge?</p>



<a name="153901046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153901046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153901046">(Aug 08 2017 at 20:12)</a>:</h4>
<p>I think there's generally something wrong here...<br>
I get funny validation errors, even though I didn't constrain anything:</p>
<p>Element 'MedicationStatement.dosage.doseQuantity' : 'doseQuantity' has an invalid type profile constraint '<a href="http://hl7.org/fhir/StructureDefinition/SimpleQuantity" target="_blank" title="http://hl7.org/fhir/StructureDefinition/SimpleQuantity">http://hl7.org/fhir/StructureDefinition/SimpleQuantity</a>'. The target represents a profile on 'Quantity' which is incompatible with the element type 'Quantity'.</p>



<a name="153901107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153901107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153901107">(Aug 09 2017 at 09:22)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191450">@Simone Heckmann</span>, thank you for the feedback. I've tried to recreate your profile in Forge. Initially, this seems to work fine. But after re-loading the profile, Forge displays warnings about the SimpleQuantity slice and does not expand the child elements. This is a bug. I'll investigate the issue.</p>



<a name="153901113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153901113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153901113">(Aug 09 2017 at 09:31)</a>:</h4>
<p>Interestingly, Simplifier also has issues rendering the Profile correctly.<br>
When you scoll to the bottom of this profile (<a href="https://simplifier.net/medikationsplanplus/medicationstatement-1" target="_blank" title="https://simplifier.net/medikationsplanplus/medicationstatement-1">https://simplifier.net/medikationsplanplus/medicationstatement-1</a>), you see two attributes called "SimpleQuantity" which should actually be maxDosePerAdministration and maxDosePerLifetime.<br>
I can see in Forge that the two attributes have a SliceName of "SimpleQuantity", but I don't really understand why that is...<br>
That's definitely coming from the core definition.</p>



<a name="153901115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153901115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153901115">(Aug 09 2017 at 09:47)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191450">@Simone Heckmann</span>, yes something's strange is going on here. The core definition of Dosage does not specify any slice names, so apparently they are being added by the snapshot generator. This is a bug that we'll have to fix in the .NET FHIR API library.</p>



<a name="153901610"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153901610" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153901610">(Aug 10 2017 at 14:34)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191450">@Simone Heckmann</span>, I analyzed the issue. It turns out that the SimpleQuantity core definition introduces a slice name "SimpleQuantity" on the root element definition. This appears to be a bug in the spec that causes tooling issues downstream.<br>
I've updated the .NET FHIR API to detect and remove unexpected and invalid slice names on core definitions and/or root elements. This workaround will be included in the next Forge release, so users don't suffer from this error in the current version of the spec. Once the spec has been updated, we can deprecate the workaround.</p>



<a name="153901697"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153901697" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153901697">(Aug 10 2017 at 18:27)</a>:</h4>
<p>Thanks Michel, you're awesome <img alt=":heart:" class="emoji" src="/static/generated/emoji/images/emoji/unicode/2764.png" title=":heart:"></p>



<a name="153902054"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/slicing%20dose%5Bx%5D/near/153902054" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/slicing.20dose.5Bx.5D.html#153902054">(Aug 11 2017 at 08:44)</a>:</h4>
<p>You're welcome! <img alt=":kissing_smiling_eyes:" class="emoji" src="/static/generated/emoji/images/emoji/unicode/1f619.png" title=":kissing_smiling_eyes:"></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
