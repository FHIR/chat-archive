---
layout: page
title: "FHIR Chat  · eld-13 · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html">eld-13</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153909877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153909877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153909877">(Sep 22 2017 at 07:55)</a>:</h4>
<p>Is there something wrong with the definition of invariant eld-13<br>
<code>type.select(code&amp;profile&amp;targetProfile).isDistinct()</code><br>
The &amp; is a string concatenation of uri values, and then distinct on that.</p>



<a name="153909878"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153909878" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153909878">(Sep 22 2017 at 08:07)</a>:</h4>
<p>as select excepts a collection it seems to be wrong. Correct term would be:<br>
<code>type.select(code,profile,targetProfile).isDistinct()</code><br>
The current invariant always resolves to a<code>{ }</code> collection after the type select, an then the isDistinct always returns true.</p>



<a name="153909937"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153909937" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153909937">(Sep 22 2017 at 15:41)</a>:</h4>
<p>Why would that be wrong?</p>



<a name="153910059"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153910059" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153910059">(Sep 23 2017 at 13:52)</a>:</h4>
<p>i'm no Fhirpath expert at all, but as pointed out by brian <code>&amp;</code>is a String concat.<br>
Imaginary Example:<br>
<code>&lt;code value="HumanName" /&gt;
        &lt;profile value="http://fhir.de/StructureDefinition/humanname-de-basis" /&gt;</code><br>
given the existing eld-13 this will evaluate to:<br>
<code>type.select(HumanNamehttp://fhir.de/StructureDefinition/humanname-de-basis).isDistinct()</code><br>
--&gt; the select returns an empty collection --&gt; <code>{ }.isDistinct()</code>--&gt; <code>true</code></p>



<a name="153910687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153910687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153910687">(Sep 26 2017 at 13:52)</a>:</h4>
<p>after some more reading in the FHIRPath Spec i assume i missed the collection brackets.<br>
<code>type.select({code,profile,targetProfile}).isDistinct()</code>is my best guess for the corrected invariant</p>



<a name="153910699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153910699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153910699">(Sep 26 2017 at 13:59)</a>:</h4>
<p>right.....did <code>type.select(code,profile,targetProfile).isDistinct()</code> not trigger an error (incorrect number of parameters) from the evaluator you are using?</p>



<a name="153910706"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153910706" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stefan Lang <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153910706">(Sep 26 2017 at 14:18)</a>:</h4>
<p>To my understanding (and I'm not a FHIRPath expert either), the current version of eld-13, using Patrick's example, would evaluate to</p>
<div class="codehilite"><pre><span></span>type.select(HumanNamehttp://fhir.de/StructureDefinition/humanname-de-basis).isDistinct()
</pre></div>


<p>while Patrick's version would evaluate to</p>
<div class="codehilite"><pre><span></span>type.select([&#39;HumanName&#39;, &#39;http://fhir.de/StructureDefinition/humanname-de-basis&#39;, null]).isDistinct()
</pre></div>


<p>IMHO this should result in the same behavior, but the string concatenated version has the caveat that it hypothetically might find duplicates where there are none.<br>
E.g. </p>
<div class="codehilite"><pre><span></span>&lt;code value=&quot;HumanName&quot; /&gt;
        &lt;targetProfile value=&quot;http://fhir.de/StructureDefinition/humanname-de-basis&quot; /&gt;
</pre></div>


<p>would have the same string result as Patrick's example. That, at least would be wrong.</p>



<a name="153910712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153910712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153910712">(Sep 26 2017 at 14:25)</a>:</h4>
<p>i did the validation via HAPI 2.5 (validation the whole StrucDef), i just tried:<br>
<code>&lt;type&gt;
        &lt;code value="Address" /&gt;
        &lt;profile value="http://fhir.de/StructureDefinition/address-de-basis" /&gt;
        &lt;targetProfile value="http://fhir.de/StructureDefinition/address-de-basis"/&gt;
      &lt;/type&gt;</code><br>
with the current eld-13 and it doesn't fail.<br>
I still assume because:<br>
<code>type.select(http://fhir.de/StructureDefinition/address-de-basishttp://fhir.de/StructureDefinition/humanname-de-basis).isDistinct()</code> --&gt; <code>{ }.isDistinct()</code> --&gt; <code>true</code></p>



<a name="153910734"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153910734" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stefan Lang <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153910734">(Sep 26 2017 at 15:05)</a>:</h4>
<p>I wouldn't expect an element with only one type to fail eld-13, so returning true seems correct to me</p>



<a name="153910916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/eld-13/near/153910916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/eld-13.html#153910916">(Sep 27 2017 at 09:18)</a>:</h4>
<p>i got confused an thought that the FHIR Path Expression was on Elementdefinition.type<br>
I now see, that it evaluates the distinctness of the Elements of a resource. Than the expression makes sense the way it is. The only theoretical problem was pointed out by Stefan. Sorry for the confusion.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
