---
layout: page
title: "FHIR Chat  · Constraining Choice to Single Type · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html">Constraining Choice to Single Type</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="182503469"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/182503469" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#182503469">(Dec 03 2019 at 22:24)</a>:</h4>
<p>If we constrain a choice to a single type (e.g., <code>value[x]</code> to be only <code>Quantity</code>), I don't believe we need to slice; we just remove all but the <code>Quantity</code> type from the <code>value[x]</code> element's <code>type</code> array (please correct me if I'm wrong).  Assuming that to be true, does the differential renaming approach (explained in <a href="https://blog.fire.ly/2019/09/13/type-slicing-in-fhir-r4/" target="_blank" title="https://blog.fire.ly/2019/09/13/type-slicing-in-fhir-r4/">this Firely blog</a>) still apply?  Should the snapshot path/id remain <code>value[x]</code> but the differential be renamed to <code>valueQuantity</code>?  Or do they both remain <code>value[x]</code> only?</p>



<a name="182511815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/182511815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#182511815">(Dec 04 2019 at 00:04)</a>:</h4>
<p>the differential can be either</p>



<a name="201958428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/201958428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#201958428">(Jun 25 2020 at 11:47)</a>:</h4>
<p>Building on this question, would this be the right way to express this:</p>
<div class="codehilite"><pre><span></span><code>    <span class="s2">&quot;differential&quot;</span><span class="err">:</span> <span class="p">{</span>
        <span class="nt">&quot;element&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;binding&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;strength&quot;</span><span class="p">:</span> <span class="s2">&quot;required&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;valueSet&quot;</span><span class="p">:</span> <span class="s2">&quot;https://bb/ValueSet/BBDemographicAgeUnit&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Observation.value[x]&quot;</span><span class="p">,</span>
                <span class="nt">&quot;min&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Observation.value[x]&quot;</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;Quantity&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span><span class="err">,</span>
</code></pre></div>


<p>I think it is, but the Java validator doesn't flag it as an error if I use a type other than Quantity.</p>
<p>Just want to make sure my logic is correct before I add a test case..</p>



<a name="201958459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/201958459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#201958459">(Jun 25 2020 at 11:47)</a>:</h4>
<p>(The above is in a SD that has a baseDefinition of <code>http://hl7.org/fhir/StructureDefinition/Observation</code> )</p>



<a name="201963014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/201963014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#201963014">(Jun 25 2020 at 12:40)</a>:</h4>
<p>Based on my understanding, given that the element is <em>not</em> a slice, it defines the root <code>value[x]</code> element.  So it indicates that _only_ <code>Quantity</code> is allowed as a value in this Observation -- and any other value type is a violation.  But I won't be offended if you wait for <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> to confirm.</p>



<a name="201963852"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/201963852" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#201963852">(Jun 25 2020 at 12:48)</a>:</h4>
<p>I agree. A test case would be good</p>



<a name="201970043"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/201970043" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#201970043">(Jun 25 2020 at 13:41)</a>:</h4>
<p>Thanks! Will do.</p>



<a name="202041498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/202041498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#202041498">(Jun 26 2020 at 00:28)</a>:</h4>
<p>ok. can you approve the changes at <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/261">https://github.com/hapifhir/org.hl7.fhir.core/pull/261</a></p>



<a name="202042860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Constraining%20Choice%20to%20Single%20Type/near/202042860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Constraining.20Choice.20to.20Single.20Type.html#202042860">(Jun 26 2020 at 00:57)</a>:</h4>
<p>this bug is fixed in the next version being released soon</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
