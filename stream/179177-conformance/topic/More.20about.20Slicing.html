---
layout: page
title: "FHIR Chat  · More about Slicing · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html">More about Slicing</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="171996449"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/171996449" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#171996449">(Jul 30 2019 at 00:58)</a>:</h4>
<p>See this thread: <a href="#narrow/stream/179239-tooling/topic/IG.20Publisher.20-.20Inconsistency.20in.20displaying.20snapshot" title="#narrow/stream/179239-tooling/topic/IG.20Publisher.20-.20Inconsistency.20in.20displaying.20snapshot">https://chat.fhir.org/#narrow/stream/179239-tooling/topic/IG.20Publisher.20-.20Inconsistency.20in.20displaying.20snapshot</a></p>



<a name="171996468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/171996468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#171996468">(Jul 30 2019 at 00:59)</a>:</h4>
<ul>
<li>the base profile slices an element (open, disciminated by a sub-element)</li>
<li>it defines some constraints on all slices </li>
<li>it defines one slice with a constraint on the sub-element</li>
</ul>



<a name="171996472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/171996472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#171996472">(Jul 30 2019 at 00:59)</a>:</h4>
<ul>
<li>the derived profile imposes a must-support on the element</li>
</ul>



<a name="171996535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/171996535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#171996535">(Jul 30 2019 at 01:00)</a>:</h4>
<p>it doesn't say anything about slicing. It presumably means that the must-support applies to the element, and therefore to all the slices defined on the element. I'm not sure we've discussed this particular scenario?</p>



<a name="171997598"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/171997598" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Uday Chandrupatla <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#171997598">(Jul 30 2019 at 01:26)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Just wondering should it be a candidate for GForge?</p>



<a name="171997622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/171997622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#171997622">(Jul 30 2019 at 01:27)</a>:</h4>
<p>not at the moment. Don't know what the issue is</p>



<a name="171997663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/171997663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#171997663">(Jul 30 2019 at 01:28)</a>:</h4>
<p>there's a really thorny thing here - the implication is that a given element has 2 ancestors, and I don't know how to make that work</p>



<a name="172017071"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172017071" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172017071">(Jul 30 2019 at 08:36)</a>:</h4>
<p>Trying to understand the scenario. Is this about how to compute/validate the set of constraints on the named slice in the (snapshot of) the derived profile?</p>



<a name="172022109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172022109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172022109">(Jul 30 2019 at 09:52)</a>:</h4>
<p>No it’s about how to generate the snapshot in this case</p>



<a name="172023353"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172023353" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172023353">(Jul 30 2019 at 10:08)</a>:</h4>
<p>FYI, the .NET SnapshotGenerator does NOT try to merge constraints on slice introduction with constraints on named slices. If a resource element matches a named slice, then I assume that the validator verifies the element against the constraints for the matching named slice, and also against any common constraints specified by the slice introduction element.</p>



<a name="172023502"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172023502" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172023502">(Jul 30 2019 at 10:10)</a>:</h4>
<p>I remember that we have discussed merging common constraints specified by a slice group onto all named child slices, however I never got around to actually implementing this behavior in the .NET SnapshotGenerator. This is very hard to support in Forge, as the application would need to harmonize live changes to slice groups to all child slices. Theoretically possible, but quite hard in practice, especially gracefully dealing with all kinds of boundary conditions (i.e. report/merge conflicting constraints?).</p>



<a name="172023982"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172023982" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172023982">(Jul 30 2019 at 10:18)</a>:</h4>
<p>I think it’s really complex. Imagine that the child profile profiles the unsliced element, and it also profiles the slice. The slice now inherits properties from 3 different elements - in what order? Nuts....</p>



<a name="172024001"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172024001" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172024001">(Jul 30 2019 at 10:18)</a>:</h4>
<p>From a tooling point, we should say that if the base slices, then the derived profiles have to constrain the slices as well as the unsliced</p>



<a name="172024244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172024244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172024244">(Jul 30 2019 at 10:23)</a>:</h4>
<p>Indeed. By not merging slice group constraints onto named slices, the .NET SnapshotGenerator completely ducks the multiple-inheritance issue - instead, leaving it up to the validator.  This shifts more work to validator implementations, but also allows validators to report on potentially conflicts between constraints from different origins (slice group vs. named slice).</p>



<a name="172024383"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172024383" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172024383">(Jul 30 2019 at 10:25)</a>:</h4>
<p>SnapshotGenerator implementations always need to merge constraints in a specific, well-defined order. However validators can verify an element against any number of constraint sets, in any order and simply report all violations.</p>



<a name="172028791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172028791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172028791">(Jul 30 2019 at 11:36)</a>:</h4>
<p>hah. the validator doesn't handle must-support, which is the question here.</p>



<a name="172028815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172028815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172028815">(Jul 30 2019 at 11:37)</a>:</h4>
<p><span class="user-mention" data-user-id="192202">@Uday Chandrupatla</span> - what you're trying to isn't going to be supported - you have to put must-support on the slice too</p>



<a name="172037791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172037791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172037791">(Jul 30 2019 at 13:32)</a>:</h4>
<p>If your snapshot builder doesn't handle multiple parents, how do you handle the multiple type.profile constraints?  Yes, absolutely there are multiple "parents" for an element:</p>
<ul>
<li>the "local" parent - the slice parent in this profile</li>
<li>the "base" parent - the same slice in the base profile</li>
<li>the "type" parent(s) - the element in any attached type profiles</li>
</ul>
<p>The "path" of snapshot aggregation will weave it's way thru these.</p>



<a name="172037899"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172037899" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172037899">(Jul 30 2019 at 13:34)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span> <span class="user-mention" data-user-id="191336">@Michel Rutten</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ^^</p>



<a name="172039493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172039493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172039493">(Jul 30 2019 at 13:55)</a>:</h4>
<p><span class="user-mention" data-user-id="191351">@Chris Grenz</span>, the .NET SnapshotGenerator aggregates element constraints from:<br>
1) associated element in the base profile (if any)<br>
2) external type profile, specified by the element itself or inherited from base element<br>
3) any other constraints specified by the element itself<br>
In the specified order, from lowest to highest priority.<br>
As I mentioned before, the .NET SnapshotGenerator (and Forge) does NOT aggregate common constraints specified on a sliced element onto the associated concrete named slices. Assumption is that validators will verify slice elements in a resource instance against both sets of constraints; (1) common constraints specified by the slice intro and (2) specific constraints specified by a matching named slice.</p>



<a name="172040080"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172040080" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172040080">(Jul 30 2019 at 14:02)</a>:</h4>
<p>What about sub-slices (reslices)?</p>



<a name="172040397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172040397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172040397">(Jul 30 2019 at 14:04)</a>:</h4>
<p>And multiple type profiles?</p>



<a name="172041889"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172041889" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172041889">(Jul 30 2019 at 14:19)</a>:</h4>
<p>According to the spec about <code>.type.profile</code> and <code>.type.targetProfile</code>, "one must apply":<br>
<a href="http://hl7.org/fhir/elementdefinition.html#definition" target="_blank" title="http://hl7.org/fhir/elementdefinition.html#definition">http://hl7.org/fhir/elementdefinition.html#definition</a><br>
Also:<br>
<a href="http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.type.profile" target="_blank" title="http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.type.profile">http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.type.profile</a><br>
"If any profiles are specified, then the content must conform to at least one of them."<br>
The .NET SnapshotGenerator only aggregates constraints from a <em>single</em> type profile, not if an element specifies multiple type profiles.</p>



<a name="172042068"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172042068" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172042068">(Jul 30 2019 at 14:21)</a>:</h4>
<p>Re-slices aggregate constraints similarly:<br>
1) associated (re)slice element in base profile<br>
2) external type profile<br>
3) other constraints specified by the reslice element itself</p>



<a name="172042335"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172042335" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172042335">(Jul 30 2019 at 14:23)</a>:</h4>
<p>(FYI if I recall correctly, implementing support for reslicing did not require a lot of custom logic. Mainly to find the correct matching base element. However constraint aggregation is similar/equal.)</p>



<a name="172042347"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172042347" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172042347">(Jul 30 2019 at 14:23)</a>:</h4>
<p>I think that's ok for validation constraints, but I think it's broken for the descriptive elements.</p>



<a name="172042760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172042760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172042760">(Jul 30 2019 at 14:27)</a>:</h4>
<p>Might be... Must confess that I have yet to find a real-life end user scenario that requires complex, deeply nested aggregation/concatenation of descriptive constraints. Many profiles we see in the wild do not specify any user-readable content at all :/</p>



<a name="172045806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/More%20about%20Slicing/near/172045806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/More.20about.20Slicing.html#172045806">(Jul 30 2019 at 14:57)</a>:</h4>
<p>You haven't had me as a client very long yet! ;)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
