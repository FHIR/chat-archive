---
layout: page
title: "FHIR Chat  · Can a derived profile insert new named slices? · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html">Can a derived profile insert new named slices?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153966708"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153966708" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153966708">(Jun 04 2018 at 17:07)</a>:</h4>
<p>I am trying to fix some reported Forge issues and need a bit of clarification on new named slices in derived profiles.</p>
<p>A derived profile can introduce new named slices to an existing slice group.<br>
By default, the new slices are appended to the existing named slices in the base profile.</p>
<p>Example 1:</p>
<p>Base profile:<br>
- Patient.identifier<br>
- Patient.identifier:foo<br>
- Patient.identifier:bar</p>
<p>Derived profile differential:<br>
- Patient.identifier:baz</p>
<p>=&gt; Derived profile snapshot:<br>
- Patient.identifier<br>
- Patient.identifier:foo<br>
- Patient.identifier:bar<br>
- Patient.identifier:baz  &lt;= Append new named slice after all existing named slices</p>
<p>I am wondering if FHIR also allows a derived profile to _insert_ new named slices into an existing (ordered) slice group?</p>
<p>Example 2, with same base profile:</p>
<p>Derived profile differential:<br>
- Patient.identifier:baz<br>
- Patient.identifier:foo</p>
<p>=&gt; Derived profile snapshot:<br>
- Patient.identifier<br>
- Patient.identifier:baz  &lt;= Insert new named slice before "foo" ?<br>
- Patient.identifier:foo<br>
- Patient.identifier:bar</p>
<p>This would require the snapshot generator to perform some kind of "peek ahead",<br>
which seems quite complicated to implement reliably and without breaking any existing behavior (if possible at all...?).<br>
So first I'd like to verify whether FHIR even allows this.</p>
<p>I guess this also depends on the exact definition of an ordered slice group.<br>
<a href="http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.slicing.ordered" target="_blank" title="http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.slicing.ordered">http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.slicing.ordered</a><br>
"If the matching elements have to occur in the same order as defined in the profile."<br>
Assuming the slice group in the base profile above is ordered, what is the correct interpretation?</p>
<p>Interpretation 1:<br>
If an instance contains a "foo" slice, it cannot not be preceded by any other slice (i.e. must be the very first slice).<br>
If an instance contains a "bar" slice, it can only be preceded by a "foo" slice (i.e. must be first or second slice).<br>
=&gt; other named slices may only occur after any "foo" and/or "bar" slices.<br>
=&gt; a derived profile is only allowed to append new named slices, not insert them.</p>
<p>Interpretation 2:<br>
If an instance contains both "foo" and "bar" slices, then "foo" must preceed "bar" (not necessarily immediate neighbours)<br>
=&gt; other named slices may occur before, in between or after "foo" and "bar".<br>
=&gt; a derived profile is allowed to introduce new named slices in any position.</p>
<p>Questions:<br>
- What is the correct interpretation of an "ordered" slice?<br>
- Does FHIR allow derived profiles to _insert_ new named slices (such as in Example 2)?</p>



<a name="153966727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153966727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153966727">(Jun 04 2018 at 18:20)</a>:</h4>
<p>have you seen build\tests\resources\snapshot-generation-tests.xml ?</p>



<a name="153966728"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153966728" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153966728">(Jun 04 2018 at 18:23)</a>:</h4>
<p>it doesn't include that, so we can say with confidence that it's not tested behaviour</p>



<a name="153966729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153966729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153966729">(Jun 04 2018 at 18:24)</a>:</h4>
<p>certainly if the slice is ordered, you cannot insert</p>



<a name="153966730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153966730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153966730">(Jun 04 2018 at 18:24)</a>:</h4>
<p>if the slicing is not ordered, I don't see what the need for inseertion is</p>



<a name="153967013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153967013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153967013">(Jun 05 2018 at 09:18)</a>:</h4>
<blockquote>
<p>certainly if the slice is ordered, you cannot insert</p>
</blockquote>
<p>That answers my question. Thanks Grahame.</p>



<a name="153967147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153967147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153967147">(Jun 05 2018 at 19:26)</a>:</h4>
<p>Just for clarity here, we have both (1) if the slice is ordered, you cannot insert and (2) if the slicing is not ordered there is no need or use for insertion (my slight paraphrase).  So, basically it would make sense to disallow insertion and to allow append and handle them the same whether the slicing is ordered or unordered, correct?</p>



<a name="153967295"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153967295" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153967295">(Jun 06 2018 at 09:52)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191405">@Rob Hausam</span>, indeed, I drew the same conclusion.</p>



<a name="153967296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153967296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153967296">(Jun 06 2018 at 09:53)</a>:</h4>
<p>This also ensures that the logic is actually implementable, which is kinda nice.</p>



<a name="153967381"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Can%20a%20derived%20profile%20insert%20new%20named%20slices%3F/near/153967381" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Can.20a.20derived.20profile.20insert.20new.20named.20slices.3F.html#153967381">(Jun 06 2018 at 14:44)</a>:</h4>
<p>yes</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
