---
layout: page
title: "FHIR Chat  · Invalid sliceName on SimpleQuantity core def? · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html">Invalid sliceName on SimpleQuantity core def?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153901593"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901593" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901593">(Aug 10 2017 at 12:54)</a>:</h4>
<p>We recently received a bug report on the .NET snapshot generator concerning unexpected slice names in the snapshot.</p>
<p>After closer analysis, I noticed that the core definition of the SimpleQuantity datatype specifies an explicit slice name on the root element:</p>
<div class="codehilite"><pre><span></span>&lt;differential&gt;
  &lt;element id=&quot;Quantity:simplequantity&quot;&gt;
    &lt;path value=&quot;Quantity&quot; /&gt;
    &lt;sliceName value=&quot;SimpleQuantity&quot; /&gt;
    &lt;!-- ... --&gt;
</pre></div>


<p>Currently, because of the way the snapshot generator works,  profiles that reference the SimpleQuantity datatype automatically inherit the slice name from the core definition. This confuses the profile author and causes unexpected tooling issues.</p>
<p>This seems incorrect? As in general, I never expect slice names to occur in core defs and neither on root elements.</p>
<p>Suggestions:<br>
1) Remove the invalid slice name from the root element of the official SimpleQuantity datatype definition in the FHIR spec<br>
2) Implement additional rule in the snapshot generator to generate warnings when slice names are found on core definitions and/or root elements.  The snapshot generator could then pro-actively delete/ignore the specified slice name. This would automatically detect and fix any future errors in the core spec.</p>



<a name="153901622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901622">(Aug 10 2017 at 15:13)</a>:</h4>
<p>Agree that there should be no sliceName on the root element.  Grahame - is this something we can fix with a patch?</p>



<a name="153901624"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901624" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901624">(Aug 10 2017 at 15:16)</a>:</h4>
<p>Maybe the official build could run a simple validation rule to verify that core defs do not contain any non-null slice names? This way, future regressions would be detected immediately.</p>



<a name="153901628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901628">(Aug 10 2017 at 15:30)</a>:</h4>
<p>Well, the true validation is that sliceName should only appear when there's slicing in scope - either from the current resource definition or on the path inherited from the parent</p>



<a name="153901800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901800">(Aug 10 2017 at 21:19)</a>:</h4>
<p>I'm not convinced that this is wrong. I think we should talk about this in San Diego</p>



<a name="153901801"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901801" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901801">(Aug 10 2017 at 21:20)</a>:</h4>
<p>This has been discussed at length in the past - it's not valid to have a sliceName on the root element.</p>



<a name="153901803"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901803" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901803">(Aug 10 2017 at 21:21)</a>:</h4>
<p>It's an artifact from pre-STU3 where "name" was used to simply label things.</p>



<a name="153901804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901804">(Aug 10 2017 at 21:22)</a>:</h4>
<p>i don't think it's so simple. In this case, the slice name is used to make the ids on the ElementDefinition unique across the buld</p>



<a name="153901819"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901819" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901819">(Aug 10 2017 at 21:42)</a>:</h4>
<p>Why should element ids be unique across the build?  They're only supposed to be unique in the context of a model.  It makes no sense to use a sliceName when you're not slicing.</p>



<a name="153901823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901823">(Aug 10 2017 at 22:05)</a>:</h4>
<p>it's useful, if you're taking a data element based look at the spec, to have unique names for the data elements</p>



<a name="153901901"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901901" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901901">(Aug 11 2017 at 00:13)</a>:</h4>
<p>What does the slice name (value="SimpleQuantity") give you that is not in the id (id="Quantity:simplequantity")?</p>



<a name="153901902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901902">(Aug 11 2017 at 00:14)</a>:</h4>
<p>The unique name is <code>http://hl7.org/fhir/StructureDefinition/SimpleQuantity#Quantity</code></p>



<a name="153901913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901913">(Aug 11 2017 at 00:16)</a>:</h4>
<p>id="Quantity:simplequantity" - that is the slice name right there</p>



<a name="153901914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901914">(Aug 11 2017 at 00:16)</a>:</h4>
<p><span class="user-mention" data-user-id="191682">@Richard Townley-O'Neill</span> the id only includes the <code>:simplequantity</code> part if the sliceName is populated (elementdefinition ids are calculated).</p>



<a name="153901915"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901915" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901915">(Aug 11 2017 at 00:23)</a>:</h4>
<p>Is that a requirement of FHIR (hard to change) or a convenient way of generating the id (maybe easier to change)?</p>



<a name="153901917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153901917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153901917">(Aug 11 2017 at 00:24)</a>:</h4>
<p>yes and yes</p>



<a name="153902000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153902000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153902000">(Aug 11 2017 at 04:14)</a>:</h4>
<p>Data elements aren't elements.  I'm fine with you prefixing the data element with the model id if the root element isn't the model id.  But you don't need to mess up the element ids to do that, nor do you need to abuse sliceName.  sliceName's semantics are clear.  The way you're using it is clearly in violation of the definition and also unnecessary.</p>



<a name="153902058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153902058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153902058">(Aug 11 2017 at 08:55)</a>:</h4>
<p>I tend to agree with Chris &amp; Lloyd on this issue. FHIR requires that element id's are unique within the context of a resource (except repeated in snap/diff). However there is no guarantee or expectation that generated id's are globally unique.  (Ab-)using the root element slice name for this purpose causes unexpected behavior in derived profiles downstream, due to the way snapshot generation currently works. I'm not sure if a snapshot generator could handle this reliably, as I suspect that this could introduce ambiguities...?</p>



<a name="153902065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Invalid%20sliceName%20on%20SimpleQuantity%20core%20def%3F/near/153902065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Invalid.20sliceName.20on.20SimpleQuantity.20core.20def.3F.html#153902065">(Aug 11 2017 at 09:03)</a>:</h4>
<p>Maybe we could allow this by introducing a special rule stating that slice names on root elements are never inherited by the referencing profile when applied as an element type profile?<br>
But frankly, I'm reluctant to introduce additional complexity to slicing... rather not.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
