---
layout: page
title: "FHIR Chat  · Slicing polymorphic Elements · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html">Slicing polymorphic Elements</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="182197894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182197894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182197894">(Nov 29 2019 at 18:56)</a>:</h4>
<p><span class="user-mention" data-user-id="191375">@Alexander Henket</span> I'm still chipping away at the zib snapshot generation issues. When the snapshot generator runs into the construct below, it returns this error:</p>
<p><code>Unable to generate snapshot for http://nictiz.nl/fhir/StructureDefinition/zib-Pregnancy-PregnancyDuration because Error at path Observation.value[x] in http://nictiz.nl/fhir/StructureDefinition/zib-Pregnancy-PregnancyDuration: Type slicing with slicing.discriminator.type != 'type'</code></p>
<p>The differential in question says this:</p>
<div class="codehilite"><pre><span></span>   <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x]&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;slicing&gt;</span>
        <span class="nt">&lt;discriminator&gt;</span>
          <span class="nt">&lt;type</span> <span class="na">value=</span><span class="s">&quot;value&quot;</span> <span class="nt">/&gt;</span>
          <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;code&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/discriminator&gt;</span>
        <span class="nt">&lt;rules</span> <span class="na">value=</span><span class="s">&quot;closed&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/slicing&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</pre></div>


<p>I don't understand what this is trying to do - to slice an polymorphic element that can't repeat by anything other than type, and the validator doesn't support this. I don't see that it makes sense either, and so I think this is an error in your profiles, but I'm interested in discussion here.</p>



<a name="182198017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182198017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182198017">(Nov 29 2019 at 18:59)</a>:</h4>
<p>btw, here's the first slice:</p>
<div class="codehilite"><pre><span></span>   <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationDays&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x]&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;PregnancyDurationDays&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;PregnancyDuration&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Duration of the pregnancy on the day on which the patient was asked. The duration can be entered in days (d) or weeks (wk).&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;alias</span> <span class="na">value=</span><span class="s">&quot;Zwangerschapsduur&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Quantity&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">&quot;hcim-pregnancy-v3.1-2017EN&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">&quot;NL-CM:7.14.4&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;comment</span> <span class="na">value=</span><span class="s">&quot;PregnancyDuration&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationDays.unit&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x].unit&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;defaultValueString</span> <span class="na">value=</span><span class="s">&quot;days&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationDays.system&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x].system&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;fixedUri</span> <span class="na">value=</span><span class="s">&quot;http://unitsofmeasure.org&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationDays.code&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x].code&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;fixedCode</span> <span class="na">value=</span><span class="s">&quot;d&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</pre></div>



<a name="182198037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182198037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182198037">(Nov 29 2019 at 18:59)</a>:</h4>
<p>and here's the second:</p>
<div class="codehilite"><pre><span></span>   <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationWeeks&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x]&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;PregnancyDurationWeeks&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;PregnancyDuration&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Duration of the pregnancy on the day on which the patient was asked. The duration can be entered in days (d) or weeks (wk).&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;alias</span> <span class="na">value=</span><span class="s">&quot;Zwangerschapsduur&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Quantity&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">&quot;hcim-pregnancy-v3.1-2017EN&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">&quot;NL-CM:7.14.4&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;comment</span> <span class="na">value=</span><span class="s">&quot;PregnancyDuration&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationWeeks.unit&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x].unit&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;defaultValueString</span> <span class="na">value=</span><span class="s">&quot;weeks&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationWeeks.system&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x].system&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;fixedUri</span> <span class="na">value=</span><span class="s">&quot;http://unitsofmeasure.org&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;Observation.value[x]:PregnancyDurationWeeks.code&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Observation.value[x].code&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;fixedCode</span> <span class="na">value=</span><span class="s">&quot;wk&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</pre></div>



<a name="182198148"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182198148" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182198148">(Nov 29 2019 at 19:01)</a>:</h4>
<p>I can't see how these are usefully different to each other except to set the default value for the unit. Which you shouldn't be doing anyway, and I'm surprised isn't an error (though it might be  the discriminator would be found first)</p>



<a name="182198305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182198305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182198305">(Nov 29 2019 at 19:04)</a>:</h4>
<p>I see we did not make a formal invariant for that rule until R4. but it has been in narrative from the beginning</p>



<a name="182230256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182230256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182230256">(Nov 30 2019 at 08:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> This 'little gem' comes from the functional model <a href="https://zibs.nl/wiki/Pregnancy-v3.1(2017EN)" target="_blank" title="https://zibs.nl/wiki/Pregnancy-v3.1(2017EN)">HCIM Pregnancy</a>. This lists a concept PregnancyDuration in either days or weeks. Hence we'd like to say that you may use PregnancyDuration using code d or code wk.</p>
<p>I suppose you could achieve the same thing using a  UCUM value set binding containing d/wk on valueQuantity as implicit slice? If you think that is a better solution, we can update for that.</p>



<a name="182231601"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182231601" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182231601">(Nov 30 2019 at 09:22)</a>:</h4>
<p>I've checked in the suggested update for the profile in the develop branch under commit id <a href="https://github.com/Nictiz/Nictiz-STU3-Zib2017/commit/af6423d57f4f67996d4619f93d91ae90822bad74" target="_blank" title="https://github.com/Nictiz/Nictiz-STU3-Zib2017/commit/af6423d57f4f67996d4619f93d91ae90822bad74">af6423d57f4f67996d4619f93d91ae90822bad74</a>. Let me know if that solved this issue.</p>



<a name="182231656"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182231656" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182231656">(Nov 30 2019 at 09:24)</a>:</h4>
<p>Ok, I’ll look. I definitely think that a value set is a much simpler way to meet this requirement for everyone</p>



<a name="182231660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182231660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182231660">(Nov 30 2019 at 09:24)</a>:</h4>
<p>Well it sure makes for easier reading :-)</p>



<a name="182231672"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182231672" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182231672">(Nov 30 2019 at 09:25)</a>:</h4>
<p>Mental note to <span class="user-mention" data-user-id="216303">@Pieter Edelman</span>: if this is the better way to go, we should update our profiling guidelines for how to attach units to quantities.</p>



<a name="182322506"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Slicing%20polymorphic%20Elements/near/182322506" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pieter Edelman <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Slicing.20polymorphic.20Elements.html#182322506">(Dec 02 2019 at 07:55)</a>:</h4>
<p>Agree that this is much more elegant. I'll update our guidelines.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
