---
layout: page
title: "FHIR Chat  · Primitive Validation Questions · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html">Primitive Validation Questions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="171998652"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171998652" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171998652">(Jul 30 2019 at 01:55)</a>:</h4>
<p>I'm reviewing the validation of primitive values by the validator. I have a couple of issues:<br>
- are leading zeros allowed on exponents in decimals? we don't say anything about this (we don't allow leading zeros on the actual number). <br>
- the validator says this is not valid:</p>
<div class="codehilite"><pre><span></span>  <span class="nt">&lt;parameter&gt;</span>
    <span class="nt">&lt;name</span> <span class="na">value=</span><span class="s">&quot;paramMarkdownMissing&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;valueMarkdown&gt;</span>
      <span class="nt">&lt;extension</span> <span class="na">url=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;valueCode</span> <span class="na">value=</span><span class="s">&quot;unknown&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;/valueMarkdown&gt;</span>
  <span class="nt">&lt;/parameter&gt;</span>
</pre></div>


<p>in fact, it gives 3 errors:</p>
<div class="codehilite"><pre><span></span>ERROR: Parameters.parameter[37]: A parameter must have one and only one of (value, resource, part) [(part.exists() and value.empty() and resource.empty()) or (part.empty() and (value.exists() xor resource.exists()))]
ERROR: Parameters.parameter[37].value.ofType(markdown): Primitive types must have a value that is not empty
ERROR: Parameters.parameter[37].value.ofType(markdown): All FHIR elements must have a @value or children [hasValue() or (children().count() &gt; id.count())]
</pre></div>


<p>I think every one of those errors is wrong?</p>



<a name="171999264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999264">(Jul 30 2019 at 02:12)</a>:</h4>
<p>related to the decimal question, we say:</p>



<a name="171999277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999277">(Jul 30 2019 at 02:13)</a>:</h4>
<blockquote>
<p>JSON is restricted to the precision limits documented in XML schema for xs:double and xs:decimal</p>
</blockquote>



<a name="171999328"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999328" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999328">(Jul 30 2019 at 02:14)</a>:</h4>
<p>consulting the xs:decimal limits, I see: </p>
<blockquote>
<p>All ·minimally conforming· processors ·must· support decimal numbers with a minimum of 18 decimal digits (i.e., with a ·totalDigits· of 18). However, ·minimally conforming· processors ·may· set an application-defined limit on the maximum number of decimal digits they are prepared to support, in which case that application-defined maximum number ·must· be clearly documented.</p>
</blockquote>



<a name="171999331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999331">(Jul 30 2019 at 02:14)</a>:</h4>
<p>and for double, I see</p>



<a name="171999355"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999355" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999355">(Jul 30 2019 at 02:15)</a>:</h4>
<blockquote>
<p>The basic ·value space· of double consists of the values m × 2^e, where m is an integer whose absolute value is less than 2^53, and e is an integer between -1075 and 970, inclusive</p>
</blockquote>



<a name="171999360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999360">(Jul 30 2019 at 02:15)</a>:</h4>
<p>I don't actually know how the double commentary is relevant</p>



<a name="171999401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999401">(Jul 30 2019 at 02:16)</a>:</h4>
<p>the decimal constraints... are not constraints.</p>



<a name="171999409"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999409" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999409">(Jul 30 2019 at 02:16)</a>:</h4>
<p>so I'm not sure what we are trying to do here. (I know what we are doing: making a mess of precision limits)</p>



<a name="171999619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999619">(Jul 30 2019 at 02:21)</a>:</h4>
<p>relevant prior discussion here on Zulip:</p>



<a name="171999621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/171999621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#171999621">(Jul 30 2019 at 02:21)</a>:</h4>
<ul>
<li><a href="#narrow/stream/179266-fhirpath/topic/Decimal.20.3D.20vs.20~" title="#narrow/stream/179266-fhirpath/topic/Decimal.20.3D.20vs.20~">https://chat.fhir.org/#narrow/stream/179266-fhirpath/topic/Decimal.20.3D.20vs.20~</a></li>
<li><a href="#narrow/stream/179266-fhirpath/topic/Fixed-precision.20decimal" title="#narrow/stream/179266-fhirpath/topic/Fixed-precision.20decimal">https://chat.fhir.org/#narrow/stream/179266-fhirpath/topic/Fixed-precision.20decimal</a></li>
</ul>



<a name="172009168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172009168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172009168">(Jul 30 2019 at 06:25)</a>:</h4>
<p>what the validator is presently doing:</p>
<ul>
<li>checking the syntax validity, allowing leading zeros on exponents</li>
<li>noting a warning if there is more than 18 digits in the exponent / decimal, and if there's more than 4 digits in the mantissa</li>
</ul>



<a name="172009325"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172009325" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172009325">(Jul 30 2019 at 06:29)</a>:</h4>
<p>And I just found a shockingly large bug in the validator :-(</p>



<a name="172009353"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172009353" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172009353">(Jul 30 2019 at 06:29)</a>:</h4>
<p>check this Java code, at the bottom of all primitive data type fixedValue checking</p>



<a name="172009402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172009402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172009402">(Jul 30 2019 at 06:30)</a>:</h4>
<div class="codehilite"><pre><span></span>  <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">checkEquals</span><span class="o">(</span><span class="n">String</span> <span class="n">v1</span><span class="o">,</span> <span class="n">String</span> <span class="n">v2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">v1</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">Utilities</span><span class="o">.</span><span class="na">noString</span><span class="o">(</span><span class="n">v1</span><span class="o">)</span> <span class="o">:</span> <span class="n">v1</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">v2</span><span class="o">);</span>
  <span class="o">}</span>
</pre></div>



<a name="172009427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172009427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172009427">(Jul 30 2019 at 06:30)</a>:</h4>
<p>big logic flaw: if the fixed value has null, it's supposed to check that the instance value is null. But it doesn't - it ignores it. It should be</p>



<a name="172009445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172009445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172009445">(Jul 30 2019 at 06:31)</a>:</h4>
<div class="codehilite"><pre><span></span> <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">checkEquals</span><span class="o">(</span><span class="n">String</span> <span class="n">v1</span><span class="o">,</span> <span class="n">String</span> <span class="n">v2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">v1</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">Utilities</span><span class="o">.</span><span class="na">noString</span><span class="o">(</span><span class="n">v2</span><span class="o">)</span> <span class="o">:</span> <span class="n">v1</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">v2</span><span class="o">);</span>
  <span class="o">}</span>
</pre></div>



<a name="172010000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172010000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172010000">(Jul 30 2019 at 06:42)</a>:</h4>
<p>is <code>-0</code> a valid decimal?</p>



<a name="172010002"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Primitive%20Validation%20Questions/near/172010002" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Primitive.20Validation.20Questions.html#172010002">(Jul 30 2019 at 06:42)</a>:</h4>
<p>I think it is</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
