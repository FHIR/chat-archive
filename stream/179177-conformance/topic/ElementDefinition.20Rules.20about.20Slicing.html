---
layout: page
title: "FHIR Chat  · ElementDefinition Rules about Slicing · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html">ElementDefinition Rules about Slicing</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153955994"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153955994" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153955994">(May 04 2018 at 18:08)</a>:</h4>
<p><a href="http://build.fhir.org/elementdefinition.html#slicing" target="_blank" title="http://build.fhir.org/elementdefinition.html#slicing">http://build.fhir.org/elementdefinition.html#slicing</a><br>
The last bullet point is just plain wrong...I think.  "The first entry (the one having the slicing information) is understood to be the set of constraints to be used for the 'open' slice" - no, that's the <code>@default</code> slice.  If you create a constraint on "the first entry" with the slicing information, you're constraining all slices.  If I'm not missing something, this is a must fix technical correction.  <span class="user-mention" data-user-id="191328">@Ewout Kramer</span> <span class="user-mention" data-user-id="191336">@Michel Rutten</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span></p>



<a name="153955995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153955995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153955995">(May 04 2018 at 18:09)</a>:</h4>
<p>For some reason, there's an exception for min..max in this wording??</p>



<a name="153955996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153955996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153955996">(May 04 2018 at 18:11)</a>:</h4>
<p>I'm confident this is wrong because the first entry with the slicing definition is where all the standard constraints live (e.g. bindings), and adding slices can't remove those (make them apply only to the 'open' slice).</p>



<a name="153955998"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153955998" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153955998">(May 04 2018 at 18:18)</a>:</h4>
<p>Please submit a change request</p>



<a name="153955999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153955999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153955999">(May 04 2018 at 18:19)</a>:</h4>
<p>Agree it should be fixed</p>



<a name="153956000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956000">(May 04 2018 at 18:19)</a>:</h4>
<p>Will do. Just wanted to check that I wasn't missing something.</p>



<a name="153956002"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956002" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956002">(May 04 2018 at 18:24)</a>:</h4>
<p><a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16309" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=16309">GF#16309</a></p>



<a name="153956113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956113">(May 05 2018 at 05:00)</a>:</h4>
<p>the min..max exception is real and deliberate</p>



<a name="153956327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956327">(May 07 2018 at 09:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191351">@Chris Grenz</span> agreed, this seems to be an error in the specification and should be corrected.</p>



<a name="153956344"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956344" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956344">(May 07 2018 at 11:57)</a>:</h4>
<p>Don't know. This was written before we had <code>@default</code> and it seems correct in that context:  the first entry's constraints describe the constraints that must be satisfied by any instance of that element, whether it ends up in a named slice, the @default and the open slice, right?  So, if the slice is open, anything that matches these constraints, but not the ones on the slices ends up in the open slice. I think that is what the current text says, though this has become somewhat ambiguous now there's a @default slice (only if the slice is closed).  If the slice is closed, and you have a @default, it would still need to match these constraints, and any additional constraints the @default slice itself has.  Correct?  Maybe the text should just be expanded, don't think it's wrong.  Unless I have misunderstood.</p>



<a name="153956439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956439">(May 07 2018 at 13:40)</a>:</h4>
<p>As I read it, the constraints on the first (slicing) element, which comes from the baseDefinition as an unsliced element, now only apply to instances <em>not</em> falling into a named slice (the "open" slice).  This is not correct - all constraints including min, max, bindings, etc. found on this element apply to all instances.</p>
<p>I'm not sure what <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  is talking about?  min..max on the first element constrains the total number of instances regardless of slicing.  For example, if I profile CodeableConcept, and set <code>#CodeableConcept.coding</code>'s min..max to <code>1..3</code>, there can be only 1, 2, or 3 codings present in any conformant CodeableConcept, full stop.  No amount of slicing or re-slicing can override that.</p>



<a name="153956442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956442">(May 07 2018 at 13:45)</a>:</h4>
<blockquote>
<p>As I read it, the constraints on the first (slicing) element, which comes from the baseDefinition as an unsliced element, now only apply to instances <em>not</em> falling into a named slice (the "open" slice).  This is not correct - all constraints including min, max, bindings, etc. found on this element apply to all instances.</p>
</blockquote>
<p>I never read that into it, but now you are saying it: I could if I wanted to ;-) Agree that it should not mean that, it's not just for the open slice.</p>
<blockquote>
<p>I'm not sure what <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  is talking about?  min..max on the first element constrains the total number of instances regardless of slicing.  For example, if I profile CodeableConcept, and set <code>#CodeableConcept.coding</code>'s min..max to <code>1..3</code>, there can be only 1, 2, or 3 codings present in any conformant CodeableConcept, full stop.  No amount of slicing or re-slicing can override that.</p>
</blockquote>
<p>"total number of instances regardless of slicing", yes that is what the spec says too, I think the two of you agree.</p>



<a name="153956443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956443">(May 07 2018 at 13:47)</a>:</h4>
<p>The language of "open" slice should at least be replaced with "all instances" or something.  Frankly, I think we do a much better job of describing slicing over on profiling.html and this is just muddying the water.</p>



<a name="153956459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956459">(May 07 2018 at 14:18)</a>:</h4>
<p>I have always interpreted slicing rules as Chris explains them. Apparently the current wording is still ambiguous, so we should try to be crystal clear.</p>



<a name="153956465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956465">(May 07 2018 at 14:27)</a>:</h4>
<p>If you set min=1 for the overall element, that does <em>not</em> set min each one on every slice.  It can't.</p>



<a name="153956466"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956466" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956466">(May 07 2018 at 14:27)</a>:</h4>
<p>Ah, I understand.</p>



<a name="153956468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956468">(May 07 2018 at 14:28)</a>:</h4>
<p>So it's really only min that's excepted.  Max would be the same (or less if specified)</p>



<a name="153956469"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956469" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956469">(May 07 2018 at 14:29)</a>:</h4>
<p>Yes, I think that's true.</p>



<a name="153956476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956476">(May 07 2018 at 14:49)</a>:</h4>
<p>Technically, a slice can specify conflicting cardinality constraints. For example, 1..1 on overal element and 2...2 on a named slice. This is a valid profile, however no instances will ever match. I consider this a very complicated way of describing the empty set. Like "SELECT * FROM Persons WHERE 1=0" is a valid SQL statement that will always returns the empty set. The validator could detect such conflicting constraints and emit a warning.</p>



<a name="153956477"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/ElementDefinition%20Rules%20about%20Slicing/near/153956477" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/ElementDefinition.20Rules.20about.20Slicing.html#153956477">(May 07 2018 at 14:59)</a>:</h4>
<p>I'd suggest that it's up to authoring tooling (or any other tooling so inclined) to determine if a set of constraints are exclusive.  It's up to the standard to define what's valid.  A 2..2 slice on a 1..1 element is not valid in that a constraint max cannot be larger than the base .  The min 2 being higher than 1 is OK, except that min must be &lt; max, and max of the profile cannot be larger than the base.</p>
<p>So, in theory I agree with you, that profiles may construct empty sets, but not with your specific example.  A non-overlapping binding is probably a better example, although that also may get some dissent.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
