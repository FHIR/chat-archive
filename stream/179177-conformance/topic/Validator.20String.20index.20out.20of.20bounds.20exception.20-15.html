---
layout: page
title: "FHIR Chat  · Validator String index out of bounds exception -15 · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Validator.20String.20index.20out.20of.20bounds.20exception.20-15.html">Validator String index out of bounds exception -15</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="183140960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Validator%20String%20index%20out%20of%20bounds%20exception%20-15/near/183140960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Validator.20String.20index.20out.20of.20bounds.20exception.20-15.html#183140960">(Dec 11 2019 at 09:45)</a>:</h4>
<p>For all composition profiles we get the same error in the Java validator. I ran through one them, disabling parts until I found the 'offending' part.</p>
<p>It turns out that if you are two sections deep and starting talking about a section.code.coding, without marking section.code first, the validator looses track, so for example in <a href="https://simplifier.net/NictizSTU3-Zib2017-Develop/eOverdrachtOverdrachtsberichtKinderen1-18jaar" target="_blank" title="https://simplifier.net/NictizSTU3-Zib2017-Develop/eOverdrachtOverdrachtsberichtKinderen1-18jaar">eOverdracht-overdrachtsbericht-kinderen-1-18-jaar</a> you cannot just say in the differential:</p>
<div class="codehilite"><pre><span></span>&lt;element id=&quot;Composition.section:carePlan.section:patientsNeedsAndPreferences.code.coding&quot;&gt;
  &lt;path value=&quot;Composition.section.section.code.coding&quot; /&gt;
  &lt;min value=&quot;1&quot; /&gt;
  &lt;max value=&quot;1&quot; /&gt;
&lt;/element&gt;
</pre></div>


<p>You need to add:</p>
<div class="codehilite"><pre><span></span>&lt;element id=&quot;Composition.section:carePlan.section:patientsNeedsAndPreferences.code&quot;&gt;
  &lt;path value=&quot;Composition.section.section.code&quot; /&gt;
&lt;/element&gt;
&lt;element id=&quot;Composition.section:carePlan.section:patientsNeedsAndPreferences.code.coding&quot;&gt;
  &lt;path value=&quot;Composition.section.section.code.coding&quot; /&gt;
  &lt;min value=&quot;1&quot; /&gt;
  &lt;max value=&quot;1&quot; /&gt;
&lt;/element&gt;
</pre></div>


<p>This seems like a validator bug to me. Is that soomething you can verify <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>? It's the same dev set you have been working on before.</p>
<div class="codehilite"><pre><span></span>Unable to generate snapshot for eOverdracht-overdrachtsbericht-kinderen-1-18-jaar from Composition because String index out of range: -15
java.lang.StringIndexOutOfBoundsException: String index out of range: -15
    at java.lang.String.substring(String.java:1931)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.fixedPathSource(ProfileUtilities.java:1498)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:643)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:685)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:787)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:970)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:970)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.processPaths(ProfileUtilities.java:666)
    at org.hl7.fhir.r5.conformance.ProfileUtilities.generateSnapshot(ProfileUtilities.java:472)
    at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:616)
    at org.hl7.fhir.r5.context.SimpleWorkerContext.allStructures(SimpleWorkerContext.java:479)
    at org.hl7.fhir.r5.utils.FHIRPathEngine.&lt;init&gt;(FHIRPathEngine.java:254)
    at org.hl7.fhir.r5.validation.ValidationEngine.messagesToOutcome(ValidationEngine.java:1199)
    at org.hl7.fhir.r5.validation.ValidationEngine.validate(ValidationEngine.java:1124)
    at org.hl7.fhir.r5.validation.ValidationEngine.validate(ValidationEngine.java:1037)
    at org.hl7.fhir.r5.validation.Validator.main(Validator.java:653)
</pre></div>



<a name="183141477"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Validator%20String%20index%20out%20of%20bounds%20exception%20-15/near/183141477" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Validator.20String.20index.20out.20of.20bounds.20exception.20-15.html#183141477">(Dec 11 2019 at 09:53)</a>:</h4>
<p>this is still on my todo list. I kind of hope that one day I won't spend all day down in the guts of the snapshot generator....</p>



<a name="183142161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Validator%20String%20index%20out%20of%20bounds%20exception%20-15/near/183142161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Validator.20String.20index.20out.20of.20bounds.20exception.20-15.html#183142161">(Dec 11 2019 at 10:03)</a>:</h4>
<p>Got it. For now I've added the missing thing manually for all Composition profiles so the error is now gone. However: first Save in Forge will delete that part again as it contains no changes compared to the base, so we'll have to be extra careful there.</p>



<a name="183142502"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Validator%20String%20index%20out%20of%20bounds%20exception%20-15/near/183142502" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Validator.20String.20index.20out.20of.20bounds.20exception.20-15.html#183142502">(Dec 11 2019 at 10:08)</a>:</h4>
<p>anyway, thanks for finding it, it will save me plenty of time</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
