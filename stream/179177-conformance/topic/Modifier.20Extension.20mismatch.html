---
layout: page
title: "FHIR Chat  · Modifier Extension mismatch · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html">Modifier Extension mismatch</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="274604083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604083">(Mar 08 2022 at 20:45)</a>:</h4>
<p>I've just found an issue in the FHIR test cases</p>



<a name="274604184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604184">(Mar 08 2022 at 20:46)</a>:</h4>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>  <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">"Patient.extension:animal"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">"Patient.extension"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">"animal"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">"Test Extension"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"Extension"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">"http://hl7.org/fhir/3.0/StructureDefinition/extension-Patient.animal"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
  <span class="nt">&lt;/element&gt;</span>
</code></pre></div>



<a name="274604197"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604197" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604197">(Mar 08 2022 at 20:46)</a>:</h4>
<p>only, that's a modifier</p>



<a name="274604272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604272">(Mar 08 2022 at 20:47)</a>:</h4>
<p>should the snapshot generator process that, and leave it to the validator to complain, or should it fail with an error? Any opinions?</p>



<a name="274604372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604372">(Mar 08 2022 at 20:47)</a>:</h4>
<p>I think I'd prefer to let the Validator catch that one.</p>



<a name="274604476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604476">(Mar 08 2022 at 20:48)</a>:</h4>
<p>I think the snapshot generator should bail. Assuming the actual path is <code>Patient.modifierExtension</code>, talking about an <code>Element.path</code> of <code>Patient.extension</code> is wrong and also confusing. (Or if I'm not understanding the story here, I'm confused anyway ;-))</p>



<a name="274604681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604681">(Mar 08 2022 at 20:50)</a>:</h4>
<p>it is wrong and confusing. The only question I'm asking is where in the tooling stack it should emerge as an issue</p>



<a name="274604740"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604740" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604740">(Mar 08 2022 at 20:50)</a>:</h4>
<p>Since the input to the snapshot generator is wrong, my perspective is that the snapshot generator should fail (early and loud is good here, and the snapshot generation is upsteam of the validation IIUC).</p>



<a name="274604854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604854">(Mar 08 2022 at 20:51)</a>:</h4>
<p>Otherwise put: snapshots shouldn't define elements that can't exist.</p>



<a name="274604861"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604861" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604861">(Mar 08 2022 at 20:51)</a>:</h4>
<p>there's lots of other things that the snapshot generator does not catch because it's task is to generate the snapshot, not validate the profile</p>



<a name="274604985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274604985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274604985">(Mar 08 2022 at 20:52)</a>:</h4>
<p>As long as it's valid path, etc., the snapshot generator should accept it and the validator should scream bloody murder</p>



<a name="274605851"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274605851" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274605851">(Mar 08 2022 at 20:58)</a>:</h4>
<p>I think I understand better now -- OK, I buy David's position.</p>
<p>Related to the test case: <code>http://hl7.org/fhir/StructureDefinition/patient-animal</code> is defined <a href="http://build.fhir.org/extension-patient-animal.html">here</a> and probably shouldn't be (anymore)?</p>



<a name="274605938"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274605938" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274605938">(Mar 08 2022 at 20:59)</a>:</h4>
<p>why not?</p>



<a name="274606172"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274606172" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274606172">(Mar 08 2022 at 21:00)</a>:</h4>
<p>Because the backport extension <code>http://hl7.org/fhir/3.0/StructureDefinition/extension-Patient.animal</code> does the same job in a standard way</p>



<a name="274606224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274606224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274606224">(Mar 08 2022 at 21:00)</a>:</h4>
<p>(Or, again, I'm confused -- increasingly likely ;-))</p>



<a name="274606492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274606492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274606492">(Mar 08 2022 at 21:02)</a>:</h4>
<p>well, it might. but the committee decided they wanted to update the definitions and be explicit about some things, and also to mark it not as a modifier</p>



<a name="274606605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274606605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274606605">(Mar 08 2022 at 21:03)</a>:</h4>
<p>I would put it the other way around: it's invalid to use that versioned extension ,but the tests cases often involve weird edge cases like that</p>



<a name="274606917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274606917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274606917">(Mar 08 2022 at 21:05)</a>:</h4>
<p>Wait, it's invalid to use <code>http://hl7.org/fhir/3.0/StructureDefinition/extension-Patient.animal</code> as <code>extension</code>, but OK to use it as <code>modifierExtension</code>, yes? <del>And we're saying that PA explicitly decided to also provide a non-modifer way to talk about animal extensions? The resolution to <a href="http://jira.hl7.org/browse/FHIR-14880">FHIR-14880</a> does not make me think that's what happend.</del></p>



<a name="274607099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274607099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274607099">(Mar 08 2022 at 21:07)</a>:</h4>
<p><del>Instead of:</del></p>
<p><del>* We know about backport but want a dedicated way to express this</del><br>
<del>* We want to surface this extension specifically as a non-modifier</del></p>
<p><del>... the resolution from <a href="http://jira.hl7.org/browse/FHIR-14880">FHIR-14880</a> makes me think the decision really just was designed to say "let's move .animal out of Patient and still have a way to express animal details outside of the core elements". And the standard backport <code>modifierExtension</code> manages that just fine.</del></p>



<a name="274607320"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274607320" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274607320">(Mar 08 2022 at 21:08)</a>:</h4>
<p>OK, the resolution was succinct but the comments were clear:</p>
<blockquote>
<p>Futher discussion was held on this topic, and the standard extension suggested should not be a modifier. And also verified with someone from veterinary who is ok with this.</p>
</blockquote>
<p>Never mind me. If standard backport extensions were considered at the time though, the decision might have gone differently.</p>



<a name="274607741"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274607741" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274607741">(Mar 08 2022 at 21:12)</a>:</h4>
<p>Does the snapshot process even always have access to the definition of the extension?  It shouldn't need to if the differential doesn't drill down inside the extension.  And if it can't access the definition, it'd have no basis on which to yell.</p>



<a name="274609612"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274609612" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274609612">(Mar 08 2022 at 21:27)</a>:</h4>
<p>it does drill into in this case, but yes, if it doesn't, the snapshot generator doesn't need the target</p>



<a name="274648462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274648462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274648462">(Mar 09 2022 at 06:32)</a>:</h4>
<p>ok well, the next version of the validator will validate this.</p>



<a name="274648484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274648484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274648484">(Mar 09 2022 at 06:32)</a>:</h4>
<p>it didn't. though you could never build an instance that would validate against the profile.</p>



<a name="274692288"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274692288" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274692288">(Mar 09 2022 at 14:08)</a>:</h4>
<blockquote>
<p>it didn't. though you could never build an instance that would validate against the profile.</p>
</blockquote>
<p>You mean the validator didn't detect this problem but would fail validation for a different reason?</p>



<a name="274709595"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274709595" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274709595">(Mar 09 2022 at 16:06)</a>:</h4>
<p>The validator would catch it when validating an instance against a profile, but not when validating the profile itself</p>



<a name="274714960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274714960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274714960">(Mar 09 2022 at 16:43)</a>:</h4>
<p>Ahh! Little by little I'm understanding what this thread is about ;-)</p>



<a name="274715047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274715047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274715047">(Mar 09 2022 at 16:43)</a>:</h4>
<p>So now if somebody tried to put a profile like this into an implementation guide, the publishing tool chain would reject it even if they didn't have any examples at all.</p>



<a name="274715114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274715114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274715114">(Mar 09 2022 at 16:44)</a>:</h4>
<p>( in addition to throwing a warning that no examples were provided...)</p>



<a name="274716469"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274716469" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274716469">(Mar 09 2022 at 16:52)</a>:</h4>
<p>Right.  Even before, the publishing tool chain would have complained about the lack of examples - but there are times when suppressing that warning is reasonable and so this issue could have slipped in.</p>



<a name="274757163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Modifier%20Extension%20mismatch/near/274757163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Modifier.20Extension.20mismatch.html#274757163">(Mar 09 2022 at 21:49)</a>:</h4>
<blockquote>
<p>the publishing tool chain would reject it even</p>
</blockquote>
<p>well, yes, where 'reject' means noting the issue in the qa page</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
