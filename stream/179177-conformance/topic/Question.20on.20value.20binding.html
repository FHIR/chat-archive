---
layout: page
title: "FHIR Chat  · Question on value binding · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Question.20on.20value.20binding.html">Question on value binding</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="220387755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Question%20on%20value%20binding/near/220387755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ryan moehrke <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Question.20on.20value.20binding.html#220387755">(Dec 18 2020 at 15:48)</a>:</h4>
<p>code snip:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code>  <span class="s2">"differential"</span><span class="err">:</span> <span class="p">{</span>
    <span class="nt">"element"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus"</span><span class="p">,</span>
        <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus"</span><span class="p">,</span>
        <span class="nt">"min"</span><span class="p">:</span> <span class="mi">1</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus.coding"</span><span class="p">,</span>
        <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus.coding"</span><span class="p">,</span>
        <span class="nt">"slicing"</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">"discriminator"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"value"</span><span class="p">,</span>
              <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"coding.system"</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="nt">"rules"</span><span class="p">:</span> <span class="s2">"open"</span>
        <span class="p">},</span>
        <span class="nt">"min"</span><span class="p">:</span> <span class="mi">1</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus.coding:ValuesetSlice"</span><span class="p">,</span>
        <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus.coding"</span><span class="p">,</span>
        <span class="nt">"sliceName"</span><span class="p">:</span> <span class="s2">"ValuesetSlice"</span><span class="p">,</span>
        <span class="nt">"min"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">"max"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span>
        <span class="nt">"binding"</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">"strength"</span><span class="p">:</span> <span class="s2">"required"</span><span class="p">,</span>
          <span class="nt">"valueSet"</span><span class="p">:</span> <span class="s2">"http://hl7.org/fhir/ValueSet/marital-status"</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus.coding:ValuesetSlice.system"</span><span class="p">,</span>
        <span class="nt">"path"</span><span class="p">:</span> <span class="s2">"Patient.maritalStatus.coding.system"</span><span class="p">,</span>
        <span class="nt">"patternUri"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/v3-MaritalStatus"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
</code></pre></div>
<p>Would we expect a structure definition defined like this to slice-match on the binding and system's patternUri? just one and not the other? I would expect it to slice match on just the system value and then validate against the binding after it knows it matches this slice. But I recently learned that type:value slicing also has bindings in scope for discriminator. But still because the path in this case is defined as system I would expect the binding to be ignored for slice-matching.<br>
for example, I'm expecting 1 below to not match the slice and thus not be evaluated against the binding. I'm expecting 2 below to also not match the slice and not throw an error because of the binding (the original binding at the root element is extensible so it would instead throw a warning). I'm expecting 3 to match the slice on the system value and then be forced to comply with the binding. Are my expectations the intended functionality? or am I misguided?</p>
<p>1</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>    <span class="nt">&lt;maritalStatus&gt;</span>
        <span class="nt">&lt;coding&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"http://terminology.hl7.org/CodeSystem/v3-NullFlavor"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"UNK"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"unknown"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/coding&gt;</span>
    <span class="nt">&lt;/maritalStatus&gt;</span>
</code></pre></div>
<p>2</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>    <span class="nt">&lt;maritalStatus&gt;</span>
        <span class="nt">&lt;coding&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"http://terminology.hl7.org/CodeSystem/v3-NullFlavor"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"UNK"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"invalid-code"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/coding&gt;</span>
    <span class="nt">&lt;/maritalStatus&gt;</span>
</code></pre></div>
<p>3</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>    <span class="nt">&lt;maritalStatus&gt;</span>
        <span class="nt">&lt;coding&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">"http://terminology.hl7.org/CodeSystem/v3-MaritalStatus"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"M"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;display</span> <span class="na">value=</span><span class="s">"Married"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/coding&gt;</span>
    <span class="nt">&lt;/maritalStatus&gt;</span>
</code></pre></div>



<a name="220649947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Question%20on%20value%20binding/near/220649947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Question.20on.20value.20binding.html#220649947">(Dec 22 2020 at 01:18)</a>:</h4>
<blockquote>
<p>Are my expectations the intended functionality? or am I misguided?</p>
</blockquote>
<p>I hope it would behave that way.</p>



<a name="220656695"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Question%20on%20value%20binding/near/220656695" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Question.20on.20value.20binding.html#220656695">(Dec 22 2020 at 03:56)</a>:</h4>
<p>That should work.</p>



<a name="220699734"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Question%20on%20value%20binding/near/220699734" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ryan moehrke <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Question.20on.20value.20binding.html#220699734">(Dec 22 2020 at 15:19)</a>:</h4>
<p>so validation should look at the discriminator path, evaluate that into a different StructureDefinition element than declares the slice name if needed, and only use the fixed[x]/pattern[x]/binding in that element to evaluate the slice matching. leaving all else as validation that is only required once a slice is matched? <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> (just want to make sure I know what you are agreeing with)</p>



<a name="220726968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Question%20on%20value%20binding/near/220726968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Question.20on.20value.20binding.html#220726968">(Dec 22 2020 at 19:45)</a>:</h4>
<p>When the validator hits a sliced element, it iterates through each slice and checks the element to see if it matches the discriminator.  If it finds more than one match, that's an error.  If it finds zero matches, that's a warning (or an error if slicing is closed).  If it finds exactly one match, then it enforces all of the rules associated with that slice.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
