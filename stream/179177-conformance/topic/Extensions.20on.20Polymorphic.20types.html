---
layout: page
title: "FHIR Chat  · Extensions on Polymorphic types · conformance"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/index.html">conformance</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html">Extensions on Polymorphic types</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154026538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026538">(Dec 20 2018 at 03:50)</a>:</h4>
<p>I am looking at a problem in IPS for <span class="user-mention" data-user-id="191405">@Rob Hausam</span></p>



<a name="154026539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026539">(Dec 20 2018 at 03:50)</a>:</h4>
<p>The current differential looks like this:</p>



<a name="154026540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026540">(Dec 20 2018 at 03:52)</a>:</h4>
<div class="codehilite"><pre><span></span>        <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;slicing&gt;</span>
                <span class="nt">&lt;discriminator&gt;</span>
                    <span class="nt">&lt;type</span> <span class="na">value=</span><span class="s">&quot;type&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;$this&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/discriminator&gt;</span>
                <span class="nt">&lt;rules</span> <span class="na">value=</span><span class="s">&quot;open&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/slicing&gt;</span>
            <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effectiveDateTime&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectiveDateTime&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;effectiveDateTime&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;dateTime&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effectiveDateTime:data-absent-reason&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectiveDateTime.extension&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;effective[x] absence reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Provides a reason why the effective is missing.&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Extension&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effectivePeriod&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectivePeriod&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;effectivePeriod&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Period&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effectivePeriod:data-absent-reason&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectivePeriod.extension&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;effective[x] absence reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Provides a reason why the effective is missing.&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Extension&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
</pre></div>



<a name="154026541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026541">(Dec 20 2018 at 03:53)</a>:</h4>
<p>summary:</p>
<ul>
<li>the effective[x] element is must-support + sliced by type</li>
<li>on both of the types, the data-absent extension is must-support</li>
</ul>



<a name="154026542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026542">(Dec 20 2018 at 03:53)</a>:</h4>
<p>I don't think it should be sliced. So I think it should be like this:</p>



<a name="154026543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026543">(Dec 20 2018 at 03:54)</a>:</h4>
<div class="codehilite"><pre><span></span>        <span class="nt">&lt;element&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectiveDateTime&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;dateTime&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectiveDateTime.extension&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;effective[x] absence reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Provides a reason why the effective is missing.&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Extension&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectivePeriod&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Period&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effectivePeriod.extension&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;effective[x] absence reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Provides a reason why the effective is missing.&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Extension&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
</pre></div>



<a name="154026544"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026544" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026544">(Dec 20 2018 at 03:54)</a>:</h4>
<p>e..g just take the slicing out.</p>



<a name="154026545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026545">(Dec 20 2018 at 03:54)</a>:</h4>
<p>but this is even simpler:</p>



<a name="154026546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026546">(Dec 20 2018 at 03:55)</a>:</h4>
<div class="codehilite"><pre><span></span>        <span class="nt">&lt;element&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x].extension&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">&quot;data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;effective[x] absence reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Provides a reason why the effective is missing.&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;type&gt;</span>
                <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Extension&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/element&gt;</span>
</pre></div>



<a name="154026547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026547">(Dec 20 2018 at 03:55)</a>:</h4>
<p>that is - just define the extension on the choice type</p>



<a name="154026548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026548">(Dec 20 2018 at 03:56)</a>:</h4>
<p>the great thing is the snapshot generater/validator don't actually work for any of these combinations...</p>



<a name="154026549"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154026549" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154026549">(Dec 20 2018 at 03:56)</a>:</h4>
<p>there's a rule that you can't do the second, because how you can define children for no type... unless they are extensions....</p>



<a name="154560313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/154560313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#154560313">(Jan 07 2019 at 10:58)</a>:</h4>
<p>If I understand correctly, according to the new new rules for choice types in R4 (that I still need to implement in dotnet API...), a slicing introduction is no longer required when introducing constraints on specific choice types.<br>
As for the second, even shorter version; theoretically a slice introduction can define constraints on the common base type for the whole slice group - in this case <code>Element</code>, which defines the common <code>Element.extension</code> child element. This implies that it should be possible (well defined/parseable) to introduce common extensions inside of a slice group, and even nested/complex extensions.<br>
Not claiming that the dotnet API currently supports the proposed behavior - I suspect that we haven't implemented this (yet).</p>



<a name="155253257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/155253257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#155253257">(Jan 16 2019 at 13:30)</a>:</h4>
<p>Decision after discussion on Tuesday evening in San Antonio:</p>



<a name="155253284"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/155253284" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#155253284">(Jan 16 2019 at 13:31)</a>:</h4>
<p>the last form is supported for extension only as a special case. modifierExtension (applicable in truly corner cases) is not supported</p>



<a name="155322266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/155322266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#155322266">(Jan 17 2019 at 09:41)</a>:</h4>
<p>Seems like I missed out on a fun discussion ;p<br>
Too my understanding, a profile is allowed to introduce _any_ constraints on (child elements of) <code>MedicationStatement.effective[x]</code>, and such constraints apply to all specific types in the type slice.<br>
So why is this particular example special? i.e. why do we need additional rules?</p>



<a name="155338160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/155338160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#155338160">(Jan 17 2019 at 14:20)</a>:</h4>
<p>in effect, we ruled that it wasn't special; I was just confirming that other people agreed with that</p>



<a name="157368077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157368077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157368077">(Feb 01 2019 at 17:12)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  It appears that the fix for this isn't complete?</p>
<div class="codehilite"><pre><span></span>process res: Medication-uv-ips                                                   (35.0253sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Medication-uv-ips.structuredefinition - overriding from 0.1 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/MedicationStatement-uv-ips because MedicationStatement.effective[x] has children (MedicationStatement.effective[x].extension) and multiple types (dateTime, Period) in profile MedicationStatement-uv-ips
</pre></div>



<a name="157385190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157385190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157385190">(Feb 01 2019 at 20:56)</a>:</h4>
<p>hmm how did you get the igpublisher you used for that?</p>



<a name="157406549"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157406549" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157406549">(Feb 02 2019 at 04:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Just now saw this.  I used the IG Publisher from the latest current build (as of this morning).</p>



<a name="157438578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157438578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157438578">(Feb 02 2019 at 21:09)</a>:</h4>
<p>so  Idon't know why you're getting different results to me. are you current against the latest version of IPS?</p>



<a name="157467922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157467922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157467922">(Feb 03 2019 at 13:18)</a>:</h4>
<p>Yes, all current.  I'll refresh and recheck all of it and try again - and if I get the same errors I'll give you all of the details.</p>



<a name="157493867"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157493867" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157493867">(Feb 04 2019 at 02:00)</a>:</h4>
<p>After wiping the temp and output folders and the ips cache, that error went away (not sure which one of those fixed it).</p>



<a name="157495440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157495440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157495440">(Feb 04 2019 at 02:52)</a>:</h4>
<p>strange</p>



<a name="157500736"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157500736" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157500736">(Feb 04 2019 at 05:25)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Well, I guess I was wrong - missed the error on the last look, but it's still there (and there are more instances now after making the extension usage consistent):</p>
<div class="codehilite"><pre><span></span>process res: Device-uv-ips                                                       (21.0084sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Device-uv-ips.structuredefinition - overriding from 0.2 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/DeviceUseStatement-uv-ips because DeviceUseStatement.timing[x] has children (DeviceUseStatement.timing[x].extension) and multiple types (Timing, Period, dateTime) in profile DeviceUseStatement-uv-ips
process res: ImagingStudy-uv-ips                                                 (21.0095sec)
process res: Immunization-uv-ips                                                 (21.0112sec)
process res: MedicationStatement-uv-ips                                          (21.0138sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Immunization-uv-ips because Immunization.occurrence[x] has children (Immunization.occurrence[x].extension) and multiple types (dateTime, string) in profile Immunization-uv-ips
process res: Medication-uv-ips                                                   (21.0163sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Medication-uv-ips.structuredefinition - overriding from 0.1 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/MedicationStatement-uv-ips because MedicationStatement.effective[x] has children (MedicationStatement.effective[x].extension) and multiple types (dateTime, Period) in profile MedicationStatement-uv-ips
process res: Observation-alcoholuse-uv-ips                                       (21.0182sec)
process res: Observation-media-uv-ips                                            (21.0198sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-alcoholuse-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-alcoholuse-uv-ips
process res: Observation-imaging-uv-ips                                          (21.0210sec)
Error in snapshot generation: Differential for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-media-uv-ips with id: Media.context has an element that is not marked with a snapshot match
process res: Observation-laboratory-uv-ips                                       (21.0248sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Observation-laboratory-uv-ips.structuredefinition - overriding from 0.2 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-imaging-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-imaging-uv-ips
process res: Observation-member-imaging-uv-ips                                   (21.0296sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-laboratory-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-laboratory-uv-ips
process res: Observation-member-laboratory-uv-ips                                (21.0316sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Observation-member-laboratory-uv-ips.structuredefinition - overriding from 0.2 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-member-imaging-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-member-imaging-uv-ips
process res: Observation-member-pathology-uv-ips                                 (21.0340sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Observation-member-pathology-uv-ips.structuredefinition - overriding from 0.2 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-member-laboratory-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-member-laboratory-uv-ips
process res: Observation-pathology-uv-ips                                        (21.0365sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Observation-pathology-uv-ips.structuredefinition - overriding from 0.2 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-member-pathology-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-member-pathology-uv-ips
process res: Observation-pregnancy-edd-uv-ips                                    (21.0388sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-pathology-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-pathology-uv-ips
process res: Observation-pregnancy-outcome-uv-ips                                (21.0404sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-pregnancy-edd-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-pregnancy-edd-uv-ips
process res: Observation-pregnancy-status-uv-ips                                 (21.0428sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-pregnancy-outcome-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-pregnancy-outcome-uv-ips
process res: Observation-tobaccouse-uv-ips                                       (21.0443sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-pregnancy-status-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-pregnancy-status-uv-ips
process res: Observation-uv-ips                                                  (21.0457sec)
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-tobaccouse-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-tobaccouse-uv-ips
process res: Organization-laboratory-uv-ips                                      (21.0472sec)
Business version mismatch in /Users/rhausam/git-repo/fhir-ips/resources/Organization-laboratory-uv-ips.structuredefinition - overriding from 0.2 to 0.2.0
Unable to generate snapshot for http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-uv-ips because Observation.effective[x] has children (Observation.effective[x].extension) and multiple types (dateTime, Period, Timing, instant) in profile Observation-uv-ips
</pre></div>


<p>Whenever it hits the effective[x] or timing[x] element that triggers the "Unable to generate snapshot" error, the snapshot generation appears as being truncated at that point (prior to rendering the extension in the snapshot):<br>
<a href="/user_uploads/10155/6VYSkBGYs34ByxUp2ZIf0Eo0/Screen-Shot-2019-02-03-at-23.22.47.png" target="_blank" title="Screen-Shot-2019-02-03-at-23.22.47.png">Screen-Shot-2019-02-03-at-23.22.47.png</a> <a href="/user_uploads/10155/mjl1pCyIi-sq88VqsRwtZ_b6/Screen-Shot-2019-02-03-at-23.23.52.png" target="_blank" title="Screen-Shot-2019-02-03-at-23.23.52.png">Screen-Shot-2019-02-03-at-23.23.52.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/6VYSkBGYs34ByxUp2ZIf0Eo0/Screen-Shot-2019-02-03-at-23.22.47.png" target="_blank" title="Screen-Shot-2019-02-03-at-23.22.47.png"><img src="/user_uploads/10155/6VYSkBGYs34ByxUp2ZIf0Eo0/Screen-Shot-2019-02-03-at-23.22.47.png"></a></div><div class="message_inline_image"><a href="/user_uploads/10155/mjl1pCyIi-sq88VqsRwtZ_b6/Screen-Shot-2019-02-03-at-23.23.52.png" target="_blank" title="Screen-Shot-2019-02-03-at-23.23.52.png"><img src="/user_uploads/10155/mjl1pCyIi-sq88VqsRwtZ_b6/Screen-Shot-2019-02-03-at-23.23.52.png"></a></div>



<a name="157727415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157727415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157727415">(Feb 06 2019 at 21:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Have you had a chance yet to look at the snapshot issues with this?</p>



<a name="157738447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/157738447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#157738447">(Feb 06 2019 at 23:51)</a>:</h4>
<p>ok will commit fix soon</p>



<a name="172142953"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172142953" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172142953">(Jul 31 2019 at 16:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191336">@Michel Rutten</span>  One thing I think it never occurred to me (until now) to clarify - are all of the fixes to this expected to be available for use with the current R4 release based on using the newer validator and IG publisher, or do they depend also on further updates to the R4 spec itself (i.e. CI build or R5, or maybe R4 technical correction)?</p>



<a name="172143420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172143420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172143420">(Jul 31 2019 at 16:47)</a>:</h4>
<p>I think the intention is to:<br>
1) improve tooling implementations, fix bugs<br>
2) Publish R4 technical correction<br>
If feasible, i.e. if the required changes are compatible. However incompatible changes will need to wait for R5.</p>



<a name="172144127"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172144127" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172144127">(Jul 31 2019 at 16:57)</a>:</h4>
<p>So, I think you are confirming that an IG and profiles that are based on the current released version of R4 (4.0.0), using the latest tooling, wouldn't be able to make use of these enhancements?</p>



<a name="172144359"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172144359" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172144359">(Jul 31 2019 at 17:00)</a>:</h4>
<p>It depends... If we succeed to address this by improving tooling, then you may be able to use this on R4 (4.0.0). If something requires a correction or change in the FHIR spec, then you will need to wait for R4.1 (or R5).</p>



<a name="172144446"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172144446" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172144446">(Jul 31 2019 at 17:01)</a>:</h4>
<p>Right.  That's what I would like to clarify - where exactly are we now with that?</p>



<a name="172144488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172144488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172144488">(Jul 31 2019 at 17:01)</a>:</h4>
<p>I guess we're currently still investigating...</p>



<a name="172144781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172144781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172144781">(Jul 31 2019 at 17:04)</a>:</h4>
<p>Maybe <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> can shed some more light?</p>



<a name="172167439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172167439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172167439">(Jul 31 2019 at 21:26)</a>:</h4>
<p>There is something wrong (or at least incomplete) about this.  When we add the dataAbsentReason extension to MedicationStatement.effective[x] in the IPS <a href="https://build.fhir.org/ig/HL7/fhir-ips/StructureDefinition-MedicationStatement-uv-ips.html" target="_blank" title="https://build.fhir.org/ig/HL7/fhir-ips/StructureDefinition-MedicationStatement-uv-ips.html">profile</a>, that itself seems to work OK, but then in both the differential and the snapshot the IG Publisher no longer renders the effectiveDateTime and effectivePeriod choices.  And if instead you try to slice it, that does show the choices but with all three elements as siblings, and then it's not really obvious that effectiveDateTime and effectivePeriod are actually the choices for effective[x] (and that effective[x] itself can't actually exist).</p>
<p>And when you are just adding the extension to the base effective[x] element (not explicitly slicing) the build qa shows these information messages (at least they're not errors):</p>
<div class="codehilite"><pre><span></span>Bundle/IPS-examples-Bundle-01: Bundle.entry[5].resource.effective.ofType(Period).start  information Could not verify slice for profile http://hl7.org/fhir/uv/ips/StructureDefinition/MedicationStatement-uv-ips
Bundle/IPS-examples-Bundle-01: Bundle.entry[6].resource.effective.ofType(Period).start  information Could not verify slice for profile http://hl7.org/fhir/uv/ips/StructureDefinition/MedicationStatement-uv-ips
</pre></div>


<p>And if instead I explicitly slice the two types, in addition to the sibling element rendering that I mentioned before I also get a broken link error that it can't resolve the effective[x].extension (I don't have a copy of that error message at the moment).</p>



<a name="172169927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172169927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172169927">(Jul 31 2019 at 21:58)</a>:</h4>
<p>how do I reproduce this?</p>



<a name="172180658"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172180658" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172180658">(Aug 01 2019 at 00:54)</a>:</h4>
<p>the non-sliced version is in the IPS IG repo, if you build that<br>
and the code for the (implicit) slicing is commented out in MedicationStatement-uv-ips.structuredefinition.xml in lines 158-177</p>



<a name="172181395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181395">(Aug 01 2019 at 01:10)</a>:</h4>
<p>ok, the non-sliced version, since you shouldn't slice. Here's the diff:</p>
<div class="codehilite"><pre><span></span> <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effective[x].extension&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x].extension&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;effective[x] absence reason&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Provides a reason why the effective is missing.&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Extension&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;profile</span>
                 <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</pre></div>



<a name="172181400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181400">(Aug 01 2019 at 01:10)</a>:</h4>
<p>and here's the rendering:</p>



<a name="172181433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181433">(Aug 01 2019 at 01:11)</a>:</h4>
<p><a href="/user_uploads/10155/XfrF1Z7W5eYeHlVl5iJo_6LN/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/XfrF1Z7W5eYeHlVl5iJo_6LN/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/XfrF1Z7W5eYeHlVl5iJo_6LN/pasted_image.png"></a></div>



<a name="172181441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181441">(Aug 01 2019 at 01:11)</a>:</h4>
<p>that seems exactly what is expected to me</p>



<a name="172181493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181493">(Aug 01 2019 at 01:12)</a>:</h4>
<p>turning to the snapshot:</p>



<a name="172181530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181530">(Aug 01 2019 at 01:12)</a>:</h4>
<div class="codehilite"><pre><span></span>   <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;short</span>
             <span class="na">value=</span><span class="s">&quot;The date/time or interval when the medication is/was/will be taken&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;definition</span>
                  <span class="na">value=</span><span class="s">&quot;The interval of time during which it is being asserted that the patient is/was/will be taking the medication (or was not taking, when the MedicationStatement.taken element is No).&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;comment</span>
               <span class="na">value=</span><span class="s">&quot;This attribute reflects the period over which the patient consumed the medication and is expected to be populated on the majority of Medication Statements. If the medication is still being taken at the time the statement is recorded, the &amp;quot;end&amp;quot; date will be omitted.  The date/time attribute supports a variety of dates - year, year/month and exact date.  If something more than this is required, this should be conveyed as text.&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;base&gt;</span>
        <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x]&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/base&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;dateTime&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Period&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;isModifier</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;isSummary</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">&quot;workflow&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">&quot;Event.occurrence[x]&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">&quot;w5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">&quot;FiveWs.done[x]&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">&quot;rim&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">&quot;.effectiveTime&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effective[x].id&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x].id&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;representation</span> <span class="na">value=</span><span class="s">&quot;xmlAttr&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;Unique id for inter-element referencing&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;definition</span>
                  <span class="na">value=</span><span class="s">&quot;Unique id for the element within a resource (for internal references). This may be any string value that does not contain spaces.&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;base&gt;</span>
        <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Element.id&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/base&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code&gt;</span>
          <span class="nt">&lt;extension</span>
                     <span class="na">url=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-json-type&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;valueString</span> <span class="na">value=</span><span class="s">&quot;string&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;/extension&gt;</span>
          <span class="nt">&lt;extension</span>
                     <span class="na">url=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-xml-type&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;valueString</span> <span class="na">value=</span><span class="s">&quot;xsd:string&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;/extension&gt;</span>
          <span class="nt">&lt;extension</span>
                     <span class="na">url=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-rdf-type&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;valueString</span> <span class="na">value=</span><span class="s">&quot;xsd:string&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;/extension&gt;</span>
        <span class="nt">&lt;/code&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;isModifier</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;isSummary</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">&quot;rim&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">&quot;n/a&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">&quot;MedicationStatement.effective[x].extension&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;MedicationStatement.effective[x].extension&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;slicing&gt;</span>
        <span class="nt">&lt;discriminator&gt;</span>
          <span class="nt">&lt;type</span> <span class="na">value=</span><span class="s">&quot;value&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;url&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/discriminator&gt;</span>
        <span class="nt">&lt;description</span> <span class="na">value=</span><span class="s">&quot;Extensions are always sliced by (at least) url&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;rules</span> <span class="na">value=</span><span class="s">&quot;open&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/slicing&gt;</span>
      <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">&quot;effective[x] absence reason&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">&quot;Provides a reason why the effective is missing.&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;base&gt;</span>
        <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">&quot;Element.extension&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">&quot;*&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/base&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;Extension&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;profile</span>
                 <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;isModifier</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;isSummary</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">&quot;rim&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">&quot;ANY.nullFlavor&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</pre></div>



<a name="172181561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181561">(Aug 01 2019 at 01:13)</a>:</h4>
<p>that also seems right to me</p>



<a name="172181567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181567">(Aug 01 2019 at 01:13)</a>:</h4>
<p>and the rendering:</p>



<a name="172181627"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181627" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181627">(Aug 01 2019 at 01:14)</a>:</h4>
<p><a href="/user_uploads/10155/1cUlC8IFuOTKTzzQ9xJurUPL/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/1cUlC8IFuOTKTzzQ9xJurUPL/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/1cUlC8IFuOTKTzzQ9xJurUPL/pasted_image.png"></a></div>



<a name="172181642"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181642" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181642">(Aug 01 2019 at 01:14)</a>:</h4>
<p>the id is missing a type.... I think otherwise it is how I expect it to be</p>



<a name="172181819"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172181819" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172181819">(Aug 01 2019 at 01:18)</a>:</h4>
<p>it may be that this is working different for me, since I have a few unreleased fixes. <span class="user-mention" data-user-id="191405">@Rob Hausam</span></p>



<a name="172183265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172183265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172183265">(Aug 01 2019 at 01:51)</a>:</h4>
<p>yes, I saw that you made more changes - I might do a local build to check, unless you are going to be releasing imminently</p>



<a name="172183744"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172183744" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172183744">(Aug 01 2019 at 02:03)</a>:</h4>
<p>it's building, but that takes 90min right now</p>



<a name="172188838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172188838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172188838">(Aug 01 2019 at 03:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  With the new 0.9.47 IG Publisher I'm not seeing any difference (that I've been able to notice) with what was there before.  It still does seem strange to me that the effectiveDateTime and effectivePeriod choices aren't being rendered in the snapshot, whereas they are in the core spec.  That doesn't seem great to me, but I can probably live with it.  I'm also still getting the "Could not verify slice" information messages in the qa  that I posted above.  Do we just ignore those?</p>



<a name="172188957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172188957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172188957">(Aug 01 2019 at 04:00)</a>:</h4>
<p>oh - the way they are in the core spec - that's a different set of code.</p>



<a name="172189023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172189023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172189023">(Aug 01 2019 at 04:00)</a>:</h4>
<p>but it raises an interesting question - the rendering of children would run into the rendering of choices if I brought the choice rendering across - they're not differentiated</p>



<a name="172189030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172189030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172189030">(Aug 01 2019 at 04:00)</a>:</h4>
<p>I'll look into the slice validation</p>



<a name="172189047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172189047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172189047">(Aug 01 2019 at 04:01)</a>:</h4>
<p>ok</p>



<a name="172189233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/172189233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#172189233">(Aug 01 2019 at 04:04)</a>:</h4>
<p>yes, the choice and child rendering is in the same space so they have the potential to collide or be confused - but maybe there is some way to differentiate them and indicate that they are distinct?</p>



<a name="186128027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/186128027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#186128027">(Jan 20 2020 at 19:36)</a>:</h4>
<p>I'm resurrecting this somewhat old thread, as I'm not sure exactly where we've gotten with it (in the R4 technical correction, particularly).  When I build the IPS IG with the latest publisher I'm getting a snapshot error on the MedicationStatement-uv-ips profile, which uses the data-absent-reason extension on effective[x]:</p>
<div class="codehilite"><pre><span></span>Error in snapshot generation: The profile http://hl7.org/fhir/uv/ips/StructureDefinition/MedicationStatement-uv-ips has 2 elements in the differential (id: MedicationStatement.effective[x], id: MedicationStatement.effective[x]:data-absent-reason) that don&#39;t have a matching element in the snapshot: check that the path and definitions are legal in the differential (including order)
Differential:
  MedicationStatement : [0..null]
  MedicationStatement.id : [0..null]
  MedicationStatement.status : [0..null]
  MedicationStatement.medication[x] : CodeableConcept([CanonicalType[http://hl7.org/fhir/uv/ips/StructureDefinition/CodeableConcept-uv-ips]])|Reference[0..null]
  MedicationStatement.effective[x] : [1..1]
  MedicationStatement.effective[x].extension : Extension([CanonicalType[http://hl7.org/fhir/StructureDefinition/data-absent-reason]])[0..1]
  MedicationStatement.subject : Reference[0..null]
  MedicationStatement.subject.reference : [1..null]
  MedicationStatement.informationSource : [0..null]
  MedicationStatement.dosage : [0..null]
  MedicationStatement.dosage.text : [0..null]
  MedicationStatement.dosage.timing : [0..null]
  MedicationStatement.dosage.route : CodeableConcept([CanonicalType[http://hl7.org/fhir/uv/ips/StructureDefinition/CodeableConcept-uv-ips]])[0..null]
Snapshot:
  MedicationStatement : [0..*]  constraints=5
  MedicationStatement.id : string[0..1]
  MedicationStatement.meta : Meta[0..1]  constraints=1
  MedicationStatement.implicitRules : uri[0..1]  constraints=1
  MedicationStatement.language : code[0..1]  constraints=1
  MedicationStatement.text : Narrative[0..1]  constraints=1
  MedicationStatement.contained : Resource[0..*]
  MedicationStatement.extension : Extension[0..*]  constraints=2
  MedicationStatement.modifierExtension : Extension[0..*]  constraints=2
  MedicationStatement.identifier : Identifier[0..*]  constraints=1
  MedicationStatement.basedOn : Reference[0..*]  constraints=1
  MedicationStatement.partOf : Reference[0..*]  constraints=1
  MedicationStatement.status : code[1..1]  constraints=1
  MedicationStatement.statusReason : CodeableConcept[0..*]  constraints=1
  MedicationStatement.category : CodeableConcept[0..1]  constraints=1
  MedicationStatement.medication[x] : CodeableConcept([CanonicalType[http://hl7.org/fhir/uv/ips/StructureDefinition/CodeableConcept-uv-ips]])|Reference[1..1]  constraints=1
  MedicationStatement.subject : Reference[1..1]  constraints=1
  MedicationStatement.subject.id : string[0..1]
  MedicationStatement.subject.extension : Extension[0..*] (slicing by url)  constraints=2
  MedicationStatement.subject.reference : string[1..1]  constraints=1
  MedicationStatement.subject.type : uri[0..1]  constraints=1
  MedicationStatement.subject.identifier : Identifier[0..1]  constraints=1
  MedicationStatement.subject.display : string[0..1]  constraints=1
  MedicationStatement.context : Reference[0..1]  constraints=1
  MedicationStatement.effective[x] : dateTime|Period[0..1]  constraints=1
  MedicationStatement.dateAsserted : dateTime[0..1]  constraints=1
  MedicationStatement.informationSource : Reference[0..1]  constraints=1
  MedicationStatement.derivedFrom : Reference[0..*]  constraints=1
  MedicationStatement.reasonCode : CodeableConcept[0..*]  constraints=1
  MedicationStatement.reasonReference : Reference[0..*]  constraints=1
  MedicationStatement.note : Annotation[0..*]  constraints=1
  MedicationStatement.dosage : Dosage[0..*]  constraints=1
  MedicationStatement.dosage.id : string[0..1]
  MedicationStatement.dosage.extension : Extension[0..*] (slicing by url)  constraints=2
  MedicationStatement.dosage.modifierExtension : Extension[0..*]  constraints=2
  MedicationStatement.dosage.sequence : integer[0..1]  constraints=1
  MedicationStatement.dosage.text : string[0..1]  constraints=1
  MedicationStatement.dosage.additionalInstruction : CodeableConcept[0..*]  constraints=1
  MedicationStatement.dosage.patientInstruction : string[0..1]  constraints=1
  MedicationStatement.dosage.timing : Timing[0..1]  constraints=1
  MedicationStatement.dosage.asNeeded[x] : boolean|CodeableConcept[0..1]  constraints=1
  MedicationStatement.dosage.site : CodeableConcept[0..1]  constraints=1
  MedicationStatement.dosage.route : CodeableConcept([CanonicalType[http://hl7.org/fhir/uv/ips/StructureDefinition/CodeableConcept-uv-ips]])[0..1]  constraints=1
  MedicationStatement.dosage.method : CodeableConcept[0..1]  constraints=1
  MedicationStatement.dosage.doseAndRate : Element[0..*]  constraints=1
  MedicationStatement.dosage.doseAndRate.id : string[0..1]
  MedicationStatement.dosage.doseAndRate.extension : Extension[0..*] (slicing by url)  constraints=2
  MedicationStatement.dosage.doseAndRate.type : CodeableConcept[0..1]  constraints=1
  MedicationStatement.dosage.doseAndRate.dose[x] : Range|Quantity([CanonicalType[http://hl7.org/fhir/StructureDefinition/SimpleQuantity]])[0..1]  constraints=1
  MedicationStatement.dosage.doseAndRate.rate[x] : Ratio|Range|Quantity([CanonicalType[http://hl7.org/fhir/StructureDefinition/SimpleQuantity]])[0..1]  constraints=1
  MedicationStatement.dosage.maxDosePerPeriod : Ratio[0..1]  constraints=1
  MedicationStatement.dosage.maxDosePerAdministration : Quantity([CanonicalType[http://hl7.org/fhir/StructureDefinition/SimpleQuantity]])[0..1]  constraints=1
  MedicationStatement.dosage.maxDosePerLifetime : Quantity([CanonicalType[http://hl7.org/fhir/StructureDefinition/SimpleQuantity]])[0..1]  constraints=1
</pre></div>


<p>This appears to be related to the use of the extension on the polymorphic type.  Maybe there is something that we need to change for this in the <a href="/user_uploads/10155/j3QIhn7YdzkM5rnxjnRHzoGp/MedicationStatement-uv-ips.structuredefinition.xml" target="_blank" title="MedicationStatement-uv-ips.structuredefinition.xml">profile</a>?:</p>
<div class="codehilite"><pre><span></span>        &lt;element id=&quot;MedicationStatement.effective[x]&quot;&gt;
            &lt;path value=&quot;MedicationStatement.effective[x]&quot;/&gt;
            &lt;min value=&quot;1&quot;/&gt;
            &lt;max value=&quot;1&quot;/&gt;
            &lt;mustSupport value=&quot;true&quot;/&gt;
        &lt;/element&gt;
        &lt;element id=&quot;MedicationStatement.effective[x]:data-absent-reason&quot;&gt;
            &lt;path value=&quot;MedicationStatement.effective[x].extension&quot;/&gt;
            &lt;short value=&quot;effective[x] absence reason&quot;/&gt;
            &lt;definition value=&quot;Provides a reason why the effective is missing.&quot;/&gt;
            &lt;max value=&quot;1&quot;/&gt;
            &lt;type&gt;
                &lt;code value=&quot;Extension&quot;/&gt;
                &lt;profile value=&quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;/&gt;
            &lt;/type&gt;
            &lt;mustSupport value=&quot;true&quot;/&gt;
        &lt;/element&gt;
</pre></div>


<p>Or maybe this hasn't been fully implemented in the snapshot generator?  I don't know if we have any explicit documentation on it - I didn't see any in the <a href="http://hl7.org/fhir/extensibility.html#2.5.0" target="_blank" title="http://hl7.org/fhir/extensibility.html#2.5.0">Extensibility</a> section.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>?</p>



<a name="186128808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/186128808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#186128808">(Jan 20 2020 at 19:49)</a>:</h4>
<p>is this in the currently committed IPS?</p>



<a name="186128820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/186128820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#186128820">(Jan 20 2020 at 19:49)</a>:</h4>
<p>yes</p>



<a name="186130111"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/186130111" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#186130111">(Jan 20 2020 at 20:12)</a>:</h4>
<p>By the way, this particular snapshot generation error and two others that I fixed (by re-ordering the elements correctly) didn't show up in the IG build qa page on in the report of errors,  warnings and info at the end of the build.  I assume that they should?  They are quite easy to overlook, otherwise, being buried in the rather voluminous build log output.</p>



<a name="186141415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/186141415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#186141415">(Jan 20 2020 at 23:44)</a>:</h4>
<p>actually, the reason is much more prosaic - you have the elements out of order in your differential, and you're not getting an error because the IG publisher sorts your differential before it processes it directly, but composition depends on it and so it gets the snapshot generated internally without sorting. So you see the error associated with that internal iteration, but not the later one which would be linked to qa.</p>



<a name="186143840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/186143840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#186143840">(Jan 21 2020 at 00:47)</a>:</h4>
<p>Yes, thanks (and apologies for bothering you with it).  The order was what I first thought about and looked at, but somehow I still missed that effective[x] and subject were still in the wrong order. :(</p>



<a name="186143853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179177-conformance/topic/Extensions%20on%20Polymorphic%20types/near/186143853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179177-conformance/topic/Extensions.20on.20Polymorphic.20types.html#186143853">(Jan 21 2020 at 00:47)</a>:</h4>
<p>well, in the future it will be an explicit error</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
