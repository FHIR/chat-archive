---
layout: page
title: "FHIR Chat  · VRDR Java Lib · Death on FHIR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179301-Death-on-FHIR/index.html">Death on FHIR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179301-Death-on-FHIR/topic/VRDR.20Java.20Lib.html">VRDR Java Lib</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="248277024"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179301-Death%20on%20FHIR/topic/VRDR%20Java%20Lib/near/248277024" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Doug Wheeler <a href="https://fhir.github.io/chat-archive/stream/179301-Death-on-FHIR/topic/VRDR.20Java.20Lib.html#248277024">(Aug 03 2021 at 20:37)</a>:</h4>
<p>Time of Injury in the VRDR-Injury-Incident is in Zulu time in VRDR.   </p>
<p>I am using the .toHumanDisplay method in the VRDR Java Lib (see below) to process the date.  This seems to be working assuming the date is converted to AM/PM vs 24 hour format.</p>
<p>But the business would like data be in 24 hour format.</p>
<p>Are there helper methods for working with dates in 24 format?</p>
<div class="codehilite"><pre><span></span><code>                    if (injuryIncidentList.get(0).getEffectiveDateTimeType() != null &amp;&amp; !injuryIncidentList.get(0).getEffectiveDateTimeType().isEmpty()) {
                        log.debug(String.format(&quot;Date/Time of Injury[%s]&quot;, injuryIncidentList.get(0).getEffectiveDateTimeType()));
                        log.debug(String.format(&quot;Date/Time of Injury[%s] (toHumanDisplay)&quot;, injuryIncidentList.get(0).getEffectiveDateTimeType().toHumanDisplay()));
                        SimpleDateFormat dateTimeFormat = new SimpleDateFormat(&quot;MMM dd, yyyy HH:mm:ss a&quot;);
                        Date parsedTimeDate = dateTimeFormat.parse(injuryIncidentList.get(0).getEffectiveDateTimeType().toHumanDisplay());
                        SimpleDateFormat yyyyMMddFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
                        log.debug(String.format(&quot;Date of Injury[%s]&quot;, yyyyMMddFormat.format(parsedTimeDate)));
                        deathRecord.setInjuryDt(new Timestamp(parsedTimeDate.getTime()));
                        SimpleDateFormat hhMMFormat = new SimpleDateFormat(&quot;HHmm&quot;);
                        log.debug(String.format(&quot;Time of Injury[%s]&quot;, hhMMFormat.format(parsedTimeDate)));
                        deathRecord.setInjuryTm(hhMMFormat.format(parsedTimeDate));
                        if (injuryIncidentList.get(0).getEffectiveDateTimeType().toHumanDisplay().endsWith(&quot;AM&quot;)) {
                            deathRecord.setInjuryTmInd(&quot;A&quot;);
                        } else if (injuryIncidentList.get(0).getEffectiveDateTimeType().toHumanDisplay().endsWith(&quot;PM&quot;)) {
                            deathRecord.setInjuryTmInd(&quot;P&quot;);
                        } else {
                            log.error(&quot;InjuryTmInd should never be anything other than AM or PM.&quot;);
                        }
                    } else {
                        log.debug(&quot;No date of injury provided...&quot;);
                        deathRecord.setInjuryDt(null);
                        deathRecord.setInjuryTm(null);
                        deathRecord.setInjuryTmInd(null);
                    }





  &quot;fullUrl&quot;: &quot;Observation/edc22fab-bddc-4998-8c14-32bcb5670b8f&quot;,
  &quot;resource&quot;: {
    &quot;id&quot;: &quot;edc22fab-bddc-4998-8c14-32bcb5670b8f&quot;,
    &quot;meta&quot;: {
      &quot;profile&quot;: [
        &quot;http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Injury-Incident&quot;
      ]
    },
    &quot;extension&quot;: [
      {
        &quot;url&quot;: &quot;http://www.hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Injury-Location&quot;,
        &quot;valueReference&quot;: {
          &quot;reference&quot;: &quot;Location/15d0a832-d9fe-493e-b83c-b1411c43643a&quot;
        }
      }
    ],
    &quot;code&quot;: {
      &quot;coding&quot;: [
        {
          &quot;system&quot;: &quot;http://loinc.org&quot;,
          &quot;code&quot;: &quot;11374-6&quot;,
          &quot;display&quot;: &quot;Injury incident description&quot;
        }
      ]
    },
    &quot;subject&quot;: {
      &quot;reference&quot;: &quot;Patient/c3ffe013-be0e-447f-86b6-ff108ffd26d9&quot;
    },
    &quot;effectiveDateTime&quot;: &quot;2020-11-17T00:00:00-05:00&quot;,
    &quot;valueString&quot;: &quot;Fell off building&quot;,
    &quot;component&quot;: [
      {
        &quot;code&quot;: {
          &quot;coding&quot;: [
            {
              &quot;system&quot;: &quot;http://loinc.org&quot;,
              &quot;code&quot;: &quot;69450-5&quot;,
              &quot;display&quot;: &quot;Place of injury&quot;
            }
          ]
        },
        &quot;valueString&quot;: &quot;Office Building&quot;
      },
      {
        &quot;code&quot;: {
          &quot;coding&quot;: [
            {
              &quot;system&quot;: &quot;http://loinc.org&quot;,
              &quot;code&quot;: &quot;69448-9&quot;,
              &quot;display&quot;: &quot;Injury leading to death associated with transportation event&quot;
            }
          ]
        },
        &quot;valueCodeableConcept&quot;: {
          &quot;coding&quot;: [
            {
              &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/v2-0136&quot;,
              &quot;code&quot;: &quot;N&quot;,
              &quot;display&quot;: &quot;No&quot;
            }
          ]
        }
      },
      {
        &quot;code&quot;: {
          &quot;coding&quot;: [
            {
              &quot;system&quot;: &quot;http://loinc.org&quot;,
              &quot;code&quot;: &quot;69444-8&quot;,
              &quot;display&quot;: &quot;Did death result from injury at work&quot;
            }
          ]
        },
        &quot;valueCodeableConcept&quot;: {
          &quot;coding&quot;: [
            {
              &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/v2-0136&quot;,
              &quot;code&quot;: &quot;Y&quot;,
              &quot;display&quot;: &quot;Yes&quot;
            }
          ]
        }
      }
    ],
    &quot;resourceType&quot;: &quot;Observation&quot;
  }
},
</code></pre></div>

<p><span class="user-mention" data-user-id="194612">@Michael Riley</span></p>



<a name="248849355"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179301-Death%20on%20FHIR/topic/VRDR%20Java%20Lib/near/248849355" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Riley <a href="https://fhir.github.io/chat-archive/stream/179301-Death-on-FHIR/topic/VRDR.20Java.20Lib.html#248849355">(Aug 09 2021 at 13:57)</a>:</h4>
<p><span class="user-mention" data-user-id="295307">@Doug Wheeler</span> Hey Doug, just  getting back from my vacation in over 2 years that's why the response is so late :)</p>
<p>Hapi Fhir uses the apache lang3 utils, and uses the FastDateFormat MEDIUM version. <a href="https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/FastDateFormat.html">https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/FastDateFormat.html</a></p>
<p>If you need the right format, unfortunately I think you have to do it yourself.</p>
<ul>
<li>Initialize a Format instance with the AM/PM formatting you need</li>
<li>Retreive the Instant class from the DateTimeDT</li>
<li>Format the instance</li>
</ul>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
