---
layout: page
title: "FHIR Chat  · subproperties in $lookup Operation · terminology"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/index.html">terminology</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html">subproperties in $lookup Operation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153918809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/153918809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#153918809">(Nov 10 2017 at 08:29)</a>:</h4>
<p>What is the meaning of the property.subproperty return paramters in the $lookup-operation<br>
<a href="http://build.fhir.org/codesystem-operations.html#lookup" target="_blank" title="http://build.fhir.org/codesystem-operations.html#lookup">http://build.fhir.org/codesystem-operations.html#lookup</a><br>
The CodeSystem doesn't have such a property...</p>



<a name="153918815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/153918815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#153918815">(Nov 10 2017 at 09:14)</a>:</h4>
<p>These sub-properties are principally for returning SNOMED CT attributes contained in relationship groups. Understand that there isn't a sub-property element in the CodeSystem resource, not sure if one is required because at this level it's not easy to find common patterns across different code systems.</p>



<a name="153918824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/153918824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#153918824">(Nov 10 2017 at 10:05)</a>:</h4>
<p>we're trialling stuff. might be an extension or not, and probably will be consistent</p>



<a name="173072985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173072985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elise Myers <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173072985">(Aug 13 2019 at 00:04)</a>:</h4>
<p>I think I understand how FHIR sub-properties can express SNOMED CT relationship groups. However, all examples I can find of sub-properties in the CodeSystem resource don't use the <code>property.code</code> field which, according to the most recent spec, has a <code>1..1</code> cardinality. What is meant to go in the <code>property.code</code> field for these grouped sub-properties?</p>



<a name="173087508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173087508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173087508">(Aug 13 2019 at 05:49)</a>:</h4>
<p>That's an interesting conundrum; for SNOEMD CT I would expect that the natural value would be the SNOMED code for |Role group| 609096000 - <a href="http://ontoserver.csiro.au/shrimp/?concept=609096000" target="_blank" title="http://ontoserver.csiro.au/shrimp/?concept=609096000">http://ontoserver.csiro.au/shrimp/?concept=609096000</a></p>



<a name="173111723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173111723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173111723">(Aug 13 2019 at 13:13)</a>:</h4>
<p><span class="user-mention" data-user-id="224108">@Elise Myers</span>  I don't think I'm following how examples of "sub-properties" aren't using CodeSystem.property.code, since it is required.  I must be missing something.  Which examples are you referring to?</p>



<a name="173127899"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173127899" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elise Myers <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173127899">(Aug 13 2019 at 16:18)</a>:</h4>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span>  In the XML on this ticket <a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14329" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14329">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14329</a> , you can see that the property parameters and their sub-properties utilize parts and have name values but no codes. In figure 2 in these docs about modeling SNOMED CT <a href="https://confluence.ihtsdotools.org/display/DOCEG/Relationship+Group" target="_blank" title="https://confluence.ihtsdotools.org/display/DOCEG/Relationship+Group">https://confluence.ihtsdotools.org/display/DOCEG/Relationship+Group</a> , it looks like the yellow ovals are sub-property codes, the blue boxes are sub-property values and the where the encompassing property.code should be is where that empty circle is to the left.</p>



<a name="173128218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173128218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elise Myers <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173128218">(Aug 13 2019 at 16:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191343">@Michael Lawley</span>  that makes sense to me. But then, would a single concept with multiple grouping of sub-properties have multiple properties with that same code?</p>



<a name="173146011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173146011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173146011">(Aug 13 2019 at 20:01)</a>:</h4>
<p>Yes, they would, and that is exactly how the underlying OWL modelling in SNOMED CT works.<br>
However, I'm not convinced that the 1..1 cardinality for code is correct, nor that this necessarily is the right / best way to expose the SNOMED sub-properties.</p>



<a name="173181005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173181005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173181005">(Aug 14 2019 at 07:27)</a>:</h4>
<p>Two questions for me...<br>
a. When should a Role Group be included - only if all properties are requested (i.e. where the  property is 410662002 |Concept model attribute|), or also if any individual property or combination of properties is requested?<br>
b. When a Role Group is included, should that be regarded as the property and all members of that Role Group as sub-properties?<br>
Looking at an extreme case - 86299006 |Tetralogy of Fallot (disorder)| This concept has 4 Role Groups consisting of the same combination of property types with varying values. How useful is it to include the Role Groups if only a single property (e.g. in this case 246454002 |Occurrence (attribute)|) is requested? It so happens that 246454002 |Occurrence (attribute)| = 255399007 |Congenital (qualifier value)|  is a member of all 4 Role Groups for this concept - does adding the Role Group in this example provide any value other than (maybe) indicating that repeating the same property/value combination 4 times isn't a server bug?</p>



<a name="173271503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173271503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173271503">(Aug 15 2019 at 07:35)</a>:</h4>
<p>This question really does open up a can of worms.<br>
Let's start by considering some simple cases :</p>
<ul>
<li><code>76069003 |Disorder of bone|</code>, which has a |Finding site| of |Bone structure|, and</li>
<li><code>125605004 |Fracture of bone|</code>, which has a |Morphology| of |Fracture| and also a |Finding site| of |Bone structure|, with the two things "grouped" together.</li>
</ul>
<p>One might expect a <code>$lookup</code> on the first to return property[0].code=|Finding site| and property[0].valueCode=|Bone Structure|.<br>
What about the second?  Since they are grouped, then they should be represented as sub-properties with property[0].subproperty[0].code = |Morphology|, property[0].subproperty[0].valueCode = |Fracture|, property[0].subproperty[1].code = |Finding site|, and property[0].subproperty[1].valueCode = |Bone structure|.</p>
<p>But actually, the SNOMED attribute |Finding site| is always grouped, even if there's only a single relationship, so the first should really be property[0].subproperty[0].code = |Finding site|, and property[0].subproperty[0].valueCode = |Bone structure|.</p>
<p>And then we need to address the mandatory property[0].code value for both of these - i.e., what are they sub-properties of?  Since July 2013 SNOMED has had 609096000 |Role group|, so this seems a reasonable option.</p>
<p>But now we look at the <code>$lookup</code> operation itself.  It's up to the server to decide what (sub-)properties are returned unless one or more <code>property</code> parameters are suppled.  How does a client request a sub-property?  Do they just use the only parameter that's available?  If so, then what happens when you do a <code>$lookup</code> on <code>125605004 |Fracture of bone|</code> with property=|Finding site| -- should both sub-properties <em>always</em> be returned, or should that be at the server's discretion?  Furthermore, what should happen for a <code>$lookup</code> for property <code>609096000 |Role group|</code>?</p>



<a name="173276575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173276575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173276575">(Aug 15 2019 at 09:24)</a>:</h4>
<p>my take on this is that this is delegated to a SNOMED CT implementation guide, which we are working on</p>



<a name="173276606"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173276606" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173276606">(Aug 15 2019 at 09:25)</a>:</h4>
<p>Also note that a server can return additional properties than those listed if it wants</p>



<a name="173276974"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173276974" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173276974">(Aug 15 2019 at 09:33)</a>:</h4>
<p>We discussed this issue in this week's SNOMED on FHIR meeting and decided to try and get more opinions by carrying on the debate here!</p>
<p>My inclination, where an individual property belonging to an explicit Role Group is requested, is to return all members of that Role Group as sub-properties of that group in order to provide the full context in which the requested property belongs.</p>



<a name="173276994"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173276994" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173276994">(Aug 15 2019 at 09:33)</a>:</h4>
<p>ok, so given that, I'll engage seriously. What kind of client wants to decompose this stuff fully?</p>



<a name="173277058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173277058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173277058">(Aug 15 2019 at 09:34)</a>:</h4>
<p>and if it does, why?</p>



<a name="173277078"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173277078" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173277078">(Aug 15 2019 at 09:35)</a>:</h4>
<p>I would think that the only client interested in this stuff can parse an expression itself</p>



<a name="173277261"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173277261" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173277261">(Aug 15 2019 at 09:38)</a>:</h4>
<p>Good question, I raised that in the meeting. Traversing a complex parameters resource with numerous parts, etc. isn't a trivial exercise....and yes, I also suggested that I'd be inclined to request the Necessary Normal Form Expression and parse that. Others weren't totally convinced by that.</p>



<a name="173277394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/subproperties%20in%20%24lookup%20Operation/near/173277394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/subproperties.20in.20.24lookup.20Operation.html#173277394">(Aug 15 2019 at 09:41)</a>:</h4>
<p>I'll look forward to hearing why....</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
