---
layout: page
title: "FHIR Chat  · ValueSet/$expand and its parameters · terminology"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/index.html">terminology</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html">ValueSet/$expand and its parameters</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="223337380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/223337380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gabriel Kleinoscheg <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#223337380">(Jan 20 2021 at 06:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  we had an interesting discussion at the CAT26 about hierarchical display of ValueSets. Currently, we are working on the proposals for improvements regarding certain extensions and the <a href="https://www.hl7.org/fhir/valueset-operation-expand.html"><code>$expand</code></a> operation on ValueSets. </p>
<p>Regarding the <code>$expand</code> operation we talked about the parameters <code>excludeNested</code> and <code>excludeNotForUI</code>. While I still remember the use case for <code>excludeNotForUI</code>, I forgot or do not find it in my notes what the use case for <code>excludeNested</code> was and how it differs from <code>excludeNotForUI</code>.</p>
<p>I would be grateful if you could tell me again, when <code>excludeNested</code> would be best to use. Thank you!</p>



<a name="223347530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/223347530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gabriel Kleinoscheg <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#223347530">(Jan 20 2021 at 09:11)</a>:</h4>
<p><span class="user-mention" data-user-id="372341">@Nikola Tanjga</span></p>



<a name="223432657"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/223432657" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#223432657">(Jan 20 2021 at 20:45)</a>:</h4>
<p>it's a subtle difference, and maybe not important. </p>
<ul>
<li>
<p>excludeNotForUI - omit any concepts from the expansion that are solely present for UI navigation purposes (typically, these are not selectable)</p>
</li>
<li>
<p>excludeNested - just return a flat list. </p>
</li>
</ul>
<p>These are different if there is a hierarchy where the nodes that have children are selectable and/or not just included for UI navigation purposes</p>



<a name="223478260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/223478260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gabriel Kleinoscheg <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#223478260">(Jan 21 2021 at 07:55)</a>:</h4>
<p>What would then be the outcome if I exclude those concepts which are solely for UI navigation assuming that some of these concepts have children and I have <code>excludeNested = false</code>? I.e. I want to preserve the hierarchy but without the concepts for UI (which are parents of some other concepts).</p>



<a name="223480828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/223480828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#223480828">(Jan 21 2021 at 08:33)</a>:</h4>
<p>you might not be able to do that</p>



<a name="223485240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/223485240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gabriel Kleinoscheg <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#223485240">(Jan 21 2021 at 09:28)</a>:</h4>
<p>Alright - thank you <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="245027661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245027661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Wiedekopf <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245027661">(Jul 06 2021 at 11:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="376049">Gabriel Kleinoscheg</span> <a href="#narrow/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters/near/223478260">said</a>:</p>
<blockquote>
<p>What would then be the outcome if I exclude those concepts which are solely for UI navigation assuming that some of these concepts have children and I have <code>excludeNested = false</code>? I.e. I want to preserve the hierarchy but without the concepts for UI (which are parents of some other concepts).</p>
</blockquote>
<p>Hi, we in Germany have been wondering about the <code>exludeNested</code> parameter. The way we understand it, <code>excludeNested=false</code> would maintain the hierarchy of the underlying CodeSystem(-s) when expanding an appropriate ValueSet. That would be fantastic for feasibility applications where inclusion and exclusion parameters are defined using some domain-specific ValueSets (e.g. all diabetes-related ICD-10-GM codes). </p>
<p>If this parameter is supposed to do what we think it does, we could take that expansion data structure and build UI for selecting groups of codes or specific codes.</p>
<p>Problem is that we are not entirely clear whether <code>exludeNested</code> does that, since the description on <a href="https://www.hl7.org/fhir/valueset-operation-expand.html">https://www.hl7.org/fhir/valueset-operation-expand.html</a> not entirely clear on the use case. Looking at the above thread, I seem to not be the only one wondering about the intention of that parameter. The terminology server we are looking at currently (Ontoserver) does not seem to consider the parameter either. Could someone please clarify if we understand it correctly? Thanks!</p>



<a name="245086824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245086824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert McClure <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245086824">(Jul 06 2021 at 19:23)</a>:</h4>
<p><span class="user-mention" data-user-id="191364">@Peter Jordan</span> <span class="user-mention" data-user-id="191405">@Rob Hausam</span> <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span></p>



<a name="245086891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245086891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert McClure <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245086891">(Jul 06 2021 at 19:24)</a>:</h4>
<p><span class="user-mention" data-user-id="191343">@Michael Lawley</span></p>



<a name="245089017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245089017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245089017">(Jul 06 2021 at 19:41)</a>:</h4>
<p>I wasn't involved with the definition of that parameter.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>?</p>



<a name="245106936"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245106936" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245106936">(Jul 06 2021 at 22:34)</a>:</h4>
<p>Terminz doesn't support that parameter either and I also find the description in the specification to be confusing. The only practical uses that I can see are if the ValueSet definition has a compose.include.valueSet element that refers to an extensional ValueSet with nested contains elements, or the later type of ValueSet is passed as a parameter to an $expand operation.</p>



<a name="245268659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245268659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245268659">(Jul 08 2021 at 03:30)</a>:</h4>
<p>Our interpretation of <code>excludeNested</code> is that, when <code>true</code>, it requires the expansion to be flat (i.e., <code>ValueSet.expansion.contains.contains</code> must always be empty.  When it is <code>false</code>, it <em>allows</em> nesting in the expansion, but does <em>not</em> require it.<br>
Now, Ontoserver never does nesting in the expansion, so we effectively ignore <code>excludeNested</code>.</p>



<a name="245268921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245268921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245268921">(Jul 08 2021 at 03:37)</a>:</h4>
<p>Regarding <code>excludeNotForUI</code>, Ontoserver does not support this, but if/when it does it would rely on the <code>http://hl7.org/fhir/concept-properties#notSelectable</code> property for its behaviour.<br>
So far, we've not had any customers asking for support for this parameter.</p>



<a name="245417323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet/%24expand%20and%20its%20parameters/near/245417323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Wiedekopf <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2F.24expand.20and.20its.20parameters.html#245417323">(Jul 09 2021 at 08:52)</a>:</h4>
<p>OK, thanks for the replies! That clears things up. For the use case we have in mind, a combination of ValueSet/$expand and ConceptMap/$closure probably seems like the next-best-thing to get this hierarchy back for a subset of concepts.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
