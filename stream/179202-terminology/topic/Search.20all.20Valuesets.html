---
layout: page
title: "FHIR Chat  · Search all Valuesets · terminology"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/index.html">terminology</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html">Search all Valuesets</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="257948967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257948967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257948967">(Oct 17 2021 at 21:11)</a>:</h4>
<p><a href="http://jira.hl7.org/browse/FHIR-19442">FHIR#19442</a> proposes to remove the expand across value sets. It wasn't my favourite piece of API but I'm stunned that the requirement it represents ("text search across all terminology on the server") isn't a compelling thing for other servers.</p>
<p><span class="user-mention" data-user-id="191343">@Michael Lawley</span> surely your customers are asking for this?</p>



<a name="257949965"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257949965" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257949965">(Oct 17 2021 at 21:25)</a>:</h4>
<p>The way the <code>@all</code> valuset is defined (all <code>ValueSets</code> known to the system) is problematic from my perspective - I would be more open to all <code>CodeSystems</code> known to the system (but how to treat multiple versions of the same CodeSystem, especially if additional parameters like <code>property=parent</code> are supplied?)</p>



<a name="257950062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257950062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257950062">(Oct 17 2021 at 21:27)</a>:</h4>
<p>So far, we've only had one customer ask about this capability.</p>



<a name="257950182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257950182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257950182">(Oct 17 2021 at 21:29)</a>:</h4>
<p>This part of the definition: "Note that this URL has no fixed meaning - its interpretation is server specific" would, I guess, allow us to provide _some_ support, but I'm not sure how useful it would be in practice.</p>



<a name="257953138"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257953138" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257953138">(Oct 17 2021 at 22:16)</a>:</h4>
<p>I'd be ok with searching all code systems; that was defined before we had CodeSystem.</p>



<a name="257953162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257953162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257953162">(Oct 17 2021 at 22:17)</a>:</h4>
<p>I guess that would the GET [base]/CodeSystem/$search?text=xxxxx</p>



<a name="257953173"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257953173" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257953173">(Oct 17 2021 at 22:17)</a>:</h4>
<p>I'm happy to retire @all if we define something equivalent on codesystem</p>



<a name="257954104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257954104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257954104">(Oct 17 2021 at 22:32)</a>:</h4>
<p>Heh, I had guessed that it was defined before CodeSystem.<br>
If it were instead defined in terms of "all CodeSystems known to the system", we're still stuck with the <code>property</code> problem (although that is not limited to this use-case; I can always define an explicit ValueSet that uses multiple versions of the same CodeSystem).</p>



<a name="257954784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257954784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257954784">(Oct 17 2021 at 22:44)</a>:</h4>
<p>I agree that this makes more sense for code systems than value sets, but still quite challenging for TS providers to implement. For example, what about searching for incomplete terms? That might easily result in GIGO. It's a feature that I might use, but I'm not sure that I would provide it to anyone entering data in an EHR/EMR/PHR.</p>



<a name="257955288"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257955288" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257955288">(Oct 17 2021 at 22:53)</a>:</h4>
<p>totally wouldn't provide to end-users, but totally important for people building value sets  and concept maps</p>



<a name="257956727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257956727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257956727">(Oct 17 2021 at 23:16)</a>:</h4>
<p>Naive implementation is to just do equivalent of [base]/CodeSystem/_search, construct a ValueSet from the results, then pass through to $expand.</p>



<a name="257957201"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257957201" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257957201">(Oct 17 2021 at 23:24)</a>:</h4>
<p>that's possible, yes. though not many systems support _text on code system, and not on code systems on snomed ct</p>



<a name="257962366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257962366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257962366">(Oct 18 2021 at 00:53)</a>:</h4>
<p>sorry - I wasn't proposing using _text -- just a way of implementing an implicit ValueSet for all codesystems -- so a search to get "all known code systems, possibly mix in some extras like SNOMED that may only have an implied existence, and build an internal ValueSet set with (long) list of includes.</p>



<a name="257962445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257962445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257962445">(Oct 18 2021 at 00:55)</a>:</h4>
<p>sure. but what should the API look like for that? that's what I was proposing as an alternative for getting rid of the all valuesets thign</p>



<a name="257964429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257964429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257964429">(Oct 18 2021 at 01:27)</a>:</h4>
<p>oh, ok, then you'd want it to return Codings?</p>



<a name="257964947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257964947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257964947">(Oct 18 2021 at 01:36)</a>:</h4>
<p>returning an expansion is ok</p>



<a name="257996233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/257996233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#257996233">(Oct 18 2021 at 08:52)</a>:</h4>
<p>I think I'd be happier with the implicit ValueSet approach -- my quick prototyping gives reasonable results if I define <code>@all</code> as all codes from the latest (CodeSystem.version) of all CodeSystems known to the system.</p>



<a name="258000404"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/258000404" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#258000404">(Oct 18 2021 at 09:29)</a>:</h4>
<p>well, I think that a text search of all terminology content is a useful thing to have from a consumer's point of view. So I'm not on board with simply removing the functionality per the task at hand.</p>



<a name="258123073"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/258123073" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#258123073">(Oct 19 2021 at 00:27)</a>:</h4>
<p>Given that "all ValueSets known to the system" should include all the "all codes in a codesystem" implicit valuesets and this would subsume any sub-setting valueset, then I think the @all valueset works as being defined in terms of code systems, not valuesets.<br>
The next question is whether its "latest versions of" or "all versions of" the codesystems.</p>



<a name="258123416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/258123416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#258123416">(Oct 19 2021 at 00:31)</a>:</h4>
<p>Doing <code>curl 'http://localhost:8090/fhir/ValueSet/$expand?url=http://hl7.org/fhir/ValueSet/@all&amp;count=10&amp;activeOnly=true&amp;filter=lung'</code> in my prototype with 1246 CodeSystems (mostly FHIR, but several SNOMEDs and LOINC) takes about 8-10 s, finds ~7000 matches and produces 96k of JSON which is mostly just listing all the code system-version pairs scanned.</p>



<a name="258123517"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/258123517" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#258123517">(Oct 19 2021 at 00:32)</a>:</h4>
<p>The <code>contains</code> part of the result looks like:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"contains"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"19.11d"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"C12468"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://jim"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"0.0.3"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"lung"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://id.who.int/icd11/foundation"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"2019-04"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"1338477196"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/v2-0550"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"2.9"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"LUNG"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://jim3"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"0.1.0"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"lung"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/service-type"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"3.5.0"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"380"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://id.who.int/icd11/mms"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"2019-04"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"XA57M6"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://jim"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"0.0.9"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"lung"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"lung"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://snomed.info/sct"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"http://snomed.info/sct/32506021000036107/version/20200430"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"228220003"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Lungi"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://snomed.info/sct"</span><span class="p">,</span>
        <span class="nt">"version"</span><span class="p">:</span> <span class="s2">"http://snomed.info/sct/32506021000036107/version/20200531"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"228220003"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Lungi"</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>Note that there are separate entries for different versions of the same CodeSystem.</p>



<a name="258131863"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/258131863" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#258131863">(Oct 19 2021 at 02:28)</a>:</h4>
<p>well... server discretion on that?</p>



<a name="258306363"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Search%20all%20Valuesets/near/258306363" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Search.20all.20Valuesets.html#258306363">(Oct 20 2021 at 03:18)</a>:</h4>
<p>My experimental support for <code>http://hl7.org/fhir/ValueSet/@all</code> is now testable on <a href="https://r4.ontoserver.csiro.au/fhir">https://r4.ontoserver.csiro.au/fhir</a><br>
Note that there's &gt; 11M (versioned) codes in this sandbox server, so it will not be doing "realtime" <code>$expand?filter=</code> :-)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
