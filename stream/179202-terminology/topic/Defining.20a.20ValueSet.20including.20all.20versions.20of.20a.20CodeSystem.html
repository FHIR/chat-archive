---
layout: page
title: "FHIR Chat  · Defining a ValueSet including all versions of a CodeSystem · terminology"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/index.html">terminology</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html">Defining a ValueSet including all versions of a CodeSystem</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153899336"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153899336" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153899336">(Jul 28 2017 at 21:23)</a>:</h4>
<p>How do I define a ValueSet that allows all codes from all versions of a CodeSystem, e.g.<br>
if I have multiple versions of ICD-10 and thus multiple CodeSystem resources with the same url=http://hl7.org/fhir/sid/icd-10-de but different versions ("2017", "2016" etc) .<br>
The proper Version always depends on context (like encounter admission date), so when profiling, I don't want to bind to any particular version of the catalogue, just to icd-10 in general.</p>
<p>How do I define a valueSet that includes <em>all</em> ICD-10 Codes regardless of version? Do I need to include all versions explicitly , like</p>
<div class="codehilite"><pre><span></span>    <span class="nt">&lt;compose&gt;</span>
        <span class="nt">&lt;include&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/sid/icd-10-de&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;version</span> <span class="na">value =</span> <span class="s">&quot;2017&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/include&gt;</span>
        <span class="nt">&lt;include&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/sid/icd-10-de&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;version</span> <span class="na">value =</span> <span class="s">&quot;2016&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/include&gt;</span>
        <span class="nt">&lt;include&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/sid/icd-10-de&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;version</span> <span class="na">value =</span> <span class="s">&quot;2015&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/include&gt;</span>
        ...
    <span class="nt">&lt;/compose&gt;</span>
</pre></div>


<p>or do I just omit the version altogether and the tx server will automagically expand the valueset to include all versions?</p>



<a name="153899378"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153899378" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153899378">(Jul 28 2017 at 22:36)</a>:</h4>
<p>well, not quite the same - omitting the version defers the choice of version to the terminology server</p>



<a name="153899379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153899379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153899379">(Jul 28 2017 at 22:37)</a>:</h4>
<p>we haven't discussed evaluating outcomes across more than one version. why is that a good idea?</p>



<a name="153899527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153899527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153899527">(Jul 29 2017 at 19:14)</a>:</h4>
<p>Selecting multiple versions can mean you have concepts that overlap in ways that weren't intended by the organization maintaining the terminology.  That said, being able to validate across all versions will be a common requirement.</p>



<a name="153900406"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900406" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900406">(Aug 03 2017 at 16:46)</a>:</h4>
<p>There's not necessarily an overlap, since you can set the CodeSystem to versionNeeded=true, then all instances of the codes must carry a version.<br>
But as LLoyd said, in Profiles we don't want to allow only one version, as they can change from time to time and the validation will never be able to evaluate the rules to decide which version applies (e.g. correct version of ICD-10 catalogue in a Condition is determined by the admission date of the Encouter it references - that's beyond the scope of what validation can do.<br>
But we need profiles to be able to make ICD-10 mandatory.</p>
<p>And right now I'm stuck figuring out how to define the ValueSet for the terminology binding that says "any ICD-10 code is valid, as long as it's a valid code in the version of the catalogue it claims to be from".</p>



<a name="153900426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900426">(Aug 03 2017 at 21:17)</a>:</h4>
<p>"correct version of ICD-10 catalogue in a Condition is determined by the admission date of the Encouter it references - that's beyond the scope of what validation can do." - sounds pretty easy to do this in an invariant</p>



<a name="153900427"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900427" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900427">(Aug 03 2017 at 21:17)</a>:</h4>
<p>"any ICD-10 code is valid, as long as it's a valid code in the version of the catalogue it claims to be from". - also could be done in an invariant, or in a value set that simply imports all versions of ICD-10</p>



<a name="153900469"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900469" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900469">(Aug 04 2017 at 09:56)</a>:</h4>
<p>"...or in a value set that simply imports all versions of ICD-10"<br>
That's exactly what I'm trying to do. But the question is: Do I explicitly have to explicitly include every single version of ICD-10 (Assuming that each of them is a  CodeSystem Resource with the same canonical url but different versions) or is it enough to just include the canonical url and the TX server will "know" that all CodeSystems matching that url need to be included regardless of version.</p>
<p>Even if I validate the "correct" version of a code through an invariant checking the Encounter context at runtime, I'd still need a ValueSet with <em>all</em> versions for the Terminology binding...</p>



<a name="153900478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900478">(Aug 04 2017 at 10:11)</a>:</h4>
<p>you need to list them all at the moment</p>



<a name="153900485"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900485" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900485">(Aug 04 2017 at 10:23)</a>:</h4>
<p>ok. Thanks! This is currently not clearly stated in the spec (unless I'm not seeing it).<br>
This bullet point (sort of) suggests that an unversioned inclusion means "all of them": </p>
<blockquote>
<p>If the system reference is not version specific and filters are present, then the contents of the value set are open and change over time as the underlying code systems are updated</p>
</blockquote>
<p><a href="http://build.fhir.org/valueset.html#compositions" target="_blank" title="http://build.fhir.org/valueset.html#compositions">http://build.fhir.org/valueset.html#compositions</a></p>



<a name="153900520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900520">(Aug 04 2017 at 15:28)</a>:</h4>
<p>This seems like something that should have an easier convention.  It's also problematic if you want to allow for future versions as you can't really reference those in advance and it would be challenging from a maintenance perspective to have to update the value set every time a new version comes out.  We have a convention for referencing versions of <code>[canonicalURL]|[businessVersion]</code>.  Would it make sense to use a convention of <code>[canonicalUrl]|*</code> if you wanted to include all versions?  Obviously those who want a particular range of versions would need to enumerate, but this would cover a lot of use-cases.</p>



<a name="153900523"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900523" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900523">(Aug 04 2017 at 15:44)</a>:</h4>
<p>Yes, the necessity to permantently update the ValueSets when a new version comes out, is a concern. As for the syntax of the convention, I don't have a preference. Whatever suits the TX server implementers best...</p>



<a name="153900556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert McClure <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900556">(Aug 05 2017 at 00:17)</a>:</h4>
<p>My perspective is</p>
<ul>
<li>Value set definition that does not LOCK any or all of the definition to a specifIc code system version, means to test conformance to that value set definition (version) you have to allow all valid code from any valid expansion. </li>
<li>Binding semantics come next, if a binding is not STATIC, then to be conformant you need to test against the same thing as above. STATIC will only allow one expansion. I think that code system version should be the one valid when the IG was published</li>
<li>unless the TS users requests conformance test against a specific code system version, you have to assume any version is ok.</li>
</ul>



<a name="153900582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900582">(Aug 05 2017 at 21:38)</a>:</h4>
<p>note that STATIC is not a think in FHIR. we delegate that decision to the value set</p>



<a name="153900583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900583">(Aug 05 2017 at 21:40)</a>:</h4>
<p>Rob's perspective here is different to FHIR, in that we are specific that if neither value set or the expansion profile specifies the version of the code system, the server performing $expand chooses the version</p>



<a name="153900601"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153900601" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153900601">(Aug 06 2017 at 12:33)</a>:</h4>
<p>Yes, and I think a significant point there is that in that case the server chooses THE version - it's not mandated (at least not currently), but in most cases it is probably going to be (and agruably should be) a single version and most likely that version of the code system will be the latest one that the server provides (which won't necessarily always or immediately be the latest version of the code system that is available from the code system publisher).  I think that the "all versions" value set is a special case (and one that is potentially fraught with problems), and that, if used, it would be best if it was invoked explicity.  In that regard, Lloyd's suggestion of of [canonicalUrl]|* is probably worth considering.</p>



<a name="153921212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153921212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153921212">(Nov 23 2017 at 02:12)</a>:</h4>
<p>Would * be interpreted as "all versions" or as "all versions known to this terminology server"?</p>



<a name="153921213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/Defining%20a%20ValueSet%20including%20all%20versions%20of%20a%20CodeSystem/near/153921213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/Defining.20a.20ValueSet.20including.20all.20versions.20of.20a.20CodeSystem.html#153921213">(Nov 23 2017 at 02:16)</a>:</h4>
<p>I'm also not sure I understand the original use-case.  Surely ICD10-DE 2017 is a superset of ICD10-DE 2016?  but just with some codes active status changed.  I would expect that just this would be suitable?</p>
<div class="codehilite"><pre><span></span>   &lt;compose&gt;
        &lt;include&gt;
            &lt;system value=&quot;http://hl7.org/fhir/sid/icd-10-de&quot; /&gt;
        &lt;/include&gt;
    &lt;/compose&gt;
</pre></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
