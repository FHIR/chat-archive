---
layout: page
title: "FHIR Chat  · ValueSet.compose question · terminology"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/index.html">terminology</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html">ValueSet.compose question</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153998366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998366">(Sep 19 2018 at 20:13)</a>:</h4>
<p>VSD-3 states that "ValueSet.compose.include Cannot have both concept and filter". What about valueSet reference? If a valueSet has all three: concept, filter and valueset reference, should there be three include?</p>



<a name="153998392"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998392" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998392">(Sep 19 2018 at 22:13)</a>:</h4>
<p><span class="user-mention" data-user-id="191506">@Yunwei Wang</span> I think that's a good point.  Probably need a tracker to fix it.  It doesn't make sense to leave the valueSet reference out of the rule and allow arbitrary combinations of it with the others.</p>



<a name="153998409"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998409" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998409">(Sep 19 2018 at 22:54)</a>:</h4>
<p>I think filter + valueSet makes sense</p>



<a name="153998410"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998410" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998410">(Sep 19 2018 at 22:55)</a>:</h4>
<p>I agree that valueSet + concept probably doesn't</p>



<a name="153998411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998411">(Sep 19 2018 at 22:56)</a>:</h4>
<p>Tracker created: <a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=18089&amp;start=0" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=18089&amp;start=0">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=18089&amp;start=0</a></p>



<a name="153998432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998432">(Sep 19 2018 at 23:59)</a>:</h4>
<p>I'm a little conflicted here. From a pure implementation logic perspective there's little reason to disallow any of the combinations; you're just taking an intersection of constraints expressed in different ways.<br>
From a human authoring perspective however it seems strange/degenerate to write something like 'these explicit concepts intersected with this filter/ValueSet' but if the ValueSet definition is machine generated, perhaps based on a template and some input data, then not having these constraints is quite useful.</p>



<a name="153998554"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998554" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998554">(Sep 20 2018 at 12:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191376">@Jim Steel</span> One problem that I see with filter + valueSet is that we have <strong>vsd-2</strong> which says "A value set with concepts or filters SHALL include a system".  So, if that's true, then how would you interpret the combination of system + valueSet, and then would filter apply to only one of them (which one?) or somehow to the combination of the two?  I don't think that was what was intended.  I believe that probably the intent was that compose.include would contain either system (0..1) <strong>or</strong> concept (0..<em>) <strong>or</strong> valueSet(0..</em>), and that both filter and concept are only used with system.  However, back to your point, I can see why it might make sense to use filter + valueSet, but if we agree we want to do that we'll have to revise at least the two (and maybe other?) invariants to make that work and do it consistently.</p>



<a name="153998796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert McClure <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998796">(Sep 21 2018 at 00:20)</a>:</h4>
<p><span class="user-mention" data-user-id="191376">@Jim Steel</span> Agree with you. Filter + Valueset ref definitely makes sense, filter + concept no.<br>
<span class="user-mention" data-user-id="191405">@Rob Hausam</span> What we need is an invariant where include has both ref and filter, the filter must have a system in the value set AND that is the system in the include.</p>



<a name="153998797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998797">(Sep 21 2018 at 00:24)</a>:</h4>
<p>I think continuing to require the system whenever a filter is used (in conjunction with a valueSet or otherwise), because more than constraining the matching concepts' code system, it constrains which filter is being used. For example, if you imported a valueSet that spanned 2 code systems A and B that both supported a filter named 'x', then a ValueSet filter might be ambiguous (e.g. in its type)</p>



<a name="153998813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998813">(Sep 21 2018 at 00:59)</a>:</h4>
<p>filter only applies to system, and must have a system.</p>



<a name="153998814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998814">(Sep 21 2018 at 00:59)</a>:</h4>
<blockquote>
<p>"the filter must have a system in the value set "</p>
</blockquote>
<p>I don't know that that means</p>



<a name="153998815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998815">(Sep 21 2018 at 00:59)</a>:</h4>
<p>Is that only to avoid empty intersections?</p>



<a name="153998985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153998985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert McClure <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153998985">(Sep 21 2018 at 13:55)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> What I was trying to say is that the referenced value set SHALL have the system identified in the include so that the intersection is not NULL.</p>



<a name="153999150"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999150" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999150">(Sep 21 2018 at 22:20)</a>:</h4>
<p>so what if the intersection is null?</p>



<a name="153999224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert McClure <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999224">(Sep 22 2018 at 00:54)</a>:</h4>
<p>It will always be null if the system in the include is not in the ref value set, so why allow that??</p>



<a name="153999240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999240">(Sep 22 2018 at 02:27)</a>:</h4>
<p>well, for several practical reasons. Let's say you have value set A, which says that it imports everything from value set B  that is-a SCT clinical finding. And value set B is authored by someone else</p>



<a name="153999241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999241">(Sep 22 2018 at 02:27)</a>:</h4>
<p>the current version of value set B includes some SCT clinical findings but also some local codes, and a few HL7 codes (nullFlavor code system). Your value set is only the SCT codes</p>



<a name="153999242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999242">(Sep 22 2018 at 02:28)</a>:</h4>
<p>so the author of value set B updates it to no longer include any SCT codes...</p>



<a name="153999243"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999243" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999243">(Sep 22 2018 at 02:28)</a>:</h4>
<p>now, your value set is empty.</p>



<a name="153999244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999244">(Sep 22 2018 at 02:29)</a>:</h4>
<p>I don't see why that's 'an error'. If it is, who's error is it? But why is any empty value set an error? I think that there's various ways of using value sets where the empty set is not an error, it just means that the set of concepts relevant for this particular action is empty</p>



<a name="153999245"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999245" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999245">(Sep 22 2018 at 02:30)</a>:</h4>
<p>eg. you might be using the value set is a criteria test in a decision support system</p>



<a name="153999358"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179202-terminology/topic/ValueSet.compose%20question/near/153999358" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179202-terminology/topic/ValueSet.2Ecompose.20question.html#153999358">(Sep 23 2018 at 23:01)</a>:</h4>
<p>Yeah, I'm inclined to agree with Grahame</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
