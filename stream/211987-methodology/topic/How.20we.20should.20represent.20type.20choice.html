---
layout: page
title: "FHIR Chat  · How we should represent type choice · methodology"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/index.html">methodology</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html">How we should represent type choice</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="178670347"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178670347" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178670347">(Oct 21 2019 at 16:08)</a>:</h4>
<p>Presently, when committees decide that an element is polymorphic, they simply list the types that can be used. </p>
<p>In the heirarchical table, and the XML and Json templates, we do the same thing: simply list the set of types that can be used</p>



<a name="178670433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178670433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178670433">(Oct 21 2019 at 16:09)</a>:</h4>
<p>But in the UML we do something different: we declare the element to be of type "Type" and list the choices as a set of constraints in a stereotype</p>



<a name="178670537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178670537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178670537">(Oct 21 2019 at 16:10)</a>:</h4>
<p>but our decision during the development of R4 that some of the Types can have modifierExtensions complicates that a lot....</p>



<a name="178670561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178670561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178670561">(Oct 21 2019 at 16:10)</a>:</h4>
<p>And Type is not a declared element.</p>



<a name="178670590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178670590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178670590">(Oct 21 2019 at 16:10)</a>:</h4>
<p>generating code to get this right is actually pretty tricky</p>



<a name="178670605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178670605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178670605">(Oct 21 2019 at 16:10)</a>:</h4>
<p>because of the modifier extensions.</p>



<a name="178673537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178673537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178673537">(Oct 21 2019 at 16:40)</a>:</h4>
<blockquote>
<p>because of the modifier extensions.</p>
</blockquote>
<p>Solution is to not allow modifier extensions... I think I have said that before</p>



<a name="178673602"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178673602" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178673602">(Oct 21 2019 at 16:41)</a>:</h4>
<p>I lost on that motion</p>



<a name="178673618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178673618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178673618">(Oct 21 2019 at 16:42)</a>:</h4>
<p>They are allowed on some types</p>



<a name="178673756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178673756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178673756">(Oct 21 2019 at 16:43)</a>:</h4>
<p>The problem is that Dosage is declared as a specialization of BackboneElement, but this is not a Type</p>



<a name="178673829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178673829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178673829">(Oct 21 2019 at 16:44)</a>:</h4>
<p>That is, if Type is declared as an abstract specialization of Element and generalises the common re-usable data types. Which is the notional but undocumented intent of Type</p>



<a name="178804735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178804735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178804735">(Oct 22 2019 at 22:25)</a>:</h4>
<p>So let's start with the abstract types. This is an classic OO model for what's going on with the abstract types, which is not explicit in the specification:</p>



<a name="178804737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178804737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178804737">(Oct 22 2019 at 22:25)</a>:</h4>
<p><a href="/user_uploads/10155/NJWgs0Wf_bFN0lKYN0FqIg9R/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/NJWgs0Wf_bFN0lKYN0FqIg9R/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/NJWgs0Wf_bFN0lKYN0FqIg9R/pasted_image.png"></a></div>



<a name="178804785"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178804785" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178804785">(Oct 22 2019 at 22:26)</a>:</h4>
<p>I'd like to make that model explicit</p>



<a name="178807820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178807820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178807820">(Oct 22 2019 at 23:14)</a>:</h4>
<p>Do you see all of the non-primative types as being descendants of BackboneType, or only some, such as Dose?such as Dose?</p>



<a name="178808099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/178808099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#178808099">(Oct 22 2019 at 23:19)</a>:</h4>
<p>only some. Currently labelled as descending from BackboneElement, but they actually can't unless you allow for polyheirarchy, which I think we should avoid</p>



<a name="179381735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/211987-methodology/topic/How%20we%20should%20represent%20type%20choice/near/179381735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/211987-methodology/topic/How.20we.20should.20represent.20type.20choice.html#179381735">(Oct 29 2019 at 22:29)</a>:</h4>
<p>Follow up on this: MnM agreed today to make this change - to include the UML diagram in the specification, and to change the structure definitions to support it, and to then consult implementers to see if anyone is concerned about this as a breaking change </p>
<p>Note that the only sense I know that this is a breaking change is that it will impact on the code generators for the reference implementations etc</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
