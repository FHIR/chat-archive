---
layout: page
title: "FHIR Chat  · retooling the core build · committers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179165-committers/index.html">committers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html">retooling the core build</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="221832256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221832256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221832256">(Jan 06 2021 at 22:28)</a>:</h4>
<p>ok. I'm getting somewhere. Frustratingly slowly, but somewhere.</p>



<a name="221832278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221832278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221832278">(Jan 06 2021 at 22:28)</a>:</h4>
<p>FYI, here's a copy of the retooled spreadsheets</p>



<a name="221832290"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221832290" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221832290">(Jan 06 2021 at 22:29)</a>:</h4>
<p><a href="/user_uploads/10155/QvNXOCi3OAeghK3yUcfSvyIf/sheets.zip">sheets.zip</a></p>



<a name="221832453"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221832453" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221832453">(Jan 06 2021 at 22:31)</a>:</h4>
<p>they're a little different, since there's some changes under the hood.</p>



<a name="221841811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221841811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221841811">(Jan 07 2021 at 00:16)</a>:</h4>
<p>are these the ones that can be converted back and forth to StructureDefs?</p>



<a name="221842025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221842025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221842025">(Jan 07 2021 at 00:18)</a>:</h4>
<p>I presume there would also be a spreadsheet for defining the valuesets...? <br>
Possibly the Profiles tab will be added as well, I presume.<br>
And final question, when can we play with it? I want to create a DeviceDispense resource and I'll gladly give this a try if that is somehow useful.</p>



<a name="221859390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221859390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221859390">(Jan 07 2021 at 05:45)</a>:</h4>
<p>no. valuesets and code systems are done natively as resources once I introduce this.</p>



<a name="221859394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221859394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221859394">(Jan 07 2021 at 05:45)</a>:</h4>
<p>so are profiles</p>



<a name="221979692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221979692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221979692">(Jan 07 2021 at 18:16)</a>:</h4>
<p>Natively, as in editing JSON files for each resource?</p>



<a name="221985092"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/221985092" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#221985092">(Jan 07 2021 at 18:58)</a>:</h4>
<p>Or XML, I hope...</p>



<a name="222844331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222844331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222844331">(Jan 15 2021 at 11:10)</a>:</h4>
<p>ok. this is now committed and live, so the editing process has changed.</p>



<a name="222844426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222844426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222844426">(Jan 15 2021 at 11:11)</a>:</h4>
<p>up until now, the master definition of the resources has been in a bunch of xml files that are excel spreadsheets. All of the resources part of the build was generated from these spreadsheets</p>



<a name="222844560"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222844560" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222844560">(Jan 15 2021 at 11:13)</a>:</h4>
<p>well, no more. From today, the master definitions will be stored as a series of resources:</p>
<ul>
<li>a structure definition for the resource itself</li>
<li>a bundle of search parameters for the search parameters</li>
<li>3 lists, for examples, operations, profiles</li>
<li>a series of operation definitions, value sets and code systems that support these</li>
</ul>



<a name="222844657"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222844657" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222844657">(Jan 15 2021 at 11:14)</a>:</h4>
<p>These are committed to version control instead of the old xml spreadsheets, which have been removed (for the resources; the data type spreadsheets have not been changed)</p>



<a name="222844807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222844807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222844807">(Jan 15 2021 at 11:16)</a>:</h4>
<p>However, you can still edit the resources using excel. The way this works is that when you run the build, it reads the master definition resources, and creates an excel spreadsheet on the fly (unless it's already open in excel, in which case the file is locked)</p>



<a name="222844855"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222844855" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222844855">(Jan 15 2021 at 11:16)</a>:</h4>
<p>then, when you run a build, the build will check the date of the spreadsheet; if it's been changed since it was written, it will read it, merge the information in it back into the master resources, and then use the updated resources.</p>



<a name="222844923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222844923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222844923">(Jan 15 2021 at 11:17)</a>:</h4>
<p>you don't need to close excel for that to happen. (though you do need to close it if you do a pull, and need the excel spreadsheet updated from new definitions, and I have no way to check on this automatically)</p>



<a name="222845106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222845106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222845106">(Jan 15 2021 at 11:20)</a>:</h4>
<p>the format of the spreadsheets has changed a little. The biggest change is that you no longer can define code systems / value sets for required bindings in the spreadsheet; you do it as native code system and value set resources. The same applies for profiles, extensions etc - these are defined in the native resource format. There's some more subtle changes in the element definitions - the spreadsheet is much more aligned with the formal definitions of the resources now, so you might not really notice the other changes</p>



<a name="222845118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222845118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222845118">(Jan 15 2021 at 11:20)</a>:</h4>
<p>you can edit the master resources directly, if you prefer.</p>



<a name="222845126"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222845126" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222845126">(Jan 15 2021 at 11:20)</a>:</h4>
<p>the spreadsheets are never committed to github</p>



<a name="222908786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222908786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222908786">(Jan 15 2021 at 19:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> a question about R4B, since I'm now working on that - should that be worked on in a branch of the main repo, or should it get it's own repo? </p>
<p>My preferred answer is: it should have it's own repo, and it's own ci-build.</p>



<a name="222909260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222909260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222909260">(Jan 15 2021 at 19:11)</a>:</h4>
<p>Certainly your call. The nice thing about using a branch is that the existing infrastructure would just keep working; what are the advantages to a separate repository?</p>



<a name="222910494"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222910494" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222910494">(Jan 15 2021 at 19:18)</a>:</h4>
<p>It's certainly easier to keep the same infrastructure for the infrastructure maintainers, sure. But I don't think it's easier for the editors.</p>



<a name="222910728"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222910728" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222910728">(Jan 15 2021 at 19:20)</a>:</h4>
<p>for editors, the flow should be the same: commit -&gt; PR to main -&gt; checked PR ok -&gt; commit to master. <br>
Its not the same group of editors either - a smaller subset.</p>



<a name="222917800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222917800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222917800">(Jan 15 2021 at 20:07)</a>:</h4>
<p>Sure, but substitute <code>r4b</code> for <code>main</code> in the flow above, and it's identical for committers. Re: smaller subset of editors, we've never enforced this kind of restriction before but if desired we could manage and enforce this with branch level restrictions like:</p>
<p><a href="/user_uploads/10155/FH50f7ELpVQeSLSItjRhaW7Z/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/FH50f7ELpVQeSLSItjRhaW7Z/image.png" title="image.png"><img src="/user_uploads/10155/FH50f7ELpVQeSLSItjRhaW7Z/image.png"></a></div>



<a name="222917886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222917886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222917886">(Jan 15 2021 at 20:08)</a>:</h4>
<p>(I'm not set against making a separate repo, but I want to make sure we've thought it through.)</p>



<a name="222932132"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/222932132" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#222932132">(Jan 15 2021 at 22:07)</a>:</h4>
<p>well, the principle issue, so far as I can see, is that as far as I know, the ci-build doesn't post r4b to <a href="http://build.fhir.org">build.fhir.org</a>. At least it doesn't at the moment. I guess if that happened, it wouldn't make much difference which repo it is</p>



<a name="223163895"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223163895" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223163895">(Jan 18 2021 at 21:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> ping on this - need resolution in the next few days</p>



<a name="223163991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223163991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223163991">(Jan 18 2021 at 21:08)</a>:</h4>
<p>Note about an R4B limitation: the example value set valueset-nhin-purposeofuse.xml includes a concept map, and the R5 build can't read that as a value set, since concept map has been changed. so that value set won't be listed with other value sets, though it will still appear as an example against the value set resource</p>



<a name="223164315"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223164315" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223164315">(Jan 18 2021 at 21:14)</a>:</h4>
<p>Interesting -- I'm out for the holiday weekend but back tomorrow.  I'd expect r4b to appear in the branch build at /branches, unless there's something causing it to break.</p>



<a name="223164367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223164367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223164367">(Jan 18 2021 at 21:15)</a>:</h4>
<p>I didn't know about /branches and couldn't find any reference to it. Can we update the PR build notification to include the link?</p>



<a name="223185482"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223185482" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223185482">(Jan 19 2021 at 04:03)</a>:</h4>
<p><a href="http://build.fhir.org/branches/gg-big-rework">http://build.fhir.org/branches/gg-big-rework</a> is building, but I'm not sure which branch contains "r4b" (not seeing an active branch with that name); can you include a link here?</p>



<a name="223185987"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223185987" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223185987">(Jan 19 2021 at 04:17)</a>:</h4>
<p>I haven't committed it yet. It will be r4b once I do</p>



<a name="223259840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223259840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223259840">(Jan 19 2021 at 17:21)</a>:</h4>
<p>Oh, OK -- well, I'm hoping it will "just work". When you wrote earlier:</p>
<blockquote>
<p>as far as I know, the ci-build doesn't post r4b to <a href="http://build.fhir.org">build.fhir.org</a>.</p>
</blockquote>
<p>... obviously it doesn't post r4b to the build site until you push r4b to github ;-))</p>



<a name="223260161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223260161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223260161">(Jan 19 2021 at 17:23)</a>:</h4>
<p>Branch builds go poof after 30 days of no new commits, right?  Will that be an issue here?</p>



<a name="223260860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223260860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223260860">(Jan 19 2021 at 17:27)</a>:</h4>
<p>We can set rules as needed.</p>



<a name="223260920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223260920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223260920">(Jan 19 2021 at 17:28)</a>:</h4>
<p>I'm not expecting r4b is going to go inactive for &gt;1mo anytime very soon though; first thing is to get it <em>started</em>.</p>



<a name="223352713"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223352713" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223352713">(Jan 20 2021 at 10:09)</a>:</h4>
<p>ok, tomorrow I'm committing an update to the main build (master) which does 2 things:</p>
<ul>
<li>fixes up a bunch of outstanding issues with the retooled R5 candidate (the master branch)</li>
<li>also is able to run the R4B branch</li>
</ul>
<p>I'll also be committing the R4B branch tomorrow - that's the R4 equivalent using the new formats. e.g. you stilll get spreadsheets if you build locally, just as it works for the R5 branch.</p>
<p>However, you don't build the R4B branch using the java code in R4B itself. Instead, you use the R5 java code to run it. Once I commit, you'll be able to run R4B by hacking the R5 build (which is how I'm doing it now). However, <span class="user-mention" data-user-id="248736">@Mark Iantorno</span> is working on moving the java code out of the FHIR repo all together, and instead we'll use a FHIR publisher jar (like the IG publisher, based on similar infrastructure) to run on either R5 or R4B. Mark will provide updates as he gets that infrastructure in place (though for users + ci-build, it'll be just the same as now: run publish.bat/publish.sh)</p>
<p>One consequence of all this is that we won't have a ci-build for R4B until Mark gets his changes in place</p>



<a name="223353054"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223353054" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223353054">(Jan 20 2021 at 10:13)</a>:</h4>
<p>note that the R4B build has many broken links, and many validation failures. I've set it to run to completion irrespective of this, until I can address all the issues after the WGM.</p>



<a name="223464125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223464125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223464125">(Jan 21 2021 at 02:49)</a>:</h4>
<p>ok R4B branch now exists. And will be built by the code in the master branch</p>



<a name="223466745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223466745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223466745">(Jan 21 2021 at 03:41)</a>:</h4>
<p>ok. <span class="user-mention" data-user-id="248736">@Mark Iantorno</span>  here's where I am now:</p>
<ul>
<li>I have fixed a few things in the test cases - these will need releasing before fhir.core is next released</li>
<li>fhir.core needs a release to support the publisher</li>
<li>the java code in the gg-r4b-work-2 branch of fhir.main is the code that will publish both R4B and R5. The PR for that fails because fhir.core needs a release - I think. It works for me locally. </li>
<li>the branch R4B in fhir.main has the source for R4B that will build with the java code in gg-r4b-work-2 branch, and is the base for R4B. It can't pass ci-build until you commit changes for it to build with the jar you are working on</li>
<li>All this works for me and is committed, but is waiting for you to resolve build/release/new jar in order to complete</li>
</ul>



<a name="223467008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223467008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223467008">(Jan 21 2021 at 03:47)</a>:</h4>
<p>I will take care of all this tomorrow. Thanks for letting me know.</p>



<a name="223467075"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223467075" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223467075">(Jan 21 2021 at 03:48)</a>:</h4>
<p>everyone, we have a name clash that has suddenly become confusing</p>



<a name="223467172"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223467172" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223467172">(Jan 21 2021 at 03:51)</a>:</h4>
<p>we have the 'core build' or 'fhir core' which is either the spec at <a href="http://hl7.org/fhir">http://hl7.org/fhir</a> or the source repo, or the process that builds it, and we also have 'fhir core' which is the java code that sits underneath the validator, the ig publisher, hapi and smile-cdr, and also the 'fhir core' java code. </p>
<p>As you can see, that's suddenly confusing now that we're re-organizing things.</p>



<a name="223467178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223467178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223467178">(Jan 21 2021 at 03:51)</a>:</h4>
<p>I'm not sure what the right solution to that is</p>



<a name="223467461"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223467461" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223467461">(Jan 21 2021 at 03:58)</a>:</h4>
<p>Well, the bit that publishes core should probably be the "fhir core publisher".</p>



<a name="223467568"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223467568" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223467568">(Jan 21 2021 at 04:00)</a>:</h4>
<p>I think context will generally make clear whether someone's talking about the spec or the code when referring to "fhir core".  When you refer to the 'fhir core' java code - do you mean the 'model' Java files and other stuff generated from the core spec?</p>



<a name="223467588"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/223467588" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#223467588">(Jan 21 2021 at 04:00)</a>:</h4>
<p>Could refer to those as the "fhir core java release" files - given that they vary from one release to another.</p>



<a name="226763536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226763536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226763536">(Feb 18 2021 at 04:28)</a>:</h4>
<p>I haven't seen anyone posting about this in regard to the way spreadsheet editing works now, so maybe I'm doing something wrong with it (although I don't think so?).  From <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> :</p>
<blockquote>
<p>However, you can still edit the resources using excel. The way this works is that when you run the build, it reads the master definition resources, and creates an excel spreadsheet on the fly (unless it's already open in excel, in which case the file is locked)</p>
<p>then, when you run a build, the build will check the date of the spreadsheet; if it's been changed since it was written, it will read it, merge the information in it back into the master resources, and then use the updated resources.</p>
<p>you don't need to close excel for that to happen. (though you do need to close it if you do a pull, and need the excel spreadsheet updated from new definitions, and I have no way to check on this automatically)</p>
</blockquote>
<p>I'm working with <span class="user-mention" data-user-id="192504">@François Macary</span> on updates to ObservationDefinition, and what I'm seeing with the build doesn't seem to be matching this process.  Francois has updated the new version of the spreadsheet for ObservationDefinition with the desired changes - several new and re-organized elements and updated text including definitions and comments.I have an up-to-date and clean build before trying to make the changes.  I then replace the previously generated observationdefinition-spreadsheet.xlsx file with the updated version from Francois.  This change appears to be detected correctly by the build, as it triggers a partial build of observationdefinition as expected.  But what's happening next isn't what I expected.  The build successfully completes, but the result is that rather than picking up and merging the updates from the spreadsheet into the StructureDefinition, the StructureDefinition is left unchanged and instead the spreadsheet file is being regenerated with the contents that it previously had (matching the StructureDefinition) and the updates to the resource do not get made.  I have been closing the spreadsheet before running the build (as I still have had that habit from before).  I wouldn't think that could cause a problem, but who knows.  I'm not seeing anything obvious that I can do differently that would make this work - any advice is appreciated.</p>



<a name="226765033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226765033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226765033">(Feb 18 2021 at 04:56)</a>:</h4>
<p>the build uses a timestamp to determine if the spreadsheet is newer than the structure definition or not.  so if the file that you get from Francois doesn't have a proper timestamp, then the build doesn't treat it as new.</p>



<a name="226765856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226765856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226765856">(Feb 18 2021 at 05:08)</a>:</h4>
<p>yes I had not anticipated that work flow, and I think Jean is right</p>



<a name="226882084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226882084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226882084">(Feb 18 2021 at 21:15)</a>:</h4>
<p>How could Jean be right? :)  Actually, I certainly agree with Jean that the build uses a timestamp to determine if the spreadsheet is newer than the structure definition, which is what I thought I described in my post.  That part seemed to work, as when the spreadsheet was updated that triggered the partial build, presumably because it <strong>did</strong> recognize the timestamp.  I don't understand the last part of the comment about the file from Francois "doesn't have a proper timestamp", as my assumption was that the timestamp that the build saves for comparison (in observationdefinition-spreadsheet.datestamp) was being compared with the time that the file was modified in the filesystem - which is independent of any of the file contents.  So if that's not the timestamp that is being compared then I don't know which one it is that needs to be "proper" (unless you are referring to meta.lastUpdated, which I <strong>don't</strong> think would make sense).  So, as I said, the partial build was actually triggered by the spreadsheet update, but the behavior still was different than I expected.  And to me this <strong>does</strong> seem to me to be a typical workflow that we should expect to handle.  So what else am I still missing?  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="192166">@Jean Duteau</span></p>



<a name="226882585"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226882585" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226882585">(Feb 18 2021 at 21:19)</a>:</h4>
<p>File timestamps between computers can be.... tricky.</p>



<a name="226882906"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226882906" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226882906">(Feb 18 2021 at 21:21)</a>:</h4>
<p>Yes, I agree with that.  But I think this is all done locally (nothing checked into GH), so the timestamps should be consistently comparable?</p>



<a name="226883121"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883121" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883121">(Feb 18 2021 at 21:22)</a>:</h4>
<p>I think the problem is in the "replace the file with the one from Francois" step.  File timestamps can be mangled / changed / removed / etc.  How are you getting that updated version?</p>



<a name="226883402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883402">(Feb 18 2021 at 21:25)</a>:</h4>
<p>Not sure if it helps, but when I was rinning a build, I saved my xlsx right after saving the StructureDef, and of course that gave me an issue.,</p>



<a name="226883467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883467">(Feb 18 2021 at 21:25)</a>:</h4>
<p>Also - are timestamps universal across timezones? I presume François is in another timezone - so if François saves a file now, and you change it in 3 hours, François's file is perhaps still saved "later" than yours</p>



<a name="226883474"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883474" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883474">(Feb 18 2021 at 21:25)</a>:</h4>
<p>You can try running <code>touch</code> to modify file creation dates (just from a debugging perspective; once we understand what's going on, we can presumably refine the workflow)</p>



<a name="226883510"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883510" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883510">(Feb 18 2021 at 21:25)</a>:</h4>
<p>One example (even in a single Windows system) is that the NTFS filesystem stores everything in UTC and the FAT filesystem stores everything in system local time.</p>
<p>Edit: Note: this gets more complicated when changing operating systems.</p>



<a name="226883679"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883679" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883679">(Feb 18 2021 at 21:26)</a>:</h4>
<p>I forget if you're on a Mac, Rob. I just read <a href="https://apple.stackexchange.com/a/187673">https://apple.stackexchange.com/a/187673</a> and am always impressed with how much I don't know :-)</p>



<a name="226883762"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883762" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883762">(Feb 18 2021 at 21:27)</a>:</h4>
<p>Yes, I see what you mean.  If Francois updated the spreadsheet on his machine and then uploads it (to Skype in this case), and then I download it and save it on my machine it would be keeping the timestamp from Francois' machine unless I actually make an additional update to the file locally?  That could be the reason, and I can try to test that.  And yes, I'm on a Mac (and I expect Francois is on Windows).</p>



<a name="226883943"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883943" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883943">(Feb 18 2021 at 21:29)</a>:</h4>
<p>I'd just open, add whitespace and save again</p>



<a name="226883999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226883999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226883999">(Feb 18 2021 at 21:29)</a>:</h4>
<p>That's exactly what I was getting ready to try right now.</p>



<a name="226884014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226884014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226884014">(Feb 18 2021 at 21:29)</a>:</h4>
<p>On the mac, this <a href="https://superuser.com/questions/428452/how-can-i-touch-a-file-from-the-mac-ui">StackOverflow</a> answer looks helpful - essentially an automation to update the file time.</p>



<a name="226885716"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226885716" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226885716">(Feb 18 2021 at 21:42)</a>:</h4>
<p>Did you notice the {resourcename}-spreadsheet.timestamp files? I assumed that was the key to this.</p>



<a name="226885989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/retooling%20the%20core%20build/near/226885989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/retooling.20the.20core.20build.html#226885989">(Feb 18 2021 at 21:44)</a>:</h4>
<p>Yes, to all of it.  That was in fact the issue.  Making a local update to the file solves that problem.  It's just a bit of a pain and not terribly obvious that it needs to be done, though.  Appreciate everyone's suggestions.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
