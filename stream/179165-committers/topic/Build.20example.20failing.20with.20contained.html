---
layout: page
title: "FHIR Chat  · Build example failing with contained · committers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179165-committers/index.html">committers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html">Build example failing with contained</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="206601210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206601210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206601210">(Aug 11 2020 at 17:04)</a>:</h4>
<p>I am getting a build failure validating an example because the contained resource is not referenced.<br>
The contained one references the parent but the build examples validator doesn't seem to recognise it.</p>
<p>I have tried:</p>
<div class="codehilite"><pre><span></span><code>&lt;MedicinalProductDefinition xmlns=&quot;http://hl7.org/fhir&quot;&gt;
    &lt;id value=&quot;equilidem-with-ing-and-auth&quot;/&gt;
    &lt;contained&gt;
        &lt;RegulatedAuthorization&gt;
            &lt;id value=&quot;authorization&quot;/&gt;
            &lt;subject&gt;
                &lt;reference value=&quot;#&quot;/&gt;
            &lt;/subject&gt;
</code></pre></div>


<p>and </p>
<div class="codehilite"><pre><span></span><code>&lt;MedicinalProductDefinition xmlns=&quot;http://hl7.org/fhir&quot;&gt;
    &lt;id value=&quot;equilidem-with-ing-and-auth&quot;/&gt;
    &lt;contained&gt;
        &lt;RegulatedAuthorization&gt;
            &lt;id value=&quot;authorization&quot;/&gt;
            &lt;subject&gt;
                &lt;reference value=&quot;#equilidem-with-ing-and-auth&quot;/&gt;
            &lt;/subject&gt;
</code></pre></div>


<p>and</p>
<div class="codehilite"><pre><span></span><code>&lt;MedicinalProductDefinition xmlns=&quot;http://hl7.org/fhir&quot;&gt;
    &lt;id value=&quot;equilidem-with-ing-and-auth&quot;/&gt;
    &lt;contained&gt;
        &lt;RegulatedAuthorization&gt;
            &lt;id value=&quot;authorization&quot;/&gt;
            &lt;subject&gt;
                &lt;reference value=&quot;MedicinalProductDefinition/equilidem-with-ing-and-auth&quot;/&gt;
            &lt;/subject&gt;
</code></pre></div>



<a name="206605289"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206605289" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206605289">(Aug 11 2020 at 17:34)</a>:</h4>
<p>it's the parent that references the contained right?</p>



<a name="206605431"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206605431" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206605431">(Aug 11 2020 at 17:35)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;MedicinalProductDefinition</span> <span class="na">xmlns=</span><span class="s">&quot;http://hl7.org/fhir&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;contained&gt;</span>
        <span class="nt">&lt;id</span> <span class="na">value=</span><span class="s">&quot;equilidem-with-ing-and-auth&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;RegulatedAuthorization&gt;</span>
            <span class="nt">&lt;id</span> <span class="na">value=</span><span class="s">&quot;authorization&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;subject&gt;</span>
                <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">&quot;#equilidem-with-ing-and-auth&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/subject&gt;</span>
    <span class="nt">&lt;/contained&gt;</span>
    <span class="nt">&lt;anotherElementInTheParentResource&gt;</span>
                <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">&quot;#equilidem-with-ing-and-auth&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/anotherElementInTheParentResource&gt;</span>
</code></pre></div>



<a name="206605549"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206605549" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206605549">(Aug 11 2020 at 17:36)</a>:</h4>
<p>I thought that the contained cannot reference the parent - please correct me if I am mistaken</p>



<a name="206621438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206621438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206621438">(Aug 11 2020 at 19:40)</a>:</h4>
<p>no - it is the contained that references the parent, in this case (though I also have the opposite in the same example). That is allowed. But the build doesn't seem to like it. Maybe I need a different syntax or maybe the validator doesn't know this case properly</p>



<a name="206625283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206625283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206625283">(Aug 11 2020 at 20:13)</a>:</h4>
<p>what's the actual error message?</p>



<a name="206625539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206625539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206625539">(Aug 11 2020 at 20:15)</a>:</h4>
<div class="codehilite"><pre><span></span><code> [java] ERROR @ MedicinalProductDefinition.contained[0].ofType(RegulatedAuthorization).subject (line 0, col0): medicinalproductdefinition-example-equilidem-using-ingredient-and-auth:: MedicinalProductDefinition.contained[0].ofType(RegulatedAuthorization).subject: ref-1: SHALL have a contained resource if a local reference is provided ( (url: equilidem-with-ing-and-auth; ids: authorization,EquilidoniumPhosphate,CalciumCarbonate)) [reference.startsWith(&#39;#&#39;).not() or (reference.substring(1).trace(&#39;url&#39;) in %rootResource.contained.id.trace(&#39;ids&#39;))] (src = InstanceValidator)
</code></pre></div>



<a name="206625569"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206625569" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206625569">(Aug 11 2020 at 20:15)</a>:</h4>
<p>and also      [java] ERROR @ MedicinalProductDefinition.contained[0].ofType(RegulatedAuthorization).subject (line 0, col0): medicinalproductdefinition-example-equilidem-using-ingredient-and-auth:: MedicinalProductDefinition.contained[0].ofType(RegulatedAuthorization).subject: Unable to resolve resource "#equilidem-with-ing-and-auth" (src = InstanceValidator)</p>



<a name="206625631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206625631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206625631">(Aug 11 2020 at 20:16)</a>:</h4>
<p>it varies based on what I try, but that is the gist of it</p>



<a name="206629585"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/206629585" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#206629585">(Aug 11 2020 at 20:50)</a>:</h4>
<p>there is a resource that nothing points at, it thinks, and a resource reference that points at nothing, it thinks. But they actually point at each other.</p>



<a name="207223529"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/207223529" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#207223529">(Aug 18 2020 at 04:57)</a>:</h4>
<p>is this still a problem?</p>



<a name="207223690"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/207223690" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#207223690">(Aug 18 2020 at 05:01)</a>:</h4>
<p>your first example is correct. I'm confused as to why the invariant doesn't seem to allow it</p>



<a name="209487447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/Build%20example%20failing%20with%20contained/near/209487447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/Build.20example.20failing.20with.20contained.html#209487447">(Sep 09 2020 at 09:06)</a>:</h4>
<p>yes this is still an issue as of today<br>
     [java] medicinalproductdefinition-example-equilidem-using-ingredient-and-auth:: MedicinalProductDefinition.contained[0].ofType(RegulatedAuthorization).subject: Unable to resolve resource "#"<br>
     [java] medicinalproductdefinition-example-equilidem-using-ingredient-and-auth:: MedicinalProductDefinition.contained[0].ofType(RegulatedAuthorization).subject: ref-1: SHALL have a contained resource if a local reference is provided ( (url: ; ids: authorization,EquilidoniumPhosphate,CalciumCarbonate)) [reference.startsWith('#').not() or (reference.substring(1).trace('url') in %rootResource.contained.id.trace('ids'))]</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
