---
layout: page
title: "FHIR Chat  · FHIRpath invariant requiring a resource type · committers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179165-committers/index.html">committers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html">FHIRpath invariant requiring a resource type</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="192908946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192908946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192908946">(Apr 04 2020 at 14:01)</a>:</h4>
<p>I'm trying to set an invariant that say the following and my FHIRpath knowledge is sadly lacking: <br>
If Patient.scope=privacy, Patient.subject must be a Patient resource.  <br>
If you can point me to an example that shows how that's done, I'd appreciate it.</p>



<a name="192910149"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192910149" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192910149">(Apr 04 2020 at 14:28)</a>:</h4>
<p><code>scope = 'privacy' implies subject.type = 'Patient'</code><br>
I think.  (I'm far from an expert...</p>



<a name="192915530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192915530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192915530">(Apr 04 2020 at 16:27)</a>:</h4>
<p>I'll see what it says...</p>



<a name="192924577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192924577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192924577">(Apr 04 2020 at 20:03)</a>:</h4>
<blockquote>
<p>scope = 'privacy' implies subject.type = 'Patient'</p>
</blockquote>
<p>requires the subject have a specified type of 'Patient'. If you want to say that what it points to must be a patient (which is what you said, and what the invariant should say):</p>
<p><code>(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient)</code></p>



<a name="192958662"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192958662" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192958662">(Apr 05 2020 at 13:07)</a>:</h4>
<p>Now the fun of teaching myself enough to do it in XPath.  (no, don't give me the answer yet)</p>



<a name="192959840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192959840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192959840">(Apr 05 2020 at 13:33)</a>:</h4>
<p>I get this error:<br>
     [java] ERROR @ Consent: Expression '(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient)<br>
     [java] (scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient' has illegal path (Error in ?? at 2, 1: Premature ExpressionNode termination at unexpected token "(") (src = Publisher)</p>



<a name="192959920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192959920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192959920">(Apr 05 2020 at 13:35)</a>:</h4>
<p>Does this mean it doesn't like the opening right parentheses?</p>



<a name="192960844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192960844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192960844">(Apr 05 2020 at 13:59)</a>:</h4>
<p>I'm confused - both of those have different quotation marks - I can't tell which is the real problem</p>



<a name="192962101"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192962101" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192962101">(Apr 05 2020 at 14:30)</a>:</h4>
<p>Here, have the file...<br>
<a href="/user_uploads/10155/JZiIf5QT3v3rnFxzoTWEJmqX/consent-spreadsheet.xml" title="consent-spreadsheet.xml">consent-spreadsheet.xml</a></p>



<a name="192976758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192976758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192976758">(Apr 05 2020 at 20:31)</a>:</h4>
<p>why do your have the expression there twice? </p>
<blockquote>
<p>(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient)&#10;(scope = 'privacy' and subject.resolve().exists()) implies (subject.resolve() is Patient</p>
</blockquote>



<a name="192986885"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192986885" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192986885">(Apr 06 2020 at 01:10)</a>:</h4>
<p>I must have pasted twice by mistake.  Well, I'm dumb.</p>



<a name="192987066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192987066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192987066">(Apr 06 2020 at 01:15)</a>:</h4>
<p>Wait, when I open it, I only see it once in the spreadsheet.  Where are you seeing it twice?<br>
<a href="/user_uploads/10155/ZWrxK_XSZclEoZB0JygJkVBP/image.png" title="image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/ZWrxK_XSZclEoZB0JygJkVBP/image.png" title="image.png"><img src="/user_uploads/10155/ZWrxK_XSZclEoZB0JygJkVBP/image.png"></a></div>



<a name="192987158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192987158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192987158">(Apr 06 2020 at 01:16)</a>:</h4>
<p>in the source. it's on the second line so you might not see it easily in excel</p>



<a name="192987174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179165-committers/topic/FHIRpath%20invariant%20requiring%20a%20resource%20type/near/192987174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179165-committers/topic/FHIRpath.20invariant.20requiring.20a.20resource.20type.html#192987174">(Apr 06 2020 at 01:17)</a>:</h4>
<p>Ah, okay, I had to expand the input line to see it.  Thank you</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
