---
layout: page
title: "FHIR Chat  · Setting up Subscriptions · subscriptions"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/index.html">subscriptions</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html">Setting up Subscriptions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153951893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153951893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Tarar <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153951893">(Apr 11 2018 at 16:04)</a>:</h4>
<p>Trying to set a FHIR Subscription test for certain resources.</p>
<p>We used the HAPI FHIR  JPA from <a href="https://hub.docker.com/r/polyakov/hapi-fhir-jpaserver-example/" target="_blank" title="https://hub.docker.com/r/polyakov/hapi-fhir-jpaserver-example/">https://hub.docker.com/r/polyakov/hapi-fhir-jpaserver-example/</a></p>
<p>When creating subscriptions, they are always set to "Requested" status. </p>
<p>1. How do I enable the subscription to active?<br>
2. Where do I configure the email SMTP details?</p>
<p>Any ideas?</p>



<a name="153951899"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153951899" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153951899">(Apr 11 2018 at 16:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="153953009"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153953009" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153953009">(Apr 18 2018 at 15:53)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="194261">@Rishi Tarar</span> ,</p>
<p>Sorry for the slow reply! Subscriptions are set up in HAPI FHIR JPA using interceptors, one per channel type. See subclasses of BaseSubscriptionInterceptor to see them: <a href="http://hapifhir.io/apidocs-jpaserver/ca/uhn/fhir/jpa/subscription/BaseSubscriptionInterceptor.html" target="_blank" title="http://hapifhir.io/apidocs-jpaserver/ca/uhn/fhir/jpa/subscription/BaseSubscriptionInterceptor.html">http://hapifhir.io/apidocs-jpaserver/ca/uhn/fhir/jpa/subscription/BaseSubscriptionInterceptor.html</a></p>
<p>You'd use <code>SubscriptionEmailInterceptor</code> for email, and that class has all of the configuration around delivery.</p>



<a name="153954255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anusha <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954255">(Apr 25 2018 at 10:17)</a>:</h4>
<p>Hello All,</p>
<p>Looking through the Subscriptions in the 3.x.x of RestHook channel type,<br>
Where I have created Subscription resource and given the criteria ex, "Observation?status=registered" and endpoint.</p>
<p>According to my Understanding when there is a change in Observation Resource in status(criteria given in subscription). We need to get notification <br>
to the  Endpoint given.</p>
<p>When i updated the Observation staus other than "registered",in the console iam viewing this info <br>
Subscription check found 0 results for query: Observation?status=registered&amp;_id=Observation/753</p>
<p>And i have no idea in what format Notification will be how can we knew it.<br>
DO we need to enable any Configurations? or iam in the correct way of understanding only.</p>
<p>Thank You</p>



<a name="153954277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954277">(Apr 25 2018 at 12:39)</a>:</h4>
<p>which server are you testing against?</p>



<a name="153954278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954278">(Apr 25 2018 at 12:39)</a>:</h4>
<p>and what status does it have for your subscription?</p>



<a name="153954284"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954284" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954284">(Apr 25 2018 at 12:45)</a>:</h4>
<p>Your understanding of the criteria is not entirely correct.<br>
"Observation?status=registered" means: send me a notification for any create or update of an Observation that has status 'registered'.<br>
So if you change the <em>status</em> to something else than 'registered', the Observation will no longer match the criteria and you will not be notified.<br>
You cannot have a subscription for changes to a specific property of an Observation.</p>



<a name="153954287"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954287" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954287">(Apr 25 2018 at 12:49)</a>:</h4>
<p>we are trailing a subscription criteria that can do that, but I'm not sure which servers support that</p>



<a name="153954302"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954302" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954302">(Apr 25 2018 at 13:03)</a>:</h4>
<p>I must have missed that. Where can I find a description of this functionality?</p>



<a name="153954308"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954308" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954308">(Apr 25 2018 at 13:33)</a>:</h4>
<p>I think the San Diego connectathon</p>



<a name="153954310"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954310" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954310">(Apr 25 2018 at 13:33)</a>:</h4>
<p>there was a subscription stream</p>



<a name="153954313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954313">(Apr 25 2018 at 13:41)</a>:</h4>
<p>I think you are referring to the use of EventDefinition in conjunction with Subscription, as stated under EventDefinition: "The EventDefinition resource is intended to be used to provide a reusable description of events for use by other resources that require event definition, such as Subscription. EventDefinition is a definition of an event that could occur, whereas Subscription is asking for notification of events when they occur." (<a href="http://build.fhir.org/eventdefinition.html" target="_blank" title="http://build.fhir.org/eventdefinition.html">http://build.fhir.org/eventdefinition.html</a>).<br>
However, this has not found it's way into Subscription itself yet.</p>



<a name="153954352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954352">(Apr 25 2018 at 21:36)</a>:</h4>
<p>no the connectathon stream only defined an extension and has not moved beyond that</p>



<a name="153954438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anusha <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954438">(Apr 26 2018 at 05:05)</a>:</h4>
<p><span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> <br>
Thanks for correcting me.</p>



<a name="153954504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anusha <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954504">(Apr 26 2018 at 12:18)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
hapi fhir server<br>
and subscription status is requested</p>



<a name="153954766"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954766" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anusha <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954766">(Apr 27 2018 at 13:06)</a>:</h4>
<p>Hi All,<br>
Iam little bit confused some of the lines in subscription documentation,<br>
When a resource is created or updated that meets the criteria, the server sends a POST request with no body to the nominated URL.</p>
<p>When the subscriber receives a POST to <a href="https://biliwatch.com/customers/mount-auburn-miu/on-result" target="_blank" title="https://biliwatch.com/customers/mount-auburn-miu/on-result">https://biliwatch.com/customers/mount-auburn-miu/on-result</a>, it re-issues the criteria as a query to the server, appending &amp;_since=:last <br>
(where :last is replaced by the time at which the client last checked). In this way it can fetch all new relevant Observations.</p>
<p>what it mean by it re-issues the criteria as a query to the server?</p>
<p>please help me in understanding the above.</p>



<a name="153954872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153954872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153954872">(Apr 27 2018 at 23:56)</a>:</h4>
<p>in this case, where the server is sending pings without any details, then the only way for the subscriber to get the details is to ask the server (re-issue the query).</p>



<a name="153955093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153955093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Tarar <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153955093">(Apr 30 2018 at 20:48)</a>:</h4>
<p>(deleted)</p>



<a name="153955623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153955623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anusha <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153955623">(May 03 2018 at 07:08)</a>:</h4>
<p>Hi All,</p>
<p>Iam working on Subscription with Resthook channel type of hapi-fhir V3.2.0, where iam getting error log as "Failure to handle Subscription payload" and<br>
 at the subscriber side Iam receiving that "  No mapping found for HTTP request with URI [/hapi-fhir-jpaserver-example/Patient/102] in DispatcherServlet with name 'spring'".<br>
Can anyone help me out with the issue.</p>



<a name="153955664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153955664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153955664">(May 03 2018 at 11:29)</a>:</h4>
<p>You may find more support on the <a class="stream" data-stream-id="8" href="/#narrow/stream/8-hapi">#hapi</a>  stream for this</p>



<a name="153977883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153977883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Justin <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153977883">(Jul 25 2018 at 12:53)</a>:</h4>
<p>Hey guys,</p>
<p>I am very new to all of the Fhir and HL7 spaces but I am working on an app that a Fhir Subscription model will work great on but am having some issues/questions:</p>
<div class="codehilite"><pre><span></span> 1. I know the Fhir Server can go to a Rest-Hook service (like a C# .asmx project) but in what format does that message come?
 2. Is there a way to add more than 1 criteria to the same Subscription entry? (I want to know about Encounters that happen with a Status of Planned, Finished, and In-Progress
 3. What kind of sandbox instances can i get started with to see if my .asmx project can receive these messages?
</pre></div>


<p>Thank you in advance!<br>
Justin</p>



<a name="153977897"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153977897" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153977897">(Jul 25 2018 at 14:38)</a>:</h4>
<p>1. Is answered in <a href="http://hl7.org/fhir/subscription.html#2.46.6.1" target="_blank" title="http://hl7.org/fhir/subscription.html#2.46.6.1">http://hl7.org/fhir/subscription.html#2.46.6.1</a><br>
2. Criteria are expressed in the FHIR API Search framework, see the choice construction in the second paragraph of <a href="http://hl7.org/fhir/search.html#combining" target="_blank" title="http://hl7.org/fhir/search.html#combining">http://hl7.org/fhir/search.html#combining</a><br>
3. One of the public test servers (see <a href="http://wiki.hl7.org/index.php?title=Publicly_Available_FHIR_Servers_for_testing" target="_blank" title="http://wiki.hl7.org/index.php?title=Publicly_Available_FHIR_Servers_for_testing">here</a>) but it is also very easy to setup a local <a href="http://docs.simplifier.net/vonk/" target="_blank" title="http://docs.simplifier.net/vonk/">Vonk</a> test server.</p>



<a name="153977907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153977907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Justin <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153977907">(Jul 25 2018 at 14:57)</a>:</h4>
<p>Thanks for the answer!<br>
So what do I need to add to the Subscription to request the entire resource be sent to my endpoint?</p>
<p>Also, I see the combining, but can we use "or" statements instead of "and" so we want Encounters with a Status of Planned OR Arrived OR Finished?</p>



<a name="153977981"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153977981" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Justin <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153977981">(Jul 25 2018 at 17:28)</a>:</h4>
<p>Also, how do you import a Subscription Resource into a Fhir server?</p>



<a name="153980010"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153980010" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Tarar <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153980010">(Aug 01 2018 at 01:55)</a>:</h4>
<p><span class="user-mention" data-user-id="191757">@Christiaan Knaap</span>  <span class="user-mention" data-user-id="191319">@James Agnew</span> <br>
I am using the HAPI FHIR Server and a custom CQF Ruler  as a call back endpoint for my CDS Service.</p>
<p>I dea is to fire a subscription via a rest hook to ship resources of interest to be evaluated by CDS Service.</p>
<p>So my Subscription looks like this </p>
<div class="codehilite"><pre><span></span>{
 &quot;resourceType&quot;: &quot;Subscription&quot;,
 &quot;status&quot;: &quot;active&quot;,
 &quot;end&quot;: &quot;2018-12-20T13:27:56.202+05:30&quot;,
 &quot;reason&quot;: &quot;Detect New Discharge&quot;,
 &quot;criteria&quot;: &quot;Encounter?status=finished&quot;,
 &quot;channel&quot;: {
   &quot;type&quot;:&quot;rest-hook&quot; ,
   &quot;endpoint&quot;: &quot;https:/blah.com/clinicDecision/cds/stroke&quot;,
   &quot;payload&quot;: &quot;application/fhir+json&quot;
 }
}
</pre></div>


<p>So when I create an Encounter with status=finished with ID:4622205,  I do get a call back but it looks like this .. so rest hook is working(see entry below from logs in CDS service).</p>
<div class="codehilite"><pre><span></span>info method=PUT path=&quot;/clinicDecision/cds/stroke/Encounter/4622205&quot; host=blah.com request_id=4a65aa71-f673-4551-aaa4-efaa1be815af fwd=&quot;104.154.163.222&quot; dyno=web.1 connect=1ms service=669ms status=404 bytes=310 protocol=https
</pre></div>


<p>Notice the URL /clinicDecision/cds/stroke/Encounter/4622205 for the call back URL. It appears the FHIR server is appending the newly created resource to the callback URL.</p>
<p>I thought I would get a bundle or a specific Encounter Resource in the payload.</p>
<p>I have tried create , update of the Encounter resource.</p>
<p>I am not sure if this expected behaviour or a bug or I may be doing something wrong.</p>
<p>-R</p>



<a name="153980106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153980106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153980106">(Aug 01 2018 at 08:49)</a>:</h4>
<p>I don't know what happens in HAPI, but have you also tried this in <a href="http://vonk.fire.ly" target="_blank" title="http://vonk.fire.ly">Vonk</a> to check whether an error may be on your side on on the HAPI side?<br>
Please note that in Vonk you have to post your Subscription to the administration API: POST <a href="http://vonk.fire.ly/administration/Subscription" target="_blank" title="http://vonk.fire.ly/administration/Subscription">http://vonk.fire.ly/administration/Subscription</a>, and then your Encounter to the regular endpoint: POST <a href="http://vonk.fire.ly/Encounter" target="_blank" title="http://vonk.fire.ly/Encounter">http://vonk.fire.ly/Encounter</a>.</p>



<a name="153980177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153980177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Tarar <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153980177">(Aug 01 2018 at 11:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> <span class="user-mention" data-user-id="191319">@James Agnew</span> </p>
<p>Thank you.</p>
<p>Tested it with Vonk and Subscriptions fire to the callback rest hook endpoint. It works as expected on Vonk. It probbably is a bug in HAPI.</p>
<p>It is also interesting to note that Vonk rest-hook callbacks are POST and HAPI is PUT.</p>
<div class="codehilite"><pre><span></span> {&quot;resourceType&quot;:&quot;Encounter&quot;,&quot;id&quot;:&quot;c6831b8e-bac5-4dee-b0f1-172761204f56&quot;,&quot;meta&quot;:{&quot;versionId&quot;:&quot;6d1f1379-4c78-4acb-bea5-a2a65a4d3fc1&quot;,&quot;lastUpdated&quot;:&quot;2018-08-01T11:41:49.369+00:00&quot;},&quot;status&quot;:&quot;finished&quot;,&quot;class&quot;:{&quot;system&quot;:&quot;http://hl7.org/fhir/encounter-class&quot;,&quot;code&quot;:&quot;inpatient&quot;,&quot;display&quot;:&quot;Inpatient&quot;},&quot;subject&quot;:{&quot;reference&quot;:&quot;Patient/934740&quot;,&quot;display&quot;:&quot;Bunny Bugs &quot;},&quot;period&quot;:{&quot;start&quot;:&quot;2000-08-21T11:56:23.000+05:30&quot;}}
</pre></div>



<a name="153980181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153980181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153980181">(Aug 01 2018 at 11:50)</a>:</h4>
<p>Thanks for testing. <br>
On the latter point HAPI is more correct, since the <a href="http://hl7.org/fhir/subscription.html#2.46.6.1" target="_blank" title="http://hl7.org/fhir/subscription.html#2.46.6.1">spec</a> specifies that it has to be an Update operations (ie PUT)</p>



<a name="153980337"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153980337" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153980337">(Aug 01 2018 at 16:54)</a>:</h4>
<p>HAPI is treating the <code>endpoint</code> as the base URL of a FHIR REST endpoint, which is why it adds the resource type and ID to it.</p>
<p>I could swear that was more explicit in the spec at some point, but at this point it doesn't seem like it is. I know lots of people rely on this behaviour though to use the rest-hook mechanism for replication.</p>
<p>Maybe it should be configurable...</p>



<a name="153993365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993365">(Sep 05 2018 at 08:46)</a>:</h4>
<p>Subscriptions in the standard still lack the functionality to ship the immediate evaluation of the criteria once created, right? Am I the only one that sees that as a problem?</p>



<a name="153993397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993397">(Sep 05 2018 at 13:08)</a>:</h4>
<p>what does 'ship the immediate evaluation of the criteria once created' mean?</p>



<a name="153993545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993545">(Sep 05 2018 at 19:02)</a>:</h4>
<p>Its the case I presented during a BoF on Subscriptions at DevDays '17. The case is today:<br>
Step 1) Client issues a query against the server in order to obtain the current state<br>
Step 2000) Client creates a subscription at the server with the same query used in step 1</p>
<p>That's what the current spec says</p>



<a name="153993546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993546">(Sep 05 2018 at 19:04)</a>:</h4>
<p>Anything can happen in between Step 1 and Step 2000. Being the state the client thought was the correct and the state where the client starts to get updates from the subscription</p>



<a name="153993547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993547">(Sep 05 2018 at 19:05)</a>:</h4>
<p>What I suggest is that you cut away step 1 - it does not make sense</p>



<a name="153993548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993548">(Sep 05 2018 at 19:06)</a>:</h4>
<p>Instead, once a subscription is created, the criteria should be evaluated at once and the result should be sent to the client on the means specified in the subscription</p>



<a name="153993549"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993549" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993549">(Sep 05 2018 at 19:06)</a>:</h4>
<p>so that is "ship the immediate evaluation of the criteria once created"</p>



<a name="153993550"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993550" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993550">(Sep 05 2018 at 19:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="153993589"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993589" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993589">(Sep 05 2018 at 21:16)</a>:</h4>
<p>It depends on the method used by the Client to get updates. Where for example with websockets the client just gets a ping; therefore the client must remember the timestamp it last used in previous query. Thus it is often helpful to do all the queries up to NOW, then start the subscription., do one more, then wait for a ping.</p>



<a name="153993590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993590">(Sep 05 2018 at 21:19)</a>:</h4>
<p>a very different use of subscription, that I worked on a prototype, is as an async API to XCA environment. In that case there is nothing to find prior to the subscription, as the subscription is what kicks off the XCA FindDocuments queries to ALL partners on the network. As results come back on the XCA queries, a notification is given to the client, so that the client can then go get everything starting from last time it queried, which for the first time is time zero.</p>



<a name="153993598"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993598" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993598">(Sep 05 2018 at 21:59)</a>:</h4>
<p>why not create the subscription, then do the query?</p>



<a name="153993626"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993626" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993626">(Sep 06 2018 at 07:04)</a>:</h4>
<p>doesn't that put a certain amount of logic into the client that ain't necessarily consistent across client implementations?</p>



<a name="153993627"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993627" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993627">(Sep 06 2018 at 07:12)</a>:</h4>
<p>I admit that I cannot directly see the case for my suggestion on "eager evaluation" when payload is not part of the notifications</p>



<a name="153993629"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993629" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993629">(Sep 06 2018 at 07:16)</a>:</h4>
<p>But when payload is wanted, I can't see any reason for not doing eager evaluation. It places the responsibility at a central place</p>



<a name="153993635"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153993635" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153993635">(Sep 06 2018 at 07:32)</a>:</h4>
<p>Thereby providing some consistency to what can be expected</p>



<a name="153995555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153995555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153995555">(Sep 10 2018 at 20:47)</a>:</h4>
<p>the initial load could be very large</p>



<a name="153995572"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153995572" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153995572">(Sep 10 2018 at 21:07)</a>:</h4>
<p>Isn't the client the only one that can know what that initial load is? Let me explain, the server can only know what NEW has happened. The server can't know what else the client is interested in. Thus the client is the only one that can know how deep into history it needs to go. If the client has no interest in history, just NEW, then the client does nothing. right?</p>



<a name="153995625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153995625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153995625">(Sep 10 2018 at 22:50)</a>:</h4>
<p>that's what I think, yes</p>



<a name="153997587"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153997587" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sahil Khanna <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153997587">(Sep 18 2018 at 11:54)</a>:</h4>
<p><span class="user-mention" data-user-id="194261">@Rishi Tarar</span> , did you enable anything for subscription on HAPI FHIR Test server? I followed your steps, but i didnt receive any response back for the update in subscribed resources.. Please advise.</p>



<a name="153999594"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Setting%20up%20Subscriptions/near/153999594" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Setting.20up.20Subscriptions.html#153999594">(Sep 24 2018 at 21:32)</a>:</h4>
<blockquote>
<p>that's what I think, yes</p>
</blockquote>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span>  What you describe as the initial load is executed anyways - by the client at first 'encounter' with the server.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
