---
layout: page
title: "FHIR Chat  · Argonaut call is on! · subscriptions"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/index.html">subscriptions</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html">Argonaut call is on!</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="183183579"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183183579" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183183579">(Dec 11 2019 at 18:06)</a>:</h4>
<p>Argonaut subscriptions call is on!  (<a href="http://bit.ly/argo19-subscriptions" target="_blank" title="http://bit.ly/argo19-subscriptions">http://bit.ly/argo19-subscriptions</a> has links/notes)</p>



<a name="183199326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183199326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183199326">(Dec 11 2019 at 20:38)</a>:</h4>
<p>For those on the call (or otherwise interested), the branch build finished.  Here are the links to the current <a href="http://build.fhir.org/branches/argonaut-subscription/subscription.html" target="_blank" title="http://build.fhir.org/branches/argonaut-subscription/subscription.html">Subscription</a> and <a href="http://build.fhir.org/branches/argonaut-subscription/subscriptiontopic.html" target="_blank" title="http://build.fhir.org/branches/argonaut-subscription/subscriptiontopic.html">SubscriptionTopic</a>.</p>
<p>Please keep in mind they are WIP (pushed at time to attempt to have them for the call), but any and all feedback is greatly appreciated.</p>



<a name="183700785"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183700785" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183700785">(Dec 17 2019 at 22:55)</a>:</h4>
<p>Hey Gino, I really like your WIP! I'm closely reading through it. Let me know if you'd prefer these comments as jira issues.</p>



<a name="183700862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183700862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183700862">(Dec 17 2019 at 22:56)</a>:</h4>
<p>Do these two sentences contradict one another?<br>
<code>Subscription resources are not intended to be secure storage for secrets (e.g., OAuth Client ID or Tokens, etc.). Implementers MAY use their judgement on including limited-use secrets (e.g., a token supplied in Subscription.channel.header to verify that a message is from the desired source).</code></p>
<p>Further, you're effectively mandating that FHIR servers aren't able to decide if this is a feature they want to support, through this statement. FHIR Servers should be empowered to not support storing credentials in a Subscription resource (because it's poor practice and probably shouldn't be done at all). <br>
<code>Each channel.header value SHALL be conveyed as an HTTP request header.</code></p>



<a name="183701377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183701377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183701377">(Dec 17 2019 at 23:02)</a>:</h4>
<p><code>The subscriber then initiates a Web Socket connection to the server, at a URL advertised in the FHIR server's Capability statement (subscriptions/webSocketUrl (todo)). A simple protocol is used to listen for notifications:</code></p>
<p>FHIRcast followed DICOMWeb here by returning the wss url in the Content-Location HTTP header of the response to a subscription request. (See <a href="https://github.com/HL7/fhircast-docs/pull/303" target="_blank" title="https://github.com/HL7/fhircast-docs/pull/303">PR</a>). Note that this also enables the "ticketing" security approach, which also provides a mechanism for addressing the limited number of connection per wss url.</p>



<a name="183701580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183701580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183701580">(Dec 17 2019 at 23:04)</a>:</h4>
<p>Thanks Isaac - that's exactly why I post them!<br>
That wasn't the intention, so I need to rework it.<br>
The language was supposed to call out that the Subscription resource (by default) is just like any other resource, so we don't want people assuming secrets are fine there (e.g., everyone who has access to the subscription resources can then impersonate the server to various third parties).  If servers DO want to implement secure storage, allow for limited-use secrets, or even just assume/pretend it's fine, that is up to them.</p>



<a name="183701750"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183701750" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183701750">(Dec 17 2019 at 23:06)</a>:</h4>
<p>Is Handshake required to be supported by servers? </p>
<p>There's no SHALL at <a href="https://build.fhir.org/subscription.html#handshake-notification" target="_blank" title="https://build.fhir.org/subscription.html#handshake-notification">https://build.fhir.org/subscription.html#handshake-notification</a>, bu reading <a href="http://build.fhir.org/branches/argonaut-subscription/subscription.html#errors" target="_blank" title="http://build.fhir.org/branches/argonaut-subscription/subscription.html#errors">http://build.fhir.org/branches/argonaut-subscription/subscription.html#errors</a>, it seems like a server is required to go through the requested -&gt; active status change.</p>



<a name="183701800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183701800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183701800">(Dec 17 2019 at 23:07)</a>:</h4>
<p>Is this:<br>
<code>Servers implementing Subscriptions are responsible for complying with their policies on information logging. </code><br>
a sentence useful to implementers?</p>



<a name="183701891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183701891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183701891">(Dec 17 2019 at 23:08)</a>:</h4>
<p>For websockets, we're playing with that and some variations.  I haven't fleshed out the docs more on it yet, but there are some modifications being considered as well (e.g., can a single wss connection register multiple subscriptions).<br>
One thought is a generic endpoint, and using client messages to auth each subscription.  This gives the benefit that auth can be renewed/expired in the same session.</p>



<a name="183701905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183701905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183701905">(Dec 17 2019 at 23:08)</a>:</h4>
<p>Re: <code>content-location</code> response headers, this is nice if the request is a websub request... but for a <code>POST Subscription</code> or <code>PUT Subscription/:id</code> request, does:</p>
<blockquote>
<p>"Content-Location indicates the direct URL to use to access the resource, without further content negotiation in the future"</p>
</blockquote>
<p>(from <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Location#Examples" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Location#Examples">MDN docs</a>) fit the bill?</p>



<a name="183701996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183701996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183701996">(Dec 17 2019 at 23:09)</a>:</h4>
<p>Message Types.</p>
<p>You've defined 5 different message types (Empty Notification, id-only Notification, full Notification, Heartbeat, Handshake) with distinct meanings and purposes; yet a subscriber is required to decipher the contents of the notification's <code>subscription-event-count</code> in order to determine what type they're receiving. It would be a lot cleaner to simply have another extension of notificationType, with the following values: Notification, Handshake, heartbeat</p>
<p>Note that in your well-written examples, you've used the <a href="http://Bundle.id" target="_blank" title="http://Bundle.id">Bundle.id</a> as a shorthand for your own convenience, to do exactly this.</p>



<a name="183702051"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702051" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702051">(Dec 17 2019 at 23:10)</a>:</h4>
<p>I feel like it's a little bit off; might think about modeling a web socket URL as a property of <code>SubscriptionStatus</code>, or a bunch of other options Gino's looking intto.</p>



<a name="183702060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702060">(Dec 17 2019 at 23:10)</a>:</h4>
<p>I believe the Handshake was left as optional for servers, but clients need to support/ignore it (same with Heartbeat messages).  I'll go through my notes to check and make sure it's clearer in the docs.</p>



<a name="183702235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702235">(Dec 17 2019 at 23:13)</a>:</h4>
<blockquote>
<p>Message Types.</p>
<p>You've defined 5 different message types (Empty Notification, id-only Notification, full Notification, Heartbeat, Handshake) with distinct meanings and purposes; yet a subscriber is required to decipher the contents of the notification's <code>subscription-event-count</code> in order to determine what type they're receiving. It would be a lot cleaner to simply have another extension of notificationType, with the following values: Notification, Handshake, heartbeat</p>
<p>Note that in your well-written examples, you've used the <a href="http://Bundle.id" target="_blank" title="http://Bundle.id">Bundle.id</a> as a shorthand for your own convenience, to do exactly this.</p>
</blockquote>
<p>I like this.  Part of the issue was the number of extensions we were creating, but since we're breaking all those fields out into a new resource (I believe <code>SubscriptionStatus</code> is winning), it isn't so bad.</p>



<a name="183702249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702249">(Dec 17 2019 at 23:13)</a>:</h4>
<p>&lt;retracted&gt; Gino'd already fixed this! My oversight.</p>



<a name="183702273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702273">(Dec 17 2019 at 23:13)</a>:</h4>
<p>In particular, by setting the type to <code>heartbeat</code> or <code>handshake</code>, various fields can be left out entirely without worry.</p>



<a name="183702384"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702384" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702384">(Dec 17 2019 at 23:15)</a>:</h4>
<p><code>email: Notifications are sent via SMTP/S, S/MIME, or Direct to the Subscription.channel.endpoint email URI (e.g., mailto:...)</code></p>
<p>Note that Direct supports two comm protocols: SMTP and IHE XDR (which is SOAP+ebXML+IHE). Do you intend for XDR to be a supported messaging <br>
 channel within <code>email</code>? I don't think that you do. You should clarify for Direct over SMTP to be supported and not Direct over  IHE XDR/XDM.</p>



<a name="183702501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702501">(Dec 17 2019 at 23:17)</a>:</h4>
<blockquote>
<ol>
<li>You should clarify for handshake (just as you do for heartbeat) that handshake doesn't "incrementing the subscription event count."</li>
</ol>
</blockquote>
<p>Hmm.. I thought it did, but it looks like it got missed.  Good catch!</p>
<blockquote>
<ol start="2">
<li>I'm still not 100% certain if a notification's <code>subscription-event-count</code> should be incremented to account for entries included in that notification.</li>
</ol>
</blockquote>
<p>OK, needs more clarification.  The relevant part there is in 2.46.6.4:</p>
<blockquote>
<p>The subscription-event-count extension indicates the number of unique events that have triggered notification attempts on this Subscription PRIOR to the current notification being sent.</p>
</blockquote>



<a name="183702667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702667">(Dec 17 2019 at 23:20)</a>:</h4>
<p>Gino - my bad, you're right! I'd written that feedback against the <a href="http://build.fhir.org" target="_blank" title="http://build.fhir.org">build.fhir.org</a> version and missed that you'd already updated it. Great work!</p>



<a name="183702745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702745">(Dec 17 2019 at 23:20)</a>:</h4>
<p>I'd encourage you to explain the rationale for including <code>eventCount</code> in the Subscription resource, as well as the notification, in the new "Managing Subscriptions and Error" section. (e.g. a client may query the subscription resource to validate that it has/has not missed a notification ... ).</p>



<a name="183702899"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183702899" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183702899">(Dec 17 2019 at 23:22)</a>:</h4>
<p>Relation to FHIRcast</p>
<p>Would you consider adding an additional bullet like this:</p>
<ul>
<li>FHIRcast synchronizes a user's session by communicating that a UI event occurred, such as a patient chart being opened or closed. Subscriptions communicates clinical or business events or changes in data, such as a patient admit. </li>
</ul>
<p><code>FHIRcast is a HTTP-based framework</code><br>
We're adding websocket support in February, so HTTP isn't entirely accurate. </p>
<p><code>FHIRcast is designed to be used by multiple applications on the same device. Subscriptions are designed to be used by multiple distinct systems</code><br>
What about something like this: <br>
<code>FHIRcast is designed to be used by multiple applications perhaps with the same user and typically on the same device. Subscriptions are designed to be used by multiple distinct systems, often outside of a workflow.</code></p>



<a name="183703071"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183703071" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183703071">(Dec 17 2019 at 23:24)</a>:</h4>
<p>Typos</p>
<p><code>will result in higher computational costs on the server (e.g., processing queries when there are no state changes).</code><br>
I don't think you should say "will result in", I think that  "may result in" would be correct.</p>
<p>Three misspellings:</p>
<ul>
<li>Sercurity</li>
<li>notificaiton </li>
<li>alwayhs</li>
</ul>



<a name="183703494"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183703494" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183703494">(Dec 17 2019 at 23:29)</a>:</h4>
<p>re: FHIRCast, sounds good to me.  My goal is to clearly convey what's the same and what's different so that people know which tool is better for their use.  If there's anything additional that could be useful to include there, please let me know - my understanding of FHIRCast is based on reading the specs as I worked on various presentations  =)</p>



<a name="183704032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183704032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183704032">(Dec 17 2019 at 23:36)</a>:</h4>
<p>blah, why doesn't VS code spell check my random text in XML docs?</p>



<a name="183772897"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183772897" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183772897">(Dec 18 2019 at 17:49)</a>:</h4>
<p>Gino, the example for SubscriptionTopic describes using Group as a filter in the documentation element, but there isn't actually a corresponding canFilterBy: </p>
<blockquote>
<div class="codehilite"><pre><span></span> &quot;documentation&quot;: &quot;Matching based on the Patient (subject) of an Encounter .&quot;
</pre></div>


</blockquote>
<p>Is something like this correct?</p>
<div class="codehilite"><pre><span></span>  &quot;canFilterBy&quot;: [
    {
      &quot;searchParamName&quot;: &quot;patient&quot;,
      &quot;matchType&quot;: [
        &quot;=&quot;,
        &quot;in&quot;,
        &quot;not-in&quot;
      ],
      &quot;documentation&quot;: &quot;Matching based on the Patient&#39;s group membership (in/not-in).&quot;
    },
    {
      &quot;searchParamName&quot;: &quot;group&quot;,
      &quot;matchType&quot;: [
        &quot;in&quot;,
        &quot;not-in&quot;
      ],
      &quot;documentation&quot;: &quot;Matching based on the Patient (subject) of an Encounter or based on the Patient&#39;s group membership (in/not-in).&quot;
    }
  ]
</pre></div>



<a name="183774836"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183774836" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183774836">(Dec 18 2019 at 18:10)</a>:</h4>
<p>The version on the site works because of R5 changes to the <code>:in</code> modifier per <a href="http://jira.hl7.org/browse/FHIR-22690" target="_blank" title="http://jira.hl7.org/browse/FHIR-22690">J#22690</a> .  I don't think it's been completed, but it was approved and we built up the examples and reference implementation assuming it.</p>
<p>The issue with what you propose is that it requires implicit knowledge on mapping Encounter.subject (when Patient) as the member of a Group.  One of the goals was to make these work generically (e.g., computably defined SubscriptionTopics can be added to a server which supports them).</p>
<p>On the flip side, discussions around this were wary of allowing too much in the filters, since they should be lightweight (more complex interactions can be covered in SubscriptionTopics).</p>
<p>Thoughts?</p>



<a name="183776838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183776838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183776838">(Dec 18 2019 at 18:30)</a>:</h4>
<blockquote>
<p>discussions around this were wary of allowing too much in the filters, since they should be lightweight (more complex interactions can be covered in SubscriptionTopics).</p>
</blockquote>
<p>Makes sense, Gino. What would a SubscriptionTopic for an admission on a patient who belonged to a group look like?</p>



<a name="183786097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183786097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183786097">(Dec 18 2019 at 20:12)</a>:</h4>
<p>Hmm.. good point.  I'll have to think on this a bit.</p>



<a name="183789991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183789991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183789991">(Dec 18 2019 at 21:03)</a>:</h4>
<p>Ok, got my head straight now.  First, definitely need better documentation around this  <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> </p>
<p>Moving on, the field <code>searchParamName</code> was renamed from <code>name</code>, but after discussions here I'm thinking about changing it again (sigh) to <code>searchParameter</code> since that is much clearer about what it is.</p>
<p>To use your example of searching for group membership before/without <code>:in</code>:</p>
<div class="codehilite"><pre><span></span>  &quot;canFilterBy&quot;: [
    {
      &quot;searchParamName&quot;: &quot;patient&quot;,
      &quot;matchType&quot;: [
        &quot;=&quot;,
      ],
      &quot;documentation&quot;: &quot;Matching based on &#39;patient&#39; reference (Encounter.subject, where subject is of type Patient).&quot;
    },
    {
      &quot;searchParamName&quot;: &quot;patient._has:Group:member:_id&quot;,
      &quot;matchType&quot;: [
        &quot;=&quot;,
      ],
      &quot;documentation&quot;: &quot;Matching based on the &#39;patient&#39; reference existing in a group by unique id.&quot;
    }
  ]
</pre></div>


<p>Essentially, <code>searchParamName</code> is the left-hand-side of a search KVP.  So, you could also have values like <code>patient.birthdate</code>, <code>patient.name</code>, etc.  The Group membership query looked particularly ugly, which is why we asked for the <code>:in</code> modifier changes in <a href="http://jira.hl7.org/browse/FHIR-22690" target="_blank" title="http://jira.hl7.org/browse/FHIR-22690">J#22690</a> (and people wanted to support it without worrying about generic<code>_has</code> support).</p>
<p>To clean up from what I was commenting on earlier - implementers wanted to reuse search tooling, but not be committed to things like <code>_include</code> or complicated and/or queries.</p>
<p>Does that make sense?</p>



<a name="183885482"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183885482" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183885482">(Dec 19 2019 at 21:09)</a>:</h4>
<p>an aside: <a href="https://www.tbray.org/ongoing/When/201x/2019/12/18/Content-based-filtering" target="_blank" title="https://www.tbray.org/ongoing/When/201x/2019/12/18/Content-based-filtering">https://www.tbray.org/ongoing/When/201x/2019/12/18/Content-based-filtering</a> - Don't know if there are any lessons for us there</p>



<a name="183889084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183889084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183889084">(Dec 19 2019 at 21:55)</a>:</h4>
<blockquote>
<p>an aside: <a href="https://www.tbray.org/ongoing/When/201x/2019/12/18/Content-based-filtering" target="_blank" title="https://www.tbray.org/ongoing/When/201x/2019/12/18/Content-based-filtering">https://www.tbray.org/ongoing/When/201x/2019/12/18/Content-based-filtering</a> - Don't know if there are any lessons for us there</p>
</blockquote>
<p>That's interesting.   If I'm reading correctly, the argument is that basing the filtering off the output format decouples it from the source events.  Makes the filtering more generic, but requires servers to change where they do it (e.g., generate the output for the event, then filter).  Novel.</p>
<p>In general, we have tried to avoid adding another type of search/filter language into FHIR though.</p>



<a name="183889583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183889583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183889583">(Dec 19 2019 at 22:01)</a>:</h4>
<p>out is related to source events of course. And there's benefit in filtering based on things you don't see.</p>



<a name="183889845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Argonaut%20call%20is%20on%21/near/183889845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Argonaut.20call.20is.20on!.html#183889845">(Dec 19 2019 at 22:03)</a>:</h4>
<p>Yep.  I do like how it changes the conversation into events in isolation and what can be done in that context.<br>
Nobody would suggest searching a data store based on evaluated JSON object comparisons, but if you are only looking at one event it's possible.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
