---
layout: page
title: "FHIR Chat  · Accuracy/atomicity of eventsSinceSubscriptionStart · subscriptions"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/index.html">subscriptions</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html">Accuracy/atomicity of eventsSinceSubscriptionStart</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="209705825"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Accuracy/atomicity%20of%20eventsSinceSubscriptionStart/near/209705825" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html#209705825">(Sep 10 2020 at 20:38)</a>:</h4>
<p>This was discussed a bit on the call this morning... but want some additional feedback. What is the expectation around accuracy of <a href="http://build.fhir.org/subscriptionstatus-definitions.html#SubscriptionStatus.eventsSinceSubscriptionStart">http://build.fhir.org/subscriptionstatus-definitions.html#SubscriptionStatus.eventsSinceSubscriptionStart</a>?</p>



<a name="209705976"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Accuracy/atomicity%20of%20eventsSinceSubscriptionStart/near/209705976" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html#209705976">(Sep 10 2020 at 20:39)</a>:</h4>
<p>This is the mechanism for clients to detect missing or out-of-order messages. So the expectation is that they are accurate, otherwise the client can't detect missed messages. Unless there's some way to specify a certain amount of slip/slop in the protocol...</p>



<a name="209707398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Accuracy/atomicity%20of%20eventsSinceSubscriptionStart/near/209707398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yazan Al-Alul <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html#209707398">(Sep 10 2020 at 20:51)</a>:</h4>
<p>To give more context, my concern is that it's possible for the notification component on the server to succeed in sending the event to the subscriber, but fail before it has stored the updated value of the counter.</p>



<a name="209707754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Accuracy/atomicity%20of%20eventsSinceSubscriptionStart/near/209707754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yazan Al-Alul <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html#209707754">(Sep 10 2020 at 20:54)</a>:</h4>
<p>And similarly if the server is keeping track of which subscriptions it has notified of an event, if it sends the notification but isn't able to persist that it did send it successfully, the server would potentially end up sending a duplicate notification to that subscriber</p>



<a name="209708242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Accuracy/atomicity%20of%20eventsSinceSubscriptionStart/near/209708242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html#209708242">(Sep 10 2020 at 20:58)</a>:</h4>
<p>In general we don't require guaranteed delivery and we don't prevent duplicate delivery. But we do expect clients to be able to detect (at least as often as their heartbeat interval) whether messages have been missed. So in the examples above, you'd want to allocate a "new event count" before you send out a message, since the updated count appears <em>in</em> the message. It's about events for which you have made notification <em>attempts</em>.</p>
<p>As the <a href="http://build.fhir.org/subscriptionstatus.html#subscription-status">spec says, <code>SubscriptionStatus.eventsSinceSubscriptionStart</code></a> is the:</p>
<blockquote>
<p>number of unique events that have triggered notification attempts on this Subscription inclusive of the current notification being sent</p>
</blockquote>



<a name="209805822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Accuracy/atomicity%20of%20eventsSinceSubscriptionStart/near/209805822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yazan Al-Alul <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html#209805822">(Sep 11 2020 at 16:48)</a>:</h4>
<p>Thanks Josh, that makes sense. I think it would be good to explicitly call out that duplicate notifications are possible</p>



<a name="209806702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Accuracy/atomicity%20of%20eventsSinceSubscriptionStart/near/209806702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Accuracy.2Fatomicity.20of.20eventsSinceSubscriptionStart.html#209806702">(Sep 11 2020 at 16:57)</a>:</h4>
<p>Agreed!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
