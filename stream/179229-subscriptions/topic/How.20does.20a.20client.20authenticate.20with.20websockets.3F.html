---
layout: page
title: "FHIR Chat  · How does a client authenticate with websockets? · subscriptions"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/index.html">subscriptions</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html">How does a client authenticate with websockets?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="168512185"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168512185" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168512185">(Jun 19 2019 at 14:35)</a>:</h4>
<p>Browser-based websocket libraries don't generally support sending HTTP headers during the creation of a websocket connection. (See heroku's excellent <a href="https://devcenter.heroku.com/articles/websocket-security" target="_blank" title="https://devcenter.heroku.com/articles/websocket-security">explanation of websocket security</a>, <a href="https://tools.ietf.org/html/rfc6455" target="_blank" title="https://tools.ietf.org/html/rfc6455">RFC 6455</a>, and <a href="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support" target="_blank" title="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support">FHIRcast's security considerations page</a> and proposed resolution to this problem).</p>



<a name="168512194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168512194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168512194">(Jun 19 2019 at 14:35)</a>:</h4>
<p>Since there's a single url on the FHIR server that all websocket clients connect to, the FHIR server only identifies clients through the <a href="https://build.fhir.org/subscription.html#2.46.8.2" target="_blank" title="https://build.fhir.org/subscription.html#2.46.8.2">bind/bound exchange</a> of the Subscription resource id. This isn't authentication.</p>



<a name="168512201"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168512201" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168512201">(Jun 19 2019 at 14:35)</a>:</h4>
<p>The Subscriptions spec currently has this bullet, which I don't fully understand:</p>
<blockquote>
<p>Client authenticates to server using a server-specified Web socket protocol (e.g. OAuth bearer token presentation).</p>
</blockquote>



<a name="168512208"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168512208" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168512208">(Jun 19 2019 at 14:35)</a>:</h4>
<p>Can anyone explain to me what the "OAuth bearer token presentation using a server-specified Web socket protocol" means? I think this probably means that the client should pass it's bearer access_token in the <code>Sec-WebSocket-Protocol</code> http header during the request.</p>



<a name="168512210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168512210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168512210">(Jun 19 2019 at 14:35)</a>:</h4>
<p>Should the server respond with the token in the same header in the response? What else should be in this header?</p>



<a name="168512214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168512214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168512214">(Jun 19 2019 at 14:35)</a>:</h4>
<p>It's a hack to authenticate via this header, but supporting browser websockets doesn't give many options.</p>



<a name="168514064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514064">(Jun 19 2019 at 14:56)</a>:</h4>
<p><span class="user-mention" data-user-id="216906">@Amy Ballard</span>  Was able to do secure websockets with Grahame's server, I believe (at the last connectathon)</p>



<a name="168514125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514125">(Jun 19 2019 at 14:57)</a>:</h4>
<p>Which would also imply that <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> has implemented websocket security from a server perspective :)</p>



<a name="168514205"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514205" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514205">(Jun 19 2019 at 14:58)</a>:</h4>
<p>client auth could be done via mutual-authenticated-TLS...    but, that is often not an optimal solution.</p>



<a name="168514221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514221">(Jun 19 2019 at 14:58)</a>:</h4>
<p>Or it's possible she tried and wasn't able to get connected...</p>



<a name="168514238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514238">(Jun 19 2019 at 14:59)</a>:</h4>
<p>I'm not entirely sure when mutual auth <em>is</em> the optimal solution ;)</p>



<a name="168514281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514281">(Jun 19 2019 at 14:59)</a>:</h4>
<blockquote>
<p>I'm not entirely sure when mutual auth <em>is</em> the optimal solution ;)</p>
</blockquote>
<p>when no other solution is available..  :-)</p>



<a name="168514377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514377">(Jun 19 2019 at 15:00)</a>:</h4>
<p>non-user situations in b-2-b...</p>



<a name="168514529"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514529" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514529">(Jun 19 2019 at 15:02)</a>:</h4>
<p>aka messaging... especially hl7 v2, v3, DICOM, etc... but also FHIR messaging... The main point is that the server doesn't need to make any decision about the client except that they are authorized to connect to this endpoint. That is to say there is no application level business rules (User Role, App, context, etc).</p>



<a name="168514584"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168514584" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168514584">(Jun 19 2019 at 15:02)</a>:</h4>
<p>which might be considerted the case in the subscription use of websockets as the notification channel.</p>



<a name="168520506"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168520506" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amy Ballard <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168520506">(Jun 19 2019 at 16:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191356">@Jenni Syed</span> I tired and was not able to connect securely. I tried passing the Authorization header with the bearer token, which didn't work. As <span class="user-mention" data-user-id="191864">@Isaac Vetter</span> mentioned, passing HTTP headers is not supported by browsers anymore so not really a viable option anyway. Other than <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>'s server, al other servers allowed me to connect by creating the connection with wss:// url with no additional authorization, so although the connection was secure anyone could connect.</p>



<a name="168520881"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168520881" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amy Ballard <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168520881">(Jun 19 2019 at 16:13)</a>:</h4>
<p>It does seem that Grahame's server has something in place for authorization for secure websockets since is was returning a 401 when I attempted to connect</p>



<a name="168549886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168549886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168549886">(Jun 19 2019 at 22:06)</a>:</h4>
<p>I'll have to investigate. it worked without security?</p>



<a name="168555991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/168555991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amy Ballard <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#168555991">(Jun 20 2019 at 00:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> for your server I could connect with ws:// without security as expected. I didn't figure out how pass the auth token to get connected with  wss:// . I was getting 401 as you'd expect for not getting the authorization correct. All the other servers at the connectathon had no authorization protecting their wss:// endpoints.</p>



<a name="169150162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169150162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169150162">(Jun 27 2019 at 16:25)</a>:</h4>
<p>I've been researching/thinking about this since the call yesterday as well.  From what I can see, the standard header-type authentications won't work because:<br>
    1) While headers are supported on ws/wss connections, implementation support for them is spotty at best.<br>
    2) Long-running connections (which these may be) have no way to re-authenticate (e.g., someone authorized today may not be tomorrow)<br>
It appears that common practice is to setup some sort of challenge/response.<br>
Based on yesterday's call, we were looking to define handshake and heartbeat messages (so far I have been leaning towards transaction bundles with extensions), and I thought that we could add an extension for authorization to these as well (e.g., a field to pass the equivalent headers).<br>
Since we are looking at sending transaction bundles over the wire already, everyone should have tooling for this and I believe it meets all the requirements for auth.<br>
Thoughts?</p>



<a name="169159296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169159296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169159296">(Jun 27 2019 at 18:07)</a>:</h4>
<p>May make more sense visually:<br>
<a href="/user_uploads/10155/wZJcvv9srhDqYuxWBGoTsySY/WebsocketAuthIdea.png" target="_blank" title="WebsocketAuthIdea.png">WebsocketAuthIdea.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/wZJcvv9srhDqYuxWBGoTsySY/WebsocketAuthIdea.png" target="_blank" title="WebsocketAuthIdea.png"><img src="/user_uploads/10155/wZJcvv9srhDqYuxWBGoTsySY/WebsocketAuthIdea.png"></a></div>



<a name="169255526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169255526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169255526">(Jun 28 2019 at 19:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191864">@Isaac Vetter</span> We had talked back in Montreal about WS clients in <a class="stream" data-stream-id="179271" href="/#narrow/stream/179271-FHIRcast">#FHIRcast</a> using a <code>protocol</code> header to pass along an OAuth token; did this get assessed and turned down?</p>



<a name="169262716"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169262716" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169262716">(Jun 28 2019 at 21:12)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="191315">@Josh Mandel</span> ,</p>



<a name="169262719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169262719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169262719">(Jun 28 2019 at 21:12)</a>:</h4>
<p>It did get assessed and turned down, but just by me because I think it's ugly. Passing the access token in the protocol header (and subsequent problems/questions) is what I was trying to refer to in the seminal post of this topic.</p>



<a name="169262725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169262725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169262725">(Jun 28 2019 at 21:12)</a>:</h4>
<p>Note that websockets defines the <code>Sec-WebSocket-Protocol</code> http header, which the client specifies during the initial request and which the server is supposed to echo back. Fundamentally, it's a hack to authenticate via this header, but supporting browser websockets doesn't give many options.</p>



<a name="169262730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169262730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169262730">(Jun 28 2019 at 21:12)</a>:</h4>
<p>I'd encourage you to read heroku's excellent <a href="https://devcenter.heroku.com/articles/websocket-security" target="_blank" title="https://devcenter.heroku.com/articles/websocket-security">explanation of websocket security</a>, and <a href="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support" target="_blank" title="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support">FHIRcast's security considerations page</a> and proposed resolution to this problem) (Also <a href="https://tools.ietf.org/html/rfc6455" target="_blank" title="https://tools.ietf.org/html/rfc6455">RFC 6455</a>).</p>



<a name="169262735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169262735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169262735">(Jun 28 2019 at 21:12)</a>:</h4>
<p>I think that the current Argo proposal -- putting the access token in the body of the FHIR bundle is better than hacking the protocol, but still weird in that it puts an access token in a FHIR resource (how should logging work? why does my security layer now have to understand FHIR?)I like the single-use "ticket" url method that's drafted in FHRcast.</p>



<a name="169263153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169263153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169263153">(Jun 28 2019 at 21:19)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191864">@Isaac Vetter</span>, I don't know that I'd call what I put above as a proposal yet, more just trying to understand what people have and what is desired.<br>
That said, part of my concern in using a header on the connection is that the only way to re-auth is to kill the connection (e.g., the connection has been open 24 hours, and I want to revalidate the token).  In the case of subscriptions, that can result in missed notifications.<br>
On the other hand, you are right (and Josh brought it up also), that having it inside the message has odd implications as well.</p>



<a name="169263285"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169263285" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169263285">(Jun 28 2019 at 21:21)</a>:</h4>
<p>It feels like there is no "perfect" solution, so I would like to fully understand the trade-offs before proposing something.</p>



<a name="169266052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266052">(Jun 28 2019 at 22:01)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="222054">@Gino Canessa</span> !</p>



<a name="169266054"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266054" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266054">(Jun 28 2019 at 22:01)</a>:</h4>
<blockquote>
<p>I don't know that I'd call what I put above as a proposal yet, </p>
</blockquote>
<p>Ah, I misunderstood then. I missed the argo call this week <span aria-label="embarrassed" class="emoji emoji-1f633" role="img" title="embarrassed">:embarrassed:</span>  on this and reading the notes/your post; it sounded like a done deal.</p>



<a name="169266060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266060">(Jun 28 2019 at 22:01)</a>:</h4>
<blockquote>
<p>In the case of subscriptions, that can result in missed notifications.</p>
</blockquote>



<a name="169266063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266063">(Jun 28 2019 at 22:01)</a>:</h4>
<p>Again, note the <a href="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support" target="_blank" title="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support">FHIRcast proposed resolution</a> to this problem, is not a hack of the websockets header, but indeed does have the flaw of potential missed notifications during session re-connections.</p>



<a name="169266064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266064">(Jun 28 2019 at 22:01)</a>:</h4>
<p>I hadn't understood that the goal was actual guaranteed message delivery. That's a hard problem for push notifications! Your handshake and heartbeat messages (and acknowledgements) are the beginnings of a full blown protocol, but even that doesn't completely prevent missed notifications.</p>



<a name="169266165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266165">(Jun 28 2019 at 22:03)</a>:</h4>
<p>Hey back <span class="user-mention" data-user-id="191864">@Isaac Vetter</span> <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span><br>
I know that I keep drifting into reliable delivery, but that's not the goal.  We want to have a best-effort, but allow for the clients to detect/discover errors, and make sure there is a reasonable way to rebuild (other than wipe and start over).</p>



<a name="169266172"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266172" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266172">(Jun 28 2019 at 22:03)</a>:</h4>
<blockquote>
<p>The client opens the WebSocket connection, and sends along this “ticket” as part of an initial handshake.</p>
</blockquote>
<p>This ticket might as well be an OAuth access token -- but how is it sent? What is "the initial handshake"? Are you saying in fhircast the handshake just "connect to a URL" (and visible to anyone logging HTTP GET traffic)?</p>



<a name="169266236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266236">(Jun 28 2019 at 22:04)</a>:</h4>
<p>I am just trying to flesh out the result of "Needs to be defined" and want to understand what people have been doing already, along with the pros and cons.</p>



<a name="169266246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266246">(Jun 28 2019 at 22:04)</a>:</h4>
<blockquote>
<p>HIRcast describes a "ticket"-based authentication system, in which the hub.topic url provided to the subscriber as part of the secured SMART app launch serves not only as a unique session identifier, but also as an "authorization ticket". This authorization ticket effectively acts as a bearer token. The Hub should therefore take care to generate opaque and unique hub.topic values.</p>
</blockquote>
<p><a href="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support" target="_blank" title="https://fhircast.hl7.org/security-considerations/#experimental-websockets-support">https://fhircast.hl7.org/security-considerations/#experimental-websockets-support</a></p>



<a name="169266273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266273">(Jun 28 2019 at 22:05)</a>:</h4>
<p>If FHIRcast embeds the authenticate secret into the URL, what's the Subscription equivalent? Would we define... an operation like <code>GET /Subscription/:id/$websocket-ticket</code> that returned a URL to connect to? Would we define a protocol to manage session renewal / expiration?</p>



<a name="169266289"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266289" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266289">(Jun 28 2019 at 22:05)</a>:</h4>
<p>Indeed, I was reading that text from fhircast -- that's what my questions are about.</p>



<a name="169266354"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266354" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266354">(Jun 28 2019 at 22:06)</a>:</h4>
<blockquote>
<p>what's the Subscription equivalent? </p>
</blockquote>
<p>Yes. I imagined a 201 on the create with a wss:// url returned to the client.</p>



<a name="169266375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266375">(Jun 28 2019 at 22:07)</a>:</h4>
<p>Or maybe the closer analogy is to say that when a SMART app launches, it receives a generic "Websocket connection URL" that it can connect to as many times as it wants, and bind to different subscriptions in each connection.</p>



<a name="169266376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266376">(Jun 28 2019 at 22:07)</a>:</h4>
<blockquote>
<p>Would we define a protocol to manage session renewal / expiration?</p>
</blockquote>
<p>No. Session/subscription end when the access token expires. Full stop. Create a new subscription.</p>



<a name="169266385"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266385" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266385">(Jun 28 2019 at 22:07)</a>:</h4>
<p>Wait, subscriptions persist well across sessions though.</p>



<a name="169266387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266387">(Jun 28 2019 at 22:07)</a>:</h4>
<p>They can turn on and off, etc.</p>



<a name="169266400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266400">(Jun 28 2019 at 22:07)</a>:</h4>
<p>not in FHIRcast</p>



<a name="169266402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266402">(Jun 28 2019 at 22:07)</a>:</h4>
<p>Understood.</p>



<a name="169266406"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266406" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266406">(Jun 28 2019 at 22:07)</a>:</h4>
<p>but, okay</p>



<a name="169266407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266407">(Jun 28 2019 at 22:07)</a>:</h4>
<p>I'm thinking about whether/how we could use that as a model in Subscriptions.</p>



<a name="169266465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266465">(Jun 28 2019 at 22:08)</a>:</h4>
<p>On the websocket side in fhircast, do I understand right that the "secret" is just the URL that a client does a <code>GET</code> on to start the websocket connection?</p>



<a name="169266468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266468">(Jun 28 2019 at 22:08)</a>:</h4>
<p>yup. So, a Subscription gets turned off when an access token expires.</p>



<a name="169266474"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266474" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266474">(Jun 28 2019 at 22:08)</a>:</h4>
<p>In the case of Subscriptions, Josh, I believe the access token would just be a transient token value.  It would only have meaning in the context of connecting to the wss:// url</p>



<a name="169266475"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266475" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266475">(Jun 28 2019 at 22:08)</a>:</h4>
<blockquote>
<p>On the websocket side in fhircast, do I understand right that the "secret" is just the URL that a client does a GET on to start the websocket connection?</p>
</blockquote>
<p>Yes</p>



<a name="169266502"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266502" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266502">(Jun 28 2019 at 22:09)</a>:</h4>
<p>The client would then need to post another request, get the secret, and continue</p>



<a name="169266509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266509">(Jun 28 2019 at 22:09)</a>:</h4>
<p>Okay -- so generally in SMART we've avoided embedding secrets in URLs. It's not a hard prohibition, obviously... but we've avoided it.</p>



<a name="169266520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266520">(Jun 28 2019 at 22:09)</a>:</h4>
<p>the alternatives are:</p>
<ul>
<li>embedding the secret in a FHIR resource</li>
<li>embedding the secret in the name of a sub-protocol</li>
</ul>



<a name="169266579"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266579" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266579">(Jun 28 2019 at 22:10)</a>:</h4>
<ul>
<li>embedding the secret in a newly created protocol layer wrapping all your websocket traffic</li>
</ul>



<a name="169266665"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266665" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266665">(Jun 28 2019 at 22:12)</a>:</h4>
<ul>
<li>not supporting browser-based clients using native websocket libraries in FHIR Subscriptions</li>
</ul>



<a name="169266684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266684">(Jun 28 2019 at 22:12)</a>:</h4>
<blockquote>
<p>embedding the secret in a newly created protocol layer wrapping all your websocket traffic</p>
</blockquote>
<p>I don't understand that one.</p>
<p>OTherwise, yes agree with this list.</p>



<a name="169266772"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266772" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266772">(Jun 28 2019 at 22:14)</a>:</h4>
<p>i.e., put the secret in the url, headers, or body.</p>
<p>Those are the places.</p>



<a name="169266842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266842">(Jun 28 2019 at 22:15)</a>:</h4>
<blockquote>
<p>a newly created protocol layer wrapping your websocket traffic</p>
</blockquote>
<p>This would be dividing the body into an auth header and the FHIR body -- like SOAP. The HTTP body is a SOAP header and a SOAP body.</p>



<a name="169266938"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169266938" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169266938">(Jun 28 2019 at 22:17)</a>:</h4>
<p>OK -- makes sense and it's a sub-flavor of "body".</p>



<a name="169267513"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169267513" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169267513">(Jun 28 2019 at 22:26)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="169296434"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169296434" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169296434">(Jun 29 2019 at 13:01)</a>:</h4>
<p>"missed notifications"  -- can a FHIR Client request the 'current state' of the context when it reconnects?  Is that sufficient?   Are we're talking about the 'small window of time' when the Client's session is timing out and reestablishing a new session or are we talking about a FHIR client that 'went away' and then came back, e.g. the user exited an app and then restarted it on same desktop?  (I assume the former)</p>



<a name="169417356"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169417356" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169417356">(Jul 01 2019 at 18:07)</a>:</h4>
<p>What has been discussed is the handshake including the Subscription state information (but no way to pull back events).  The reason for not forcing the events to be available is because that would be proscribing message-queuing, etc. to all servers wanting to implement.  I can see that some servers may allow the behavior.<br>
My original concern was around the time gap of re-authenticating (e.g., server times out token, client gets new one, client reconnects).  Otherwise the client may need to rebuild every time a token expires, which does not feel like a robust process to me.<br>
Talking through, there appear to be remedies for this, so it shouldn't be an issue.</p>



<a name="169532335"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169532335" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169532335">(Jul 03 2019 at 01:16)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="194183">@John Silva</span> , also note that fhir subscriptions is describing a backend data integration and doesn't communicate the user session-type context as handled by FHIRcast. (I wanted to start this conversation to point out the gaps in the backend subscriptions websockets support that FHIRcast has already considered).</p>



<a name="169552234"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/169552234" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#169552234">(Jul 03 2019 at 09:33)</a>:</h4>
<p><span class="user-mention" data-user-id="193551">@Marco Visser</span>  - OK, thanks</p>



<a name="175720626"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/175720626" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#175720626">(Sep 14 2019 at 22:15)</a>:</h4>
<p>Just found this thread.  We’ve been running FHIR resources over websockets for 3 or 4 years now via the Data Distribution Protocol (defined by MIT alumni).  The general idea is protocol hoisting, which would be “embedding the secret in a newly created protocol layer”, and that newly created layer being DDP.</p>
<p><a href="https://github.com/meteor/meteor/blob/devel/packages/ddp/DDP.md" target="_blank" title="https://github.com/meteor/meteor/blob/devel/packages/ddp/DDP.md">https://github.com/meteor/meteor/blob/devel/packages/ddp/DDP.md</a></p>



<a name="175720677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/175720677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#175720677">(Sep 14 2019 at 22:16)</a>:</h4>
<p>Is that in prod?</p>



<a name="175720853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/175720853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#175720853">(Sep 14 2019 at 22:21)</a>:</h4>
<p>Very much so.  It works great, and we’ve done probably 40 or 50 prototypes and pilots with it.  We have two instance (that I know of) published into the Apple App Store.</p>



<a name="175720857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/How%20does%20a%20client%20authenticate%20with%20websockets%3F/near/175720857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/How.20does.20a.20client.20authenticate.20with.20websockets.3F.html#175720857">(Sep 14 2019 at 22:22)</a>:</h4>
<p>Excellent.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
