---
layout: page
title: "FHIR Chat  · security token for callback · subscriptions"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/index.html">subscriptions</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html">security token for callback</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153905993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153905993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153905993">(Sep 10 2017 at 21:21)</a>:</h4>
<p>Has there been discussion on how the subscription carries a security token for the callback?</p>



<a name="153906007"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906007" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906007">(Sep 10 2017 at 23:00)</a>:</h4>
<p>no. there's been no discussion</p>



<a name="153906012"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906012" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906012">(Sep 10 2017 at 23:22)</a>:</h4>
<p>In a project I was on, we used Subscription on DocumentReference as a way to produce a RESTful (FHIR) API that was asynchronous. We found that he callback needed some kind of security token. Initially we were thinking of adding an extension to carry this token. But what we were able to do is just do the callback without security token, given very constrained environment.   Having a way to put a security token into the subscription might be a useful feature. Seems this would also be a good way to deal with this similar problem in cds-hooks. Where this security token is just for the 'next' call (callback in subscription, but call forward for cds-hooks). WHere as the http auth token is then focused only on if the subscription requiest is authorized... sound reasonable?</p>



<a name="153906013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906013">(Sep 10 2017 at 23:25)</a>:</h4>
<p>follow the logic of conforming to cds-hooks, but there's a much wider range of implementation contexts for subscription (as opposed to cds-hooks)</p>



<a name="153906014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906014">(Sep 10 2017 at 23:25)</a>:</h4>
<p>didn't follow the 'next' bit</p>



<a name="153906015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906015">(Sep 10 2017 at 23:40)</a>:</h4>
<p>sorry. I am discussing cds-hooks and subscription as if they are the same thing... but they are only the same thing in that Party ONE is asking Party TWO to have a transaction with Party THREE.. where Party TWO needs to have some security token when communicating with Party THREE. In subscrption the Party THREE is the callback service endpoint, in cds-hooks it is the prefetch target server... right? Are there others that need this kind of an interaction model, so that we can look to a pattern?  The main point is that security token for TWO--&gt;THREE does not need to be (and should not be) the same securty token used b ONE--&gt; TWO.</p>



<a name="153906016"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906016" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906016">(Sep 10 2017 at 23:41)</a>:</h4>
<p>and where the security token is only usable by TWO for the purpose of transaction with THREE.</p>



<a name="153906018"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906018" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906018">(Sep 10 2017 at 23:57)</a>:</h4>
<p>I'm not sure if I'm following this conversation (not having worked on Subscriptions this weekend) or the analogies, but I believe the Party THREE you are referring to in CDS Hooks is the EHR FHIR Server.</p>



<a name="153906020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906020">(Sep 10 2017 at 23:58)</a>:</h4>
<p>I'd be interested to chat with you both on this further. It may be beneficial to discuss offline - perhaps at the bar later :-)</p>



<a name="153906021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906021">(Sep 10 2017 at 23:58)</a>:</h4>
<p>in the FHIR subscription model, it <em>may</em> also be the EHR FHIR server. but it may be all sorts of other things as well.</p>



<a name="153906026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906026">(Sep 11 2017 at 00:04)</a>:</h4>
<p>for now, there is no security arrangements on subscription for the push at all. You can do a push without any content, if there's no security arrangements. or else, the system may now the appropriate arrangements out band. The space in the middle is punted to the future</p>



<a name="153906027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906027">(Sep 11 2017 at 00:05)</a>:</h4>
<p>each of the channels has it's own security token requirements/options</p>



<a name="153906028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906028">(Sep 11 2017 at 00:21)</a>:</h4>
<p>sms: no security<br>
email: security by direct, or none. For direct, there's nothing to say in the subscription resource<br>
message: what security applies depends on the delivery method. We describe a HTTP post method, but indicate that MLLP, MQ series etc could be used. All these have different tokens</p>



<a name="153906029"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906029" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906029">(Sep 11 2017 at 00:21)</a>:</h4>
<p>Hey Guys,</p>
<p>Interesting conversation. <span class="user-mention" data-user-id="191404">@John Moehrke</span> - I'd love to hear more about your experience using Subscriptions with Document Reference.</p>



<a name="153906030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906030">(Sep 11 2017 at 00:22)</a>:</h4>
<p>websockets - has it's own model that isn't replicated into the subscription resource</p>



<a name="153906031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906031">(Sep 11 2017 at 00:22)</a>:</h4>
<p>rest-hook- either a bearer token or a user name and password, and potentially a certificate identity</p>



<a name="153906032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906032">(Sep 11 2017 at 00:24)</a>:</h4>
<p>In addition to Grahame's points, note that the current spec's optional Subscription.channel.payload element. Lack of a specified payload in the Subscription causes the server to simply "ping" the subscribed client, such that there's no data in the notification's body and the client must query the FHIR server to understand the recent change. (This neatly sidesteps the exact security need you're describing).</p>



<a name="153906033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906033">(Sep 11 2017 at 00:25)</a>:</h4>
<p>yes that's why it exists as an option</p>



<a name="153906034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906034">(Sep 11 2017 at 00:25)</a>:</h4>
<p>For the rest-hook specifically, <span class="user-mention" data-user-id="194360">@Niklas Svenzén</span> and I had briefly talked through the use of the  OAuth access_token created either via an actual "front-end" SMART app integration and/or via the OAuth client credentials / SMART Backend Services flow.</p>



<a name="153906035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906035">(Sep 11 2017 at 00:27)</a>:</h4>
<p>that's one logical option, yes</p>



<a name="153906036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906036">(Sep 11 2017 at 00:31)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  :)</p>
<p>Lastly, </p>
<blockquote>
<p>in that Party ONE is asking Party TWO to have a transaction with Party THREE.. </p>
</blockquote>
<p>in the case where ONE is the FHIR Server, TWO is the EHR (or other clinical workflow system) and THREE is the subscribing FHIR client -- </p>
<p>It's not obvious to me that FHIR Subscriptions actually requires TWO at all. Right?</p>



<a name="153906037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906037">(Sep 11 2017 at 00:32)</a>:</h4>
<p>well, there's 3 logical parties, but one actual party could play two of the roles - or even all 3</p>



<a name="153906038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906038">(Sep 11 2017 at 00:38)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> - <span class="user-mention" data-user-id="192646">@Bill Harty</span> walked through a scenario this morning, where his system  was both the subscribing client and the cause of the change that he was notified of (I'm pretty sure that he was even testing against your server).</p>
<p>While, sure, you can argue that there are three parties in this case, I'm pretty sure that we all agree that notifications come from the FHIR Server that holds the Subscription -- party ONE.</p>



<a name="153906039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906039">(Sep 11 2017 at 00:47)</a>:</h4>
<p>I have uses for my server arranging for it to notify itself of a change. that's just reusing the infrastructure for internal usage</p>



<a name="153906048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Hatt <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906048">(Sep 11 2017 at 03:19)</a>:</h4>
<p>Webhooks are generally an unsolved problem as far as authentication/authorization go. By unsolved I mean no IETF standard that covers them. In fact, authentication and authorization aren't necessarily that important as verifying that sender is who they say they are. That's the model behind github webhooks - they provide a HMAC signature of the body of the payload, hashed using a secret that the subscriber provides. Of course Oauth works fine too, but moreso 2-legged bearer token style.</p>



<a name="153906113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906113">(Sep 11 2017 at 15:41)</a>:</h4>
<p>I fully expect there are solutions in the general IT market. We should not have to invent something special in FHIR. What I think we could do is help identify patterns, so that parties can indicate their alignment on the same pattern. The security wg might get some time to talk about this on Wednesday Q3.</p>



<a name="153906257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Hatt <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906257">(Sep 11 2017 at 17:17)</a>:</h4>
<p>The examples for <code>criteria</code> don't include a URL. We would hypothetically be a subscription aggregator, one endpoint to manage subscriptions to various FHIR servers, and some kind of identification of which resource owner should get the subscription would be essential.</p>



<a name="153906260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906260">(Sep 11 2017 at 17:21)</a>:</h4>
<p>hmm. sounds like a different element to me</p>



<a name="153906262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Vetter <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906262">(Sep 11 2017 at 17:26)</a>:</h4>
<blockquote>
<p>... subscription aggregator, ... which resource owner should get the subscription would be essential.</p>
</blockquote>
<p>Hey <span class="user-mention" data-user-id="194031">@Nick Hatt</span> ! In your aggregator scenario, note that a lot of the time, the authenticiation mechanisms (probably OAuth access_token) will also be specific to the FHIR server/tenant as well. So an aggregator would definitely be managing endpoints and other information already.</p>



<a name="153906278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/security%20token%20for%20callback/near/153906278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Hatt <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/security.20token.20for.20callback.html#153906278">(Sep 11 2017 at 18:05)</a>:</h4>
<p><span class="user-mention" data-user-id="191864">@Isaac Vetter</span>  We manage tokens as well, so people log into our site and setup OAuth through our platform. It lets people offload the complexity of refresh tokens, monitoring, and troubleshooting. In other words, our customers authenticate to us once, so they need some kind of content-level flag to indicate which FHIR server/tenant/EHR/deployment they care about. But as <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> suggests it can just be an extension, or even a custom HTTP header on subscription create.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
