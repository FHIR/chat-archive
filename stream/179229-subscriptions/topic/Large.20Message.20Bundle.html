---
layout: page
title: "FHIR Chat  · Large Message Bundle · subscriptions"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/index.html">subscriptions</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html">Large Message Bundle</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="213806935"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213806935" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> OS <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213806935">(Oct 19 2020 at 15:56)</a>:</h4>
<p>X-Post - <a href="#narrow/stream/179166-implementers/topic/subscriptions/near/213805700">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/subscriptions/near/213805700</a></p>
<p>Hi all - <br>
I'm building a system for taking FHIR data and mastering (MDM) certain elements, and pushing certain elements to a data lake. The data we get (mostly practitioner/practitionerRole resources) can come in massive batches at times (1000s of resource entries). If that happens, and if we have a SubscriptionTopic and Subscription set up with a rest hook, how will that data be pushed? I know during the querying process, the pagination limits a page to 200 resources. Will the subscription post multiple bundles in that case of 200 resources? Or Would it post a larger bundle? Or would it fail? Any guidance here would be super helpful. I'm sure the 200-item limit is a configuration that can be changed, but my question stands regardless of if the posted bundle is &gt; the limit of # of resources on a page. Thanks in advance</p>



<a name="213808365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213808365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213808365">(Oct 19 2020 at 16:07)</a>:</h4>
<p>Interesting question - so far we've been leaving this up to the server's discretion (e.g., when to bundle, and how many).  In this case, we probably do need some way to establish a 'max' for the bundling process, so that the server doesn't try to send more entries than the receiver accepts.  Do you want to open a Jira for this?</p>



<a name="213824394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213824394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> OS <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213824394">(Oct 19 2020 at 18:13)</a>:</h4>
<p>Sure thing! Just so I understand though, is the current out-of-the-box behavior that the resources will not be paginated and the (HAPI) FHIR server will try to send the entire set? Or will it still send a paginated/truncated bundle over?</p>



<a name="213825372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213825372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> OS <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213825372">(Oct 19 2020 at 18:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="285887">OS</span> <a href="#narrow/stream/179229-subscriptions/topic/Large.20Message.20Bundle/near/213824394">said</a>:</p>
<blockquote>
<p>Sure thing! Just so I understand though, is the current out-of-the-box behavior that the resources will not be paginated and the (HAPI) FHIR server will try to send the entire set? Or will it still send a paginated/truncated bundle over?</p>
</blockquote>
<p>Added the following issue in JIRA: <a href="https://jira.hl7.org/browse/FHIR-29315">https://jira.hl7.org/browse/FHIR-29315</a> and cc'd you on it as well. If you have any thoughts on what the current out-of-box behavior would be, that'd be very much appreciated! Thanks!</p>



<a name="213826958"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213826958" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213826958">(Oct 19 2020 at 18:35)</a>:</h4>
<p>Notification bundles don't have any sort of pagination support.  There's simply a bundle that contains 'x' number of notifications within it.  So far, we've left it entirely up to the server implementation to decide when to bundle multiple notifications together and how many to do.</p>
<p>I think there should be some way for a client to specify their upper bounds on the notifications, but I don't know if that should be an element on the Subscription or an extension, and if it should be count or size.</p>



<a name="213827054"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213827054" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213827054">(Oct 19 2020 at 18:36)</a>:</h4>
<p>It seems to me that it should follow the default paging size for $everything.  That way it's consistent and defaults to 20</p>



<a name="213827692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213827692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213827692">(Oct 19 2020 at 18:41)</a>:</h4>
<p>That's an option - though it sets a single expectation instead of leaving it per-client (e.g., a lightweight client connected via websockets has the same hard cap as a large batch-processing server).</p>



<a name="213828263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213828263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213828263">(Oct 19 2020 at 18:46)</a>:</h4>
<p>Maybe I am missing some context, but why is it expected that with subscription there will be notifications for 1000s of resources?</p>



<a name="213829413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213829413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213829413">(Oct 19 2020 at 18:55)</a>:</h4>
<p>This could happen, for example, if you have broad subscriptions looking for all changes to resources of a particular type. Imagine a subscription to all changes in Practitioners, coupled with a server that has just performed a transaction-based loading of a pile of practitioners -- a client's subscription could accumulate a bunch of events all at once.</p>



<a name="213833900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213833900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> OS <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213833900">(Oct 19 2020 at 19:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179229-subscriptions/topic/Large.20Message.20Bundle/near/213829413">said</a>:</p>
<blockquote>
<p>This could happen, for example, if you have broad subscriptions looking for all changes to resources of a particular type. Imagine a subscription to all changes in Practitioners, coupled with a server that has just performed a transaction-based loading of a pile of practitioners -- a client's subscription could accumulate a bunch of events all at once.</p>
</blockquote>
<p>This is precisely our use case. <br>
I like your option <span class="user-mention" data-user-id="192587">@David Pyke</span>  - from a developer's point of view, that gives me something that I can start from in my conversations with clients. I totally get your pov <span class="user-mention" data-user-id="222054">@Gino Canessa</span>  - however, I think the safety of having a default to start with would result in more predictable behavior, rather than encountering edge cases  when a server unexpectedly spikes for example. </p>
<p>In any case, <span class="user-mention" data-user-id="222054">@Gino Canessa</span>  is correct this is an implementation question, I probably need to pose this to a HAPI workgroup. Thanks for the responses!</p>



<a name="213837462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213837462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213837462">(Oct 19 2020 at 20:03)</a>:</h4>
<p>Sounds good - please do keep in mind that the decision to batch is (and will stay) up to the server (e.g., whether to batch notifications or send single ones).</p>



<a name="213839380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213839380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> OS <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213839380">(Oct 19 2020 at 20:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="222054">Gino Canessa</span> <a href="#narrow/stream/179229-subscriptions/topic/Large.20Message.20Bundle/near/213837462">said</a>:</p>
<blockquote>
<p>Sounds good - please do keep in mind that the decision to batch is (and will stay) up to the server (e.g., whether to batch notifications or send single ones).</p>
</blockquote>
<p>Absolutely! Humble suggestion - perhaps the documentation should make that explicit. It may just be me, but when I saw that the results are returned as a bundle, I automatically assumed it was batch (but that may be my own mistake)</p>



<a name="213841756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179229-subscriptions/topic/Large%20Message%20Bundle/near/213841756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179229-subscriptions/topic/Large.20Message.20Bundle.html#213841756">(Oct 19 2020 at 20:34)</a>:</h4>
<p>Thanks for the feedback - I'll look at that section when I'm updating docs this week.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
