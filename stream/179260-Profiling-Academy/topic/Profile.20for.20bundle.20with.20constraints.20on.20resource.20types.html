---
layout: page
title: "FHIR Chat  · Profile for bundle with constraints on resource types · Profiling Academy"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/index.html">Profiling Academy</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html">Profile for bundle with constraints on resource types</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="226021574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226021574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johanna Eicher <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226021574">(Feb 11 2021 at 16:52)</a>:</h4>
<p>Hi,<br>
I want to create a FHIR profile for a bundle with the following constraints:</p>
<ul>
<li>the bundle should contain exactly one patient resource</li>
<li>the bundle may contain any number of encounter resources.</li>
</ul>
<p>I'm using Forge where I sliced on the bundle entry and created two slices for each resource type <a href="/user_uploads/10155/mUrS3SsIQ8uwwBuOlQ2YM5ku/image.png">see here</a>. I'm not sure which discriminator type to use and I don't know how to specify which of the two new slices is for the patient and which one is for the encounter.</p>
<div class="message_inline_image"><a href="/user_uploads/10155/mUrS3SsIQ8uwwBuOlQ2YM5ku/image.png" title="see here"><img src="/user_uploads/10155/mUrS3SsIQ8uwwBuOlQ2YM5ku/image.png"></a></div><p>Does anyone have any tips of how to accomplish this or maybe an example of a structure definition where a bundle was sliced this way?</p>



<a name="226098765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226098765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226098765">(Feb 12 2021 at 05:02)</a>:</h4>
<p>This should work</p>
<p>&lt;differential&gt;<br>
    &lt;element id="Bundle"&gt;<br>
      &lt;path value="Bundle" /&gt;<br>
    &lt;/element&gt;<br>
    &lt;element id="Bundle.entry"&gt;<br>
      &lt;path value="Bundle.entry" /&gt;<br>
      &lt;slicing&gt;<br>
        &lt;discriminator&gt;<br>
          &lt;type value="type" /&gt;<br>
          &lt;path value="resource" /&gt;<br>
        &lt;/discriminator&gt;<br>
        &lt;rules value="open" /&gt;<br>
      &lt;/slicing&gt;<br>
      &lt;min value="1" /&gt;<br>
    &lt;/element&gt;<br>
    &lt;element id="Bundle.entry:pat"&gt;<br>
      &lt;path value="Bundle.entry" /&gt;<br>
      &lt;sliceName value="pat" /&gt;<br>
      &lt;max value="1" /&gt;<br>
    &lt;/element&gt;<br>
    &lt;element id="Bundle.entry:pat.resource"&gt;<br>
      &lt;path value="Bundle.entry.resource"/&gt;<br>
      &lt;min value="1"/&gt;<br>
      &lt;type&gt;<br>
        &lt;code value="Patient"/&gt;<br>
      &lt;/type&gt;<br>
    &lt;/element&gt;<br>
    &lt;element id="Bundle.entry:per"&gt;<br>
      &lt;path value="Bundle.entry" /&gt;<br>
      &lt;sliceName value="per" /&gt;<br>
      &lt;min value="1" /&gt;<br>
    &lt;/element&gt;<br>
    &lt;element id="Bundle.entry:per.resource"&gt;<br>
      &lt;path value="Bundle.entry.resource"/&gt;<br>
      &lt;min value="1"/&gt;<br>
      &lt;type&gt;<br>
        &lt;code value="Person"/&gt;<br>
      &lt;/type&gt;<br>
    &lt;/element&gt;<br>
  &lt;/differential&gt;</p>



<a name="226124620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226124620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johanna Eicher <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226124620">(Feb 12 2021 at 11:20)</a>:</h4>
<p>I will check it out, thank you!</p>



<a name="226140613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226140613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johanna Eicher <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226140613">(Feb 12 2021 at 14:08)</a>:</h4>
<p>This is the result from my attempt. Does that look okay to you?</p>
<p>&lt;differential&gt;<br>
 &lt;element id="Bundle.entry"&gt;<br>
&lt;path value="Bundle.entry"/&gt;<br>
 &lt;slicing&gt;<br>
 &lt;discriminator&gt;<br>
&lt;type value="type"/&gt;<br>
&lt;path value="resource"/&gt;<br>
&lt;/discriminator&gt;<br>
&lt;rules value="open"/&gt;<br>
&lt;/slicing&gt;<br>
&lt;min value="1"/&gt;<br>
&lt;/element&gt;<br>
 &lt;element id="Bundle.entry:patientEntry"&gt;<br>
&lt;path value="Bundle.entry"/&gt;<br>
&lt;sliceName value="patientEntry"/&gt;<br>
&lt;min value="1"/&gt;<br>
&lt;max value="1"/&gt;<br>
&lt;/element&gt;<br>
 &lt;element id="Bundle.entry:patientEntry.resource"&gt;<br>
&lt;path value="Bundle.entry.resource"/&gt;<br>
&lt;min value="1"/&gt;<br>
 &lt;type&gt;<br>
&lt;code value="Resource"/&gt;<br>
&lt;profile value="Patient"/&gt;<br>
&lt;/type&gt;<br>
&lt;/element&gt;<br>
 &lt;element id="Bundle.entry:encounterEntry"&gt;<br>
&lt;path value="Bundle.entry"/&gt;<br>
&lt;sliceName value="encounterEntry"/&gt;<br>
&lt;/element&gt;<br>
 &lt;element id="Bundle.entry:encounterEntry.resource"&gt;<br>
&lt;path value="Bundle.entry.resource"/&gt;<br>
 &lt;type&gt;<br>
&lt;code value="Resource"/&gt;<br>
&lt;profile value="Encounter"/&gt;<br>
&lt;/type&gt;<br>
&lt;/element&gt;<br>
&lt;/differential&gt;</p>



<a name="226330566"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226330566" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226330566">(Feb 14 2021 at 23:00)</a>:</h4>
<p>Looks OK to me.<br>
If you want to prohibit entries that are neither Patient nor Encounter, make the slicing closed.</p>
<div class="codehilite"><pre><span></span><code>        &lt;slicing&gt;
            &lt;discriminator&gt;
                &lt;type value=&quot;type&quot;/&gt;
                &lt;path value=&quot;resource&quot;/&gt;
            &lt;/discriminator&gt;
            &lt;rules value=&quot;closed&quot;/&gt;
        &lt;/slicing&gt;```
</code></pre></div>



<a name="226330787"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226330787" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226330787">(Feb 14 2021 at 23:04)</a>:</h4>
<p>If slicing is open, the encounterEncounter slice constrains nothing. If you want to allow Patient, Encounter and anything else, you do not need the Encounter slice, though you might want it as documentation for humans to show you are interested in encounters.</p>



<a name="226331226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226331226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226331226">(Feb 14 2021 at 23:15)</a>:</h4>
<p>On reflection, I think that </p>
<div class="codehilite"><pre><span></span><code>&lt;type&gt;
    &lt;code value=&quot;Resource&quot;/&gt;
    &lt;profile value=&quot;Encounter&quot;/&gt;
&lt;/type&gt;
</code></pre></div>
<p>should be</p>
<div class="codehilite"><pre><span></span><code>&lt;type&gt;
    &lt;code value=&quot;Encounter&quot;/&gt;
&lt;/type&gt;
</code></pre></div>
<p>As Encounter is a valid type.</p>



<a name="226383220"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226383220" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johanna Eicher <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226383220">(Feb 15 2021 at 13:24)</a>:</h4>
<p>I actually want to prohibit any other resources, thank you for the tip about the closed slicing.</p>
<p>About the type definition, I didn't know how to create this</p>
<div class="codehilite"><pre><span></span><code> &lt;type&gt;
      &lt;code value=&quot;Encounter&quot;/&gt;
 &lt;/type&gt;
</code></pre></div>
<p>in Forge. I tried to set it in the Element properties of the resource (see <a href="/user_uploads/10155/nqU409IvuFYjLdRTHJPcMWJ3/image.png">image.png</a> ), but the result is</p>
<div class="message_inline_image"><a href="/user_uploads/10155/nqU409IvuFYjLdRTHJPcMWJ3/image.png" title="image.png"><img src="/user_uploads/10155/nqU409IvuFYjLdRTHJPcMWJ3/image.png"></a></div><div class="codehilite"><pre><span></span><code>&lt;type&gt;
   &lt;code value=&quot;Resource&quot;/&gt;
   &lt;profile value=&quot;Encounter&quot;/&gt;
&lt;/type&gt;
</code></pre></div>
<p>Any tips for how to do this in Forge?</p>



<a name="226458955"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226458955" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226458955">(Feb 16 2021 at 00:31)</a>:</h4>
<p>If Forge does it that way it should work just fine.</p>



<a name="226511298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226511298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthijs van der Wielen <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226511298">(Feb 16 2021 at 13:16)</a>:</h4>
<p>Although it doesn't seem intuitive, you can specify the resource type by defining a "profile" on resource. Since all other core resources are technically profiles on resource. In the screenshot attached you can see how to define that you can only use "Patient" in this slice. You can add other canonical URLs to define other options, which can be core resources or local profiles.<br>
This would result in the following:</p>
<div class="codehilite"><pre><span></span><code> &lt;type&gt;
       &lt;code value=&quot;Resource&quot;/&gt;
       &lt;profile value=&quot;http://hl7.org/fhir/StructureDefinition/Patient&quot;/&gt;
&lt;/type&gt;
</code></pre></div>
<p><a href="/user_uploads/10155/MmmFEMXhphP1KXpW7QkVnzch/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/MmmFEMXhphP1KXpW7QkVnzch/image.png" title="image.png"><img src="/user_uploads/10155/MmmFEMXhphP1KXpW7QkVnzch/image.png"></a></div>



<a name="226541499"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/226541499" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johanna Eicher <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#226541499">(Feb 16 2021 at 16:56)</a>:</h4>
<p>Thank you very much, it was the canonical URL that I was missing!</p>



<a name="227399093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179260-Profiling%20Academy/topic/Profile%20for%20bundle%20with%20constraints%20on%20resource%20types/near/227399093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johanna Eicher <a href="https://fhir.github.io/chat-archive/stream/179260-Profiling-Academy/topic/Profile.20for.20bundle.20with.20constraints.20on.20resource.20types.html#227399093">(Feb 23 2021 at 08:57)</a>:</h4>
<p>I have now created my own profiles for the different entries as well (Patient, Encounter, etc). But when I link them in the Bundle via the URL I get the following error: <a href="/user_uploads/10155/OGfwOKL2URfBrANt8VcrwXvl/image.png">image.png</a> .<br>
Do you have any idea where this problem might originate from?</p>
<div class="message_inline_image"><a href="/user_uploads/10155/OGfwOKL2URfBrANt8VcrwXvl/image.png" title="image.png"><img src="/user_uploads/10155/OGfwOKL2URfBrANt8VcrwXvl/image.png"></a></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
