---
layout: page
title: "FHIR Chat  · Where conditions · CCDA / FHIR mapping stream"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/index.html">CCDA / FHIR mapping stream</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/Where.20conditions.html">Where conditions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153957093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/Where%20conditions/near/153957093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/Where.20conditions.html#153957093">(May 09 2018 at 02:26)</a>:</h4>
<p>I'm slightly confused by the context that exists for where conditions in mapping rules.  I want to express a rule like this: <code>for source as srcSection where code.code = "48765-2"</code>  but that doesn't fire.  When I trace it in the debugger, it is quite tough to make heads or tails of whether it is supposed to work.  I am assuming that the context for my where clause is the initial variable, i.e. source.  So this should work when my XML is <code> &lt;section&gt;&lt;code code="48765-2" .../&gt; </code></p>



<a name="153957105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/Where%20conditions/near/153957105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/Where.20conditions.html#153957105">(May 09 2018 at 05:48)</a>:</h4>
<p>hmm. maybe I could document this better. There's no implicit context for that FHIRPath statement. You need to do where srcSection.code.code</p>



<a name="153957106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/Where%20conditions/near/153957106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/Where.20conditions.html#153957106">(May 09 2018 at 05:48)</a>:</h4>
<p>you can start with a reference to any of the variables in scope</p>



<a name="153957113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/Where%20conditions/near/153957113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/Where.20conditions.html#153957113">(May 09 2018 at 06:42)</a>:</h4>
<p>hmm, i must still have something wrong:</p>
<div class="codehilite"><pre><span></span>section: for source.component as component then {
    body: for component.structuredBody as body then {
        component: for body.component as component then {
            allergySection: for component.section as srcSection where srcSection.code.code = &quot;48765-2&quot; make target.section as tgtSection then AllergySection(srcSection, bundle, tgtSection)
            section: for component.section as srcSection where srcSection.code.code != &quot;48765-2&quot; make target.section as tgtSection then ClinicalDocumentSection(srcSection, tgtSection)
        }
    }
}
</pre></div>


<p>the allergySection rule is always firing even though only one of my sections has a code with 48765-2.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
