---
layout: page
title: "FHIR Chat  · ccda-to-fhir · CCDA / FHIR mapping stream"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/index.html">CCDA / FHIR mapping stream</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html">ccda-to-fhir</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="200463009"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/200463009" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Boerner <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#200463009">(Jun 10 2020 at 19:14)</a>:</h4>
<p>I'm looking to try using the opensource solution here  <a href="https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Mapping+Language">https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Mapping+Language</a> for mapping CCDA to FHIR.</p>
<p>I'm really struggling to get the CLI tool to work and was hoping someone might be able to point me in the right direction.</p>
<p>It appears from the example I'm working with at <a href="https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content#CCDA_to_FHIR">https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content#CCDA_to_FHIR</a> which references this solution that there are numerous out of date / broken references.</p>
<p>Does anyone have an up to date project/command that I could reference?</p>
<p>I am trying /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/bin/java -jar org.hl7.fhir.validator.jar /Users/davidboerner/Documents/GitHub/ArielCCD.xml -transform /Users/davidboerner/Documents/GitHub/ccda-to-fhir/mappings/CCDAToFHIR.map -ig hl7.fhir.us.ccda -ig /Users/davidboerner/Documents/GitHub/ccda-to-fhir/mappings/ -output /Users/davidboerner/Documents/GitHub/ccda-to-fhir/output/ariel.json -ig hl7.fhir.r4.core -version 4.0 -log test.txt</p>
<p>but getting this error, even though I'm referencing the input structure as CCDA (-ig hl7.fhir.us.ccda) which I had to update from -ig hl7.fhir.cda#2.0 which is a broken link</p>
<p>...Failure: This does not appear to be a FHIR resource (unknown namespace/name "urn:hl7-org:v3::ClinicalDocument") at line 0 col 0<br>
org.hl7.fhir.exceptions.FHIRFormatError: This does not appear to be a FHIR resource (unknown namespace/name "urn:hl7-org:v3::ClinicalDocument") at line 0 col 0</p>
<p>Any help most appreciated!</p>



<a name="200516877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/200516877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#200516877">(Jun 11 2020 at 08:25)</a>:</h4>
<p>The error message looks like the validator has the CDA Logical Model not available. I do not have experience with the CCDA Model, but maybe cou can specify the CDA Logical Model itself directly with the parameter -ig <a href="https://build.fhir.org/ig/HL7/cda-core-2.0/package.tgz">https://build.fhir.org/ig/HL7/cda-core-2.0/package.tgz</a> to look if the validator can parse the file. Are you using the latest version of the validator?</p>



<a name="200667214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/200667214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Boerner <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#200667214">(Jun 12 2020 at 13:04)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191478">@Oliver Egger</span>  that perhaps has gotten me a bit further? I am using the latest versions.</p>
<p>I tried java -jar org.hl7.fhir.validator.jar /Users/davidboerner/Documents/GitHub/ArielCCD.xml -transform /Users/davidboerner/Documents/GitHub/ccda-to-fhir/mappings/CCDAToFHIR.map -ig <a href="https://build.fhir.org/ig/HL7/cda-core-2.0/package.tgz">https://build.fhir.org/ig/HL7/cda-core-2.0/package.tgz</a> -ig /Users/davidboerner/Documents/GitHub/ccda-to-fhir/mappings/ -output /Users/davidboerner/Documents/GitHub/ccda-to-fhir/output/ariel.json -version 4.0 -log test.txt</p>
<p>and now getting the following error:</p>
<ul>
<li>.. load IG from <a href="https://build.fhir.org/ig/HL7/cda-core-2.0/package.tgz">https://build.fhir.org/ig/HL7/cda-core-2.0/package.tgz</a><br>
 ...Failure: Type 'IVL_TS' is not an acceptable type for 'effectiveTime' on property SubstanceAdministration.effectiveTime<br>
org.hl7.fhir.exceptions.DefinitionException: Type 'IVL_TS' is not an acceptable type for 'effectiveTime' on property SubstanceAdministration.effectiveTime</li>
</ul>
<p>Is this a problem with the CDA logical definition I'm trying to pull from?</p>



<a name="200671797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/200671797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Boerner <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#200671797">(Jun 12 2020 at 13:47)</a>:</h4>
<p>I edited my inbound CCD a bit and was able to get past those validation errors, but looks like I'm choking on the transform bit.</p>
<p>In general I'm wondering if anybody has a functional project that transforms a CCDA to FHIR bundle?</p>
<p>Should I be using <a href="https://github.com/HL7/ccda-to-fhir">https://github.com/HL7/ccda-to-fhir</a> or the validator within <a href="https://github.com/hapifhir/org.hl7.fhir.core#download">https://github.com/hapifhir/org.hl7.fhir.core#download</a> ?</p>



<a name="200816650"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/200816650" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#200816650">(Jun 14 2020 at 13:28)</a>:</h4>
<p>The CDA logical model currently defines IVL-TS as type and not IVL_TS, I assume the error comes from that. I made a <a href="https://github.com/HL7/cda-core-2.0/pull/43">PR</a> to propose a solution since the FHIR Mapping Language cannot work currently with the - character.  You can try to use apply the map with the CDA Model containing the PR and use -ig <a href="http://build.fhir.org/ig/ahdis/cda-core-2.0/branches/pullrequests/package.tgz">http://build.fhir.org/ig/ahdis/cda-core-2.0/branches/pullrequests/package.tgz</a></p>



<a name="218304683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218304683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218304683">(Nov 30 2020 at 15:51)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span>  Hi, I am looking of logical models for CDA similar what is there at <a href="http://build.fhir.org/ig/ahdis/cda-core-2.0/branches/pullrequests/package.tgz">http://build.fhir.org/ig/ahdis/cda-core-2.0/branches/pullrequests/package.tgz</a> and not in R4 but STU3. Thanks!</p>



<a name="218306206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218306206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218306206">(Nov 30 2020 at 16:01)</a>:</h4>
<p>The logical model is here: <a href="https://github.com/hl7/cda-core-2.0">https://github.com/hl7/cda-core-2.0</a>. Why do you need that in a STU3 version? The logical model itself is independent of the version, however it is described in conformance resources with R4, I don't think backporting to STU3 would be easy.</p>



<a name="218371448"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218371448" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218371448">(Dec 01 2020 at 01:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span> I was assuming its version dependent. Thanks you for the help.</p>



<a name="218387676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218387676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218387676">(Dec 01 2020 at 07:30)</a>:</h4>
<p><span class="user-mention" data-user-id="263322">@Kailash</span> depending what you want to use the model for, the logical model conformance resource versions could have an impact.</p>



<a name="218389081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218389081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218389081">(Dec 01 2020 at 07:54)</a>:</h4>
<p>I want to use logical model for ccd to FHIR mapping (transformation) for STU3</p>



<a name="218393132"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218393132" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218393132">(Dec 01 2020 at 08:43)</a>:</h4>
<p>i think that might work, but you would need to develop the maps to STU3 and find or configure an mapping engine that can directly run the maps.</p>



<a name="218404698"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218404698" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218404698">(Dec 01 2020 at 10:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span>  thanks , I am still not clear if transformation possible directly using maps (mapping using FHIR mapping language) or I need to first $convert it into StructureMap resource and then use $transform for input data? If both case are possible then should I choose the approach based on server capabilities for supported operations?</p>



<a name="218405637"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218405637" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218405637">(Dec 01 2020 at 10:53)</a>:</h4>
<p>this depends on the tooling you use. the java validator can handle maps directly (converts it to StructureMap internally), if you use a server based setup you will need to provide the StructureMap and can then use the $transform operation, see also <a href="https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Mapping+Language">https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Mapping+Language</a></p>



<a name="218413993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/218413993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#218413993">(Dec 01 2020 at 12:21)</a>:</h4>
<p>Thanks for the input this will help to choose both the tooling and approach.</p>



<a name="243000436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/243000436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ilayaraja <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#243000436">(Jun 17 2021 at 10:51)</a>:</h4>
<p>I am getting "The Coding provided (<a href="http://terminology.hl7.org/CodeSystem/v3-Ethnicity#2135-2">http://terminology.hl7.org/CodeSystem/v3-Ethnicity#2135-2</a>) is not in the value set <a href="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.837">http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.837</a>, and a code is required from this value set. (error message = Not in value set <a href="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.837">http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.114222.4.11.837</a>)" on FHIR validation.<br>
I am trying to use <a href="http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity">http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity</a> extension in Patient resource.<br>
Kindly help me on resolving this issue.</p>



<a name="243845135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/243845135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#243845135">(Jun 24 2021 at 20:54)</a>:</h4>
<p>You might be best raising this in <a class="stream" data-stream-id="179190" href="/#narrow/stream/179190-united-states">#united states</a> or <a class="stream" data-stream-id="291844" href="/#narrow/stream/291844-FHIR-Validator">#FHIR Validator</a> as it doesn't seem like a mapping issue</p>



<a name="245982614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/245982614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ilayaraja <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#245982614">(Jul 14 2021 at 16:16)</a>:</h4>
<p>I am using .Net <strong>Hl7.Fhir.Validation</strong> and in that I tried <strong>ExternalTerminologyService</strong> but it is getting failed with the following error,<br>
"Terminology service failed while validating code 'work' (system ''): Operation was unsuccessful because of a client error (NotFound). OperationOutcome: Overall result: FAILURE (1 errors and 0 warnings)<br>
[ERROR] (no details)(further diagnostics: Endpoint returned a body with contentType 'text/html', while a valid FHIR xml/json body type was expected. Is this a FHIR endpoint?)."</p>
<p>I am using the following .Net code for the implementation,</p>
<p>var validationSource = new CachedResolver(ZipSource.CreateValidationSource());<br>
var settings = new FhirClientSettings<br>
{<br>
    Timeout = 12000,<br>
    PreferredFormat = ResourceFormat.Json,<br>
    VerifyFhirVersion = true,<br>
    PreferredReturn = Prefer.ReturnMinimal<br>
};</p>
<p>var client = new FhirClient(new Uri("<a href="http://tx.fhir.org">http://tx.fhir.org</a>"), settings);<br>
var valuesetExpanderSettings = new ValueSetExpanderSettings()<br>
{<br>
    ValueSetSource = validationSource,<br>
    MaxExpansionSize = 500,<br>
    IncludeDesignations = true<br>
};</p>
<p>var validationSettings = new ValidationSettings()<br>
{<br>
    //ConstraintBestPractices = ConstraintBestPractices.Enabled,<br>
    //SkipConstraintValidation = false,<br>
    ResourceResolver = validationSource,<br>
    GenerateSnapshot = true,<br>
    EnableXsdValidation = true,<br>
    Trace = false,<br>
    ResolveExternalReferences = true,<br>
    TerminologyService = new LocalTerminologyService(validationSource, valuesetExpanderSettings)//new ExternalTerminologyService(client)<br>
};<br>
var validator1 = new Validator(validationSettings);<br>
var validationResult = validator1.Validate(collection);<br>
if (!validationResult.Success) { }</p>
<p>Kindly help me on resolving this issue.</p>



<a name="245985170"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179273-CCDA%20/%20FHIR%20mapping%20stream/topic/ccda-to-fhir/near/245985170" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179273-CCDA-/-FHIR-mapping-stream/topic/ccda-to-fhir.html#245985170">(Jul 14 2021 at 16:37)</a>:</h4>
<p>I think you need to do "<a href="http://tx.fhir.org/r4">http://tx.fhir.org/r4</a>"</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
