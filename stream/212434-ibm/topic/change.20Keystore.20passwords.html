---
layout: page
title: "FHIR Chat  · change Keystore passwords · ibm"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/index.html">ibm</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html">change Keystore passwords</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="219812106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/219812106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cornelius Erbelding <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#219812106">(Dec 14 2020 at 08:36)</a>:</h4>
<p>Hi everyone,<br>
i'm facing the following problem with my dockerized IBM FHIR Server:<br>
Changing the password of <code>fhirKeyStore.p12</code> works well, as this keystore is mounted from the host machine (containing the local https-certificate). <br>
When changing the password of <code>fhirTrustStore.p12</code> in <code>server.xml</code> (as this is the only place where i can find the password-configuration) accessing the keystore fails.</p>
<p>Is it really necessary to mount a <code>fhirTrustStore.p12</code> with the updated password or is there another password-configuration anywhere?</p>



<a name="220008937"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/220008937" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#220008937">(Dec 15 2020 at 17:00)</a>:</h4>
<p>Hi Cornelius,  one option you can mount a configDrops/override that has the updated details, it might not do exactly what you want, however, it should override the server.xml behavior for the keystore</p>



<a name="220009041"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/220009041" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#220009041">(Dec 15 2020 at 17:00)</a>:</h4>
<p>Otherwise, I don't think you can as part of the image update the fhirtTrustStore.p12 password in the image itself</p>



<a name="220013832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/220013832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#220013832">(Dec 15 2020 at 17:33)</a>:</h4>
<p>Thinking about this some more - maybe we could make an enhancement to externalize it? <span class="user-mention" data-user-id="191676">@Lee Surprenant</span> when you get a second what do you think?</p>



<a name="220019875"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/220019875" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#220019875">(Dec 15 2020 at 18:17)</a>:</h4>
<blockquote>
<p>Is it really necessary to mount a fhirTrustStore.p12 with the updated password or is there another password-configuration anywhere?</p>
</blockquote>
<p>the configured trustStore password (in server.xml or a configDropin) really does need to match the actual password of the configured truststore.<br>
this truststore is used for two main things:</p>
<ul>
<li>designating which client certs the server should trust (we enable mutual TLS by default, but with these sample certs)</li>
<li>security the connection of outbound TLS (although the db connection may use a different one...i know postgresql does)</li>
</ul>
<p>are you using mTLS?<br>
if not, you can decide how tight to make your truststore.  one thing I'd like to do is update the server to use the default java truststore by default (e.g. by setting the following env property which is supported by liberty: <br>
 SEC_TLS_TRUSTDEFAULTCERTS=true).  the only thing stopping me is that currently we ship with that sample mTLS setup and so we still need our self-signed client cert in the truststore for that to work.</p>



<a name="220019975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/220019975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#220019975">(Dec 15 2020 at 18:17)</a>:</h4>
<blockquote>
<p>maybe we could make an enhancement to externalize it?</p>
</blockquote>
<p>sounds reasonable to me. is there a keytool command for changing the password of an existing store?  or do you need to create a new one and copy over the entries?</p>



<a name="220081321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/220081321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cornelius Erbelding <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#220081321">(Dec 16 2020 at 06:15)</a>:</h4>
<blockquote>
<p>sounds reasonable to me. is there a keytool command for changing the password of an existing store? or do you need to create a new one and copy over the entries?</p>
</blockquote>
<p>Yes, there is one: <code>keytool -storepasswd -keystore fhirTrustStore.p12</code></p>



<a name="220081386"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/change%20Keystore%20passwords/near/220081386" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cornelius Erbelding <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/change.20Keystore.20passwords.html#220081386">(Dec 16 2020 at 06:16)</a>:</h4>
<blockquote>
<p>one option you can mount a configDrops/override that has the updated details, it might not do exactly what you want, however, it should override the server.xml behavior for the keystore<br>
 Otherwise, I don't think you can as part of the image update the fhirtTrustStore.p12 password in the image itself</p>
</blockquote>
<p>I've copied the <code>fhirTrustStore.p12</code> from the Docker-Container, changed the password and mounted it directly to <code>./resources/security/fhirTrustStore.p12</code>.<br>
My keystore credentials (for <code>fhirTrustStore</code> and <code>fhirKeyStore</code>) are passed as environment variables, therefore, the <code>server.xml</code> contains the <code>${variable}</code> part.<br>
However, it does work for the <code>fhirKeyStore</code> containing my local SSL certificate, but not for the <code>fhirTrustStore</code>.<br>
 The Error is <code>keytool error: java.io.FileNotFoundException: resources/security/fhirTrustStore.p12 (Permission denied)</code> (when trying to import Keycloaks realm- &amp; instance-certificate)<br>
Direct access to the keystore (via <code>docker exec -it CONTAINER /bin/bash</code> &amp; <code>keytool --list -v -keystore fhirTrustStore.p12</code>) works with the same password.<br>
When accessing the running FHIR-Server, the JWT-Tokens can't be validated as the Token-Signer can't be found within the <code>fhirTrustStore.p12</code></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
