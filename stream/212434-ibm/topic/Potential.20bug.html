---
layout: page
title: "FHIR Chat  · Potential bug · ibm"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/index.html">ibm</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html">Potential bug</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="180052810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180052810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180052810">(Nov 06 2019 at 16:57)</a>:</h4>
<p>Changing to "strict" mode by default has highlighted how bad our e2e search tests are.  Most of them are just checking for &gt;=1 result, so the fact we were returning all the results for unexpected issues was masking some problems.</p>



<a name="180052883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180052883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180052883">(Nov 06 2019 at 16:58)</a>:</h4>
<p>I think our JDBC search tests are pretty good, so I'm not sure how important it is to improve all these e2e tests</p>



<a name="180052928"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180052928" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180052928">(Nov 06 2019 at 16:58)</a>:</h4>
<p>but there is a related issue i'm looking at right now which I believe is either a bug in our fhirpath engine or in the spec-defined search criteria</p>



<a name="180052991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180052991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180052991">(Nov 06 2019 at 16:59)</a>:</h4>
<p>the search parameter in question is <code>Observation-value-quantity</code> and the expression is <code>(Observation.component.value as Quantity) | (Observation.component.value as SampledData)</code></p>



<a name="180053049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180053049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180053049">(Nov 06 2019 at 16:59)</a>:</h4>
<p>i would expect that to extract the values from the following sample Observation (Observation1.json):</p>
<div class="codehilite"><pre><span></span>{
        &quot;resourceType&quot; : &quot;Observation&quot;,
        &quot;status&quot; : &quot;final&quot;,
        &quot;category&quot; : [{
            &quot;coding&quot; : [ {
                &quot;system&quot; : &quot;http://terminology.hl7.org/CodeSystem/observation-category&quot;,
                &quot;code&quot; : &quot;vital-signs&quot;,
                &quot;display&quot; : &quot;Vital Signs&quot;
            } ]
        }],
        &quot;code&quot; : {
            &quot;coding&quot; : [ {
                &quot;system&quot; : &quot;http://loinc.org&quot;,
                &quot;code&quot; : &quot;55284-4&quot;,
                &quot;display&quot; : &quot;Blood pressure systolic and diastolic&quot;
            } ]
        },
        &quot;component&quot; : [ {
            &quot;code&quot; : {
                &quot;coding&quot; : [ {
                    &quot;system&quot; : &quot;http://loinc.org&quot;,
                    &quot;code&quot; : &quot;8459-0&quot;,
                    &quot;display&quot; : &quot;Systolic blood pressure--sitting&quot;
                } ]
            },
            &quot;valueQuantity&quot; : {
                &quot;value&quot; : 125.0,
                &quot;unit&quot; : &quot;mmHg&quot;
            }
        }, {
            &quot;code&quot; : {
                &quot;coding&quot; : [ {
                    &quot;system&quot; : &quot;http://loinc.org&quot;,
                    &quot;code&quot; : &quot;8453-3&quot;,
                    &quot;display&quot; : &quot;BP dias--sitting&quot;
                } ]
            },
            &quot;valueQuantity&quot; : {
                &quot;value&quot; : 80.0,
                &quot;unit&quot; : &quot;mmHg&quot;
            }
        } ]
}
</pre></div>



<a name="180053058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180053058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180053058">(Nov 06 2019 at 17:00)</a>:</h4>
<p>but its not</p>



<a name="180053387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180053387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180053387">(Nov 06 2019 at 17:02)</a>:</h4>
<p><span class="user-mention" data-user-id="192334">@John Timm</span> does the fhirpath look right to you?  component is an array, but FHIRPath handles that automatically, right?</p>



<a name="180055290"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180055290" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180055290">(Nov 06 2019 at 17:20)</a>:</h4>
<p>OK, I think I figured this one out.  Its failing to select these because of the <code>isSingleton(nodes)</code> check in FHIRPathEvaluator.visitTypeExpression<br>
<a href="/user_uploads/10155/zrGCC-B9dAss7kdxcsv9fdGm/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/zrGCC-B9dAss7kdxcsv9fdGm/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/zrGCC-B9dAss7kdxcsv9fdGm/pasted_image.png"></a></div>



<a name="180056993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180056993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180056993">(Nov 06 2019 at 17:37)</a>:</h4>
<p>is it possible just to have that method call the <code>is</code> and <code>as</code> methods instead of duplicating the logic?</p>



<a name="180058193"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180058193" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180058193">(Nov 06 2019 at 17:49)</a>:</h4>
<p>Although I think the FHIRPath spec says "as" should have a single left-hand operand, I'm gonna treat this one like a bug on our side (since the <code>X as Y</code> pattern is so common in search expressions)</p>



<a name="180059505"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180059505" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180059505">(Nov 06 2019 at 18:02)</a>:</h4>
<p>opened <a href="https://github.com/IBM/FHIR/issues/370" target="_blank" title="https://github.com/IBM/FHIR/issues/370">https://github.com/IBM/FHIR/issues/370</a></p>



<a name="180059752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180059752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180059752">(Nov 06 2019 at 18:04)</a>:</h4>
<p>Per the FHIRPath Specification (Section 6.3):<br>
<a href="http://hl7.org/fhirpath/2018Sep/index.html#types" target="_blank" title="http://hl7.org/fhirpath/2018Sep/index.html#types">http://hl7.org/fhirpath/2018Sep/index.html#types</a><br>
"If the input collections contains more than one item, the evaluator will throw an error. In all other cases this function returns the empty collection."</p>



<a name="180059897"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180059897" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180059897">(Nov 06 2019 at 18:06)</a>:</h4>
<p>yes, i included that in the "additional context" on the bug report</p>



<a name="180066755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180066755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180066755">(Nov 06 2019 at 19:12)</a>:</h4>
<p>included the "fix" in <a href="https://github.com/IBM/FHIR/pull/369" target="_blank" title="https://github.com/IBM/FHIR/pull/369">https://github.com/IBM/FHIR/pull/369</a></p>



<a name="180076138"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180076138" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180076138">(Nov 06 2019 at 21:03)</a>:</h4>
<p><span class="user-mention" data-user-id="192334">@John Timm</span> interesting build error after making that change to ensure <code>is</code> always operates on a singleton:</p>
<div class="codehilite"><pre><span></span>[ERROR] Tests run: 13, Failures: 4, Errors: 0, Skipped: 0, Time elapsed: 9.016 s &lt;&lt;&lt; FAILURE! - in TestSuite
[ERROR] testInvalidBundleContainedInDomainResource(com.ibm.fhir.validation.test.BundleValidationTest)  Time elapsed: 0.057 s  &lt;&lt;&lt; FAILURE!
java.lang.Error: An error occurred while validating constraint: bdl-11 with location: (base) and expression: type = &#39;document&#39; implies entry.first().resource.is(Composition) at path: Bundle
    at com.ibm.fhir.validation.test.BundleValidationTest.testInvalidBundleContainedInDomainResource(BundleValidationTest.java:237)
Caused by: com.ibm.fhir.model.path.exception.FHIRPathException: java.lang.IllegalArgumentException: Input collection has 0 items, but only 1 is allowed
    at com.ibm.fhir.validation.test.BundleValidationTest.testInvalidBundleContainedInDomainResource(BundleValidationTest.java:237)
Caused by: java.lang.IllegalArgumentException: Input collection has 0 items, but only 1 is allowed
    at com.ibm.fhir.validation.test.BundleValidationTest.testInvalidBundleContainedInDomainResource(BundleValidationTest.java:237)
</pre></div>



<a name="180076224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180076224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180076224">(Nov 06 2019 at 21:04)</a>:</h4>
<p>i guess we should just return empty() if the input collection is empty()?</p>



<a name="180076233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180076233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180076233">(Nov 06 2019 at 21:04)</a>:</h4>
<p>instead of throwing</p>



<a name="180077050"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077050" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077050">(Nov 06 2019 at 21:14)</a>:</h4>
<p>Agreed with the empty() for empty() comment</p>



<a name="180077069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077069">(Nov 06 2019 at 21:14)</a>:</h4>
<p>i don't think fhirpath spec even covers that</p>



<a name="180077109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077109">(Nov 06 2019 at 21:15)</a>:</h4>
<blockquote>
<p>If there is more than one item in the input collection, the evaluator will throw an error.</p>
</blockquote>



<a name="180077131"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077131" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077131">(Nov 06 2019 at 21:15)</a>:</h4>
<p>so i guess it should fall through to the next comment:</p>
<blockquote>
<p>Otherwise, this operator returns the empty collection.</p>
</blockquote>



<a name="180077160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077160">(Nov 06 2019 at 21:16)</a>:</h4>
<p>but its weird to think that a left-hand operator can be empty collection</p>



<a name="180077314"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077314" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077314">(Nov 06 2019 at 21:17)</a>:</h4>
<p>If it's not required, then it could be not present / empty. Not all expressions have the element.exists() implies guard.</p>



<a name="180077399"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077399" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077399">(Nov 06 2019 at 21:18)</a>:</h4>
<p>proposed fix:<br>
<a href="/user_uploads/10155/lQv2nsy3JMO9-k-M-IAvFRtv/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/lQv2nsy3JMO9-k-M-IAvFRtv/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/lQv2nsy3JMO9-k-M-IAvFRtv/pasted_image.png"></a></div>



<a name="180077411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077411">(Nov 06 2019 at 21:18)</a>:</h4>
<p>so we'd exit early for both as and is</p>



<a name="180077462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077462">(Nov 06 2019 at 21:19)</a>:</h4>
<p>I'm hoping this takes care of the build failures</p>



<a name="180077849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077849">(Nov 06 2019 at 21:23)</a>:</h4>
<p>actually, this messes up the indentLevel</p>



<a name="180077866"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077866" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077866">(Nov 06 2019 at 21:23)</a>:</h4>
<p>i assume thats just used for debug purposes?</p>



<a name="180077923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077923">(Nov 06 2019 at 21:24)</a>:</h4>
<p>Please make sure to do a indentLevel-- before your early exit.</p>



<a name="180077948"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180077948" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180077948">(Nov 06 2019 at 21:24)</a>:</h4>
<p>Or alter the code to maintain a single exit.</p>



<a name="180078204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180078204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180078204">(Nov 06 2019 at 21:27)</a>:</h4>
<p>will do</p>



<a name="180078228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180078228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180078228">(Nov 06 2019 at 21:27)</a>:</h4>
<p>but now i'm having second-thoughts on returning empty list of <code>is</code></p>



<a name="180078229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180078229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180078229">(Nov 06 2019 at 21:27)</a>:</h4>
<p>for <code>as</code> it seems right</p>



<a name="180078244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180078244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180078244">(Nov 06 2019 at 21:27)</a>:</h4>
<p>but maybe <code>is</code> should return <code>SINGLETON_FALSE</code> ?</p>



<a name="180078296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180078296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180078296">(Nov 06 2019 at 21:28)</a>:</h4>
<p>thats what seems to match the prior behavior</p>



<a name="180078362"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180078362" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180078362">(Nov 06 2019 at 21:28)</a>:</h4>
<p>There are other examples of functions that return empty if the input is empty. I think we should follow that. returning false implies something was actually checked. an empty input doesn't have anything that can be checked. i think returning <br>
empty makes more sense.</p>



<a name="180078501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180078501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180078501">(Nov 06 2019 at 21:30)</a>:</h4>
<p>ok, thanks for the confirm.  trying it out now</p>



<a name="180079001"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180079001" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180079001">(Nov 06 2019 at 21:36)</a>:</h4>
<p>on the indent thing, does the indent level matter when we visit the expression?  assuming yes, I just popped a indentLevel--; in before the early exit return</p>



<a name="180079035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180079035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180079035">(Nov 06 2019 at 21:36)</a>:</h4>
<p>if indentLevel didn't matter for the visit, i would have just moved the early exit block above the indentLevel++</p>



<a name="180079149"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180079149" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180079149">(Nov 06 2019 at 21:38)</a>:</h4>
<p><a href="https://github.com/IBM/FHIR/pull/369" target="_blank" title="https://github.com/IBM/FHIR/pull/369">https://github.com/IBM/FHIR/pull/369</a> is updated</p>



<a name="180080402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180080402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180080402">(Nov 06 2019 at 21:52)</a>:</h4>
<p>we call visit a couple of times after the indentLevel++ statement so I think the best solution is to put indentLevel-- right before return empty()</p>



<a name="180080873"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Potential%20bug/near/180080873" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Potential.20bug.html#180080873">(Nov 06 2019 at 21:58)</a>:</h4>
<p>ok, cool, thats what i did</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
