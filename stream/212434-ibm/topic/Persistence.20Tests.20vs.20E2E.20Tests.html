---
layout: page
title: "FHIR Chat  · Persistence Tests vs E2E Tests · ibm"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/index.html">ibm</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html">Persistence Tests vs E2E Tests</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="179474961"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179474961" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179474961">(Oct 30 2019 at 20:43)</a>:</h4>
<p>one interesting thing about our layered implementation is we end up with extremely similar tests at multiple levels:</p>
<ul>
<li>fhir-model (unit)</li>
<li>fhir-persistence (functional?)</li>
<li>fhir-server-test (e2e / integration)</li>
</ul>



<a name="179475001"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475001" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475001">(Oct 30 2019 at 20:43)</a>:</h4>
<p>I was just reviewing <a href="https://github.com/IBM/FHIR/pull/341" target="_blank" title="https://github.com/IBM/FHIR/pull/341">https://github.com/IBM/FHIR/pull/341</a> and this came to my mind once again</p>



<a name="179475033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475033">(Oct 30 2019 at 20:44)</a>:</h4>
<p>whats our perspective on the right place for these tests?</p>



<a name="179475087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475087">(Oct 30 2019 at 20:44)</a>:</h4>
<p>should we test everything we can at each layer?</p>



<a name="179475129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475129">(Oct 30 2019 at 20:44)</a>:</h4>
<p>should we be more exhaustive in the unit tests and less exhaustive in the e2e tests</p>



<a name="179475142"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475142" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475142">(Oct 30 2019 at 20:44)</a>:</h4>
<p>should we just favor the e2e ones and do less unit testing?</p>



<a name="179475189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475189">(Oct 30 2019 at 20:45)</a>:</h4>
<p>for this particular issue, i was expecting to see some tests added in fhir-persistence</p>



<a name="179475214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475214">(Oct 30 2019 at 20:45)</a>:</h4>
<p>but perhaps i'm just biased because thats where i've spent a lot of time recently?</p>



<a name="179475352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475352">(Oct 30 2019 at 20:47)</a>:</h4>
<p>I think it's probably a case by case thing. I would expect that changes to PL yields, at the very least, additional unit tests. Ideally, there would also be an integration test if we think that the REST layer might be impacted by a change (for example, the paging context work we did yesterday).</p>



<a name="179475379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475379">(Oct 30 2019 at 20:47)</a>:</h4>
<p>integration tests are needed when we cross component boundaries</p>



<a name="179475433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475433">(Oct 30 2019 at 20:48)</a>:</h4>
<p>if the change is isolated, then i think integration tests are a nice to have but not necessarily a requirement</p>



<a name="179475483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475483">(Oct 30 2019 at 20:48)</a>:</h4>
<p>IMO, most of the "exhaustive" testing should be done in the units (if possible)</p>



<a name="179475530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475530">(Oct 30 2019 at 20:49)</a>:</h4>
<p>what i've sort of been thinking (for changes effecting the persistence layer at least) is to have through/exhaustive unit tests</p>



<a name="179475542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475542">(Oct 30 2019 at 20:49)</a>:</h4>
<p>shooting for good code coverage</p>



<a name="179475578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475578">(Oct 30 2019 at 20:49)</a>:</h4>
<p>and then a smattered of end-to-end / integration tests to show things are working as expected in the cases we care most about</p>



<a name="179475666"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475666" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475666">(Oct 30 2019 at 20:50)</a>:</h4>
<p>but sometimes i waver on that and think "what really matters is the e2e behavior of the system, so maybe thats where we should be exhaustive"</p>



<a name="179475693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475693">(Oct 30 2019 at 20:50)</a>:</h4>
<p>i go back and forth depending on the weather...</p>



<a name="179475773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475773">(Oct 30 2019 at 20:51)</a>:</h4>
<p>just due  to the nature of e2e tests and the setup and time required to run, etc. it's more difficult and not always practical to build something that is exhaustive</p>



<a name="179475775"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475775" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475775">(Oct 30 2019 at 20:51)</a>:</h4>
<p>also, our fhir-persistence tests aren't REALLY unit tests</p>



<a name="179475790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475790">(Oct 30 2019 at 20:51)</a>:</h4>
<p>i think they're much closer to functional tests</p>



<a name="179475800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475800">(Oct 30 2019 at 20:52)</a>:</h4>
<p>or, if they are unit tests, the unit under test is quite large</p>



<a name="179475847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475847">(Oct 30 2019 at 20:52)</a>:</h4>
<p>whereas with units it is easier to be more exhaustive</p>



<a name="179475885"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475885" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475885">(Oct 30 2019 at 20:52)</a>:</h4>
<p>I don't think the PL tests are technically unit tests. in DSTU2 we called them "lightweight integration tests"</p>



<a name="179475898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475898">(Oct 30 2019 at 20:52)</a>:</h4>
<p>yeah, that sounds about right</p>



<a name="179475902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475902">(Oct 30 2019 at 20:52)</a>:</h4>
<p>they aren't e2e but they do require "integration" with a database backend</p>



<a name="179475906"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475906" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475906">(Oct 30 2019 at 20:52)</a>:</h4>
<p>so is that the spot to be exhaustive?</p>



<a name="179475929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475929">(Oct 30 2019 at 20:53)</a>:</h4>
<p>for PL stuff, I think it's the best option</p>



<a name="179475949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179475949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Timm <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179475949">(Oct 30 2019 at 20:53)</a>:</h4>
<p>hard to test the PL stuff without at least Derby at your disposal</p>



<a name="179476074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Persistence%20Tests%20vs%20E2E%20Tests/near/179476074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Persistence.20Tests.20vs.20E2E.20Tests.html#179476074">(Oct 30 2019 at 20:54)</a>:</h4>
<p>ok, thanks for the discussion.  it makes me feel more confident to ask albert to add PL tests for testing this "duplicate search results" case</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
