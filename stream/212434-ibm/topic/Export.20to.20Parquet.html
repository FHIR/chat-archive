---
layout: page
title: "FHIR Chat  · Export to Parquet · ibm"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/index.html">ibm</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Export.20to.20Parquet.html">Export to Parquet</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="205528794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Export%20to%20Parquet/near/205528794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Export.20to.20Parquet.html#205528794">(Jul 30 2020 at 20:30)</a>:</h4>
<p>I finally took a swag at packaging up the prototype code from <span class="user-mention" data-user-id="197632">@Gidon Gershinsky</span> and <span class="user-mention" data-user-id="251796">@Eliot Salant</span> for use from the FHIR Server:  <a href="https://github.com/IBM/FHIR/pull/1374/files">https://github.com/IBM/FHIR/pull/1374/files</a></p>



<a name="205528845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Export%20to%20Parquet/near/205528845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Export.20to.20Parquet.html#205528845">(Jul 30 2020 at 20:31)</a>:</h4>
<p>I just finished reviewing it with the team and we think this will work (though should be considered experimental at present).</p>



<a name="205528989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Export%20to%20Parquet/near/205528989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Export.20to.20Parquet.html#205528989">(Jul 30 2020 at 20:32)</a>:</h4>
<p>Unfortunately, this new power comes at a pretty heavy cost...by using Apache Spark to do the heavy lifting of the JSON -&gt; Parquet writing, we introduce over 200MB of new dependencies to our already considerable size.</p>



<a name="205529193"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Export%20to%20Parquet/near/205529193" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Export.20to.20Parquet.html#205529193">(Jul 30 2020 at 20:34)</a>:</h4>
<p>It pushes the fhir-bulkimportexport-webapp over the size limit enforced by bintray, so we wouldn't even be able to publish it there.<br>
So we explored an option of pushing that spark stuff into the install; that would allow us to continue posting the webapp to bintray, but we'd still pay to cost in terms of the size (and complexity) of our installer zip and docker image.</p>
<p>So with these considerations in mind we're thinking to do this:</p>
<p><em>Short term</em>:  mark these new dependencies as "provided" and introduce a config property called "enableParquet" which is false by default.  then document that to turn it on, you need to add all the spark dependencies.  when its false, reject requests for bulk export to parquet.</p>
<p><em>Long term</em>:  split fhir-bulkimportexport-webapp into a separate project with its own docker image.  this way, the ibm-fhir-server can stay its current size (or get a bit smaller), and we can put all the new heft into the new image and call that <code>ibmcom/ibm-fhir-job-server</code> or some such</p>



<a name="205529219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Export%20to%20Parquet/near/205529219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Export.20to.20Parquet.html#205529219">(Jul 30 2020 at 20:34)</a>:</h4>
<p>Your feedback welcome on this plan...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
