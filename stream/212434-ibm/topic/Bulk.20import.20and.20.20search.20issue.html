---
layout: page
title: "FHIR Chat  · Bulk import and  search issue · ibm"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/index.html">ibm</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html">Bulk import and  search issue</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="223685205"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223685205" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Teva Riou <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223685205">(Jan 22 2021 at 19:12)</a>:</h4>
<p>Hello! I noticed that when  I import a resource  via bulk import, I am unable to perform a search on this resource using search parameters. If I create this exact same resource via a simple http request, it works without issue. Is there a supplementary step I need to do in order to make it work ?</p>



<a name="223685472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223685472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223685472">(Jan 22 2021 at 19:14)</a>:</h4>
<p>no, resources should be indexed properly when imported via bulk import.  if you're confident in what your seeing, maybe you can open a bug for it (with info like what resource types and which queries)?</p>



<a name="223700555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223700555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Teva Riou <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223700555">(Jan 22 2021 at 21:09)</a>:</h4>
<p>It's weird. For instance, take a resource Patient. I can find my resource with birthday or name but not with gender or a reference. I've opened an issue.</p>



<a name="223701809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223701809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223701809">(Jan 22 2021 at 21:19)</a>:</h4>
<p>Thank you for the report Teva, we'll have a look</p>



<a name="223701989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223701989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223701989">(Jan 22 2021 at 21:21)</a>:</h4>
<p>I'm pretty sure it's a token problem - it might be the original url that is failing</p>



<a name="223702020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223702020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223702020">(Jan 22 2021 at 21:21)</a>:</h4>
<p>thanks for the issue/bug</p>



<a name="223704648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223704648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223704648">(Jan 22 2021 at 21:42)</a>:</h4>
<p>&lt;property name="incomingUrl" value=""/&gt; &lt;--</p>



<a name="223704652"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223704652" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223704652">(Jan 22 2021 at 21:42)</a>:</h4>
<p>that's the problem</p>



<a name="223704659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223704659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223704659">(Jan 22 2021 at 21:42)</a>:</h4>
<p>small fix coming</p>



<a name="223705519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/223705519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Bastide <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#223705519">(Jan 22 2021 at 21:48)</a>:</h4>
<p>I oversold the fix. still digging in...</p>



<a name="225638077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/225638077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#225638077">(Feb 09 2021 at 02:21)</a>:</h4>
<p>We believe that we've addressed this issue with the 4.5.5 release that we just tagged.  Please let us know if you're able to confirm the fix on your end.</p>



<a name="273690275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/273690275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh Dabi <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#273690275">(Mar 01 2022 at 18:44)</a>:</h4>
<p><a href="/user_uploads/10155/sCgWPDNRBto-OzVyyfis3S1v/Test.ndjson">Test.ndjson</a> </p>
<p>Hi Trying to import this file, it is giving some errors. Medicationstatement is giving error. Even though I deleted those tow manually it is successful but can't see data in DB. Here we are trying to import all resources from single bundle.</p>
<p>Mahesh</p>



<a name="273690300"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/273690300" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh Dabi <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#273690300">(Mar 01 2022 at 18:44)</a>:</h4>
<p>BTW we are using 4.10.1</p>



<a name="274647291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/274647291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh Dabi <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#274647291">(Mar 09 2022 at 06:09)</a>:</h4>
<p>Can anybody please help?</p>
<p>Mahesh</p>



<a name="274679348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/274679348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#274679348">(Mar 09 2022 at 12:22)</a>:</h4>
<p>Hi Mahesh, I'm afraid its not so clear how to help you.  Are there any errors in the logs (either the server logs or the job logs from the import)?</p>



<a name="274679542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/274679542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#274679542">(Mar 09 2022 at 12:24)</a>:</h4>
<p>In general, we've been pointing folks at the batch/transaction endpoint for ingestion lately because our import is single-threaded and so its not really any faster.  We have some utilities in our <code>fhir-bucket</code> project for converting NDJSON to bundles and uploading those in parallel, but no great docs on that yet.</p>



<a name="274679771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/274679771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#274679771">(Mar 09 2022 at 12:26)</a>:</h4>
<p>net:  bulk import is definitely an interesting feature, but the current implementation (that was originally done for a connectathon a while back) has proved problematic...we're patching some of those issues for our next release but we probably need to rethink the whole feature in the coming months</p>



<a name="275091249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275091249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh Dabi <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275091249">(Mar 12 2022 at 11:12)</a>:</h4>
<p>Hi Lee</p>
<p>Here is log and ndjson file which we are trying to import along with job <a href="/user_uploads/10155/r5F852qVMCux0A4Po6iBwzVa/test.zip">test.zip</a> log. Log shows that import is successful but somehow I am unable to see any patient created. We are trying to import bundle with one patient summary containing all resources for that patient. Not sure whether it is supported or not. Individual resource import e.g. Allergies.ndjson, patient.ndjson works fine. So not sure whether it can import all resources of single patient in one go. <a href="/user_uploads/10155/iUAUOVzZ01LpHBfmB36bwZeE/test.zip">test.zip</a></p>
<p>Here is the import request, please see the type</p>
<p>{<br>
    "resourceType": "Parameters",<br>
    "id": "30321130-5032-49fb-be54-9b8b82b2445a",<br>
    "parameter": [<br>
        {<br>
            "name": "inputSource",<br>
            "valueUri": "<a href="https://44.197.187.245:9443/fhir-server">https://44.197.187.245:9443/fhir-server</a>"<br>
        },<br>
        {<br>
            "name": "inputFormat",<br>
            "valueString": "application/fhir+ndjson"<br>
        },<br>
        {<br>
            "name": "input",<br>
            "part": [<br>
                {<br>
                    "name": "type",<br>
<strong>"valueString": "Package"</strong><br>
                },<br>
                {<br>
                    "name": "url",<br>
                    "valueUrl": "test.ndjson"<br>
                }<br>
            ]<br>
        },<br>
        {<br>
            "name": "storageDetail",<br>
            "valueString": "file"<br>
        }<br>
    ]<br>
}</p>



<a name="275091326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275091326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh Dabi <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275091326">(Mar 12 2022 at 11:14)</a>:</h4>
<p>I am not sure the resource type I am mentioning in request is correct or not.</p>
<p>"part": [<br>
{<br>
"name": "type",<br>
<strong><em>"valueString": "Package"</em></strong><br>
},</p>



<a name="275188661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275188661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh Dabi <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275188661">(Mar 14 2022 at 02:39)</a>:</h4>
<p>In short I have data available in CCDA (visit note fomats) , what will be best way to import to IBM FHIR Server. I am converting CCDA to FHIR package and trying to import.</p>



<a name="275194510"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275194510" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahesh Dabi <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275194510">(Mar 14 2022 at 05:04)</a>:</h4>
<p>BTW if you look at my NDJSON file it is a package and that is imported as pachange. If I see <br>
<a href="https://baseurl:9443/fhir-server/api/v4/Bundle">https://baseurl:9443/fhir-server/api/v4/Bundle</a> I can get the whole bundle. So I think it imports and stores this as bundle but not as separate resources by splitting them. Is there any way to split them while import? Do I need to import as anything else other than Package or Bundle?</p>



<a name="275222323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275222323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275222323">(Mar 14 2022 at 11:20)</a>:</h4>
<p>thanks, Mahesh, that makes sense.</p>
<blockquote>
<p>Is there any way to split them while import? </p>
</blockquote>
<p>No, not with the current implementation at least</p>
<blockquote>
<p>Do I need to import as anything else other than Package or Bundle?</p>
</blockquote>
<p>Import is performed on an NDJSON file that contains the type of resource you're trying to import.<br>
In the next release, we will more strictly enforce that the NDJSON contains only a single type and that this type matches what was passed on the call to invoke import:  <a href="https://github.com/IBM/FHIR/issues/3180">https://github.com/IBM/FHIR/issues/3180</a></p>



<a name="275222852"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275222852" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275222852">(Mar 14 2022 at 11:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="392119">Mahesh Dabi</span> <a href="#narrow/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue/near/275091326">said</a>:</p>
<blockquote>
<p>I am not sure the resource type I am mentioning in request is correct or not.</p>
<p>"part": [<br>
{<br>
"name": "type",<br>
<strong><em>"valueString": "Package"</em></strong><br>
},</p>
</blockquote>
<p>No, that doesn't make sense to me.  The "type" should be a resource type.  In <code>main</code> (and our next release) I think we'd reject this request as invalid because Package is not a valid resource type.</p>



<a name="275223033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275223033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275223033">(Mar 14 2022 at 11:29)</a>:</h4>
<p>You have a few options, but I think it might be easiest for you to convert your Bundle resources into 'transaction' bundles and post those to the base url (fhir-server/api/v4).  That will have your desired behavior of splitting the bundle into its individual components, storing them individually, and making those searchable.</p>



<a name="275223345"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/212434-ibm/topic/Bulk%20import%20and%20%20search%20issue/near/275223345" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/212434-ibm/topic/Bulk.20import.20and.20.20search.20issue.html#275223345">(Mar 14 2022 at 11:32)</a>:</h4>
<p>The downside of this is if you are actually trying to find the CCDA as a whole, it can be tricky to put them back together.  We have a fledgling implementation of the <a href="https://www.hl7.org/fhir/composition-operation-document.html">$document</a> operation for doing just that, but be mindful that this is a bit experimental.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
