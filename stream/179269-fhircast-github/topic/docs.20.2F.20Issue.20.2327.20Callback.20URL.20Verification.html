---
layout: page
title: "FHIR Chat  · docs / Issue #27 Callback URL Verification · fhircast-github"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/index.html">fhircast-github</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html">docs / Issue #27 Callback URL Verification</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153959478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179269-fhircast-github/topic/docs%20/%20Issue%20%2327%20Callback%20URL%20Verification/near/153959478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications (FHIRcast) <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html#153959478">(May 13 2018 at 09:06)</a>:</h4>
<p>RazStorm opened <a href="https://github.com/fhircast/docs/issues/27" target="_blank" title="https://github.com/fhircast/docs/issues/27">Issue #27</a></p>
<blockquote>
<p>This issue concerns the initial FHIRCast subscription to a topic. </p>
<p>If an App is subscribing to the Hub, it transmits a callback-url (see <a href="http://fhircast.org/#synchronize" target="_blank" title="http://fhircast.org/#synchronize">http://fhircast.org/#synchronize</a>). The App (Subscriber) itself is OAuth verified, and the general use-case can assume that the callback-url is for that App (Subscriber). However as the callback-url can be anything, one could potentially use the subscription as a form of broker where an App (Broker) subscribes a different App (Event Consumer) to the Hub. </p>
<p>The problem that arises here, is that the EventReceiver can be "anything", including an Application that has not been verified with OAuth. That could lead to the problem that sensitive data is transmitted to an unautorized App (Event Consumer).</p>
<p>Since the Hub already verifies the callback-url in the sense of "do you really want to subscribe to this, and can you solve my challenge -&gt; proving that you implemented the subscription model", one possible option is that the callback responds with an OAuth-Token verifying it in the security context, and ensuring that data being sent to it, is something it is allowed to see.</p>
<p>This would also enable a broker pattern where one App (Broker) is responsible for matchmaking between the Hub (Event Producer) and several Subscribers (Event Consumer), while still managing verification of access though the Hub.</p>
</blockquote>



<a name="153960227"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179269-fhircast-github/topic/docs%20/%20Issue%20%2327%20Callback%20URL%20Verification/near/153960227" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications (FHIRcast) <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html#153960227">(May 14 2018 at 10:56)</a>:</h4>
<p>isaacvetter <a href="https://github.com/fhircast/docs/issues/27#issuecomment-388777641" target="_blank" title="https://github.com/fhircast/docs/issues/27#issuecomment-388777641">commented</a> on <a href="https://github.com/fhircast/docs/issues/27" target="_blank" title="https://github.com/fhircast/docs/issues/27">Issue #27</a></p>
<blockquote>
<p>Hey @RazStorm , great analysis!</p>
<blockquote>
<p>This would also enable a broker pattern where one App (Broker) is responsible for matchmaking between the Hub (Event Producer) and several Subscribers (Event Consumer), while still managing verification of access though the Hub.</p>
</blockquote>
<p>In such a broker pattern, it seems like the hub wouldn't actually know anything about the downstream subscribers (event consumers), specifically because the broker&lt;-&gt; subscriber/consumer relationship is negotiated outside the Hub&lt;-&gt; broker relationship. Further, the Hub-granted, OAuth2 access_token is owned by the broker and traceable to it's client_id. Sharing this access_token with the subscribers/consumers would also grant those subscribers/consumers access to the Hub's FHIR server with the broker's scopes. For these reasons, I don't think that it makes sense for the Hub to require that the broker share it's access_token with the subscribers/consumers. </p>
<p>I'd like to turn this issue around on you - Given that the app (subscriber not in a broker relationship), is already authenticating to the Hub when creating the subscription, why don't we remove the url verification step completely? </p>
<p>This url verification is <a href="https://www.w3.org/TR/websub/#hub-verifies-intent" target="_blank" title="https://www.w3.org/TR/websub/#hub-verifies-intent">required in WebSub</a>; in part, I think, because, the initial subscription transaction isn't authenticated. So, not requiring it would be a break from WebSub.</p>
</blockquote>



<a name="153960291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179269-fhircast-github/topic/docs%20/%20Issue%20%2327%20Callback%20URL%20Verification/near/153960291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications (FHIRcast) <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html#153960291">(May 14 2018 at 12:11)</a>:</h4>
<p>RazStorm <a href="https://github.com/fhircast/docs/issues/27#issuecomment-388795102" target="_blank" title="https://github.com/fhircast/docs/issues/27#issuecomment-388795102">commented</a> on <a href="https://github.com/fhircast/docs/issues/27" target="_blank" title="https://github.com/fhircast/docs/issues/27">Issue #27</a></p>
<blockquote>
<p>Definitely an option. There still remains the risk that the Subscriber and the System specified in the callback are not one and the same. If we make this the responsibility of the Subscriber (i.e. Callback is assumed to have the exact same access rights / is the Subscriber) this is not a problem. -&gt; I.e. verification can be removed.</p>
</blockquote>



<a name="153960331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179269-fhircast-github/topic/docs%20/%20Issue%20%2327%20Callback%20URL%20Verification/near/153960331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications (FHIRcast) <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html#153960331">(May 14 2018 at 12:32)</a>:</h4>
<p>isaacvetter <a href="https://github.com/fhircast/docs/issues/27#issuecomment-388800166" target="_blank" title="https://github.com/fhircast/docs/issues/27#issuecomment-388800166">commented</a> on <a href="https://github.com/fhircast/docs/issues/27" target="_blank" title="https://github.com/fhircast/docs/issues/27">Issue #27</a></p>
<blockquote>
<p>Hey @RazStorm </p>
<blockquote>
<p>There still remains the risk that the Subscriber and the System specified in the callback are not one and the same. </p>
</blockquote>
<p>Definitely. I think this is very likely to be different machines, but even (to your point) to also be entirely different systems. It's an important use-case.</p>
<blockquote>
<p>If we make this the responsibility of the Subscriber <br>
<span class="emoji emoji-1f44d" title="thumbs up">:thumbs_up:</span></p>
<p>(i.e. Callback is assumed to have the exact same access rights / is the Subscriber) <br>
Perhaps more explicitly, callback authorization is the responsibility of the subscriber, not the hub. </p>
</blockquote>
<p>I think that this makes sense to call out in the spec. I just created PR #30 adding this text:</p>
<blockquote>
<blockquote>
<p>Within FHIRcast, the client that creates a subscriptions and the server that hosts the callback url are the same entity. If these roles are split, the Hub assumes that the same authorization and access rights apply to both systems.  </p>
</blockquote>
<p>this is not a problem. -&gt; I.e. verification can be removed.</p>
</blockquote>
<p>This leaves us incompatible with WebSub. Is that a big deal? </p>
</blockquote>



<a name="153960420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179269-fhircast-github/topic/docs%20/%20Issue%20%2327%20Callback%20URL%20Verification/near/153960420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications (FHIRcast) <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html#153960420">(May 14 2018 at 14:01)</a>:</h4>
<p>RazStorm <a href="https://github.com/fhircast/docs/issues/27#issuecomment-388827528" target="_blank" title="https://github.com/fhircast/docs/issues/27#issuecomment-388827528">commented</a> on <a href="https://github.com/fhircast/docs/issues/27" target="_blank" title="https://github.com/fhircast/docs/issues/27">Issue #27</a></p>
<blockquote>
<p>I think #30 solves this according to the discussion :)</p>
<p>Concerning WebSub -&gt; We should ask implementers if they want/need compliance with WebSub</p>
<p>I think that if, so far we are compatible / using the WebSub spec, and this is the ONLY thing where we break with WebSub, then verification should be kept. From an implementer perspective it takes maybe about an hour to implement the verification on client and server side. However in that case the text in index.md </p>
<blockquote>
<p>Modeled after the common webhook design pattern and specifically the W3C WebSub RFC</p>
</blockquote>
<p>should read</p>
<blockquote>
<p>Modeled after the common webhook design pattern and is specifically <strong>compliant with</strong> the W3C WebSub RFC</p>
</blockquote>
<p>To me, at least it looked like FHIRCast is modelled after the WebSub, but was not aware it is compatible.</p>
</blockquote>



<a name="153960738"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179269-fhircast-github/topic/docs%20/%20Issue%20%2327%20Callback%20URL%20Verification/near/153960738" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications (FHIRcast) <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html#153960738">(May 14 2018 at 21:44)</a>:</h4>
<p>jkiddo <a href="https://github.com/fhircast/docs/issues/27#issuecomment-388972899" target="_blank" title="https://github.com/fhircast/docs/issues/27#issuecomment-388972899">commented</a> on <a href="https://github.com/fhircast/docs/issues/27" target="_blank" title="https://github.com/fhircast/docs/issues/27">Issue #27</a></p>
<blockquote>
<p>Given that you base yourself on an existing WebSub implementation that actually follows the standard, then you've just ruined it if you won't follow the standard. I would encourage you guys to stay compatible with the standard and extend it - not break it - or the conformance to it.</p>
</blockquote>



<a name="154024470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179269-fhircast-github/topic/docs%20/%20Issue%20%2327%20Callback%20URL%20Verification/near/154024470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications (FHIRcast) <a href="https://fhir.github.io/chat-archive/stream/179269-fhircast-github/topic/docs.20.2F.20Issue.20.2327.20Callback.20URL.20Verification.html#154024470">(Dec 11 2018 at 16:36)</a>:</h4>
<p>isaacvetter labeled <a href="https://github.com/fhircast/docs/issues/27" target="_blank" title="https://github.com/fhircast/docs/issues/27">Issue #27</a></p>
<blockquote>
<p>This issue concerns the initial FHIRCast subscription to a topic. </p>
<p>If an App is subscribing to the Hub, it transmits a callback-url (see <a href="http://fhircast.org/#synchronize" target="_blank" title="http://fhircast.org/#synchronize">http://fhircast.org/#synchronize</a>). The App (Subscriber) itself is OAuth verified, and the general use-case can assume that the callback-url is for that App (Subscriber). However as the callback-url can be anything, one could potentially use the subscription as a form of broker where an App (Broker) subscribes a different App (Event Consumer) to the Hub. </p>
<p>The problem that arises here, is that the EventReceiver can be "anything", including an Application that has not been verified with OAuth. That could lead to the problem that sensitive data is transmitted to an unautorized App (Event Consumer).</p>
<p>Since the Hub already verifies the callback-url in the sense of "do you really want to subscribe to this, and can you solve my challenge -&gt; proving that you implemented the subscription model", one possible option is that the callback responds with an OAuth-Token verifying it in the security context, and ensuring that data being sent to it, is something it is allowed to see.</p>
<p>This would also enable a broker pattern where one App (Broker) is responsible for matchmaking between the Hub (Event Producer) and several Subscribers (Event Consumer), while still managing verification of access though the Hub.</p>
</blockquote>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
