---
layout: page
title: "FHIR Chat  · ✔ Versioned Messages · fhir-messages"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/index.html">fhir-messages</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html">✔ Versioned Messages</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="245107182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245107182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eirik Myklebost <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245107182">(Jul 06 2021 at 22:37)</a>:</h4>
<p>I'm working on a project where we receive fhir messages that are validated according to profiles depending on the eventType. These messages are stored in a custom event-store as part of an EventSourcing architecture. The profiles are owned and managed by my team.</p>
<p>I do foresee that the events' structure\profile may change over time and might even have breaking changes. In that scenario we still want to be able to receive messages conforming to old versions of the profiles while our clients transitions to new versions. We also want to handle messages of different versions while replaying events from the event-store.</p>
<p>What is the current best practice to label messages with a version? I've considered the following alternatives:</p>
<ol>
<li>Explicitly specify the profile in Bundle.Meta.Profile, and embed the version in the profile's canonical-url: e.g. <code>some-domain/StructureDefinition/my-message-v2</code>.</li>
<li>Same as 1., but have different business-versions, e.g. <code>some-domain/StructureDefinition/my-message|2.1.0</code>. Will the validator handle this?</li>
<li>Embed the version in the MessageHeader.event Code, e.g. <code>patient-admitted-v2</code>. The correct profile can be selected using slicing.</li>
</ol>
<p>Whichever version we choose I guess each version must have its own fhir package in order to handle breaking changes in transient dependencies?</p>



<a name="245107934"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245107934" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245107934">(Jul 06 2021 at 22:47)</a>:</h4>
<ol>
<li>This will work, but creates maintenance challenges of fixing all of your links</li>
<li>Validator <em>should</em> handle that, though support for multiple versions of a single profile is not widely (at all?) tested</li>
<li>That sounds like it's going to get really ugly really fast</li>
</ol>



<a name="245108976"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245108976" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eirik Myklebost <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245108976">(Jul 06 2021 at 23:00)</a>:</h4>
<p>So you would suggest going for option 1.? Can you think of a better solution that I haven't considered?</p>



<a name="245111791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245111791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245111791">(Jul 06 2021 at 23:41)</a>:</h4>
<p>My preference is option #2, I just can't guarantee how well the tools will work yet.  It's certainly something that <em>should</em> work.</p>



<a name="245145239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245145239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eirik Myklebost <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245145239">(Jul 07 2021 at 08:23)</a>:</h4>
<p>Ok, thanks! That is also be my preference. I will have to look into loading multiple different versions of the same fhir package. If it doesn't work I can use different validator instances and choose depending on the profile.</p>



<a name="245168058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245168058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245168058">(Jul 07 2021 at 11:58)</a>:</h4>
<p>why can't new profiles be defined as the profiling changes? Thus each is tagged with exactly what the sender intended?</p>



<a name="245170971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245170971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eirik Myklebost <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245170971">(Jul 07 2021 at 12:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/179263-fhir-messages/topic/Versioned.20Messages/near/245168058">said</a>:</p>
<blockquote>
<p>why can't new profiles be defined as the profiling changes? Thus each is tagged with exactly what the sender intended?</p>
</blockquote>
<p>I'm not sure I understood the question, but that would effectively be what option 1 is suggesting; creating a new profile for the new version.</p>



<a name="245171084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245171084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245171084">(Jul 07 2021 at 12:28)</a>:</h4>
<p>okay, I was reading that you were adding a version vector to the profile. I was specifically saying that the profile canonical URI would change, not just the version.</p>



<a name="245185757"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/245185757" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#245185757">(Jul 07 2021 at 14:09)</a>:</h4>
<p>If you change the canonical URL of the profile, that breaks all references to the profile.  Standard behavior in an IG is to leave all of the canonical URLs the same and increment the version of everything in the IG.  That's simplest from a maintenance perspective.</p>



<a name="252627717"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179263-fhir-messages/topic/%E2%9C%94%20Versioned%20Messages/near/252627717" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://fhir.github.io/chat-archive/stream/179263-fhir-messages/topic/.E2.9C.94.20Versioned.20Messages.html#252627717">(Sep 09 2021 at 13:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="223185">Eirik Myklebost</span> has marked this topic as resolved.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
