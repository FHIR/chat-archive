---
layout: page
title: "FHIR Chat  · IHE IUA vs SMART-on-FHIR · ihe"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/index.html">ihe</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html">IHE IUA vs SMART-on-FHIR</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="219997093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/219997093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael van der Zel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#219997093">(Dec 15 2020 at 15:46)</a>:</h4>
<p>Is SMART-on-FHIR compatible with IHE IUA or the other way around? In other words are the authentication steps of SMART-on-FHIR compatible with IHE:IUA ITI-72 and IHE:IUA ITI-71? And is their use of JWT the same?</p>



<a name="220003233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220003233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220003233">(Dec 15 2020 at 16:22)</a>:</h4>
<p>There is some discussion on that in the current version of IUA (in public comment): <a href="https://profiles.ihe.net/ITI/IUA/">https://profiles.ihe.net/ITI/IUA/</a><br>
If it is not clear enough, or if you think there are better approaches, please comment on it.</p>



<a name="220004147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220004147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220004147">(Dec 15 2020 at 16:27)</a>:</h4>
<p>Thanks for the link -- I hadn't seen this! Re: JWTs, SMART doesn't make any requirements about access token format (though of course we use JWTs for <code>id_token</code>s, because that's how OpenID Conenct works).</p>



<a name="220091985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220091985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael van der Zel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220091985">(Dec 16 2020 at 09:11)</a>:</h4>
<p>Thanks.<br>
For example I created an SMART-on-FHIR app that runs with oauth etc in the smarthealthit sandbox and in the Epic AppOrchard. What do I need to do to claim that it is conform IHE:IUA? Is there a checklist of some kind?</p>



<a name="220092064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220092064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael van der Zel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220092064">(Dec 16 2020 at 09:12)</a>:</h4>
<p>Ow. Sorry. I see now there is a chapter in the link from Vassil. Thanks!</p>



<a name="220243217"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220243217" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael van der Zel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220243217">(Dec 17 2020 at 13:33)</a>:</h4>
<p>Question. IUA Issue 13 says that SMART-on-FHIR specifies OAuth 2.1, but on <a href="http://www.hl7.org/fhir/smart-app-launch/">http://www.hl7.org/fhir/smart-app-launch/</a> it talks about OAith 2.0?</p>



<a name="220247752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220247752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220247752">(Dec 17 2020 at 14:14)</a>:</h4>
<p>Are some of the IUA authors present here?</p>



<a name="220248077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220248077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220248077">(Dec 17 2020 at 14:17)</a>:</h4>
<p>yes. myself, <span class="user-mention" data-user-id="191478">@Oliver Egger</span> <span class="user-mention" data-user-id="191906">@Massimiliano Masi</span>  -- but you might be best to address your concerns to the github repo, issues.</p>



<a name="220248106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220248106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220248106">(Dec 17 2020 at 14:18)</a>:</h4>
<p><a href="https://github.com/IHE/ITI.IUA">https://github.com/IHE/ITI.IUA</a></p>



<a name="220248183"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220248183" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220248183">(Dec 17 2020 at 14:18)</a>:</h4>
<p>Issue 13 states that IUA directly references OAuth 2.1. Presumably, part of the issue is that SMART references OAuth 2.0</p>



<a name="220248254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220248254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220248254">(Dec 17 2020 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="239813">@Joost Reuzel</span></p>



<a name="220248650"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220248650" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220248650">(Dec 17 2020 at 14:22)</a>:</h4>
<p>and input from <span class="user-mention" data-user-id="191864">@Isaac Vetter</span> <span class="user-mention" data-user-id="195299">@Luis Maas</span> <span class="user-mention" data-user-id="194684">@Gregorio Canal</span> <span class="user-mention" data-user-id="273609">@Martin Rosner</span></p>



<a name="220673720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/220673720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joost Reuzel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#220673720">(Dec 22 2020 at 09:45)</a>:</h4>
<p>Long answer:</p>
<p>Indeed, IUA references OAuth2.1, where SMART (still) references OAuth2.0. However, this was not the biggest concerns around adopting SMART. OAuth2.1 basically is OAuth2.0, but integrated with all best practices like PKCE, the use of code flow over implicit flow, etc. </p>
<p>Summarizing there were three main concerns around SMART, which prevented it to be adopted into IUA from the start:</p>
<ol>
<li>The current SMART specification assumes a tight relation between the authorization server and the resource server, sometimes not even distinguishing the two. For example, does the discovery document belong to the authorization server or resource server?. How would the resource server translate the access token into a set of claims? No mechanism is specified, which implies this is a specific dependency between the two. And how does the authorization server know about the launch contexts? There is no API to announce those in a generic way. </li>
<li>The SMART-scopes are bound to the default FHIR REST operations. In the various IHE profiles other base protocols are (or will be) used as well. Moreover, the SMART-scopes don't include FHIR messaging or support for the operations like the $apply on ActivityDefinition which are used in IHE profiles as well.</li>
<li>The SMART-scopes include an authorization context (user/patient/system). The user or patient identifier is resolvable at the resource server. Again a dependency between resource and authorization server. It would have been easier if the context was separated from the scopes into a separate set of claims (which is already partly so as the patient or user id are separate claims). This would allow the IHE transactions based on FHIR to refer to the resources and operations only. The contextual filters based on patient, system or user context would then be tackled in a generic separate way. For example, IUA includes a way of describing the user in its organizational context, which can be used in authorization decisions by the resource server. Something similar can be added for a patient context.</li>
</ol>
<p>SMART works great for the EMR-launch use-cases, like the Epic AppOrchard. However, we found it somewhat limiting for other use-cases. To extend the applicability of SMART I would recommend the following three:</p>
<ul>
<li>Introduce token introspection endpoint to allow the resource server to obtain the claims associated with the access token. Optionally the access token can be formatted as JWT to optimize the number of network calls. I noticed that work is ongoing on this topic, which is great in my view.</li>
<li>Add an API to register (launch) sessions at an authorization server. This would further decouple resource servers from the authorization servers.</li>
<li>Update the SMART Scopes: Remove the context from the scopes and place that into separate token claims. Add support for FHIR operations and FHIR messaging to the claims. Enhance the context claims (user/patient/system) to include more contextual information like organization identifiers, roles, etc.</li>
</ul>
<p>Having said all this, suggestions on how the bridge the gap between the two specifications are quite welcome!</p>
<p>Hope this helps,<br>
Joost</p>



<a name="221536841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/IHE%20IUA%20vs%20SMART-on-FHIR/near/221536841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/IHE.20IUA.20vs.20SMART-on-FHIR.html#221536841">(Jan 04 2021 at 15:29)</a>:</h4>
<p>Thanks! A couple of these suggestions are things we are adding in SMART v2 -- specifically, place, token introspection, and support for more FHIR interactions in the scope language.</p>
<p>(I'm not sure I follow the suggestion about removing "context" from scopes; SMART key use cases require the ability to differentiate a request for user level versus patient level access. I might be missing something about the suggestion though.)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
