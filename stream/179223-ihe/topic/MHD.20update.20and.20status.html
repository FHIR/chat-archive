---
layout: page
title: "FHIR Chat  · MHD update and status · ihe"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/index.html">ihe</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html">MHD update and status</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="264173520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264173520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264173520">(Dec 08 2021 at 15:41)</a>:</h4>
<p>If I understand it correctly, MHD currently only allows for POST-Interactions on DocumentReference and Binaries. Deletion and Update are our of scope, right?<br>
So an new Document can be provided with a "replaces"-Relation to an existing one, but the status of the existing document could never be changed to "superseded"? Nor could a DocRef be changed to the "entered-in-error"-state.<br>
Wouldn't this imply that all DocumentReference in the MHD scope must be, and always will be "current"?</p>



<a name="264176810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264176810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264176810">(Dec 08 2021 at 16:01)</a>:</h4>
<p>if you have MHD with the <a href="https://profiles.ihe.net/ITI/MHD/1332_actor_options.html#13322-xds-on-fhir-option">XDS on FHIR Option</a> you can have afterwards a DocumentReference in superseded state as per <a href="https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.2.2.3">https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.2.2.3</a>. I don't see this behaviour specified in MHD directly.</p>



<a name="264178032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264178032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264178032">(Dec 08 2021 at 16:09)</a>:</h4>
<p>MHD does support replacing documents, just like XDS did. That is to say these are NOT an "Update" action. They are a "Create" of a new DocumentReference for the new instance of a Binary document; with a .relatesTo that deprecated the previous DocumentReference/Binary.<br>
<a href="https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654123-replace-transform-signs-and-append-associations">https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654123-replace-transform-signs-and-append-associations</a></p>



<a name="264183316"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264183316" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264183316">(Dec 08 2021 at 16:46)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> where is this behaviour stated in <a href="https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654123-replace-transform-signs-and-append-associations">https://profiles.ihe.net/ITI/MHD/ITI-65.html#23654123-replace-transform-signs-and-append-associations</a>? Also from the semantics of the Bundle transaction I would have assumed the same behaviour as <span class="user-mention" data-user-id="191450">@Simone Heckmann</span> described it, a new DocumentReference would be added with a relatesTo link to the other DocumentReference.</p>



<a name="264183543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264183543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264183543">(Dec 08 2021 at 16:47)</a>:</h4>
<p>that is what that section (intends) to say</p>



<a name="264183949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264183949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264183949">(Dec 08 2021 at 16:50)</a>:</h4>
<p>In early versions of MHD we didn't cover this well, because replace was not a high priority use-case. But the current should be covering it. Welcome improvement recommendations.</p>



<a name="264184316"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264184316" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264184316">(Dec 08 2021 at 16:52)</a>:</h4>
<p>MHD is just the interface, so it is just there to convey the intent. There is further explaination of replace in XDS, and also in MHDS</p>



<a name="264184384"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264184384" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264184384">(Dec 08 2021 at 16:53)</a>:</h4>
<p>MHDS work in progress to move to html -- <a href="https://github.com/IHE/ITI.MHDS/blob/master/index.md">https://github.com/IHE/ITI.MHDS/blob/master/index.md</a></p>



<a name="264208680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264208680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264208680">(Dec 08 2021 at 19:38)</a>:</h4>
<p>But if MHD is just the interface and it uses a transaction Bundle then I think it should include the to be updated relateTo DocumentReference or alternatively an operation should be defined. I offer to write a CP.</p>



<a name="264208781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264208781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264208781">(Dec 08 2021 at 19:39)</a>:</h4>
<p>as indicated, I thought the section I pointed to did say that. It just didn't have an example. right?</p>



<a name="264210046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264210046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264210046">(Dec 08 2021 at 19:48)</a>:</h4>
<blockquote>
<p>The Document Recipient shall process the bundle atomically, analogous to both the Provide and Register Document Set-b [ITI-41] transaction and FHIR “transaction” as specified in <a href="http://hl7.org/fhir/R4/http.html#transaction">http://hl7.org/fhir/R4/http.html#transaction</a>.</p>
</blockquote>
<p>You cannot expect to be compliant to [ITI-41] and to the FHIR "transaction" for the replaceTo behaviour. Either the replaceTo behaviour is excluded, the transaction needs to add the updated DocumentReference or an operation is defined.</p>



<a name="264210604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264210604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264210604">(Dec 08 2021 at 19:52)</a>:</h4>
<p>I don't understand why you say that</p>



<a name="264210702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264210702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264210702">(Dec 08 2021 at 19:52)</a>:</h4>
<p>are you meaning in the context of MHDS that there is a problem? There is not really a problem in the case of XDS, as that is already the behaviour of the XDS Provide and Register Document Set</p>



<a name="264211533"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264211533" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264211533">(Dec 08 2021 at 19:58)</a>:</h4>
<p>in the context of MHD without the XDS on FHIR option selected</p>



<a name="264213546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264213546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264213546">(Dec 08 2021 at 20:13)</a>:</h4>
<p>okay, so in MHDS</p>



<a name="264213769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264213769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264213769">(Dec 08 2021 at 20:15)</a>:</h4>
<p>I have had comments to public-comment about moving ITI-65 as an operation. It feels very much like it is an operation more than a transaction. It is what it is because of history, and lack of comments to the contrary. I am happy to have Trial-Implementation improve it.</p>



<a name="264214538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264214538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264214538">(Dec 08 2021 at 20:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span> you can just put in github issues. You don't need to write formal CP.</p>



<a name="264723780"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264723780" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264723780">(Dec 13 2021 at 15:37)</a>:</h4>
<p>added <a href="https://github.com/IHE/ITI.MHD/issues/100">issue 100</a> with a proposition for clarification of the text.</p>



<a name="264844643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264844643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264844643">(Dec 14 2021 at 11:42)</a>:</h4>
<p>I can't really wrap my head around how a Document's status could be changed to "entered in error" using ITI-65. Can it even?</p>



<a name="264853591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264853591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264853591">(Dec 14 2021 at 13:02)</a>:</h4>
<p>not really, there is no functionality called for in the use-cases to do that. Even the case where we have had a need for a Delete, we did that with a replace with an empty document. We don't have a use for the status entered in error.</p>



<a name="264853644"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/264853644" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#264853644">(Dec 14 2021 at 13:02)</a>:</h4>
<p>that is not to say that it couldn't ever be set, just no use-case means for setting it using ITI-65.</p>



<a name="265268991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265268991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265268991">(Dec 17 2021 at 08:58)</a>:</h4>
<p>After giving this some additional thought, I absolutely agree with the idea, that MHD should move to operations instead of transactions. I often tell my customers that the difference between the two is the location of the business logic. With transactions it's on the client side (client decides whether to PUT or POST, what's the appropriate matching criteria for conditional create/update etc). Operations however have all of that happening on the server side, and the client simply provides the necessary input.</p>
<p>With MHD it feels like it should be the latter rather than the former.</p>
<p>I am currently working on a national spec for Germany where we want to describe simplified intra-organisational document exchange but align with MHD as much as possible to enable communications with the XDS based PHR withount much of an additional effort. </p>
<p>I'd be very much interested in preadopting the operations approach. Maybe we can start the discussion right here...?</p>



<a name="265291212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265291212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265291212">(Dec 17 2021 at 12:50)</a>:</h4>
<p>is there a downside to changing to an operation? (it is not an operation purely because this is an old enough spec that there was no operation support when MHD was first written).</p>



<a name="265291419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265291419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265291419">(Dec 17 2021 at 12:52)</a>:</h4>
<p>IHE process would run this change to an operation as a "Change Proposal". This would at-best be balloted in January, and thus be at-best final in February.<br>
The CP needs to explain why, and exact textual changes.  (The github issue with a pull-request would be fantastic)</p>



<a name="265342044"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265342044" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265342044">(Dec 17 2021 at 18:48)</a>:</h4>
<p>I would suggest to introduce the operation only as an addition for covering the replace document if the client cannot handle himself the replace logic. Why introduce an operation for all Usecases when those are semantically very nice handled with the transaction? Not every client needs to replace documents and would be perfectly fine to just use the transaction bundle as defined now. Not to forget that MHD has been tested during multiple connectathons with the transactions semantics and the NIST tooling built for it. Defining operations sounds for me like rewriting WSDL's ...</p>



<a name="265342311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265342311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265342311">(Dec 17 2021 at 18:50)</a>:</h4>
<p>that would keep from breaking things... but it also replicates alot of functionality, as all the functionality the current transaction is needed in the operation. as it is very possible to submit a replacement with a signature, ammendment, folder change, etc...</p>



<a name="265343480"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265343480" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265343480">(Dec 17 2021 at 18:59)</a>:</h4>
<p>other, relatively non-breaking, is to just require Document Source to include the old DocumentReference with the changes. Not that much of a bigger burden, just not something an XDS Document Source needs to do.</p>



<a name="265343554"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265343554" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265343554">(Dec 17 2021 at 19:00)</a>:</h4>
<p>so, we have three alternatives for discussion</p>



<a name="265343813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265343813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265343813">(Dec 17 2021 at 19:01)</a>:</h4>
<p>i would prefer additions then alternatives <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="265344087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265344087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265344087">(Dec 17 2021 at 19:03)</a>:</h4>
<p>I meant alternatives for how we solve the problem. not options to be written into the profile.</p>



<a name="265344723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265344723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Duncan <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265344723">(Dec 17 2021 at 19:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/179223-ihe/topic/MHD.20update.20and.20status/near/265291212">said</a>:</p>
<blockquote>
<p>is there a downside to changing to an operation? (it is not an operation purely because this is an old enough spec that there was no operation support when MHD was first written).</p>
</blockquote>
<p>One downside is that currently, you can support MHD in a standard FHIR server, so if it's an operation, that would need to be written for any default FHIR server that wants to support it.  I'm not saying this is necessarily a good enough reason, but it would affect implementations.</p>



<a name="265353573"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/265353573" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#265353573">(Dec 17 2021 at 20:05)</a>:</h4>
<p>right, but replacing a document is a normal lifecycle action, so that FHIR server would certainly need to support the replace functionality. <br>
This point about a normal FHIR server, would tend to require pushing the responsibility to the Document Source. But even this alternative would require the FHIR server to not allow a replace without the old DocumentReference.</p>



<a name="268287387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268287387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268287387">(Jan 17 2022 at 15:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="193299">Luke Duncan</span> <a href="#narrow/stream/179223-ihe/topic/MHD.20update.20and.20status/near/265344723">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/179223-ihe/topic/MHD.20update.20and.20status/near/265291212">said</a>:</p>
<blockquote>
<p>is there a downside to changing to an operation? (it is not an operation purely because this is an old enough spec that there was no operation support when MHD was first written).</p>
</blockquote>
<p>One downside is that currently, you can support MHD in a standard FHIR server, so if it's an operation, that would need to be written for any default FHIR server that wants to support it.  I'm not saying this is necessarily a good enough reason, but it would affect implementations.</p>
</blockquote>
<p>But would a default server's behaviour be correct according to the spec? If a Client sends an updated Document via transaction to an out-of-the-box FHIR Server, there would be duplicate documents with the same master identifier and both status "current". That can't be right...</p>



<a name="268287664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268287664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268287664">(Jan 17 2022 at 15:52)</a>:</h4>
<p>well, master identifier is expected to change on version changes too... see this in CDA and FHIR-Document.</p>



<a name="268288223"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268288223" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268288223">(Jan 17 2022 at 15:56)</a>:</h4>
<p>Guess I meant identifier, then...?</p>



<a name="268288321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268288321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268288321">(Jan 17 2022 at 15:57)</a>:</h4>
<p>so, yes there could be problems.. agreed.</p>



<a name="268290309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268290309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268290309">(Jan 17 2022 at 16:14)</a>:</h4>
<p>Note there is a "new work item" proposed to be picked up in February... if there is enough interest...</p>



<a name="268290312"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268290312" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268290312">(Jan 17 2022 at 16:14)</a>:</h4>
<p><a href="https://github.com/IHE/IT-Infrastructure/issues/175#issuecomment-1002122712">https://github.com/IHE/IT-Infrastructure/issues/175#issuecomment-1002122712</a></p>



<a name="268290761"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268290761" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268290761">(Jan 17 2022 at 16:19)</a>:</h4>
<p>I think the current specification contradicts the description of a transaction. We expect our POSTs to have consequence beyond the creation of the new resource (update status of old version) which is not what transactions do.</p>
<p>I see three options here:</p>
<ol>
<li>Keep the transaction as it is and accept that MHD in this form does not support updates</li>
<li>Keep the transaction but in case of an Update, the Transaction must include a PATCH or PUT on the old DocumentReference to set the status to 'superseded'</li>
<li>Drop the transaction and introduce an Operation and leave it to the server to deprecate the old version if a new one is added.</li>
</ol>
<p>What I am uncertain about is if the prospective Operation should differ between Create and Update. Is it up to the Server to figure out if a Document with the same identifier already exists or not and behave accordingly or is it up to the client? Does a client always know or care if an older version of the document already exists on the server?</p>



<a name="268853452"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268853452" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268853452">(Jan 21 2022 at 14:58)</a>:</h4>
<p>Regardless of whether Transaction or Operation, I think I would like to have a little more information on the expected server side behaviour in case of an update, specifically potential error scenarios:</p>
<ul>
<li>What triggers the specific update logic on the server?<ul>
<li>Is it the fact, that a document is submitted with an identifier that already exists on the server? </li>
<li>Is it the existence of the relatesTo-element? (and what if the relatesTo.code is anything other than "replaces")?</li>
</ul>
</li>
<li>Is the server expected to treat a submission as an update if only one of the conditions above are met or both?</li>
<li>what if the identifier of the DocumentReference behind the relatesTo-Link differs from the submitted DocumentReference.identifier?</li>
<li>what if the relatesTo.reference points to a DocumentReference that doesn't exist on the server? Should it treat the interaction as a (successful) create or error on the update?</li>
</ul>
<p>We just had a meeting with the stakeholders for the German ISiK specification and we are uncertain on how to continue... Keep the Transaction and clarify the expected behaviour in our IG? Create our own Operation and aim for future alignment with MHD or wait for IHE to decide on how to move forward? We are scheduled to publish in June, so it might be a close call...</p>
<p>I'm open for suggestions...</p>



<a name="268854301"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268854301" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268854301">(Jan 21 2022 at 15:03)</a>:</h4>
<p>These are excellent comments/questions. Thankyou.</p>



<a name="268854407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268854407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268854407">(Jan 21 2022 at 15:04)</a>:</h4>
<p>One clarification, are you speaking of the MHDS environment, or MHD as an API to XDS?</p>



<a name="268854743"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268854743" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268854743">(Jan 21 2022 at 15:07)</a>:</h4>
<p>I am not sure where IHE might go relative to changing to an Operation. BUT, your experience would be fantastic influence. so your overall question about if you should wait for IHE, I really don't think you should wait; but I do think engaging (like you are now) with discussion is fantastic.</p>



<a name="268854845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268854845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268854845">(Jan 21 2022 at 15:07)</a>:</h4>
<p>There are three forums where stakeholders might be. This one, Github repo, and the mhd implmementers mailing list.</p>



<a name="268856853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268856853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268856853">(Jan 21 2022 at 15:22)</a>:</h4>
<p>Agree that some transactions call for server side (replacement) logic, and therefore FHIR operations. MHD covers the bulk of the workflows, but just like with XDS the more complex stuff (ITI-41, ITI-86, ITI-62) will take longer to flesh out. Right now you should probably go for whatever seems most practical and in the spirit of FHIR &amp; REST, MHD(S) can still be changed at this point in time. </p>
<p>IMHO one can't, and shouldn't, define nor assume any particular server side logic to happen on a simple POST or PUT, besides simply updating its back end store.</p>



<a name="268896369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268896369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268896369">(Jan 21 2022 at 20:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/179223-ihe/topic/MHD.20update.20and.20status/near/268854407">said</a>:</p>
<blockquote>
<p>One clarification, are you speaking of the MHDS environment, or MHD as an API to XDS?</p>
</blockquote>
<p>That's a difficult one...<br>
We're currently aiming for a simplified spec where only single documents are exchanged within a single organiziation, but we are trying to align as much as possible with MHD, so the documents exchanged between systems using our spec can easily be forwarded to  MHD/XDS environments (e.g. our DocumetReferences already have appropriate metadata, but we don't use SubmissionSets).<br>
We might as well have gone and said we just do simple RESTful updates because it terms of compatibility it doesn't matter what the document's prior history  looks like * before* it's been forwarded to MHD/XDS. <br>
However, today's meeting has shown that the vendors prefer to use XDS logic for updates (creating a new DocumentReference and linking to the old one) even for the simplified exchange.<br>
 Also, everyone agreed, that the decision of how to correctly perform an update should be up to the server, not the client (this cuts out transaction).<br>
...so we're basically at the point where we need to fix the same problem as IHE.</p>
<p>I'm cautiously leaning towards something like a $submit-document operation, with a DocumentReference and a Binary input parameter plus some verbiage around how Clients can express the intent for update (e.g. through the relatesTo property) but eventually leaving it to the server  whether to treat it as regular RESTful update of the submitted DocumentReference on the relatesTo-target or to update "XDS-style" and whether to error on invalid relatesTo references or default to a create interaction... <br>
Either way, the expected result of the operation is that for each Document, there is eventually only one version with the status "current" on the server.</p>
<p>...but these are just initial thoughts that need a lot more thinking about...</p>



<a name="268902952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268902952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268902952">(Jan 21 2022 at 21:04)</a>:</h4>
<p>thanks for the thinking. I suspect IHE should move to an operation for many of these reasons.</p>



<a name="268903038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268903038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268903038">(Jan 21 2022 at 21:04)</a>:</h4>
<p>would your group be completely against one more List resource that is marked as a SubmissionSet? That tells the server WHY the operation is being done.</p>



<a name="268903081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/268903081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#268903081">(Jan 21 2022 at 21:05)</a>:</h4>
<p>is your primary use-case more of a PUSH, rather than a publish?</p>



<a name="270374311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270374311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270374311">(Feb 02 2022 at 12:17)</a>:</h4>
<p>More like a publish. We want to support full metadata as well as search.</p>



<a name="270394692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270394692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270394692">(Feb 02 2022 at 14:46)</a>:</h4>
<p>I tentatively drafted a $submit-document operation: <a href="https://simplifier.net/isik-dokumentenaustausch/submit-document">https://simplifier.net/isik-dokumentenaustausch/submit-document</a><br>
Points I'm still unclear about: </p>
<ul>
<li>Are we going to need more modes than just create/update, and if so, will this approach scale well?</li>
<li>What should the out parameter(s) be other than an OperationOutcome?</li>
<li>Can this be easily scaled up to an XDS compatible Operation by adding the SubmissionSet-List as an additional Parameter?</li>
<li>Would it be better to define distinct operations for update and create rather than putting the mode switch into parameters?</li>
<li>Are the expectations on Client/Server behaviour plausible?</li>
</ul>
<p>Please let me hear your thoughts!</p>



<a name="270396619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270396619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270396619">(Feb 02 2022 at 14:58)</a>:</h4>
<p>I think minimally create (mostly) is all that we need. Lesson learned from XDS days. yes there are XDS ways to soft-delete, and hard-delete. Folders can be updated, but DocumentReference and SubmissionSet are create only (they do get updated by the Registry triggered by things like Replace, soft-delete, and hard-delete); but those actions are independent of the publish flow.</p>



<a name="270396685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270396685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270396685">(Feb 02 2022 at 14:58)</a>:</h4>
<p>I think OperationOutcome is all that is needed, right? Good question.</p>



<a name="270396959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270396959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270396959">(Feb 02 2022 at 15:00)</a>:</h4>
<p>yes, SubmissionSet is needed. I understand your use-case doesn't understand the need, but the degenerate form of publishing one document is automatable to a minimal SubmissionSet. The SubmissionSet is useful for provenance, and traceability.</p>



<a name="270448849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270448849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270448849">(Feb 02 2022 at 20:03)</a>:</h4>
<p>The closest equivalent to this operation is a PUT/POST of a bundle, so you could consider having a bundle as the OUT parameter. This exposes the client to whatever (filtered/modified/limited) version of the resources as supported/stored by the FHIR server, who may not wish/be able to support all things contained in the IN bundle. The resources in the IN bundle could be richer than that which is required by IHE, or may contain extensions, all of which may or may not be supported by the server.</p>



<a name="270461512"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270461512" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270461512">(Feb 02 2022 at 21:34)</a>:</h4>
<p>and that is what this operation is replacing... the current transaction bundle.</p>



<a name="270518190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270518190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270518190">(Feb 03 2022 at 09:07)</a>:</h4>
<p>I was thinking that returning the DocumentReference (and the SubmissionSet, if present) with the id would be useful, so the client can cache the URL for easier user access (list of last documents, also, the client needs these urls for update/replace). My operation doesn't make assumptions about whether the server replaces or updates the Document (I wanted to leave this decision to the server and make the Operation usable in both scenarios). So the returned DocumentReference with either a new id or a new version is the only way, the client can tell, how the server processed the update.<br>
What I wouldn't wat to have as part of the return parameters is the Binary. I think that would just make things bulky and slow for no good reason.</p>



<a name="270518691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270518691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270518691">(Feb 03 2022 at 09:12)</a>:</h4>
<p>The OD I created is already tied to our current use case (ISiK Profiles). But I was hoping that maybe we could infer a common base operation which could be constrained for both our purpose and MHD without deviating too far from the base definition.</p>



<a name="270525645"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270525645" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270525645">(Feb 03 2022 at 10:13)</a>:</h4>
<p>Indeed, Binary should not be returned..</p>



<a name="270694956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179223-ihe/topic/MHD%20update%20and%20status/near/270694956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179223-ihe/topic/MHD.20update.20and.20status.html#270694956">(Feb 04 2022 at 10:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191372">René Spronk</span> <a href="#narrow/stream/179223-ihe/topic/MHD.20update.20and.20status/near/270448849">said</a>:</p>
<blockquote>
<p>The closest equivalent to this operation is a PUT/POST of a bundle, so you could consider having a bundle as the OUT parameter. This exposes the client to whatever (filtered/modified/limited) version of the resources as supported/stored by the FHIR server, who may not wish/be able to support all things contained in the IN bundle. The resources in the IN bundle could be richer than that which is required by IHE, or may contain extensions, all of which may or may not be supported by the server.</p>
</blockquote>
<p>I believe, the original idea in MHD was, to return a transaction-response with <em>only</em> the URLs of the created resources. But I agree with René that returning the created resources <strong>as the server understood them</strong> is of value to the client. So I'll just use the same Parameters construct for return values but without the Binary.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
