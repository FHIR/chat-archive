---
layout: page
title: "FHIR Chat  · docs: pull request 27: Remove `redirect`, add `postMessag... · cds hooks/committers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/index.html">cds hooks/committers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html">docs: pull request 27: Remove `redirect`, add `postMessag...</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153880436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179231-cds%20hooks/committers/topic/docs%3A%20pull%20request%2027%3A%20Remove%20%60redirect%60%2C%20add%20%60postMessag.../near/153880436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html#153880436">(Mar 30 2017 at 19:11)</a>:</h4>
<p>bkaney edited <a href="https://github.com/cds-hooks/docs/pull/27" target="_blank" title="https://github.com/cds-hooks/docs/pull/27">pull request 27</a></p>



<a name="153880453"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179231-cds%20hooks/committers/topic/docs%3A%20pull%20request%2027%3A%20Remove%20%60redirect%60%2C%20add%20%60postMessag.../near/153880453" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html#153880453">(Mar 30 2017 at 19:46)</a>:</h4>
<p>isaacvetter <a href="https://github.com/cds-hooks/docs/pull/27#issuecomment-290523923" target="_blank" title="https://github.com/cds-hooks/docs/pull/27#issuecomment-290523923">commented</a> on <a href="https://github.com/cds-hooks/docs/pull/27" target="_blank" title="https://github.com/cds-hooks/docs/pull/27">pull request 27</a></p>
<blockquote>
<p>Hi Brian,</p>
<p>What would this mean for apps that aren't hosted in an iframe?</p>
<p>Isaac</p>
</blockquote>



<a name="153880550"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179231-cds%20hooks/committers/topic/docs%3A%20pull%20request%2027%3A%20Remove%20%60redirect%60%2C%20add%20%60postMessag.../near/153880550" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html#153880550">(Mar 31 2017 at 00:48)</a>:</h4>
<p>bkaney <a href="https://github.com/cds-hooks/docs/pull/27#issuecomment-290585172" target="_blank" title="https://github.com/cds-hooks/docs/pull/27#issuecomment-290585172">commented</a> on <a href="https://github.com/cds-hooks/docs/pull/27" target="_blank" title="https://github.com/cds-hooks/docs/pull/27">pull request 27</a></p>
<blockquote>
<blockquote>
<p>Hi Brian,</p>
<p>What would this mean for apps that aren't hosted in an iframe?</p>
<p>Isaac</p>
</blockquote>
<p>Hi Isaac -- <code>postMessage</code> enables cross-origin communication. This can mean iframe/parent, but also can mean when a window opens another window.</p>
</blockquote>



<a name="153881499"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179231-cds%20hooks/committers/topic/docs%3A%20pull%20request%2027%3A%20Remove%20%60redirect%60%2C%20add%20%60postMessag.../near/153881499" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html#153881499">(Apr 09 2017 at 15:53)</a>:</h4>
<p>jmandel <a href="https://github.com/cds-hooks/docs/pull/27#issuecomment-292794135" target="_blank" title="https://github.com/cds-hooks/docs/pull/27#issuecomment-292794135">commented</a> on <a href="https://github.com/cds-hooks/docs/pull/27" target="_blank" title="https://github.com/cds-hooks/docs/pull/27">pull request 27</a></p>
<blockquote>
<p>Thanks @bkaney! One aspect we should cover here (well, in any discussion of <code>postMessage</code>) is the target origin: we should specify how to lock this down on both sides, so that the CDS service's web UI (SMART app) can post messages _to_ a known target domain, and the EHR's listener window can filter by messages coming _from_ a known target domain. Thoughts on how to tie this back into our discovery/launch protocol?</p>
</blockquote>



<a name="153881643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179231-cds%20hooks/committers/topic/docs%3A%20pull%20request%2027%3A%20Remove%20%60redirect%60%2C%20add%20%60postMessag.../near/153881643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html#153881643">(Apr 10 2017 at 19:29)</a>:</h4>
<p>bkaney <a href="https://github.com/cds-hooks/docs/pull/27#issuecomment-293053810" target="_blank" title="https://github.com/cds-hooks/docs/pull/27#issuecomment-293053810">commented</a> on <a href="https://github.com/cds-hooks/docs/pull/27" target="_blank" title="https://github.com/cds-hooks/docs/pull/27">pull request 27</a></p>
<blockquote>
<blockquote>
<p>Thanks @bkaney! One aspect we should cover here (well, in any discussion of postMessage) is the target origin: we should specify how to lock this down on both sides, so that the CDS service's web UI (SMART app) can post messages to a known target domain, and the EHR's listener window can filter by messages coming from a known target domain. Thoughts on how to tie this back into our discovery/launch protocol?</p>
</blockquote>
<p>Hmm, good point. I wonder if there is a way to use the existing HookInstance identifier somehow? I'll think about this over the next day or so and update the PR.</p>
</blockquote>



<a name="153884729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179231-cds%20hooks/committers/topic/docs%3A%20pull%20request%2027%3A%20Remove%20%60redirect%60%2C%20add%20%60postMessag.../near/153884729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html#153884729">(Apr 13 2017 at 20:57)</a>:</h4>
<p>bdoolittle <a href="https://github.com/cds-hooks/docs/pull/27#issuecomment-294019760" target="_blank" title="https://github.com/cds-hooks/docs/pull/27#issuecomment-294019760">commented</a> on <a href="https://github.com/cds-hooks/docs/pull/27" target="_blank" title="https://github.com/cds-hooks/docs/pull/27">pull request 27</a></p>
<blockquote>
<p>Hi All,</p>
<p>postMessage seems like a nice alternative to the redirect url, we're really excited about its ability to enable a more responsive user experience. My team has a few points we'd like to add for consideration. </p>
<p>First, we agree with Josh that specifying targetOrigin when sending the message and checking the origin on the receiving side is a good security measure to add into the spec. Should the SMART App also be sending a security token (or other mechanism) to add an additional level of authentication?</p>
<p>Second, a web-based EHR may want to open the SMART App in a new tab rather than an iframe, this introduces the possibility that the user may exit the EHR before completing the SMART App interaction. In this case, there would be no window to send a postMessage to. Would the CDS Service know that the postMessage was not received? Should there be some acknowledgement from the EHR to the SMART App indicating that the EHR successfully received the postMessage? This way, the SMART App could indicate to the user that there was an error in notifying the EHR about the decision.</p>
<p>Third, there may be implementations where the redirect URL solution is more accessible than postMessage. Would it be reasonable for the hooks standard to be flexible and support both means of communication? The worry here is that the cds-hooks implementation becomes more complex.</p>
</blockquote>



<a name="153885324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179231-cds%20hooks/committers/topic/docs%3A%20pull%20request%2027%3A%20Remove%20%60redirect%60%2C%20add%20%60postMessag.../near/153885324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Github Notifications <a href="https://fhir.github.io/chat-archive/stream/179231-cds-hooks/committers/topic/docs.3A.20pull.20request.2027.3A.20Remove.20.60redirect.60.2C.20add.20.60postMessag.2E.2E.2E.html#153885324">(Apr 20 2017 at 19:52)</a>:</h4>
<p>bkaney <a href="https://github.com/cds-hooks/docs/pull/27#issuecomment-295879816" target="_blank" title="https://github.com/cds-hooks/docs/pull/27#issuecomment-295879816">commented</a> on <a href="https://github.com/cds-hooks/docs/pull/27" target="_blank" title="https://github.com/cds-hooks/docs/pull/27">pull request 27</a></p>
<blockquote>
<p>I agree with <span class="user-mention" data-user-email="jmandel@gmail.com">@Josh Mandel</span>. There is two more things I was thinking about. </p>
<p>1) I was thinking the <code>hookInstance</code> should be passed (as a query parameter, for instance) to the redirect URL. This would be helpful -or- necessary information for EHR to deal with navigation post-interaction.</p>
<p>2) I appreciate the "lowest common denominator" idea around a redirect URL. However, given a client-server EHR that is using some sort web dialog widget, having a javascript way to do this (e.g. <code>postMessage</code>) might be in fact the LCD...</p>
</blockquote>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
