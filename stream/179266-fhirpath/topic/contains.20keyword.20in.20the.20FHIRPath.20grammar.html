---
layout: page
title: "FHIR Chat  · contains keyword in the FHIRPath grammar · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html">contains keyword in the FHIRPath grammar</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153964342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Munini <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964342">(May 23 2018 at 15:16)</a>:</h4>
<p>I'm using the FHIRPath grammar from <a href="http://hl7.org/fhirpath/2018May/grammar.html" target="_blank" title="http://hl7.org/fhirpath/2018May/grammar.html">http://hl7.org/fhirpath/2018May/grammar.html</a>, and working with the SearchParameter FHIRPath expressions in search-parameters.xml.  They are working great except for this one:</p>
<p>ValueSet.expansion.contains.code</p>
<p>I'm getting this error using Antlr 4.3, generating Java:</p>
<p>line 1:19 no viable alternative at input 'contains'</p>
<p>If I remove the following line from the grammar, it works just fine.  I don't think that "contains" is used in any SearchParameter FHIR expressions:</p>
<div class="codehilite"><pre><span></span>    | expression (&#39;in&#39; | &#39;contains&#39;) expression                 #membershipExpression
</pre></div>


<p>The problem appears to be with the keyword "contains" in the FHIRPath expression.</p>
<p>Has anyone else run into this problem with the grammar?</p>



<a name="153964366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964366">(May 23 2018 at 17:22)</a>:</h4>
<p>it's certainly valid because contains is an element in the ValueSet resource</p>



<a name="153964436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964436">(May 23 2018 at 19:32)</a>:</h4>
<p>If the model has an element that is named the same as a keyword in the language, use a quoted identifier to access the element, so <code>"contains"</code></p>



<a name="153964437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964437">(May 23 2018 at 19:34)</a>:</h4>
<p>This was something we did not appreciate when we wrote the spec, and it's currently wrong if you're correct. But I don't think you are. field.contains is not ambiguous</p>



<a name="153964438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964438">(May 23 2018 at 19:35)</a>:</h4>
<p>(as in, the FHIRPath spec is wrong)</p>



<a name="153964483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964483">(May 23 2018 at 22:19)</a>:</h4>
<p>Not sure I'm following. Are you saying the spec is wrong for having contains as a keyword?</p>



<a name="153964484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964484">(May 23 2018 at 22:20)</a>:</h4>
<p>well, no, but if having that means you can't use xx.contains, then some examples are wrong. And I don't know whether I would have agreed to symbols containing words if I realised that was the case</p>



<a name="153964485"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964485" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964485">(May 23 2018 at 22:20)</a>:</h4>
<p>we don't publish a list of words...</p>



<a name="153964486"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964486" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964486">(May 23 2018 at 22:22)</a>:</h4>
<p>True, we don't have a list of keywords, and we should, there are several:</p>



<a name="153964487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964487">(May 23 2018 at 22:22)</a>:</h4>
<p>But they are defined as such in the grammar.</p>



<a name="153964488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964488">(May 23 2018 at 22:25)</a>:</h4>
<p><code>div</code>, <code>mod</code>, <code>is</code>, <code>as</code>, <code>in</code>, <code>contains</code>, <code>and</code>, <code>or</code>, <code>xor</code>, <code>implies</code>, and the date/time precision keywords (<code>year</code>, <code>month</code>, <code>day</code>, etc.)</p>



<a name="153964489"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964489" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964489">(May 23 2018 at 22:26)</a>:</h4>
<p>If the implementations don't do this though, then I agree, the spec is wrong</p>



<a name="153964490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964490">(May 23 2018 at 22:27)</a>:</h4>
<p>well, the spec doesn't put "" around them in the examples.</p>



<a name="153964491"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964491" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964491">(May 23 2018 at 22:27)</a>:</h4>
<p>and I don't see why we should unless there's actual ambiguity.</p>



<a name="153964492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964492">(May 23 2018 at 22:29)</a>:</h4>
<p>I agree, and I also agree that <code>xx.contains</code> isn't ambiguous, it couldn't possibly be a keyword because it's clearly part of a path. I think the Antlr parser chokes on this though, and as far as I've been able to determine, the workaround is to put the keywords in the indentifier rule. We've already actually done this with is and as, for example.</p>



<a name="153964493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964493">(May 23 2018 at 22:30)</a>:</h4>
<p>well, can we fix the grammar then?</p>



<a name="153964494"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964494" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964494">(May 23 2018 at 22:31)</a>:</h4>
<p>I'll take a look and see if i can figure out a better way to convince Antlr it's not ambiguous.</p>



<a name="153964495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964495">(May 23 2018 at 22:31)</a>:</h4>
<p>Worst case, yes, we can add all the keywords to the identifier rule.</p>



<a name="153964496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964496">(May 23 2018 at 22:32)</a>:</h4>
<p>ok great.</p>



<a name="153964504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/contains%20keyword%20in%20the%20FHIRPath%20grammar/near/153964504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Munini <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/contains.20keyword.20in.20the.20FHIRPath.20grammar.html#153964504">(May 24 2018 at 01:18)</a>:</h4>
<p>Thanks Bryn and Grahame for looking into this.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
