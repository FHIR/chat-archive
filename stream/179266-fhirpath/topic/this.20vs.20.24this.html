---
layout: page
title: "FHIR Chat  · this vs $this · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html">this vs $this</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="164728006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164728006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164728006">(May 02 2019 at 17:35)</a>:</h4>
<p>In <a href="http://build.fhir.org/eventdefinition-example.json.html" target="_blank" title="http://build.fhir.org/eventdefinition-example.json.html">this example</a> we see the following expression:</p>
<div class="codehilite"><pre><span></span>(this | %previous).location.where(location = &#39;Location/emergency&#39; and status in {&#39;active&#39;, &#39;completed&#39;}).exists()
</pre></div>


<p>Should <code>this</code> actually be <code>$this</code>, or are both valid?</p>



<a name="164728038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164728038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164728038">(May 02 2019 at 17:35)</a>:</h4>
<p>(Related: how are fhirpath expressions in the spec validated?)</p>



<a name="164730692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164730692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164730692">(May 02 2019 at 18:05)</a>:</h4>
<p>Should be <code>$this</code>, it's a special-purpose identifier in the grammar.</p>



<a name="164730778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164730778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164730778">(May 02 2019 at 18:06)</a>:</h4>
<p>The expressions in the spec are validated with the engine running</p>



<a name="164730795"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164730795" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164730795">(May 02 2019 at 18:06)</a>:</h4>
<p>in the build</p>



<a name="164730817"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164730817" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164730817">(May 02 2019 at 18:06)</a>:</h4>
<p>But since that particular example doesn't actually run as part of the build, it's not validated.</p>



<a name="164730911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164730911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164730911">(May 02 2019 at 18:07)</a>:</h4>
<p>that expression is not validated - it's not in a place the validator knows to look and validate. And I think it should actually be </p>
<p><code>(%current | %previous).location.where(location = 'Location/emergency' and status in {'active', 'completed'}).exists()</code></p>



<a name="164731048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164731048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164731048">(May 02 2019 at 18:09)</a>:</h4>
<p>Where is %current defined?</p>



<a name="164731158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164731158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164731158">(May 02 2019 at 18:10)</a>:</h4>
<p><code>%current</code> is a context variable so it's defined by whatever the context specifies. In this case, a trigger condition, so it's specified as part of the condition element as an expectation of the implementation.</p>



<a name="164731858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164731858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164731858">(May 02 2019 at 18:17)</a>:</h4>
<p>That makes sense.  FYI, at <a href="http://build.fhir.org/metadatatypes-definitions.html#TriggerDefinition.condition" target="_blank" title="http://build.fhir.org/metadatatypes-definitions.html#TriggerDefinition.condition">http://build.fhir.org/metadatatypes-definitions.html#TriggerDefinition.condition</a>, I saw %previous mentioned, but not %current defined as a variable name.  Although it says you should be able to get to the current resource,  it does not say what variable name it is in.</p>



<a name="164732403"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164732403" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164732403">(May 02 2019 at 18:23)</a>:</h4>
<p>right. that work is incomplete for that reason</p>



<a name="164737053"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/this%20vs%20%24this/near/164737053" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/this.20vs.20.24this.html#164737053">(May 02 2019 at 19:21)</a>:</h4>
<p>Added <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21233" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=21233">GF#21233</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
