---
layout: page
title: "FHIR Chat  · FHIRPath test suite for precedence correct? · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html">FHIRPath test suite for precedence correct?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="267315566"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267315566" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267315566">(Jan 08 2022 at 21:06)</a>:</h4>
<p>I continue to work my way through the FHIRPath test suite: I am wondering whether test cases 'testPrecedence3' and 'testPrecedence4' are correct? They are '1 &gt; 2 is Boolean' with expected result true, and '1 | 1 is Integer' with expected result true. But 'is' has higher precedence than '&gt;' and '|'. In my mind the proper outcome of the first expression is thus a failure, since it basically evaluates to '1 &gt; false'. The outcome of the second one should be '[1, true]', as '1 is Integer' equals true. Or am I mistaken?</p>



<a name="267316542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316542">(Jan 08 2022 at 21:19)</a>:</h4>
<p>The dotnet engine gives &gt; a higher precedence than is (just tested it here)</p>



<a name="267316588"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316588" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316588">(Jan 08 2022 at 21:20)</a>:</h4>
<p>However I think you're right based on the spec. I'll check the code and grammar to compare.</p>



<a name="267316601"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316601" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316601">(Jan 08 2022 at 21:20)</a>:</h4>
<p>I'm looking at this spec: <a href="http://hl7.org/fhirpath/#operator-precedence">http://hl7.org/fhirpath/#operator-precedence</a></p>



<a name="267316611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316611">(Jan 08 2022 at 21:21)</a>:</h4>
<p>Did you test the Java or fhirpathjs implementation?</p>



<a name="267316631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316631">(Jan 08 2022 at 21:21)</a>:</h4>
<p>not yet, I'm contributing to <span class="user-mention" data-user-id="235060">@Grey Faulkenberry</span> 's Dart version.</p>



<a name="267316682"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316682" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316682">(Jan 08 2022 at 21:22)</a>:</h4>
<p>I assume you have the tests file and walking through that yeah?</p>



<a name="267316708"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316708" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316708">(Jan 08 2022 at 21:23)</a>:</h4>
<p>exactly. Very helpful in general, but a very small number of test cases leave me with some doubts.</p>



<a name="267316789"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316789" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316789">(Jan 08 2022 at 21:25)</a>:</h4>
<p>The fhirpath.js is also doing the precedence as expected in the test suite and not as in the spec.</p>



<a name="267316935"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267316935" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267316935">(Jan 08 2022 at 21:28)</a>:</h4>
<p>The grammar file is consistent with spec</p>



<a name="267317096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317096">(Jan 08 2022 at 21:33)</a>:</h4>
<p>Do you know what the procedure is to give feedback on the test suite? Similar as with SDC, where one files a JIRA issue? I just found the next test case that should signal an error according to the spec, but the test suite expects it to pass.</p>



<a name="267317109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317109">(Jan 08 2022 at 21:33)</a>:</h4>
<p>Just jira the same.</p>



<a name="267317153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317153">(Jan 08 2022 at 21:34)</a>:</h4>
<p>(might not be an offical artifact, but makes sense to track in the same way)</p>



<a name="267317178"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317178" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317178">(Jan 08 2022 at 21:35)</a>:</h4>
<p>(and also here too for discussion like this)</p>



<a name="267317246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317246">(Jan 08 2022 at 21:36)</a>:</h4>
<p>Actually, the grammar used by the fhirpathjs is different to the official one on the site...</p>



<a name="267317281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317281">(Jan 08 2022 at 21:37)</a>:</h4>
<p>Same here, there was no good ANTLR for Dart, so it is based on Petite Parser. Tries to get the spec correctly implemented, but cannot use the grammar file.</p>



<a name="267317376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317376">(Jan 08 2022 at 21:39)</a>:</h4>
<p>This is what is in the fhirpathjs implementation...<br>
<a href="https://github.com/HL7/fhirpath.js/blob/master/src/parser/FHIRPath.g4">https://github.com/HL7/fhirpath.js/blob/master/src/parser/FHIRPath.g4</a><br>
And that moved the precedence of the is down below &gt; and |</p>



<a name="267317419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317419">(Jan 08 2022 at 21:40)</a>:</h4>
<p>Thus different to <a href="https://hl7.org/fhirpath/grammar.html">https://hl7.org/fhirpath/grammar.html</a></p>



<a name="267317433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317433">(Jan 08 2022 at 21:40)</a>:</h4>
<p>(still trying to locate the specific part of the .net code that does this)</p>



<a name="267317574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317574">(Jan 08 2022 at 21:44)</a>:</h4>
<p>Looks like the dotnet parser does the same as the fhirpathjs there too (precedence wise)<br>
<a href="https://github.com/FirelyTeam/firely-net-common/blob/7c6f7fb726f41f5a6645a9bc9239af9ca4ec9f82/src/Hl7.FhirPath/FhirPath/Parser/Grammar.cs#L134">https://github.com/FirelyTeam/firely-net-common/blob/7c6f7fb726f41f5a6645a9bc9239af9ca4ec9f82/src/Hl7.FhirPath/FhirPath/Parser/Grammar.cs#L134</a></p>



<a name="267317676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317676">(Jan 08 2022 at 21:47)</a>:</h4>
<p>I think from a common sense perspective the lower precedence for 'is' makes sense. But I guess it would be hard to argue against a released ANSI standard...</p>



<a name="267317805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20test%20suite%20for%20precedence%20correct%3F/near/267317805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20test.20suite.20for.20precedence.20correct.3F.html#267317805">(Jan 08 2022 at 21:50)</a>:</h4>
<p>(deleted)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
