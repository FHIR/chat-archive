---
layout: page
title: "FHIR Chat  · Comparing collections with subsetOf · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html">Comparing collections with subsetOf</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="261044537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261044537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261044537">(Nov 10 2021 at 19:49)</a>:</h4>
<p>I have a situation where I want to make sure I want the all of the values of one collection of elements be a subset of the collection of other values. It is working on <a href="https://hl7.github.io/fhirpath.js/">https://hl7.github.io/fhirpath.js/</a> but not in the build.<br>
Specifically I need to make sure all of the numbers in Explanation.supportingInfo.sequence (where supporting info has certain info in it) are included in the collection of ExplanationOfBenefit.item.informationSequence values.</p>
<p>Here is the example. I would expect [1, 2] to be a subset of [1, 2]<br>
FHIRPath expression: <code>supportingInfo.where(category.coding.code = 'additionalbodysite').sequence.subsetOf(item.informationSequence)</code><br>
Stripped Resource:</p>
<div class="codehilite"><pre><span></span><code>{
  &quot;resourceType&quot; : &quot;ExplanationOfBenefit&quot;,
  &quot;supportingInfo&quot; : [
    {
      &quot;sequence&quot; : 1,
      &quot;category&quot; : {
        &quot;coding&quot; : [
          {
            &quot;system&quot; : &quot;http://hl7.org/fhir/us/carin-bb/CodeSystem/C4BBSupportingInfoType&quot;,
            &quot;code&quot; : &quot;additionalbodysite&quot;
          }
        ]
      }
    },
    {
      &quot;sequence&quot; : 2,
      &quot;category&quot; : {
        &quot;coding&quot; : [
          {
            &quot;system&quot; : &quot;http://hl7.org/fhir/us/carin-bb/CodeSystem/C4BBSupportingInfoType&quot;,
            &quot;code&quot; : &quot;additionalbodysite&quot;
          }
        ]
      }
    }
  ],
  &quot;item&quot; : [
    {
      &quot;sequence&quot; : 1,
      &quot;informationSequence&quot; : [
        2
      ]
    },
    {
      &quot;sequence&quot; : 2,
      &quot;informationSequence&quot; : [
        1
      ]
    }
  ]
}
</code></pre></div>



<a name="261364776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261364776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261364776">(Nov 13 2021 at 15:05)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="261376458"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261376458" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261376458">(Nov 13 2021 at 19:41)</a>:</h4>
<p>Added a test case for this:</p>



<a name="261376460"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261376460" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261376460">(Nov 13 2021 at 19:41)</a>:</h4>
<p><a href="https://github.com/FHIR/fhir-test-cases/pull/100">https://github.com/FHIR/fhir-test-cases/pull/100</a></p>



<a name="261379247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261379247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261379247">(Nov 13 2021 at 20:47)</a>:</h4>
<p>I'm not able to debug though because the current master of org.hl7.fhir.core fails for me on package tests, not sure what's happening there.</p>



<a name="261379299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261379299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261379299">(Nov 13 2021 at 20:48)</a>:</h4>
<p>not failing for me. what's your error?</p>



<a name="261379810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261379810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261379810">(Nov 13 2021 at 21:01)</a>:</h4>
<p>Hmm... testJavaHomeDirectory failed:</p>



<a name="261379811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/261379811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#261379811">(Nov 13 2021 at 21:01)</a>:</h4>
<p>org.opentest4j.AssertionFailedError: <br>
Expected :C:\Program Files\AdoptOpenJDK\jdk-11.0.5.10-openj9\test.txt<br>
Actual   :C:\Program Files\AdoptOpenJDK\jdk-11.0.5.10-openj9\\test.txt</p>



<a name="263805332"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/263805332" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#263805332">(Dec 06 2021 at 03:31)</a>:</h4>
<p><span class="user-mention" data-user-id="453078">@David Otasek</span> can you look into this? </p>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> what OS is this on?</p>



<a name="263856561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/263856561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Otasek <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#263856561">(Dec 06 2021 at 14:24)</a>:</h4>
<p>I'll look into it. From the path, it looks to be triggered by Windows, but it would be good to have this confirmed. It also looks to be very similar to the MacOS test I fixed a few weeks ago, so the fix might be pretty easy.</p>



<a name="263936000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Comparing%20collections%20with%20subsetOf/near/263936000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Otasek <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Comparing.20collections.20with.20subsetOf.html#263936000">(Dec 06 2021 at 22:49)</a>:</h4>
<p>Fix is in this PR: <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/683/">https://github.com/hapifhir/org.hl7.fhir.core/pull/683/</a></p>
<p>I'm waiting for the other PRs and builds to settle down, and then I'll merge.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
