---
layout: page
title: "FHIR Chat  · .trace() · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html">.trace()</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153973616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973616">(Jul 05 2018 at 01:00)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> <span class="user-mention" data-user-id="191328">@Ewout Kramer</span> <span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> I have a FHIRPath problem I'm trying to think my way through</p>



<a name="153973618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973618">(Jul 05 2018 at 01:01)</a>:</h4>
<p>take this FHIRPath:</p>



<a name="153973619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973619">(Jul 05 2018 at 01:02)</a>:</h4>
<div class="codehilite"><pre><span></span>contained.where(criteria).trace(&#39;unmatched&#39;).empty()
</pre></div>



<a name="153973620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973620">(Jul 05 2018 at 01:02)</a>:</h4>
<p>I actually want, from the trace, a list of resource ids, not a list of resources</p>



<a name="153973621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973621">(Jul 05 2018 at 01:02)</a>:</h4>
<p>but I can't do this:</p>



<a name="153973622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973622">(Jul 05 2018 at 01:03)</a>:</h4>
<div class="codehilite"><pre><span></span>contained.where(criteria).id.trace(&#39;unmatched&#39;).empty()
</pre></div>



<a name="153973623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973623">(Jul 05 2018 at 01:03)</a>:</h4>
<p>because then the empty() applies to the id collection, which mightn't be the same as the resource collection</p>



<a name="153973624"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973624" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973624">(Jul 05 2018 at 01:03)</a>:</h4>
<p>we don't have syntax tricks for side branches, do we?</p>



<a name="153973625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973625">(Jul 05 2018 at 01:07)</a>:</h4>
<p>).select($this|id.trace().first().empty()</p>



<a name="153973628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973628">(Jul 05 2018 at 01:16)</a>:</h4>
<p>I don't follow that</p>



<a name="153973636"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973636" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973636">(Jul 05 2018 at 04:39)</a>:</h4>
<div class="codehilite"><pre><span></span>&lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;
&lt;name&gt;&lt;family value=&quot;Pos&quot;/&gt;
&lt;given value=&quot;brian&quot;/&gt;
&lt;/name&gt;
&lt;birthDate value=&quot;1980&quot;/&gt;
&lt;/Patient&gt;
</pre></div>


<p>With the above example resource, the below expression will trace Brian, but return the family as the selected node at the end,</p>
<div class="codehilite"><pre><span></span>name.select($this | given.trace(&#39;f&#39;)).first().family
</pre></div>



<a name="153973678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973678">(Jul 05 2018 at 12:09)</a>:</h4>
<p>ok I understand that, but I don't really see how this applies to the question I asked</p>



<a name="153973755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973755">(Jul 05 2018 at 14:45)</a>:</h4>
<p>Maybe this:</p>
<div class="codehilite"><pre><span></span>contained.where(criteria).select(iff($this.id.trace().empty(), $this, $this)).empty()
</pre></div>



<a name="153973846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973846">(Jul 05 2018 at 19:01)</a>:</h4>
<p>clever</p>



<a name="153973847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973847">(Jul 05 2018 at 19:02)</a>:</h4>
<p>but is this a language problem?</p>



<a name="153973851"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973851" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973851">(Jul 05 2018 at 19:05)</a>:</h4>
<p>I think it's more a problem with trace, in that it's not flexible enough to describe what you want to output. A fix for trace would be to just add an optional parameter that allows you to shape the output. You could potentially build up a result that had both what you wanted and what you wanted to trace, but that would be forcing you to change the structure of an invariant just to add debugging information.</p>



<a name="153973872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973872">(Jul 05 2018 at 19:16)</a>:</h4>
<p>that's certainly true about trace. I guess we can fix that... it's only in FHIR isn't it (surely you need it elsewhere...)</p>



<a name="153973892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973892">(Jul 05 2018 at 20:01)</a>:</h4>
<p>Trace is in the base FHIRPath spec: <a href="http://hl7.org/fhirpath/2018May/index.html#utility-functions" target="_blank" title="http://hl7.org/fhirpath/2018May/index.html#utility-functions">http://hl7.org/fhirpath/2018May/index.html#utility-functions</a></p>



<a name="153973893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973893">(Jul 05 2018 at 20:07)</a>:</h4>
<p>oh. yes. so are able to change it to add a selector?</p>



<a name="153973894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973894">(Jul 05 2018 at 20:08)</a>:</h4>
<p>(that's a process question)</p>



<a name="153973905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973905">(Jul 05 2018 at 20:43)</a>:</h4>
<p>Not seeing any comments that would support it</p>



<a name="153973907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973907">(Jul 05 2018 at 20:49)</a>:</h4>
<p>no. it's a discovered issue</p>



<a name="153973908"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973908" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973908">(Jul 05 2018 at 20:50)</a>:</h4>
<p>I guess we could add it to <a href="http://build.fhir.org/fhirpath.html" target="_blank" title="http://build.fhir.org/fhirpath.html">http://build.fhir.org/fhirpath.html</a> as a FHIR specific extension and roll it up to the main FHIRPath spec next time round</p>



<a name="153973913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973913">(Jul 05 2018 at 21:25)</a>:</h4>
<p><a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17455" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17455">GF#17455</a></p>



<a name="153973916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153973916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153973916">(Jul 05 2018 at 21:33)</a>:</h4>
<p>Yeah, Bryn's answer is much better.</p>



<a name="153974257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153974257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153974257">(Jul 08 2018 at 23:15)</a>:</h4>
<p>ok, I added a selector for trace() to the FHIRPath spec</p>



<a name="153974258"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/.trace%28%29/near/153974258" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/.2Etrace().html#153974258">(Jul 08 2018 at 23:15)</a>:</h4>
<p>I also added a terminology service API (to <a href="http://build.fhir.org/fhirpath.html" target="_blank" title="http://build.fhir.org/fhirpath.html">http://build.fhir.org/fhirpath.html</a>)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
