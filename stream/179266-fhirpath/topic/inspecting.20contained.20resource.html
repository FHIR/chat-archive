---
layout: page
title: "FHIR Chat  · inspecting contained resource · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html">inspecting contained resource</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="191822816"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/191822816" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#191822816">(Mar 25 2020 at 23:14)</a>:</h4>
<p>How do I correctly get a hold of a certain (set of) contained resource(s) in an invariant. Lets say I have a Communication resource and the sender is a contained device. In my Invariant, I would like to get access to that particular contained resource. The following does not work (and it aint elegant either): <code>contained.where(id = sender.reference.replace('#',''))</code></p>



<a name="191822849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/191822849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#191822849">(Mar 25 2020 at 23:15)</a>:</h4>
<p>the question is how is that correctly stated using FHIR Path?</p>



<a name="191840272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/191840272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#191840272">(Mar 26 2020 at 04:53)</a>:</h4>
<p>You should ideally be resolving the references (using <code>.resolve()</code>) rather than relying on foreknowledge that the content will be contained.</p>



<a name="191852599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/191852599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#191852599">(Mar 26 2020 at 08:40)</a>:</h4>
<p>How do I inspect the identifier of the device when the example looks like the following?</p>
<div class="codehilite"><pre><span></span>{
  &quot;sender&quot;: {
    &quot;reference&quot;: &quot;#1&quot;
  },
  &quot;meta&quot;: {
    &quot;profile&quot;: [
      &quot;http://ehealth.sundhed.dk/fhir/StructureDefinition/ehealth-message&quot;
    ]
  },
  &quot;status&quot;: &quot;completed&quot;,
  &quot;medium&quot;: [
    {
      &quot;text&quot;: &quot;WRITTEN&quot;,
      &quot;coding&quot;: [
        {
          &quot;system&quot;: &quot;http://terminology.hl7.org/CodeSystem/v3-ParticipationMode&quot;,
          &quot;code&quot;: &quot;WRITTEN&quot;
        }
      ]
    }
  ],
  &quot;recipient&quot;: [
    {
      &quot;reference&quot;: &quot;http://inttest.ehealth.sundhed.dk/trifork-fhir-server/Patient/XXX&quot;
    }
  ],
  &quot;resourceType&quot;: &quot;Communication&quot;,
  &quot;category&quot;: [
    {
      &quot;text&quot;: &quot;Besked&quot;,
      &quot;coding&quot;: [
        {
          &quot;system&quot;: &quot;http://ehealth.sundhed.dk/cs/message-category&quot;,
          &quot;code&quot;: &quot;message&quot;
        }
      ]
    }
  ],
  &quot;contained&quot;: [
    {
      &quot;id&quot;: &quot;1&quot;,
      &quot;resourceType&quot;: &quot;Device&quot;,
      &quot;identifier&quot;: [
        {
          &quot;value&quot;: &quot;hello.system&quot;
        }
      ]
    }
  ],
  &quot;payload&quot;: [
    {
      &quot;contentString&quot;: &quot;Hello world&quot;
    }
  ],
  &quot;sent&quot;: &quot;2019-04-03T18:01:10-08:00&quot;
}
</pre></div>


<p>sender.resolve() returns the empty set</p>



<a name="191852616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/191852616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#191852616">(Mar 26 2020 at 08:41)</a>:</h4>
<p>at least using <a href="https://marketplace.visualstudio.com/items?itemName=Yannick-Lagger.vscode-fhir-tools" title="https://marketplace.visualstudio.com/items?itemName=Yannick-Lagger.vscode-fhir-tools">https://marketplace.visualstudio.com/items?itemName=Yannick-Lagger.vscode-fhir-tools</a></p>



<a name="259450545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259450545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259450545">(Oct 28 2021 at 20:54)</a>:</h4>
<p>I have the same need, I guess</p>



<a name="259450663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259450663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259450663">(Oct 28 2021 at 20:55)</a>:</h4>
<p>I am looking into a contained resource. <br>
This evaluates to true:<br>
<code>contained.first().id=implementation.custodian.reference.substring(1,999)</code></p>



<a name="259450736"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259450736" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259450736">(Oct 28 2021 at 20:56)</a>:</h4>
<p>(as it should) - this means that the first contained resource matches what I want to look for</p>



<a name="259450847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259450847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259450847">(Oct 28 2021 at 20:57)</a>:</h4>
<p>so why doesn't <code>contained.where(id=implementation.custodian.reference.substring(1,999))</code> return the first contained resource?</p>



<a name="259459927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259459927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259459927">(Oct 28 2021 at 22:21)</a>:</h4>
<p><code>contained.where(id=%resource.implementation.custodian.reference.substring(1,999))</code> will probably work</p>



<a name="259460035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259460035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259460035">(Oct 28 2021 at 22:22)</a>:</h4>
<p>When you're inside the where clause, the names of the properties you're referencing have to be 'visible' from the node you're on.  In this case, the root node of all the contained resources</p>



<a name="259461111"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259461111" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259461111">(Oct 28 2021 at 22:36)</a>:</h4>
<p>%resource allows you to start at the root of the resource that is the 'base' for the current node</p>



<a name="259487022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259487022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259487022">(Oct 29 2021 at 06:21)</a>:</h4>
<p>It seems that %resource is not implemented in the javascript library that I want to use.</p>



<a name="259520824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259520824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259520824">(Oct 29 2021 at 13:05)</a>:</h4>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span></p>



<a name="259697293"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259697293" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259697293">(Oct 29 2021 at 23:41)</a>:</h4>
<p>It is, but you have to set it when calling it.</p>



<a name="259718758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259718758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259718758">(Oct 30 2021 at 08:38)</a>:</h4>
<p>What does that mean?</p>



<a name="259719898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259719898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259719898">(Oct 30 2021 at 09:07)</a>:</h4>
<p>The code that calls it needs to pass in an array of variables, including this one.</p>



<a name="259720069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259720069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259720069">(Oct 30 2021 at 09:12)</a>:</h4>
<p>Not the part on here that talks about environment variables, use that and add in resource to that array like it has for %a<br>
<a href="https://github.com/HL7/fhirpath.js/">https://github.com/HL7/fhirpath.js/</a></p>



<a name="259811415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/inspecting%20contained%20resource/near/259811415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/inspecting.20contained.20resource.html#259811415">(Oct 31 2021 at 22:20)</a>:</h4>
<p>thanks. That works</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
