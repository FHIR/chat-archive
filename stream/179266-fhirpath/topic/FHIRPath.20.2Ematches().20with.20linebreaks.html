---
layout: page
title: "FHIR Chat  · FHIRPath .matches() with linebreaks · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html">FHIRPath .matches() with linebreaks</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="238725037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/238725037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pieter Edelman <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#238725037">(May 14 2021 at 06:37)</a>:</h4>
<p><a href="#narrow/stream/179166-implementers/topic/FHITPath.20.2Ematches.28.29.20with.20linebreaks/near/238528297">(previously posted in <a class="stream" data-stream-id="179166" href="/#narrow/stream/179166-implementers">#implementers</a> )</a>:<br>
Hi,<br>
I'm trying to use the <code>.matches()</code> FHIRPath function to check if the <code>StructureDefintion.purpose</code> text is properly populated in some of our profiles. This works as long as I don't include linebreaks in the <code>.purpose</code> field. If I do, I get inconsistent results. Take the following synthetic example:</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>  -- snip --
  <span class="nt">&lt;description</span> <span class="na">value=</span><span class="s">"An anatomical location specifies the location (e.g. foot) and laterality (e.g. links) of a bodypart."</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;purpose</span> <span class="na">value=</span><span class="s">"A&amp;#xD;&amp;#xA;B"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;fhirVersion</span> <span class="na">value=</span><span class="s">"4.0.1"</span> <span class="nt">/&gt;</span>
  -- snip --
</code></pre></div>
<p>Yields:</p>
<table>
<thead>
<tr>
<th></th>
<th>HL7 Validator</th>
<th>FHIRPath Tester</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>StructureDefinition.purpose.matches('A.*')</code></td>
<td>false</td>
<td>true</td>
</tr>
<tr>
<td><code>StructureDefinition.purpose.matches('A.*B')</code></td>
<td>false</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>However, the specification states that regexes in <code>matches()</code> are considered to use single-line mode, suggesting that a dot should match newlines. Could anybody help out?</p>



<a name="238772898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/238772898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#238772898">(May 14 2021 at 14:11)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="238777023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/238777023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pieter Edelman <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#238777023">(May 14 2021 at 14:38)</a>:</h4>
<p>I think the issue is actually an omission in the implementations. I just raised an issue for the FHIR Validator.</p>



<a name="238830631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/238830631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#238830631">(May 14 2021 at 21:12)</a>:</h4>
<p>the test cases are here: <a href="https://github.com/FHIR/fhir-test-cases/blob/master/r5/fhirpath/tests-fhir-r5.xml">https://github.com/FHIR/fhir-test-cases/blob/master/r5/fhirpath/tests-fhir-r5.xml</a>. Do you want to add a test case that fails?</p>



<a name="239041822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/239041822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pieter Edelman <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#239041822">(May 17 2021 at 06:56)</a>:</h4>
<p>Thanks for the pointer, I'll add the test case.</p>



<a name="239072966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/239072966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pieter Edelman <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#239072966">(May 17 2021 at 11:39)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> I'm not very familiar with Maven, but I believe I managed to add a test case for this issue (not pushed yet). Do you want me to add other test cases for <code>matches()</code> as well while I'm at it?</p>



<a name="239148056"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/239148056" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#239148056">(May 17 2021 at 19:41)</a>:</h4>
<p>sure. the more the better</p>



<a name="239206527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20.matches%28%29%20with%20linebreaks/near/239206527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pieter Edelman <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20.2Ematches().20with.20linebreaks.html#239206527">(May 18 2021 at 06:56)</a>:</h4>
<p>Ok, created a pull request</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
