---
layout: page
title: "FHIR Chat  · filter by postal code · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html">filter by postal code</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="250871840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250871840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250871840">(Aug 27 2021 at 02:20)</a>:</h4>
<p>Hello,</p>
<p>I am trying to filter the resources by the zip code. The scenario is to extract from a FHIR bundle postal codes where value of the postalCode ='44124'. I tried different variations like PractitionerRole.healthcareService.resolve().location.resolve().address.postalCode('44124').value. It didnt work.Then I tried PractitionerRole.healthcareService.resolve().location.resolve().address.postalCode.where(postalCode='44124'). It didn't work.I also tried PractitionerRole.healthcareService.resolve().location.resolve().address.postalCode.(postalCode='44124') , didnt get result. Can somebody please suggest what would be the correct syntaxt to handle this. Thanks in advance. <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="250873251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250873251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250873251">(Aug 27 2021 at 02:26)</a>:</h4>
<p>I think what you want is <code>PractitionerRole.where(healthcareService.resolve().location.resolve().address.postalCode='44124')</code>?</p>



<a name="250873874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250873874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250873874">(Aug 27 2021 at 02:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> , it is bringing the entire PractitionerRole resource back, I simply want to extract the zip code. nothing else</p>



<a name="250873892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250873892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250873892">(Aug 27 2021 at 02:33)</a>:</h4>
<p>how do you mean, 'bringing the whole resource back'. How are you executing the FHIRPath?</p>



<a name="250874083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874083">(Aug 27 2021 at 02:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span>  like this:<br>
{<br>
    "name": "result",<br>
    "resource": {<br>
      "resourceType": "PractitionerRole",<br>
      "id": "1912884",<br>
      "meta": {<br>
        "versionId": "1",<br>
        "lastUpdated": "2021-02-28T22:55:47.367+00:00",<br>
        "source": "#WjJ32gkJCVMoR6YU"<br>
      },<br>
      "active": true,<br>
      "practitioner": {<br>
        "reference": "Practitioner/1912759",<br>
        "type": "Practitioner"<br>
      },<br>
      "organization": {<br>
        "reference": "Organization/1912733",<br>
        "type": "Organization"<br>
      },<br>
      "code": [ {<br>
        "coding": [ {<br>
          "system": "<a href="http://terminology.hl7.org/CodeSystem/practitioner-role">http://terminology.hl7.org/CodeSystem/practitioner-role</a>",<br>
          "code": "doctor"<br>
        } ]<br>
      } ],<br>
      "location": [ {<br>
        "reference": "Location/1912741",<br>
        "type": "Location"<br>
      } ],<br>
      "healthcareService": [ {<br>
        "reference": "HealthcareService/1863096",<br>
        "type": "HealthcareService"<br>
      } ]<br>
    }<br>
  }</p>



<a name="250874116"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874116" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874116">(Aug 27 2021 at 02:37)</a>:</h4>
<p>You want to bring back a zip code that is equal to a string you're passing in?</p>



<a name="250874160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874160">(Aug 27 2021 at 02:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> Yes please</p>



<a name="250874193"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874193" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874193">(Aug 27 2021 at 02:39)</a>:</h4>
<p>example:<br>
{<br>
    "name": "result",<br>
    "valueString": "94538"<br>
  }</p>



<a name="250874195"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874195" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874195">(Aug 27 2021 at 02:39)</a>:</h4>
<p>How does that help?  You'll get back a collection of strings with the value '44124'</p>



<a name="250874291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874291">(Aug 27 2021 at 02:40)</a>:</h4>
<p>trying to extract and export as a report where i have Practioner name which would be a separate fhirpath, practitioner NPI-separate fhirpath and the zip code separate fhirpath</p>



<a name="250874310"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874310" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874310">(Aug 27 2021 at 02:41)</a>:</h4>
<p>But why return the zip code if you're matching for a specific zip code?</p>



<a name="250874428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874428">(Aug 27 2021 at 02:43)</a>:</h4>
<p>Do you just want the zip code(s) regardless of value?  (You'll probably get more than one as there will likely be multiple locations, healthcareservices and addresses)</p>



<a name="250874570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874570">(Aug 27 2021 at 02:46)</a>:</h4>
<p>I was trying to extract a report where the Practitioner name, NPI &amp; zip code are presented to the user. To do so i used the query: PractitionerRole?_profile=http://hl7.org/fhir/us/davinci-pdex-plan-net/StructureDefinition/plannet-PractitionerRole&amp;_include=PractitionerRole:practitioner&amp;_include=PractitionerRole:service&amp;_include:iterate=HealthcareService:location&amp;service.location.address-postalcode=${PostalCode}</p>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>



<a name="250874687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874687">(Aug 27 2021 at 02:47)</a>:</h4>
<p>But as you pinted out - the PractitionerRole had multiple locations.Some of those locations had zip codes other than what was used as input in the query, so I was trying to extract the zip codes that really were used in the query. But I guess u have a point-i can do away with the zip code</p>



<a name="250874854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250874854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250874854">(Aug 27 2021 at 02:50)</a>:</h4>
<p>Just one question though - do you think the query shall work correctly , I am not sure how to ascertain it is filtering only by the input zip code. I tried it on a small sample created by me and it seem to be working though</p>



<a name="250877631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/250877631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#250877631">(Aug 27 2021 at 03:38)</a>:</h4>
<p>First, I don't think you can rely on searching by _profile.  There's no expectation that plan-net compliant PractitionerRole instances will actually declare that profile (or any profile) and _profile will only match on PractitionerRoles that declare the profile, not those that comply (unless you have a server that's pre-emptively testing that).</p>
<p>So you've got the PractitionerRole as well as the HealthCareService and Location, but you're choosing to extract the information using FHIRPath rather than code.  Any particular reason why?</p>



<a name="252828419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/252828419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tushar Nair <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#252828419">(Sep 10 2021 at 18:23)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> apologies for the delayed response, was away for a while. The reason we chose to extract using FHIRPath is because users would like to have the full set of results in one go, rather than navigating through multiple pages. Another reason was scenarios like a Practitioner having multiple practicing location addresses. So basically we tried to extract the data using FHIRPath and then export it as a CSV file so that the user could further perform slide and dice analytics, like importing to excel using vlookup etc.</p>



<a name="252852286"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/filter%20by%20postal%20code/near/252852286" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/filter.20by.20postal.20code.html#252852286">(Sep 10 2021 at 21:19)</a>:</h4>
<p>I'm still not really understanding you're use-case.  You're filtering by postal code and then trying to extract the postal code of <em>other</em> addresses for the same individual?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
