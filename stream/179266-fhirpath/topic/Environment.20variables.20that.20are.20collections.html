---
layout: page
title: "FHIR Chat  · Environment variables that are collections · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Environment.20variables.20that.20are.20collections.html">Environment variables that are collections</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="242104409"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Environment%20variables%20that%20are%20collections/near/242104409" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Environment.20variables.20that.20are.20collections.html#242104409">(Jun 09 2021 at 17:49)</a>:</h4>
<p>Hi! I have a use case where I'm trying to use a List of Encounters as the Environment variable <code>%encounters</code>. In trying to implement the <code>IEvaluationContext</code> interface I discovered that it expects to return a single <code>Base</code> object:</p>
<p><a href="https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-structures-r5/org/hl7/fhir/r5/utils/FHIRPathEngine.IEvaluationContext.html#resolveConstant(java.lang.Object,java.lang.String,boolean)">https://hapifhir.io/hapi-fhir/apidocs/hapi-fhir-structures-r5/org/hl7/fhir/r5/utils/FHIRPathEngine.IEvaluationContext.html#resolveConstant(java.lang.Object,java.lang.String,boolean)</a></p>
<p>I can't find any restriction on the use of collections in FHIRPath in any of the relevant guidance, and in fact it seems that everything should be treated as a collection:</p>
<p><a href="http://hl7.org/fhir/fhirpath.html#vars">http://hl7.org/fhir/fhirpath.html#vars</a></p>
<blockquote>
<p>Note that these tokens are not restricted to simple types,</p>
</blockquote>
<p><a href="http://hl7.org/fhirpath/#collections">http://hl7.org/fhirpath/#collections</a></p>
<blockquote>
<p>Collections are fundamental to FHIRPath, in that the result of every expression is a collection</p>
</blockquote>
<p>Is there a different interface I should be implementing? Or is this an oversight in the <code>IEvaluationContext</code> interface?</p>



<a name="242244763"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Environment%20variables%20that%20are%20collections/near/242244763" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Environment.20variables.20that.20are.20collections.html#242244763">(Jun 10 2021 at 17:48)</a>:</h4>
<p>Is this a question more appropriate for the hapi thread?</p>



<a name="242247000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Environment%20variables%20that%20are%20collections/near/242247000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Environment.20variables.20that.20are.20collections.html#242247000">(Jun 10 2021 at 18:05)</a>:</h4>
<p>Possibly.  I know FHIRPath, but I don't know what IEvaluationContext or Base are.  But, there are probably some people on this stream who do.</p>



<a name="242247451"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Environment%20variables%20that%20are%20collections/near/242247451" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Environment.20variables.20that.20are.20collections.html#242247451">(Jun 10 2021 at 18:09)</a>:</h4>
<p>That makes sense. They are part of the org.hl7.fhir implementation of a FhirPath engine.</p>



<a name="242249498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Environment%20variables%20that%20are%20collections/near/242249498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Environment.20variables.20that.20are.20collections.html#242249498">(Jun 10 2021 at 18:24)</a>:</h4>
<p>it looks like an oversight to me</p>



<a name="242254033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Environment%20variables%20that%20are%20collections/near/242254033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Environment.20variables.20that.20are.20collections.html#242254033">(Jun 10 2021 at 18:57)</a>:</h4>
<p><a href="https://github.com/hapifhir/org.hl7.fhir.core/issues/535">https://github.com/hapifhir/org.hl7.fhir.core/issues/535</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
