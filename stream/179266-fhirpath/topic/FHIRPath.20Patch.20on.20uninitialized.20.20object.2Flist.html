---
layout: page
title: "FHIR Chat  · FHIRPath Patch on uninitialized  object/list · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20Patch.20on.20uninitialized.20.20object.2Flist.html">FHIRPath Patch on uninitialized  object/list</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="263913688"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20Patch%20on%20uninitialized%20%20object/list/near/263913688" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Weaver <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20Patch.20on.20uninitialized.20.20object.2Flist.html#263913688">(Dec 06 2021 at 20:02)</a>:</h4>
<p>Hello! I'm working on a FHIRPath Patch implementation for our FHIR server. I've run into two related use cases where data needs to be added to a resource, but the target object or list isn't initialized. The specification page doesn't address proper behavior for this scenario, so my assumption is that the behavior is left up to the implementer. Is that correct? Also, any input on what the server should do for these scenarios?</p>
<p>JSONPatch specifically calls this out in <a href="https://www.rfc-editor.org/rfc/rfc6902#section-4.1">RFC 6902 4.1</a>. The spec says <em>"However, the object itself or an array containing it does need to exist, and it remains an error for that not to be the case"</em>.</p>
<p>Below are a couple of sample use cases. Thanks for the help!</p>
<p><strong>Use Case 1: Adding a value to a nested object that doesn't exist.</strong><br>
The Patient has an identifier defined without a period. The user wants to be able to expire the identifier. Should the server initialize the <code>period</code> object that doesn't exist on the object or return an error?</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Patient"</span><span class="p">,</span>
    <span class="nt">"identifier"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">"use"</span><span class="p">:</span> <span class="s2">"official"</span><span class="p">,</span>
            <span class="nt">"value"</span><span class="p">:</span> <span class="s2">"123"</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Parameters"</span><span class="p">,</span>
    <span class="nt">"parameter"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"operation"</span><span class="p">,</span>
            <span class="nt">"part"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"type"</span><span class="p">,</span>
                    <span class="nt">"valueCode"</span><span class="p">:</span> <span class="s2">"add"</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"path"</span><span class="p">,</span>
                    <span class="nt">"valueString"</span><span class="p">:</span> <span class="s2">"Patient.identifier.where(use = 'official').period"</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"name"</span><span class="p">,</span>
                    <span class="nt">"valueString"</span><span class="p">:</span> <span class="s2">"end"</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"value"</span><span class="p">,</span>
                    <span class="nt">"valueDate"</span><span class="p">:</span> <span class="s2">"2021-12-01"</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Use Case 2: Inserting a value into a list that doesn't exist.</strong><br>
A Patient resource exists without any identifiers. The user wants to add an identifier to the patient. Should the server initialize the <code>identifier</code> list or return an error?</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Patient"</span>
<span class="p">}</span>
</code></pre></div>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Parameters"</span><span class="p">,</span>
    <span class="nt">"parameter"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"operation"</span><span class="p">,</span>
            <span class="nt">"part"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"type"</span><span class="p">,</span>
                    <span class="nt">"valueCode"</span><span class="p">:</span> <span class="s2">"add"</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"path"</span><span class="p">,</span>
                    <span class="nt">"valueString"</span><span class="p">:</span> <span class="s2">"Patient"</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"name"</span><span class="p">,</span>
                    <span class="nt">"valueString"</span><span class="p">:</span> <span class="s2">"identifier"</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"value"</span><span class="p">,</span>
                    <span class="nt">"valueIdentifier"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://example.org"</span><span class="p">,</span>
                        <span class="nt">"value"</span><span class="p">:</span> <span class="s2">"value 3"</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>



<a name="264384591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/FHIRPath%20Patch%20on%20uninitialized%20%20object/list/near/264384591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mikael Weaver <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/FHIRPath.20Patch.20on.20uninitialized.20.20object.2Flist.html#264384591">(Dec 09 2021 at 23:54)</a>:</h4>
<p>See <a href="#narrow/stream/179166-implementers/topic/FHIRPath.20Patch.20on.20uninitialized.20object.2Flist">the orig thread</a> for the answer</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
