---
layout: page
title: "FHIR Chat  · Paths for choice types · fhirpath"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/index.html">fhirpath</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html">Paths for choice types</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="164971778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164971778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164971778">(May 06 2019 at 10:48)</a>:</h4>
<p>Given the following:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;Observation&quot;</span><span class="p">,</span>
  <span class="nt">&quot;valueQuantity&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span>
    <span class="nt">&quot;unit&quot;</span><span class="p">:</span> <span class="s2">&quot;breaths/minute&quot;</span><span class="p">,</span>
    <span class="nt">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;http://unitsofmeasure.org&quot;</span><span class="p">,</span>
    <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;/min&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>The FHIR spec says I can use <code>Observation.value</code> or <code>(Observation.value as Quantity)</code> to refer to the value.</p>
<p>Question: Can we use <code>Observation.valueQuantity</code> as well?</p>



<a name="164972127"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164972127" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164972127">(May 06 2019 at 10:54)</a>:</h4>
<p>not in FHIRPath, no</p>



<a name="164982826"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164982826" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164982826">(May 06 2019 at 13:49)</a>:</h4>
<p>fhirpath.js does not handle that yet, and still would use valueQuantity. The difficult part about ".value" is that fhirpath.js has no knowledge of FHIR types, so when it loads a JSON resource and sees the key "valueQuantity", it does not have a way to know that that should be changed to "value".  In order to make that work, I think we will need to add some limited knowledge of the common polymorphic keys in FHIR.</p>



<a name="164983025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164983025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164983025">(May 06 2019 at 13:51)</a>:</h4>
<p>you are guaranteed that .value[x] will never have a sibling .valueXX so that there is any ambiguity</p>



<a name="164983111"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164983111" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164983111">(May 06 2019 at 13:52)</a>:</h4>
<p>so you shouldn't need any metadata insight to make that work</p>



<a name="164983398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164983398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164983398">(May 06 2019 at 13:56)</a>:</h4>
<p>From fhirpath.js' perspective, "valueQuantity" has no more meaning than a key like "abc".  I suppose if it knew a few basic FHIR types (Quanntity, Attachment, Reference), it could detect that "zzzQuantity" was meant to be a polymorphic value "zzz".</p>



<a name="164983596"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164983596" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164983596">(May 06 2019 at 13:58)</a>:</h4>
<p>yes. if you have a request for [N} and you don't find [N] but you do find [N]{T} where {T} is from the list below, then it's a match</p>



<a name="164983601"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164983601" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164983601">(May 06 2019 at 13:58)</a>:</h4>
<p>the list is:</p>



<a name="164983699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164983699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164983699">(May 06 2019 at 13:59)</a>:</h4>
<p>Address<br>
Age<br>
Annotation<br>
Attachment<br>
Base64Binary<br>
Boolean<br>
Canonical<br>
Code<br>
CodeableConcept<br>
Coding<br>
ContactDetail<br>
ContactPoint<br>
Contributor<br>
Count<br>
DataRequirement<br>
Date<br>
DateTime<br>
Decimal<br>
Distance<br>
Dosage<br>
Duration<br>
Expression<br>
HumanName<br>
Id<br>
Identifier<br>
Instant<br>
Integer<br>
Markdown<br>
Money<br>
Oid<br>
ParameterDefinition<br>
Period<br>
PositiveInt<br>
Quantity<br>
Range<br>
Ratio<br>
Reference<br>
RelatedArtifact<br>
SampledData<br>
Signature<br>
String<br>
Time<br>
Timing<br>
TriggerDefinition<br>
UnsignedInt<br>
Uri<br>
Url<br>
UsageContext<br>
Uuid</p>



<a name="164983701"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164983701" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164983701">(May 06 2019 at 14:00)</a>:</h4>
<p>that works across all versions</p>



<a name="164984191"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164984191" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164984191">(May 06 2019 at 14:05)</a>:</h4>
<p>If FHIRPath is meant to be an language that is independent of FHIR, should it include so much knowledge of FHIR?   I guess since FHIRPath is probably only used with FHIR, it is acceptable-- maybe it could include that type list as an override-able default.</p>



<a name="164984684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/164984684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#164984684">(May 06 2019 at 14:11)</a>:</h4>
<p>you are here asking a question about how the language binds to FHIR, not about the language itself. And so you get a FHIR specific answer</p>



<a name="165017614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165017614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165017614">(May 06 2019 at 20:48)</a>:</h4>
<p>i still think postfix notation in fhir json is a mistake :) this is one of illustration</p>



<a name="165017678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165017678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165017678">(May 06 2019 at 20:49)</a>:</h4>
<p>but yeah  we can put some fhir-hacks  to make it work</p>



<a name="165017838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165017838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165017838">(May 06 2019 at 20:51)</a>:</h4>
<p>or  can force always use <code>x as Type =&gt; xType</code></p>



<a name="165649094"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165649094" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165649094">(May 14 2019 at 18:37)</a>:</h4>
<p>The rule to check the trailing text won't always work. As there are a few cases where this transform doesn't happen<br>
e.g. <a href="http://build.fhir.org/medicationadministration.html#MedicationAdministration" target="_blank" title="http://build.fhir.org/medicationadministration.html#MedicationAdministration">http://build.fhir.org/medicationadministration.html#MedicationAdministration</a><br>
the pair of instantiates properties. There are others, this was the first that I found.</p>



<a name="165854526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165854526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165854526">(May 16 2019 at 22:25)</a>:</h4>
<p>is it a problem?</p>



<a name="165905619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165905619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165905619">(May 17 2019 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Yes, it is a problem in that it means that the light-weight solution you proposed for handling polymorphic fields would not work.  In Brian's example, you would not want to replace "instantiatesCanonical" with "instantiates".</p>



<a name="165941630"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165941630" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165941630">(May 17 2019 at 22:24)</a>:</h4>
<p>well, why is that a problem? I think that is the intent here. It's on my list to get agreement to recast all of those as instantiates[x] : canonical | url</p>



<a name="165941690"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165941690" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165941690">(May 17 2019 at 22:25)</a>:</h4>
<p>Oh-- in that case maybe it isn't a problem.  <span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> ?</p>



<a name="165946643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165946643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165946643">(May 18 2019 at 00:00)</a>:</h4>
<p>My point was the example I gave wasn't a choice type, so shouldn't be changing over to use just value. So the simple trailing type can't always be trimmed/assumed.<br>
Even though in the future this specific case will be fixed to be a choice type.</p>



<a name="165946664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165946664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165946664">(May 18 2019 at 00:00)</a>:</h4>
<p>well, what's the harm in treating it as a choice type now?</p>



<a name="165946680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165946680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165946680">(May 18 2019 at 00:01)</a>:</h4>
<p>There were other cases, but I'll have to go find them.</p>



<a name="165946687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165946687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165946687">(May 18 2019 at 00:01)</a>:</h4>
<p>It's about knowing when to do it.</p>



<a name="165947031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165947031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165947031">(May 18 2019 at 00:08)</a>:</h4>
<p>It was also the point that I believe you were saying that you can't include the type in the field.</p>



<a name="165952979"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179266-fhirpath/topic/Paths%20for%20choice%20types/near/165952979" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179266-fhirpath/topic/Paths.20for.20choice.20types.html#165952979">(May 18 2019 at 02:28)</a>:</h4>
<p>hmm yes that's problematic. Might need some special case exemptions, I'm afraid.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
