---
layout: page
title: "FHIR Chat  · Consent Service · Security and Privacy"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/index.html">Security and Privacy</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html">Consent Service</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="167851905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167851905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167851905">(Jun 11 2019 at 13:55)</a>:</h4>
<p>At the San Antonio WGM tooling meeting (I hope I'm getting the timeline right..) <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> proposed a generic user-implementable API that would allow a developer to implement a consent service on top of a FHIR repository. The motivation was to create a fairly low-level API that is flexible and powerful enough that it could be used by developers to implement anyone's notion of consent. I.e. it makes on assumptions on how a Consent resource (or consent directives more generally) should be interpreted, but provides the infrastructure so that someone could write that interpretation in code and have it enforced by the server.</p>
<p>In case it's of interest, at DevDays today I'm going to touch briefly on a new proof-of-concept implementation of this that is being added to HAPI FHIR.</p>
<p>This is the user visible API that implementers would have to implement:<br>
<a href="https://github.com/jamesagnew/hapi-fhir/blob/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent/IConsentService.java" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/blob/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent/IConsentService.java">https://github.com/jamesagnew/hapi-fhir/blob/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent/IConsentService.java</a></p>
<p>The rest of the user API (but not hapi's internal implementation of the API) lives in here: <a href="https://github.com/jamesagnew/hapi-fhir/tree/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/tree/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent">https://github.com/jamesagnew/hapi-fhir/tree/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent</a></p>
<p>This is very much a work in progress, but it does work. I have testing consent service implementations that block specific user access, do data masking, create audit records, etc.</p>
<p>I'm hoping to spur some feedback on the API, shortcomings, suggestions, etc.</p>



<a name="167854187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167854187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167854187">(Jun 11 2019 at 14:18)</a>:</h4>
<p>Session details <a href="https://www.devdays.com/us/schedule/#event-234" target="_blank" title="https://www.devdays.com/us/schedule/#event-234">https://www.devdays.com/us/schedule/#event-234</a> -- 10:30a in St Helen's</p>



<a name="167857897"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167857897" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167857897">(Jun 11 2019 at 14:56)</a>:</h4>
<p>Can I get a copy of the presentation?</p>



<a name="167861324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167861324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167861324">(Jun 11 2019 at 15:33)</a>:</h4>
<p>Sure thing, will post afterward. The consent stuff is literally only 4 slides, but hey. :)</p>



<a name="167861529"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167861529" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167861529">(Jun 11 2019 at 15:35)</a>:</h4>
<p>I have a few discovered things to extend the API with. Will get back to it</p>



<a name="167868495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167868495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167868495">(Jun 11 2019 at 16:53)</a>:</h4>
<p>Does </p>
<p><em><a href="https://github.com/jamesagnew/hapi-fhir/blob/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent/ConsentInterceptor.java#L65" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/blob/ja_consent_svc/hapi-fhir-server/src/main/java/ca/uhn/fhir/rest/server/interceptor/consent/ConsentInterceptor.java#L65">thePreResourceAccessDetails.setDontReturnResourceAtIndex(i);</a></em></p>
<p>mean that fewer than <code>_count</code> resources (maybe even zero) would get returned, or is there logic somewhere to go fetch more results from the db as individual search results are redacted from the response bundle?  <span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="167868632"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167868632" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167868632">(Jun 11 2019 at 16:55)</a>:</h4>
<p>Also, I was expecting to see something about <code>Consent</code> resources in this interface, but I guess this is at a different level of abstraction (and any given interceptor might look up some Consent resources to define its policy... or not).</p>



<a name="167877880"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167877880" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167877880">(Jun 11 2019 at 18:39)</a>:</h4>
<p>yes the consent resources are implicit in this interface - one assumes that implementations track and load consent resources as appropriate</p>



<a name="167891647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167891647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167891647">(Jun 11 2019 at 21:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> re. count: that is a fun topic. One of the differences between my API and the one Grahame proposed is that i've split the concept of "seeResource" into two concepts, roughly called "canSeeResource" and "aboutToSeeResource".</p>
<p>The former is a simple boolean question, and the idea is that it happens before pages are calculated. The idea there is that if you ask for <code>_count=10</code>, you should get a page of 10 back unless you've exhausted all possible resources. This probably has a measurable negative impact on performance, but also means that it's possible to block resources without the user being able to detect whether any data was blocked.</p>



<a name="167891683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167891683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167891683">(Jun 11 2019 at 21:23)</a>:</h4>
<p>And yeah, the assumption I'm making is that if Consent resources are a part of your consent infrastructure (and they probably are), you load them in the first method.</p>



<a name="167892825"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167892825" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167892825">(Jun 11 2019 at 21:39)</a>:</h4>
<p>Oh, and <span class="user-mention" data-user-id="192587">@David Pyke</span>, here are the slides: <a href="https://docs.google.com/presentation/d/1rp7g7n3OXvjoU4qmMhEWEFW-3Csag-gdh4g16y139So" target="_blank" title="https://docs.google.com/presentation/d/1rp7g7n3OXvjoU4qmMhEWEFW-3Csag-gdh4g16y139So">https://docs.google.com/presentation/d/1rp7g7n3OXvjoU4qmMhEWEFW-3Csag-gdh4g16y139So</a></p>



<a name="167942726"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Consent%20Service/near/167942726" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Consent.20Service.html#167942726">(Jun 12 2019 at 12:49)</a>:</h4>
<p>Nicely done. I look forward to deeper details to be understood.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
