---
layout: page
title: "FHIR Chat  · Bundle.signature · Security and Privacy"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/index.html">Security and Privacy</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html">Bundle.signature</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="254759981"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/254759981" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#254759981">(Sep 24 2021 at 19:34)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span>  I read your blog and the ihe spec and am still confused how to apply it Bundle.signature.   It sounds like a digitally signed jws will have copy of the bundle minus the signature embedded right in the bundle.  Am I correct?  Am I missing something ?</p>



<a name="254769923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/254769923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#254769923">(Sep 24 2021 at 20:46)</a>:</h4>
<p>you do not apply it to Bundle.signature. It is a totally different DocumentReference that points at the signature "document", and that has a relationship to the DocumentReference that points at the FHIR-Document. The FHIR-Document does not have a Bundle.signature element..... This is the strength of this method. Given that it is a WHOLE signature, there is no blindspots. When you have an element inside the signed thing, like Bundle.signature, you must use stylesheets to exclude the bundle.signature element from the signature, thus ANY CHANGE TO THE Bundle.signature in the future are NOT detectable. This includes stuffing in extensions.</p>



<a name="254770790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/254770790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#254770790">(Sep 24 2021 at 20:52)</a>:</h4>
<p>So the docref is exchanged ?</p>



<a name="254771027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/254771027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#254771027">(Sep 24 2021 at 20:54)</a>:</h4>
<p>As in I want x (ccd,resource, FHIR document,etc) and the response is a docref?</p>



<a name="254771294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/254771294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#254771294">(Sep 24 2021 at 20:57)</a>:</h4>
<p>Which points to a JWS which wraps the thing you want?</p>



<a name="255034787"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255034787" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255034787">(Sep 27 2021 at 11:54)</a>:</h4>
<p>You are searching for clinical documents, searching on DocumentReference for some use-case. You end up with a clinical document, that you are wondering about signatures. At this point you have the clinical document <a href="http://DocumentReference.id">DocumentReference.id</a>.  So you then search for DocumentReference with a .relatesTo.target equal to that id (and a .relatesTo.code of signs). Now you have the signature document of the clinical document. The signature document is nothing but the signature, which in the cryptographically protected signature blob is also the indicators of the document, who signed, why they signed, when they signed, method of signature, etc). Two different documentReference, but related. The lifecycle of the clinical document is independent of the lifecycle of the signature. The clinical document will exist well before it is signed. The signature does not change the clinical document. Anyone not caring about the signature just uses the clinical document and is not bothered by the overhead of any signature (which is 99.999% of all uses of data, no one cares to confirm a signature, it is there when some legal action happens.)</p>



<a name="255095463"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255095463" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255095463">(Sep 27 2021 at 18:20)</a>:</h4>
<p>Why not just exchange the signed thing</p>



<a name="255095847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255095847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255095847">(Sep 27 2021 at 18:21)</a>:</h4>
<p>Let the receiver use the document as they want?  With the understanding It is no longer attested by the signer when they do?</p>



<a name="255102251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255102251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255102251">(Sep 27 2021 at 19:02)</a>:</h4>
<p>in a push case, you might choose to push the signature too... sure.</p>



<a name="255105752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255105752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255105752">(Sep 27 2021 at 19:26)</a>:</h4>
<p>in a REST, those that need the signature can find it. most don't need to be bothered with it.</p>



<a name="255147248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255147248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255147248">(Sep 28 2021 at 01:27)</a>:</h4>
<p>I appreciate your input , but I don't understand what you mean exactly by "in a REST, those that need the signature can find it. most don't need to be bothered with it.".   In CDEX we have a use case for 'signatures required"  and you commented on it here...</p>
<p><a href="https://confluence.hl7.org/display/DVP/Signature+Option+per+Use+Case">https://confluence.hl7.org/display/DVP/Signature+Option+per+Use+Case</a></p>
<p>We assume the digital Sig is needed and are proposing using a FHIR document bundle or search bundle with the signature element.  We will need to document how to do this.   Thing is, after digging into it, I was unable to even start to describe how the technical pieces work based on what we decided for CDEX for the new stuff.  Namely the similar questions to those Josh asked on the other stream.   For example Here are my issues:</p>
<ol>
<li>the payload for the signature has to be the bundle without the signature element</li>
<li>the signature payload ("copy1") is a purportedly a copy of the bundle ("copy2") without the signature element... so now we have two copies exchanged over the wire</li>
<li>Upon receipt you would have to check if copy1 and copy2 are the same?<br>
      1. What if copy1 and copy2 are not the same?   do you use copy1?</li>
</ol>



<a name="255147714"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255147714" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255147714">(Sep 28 2021 at 01:32)</a>:</h4>
<p>To sign the document, you run the document through the canonicalization algorithm and calculate the signature, then affix the signature to the Bundle.  The recipient receives one Bundle.  They remove the signature (in memory), run the canonicalization algorithm and check the result against the provided signature.  There are no copies exchanged or persisted, just a temporary copy made in memory to strip the signature and run the canonicalization process.</p>



<a name="255147717"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255147717" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255147717">(Sep 28 2021 at 01:32)</a>:</h4>
<p>If I understand it correclty, I think the envelope solution you mentioned avoids these issues so if you get around to suing or being sued it seems this would be clear what was exchanged.   I'm sure there are other tradeoffs.</p>



<a name="255148539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255148539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255148539">(Sep 28 2021 at 01:45)</a>:</h4>
<blockquote>
<p>Element Id Bundle.signature<br>
Definition <br>
Digital Signature - base64 encoded. XML-DSig or a JWT.</p>
</blockquote>
<p>A signed JWT is composed of three elements: the header, <strong>the payload</strong>, and the signature</p>
<p>I understand the payload to be  "the  canonicalized bundle" which is essential the official the copy of the bundle being exchanged.</p>



<a name="255148642"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255148642" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255148642">(Sep 28 2021 at 01:46)</a>:</h4>
<p>Usually you would sign a hash of the payload, not the whole payload.  There's zero reason to re-transmit the whole thing...</p>



<a name="255148651"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255148651" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255148651">(Sep 28 2021 at 01:46)</a>:</h4>
<p>and as an aside apart from the fhir specification, I have been unable to locate any  guidance on how exactly this is done or examples</p>



<a name="255148937"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255148937" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255148937">(Sep 28 2021 at 01:50)</a>:</h4>
<p>aha...a hash makes more sense... I still like John's envelope solution</p>



<a name="255149287"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255149287" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255149287">(Sep 28 2021 at 01:56)</a>:</h4>
<p>... what we have proposed and what Josh is proposing for resources are disparate solutions for similar if not the same problem.</p>



<a name="255149729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255149729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255149729">(Sep 28 2021 at 02:01)</a>:</h4>
<p>A Bundle <em>is</em> and envelope.  We don't want to create any more layers than are strictly necessary.  We want to transmit the data that would normally be transmitted.  Many systems will totally ignore the signature, so the mode of transmission can't be changed by whether or not a signature happens to be affixed.</p>



<a name="255150481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255150481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255150481">(Sep 28 2021 at 02:12)</a>:</h4>
<p>I understand those tradeoffs but we are already proposing a lot of other tradeoffs too.   Besides we agreed that  the default is unsigned data and signature is upon request so the requester would be prepared for it.  right?</p>



<a name="255153664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255153664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255153664">(Sep 28 2021 at 02:57)</a>:</h4>
<p>For the signed documents, yes.  For the query responses, no - though there might be pre-negotiation.  Also, for query responses, there's no option other than to return a regular query response - returning anything else would be non-conformant.  There's zero reason to have an extra wrapper layer here.</p>



<a name="255156429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255156429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255156429">(Sep 28 2021 at 03:38)</a>:</h4>
<p>other options discussed</p>
<ul>
<li>contained Provenance/resource</li>
<li><a href="http://meta.security/resource">meta.security/resource</a></li>
<li>http signature header/transaction</li>
</ul>



<a name="255210858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255210858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255210858">(Sep 28 2021 at 12:54)</a>:</h4>
<p>For JWS, keep in mind that a payload can be attached or detached <span class="user-mention" data-user-id="191401">@Eric Haas</span></p>



<a name="255226541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255226541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255226541">(Sep 28 2021 at 14:32)</a>:</h4>
<p>It's a Bundle - either a searchset or a document.  Bundle has Bundle.signature.  That's what it's for.  I don't understand why we'd be looking for alternatives?</p>



<a name="255243718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255243718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255243718">(Sep 28 2021 at 16:13)</a>:</h4>
<ol>
<li>The existing Bundle.signature element and datatype has some significant issues that Josh has pointed out ... Maybe I am paranoid, but those who implement the spec are going to be faced these same issues and ask similar questions so is best to anticipate them.</li>
<li>We are creating bundles for the purpose of adding signatures.  I think we need to justify this approach and consider the alternatives.</li>
</ol>



<a name="255252265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255252265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255252265">(Sep 28 2021 at 17:04)</a>:</h4>
<p>there is much mixing solutions in this thread. It seems Lloyd wants to not discuss anything except Bundle.signature. so, Lloyd is fully correct in how that works. But, that leaves room for malicious insertion in the Bundle.signature element, in addition to anywhere else that the canonicalization has excluded.</p>



<a name="255252431"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255252431" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255252431">(Sep 28 2021 at 17:06)</a>:</h4>
<p>As to Search Sets... are we talking about synchronous return of a search set from a http GET/POST search request? If so, then what is wrong with the authenticity and integrity protection that the TLS provides? It is a form of signature, by the server, for the purpose of communicating results, at that instant in time.</p>



<a name="255252652"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255252652" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255252652">(Sep 28 2021 at 17:07)</a>:</h4>
<p>or are we talking about Search Sets as persisted Bundles? -- aka a document (note lowercase 'd', not to be confused with HL7 definition of a Document)... but certainly within the scope of documentReference resource.</p>



<a name="255252877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255252877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255252877">(Sep 28 2021 at 17:08)</a>:</h4>
<p>With Lloyds focus on <a href="http://Bundle.security">Bundle.security</a>... is this signature going to include both encodings? That is a signature for the FHIR xml encoding, and a signature for the FHIR json encoding? Is that signature going to be in JWS form, XML-Signature form, or something else?... or is it going to be ALL of the above, just to be sure.</p>



<a name="255260582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255260582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255260582">(Sep 28 2021 at 17:14)</a>:</h4>
<p>note, that last question applies to all forms of signature, not specific to Lloyds focus on Bundle.signature</p>



<a name="255262318"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255262318" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255262318">(Sep 28 2021 at 17:24)</a>:</h4>
<p>Insertion of elements in the Bundle.signature element that aren't signed doesn't much matter.  We can just highlight the issue and indicate that they SHALL be ignored if a digital signature is present.  Alternatively, we could define a canonicalization that signs everything except the <a href="http://Signature.data">Signature.data</a></p>
<p>The requirement for search-set signatures is the need to be able to persist the search-set with a non-repudiatable proof that might not come into play for years.  TLS allows you to verify that something hasn't changed in transit, but doesn't give you a token that you can use years later to prove what came over the wire.  We don't know (or care) how the receiving system stores the search-set Bundle, only that they receive it as a regular search set.  There's zero expectation that the stored search set will be available for subsequent query.  It'll only see the light of day if lawyers need to be involved.</p>
<p>Da Vinci is talking about standardizing on JSON, but until they do so, presumably we'd need to support both forms of signature - and a system that requests the data in a syntax other than was used would need to convert it before canonicalizing and verifying the signature.  That's a decision we'll need to land on as a project.</p>



<a name="255263673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255263673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255263673">(Sep 28 2021 at 17:32)</a>:</h4>
<p>the search-set signature sounds like a recipient responsibility. It will be received as protected by TLS, it is up to local requirements to further protect it. One method might be to have an import Provenance created that cover it. Would seem the interoperability requirement is satisfied by TLS.</p>



<a name="255263893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255263893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255263893">(Sep 28 2021 at 17:33)</a>:</h4>
<p>Yes, one mitigation for the risk of insertions is to REQUIRE everyone, regardless of if they care about signatures, to ignore/blank the Bundle.signature element. Anyone not explicitly ignoring it, could be duped into using data they "presume" is authentic.</p>



<a name="255840794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255840794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255840794">(Oct 02 2021 at 04:40)</a>:</h4>
<p>The <a href="http://hl7.org/fhir/datatypes.html#JSON">JSON Signature rules</a> specified in the FHIR specification  has this bullet which I don't understand:</p>
<blockquote>
<ul>
<li>The Signature <strong>SHALL</strong> include a "CommitmentTypeIndication" element for the Purpose(s) of Signature. The Purpose can be the action being attested to, or the role associated with the signature. The value shall come from ASTM E1762-95(2013). The <code>Signature.type</code> shall contain the same values as the CommitmentTypeIndication element.</li>
</ul>
</blockquote>
<p>does it mean there  is a CommitmentTypeIndication" element for the Purpose(s) of Signature in the JWS itself?  if so where would that go?</p>



<a name="255840820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255840820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255840820">(Oct 02 2021 at 04:41)</a>:</h4>
<p>should is say the FHIR Signature element SHALL ... ?</p>



<a name="255868707"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255868707" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255868707">(Oct 02 2021 at 12:44)</a>:</h4>
<p>it was aspirational that someone would define this element in terms of JWS. Since that time there is now a a ETSI standard for long term JSON signature, a profile on JWS - <a href="https://www.sciencedirect.com/science/article/abs/pii/S0920548919300960">https://www.sciencedirect.com/science/article/abs/pii/S0920548919300960</a></p>



<a name="255868770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255868770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255868770">(Oct 02 2021 at 12:45)</a>:</h4>
<p><a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf</a></p>



<a name="255868953"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255868953" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255868953">(Oct 02 2021 at 12:49)</a>:</h4>
<p>that defines the purpose of signature is within a JAdES tag "srCms"</p>



<a name="255869067"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255869067" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255869067">(Oct 02 2021 at 12:50)</a>:</h4>
<p>so this specification is the JSON signature equivalent of the XaDES that we specify for XML-Signature. These ETSI specifications are Implementation Guides for specific use-cases of digital signature. In EU and Asia they are required by regulation.</p>



<a name="255869238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Bundle.signature/near/255869238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Bundle.2Esignature.html#255869238">(Oct 02 2021 at 12:53)</a>:</h4>
<p>Would like to have someone review this specification for applicability to FHIR Signature.    Better to use standards developed by experts, than to invent them. Especially when those experts are experts in digital signatures, and we are not.  -- but, I have not had time to fully review this JAdES specification (it was just published in March 2021).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
