---
layout: page
title: "FHIR Chat  · AuditEvent pattern for POST search · Security and Privacy"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/index.html">Security and Privacy</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html">AuditEvent pattern for POST search</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="221545082"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/221545082" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#221545082">(Jan 04 2021 at 16:25)</a>:</h4>
<p>The security WG has a CR <a href="https://jira.hl7.org/browse/FHIR-26938">https://jira.hl7.org/browse/FHIR-26938</a>  that is asking us to define a pattern for auditEvent when recording a POST based search. I would rather define something that is in use, than define something no one has implemented.</p>



<a name="221548484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/221548484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#221548484">(Jan 04 2021 at 16:50)</a>:</h4>
<p>Would seem the post body is simple enough to record in the query element. Does someone have an example?</p>



<a name="222248730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222248730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222248730">(Jan 10 2021 at 23:54)</a>:</h4>
<p>Need both the URL and the post body (as can have parameters in both places, and the base URL would indicate which operation, or resource type)<br>
I've also added notes into the Jira ticket too.</p>



<a name="222297801"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222297801" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222297801">(Jan 11 2021 at 13:42)</a>:</h4>
<p>yes, seems even with a GET query, one does need to preserve the http headers. So, is there already a definition of how one combines the URL and http headers (and body for POST) into a blob?</p>



<a name="222418110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222418110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222418110">(Jan 12 2021 at 11:21)</a>:</h4>
<p>I'd be interested to know.</p>



<a name="222418121"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222418121" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222418121">(Jan 12 2021 at 11:21)</a>:</h4>
<p>For my server, I'd only log a few specific headers.</p>



<a name="222429148"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222429148" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222429148">(Jan 12 2021 at 13:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span>  what do you log? as is typical for FHIR and for Implementation Guides, they tend to start with what is currently done.</p>



<a name="222468062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222468062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222468062">(Jan 12 2021 at 17:44)</a>:</h4>
<p>Our auditevents looks the same regardless of the FHIR query being done as GET or POST</p>



<a name="222468135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222468135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222468135">(Jan 12 2021 at 17:45)</a>:</h4>
<p>They are semantically equal</p>



<a name="222468311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222468311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222468311">(Jan 12 2021 at 17:46)</a>:</h4>
<p>so... what do they look like?</p>



<a name="222468565"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222468565" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222468565">(Jan 12 2021 at 17:48)</a>:</h4>
<p>Ill find an example for you tomorrow</p>



<a name="222508915"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222508915" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222508915">(Jan 12 2021 at 23:05)</a>:</h4>
<p>Here's a rough one</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"AuditEvent"</span><span class="p">,</span>
  <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"f1df2bacce8e4c4198e12a90f3a7197c"</span><span class="p">,</span>
  <span class="nt">"meta"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"versionId"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span>
    <span class="nt">"lastUpdated"</span><span class="p">:</span> <span class="s2">"2020-12-18T14:14:01.6713288+11:00"</span>
  <span class="p">},</span>
  <span class="nt">"extension"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"http://fhir.example-org.com.au/StructureDefinition/TimeTaken"</span><span class="p">,</span>
      <span class="nt">"valueDecimal"</span><span class="p">:</span> <span class="mf">7.45</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"http://fhir.example-org.com.au/StructureDefinition/X_CorrelationId"</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"type"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/audit-event-type"</span><span class="p">,</span>
    <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"rest"</span>
  <span class="p">},</span>
  <span class="nt">"action"</span><span class="p">:</span> <span class="s2">"R"</span><span class="p">,</span>
  <span class="nt">"recorded"</span><span class="p">:</span> <span class="s2">"2020-12-18T03:14:01.6539829+00:00"</span><span class="p">,</span>
  <span class="nt">"outcome"</span><span class="p">:</span> <span class="s2">"0"</span><span class="p">,</span>
  <span class="nt">"_outcome"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"extension"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"http://fhir.example-org.com.au/StructureDefinittion/httpstatus"</span><span class="p">,</span>
        <span class="nt">"valueInteger"</span><span class="p">:</span> <span class="mi">200</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="nt">"agent"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"who"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"reference"</span><span class="p">:</span> <span class="s2">"Organization/2bfe6cfc-38e5-4b84-a4d9-efaebabe110b"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Generic Medicines"</span>
      <span class="p">},</span>
      <span class="nt">"altId"</span><span class="p">:</span> <span class="s2">"mvf_client_id"</span><span class="p">,</span>
      <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"Generic Medicines"</span><span class="p">,</span>
      <span class="nt">"requestor"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nt">"network"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"address"</span><span class="p">:</span> <span class="s2">"::1"</span><span class="p">,</span>
        <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"2"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"site"</span><span class="p">:</span> <span class="s2">"Development"</span><span class="p">,</span>
    <span class="nt">"observer"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"HCX-LP-1303"</span>
    <span class="p">},</span>
    <span class="nt">"type"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/security-source-type"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"3"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Web Server"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="nt">"entity"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"role"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/object-role"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"24"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Query"</span>
      <span class="p">},</span>
      <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"http://localhost:2483/Patient?_id=3d03619fefa74dae93ce0d93c65b2803&amp;given=Jonathan&amp;family=Curt"</span><span class="p">,</span>
      <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"Search Patient - Total: 1   Entries: 1"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"what"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"reference"</span><span class="p">:</span> <span class="s2">"Patient/3d03619fefa74dae93ce0d93c65b2803"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Curt, Jonathan Mr"</span>
      <span class="p">},</span>
      <span class="nt">"role"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/object-role"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Patient"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>(yes I know it's not valid as has some missing values, but is in development build)<br>
And happy to get feedback if I have some of these values wrong.<br>
Note that we extract the patient ID from the query parameter, and put that into the entities so that the searching for that patient's content comes up in the audit searching by that patient ID - this is also done on other things like MedReq searching by Patient ID.</p>



<a name="222516854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222516854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222516854">(Jan 13 2021 at 00:42)</a>:</h4>
<p>so that looks like an audit of a GET, not a POST... and properly what you have in entity[0].name should really be in entity[0].query. </p>
<p>I am noticing that even this is missing information like the mime-type negotiation...</p>



<a name="222520983"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222520983" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222520983">(Jan 13 2021 at 01:35)</a>:</h4>
<p>do you have a FHIR server available that is configured to auto record AuditEvents for REST (and possibly transactions)?</p>



<a name="222566520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222566520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222566520">(Jan 13 2021 at 11:27)</a>:</h4>
<p>GET</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;AuditEvent&quot;,
    &quot;type&quot;: {
        &quot;system&quot;: &quot;http://hl7.org/fhir/audit-event-type&quot;,
        &quot;code&quot;: &quot;rest&quot;,
        &quot;display&quot;: &quot;RESTful Operation&quot;
    },
    &quot;subtype&quot;: [
        {
            &quot;system&quot;: &quot;http://hl7.org/fhir/restful-interaction&quot;,
            &quot;code&quot;: &quot;search-type&quot;
        }
    ],
    &quot;action&quot;: &quot;R&quot;,
    &quot;recorded&quot;: &quot;2021-01-13T12:21:12.303+01:00&quot;,
    &quot;outcome&quot;: &quot;0&quot;,
    &quot;outcomeDesc&quot;: &quot;Patient&quot;,
    &quot;purposeOfEvent&quot;: [
        {
            &quot;coding&quot;: [
                {
                    &quot;system&quot;: &quot;http://ehealth.sundhed.dk/fhir/PurposeOfUse&quot;,
                    &quot;code&quot;: &quot;INTERNAL_AUDIT_ONLY&quot;
                }
            ]
        }
    ],
    &quot;agent&quot;: [
        {
            &quot;extension&quot;: [
                {
                    &quot;url&quot;: &quot;http://ehealth.sundhed.dk/fhir/StructureDefinition/ehealth-responsibleOrganization&quot;,
                    &quot;valueReference&quot;: {
                        &quot;reference&quot;: &quot;https://organization.fut.trifork.com/fhir/Organization/33405&quot;
                    }
                }
            ],
            &quot;userId&quot;: {
                &quot;system&quot;: &quot;http://ehealth.sundhed.dk&quot;,
                &quot;value&quot;: &quot;https://organization.fut.trifork.com/fhir/Practitioner/107950&quot;
            },
            &quot;requestor&quot;: true
        }
    ],
    &quot;source&quot;: {
        &quot;identifier&quot;: {
            &quot;system&quot;: &quot;http://ehealth.sundhed.dk&quot;,
            &quot;value&quot;: &quot;http://localhost:8080/fhir/&quot;
        },
        &quot;type&quot;: [
            {
                &quot;system&quot;: &quot;http://hl7.org/fhir/security-source-type&quot;,
                &quot;code&quot;: &quot;4&quot;
            }
        ]
    },
    &quot;entity&quot;: [
        {
            &quot;identifier&quot;: {
                &quot;value&quot;: &quot;f7ded3e5-6db7-42de-ba30-65cd8d0b4015&quot;
            },
            &quot;type&quot;: {
                &quot;system&quot;: &quot;http://hl7.org/fhir/security-source-type&quot;,
                &quot;code&quot;: &quot;4&quot;,
                &quot;display&quot;: &quot;Application Server&quot;
            },
            &quot;role&quot;: {
                &quot;system&quot;: &quot;http://hl7.org/fhir/object-role&quot;,
                &quot;code&quot;: &quot;24&quot;,
                &quot;display&quot;: &quot;Query&quot;
            },
            &quot;description&quot;: &quot;search entity&quot;,
            &quot;query&quot;: &quot;eyJfaWQiOlsiMTExIl19&quot;
        },
        {
            &quot;reference&quot;: {
                &quot;reference&quot;: &quot;http://localhost:8080/fhir/Patient/111&quot;
            },
            &quot;role&quot;: {
                &quot;system&quot;: &quot;http://hl7.org/fhir/object-role&quot;,
                &quot;code&quot;: &quot;1&quot;
            }
        }
    ]
}
</code></pre></div>



<a name="222566547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222566547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222566547">(Jan 13 2021 at 11:27)</a>:</h4>
<p>POST</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;AuditEvent&quot;,
    &quot;type&quot;: {
        &quot;system&quot;: &quot;http://hl7.org/fhir/audit-event-type&quot;,
        &quot;code&quot;: &quot;rest&quot;,
        &quot;display&quot;: &quot;RESTful Operation&quot;
    },
    &quot;subtype&quot;: [
        {
            &quot;system&quot;: &quot;http://hl7.org/fhir/restful-interaction&quot;,
            &quot;code&quot;: &quot;search-type&quot;
        }
    ],
    &quot;action&quot;: &quot;R&quot;,
    &quot;recorded&quot;: &quot;2021-01-13T12:22:02.980+01:00&quot;,
    &quot;outcome&quot;: &quot;0&quot;,
    &quot;outcomeDesc&quot;: &quot;Patient&quot;,
    &quot;purposeOfEvent&quot;: [
        {
            &quot;coding&quot;: [
                {
                    &quot;system&quot;: &quot;http://ehealth.sundhed.dk/fhir/PurposeOfUse&quot;,
                    &quot;code&quot;: &quot;INTERNAL_AUDIT_ONLY&quot;
                }
            ]
        }
    ],
    &quot;agent&quot;: [
        {
            &quot;extension&quot;: [
                {
                    &quot;url&quot;: &quot;http://ehealth.sundhed.dk/fhir/StructureDefinition/ehealth-responsibleOrganization&quot;,
                    &quot;valueReference&quot;: {
                        &quot;reference&quot;: &quot;https://organization.fut.trifork.com/fhir/Organization/33405&quot;
                    }
                }
            ],
            &quot;userId&quot;: {
                &quot;system&quot;: &quot;http://ehealth.sundhed.dk&quot;,
                &quot;value&quot;: &quot;https://organization.fut.trifork.com/fhir/Practitioner/107950&quot;
            },
            &quot;requestor&quot;: true
        }
    ],
    &quot;source&quot;: {
        &quot;identifier&quot;: {
            &quot;system&quot;: &quot;http://ehealth.sundhed.dk&quot;,
            &quot;value&quot;: &quot;http://localhost:8080/fhir/&quot;
        },
        &quot;type&quot;: [
            {
                &quot;system&quot;: &quot;http://hl7.org/fhir/security-source-type&quot;,
                &quot;code&quot;: &quot;4&quot;
            }
        ]
    },
    &quot;entity&quot;: [
        {
            &quot;identifier&quot;: {
                &quot;value&quot;: &quot;b4b77e5f-9658-4fa4-8a1c-530a5f2ce0e7&quot;
            },
            &quot;type&quot;: {
                &quot;system&quot;: &quot;http://hl7.org/fhir/security-source-type&quot;,
                &quot;code&quot;: &quot;4&quot;,
                &quot;display&quot;: &quot;Application Server&quot;
            },
            &quot;role&quot;: {
                &quot;system&quot;: &quot;http://hl7.org/fhir/object-role&quot;,
                &quot;code&quot;: &quot;24&quot;,
                &quot;display&quot;: &quot;Query&quot;
            },
            &quot;description&quot;: &quot;search entity&quot;,
            &quot;query&quot;: &quot;eyJfaWQiOlsiMTExIl19&quot;
        },
        {
            &quot;reference&quot;: {
                &quot;reference&quot;: &quot;http://localhost:8080/fhir/Patient/111&quot;
            },
            &quot;role&quot;: {
                &quot;system&quot;: &quot;http://hl7.org/fhir/object-role&quot;,
                &quot;code&quot;: &quot;1&quot;
            }
        }
    ]
}
</code></pre></div>



<a name="222573570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222573570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222573570">(Jan 13 2021 at 12:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191427">@Jens Villadsen</span> so it appears you convert both get and post into some other form. What is that other form? I simply don't recognize it</p>
<div class="codehilite"><pre><span></span><code>{&quot;_id&quot;:[&quot;111&quot;]}
</code></pre></div>



<a name="222573643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222573643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222573643">(Jan 13 2021 at 12:44)</a>:</h4>
<p>this method has the drawback that the audit log will not contain the query as it was received. It will have been cleansed. Thus there is not data there to be used to determine if an attack probe is being done.</p>



<a name="222574386"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222574386" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222574386">(Jan 13 2021 at 12:53)</a>:</h4>
<p>the query was "_id=111"</p>



<a name="222574546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222574546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222574546">(Jan 13 2021 at 12:54)</a>:</h4>
<p>you can say it has been 'cleansed' - by HAPI that is ... to the canonical internal representation as conceived by HAPI</p>



<a name="222574599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222574599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222574599">(Jan 13 2021 at 12:55)</a>:</h4>
<p>They are syntactically identical</p>



<a name="222574708"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222574708" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222574708">(Jan 13 2021 at 12:56)</a>:</h4>
<p>We have a full request/response log next to the auditlog</p>



<a name="222575653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222575653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222575653">(Jan 13 2021 at 13:05)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span></p>



<a name="222575993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222575993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222575993">(Jan 13 2021 at 13:08)</a>:</h4>
<p>so the intermediate form I am looking for is a HAPI invention. unfortunate... and as I said, for security or privacy purposes this clensed form is not as good.... I do wonder if this brings up an opportunity to use the intermediate form for positive purposes (find me the audits of queries for <em>this</em>). while dual recording the exact inbound query also for negative purposes.</p>



<a name="222576330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222576330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222576330">(Jan 13 2021 at 13:11)</a>:</h4>
<p>note - all auditevents are linked to the actual request in the request/response log as the entity.identifier in the auditevent is a b3 zipkin ... meaning that we can always find the original request will all headers and URL's and stuff</p>



<a name="222576374"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222576374" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222576374">(Jan 13 2021 at 13:11)</a>:</h4>
<p>The AuditEvent will always be a condensed form of the the original request as I see it</p>



<a name="222576492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222576492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222576492">(Jan 13 2021 at 13:12)</a>:</h4>
<p>but that is not "standard"... I am trying to come up with a "standard" that everyone can follow ... hence my questions</p>



<a name="222576543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222576543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222576543">(Jan 13 2021 at 13:13)</a>:</h4>
<p>I am not looking to implement, I am looking to fix or provide guidance in AuditEvent</p>



<a name="222576600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222576600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222576600">(Jan 13 2021 at 13:13)</a>:</h4>
<p>ok ... then the AuditEvent should reflect the request in its entirety</p>



<a name="222576666"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222576666" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222576666">(Jan 13 2021 at 13:14)</a>:</h4>
<p>meaning: ALL headers, ALL of the Body</p>



<a name="222577323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222577323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222577323">(Jan 13 2021 at 13:20)</a>:</h4>
<p>IE - I don't see a partiular field for HTTP header fields in AuditEvent</p>



<a name="222579437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222579437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222579437">(Jan 13 2021 at 13:37)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span></p>



<a name="222581445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222581445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222581445">(Jan 13 2021 at 13:51)</a>:</h4>
<p>yes, that is the intentioni</p>



<a name="222581503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222581503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222581503">(Jan 13 2021 at 13:52)</a>:</h4>
<p>that is why I was asking for how others have solved this.</p>



<a name="222582065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582065">(Jan 13 2021 at 13:55)</a>:</h4>
<p>This is why the AuditEvent.entity.query is a base64, so that it captures exactly what came in. Thus for any kind of query technology there needs to be a way defined for how to be complete while also not sanitizing the data. With DICOM this was easy, with SQL this was easy, for XDS this was easy... for http GET we thought it was easy until it was pointed out the http headers are important, and for http POST we could grab the http header/body but miss the URL.</p>



<a name="222582482"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582482" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582482">(Jan 13 2021 at 13:58)</a>:</h4>
<p>HTTP headers are also important in XDS</p>



<a name="222582578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582578">(Jan 13 2021 at 13:59)</a>:</h4>
<p>in what way are you thinking they are important?</p>



<a name="222582594"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582594" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582594">(Jan 13 2021 at 13:59)</a>:</h4>
<p>they may contain security tokens</p>



<a name="222582632"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582632" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582632">(Jan 13 2021 at 13:59)</a>:</h4>
<p>or other important context</p>



<a name="222582649"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582649" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582649">(Jan 13 2021 at 13:59)</a>:</h4>
<p>security is not a different layer, handled by a different audit event</p>



<a name="222582758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582758">(Jan 13 2021 at 14:00)</a>:</h4>
<p>sure ... but the header may set the context of the xds invocation</p>



<a name="222582764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582764">(Jan 13 2021 at 14:00)</a>:</h4>
<p>right?</p>



<a name="222582781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582781">(Jan 13 2021 at 14:00)</a>:</h4>
<p>in FHIR http, I don't mind keeping the security headers or removing them... not the most important problem right now</p>



<a name="222582994"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222582994" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222582994">(Jan 13 2021 at 14:02)</a>:</h4>
<p>it would not recommend  removing headers in an audit trail</p>



<a name="222583074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583074">(Jan 13 2021 at 14:02)</a>:</h4>
<p>especially in a RESTful setup as FHIR</p>



<a name="222583092"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583092" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583092">(Jan 13 2021 at 14:02)</a>:</h4>
<p>right. I agree</p>



<a name="222583112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583112">(Jan 13 2021 at 14:02)</a>:</h4>
<p>I am not trying to remove them</p>



<a name="222583151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583151">(Jan 13 2021 at 14:02)</a>:</h4>
<p>I am trying to get the POST query fully recorded</p>



<a name="222583207"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583207" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583207">(Jan 13 2021 at 14:03)</a>:</h4>
<p>you don't even have the GET fully recorded</p>



<a name="222583214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583214">(Jan 13 2021 at 14:03)</a>:</h4>
<p>if along the way I discover the GET query needs some more guidance, so be it</p>



<a name="222583244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583244">(Jan 13 2021 at 14:03)</a>:</h4>
<p>then help me... I know the points you are making.</p>



<a name="222583390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583390">(Jan 13 2021 at 14:04)</a>:</h4>
<p>and your intention is to build a model that fully encapsulates a HTTP request</p>



<a name="222583403"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583403" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583403">(Jan 13 2021 at 14:04)</a>:</h4>
<p>?</p>



<a name="222583415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583415">(Jan 13 2021 at 14:04)</a>:</h4>
<p>I asked for examples.. you gave them to me... I pointed out how they are not sufficient... now onto the next step</p>



<a name="222583553"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583553" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583553">(Jan 13 2021 at 14:05)</a>:</h4>
<p>and the next step would be ... ? to fully encapsulate HTTP requests (at least for RESTful FHIR)?</p>



<a name="222583610"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583610" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583610">(Jan 13 2021 at 14:06)</a>:</h4>
<p>is that your goal? to design such a model?</p>



<a name="222583731"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583731" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583731">(Jan 13 2021 at 14:07)</a>:</h4>
<p>the specific HTTP method is irrelevant ... you would have to capture all of them anyway</p>



<a name="222583759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583759">(Jan 13 2021 at 14:07)</a>:</h4>
<p>any by the way ... HTTP GET can actually contain a body ... just an FYI</p>



<a name="222583840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222583840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222583840">(Jan 13 2021 at 14:08)</a>:</h4>
<p>and it is used from time to time ... seldom however</p>



<a name="222584006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222584006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222584006">(Jan 13 2021 at 14:09)</a>:</h4>
<p>just to stir things up</p>



<a name="222584232"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222584232" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222584232">(Jan 13 2021 at 14:11)</a>:</h4>
<p>yes that sounds right</p>



<a name="222585023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585023">(Jan 13 2021 at 14:17)</a>:</h4>
<p>well ... to simplify matters ... for calls made over HTTP you would need an array of fields for for HTTP headers, one for the method and a field for the body</p>



<a name="222585045"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585045" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585045">(Jan 13 2021 at 14:17)</a>:</h4>
<p>regardless of the HTTP method</p>



<a name="222585608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585608">(Jan 13 2021 at 14:20)</a>:</h4>
<p>sounds good... does this exist, or will we be defining this on the AuditEvent page?</p>



<a name="222585731"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585731" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585731">(Jan 13 2021 at 14:21)</a>:</h4>
<p>The word 'header' does not exist on <a href="https://www.hl7.org/fhir/auditevent.html">https://www.hl7.org/fhir/auditevent.html</a> so my guess would be 'no'.</p>



<a name="222585732"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585732" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585732">(Jan 13 2021 at 14:21)</a>:</h4>
<p>I don't mind defining it on the AuditEvent page, but would like it better if it was already specified somewhere.. like in an IETF RFC...</p>



<a name="222585784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585784">(Jan 13 2021 at 14:22)</a>:</h4>
<p>arh...</p>



<a name="222585829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585829">(Jan 13 2021 at 14:22)</a>:</h4>
<p>what do web server audit logs natively look like?</p>



<a name="222585887"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585887" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585887">(Jan 13 2021 at 14:22)</a>:</h4>
<p>there's no such thing</p>



<a name="222585893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585893">(Jan 13 2021 at 14:22)</a>:</h4>
<p>in general terms</p>



<a name="222585910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222585910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222585910">(Jan 13 2021 at 14:23)</a>:</h4>
<p>surely doesn't hurt to ask</p>



<a name="222586015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586015">(Jan 13 2021 at 14:24)</a>:</h4>
<p>usually like <a href="https://httpd.apache.org/docs/2.4/logs.html#accesslog">https://httpd.apache.org/docs/2.4/logs.html#accesslog</a></p>



<a name="222586062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586062">(Jan 13 2021 at 14:24)</a>:</h4>
<p>well ... thats access logs ...</p>



<a name="222586083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586083">(Jan 13 2021 at 14:24)</a>:</h4>
<p>that not the same thing as auditlogs</p>



<a name="222586357"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586357" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586357">(Jan 13 2021 at 14:26)</a>:</h4>
<p><a href="https://tools.ietf.org/html/rfc2616">https://tools.ietf.org/html/rfc2616</a> specifies how HTTP requests look like</p>



<a name="222586380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586380">(Jan 13 2021 at 14:26)</a>:</h4>
<p>and what is mandatory</p>



<a name="222586475"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586475" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586475">(Jan 13 2021 at 14:27)</a>:</h4>
<p>so we have the other stuff... we just need the "The request line from..."</p>



<a name="222586772"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586772" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586772">(Jan 13 2021 at 14:29)</a>:</h4>
<p>we just need %r</p>



<a name="222586979"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222586979" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222586979">(Jan 13 2021 at 14:30)</a>:</h4>
<p>The <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html</a></p>



<a name="222587187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587187">(Jan 13 2021 at 14:31)</a>:</h4>
<p>so the method and the request uri</p>



<a name="222587205"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587205" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587205">(Jan 13 2021 at 14:31)</a>:</h4>
<p>that would do it... right?</p>



<a name="222587251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587251">(Jan 13 2021 at 14:31)</a>:</h4>
<p>seems correct ... where would you place the headers?</p>



<a name="222587379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587379">(Jan 13 2021 at 14:32)</a>:</h4>
<p>or are you 'just' collecting stuff that needs to be in the model?</p>



<a name="222587394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587394">(Jan 13 2021 at 14:32)</a>:</h4>
<p>unfortunately... the code that would be building the AuditEvent likely only has sanitized data (like your observing)... so it might be hard to get this...</p>



<a name="222587525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587525">(Jan 13 2021 at 14:33)</a>:</h4>
<p>nop ... and FHIR server building auditevents should have access to the actual request ...</p>



<a name="222587575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587575">(Jan 13 2021 at 14:33)</a>:</h4>
<p>ah. okay.</p>



<a name="222587641"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587641" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587641">(Jan 13 2021 at 14:33)</a>:</h4>
<p>well ... you are right .... it can probably be hard to get it under some circumstances</p>



<a name="222587644"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587644" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587644">(Jan 13 2021 at 14:33)</a>:</h4>
<p>so... this would solve the core problem. satisfy the need for both GET and POST query, grabing stuff that we don't grab today...</p>



<a name="222587715"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587715" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587715">(Jan 13 2021 at 14:34)</a>:</h4>
<p>and all the other Methods</p>



<a name="222587722"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587722" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587722">(Jan 13 2021 at 14:34)</a>:</h4>
<p>I just wonder if we should have a different way to record the sanitized parameters.</p>



<a name="222587726"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587726" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587726">(Jan 13 2021 at 14:34)</a>:</h4>
<p>PATCH, DELETE</p>



<a name="222587783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587783">(Jan 13 2021 at 14:34)</a>:</h4>
<p>this is just for Query type transactions... but the pattern might be useful elsewhere.. agreed</p>



<a name="222587807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587807">(Jan 13 2021 at 14:34)</a>:</h4>
<p>well ... given that POST and GET searches are semantically equivivalent ... it shouldn't be necessary</p>



<a name="222587862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587862">(Jan 13 2021 at 14:35)</a>:</h4>
<p>You need to support all HTTP methods for the AuditEvent</p>



<a name="222587943"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587943" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587943">(Jan 13 2021 at 14:35)</a>:</h4>
<p>at least the one's that are supported for FHIR</p>



<a name="222587958"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222587958" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222587958">(Jan 13 2021 at 14:35)</a>:</h4>
<p>or specified for FHIR</p>



<a name="222588113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588113">(Jan 13 2021 at 14:36)</a>:</h4>
<p>will this come up on the upcoming WGM?</p>



<a name="222588128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588128">(Jan 13 2021 at 14:36)</a>:</h4>
<p>I think you are addressing another topic.. that of should there be a pattern in AuditEvent to record all http requests regardless of what they are.</p>



<a name="222588202"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588202" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588202">(Jan 13 2021 at 14:36)</a>:</h4>
<p>to that, I don't disagree, but to that we expected that was already handled by the infrastructure that is not FHIR specific</p>



<a name="222588367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588367">(Jan 13 2021 at 14:37)</a>:</h4>
<p>well ... we just agreed that the current model does not contain headers</p>



<a name="222588462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588462">(Jan 13 2021 at 14:38)</a>:</h4>
<p>and for Query we do expect that if you can identify the patient(s) that you do... so we are not replacing the web server log, we are doing a log at the FHIR  infrastructure level</p>



<a name="222588503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588503">(Jan 13 2021 at 14:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191427">Jens Villadsen</span> <a href="#narrow/stream/179247-Security-and.20Privacy/topic/AuditEvent.20pattern.20for.20POST.20search/near/222588367">said</a>:</p>
<blockquote>
<p>well ... we just agreed that the current model does not contain headers</p>
</blockquote>
<p>yes, and you just helped solve that one</p>



<a name="222588509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588509">(Jan 13 2021 at 14:38)</a>:</h4>
<p>sure</p>



<a name="222588787"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588787" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588787">(Jan 13 2021 at 14:40)</a>:</h4>
<p>I just dont understand how the auditevent model can be seen as complete for the other HTTP methods when HTTP headers currently are not part of the model</p>



<a name="222588826"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588826" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588826">(Jan 13 2021 at 14:40)</a>:</h4>
<p>but  i agree - that is not part of the topic</p>



<a name="222588922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222588922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222588922">(Jan 13 2021 at 14:41)</a>:</h4>
<p>but if you are working on fixing the model i general ... now you know more of its shortcommings ;)</p>



<a name="222589219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222589219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222589219">(Jan 13 2021 at 14:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191427">Jens Villadsen</span> <a href="#narrow/stream/179247-Security-and.20Privacy/topic/AuditEvent.20pattern.20for.20POST.20search/near/222586979">said</a>:</p>
<blockquote>
<p>The <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html</a></p>
</blockquote>
<p>so the recommendation is that the AuditEvent.entity.query is base64 (later we can argue the base64 point) encoded of this </p>
<div class="codehilite"><pre><span></span><code>Request       = Request-Line              ; Section 5.1
                        *(( general-header        ; Section 4.5
                         | request-header         ; Section 5.3
                         | entity-header ) CRLF)  ; Section 7.1
                        CRLF
                        [ message-body ]          ; Section 4.3
</code></pre></div>
<p>does this work for <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span>  <span class="user-mention" data-user-id="191319">@James Agnew</span> and other FHIR server platforms ?</p>



<a name="222589790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222589790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222589790">(Jan 13 2021 at 14:47)</a>:</h4>
<ul>
<li>an obvious note to that is that the query can be in either the <code>message-body</code> or the <code>Request-Line</code></li>
</ul>



<a name="222590276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222590276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222590276">(Jan 13 2021 at 14:50)</a>:</h4>
<p>I read this to say that the "Request" includes both the Request-Line and the message-body... so we are covered.. right?</p>



<a name="222590342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222590342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222590342">(Jan 13 2021 at 14:50)</a>:</h4>
<p>would be good to see two examples (GET vs POST) of a simple FHIR query</p>



<a name="222590725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222590725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222590725">(Jan 13 2021 at 14:52)</a>:</h4>
<p>The <code>Request</code> is the full monty</p>



<a name="222590988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222590988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222590988">(Jan 13 2021 at 14:54)</a>:</h4>
<p>likely more than we want... as you pointed out it will include security headers... but better to get it than invent some format that will be harder to address.</p>



<a name="222593709"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222593709" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222593709">(Jan 13 2021 at 15:09)</a>:</h4>
<p>I have not read all the messages in this thread but wanted to point out <a href="http://www.softwareishard.com/blog/har-12-spec/#request">http://www.softwareishard.com/blog/har-12-spec/#request</a> which I don't think was ever formally standardized despite being drafted in w3c, but it is widely used in software tools for saving durable records of http requests and responses (for example, in chrome developer tools you can save any requests made from a web page in this format by right clicking the request in the network tab and choosing save as)</p>



<a name="222598228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222598228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222598228">(Jan 13 2021 at 15:34)</a>:</h4>
<p>seems like an ok option</p>



<a name="222610048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222610048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222610048">(Jan 13 2021 at 16:49)</a>:</h4>
<p>that seems like an alternative we should consider. It is a bit more readable to a JSON friendly person. But it seems to contain the same stuff, right? So the difference is encoding, and one is a standard vs one is a a quasi-standard. I don't see that as a bad thing, but just want to be clear.</p>



<a name="222611049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/AuditEvent%20pattern%20for%20POST%20search/near/222611049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/AuditEvent.20pattern.20for.20POST.20search.html#222611049">(Jan 13 2021 at 16:56)</a>:</h4>
<p>I think "quasi-standard" sounds about right for HAR; <a href="https://en.wikipedia.org/wiki/HAR_(file_format)">https://en.wikipedia.org/wiki/HAR_(file_format)</a> has a bit more background.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
