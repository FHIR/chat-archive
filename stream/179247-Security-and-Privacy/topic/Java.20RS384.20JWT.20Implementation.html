---
layout: page
title: "FHIR Chat  · Java RS384 JWT Implementation · Security and Privacy"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/index.html">Security and Privacy</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Java.20RS384.20JWT.20Implementation.html">Java RS384 JWT Implementation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="214077456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Java%20RS384%20JWT%20Implementation/near/214077456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Java.20RS384.20JWT.20Implementation.html#214077456">(Oct 21 2020 at 16:32)</a>:</h4>
<p>I'm looking at implementing server to server OAuth as defined in Bulk Data (<a href="https://hl7.org/fhir/uv/bulkdata/authorization/index.html">https://hl7.org/fhir/uv/bulkdata/authorization/index.html</a>). The client assertion is a signed JWT using RS384. I have a Java server which wishes to verify this signature using the public key from the jwks.</p>
<p>I'm using the auth0 jwt library to verify the signature. To do this an algorithm is required which takes as an input the java security RSAPublicKey. However I am having difficulty creating the RSAPublicKey object from the jwk set. The parameters n and e in jwks are Base64 URL Encoded by the RSAPublicKey uses BigIntegers. The following seems to work:<br>
<code>BigInteger e = new BigInteger(Base64.getUrlDecoder().decode(rawExponent));</code><br>
But for the modulus it appears to overflow; the result is -310301627147497527848975101822928448285430943117086804.......</p>
<p>Has anyone else successfully created an RSAPublicKey object from a jwk set?</p>



<a name="214077567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Java%20RS384%20JWT%20Implementation/near/214077567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Java.20RS384.20JWT.20Implementation.html#214077567">(Oct 21 2020 at 16:33)</a>:</h4>
<p>For reference here is the public key I am using to verify the JWT</p>
<div class="codehilite"><pre><span></span><code>{
  &quot;keys&quot;: [
    {
      &quot;kty&quot;: &quot;RSA&quot;,
      &quot;alg&quot;: &quot;RS384&quot;,
      &quot;n&quot;: &quot;52tcPrGJgzyGqjcUiHsbSk_PxQ7Uovz4saGxva3iyBoidsekonigJJ3LnFlHYb3vBa2NA-0GpX2E1KhNNcYWAWQFcu069zi0YZ_wWGn6PWZURuonUoKH4dGHggym3xxVUxuA8OPubGe5ji56eic4RPINg0z-TtPlS-H9dnDIVznRUTXf3fy2dqWMuTY4D2e4fXGII6OpFAsEyrOqIoR8pLWGu7AiQkothunopp9q_Gu2xqB6l8BNulsbiwsQMeRE-9SGfeFpyblHiizHDwSqeZ3iv49Ellk4yjmrf6wOaFA2IXRqL1cCLj86B6KIDrjdzOL4lOSiES-PclNpioG2rQ&quot;,
      &quot;e&quot;: &quot;AQAB&quot;,
      &quot;key_ops&quot;: [&quot;verify&quot;],
      &quot;ext&quot;: true,
      &quot;kid&quot;: &quot;3ab8b05b64d799e289e10a201786b38c&quot;
    }
  ]
}
</code></pre></div>



<a name="214088269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Java%20RS384%20JWT%20Implementation/near/214088269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Langley <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Java.20RS384.20JWT.20Implementation.html#214088269">(Oct 21 2020 at 17:47)</a>:</h4>
<p>If anyone runs into this problem again the issue was with number representations. The jwks is Base64Url encoded big endian but the BigInteger byte array constructor expects two's complement. The solution is to use <code>BigInteger e = new BigInteger(1, Base64.getUrlDecoder().decode(rawExponent));</code></p>



<a name="214103483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179247-Security%20and%20Privacy/topic/Java%20RS384%20JWT%20Implementation/near/214103483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179247-Security-and-Privacy/topic/Java.20RS384.20JWT.20Implementation.html#214103483">(Oct 21 2020 at 19:37)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
