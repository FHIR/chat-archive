---
layout: page
title: "FHIR Chat  · Non-conformant element ids · united states"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/index.html">united states</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html">Non-conformant element ids</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="247978856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/247978856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#247978856">(Aug 02 2021 at 22:24)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> <span class="user-mention" data-user-id="191410">@Brett Marquard</span> The us-core extension profiles have non-conformant element ids in them. How can I report this officially?</p>
<p>For example, us-core-race has id <code>Extension.extension:ombCategory.valueCoding</code> which should be <code>Extension.extension:ombCategory.value[x]:valueCoding</code></p>
<p>Also, an additional differential element is needed at <code>Extension.extension:ombCategory.value[x]</code> to limit the allowed value to Coding.</p>
<p>See <a href="http://hl7.org/fhir/elementdefinition.html#id">http://hl7.org/fhir/elementdefinition.html#id</a> and <a href="http://hl7.org/fhir/elementdefinition.html#typesx">http://hl7.org/fhir/elementdefinition.html#typesx</a></p>



<a name="248145546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248145546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248145546">(Aug 02 2021 at 23:21)</a>:</h4>
<p>Is this happening in the most recent version of US Core?</p>



<a name="248145552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248145552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248145552">(Aug 02 2021 at 23:21)</a>:</h4>
<p>(Trying to figure out if this is a current publisher issue)</p>



<a name="248151872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248151872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248151872">(Aug 02 2021 at 23:59)</a>:</h4>
<p>I'm looking at the <a href="http://www.hl7.org/fhir/us/core/StructureDefinition-us-core-race.profile.json.html">latest US Core race extension</a>, and the snapshot has an element with <code>Extension.extension:ombCategory.value[x]:valueCoding</code>.  The differential does have <code>Extension.extension:ombCategory.valueCoding</code>, but that shortcut syntax is allowed in the differential (as described in <a href="https://fire.ly/2019/09/13/type-slicing-in-fhir-r4/">this blog</a> and hopefully the spec <em>somewhere</em>).</p>
<p>I agree, however, that the differential <em>should</em> also contain a type constraint on <code>Extension.extension:ombCategory.value[x]</code> constraining it to only <code>Coding</code>.  The spec is clear about this as <span class="user-mention" data-user-id="191351">@Chris Grenz</span> points out.  The snapshot generator, however, is <em>incorrectly</em> inferring the constraint from the <code>Extension.extension:ombCategory.valueCoding</code> -- so if you look at the snapshot, it <em>does</em> have a type constraint.  But this is a bug, not a feature (and one that I'm 98% sure I've reported before).</p>



<a name="248169760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248169760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248169760">(Aug 03 2021 at 00:27)</a>:</h4>
<p>The R4 spec specifically disallows that id format in the differential. The blog post points out that this was unclear in R3.</p>
<p><code>valueCoding</code> _is_ the correct value in the path.</p>



<a name="248169975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248169975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248169975">(Aug 03 2021 at 00:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> I think the "Normalization" section of the blog post is non-conformant...</p>



<a name="248172671"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248172671" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248172671">(Aug 03 2021 at 01:14)</a>:</h4>
<p>make a tracker as a technical correction.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>   I expected the validator to catch this?</p>



<a name="248173375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248173375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248173375">(Aug 03 2021 at 01:27)</a>:</h4>
<p><span class="user-mention" data-user-id="191351">@Chris Grenz</span> -- I am pretty sure that most (or all?) of the major tools support choice type renaming in differential element ids.  The IG Publisher happily accepts it and translates it to the full id in the snapshot.  Even the vital signs profiles included in FHIR R4 core use choice type renaming in differential ids (<a href="http://hl7.org/fhir/R4/bodyweight.profile.json.html">example</a>).  So if you're right that it is not allowed, then there are a lot of tools and definitions that need to change (including FHIR core itself).  We should probably get to the bottom of this.</p>



<a name="248174130"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248174130" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248174130">(Aug 03 2021 at 01:41)</a>:</h4>
<p>Hmm... That's how I read this: <a href="http://hl7.org/fhir/elementdefinition.html#id">http://hl7.org/fhir/elementdefinition.html#id</a></p>
<p>SHALL be present and SHALL use this algo. And the algo specifically calls out the type choice scenario...</p>



<a name="248176168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248176168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248176168">(Aug 03 2021 at 02:23)</a>:</h4>
<p>My understanding was that valueCoding is not allowed in either id or path anymore.</p>



<a name="248215647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248215647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248215647">(Aug 03 2021 at 12:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191351">@Chris Grenz</span> -- yeah, that section of doc does read that way.  I only know what I've seen and been told regarding this.  I am having a hard time finding it in the spec though.</p>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> - the spec at least mentions it in reference for paths:</p>
<blockquote>
<p>The inclusion of a type specific path (such as "Patient.deceasedBoolean") SHALL NOT be interpreted as constraining allowed types, but instead, it constrains the use of a particular type</p>
</blockquote>
<p>And that bit (quoted above) was specifically <em>added</em> in R4, so it's not just an unintentional carryover from STU3.</p>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> <span class="user-mention" data-user-id="203235">@Ward Weistra</span> <span class="user-mention" data-user-id="191328">@Ewout Kramer</span> - does <a href="http://fire.ly">fire.ly</a> have any insight on choice type renaming and where it is and is not allowed? Since <a href="http://fire.ly">fire.ly</a> <a href="https://fire.ly/2019/09/13/type-slicing-in-fhir-r4/">wrote the blog article</a>, I imagine you had some conversations around this back when it was decided.</p>



<a name="248220347"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248220347" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248220347">(Aug 03 2021 at 13:28)</a>:</h4>
<p>It's important to distinguish between path and id. <code>path: Extension.valueCoding</code> is fine and refers to <code>id: Extension.value[x]:valueCoding</code></p>
<p><code>id: Extension.valueCoding</code> should be an error.</p>



<a name="248221146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248221146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248221146">(Aug 03 2021 at 13:34)</a>:</h4>
<p>I guess I just don't understand the point of it then.  It's not much of a "shortcut" syntax if you're still required to do the long form in the <code>id</code> anyway.  If <code>id</code> was optional then you could argue that there's value if you're <em>only</em> doing the path, but sdf-17 requires every differential element to have an id -- so what's the point?</p>



<a name="248222744"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/248222744" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#248222744">(Aug 03 2021 at 13:47)</a>:</h4>
<p>I'm afraid not -- Michel (who wrote this) is out of the picture and he &amp; Grahame worked on this stuff pretty much in isolation. <span class="user-mention" data-user-id="193551">@Marco Visser</span> and me are now responsible for his code, but I would have to dig in the code.  I do know that Michel wrote this after he implemented it in the R4 API (and thus forge).</p>



<a name="249677394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/249677394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#249677394">(Aug 17 2021 at 04:26)</a>:</h4>
<p>I'm not sure what the problem is here?</p>



<a name="249813239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/249813239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#249813239">(Aug 18 2021 at 06:41)</a>:</h4>
<p>See Chris’ original post on the syntax used in the differentials for choice datatypes</p>



<a name="250418143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179190-united%20states/topic/Non-conformant%20element%20ids/near/250418143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179190-united-states/topic/Non-conformant.20element.20ids.html#250418143">(Aug 23 2021 at 22:04)</a>:</h4>
<p>Submitted <a href="https://jira.hl7.org/browse/FHIR-33233">https://jira.hl7.org/browse/FHIR-33233</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
