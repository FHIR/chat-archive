---
layout: page
title: "FHIR Chat  · How to reference contained value set · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html">How to reference contained value set</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="192086871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192086871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192086871">(Mar 27 2020 at 22:16)</a>:</h4>
<p>I have a Questionnaire with contained value set. The value set has <code>"id": "valueset-1"</code> and <code>"url": "http://example.com/valueset-1"</code>. What should I use in item.answerValueSet (which is type canonical)? <code> "#id"</code> or <code>"http://example.com/valueset-1"</code></p>



<a name="192088590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192088590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192088590">(Mar 27 2020 at 22:37)</a>:</h4>
<p>I <em>think</em> <code>#id</code>.  However, I'm not sure that using the canonical URL is wrong.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, opinions?</p>



<a name="192166959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192166959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192166959">(Mar 29 2020 at 10:19)</a>:</h4>
<p>no you use the local - this is here: <a href="http://hl7.org/fhir/references.html#canonical-fragments" title="http://hl7.org/fhir/references.html#canonical-fragments">http://hl7.org/fhir/references.html#canonical-fragments</a></p>



<a name="192300418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192300418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192300418">(Mar 30 2020 at 18:48)</a>:</h4>
<p>On that page, there is this example:</p>
<div class="codehilite"><pre><span></span>&lt;valueSet value=&quot;http://fhir.acme.com/Questionnaire/example|1.0#vs1&quot;/&gt;
</pre></div>


<p>with the explanation: "This is a reference to the value set with id "vs1" in version 1.0 of the identified questionnaire. "</p>
<p>Is that talking about one resource referencing a contained valueset inside a different resource (the Questionnaire)?  Or is it another way for the Questionnaire to refer to its contained ValueSet?</p>
<p>I am confused by this example because I see this restriction on the same page: "References to contained resources are never resolved outside the container resource."</p>



<a name="192303660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192303660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192303660">(Mar 30 2020 at 19:11)</a>:</h4>
<p>inside a different resource</p>



<a name="192314692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192314692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192314692">(Mar 30 2020 at 20:42)</a>:</h4>
<p>How can that be, if there is this restriction:  "References to contained resources are never resolved outside the container resource." ?</p>



<a name="192315205"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192315205" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192315205">(Mar 30 2020 at 20:47)</a>:</h4>
<p>if you see a reference that starts with # like #a, then the resolution of that reference will never be outside the containing resource</p>



<a name="192315522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192315522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192315522">(Mar 30 2020 at 20:49)</a>:</h4>
<p>Well, okay, but I was quoting from <a href="http://hl7.org/fhir/references.html#contained" title="http://hl7.org/fhir/references.html#contained">http://hl7.org/fhir/references.html#contained</a>, which does not qualify that statement with respect to the format of the URI.</p>



<a name="192315658"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192315658" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192315658">(Mar 30 2020 at 20:50)</a>:</h4>
<p>well, you could create a task to clarify</p>



<a name="192315976"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192315976" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192315976">(Mar 30 2020 at 20:53)</a>:</h4>
<p>Another needed clarification is needed on this statement on "<a href="http://hl7.org/fhir/references.html#contained" title="http://hl7.org/fhir/references.html#contained">Canonical URLs</a>": "References to canonical URLs use the canonical type to refer to the url element".   There no mention in this section that a canonical URL might be something else.  Should I make two tasks or one?</p>



<a name="192320236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192320236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192320236">(Mar 30 2020 at 21:34)</a>:</h4>
<p>two tasks.</p>



<a name="192324775"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/192324775" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#192324775">(Mar 30 2020 at 22:18)</a>:</h4>
<p><a href="http://jira.hl7.org/browse/FHIR-26666" title="http://jira.hl7.org/browse/FHIR-26666">J#26666</a> and <a href="http://jira.hl7.org/browse/FHIR-26667" title="http://jira.hl7.org/browse/FHIR-26667">J#26667</a></p>



<a name="244408001"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244408001" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244408001">(Jun 30 2021 at 11:19)</a>:</h4>
<p>Is there a way to reference the valueset directly, and not via the canonical? (like we used to do in DSTU2/STU3)</p>



<a name="244409042"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244409042" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244409042">(Jun 30 2021 at 11:31)</a>:</h4>
<p>Also, coming back to how the <code>http://fhir.acme.com/Questionnaire/example|1.0#vs1</code><br>
If that was a structureDefinition, doesn't that then refer to the element with id vs1?<br>
<a href="http://hl7.org/fhir/r4/questionnaire-definitions.html#Questionnaire.item.definition">http://hl7.org/fhir/r4/questionnaire-definitions.html#Questionnaire.item.definition</a><br>
says that this value <code>http://hl7.org/fhir/StructureDefinition/Observation#Observation.value[x]</code> doesn't refer to the contained resource, it's the element definition.<br>
<span class="user-mention" data-user-id="191407">@Rick Geimer</span> <span class="user-mention" data-user-id="195344">@Paul Lynch</span></p>



<a name="244409495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244409495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244409495">(Jun 30 2021 at 11:36)</a>:</h4>
<p>There is a <code>display</code> extension to add in the explicit display to show (like you would on a regular reference) but no excplicit reference link</p>



<a name="244409701"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244409701" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244409701">(Jun 30 2021 at 11:39)</a>:</h4>
<p>The only option here is to include the <code>http://hl7.org/fhir/StructureDefinition/terminology-server</code>and the url for the valueset (can't just reference it)</p>



<a name="244434378"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244434378" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244434378">(Jun 30 2021 at 14:45)</a>:</h4>
<p>Questionnaire only supports referencing by canonical, not by Reference.  We do have an extension that allows you to indicate preferred terminology server which presumably would allow you to indicate where to look for it.  Agree that's your only option right now.</p>
<p>#vs1 says "the element in this resource with id 'vs1'".  Any element in a resource might have an id.  contained resources and snapshot and differential elements are required to have ids.  If you have a StructureDefinition with contained resources, so long as the id is unique, referencing it should work, though it's possible some software doesn't account for that.  (And it may be that we need to make the documentation clearer.)</p>



<a name="244495720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244495720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244495720">(Jun 30 2021 at 22:14)</a>:</h4>
<p>Contained resources don't have to have element ids, but a resource Id (different thing) and that's my point.</p>



<a name="244499183"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244499183" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244499183">(Jun 30 2021 at 22:59)</a>:</h4>
<p>see this:  <a href="http://hl7.org/fhir/references.html#canonical-fragments">http://hl7.org/fhir/references.html#canonical-fragments</a></p>



<a name="244502668"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244502668" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244502668">(Jun 30 2021 at 23:41)</a>:</h4>
<p>Yes, it's the inconsistency where that refers to the contained resource ID, and the element Definition usage of the same format in the same type going to an elementID somewhere in the resource.</p>



<a name="244513265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/How%20to%20reference%20contained%20value%20set/near/244513265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/How.20to.20reference.20contained.20value.20set.html#244513265">(Jul 01 2021 at 02:58)</a>:</h4>
<p>I don't think there's inconsistency.  A hash-reference to a StructureDefinition could be a contained resource or an element or in theory even something like StructureDefinition.title if it happened to have an id on it.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
