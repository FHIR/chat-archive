---
layout: page
title: "FHIR Chat  · Different enableWhen support? · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html">Different enableWhen support?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="228993277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/228993277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#228993277">(Mar 05 2021 at 17:36)</a>:</h4>
<p>EnableWhen is a weird beast.  It's not totally clear whether it makes the 80% rule - and we have a more generic solution (enableWhenExpression) that covers everything enableWhen allows plus more - and it's not clear that it's significantly more complex to support.  Also, we have some forms that have a design approach of "skip to Question X" which is somewhat clunky to implement using enableWhen.</p>
<p>How comfortable are we that we want to lock this down into "can't break compatibility going forward"?</p>



<a name="228993470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/228993470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#228993470">(Mar 05 2021 at 17:37)</a>:</h4>
<p>enableWhen and enableWhenExpression were backwards for our questionnaire purposes.  We had the "skip to question" version of the rules.  Based on the answer to this question (or some external parameters), we need to say go to the next question and, as you said, that is clunky or downright not doable using enableWhen.</p>



<a name="228993682"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/228993682" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#228993682">(Mar 05 2021 at 17:39)</a>:</h4>
<p>It should be doable (curious what couldn't be expressed if not), but definitely can get super clunky.</p>



<a name="229456175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229456175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ilya Beda <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229456175">(Mar 09 2021 at 10:42)</a>:</h4>
<p>I think that replacing <code>enableWhen</code> with <code>enableWhenExpression</code> is a good idea. It is much easy to support the only enableWhenExpression rather than try to implement all weird options for <code>enableWhen</code>.<br>
We can provide a tool that automatically converts old <code>enableWhen</code> elements to <code>enableWhenExpression</code> notation.</p>



<a name="229751236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229751236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229751236">(Mar 10 2021 at 21:48)</a>:</h4>
<p>I like the idea of a "skipToItem" extension, though I wonder would should happen if a question is skipped but its own enableWhen logic (or its group's) says to show it.  I think implementations would need separate flags for both.</p>



<a name="229752853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229752853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229752853">(Mar 10 2021 at 21:59)</a>:</h4>
<p>Does "skipTo" need to be partnered with "backTo"? Assuming that for each question I have "next question" and "previous question" buttons, and use skipTo to jump from Q2 to Q5, would the "previous question" button take me Q4 or Q2? Does it matter if Q3 and Q4 are enabled, but skipped? Can you skip an enabled question?</p>
<p>I like enableWhen because it means I don't need to learn (the even more poorly documented than SDC) FHIRPath or CQL to turn on or off particular questions. If enableWhen is replaced, enableWhenExpression needs to have solid examples that correspond to the basic use cases that enableWhen covered.</p>



<a name="229763151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229763151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229763151">(Mar 10 2021 at 23:02)</a>:</h4>
<p>I think skipToItem would override enableWhen(Expression).  A back button would have to skip over any skipped or disabled items.</p>



<a name="229789035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229789035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229789035">(Mar 11 2021 at 03:47)</a>:</h4>
<p>Great thread ...</p>
<p>I do like the <code>skipTo</code> idea having built many questionnaires and the code to implement form filler behavior. </p>
<p>I was thinking of <code>skipTo</code> as a way of specifying an alternative exit edge from an item (where the default exit edge is either the next child, or next sibling  item). As <code>enableWhen</code> is an entry condition (similar to <code>condition</code> in Plan/ActionDef.action), I don't think one would override the other (e.g. <code>enableWhen</code> logic would still apply). </p>
<p>But I don't think this idea should be conflated with trying to specify item navigational state (e.g. <code>backTo</code>). It is a special case if the form filler  experience is one-question-at-a-time (as opposed to seeing all items at once, or broken down by group, or other hierarchy).</p>



<a name="229857561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229857561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ilya Beda <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229857561">(Mar 11 2021 at 14:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191380">@Elliot Silver</span>  I am not using CQL, so I can't help with it.<br>
However, FHIRPath is well documented and it is very simple to convert <code>enableWhen</code> to FHIRPath powered <code>enableWhenExpression</code>.</p>
<div class="codehilite"><pre><span></span><code>  enableWhen:
  - question: has-claim-number
    operator: &quot;!=&quot;
    answer:
      Coding:
        system: http://snomed.info/sct
        code: &quot;373066001&quot;
        display: &quot;Yes&quot;
</code></pre></div>
<div class="codehilite"><pre><span></span><code>QuestionnaireResponse.repeat(item).where(linkId=&#39;has-claim-number&#39;).answer.children().code ~ &#39;373066001&#39;
</code></pre></div>
<p>Leveraging FHRPath boolean logic <a href="http://hl7.org/fhirpath/N1/#and">http://hl7.org/fhirpath/N1/#and</a> makes complex expression more flexible and readable than <code>enableBehavior</code>.</p>
<p>I am using two FHIRPath implementations.<br>
javascript-based is <a href="https://github.com/HL7/fhirpath.js">https://github.com/HL7/fhirpath.js</a> <br>
python-based is <a href="https://github.com/beda-software/fhirpath-py">https://github.com/beda-software/fhirpath-py</a></p>
<p>Both of them contains data-driven tests that can be used as examples of FHIRPath expression</p>
<p><a href="https://github.com/beda-software/fhirpath-py/tree/master/tests/cases">https://github.com/beda-software/fhirpath-py/tree/master/tests/cases</a><br>
<a href="https://github.com/HL7/fhirpath.js/tree/master/test/cases">https://github.com/HL7/fhirpath.js/tree/master/test/cases</a></p>



<a name="229879390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229879390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229879390">(Mar 11 2021 at 16:27)</a>:</h4>
<p><span class="user-mention" data-user-id="196255">@Ilya Beda</span> , perhaps I was inaccurate when I said FHIRPath is not well documented. What I meant was, there is no easy entry point to learning FHIRPath. I can look at what you wrote, and understand what it means, but I couldn't have gone from the enableWhen to your expressions myself. </p>
<p>Apparently FHIRPath is a subset of CQL, or vice-versa.</p>



<a name="229896357"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/229896357" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#229896357">(Mar 11 2021 at 17:58)</a>:</h4>
<p>FHIRPath is a subset of CQL</p>



<a name="232117936"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/232117936" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#232117936">(Mar 27 2021 at 20:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F/near/228993277">said</a>:</p>
<blockquote>
<p>EnableWhen is a weird beast.  It's not totally clear whether it makes the 80% rule - and we have a more generic solution (enableWhenExpression) that covers everything enableWhen allows plus more - and it's not clear that it's significantly more complex to support.  Also, we have some forms that have a design approach of "skip to Question X" which is somewhat clunky to implement using enableWhen.</p>
<p>How comfortable are we that we want to lock this down into "can't break compatibility going forward"?</p>
</blockquote>
<p>Maybe it depends on the point from which you are starting. I am currently implementing a Questionnaire filler app in Flutter using Dart. That means I don't have a ready-to-use mature Open Source FHIRPath implementation at my disposal. enableWhen vs enableWhenExpression is making the difference between 50 lines of if-then logic vs. writing a FHIRPath engine from scratch. Seeing how most of my use-cases are trivial (similar to the SDC samples, "if female then ask pregnancy") I would like to keep the simplistic option.</p>



<a name="232290743"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/232290743" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ilya Beda <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#232290743">(Mar 29 2021 at 15:53)</a>:</h4>
<p>There are a lot of open-source FHIRPath implementations you can use as an example. <br>
Also, there is no need to implement the whole spec you can implement a small subset that meets your needs.<br>
Finally, FHIRpath is one of the FHIR core elements, so you have to implement it anyway.</p>



<a name="232293417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/232293417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#232293417">(Mar 29 2021 at 16:10)</a>:</h4>
<p>It's not accurate to say that you have to implement FHIRPath anyway - a Questionnaire rendering tool could easily have no support for FHIRPath.</p>



<a name="232295173"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Different%20enableWhen%20support%3F/near/232295173" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F.html#232295173">(Mar 29 2021 at 16:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179255-questionnaire/topic/Different.20enableWhen.20support.3F/near/232293417">said</a>:</p>
<blockquote>
<p>It's not accurate to say that you have to implement FHIRPath anyway - a Questionnaire rendering tool could easily have no support for FHIRPath.</p>
</blockquote>
<p>Mine goes for consumer appeal and smoothness <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span>  <a href="/user_uploads/10155/9i_o1REraCVlmOBi789_Ovwz/image.png">image.png</a>  <br>
Maybe the first one to do 90fps on a phone.</p>
<div class="message_inline_image"><a href="/user_uploads/10155/9i_o1REraCVlmOBi789_Ovwz/image.png" title="image.png"><img src="/user_uploads/10155/9i_o1REraCVlmOBi789_Ovwz/image.png"></a></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
