---
layout: page
title: "FHIR Chat  · Multiple unit choices for an answer · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html">Multiple unit choices for an answer</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154015201"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015201" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015201">(Nov 02 2018 at 16:52)</a>:</h4>
<p>If you have a Questionnaire question for height in which the user can choose units of either inches or meters, and then you want to do a BMI calculation (or something else) with that entered quantity, is there a way in which the FHIRPath expression can retrieve the value entered in a particular desired unit?  For instance if the BMI rule is expecting the height in meters, but the user has selected inches, is there some way in which the height in meters can be obtained?</p>
<p>Now that I think about it, it might be possible to write a rather complicated FHIRPath expression for this if the possible units are known in advance (for instance, if it is known that the units are either inches or meters and not cm or feet).  But is there, or should there be, some support for this from Questionnaire/QuestionnaireResponse?</p>



<a name="154015204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015204">(Nov 02 2018 at 17:04)</a>:</h4>
<p>So you're asking if FHIRPath can do UCUM unit conversions for you?  That sounds like a good question to ask in a FHIRPath specific stream.  It'd be an awesome feature, but not one I can recall having seen in the spec.</p>



<a name="154015206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015206">(Nov 02 2018 at 17:12)</a>:</h4>
<p>No, although that is an interesting question as well.  I was asking if Questionnaire/QR would have some support for doing that, for instance, by specifying that the value obtained from QR.answer.valueCoding would be in a particular unit, and not necessarily the unit the user selected when entering the data.</p>
<p>Just for reference, the following FHIRPath expression could work if it is known that the units are either inches or meters:</p>
<div class="codehilite"><pre><span></span>(%height.answer.valueQuantity.where(unit=&#39;[in_i]&#39;).value*0.0254).combine(%height.answer.valueQuantity.where(unit=&#39;m&#39;).value)
</pre></div>


<p>But, what I am really wondering here is whether that is necessary.  There might be a situation in which the user could pick a UCUM unit not defined on the form (like cm).</p>



<a name="154015208"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015208" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015208">(Nov 02 2018 at 17:19)</a>:</h4>
<p>Not following how you could presume that the data would be in anything other than the unit the user specified...</p>



<a name="154015211"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015211" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015211">(Nov 02 2018 at 17:28)</a>:</h4>
<p>The form renderer would convert what the user entered to the target unit specified in the Questionnaire, so that when the QR data was accessed, it would be in that unit.</p>



<a name="154015213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015213">(Nov 02 2018 at 17:33)</a>:</h4>
<p>Transformation between user entry and what's stored?  That's quite contrary to the base purpose of QuestionnaireResponse - which is to be a precise record of what the user actually entered.  The transformation happens during the conversion process.  If you wanted to calculate the value of a separate hidden question, you could do that, but I wouldn't be in favor of anything that changes user-entered data.</p>



<a name="154015216"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015216" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015216">(Nov 02 2018 at 17:39)</a>:</h4>
<p>It would not need to affect the answer that was stored under item.answer.valueQuantity.  Perhaps the transformed value could be stored on a different attribute.</p>



<a name="154015219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015219">(Nov 02 2018 at 17:48)</a>:</h4>
<p>You could stick it in an extension I suppose, but I'd lean towards a hidden question.</p>



<a name="154015226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015226">(Nov 02 2018 at 18:03)</a>:</h4>
<p>A hidden question presumes that a form designer knows what transformation to make and put in the hidden question.  I think it will probably be necessary for a some external library call to be made (e.g. by the form renderer) to do the transformation from the actual to desired unit.</p>
<p>The other option other than an extension on Questionnaire would be to put something in FHIRPath (as you mentioned) for converting one Quantity to another Quantity with the desired unit.   That might have wider usefulness.</p>



<a name="154015369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015369">(Nov 03 2018 at 01:49)</a>:</h4>
<p>Out of curiosity, what is the ucum unit that you're converting?</p>



<a name="154015682"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154015682" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154015682">(Nov 05 2018 at 16:43)</a>:</h4>
<p>Inches to meters.  [in_i] to m.</p>



<a name="154016975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154016975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154016975">(Nov 09 2018 at 00:20)</a>:</h4>
<p>so we haven't surfaced this in FHIRPath. It's not that hard to implement assuming you have a UCUM library (and there are UCUM libraries for most languages these days).</p>



<a name="154016976"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154016976" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154016976">(Nov 09 2018 at 00:22)</a>:</h4>
<p>given that we have quantity as a type, it would make sense to add 2 functions to it:<br>
boolean quantity.convertsTo(String unit)<br>
quantity quantity.convert(String unit)</p>



<a name="154016977"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154016977" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154016977">(Nov 09 2018 at 00:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> what say you?</p>



<a name="154016999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154016999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154016999">(Nov 09 2018 at 01:28)</a>:</h4>
<p>Since we already have <a href="http://hl7.org/fhirpath/2018Sep/#convertstoquantity-boolean" target="_blank" title="http://hl7.org/fhirpath/2018Sep/#convertstoquantity-boolean">convertsToQuantity</a> and <a href="http://hl7.org/fhirpath/2018Sep/#toquantity-quantity" target="_blank" title="http://hl7.org/fhirpath/2018Sep/#toquantity-quantity">toQuantity</a>, I would suggest just adding an optional overload to those functions <code>unit: String</code> that would support the behavior.</p>



<a name="154017000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017000">(Nov 09 2018 at 01:29)</a>:</h4>
<p>So we would have <code>convertsToQuantity([unit: String])</code> and <code>toQuantity([unit: String])</code></p>



<a name="154017005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017005">(Nov 09 2018 at 01:39)</a>:</h4>
<p>yes I like that</p>



<a name="154017009"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017009" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017009">(Nov 09 2018 at 01:50)</a>:</h4>
<p>String and not code?</p>



<a name="154017011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017011">(Nov 09 2018 at 01:55)</a>:</h4>
<p>if you mean the parameter types, then yes - these are FHIRPath system types, not FHIR types</p>



<a name="154017013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017013">(Nov 09 2018 at 01:57)</a>:</h4>
<p>But you'd pass an actual code and not a descriptive string, correct?</p>



<a name="154017014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017014">(Nov 09 2018 at 01:58)</a>:</h4>
<p>yes must be UCUM code</p>



<a name="154017031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017031">(Nov 09 2018 at 05:08)</a>:</h4>
<p>Yes, same representation as the quantity literal (<a href="http://hl7.org/fhirpath/2018Sep/grammar.html" target="_blank" title="http://hl7.org/fhirpath/2018Sep/grammar.html">http://hl7.org/fhirpath/2018Sep/grammar.html</a>)</p>



<a name="154017032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Multiple%20unit%20choices%20for%20an%20answer/near/154017032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Multiple.20unit.20choices.20for.20an.20answer.html#154017032">(Nov 09 2018 at 05:13)</a>:</h4>
<p><a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19635" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=19635">GF#19635</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
