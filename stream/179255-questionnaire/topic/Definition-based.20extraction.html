---
layout: page
title: "FHIR Chat  · Definition-based extraction · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html">Definition-based extraction</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="229665628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229665628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229665628">(Mar 10 2021 at 14:13)</a>:</h4>
<p>For activating Definition-based extraction, I think we need to add an extension <br>
<a href="http://hl7.org/fhir/uv/sdc/2019May/extension-sdc-questionnaire-itemContext.html">http://hl7.org/fhir/uv/sdc/2019May/extension-sdc-questionnaire-itemContext.html</a><br>
what goes into the value of that extension?</p>



<a name="229699521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229699521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229699521">(Mar 10 2021 at 16:45)</a>:</h4>
<p>Typically a FHIRPath</p>



<a name="229702179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229702179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229702179">(Mar 10 2021 at 16:59)</a>:</h4>
<p>Path to where?</p>



<a name="229706381"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229706381" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229706381">(Mar 10 2021 at 17:22)</a>:</h4>
<p>From the context associated with the containing item to the context associated with this item.</p>



<a name="229734136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229734136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229734136">(Mar 10 2021 at 20:08)</a>:</h4>
<p>I have an questionnaire q1 that I want to use to populate a patient profile p1 and 2 observations o1 and o2<br>
at the top level of q1, do I need to add that extension? Or I need to populate this extension for each questionnaire item that I want to map to the patient/observation?</p>



<a name="229741816"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229741816" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229741816">(Mar 10 2021 at 20:50)</a>:</h4>
<p>You'd have a context for your overall Questionnaire and then you'd establish separate context for each of the two Observation questions.</p>



<a name="229742949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229742949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229742949">(Mar 10 2021 at 20:57)</a>:</h4>
<p>what is the context for the overall questionnaire?</p>



<a name="229742961"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229742961" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229742961">(Mar 10 2021 at 20:57)</a>:</h4>
<p>Patient?</p>



<a name="229743167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229743167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229743167">(Mar 10 2021 at 20:58)</a>:</h4>
<p>so I put that extension 3 times? one where the value is ..../MyPatient, another ..../MyObservation1, and ..../MyObservation2 ?</p>



<a name="229760562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229760562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229760562">(Mar 10 2021 at 22:41)</a>:</h4>
<p>You can have itemContext for the Questionnaire as a whole too.  That context might be a query</p>



<a name="229768058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229768058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229768058">(Mar 10 2021 at 23:47)</a>:</h4>
<p>The current extension name is itemExtractionContext, and is at <a href="http://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-questionnaire-itemExtractionContext.html">http://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-questionnaire-itemExtractionContext.html</a>.</p>



<a name="229768435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/229768435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#229768435">(Mar 10 2021 at 23:51)</a>:</h4>
<p>I think the Patient might be set with the <a href="http://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-questionnaire-launchContext.html">launchContext</a> extension, in which case itemExtractContext for the patient would be a very simple FHIRPath that just said "%patient".</p>



<a name="248349818"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/248349818" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fred Hersch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#248349818">(Aug 04 2021 at 13:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> </p>
<p>Looking for some help here: We are using a Definition based extraction approach to extract the data from the questionnaire response.<br>
In this example:</p>
<ul>
<li>Questionnaire has an item to record the body temperature.</li>
<li>We also need to update the Observation.code while extracting questionnaire responses for body temperature.</li>
</ul>
<p>A couple of questions:</p>
<ul>
<li>What is the correct way to extract the code? </li>
<li>Can it be within the root item? - example 1 below - if so, what is the correct expression?</li>
<li>Or should we use hidden field to extract like in example 2 below</li>
<li>In general is there best practice for extracting the QuantityValue with the code system etc</li>
</ul>
<p>Example 1</p>
<div class="codehilite"><pre><span></span><code>{
      &quot;text&quot;: &quot;Temperature&quot;,
      &quot;type&quot;: &quot;group&quot;,
      &quot;linkId&quot;: &quot;5.0.0&quot;,
      &quot;extension&quot;: [
        {
          &quot;url&quot;: &quot;http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-itemExtractionContext&quot;,
          &quot;valueExpression&quot;: {
            &quot;language&quot;: &quot;application/x-fhir-query&quot;,
            &quot;expression&quot;: &quot;Observation&quot;,
            &quot;name&quot;: &quot;temperature&quot;
          }
        },
      &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#observation.code&quot;,
      &quot;code&quot; : [
       {
          &quot;code&quot; : &quot;8310-5&quot;,
          &quot;display&quot; : &quot;Temperature&quot;,
          &quot;system&quot; : &quot;http://loinc.org&quot;
       }
      ],
        {
          &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl&quot;,
          &quot;valueCodeableConcept&quot;: {
            &quot;coding&quot;: [
              {
                &quot;system&quot;: &quot;http://hl7.org/fhir/questionnaire-item-control&quot;,
                &quot;code&quot;: &quot;page&quot;,
                &quot;display&quot;: &quot;Page&quot;
              }
            ],
            &quot;text&quot;: &quot;Page&quot;
          }
        }
      ],
      &quot;item&quot;: [
        {
          &quot;text&quot;: &quot;Add instructions for capturing temperature&quot;,
          &quot;type&quot;: &quot;display&quot;,
          &quot;linkId&quot;: &quot;5.1.0&quot;
        },
        {
          &quot;linkId&quot;: &quot;5.2.0&quot;,
          &quot;type&quot;: &quot;group&quot;,
          &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#Observation.valueQuantity&quot;,
          &quot;extension&quot;: [
            {
              &quot;url&quot;: &quot;http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-itemExtractionContext&quot;,
              &quot;valueExpression&quot;: {
                &quot;language&quot;: &quot;application/x-fhir-query&quot;,
                &quot;expression&quot;: &quot;Quantity&quot;,
                &quot;name&quot;: &quot;quantity&quot;
              }
            }
          ],
          &quot;item&quot;: [
            {
              &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#Observation.valueQuantity.value&quot;,
              &quot;text&quot;: &quot;Record temperature&quot;,
              &quot;type&quot;: &quot;decimal&quot;,
              &quot;linkId&quot;: &quot;5.2.1&quot;,
              &quot;extension&quot;: [
                {
                  &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/minValue&quot;,
                  &quot;valueDecimal&quot;: 35.0
                },
                {
                  &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/maxValue&quot;,
                  &quot;valueDecimal&quot;: 45.0
                }
              ]
            },
            {
              &quot;text&quot;: &quot;Unit&quot;,
              &quot;type&quot;: &quot;choice&quot;,
              &quot;linkId&quot;: &quot;5.2.2&quot;,
              &quot;required&quot;: true,
              &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#Observation.valueQuantity.code&quot;,
              &quot;extension&quot;: [
                {
                  &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl&quot;,
                  &quot;valueCodeableConcept&quot;: {
                    &quot;coding&quot;: [
                      {
                        &quot;system&quot;: &quot;http://hl7.org/fhir/questionnaire-item-control&quot;,
                        &quot;code&quot;: &quot;drop-down&quot;,
                        &quot;display&quot;: &quot;Drop down&quot;
                      }
                    ],
                    &quot;text&quot;: &quot;Drop down&quot;
                  }
                }
              ],
              &quot;answerOption&quot;: [
                {
                  &quot;valueCoding&quot;: {
                    &quot;code&quot;: &quot;F&quot;,
                    &quot;display&quot;: &quot;F&quot;
                  }
                },
                {
                  &quot;valueCoding&quot;: {
                    &quot;code&quot;: &quot;C&quot;,
                    &quot;display&quot;: &quot;C&quot;
                  }
                }
              ]
            }
          ]
        },
      ]
    },
</code></pre></div>
<p>Example 2: </p>
<div class="codehilite"><pre><span></span><code>&quot;item&quot;: [
            {
              &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#Observation.code.coding&quot;,
              &quot;type&quot;: &quot;group&quot;,
              &quot;linkId&quot;: &quot;5.3.1&quot;,
              &quot;extension&quot;: [
                {
                  &quot;url&quot;: &quot;http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-itemExtractionContext&quot;,
                  &quot;valueExpression&quot;: {
                    &quot;language&quot;: &quot;application/x-fhir-query&quot;,
                    &quot;expression&quot;: &quot;Coding&quot;,
                    &quot;name&quot;: &quot;coding&quot;
                  }
                }
              ],
              &quot;item&quot;: [
                {
                  &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#Observation.code.coding.code&quot;,
                  &quot;type&quot;: &quot;string&quot;,
                  &quot;linkId&quot;: &quot;5.3.1.1&quot;,
                  &quot;initial&quot;: [
                    {
                      &quot;valueString&quot;: &quot;8310-5&quot;
                    }
                  ]
                },
                {
                  &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#Observation.code.coding.system&quot;,
                  &quot;type&quot;: &quot;string&quot;,
                  &quot;linkId&quot;: &quot;5.3.1.2&quot;,
                  &quot;initial&quot;: [
                    {
                      &quot;valueString&quot;: &quot;http://loinc.org&quot;
                    }
                  ]
                },
                {
                  &quot;definition&quot;: &quot;http://hl7.org/fhir/StructureDefinition/Observation#Observation.code.coding.display&quot;,
                  &quot;type&quot;: &quot;string&quot;,
                  &quot;linkId&quot;: &quot;5.3.1.3&quot;,
                  &quot;initial&quot;: [
                    {
                      &quot;valueString&quot;: &quot;Temperature&quot;
                    }
                  ]
                }
              ]
</code></pre></div>
<p>Any general best practice or examples would be super helpful!</p>
<p>Thanks in advance</p>
<p>cc: <span class="user-mention" data-user-id="396904">@Aditya Kurkure</span> <span class="user-mention" data-user-id="366686">@Jing Tang</span> <span class="user-mention" data-user-id="199006">@Peter Lubell-Doughtie</span></p>



<a name="248356623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Definition-based%20extraction/near/248356623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Definition-based.20extraction.html#248356623">(Aug 04 2021 at 14:23)</a>:</h4>
<p>See response here: <a href="#narrow/stream/179255-questionnaire/topic/Need.20advice.20on.20how.20to.20add.20Observation.2Ecode.20in.20questionnaire">https://chat.fhir.org/#narrow/stream/179255-questionnaire/topic/Need.20advice.20on.20how.20to.20add.20Observation.2Ecode.20in.20questionnaire</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
