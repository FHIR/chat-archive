---
layout: page
title: "FHIR Chat  · validation and Questionnaire Response status · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html">validation and Questionnaire Response status</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="242261995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/242261995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Diane <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#242261995">(Jun 10 2021 at 19:59)</a>:</h4>
<p>Any tips on validation contingent on Questionnaire Response status?    I am using the NLM LHC Forms  application, so that might limit what I can do as well.   Some of our Questionnaires are very long and might take 4-5 hours to complete.  I would like the users to be able to store their work if they want to take a break as a FHIR Questionnaire Response  (with a status of "in-progress" )  and not have the validation rules take effect.   </p>
<p>So far, the validation rules  use readily available extensions like "<a href="http://hl7.org/fhir/StructureDefinition/minLength">http://hl7.org/fhir/StructureDefinition/minLength</a>"    and are very simple like:<br>
some items  are required<br>
item has a minimum quantity<br>
if "other "  is selected, then the text box explanation must be filled in<br>
date validation between answers (eg. the root cause assessment activity must occur after the problematic event actually happened)</p>
<p>I would prefer that the users can submit their Questionnaire Response  with a status of "in-progress"  without being blocked by these value constraints.</p>
<p>Once the user clicks a button on the UI to "Submit as Completed",  then I would like the validation to take place. </p>
<p>Is this possible?    I thought about updating the Questionnaire Response status via the Client to "Completed" then pulling the Questionnaire Response back for editing  and validation  using custom fhirpath.js  invariants  with a ternary to check that Questionnaire Response status is "Completed".   But, that is cumbersome and if validation fails and the user gives up, then the client has to have a robust way to be sure to reset the Questionnaire Response to "in-progress" in the FHIR server.   </p>
<p>Maybe I am making this too difficult.</p>



<a name="242262637"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/242262637" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#242262637">(Jun 10 2021 at 20:03)</a>:</h4>
<p>If the user is clicking "Submit as Completed", your code that handles that button could call the LHC-Forms API LForms.Util.checkValidity() to run the validations then.</p>



<a name="242281654"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/242281654" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#242281654">(Jun 10 2021 at 22:51)</a>:</h4>
<p>Validation rules shouldn't kick in as anything other than 'warnings' unless the status is 'completed'.  However basic 'resource' validations are always in force.  Are you finding any of those problematic?</p>



<a name="242292330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/242292330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#242292330">(Jun 11 2021 at 01:47)</a>:</h4>
<p>After seeing this one recently in another post (and changing our internal implementation too) I've had a bit of a change of heart on this one...<br>
There is definitely a difference between errors and warnings here, and I think if you're calling $validate, then it shouldn't matter what the status is, but if you're storing it, then I think that should permit it to be stored (and maybe return warnings if you're returning the operationoutcome).<br>
<span class="user-mention" data-user-id="195344">@Paul Lynch</span> <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  thoughts on that subtle difference?</p>



<a name="242296941"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/242296941" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#242296941">(Jun 11 2021 at 03:22)</a>:</h4>
<p>I think an instance of a QuestionnaireResponse must always be valid against the resource constraints and any profile it declares.  It doesn't need to be valid against the Questionnaire it asserts it's a response to until/unless the status is 'complete' or 'amended', though it should  have base validity - e.g. refer to the appropriate linkIds, use appropriate types for responses, etc.  But all invariants, required answers, etc. should be ignored until complete.  Once the status changes, servers MAY (but don't have to) reject instances that aren't strictly valid against their referenced Questionnaire.</p>



<a name="242335764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/242335764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#242335764">(Jun 11 2021 at 12:10)</a>:</h4>
<p>Base yes, but was thinking a $validate could also verify all the other rules there, but be permissive on the save.<br>
Still seems a little weird. (either way)</p>



<a name="276141513"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/276141513" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#276141513">(Mar 22 2022 at 04:00)</a>:</h4>
<p>In my new validation implementation I'm considering the display text to be included in the output error messages, and I'm wondering if the display text in the QuestionnaireResponse should also be considered?</p>



<a name="276141592"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/276141592" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#276141592">(Mar 22 2022 at 04:02)</a>:</h4>
<p>e.g. IF the QR.item.text = 'localized/personalized Q1 display' and the W.item.text = 'Q1 Display value'<br>
should/could the localized display be included in the validation output?</p>



<a name="276189357"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/276189357" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#276189357">(Mar 22 2022 at 13:37)</a>:</h4>
<p>I'm not understanding the question...</p>



<a name="276251273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/validation%20and%20Questionnaire%20Response%20status/near/276251273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/validation.20and.20Questionnaire.20Response.20status.html#276251273">(Mar 22 2022 at 20:42)</a>:</h4>
<p>Eg. Output an error message like<br>
'localuzed/personalised Q1 display is greater than the maximum value 4.4"<br>
Where that display label text value was in the QR.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
