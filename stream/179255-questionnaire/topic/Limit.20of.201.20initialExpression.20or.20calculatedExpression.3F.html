---
layout: page
title: "FHIR Chat  · Limit of 1 initialExpression or calculatedExpression? · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html">Limit of 1 initialExpression or calculatedExpression?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154024471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024471">(Dec 11 2018 at 16:37)</a>:</h4>
<p>I think that logically, it does not make sense for a field to have more than one initialExpression, or more than one calculatedExpression, and (probably) not more than one of either.  Is there anything in the spec to say that a valid questionnaire will not have more that one of those?</p>



<a name="154024484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024484">(Dec 11 2018 at 17:09)</a>:</h4>
<p>The cardinality of each should have a max of 1.  We could add context invariants to each that would prevent there from being more than one of both</p>



<a name="154024491"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024491" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024491">(Dec 11 2018 at 17:25)</a>:</h4>
<p>Okay-- I see there is a cardinality setting of  0..1 on those extensions.</p>



<a name="154024492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024492">(Dec 11 2018 at 17:31)</a>:</h4>
<p>If you think it's important to enforce the cross-extension cardinality limit, you can submit a change request</p>



<a name="154024493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024493">(Dec 11 2018 at 17:51)</a>:</h4>
<p>I am unsure about that.  As a contrived example, suppose you have a BMI field.  You might want an initialExpression to load in the previous BMI value, and then have a calculatedExpression to update it when height and weight values (which could start out blank, preventing the calculatedExpression from running) are filled in.</p>



<a name="154024500"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024500" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024500">(Dec 11 2018 at 18:08)</a>:</h4>
<p>One of the things we haven't done with calculatedValue yet is declare at what point the value gets calculated - does there have to be an answer for all of the questions?</p>



<a name="154024522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024522">(Dec 11 2018 at 19:15)</a>:</h4>
<p>The spec says, "Calculated value is updated as other answers in the QuestionnaireResponse are filled in".  I was assuming this meant, "whenever a value changes, run the calculatedExpressions".</p>



<a name="154024666"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024666" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024666">(Dec 12 2018 at 02:15)</a>:</h4>
<p>And the renderer could be smart about it, maybe.</p>



<a name="154024805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Limit%20of%201%20initialExpression%20or%20calculatedExpression%3F/near/154024805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Limit.20of.201.20initialExpression.20or.20calculatedExpression.3F.html#154024805">(Dec 12 2018 at 15:08)</a>:</h4>
<p>If by "smart" you mean being selective about which expressions need to be run, I don't see a way to do that with the current spec.  You do not know in advance what other answers a FHIRPath expression might reference, and the set of answers it references could change from one run to the next.  In LHC-Forms, we specify explicitly what the source items are, so we only run what is needed when one of the source items changes.  It would be nice if something like that were in Questionnaire, though for small forms it doesn't seem to hurt too much to run them all.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
