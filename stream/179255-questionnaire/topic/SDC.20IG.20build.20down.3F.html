---
layout: page
title: "FHIR Chat  · SDC IG build down? · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html">SDC IG build down?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="185144007"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185144007" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185144007">(Jan 08 2020 at 18:50)</a>:</h4>
<p><a href="http://build.fhir.org/ig/HL7/sdc" target="_blank" title="http://build.fhir.org/ig/HL7/sdc">http://build.fhir.org/ig/HL7/sdc</a> gives me an odd directory listing, and other links are 404s.</p>



<a name="185145765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185145765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185145765">(Jan 08 2020 at 19:07)</a>:</h4>
<p>The CI build is unhappy right now.  Hopefully fixed tomorrow once Grahame is back in action</p>



<a name="185145876"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185145876" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185145876">(Jan 08 2020 at 19:09)</a>:</h4>
<p>Ideally, if the build breaks, it would not deploy to the public version of the site that people are using.</p>



<a name="185146010"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185146010" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185146010">(Jan 08 2020 at 19:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> Is that something that's possible to do?  Retain the old copy if the CI build fails?</p>



<a name="185152985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185152985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185152985">(Jan 08 2020 at 20:24)</a>:</h4>
<p>Sure -- though I'd definitely appreciate help making that change (it's not trivial, because the service receiving build content doesn't currently <em>understand</em> the content, and the service generating build content doesn't have access to previous build results).</p>



<a name="185153021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185153021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185153021">(Jan 08 2020 at 20:24)</a>:</h4>
<p>In general the preferred workflow would be to make changes in branches and merge them when they're not broken.</p>



<a name="185153046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185153046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185153046">(Jan 08 2020 at 20:24)</a>:</h4>
<p>In other words, keeping <code>master</code> healthy prevents broken CI content.</p>



<a name="185559804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185559804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185559804">(Jan 14 2020 at 02:32)</a>:</h4>
<p>that's not so useful when the problem is that the infrastructure collapges</p>



<a name="185563980"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185563980" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185563980">(Jan 14 2020 at 04:13)</a>:</h4>
<p>Hmm, like if the infrastructure breaks between testing changes in a branch and merging them into master?</p>



<a name="185564022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185564022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185564022">(Jan 14 2020 at 04:14)</a>:</h4>
<p>Anyway, maybe we can have a canonical place where the filed build logs go, like a subdirectory of the successful build output?</p>



<a name="185564097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185564097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185564097">(Jan 14 2020 at 04:17)</a>:</h4>
<p>which logs?</p>



<a name="185599216"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185599216" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185599216">(Jan 14 2020 at 14:15)</a>:</h4>
<p>Build error log, and any of other output that you'd want to post in the case of a failure</p>



<a name="185628365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185628365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185628365">(Jan 14 2020 at 19:06)</a>:</h4>
<p>so if the build fails completely, put some kind of error log in place instead?</p>



<a name="185628379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185628379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185628379">(Jan 14 2020 at 19:06)</a>:</h4>
<p>so if the build fails completely, put some kind of error log in place instead?</p>



<a name="185628424"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185628424" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185628424">(Jan 14 2020 at 19:07)</a>:</h4>
<p>so if the build fails completely, put some kind of error log in place instead?</p>



<a name="185628615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185628615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185628615">(Jan 14 2020 at 19:09)</a>:</h4>
<p>Why not reverse the merge commit on master if the build fails, to get back to the previous working version?</p>



<a name="185628821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185628821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185628821">(Jan 14 2020 at 19:11)</a>:</h4>
<p>Do you mean automatically? This could cause some troubling / unstable behavior, and it's probably not desirable if it's a build infrastructure problem (rather than a content problem) that caused the failure -- because in that case, rolling back the commit wouldn't actually fix the build.</p>



<a name="185629098"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185629098" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185629098">(Jan 14 2020 at 19:14)</a>:</h4>
<p>If the build fails (completely or otherwise), the question is: what's the desired behavior. Right now we upload the complete (failed) build context, including output, logs, and source materials -- and replace any published content with this. I was thinking a better step might be to take this whole package and upload it to a <em>subdirectory</em> of any previous successful build (if there is any). Basically this would mean:</p>
<ul>
<li>At any time at most one successful build output would be published (for a given branch)</li>
<li>Any any time, at most one failed build output would be published</li>
<li>At any given time, there could be a (most recent) success output <em>and</em> a (most recent) failure output, both published</li>
</ul>



<a name="185629164"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185629164" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185629164">(Jan 14 2020 at 19:14)</a>:</h4>
<p>If this sounds like the right outcome, we can work towards that. It's not entirely trivial, but should be doable. I'd love help if anybody is interested in rolling up their sleeves on the build infrastructure.</p>



<a name="185629584"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185629584" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185629584">(Jan 14 2020 at 19:18)</a>:</h4>
<p>what should happen if there's never been a successful build? that's an important case because it's the onramp step</p>



<a name="185629685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185629685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185629685">(Jan 14 2020 at 19:20)</a>:</h4>
<p>The other thing to say is that pretty much all I could aim to do in case of a total failure is to get the console log output dumped, but the host that runs the IG Publisher is in a better place to do that already</p>



<a name="185630808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185630808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185630808">(Jan 14 2020 at 19:29)</a>:</h4>
<p>Why upload anything if the build fails?  Is there no place to see the errors other than the public website?  (As you can tell, I am not familiar with the build infrastructure.)  I would think the process would look like:</p>
<p>1) Generate the new version of the web pages on a staging server<br>
2) Confirm that the new version is good (no build failure; selected pages look okay)<br>
3) Copy the pages from staging to production<br>
4) Move the old version on production to a ".bak" directory<br>
5) Move the new version into place</p>
<p>But, I am sure there other considerations of which I am not aware.</p>



<a name="185631181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185631181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185631181">(Jan 14 2020 at 19:32)</a>:</h4>
<p>this is a most useful page: <a href="https://fhir.github.io/auto-ig-builder/builds.html" target="_blank" title="https://fhir.github.io/auto-ig-builder/builds.html">https://fhir.github.io/auto-ig-builder/builds.html</a></p>



<a name="185632297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185632297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185632297">(Jan 14 2020 at 19:43)</a>:</h4>
<p>If there has never been a successful build, then there's zero successful build hosted, and zero or one failure.</p>



<a name="185632470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185632470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185632470">(Jan 14 2020 at 19:45)</a>:</h4>
<p>I'm thinking that in terms of file layout on our web server we'd have something like</p>
<div class="codehilite"><pre><span></span>example-ig/
├── failure
│   ├── errors.log
│   ├── ig.json
│   └── output
│   └── other-source-files
├── index.html
├── success-file-1
└── success-file-2
</pre></div>



<a name="185632514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185632514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185632514">(Jan 14 2020 at 19:45)</a>:</h4>
<p>So if you just navigate to the URL for the IG, you'd see the successful build; if you navigate to <code>/failure</code>, you'd get failure details (if any).</p>



<a name="185632617"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185632617" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185632617">(Jan 14 2020 at 19:46)</a>:</h4>
<p>The "only publish good builds" approach you described in step (2) above <span class="user-mention" data-user-id="195344">@Paul Lynch</span> doesn't explain how failure logs get published.</p>



<a name="185632933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20IG%20build%20down%3F/near/185632933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20IG.20build.20down.3F.html#185632933">(Jan 14 2020 at 19:49)</a>:</h4>
<p>I was thinking that the failure logs would be viewable on the "staging server".  But, I was also thinking that everything was published at once, which I see by Grahame's link that that is not the case, so things are more complex than I was thinking.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
