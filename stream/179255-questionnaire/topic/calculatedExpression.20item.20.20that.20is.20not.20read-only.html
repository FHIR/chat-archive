---
layout: page
title: "FHIR Chat  · calculatedExpression item  that is not read-only · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html">calculatedExpression item  that is not read-only</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="261195849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261195849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Diane <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261195849">(Nov 11 2021 at 23:30)</a>:</h4>
<p>In <a href="http://build.fhir.org/ig/HL7/sdc/expressions.html#expression-extensions">http://build.fhir.org/ig/HL7/sdc/expressions.html#expression-extensions</a>    there is a notation that 'In most cases, 'calculated' answers should be marked as 'readOnly', however in some cases it may be legitimate to override a calculated element, for example if the calculation cannot be made due to non-available information, but the user still knows the calculated value.'  </p>
<p>If the item is not marked as "readOnly",   what is the expectation in the spec? That the user will be able to edit the answer?   How is this implemented in LHC-Forms?</p>



<a name="261276685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261276685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261276685">(Nov 12 2021 at 16:29)</a>:</h4>
<p>Yes, the expectation is that if not marked readOnly, the user will be able to edit it even if there is a calculatedExpression, but in that case the calculatedExpression should stop calculating.  LHC-Forms' implementation of calculatedExpression was written before that behavior was settled, and just makes the field readOnly whenever there is a calculatedExpression.  I had meant to change that, and added code to stop the calculation if the user edited it, but I see that I missed removing the setting of the readOnly flag.  Do you have a case where you have a calculatedExpression and also want the user to be able to edit?</p>



<a name="261331328"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261331328" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Diane <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261331328">(Nov 13 2021 at 01:26)</a>:</h4>
<p>Maybe.   It is the recalculating ability that I need along the way, which initialExpression doesn't provide.   For several of our questions, I use initialExpression  as a workaround  because I need the user to be able to edit, but my tests show that calculatedExpression is less prone to population errors  because it allows recalculation along the way.    The initialExpression often doesn't re-calculate correctly when too many answers are changed as the questionnaire is completed.  This happens where there is a series of questions where if they are done if the correct order and the user doesn't need to change any answers along the way, then then the final answer populates correctly using initialExpression.    I have used the newly implemented  enableWhen  extension  to try to force the order of question completion so that the chance of changing answers is minimized.    So, I have a sort of workaround for now.    But,  there really needs to be a populate expression that works (and allows editing)  that recalculates along the way.</p>



<a name="261529176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261529176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tilo Christ <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261529176">(Nov 15 2021 at 17:20)</a>:</h4>
<p>Would there be a need to somehow flag the questionnaire response item as being manually entered? I am just thinking about saving a questionnaire with a manually overridden calculatedExpression in non-completed state to a server and then retrieving it again later for completion. How would the filler know that it should again not be read-only. Something similar to the "userSelected" flag in Coding.</p>



<a name="261552084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261552084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261552084">(Nov 15 2021 at 20:09)</a>:</h4>
<p>The specification says that if the value is different from the calculated value at time of load, presume it's been manually edited.</p>



<a name="261555988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261555988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261555988">(Nov 15 2021 at 20:41)</a>:</h4>
<p>And if the other data is changed then it will be recalculated and overwritten again. Very subtle interactions there.</p>



<a name="261588186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261588186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Diane <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261588186">(Nov 16 2021 at 01:54)</a>:</h4>
<p>Agreed.  <span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span>   what does your form filler do? Do you have this implemented so that the user can manually override?</p>



<a name="261589463"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/261589463" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#261589463">(Nov 16 2021 at 02:13)</a>:</h4>
<p>I've only just completed that functionality, and haven't really tried it out in those specific cases.<br>
So it's likely undefined what behaviour will be when reloading a fork like that. We anticipate that the calc field will be read only, and another field for a custom value.</p>



<a name="267512181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/calculatedExpression%20item%20%20that%20is%20not%20read-only/near/267512181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Diane <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/calculatedExpression.20item.20.20that.20is.20not.20read-only.html#267512181">(Jan 10 2022 at 22:41)</a>:</h4>
<p>I would like to discuss this topic (and Brian's implementation) at the Connectathon this week.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
