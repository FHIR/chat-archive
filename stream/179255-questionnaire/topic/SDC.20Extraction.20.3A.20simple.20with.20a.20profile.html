---
layout: page
title: "FHIR Chat  · SDC Extraction : simple with a profile · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html">SDC Extraction : simple with a profile</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="220122053"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220122053" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220122053">(Dec 16 2020 at 14:33)</a>:</h4>
<p>I would like to use the "simple" Observation -based extract option, but would like to specify a profile (for the eventual Observation) to use. I was thinking of two options: <br>
1) Use item.definition (but do not include the <code>#</code> segment) to refer to the StructureDefinition for the profile<br>
2) Create a new extension on item.</p>
<p>I am leaning toward (1) but it seems like it would conflict the guidance in the spec "Implementers are free to try combining this mechanism with the Definition-based approach. If they do, they should take care that a given item (and its children) are only handled by one approach or the other - not both."</p>
<p>Any thoughts/recommendations on how to do this?</p>



<a name="220137723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220137723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220137723">(Dec 16 2020 at 16:26)</a>:</h4>
<p>What are your objectives in specifying a profile rather than the base resource?</p>



<a name="220144727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220144727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220144727">(Dec 16 2020 at 17:20)</a>:</h4>
<p>I have a profile on Observation. In this first specific case, it specifies the category.</p>



<a name="220145192"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220145192" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220145192">(Dec 16 2020 at 17:23)</a>:</h4>
<p>So your intention is that by specifying a profile, certain fixed values would be auto-populated into the extracted Observation?</p>



<a name="220146666"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220146666" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220146666">(Dec 16 2020 at 17:33)</a>:</h4>
<p>Right. A variation on the Observation-based extract where you can also specify a profile on Observation. So the same extract rules apply, but would ensure the result conforms to the profile (in this case, fixed category code). I think there are lots of IG out there with Observation profiles that might be asked for in a survey as well, so I hope this is more than just my problem :)</p>



<a name="220147031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220147031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220147031">(Dec 16 2020 at 17:36)</a>:</h4>
<p>I don't think there's any way to ensure that the result complies with the profile.  The best you could do is auto-populate fixed values, and perhaps have the item paths be aware of slicing names when performing extractions.</p>



<a name="220147055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220147055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220147055">(Dec 16 2020 at 17:36)</a>:</h4>
<p>Can you submit a change request for us to discuss this?</p>



<a name="220156325"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220156325" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220156325">(Dec 16 2020 at 18:49)</a>:</h4>
<p>Would something doing the extraction just be expected to set meta.profile, or to know that a particular profile means add a particular category?</p>



<a name="220169569"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220169569" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220169569">(Dec 16 2020 at 20:37)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  -- that is a good point. e.g. there would be no way to specify to fix the category.</p>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span>  -- yes, the profile fixes category to be <code>survey</code>, and in this case the Questionnaire is an AOE survey. I want to be able to differentiate Observations from the survey from others.</p>



<a name="220190031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220190031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220190031">(Dec 16 2020 at 23:51)</a>:</h4>
<p><span class="user-mention" data-user-id="191782">@Brian Kaney</span>  Couldn't you differentiate by meta.profile?  You could search for them using _profile.</p>



<a name="220192520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220192520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220192520">(Dec 17 2020 at 00:21)</a>:</h4>
<p>Wouldn’t Observation.derivedFrom work? You could then tie that to the canonical URL of the questionnaire in  QuestionnaireResponses.questionnaire? Alternatively, isn’t there a role here for providence?</p>



<a name="220376241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220376241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220376241">(Dec 18 2020 at 14:16)</a>:</h4>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span> - I will think about that. I haven't used <code>profile</code> in that way before (e.g. for querying purposes). So if I understand what you are proposing -- the semantics would be if an Observation is known to conform to a profile (e.g. it has a profile claim and we trust the server has validated it), it is of a certain kind of Observation?</p>
<p><span class="user-mention" data-user-id="191380">@Elliot Silver</span> - I think either of these could work in this case (of knowing the Observation came from a survey)</p>
<p>But I was wondering if there was a more general solution for specifying Observation profiles with questionnaires. For instance if we wanted to ask a question about a patient's TNM stage and would like to specify the Observation would use a profile such as <a href="http://hl7.org/implement/standards/fhir/us/mcode/StructureDefinition-mcode-tnm-clinical-primary-tumor-category.html">http://hl7.org/implement/standards/fhir/us/mcode/StructureDefinition-mcode-tnm-clinical-primary-tumor-category.html</a></p>



<a name="220377231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220377231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220377231">(Dec 18 2020 at 14:25)</a>:</h4>
<p>That sounds to me like what Observation.code is for.  The page you link to suggests LOINC code 21905-5.</p>



<a name="220378110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220378110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220378110">(Dec 18 2020 at 14:32)</a>:</h4>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span>  - So would a general solution be to ensure the questionnaire item would only ever allow for a valid Observation (e.g. code, available answers) and then specify the profile in <code>item.definition</code> (without a<code>#</code> segment). When extracting the Observation use the Observation-based technique, then simply copy over the definition and add to the Observation.meta.profile list?</p>



<a name="220379085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220379085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220379085">(Dec 18 2020 at 14:40)</a>:</h4>
<p>Observation based extraction is based on item.code, which becomes the Observation code.  It there is a list associated with that code (e.g. a LOINC answer list), you would make sure the Questionnaire definition has the correct list.  The derivedFrom field would get set to the QuestionnaireResponse (a reference).  Given a particular Observation, you could check derivedFrom to know whether it can from a Questionnaire, and you could query for Observations that came from a particular patient's QuesitonnaireResponse, but I don't think you could search the server to get a list of Observations that came from any QuestionnaireResponse.  (I'm not sure if that is what you want, anyway.)  item.definition gets used for other purposes, so I am uneasy about putting a profile URL there.  If putting a profile on it is important (though I am still not sure why people do that, when there is there is Observation.code) then I think a new extension would be needed.</p>



<a name="220380518"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220380518" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220380518">(Dec 18 2020 at 14:52)</a>:</h4>
<p>Thank <span class="user-mention" data-user-id="195344">@Paul Lynch</span> for helping me think through this!</p>
<blockquote>
<p>but I don't think you could search the server to get a list of Observations that came from any QuestionnaireResponse</p>
</blockquote>
<p>My use-case is to know that an observation came from a survey (verses somewhere else, such lab results). So for me using derivedFrom will work nicely.</p>
<blockquote>
<p>If putting a profile on it is important (though I am still not sure why people do that, when there is there is Observation.code) then I think a new extension would be needed.</p>
</blockquote>
<p>Well I think it is important as I would like to validate the extracted Observation when it comes time to save it. But maybe I am alone in this thinking this is important...</p>



<a name="220381786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/SDC%20Extraction%20%3A%20simple%20with%20a%20profile/near/220381786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/SDC.20Extraction.20.3A.20simple.20with.20a.20profile.html#220381786">(Dec 18 2020 at 15:02)</a>:</h4>
<p>You are definitely not alone, but I don't understand the reasoning behind it. If the profile just tells you that the Observation should have a certain code, then why not just validate the code?  But, I think you started out saying the profile specifies a category for the Observation, and not it's code, so maybe there is some utility if you are trying to constrain more that one field.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
