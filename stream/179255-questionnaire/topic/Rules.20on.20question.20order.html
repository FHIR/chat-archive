---
layout: page
title: "FHIR Chat  · Rules on question order · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html">Rules on question order</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="217185883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217185883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217185883">(Nov 18 2020 at 19:37)</a>:</h4>
<p>I want to implement a set of rules that dictate an ordering of questions.  I have an array of rules that are processed in order and if one of the rules fires, it indicates which question to go to next via the linkId.  I don't see anything in the SDC that can handle this but I thought before I created an extension, I'd ask if someone has already done something around question logic.</p>



<a name="217225116"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217225116" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217225116">(Nov 19 2020 at 03:10)</a>:</h4>
<p>At the moment, all items in a questionnaire have a fixed order.  You can cause some to turn on and off based on other answers, but you can't change their order of appearance.  Can you give an example of where changing order would be necessary?</p>



<a name="217227869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217227869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217227869">(Nov 19 2020 at 04:07)</a>:</h4>
<p>Unless you use the dynamic questionnaire stuff that was part of the Argonaut work, <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> wherebis that defined again?</p>



<a name="217227960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217227960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217227960">(Nov 19 2020 at 04:09)</a>:</h4>
<p>We have a questionnaire with branches.  I like to think of them as Choose-Your-Adventure questionnaires. :) Our rules can be based on what you just answered as well as characteristics of the submitter or source.  We looked at 'enableWhen' but since one question could appear in different branches at different points, the rules for enableWhen would get quite complicated.</p>



<a name="217228017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228017">(Nov 19 2020 at 04:10)</a>:</h4>
<p>Take a look at the SDC adaptive questionnaire. I think this allows you to load the "next page" based on the results of the questionnaire so far.</p>



<a name="217228025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228025">(Nov 19 2020 at 04:11)</a>:</h4>
<p>i did look at that but didn't find, i'll go take another look</p>



<a name="217228032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228032">(Nov 19 2020 at 04:11)</a>:</h4>
<p><a href="http://build.fhir.org/ig/HL7/sdc/adaptive.html">http://build.fhir.org/ig/HL7/sdc/adaptive.html</a></p>



<a name="217228272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228272">(Nov 19 2020 at 04:16)</a>:</h4>
<p>right, i remember reading that, but that assumes a server with the question dynamically determined.  this is sort of like that except that I want to exchange the rules for determining the next question with the questionnaire itself</p>



<a name="217228276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228276">(Nov 19 2020 at 04:16)</a>:</h4>
<p>Hmm, it seems to require a certain amount of support on the server side; I don't see a way to define the full logic in the questionnaire.</p>



<a name="217228278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228278">(Nov 19 2020 at 04:16)</a>:</h4>
<p>right.</p>



<a name="217228440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228440">(Nov 19 2020 at 04:20)</a>:</h4>
<p>If complex enableWhen conditions are your main block, what about using a variable to factor out those conditions?</p>



<a name="217228508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228508">(Nov 19 2020 at 04:22)</a>:</h4>
<p>I just looked at the hidden extension, but that won't do what you want either--it only takes a constant true/false, not a dynamic value.</p>



<a name="217228694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217228694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217228694">(Nov 19 2020 at 04:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191380">Elliot Silver</span> <a href="#narrow/stream/179255-questionnaire/topic/Rules.20on.20question.20order/near/217228440">said</a>:</p>
<blockquote>
<p>If complex enableWhen conditions are your main block, what about using a variable to factor out those conditions?</p>
</blockquote>
<p>Yes, except that the problem is that I have different branches where the same question occurs in different spots.  So if I had a list of questions 1,2,3,4,5, one branch might be 1,3,4,5, another might be 1,2,5,3,4, etc.</p>



<a name="217264272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217264272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217264272">(Nov 19 2020 at 12:51)</a>:</h4>
<p>Can you give a specific example why sometimes 5 needs to be asked before 3 and 4 and sometimes after?</p>



<a name="217302678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217302678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217302678">(Nov 19 2020 at 17:25)</a>:</h4>
<p>i was making that example up out of whole cloth.  let me find a real branching example that has behaviour like this</p>



<a name="217304552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217304552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217304552">(Nov 19 2020 at 17:39)</a>:</h4>
<p>okay, the questionnaire that I found had a set of questions for everyone, a set of questions for males, a set of questions for females, and then some wrap-up questions.  I can actually reduce the amount of branching by applying some logic, but that wasn't the way that the questionnaire was created in the system.</p>



<a name="217305011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217305011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217305011">(Nov 19 2020 at 17:43)</a>:</h4>
<p>i've abstracted the questions and reordered the branches so that it looks like this:</p>
<div class="codehilite"><pre><span></span><code>1) What is your gender?  M/F/O
    if M and age &gt; 40, go to 2
    if M and age &lt;= 40, go to 22
    if F and age &gt; 20, go to 10
    if F and age &lt;= 20, go to 22
    if O, go to 22

2) Have you been screened for prostate cancer? Y/N
    if Y, go to 4
    if N, go to 20

3) Have you been screened for breast cancer? Y/N
    if Y, go to 16
    if N, go to 20

4-10) questions about prostate cancer screening experience with logic based on answers
    last question has go to 16

11-15) questions about breast cancer screening experience with logic based on answers
    last question has go to 16

16-19) general questions about cancer screening experience, potentially with logic

20) Would you like to book a cancer screening appointment? Y/N
    If Y, go to 21
    If N, go to 22

21) (no question, just info about appointment booking)

22) (no question, just thank you slide)
</code></pre></div>



<a name="217305270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217305270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217305270">(Nov 19 2020 at 17:44)</a>:</h4>
<p>this is how the questionnaire was really laid out (again abstracted as it was way more complex):</p>
<div class="codehilite"><pre><span></span><code>1) What is your gender?  M/F/O
    if M and age &gt; 40, go to 2
    if M and age &lt;= 40, go to 22
    if F and age &gt; 20, go to 10
    if F and age &lt;= 20, go to 22
    if O, go to 22

2) Have you been screened for prostate cancer? Y/N
    if Y, go to 4
    if N, go to 20

3-9) questions about prostate cancer screening experience with logic based on answers

10-13) general questions about cancer screening experience, potentially with logic
    last question has go to 20

14) Have you been screened for breast cancer? Y/N
    if Y, go to 15
    if N, go to 20

15-19) questions about breast cancer screening experience with logic based on answers
    last question has go to 10

20) Would you like to book a cancer screening appointment? Y/N
    If Y, go to 21
    If N, go to 22

21) (no question, just info about appointment booking)

22) (no question, just thank you slide)
</code></pre></div>



<a name="217305857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217305857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217305857">(Nov 19 2020 at 17:49)</a>:</h4>
<p>Having done the reordering above, I don't actually want to force the users to a) go back and reorder the Questionnaires they have already created and b) reduce branching as much as possible in their new created Questionnaires.  I just want to convey the logic that they are creating.  I've created an extension for these rules since I couldn't find anything in SDC.</p>



<a name="217306552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217306552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217306552">(Nov 19 2020 at 17:54)</a>:</h4>
<p>This looks like it can be handled without any re-ordering.  You just turn off the stuff that's not relevant based on prior answers.</p>



<a name="217306916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217306916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217306916">(Nov 19 2020 at 17:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179255-questionnaire/topic/Rules.20on.20question.20order/near/217306552">said</a>:</p>
<blockquote>
<p>This looks like it can be handled without any re-ordering.  You just turn off the stuff that's not relevant based on prior answers.</p>
</blockquote>
<p>Sure.  We could use 'enableWhen' but the rules will get quite complex.  I suspect that the development team (which was developing these before I introduced the notion of FHIR Questionnaires) may have considered that but since the rules got too complex and the idea of a Choose-Your-Adventure Questionnaire seemed simpler, they went with that.</p>



<a name="217313112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217313112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217313112">(Nov 19 2020 at 18:47)</a>:</h4>
<p>Are you showing one question at a time?  "go to" might or might not mean hide the others.<br>
enableWhenExpression gives you more flexibility than enableWhen.<br>
The disadvantage of your custom extension is that other systems won't understand it.<br>
You could submit a change request....</p>



<a name="217315530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217315530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217315530">(Nov 19 2020 at 19:06)</a>:</h4>
<p>Yes, I am showing one question at a time.  "go to" meant purely skip forward to question with linkId x.  I'm going to keep looking at enableWhenExpression and see if I can use that, but the basic problem is that the semantics are the inverse of what I have in my data.</p>



<a name="217317035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217317035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217317035">(Nov 19 2020 at 19:18)</a>:</h4>
<p>Yes, it is inverse, and enableWhen(Expression) has the drawback that if you want to skip from question 1 to question 10 based on question 1's answer, you have to put the enableWhen(Expression) on 8 questions.  As Brian said, you could simplify those expressions with a variable, but they still have to be there.<br>
I suppose you could write some code to take a set of "go to" rules and generate the right enableWhenExpressions.<br>
If support for "go to" were added, questionnaire renderers that show the full questionnaire would have to implement that same transformation to enabled states to determine which questions should be visible.</p>



<a name="217317341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/217317341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#217317341">(Nov 19 2020 at 19:20)</a>:</h4>
<p>You could also point those questions inside a group - but still number them as if they weren't.  Then your enableWhen would only need to appear on the group.</p>



<a name="222249296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Rules%20on%20question%20order/near/222249296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Rules.20on.20question.20order.html#222249296">(Jan 11 2021 at 00:08)</a>:</h4>
<p>The simplest answer to this one is the adaptive mode where they only present the questions at each stage.<br>
Jumping about is going to make things very interesting depending on the way that your renderer displays things, and what is practical on the form factor.<br>
Going backwards is always an interesting thing to do - and how would that be handled if you just had a back/next button and showed some content, you'd need to be maintaining an interesting stack of pages/questions?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
