---
layout: page
title: "FHIR Chat  · Questionnaires with Math · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html">Questionnaires with Math</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154000291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000291">(Sep 27 2018 at 15:06)</a>:</h4>
<p>Is it right to embed Math Logic in a questionnaire? <br>
questionItem1 reponse = 3<br>
questionItem2 response= 10 </p>
<p>Would there be a place where i could embed the math logic into? Item1 + Item2.<br>
I was thinking about this example: <a href="https://www.hl7.org/fhir/questionnaire-example-gcs.json.html" target="_blank" title="https://www.hl7.org/fhir/questionnaire-example-gcs.json.html">https://www.hl7.org/fhir/questionnaire-example-gcs.json.html</a> It is a math based questionnaire but leaves calculations to the client side perhaps.</p>



<a name="154000293"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000293" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000293">(Sep 27 2018 at 15:09)</a>:</h4>
<p>Take a look at the structured data capture implementation guide.  It provides some guidance in this space (though more is still needed).  Essentially you're going to use the "variable" extension and the "calculatedExpression" extension</p>



<a name="154000294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000294">(Sep 27 2018 at 15:24)</a>:</h4>
<p>great. thanks. will check back</p>



<a name="154000313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000313">(Sep 27 2018 at 15:58)</a>:</h4>
<p>Seems like its not for r3?</p>



<a name="154000320"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000320" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000320">(Sep 27 2018 at 16:10)</a>:</h4>
<p>Correct, though you can adopt the same approach in R3 with a custom extension</p>



<a name="154000913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000913">(Sep 28 2018 at 04:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> why is argonaut using different extensions than SDC defines:</p>
<div class="codehilite"><pre><span></span>      &lt;extension url=&quot;http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/extension-score&quot;&gt;
        &lt;valueDecimal value=&quot;17&quot;/&gt;
      &lt;/extension&gt;
</pre></div>



<a name="154000939"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000939" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000939">(Sep 28 2018 at 06:13)</a>:</h4>
<p>1) for STU3<br>
2) There was no extension for option.valueString or for items...which we only fixed for R4</p>



<a name="154000947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000947">(Sep 28 2018 at 10:21)</a>:</h4>
<p>I don't understand why either of those is a reason not to use the SDC extension URL</p>



<a name="154000990"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000990" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000990">(Sep 28 2018 at 13:28)</a>:</h4>
<p>Score shouldn't be an extension - score should be the answer to a question</p>



<a name="154000995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154000995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154000995">(Sep 28 2018 at 13:31)</a>:</h4>
<p>it should be the calculdated-value extension</p>



<a name="154001024"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001024" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001024">(Sep 28 2018 at 15:00)</a>:</h4>
<p>The calculated-value tells you the calculation.  The actual score goes in the item.answer.value</p>



<a name="154001052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001052">(Sep 28 2018 at 15:23)</a>:</h4>
<p>of so that's the ordinal value extension - why not use that one?</p>



<a name="154001064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001064">(Sep 28 2018 at 15:26)</a>:</h4>
<p>Ordinal value is for a code or option.  It's tied to the choice, it's not dynamic.</p>



<a name="154001068"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001068" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001068">(Sep 28 2018 at 15:29)</a>:</h4>
<p>so that's what the extension above is?</p>



<a name="154001079"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001079" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001079">(Sep 28 2018 at 15:52)</a>:</h4>
<p>The extension above is the formula, not the value.</p>



<a name="154001080"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001080" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001080">(Sep 28 2018 at 15:53)</a>:</h4>
<p>The value of the score is conveyed as the answer to a question.  It can be a hidden question if you don't want the person filling the form to see the score.</p>



<a name="154001181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001181">(Sep 29 2018 at 04:58)</a>:</h4>
<p>the argonaut extension has <strong>nothing</strong> to  do with a calculated value -  it is what value is assigned to the question.  I  see how the word "score" is confusing and will need to change that.   There is no scoring -as in calculating the score and providing that- extensions for the Argo Q - just numbers that can be assigned to any type of question.   The total score could be a hidden q-a pair though we don't document that.</p>



<a name="154001189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001189">(Sep 29 2018 at 08:23)</a>:</h4>
<p>I'm not understanding this then. What is 'the score' if it's not the ordinal value?</p>



<a name="154001228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001228">(Sep 29 2018 at 10:40)</a>:</h4>
<p>see this example.   Score=17 is the integer value associated with that question.  Its is static number and not calculated - I think you make a good point as to what it means when calculating a total score since is open to interpretation.   it could be a weight a, or a max for that question/group etc.    Its easier to interpret a score in the second example  when is a multiple choice since its easier to intepret each choice having a value or weight that can be used to calculate  a total.  <a href="/user_uploads/10155/voxWd0lQ5qHqBrgLviDaHH5u/Screen-Shot-2018-09-29-at-3.23.57-AM.png" target="_blank" title="Screen-Shot-2018-09-29-at-3.23.57-AM.png">Screen-Shot-2018-09-29-at-3.23.57-AM.png</a> <a href="/user_uploads/10155/oztyd-TZ5A3QmX0T-pRXCSg-/Screen-Shot-2018-09-29-at-3.40.30-AM.png" target="_blank" title="Screen-Shot-2018-09-29-at-3.40.30-AM.png">Screen-Shot-2018-09-29-at-3.40.30-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/voxWd0lQ5qHqBrgLviDaHH5u/Screen-Shot-2018-09-29-at-3.23.57-AM.png" target="_blank" title="Screen-Shot-2018-09-29-at-3.23.57-AM.png"><img src="/user_uploads/10155/voxWd0lQ5qHqBrgLviDaHH5u/Screen-Shot-2018-09-29-at-3.23.57-AM.png"></a></div><div class="message_inline_image"><a href="/user_uploads/10155/oztyd-TZ5A3QmX0T-pRXCSg-/Screen-Shot-2018-09-29-at-3.40.30-AM.png" target="_blank" title="Screen-Shot-2018-09-29-at-3.40.30-AM.png"><img src="/user_uploads/10155/oztyd-TZ5A3QmX0T-pRXCSg-/Screen-Shot-2018-09-29-at-3.40.30-AM.png"></a></div>



<a name="154001229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001229">(Sep 29 2018 at 10:42)</a>:</h4>
<p>and like  I said before the word 'score' here may be confusing.  'weight' or 'integer value associated wth this item' might be better</p>



<a name="154001231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001231">(Sep 29 2018 at 10:44)</a>:</h4>
<p>here is a score associated with a text answer...</p>



<a name="154001232"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001232" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001232">(Sep 29 2018 at 10:45)</a>:</h4>
<p><a href="/user_uploads/10155/RzcwrWNrqlcGvNR7QzsS9JE_/Screen-Shot-2018-09-29-at-3.44.08-AM.png" target="_blank" title="Screen-Shot-2018-09-29-at-3.44.08-AM.png">Screen-Shot-2018-09-29-at-3.44.08-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/RzcwrWNrqlcGvNR7QzsS9JE_/Screen-Shot-2018-09-29-at-3.44.08-AM.png" target="_blank" title="Screen-Shot-2018-09-29-at-3.44.08-AM.png"><img src="/user_uploads/10155/RzcwrWNrqlcGvNR7QzsS9JE_/Screen-Shot-2018-09-29-at-3.44.08-AM.png"></a></div>



<a name="154001233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001233">(Sep 29 2018 at 10:51)</a>:</h4>
<p>so this is the ordinalValue extension then</p>



<a name="154001234"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001234" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001234">(Sep 29 2018 at 11:00)</a>:</h4>
<p>yes and it predated the expansion of  its context and consolidation of all the various extensions , I plan to update the name of it to align with it.  Its the STU3 version of it</p>



<a name="154001235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001235">(Sep 29 2018 at 11:01)</a>:</h4>
<p>well can we do that for this connectathon?</p>



<a name="154001236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001236">(Sep 29 2018 at 11:04)</a>:</h4>
<p>Its unlikely I will have a chance to change it before then.</p>



<a name="154001238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001238">(Sep 29 2018 at 11:06)</a>:</h4>
<p>There are other things that predate SDC and will need to be aligned too.</p>



<a name="154001255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001255">(Sep 29 2018 at 11:38)</a>:</h4>
<p>.. all my tooling is SDC based :-(</p>



<a name="154001257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001257">(Sep 29 2018 at 11:38)</a>:</h4>
<p>Why is that a frowny-face? ;)</p>



<a name="154001258"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001258" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001258">(Sep 29 2018 at 11:39)</a>:</h4>
<p>because the questionnaires for the connectathon track are not consistent with SDC, so my tooling isn't applicable</p>



<a name="154001263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154001263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154001263">(Sep 29 2018 at 11:41)</a>:</h4>
<p>I did understand that.  And am happy the intention is to align</p>



<a name="154020656"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154020656" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Koray Atalag <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154020656">(Nov 24 2018 at 04:19)</a>:</h4>
<blockquote>
<p>Take a look at the structured data capture implementation guide.  It provides some guidance in this space (though more is still needed).  Essentially you're going to use the "variable" extension and the "calculatedExpression" extension</p>
</blockquote>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> is there an example using these two extensions?</p>



<a name="154020667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154020667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154020667">(Nov 24 2018 at 20:07)</a>:</h4>
<p>Not yet.  I hope to have time to work on examples in December and January in advance of the connectathon.</p>



<a name="154020874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154020874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154020874">(Nov 26 2018 at 15:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191420">@Koray Atalag</span> I have an example here: <a href="https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/weight-height-questionnaire.json" target="_blank" title="https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/weight-height-questionnaire.json">https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/weight-height-questionnaire.json</a></p>
<p>which calculates a BMI, though it has a couple of minor problems:</p>
<p>1) In the questionnaire-calculatedExpression, I think the correct FHIRPath would put "%resource.item" where I just have "item".<br>
2) it is still using R3 syntax for the lists ("option" instead of "answerOption")-- but I think that issue is probably not relevant.</p>
<p>You can upload this example into our viewer here:  <a href="https://apps.smarthealthit.org/app/lforms-questionnaire-app" target="_blank" title="https://apps.smarthealthit.org/app/lforms-questionnaire-app">https://apps.smarthealthit.org/app/lforms-questionnaire-app</a> and see it working.</p>



<a name="154860362"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154860362" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154860362">(Jan 10 2019 at 18:23)</a>:</h4>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span>  Thanks for the links. I have a related question:<br>
I noticed the QuestionnaireResponse created through the SMART App "LHNCPC SDC Questionnaire App", does not calculate the BMI through FHIRPath, is this because it is a server side step and the QR is autoupdated after upload with the appropriate result?</p>



<a name="154860857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154860857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154860857">(Jan 10 2019 at 18:31)</a>:</h4>
<p>First, I should point out that due to a reorganization of the files, the updated link for the Questionnaire example is at <a href="https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/R4/weight-height-questionnaire.json" target="_blank" title="https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/R4/weight-height-questionnaire.json">https://raw.githubusercontent.com/lhncbc/lforms-fhir-app/master/e2e-tests/data/R4/weight-height-questionnaire.json</a> .</p>
<p>As you'll see in that example, the BMI is calculated through FHIRPath (search for "BMI calculation").  It is done on the client side.  The QuestionnaireResponse ("Show As"-&gt;"FHIR QuestionnaireResponse (SDC)") also includes the value that was calculated.</p>
<p>I just updated the system this morning, and of course after the update was live, found a couple of bugs which I am working to fix.  But, the above example still works.</p>



<a name="154863602"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154863602" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154863602">(Jan 10 2019 at 19:13)</a>:</h4>
<p>Perfect, thanks. <br>
I couldn't get the calculated BMI item in QR SDC at <a href="https://lhncbc.github.io/lforms-fhir-app/" target="_blank" title="https://lhncbc.github.io/lforms-fhir-app/">https://lhncbc.github.io/lforms-fhir-app/</a> <br>
I used both stu3 and the r3 sample through upload.</p>



<a name="154863760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154863760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154863760">(Jan 10 2019 at 19:15)</a>:</h4>
<p>The calculatedExpression extension is for R4, so you would need to use the R4 example.</p>



<a name="154864350"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154864350" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154864350">(Jan 10 2019 at 19:24)</a>:</h4>
<p>Did you mean R4?  I see you wrote both "STU3" and "r3" which are the same.  I just tried the R4 example there and it worked.</p>



<a name="154864426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154864426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154864426">(Jan 10 2019 at 19:25)</a>:</h4>
<p><a href="/user_uploads/10155/RdshTwHYSYixrh_p-6Z4yyec/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/RdshTwHYSYixrh_p-6Z4yyec/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/RdshTwHYSYixrh_p-6Z4yyec/pasted_image.png"></a></div>



<a name="154867528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154867528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154867528">(Jan 10 2019 at 20:12)</a>:</h4>
<p>Sorry, I meant R4. For some reason, that isn't working for me when I try it. I'll try again with the right file.</p>



<a name="154878449"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/154878449" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#154878449">(Jan 10 2019 at 22:44)</a>:</h4>
<p><span class="user-mention" data-user-id="194948">@Raheel Sayeed</span> One thing that might be causing confusion is that, while the BMI calculation will run after you upload the form, after you have saved form to the server and pull it back, it will no longer run, because the server is STU3 (and so the resource that is saved and comes back no longer has the R4 extensions).</p>



<a name="155187998"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/155187998" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#155187998">(Jan 15 2019 at 17:34)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="195344">@Paul Lynch</span> that was an issue.</p>



<a name="159014488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159014488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159014488">(Feb 20 2019 at 21:01)</a>:</h4>
<p><span class="user-mention" data-user-id="194948">@Raheel Sayeed</span> It just (re-)discovered that LHC-Forms somewhat accidentally does support calculatedExpression for STU3 questionnaires, and there are tests in LHC-Forms for that functionality with STU3.  This means that support does exist on the <a href="https://apps.smarthealthit.org/app/lforms-questionnaire-app" target="_blank" title="https://apps.smarthealthit.org/app/lforms-questionnaire-app">NLM SDC Questionnaire SMART app</a>.  For an example STU3 form that uses calculatedExpression to do a BMI value, see <a href="https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json" target="_blank" title="https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json">https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json</a>.  You can use the "upload" button on the SMART app to upload it and try it.  (Ignore the warning message you get.)</p>



<a name="159100645"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159100645" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159100645">(Feb 21 2019 at 20:11)</a>:</h4>
<p>Whooa, this is great. thanks <span class="user-mention" data-user-id="195344">@Paul Lynch</span></p>



<a name="159620299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159620299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159620299">(Feb 28 2019 at 14:53)</a>:</h4>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span> Have you implemented FHIRPath logic for the calculatedExpression? Can you point me to it in the app?</p>



<a name="159621440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159621440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159621440">(Feb 28 2019 at 15:07)</a>:</h4>
<p><span class="user-mention" data-user-id="194948">@Raheel Sayeed</span>  Did you look at <a href="https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json" target="_blank" title="https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json">https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json</a>?  If you search there for "calculatedExpression" you will see an example.</p>



<a name="159628158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159628158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159628158">(Feb 28 2019 at 16:19)</a>:</h4>
<p>I did, I was trying that in the app: <a href="https://apps.smarthealthit.org/app/lforms-questionnaire-app" target="_blank" title="https://apps.smarthealthit.org/app/lforms-questionnaire-app">https://apps.smarthealthit.org/app/lforms-questionnaire-app</a> ("Try App"), uploaded the resource you mentioned. It  does layout the form and upon saving it back, It calculated once, rightly showed the BMI in QR. But I couldn't replicate that behavior.</p>



<a name="159629187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159629187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159629187">(Feb 28 2019 at 16:30)</a>:</h4>
<p>By "replicate", do you mean that when you used calculatdExpression in your own questionnaire, and loaded it into that app, that the calculation didn't work?  If you'd like to email me the questionnaire, I'll take a look and see if I can spot the problem.  Assuming your questionnaire and expression are correct, it might be that you have run  into a bug.</p>



<a name="159630662"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159630662" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159630662">(Feb 28 2019 at 16:49)</a>:</h4>
<p>I meant the same questionnaire  ––&gt; <a href="https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json" target="_blank" title="https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json">https://raw.githubusercontent.com/lhncbc/lforms/master/test/data/STU3/weightHeightQuestionnaire.json</a> . Perhaps some issue with the sandbox its running against.</p>



<a name="159632967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159632967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159632967">(Feb 28 2019 at 17:16)</a>:</h4>
<p>Are you using "upload" to upload the form, or are you using a saved copy from the server?  The server's FHIR version is R3, so those copies don't have the calculatedExpression extension.</p>



<a name="159644439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159644439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159644439">(Feb 28 2019 at 19:31)</a>:</h4>
<p>Yes, did use upload. and it did work once. later uploads didn't quite work.</p>



<a name="159646101"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159646101" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159646101">(Feb 28 2019 at 19:53)</a>:</h4>
<p>Which web browser are you using?  I just retested with Firefox and Chrome, and it is working for me.  I do notice an issue with Edge (but the form there does not even load, so I don't think that is what you are seeing.)</p>



<a name="159647204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159647204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159647204">(Feb 28 2019 at 20:04)</a>:</h4>
<p>Totally worked. Safari was the problem. BMI is calculated at client side. </p>
<p>A question though: I see calculation happening client side. Ideally, on R4 servers, is this handled server side? A QR generated with an FHIRPath item, is updated with calculated value after POST.</p>



<a name="159649308"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159649308" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159649308">(Feb 28 2019 at 20:29)</a>:</h4>
<p><a href="http://hl7.org/fhir/2018Sep/extension-questionnaire-calculatedexpression.html" target="_blank" title="http://hl7.org/fhir/2018Sep/extension-questionnaire-calculatedexpression.html">http://hl7.org/fhir/2018Sep/extension-questionnaire-calculatedexpression.html</a> says, "Calculated value is updated as other answers in the QuestionnaireResponse are filled in."  So, the intent is that the BMI value updates in response to the user inputting/changing values.  After a QR is saved to a server, that BMI value does not automatically get updated based on new heights and weights saved in other resources.  (One could pull back a QuestionnaireResponse and edit the height &amp; weight values to get the BMI to update, but again that would be client-side.)</p>



<a name="159651306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/159651306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#159651306">(Feb 28 2019 at 20:55)</a>:</h4>
<p>(It also sounds like I should find a way to test from Safari.)</p>



<a name="161790343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/161790343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#161790343">(Mar 26 2019 at 18:32)</a>:</h4>
<p><span class="user-mention" data-user-id="194948">@Raheel Sayeed</span> I think I have fixed the Safari and Edge issues (which were different problems) in the <a href="https://apps.smarthealthit.org/app/lforms-questionnaire-app" target="_blank" title="https://apps.smarthealthit.org/app/lforms-questionnaire-app">SDC SMART app</a>.  As a side benefit to working on this problem, I now have a Mac in my office.</p>



<a name="163582842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaires%20with%20Math/near/163582842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Raheel Sayeed <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaires.20with.20Math.html#163582842">(Apr 17 2019 at 17:31)</a>:</h4>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span> Great! it works.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
