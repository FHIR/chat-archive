---
layout: page
title: "FHIR Chat  · Questionnaire population for a choice/code · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html">Questionnaire population for a choice/code</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="241178292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaire%20population%20for%20a%20choice/code/near/241178292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html#241178292">(Jun 02 2021 at 17:02)</a>:</h4>
<p>I am trying to prepopulate a questionnaire using fhirpath expression to convert a string to a code, specifically populating a patient's gender.<br>
In the example on "<a href="https://lhcforms.nlm.nih.gov/lforms-fhir-app/">https://lhcforms.nlm.nih.gov/lforms-fhir-app/</a>" for "US Surgeon General family health portrait [54127-6]" the resource Questionnaire has an initialExpression for Gender that uses %patient.gender, but this does not populate the questionnaire.<br>
I found this post "<a href="#narrow/stream/179266-fhirpath/topic/data.20extraction.20for.20Questionnaires">https://chat.fhir.org/#narrow/stream/179266-fhirpath/topic/data.20extraction.20for.20Questionnaires</a>" which is relevant but I was not able to find what was being discussed in the post in "<a href="http://hl7.org/fhirpath/">http://hl7.org/fhirpath/</a>" or "<a href="https://www.hl7.org/fhir/fhirpath.html">https://www.hl7.org/fhir/fhirpath.html</a>"<br>
I found <code>%terminologies.subsumes(system, coded1, coded2, params) : code</code> but wasn't sure if that could be used for this purpose.<br>
How can I populate the questionnaire for choice types?</p>



<a name="241181413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaire%20population%20for%20a%20choice/code/near/241181413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html#241181413">(Jun 02 2021 at 17:26)</a>:</h4>
<p><span class="user-mention" data-user-id="195344">@Paul Lynch</span></p>



<a name="241297041"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaire%20population%20for%20a%20choice/code/near/241297041" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html#241297041">(Jun 02 2021 at 18:09)</a>:</h4>
<p>Until <a href="http://jira.hl7.org/browse/FHIR-29324">FHIR#29324</a> is addressed, there isn't a way to create a Coding.  However, if you have a Coding somewhere in the Questionnaire, you can use iif statements to pick the Coding you want and assign it via initialExpression.</p>



<a name="241298406"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaire%20population%20for%20a%20choice/code/near/241298406" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html#241298406">(Jun 02 2021 at 18:17)</a>:</h4>
<p>Example (with calculatedExpression setting a choice item): <a href="https://lforms-fhir.nlm.nih.gov/baseR4/Questionnaire/88121-9-x?_format=json">https://lforms-fhir.nlm.nih.gov/baseR4/Questionnaire/88121-9-x?_format=json</a></p>



<a name="241451844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaire%20population%20for%20a%20choice/code/near/241451844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html#241451844">(Jun 03 2021 at 20:55)</a>:</h4>
<p>I tried following the example but wasn't able to get very far. I read the snippet about <a href="http://hl7.org/fhirpath/#iifcriterion-expression-true-result-collection-otherwise-result-collection-collection">iif</a> but still am not sure if I'm following the syntax correctly.<br>
I have the following under the extension for the choice for gender.</p>
<div class="codehilite"><pre><span></span><code>        {
            &quot;type&quot;: &quot;choice&quot;,
            &quot;code&quot;: [
                {
                    &quot;code&quot;: &quot;LL3324-2&quot;,
                    &quot;display&quot;: &quot;Sex assigned at birth&quot;,
                    &quot;system&quot;: &quot;http://loinc.org&quot;
                }
            ],
            &quot;extension&quot;: [
                {
                    &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl&quot;,
                    &quot;valueCodeableConcept&quot;: {
                        &quot;coding&quot;: [
                            {
                                &quot;system&quot;: &quot;http://hl7.org/fhir/questionnaire-item-control&quot;,
                                &quot;code&quot;: &quot;drop-down&quot;,
                                &quot;display&quot;: &quot;Drop down&quot;
                            }
                        ],
                        &quot;text&quot;: &quot;Drop down&quot;
                    }
                },
                {
                    &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/variable&quot;,
                    &quot;valueExpression&quot;: {
                        &quot;name&quot;: &quot;thisItem&quot;,
                        &quot;language&quot;: &quot;text/fhirpath&quot;,
                        &quot;expression&quot;: &quot;%questionnaire.item.where(linkId = &#39;/LL3324-2&#39;)&quot;
                    }
                },
                {
                    &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/variable&quot;,
                    &quot;valueExpression&quot;: {
                        &quot;name&quot;: &quot;maleCoding&quot;,
                        &quot;language&quot;: &quot;text/fhirpath&quot;,
                        &quot;expression&quot;: &quot;%thisItem.answerOption.valueCoding.where(code=&#39;LA2-8&#39;)&quot;
                    }
                },
                {
                    &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/variable&quot;,
                    &quot;valueExpression&quot;: {
                        &quot;name&quot;: &quot;femaleCoding&quot;,
                        &quot;language&quot;: &quot;text/fhirpath&quot;,
                        &quot;expression&quot;: &quot;%thisItem.answerOption.valueCoding.where(code=&#39;LA3-6&#39;)&quot;
                    }
                },
                {
                    &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/questionnaire-calculatedExpression&quot;,
                    &quot;valueExpression&quot;: {
                        &quot;description&quot;: &quot;Birthsex from patient resource&quot;,
                        &quot;language&quot;: &quot;text/fhirpath&quot;,
                        &quot;expression&quot;: &quot;iif(%patient.gender=&#39;male&#39;, %maleCoding, %femaleCoding)&quot;
                    }
                }
            ],
            &quot;required&quot;: false,
            &quot;linkId&quot;: &quot;/LL3324-2&quot;,
            &quot;text&quot;: &quot;Sex assigned at birth&quot;,
            &quot;answerOption&quot;: [
                {
                    &quot;valueCoding&quot;: {
                        &quot;code&quot;: &quot;LA2-8&quot;,
                        &quot;display&quot;: &quot;Male&quot;
                    }
                },
                {
                    &quot;valueCoding&quot;: {
                        &quot;code&quot;: &quot;LA3-6&quot;,
                        &quot;display&quot;: &quot;Female&quot;
                    }
                },
                {
                    &quot;valueCoding&quot;: {
                        &quot;code&quot;: &quot;LA4489-6&quot;,
                        &quot;display&quot;: &quot;Unknown&quot;
                    }
                }
            ]
        },
</code></pre></div>



<a name="241470584"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaire%20population%20for%20a%20choice/code/near/241470584" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html#241470584">(Jun 03 2021 at 23:44)</a>:</h4>
<p>That looks good, as far as I can see.   Do you have "patient" defined from a launchContext extension somewhere?</p>



<a name="241542928"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/Questionnaire%20population%20for%20a%20choice/code/near/241542928" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/Questionnaire.20population.20for.20a.20choice.2Fcode.html#241542928">(Jun 04 2021 at 14:26)</a>:</h4>
<p>Yes, I have the following, however the field for gender is not being prepopulated and there are no error messages.</p>
<p>Is the syntax for the comparison <code>"$patient.gender = 'male' </code>and the syntax for the iif correct?<br>
<code>iif(%patient.gender='male', %maleCoding, %femaleCoding)</code></p>
<p>Also, is there a way to hardcode a initialExpression for a choice type? It may give me more insight.</p>
<p>launchContext for Patient under extension</p>
<div class="codehilite"><pre><span></span><code>        {
            &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/questionnaire-launchContext&quot;,
            &quot;extension&quot;: [
                {
                    &quot;url&quot;: &quot;name&quot;,
                    &quot;valueId&quot;: &quot;patient&quot;
                },
                {
                    &quot;url&quot;: &quot;type&quot;,
                    &quot;valueCode&quot;: &quot;Patient&quot;
                },
                {
                    &quot;url&quot;: &quot;descripton&quot;,
                    &quot;valueString&quot;: &quot;For filling in patient information as the subject for the form&quot;
                }
            ]
        }
</code></pre></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
