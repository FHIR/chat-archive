---
layout: page
title: "FHIR Chat  · EnableWhen Expressions · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html">EnableWhen Expressions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="198169287"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/198169287" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#198169287">(May 20 2020 at 08:42)</a>:</h4>
<p><a href="http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983">http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983</a></p>



<a name="198211401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/198211401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#198211401">(May 20 2020 at 15:03)</a>:</h4>
<p><span class="user-mention" data-user-id="217312">@Joee Garcia</span> Do we have one for this yet?</p>



<a name="198236540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/198236540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joee Garcia <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#198236540">(May 20 2020 at 18:12)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> , I've just added the demo questionnaire I'm working on for advanced form behavior here: <a href="http://build.fhir.org/ig/HL7/sdc/behavior.html#example">http://build.fhir.org/ig/HL7/sdc/behavior.html#example</a> .  It has an example on how to use enableWhenExpression.</p>



<a name="203932813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/203932813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bas Harmsen <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#203932813">(Jul 15 2020 at 09:26)</a>:</h4>
<p>When looking at the example (I think the url is now: <a href="http://build.fhir.org/ig/HL7/sdc/examples.html#using-enablewhen-enablebehavior-and-enablewhenexpression">http://build.fhir.org/ig/HL7/sdc/examples.html#using-enablewhen-enablebehavior-and-enablewhenexpression</a>) I noticed that it uses <code>%resource.repeats(item).where(...)</code>. As I understand <code>%resource</code> is the same for all items in the Questionnaire and when items can repeat this may be a problem. I think I found a nice solution and posted it in the mentioned thread (this reply: <a href="http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983/8">http://community.fhir.org/t/how-do-i-use-enablewhenexpression/1983/8</a>) Since there has not yet been a reply to this post, I would like to ask if there are people here who could look at it.</p>



<a name="203972160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/203972160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#203972160">(Jul 15 2020 at 15:40)</a>:</h4>
<p>That example should be "repeat(item)" not "repeats(item)".  It is using the repeat function in FHIRPath: <a href="http://hl7.org/fhirpath/#repeatprojection-expression-collection">http://hl7.org/fhirpath/#repeatprojection-expression-collection</a>, not item.repeats.</p>



<a name="203981326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/203981326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bas Harmsen <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#203981326">(Jul 15 2020 at 16:47)</a>:</h4>
<p>Reading my message again I see that it's a little bit confusing. I'm aware of the <code>repeat</code> function but I forgot that it's called <code>repeat</code> and not <code>repeats</code>. So the first repeats in my message refers to the FHIRpath <code>repeat</code>-function and the second one to the <code>repeats</code>-element in a Questionnaire.</p>
<p>The problem I see is that there is no context when using <code>%resource.repeat(item).where(...)</code> and the <code>repeats</code> element is set to true for some group-item. When a group can repeat and one of the items should only be enabled in the case that a given item in the same group meets some condition then the expression should be evaluated in a certain context. It seems to me that<code>'%resource.repeat(item).where(...)</code> refers 'globally' to all elements that meet the condition and not just to the item relative to the item for which enableWhenExpression is evaluated.<br>
Edit: I’m aware that in the example in the implementation guide the item cannot repeat but I’d like to know if my solution for the case that it may repeat is correct.</p>



<a name="204020146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/204020146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#204020146">(Jul 15 2020 at 22:20)</a>:</h4>
<p>Yes, using variables is the appropriate solution when using enableWhen inside repeating groups.</p>



<a name="204059822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/204059822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bas Harmsen <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#204059822">(Jul 16 2020 at 08:56)</a>:</h4>
<p>Thanks for your answer.</p>



<a name="253465292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/253465292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#253465292">(Sep 15 2021 at 18:34)</a>:</h4>
<p>The tracker #33295 - Having discussed and reviewed this with Paul, looks like the description is actually now different to invariants - which I don't think was intended.</p>



<a name="253465471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/EnableWhen%20Expressions/near/253465471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/EnableWhen.20Expressions.html#253465471">(Sep 15 2021 at 18:35)</a>:</h4>
<p><a href="https://github.com/FirelyTeam/firely-net-common/blob/d652305916bcc7fdc32337e5cb71bf8a763c91c3/src/Hl7.FhirPath/FhirPath/CompiledExpression.cs#L28">https://github.com/FirelyTeam/firely-net-common/blob/d652305916bcc7fdc32337e5cb71bf8a763c91c3/src/Hl7.FhirPath/FhirPath/CompiledExpression.cs#L28</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
