---
layout: page
title: "FHIR Chat  · &quot;variables are only calculated when prepopulating&quot; · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html">&quot;variables are only calculated when prepopulating&quot;</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154024244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024244">(Dec 10 2018 at 22:10)</a>:</h4>
<p>Another part of Grahame's blog post (which is a good resource, though getting outdated) says, "variables are only calculated when prepopulating".  Is that still the case?  Since the Expression for a variable could be a FHIRPath expression, I am not sure why that should be.</p>



<a name="154024256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024256">(Dec 10 2018 at 22:30)</a>:</h4>
<p>I don't think <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>'s statement is true.  Variables could be calculated for other reasons.</p>



<a name="154024620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024620">(Dec 11 2018 at 21:51)</a>:</h4>
<p>what other reasons?</p>



<a name="154024623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024623">(Dec 11 2018 at 21:52)</a>:</h4>
<p>I don't mind posting an updated version if someone has a chance to update it?</p>



<a name="154024646"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024646" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024646">(Dec 11 2018 at 22:15)</a>:</h4>
<p>We use variables for things like enableWhen</p>



<a name="154024648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024648">(Dec 11 2018 at 22:19)</a>:</h4>
<p>Also, I am planning on using variables for calculatedExpression, to make the expression easier to write &amp; read.</p>



<a name="154024651"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024651" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024651">(Dec 12 2018 at 00:00)</a>:</h4>
<p>so that hasn</p>



<a name="154024652"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024652" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024652">(Dec 12 2018 at 00:00)</a>:</h4>
<p>that hasn't explained when else</p>



<a name="154024799"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024799" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024799">(Dec 12 2018 at 15:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> So, if you have a BMI formula in a calculatedExpression that you want updated when the user enters new weight &amp; height vales, and the weight and height values in the formula are coming from %weight and %height variables you've defined, then you want those variables updated when the user enters new values, not just at prepopulation time.</p>



<a name="154024916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024916">(Dec 12 2018 at 18:50)</a>:</h4>
<p>if the user is entering values, why are you defining variables?</p>



<a name="154024927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024927">(Dec 12 2018 at 19:23)</a>:</h4>
<p>You can't calculate based on the value of preceding questions, only descendant questions.  To get access to preceding questions, you have to do the calculation at a higher level (in a variable) then reference the variable in your expression</p>



<a name="154024951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/%22variables%20are%20only%20calculated%20when%20prepopulating%22/near/154024951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/.22variables.20are.20only.20calculated.20when.20prepopulating.22.html#154024951">(Dec 12 2018 at 20:23)</a>:</h4>
<p>Lloyd has a good point, but also even if the item is retrievable via %resource, I would rather have a BMI formula that looks like:</p>
<div class="codehilite"><pre><span></span>%weight/%height/%height
</pre></div>


<p>rather than:</p>
<div class="codehilite"><pre><span></span>%resource.item.where(linkId=&#39;/29463-7&#39;).answer.valueQuantity.value/%resource.item.where(linkId=&#39;/8302-2&#39;).answer.valueQuantity.value/%resource.item.where(linkId=&#39;/8302-2&#39;).answer.valueQuantity.value
</pre></div>


<p>Also note that the height appears twice, so in this case having the variable for height saves evaluating that part of the expression a second time.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
