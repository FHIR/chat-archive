---
layout: page
title: "FHIR Chat  · answerValueSet invariant · questionnaire"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/index.html">questionnaire</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html">answerValueSet invariant</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="208772052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/208772052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joee Garcia <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#208772052">(Sep 02 2020 at 02:05)</a>:</h4>
<p>I'm working on updating the core Questionnaire resource based on the change request to remove 'choice' and 'open-choice' types (See <a href="https://jira.hl7.org/browse/FHIR-20396">https://jira.hl7.org/browse/FHIR-20396</a>).  Since we're removing these types, this invariant on 'item' is not applicable anymore:</p>
<p>que-5: Only 'choice' and 'open-choice' items can have answerValueSet</p>
<p>I've discussed this with Lloyd and he thinks, this invariant should be updated so answerValueSet should only be allowed for 'coding', 'string' and 'url' type questions.  Any thoughts or concerns?</p>



<a name="208898333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/208898333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#208898333">(Sep 02 2020 at 22:48)</a>:</h4>
<p>url type questions?</p>



<a name="208898531"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/208898531" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#208898531">(Sep 02 2020 at 22:51)</a>:</h4>
<p>Can a ValueSet contain something other than Coding?</p>



<a name="208978691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/208978691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joee Garcia <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#208978691">(Sep 03 2020 at 14:48)</a>:</h4>
<p>According to Lloyd, you can only get codes on ValueSets but you can treat them as strings (ie you can have codes like "Canada", "U.S." and treat them as strings  for an address part).   For url, he said there are places where you actually have a list of URLs as pseudo codes so it should be applicable, too.</p>



<a name="208984492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/208984492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#208984492">(Sep 03 2020 at 15:26)</a>:</h4>
<p>That would require the form renderer to know that if there is an item of type 'string' or 'url', it should convert Codings into strings by taking just the code part.  Is there something in the specification that suggests the form renderer should do that?   When showing the list for the user to pick from, would it then show the code attributes rather than the display attributes?</p>



<a name="208985191"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/208985191" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#208985191">(Sep 03 2020 at 15:31)</a>:</h4>
<p>We should probably add some explicit language making clear that's possible - care to submit a change request? :)</p>



<a name="208985648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/208985648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#208985648">(Sep 03 2020 at 15:34)</a>:</h4>
<p>I am not sure it is a change I want.  Who is it that wants answerValueSet for items of type string or url?  Why wouldn't you just use type "coding"?</p>



<a name="209008131"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209008131" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209008131">(Sep 03 2020 at 18:11)</a>:</h4>
<p>Because the element you're mapping to is type string - e.g. Address.country or Address.state, HumanName.prefix, etc.</p>



<a name="209011966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209011966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209011966">(Sep 03 2020 at 18:42)</a>:</h4>
<p>If you are creating a StructureMap to extract from Questionnaire to something containing an Address or HumanName, presumably that StructureMap could handle an answer with a Coding, couldn't it?   It doesn't seem like form renderer's role to know how to convert a Coding to a string.</p>



<a name="209014070"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209014070" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209014070">(Sep 03 2020 at 18:59)</a>:</h4>
<p>It's commonly done in profiles - so it seems to make sense to allow it in Questionnaire too...</p>



<a name="209015853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209015853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209015853">(Sep 03 2020 at 19:12)</a>:</h4>
<p>When displaying a list of Codings, the user normally sees the display strings, and that it was goes into the field when they pick one.  Making a special case for putting the code property into the field does not sound right to me, especially when the value in the response is not the full Coding.  There would need to be some way to state how the Coding should be converted to a string and there is more that one option for that.</p>



<a name="209033097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209033097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209033097">(Sep 03 2020 at 21:43)</a>:</h4>
<p>The string support in open-choice isn't for the valuieset, its for an answer where it isn't in the set.</p>



<a name="209034889"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209034889" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209034889">(Sep 03 2020 at 22:04)</a>:</h4>
<p>That's true currently, but see the top of this thread for context.</p>



<a name="209041448"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209041448" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209041448">(Sep 03 2020 at 23:38)</a>:</h4>
<p>Lloyd is right that in Structure Definitions you can "bind" a valueset to a text field like city, which will then check that the display value is in the field. (from my understanding)<br>
And I think he's suggesting that Questionnaire should support that too.</p>



<a name="209047362"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209047362" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209047362">(Sep 04 2020 at 01:30)</a>:</h4>
<p>Yup</p>



<a name="209096309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209096309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209096309">(Sep 04 2020 at 13:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="217312">Joee Garcia</span> <a href="#narrow/stream/179255-questionnaire/topic/answerValueSet.20invariant/near/208978691">said</a>:</p>
<blockquote>
<p>According to Lloyd, you can only get codes on ValueSets but you can treat them as strings</p>
</blockquote>
<p>I thought this meant the code was in the field.  Is the code or the display value in the field?  It is not clear which of them one would want.  Possibly, one would combine the two into one string with some separator.</p>



<a name="209140720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209140720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209140720">(Sep 04 2020 at 21:03)</a>:</h4>
<p>Not for things like a state or postcode or even city. You'd want to only see the display value.</p>



<a name="209537709"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/209537709" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#209537709">(Sep 09 2020 at 16:53)</a>:</h4>
<p>So there are seem to be at least two use-cases with different desired outputs (codes, or display values).  If you were picking an ICD-10 code, you might want both code and display in the field.  It sounds like there should be some FHIRPath to construct the value from the Coding.</p>



<a name="210452575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/210452575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joee Garcia <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#210452575">(Sep 17 2020 at 21:17)</a>:</h4>
<p>Can we make use of candidateExpression (which will be renamed to answerExpression) with a FHIRPath in constructing the value for the Coding?  If so, how can we reference the answerValueSet in the FHIRPath?</p>



<a name="210457133"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/210457133" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#210457133">(Sep 17 2020 at 22:02)</a>:</h4>
<p>Sorry <span class="user-mention" data-user-id="217312">@Joee Garcia</span> - just saw this.  We could have taken some time to discuss on the call.  I'm not sure I understand the question - can you expand/give an example?</p>



<a name="210461355"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/210461355" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#210461355">(Sep 17 2020 at 22:55)</a>:</h4>
<p>I don't think candidateExpression and answerExpression are the same thing.</p>



<a name="210461586"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/210461586" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#210461586">(Sep 17 2020 at 22:59)</a>:</h4>
<p>candidateExpression's description says, "NOTE: the set of candidate expressions is intended to be a starter set, not exhaustive. The user should be free to enter or look-up additional values."  But, answerExpression is the complete list for the field.</p>



<a name="210461837"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/210461837" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joee Garcia <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#210461837">(Sep 17 2020 at 23:02)</a>:</h4>
<p>My understanding for this ticket <a href="http://jira.hl7.org/browse/FHIR-21332">J#21332</a> is that we are changing candidateExpression to answerExpression. Is this not the case?</p>



<a name="210462226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/210462226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#210462226">(Sep 17 2020 at 23:06)</a>:</h4>
<p>Yes, I was just looking at that.  I don't see how that works though.  answerExpression will resolve to some list of items.  That is all the user has to choose from, though they could enter a string.  My understanding of candidateExpression was like "here is a list of medications based on your record, but you can enter others" and then the user could either pick one of those or get any other medication using answerValueSet.  The user of answerExpression precludes the use of answerValueSet.  (For references answerExpresion is documented in <a href="http://jira.hl7.org/browse/FHIR-25960">J#25960</a> and <a href="http://jira.hl7.org/browse/FHIR-28386">J#28386</a>.)</p>



<a name="210566379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179255-questionnaire/topic/answerValueSet%20invariant/near/210566379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joee Garcia <a href="https://fhir.github.io/chat-archive/stream/179255-questionnaire/topic/answerValueSet.20invariant.html#210566379">(Sep 18 2020 at 19:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="195344">Paul Lynch</span> <a href="#narrow/stream/179255-questionnaire/topic/answerValueSet.20invariant/near/210461355">said</a>:</p>
<blockquote>
<p>I don't think candidateExpression and answerExpression are the same thing.</p>
</blockquote>
<p>I've added a ticket to discuss this further: <a href="http://jira.hl7.org/browse/FHIR-28580">J#28580</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
