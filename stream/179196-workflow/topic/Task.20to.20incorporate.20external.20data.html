---
layout: page
title: "FHIR Chat  · Task to incorporate external data · workflow"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/index.html">workflow</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html">Task to incorporate external data</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="244199554"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244199554" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244199554">(Jun 28 2021 at 20:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> on a scale of 1 to 10 (1 == it's fine, 10 == it's the worst), how much do you dislike the following use of <code>contained</code>? Would you prefer to stick this kind of content in... <code>valueAttachment.data</code> with some kind of FHIR JSON content b64 encoded? Or in a single contained Bundle? And if so, how would you enable links among the resources inside?</p>
<p>Goals here:</p>
<p>1) provide a clear place to put data that a Task relies on, even before the "receiving" system has committed to storing/incorporating them at any persistent location --  which is why we've got this Task in the first place,<br>
2) provide a way to explicitly call out certain resources like Observations as directly needed by the Task, and others like Device as ...  playing a supporting role,<br>
3) provide a way to link between the Task and the supplied resources, and between supplied resources like Observation -&gt; Device</p>
<h3>Example payload to POST /Task</h3>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="p">{</span>
  <span class="s2">"resourceType"</span><span class="o">:</span> <span class="s2">"Task"</span><span class="p">,</span>
  <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"requested"</span><span class="p">,</span>
  <span class="s2">"intent"</span><span class="o">:</span> <span class="s2">"order"</span><span class="p">,</span> <span class="c1">// App is requesting the incorporation of the data</span>
  <span class="s2">"basedOn"</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// Optional "data request"; when known, this can help EHR process quickly/correctly</span>
    <span class="s2">"reference"</span><span class="o">:</span> <span class="s2">"ServiceRequest/123"</span>
  <span class="p">},</span>
  <span class="s2">"code"</span><span class="o">:</span> <span class="p">{</span><span class="s2">"coding"</span><span class="o">:</span> <span class="p">[{</span><span class="s2">"code"</span><span class="o">:</span> <span class="s2">"incorporate-external-data"</span><span class="p">}]},</span>
  <span class="s2">"input"</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">"type"</span><span class="o">:</span> <span class="p">{</span> <span class="s2">"coding"</span><span class="o">:</span> <span class="p">[{</span> <span class="s2">"code"</span><span class="o">:</span> <span class="s2">"data-to-incorporate"</span><span class="p">}]},</span>
      <span class="s2">"valueReference"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"reference"</span><span class="o">:</span> <span class="s2">"#obs1"</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">"type"</span><span class="o">:</span> <span class="p">{</span><span class="s2">"coding"</span><span class="o">:</span> <span class="p">[{</span> <span class="s2">"code"</span><span class="o">:</span> <span class="s2">"data-to-incorporate"</span><span class="p">}]},</span>
      <span class="s2">"valueReference"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"reference"</span><span class="o">:</span> <span class="s2">"#obs2"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">"contained"</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">"resourceType"</span><span class="o">:</span> <span class="s2">"Observation"</span><span class="p">,</span>
      <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"obs1"</span><span class="p">,</span>
      <span class="s2">"effectiveDateTime"</span><span class="o">:</span> <span class="s2">"2021-06-02T10:14:51Z"</span><span class="p">,</span>
      <span class="s2">"code"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"coding"</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">"system"</span><span class="o">:</span> <span class="s2">"http://loinc.org"</span><span class="p">,</span>
            <span class="s2">"code"</span><span class="o">:</span> <span class="s2">"29463-7"</span><span class="p">,</span>
            <span class="s2">"display"</span><span class="o">:</span> <span class="s2">"Body Weight"</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">"valueQuantity"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"value"</span><span class="o">:</span> <span class="mf">68.4</span><span class="p">,</span>
        <span class="s2">"unit"</span><span class="o">:</span> <span class="s2">"kg"</span><span class="p">,</span>
        <span class="s2">"system"</span><span class="o">:</span> <span class="s2">"http://unitsofmeasure.org"</span><span class="p">,</span>
        <span class="s2">"code"</span><span class="o">:</span> <span class="s2">"kg"</span>
      <span class="p">},</span>
      <span class="s2">"device"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"reference"</span><span class="o">:</span> <span class="s2">"#dev"</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">"resourceType"</span><span class="o">:</span> <span class="s2">"Observation"</span><span class="p">,</span>
      <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"obs2"</span><span class="p">,</span>
      <span class="s2">"effectiveDateTime"</span><span class="o">:</span> <span class="s2">"2021-06-02T18:25:10Z"</span><span class="p">,</span>
      <span class="s2">"code"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"coding"</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">"system"</span><span class="o">:</span> <span class="s2">"http://loinc.org"</span><span class="p">,</span>
            <span class="s2">"code"</span><span class="o">:</span> <span class="s2">"29463-7"</span><span class="p">,</span>
            <span class="s2">"display"</span><span class="o">:</span> <span class="s2">"Body Weight"</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">"valueQuantity"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"value"</span><span class="o">:</span> <span class="mf">68.4</span><span class="p">,</span>
        <span class="s2">"unit"</span><span class="o">:</span> <span class="s2">"kg"</span><span class="p">,</span>
        <span class="s2">"system"</span><span class="o">:</span> <span class="s2">"http://unitsofmeasure.org"</span><span class="p">,</span>
        <span class="s2">"code"</span><span class="o">:</span> <span class="s2">"kg"</span>
      <span class="p">},</span>
      <span class="s2">"device"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"reference"</span><span class="o">:</span> <span class="s2">"#dev"</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span> <span class="c1">// This is for context only; the EHR may use it or not, and still consider the request fulfilled</span>
      <span class="s2">"resourceType"</span><span class="o">:</span> <span class="s2">"Device"</span><span class="p">,</span>
      <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"dev"</span><span class="p">,</span>
      <span class="s2">"identifier"</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">"system"</span><span class="o">:</span> <span class="s2">"http://wittech.net"</span><span class="p">,</span>
          <span class="s2">"value"</span><span class="o">:</span> <span class="s2">"S200/123-xxx-456"</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">"displayName"</span><span class="o">:</span> <span class="s2">"WiTscale S200 Bluetooth Smart Digital Bathroom Scale"</span><span class="p">,</span>
      <span class="s2">"manufacturer"</span><span class="o">:</span> <span class="s2">"WiT"</span><span class="p">,</span>
      <span class="s2">"modelNumber"</span><span class="o">:</span> <span class="s2">"S200"</span><span class="p">,</span>
      <span class="s2">"serialNumber"</span><span class="o">:</span> <span class="s2">"123-xxx-456"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>



<a name="244204162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244204162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244204162">(Jun 28 2021 at 21:02)</a>:</h4>
<p>From discussion on FHIR-I, using <code>contained</code> here gets an OK score from Lloyd (say 1-3 -- "totally comfortable")</p>



<a name="244205227"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244205227" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244205227">(Jun 28 2021 at 21:12)</a>:</h4>
<p>One thing that still favors a dedicated <code>$incorporate</code> operation, over <code>POST /Task</code>: if the EHR wants to immediately accept (or reject) the request, the using Operations, the EHR can return a Task to the client as the operation's return value, without having to <em>persist</em> a Task resource anywhere. But using <code>POST /Task</code> kind of requires (I think!) the EHR to persist the Task. Is that right?</p>



<a name="244211702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244211702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244211702">(Jun 28 2021 at 22:18)</a>:</h4>
<p>A POST of a Task could result in a response where the Task already had a completed status and an output, but yes, it'd be stored on the endpoint.  (How long the endpoint retains completed Tasks and who it allows to see Tasks created by someone else might vary.)  From an EHR perspective, presumably they do persist - at least for audit purposes - the fact that a request for write came in and what was done with it, whether processed synchronously or asynchronously.  So, at least in theory, there should be a persisted structure that could be used to satisfy the endpoint on read.</p>



<a name="244213607"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244213607" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244213607">(Jun 28 2021 at 22:40)</a>:</h4>
<p>EHR data persistence requirements don't necessarily mean "stuff we want to expose on a FHIR endpoint long-term" though. Anyway, I don't think this is a show-stopping concern; just trying to evaluate pros and cons at this stage.</p>



<a name="244214310"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244214310" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244214310">(Jun 28 2021 at 22:48)</a>:</h4>
<p>BTW <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> in the example above you encouraged me to use <code>Task.intent</code> of <code>order</code>  but the <a href="http://build.fhir.org/valueset-task-intent.html">definition </a> doesn't apply:</p>
<blockquote>
<p>The request represents a request/demand and authorization for action by a Practitioner.</p>
</blockquote>
<p>Does this definition need to be updated, or is <code>request</code> a bitter fit for intent? (To be clear, I'd rather leave off intent altogether; I don't think marking it required is helping here.)</p>



<a name="244216888"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244216888" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244216888">(Jun 28 2021 at 23:22)</a>:</h4>
<p>Can you submit a change request?  The intent is absolutely that order can be initiated by someone other than a Practitioner.  The key thing is that it's initiated by someone who has the authority to ask for it directly - as opposed to needing some subsequent step to ask for the action to occur.</p>



<a name="244222114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244222114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244222114">(Jun 29 2021 at 00:59)</a>:</h4>
<p><a href="http://jira.hl7.org/browse/FHIR-32987">FHIR-32987</a></p>



<a name="244224541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244224541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244224541">(Jun 29 2021 at 01:46)</a>:</h4>
<p>For US Core We got beat up for this for 2 years a year by pharmacy over intent = "order" with this as a resolution</p>
<blockquote>
<p>SHALL include all prescribed and “self-prescribed” MedicationRequest resources with an intent = “plan” representing reported medications </p>
</blockquote>
<p>based on that  insanity the intent is going to be 'plan'  to avoid endless discussion</p>



<a name="244225747"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244225747" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244225747">(Jun 29 2021 at 02:12)</a>:</h4>
<p>Fine by me. Or <code>unknown</code>. The field isn't relevant for this use case, so I'm not sure why it's required.</p>



<a name="244231512"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244231512" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244231512">(Jun 29 2021 at 04:07)</a>:</h4>
<p>Plan is definitely wrong.</p>



<a name="244231519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244231519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244231519">(Jun 29 2021 at 04:07)</a>:</h4>
<p>Plan is "it'd be nice if this happened, but I'm not asking for anything to happen, and it's not appropriate for any action to happen yet"</p>



<a name="244231570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244231570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244231570">(Jun 29 2021 at 04:08)</a>:</h4>
<p>It's the equivalent of sticking something in a care plan.  It's expected/hoped to happen at some point in the future, but it's not supposed to happen 'now' and there's no actual 'request' for it to happen.</p>



<a name="244231583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244231583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244231583">(Jun 29 2021 at 04:08)</a>:</h4>
<p>'order' is "I have the authority to ask for this, and I'm asking for it right now".</p>



<a name="244231608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244231608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244231608">(Jun 29 2021 at 04:09)</a>:</h4>
<p>And the latter is definitely what's happening here.  The person requesting doesn't get to decide what happens with the request, but they definitely have authority to ask :)</p>



<a name="244231984"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179196-workflow/topic/Task%20to%20incorporate%20external%20data/near/244231984" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179196-workflow/topic/Task.20to.20incorporate.20external.20data.html#244231984">(Jun 29 2021 at 04:18)</a>:</h4>
<p>Self-reported meds as a 'planned' MedicationRequest is fine because in that case, there's no request for action from the patient.  (It's a kludge because those should actually be MedicationUsage as they're not really 'requests' at all and you should be using two resources, but it's an accepted/workable kludge.)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
