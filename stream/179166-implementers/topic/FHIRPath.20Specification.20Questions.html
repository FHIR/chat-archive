---
layout: page
title: "FHIR Chat  · FHIRPath Specification Questions · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html">FHIRPath Specification Questions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153893716"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893716" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893716">(Jun 14 2017 at 12:31)</a>:</h4>
<p>Hi,</p>
<p>I have some questions regarding the FHIRPath specification, but don't know whether the version I'm looking at is the most recent one or there's something newer.</p>
<p>I am looking at these:<br>
<a href="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc" target="_blank" title="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc">https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc</a><br>
<a href="http://hl7.org/fhirpath/" target="_blank" title="http://hl7.org/fhirpath/">http://hl7.org/fhirpath/</a></p>
<p>Are these the latest versions?</p>



<a name="153893718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893718">(Jun 14 2017 at 12:37)</a>:</h4>
<p>the current formal version is here: </p>



<a name="153893719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893719">(Jun 14 2017 at 12:37)</a>:</h4>
<p><a href="http://hl7.org/fhirpath" target="_blank" title="http://hl7.org/fhirpath">http://hl7.org/fhirpath</a></p>



<a name="153893762"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893762" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893762">(Jun 14 2017 at 15:12)</a>:</h4>
<p>Thanks for that. I have the following questions:</p>
<p>1. In section 6.5 Boolean logic (i.e. <a href="http://hl7.org/fhirpath/#boolean-logic" target="_blank" title="http://hl7.org/fhirpath/#boolean-logic">http://hl7.org/fhirpath/#boolean-logic</a>), it says:<br>
"For all boolean operators, the collections passed as operands are first evaluated as booleans (as described in <strong>Boolean Evaluation of Collections</strong>). The operators..."<br>
It seems to refer to a section named "Boolean Evaluation of Collections". However, I don't see such a named section in the specification. The closest I could find was <a href="http://hl7.org/fhirpath/#singleton-evaluation-of-collections" target="_blank" title="http://hl7.org/fhirpath/#singleton-evaluation-of-collections">http://hl7.org/fhirpath/#singleton-evaluation-of-collections</a>. Is this the correct reference?</p>
<p>2. In <a href="http://hl7.org/fhir/STU3/definitions.xml.zip" target="_blank" title="http://hl7.org/fhir/STU3/definitions.xml.zip">http://hl7.org/fhir/STU3/definitions.xml.zip</a>, in search-parameters.xml, some of the search parameters use the is() or as() functions. An example is <a href="http://hl7.org/fhir/SearchParameter/Condition-abatement-boolean" target="_blank" title="http://hl7.org/fhir/SearchParameter/Condition-abatement-boolean">http://hl7.org/fhir/SearchParameter/Condition-abatement-boolean</a>.<br>
I cannot find any definition of these functions in the FHIRPath spec. I do find the equivalent 'is' or 'as' keywords under <a href="http://hl7.org/fhirpath/#types" target="_blank" title="http://hl7.org/fhirpath/#types">http://hl7.org/fhirpath/#types</a>. Are the functions equal to their keyword counterparts?</p>



<a name="153893764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893764">(Jun 14 2017 at 15:15)</a>:</h4>
<p>1. Yes, that's been corrected in the next version, but isn't published yet.</p>



<a name="153893765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893765">(Jun 14 2017 at 15:16)</a>:</h4>
<p>2. Yes, that's also been corrected, and yes, they are equivalent. They're done as part of the syntax so we can distinguish that the identifier is a "type" identifier, rather than a "variable" identifier.</p>



<a name="153893767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893767">(Jun 14 2017 at 15:20)</a>:</h4>
<p>Thanks. Is the unpublished version viewable? Like in GForge or something?</p>



<a name="153893768"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893768" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893768">(Jun 14 2017 at 15:21)</a>:</h4>
<p>The source is in Github, and now that I'm looking at it I see that that issue is still outstanding, I thought it had been corrected.</p>



<a name="153893769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893769">(Jun 14 2017 at 15:21)</a>:</h4>
<p><a href="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc" target="_blank" title="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc">https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc</a></p>



<a name="153893770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893770">(Jun 14 2017 at 15:21)</a>:</h4>
<p>I'll fix it.</p>



<a name="153893771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893771">(Jun 14 2017 at 15:27)</a>:</h4>
<p>There's actually a tracker on it too: <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12583&amp;start=0" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12583&amp;start=0">http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=12583&amp;start=0</a></p>



<a name="153893773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893773">(Jun 14 2017 at 15:34)</a>:</h4>
<p>I had forgotten about that issue I posted on GForge. My bad.<br>
But for my question #2, it seems that <a href="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc" target="_blank" title="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc">https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc</a> is not yet updated. Do you want me to put in a GForge ticket for this?</p>



<a name="153893774"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893774" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893774">(Jun 14 2017 at 15:35)</a>:</h4>
<p>No, in looking at that ticket, it was auto-deferred, so we can just put it back to open and apply the change.</p>



<a name="153893776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893776">(Jun 14 2017 at 15:39)</a>:</h4>
<p>For question #2, the github is correct, is and as are keywords.</p>



<a name="153893778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893778">(Jun 14 2017 at 15:41)</a>:</h4>
<p>But yes, I see that they are used as functions in the FHIRPath for the search parameters in the spec.</p>



<a name="153893779"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893779" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893779">(Jun 14 2017 at 15:42)</a>:</h4>
<p>So yes, log a ticket for that so we can sort it.</p>



<a name="153893780"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153893780" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153893780">(Jun 14 2017 at 15:43)</a>:</h4>
<p>Actually, looks like Ewout just did.</p>



<a name="153939813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939813">(Feb 22 2018 at 20:04)</a>:</h4>
<p>So, what is the correct semantics for the "Boolean Evaluation of Collections" (I wasn't able to find it anywhere).<br>
Is it that single boolean value evaluates to that value, empty collection evaluates to empty and anything else is "true"?</p>



<a name="153939849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939849">(Feb 22 2018 at 20:42)</a>:</h4>
<p><a href="http://hl7.org/fhirpath/#singleton-evaluation-of-collections" target="_blank" title="http://hl7.org/fhirpath/#singleton-evaluation-of-collections">Singleton evaluation of collections</a></p>



<a name="153939856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939856">(Feb 22 2018 at 20:44)</a>:</h4>
<p>Boolean evaluation of collections is a special case of singleton evaluation. In general, it's an error to attempt to evaluate a collection with more than one thing in it as a singleton.</p>



<a name="153939869"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939869" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939869">(Feb 22 2018 at 20:56)</a>:</h4>
<p>Would non-boolean produce an error or evaluate to 'true'?<br>
Reason I'm asking is that I see the following FHIRPath in standard definitions: "(code or value.empty()) and (system.empty() or system = 'urn:iso:std:iso:4217')", which implies that non-empty code should evaluate to true.</p>



<a name="153939870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939870">(Feb 22 2018 at 20:58)</a>:</h4>
<p>(it's in Money definition)</p>



<a name="153939871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939871">(Feb 22 2018 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span></p>



<a name="153939902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939902">(Feb 22 2018 at 22:17)</a>:</h4>
<p>Hmmm.... seems like it shouldn't evaluate to me, should be <code>(code.exists() or value.empty()) and (system.empty() or system = 'urn:iso:std:iso:4217')</code></p>



<a name="153939917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939917">(Feb 22 2018 at 22:26)</a>:</h4>
<p>indeed that should be corrected</p>



<a name="153939932"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939932" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939932">(Feb 22 2018 at 22:50)</a>:</h4>
<p><a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15611" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15611">GF#15611</a></p>



<a name="153939957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153939957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153939957">(Feb 22 2018 at 23:19)</a>:</h4>
<p>Marked as an auto-approved typo</p>



<a name="153940661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940661">(Feb 26 2018 at 19:12)</a>:</h4>
<p>Here is one more inconsistency between the spec and its application.<br>
For example, spec doesn't define ".in()" function (), but rather an "in" operator. However, both spec and real definitions use "in" as a function.<br>
Same for the "as" operator.<br>
So, in those two cases, should those be both supported as a "function" and as an "operator" or only as an operator?</p>



<a name="153940662"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940662" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940662">(Feb 26 2018 at 19:19)</a>:</h4>
<p>There is also a lot of other things, like missing <code>.exists()</code>, as in example above, comparing single item versus a collection (like in <code>value.empty() or code!=component.code</code> for Observation), assuming short-cutting "or" operator (like in <code>min.empty() or max.empty() or (max = '*') or (min &lt;= max.toInteger())</code>, toInteger will fail if <code>max = '*'</code>).<br>
(plus some of the data in examples doesn't pass validation, like bmi-questionnaire.json missing "linkId" elements here and there).</p>
<p>Should I report all these cases one by one or maybe I can just list all of them as a bulk item?</p>



<a name="153940663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940663">(Feb 26 2018 at 19:21)</a>:</h4>
<p>I don't see a reference to .in() in the spec, in is defined as an operator in the spec and the grammar.</p>



<a name="153940664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940664">(Feb 26 2018 at 19:22)</a>:</h4>
<p>For <code>is</code> and <code>as</code>, they are defined in the spec and the grammar as operators, but I do see examples that use them as functions. I'd suggest a tracker for that on FHIRPath.</p>



<a name="153940665"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940665" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940665">(Feb 26 2018 at 19:22)</a>:</h4>
<p>For the use of <code>.in()</code> in the spec, I'd say that would be a tracker against FHIR, citing the invariant that uses it.</p>



<a name="153940666"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940666" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940666">(Feb 26 2018 at 19:22)</a>:</h4>
<p>Separate trackers for the items in FHIRPath are preferable, it's easier to track the specific resolutions for the issues.</p>



<a name="153940668"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940668" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940668">(Feb 26 2018 at 19:29)</a>:</h4>
<p>You are right about ".in()", it was just one of the constraints.</p>
<p>I'll open separate tickets.</p>



<a name="153940683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940683">(Feb 26 2018 at 20:09)</a>:</h4>
<p>Thank you!</p>



<a name="153940823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940823">(Feb 26 2018 at 21:42)</a>:</h4>
<p>Created few:</p>
<p><a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15648" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15648">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15648</a><br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15649" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15649">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15649</a><br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15650" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15650">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15650</a><br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15651" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15651">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15651</a><br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15652" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15652">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15652</a><br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15653" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15653">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15653</a><br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15654" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15654">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=15654</a></p>



<a name="153940906"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940906" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940906">(Feb 27 2018 at 09:44)</a>:</h4>
<blockquote>
<p>There is also a lot of other things, like missing <code>.exists()</code>, as in example above, comparing single item versus a collection (like in `value.empty() or  (...)</p>
<p>Should I report all these cases one by one or maybe I can just list all of them as a bulk item?</p>
</blockquote>
<p>Hi Ivan, these inconsistencies are because of a change of the boolean interpretation of empty arrays &amp; introduction of three-valued logic in STU3.  We tried to manually hunt these mistakes down &amp; fix them, but obviously we've missed a few.  Thanks for pointing them out!</p>



<a name="153940907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940907">(Feb 27 2018 at 09:45)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>: I think we need to continue our discussion around sum() or aggregate/fold (and possible lambda notation) for the FhirPath normative?</p>



<a name="153940908"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940908" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940908">(Feb 27 2018 at 10:00)</a>:</h4>
<p>we do. though I don't know about the lambda bit?</p>



<a name="153940909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940909">(Feb 27 2018 at 10:08)</a>:</h4>
<p>The major question is: </p>
<ul>
<li>Option A:  We add just sum(), which works on a collection of numbers and sums the numbers</li>
<li>Option B: We generalize and introduce explicit lambda notation like so:     <code>Patient.name.first.aggregate(\total arg -&gt;  $total &amp; $arg)</code> (just borrowing from Haskell here) - which would allow you to sum/aggregate anything in any way, since you're not bound to just sums</li>
<li>Option C: Another magic variable <code>$total</code> (much like $this), which only appears in <code>aggregate</code>:   <code>Patient.name.first.aggregate($total &amp; $this)</code></li>
</ul>



<a name="153940910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940910">(Feb 27 2018 at 10:22)</a>:</h4>
<p>I think the third option is closest to our current design - where() etc introduce a magic $this, aggregate() could introduce $total.</p>
<p>Interestingly, <code>repeat()</code> could then be rewritten using <code>aggregate()</code>:</p>
<p><code>Questionnaire.repeat(group | question).question</code> becomes  </p>
<p><code>Questionnaire.aggregate($total | (group | question)).question</code></p>



<a name="153940979"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940979" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940979">(Feb 27 2018 at 17:08)</a>:</h4>
<p>Option A is the most well understood, but least flexible. It's the least likely to be considered a substantive change.</p>



<a name="153940980"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940980" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940980">(Feb 27 2018 at 17:09)</a>:</h4>
<p>Option B is, I think, the least understood, but most flexible, and I think would be considered substantive, it's a pretty big change in terms of functionality, even if not in terms of the actual grammar and specification.</p>



<a name="153940983"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153940983" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153940983">(Feb 27 2018 at 17:11)</a>:</h4>
<p>Option C is my favorite, it's not as flexible as lambdas, but it's also a very focused change so much less likely to be considered substantive. I actually really like it, it supports everything we need and more, nice proposal <span class="user-mention" data-user-id="191328">@Ewout Kramer</span></p>



<a name="153941004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941004">(Feb 27 2018 at 18:05)</a>:</h4>
<p>I understand this: Patient.name.first.aggregate($total &amp; $this) - but I find it not useful because of the need for a separator in most cases - an 'all but the first' action.</p>



<a name="153941005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941005">(Feb 27 2018 at 18:05)</a>:</h4>
<p>but I don't understand this: Questionnaire.aggregate($total | (group | question)).question - what is aggregate aggregating on? Is this a mistake, or something I don't understand?</p>



<a name="153941021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941021">(Feb 27 2018 at 19:38)</a>:</h4>
<p>Patient.name.first().aggregate($total &amp; $total.iif(exists(), ', ') &amp; $this)</p>



<a name="153941022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941022">(Feb 27 2018 at 19:38)</a>:</h4>
<p>For the second one, it's aggregating the list, so union is the aggregate function.</p>



<a name="153941030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941030">(Feb 27 2018 at 20:04)</a>:</h4>
<p>how is it different to (Questionnaire.group | Questionnaire.question) ? Surely you have to have a list as focus in order to actually aggregate something?</p>



<a name="153941037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941037">(Feb 27 2018 at 20:17)</a>:</h4>
<p>Are you going create Turing complete language with perl syntax?</p>



<a name="153941039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941039">(Feb 27 2018 at 20:18)</a>:</h4>
<p>no but that sounds like fun. It'll only take you a few minutes to do that...</p>



<a name="153941187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941187">(Feb 28 2018 at 16:16)</a>:</h4>
<blockquote>
<p>but I don't understand this: Questionnaire.aggregate($total | (group | question)).question - what is aggregate aggregating on? Is this a mistake, or something I don't understand?</p>
</blockquote>
<p>No, I was a bit too enthousiastic ;-)  We can't get rid of the repeat() unfortunately.</p>



<a name="153941188"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941188" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941188">(Feb 28 2018 at 16:17)</a>:</h4>
<blockquote>
<p>Are you going create Turing complete language with perl syntax?</p>
</blockquote>
<p>Thinking about addinc <code>let rec</code>....</p>



<a name="153941305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Specification%20Questions/near/153941305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Specification.20Questions.html#153941305">(Feb 28 2018 at 22:37)</a>:</h4>
<p>With the aggregate functions, need to be very careful that they don't operate on a list that has had duplicates removed, will skew values and make sums incorrect.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
