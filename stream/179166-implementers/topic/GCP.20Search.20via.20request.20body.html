---
layout: page
title: "FHIR Chat  · GCP Search via request body · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html">GCP Search via request body</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="209871510"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/209871510" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hue Nguyen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#209871510">(Sep 12 2020 at 08:41)</a>:</h4>
<p>Hi, My name is Hue.<br>
I'm using GCP Healthcare API<br>
I wanna do FHIR <a href="https://cloud.google.com/healthcare/docs/reference/rest/v1/projects.locations.datasets.fhirStores.fhir/search">search</a> via request body. <br>
For example, I have 100 <code>Patient IDs</code> from 1 to 100  and <code>name= Jame</code> condition. How can I search on 1 request?</p>
<ul>
<li>Id is uuid with 36 character. That mean 100 ids will be 3600 character</li>
<li>maximum URL length is <a href="https://serpstat.com/blog/how-long-should-be-the-page-url-length-for-seo/#:~:text=The%20maximum%20length%20of%20a,address%20bar%20is%202048%20characters.">2048</a><br>
If we can not search via request body, do you have any solution for it?<br>
Looping: <span class="user-mention" data-user-id="197072">@Paul Church</span></li>
</ul>



<a name="209881294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/209881294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#209881294">(Sep 12 2020 at 13:20)</a>:</h4>
<p>Did you try searching using POST?<br>
<a href="http://build.fhir.org/search.html#Introduction">http://build.fhir.org/search.html#Introduction</a></p>



<a name="209882698"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/209882698" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#209882698">(Sep 12 2020 at 13:59)</a>:</h4>
<p>You can also consider using Batch.</p>



<a name="209884309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/209884309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#209884309">(Sep 12 2020 at 14:46)</a>:</h4>
<p>We don't support POST search parameters in the request body at the moment. We support read but not search in a batch bundle - search is feasible but we haven't seen much demand for it yet.</p>
<p>In general I suggest designing the search to use an attribute of the resources instead of a large list. If there isn't a criterion that selects these 100 patients, perhaps an artificial attribute like meta.tag. If you need to retrieve a lot of resources by ID alone, a batch bundle of read operations will work and can be very large.</p>



<a name="209884800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/209884800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hue Nguyen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#209884800">(Sep 12 2020 at 15:00)</a>:</h4>
<p><span class="user-mention" data-user-id="197072">@Paul Church</span> <br>
I wanna make a search query with <code>Patient.name, Patient.phone, Encounter.practitioner</code>.<br>
Query will like <code>&lt;basepath&gt;/Encounter?practitioner={id}&amp;subject:Patient:name=xxx&amp;subject:Patient:phone=xxx</code><br>
But GCP has a problem when search with Japanese characters (jp characters is too short and can't set index for it).<br>
So, I'm trying to use Elastic search for Japanese characters search =&gt; and will get list of IDs<br>
Then, new query will be:<br>
<code>&lt;basepath&gt;/Encounter?practitioner={id}&amp;subject:Patient:_id=111,222,43333....</code><br>
Do you have any suggestion for this case</p>



<a name="210441573"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/210441573" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#210441573">(Sep 17 2020 at 19:49)</a>:</h4>
<p>Sorry for the delay. My only suggestion for this case is to split into smaller queries.</p>
<p>We are tracking POST _search with the parameters in the request body as a future enhancement but it's likely that substring search on 1-2 character words will be fixed earlier than that.</p>



<a name="210966276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/210966276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hue Nguyen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#210966276">(Sep 23 2020 at 07:17)</a>:</h4>
<p>Thank you. Let's me try</p>



<a name="219525316"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/219525316" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Forbis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#219525316">(Dec 10 2020 at 19:56)</a>:</h4>
<p>I have a sort of related question regarding 2048 character limit on URLs. I understand that using POST based search could avoid that on the way into the server, but wouldn't this still cause problem for bundle link entries (self, prev, next, etc) in the returned bundle?</p>



<a name="219541478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/219541478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#219541478">(Dec 10 2020 at 22:13)</a>:</h4>
<p>Yes, I would think we'd have to give you a <a href="http://link.next">link.next</a> URL with query parameters that is too long, but you could reinterpret it into a POST body. Not sure what other servers do about this.</p>



<a name="219541704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/219541704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Forbis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#219541704">(Dec 10 2020 at 22:15)</a>:</h4>
<p>I think returning a URL that cannot be served by a GET request is invalid? Is that correct?</p>



<a name="219542107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/219542107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#219542107">(Dec 10 2020 at 22:18)</a>:</h4>
<p>The only language I'm aware of is "In the case of a search, the initial request may be made via a POST, but the follow up page requests will be made via GET requests. However servers SHOULD allow for a client to convert the follow up requests to be made via a POST."</p>
<p>This seems unhelpful in the case where the search parameters are too long to be served by a GET.</p>



<a name="219995604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/GCP%20Search%20via%20request%20body/near/219995604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Forbis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/GCP.20Search.20via.20request.20body.html#219995604">(Dec 15 2020 at 15:36)</a>:</h4>
<p>Perhaps this is something that just needs to be documented by each individual implementation? It seems that most servers support somewhere between 4k-8k max header size (which also applies to query args), so the 2048 limit is just for browser URLs which I think doesn't really apply here since these are APIs. Here's a list of <a href="https://www.tutorialspoint.com/What-is-the-maximum-size-of-HTTP-header-values">popular servers and their default size limits</a>. These settings are usually adjustable, but they are set to that size specifically to avoid DoS attacks.</p>
<p>As far as returning a link that the server would reject if it was made via GET, but accept if it was made via POST, I'd still like to know whether that could be considered acceptable per conformance standards.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
