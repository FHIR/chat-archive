---
layout: page
title: "FHIR Chat  · FHIRPath date math · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html">FHIRPath date math</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="183089979"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183089979" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tadas Antanavicius <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183089979">(Dec 10 2019 at 18:56)</a>:</h4>
<p>Hi,</p>
<p>I want to write a FHIRPath expression that calculates a person's age based on their birthdate.</p>
<p>Doing this elegantly seems like it would require extracting the "year" from both today() and the birthday, e.g pseudocode:</p>
<p>(today.year - birth.year).select($this - iif(today &lt; birth + $this, 1, 0)</p>
<p>Is there an elegant way to extract the year from a Date in FHIRPath?</p>
<p>It seems doable with regex:</p>
<p>today().toString().replaceMatches('(?&lt;year&gt;\d{4}).*', '${year}').toDecimal()</p>
<p>But I'm hoping there's some cleaner way I'm missing. Haven't been able to find anything relevant in these docs: <a href="http://build.fhir.org/ig/HL7/FHIRPath/branches/master/N1/" target="_blank" title="http://build.fhir.org/ig/HL7/FHIRPath/branches/master/N1/">http://build.fhir.org/ig/HL7/FHIRPath/branches/master/N1/</a></p>
<p>Thanks!</p>



<a name="183096518"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183096518" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183096518">(Dec 10 2019 at 20:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> there's not even a way to subtract a data from date to get a duration?</p>



<a name="183097057"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183097057" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183097057">(Dec 10 2019 at 20:09)</a>:</h4>
<p>No, because you'd have to define subtractions for each precision.</p>



<a name="183097141"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183097141" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183097141">(Dec 10 2019 at 20:10)</a>:</h4>
<p>You can convert both to seconds and get the difference in seconds.</p>



<a name="183097174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183097174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183097174">(Dec 10 2019 at 20:10)</a>:</h4>
<p>But we explicitly put calendar duration calculation out of scope.</p>



<a name="183099150"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183099150" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183099150">(Dec 10 2019 at 20:32)</a>:</h4>
<p>so how would you solve this one?</p>



<a name="183128727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183128727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183128727">(Dec 11 2019 at 05:24)</a>:</h4>
<p>Well to do it right we'd have to introduce date/time component extractors or calendar duration calculation (probably both). It's been on the list, but we have been focused on getting to normative. A perhaps simpler hack would be today().toString().substring(0, 4).toInteger().</p>



<a name="183196911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20date%20math/near/183196911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tadas Antanavicius <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20date.20math.html#183196911">(Dec 11 2019 at 20:14)</a>:</h4>
<p>Got it, thanks! Going to go with your suggestion for now.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
