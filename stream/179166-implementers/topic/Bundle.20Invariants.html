---
layout: page
title: "FHIR Chat  · Bundle Invariants · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html">Bundle Invariants</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153863537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863537">(Dec 15 2016 at 01:10)</a>:</h4>
<p>Just wondering if a bundle being returned from a resource's history should also satisfy all the invariants, as I don't think that invariant <code>bdl-7</code> can be satisfied if there are deletes in the results (as they don't have a resource, and therefore no meta.versionId).</p>



<a name="153863538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863538">(Dec 15 2016 at 01:10)</a>:</h4>
<p>This is causing some of the connectathon tests in Touchstone to fail. (on my server anyway)</p>



<a name="153863539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863539">(Dec 15 2016 at 01:12)</a>:</h4>
<p>multiple deletes on the same resource?</p>



<a name="153863540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863540">(Dec 15 2016 at 01:27)</a>:</h4>
<p>can do.</p>



<a name="153863541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863541">(Dec 15 2016 at 01:27)</a>:</h4>
<p>a create, delete, update (which re-creates) then delete would do it</p>



<a name="153863588"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863588" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863588">(Dec 15 2016 at 05:58)</a>:</h4>
<p>What if <code>bld-7</code> and <code>bld-8</code> only applied when (type = 'history).not()?</p>
<p>Then add a new invariant for when (type = 'history) where fullUrl is version specific.</p>



<a name="153863590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863590">(Dec 15 2016 at 06:01)</a>:</h4>
<p>bdl-8 I'm ok with, bdl-7 I think needs your addition in there.</p>



<a name="153863600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863600">(Dec 15 2016 at 06:07)</a>:</h4>
<p>So <code>bld-7</code> would look like this:</p>
<p>(type = 'history').not() and entry.where(fullUrl).select(fullUrl&amp;resource.meta.versionId).isDistinct()</p>



<a name="153863603"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863603" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863603">(Dec 15 2016 at 06:12)</a>:</h4>
<p>If that looks right I can update Touchstone's fhir validator for 1.8.0.  (Tomorrow - heading off to bed now)</p>



<a name="153863604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863604">(Dec 15 2016 at 06:14)</a>:</h4>
<p>Cool, now that I've updated my FhirPathTester to support both DSTU2 and STU3, should be easy to check.</p>



<a name="153863606"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863606" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863606">(Dec 15 2016 at 06:16)</a>:</h4>
<p>Nice. I'll let you know when I have that done.<br>
(Signing off now...)</p>



<a name="153863655"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863655" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863655">(Dec 16 2016 at 01:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> I've updated the <code>bdl-7</code> invariant in Touchstone and ran one of the TestScripts that had the failure and it now passes.</p>



<a name="153863656"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Invariants/near/153863656" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Invariants.html#153863656">(Dec 16 2016 at 01:19)</a>:</h4>
<p>The actual change to <code>bdl-7</code> was slightly different. It's now defined as:<br>
(type = 'history') or entry.where(fullUrl).select(fullUrl&amp;resource.meta.versionId).isDistinct()</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
