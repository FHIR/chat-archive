---
layout: page
title: "FHIR Chat  · bundle.type qualities · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html">bundle.type qualities</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153991812"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991812" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991812">(Aug 30 2018 at 08:10)</a>:</h4>
<p>Should a bundle with bundle type <a href="http://build.fhir.org/valueset-bundle-type.html" target="_blank" title="http://build.fhir.org/valueset-bundle-type.html">valueset</a> document be treated as a transaction? It seems a bit fluffy that there are valuetypes (eg. transaction and batch) that describes the behaviour of <strong>how</strong> the collection of elements should be handled mixed with <strong>what</strong> is contained (document and message). Ain't that two different qualities that mixed together? Is it not something that is orthogonal on eachother and should not be mixed?</p>



<a name="153991822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991822">(Aug 30 2018 at 08:16)</a>:</h4>
<p>What gets done with a Bundle depends on what you do with it.  If you POST it to the Bundle endpoint, the base expectation is that you'll store it as-is.  However, a system MAY choose to process it as a transaction too - creating or updating resources at various other endpoints based on the content of the Bundle.  If you POST the document to the root endpoint, then some servers might opt to treat the Bundle as a transaction, though without the specific instructions on whether to POST or PUT the data, the server would have to make up its own business rules.  And of course, the server would be well within its rights to reject the POST as invalid.  In general, the only thing that you can count on being treated as a transaction is a Bundle of type "transaction".  The primary purpose of a document Bundle is to be stored and to be rendered in a particular way.</p>



<a name="153991823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991823">(Aug 30 2018 at 08:18)</a>:</h4>
<p>Where does the spec say anything about rendering of document Bundles?</p>



<a name="153991824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991824">(Aug 30 2018 at 08:22)</a>:</h4>
<p>would you agree to the fact that <strong>how</strong> and <strong>what</strong> are sort of mixed together in this valueset?</p>



<a name="153991825"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991825" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991825">(Aug 30 2018 at 08:24)</a>:</h4>
<p>It's all about the "what".  A transaction and a document are different things.  The rules around processing documents is <a href="http://build.fhir.org/documents.html#presentation" target="_blank" title="http://build.fhir.org/documents.html#presentation">here</a></p>



<a name="153991827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991827">(Aug 30 2018 at 08:31)</a>:</h4>
<p>you stated that servers MAY choose to process documents as transactions too - which makes sense to me - and this in my perspective qualifies as <strong>how</strong>.</p>



<a name="153991830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991830">(Aug 30 2018 at 08:42)</a>:</h4>
<p>to me it seems a bit shoehorned that there is a special transactional type for bundles containing a composition (given that one can treat a document as a transaction) - but it might just be the special case that makes the world spin. And why must composition be the first resource? Wouldn't it be adequate to say that it must contain at least one or only one? Is the order important?</p>



<a name="153991833"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991833" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991833">(Aug 30 2018 at 08:43)</a>:</h4>
<p>Processing a document as a transaction is an unusual thing.  Servers <em>can</em> do whatever they like.  But if something is a document, the expectation is that it'll be processed like a document - i.e. stored and rendered.</p>



<a name="153991834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991834">(Aug 30 2018 at 08:43)</a>:</h4>
<p>Composition must be the first resource because it's the anchor for the content.  It defines how the document is rendered and provides all the metadata needed when searching for the document.</p>



<a name="153991835"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991835" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991835">(Aug 30 2018 at 08:45)</a>:</h4>
<p>but you would like the document being processed by a server as an atomic commit, right?</p>



<a name="153991836"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991836" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991836">(Aug 30 2018 at 08:53)</a>:</h4>
<blockquote>
<p>Composition must be the first resource because it's the anchor for the content.  It defines how the document is rendered and provides all the metadata needed when searching for the document.</p>
</blockquote>
<p>The need you describe only require the composition to be within the bundle. It does not describe a need for it to be first</p>



<a name="153991837"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991837" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991837">(Aug 30 2018 at 08:53)</a>:</h4>
<p>No.  When you post adocument, you want it stored as a Bundle</p>



<a name="153991838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991838">(Aug 30 2018 at 08:54)</a>:</h4>
<p>Making the composition first means that servers don't have to wade through a Bundle of 100+ resources looking for it.</p>



<a name="153991840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991840">(Aug 30 2018 at 08:55)</a>:</h4>
<p>Documents are "special", just like messages and history and all the other types of Bundle.  Each has rules around what content is expected to be present and where it's expected to appear.  Those rules allow the behaviors associated with those types to be performed appropriately and efficiently.</p>



<a name="153991841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991841">(Aug 30 2018 at 08:59)</a>:</h4>
<blockquote>
<p>Making the composition first means that servers don't have to wade through a Bundle of 100+ resources looking for it.</p>
</blockquote>
<p>if the argument is for performance reasons wouldn't it be suitable to suggest an order for all resources  in all types of bundles - e.g. patients before encounters and so on?</p>



<a name="153991842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991842">(Aug 30 2018 at 09:06)</a>:</h4>
<p>There's no general purpose rule for a transaction bundle - we have no clue what they might contain.  But a Document will always contain one "defining" Composition.  And that Composition is key to it being a document.  (In fact, in some rare cases, a document Bundle could theoretically contain multiple compositions, so insisting that the defining one be first has additional importance.)</p>



<a name="153991843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991843">(Aug 30 2018 at 09:07)</a>:</h4>
<p>There's no ordering of the content within a document bundle beyond the requirement that the defining Composition must come first (just as the MessageHeader must come first in a message Bundle).</p>



<a name="153991845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991845">(Aug 30 2018 at 09:08)</a>:</h4>
<blockquote>
<p>There's no general purpose rule for a transaction bundle - we have no clue what they might contain.  But a Document will always contain one "defining" Composition.  And that Composition is key to it being a document.  (In fact, in some rare cases, a document Bundle could theoretically contain multiple compositions, so insisting that the defining one be first has additional importance.)</p>
</blockquote>
<p>A document bundle cannot pr. spec contain multiple compositions - that would violate the rule about it having to be first as both cannot be first</p>



<a name="153991847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991847">(Aug 30 2018 at 09:09)</a>:</h4>
<blockquote>
<p>There's no ordering of the content within a document bundle beyond the requirement that the defining Composition must come first (just as the MessageHeader must come first in a message Bundle).</p>
</blockquote>
<p>I cant see the need for the MessageHeader to come first either</p>



<a name="153991848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991848">(Aug 30 2018 at 09:10)</a>:</h4>
<p>Where does the spec say that multiples are prohibited?  The defining Composition must be first, but I don't see any rule prohibiting others.</p>



<a name="153991849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991849">(Aug 30 2018 at 09:11)</a>:</h4>
<p>When you're processing a message, the first thing you want to see (so you know whether you even want to process it or not) is the MessageHeader.  Having the MessageHeader anywhere else in the instance is just inefficient.</p>



<a name="153991850"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991850" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991850">(Aug 30 2018 at 09:12)</a>:</h4>
<p>I'd rather spec those extra bucks on a CPU doing the traversal of +100 resources than spending time on development tuning my serializer to enforce a rule about certain elements to come first - but that is a subjective matter of opinion.</p>



<a name="153991851"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991851" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991851">(Aug 30 2018 at 09:15)</a>:</h4>
<p>Well, if you're serializing a document, the root object that you're working with is going to be the Composition, so making it the first entry in the Bundle should be a pretty natural thing to do.  (Same for MessageHeader and a message)</p>



<a name="153991853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991853">(Aug 30 2018 at 09:16)</a>:</h4>
<blockquote>
<p>Well, if you're serializing a document, the root object that you're working with is going to be the Composition, so making it the first entry in the Bundle should be a pretty natural thing to do.  (Same for MessageHeader and a message)</p>
</blockquote>
<ul>
<li>back to my performance argument. I would either buy more CPU - or globally define a relational order for all elements - but that is my own subjective opinion</li>
</ul>



<a name="153991854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991854">(Aug 30 2018 at 09:18)</a>:</h4>
<blockquote>
<p>Where does the spec say that multiples are prohibited?  The defining Composition must be first, but I don't see any rule prohibiting others.</p>
</blockquote>
<p>I'm in deep water here and I wouldn't expect multiple compositions. If there exists something as a 'defining' composition, I would suggest it to be modelled in the datafields - not in the order I read it</p>



<a name="153991858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/bundle.type%20qualities/near/153991858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/bundle.2Etype.20qualities.html#153991858">(Aug 30 2018 at 09:27)</a>:</h4>
<p>Breaking out the Composition or MessageHeader as separate elements would introduce a significant amount of other complexity - as you'd then have to handle those resources pointing to entries in the Bundle and entries in the Bundle pointing to them.  On balance, requiring that the "special" resources come first is much simpler.  Order has to be retained and order is allowed to have significance.  We take advantage of that where we need to.  (Just as we require that the "first" name of a Patient is the first repetition of Patient.name.given...)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
