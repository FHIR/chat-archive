---
layout: page
title: "FHIR Chat  · Reference by search · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html">Reference by search</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="226374856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226374856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226374856">(Feb 15 2021 at 11:57)</a>:</h4>
<p>Can a literal reference point to a search? I've seen this somewhere, but I don't think this is accepted. e.g.<br>
POST /Observation</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
<span class="err">...</span>
  <span class="nt">"subject"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">"reference"</span> <span class="p">:</span> <span class="s2">"Patient?identifier=xyz"</span>
  <span class="p">}</span>
<span class="err">...</span>
<span class="p">}</span>
</code></pre></div>



<a name="226377965"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226377965" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226377965">(Feb 15 2021 at 12:31)</a>:</h4>
<p>The response would be a bundle.</p>



<a name="226378562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226378562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226378562">(Feb 15 2021 at 12:37)</a>:</h4>
<p>correct.</p>



<a name="226378602"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226378602" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226378602">(Feb 15 2021 at 12:37)</a>:</h4>
<p>which is why i ask if this would make sense - i think not but maybe there is some section in the spec I've missed</p>



<a name="226379047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226379047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226379047">(Feb 15 2021 at 12:41)</a>:</h4>
<p>No. Such conditional references may be used as  part of a conditional-create or conditional-update, but not as part of a literal reference. Use reference .identifier instead.</p>



<a name="226380868"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226380868" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226380868">(Feb 15 2021 at 13:01)</a>:</h4>
<p>thank you</p>



<a name="226391353"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226391353" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226391353">(Feb 15 2021 at 14:37)</a>:</h4>
<p>This is legal as a conditional reference in a transaction bundle.</p>



<a name="226391768"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226391768" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226391768">(Feb 15 2021 at 14:41)</a>:</h4>
<p>True "Note, in addition, that a reference may be by identifier, and if it is, and there is no URL, it may be resolved by scanning the ids in the bundle. Note also that transactions may contain conditional references that must be resolved by the server before processing the matches. "</p>



<a name="226391894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/226391894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#226391894">(Feb 15 2021 at 14:42)</a>:</h4>
<p>Josh has a proposal out there to revamp <a href="http://build.fhir.org/bundle.html#references">http://build.fhir.org/bundle.html#references</a> - referencing within bundles remains a tricky subject ...</p>



<a name="227413311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227413311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227413311">(Feb 23 2021 at 11:08)</a>:</h4>
<p>So in HAPI we can post this resource</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span> <span class="p">:</span> <span class="s2">"AllergyIntolerance"</span><span class="p">,</span>
  <span class="nt">"type"</span> <span class="p">:</span> <span class="s2">"allergy"</span><span class="p">,</span>
  <span class="nt">"category"</span> <span class="p">:</span> <span class="p">[</span>
    <span class="s2">"food"</span>
  <span class="p">],</span>
  <span class="nt">"code"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">"text"</span> <span class="p">:</span> <span class="s2">"Allergic to shrimp"</span>
  <span class="p">},</span>
  <span class="nt">"patient"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">"reference"</span> <span class="p">:</span> <span class="s2">"Patient?identifier=https://www.ehealth.fgov.be/standards/fhir/NamingSystem/ssin|60102047165"</span>
  <span class="p">},</span>
  <span class="nt">"recordedDate"</span> <span class="p">:</span> <span class="s2">"2014-10-09T14:58:00+11:00"</span>
<span class="p">}</span>
</code></pre></div>



<a name="227413358"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227413358" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227413358">(Feb 23 2021 at 11:08)</a>:</h4>
<p>should that  be allowed?</p>



<a name="227413417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227413417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227413417">(Feb 23 2021 at 11:09)</a>:</h4>
<p>I don't think so, but perhaps I'm missing something</p>



<a name="227413572"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227413572" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227413572">(Feb 23 2021 at 11:10)</a>:</h4>
<p>No, only if it's part of a transaction..</p>



<a name="227416562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227416562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227416562">(Feb 23 2021 at 11:36)</a>:</h4>
<p>thank you. Should I submit an issue against HAPI?</p>



<a name="227440681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227440681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227440681">(Feb 23 2021 at 14:43)</a>:</h4>
<p>It's not technically non-conformant to handle that on an individual call - there's just no expectation it would be handled.</p>



<a name="227460037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227460037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227460037">(Feb 23 2021 at 16:31)</a>:</h4>
<p>Since this is equivalent to </p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="nt">"patient"</span> <span class="p">:</span> <span class="p">{</span>
  <span class="nt">"identifier"</span> <span class="p">:</span> <span class="p">{</span>
       <span class="nt">"value"</span> <span class="p">:</span> <span class="nt">"60102047165"</span>
       <span class="nt">"system"</span> <span class="p">:</span> <span class="s2">"https://www.ehealth.fgov.be/standards/fhir/NamingSystem/ssin"</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>I think it is not helpful to allow the search string in the reference....</p>



<a name="227461871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227461871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227461871">(Feb 23 2021 at 16:41)</a>:</h4>
<p>It's not really the same.  In a transaction, there's an expectation that conditional references will be resolved - and that failure to resolve or resolution to more than one is an error.  On the other hand, specifying Reference.identifier imposes no such expectations.</p>



<a name="227461968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227461968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227461968">(Feb 23 2021 at 16:42)</a>:</h4>
<p>Also, the example with an identifier is just one of the possible ways a conditional reference could be used.</p>



<a name="227473774"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227473774" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227473774">(Feb 23 2021 at 17:53)</a>:</h4>
<p>I was referring to the observed behavior where there was no bundle. If there is no expectation that the search in the reference will result in any specific action, it seems to be equivalent to a logical reference...</p>



<a name="227496593"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227496593" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227496593">(Feb 23 2021 at 20:17)</a>:</h4>
<p>In a transaction, search in the reference must be executed and resolved - or result in an error if not supported.  It won't be stored as the search.</p>



<a name="227498992"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227498992" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227498992">(Feb 23 2021 at 20:34)</a>:</h4>
<p>My point is that when POSTing an individual resource, search in reference will not be executed and resolved, and it shall not be stored as the search. Is that incorrect? </p>
<p>I am not arguing about transaction bundles.</p>



<a name="227499087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227499087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227499087">(Feb 23 2021 at 20:35)</a>:</h4>
<p>If you POST a bare resource like that, you're non-conformant.  Server is free to reject, ignore the element, resolve or whatever it likes.</p>



<a name="227509930"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227509930" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227509930">(Feb 23 2021 at 21:53)</a>:</h4>
<p>It seems to me that HAPI, being a reference implementation, should reject such a POST in order to alert the client that they are non-conformant.</p>



<a name="227510924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227510924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227510924">(Feb 23 2021 at 22:00)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="227520380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227520380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227520380">(Feb 23 2021 at 23:03)</a>:</h4>
<p>Resolving inline search expressions in references is an optional non-standard feature in HAPI FHIR that is disabled by default (but enabled on the public server)</p>



<a name="227543534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227543534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227543534">(Feb 24 2021 at 03:42)</a>:</h4>
<p>Can you disable it on the public server <span class="user-mention" data-user-id="191319">@James Agnew</span> - people often use that to see what they can expect in production.</p>



<a name="227543546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227543546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227543546">(Feb 24 2021 at 03:42)</a>:</h4>
<p>(and to test conformance)</p>



<a name="227579049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227579049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227579049">(Feb 24 2021 at 10:42)</a>:</h4>
<p>Yeah, I suppose we should.</p>



<a name="227651893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20by%20search/near/227651893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20by.20search.html#227651893">(Feb 24 2021 at 18:52)</a>:</h4>
<p>thank you. Indeed, we used that to see what could be admissible</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
