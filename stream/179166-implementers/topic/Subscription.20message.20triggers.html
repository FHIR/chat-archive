---
layout: page
title: "FHIR Chat  · Subscription message triggers · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html">Subscription message triggers</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="185089735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185089735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185089735">(Jan 08 2020 at 08:41)</a>:</h4>
<p>I'm working on a scenario of something like 'If patients is admitted to ED with an asthma condition send a Medication review to their GP (primary carer or organisation)'.</p>
<p>That's likely to be a message either HL7v2 ORM^O01 or FHIR equivalent and I'm not expecting for pub/sub to build the message or handle the delivery. I think I need a message-trigger channel which contains:</p>
<ul>
<li>EventCode (e.g. ORM^O01)</li>
<li>Recipient (endpoint) </li>
<li>Triggering resource (payload?)</li>
</ul>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;channel&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;message-trigger&quot;</span><span class="p">,</span>
  <span class="nt">&quot;eventCoding&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.org/fhir/message-events&quot;</span><span class="p">,</span>
    <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;order&quot;</span>
  <span class="p">},</span>
    <span class="nt">&quot;endpoint&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="nt">&quot;identifier&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;https://fhir.hl7.org.uk/Id/gmc-number&quot;</span><span class="p">,</span>
            <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;C3456789&quot;</span>
          <span class="p">}</span>
     <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>



<a name="185089910"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185089910" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185089910">(Jan 08 2020 at 08:45)</a>:</h4>
<p>Is this the best of doing this? I wouldn't expect the subscription handler to know how to send the message at this point (in my use case I think this would result in a HL7v3 message or an email)</p>



<a name="185090435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185090435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185090435">(Jan 08 2020 at 08:55)</a>:</h4>
<p>Seems like I'm describing R5 Subscription and main difference is using something like reference for endpoint.</p>



<a name="185153164"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185153164" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185153164">(Jan 08 2020 at 20:26)</a>:</h4>
<p>Hi Kevin.  First, apologies if this is a little disjointed - I'm at a connectathon and have had this open for a few hours.  I'm going to try and tackle your question in parts, with a few questions.  I'm going to go through it in Subscriptions R5:</p>
<p>1) I would start with basic Encounter-Start topic, and derive a new topic to add filtering for Encounter.class, which would allow a Subscription.filterBy on Encounter.class='EMER'.</p>
<p>2) To filter on asthma would be the same process (likely same step, no need to derive twice).</p>
<p>This process should work well if your use cases map well (e.g., the same topic will be useful for any type of admission and any condition).  IF this is representative of a class of scenarios with different fields, we should open some discussions on how to put events into SubscriptionTopics (e.g., have a topic which is defined solely by the event).</p>
<p>On the other side, I would recommend using a standard channel (e.g., REST) to get the notification to another internal system, which could then build the specific graph and forward on the notification in whatever channel fits your workflow.</p>



<a name="185187791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185187791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185187791">(Jan 09 2020 at 06:53)</a>:</h4>
<p>Yep that's sounds good. I need to research messaging side a little more, I think I may just  want to start a workflow - that could be rest channel to a process that converts it to a full message.</p>



<a name="185293614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185293614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185293614">(Jan 10 2020 at 09:22)</a>:</h4>
<p>On second thoughts what I'm wanting out from the Subscription is pass a message to pass to the another process to action the subscription.... Something like a message-hook channel which outputs a message bundle and includes:</p>
<ul>
<li>MessageHeader[1..1]</li>
<li>Resource[0..1] (rest-hook)</li>
<li>eventCoding[0..1] (for message)</li>
<li>Communication[0..1] (for SMS and email]</li>
</ul>
<p>This is based at looking at HAPI and wanting to decouple delivery from the server.</p>



<a name="185457097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185457097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185457097">(Jan 13 2020 at 00:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191687">@Kevin Mayfield</span>  are you referring to using the messaging channel? to output from a subscription a message?</p>



<a name="185473017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subscription%20message%20triggers/near/185473017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subscription.20message.20triggers.html#185473017">(Jan 13 2020 at 08:22)</a>:</h4>
<p>In part yes but I'm thinking the role of a subscription service (especially in a epr/ehr) is mainly to trigger events. It shouldn't action the events (build a fhir message, deliver sms or email). <br>
So in hapi jpa, subscription works as is but events (email, sms, message--trigger) are sent to middleware (service) such as apache camel to action.</p>
<p>A subscription in a middleware service would work as is. </p>
<p>Wonder if I'm describing new channel types?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
