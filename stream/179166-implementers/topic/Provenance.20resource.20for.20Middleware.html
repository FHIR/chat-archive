---
layout: page
title: "FHIR Chat  · Provenance resource for Middleware · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html">Provenance resource for Middleware</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153826613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826613">(May 10 2016 at 22:47)</a>:</h4>
<p>While trying to compose a Provenance resource to annotate stuff that is extracted from a V2 message and posted on a server, I just realized, that Provenance doesn't fit this use case very well. I hardly find any useful values to fill in, if the agent is a middleware engine.</p>



<a name="153826615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826615">(May 10 2016 at 22:48)</a>:</h4>
<p>Would the V2 message I pulled the stuff from be considered an "entity" in this context?</p>



<a name="153826616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826616">(May 10 2016 at 22:48)</a>:</h4>
<p>Simone, please explain why you see it as not useful? Rene did find it useful to explain where the v2 object came from, and to point at a copy of the original in Provenance.entity</p>



<a name="153826617"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826617" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826617">(May 10 2016 at 22:49)</a>:</h4>
<p>Yes, Povenance.entity would be the information used in creating the 1..* Provenance.target resources</p>



<a name="153826618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826618">(May 10 2016 at 22:51)</a>:</h4>
<p>I'm not saying Provenance isn't useful, but I am having trouble fitting things like "name of the middleware system", "id of the original message" into it or picking proper values for agent.role etc.</p>



<a name="153826619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826619">(May 10 2016 at 22:51)</a>:</h4>
<p>I do have an example that I have not yet integrated into the build that Rene did...</p>



<a name="153826620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826620">(May 10 2016 at 22:51)</a>:</h4>
<p>Oh yes please! That would be helpful!</p>



<a name="153826621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826621">(May 10 2016 at 22:52)</a>:</h4>
<p>Rene worked on it... this might be his blog on the topic  <a href="http://www.ringholm.com/docs/04350_mapping_HL7v2_FHIR.htm" target="_blank" title="http://www.ringholm.com/docs/04350_mapping_HL7v2_FHIR.htm">http://www.ringholm.com/docs/04350_mapping_HL7v2_FHIR.htm</a></p>



<a name="153826622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826622">(May 10 2016 at 22:53)</a>:</h4>
<p>of course things change from blog articles, so check with him... </p>



<a name="153826623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826623">(May 10 2016 at 22:58)</a>:</h4>
<p>Hah. That's fun. The place where Rene captured the fact, that the Agent is in fact a software (agent.type) is missing in the resource definition ...</p>



<a name="153826624"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826624" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826624">(May 10 2016 at 23:03)</a>:</h4>
<p>likely now Provenance.agent.role</p>



<a name="153826625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826625">(May 10 2016 at 23:03)</a>:</h4>
<p>reason.text to capture the fact that this is the result of a message transformation doesn't work either because reason is a Coding not a CodableConcept</p>



<a name="153826626"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826626" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826626">(May 10 2016 at 23:04)</a>:</h4>
<p>I would be glad to put an example into the specification... Just need a few eyes to look one example over before we put it in. I would suggest you work with Rene and suggest one example.</p>



<a name="153826627"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826627" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826627">(May 10 2016 at 23:05)</a>:</h4>
<p>love to get these suggestions as CPs... need real-world input. </p>



<a name="153826629"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826629" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826629">(May 10 2016 at 23:34)</a>:</h4>
<p>ok, let's set up the scenario:  We have some sort of middleware device that receives some sort of non-FHIR input (e.g. a V2 message, a CDA document, a CSV file...)  and extracts FHIR resources from this input and posts them on a server. The resulting transaction is supposed to include a provenance resource that captures <br>
a) some information about the middleware (type, vendor, version...)<br>
b) information about the data source (type/format, identifier (original filename or messageID ) to trace it back)<br>
c) if known,  information about the software that created the original input<br>
d) if known, information about the user that created the information in the first place (e.g. from the EVN-Segment)</p>



<a name="153826630"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826630" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826630">(May 10 2016 at 23:35)</a>:</h4>
<p>Would a) c) and d) be all agents, or would any of them be a relatedAgent?</p>



<a name="153826631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153826631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153826631">(May 10 2016 at 23:37)</a>:</h4>
<p>The roles (<a href="http://hl7-fhir.github.io/valueset-provenance-agent-role.html" target="_blank" title="http://hl7-fhir.github.io/valueset-provenance-agent-role.html">http://hl7-fhir.github.io/valueset-provenance-agent-role.html</a>) could be<br>
a) assembler<br>
c) composer<br>
d) author<br>
...does that make sense?</p>



<a name="153827036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153827036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153827036">(May 11 2016 at 19:45)</a>:</h4>
<p>I don't know how to fit b) into the entity part of provenance. Though the entity.role "derived" seems like a good fit, it seems that the entity itself is expected to be a FHIR resource.</p>



<a name="153827063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153827063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153827063">(May 11 2016 at 20:17)</a>:</h4>
<p>I created <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996">http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996</a> to keep track of this.</p>



<a name="153828873"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153828873" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153828873">(May 20 2016 at 14:55)</a>:</h4>
<p>Oh, I just realized we talked about Rene, but didn't tag him. So: <span class="user-mention" data-user-id="191372">@René Spronk</span> : Care to chime in? :)</p>



<a name="153839693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153839693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glen Marshall <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153839693">(Jul 19 2016 at 16:19)</a>:</h4>
<p>[#9996] Summary: Using Provenance resource to annotate content derived from non-FHIR sources </p>



<a name="153839694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153839694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glen Marshall <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153839694">(Jul 19 2016 at 16:19)</a>:</h4>
<p>Original comment:</p>
<p>While trying to compose a Provenance resource to annotate stuff that is extracted from a V2 message and posted on a server, I just realized, that Provenance doesn't fit this use case very well. I hardly find any useful values to fill in, if the agent is a middleware engine.</p>
<p>Here's the Scenario:</p>
<p>We have some sort of middleware device that receives some sort of non-FHIR input (e.g. a V2 message, a CDA document, a CSV file...) and extracts FHIR resources from this input and posts them on a server. The resulting transaction is supposed to include a provenance resource that captures <br>
a) some information about the middleware (type, vendor, version...)<br>
b) information about the data source (type/format, identifier (original filename or messageID ) to trace it back)<br>
c) if known, information about the software that created the original input<br>
d) if known, information about the user that created the information in the first place (e.g. from the EVN-Segment)</p>
<p>Would a) c) and d) be all agents, or would any of them be a relatedAgent?</p>
<p>The roles (<a href="http://hl7-fhir.github.io/valueset-provenance-agent-role.html" target="_blank" title="http://hl7-fhir.github.io/valueset-provenance-agent-role.html">http://hl7-fhir.github.io/valueset-provenance-agent-role.html</a>) could be<br>
a) assembler<br>
c) composer<br>
d) author</p>
<p>...does that make sense?</p>
<p>I don't know how to fit b) into the entity part of provenance. Though the entity.role "derived" seems like a good fit, it seems that the entity itself is expected to be a FHIR resource and nothing else...</p>
<p>Help, please!</p>
<p>Proposed response: </p>
<p>Accepted with modification: include the following non-normative guidance:<br>
1.  The middleware, original input, and use are all agents.  They act independently of each other, so are not relatedAgent.  Each is associated with a Provenance instance.        <br>
2.  Middleware is an assembler for the purposes of Provenance.  Other agents are assigned roles per the role vocabulary definitions.<br>
3.  Metadata, if known, should be associated with each of the agents.  Any missing values should be null or default, depending on the defined cardinality in Provenance.</p>



<a name="153839697"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153839697" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glen Marshall <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153839697">(Jul 19 2016 at 16:20)</a>:</h4>
<p>Also,  the Provenance.entity might point at a copy of the raw data received (e.g. the HL7 v2 message). This might have been saved as a Binary resource for this purpose.</p>



<a name="153839717"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153839717" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153839717">(Jul 19 2016 at 16:58)</a>:</h4>
<p>Hi Simone.  I think this is a good use case because it involves which actor roles are used based on what is being imported and how.  I'll give you my opinion piecemeal so it's easier to respond to.  </p>
<p>1) The provenance information that is extracted from the original file/data should be extracted and identified in the new resource that is created.  The system should be able to pull that out if it's a readable file.  </p>
<p>2) I don't think information about the software that created the original data/file matters or will be available in a majority of cases unless they have referenced the device used to author the documents.  What I'm getting at is the original software probably doesn't matter.</p>
<p>3) The middleware is IDed as an agent.  I think it's a related agent to the local system, which is also IDed as as agent, but I think the value sets are lacking to describe this.  </p>
<p>4)  The most important point in this whole thing for me is the agent role.  In this case, I'm talking about the local system acting as an agent and taking the message or CDA document and turning it into a resource.  If it is taking a message or PDF or flat file or anything that is reproduced on a 1:1 basis, I think the role should always be author.  It is authoring a new resource from existing data but isn't making any changes.  If I as a downstream system see this, I will know I don't have to dig any deeper or validate anything because "author" is used in these 1:1 cases.  If the local system is disassembling a larger document but keeping all the data intact (1:1) during the resource creation process, then "author" should still apply, even though the end result is distributed among more than one resource.  Even though an algorithm is being used to perform the disassembly and creation, you can still trace everything back to the original file and nothing has been modified.  That is important because it relates to downstream validation and use.  If, however, you are using logic or algorithms to alter the source data or reduce or modify anything in the full set, then assembler or composer apply.  That role ID should be reserved to ID changes that have been applied in my opinion.  It's assembler if the process is automated, without human intervention and decision-making.  It's composer if someone is actually intervening and adding their logic or selections to the software that is used to perform the action.  In that case, the human is also acting as an agent and needs to be referenced.  </p>
<p>The larger point here is that me as a downstream system can use that scheme to figure out if I need to validate the results further or check the original to see if I can trust it as a complete data set.  The agent role matters to me for that reason.  If I see author I can just move on, if I see either of the other two, there are additional steps that I may have to implement to ensure data fidelity.  I think we should probably talk about this and define it somewhere in the spec because the implications for system operations are large.</p>



<a name="153839792"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153839792" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153839792">(Jul 19 2016 at 20:12)</a>:</h4>
<p>Note this discussion is in support of us coming to a resolution on <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996">GF#9996</a></p>



<a name="153839794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153839794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153839794">(Jul 19 2016 at 20:13)</a>:</h4>
<p><span class="user-mention" data-user-id="191372">@René Spronk</span> we really need your input, suggestion, improvements.</p>



<a name="153840538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153840538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153840538">(Jul 22 2016 at 08:47)</a>:</h4>
<p>I think Simone captures the requirements pretty well. </p>



<a name="153840539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153840539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153840539">(Jul 22 2016 at 08:53)</a>:</h4>
<p>An analogy: if you were to receive a translation (in English) of a Chinese clinical document, you'd like to know who the translation-agent was (a human, presumably one could look up their qualifications [the qualifications of the translator arent part of the provenance resource itself], or Google Translate). Yes, it would also be nice to know the original author of the document, but that may be a different provenance resource than the provenance resource which focuses on the "translation" activity. Maybe the v2-FHIR middelware solution should create two provenance resources ? (not sure) . <span class="user-mention" data-user-id="191450">@Simone Heckmann</span>  deals with the actual use case, so she's best positioned to make a recomendation..</p>



<a name="153843252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153843252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153843252">(Aug 09 2016 at 21:54)</a>:</h4>
<p>The Provenance that the middleware can apply is only at the perspective from the middleware. </p>
<p>1. It receives from sender X, payload Y.<br>
2. It optionally saves payload Y as a FHIR Binary Resource (Y')<br>
3. It disassembles Y into some number of Z FHIR Resources (Z(n)) which it creates<br>
4. It creates a Provenance record P, with <br>
       P.target all of Z(n); <br>
       P.agent[0] - self as assembler; <br>
       P.agent[1] is X as a ???; <br>
       P.entity is Y' as source</p>
<p>What we learn is that for the P.agent[1], we don't have a way to say 'source' for the role of that agent. So we have a need of new vocabulary.</p>



<a name="153843671"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153843671" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153843671">(Aug 11 2016 at 20:07)</a>:</h4>
<p>I think the provenance resource will most likely be used for debugging purposes.<br>
Whatever the middleware algorithm is, that authors/assemples the Resources: It can potentially be flawed.<br>
And whenever such a flaw is detected, there needs to be a way to backtrace, which resources have been affected.</p>
<p>It may also be that the original author (the sending software system) was affected e.g. by a system update and exported flawed data. In that case it would be helpful if I could trace back the Resources not only to the middleware but also to the original authoring system. However, I don't think there is a requirement to trace back to the original data enterer (the user of the authoring system). Most of the time this information can be retrieved from the source data (e.g. V2 EVN-Segment) and I don't see a use case that would require this to be searchable.</p>
<p>I can imagine that having the original data as binary attachment will be helpful for debugging purposes. E.g. if a Resource looks suspicios, you can take a look at the original data to figure out whether the middleware or the original sending system is to blame.</p>
<p>Beyond that I don't have any other requirements. However, that's from my Middleware point of view. Server implementers may have different use cases altogether for the provenance Resource.</p>
<p>In the end: since the provenance Resource creates an enormous overhead in the communication and will most likely be implemented only reluctantly, I'd vote for: the simpler, the better!</p>



<a name="153843740"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153843740" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153843740">(Aug 12 2016 at 15:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191450">@Simone Heckmann</span> Given your post, I think my proposal aligns with it? Where as Glen's proposal added additional elements that you discounted. I agree the intermediary should only be responsible for the things that the intermediary can see from its perspective. If original author is necessary for a use-case then original content should have included author provenance, which would have been processed by the intermediary just like any content. This encapsulated provenance is source provenance not intermediary provenance.   correct?</p>



<a name="153855995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153855995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153855995">(Nov 08 2016 at 17:19)</a>:</h4>
<p>Security WG will discuss proposed change for <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996">GF#9996</a> today. Mostly explanation keeping with discussion here in chat and workgroup. Adding an explanation to the Provenance page explaining how middleware that transforms information on import might record this fact in a Provenance record.</p>



<a name="153855996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153855996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153855996">(Nov 08 2016 at 17:25)</a>:</h4>
<p>Sorry, I missed you tagging me with your last question. I don't understand "This encapsulated provenance is source provenance not intermediary provenance?" What do you mean by "encapsulated provenance"?</p>



<a name="153855997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153855997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153855997">(Nov 08 2016 at 17:31)</a>:</h4>
<p>Hi Simone.  The source data might include 'provenance' (likely in source data format). That kind of provenance is very helpful to explain the history of the source data prior to the middleware doing anything. That provenance is to the middleware, just like all the other source data... that is it is source data that the middleware imports, transforms, and hopefully properly created FHIR Resouces. What I was pointing out is that that provenance is not the topic of the CR, the topic of the CR is what Provenance record should the middleware create to explain what the middleware did.    That said, my proposal in <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996">GF#9996</a> does have a paragraph explaining this. Hopefully we can get the words improved.</p>



<a name="153855998"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153855998" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153855998">(Nov 08 2016 at 17:33)</a>:</h4>
<p>In this case, the answer is: yes :)</p>



<a name="153855999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153855999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153855999">(Nov 08 2016 at 17:35)</a>:</h4>
<p>do you like the proposal in <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996">GF#9996</a>?</p>



<a name="153856003"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856003" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856003">(Nov 08 2016 at 17:44)</a>:</h4>
<p>Using Binary attachment to store the original V2 message -&gt; agreed.<br>
So we'd have something like Provenance.source.data of type reference with choice of (Binary|Bundle|ImagingStudy and whatnot)?<br>
I think it would be useful to have at least have also a Provenance.source.identifier. If I know that a certain V2 message was sent in error, I'd want to be able to search by messageControlId and figure out which Resources have been created from this message without having to parse all of the binary attachments.</p>



<a name="153856007"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856007" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856007">(Nov 08 2016 at 17:59)</a>:</h4>
<p>Interesting... Wonder if this is more of a Binary responsibility... </p>



<a name="153856008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856008">(Nov 08 2016 at 18:00)</a>:</h4>
<p>or does that call for treating the original v2 message as Document, and thus using DocumentReference to hold this identifier metadata?</p>



<a name="153856009"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856009" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856009">(Nov 08 2016 at 18:04)</a>:</h4>
<p>The _has-parameter doesn't support chaining, so having it in the Binary resource won't help.</p>



<a name="153856010"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856010" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856010">(Nov 08 2016 at 18:05)</a>:</h4>
<p>It has to be an attribute of Provenance</p>



<a name="153856011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856011">(Nov 08 2016 at 18:09)</a>:</h4>
<p>"Give me all Observations created from the V2 message with controlId 123456" would have to be something like <code>/Observation?_has:Provenance:target:source-identifier=123456</code><br>
...assuming Provenance.source.identifier had a search attribute named "source-identifier"<br>
There's no way to use chaining like Provenance.source:Binary.identifier or something like that with the _has-Parameter</p>



<a name="153856013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856013">(Nov 08 2016 at 18:12)</a>:</h4>
<p>so, we should add an element to Provenance.entity.identifier to be used only when Provenance.entity.reference is Binary? Otherwise we create an element that can be in conflict with a FHIR native Resource that is pointed to by Provenance.entity.reference.</p>



<a name="153856014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856014">(Nov 08 2016 at 18:17)</a>:</h4>
<p>Ah, no! I think the solution is much easier:<br>
entity.reference needs to be changed from Datatype "uri" to Datatype "Reference"</p>



<a name="153856015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856015">(Nov 08 2016 at 18:18)</a>:</h4>
<p>but it is URI because it might not always be a FHIR native object. Even in your case the content might be stored somewhere else, not as a FHIR Binary; but as just a HTTP object. </p>



<a name="153856016"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856016" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856016">(Nov 08 2016 at 18:18)</a>:</h4>
<p>Then it can be either a literal reference to a Binary/Document.... and/or a logical reference hlding only an identifier: <a href="http://build.fhir.org/references.html#logical" target="_blank" title="http://build.fhir.org/references.html#logical">http://build.fhir.org/references.html#logical</a></p>



<a name="153856017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856017">(Nov 08 2016 at 18:19)</a>:</h4>
<p>Reference.reference may point at non-FHIR stuff: <a href="http://build.fhir.org/references.html#literal" target="_blank" title="http://build.fhir.org/references.html#literal">http://build.fhir.org/references.html#literal</a></p>



<a name="153856018"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856018" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856018">(Nov 08 2016 at 18:19)</a>:</h4>
<p>seems we have a new discussion... do we do as you recommend, and thus can't point at source that are not FHIR objects.... or we add an identifier.</p>



<a name="153856019"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856019" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856019">(Nov 08 2016 at 18:20)</a>:</h4>
<p>hmmm,that must have happened after this was modeled in Provenance this way.</p>



<a name="153856020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856020">(Nov 08 2016 at 18:20)</a>:</h4>
<p>so, we can change agent.reference to a Reference, and remove agent.type as it is unnecessary?</p>



<a name="153856021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856021">(Nov 08 2016 at 18:20)</a>:</h4>
<p>Logical References were introduced during Baltimore WGM</p>



<a name="153856022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856022">(Nov 08 2016 at 18:22)</a>:</h4>
<p>guess I can get rid of entity.display too.</p>



<a name="153856023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856023">(Nov 08 2016 at 18:24)</a>:</h4>
<p>you mean "entity.type"? I guess so. I have never seen any other Resource that has a reference to a choice of targets and adds a "type" attribute to specify which it is. I guess FHIR implementers are used to deal with this kind of ambiguity</p>



<a name="153856024"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856024" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856024">(Nov 08 2016 at 18:25)</a>:</h4>
<p>type was there to support uri that was not a FHIR object. So, now that these are in the definition of the Reference datatype they are unnecessary </p>



<a name="153856025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856025">(Nov 08 2016 at 18:27)</a>:</h4>
<p>I updated <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996">GF#9996</a> with this new information as part of the proposed resolution.</p>



<a name="153856027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153856027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153856027">(Nov 08 2016 at 18:38)</a>:</h4>
<p>Actually, I'm not really sure how searching for a logical reference works.<br>
...wait. I'll ask that in another thread...</p>



<a name="153858021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Provenance%20resource%20for%20Middleware/near/153858021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Provenance.20resource.20for.20Middleware.html#153858021">(Nov 21 2016 at 20:17)</a>:</h4>
<p><img alt=":thumbs_up:" class="emoji" src="/static/third/gemoji/images/emoji/thumbs_up.png" title=":thumbs_up:"> for the resolution of <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9996">GF#9996</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
