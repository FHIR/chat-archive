---
layout: page
title: "FHIR Chat  · Reverse chaining with filtering on Task.Owner · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html">Reverse chaining with filtering on Task.Owner</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="263062870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263062870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Toft <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263062870">(Nov 29 2021 at 20:21)</a>:</h4>
<p>I would like to make a reverse chained query that fetches all Observations of all Encounters of all Tasks related to a specific Organization. I would also like to make a reverse chained query that fetches all Observations of all Encounters of all Tasks related to a specific PractitionerRole.</p>
<p>Given these queries I find that the "Task.owner.PractitionerRole=some_id" filter matches both Organizations with that id and PractitionerRoles with the id. Even though I have specified the reference type, I get results not matching that type. The same applies for the other query "Task.owner.Organization=some_id" which also does not honor the reference type and does return matching PractionerRole resources. </p>
<p>The model:</p>
<ul>
<li>Encounter.reasonReference references Observation</li>
<li>Task.encounter references Encounter</li>
<li>Task.owner is either a reference to an Organization or a PractitionerRole</li>
</ul>
<p>The queries:</p>
<ul>
<li>Observation?_has:Encounter:reason-reference:_has:Task:encounter:owner.organization=some_id</li>
<li>Observation?_has:Encounter:reason-reference:_has:Task:encounter:owner.practitionerrole=some_id</li>
</ul>
<p>Any ideas on this? Bug, feature, or am I missing something?</p>
<p>Thanks.</p>



<a name="263073316"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263073316" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263073316">(Nov 29 2021 at 22:00)</a>:</h4>
<p>What server are you trying this on?</p>



<a name="263112919"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263112919" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Toft <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263112919">(Nov 30 2021 at 08:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197072">Paul Church</span> <a href="#narrow/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner/near/263073316">said</a>:</p>
<blockquote>
<p>What server are you trying this on?</p>
</blockquote>
<p>I am using HAPI FHIR 5.4.1</p>



<a name="263113399"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263113399" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263113399">(Nov 30 2021 at 08:36)</a>:</h4>
<p>Does the 'self' link in the response bundle echo your entire search URL?</p>



<a name="263118691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263118691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Toft <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263118691">(Nov 30 2021 at 09:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191372">René Spronk</span> <a href="#narrow/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner/near/263113399">said</a>:</p>
<blockquote>
<p>Does the 'self' link in the response bundle echo your entire search URL?</p>
</blockquote>
<p>I believe so. When executing this query:<br>
Observation?_has:Encounter:reason-reference:_has:Task:encounter:owner.practitionerrole=1952</p>
<p>The return self link is:<br>
Observation?_has%3AEncounter%3Areason-reference%3A_has%3ATask%3Aencounter%3Aowner.practitionerrole=1952</p>



<a name="263119505"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263119505" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263119505">(Nov 30 2021 at 09:34)</a>:</h4>
<p>If that's the case, and you're sure there  is matching data on the server, I'd urge you to start looking for server-side issues. Perhaps using the <a class="stream" data-stream-id="179167" href="/#narrow/stream/179167-hapi">#hapi</a>  stream on this forum.</p>



<a name="263158908"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263158908" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Toft <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263158908">(Nov 30 2021 at 15:15)</a>:</h4>
<p>Thanks for the help.</p>
<p>I did some more digging. As it turns out I can actually query what I want.</p>
<p>This query will give me Observations referenced by the PractitionerRole with id 1234:<br>
Observation?_has:Encounter:reason-reference:_has:Task:encounter:owner=PractitionerRole/1234</p>
<p>This query will give me Observations referenced by the Organization with id 5678:<br>
Observation?_has:Encounter:reason-reference:_has:Task:encounter:owner=Organization/5678</p>
<p>This query will give me Observations referenced by any Task.owner reference with id 1234 or 5678. Note the JIBBERISH at the end. This is the part that confused me. I would expect the server to return an error:<br>
Observation?_has:Encounter:reason-reference:_has:Task:encounter:owner.JIBBERISH=1234,5678</p>



<a name="263160905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263160905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263160905">(Nov 30 2021 at 15:29)</a>:</h4>
<p>I guess the self link doesn't contain the JIBBERISH part. If it does, talk to the authors of your server software. A server is supposed to largely ignore all parts of a search URL it doesn't understand, and to provide you with the best matching result set given what it does understand.</p>



<a name="263160974"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263160974" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263160974">(Nov 30 2021 at 15:29)</a>:</h4>
<p>Re: jibberish, In general, servers are free to ignore search parameters they don't understand and are supposed to communicate to clients the list of search parameters they did understand by populating the Bundle.link[self] of the response. See <a href="http://build.fhir.org/search.html#errors">http://build.fhir.org/search.html#errors</a></p>



<a name="263253557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reverse%20chaining%20with%20filtering%20on%20Task.Owner/near/263253557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Toft <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner.html#263253557">(Dec 01 2021 at 07:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179166-implementers/topic/Reverse.20chaining.20with.20filtering.20on.20Task.2EOwner/near/263160974">said</a>:</p>
<blockquote>
<p>Re: jibberish, In general, servers are free to ignore search parameters they don't understand and are supposed to communicate to clients the list of search parameters they did understand by populating the Bundle.link[self] of the response. See <a href="http://build.fhir.org/search.html#errors">http://build.fhir.org/search.html#errors</a></p>
</blockquote>
<p>I see Your point. However the JIBBERISH is part of the returned self link. As I read the docs that should not be the case unless it is used for the search.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
