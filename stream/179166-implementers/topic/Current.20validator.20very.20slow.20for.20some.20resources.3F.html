---
layout: page
title: "FHIR Chat  · Current validator very slow for some resources? · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html">Current validator very slow for some resources?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="216316797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216316797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216316797">(Nov 11 2020 at 08:09)</a>:</h4>
<p>Hi <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Running the latest validator this morning, I noticed it was extremely slow for certain resources. It seems to be very dependent on the resource/resource type (seem to work as usual for some), but I see it e.g. on this  QuestionnaireResponse example: <a href="http://hl7.org/fhir/R4/questionnaire-example.json">http://hl7.org/fhir/R4/questionnaire-example.json</a> Validating this standard example just now took 1 min 19 secs!  The slowness remains even when switching off the terminology serverm, so that is not the issue. There are no errors being thrown,  either (see command line output below). Any ideas where this might be coming from?</p>
<div class="codehilite"><pre><span></span><code>FHIR Validation tool Version 5.1.21 (Git# 5b62d35f715f). Built 2020-11-11T02:04:31.124Z (5 hours old)
  Java:   1.8.0_222 from /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre on x86_64 (64bit). 3641MB available
  Paths:  Current = [....], Package Cache = /Users/[...]/.fhir/packages
  Params: -version 4.0.1 -tx n/a test.json
Loading
  Load FHIR v4.0 from hl7.fhir.r4.core#4.0.1 - 4575 resources (00:03.0671)
  Terminology server null - Version n/a: No Terminology Server (00:00.0000)
  Get set...  go (00:00.0002)
Validating
  Validate test.jsonTerminology server: Check for supported code systems for http://cancer.questionnaire.org/system/code/yesno
==============!! Running without terminology server !! ==============
=====================================================================
 01:19.0046
Done. Times: Loading: 00:03.0862, validation: 01:19.0046

Success: 0 errors, 2 warnings, 5 notes
  Information @ QuestionnaireResponse (line 1, col2) : No questionnaire is identified, so no validation can be performed against the base questionnaire
  Information @ QuestionnaireResponse.item[0].item[0].answer[0].value.ofType(Coding) (line 77, col83) : Code System URI &#39;http://cancer.questionnaire.org/system/code/yesno&#39; is unknown so the code cannot be validated
  Information @ QuestionnaireResponse.item[0].item[0].answer[0].item[0].item[0].answer[0].value.ofType(Coding) (line 87, col99) : Code System URI &#39;http://cancer.questionnaire.org/system/code/yesno&#39; is unknown so the code cannot be validated
  Information @ QuestionnaireResponse.item[0].item[0].answer[0].item[0].item[1].answer[0].value.ofType(Coding) (line 96, col99) : Code System URI &#39;http://cancer.questionnaire.org/system/code/yesno&#39; is unknown so the code cannot be validated
  Information @ QuestionnaireResponse.item[0].item[0].answer[0].item[0].item[2].answer[0].value.ofType(Coding) (line 105, col99) : Code System URI &#39;http://cancer.questionnaire.org/system/code/yesno&#39; is unknown so the code cannot be validated
  Warning @ QuestionnaireResponse.contained[0].ofType(Patient).identifier[1].type (line 18, col22) : No code provided, and a code should be provided from the value set http://hl7.org/fhir/ValueSet/identifier-type (http://hl7.org/fhir/ValueSet/identifier-type)
  Warning @ QuestionnaireResponse.contained[2].ofType(Practitioner).identifier[0].type (line 44, col18) : No code provided, and a code should be provided from the value set http://hl7.org/fhir/ValueSet/identifier-type (http://hl7.org/fhir/ValueSet/identifier-type)
</code></pre></div>



<a name="216353351"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216353351" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216353351">(Nov 11 2020 at 14:36)</a>:</h4>
<p>Does it run slow still once you have an updated cache?  (Questionnaires often involve lots of vocabulary validation)</p>



<a name="216444561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216444561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216444561">(Nov 12 2020 at 09:22)</a>:</h4>
<p>Strangely, this morning the example I mentioned above runs fine (less than a second), but I still see this problem on other resources. I played around a bit and found the following:</p>
<ul>
<li>Running the same validation repeatedly does not improve the speed - I imagine that means it is not due to a stale cache(?)</li>
<li>All the slow runs seem to run for pretty much exactly 1 min 19 secs, so there does not seem to be a strong dependence on resource details</li>
<li>Slow runs seem to be triggered by custom code system canonical URLs that contain particular "FHIR-words", e.g. "CodeSystem". For instance, comparing the two examples below,  having "CodeSystem"  (as opposed to "SodeCystem") in the URL bumps the validation time from 0.5 secs to 1 min 19 secs (!):</li>
</ul>
<p>Slow example <code>Encounter.type.coding.system</code> = "<a href="http://somreandomurl.com/CodeSystem/test">http://somreandomurl.com/CodeSystem/test</a>" :</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Encounter"</span><span class="p">,</span>
    <span class="nt">"status"</span><span class="p">:</span> <span class="s2">"finished"</span><span class="p">,</span>
    <span class="nt">"class"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/v3-ActCode"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"AMB"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"ambulatory"</span>
    <span class="p">},</span>
    <span class="nt">"type"</span><span class="p">:</span> <span class="p">[{</span>
        <span class="nt">"coding"</span><span class="p">:</span> <span class="p">[{</span>
            <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://somreandomurl.com/CodeSystem/test"</span><span class="p">,</span>
            <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"somecode"</span>
        <span class="p">}]</span>
    <span class="p">}],</span>
    <span class="nt">"period"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"start"</span><span class="p">:</span> <span class="s2">"2020-02-06"</span><span class="p">,</span>
        <span class="nt">"end"</span><span class="p">:</span> <span class="s2">"2020-02-06"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Fast example  - identical to the above, except that <code>Encounter.type.coding.system</code> = "<a href="http://somreandomurl.com/SodeCystem/test">http://somreandomurl.com/SodeCystem/test</a>" :</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Encounter"</span><span class="p">,</span>
    <span class="nt">"status"</span><span class="p">:</span> <span class="s2">"finished"</span><span class="p">,</span>
    <span class="nt">"class"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/v3-ActCode"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"AMB"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"ambulatory"</span>
    <span class="p">},</span>
    <span class="nt">"type"</span><span class="p">:</span> <span class="p">[{</span>
        <span class="nt">"coding"</span><span class="p">:</span> <span class="p">[{</span>
            <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://somreandomurl.com/SodeCystem/test"</span><span class="p">,</span>
            <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"somecode"</span>
        <span class="p">}]</span>
    <span class="p">}],</span>
    <span class="nt">"period"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"start"</span><span class="p">:</span> <span class="s2">"2020-02-06"</span><span class="p">,</span>
        <span class="nt">"end"</span><span class="p">:</span> <span class="s2">"2020-02-06"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>



<a name="216538660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216538660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charlie Filkins <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216538660">(Nov 12 2020 at 22:30)</a>:</h4>
<p>I have been experiencing problems as well on a number of different machines, with different network configurations, and with different versions of the Validator. I used WireShark to capture some network traffic and found a number of 502 Bad Gateway responses to <a href="http://packages2.fhir.org">http://packages2.fhir.org</a>. I did notice that one validation (sadly, I can't recall which particular file) did run at what I would call a "normal" speed.</p>



<a name="216539677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216539677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216539677">(Nov 12 2020 at 22:38)</a>:</h4>
<p>hmm it shouldn't be hitting <a href="http://packages2.fhir.org">packages2.fhir.org</a>...</p>



<a name="216550061"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216550061" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216550061">(Nov 13 2020 at 00:34)</a>:</h4>
<p>you'll both be glad to know that for me, validating the fast resource takes 01:28, and the slow resource takes 1:50</p>



<a name="216553848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216553848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216553848">(Nov 13 2020 at 01:24)</a>:</h4>
<p>and now that I fixed a few things, both now take 00:00.02</p>



<a name="216570156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Current%20validator%20very%20slow%20for%20some%20resources%3F/near/216570156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Current.20validator.20very.20slow.20for.20some.20resources.3F.html#216570156">(Nov 13 2020 at 05:48)</a>:</h4>
<p>Indeed, sounds great! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
