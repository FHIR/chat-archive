---
layout: page
title: "FHIR Chat  · HAPI validator error - traversing bundles · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html">HAPI validator error - traversing bundles</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153991221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/153991221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Katie Wheatley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#153991221">(Aug 28 2018 at 12:22)</a>:</h4>
<p>I received this error message when running HAPI 3.4 against the attached xml message instance named ITK-OPL-TEST-019-1.xml. I would like clarification as to why this error appears as I do not understand why HAPI is throwing it out as an error. I would not expect the entries it identifies as problematic in the second document bundle to be reachable from the first message bundle as I believe the two bundles should be separate. Also, there are many entries within the document bundle which cannot be reached from the first bundle and these are not highlighted as errors, so why these ones in particular? Should this error message rather be a warning instead?<br>
The entries which are highlighted as problematic are those in the document bundle which are based on the Practitioner and Organization resources. These resources are also referenced in the message bundle, specifically from the profile ITK-MessageHeader-2, but the profiles are different and differently named to those in the document bundle, e.g. in the message bundle they are named CareConnect-ITK-Header-Practitioner-1 and CareConnect-ITK-Header-Organization-1 and in the document bundle they are named CareConnect-Organization-1 and CareConnect-Practitioner-1.<br>
Below are the links to the raw xml for the relevant FHIR profiles too, as I believe these could be pertinent to solving this issue.</p>
<p><a href="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-Message-Bundle-1/_history/1.1?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-Message-Bundle-1/_history/1.1?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/ITK-Message-Bundle-1/_history/1.1?_format=xml</a><br>
<a href="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-Document-Bundle-1/_history/1.1?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-Document-Bundle-1/_history/1.1?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/ITK-Document-Bundle-1/_history/1.1?_format=xml</a><br>
<a href="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-MessageHeader-2/_history/2.1?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-MessageHeader-2/_history/2.1?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/ITK-MessageHeader-2/_history/2.1?_format=xml</a><br>
<a href="https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ITK-MessageHandling-2/_history/2.1?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ITK-MessageHandling-2/_history/2.1?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ITK-MessageHandling-2/_history/2.1?_format=xml</a><br>
<a href="https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-Header-Practitioner-1/_history/1.1?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-Header-Practitioner-1/_history/1.1?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-Header-Practitioner-1/_history/1.1?_format=xml</a><br>
<a href="https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-Header-Organization-1/_history/1.1?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-Header-Organization-1/_history/1.1?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-Header-Organization-1/_history/1.1?_format=xml</a><br>
<a href="https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Practitioner-1/_history/1.0?_format=xml" target="_blank" title="https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Practitioner-1/_history/1.0?_format=xml">https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Practitioner-1/_history/1.0?_format=xml</a><br>
<a href="https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1/_history/1.0?_format=xml" target="_blank" title="https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1/_history/1.0?_format=xml">https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1/_history/1.0?_format=xml</a><br>
<a href="https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-OPL-Composition-1/_history/1.2?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-OPL-Composition-1/_history/1.2?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-ITK-OPL-Composition-1/_history/1.2?_format=xml</a><br>
<a href="https://fhir.nhs.uk/STU3/StructureDefinition/Extension-CareSettingType-1/_history/1.0?_format=xml" target="_blank" title="https://fhir.nhs.uk/STU3/StructureDefinition/Extension-CareSettingType-1/_history/1.0?_format=xml">https://fhir.nhs.uk/STU3/StructureDefinition/Extension-CareSettingType-1/_history/1.0?_format=xml</a></p>
<p>The full details of the errors are:-</p>
<p>ITK-OPL-TEST-019-1.xml  FAIL    ERROR -- DOCUMENT BUNDLE: Entry isn't reachable by traversing from first Bundle entry * Location: Bundle.entry[12] column: 0<br>
ITK-OPL-TEST-019-1.xml  FAIL    ERROR -- DOCUMENT BUNDLE: Entry isn't reachable by traversing from first Bundle entry * Location: Bundle.entry[13] column: 0<br>
ITK-OPL-TEST-019-1.xml  FAIL    ERROR -- DOCUMENT BUNDLE: Entry isn't reachable by traversing from first Bundle entry * Location: Bundle.entry[15] column: 0<br>
ITK-OPL-TEST-019-1.xml  FAIL    ERROR -- DOCUMENT BUNDLE: Entry isn't reachable by traversing from first Bundle entry * Location: Bundle.entry[18] column: 0<br>
ITK-OPL-TEST-019-1.xml  FAIL    ERROR -- DOCUMENT BUNDLE: Entry isn't reachable by traversing from first Bundle entry * Location: Bundle.entry[19] column: 0<br>
ITK-OPL-TEST-019-1.xml  FAIL    ERROR -- DOCUMENT BUNDLE: Entry isn't reachable by traversing from first Bundle entry * Location: Bundle.entry[20] column: 0<br>
Attachments (1) <a href="/user_uploads/10155/_DI5NWPlWi5R5x4bDprTFgkC/ITK-OPL-TEST-019-1.xml" target="_blank" title="ITK-OPL-TEST-019-1.xml">ITK-OPL-TEST-019-1.xml</a> <br>
<span class="user-mention" data-user-id="191319">@James Agnew</span> I wondered if you could help with this issue?</p>



<a name="153991298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/153991298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#153991298">(Aug 28 2018 at 15:17)</a>:</h4>
<p>Within the document Bundle, all entries in the Bundle need to be reachable by traversing from the Composition.  For example, your PractitionerRole cd734ce9-468d-4a36-8dac-e453aa4747e0 isn't pointed to by anything.  And Practitioner 88f1ca61-0200-4943-a066-baf9a1570029 is only pointed to by that PractitionerRole, so it's not connected either.</p>



<a name="153991299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/153991299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#153991299">(Aug 28 2018 at 15:18)</a>:</h4>
<p>That's a base rule in the FHIR specification, so it's not an issue with HAPI</p>



<a name="153991304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/153991304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Katie Wheatley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#153991304">(Aug 28 2018 at 16:02)</a>:</h4>
<blockquote>
<p>That's a base rule in the FHIR specification, so it's not an issue with HAPI</p>
</blockquote>
<p>Thanks very much for your response, Lloyd. Practitioner 88f1ca61-0200-4943-a066-baf9a1570029 is traversable from the Composition entry, but the PractitionerRole entries are not and I believe that is the problem which is generating the error. All the errors I believe relate to Practitioners and Organisations which are referenced in PractitionerRole entries.</p>



<a name="153994235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/153994235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Katie Wheatley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#153994235">(Sep 07 2018 at 06:10)</a>:</h4>
<blockquote>
<p>Within the document Bundle, all entries in the Bundle need to be reachable by traversing from the Composition.  For example, your PractitionerRole cd734ce9-468d-4a36-8dac-e453aa4747e0 isn't pointed to by anything.  And Practitioner 88f1ca61-0200-4943-a066-baf9a1570029 is only pointed to by that PractitionerRole, so it's not connected either.</p>
</blockquote>
<p>I have looked into this issue in a little more detail. Within the xml example attached, I don't have any orphaned resources and they are all reachable from Composition either directly or indirectly. This does seem to me to conform to the FHIR documents guidance at <a href="https://www.hl7.org/fhir/documents.html" target="_blank" title="https://www.hl7.org/fhir/documents.html">https://www.hl7.org/fhir/documents.html</a> where it states that </p>
<p>*The document bundle SHALL include only:<br>
The Composition resource, and any resources directly or indirectly (e.g. recursively) referenced from it*</p>
<p>The HAPI validator error I received above is thrown against the Practitioner and Organization entries where they are referenced within the PractitionerRole entries. Both the Practitioner and Organization entries are referenced directly from Composition within the document bundle. PractitionerRole links to them as it contains references to them - that is how PractitionerRole works in FHIR as neither Practitioner nor Organization hold references to it - the referencing works the other way around. <br>
That is why I believe that the error thrown by the HAPI validator may be because HAPI is not interpreting the FHIR guidance correctly.  I would welcome more discussion on this.</p>



<a name="153994242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/153994242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#153994242">(Sep 07 2018 at 06:42)</a>:</h4>
<p>In STU3, there was no allowance for reverse-direction relationships.  That's fixed in R4.  However, you'd still want the Composition to point to PractitionerRole, not Practitioner.  If Composition points to Practitioner, you're saying "this was created by Dr. Smith, but I don't know/care what role she did it in or on behalf of what organization she did it; oh and by the way, here's one of the roles that Dr. Smith works".  Presumably that's not what you're wanting to say.</p>



<a name="160482897"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/160482897" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#160482897">(Mar 11 2019 at 14:27)</a>:</h4>
<p>This is an issue on 3.7 HAPI, we have a message Bundle which has focus of Encounter. </p>
<p>Other entries have context of Encounter, they all come up as 'Entry isn't reachable by traversing from first Bundle entry'</p>



<a name="160488635"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/160488635" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#160488635">(Mar 11 2019 at 15:30)</a>:</h4>
<p>Believe this needs to be added to HAPI Validator </p>
<p>Comment in InstanceValidator class</p>
<p>// Todo - check if the remaining resources point <em>to</em> the elements in the referenced set.  Any that are still left over are errors</p>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> can you confirm implementing this TODO is still within FHIR rules?</p>



<a name="160489822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/160489822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#160489822">(Mar 11 2019 at 15:44)</a>:</h4>
<p>That comment is no longer in the shared HL7/HAPI code and I seem to recall refactoring it to address the issue, so that problem <em>shouldn't</em> exist in the most recent version of HAPI.</p>



<a name="160490413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/160490413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#160490413">(Mar 11 2019 at 15:50)</a>:</h4>
<p>excellent (I should have checked r4). So the solution should be to move the fix from r4 to stu3</p>



<a name="160490450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/160490450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#160490450">(Mar 11 2019 at 15:50)</a>:</h4>
<p>Will look at making the change</p>



<a name="160492086"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/160492086" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#160492086">(Mar 11 2019 at 16:09)</a>:</h4>
<p>In principle, the current validator code should always be used regardless of version</p>



<a name="160749099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20validator%20error%20-%20traversing%20bundles/near/160749099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20validator.20error.20-.20traversing.20bundles.html#160749099">(Mar 14 2019 at 03:50)</a>:</h4>
<p>r5 now... :-(</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
