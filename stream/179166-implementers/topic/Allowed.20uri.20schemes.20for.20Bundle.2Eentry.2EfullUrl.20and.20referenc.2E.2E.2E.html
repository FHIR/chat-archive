---
layout: page
title: "FHIR Chat  · Allowed uri schemes for Bundle.entry.fullUrl and referenc... · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html">Allowed uri schemes for Bundle.entry.fullUrl and referenc...</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="271621146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271621146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271621146">(Feb 11 2022 at 18:54)</a>:</h4>
<p>I've read the proposed wording update for Bundle reference resolution at <a href="https://jira.hl7.org/browse/FHIR-29271?focusedCommentId=183020&amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-183020">https://jira.hl7.org/browse/FHIR-29271?focusedCommentId=183020&amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-183020</a><br>
but I'm still not sure about something:  are there any other supported uri schemes (besides <code>http/s:</code> and <code>urn:</code>) for fullUrl which should be supported by the server for reference replacement?</p>



<a name="271623321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271623321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271623321">(Feb 11 2022 at 19:11)</a>:</h4>
<p>I think I've seen Bundles that have other fullUrl structures before (though maybe invalid ones!).  Right now, the only one I can recall is the Bundle that goes into smart health cards which uses a <code>resource:</code> scheme.  Would anyone expect to be able to post entries with that scheme to a server and have it do reference replacement?</p>



<a name="271623756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271623756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271623756">(Feb 11 2022 at 19:14)</a>:</h4>
<p>I guess there is <a href="http://jira.hl7.org/browse/FHIR-31422">FHIR#31422</a> which relates to that (persuasive with modification) and what I'm trying to understand is whether / how that affects the resolution on <a href="http://jira.hl7.org/browse/FHIR-29271">FHIR#29271</a></p>



<a name="271627118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271627118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271627118">(Feb 11 2022 at 19:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="271636029"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271636029" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271636029">(Feb 11 2022 at 20:59)</a>:</h4>
<p><a href="http://jira.hl7.org/browse/FHIR-31422">FHIR-31422</a> is the relevant decision here from my perspective; servers ought to be able to do "full URL matching" based on any scheme, and that's consistent with the "If the reference.value is a versionless..." logic from <a href="http://jira.hl7.org/browse/FHIR-29271">FHIR-29271</a>, which you cite.</p>
<p>If you need "fhir base semantics" (like, to turn a relative reference into an absolute reference by appending to an inferred base) then you're limited (today) to the http/https schemes. (Even that's an unnecessary limitation; I think base semantics should work for ipfs and its brethren).</p>



<a name="271648051"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271648051" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271648051">(Feb 11 2022 at 22:39)</a>:</h4>
<p>I think I could get behind that.  But then, in my opinion, listing only http/https examples under "Resolving absolute references" is a bit misleading...it would be nice to have at least one non-http example listed there to make it clear that "any" scheme could be considered an "absolute reference".<br>
But that makes me wonder what would fall to the "Resolving other references." section...</p>



<a name="271648209"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271648209" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271648209">(Feb 11 2022 at 22:41)</a>:</h4>
<blockquote>
<p>servers ought to be able to do "full URL matching" based on any scheme</p>
</blockquote>
<p>would that include fullUrl with no scheme (i.e. no <code>:</code> delimiter), or is this what would full under the "Resolving other references" section?</p>



<a name="271648858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271648858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271648858">(Feb 11 2022 at 22:48)</a>:</h4>
<p>the one thing that gives me pause is the spec wants servers to replace references all over (even in the narrative text) and I'm wondering if its safe to do that for "any scheme".  the risk of an unrelated href or img <code>src</code> attribute containing a long <code>urn:</code> value seems a lot lower than a string like "resource:0"</p>



<a name="271650231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271650231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271650231">(Feb 11 2022 at 23:02)</a>:</h4>
<p>Sure, but the resolution rules are useful in places outside of "batch create" -- like, being able to publish a Bundle with one Organization's full hierarchy of clinics and practitioners with fullUrls  like <code>ipfs://{hash}/resources/Organization/123</code>, and working references across the entries like <code>Organization/123</code>) (using absolute URIs for the references here is workable though).</p>
<p>[<del>Or being able or resolve short urls like <code>resource:0</code> across references in space constrained QR.</del> Edit: we don't need relative URIs in this references for this one; absolute are shorter].</p>
<p>If you're preparing a Bundle specifically to call batch create and you want to avoid ambiguities, you could always use URNs.</p>



<a name="271664835"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271664835" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271664835">(Feb 12 2022 at 02:56)</a>:</h4>
<p>(btw will you share a pointer to the language about replacing narrative? It sounds familiar but I'm having trouble finding it.)</p>



<a name="271667102"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271667102" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271667102">(Feb 12 2022 at 03:47)</a>:</h4>
<p>sure, thats from <a href="https://build.fhir.org/http.html#trules">https://build.fhir.org/http.html#trules</a><br>
specifically this bit:</p>
<blockquote>
<p>Servers SHALL replace all matching links in the bundle, whether they are found in the resource ids, resource references, elements of type uri, url, oid, uuid, and &lt;a href="" &amp; &lt;img src="" in the narrative. Elements of type canonical are not replaced.</p>
</blockquote>



<a name="271667166"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Allowed%20uri%20schemes%20for%20Bundle.entry.fullUrl%20and%20referenc.../near/271667166" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Allowed.20uri.20schemes.20for.20Bundle.2Eentry.2EfullUrl.20and.20referenc.2E.2E.2E.html#271667166">(Feb 12 2022 at 03:49)</a>:</h4>
<p>I'm not sure if servers actually implement that bit or not though.  I "kind of" get replacing href values but really not sure what the use case is for an img src attribute that points at a resource url.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
