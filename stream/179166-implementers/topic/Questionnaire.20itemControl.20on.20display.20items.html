---
layout: page
title: "FHIR Chat  · Questionnaire itemControl on display items · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html">Questionnaire itemControl on display items</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="265224035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265224035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265224035">(Dec 16 2021 at 21:46)</a>:</h4>
<p>We have markup in our display items. R4 cannot handle any markup in item.text. For that we use the <a href="http://hl7.org/fhir/extension-questionnaire-itemcontrol.html">itemControl</a> extension. The itemControl extension goes onto a child item of the item it should <em>control</em>. When the item is a display item however, invariant que-1 kicks in:</p>
<blockquote>
<p>que-1 Rule    Questionnaire.item  Group items must have nested items, display items cannot have nested items</p>
</blockquote>
<p>Are we using the extension in the wrong way or did que-1 just never anticipate itemControl?</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"linkId"</span><span class="p">:</span> <span class="s2">"2.16.840.1.113883.2.4.3.11.60.114.2.1.2--20210603151524"</span><span class="p">,</span>
  <span class="nt">"definition"</span><span class="p">:</span> <span class="s2">"http://decor.nictiz.nl/fhir/StructureDefinition/2.16.840.1.113883.2.4.3.11.60.114.4.2--20210603160554#2.16.840.1.113883.2.4.3.11.60.114.2.1.2--20210603151524"</span><span class="p">,</span>
  <span class="nt">"text"</span><span class="p">:</span> <span class="s2">"instructies"</span><span class="p">,</span>
  <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"display"</span><span class="p">,</span>
  <span class="nt">"item"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"extension"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl"</span><span class="p">,</span>
          <span class="nt">"valueCodeableConcept"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="nt">"coding"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://hl7.org/fhir/questionnaire-item-control"</span><span class="p">,</span>
                  <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"help"</span><span class="p">,</span>
                  <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Help-Button"</span>
                <span class="p">}</span>
              <span class="p">],</span>
              <span class="nt">"text"</span><span class="p">:</span> <span class="s2">"Help-Button"</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">"linkId"</span><span class="p">:</span> <span class="s2">"2.16.840.1.113883.2.4.3.11.60.114.2.1.2--20210603151524-help"</span><span class="p">,</span>
      <span class="nt">"text"</span><span class="p">:</span> <span class="s2">"Selecteer het antwoord dat het beste beschrijft hoe u zich de afgelopen week heeft gevoeld.(Slechts één antwoord per vraag)"</span><span class="p">,</span>
      <span class="nt">"_text"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"extension"</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"http://hl7.org/fhir/StructureDefinition/rendering-xhtml"</span><span class="p">,</span>
            <span class="nt">"valueString"</span><span class="p">:</span> <span class="s2">"&lt;div&gt;Selecteer het antwoord dat het beste beschrijft hoe u zich de &lt;strong&gt;afgelopen week&lt;/strong&gt; heeft gevoeld.&lt;br/&gt;(Slechts één antwoord per vraag)&lt;/div&gt;"</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"display"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">},</span>
</code></pre></div>



<a name="265233603"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265233603" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265233603">(Dec 16 2021 at 23:14)</a>:</h4>
<p>You're using it wrong :)   The itemControl extension needs to appear on the 'display' item itself, not a nested item.  You can't nest one display inside another.  If you have multiple displays, they have to be sequential.</p>



<a name="265264495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265264495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265264495">(Dec 17 2021 at 08:08)</a>:</h4>
<p>I'm trying to wrap around how to apply what you are saying. The way I understand the itemControl is that if you want a help button/text on something, you need to create child item that you mark with that extension. That is what I did above. If I make the item marked with itemControl a sibling of the thing it needs to be a Help text on, then how does one know what it belongs with?</p>
<p>LHC Forms renders the item[type = display] + child help text exactly as I expect. LHC Forms does not render the Help text at all when I make them siblings. I think I would agree with LHC here. What do I miss?</p>



<a name="265314110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265314110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265314110">(Dec 17 2021 at 15:50)</a>:</h4>
<p>There's no mechanism to have help text 'on' a display item.  It can be before or after, but not 'inside'.</p>



<a name="265367474"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265367474" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265367474">(Dec 17 2021 at 22:10)</a>:</h4>
<p>So this LHC feature is wrong then? The presumed way to display it, is attached to the question mark icon also visible in the screenshot<br>
<a href="/user_uploads/10155/tbbb3HrdPiZNunvgMqVaSA0j/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/tbbb3HrdPiZNunvgMqVaSA0j/image.png" title="image.png"><img src="/user_uploads/10155/tbbb3HrdPiZNunvgMqVaSA0j/image.png"></a></div>



<a name="265374103"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265374103" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265374103">(Dec 17 2021 at 23:06)</a>:</h4>
<p>For using markdown on the text use the markdown extension on the text rather than item control.</p>



<a name="265374156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265374156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265374156">(Dec 17 2021 at 23:07)</a>:</h4>
<p>Alex, that help control thing is correct in lhcforms .</p>



<a name="265387966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265387966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265387966">(Dec 18 2021 at 03:08)</a>:</h4>
<p>LHC forms is <em>incorrect</em>.  The rule is clearly that display items cannot contain nested items.  (At least for R4 - we could theoretically relax and allow nested display items in R5+ if someone were to submit a change request.)  <span class="user-mention" data-user-id="195344">@Paul Lynch</span></p>



<a name="265482873"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265482873" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265482873">(Dec 19 2021 at 14:33)</a>:</h4>
<p>The usual case is a question and an explanation thereof. The question normally is plain text, but could have markup in which case item.text + markdown extension could suffice. The additional explanation though, cannot really go anywhere else than under itemControl. All works fine for items other than display. For display items, LHC Forms still works fine, but the core invariant says it is wrong.</p>
<p>LHC Forms does not support the item.text.extension for markdown unfortunately (I put in html there as LHC Forms does not do markdown at all). Since LHC Forms is the only viable open source implementation of Questionnaire out there, that makes being LHC Forms compatible more important than being FHIR compatible. I do we get those two goals to align?</p>



<a name="265486794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265486794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265486794">(Dec 19 2021 at 16:04)</a>:</h4>
<p>If you have a question, then it's not a display item, it's a question.  The only thing we prohibit is display under display.</p>



<a name="265486804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265486804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265486804">(Dec 19 2021 at 16:05)</a>:</h4>
<p>You're free to have markdown on the text of a question or a display item.</p>



<a name="265498508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265498508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265498508">(Dec 19 2021 at 20:29)</a>:</h4>
<p>This isn't helped by the tooltip text moving from the extension as it was back in DSTU2 (don't recall stu3) and to a child item. Means you lost the ability to have tooltip text on display items.</p>



<a name="265498514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265498514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265498514">(Dec 19 2021 at 20:29)</a>:</h4>
<p>(and I guess help text too?)</p>



<a name="265502435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265502435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265502435">(Dec 19 2021 at 22:01)</a>:</h4>
<p>Correct.  We could relax the rule in R5 to allow displays to have child displays (do we limit how deep?), but it's definitely prohibited in R4.  Feel free to submit a change request.</p>



<a name="265576213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265576213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265576213">(Dec 20 2021 at 15:18)</a>:</h4>
<p>I would like to see an example of a questionnaire where it makes sense to have help text on a display item (as opposed to a question or group).</p>



<a name="265576745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265576745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265576745">(Dec 20 2021 at 15:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191375">Alexander Henket</span> <a href="#narrow/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items/near/265482873">said</a>:</p>
<blockquote>
<p>LHC Forms does not support the item.text.extension for markdown unfortunately (I put in html there as LHC Forms does not do markdown at all). Since LHC Forms is the only viable open source implementation of Questionnaire out there, that makes being LHC Forms compatible more important than being FHIR compatible. I do we get those two goals to align?</p>
</blockquote>
<p>You can submit a request for markdown support here:  <a href="https://github.com/lhncbc/lforms/issues">https://github.com/lhncbc/lforms/issues</a>.  Or, you can submit a pull request for markdown support (though I suggest waiting until version 30 is out of beta, as we are reorganizing the code).</p>



<a name="265985976"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265985976" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265985976">(Dec 24 2021 at 08:14)</a>:</h4>
<p>I just might do that PR...</p>



<a name="265986282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Questionnaire%20itemControl%20on%20display%20items/near/265986282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Questionnaire.20itemControl.20on.20display.20items.html#265986282">(Dec 24 2021 at 08:20)</a>:</h4>
<p>With the right lib, that's no harder than the HTML extension. (which is how I've done it)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
