---
layout: page
title: "FHIR Chat  · Java cast error in JAR validator · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html">Java cast error in JAR validator</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154009077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009077">(Oct 15 2018 at 12:41)</a>:</h4>
<p>End of last week, I started seeing the following Java error being thrown by the latest version of the standard JAR validator (<a href="https://build.fhir.org/validator.zip" target="_blank" title="https://build.fhir.org/validator.zip">https://build.fhir.org/validator.zip</a>) when validating STU3 resources:</p>
<div class="codehilite"><pre><span></span>Error java.lang.ClassCastException: org.hl7.fhir.r4.model.Parameters cannot be cast to org.hl7.fhir.r4.model.TerminologyCapabilities validating Coding`
</pre></div>


<p>For instance, here is the output when running against one of the standard STU3 examples (<a href="https://www.hl7.org/fhir/observation-example.xml" target="_blank" title="https://www.hl7.org/fhir/observation-example.xml">https://www.hl7.org/fhir/observation-example.xml</a>):</p>
<div class="codehilite"><pre><span></span>java -jar org.hl7.fhir.validator.jar -version 3.0.1 observation-example.xml
FHIR Validator Build ??
Arguments: -version 3.0.1 observation-example.xml
  .. connect to tx server @ http://tx.fhir.org
  .. definitions from hl7.fhir.core#3.0.1
    (v3.0.1-null)
  .. validate [observation-example.xml]
Terminology server: Check for supported code systems for http://loinc.org
Terminology server: Check for supported code systems for http://loinc.org
Terminology server: Check for supported code systems for http://acme.org/devices/clinical-codes
*FAILURE* validating observation-example.xml:  error:4 warn:0 info:0
  Error @ Observation.code.coding[1] (line 21, col11) : Error java.lang.ClassCastException: org.hl7.fhir.r4.model.Parameters cannot be cast to org.hl7.fhir.r4.model.TerminologyCapabilities validating Coding
  Error @ Observation.code.coding[2] (line 26, col11) : Error java.lang.ClassCastException: org.hl7.fhir.r4.model.Parameters cannot be cast to org.hl7.fhir.r4.model.TerminologyCapabilities validating Coding
  Error @ Observation.code.coding[3] (line 32, col11) : Code system validation not supported in R2
  Error @ Observation.code.coding[4] (line 38, col11) : Error java.lang.ClassCastException: org.hl7.fhir.r4.model.Parameters cannot be cast to org.hl7.fhir.r4.model.TerminologyCapabilities validating Coding
</pre></div>


<p>Has anyone seen this or, even better, know a way around it?</p>
<p>Running without a terminology server (<code>-tx n/a</code>) does not lead to the above error. However, I see that using this option now itself causes the validation to fail (<code>Error validating code: running without terminology services</code>), which I do not quite understand. After all, I explicitly switched it off and the validator outputs a large warning about this at the top, so why is this also a <em>validation</em> error for the resource? Is there now some other way to switch of terminology checks without causing an error (e.g. to avoid a CI pipeline with automatic validation breaking if no terminology server is available)?</p>



<a name="154009083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009083">(Oct 15 2018 at 13:01)</a>:</h4>
<p>do you get a stack dump?</p>



<a name="154009093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009093">(Oct 15 2018 at 14:04)</a>:</h4>
<p>I only get the output I pasted in above (not sure how I can convince the JVM to say more...)</p>



<a name="154009104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Riley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009104">(Oct 15 2018 at 14:52)</a>:</h4>
<p>Without knowing how you ran the validator, this looks like a FHIR version issue. That's an R4 (release candidate 4/STU4) class, so it shouldn't be used to validate STU3 resources. The right class would be org.hl7.fhir.dstu3.model.Parameters.</p>
<p>Unless I'm misunderstanding and you intended to validate R4 resources?</p>



<a name="154009184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009184">(Oct 15 2018 at 17:54)</a>:</h4>
<p>this is a bug in the validator. I'm mystified how this passes the JUnit tests that are part of the build that run exactly this test. because due to a bug in my code this will fail.</p>



<a name="154009190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009190">(Oct 15 2018 at 18:42)</a>:</h4>
<p>found and fixed the problems, and added a few more tests. Will let you know when it is released</p>



<a name="154009224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009224">(Oct 15 2018 at 20:15)</a>:</h4>
<p>released</p>



<a name="154009374"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Java%20cast%20error%20in%20JAR%20validator/near/154009374" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Java.20cast.20error.20in.20JAR.20validator.html#154009374">(Oct 16 2018 at 06:53)</a>:</h4>
<p>Awesome, thank you <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
