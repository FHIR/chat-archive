---
layout: page
title: "FHIR Chat  · Security tags in a transaction · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html">Security tags in a transaction</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="162083340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162083340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162083340">(Mar 29 2019 at 20:58)</a>:</h4>
<p>Let's say my system uses security tags to limit what the user can do with specific resources...<br>
Now, I have a transaction bundle that has a bunch of resources in it, some are creates, some are updates. Is there a way to indicate that the updates should only occur if certain security tags are already on the resource?</p>



<a name="162083395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162083395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162083395">(Mar 29 2019 at 20:59)</a>:</h4>
<p>no. there's no way to make transactions dependent on anything but existence of a resource</p>



<a name="162083400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162083400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162083400">(Mar 29 2019 at 20:59)</a>:</h4>
<p>damn</p>



<a name="162084677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162084677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162084677">(Mar 29 2019 at 21:20)</a>:</h4>
<p>it doesn't sound like a crazy idea but it would be a change proposal...</p>



<a name="162084696"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162084696" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162084696">(Mar 29 2019 at 21:20)</a>:</h4>
<p>or you could use patch</p>



<a name="162212198"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162212198" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162212198">(Apr 01 2019 at 06:12)</a>:</h4>
<p>how would PATCH make a difference <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="162212200"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162212200" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162212200">(Apr 01 2019 at 06:13)</a>:</h4>
<p>?</p>



<a name="162213124"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162213124" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162213124">(Apr 01 2019 at 06:35)</a>:</h4>
<p>ah no. I thought I added a conditional thing to the patch but I see that I didn't</p>



<a name="162744109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162744109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162744109">(Apr 07 2019 at 08:07)</a>:</h4>
<p>I would have thought that if the user didn't have access to the version of the resource being updated, you'd get errors.</p>



<a name="162825960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/162825960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#162825960">(Apr 08 2019 at 15:16)</a>:</h4>
<p>That is likely true of the current security models, as they are most fine grain at the Resource level (Permit vs Deny). However there will be needs for more fine grain security/privacy models that might have ability to have rules at a much more fine grain than Resource. Patch offers a pathway for updating portions that one would not have full access too.<br>
This said, there is nothing preventing a full POST to be used, where the server notices that only an allowed element is actually changing, thus the resulting allowed change very similar to Patch on that element alone.</p>



<a name="163333582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163333582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163333582">(Apr 14 2019 at 20:38)</a>:</h4>
<p>Yes John, we're currently mid way through that implementation at the moment.</p>



<a name="163333591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163333591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163333591">(Apr 14 2019 at 20:38)</a>:</h4>
<p>(I.e. Non patch patching)</p>



<a name="163336540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163336540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163336540">(Apr 14 2019 at 21:46)</a>:</h4>
<p>I've done something similar. The problem is deletion - is something missing because it's not being changed, or because it's being deleted?</p>



<a name="163337195"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163337195" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163337195">(Apr 14 2019 at 22:03)</a>:</h4>
<p>also, matching changes in a list - change or deletion + insertion. There's no general purpose solution to these problems</p>



<a name="163339806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163339806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163339806">(Apr 14 2019 at 23:13)</a>:</h4>
<p>Our implementation knows what the previous version from that system provided, so can detect the deletion.</p>



<a name="163369577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163369577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163369577">(Apr 15 2019 at 10:50)</a>:</h4>
<p>but what makes it a deletion? that it was omitted? isn't that the point: don't delete what is omitted...</p>



<a name="163488481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163488481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163488481">(Apr 16 2019 at 17:21)</a>:</h4>
<p>Maybe I'm missing something.  Is there a case in which a client-orchestrated full-resource update wouldn't completely overwrite what was there before?  (e.g. server-side house rules?)</p>



<a name="163491450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163491450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163491450">(Apr 16 2019 at 17:57)</a>:</h4>
<p>Servers are allowed to ignore some bits of what comes in.  Most common would be to throw away extensions or core elements they don't support.  However, in principle, a server could accept an update but not allow changing of a particular element  based on its own business rules (e.g. some other system is the authoritative source for names or addresses).  If this happens, the server SHOULD produce a warning indicating what it's done.  If the resource gets echoed back instead, the client can see exactly which parts of the update "stuck".</p>



<a name="163495466"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163495466" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163495466">(Apr 16 2019 at 18:42)</a>:</h4>
<p>Thanks Lloyd.  Digging further, I see the FHIR spec discusses variations between submitted and retrieved data here:</p>
<p><a href="http://www.hl7.org/fhir/updates.html" target="_blank" title="http://www.hl7.org/fhir/updates.html">http://www.hl7.org/fhir/updates.html</a></p>
<p>However, I didn't find text there saying the server SHOULD produce a warning indicating what it's done.</p>



<a name="163495850"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163495850" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163495850">(Apr 16 2019 at 18:46)</a>:</h4>
<p>Would probably be a good thing to add to the spec.  Do you want to submit a change request?</p>



<a name="163495941"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163495941" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163495941">(Apr 16 2019 at 18:47)</a>:</h4>
<p>Will do.</p>



<a name="163500552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163500552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163500552">(Apr 16 2019 at 19:45)</a>:</h4>
<p><a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20874" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20874">GF#20874</a></p>



<a name="163512511"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163512511" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163512511">(Apr 16 2019 at 22:23)</a>:</h4>
<p>I don't know how it would provide such a warning. OperationOutcome. presumbly, if it is returned, but there's no obvious way to say anything more than human readable</p>



<a name="163536604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163536604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Schneider <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163536604">(Apr 17 2019 at 07:01)</a>:</h4>
<p>I don't have an immediate use case for a more formal warning mechanism.  Would defer to others regarding whether adding something like that would make sense.</p>



<a name="163566049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163566049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163566049">(Apr 17 2019 at 14:33)</a>:</h4>
<p>RE: operationOutcome - the client also has to request the operationOutcome in the response, a server can't send one unless it's requested with the prefer header: <a href="http://hl7.org/fhir/r4/http.html#ops" target="_blank" title="http://hl7.org/fhir/r4/http.html#ops">http://hl7.org/fhir/r4/http.html#ops</a></p>



<a name="163566231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163566231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163566231">(Apr 17 2019 at 14:35)</a>:</h4>
<p>so the warning would be hidden unless the app specifically requested it</p>



<a name="163571461"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163571461" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163571461">(Apr 17 2019 at 15:29)</a>:</h4>
<p>Right.  If you're in an environment where it's possible the update might not be applied exactly as you requested, you should either ask for a copy of the stored record back or for OperationOutcome.</p>



<a name="163620514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20tags%20in%20a%20transaction/near/163620514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20tags.20in.20a.20transaction.html#163620514">(Apr 18 2019 at 03:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191505">@Sean McIlvenna</span> in Aidbox  transaction internally calls same endpoints as if you send entry requests one by one, i.e. we interpret transaction at a server routing level as multi operation request. With this interpretation we run all security checks on updates/deletes and fail transaction is access denied for some of them.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
