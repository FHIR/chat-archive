---
layout: page
title: "FHIR Chat  · Searching by a collection of references · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html">Searching by a collection of references</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="269521366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269521366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269521366">(Jan 27 2022 at 03:29)</a>:</h4>
<p>I've got a collection of local references (e.g. Practitioner/1, Practitioner/2, Organization/3, PractitionerRole/4)<br>
I want to define a single search that will retrieve all four resources<br>
Is it possible?  If so, how?</p>



<a name="269526219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269526219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269526219">(Jan 27 2022 at 05:01)</a>:</h4>
<p>write a batch bundle with 4 read operations in it?</p>



<a name="269534608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269534608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269534608">(Jan 27 2022 at 07:31)</a>:</h4>
<p>A bit whacky perhaps, but on the quick I don't see why theoretically it shouldn't work: GET Resource?_id=Practitioner/1, Practitioner/2, Organization/3, PractitionerRole/4</p>



<a name="269597618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269597618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269597618">(Jan 27 2022 at 16:25)</a>:</h4>
<p>The batch bundle is the only approach I've come up with, but it seems rather inefficient.  I don't think searching by _id allows preceding resource names.  Though if we could have a search at the 'root' level that could work that way, that'd be ideal...</p>



<a name="269598979"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269598979" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269598979">(Jan 27 2022 at 16:35)</a>:</h4>
<p>GET [base]?_type=Practitioner,Organization&amp;_id=1,2,3 or even GET [base]?_id=1,2,3 certainly works, but one would have to assume that all of the logical ids are unique on a server for that to do exactly what it is you'd like to do.</p>



<a name="269599965"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269599965" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269599965">(Jan 27 2022 at 16:41)</a>:</h4>
<p>bulk data pull everything, filter out locally.... You never said you wanted to have a single search return ONLY these.   :-)</p>



<a name="269641500"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269641500" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269641500">(Jan 27 2022 at 21:34)</a>:</h4>
<p>@Rene, ids aren't unique across resource types, so in theory you might get Organization/1 and Practitioner/1 and PractitionerRole/1</p>



<a name="269641583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269641583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269641583">(Jan 27 2022 at 21:34)</a>:</h4>
<p>I definitely want the search to return <em>only</em> those.  The use-case is a CDS Hooks pre-fetch.</p>



<a name="269934823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269934823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jabeen Mohammed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269934823">(Jan 30 2022 at 14:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references/near/269641583">said</a>:</p>
<blockquote>
<p>I definitely want the search to return <em>only</em> those.  The use-case is a CDS Hooks pre-fetch.</p>
</blockquote>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  one can create $youroperation with input resource parameters</p>



<a name="269937965"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269937965" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269937965">(Jan 30 2022 at 15:13)</a>:</h4>
<p>Sure, but that then requires custom support across all servers.  It seems to me that there <em>should</em> be a simple search mechanism to retrieve a list of local references without needing a Batch of reads.</p>



<a name="269945145"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269945145" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269945145">(Jan 30 2022 at 17:33)</a>:</h4>
<blockquote>
<p>The batch bundle is the only approach I've come up with, but it seems rather inefficient.</p>
</blockquote>
<p>What kind of "efficiency" are you thinking about here? Batch seems to meet your stated requirements neatly.</p>



<a name="269945295"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269945295" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269945295">(Jan 30 2022 at 17:36)</a>:</h4>
<blockquote>
<p>The use-case is a CDS Hooks pre-fetch.</p>
</blockquote>
<p>For CDS Hooks pre-fetch, you can have as many individual pre-fetch keys as you require. Why not define distinct pre-fetch keys for each, so you can name them with useful labels and so the EHR can easily return any subset of them?</p>



<a name="269945543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269945543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269945543">(Jan 30 2022 at 17:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references/near/269937965">said</a>:</p>
<blockquote>
<p>Sure, but that then requires custom support across all servers.  It seems to me that there <em>should</em> be a simple search mechanism to retrieve a list of local references without needing a Batch of reads.</p>
</blockquote>
<p>I'm pretty ignorant here 'cause i've not dived into the specs, but i'da thunk that the phrase "Batch of reads" nicely describes the desired behavior.</p>



<a name="269951111"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269951111" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269951111">(Jan 30 2022 at 19:28)</a>:</h4>
<p>What I want to do is, for all draft orders passed in, retrieve the performers (Practitioners, PractitionerRoles, whatever) for all of the orders.  I don't know in advance how many orders there will be, so I can't reasonably name a distinct key for each.</p>



<a name="269953112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269953112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jabeen Mohammed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269953112">(Jan 30 2022 at 20:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references/near/269951111">said</a>:</p>
<blockquote>
<p>What I want to do is, for all draft orders passed in, retrieve the performers (Practitioners, PractitionerRoles, whatever) for all of the orders.  I don't know in advance how many orders there will be, so I can't reasonably name a distinct key for each.</p>
</blockquote>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  use case basis store them as bundle resource of type collection.  This allow you to search and if you want to additional update that specific bundle. So the when client query they will get most current info. <br>
-- I am trying to learn your use case</p>



<a name="269954190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269954190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269954190">(Jan 30 2022 at 20:15)</a>:</h4>
<p>The use-case is that a set of draft orders are passed to a CDS Hook.  The draft orders are not persisted on a server anywhere, so there's no ability to query them using a RESTful server.  The draft orders reference who 'performs' each order.  I want to define a pre-fetch query that will retrieve the performers for all of the specified orders.  I can easily create a comma-delimited list of reference URLs (absolute or relative).  But I <em>don't</em> have a way to retrieve the set of resources so referenced in a single query.  It needs to be a single query because the prefetch has to drop into a single prefetch variable - I can't have a distinct variable per record because you have to know how many variables you'll have at the outset - and I have no idea how many orders there will be, or how many performers per order.</p>



<a name="269959600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269959600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269959600">(Jan 30 2022 at 21:46)</a>:</h4>
<p>I'm confused about how you are using the CDS hooks prefetch templating syntax. Can you share an example of the input variables that you are using to create a prefetch template? I'm having trouble understanding how the static prefetch template syntax would get access to an array of inputs...</p>



<a name="269961621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269961621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269961621">(Jan 30 2022 at 22:26)</a>:</h4>
<p>The CDS work group has talked about extending the syntax to allow navigating into the passed resource to allow retrieval.  (One of the most obvious needs is to be able to retrieve the Medication instances associated with MedicationRequests passed as draft or signed orders.)  The problem though is that even if we extend the syntax to allow navigating to the MedicationResource.medication element, there's no effective way to have a search that could use the results :(</p>



<a name="269969961"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269969961" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269969961">(Jan 31 2022 at 01:22)</a>:</h4>
<p>If we're creating new capabilities, we can think about several options... e.g., an <code>include</code> array in the prefetch template that can take a set of expressions based on the context -- but this is all quite complex. Better, I think, to just let the CDS Service make REST API calls as needed, without prefetch.</p>



<a name="269975052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/269975052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#269975052">(Jan 31 2022 at 03:10)</a>:</h4>
<p>REST calls by the service are a non-starter in some cases.  Plus, the whole point of pre-fetch is to grab the content you need all the time.  And needing the medication for a MedicationRequest is an obvious situation where this is going to be needed.</p>



<a name="270607761"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/270607761" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#270607761">(Feb 03 2022 at 19:53)</a>:</h4>
<p>I'm hearing this as a new feature request for the CDS Hooks prefetch language. It would be good to capture the use case and some proposed approach(es) to meet it (e.g., suggested semantics and syntax, evaluation of trade-offs).</p>



<a name="270616436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Searching%20by%20a%20collection%20of%20references/near/270616436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Searching.20by.20a.20collection.20of.20references.html#270616436">(Feb 03 2022 at 20:57)</a>:</h4>
<p>The new feature has been discussed on a couple of CDS calls already - but it was all based on the premise we could tie into the existing search syntax.  However, as best as I can determine, we can't.  So my first step was to make sure that I'm not missing something.  After that, then yes, we'll probably be looking at adding something completely net new in terms of prefetch for CDS Hooks.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
