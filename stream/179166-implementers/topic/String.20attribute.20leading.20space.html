---
layout: page
title: "FHIR Chat  · String attribute leading space · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html">String attribute leading space</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="212546922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212546922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorn Duwel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212546922">(Oct 07 2020 at 11:55)</a>:</h4>
<p>Hi!<br>
The datatype spec says the following:</p>
<blockquote>
<p>According to XML schema, leading and trailing whitespace in the value attribute is ignored for the types boolean, integer, decimal, base64Binary, instant, uri, date, dateTime, oid, and uri. Note that this means that the schema aware XML libraries give different attribute values to non-schema aware libraries when reading the XML instances. For this reason, the value attribute for these types SHOULD not have leading and trailing spaces. <strong>String values should only have leading and trailing spaces if they are part of the content of the value</strong>. In JSON and Turtle whitespace in string values is always significant. Primitive types other than string SHALL NOT have leading or trailing whitespace.</p>
</blockquote>
<p>(Emphasis added)</p>
<p>The XML representation spec says the following:</p>
<blockquote>
<p>Implementers SHOULD trim leading and trailing whitespace before writing and SHOULD trim leading and trailing whitespace when reading attribute values</p>
</blockquote>
<p>These two quotes seem to contradict one another. When adding a leading (or trailing) space to a string value, can one expect it to be present in an XML representation of that string value?</p>



<a name="212554615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212554615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212554615">(Oct 07 2020 at 13:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191328">@Ewout Kramer</span></p>



<a name="212607509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212607509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212607509">(Oct 07 2020 at 19:27)</a>:</h4>
<p>there's no way to say. you cannot have any expectations; the problem is in xml itself.</p>



<a name="212658425"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212658425" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorn Duwel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212658425">(Oct 08 2020 at 08:11)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, thank you  for your reply. I actually would have the expectation that if my string data is valid following the datatype specification, it would be parsed correctly. If there is no way to guarantee that because of the representation method, shouldn't this ambiguous situation be reflected in the specification somehow?</p>



<a name="212661718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212661718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212661718">(Oct 08 2020 at 08:46)</a>:</h4>
<p>Does it help that this only affects schema aware processing? If you don't need and don't use the PSVI, is this an issue?</p>



<a name="212665203"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212665203" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212665203">(Oct 08 2020 at 09:24)</a>:</h4>
<p>I thought that the comments were reflecting the problem into the specification</p>



<a name="212716275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212716275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorn Duwel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212716275">(Oct 08 2020 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191651">@Rik Smithies</span> I am not sure if this issue has to do with schema aware processing (I am aware of the difficulty with whitespace and schema). We are having an issue where a sending party sends a string " III" (with a relevant leading space). The receving party parses is as "III" via XML. Both are pointing to the quoted parts of the specification, both are right in their way, but nevertheless a difference between the sent and received data now exists. Based on the specification as it is I cannot tell who is right or wrong. </p>
<p>For our implementation a possible way of solving this would be a solution where we do not use any leading spaces as relevant information in strings, but perhaps it could be discussed if the specification could identify or prevent this issue in the future.</p>



<a name="212719532"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212719532" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212719532">(Oct 08 2020 at 16:57)</a>:</h4>
<p>hi Jorn - The issue is documented  in the FHIR spec though? Is that not identifying the issue? What would you like to see? (Other than a fix, which might not be possible). <br>
The warning talks about non-string types not preserving spaces. Why would that affect string handling? What data type is your " III"?</p>



<a name="212757503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212757503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212757503">(Oct 08 2020 at 22:34)</a>:</h4>
<p>the spec says "you can, but you might have problems'.</p>



<a name="212757517"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/212757517" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#212757517">(Oct 08 2020 at 22:34)</a>:</h4>
<p>and you are</p>



<a name="213007484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213007484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc de Graauw <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213007484">(Oct 12 2020 at 07:54)</a>:</h4>
<p>It's not PSVI, it's in the core XML spec which predates Schema by a lot. Since conformant XML processors should implement the XML spec, they will drop leading/trailing spaces in attribute content. (Not sure this is an XML problem, one might as well say it's FHIR's problem since they want to store strings with leading spaces in attribute content, not element content. I realize that this remark is utterly unhelpful, since no-one will want to change that now.). The dataype spec might add a warning: "Don't expect leading/trailing spaces to persist in XML serialization." I don't think a fix is possible indeed.</p>



<a name="213008585"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213008585" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213008585">(Oct 12 2020 at 08:06)</a>:</h4>
<p>hi Marc - that is interesting. The datatype spec does already warn about this though doesn't it? What more do we think should be added? It may want to not say "XML schema" but instead "the XML standard". <br>
I still don't understand why this affects what seems to be a string datatype attribute though for <span class="user-mention" data-user-id="280644">@Jorn Duwel</span>. Is this not limited to the datatypes mentioned?</p>



<a name="213009611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213009611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc de Graauw <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213009611">(Oct 12 2020 at 08:18)</a>:</h4>
<p>Hi Rik, the datatypes spec does not really warn against leading space in string datatypes, it allows those (and this is fine for JSON). The schema remark is a bit vague - does this refer to the FHIR XML Schema for datatypes? For XML itself, there is no "XML Schema" for XML itself, so if that's intended "the XML standard" or "specification" would be better indeed.</p>



<a name="213009796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213009796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213009796">(Oct 12 2020 at 08:20)</a>:</h4>
<p>~the  spec does not really warn against leading space in string datatypes<br>
and is that a problem? I take it this applies to all datatypes in all XML attributes?<br>
In fact if it's the base XML standard, that doesn't even have datatypes.</p>



<a name="213010875"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213010875" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc de Graauw <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213010875">(Oct 12 2020 at 08:33)</a>:</h4>
<p>FHIR datatypes says value attributes other than string SHALL NOT have leading/trailing spaces. For string, it says they can have leading/trailing spaces it that's part of the content. For XML, this wil break. We know this now, so we could warn. And it's not about XML datatypes, but core attribute processing: <a href="https://www.w3.org/TR/xml/#AVNormalize">https://www.w3.org/TR/xml/#AVNormalize</a> : "...the XML processor must ... discarding any leading and trailing space"</p>



<a name="213011158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213011158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc de Graauw <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213011158">(Oct 12 2020 at 08:36)</a>:</h4>
<p>I can make a Jira issue, unless people see reason not to.</p>



<a name="213047305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213047305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213047305">(Oct 12 2020 at 14:44)</a>:</h4>
<p>The link doesn't simply say "...the XML processor must ... discarding any leading and trailing space" - there is a discussion about attribute being a string (CDATA), or tokenized sequence (NMTOKEN) which would be DTD definitions (as opposed to XML schema), and there are examples of leading white space. It seems that leading white space can be preserved if explicitly represented as <code>&amp;#x20;</code></p>



<a name="213050092"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213050092" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213050092">(Oct 12 2020 at 15:05)</a>:</h4>
<p>XML schema adds more to the above, but essentially, if an XML attribute is declared to be of type <code>string</code>, then white space must be preserved. If it is not, then it is the lack of schema awareness that unnecessarily removes the leading white space, not because of XML schema.</p>
<p>See<br>
<a href="https://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#rf-whiteSpace">for string the value of <code>whiteSpace</code> is <code>preserve</code>;</a><br>
and<br>
<a href="https://www.w3.org/TR/2004/REC-xmlschema-1-20041028/structures.html#d0e1654">https://www.w3.org/TR/2004/REC-xmlschema-1-20041028/structures.html#d0e1654</a></p>



<a name="213054898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213054898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc de Graauw <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213054898">(Oct 12 2020 at 15:46)</a>:</h4>
<p>Yes, you're right, <span class="user-mention" data-user-id="192685">@Vassil Peytchev</span>  and XML + Schema does allow it. But FHIR datatypes (<a href="http://build.fhir.org/datatypes.html#string">http://build.fhir.org/datatypes.html#string</a>) says: "Leading and Trailing whitespace is allowed, but SHOULD be removed when using the XML format".</p>



<a name="213065625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213065625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213065625">(Oct 12 2020 at 17:27)</a>:</h4>
<p>And digging further, the fhir-base.xsd defines a derived type for the actual attribute, <code>string-primitive</code>. Then the following XML schema rule applies: </p>
<blockquote>
<p>For all ·atomic· datatypes other than string (and types ·derived· by ·restriction· from it) the value of <code>whiteSpace</code> is <code>collapse</code> and cannot be changed by a schema author.</p>
</blockquote>
<p><code>collapse</code> is what prohibits leading (or trailing) white space. The only purpose of string-primitive is to define the minLength to 1, and I am wondering if that is necessary (even though it is shown as an example in the XML schema spec). If we change the following</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code><span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"string"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xs:annotation&gt;</span>
      <span class="nt">&lt;xs:documentation</span> <span class="na">xml:lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>A sequence of Unicode characters<span class="nt">&lt;/xs:documentation&gt;</span>
      <span class="nt">&lt;xs:documentation</span> <span class="na">xml:lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>Note that FHIR strings SHALL NOT exceed 1MB in size<span class="nt">&lt;/xs:documentation&gt;</span>
      <span class="nt">&lt;xs:documentation</span> <span class="na">xml:lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>If the element is present, it must have either a @value, an @id, or extensions<span class="nt">&lt;/xs:documentation&gt;</span>
    <span class="nt">&lt;/xs:annotation&gt;</span>
    <span class="nt">&lt;xs:complexContent&gt;</span>
      <span class="nt">&lt;xs:extension</span> <span class="na">base=</span><span class="s">"Element"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"value"</span> <span class="na">type=</span><span class="s">"string-primitive"</span> <span class="na">use=</span><span class="s">"optional"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/xs:extension&gt;</span>
    <span class="nt">&lt;/xs:complexContent&gt;</span>
  <span class="nt">&lt;/xs:complexType&gt;</span>
</code></pre></div>

<p>to</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code><span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"string"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xs:annotation&gt;</span>
      <span class="nt">&lt;xs:documentation</span> <span class="na">xml:lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>A sequence of Unicode characters<span class="nt">&lt;/xs:documentation&gt;</span>
      <span class="nt">&lt;xs:documentation</span> <span class="na">xml:lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>Note that FHIR strings SHALL NOT exceed 1MB in size<span class="nt">&lt;/xs:documentation&gt;</span>
      <span class="nt">&lt;xs:documentation</span> <span class="na">xml:lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>If the element is present, it must have either a @value, an @id, or extensions<span class="nt">&lt;/xs:documentation&gt;</span>
    <span class="nt">&lt;/xs:annotation&gt;</span>
    <span class="nt">&lt;xs:complexContent&gt;</span>
      <span class="nt">&lt;xs:extension</span> <span class="na">base=</span><span class="s">"Element"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"value"</span> <span class="na">type=</span><span class="s">"xs:string"</span> <span class="na">use=</span><span class="s">"optional"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/xs:extension&gt;</span>
    <span class="nt">&lt;/xs:complexContent&gt;</span>
  <span class="nt">&lt;/xs:complexType&gt;</span>
</code></pre></div>

<p>the JSON and XML representations will not have this discrepancy.</p>



<a name="213115778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213115778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213115778">(Oct 13 2020 at 06:22)</a>:</h4>
<p>so you see why I said it's a schema related issue. And it will work for some conformant XML processors, and not for others. WHich is why we decided a long time ago to not prohibit it but just to warn about it.</p>



<a name="213121245"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213121245" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc de Graauw <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213121245">(Oct 13 2020 at 07:52)</a>:</h4>
<p><span class="user-mention" data-user-id="192685">@Vassil Peytchev</span>  "...(the) purpose of string-primitive is to define the minLength to 1, and I am wondering if that is necessary..." - string-primitive implements: (<a href="http://build.fhir.org/xml.html">http://build.fhir.org/xml.html</a>): "Attributes cannot be empty. Either they are absent, or they are present with at least one character of non-whitespace content."<br>
<span class="user-mention" data-user-id="191316">@Grahame Grieve</span> "...it will work for some conformant XML processors, and not for others" - Yes, I tested yesterday with Expat, and leading whitespace is preserved there.</p>



<a name="213164911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213164911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213164911">(Oct 13 2020 at 14:41)</a>:</h4>
<p>My question was whether it is necessary to use a schema construct to enforce the rule that attributes are either "absent or they are present with st least one character of non-whites pace content."</p>
<p>Can that rule be enforced via schematron or directly at the FHIR processing level?</p>



<a name="213215507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213215507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213215507">(Oct 13 2020 at 20:56)</a>:</h4>
<p>I don't know what's 'necessary' since schema doesn't enforce all validations. It does what it can. Why should it not do this one?</p>



<a name="213242065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213242065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213242065">(Oct 14 2020 at 03:09)</a>:</h4>
<p>Maybe I am missing the background of this point. From the FHIR specification perspective, without regards to the wire format, what is the <strong>desired</strong> property of the string data type:</p>
<ol>
<li>Strings shall not have leading or trailing whitespace</li>
<li>Strings can have leading but no trailing whitespace</li>
<li>Strings can have leading or trailing whitespace<br>
For each of 1, 2, or 3 I am assuming that there is the desired property of at least one non-whitespace character.</li>
</ol>



<a name="213242438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213242438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213242438">(Oct 14 2020 at 03:18)</a>:</h4>
<p>desired by who?</p>



<a name="213242441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213242441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213242441">(Oct 14 2020 at 03:18)</a>:</h4>
<p>the simplest thing do say would be </p>
<p>"String values SHALL not have leading or trailing blanks"</p>



<a name="213242450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213242450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213242450">(Oct 14 2020 at 03:19)</a>:</h4>
<p>but of course, we can't say that. </p>
<p>various databases already have strings with leading and trailing blanks. Also, markdown is a string</p>



<a name="213242501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213242501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213242501">(Oct 14 2020 at 03:20)</a>:</h4>
<p>the next thing we could say is 'leading and trailing whitespace SHALL be respected', but there's lots of leading XML parsers out there that don't. And these are well into production too</p>



<a name="213242523"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213242523" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213242523">(Oct 14 2020 at 03:20)</a>:</h4>
<p>so we have to allow both leading and trailing whitespace, but we warn implementers about the pitfalls</p>



<a name="213242883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213242883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213242883">(Oct 14 2020 at 03:29)</a>:</h4>
<p>In this case the pitfalls are at least partially (mostly) due to the FHIR schema which states that string values shall not have leading or trailing spaces. If the data type of the fhir:string/@value attribute were of type xs:string, there would be fewer processors that would not respect the white space.</p>



<a name="213247250"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213247250" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213247250">(Oct 14 2020 at 05:06)</a>:</h4>
<p>where does it say that?</p>



<a name="213317394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213317394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213317394">(Oct 14 2020 at 16:36)</a>:</h4>
<p>In my <em>misreading</em> of the XML Schema spec. I am going to try some examples on a few platforms to see if there is a possible improvement in the schema definition to respect white space.</p>



<a name="213474556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213474556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213474556">(Oct 15 2020 at 19:17)</a>:</h4>
<p>So far I have confirmed that .NET (core 3.1), Java OpenJDK 11 (default Xerces parser implementation), and Java JAXB all preserve leading spaces when parsing an attribute. This was tested with and without schema validation. Earlier, there was a confirmation that Expat also preserves leading white space. What other leading XML parsers would need to be tested? nodejs?</p>
<p><span class="user-mention" data-user-id="280644">@Jorn Duwel</span>, is there more specific information on the use case where the leading space is not preserved?</p>



<a name="213475264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213475264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213475264">(Oct 15 2020 at 19:23)</a>:</h4>
<p>At the very least, the sentence</p>
<blockquote>
<p>Implementers SHOULD trim leading and trailing whitespace before writing and SHOULD trim leading and trailing whitespace when reading attribute values (for XML schema conformance)</p>
</blockquote>
<p>is not accurate regarding XML schema conformance.</p>



<a name="213788546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213788546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jorn Duwel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213788546">(Oct 19 2020 at 13:55)</a>:</h4>
<p><span class="user-mention" data-user-id="192685">@Vassil Peytchev</span> , I was out of office for a few days. I will try to get more information on the parser used. Thanks for your efforts btw.</p>



<a name="213873171"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213873171" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213873171">(Oct 20 2020 at 03:56)</a>:</h4>
<blockquote>
<p>is not accurate regarding XML schema conformance</p>
</blockquote>
<p>I think it is. We could perhaps clarify that tools are not necessarily conformant here. Where it really gets complicated is with digital signatures</p>



<a name="213874042"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/String%20attribute%20leading%20space/near/213874042" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/String.20attribute.20leading.20space.html#213874042">(Oct 20 2020 at 04:20)</a>:</h4>
<p>I am looking at that point next, but I still want to find those production parsers that strip spaces.</p>
<p>The schema can actually enforce the "at least one non-whitespace character" rule using a regex pattern (similar to the markdown one).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
