---
layout: page
title: "FHIR Chat  · extension-regex usage · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension-regex.20usage.html">extension-regex usage</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="169682454"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension-regex%20usage/near/169682454" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension-regex.20usage.html#169682454">(Jul 05 2019 at 03:24)</a>:</h4>
<p>Looking at the StructureDefinitions in <code>profiles-types.json</code> from <a href="https://www.hl7.org/fhir/definitions.json.zip" target="_blank" title="https://www.hl7.org/fhir/definitions.json.zip">the master set of FHIR definitions</a> I noticed that the <a href="https://www.hl7.org/fhir/extension-regex.json.html" target="_blank" title="https://www.hl7.org/fhir/extension-regex.json.html">extension-regex</a> for <code>Extension.url</code> is on the <code>ElementDefinition.type.code</code>, whereas the other StructureDefinitions with a regex have it on the <code>ElementDefinition.type</code>.</p>
<p>For reference the Extension.url regex extension looks like this:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
              <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Extension.url&quot;</span><span class="p">,</span>
              <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Extension.url&quot;</span><span class="p">,</span>
              <span class="nt">&quot;representation&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;xmlAttr&quot;</span>
              <span class="p">],</span>
              <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;The definition may point directly to a computable or human-readable definition of the extensibility codes, or it may be a logical URI as declared in some other specification. The definition SHALL be a URI for the Structure Definition defining the extension.&quot;</span><span class="p">,</span>
              <span class="nt">&quot;min&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="nt">&quot;max&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
              <span class="nt">&quot;base&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Extension.url&quot;</span><span class="p">,</span>
                <span class="nt">&quot;min&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;max&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
              <span class="p">},</span>
              <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="nt">&quot;_code&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;extension&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-json-type&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                      <span class="p">},</span>
                      <span class="p">{</span>
                        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-xml-type&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;xsd:string&quot;</span>
                      <span class="p">},</span>
                      <span class="p">{</span>
                        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-rdf-type&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;xsd:string&quot;</span>
                      <span class="p">},</span>
                      <span class="p">{</span>
                        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/regex&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;((http|https)://([A-Za-z0-9\\\\\\.\\:\\%\\$]*\\/)*)?(Account|ActivityDefinition|AdverseEvent|AllergyIntolerance|Appointment|AppointmentResponse|AuditEvent|Basic|Binary|BiologicallyDerivedProduct|BodyStructure|Bundle|CapabilityStatement|CarePlan|CareTeam|CatalogEntry|ChargeItem|ChargeItemDefinition|Claim|ClaimResponse|ClinicalImpression|CodeSystem|Communication|CommunicationRequest|CompartmentDefinition|Composition|ConceptMap|Condition|Consent|Contract|Coverage|CoverageEligibilityRequest|CoverageEligibilityResponse|DetectedIssue|Device|DeviceDefinition|DeviceMetric|DeviceRequest|DeviceUseStatement|DiagnosticReport|DocumentManifest|DocumentReference|EffectEvidenceSynthesis|Encounter|Endpoint|EnrollmentRequest|EnrollmentResponse|EpisodeOfCare|EventDefinition|Evidence|EvidenceVariable|ExampleScenario|ExplanationOfBenefit|FamilyMemberHistory|Flag|Goal|GraphDefinition|Group|GuidanceResponse|HealthcareService|ImagingStudy|Immunization|ImmunizationEvaluation|ImmunizationRecommendation|ImplementationGuide|InsurancePlan|Invoice|Library|Linkage|List|Location|Measure|MeasureReport|Media|Medication|MedicationAdministration|MedicationDispense|MedicationKnowledge|MedicationRequest|MedicationStatement|MedicinalProduct|MedicinalProductAuthorization|MedicinalProductContraindication|MedicinalProductIndication|MedicinalProductIngredient|MedicinalProductInteraction|MedicinalProductManufactured|MedicinalProductPackaged|MedicinalProductPharmaceutical|MedicinalProductUndesirableEffect|MessageDefinition|MessageHeader|MolecularSequence|NamingSystem|NutritionOrder|Observation|ObservationDefinition|OperationDefinition|OperationOutcome|Organization|OrganizationAffiliation|Patient|PaymentNotice|PaymentReconciliation|Person|PlanDefinition|Practitioner|PractitionerRole|Procedure|Provenance|Questionnaire|QuestionnaireResponse|RelatedPerson|RequestGroup|ResearchDefinition|ResearchElementDefinition|ResearchStudy|ResearchSubject|RiskAssessment|RiskEvidenceSynthesis|Schedule|SearchParameter|ServiceRequest|Slot|Specimen|SpecimenDefinition|StructureDefinition|StructureMap|Subscription|Substance|SubstanceNucleicAcid|SubstancePolymer|SubstanceProtein|SubstanceReferenceInformation|SubstanceSourceMaterial|SubstanceSpecification|SupplyDelivery|SupplyRequest|Task|TerminologyCapabilities|TestReport|TestScript|ValueSet|VerificationResult|VisionPrescription)\\/[A-Za-z0-9\\-\\.]{1,64}(\\/_history\\/[A-Za-z0-9\\-\\.]{1,64})?&quot;</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">],</span>
              <span class="nt">&quot;isModifier&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
              <span class="nt">&quot;isSummary&quot;</span><span class="p">:</span> <span class="kc">false</span>
            <span class="p">}</span>
</pre></div>


<p>whereas the other FHIR datatypes, like uri, have it on the type element:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
              <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;uri.value&quot;</span><span class="p">,</span>
              <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;uri.value&quot;</span><span class="p">,</span>
              <span class="nt">&quot;representation&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;xmlAttr&quot;</span>
              <span class="p">],</span>
              <span class="nt">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="nt">&quot;max&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
              <span class="nt">&quot;base&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;uri.value&quot;</span><span class="p">,</span>
                <span class="nt">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;max&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
              <span class="p">},</span>
              <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="nt">&quot;extension&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/regex&quot;</span><span class="p">,</span>
                      <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;\\S*&quot;</span>
                    <span class="p">}</span>
                  <span class="p">],</span>
                  <span class="nt">&quot;_code&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;extension&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-json-type&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                      <span class="p">},</span>
                      <span class="p">{</span>
                        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-xml-type&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;xsd:anyURI&quot;</span>
                      <span class="p">},</span>
                      <span class="p">{</span>
                        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://hl7.org/fhir/StructureDefinition/structuredefinition-rdf-type&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;valueString&quot;</span><span class="p">:</span> <span class="s2">&quot;xsd:string&quot;</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">],</span>
              <span class="nt">&quot;isModifier&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
              <span class="nt">&quot;isSummary&quot;</span><span class="p">:</span> <span class="kc">false</span>
            <span class="p">}</span>
</pre></div>


<p>based on the context from the regex-extension StructureDefinition I was expecting it to be on the ElementDefinition.  I can see that it might be undesirable to have it on the ElementDefinition because of elements that have a choice of type.</p>
<div class="codehilite"><pre><span></span><span class="s2">&quot;context&quot;</span><span class="err">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span>
            <span class="nt">&quot;expression&quot;</span><span class="p">:</span> <span class="s2">&quot;Questionnaire.item&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span>
            <span class="nt">&quot;expression&quot;</span><span class="p">:</span> <span class="s2">&quot;ElementDefinition&quot;</span>
          <span class="p">}</span>
        <span class="p">]</span>
</pre></div>


<p>Is there a reason for putting the regex-extension in one place or the other and should they be treated differently depending on if its on the type or the type.code?</p>



<a name="169695909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension-regex%20usage/near/169695909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension-regex.20usage.html#169695909">(Jul 05 2019 at 09:26)</a>:</h4>
<p>should be consistent. But I'm not sure where it should be</p>



<a name="169711439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension-regex%20usage/near/169711439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension-regex.20usage.html#169711439">(Jul 05 2019 at 14:10)</a>:</h4>
<p>It should be on ElementDefinition.  We're qualifying the whole definition and that's where we put other constraints like maxLength.</p>



<a name="169872632"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension-regex%20usage/near/169872632" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reece Adamson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension-regex.20usage.html#169872632">(Jul 08 2019 at 14:13)</a>:</h4>
<p>Thanks!  Should I submit a tracker ticket for this?  I'd be happy to help implement a fix if desired.</p>



<a name="169883066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension-regex%20usage/near/169883066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension-regex.20usage.html#169883066">(Jul 08 2019 at 16:20)</a>:</h4>
<p>Please.  And a pull request is always welcome</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
