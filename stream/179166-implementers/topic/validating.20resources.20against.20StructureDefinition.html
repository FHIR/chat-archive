---
layout: page
title: "FHIR Chat  · validating resources against StructureDefinition · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html">validating resources against StructureDefinition</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153847396"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/153847396" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venkat Reddy <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#153847396">(Sep 15 2016 at 18:17)</a>:</h4>
<p>Hi All, this is regarding to validateWithResult() method. it is performance hit. tried with Patient resource and default profile.  is there any other alternative to it. suggestions will be helpful. </p>



<a name="153847402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/153847402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#153847402">(Sep 15 2016 at 19:09)</a>:</h4>
<p>You're using the reference implementation?  A good bit of the performance is in the terminology services invocations - if you can cache that, it's less of an issue.  Also, the validator hasn't really been performance tuned.  As well, there's a trade-off between validation thoroughness and performance - the more you validate, the more time it will take</p>



<a name="153847409"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/153847409" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Venkat Reddy <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#153847409">(Sep 15 2016 at 19:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> Any link / document reference  to  configure  the validation thoroughness . </p>



<a name="153847413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/153847413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#153847413">(Sep 15 2016 at 19:42)</a>:</h4>
<p>Well, there's an ability to turn off external terminology validation - just specify your terminology server as "na".  Beyond that, the configuration mechanism is "wade through the code and remove/comment out what you wish".  The focus of the validator to date has been meeting the needs of the FHIR publishing process, not run-time use, so we haven't profiled it to see where the performance issues are, nor figured out where we can tune those vs. where it makes sense to make those portions of the validation configurable.  (And realistically, this work is likely to happen as part of paid project work rather than standard volunteer effort.)</p>



<a name="153847446"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/153847446" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#153847446">(Sep 16 2016 at 10:11)</a>:</h4>
<p>where is validateWithResult()? what code are you referring to? </p>



<a name="153847447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/153847447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#153847447">(Sep 16 2016 at 10:11)</a>:</h4>
<p>and how long is it taking? </p>



<a name="256461965"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/256461965" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Łukasz Kułakowski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#256461965">(Oct 06 2021 at 18:36)</a>:</h4>
<p>Hello everyone, <br>
I'll pin my question under current topic as it fits perfectly :)<br>
I've been trying to build FHIR resource validator in python, basing only on StructureDefiniton.differential.element (assuming that we have basic validation of resource already in place) and I've been wondering if there is any more efficient method of validating a resource than looping through each StructureDefinition.differential.element? Just want to make sure I'm following the docs correctly, I've generated my StructureDefinition's using Forge and I see that all the information that I want to validate against are actually included in StructureDefinition.differential.element so naturally I wanted to build test cases around those, but maybe im missing somethin.<br>
Thanks!</p>



<a name="256464821"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/256464821" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#256464821">(Oct 06 2021 at 18:53)</a>:</h4>
<p>You definitely want to perform validation using snapshot, not differential.  The algorithm for generating a snapshot from a differential is super-complex and you definitely <em>don't</em> want to take that on in addition to doing the validation piece.</p>



<a name="256545946"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/256545946" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek S <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#256545946">(Oct 07 2021 at 09:11)</a>:</h4>
<p>Hi,<br>
I am using validator_cli.jar to validate the FHIR resource against my profiles/ig. I am seeing an error as below for one of the Observation.code.<br>
As per the understanding, this snomed code "459231000124102" is available in "<a href="http://snomed.info/sct/900000000000207008/version/20210731">http://snomed.info/sct/900000000000207008/version/20210731</a>" version. However the validator is pointing to "<a href="http://snomed.info/sct/900000000000207008/version/20200131">http://snomed.info/sct/900000000000207008/version/20200131</a>" version as seen in the error. </p>
<p>Error @ Observation.code.coding[0] (line 23, col8) : Unable to find code 459231000124102 in <a href="http://snomed.info/sct">http://snomed.info/sct</a> (version <a href="http://snomed.info/sct/900000000000207008/version/20200131">http://snomed.info/sct/900000000000207008/version/20200131</a>); The code "459231000124102" is not valid in the system <a href="http://snomed.info/sct">http://snomed.info/sct</a>; The code provided (<a href="http://snomed.info/sct#459231000124102">http://snomed.info/sct#459231000124102</a>) is not valid in the value set 'All codes known to the system' (from <a href="http://tx.fhir.org/r4">http://tx.fhir.org/r4</a>) for '<a href="http://snomed.info/sct#459231000124102">http://snomed.info/sct#459231000124102</a>'</p>
<p>Even though I pass the specific version in FHIR resource as below, validator is trying to refer "20200131" version and return the above error .</p>
<p>"code": {<br>
    "coding": [<br>
      {<br>
        "system": "<a href="http://snomed.info/sct">http://snomed.info/sct</a>",<br>
    "version": "<a href="http://snomed.info/sct/900000000000207008/version/20210731">http://snomed.info/sct/900000000000207008/version/20210731</a>",<br>
        "code": "459231000124102",<br>
        "display": "Sequential organ failure assessment score (assessment scale)"<br>
      }<br>
    ]<br>
  }</p>
<p>Any thoughts on how to resolve this specific version issue seen in validator is appreciated.</p>



<a name="256576104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/256576104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#256576104">(Oct 07 2021 at 13:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span></p>



<a name="256579638"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/256579638" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#256579638">(Oct 07 2021 at 13:46)</a>:</h4>
<p><span class="user-mention" data-user-id="449383">@Vivek S</span> I'll try to take a look at this.  If you don't hear from me on it today, feel free to ping again (or PM me directly).</p>



<a name="257175667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/257175667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#257175667">(Oct 12 2021 at 09:43)</a>:</h4>
<p>this is esp. surprising, since via the web interface the concept _is_ found: <code>http://tx.fhir.org/snomed/900000000000207008-20210731/?srch=459231000124102</code>- when the version is correctly used. (the concept did not yet exist in 20200131)</p>
<p>somehow the hl7validator+tx.fhir.org do not take the supplied version in to account, when using the FHIR-REST API ($validate)</p>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  <span class="user-mention" data-user-id="191405">@Rob Hausam</span> it is very well possible that the hl7validator does not pass the version along in its call - <code>20210731</code>is not found in the txLog file.... the <code>version</code> seems missing on the <code>POST http://tx.fhir.org/r4/CodeSystem/$validate-code? HTTP/1.0</code>:</p>
<div class="codehilite"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;
    &lt;parameter&gt;
        &lt;name value=&quot;coding&quot;/&gt;
        &lt;valueCoding&gt;
            &lt;system value=&quot;http://snomed.info/sct&quot;/&gt;
            &lt;code value=&quot;459231000124102&quot;/&gt;
            &lt;display value=&quot;Sequential organ failure assessment score (assessment scale)&quot;/&gt;
        &lt;/valueCoding&gt;
    &lt;/parameter&gt;
    &lt;parameter&gt;
        &lt;name value=&quot;profile&quot;/&gt;
        &lt;resource&gt;
            &lt;Parameters&gt;
                &lt;parameter&gt;
                    &lt;name value=&quot;profile-url&quot;/&gt;
                    &lt;valueString value=&quot;http://hl7.org/fhir/ExpansionProfile/dc8fd4bc-091a-424a-8a3b-6198ef146891&quot;/&gt;
                &lt;/parameter&gt;
                &lt;parameter&gt;
                    &lt;name value=&quot;system-version&quot;/&gt;
                    &lt;valueString value=&quot;http://snomed.info/sct|http://snomed.info/sct/900000000000207008&quot;/&gt;
                &lt;/parameter&gt;
            &lt;/Parameters&gt;
        &lt;/resource&gt;
    &lt;/parameter&gt;
&lt;/Parameters&gt;
</code></pre></div>
<p>with the following response (note the tx server using its default version):</p>
<div class="codehilite"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;
    &lt;parameter&gt;
        &lt;name value=&quot;result&quot;/&gt;
        &lt;valueBoolean value=&quot;false&quot;/&gt;
    &lt;/parameter&gt;
    &lt;parameter&gt;
        &lt;name value=&quot;message&quot;/&gt;
        &lt;valueString value=&quot;Unable to find code 459231000124102 in http://snomed.info/sct (version http://snomed.info/sct/900000000000207008/version/20200131); The code &amp;quot;459231000124102&amp;quot; is not valid in the system http://snomed.info/sct; The code provided (http://snomed.info/sct#459231000124102) is not valid in the value set &amp;apos;All codes known to the system&amp;apos;&quot;/&gt;
    &lt;/parameter&gt;
    &lt;parameter&gt;
        &lt;name value=&quot;cause&quot;/&gt;
        &lt;valueString value=&quot;invalid&quot;/&gt;
    &lt;/parameter&gt;
&lt;/Parameters&gt;
</code></pre></div>



<a name="257196360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/257196360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Łukasz Kułakowski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#257196360">(Oct 12 2021 at 12:46)</a>:</h4>
<p>When dealing with validation of resource using StructureDefinitions, how do you store information about which StructureDefinition should be used to validate which resource? E.g. I have several observation resources like heart rate, saturation etc and I'd like to validate them with different StructureDefinitions, should information about which SD to use be stored inside resource, or should i dynamically assign the proper structure basing on "category" or "code"?</p>



<a name="257201570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/257201570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#257201570">(Oct 12 2021 at 13:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="434643">Łukasz Kułakowski</span> <a href="#narrow/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition/near/257196360">said</a>:</p>
<blockquote>
<p>When dealing with validation of resource using StructureDefinitions, how do you store information about which StructureDefinition should be used to validate which resource? E.g. I have several observation resources like heart rate, saturation etc and I'd like to validate them with different StructureDefinitions, should information about which SD to use be stored inside resource, or should i dynamically assign the proper structure basing on "category" or "code"?</p>
</blockquote>
<p>ah, the original topic - we hijacked it - :) the quick answer is to claim 1..* SD/profile conformance(s) using meta.profile (<a href="https://www.hl7.org/fhir/resource.html#Meta">https://www.hl7.org/fhir/resource.html#Meta</a>) in the Resource.</p>



<a name="257208136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/257208136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Łukasz Kułakowski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#257208136">(Oct 12 2021 at 14:05)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="194580">@David Simons</span> !</p>



<a name="257972838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/257972838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#257972838">(Oct 18 2021 at 03:49)</a>:</h4>
<p>hmm. I found and fixed a nmber of issues related to this but I couldn't actually reproduce this, so I'm not sure I fixed it. How would I reproduce this?</p>



<a name="258137269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258137269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek S <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258137269">(Oct 19 2021 at 03:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition/near/257972838">said</a>:</p>
<blockquote>
<p>hmm. I found and fixed a nmber of issues related to this but I couldn't actually reproduce this, so I'm not sure I fixed it. How would I reproduce this?</p>
</blockquote>
<p>Hi Grahame,<br>
If the observation resource has below specified code, the FHIR validator used to return a Failure/Error indicating the  the code is not valid in the system. Detailed error in my original post above. (code was valid only latest 20210731 SNOMED version, validator was referring 20200131 SNOMED version)<br>
Post fix, we do not expect the FHIR validator to return the failure.</p>
<p>"code": {<br>
    "coding": [<br>
      {<br>
        "system": "<a href="http://snomed.info/sct">http://snomed.info/sct</a>",<br>
    "version": "<a href="http://snomed.info/sct/900000000000207008/version/20210731">http://snomed.info/sct/900000000000207008/version/20210731</a>",<br>
        "code": "459231000124102",<br>
        "display": "Sequential organ failure assessment score (assessment scale)"<br>
      }<br>
    ]<br>
  }</p>



<a name="258343680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258343680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek S <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258343680">(Oct 20 2021 at 10:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition/near/257972838">said</a>:</p>
<blockquote>
<p>hmm. I found and fixed a nmber of issues related to this but I couldn't actually reproduce this, so I'm not sure I fixed it. How would I reproduce this?</p>
</blockquote>
<p>Hi Grahame, Could you please confirm if the changes are already merged to master branch for us to re-test?</p>



<a name="258346736"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258346736" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258346736">(Oct 20 2021 at 10:48)</a>:</h4>
<p>not in master. you can look at this PR:</p>



<a name="258346794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258346794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258346794">(Oct 20 2021 at 10:48)</a>:</h4>
<p><a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/624">https://github.com/hapifhir/org.hl7.fhir.core/pull/624</a></p>



<a name="258365151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258365151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258365151">(Oct 20 2021 at 13:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition/near/258346736">said</a>:</p>
<blockquote>
<p>not in master. you can look at this PR:</p>
</blockquote>
<p>thanks, building this branch for <span class="user-mention" data-user-id="449383">@Vivek S</span>, so we can test</p>



<a name="258380422"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258380422" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258380422">(Oct 20 2021 at 14:44)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, the hl7validator side seems to have been resolved with that PR #624, the version is now included in the POST</p>
<div class="codehilite"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Parameters xmlns=&quot;http://hl7.org/fhir&quot;&gt;
    &lt;parameter&gt;
        &lt;name value=&quot;coding&quot;/&gt;
        &lt;valueCoding&gt;
            &lt;system value=&quot;http://snomed.info/sct&quot;/&gt;
            &lt;version value=&quot;http://snomed.info/sct/900000000000207008/version/20210731&quot;/&gt;
            &lt;code value=&quot;459231000124102&quot;/&gt;
            &lt;display value=&quot;Sequential organ failure assessment score (assessment scale)&quot;/&gt;
        &lt;/valueCoding&gt;
    &lt;/parameter&gt;
</code></pre></div>



<a name="258381004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258381004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258381004">(Oct 20 2021 at 14:48)</a>:</h4>
<p>HOWEVER, the <a href="http://tx.fhir.org">tx.fhir.org</a> server side now seems to have lost the SNOMED 20210731 International version?</p>
<p><code>http://tx.fhir.org/snomed/900000000000207008-20210731/?srch=459231000124102</code> gives a <code>Document /snomed/900000000000207008-20210731/ not found</code>...<br>
Also <code>https://tx.fhir.org /snomed</code> is gone</p>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="258383176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258383176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258383176">(Oct 20 2021 at 15:00)</a>:</h4>
<p><span class="user-mention" data-user-id="194580">@David Simons</span> It certainly should not have lost it.   The server is running and the 20210731 International Edition appears to be loaded and is still showing as the default.  But I agree that something seems wrong with the queries that I'm trying.  I'll look at it further, but I'm occupied for the next hour.</p>



<a name="258384382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258384382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258384382">(Oct 20 2021 at 15:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191405">Rob Hausam</span> <a href="#narrow/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition/near/258383176">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="194580">David Simons</span> It certainly should not have lost it.   The server is running and the 20210731 International Edition appears to be loaded and is still showing as the default.  But I agree that something seems wrong with the queries that I'm trying.  I'll look at it further, but I'm occupied for the next hour.</p>
</blockquote>
<p>Thank you for all your support! End-of-day here - we'll check back in tomorrow.</p>



<a name="258384627"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258384627" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258384627">(Oct 20 2021 at 15:08)</a>:</h4>
<p>this  is what we see currently, as additional input.</p>
<p><a href="/user_uploads/10155/9PL6FGT-tuMu7s8jjbvbaClK/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/9PL6FGT-tuMu7s8jjbvbaClK/image.png" title="image.png"><img src="/user_uploads/10155/9PL6FGT-tuMu7s8jjbvbaClK/image.png"></a></div>



<a name="258506002"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258506002" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258506002">(Oct 21 2021 at 08:23)</a>:</h4>
<p>Resolved</p>



<a name="258506626"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/258506626" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek S <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#258506626">(Oct 21 2021 at 08:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="194580">David Simons</span> <a href="#narrow/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition/near/258384382">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="191405">Rob Hausam</span> <a href="#narrow/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition/near/258383176">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="194580">David Simons</span> It certainly should not have lost it.   The server is running and the 20210731 International Edition appears to be loaded and is still showing as the default.  But I agree that something seems wrong with the queries that I'm trying.  I'll look at it further, but I'm occupied for the next hour.</p>
</blockquote>
<p>Thank you for all your support! End-of-day here - we'll check back in tomorrow.</p>
</blockquote>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Today we could see "<a href="http://tx.fhir.org/snomed/">http://tx.fhir.org/snomed/</a>" up with "20210731" SNOMED version in it.<br>
Also, I could re-test the validator for SNOMED code "459231000124102" against "20210731" SNOMED version on the latest changes created on PR #624, our tests now pass.</p>
<p>Thanks for the support.</p>



<a name="268587681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/268587681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Ross <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#268587681">(Jan 19 2022 at 19:01)</a>:</h4>
<p>I am trying to validate a patient resource against the US-core profile using 5.6.2 HAPI libraries and loading the StructuredDefinition-us-core-patient.json resource from (<a href="http://hl7.org/fhir/us/core/STU4/full-ig.zip">http://hl7.org/fhir/us/core/STU4/full-ig.zip</a>).  Validating with an R4 FhirContext and using setDefaultTypeForProfile(), everything loads and validates as expected.</p>
<p>When I run my same test with a DSTU3 FhirContext I get a null pointer exception in the InstanceValidator.  I have tried both the StructuredDefinition above and using the older DSTU3 StructuredDefinition (<a href="http://hl7.org/fhir/us/core/STU3.1.1/full-ig.zip">http://hl7.org/fhir/us/core/STU3.1.1/full-ig.zip</a>).  I am specifying the DSTU3 Patient class for the defaultType.</p>
<p>Is there a trick to validing DSTU3 resources with the current InstanceValidator?  It looks like it is referencing R5 Element definitions.  Any help appreciated.</p>
<p>Here is the stack trace:</p>
<div class="codehilite"><pre><span></span><code>java.lang.NullPointerException
    at org.hl7.fhir.r5.model.Element.getExtensionString(Element.java:428)
    at org.hl7.fhir.r5.model.ElementDefinition$TypeRefComponent.getWorkingCode(ElementDefinition.java:2264)
    at org.hl7.fhir.validation.instance.InstanceValidator.checkChildByDefinition(InstanceValidator.java:4510)
    at org.hl7.fhir.validation.instance.InstanceValidator.checkChild(InstanceValidator.java:4492)
    at org.hl7.fhir.validation.instance.InstanceValidator.validateElement(InstanceValidator.java:4444)
    at org.hl7.fhir.validation.instance.InstanceValidator.startInner(InstanceValidator.java:4160)
    at org.hl7.fhir.validation.instance.InstanceValidator.start(InstanceValidator.java:4023)
    at org.hl7.fhir.validation.instance.InstanceValidator.validateResource(InstanceValidator.java:5242)
    at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:748)
    at org.hl7.fhir.validation.instance.InstanceValidator.validate(InstanceValidator.java:593)
    at org.hl7.fhir.common.hapi.validation.validator.ValidatorWrapper.validate(ValidatorWrapper.java:181)
    at org.hl7.fhir.common.hapi.validation.validator.FhirInstanceValidator.validate(FhirInstanceValidator.java:235)
    at org.hl7.fhir.common.hapi.validation.validator.BaseValidatorBridge.doValidate(BaseValidatorBridge.java:22)
    at org.hl7.fhir.common.hapi.validation.validator.BaseValidatorBridge.validateResource(BaseValidatorBridge.java:45)
    at org.hl7.fhir.common.hapi.validation.validator.FhirInstanceValidator.validateResource(FhirInstanceValidator.java:25)
    at ca.uhn.fhir.validation.FhirValidator.validateWithResult(FhirValidator.java:261)
    at ca.uhn.fhir.validation.FhirValidator.validateWithResult(FhirValidator.java:202)
    at com.qvera.qie.hapi.AbstractValidatorTest.testCustomProfileValidator(AbstractValidatorTest.java:101)
</code></pre></div>



<a name="268592403"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/268592403" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#268592403">(Jan 19 2022 at 19:37)</a>:</h4>
<p>US Core 3.1.1 is based on FHIR R4,  The last published version of US Core based on FHIR STU3 is <a href="http://hl7.org/fhir/us/core/STU2/">2.0.0</a></p>



<a name="268608526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/268608526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Ross <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#268608526">(Jan 19 2022 at 21:51)</a>:</h4>
<p>Thank you.  I assumed it was the same versioning.  I didn't realize that.  I just tried the StructuredDefinition-us-core-patient.json from <a href="http://hl7.org/fhir/us/core/STU2/full-ig.zip">http://hl7.org/fhir/us/core/STU2/full-ig.zip</a>, and I'm still getting the same null pointer as I try to use the validator for DSTU3 context.</p>
<p>If I remove the use of prePopulatedSupport from the chain, it reports that us-core-patient is unknown.  When I include it in the change for DSTU3 FhirContext, it produces the null pointer exception in the InstanceValidator</p>
<div class="codehilite"><pre><span></span><code>        PrePopulatedValidationSupport prePopulatedSupport = new PrePopulatedValidationSupport(context);
        prePopulatedSupport.addStructureDefinition(usCoreStructureDefinition);

        // https://hapifhir.io/hapi-fhir/docs/validation/validation_support_modules.html
        // Create a chain that will hold our modules
        ValidationSupportChain supportChain = new ValidationSupportChain(
                defaultSupport
                ,commonCodeSystemsTerminologySupport
                ,inMemoryTerminologySupport
                ,prePopulatedSupport
        );

        // Wrap the chain in a cache to improve performance
        CachingValidationSupport cache = new CachingValidationSupport(supportChain);

        // Create a validator using the FhirInstanceValidator module. We can use this
        // validator to perform validation
        FhirInstanceValidator validatorModule = new FhirInstanceValidator(cache);
        FhirValidator validator = context.newValidator().registerValidatorModule(validatorModule);

        String patientString = createUSCorePatientString();
        ValidationResult usCoreValidationResults = validator.validateWithResult(patientString);
</code></pre></div>



<a name="268720858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/validating%20resources%20against%20StructureDefinition/near/268720858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Ross <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/validating.20resources.20against.20StructureDefinition.html#268720858">(Jan 20 2022 at 16:42)</a>:</h4>
<p>Thank you, Eric.  It looks like it is working with the 2.0.0 IG.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
