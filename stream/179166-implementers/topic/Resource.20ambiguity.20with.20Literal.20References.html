---
layout: page
title: "FHIR Chat  · Resource ambiguity with Literal References · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html">Resource ambiguity with Literal References</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="216890571"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216890571" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Arnold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216890571">(Nov 16 2020 at 15:58)</a>:</h4>
<p>Literal references can be specified as a logical id without the resource type e.g. 'abc1234'. Also, logical-ids are only required to be unique for a given resource type, so I could have a Patient resource 'abc1234' and a RelatedPerson resource 'abc1234'. This could cause problems with compartment membership because the same reference field is used to model relationships to more than one type of resource. For example, CareTeam.participant indicates that the CareTeam resource belongs to a given Patient compartment as well as a RelatedPerson compartment. If the same logical-id were used for both a Patient and a (perhaps completely unrelated!) RelatedPerson 'abc1234'.  this would map a CareTeam resource into a compartment it might not actually belong to.</p>
<p>Forcing relative references to include the resource-type is one solution, but deviates from the specification. Has anyone else hit this and is there a recommended approach?</p>



<a name="216890847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216890847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216890847">(Nov 16 2020 at 16:00)</a>:</h4>
<p>Logical ids should be a combination of system + value - and together those SHOULD be globally unique across all resource types.</p>



<a name="216891156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216891156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216891156">(Nov 16 2020 at 16:01)</a>:</h4>
<p>A literal reference without the type isn't legal. There are some contexts where you can use id alone, for example reference search, but each of those contexts has some language like "Servers SHOULD reject a search where the logical id refers to more than one matching resource across different types" to clarify what happens.</p>



<a name="216891161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216891161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216891161">(Nov 16 2020 at 16:01)</a>:</h4>
<p>That said, it's certainly possible for the logical identifier to exist on multiple.  E.g. pointing by social security number and it resolving on Patient, RelatedPerson and Practitioner.  The reality is that logical references aren't as precise as true references.  Even if you add resource type, there's a possibility of multiple matches.</p>



<a name="216893213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216893213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Arnold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216893213">(Nov 16 2020 at 16:14)</a>:</h4>
<p><span class="user-mention" data-user-id="197072">@Paul Church</span> yes, I agree that the search specification indicates that the search should be rejected if the logical id matches more than one resource across different types, but it provides a way to disambiguate such cases by specifying the desired type in the search string. But this still leaves the issue with compartment membership.</p>



<a name="216893829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216893829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Arnold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216893829">(Nov 16 2020 at 16:18)</a>:</h4>
<p><span class="user-mention" data-user-id="197072">@Paul Church</span> perhaps I'm misreading the spec, but it does seem as though literal references don't require the type. "For this reason, the reference may indicate directly the target resource type".</p>



<a name="216896065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216896065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216896065">(Nov 16 2020 at 16:33)</a>:</h4>
<p>I read the spec as requiring the type in any case where it can't be inferred, because of "a Reference always point[s] to another resource, which has a fixed and known type".</p>
<p>I don't think this is entirely clear from the wording though. The "may indicate directly" wording points in the opposite direction. The Google implementation does not allow the type to be omitted in any case.</p>



<a name="216896158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216896158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216896158">(Nov 16 2020 at 16:34)</a>:</h4>
<p>To me, the spec is clear that relative references should be of the form <code>ResourceType/123</code>.<br>
However, I don't see anything in the datatype definitions (i.e. no constraints other than the one about starting with <code>#</code>) that enforces that.</p>



<a name="216896559"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216896559" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216896559">(Nov 16 2020 at 16:37)</a>:</h4>
<p>We know absolute references are allowed as well, and that these need not match the FHIR REST API pattern.  But would it still be possible to add some kind of URI pattern constraint?</p>



<a name="216896805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216896805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216896805">(Nov 16 2020 at 16:38)</a>:</h4>
<p>and, without this type of enforcement, is an opaque string value truly "invalid"?</p>



<a name="216899472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216899472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216899472">(Nov 16 2020 at 16:56)</a>:</h4>
<p>The section on <a href="https://build.fhir.org/references.html">references</a> makes clear what the URL is allowed to be.  It's either an absolute URL, it's a type/id or it's a local reference (starts with '#').  A bare id is never legal.</p>



<a name="216899699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216899699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216899699">(Nov 16 2020 at 16:58)</a>:</h4>
<p>There is no part of that section that clearly states the type/id part of what you just said.</p>



<a name="216900189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216900189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216900189">(Nov 16 2020 at 17:02)</a>:</h4>
<p>also, what constitutes a valid absolute URL.  does it need to match <code>scheme ":" hier-part [ "?" query ] [ "#" fragment ]</code> ?</p>



<a name="216900328"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216900328" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ryan moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216900328">(Nov 16 2020 at 17:03)</a>:</h4>
<p>I'm not sure where I got the impression (I tried to look for anything to back this up) but I was under the impression that a reference that is bound to only one resourceType by the base fhir spec is allowed to not give the resource type in the reference (i.e. Patient.managingOrganization=123 implies Organization/123 but Patient.generalPractitioner=123 is invalid because of this very reason) is this not the case?</p>



<a name="216900425"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216900425" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216900425">(Nov 16 2020 at 17:04)</a>:</h4>
<p><span class="user-mention" data-user-id="237342">@ryan moehrke</span> there are two different parts to this.</p>
<ol>
<li>what appears in the Resource</li>
<li>what you can use to search it</li>
</ol>



<a name="216900503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216900503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216900503">(Nov 16 2020 at 17:04)</a>:</h4>
<p>for 1, it must be <code>ReferenceType/id</code> (for relative references)</p>



<a name="216900533"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216900533" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216900533">(Nov 16 2020 at 17:04)</a>:</h4>
<p>for 2, you can omit the <code>ReferenceType/</code> prefix if its unambiguous</p>



<a name="216902558"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216902558" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216902558">(Nov 16 2020 at 17:19)</a>:</h4>
<blockquote>
<p>for 2, you can omit the ReferenceType/ prefix if its unambiguous</p>
</blockquote>
<p>(And as a side note, one way to make it unambiguous in a search is with a modifier -- e.g., <code>Observation?subject:Patient=123</code>. Though this particular example would be pretty unusual, since there's a dedicated <code>patient=</code> search parameter that accomplishes exactly this restriction out of the box.)</p>



<a name="216902744"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216902744" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216902744">(Nov 16 2020 at 17:21)</a>:</h4>
<p>(it annoys the heck out of me that you can do subject:Patient=123 or subject=Patient/123 or patient=123 to solve the same problem)</p>



<a name="216912656"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216912656" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216912656">(Nov 16 2020 at 18:34)</a>:</h4>
<p>We should probably just come up with a <a href="https://xkcd.com/927/">new unified syntax that can do it all!</a></p>



<a name="216934136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216934136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216934136">(Nov 16 2020 at 21:22)</a>:</h4>
<p>It's technically possible to put just a base string in the reference:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="s2">"patient"</span> <span class="err">:</span> <span class="p">{</span> <span class="nt">"reference"</span> <span class="p">:</span> <span class="s2">"8cdf70c5-a3d0-4910-935d-d59594079647"</span><span class="p">}</span> <span class="err">}</span>
</code></pre></div>
<p>What this means is that the literal reference <code>[base]/8cdf70c5-a3d0-4910-935d-d59594079647</code> resolves to something that is a valid resource type of the resources allowed in this context.</p>
<p>Obviously this means that the target resource is not being served up by a server that conforms to the RESTful API. And therefore it is indeterminate what it means for RESTful API search, since the RESTful search is search on the RESTful API.</p>



<a name="216937918"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216937918" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Derek Ritz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216937918">(Nov 16 2020 at 21:54)</a>:</h4>
<p>I'm very sorry if the answer to this is obvious to everyone but me... but is this problem made worse by situations where there are <strong>multiple</strong> FHIR servers, each playing unique roles in an HIE architecture? For example... if there is a FHIR server acting as an EMPI and a separate one acting as a shared health record (SHR... or CDR), are we forced into needing to employ fully specified URLs? And if not, are relative references able to operate outside the scope of a single FHIR server?</p>



<a name="216938106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216938106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216938106">(Nov 16 2020 at 21:56)</a>:</h4>
<p>Relative references are limited to the scope of a single server (unless their served up by a facade that masks the existence of multiple back-end servers)</p>



<a name="216938147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216938147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216938147">(Nov 16 2020 at 21:56)</a>:</h4>
<p>That's the only way to ensure unique resolution</p>



<a name="216938599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216938599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216938599">(Nov 16 2020 at 22:00)</a>:</h4>
<blockquote>
<p>are relative references able to operate outside the scope of a single FHIR server</p>
</blockquote>
<p>The specification does not say that this is not possible. Note the double negative there, with care. There are immediately obvious challenges with doing this, but if the eco-system can ensure that each type has a master server, and this is fixed in advance, then it's possible. But that's super fragile; much much better to use absolute references</p>



<a name="216938862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216938862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Derek Ritz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216938862">(Nov 16 2020 at 22:03)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  and <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>. So... realistically... one would be well-served to always use absolute references as a matter of good practice. This way -- if separate servers needed to be lit up at a later date (to handle high traffic loads, for example) -- it'd all just keep working... right? And if relative references were used... perhaps not so much.</p>



<a name="216939116"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216939116" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216939116">(Nov 16 2020 at 22:05)</a>:</h4>
<p>maybe. depends on how it plays out. Typically, multiple servers = multiple IP address for the same name in DNS, and the scaling solution is opaque to clients. But if it's not... then maybe absolute references would have helped (retrospectively)</p>



<a name="216939153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216939153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216939153">(Nov 16 2020 at 22:05)</a>:</h4>
<p>my understanding is that relative references would be in the context of an obvious base.. the example given here is that they are used within  a Bundle, so the base on the bundle gives context. <br>
I don't think that one MUST use relative references inside a Bundle... right?</p>



<a name="216939895"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216939895" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216939895">(Nov 16 2020 at 22:11)</a>:</h4>
<p>thus a trusted intermediary (I) might assemble a Bundle made up of federated queries out to many (A, B, C, D) . Each of the federated queries would have had relative references to each Bundle response.. that trusted intermediary (I) might then create a Response Bundle of its-own (I:Bundle) expand  all the relative references from the (A, B, C, D) bundles into full URL and assemble them all into the one Bundle owned by the trusted intermediary (I-Bundle). Given that this trusted intermediary didn't add any resources of its-own (not disallowed, just for example), then all the resources in the Bundle would not have relative References but have fully specified URL back to the federation of resource servers. The result would be clear and compliant. --- right?</p>



<a name="216940407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216940407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216940407">(Nov 16 2020 at 22:15)</a>:</h4>
<p>yes it could be done that way</p>



<a name="216942974"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/216942974" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Derek Ritz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#216942974">(Nov 16 2020 at 22:39)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span>  -- is that what a <strong>Document Registry</strong> actor might do (as defined in the IHE MHDS spec)? This seems to be very much the kind of trusted role the <strong>Interoperability Layer</strong> plays in an <strong>OpenHIE</strong> architecture and the kind of tasks it could be expected to perform.</p>



<a name="217005823"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217005823" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217005823">(Nov 17 2020 at 14:05)</a>:</h4>
<p><span class="user-mention" data-user-id="193307">@Derek Ritz</span>  MHDS does not need to do this as the Document Registry is the owner of the DocumentReference, DocumentManifest, and List resources.  Same is true of the other central FHIR services (PMIR, SVCM, ATNA, etc). This is just normal MHDS... But it might be a solution for a federation of MHDS(s)</p>



<a name="217144180"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217144180" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Arnold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217144180">(Nov 18 2020 at 14:52)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> this is OK iff the id is unique across all resource types in a given context. But the spec states that: "The logical id is unique within the space of all resources of the same type on the same server." By inference, it does not need to be unique across resource types, which I think exposes the issue described in my original post. Because this relates to compartment membership, I believe this could lead to information leakage.</p>



<a name="217161886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217161886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217161886">(Nov 18 2020 at 16:42)</a>:</h4>
<p>I'm not sure what you mean. If you use a literal reference then that can only resolve to one address, and that can't be more than one thing</p>



<a name="217163384"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217163384" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217163384">(Nov 18 2020 at 16:52)</a>:</h4>
<p><span class="user-mention" data-user-id="304455">@Robin Arnold</span> According to <a href="https://build.fhir.org/references.html#literal">https://build.fhir.org/references.html#literal</a> "a relative URL, which is relative to the Service Base URL, or, if processing a resource from a bundle, which is relative to the base URL implied by the Bundle.entry.fullUrl (see Resolving References in Bundles)". I don't see, in your example, how you can use relative reference without resource type.</p>



<a name="217164370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217164370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Arnold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217164370">(Nov 18 2020 at 16:59)</a>:</h4>
<p>Consider this scenario. I create a resource "Patient/abc" and then "CareTeam/ct1" which includes a participant reference = "abc". This places "CareTeam/ct1" in the compartment of "Patient/abc".</p>
<p>Now let's add a new resource "RelatedPerson/abc" which has nothing to do with the above resources, other than it happens to share the same literal id. This is valid, because ids are only unique within a resource type. However, this causes our resource "CareTeam/ct1" to be included in the compartment of this new resource (based on participant reference = "abc" and according to the compartment definition for CareTeam).</p>



<a name="217169098"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217169098" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217169098">(Nov 18 2020 at 17:31)</a>:</h4>
<p>Here is problem. According to the spec, the relative url is based on "<strong>Service Base URL</strong>" (see the link in my previous post). So unless your patient can be accessed by [base]/abc, reference = abc is not correct.</p>



<a name="217171468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217171468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Arnold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217171468">(Nov 18 2020 at 17:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191506">@Yunwei Wang</span> this is ideally what I'd like to have confirmed. I suspect I'm missing something implied by  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> in his earlier post: "It's technically possible to put just a base string in the reference: "patient" : { "reference" : "8cdf70c5-a3d0-4910-935d-d59594079647"} }".</p>



<a name="217172969"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217172969" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217172969">(Nov 18 2020 at 17:59)</a>:</h4>
<p>My take on what Grahame said is that the spec allows that case, but unless <strong>your implementation</strong> serves up a resource at [base]/123, you are free to reject "reference":"123" because it can't refer to anything on your server.</p>



<a name="217173598"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217173598" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Arnold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217173598">(Nov 18 2020 at 18:04)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="197072">@Paul Church</span> very reasonable.</p>



<a name="217173811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Resource%20ambiguity%20with%20Literal%20References/near/217173811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Resource.20ambiguity.20with.20Literal.20References.html#217173811">(Nov 18 2020 at 18:06)</a>:</h4>
<p>Yes. That is my understanding too. If your server does serve Patient/123 at [base]/123, there is no problem for refernece = 123. But then you cannot claim that [base]/123 also serve as endpoint for RelatedPersion/123. The url serves one resource only.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
