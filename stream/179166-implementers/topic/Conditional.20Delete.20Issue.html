---
layout: page
title: "FHIR Chat  · Conditional Delete Issue · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html">Conditional Delete Issue</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153840420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840420">(Jul 21 2016 at 23:30)</a>:</h4>
<p>Query about <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=8779" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=8779">GF#8779</a>. The resolution this task proposes means that there will no longer be any way to find out whether you deleted something when you delete it </p>



<a name="153840421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840421">(Jul 21 2016 at 23:31)</a>:</h4>
<p>given the ferocity with which some implementers claimed that they needed to be able to do that, taking it away makes me nervous </p>



<a name="153840422"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840422" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840422">(Jul 21 2016 at 23:31)</a>:</h4>
<p>the ask dispostion says "Since this is a breaking change we will consult the community about this change." - well, I can't see that this happened anytime, so here you are... the community is being consulted</p>



<a name="153840475"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840475" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Royce <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840475">(Jul 22 2016 at 01:57)</a>:</h4>
<p>I'm not familiar with the issue so this may be off-beam, but shouldn't there be an AuditEvent?  If there was, then you know that the thing had been deleted.</p>



<a name="153840480"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840480" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840480">(Jul 22 2016 at 02:19)</a>:</h4>
<p>The client doesn't necessarily have access to the audit log, nor do they want to query it to determine if their operation succeeded or not</p>



<a name="153840488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Royce <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840488">(Jul 22 2016 at 03:10)</a>:</h4>
<p>I'm unclear why the client would need to query the audit log to determine that.  The client should simply ask the server "Did my operation succeed?" and the server would use whatever means necessary, presumably including querying the audit log, to answer the question.</p>



<a name="153840492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840492">(Jul 22 2016 at 03:21)</a>:</h4>
<p>how does the client ask that? how do they refer to an operation when they ask that?</p>



<a name="153840496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Royce <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840496">(Jul 22 2016 at 03:28)</a>:</h4>
<p>I don't know; <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> was the one who said they need to determine if the operation was successful or not.  If you need to know that, then you need to have a mechanism to ask the server if it was, not try to figure it out on your own.</p>



<a name="153840498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840498">(Jul 22 2016 at 03:29)</a>:</h4>
<p>right now, the server just tells you directly. That's being proposed to be removed</p>



<a name="153840501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Royce <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840501">(Jul 22 2016 at 03:33)</a>:</h4>
<p>Then I would suggest you either do not do that or you provide a query operation that the client can use to ask about the operation after the fact; I definitely would not rely on clients being able to determine for themselves if an operation was successful or not.</p>



<a name="153840517"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840517" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840517">(Jul 22 2016 at 05:12)</a>:</h4>
<p>I'll take that as a vote that you think that a client needs to be able to know </p>



<a name="153840521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Royce <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840521">(Jul 22 2016 at 05:20)</a>:</h4>
<p>Not necessarily.  I don't really have enough experience with this to vote one way or another; I'm just saying the <strong>_if_</strong> you want the client to know, don't make them work it out for themselves.  Having said that, I find it hard to imagine that a 200 response would not be enough acknowledgement of success, but I'm not working with complex transactions.</p>



<a name="153840524"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840524" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Royce <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840524">(Jul 22 2016 at 05:29)</a>:</h4>
<p>Okay; so I just actually read the issue again, and I agree that the client does need to be able to know and that returning a 404 response is not really a good idea.  To my way of thinking, successfully deleting no records is still a success and it's more important to know that there was no failure than that there were no records deleted.  Of course, the response could contain a deletion count, but not sure how that might affect the specification.</p>



<a name="153840525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Royce <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840525">(Jul 22 2016 at 05:30)</a>:</h4>
<p>So I support the resolution.</p>



<a name="153840552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840552">(Jul 22 2016 at 13:07)</a>:</h4>
<p>After reviewing the tracker item for this, I see that the resolution is to simply modify the returned response code in the specific case of a conditonal delete operation not matching any resources to now return a 204 (No Content) instead of the 404 (Not Found). This change provides consistent behavior with the delete operation when the resource to be deleted does not exist at all.</p>



<a name="153840553"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840553" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840553">(Jul 22 2016 at 13:07)</a>:</h4>
<p>So, I also support the resolution.</p>



<a name="153840758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153840758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153840758">(Jul 24 2016 at 07:32)</a>:</h4>
<p>ok, made the change</p>



<a name="153857970"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153857970" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Angus Millar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153857970">(Nov 21 2016 at 12:04)</a>:</h4>
<p>I just implemented Conditional delete alowing for the delete all the matching resources. But then I thought about the consequences of this operation and it got me worried. If a client sends delete operation such as <code>DELETE [base]/Patient</code> then all patient records will be deleted, sounds dangerous, it's only a slip away from GET all Patient resource. And even worse if some sends an incorrect search parameter i.e <code>DELETE [base]/Patient?identiphier=http://acme.org/patient|23</code> then the unknown search parameter will be ignored and once again all Patient resource deleted.<br>
In light of this, I want to implement conditional delete whereby zero search parameters or any unknown search parameters returns 412 - Precondition Failed. Does this sound fair?</p>



<a name="153858006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153858006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153858006">(Nov 21 2016 at 19:52)</a>:</h4>
<p>yes</p>



<a name="153858046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153858046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Angus Millar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153858046">(Nov 21 2016 at 23:31)</a>:</h4>
<p>Thanks Grahame</p>



<a name="153858191"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153858191" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153858191">(Nov 23 2016 at 05:53)</a>:</h4>
<p>While we're on the conditional subject, the spec is quiet on what should happen if the resource instance PUT to the conditional update has an id in it (and clashes with the one that comes back from the call)<br>
Should I report a bad request (like I do when POST is used, or PUT without)</p>



<a name="153858194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153858194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153858194">(Nov 23 2016 at 05:57)</a>:</h4>
<p>that's changed; we should provide guidance, and it should be cosistent (ignore and overwrite)</p>



<a name="153858196"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153858196" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153858196">(Nov 23 2016 at 05:59)</a>:</h4>
<p>So ignore rather than fail (like we do with a POST that has the Id inside)</p>



<a name="153858199"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153858199" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153858199">(Nov 23 2016 at 06:00)</a>:</h4>
<p>And with the delete, the spec is pretty clear that if your server only wants to permit single record conditional deletes, that's perfectly normal.</p>



<a name="153858206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153858206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Angus Millar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153858206">(Nov 23 2016 at 07:16)</a>:</h4>
<p>(from the FHIR spec) Update PUT:<br>
The request body SHALL be a Resource with an id element that has an identical value to the [id] in the URL. If no id element is provided, or the value is wrong, the server SHALL respond with a HTTP 400 error code, and SHOULD provide an operation outcome identifying the issue.</p>
<p>(from the FHIR spec) Create POST:<br>
The request body SHALL be a FHIR Resource. The resource does not need to have an id element (this is the one of the few case where a resource exists without an id element). If an id is provided, the server SHALL ignore it.</p>
<p>Condition Update PUT:<br>
So when the resource does have and id and it does not match the located resource's id (located by search) we are in a 50/50 decision. Do we behave like a Create or like an Update. Create would ignore the id whereas Update would reject it. I would argue that a Condition Update should behave live an Update. A normal Create can ignore the id as there is no conflicting id's, yet Condition Update can detect the conflict in ids and should report it, not ignore it.</p>



<a name="153862645"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153862645" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153862645">(Dec 09 2016 at 05:35)</a>:</h4>
<p>+1 <span class="user-mention" data-user-id="191391">@Angus Millar</span> Update (conditional or otherwise) needs to be more conservative than Create</p>



<a name="153862765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Delete%20Issue/near/153862765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Delete.20Issue.html#153862765">(Dec 09 2016 at 18:54)</a>:</h4>
<p>This is how HAPI's server works by default FYI</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
