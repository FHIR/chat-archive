---
layout: page
title: "FHIR Chat  · Constraints / rule sets on SearchParameter · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html">Constraints / rule sets on SearchParameter</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="166986491"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/166986491" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kenneth Myhra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#166986491">(May 31 2019 at 10:47)</a>:</h4>
<p>I am looking into the SearchParameter 'composition' on Bundle  and it has a constraint that that is only expressed textually: <em>The first resource in the bundle, if the bundle type is "document" - this is a composition, and this parameter provides access to search its contents</em>.</p>
<p>As far as I see it should be trivial to express this as a constraint on the SearchParameter using i.e. FhirPath. For me it would make sense to use this constraint primarily when indexing the resource.<br>
So I am wondering if there has been a discussion to add such a constraint attribute to the SearchParameter resource or if I am overlooking something in the specification that would enable this?</p>



<a name="167163607"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167163607" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kenneth Myhra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167163607">(Jun 03 2019 at 07:46)</a>:</h4>
<p>GForge <a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=22653" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=22653">#22653</a></p>



<a name="167206039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167206039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167206039">(Jun 03 2019 at 16:17)</a>:</h4>
<p>I've been looking at Bundle-composition and Bundle-message in detail recently - they're quite unusual search parameters. They are the only place I can find where an explicit array index appears as part of a search param (in the base spec), they specifically index contained resources, and their definitions depend on the bundle type and express very specific requirements/assumptions about what the bundle type implies.</p>
<p>If the spec had richer support for this case, would it be used in more places? If not, would a more simple spec be better with these unusual cases relaxed to something like "composition: searches the contents of any Composition in the bundle"?</p>



<a name="167208735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167208735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167208735">(Jun 03 2019 at 16:45)</a>:</h4>
<p>We don't want any composition inside the Bundle.  The first Composition in a document Bundle has special meaning.  It represents the metadata for "This" document.  Any other Compositions would be content of the document but wouldn't describe the document.</p>



<a name="167209027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167209027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167209027">(Jun 03 2019 at 16:48)</a>:</h4>
<p>The only places where the first resource has special meaning are for documents and messages.  It's certainly possible we could come up with another usecase in the future, but we don't have any specific plans as yet</p>



<a name="167222418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167222418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Geimer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167222418">(Jun 03 2019 at 19:22)</a>:</h4>
<p>Discussed on FHIR-I today, but decided we need more input from server vendors.</p>



<a name="167224429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167224429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kenneth Myhra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167224429">(Jun 03 2019 at 19:47)</a>:</h4>
<p>Example of a SearchParameter with the attribute 'constraint' added:</p>
<div class="codehilite"><pre><span></span>{
    &quot;resourceType&quot;: &quot;SearchParameter&quot;,
    &quot;id&quot;: &quot;Bundle-composition&quot;,
    &quot;name&quot;: &quot;composition&quot;,
    &quot;code&quot;: &quot;composition&quot;,
    &quot;base&quot;: [
        &quot;Bundle&quot;
    ],

    // Proposing to add this attribute
    &quot;constraint&quot;: &quot;Bundle.type = &#39;document&#39; and Bundle.entry[0].resource.resourceType = &#39;Composition&#39;&quot;,

    &quot;type&quot;: &quot;reference&quot;,
    &quot;expression&quot;: &quot;Bundle.entry[0].resource&quot;,
    &quot;xpath&quot;: &quot;f:Bundle/f:entry[0]/f:resource&quot;,
    &quot;xpathUsage&quot;: &quot;normal&quot;,
    &quot;target&quot;: [
        &quot;Composition&quot;
    ],
    &quot;multipleOr&quot;: true,
    &quot;multipleAnd&quot;: true,
    &quot;modifier&quot;: [
        &quot;missing&quot;,
        &quot;type&quot;,
        &quot;identifier&quot;
    ]
}
</pre></div>



<a name="167224590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167224590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167224590">(Jun 03 2019 at 19:49)</a>:</h4>
<p>Is the evaluation of the constraint essential to the document/message use case? If Bundle-composition searched any bundle whose entry[0].resource was a Composition, the client could add &amp;type=document to their query.</p>
<p>If constraints are needed, then I agree they should be explicit and encoded as fhirpath to be evaluated by the server.</p>
<p>I'm not convinced that constraints are a good idea, based on the balance of complexity vs. usefulness. Arbitrary fhirpath constraints are very broad and would be a big door to open just to support this. Are there more use cases than just Bundle, or use cases where the constraint is not something trivially expressed with an extra search term like &amp;type=document?</p>



<a name="167227250"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167227250" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167227250">(Jun 03 2019 at 20:18)</a>:</h4>
<p>In theory we could have squished both parameters into one - at the expense of everyone using the new search parameter always needing to filter on Bundle type.  However, Bundle is now normative, so we're past the point where we can debate whether that would be a good idea or not.</p>



<a name="167232477"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167232477" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kenneth Myhra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167232477">(Jun 03 2019 at 21:10)</a>:</h4>
<p>To be able to evaluate the SearchParameter in the document/message use case the constraint is very much needed from my point of view. So, although we could use the target attribute to infer what types are allowed in <code>entry[0].resource</code>, there is no way to express <code>type=document</code> or <code>type=message</code> without the constraint attribute. There is also the option of modifying the expression in the <code>expression</code> attribute to use an <code>iif</code>, but that would probably break current implementations.</p>



<a name="167776020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167776020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> okyere sharaf deen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167776020">(Jun 10 2019 at 17:00)</a>:</h4>
<p>hello, please i am new to fhir, i am a developer, our team would like to implement fhir in our health application, can someone please help me with the step my step procedure of how to comply with hl7 fhir, i have read so many documents and cant make any sense of it. please help if you can</p>



<a name="167778240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167778240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167778240">(Jun 10 2019 at 17:29)</a>:</h4>
<p>there's no real general introduction because the kind of problems you might encounter vary so wildly. Do you have a relational database? what platform is the application in?</p>



<a name="167780488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Constraints%20/%20rule%20sets%20on%20SearchParameter/near/167780488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Constraints.20.2F.20rule.20sets.20on.20SearchParameter.html#167780488">(Jun 10 2019 at 17:56)</a>:</h4>
<p>Complying with FHIR can be done in a wide variety of ways.  Do you know who you want to operate with and in what context?  There are often additional implementation guides that provide further expectations in different countries and for different use cases.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
