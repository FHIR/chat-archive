---
layout: page
title: "FHIR Chat  · Conditional Reference · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html">Conditional Reference</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153820103"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820103" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820103">(Apr 07 2016 at 01:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191450">@Simone Heckmann</span> Looking at the proposed connectathon track for conditional references.  This is a HUGE need - thank you for taking it on!</p>



<a name="153820104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820104">(Apr 07 2016 at 01:04)</a>:</h4>
<p>I have a question about scenario step 3 - what if the client knows that the referenced item will arrive out of order?  There are times, esp. in emergent scenarios, where registration data may lag the order feed for instance.  We would like to be able to save the order, retaining the conditional linkage until the referenced data arrives.</p>



<a name="153820105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820105">(Apr 07 2016 at 01:05)</a>:</h4>
<p>However, this:  a) causes the server to have to re-check for the conditional linkage later, and b) introduces the possibility of undetectable (to the client) mis-matches.</p>



<a name="153820106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820106">(Apr 07 2016 at 01:07)</a>:</h4>
<p>Right now, we're using contained resources to handle this scenario - we create a contained resource with only what we know about the referenced resource.  The server then (preferably on write, but possibly on read for late arriving) resolves the match.  If the match can't be resolved, the contained resource remains and the reference remains internal.</p>



<a name="153820107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820107">(Apr 07 2016 at 01:08)</a>:</h4>
<p>Does anyone see pros/cons to either approach?  (as described vs. <a href="http://wiki.hl7.org/index.php?title=201605_Conditional_Reference_Connectathon_Proposal" target="_blank" title="http://wiki.hl7.org/index.php?title=201605_Conditional_Reference_Connectathon_Proposal">http://wiki.hl7.org/index.php?title=201605_Conditional_Reference_Connectathon_Proposal</a>)</p>



<a name="153820108"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820108" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820108">(Apr 07 2016 at 01:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191328">@Ewout Kramer</span> <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <span class="user-mention" data-user-id="191315">@Josh Mandel</span> ??</p>



<a name="153820109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820109">(Apr 07 2016 at 01:18)</a>:</h4>
<p>Talking to myself a bit...contained allows the server more latitude to create a meaningful resource (conditional create) if that fits the server's use case better (contained could contain some arbitrarily large amount of data about the referenced resource).  However, there would need to be some directive by the client that the intent is to match/convert the contained resource. </p>



<a name="153820110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820110">(Apr 07 2016 at 01:19)</a>:</h4>
<p>Conditional reference is more explicit and could still serve the late-arriving use case if the conditional reference was allowed to remain in the resource after POST/PUT.</p>



<a name="153820112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820112">(Apr 07 2016 at 03:56)</a>:</h4>
<p>Technically if the inbound instance has a contained resource, the server would have to do an "update" such that the original version (with any signature) was retained.  I'm not a fan of storing a conditional reference.</p>



<a name="153820156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820156">(Apr 07 2016 at 09:17)</a>:</h4>
<p>What you could do is to pack both the referencing and the referenced resource into a transaction, using temp uuids to point from the referencing to the referenced resource. </p>



<a name="153820157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820157">(Apr 07 2016 at 09:18)</a>:</h4>
<p>The server sill then replace the temporal ID with the actual ID ans update the reference</p>



<a name="153820158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820158">(Apr 07 2016 at 09:19)</a>:</h4>
<p>If - at th point of submission - you have no information about the referenced resource, you can submit whatever you have (at least the business identifier) as a conditional create.</p>



<a name="153820159"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820159" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820159">(Apr 07 2016 at 09:21)</a>:</h4>
<p>That way, the server sill create your resource, if it doesn't exist or pick an already existing resource with the same identifier and reference to that resource instead without updating it. (Provided, your condition is the matching of the business identifier)</p>



<a name="153820160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820160">(Apr 07 2016 at 09:22)</a>:</h4>
<p>Once the actual data arrives, you can update the resource by using a conditional update. (Once again by matching the identifier)</p>



<a name="153820162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820162">(Apr 07 2016 at 09:24)</a>:</h4>
<p>This way you can have a unidirectional data stream to the server without ever having to query for IDs (which is pretty much what sending V2 streams to a fhir server is all about)</p>



<a name="153820163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820163">(Apr 07 2016 at 09:24)</a>:</h4>
<p>I think the conditional reference is only a good choice if you can savely assume that the referenced resource already exists on the target server.</p>



<a name="153820165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820165">(Apr 07 2016 at 09:34)</a>:</h4>
<p>e.g. every Hospital in a region/country is commonly known by a unique national identifier. In this scenario I could simply always reference to a Organisation with that identifier, without having to look up the different IDs of the different servers you're talking to. In such scenarios, you'd explicitly WANT your submission to fail, because a no match by identifier means that the referenced hospital is not participating in your network.</p>



<a name="153820167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820167">(Apr 07 2016 at 09:38)</a>:</h4>
<p>or: you have some sort of automated workflow where a barcode  sticker (case number) is read from a sample, a test is performed and the result is transmitted back to the HIS. In that scenario you have a strong reason to belive that the case number is known to the HIS because it printed the barcode sticker in the first place.</p>



<a name="153820175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820175">(Apr 07 2016 at 10:06)</a>:</h4>
<p>I like the idea. I currently use contained resources to just pass around the ESB/Hospital indentifiers and so in most cases they just contain identifier.system and identifier.value. I don't use the contained resources to create resources (within the hospital/ESB). It's a bit tedious to build and process. If a shorthand reference was available I would just use that.</p>



<a name="153820184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820184">(Apr 07 2016 at 12:09)</a>:</h4>
<p>+1 to Simone's recommendation</p>



<a name="153820187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820187">(Apr 07 2016 at 13:15)</a>:</h4>
<p>FYI: James has that already implemented conditional references in HAPI. </p>



<a name="153820188"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820188" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820188">(Apr 07 2016 at 13:16)</a>:</h4>
<p>The Transaction/Conditional Update/Conditional Create- Workflow I described above has been successfully tested at the Connectathon in Atlanta.</p>



<a name="153820189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820189">(Apr 07 2016 at 13:16)</a>:</h4>
<p>Not sure about the other servers, though.</p>



<a name="153820190"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820190" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820190">(Apr 07 2016 at 14:09)</a>:</h4>
<p>I actually like the conditional reference - it's simple.  But take a moment to read the description of contained resources (and references to them): <a href="https://www.hl7.org/fhir/references.html#contained" target="_blank" title="https://www.hl7.org/fhir/references.html#contained">https://www.hl7.org/fhir/references.html#contained</a>  They exist for a flavor of this scenario - a client knows only a little about the referenced resource, so it creates a contained.  The intent (usually) is *not* that the contained remain forever, but rather that the correct match and reference be made.  Contained is a concession to the reality of imperfect information.</p>



<a name="153820192"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820192" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820192">(Apr 07 2016 at 14:12)</a>:</h4>
<p>The description of contained would lead me to believe that we should be defining some directives on what a server should do with these things - not defining matching logic necessarily, but at least a way for the client to say "please try and match this partial data to something you know about".</p>



<a name="153820193"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820193" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820193">(Apr 07 2016 at 14:15)</a>:</h4>
<p><span class="user-mention" data-user-id="191450">@Simone Heckmann</span> A conditional create would be fine IF the server's profile/logic allows. It's certainly plausible though that a Patient record with only an identifier would be considered inadequate to create a resource (as the contained explanation relays).</p>



<a name="153820221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820221">(Apr 07 2016 at 14:29)</a>:</h4>
<p>It may be a situation where both (all 3?) approaches are appropriate as long as there is a clear explanation of the utility and appropriateness of each.</p>



<a name="153820328"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820328" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820328">(Apr 07 2016 at 18:11)</a>:</h4>
<p>Contained resources generally would not mean that the server can turn them into non-contained references.  Doing so would certainly break signatures, so it would need to be treated as an update that still retained the existence of the original version if signatures were at all important.</p>



<a name="153820331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820331">(Apr 07 2016 at 18:31)</a>:</h4>
<p>Lloyd - agree that the conversion would be an update, but it seems to me that this should be able to be requested by the client, especially in the messaging world.  I can't think of a scenario that would prefer a partial contained to a real reference. The contained could even be retained for posterity, but the local references should be updated if desired.</p>



<a name="153820332"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820332" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820332">(Apr 07 2016 at 18:31)</a>:</h4>
<p>Also, the signature of a resource with a conditional reference converted to a "real" reference would also be altered.</p>



<a name="153820395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820395">(Apr 07 2016 at 21:04)</a>:</h4>
<p>I don't think you can assume a server will ever do post-processing.  So a conditional create followed by a subsequent conditional create or conditional update is what would best give the client control over what's going on.</p>



<a name="153820396"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820396" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820396">(Apr 07 2016 at 21:05)</a>:</h4>
<p>Isn't resolving a conditional reference "post-processsing" - a subsequent GET will not return what was just PUT.</p>



<a name="153820398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820398">(Apr 07 2016 at 21:07)</a>:</h4>
<p>Resolving a conditional reference is post processing that's done at the time of the create/update.  If it fails, the create/update fails.  I'm talking about deferred post-processing (as would be required for a system to update a resource with a "contained" resource to instead point to a non-contained resource.</p>



<a name="153820402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820402">(Apr 07 2016 at 21:12)</a>:</h4>
<p>The contained could be resolved at write time or (if matching fails) retained as-is as a matter of standard operation.  Matching/resolution after that point would be a server-specific choice.</p>



<a name="153820411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820411">(Apr 07 2016 at 21:47)</a>:</h4>
<p>I'm not thrilled with it being retained as-is, nor with any implicit assumption that servers "should" be responsible for making such updates.  If we're doing REST, I think it's cleaner for things to be client-driven</p>



<a name="153820412"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820412" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820412">(Apr 07 2016 at 21:48)</a>:</h4>
<p>Isn't that the current operation of contained resources?  I don't know enough to create a resource, so I'll put in whatever I have.  If that's not enough to match, it would be natural to leave it alone, no?</p>



<a name="153820414"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820414" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820414">(Apr 07 2016 at 21:50)</a>:</h4>
<p>Any "post-processing" would be up to the implementer.  You're right that a ReST client shouldn't assume.</p>



<a name="153820415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820415">(Apr 07 2016 at 21:50)</a>:</h4>
<p>Including assuming that other actors (e.g. a post-processor) won't act on a resource after their operation is complete.</p>



<a name="153820419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820419">(Apr 07 2016 at 22:00)</a>:</h4>
<p>When you create a contained resource, you expect it to remain contained until/unless a client updates it.  Which means the client has to remember to update it (which is unlikely).</p>



<a name="153820421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820421">(Apr 07 2016 at 22:02)</a>:</h4>
<p>I disagree.  There's nothing that would prevent the server from implementing (according to its own needs) a process for this, effectively acting as an internal "re-indexing" client.  I agree that the standard shouldn't mandate this - it should define only what happens during the client interaction.</p>



<a name="153820423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820423">(Apr 07 2016 at 22:02)</a>:</h4>
<p>A client should not assume that it's the only client.</p>



<a name="153820458"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820458" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820458">(Apr 08 2016 at 11:47)</a>:</h4>
<p>@Kevin: We have the same situation in the financtial domain where the identifier for a think is known but the id of a content model (resource) is not - so were also createing contained resources sometimes only to contain the identifier. We have recently change those elements for which this is the case from resouce(x) to Identifier|resource(x) - see CLaim and the examples SOA Dental Claim, which uses contained resources, and SOA Dental Claim with identifiers which doesn't. </p>



<a name="153820460"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820460" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820460">(Apr 08 2016 at 12:18)</a>:</h4>
<p>Do you have a url for those examples? I'm wondering if contained resources has too much coupling  for the client. National identifiers (UK NHS Number or even EU EHIC Card number) is enough information to reference a patient resource and exchange information. Thinking of an Observation app which for example conforms to a pan EU Observation profile, it's unlikely to support all the Patient profiles in the EU - identifiers yes. It should be the servers job to get the Patient (with the correct profile) if it needs to, in many cases the server will own the master Patient resource.</p>



<a name="153820541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820541">(Apr 09 2016 at 07:42)</a>:</h4>
<p>Looking at the proposal I've seen references such as &lt;reference value="Patient?identifier=9876512345"/&gt; would references such as &lt;reference value="Patient?identifier=urn:fhir.nhs.uk:id/NHSNumber|9876512345"/&gt; work? i.e. also include the system</p>



<a name="153820542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820542">(Apr 09 2016 at 07:49)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> I notice this is already supported in HAPI, is that 1.4? I have some code which shows the number of lookups we're doing when posting a DocumentReference - it would really speed up the processing if it does (6 calls downto 2). Apache Camel route is here <a href="https://github.com/KevinMayfield/Jorvik/blob/master/UKFHIR-HAPI/src/main/java/uk/co/mayfieldis/camelRoute/UKFhirAPI/UKFHIRCamelRoute.java" target="_blank" title="https://github.com/KevinMayfield/Jorvik/blob/master/UKFHIR-HAPI/src/main/java/uk/co/mayfieldis/camelRoute/UKFhirAPI/UKFHIRCamelRoute.java">https://github.com/KevinMayfield/Jorvik/blob/master/UKFHIR-HAPI/src/main/java/uk/co/mayfieldis/camelRoute/UKFhirAPI/UKFHIRCamelRoute.java</a></p>



<a name="153820583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820583">(Apr 10 2016 at 16:54)</a>:</h4>
<p>As much as I dislike "contained" resources, one nice thing about that approach is that it avoids the potential to create invalid references on the server -- e.g. if a client sends data with a "conditional reference" and the server doesn't know how to process this, and so the client's submission just lands directly in the server's database. You'd wind up seeing data with references like:</p>
<div class="codehilite"><pre>&lt;reference value=&quot;Patient?identifier=123&quot;/&gt;
</pre></div>


<p>Since a reference is just a string, this is pretty likely in some server designs. And following the reference would resolve a bundle instead of a resource, which would be surprising/unpleasant for clients.</p>



<a name="153820586"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820586" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820586">(Apr 10 2016 at 18:40)</a>:</h4>
<p>@Kevin: In FM resources to support situations such as national patient identifiers, national practitioner identifiers etc we put in the choice of a resource reference or an identifier so you could have patient system = "<a href="http://nationalsystem.com/patientidetifier" target="_blank" title="http://nationalsystem.com/patientidetifier">http://nationalsystem.com/patientidetifier</a>" value = "AB123456". We are starting to hear pushback that we should instead create a separate resource, included the reference to that and either make you come read that resource too or we can include the original resource and all of the other created resource instances in a larger structure (bundle, message, document, etc). Not very efficient, nor usefull especially when you aren't giveing the end party a patient to add or update on their system, we are just tryin to say 'it's patient/provider/whatever number 12345'. Doable but is the pain worth the gain?</p>
<p>The NHS or EHIC card number is an identifier not a <a href="http://resource.id" target="_blank" title="http://resource.id">resource.id</a> and FM has been trying to discourage confusing them and avoiding unnecessary overhead. All the providers who service that patient would give you completely different resource.ids to locally created resources which contain the same identifier. It seemed to us to be more efficient as you indicated to just give the identifier as that is what you need to know.</p>
<p>We were trying to be explicit by allowing one to declare and provide the identifier. If that's not allowed the above seems more obscure but still closer to the same efficientcy, my example could be: &lt;reference value=Patient?identifier?=http://nationalsystem.com/patientidentifier|AB123456"/&gt;.</p>



<a name="153820589"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820589" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820589">(Apr 10 2016 at 20:31)</a>:</h4>
<p>The intention with the reference approach would be that the submission would fail unless the reference could be resolved to an existing resource though.</p>



<a name="153820610"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820610" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820610">(Apr 11 2016 at 04:44)</a>:</h4>
<p>catching up on this thread: contained resources were created for the case where you don't have enough information to identify the resource. Which is the exact opposite of when you have an identifier that can be resolved. So contained resources are a different problem to the one being discussed here</p>



<a name="153820816"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820816" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820816">(Apr 11 2016 at 17:43)</a>:</h4>
<p>Ok then the pattern which has emerged is that if you can uniquely identify the thing you should create a resource and reference that not create a contained resource. <br>
So that would eliminate having bodySite as a choice of the code and the resource as the code would uniquely identify the resource.</p>



<a name="153820827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820827">(Apr 11 2016 at 18:14)</a>:</h4>
<p>where do we have bodysite as a choice of code and resource?</p>



<a name="153820828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820828">(Apr 11 2016 at 18:17)</a>:</h4>
<p>We do in claim but I got that from somewhere else, we just need the code, - I'll look.</p>



<a name="153820829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Stechishin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820829">(Apr 11 2016 at 18:18)</a>:</h4>
<p>Observation uses bodySite[x] codeableConcept|Reference(BodySite)</p>



<a name="153820830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820830">(Apr 11 2016 at 18:26)</a>:</h4>
<p>not in DSTU 2 or the current version</p>



<a name="153820831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820831">(Apr 11 2016 at 18:39)</a>:</h4>
<p>DeviceuseRequest, DeviceUseStatement, MedicationAdministration for a start  and MedicationAdministration uses the same pattern to Medication in current build.</p>



<a name="153820832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820832">(Apr 11 2016 at 18:43)</a>:</h4>
<p>ok tahnks</p>



<a name="153820851"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820851" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820851">(Apr 11 2016 at 19:43)</a>:</h4>
<p>I think those have open trackers to change or should have them</p>



<a name="153820852"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820852" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820852">(Apr 11 2016 at 19:46)</a>:</h4>
<p>And Careplan and Procedure and SupplyRequest use the same pattern too.</p>



<a name="153820854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820854">(Apr 11 2016 at 19:56)</a>:</h4>
<p>And Specimen and maybe ModuleDefinition.</p>



<a name="153820880"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820880" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820880">(Apr 11 2016 at 20:59)</a>:</h4>
<p><span class="user-mention" data-user-id="191430">@Paul Knapp</span>  not in dstu2 and current build all PC and OO resource only have codeableconcept for Bodysite</p>



<a name="153820962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820962">(Apr 12 2016 at 03:24)</a>:</h4>
<p>For BodySite, it was decided that the reference to the resource was extension space.  However, for referencing Medication, both codes and ability to point to a full-blown resource (for things like compounds) are both in the 80%.  Whether the code is sufficient to be "identifiable" varies - sometimes yes, sometimes no.</p>



<a name="153820993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820993">(Apr 12 2016 at 05:48)</a>:</h4>
<p><span class="user-mention" data-user-email="eric@w3.org">@Eric Prud'hommeaux</span>: Specimen appears to use the pattern in question just not for BodySite.</p>
<p><span class="user-mention" data-user-email="lloyd@lmckenzie.com">@Lloyd McKenzie</span>: Was anyone told it was extension space? By that do you mean that resources which use the code need to use an extension rather than a choice to use a reference? What medictions can you specifiy by code which you could not put in a Medication resource?</p>



<a name="153820995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820995">(Apr 12 2016 at 06:03)</a>:</h4>
<p>It's not that you can't specify them in a medication resource, it's just that many applications simply use a code, and the committee came to the conclusion that it was appropriate to allow either a code or a reference to a medication resource - and for many medication terminologies, we'll be defining formal equivalence between their codes and an equivalent medication resource.</p>



<a name="153820996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153820996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153820996">(Apr 12 2016 at 06:04)</a>:</h4>
<p>I don't know what you mean by 'told it was extension space' - the committees are presently making the determination of what is common or not</p>



<a name="153821239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153821239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153821239">(Apr 12 2016 at 14:14)</a>:</h4>
<p><span class="user-mention" data-user-id="194909">@Kevin Mayfield</span> Re Conditional reference in HAPI, it's only supported as of 1.5 and FYI it needs to be explicitly enabled in the JpaConfig since it's only an experiment for now. You can try it out with the current snapshots, and we'll be launching 1.5 this week most likely.</p>



<a name="153821250"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153821250" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153821250">(Apr 12 2016 at 15:13)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191319">@James Agnew</span> WIll take a look</p>



<a name="153821260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153821260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153821260">(Apr 12 2016 at 15:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191430">@Paul Knapp</span> The extension is defined in the extensions associated with the BodySite resource.  Not sure what you mean about "telling".  If implementers find they need something that isn't in core, the first thing they should do is look to see if there's a standard extension.  Some of the medications are "abstract" - e.g. "Aspirin" or might even just have a name (CodeableConcept.text) without a code at all.  In those cases, a stand-alone Medication couldn't be used, though a contained resource could be.  But it was decided that forcing a contained Medication when the use-case of having a bare code was super common (probably 70%+ of instances) was inappropriate.  In the case of Patient, the considerations are a bit different.  We don't have Compartments for Medication.  And querying for orders or other resources by Medication or joining resources in queries by Medication is quite uncommon, while querying and joining by Patient happens all the time.  So the considerations are different.  That doesn't mean we can't allow the pattern, but if the pattern gets used, it should be used everywhere and we need to think carefully about the additional ramifications.</p>



<a name="153821309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153821309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153821309">(Apr 12 2016 at 20:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> my concern with "conditional references" in POSTed resources is that suddenly it's not okay for a server to just persist a reference; it needs to <em>detect</em> when a reference may be conditional, and then behave appropriately. But previously we've said that a reference can be an arbitrary URL. We'd need to document expectations carefully.</p>



<a name="153821312"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153821312" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153821312">(Apr 12 2016 at 20:23)</a>:</h4>
<p>well, many servers already enforce that the references are valid. or index according to them (you pretty much have to do that). so merely making a server inspect references is not that radical. Agree that we'd have to be very clear about this though</p>



<a name="153821419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conditional%20Reference/near/153821419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conditional.20Reference.html#153821419">(Apr 13 2016 at 08:26)</a>:</h4>
<p>There's also the (still somewhat undecided) idea out there to only support conditional references in Transactions. In that case, the pure REST server could still behave as Josh described. In the Transation, the server has to inspect references anyway, since we already defined the expectation that the server must replace uuids. So nothing new here.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
