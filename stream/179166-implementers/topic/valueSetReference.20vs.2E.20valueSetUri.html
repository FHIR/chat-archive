---
layout: page
title: "FHIR Chat  · valueSetReference vs. valueSetUri · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html">valueSetReference vs. valueSetUri</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153835177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835177">(Jun 27 2016 at 20:35)</a>:</h4>
<p>Need some remedial instruction here... it's my understanding that in elementdefinition.binding:<br>
1. Using valueSetUri leads to resolution of the binding via the ValueSet.url field (<code>GET [base]/ValueSet?url=XXX</code>).<br>
2. Using valueSetReference leads to resolution using a FHIR read.  In the case of a relative URL, resolving locally.  In the case of an absolute URL, resolving by whatever means/policy the server has defined.</p>
<p>Since:<br>
a. Most servers will make some kind of local copy of the FHIR standard valuesets for performance and security.<br>
b. Reference absolute URLs don't actually resolve (<code>http://hl7.org/fhir/vs/use-context</code>).<br>
c. Canonical URLs exist, are stored, and are searchable.</p>
<p>Why don't the standard profiles use valueSetUri rather than valueSetReference?  In fact, why would *any* system not just use the canonical URL for conformance resources?</p>



<a name="153835179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835179">(Jun 27 2016 at 20:41)</a>:</h4>
<p>canonical URLs in the FHIR specfication resolve. The correct URL is <a href="http://hl7.org/fhir/ValueSet/use-context" target="_blank" title="http://hl7.org/fhir/ValueSet/use-context">http://hl7.org/fhir/ValueSet/use-context</a>. The only time they don't resolve  is when they are defined in the current build, and not yet published</p>



<a name="153835180"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835180" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835180">(Jun 27 2016 at 20:42)</a>:</h4>
<p>Why not just use the canonical URLs?</p>



<a name="153835182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835182">(Jun 27 2016 at 20:42)</a>:</h4>
<p>the important difference between valueSetUri and valueSetReference is that valueSetReference is defined to be an explicit reference to a value set resource, but valueSetUri may be a reference to something that is not an explicit value set </p>



<a name="153835183"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835183" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835183">(Jun 27 2016 at 20:43)</a>:</h4>
<p>I use canonical URLs in valueSetReference</p>



<a name="153835184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835184">(Jun 27 2016 at 20:43)</a>:</h4>
<p>Seems to be forcing some gymnastics when storing these locally - I have to do absolute &lt;-&gt; local conversion of the URLs using the same resource id to resolve locally....</p>



<a name="153835185"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835185" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835185">(Jun 27 2016 at 20:44)</a>:</h4>
<p>or implement some kind of alternate cache with the original URL intact.</p>



<a name="153835186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835186">(Jun 27 2016 at 20:45)</a>:</h4>
<p>It's taboo to search ValueSet.url to resolve valueSetReference, yes?</p>



<a name="153835187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835187">(Jun 27 2016 at 20:46)</a>:</h4>
<p>And a valueSetUri binding *should* try to resolve via ValueSet.url, yes?</p>



<a name="153835230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835230">(Jun 27 2016 at 22:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> is there any doco/examples on how CQL should play with these notions?</p>



<a name="153835231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835231">(Jun 27 2016 at 22:46)</a>:</h4>
<p><span class="user-mention" data-user-id="192001">@Erich Schulz</span> CQL provides declarations that allow you to reference value sets, but it is silent about how those identifiers resolve underneath. When using FHIR, the recommendation is to use the URI as the identifier for the value set (so valueSetUri in this context). That may resolve to an actual value set reference on your FHIR server, or it may just be a value set identifier that is passed to a terminology server. Or it may be mapped to an OID, or...</p>



<a name="153835238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835238">(Jun 27 2016 at 23:37)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> - this is bit of a key issue... a small remnant of the curly brace problem - is it being discussed anywhere?</p>



<a name="153835240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835240">(Jun 27 2016 at 23:41)</a>:</h4>
<p>I guess I specifically trying to figure out how to express notions such "has this code or any subtypes of this code"</p>



<a name="153835251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835251">(Jun 27 2016 at 23:54)</a>:</h4>
<p>Chris - I treat my local value set copies as a cache and look there for the value set reference by URL first before falling back to looking at the actual literal URL. I haven't found that forced, but perhaps I never thought of any other approach </p>



<a name="153835252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835252">(Jun 27 2016 at 23:55)</a>:</h4>
<p>it's not taboo to search by URL. but I don't try to do that for ValueSet.uri</p>



<a name="153835257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835257">(Jun 28 2016 at 00:24)</a>:</h4>
<p><span class="user-mention" data-user-id="192001">@Erich Schulz</span> yes, terminology references are an active topic in the various CQF forums. Basically, CQL supports valueset and codesystem membership with the _in_ operator. But we purposely excluded subsumption from the spec (too much possibility for variation of interpretation), but there's nothing that says you couldn't define a subsumption function for use in a particular context. And if you feel it's a necessity, submit a DSTU comment :)</p>



<a name="153835258"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835258" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835258">(Jun 28 2016 at 00:25)</a>:</h4>
<p>is there any reason why CQL shouldn't assume the existence of the FHIR terminology service, and map to it's operations directly?</p>



<a name="153835259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835259">(Jun 28 2016 at 00:27)</a>:</h4>
<p>this could work <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> - the goal is to enable authors of "shareable knowledge artifacts" to express knowledge and clinical logic in a standard, transparent manner</p>



<a name="153835260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835260">(Jun 28 2016 at 00:27)</a>:</h4>
<p>I'm working on that right now actually. It effectively does assume the existence of a terminology service (or equivalent functionality), the spec just considers that an implementation issue and doesn't specify any particular interface.</p>



<a name="153835261"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835261" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835261">(Jun 28 2016 at 00:27)</a>:</h4>
<p>that would work internationally and allow easy peer review and validation</p>



<a name="153835262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835262">(Jun 28 2016 at 00:27)</a>:</h4>
<p>I think that it should specify the FHIR terminology service, and bind to it. I believe that will work in the CDA context too </p>



<a name="153835263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835263">(Jun 28 2016 at 00:27)</a>:</h4>
<p>I'm working on an implementation-level interface that would support the terminology operations as exposed by FHIR.</p>



<a name="153835264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835264">(Jun 28 2016 at 00:29)</a>:</h4>
<p>And then a plugin that can call any FHIR terminology service with that interface.</p>



<a name="153835265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835265">(Jun 28 2016 at 00:29)</a>:</h4>
<p>i think it should simply refernece the snomed code...</p>



<a name="153835266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835266">(Jun 28 2016 at 00:29)</a>:</h4>
<p>that is the international standard right?</p>



<a name="153835268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835268">(Jun 28 2016 at 00:30)</a>:</h4>
<p>whatever server is providing the subsumption service should be immaterial?? right?</p>



<a name="153835269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835269">(Jun 28 2016 at 00:30)</a>:</h4>
<p>(or ICD or LOINC code as needed)</p>



<a name="153835270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835270">(Jun 28 2016 at 00:30)</a>:</h4>
<p>Well, it wouldn't reference any particular terminology, just the concept of a terminology service.</p>



<a name="153835271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835271">(Jun 28 2016 at 00:30)</a>:</h4>
<p>Right.</p>



<a name="153835273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835273">(Jun 28 2016 at 00:32)</a>:</h4>
<p>which server is providing the service should be immaterial, but the spec it's conforming to is very relevant</p>



<a name="153835274"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835274" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835274">(Jun 28 2016 at 00:45)</a>:</h4>
<p>sorry - i'm possibly missing some basic stuff...</p>



<a name="153835275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835275">(Jun 28 2016 at 00:45)</a>:</h4>
<p>(and on job so bit distracted, not unusually)</p>



<a name="153835277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835277">(Jun 28 2016 at 00:46)</a>:</h4>
<p>but how do specify a cql Retrieve which says "this code on one of its subtypes"</p>



<a name="153835279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835279">(Jun 28 2016 at 00:47)</a>:</h4>
<p>thankfully CQL takes care of all the more complex operations really really well</p>



<a name="153835281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835281">(Jun 28 2016 at 00:48)</a>:</h4>
<p>i'm just trying to join the dots... in a way that will be as simple and as standard as possible for CQL authors</p>



<a name="153835301"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835301" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835301">(Jun 28 2016 at 01:06)</a>:</h4>
<p>so <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> I think subsumption is critical</p>



<a name="153835302"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835302" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835302">(Jun 28 2016 at 01:06)</a>:</h4>
<p>i'll submit a comment I guess</p>



<a name="153835306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153835306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erich Schulz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153835306">(Jun 28 2016 at 01:08)</a>:</h4>
<p>in meantime I'd be open for guidance on how this should be expressed in a standardish way</p>



<a name="153836147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153836147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153836147">(Jul 02 2016 at 04:30)</a>:</h4>
<p>FWIW, I'm not comfortable resolving references outside the local server - could be anything at the end of that URL - it's a vector for using a FHIR server to launch a DDOS for example.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> do you whitelist domains or url patterns for external references?</p>



<a name="153836154"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153836154" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153836154">(Jul 02 2016 at 10:39)</a>:</h4>
<p>I ignore them. </p>



<a name="153836155"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153836155" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153836155">(Jul 02 2016 at 10:39)</a>:</h4>
<p>on the public servers </p>



<a name="153836169"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153836169" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153836169">(Jul 02 2016 at 16:21)</a>:</h4>
<p>Michael, very useful obseravation for "Operational" specifications. Not something a core specification can do much about except to point out that operaional concerns must be addressed. I would entertain adding an additional note to the securty.html page about this URL concern . Can you create a GF tracker with your recommended wording?</p>



<a name="153894438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894438">(Jun 19 2017 at 21:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191351">@Chris Grenz</span> Reading through this thread it seemed to morph away from the topic! I have a similar question: When creating a binding to a custom ValueSet from a profile, is it best practice to use ValueSetReference or ValueSetUri?.  I've taken the position that ValueSetUri is better as it supports registries exposing the lookup query that you describe (and assuming that the value is the canonical URL of the VS). It seems to me that using ValueSetReference means that the valueset must always be hosted at the indicated address as it's supposed to resolve.   </p>
<p>But reading Grahames comment, it looks as if best practice is to use the canonical url as the value of ValueSetReference, and if it does not resolve, then look for it in a registry (like simplifier)</p>
<p>Does that make sense?</p>



<a name="153894444"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894444" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894444">(Jun 19 2017 at 22:14)</a>:</h4>
<p>ValueSetReference means that you expect the specified URL to resolve to a FHIR value set (either directly or by looking up the canonical URL in a registry).  valueSetUri doesn't expect to resolve to a FHIR value set definition.  At least that's my understanding of the difference.</p>



<a name="153894447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894447">(Jun 19 2017 at 22:41)</a>:</h4>
<p>Ah - I didn't appreciate that the 'looking up in a registry' was an appropriate fallback if the reference didn't resolve as that's not how a normal resource reference works - does it?</p>



<a name="153894454"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894454" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894454">(Jun 19 2017 at 23:02)</a>:</h4>
<p>Process is a bit different for resources with canonical URLs.</p>



<a name="153894457"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894457" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894457">(Jun 20 2017 at 00:06)</a>:</h4>
<p>so any reference to a resource with a canonical URL (StructureDefinition, ValueSet, OperationDefinition etc operates in this way? </p>



<a name="153894458"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894458" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894458">(Jun 20 2017 at 00:08)</a>:</h4>
<p>in which respect?</p>



<a name="153894459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894459">(Jun 20 2017 at 00:13)</a>:</h4>
<p>I always thought that the canonical URI was done via the Uri, and not the reference.</p>



<a name="153894462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894462">(Jun 20 2017 at 00:18)</a>:</h4>
<p>in a binding?</p>



<a name="153894463"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894463" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894463">(Jun 20 2017 at 00:18)</a>:</h4>
<p>the canonical URL should be a reference not a URI</p>



<a name="153894468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894468">(Jun 20 2017 at 01:51)</a>:</h4>
<p>The question was how to support a registry. I thought that a resource reference MUST resolve to a FHIR resource, so if you are binding a coded item to a ValueSet using binding.ValueSetReference, then the VS had to exist at that location (whether or not the URL is canonical) - if it wasn't found there, then the call would fail to retrieve the VS. That's why I've been using the binding.ValueSetUri - to indicate that the binding was to a canonical URI that could be retrieved from a registry - using a call like [host]/ValueSet?url=xx (as Chris said at the beginning of this thread)</p>
<p>Lloyd is suggesting that you can still use binding.ValueSetReference, but if the call doesn't resolve to a VS, then you can look in your friendly registry for a VS with that URL value and use that...</p>



<a name="153894474"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894474" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894474">(Jun 20 2017 at 03:44)</a>:</h4>
<p>yes Lloyd is right. If you look in the standard, we use a URL where it implies a value set - e.g. some of the IETF rfcs</p>



<a name="153894742"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153894742" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153894742">(Jun 21 2017 at 14:17)</a>:</h4>
<p>So, again on the "remedial" theme ;) I could assume:<br>
1. A binding with valueSetUri is not technically enforceable and will not be validated except perhaps via "special logic".<br>
2. A binding with a relative URL will attempt to be resolved locally (or via a local/preferred terminology service) via a FHIR ReSTful GET.  E.g.: <code>GET http://my.fhir.server/ValueSet/ab123</code><br>
3. A binding with an absolute URL "<a href="http://x.com/some/uri" target="_blank" title="http://x.com/some/uri">http://x.com/some/uri</a>" will attempt resolution via:<br>
  a. Local/preferred terminology services via <code>GET http://my.fhir.server/ValueSet?url=http://x.com/some/uri</code><br>
  b. Trusted registry services via <code>GET http://my.trusted.repo/ValueSet?url=XX</code><br>
  c. If policy allows (probably not) by HTTP GET to the URL.  <code>GET http://x.com/some/uri</code></p>



<a name="153895088"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153895088" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153895088">(Jun 23 2017 at 14:29)</a>:</h4>
<p><span class="user-mention" data-user-id="191351">@Chris Grenz</span> In your use case, 3.a gets the actual valueset. But waht does 3.b return? I assume it returns a canonical URL for that valueset. Is that right?</p>



<a name="153895113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153895113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153895113">(Jun 23 2017 at 18:12)</a>:</h4>
<p>I would assume all would return the valueset</p>



<a name="153895129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/valueSetReference%20vs.%20valueSetUri/near/153895129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/valueSetReference.20vs.2E.20valueSetUri.html#153895129">(Jun 23 2017 at 20:17)</a>:</h4>
<p>Yes. All return the valueset.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
