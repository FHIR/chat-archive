---
layout: page
title: "FHIR Chat  · Transaction with PATCH request · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html">Transaction with PATCH request</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="193894324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/193894324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dimitar Dimitrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#193894324">(Apr 14 2020 at 13:14)</a>:</h4>
<p>Hello everyone. <br>
I am wondering which is the right format of a transaction with PATCH request in it. I tried with something like that:</p>
<p>{<br>
    "resourceType": "Bundle",<br>
    "type": "transaction",<br>
    "entry": [<br>
        {<br>
            "resource": [<br>
                {<br>
                    "op": "replace",<br>
                    "path": "/status",<br>
                    "value": "completed"<br>
                }<br>
            ],<br>
            "request": {<br>
                "method": "PATCH",<br>
                "url": "MedicationRequest/11"<br>
            }<br>
        },<br>
        {<br>
            "fullUrl": "urn:uuid:aa4abd42-985b-461a-b15d-c15c04f5e634",<br>
            "resource": {<br>
                "resourceType": "MedicationDispense",<br>
                "status": "completed",<br>
                "medicationReference": {<br>
                    "reference": "Medication/12",<br>
                    "display": "AUGMENTIN FILM COATED TABLETS 875/125MG 14"<br>
                },<br>
                "subject": {<br>
                    "reference": "Patient/13",<br>
                    "display": "ГЕОРГИ ДИМИТРОВ"<br>
                },<br>
                "receiver": {<br>
                    "display": "Димитър Димитров"<br>
                },<br>
                "quantity": {<br>
                    "value": "2",<br>
                    "unit": "опаковки"<br>
                },<br>
                "authorizingPrescription": {<br>
                    "reference": "MedicationRequest/11"<br>
                }<br>
            },<br>
            "request": {<br>
                "method": "POST"<br>
            }<br>
        }<br>
    ]<br>
}</p>
<p>But it seems that it is not the correct. I didn't found any example in the Internet so please help me with that.</p>
<p>Thanks in advance.</p>



<a name="193897496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/193897496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#193897496">(Apr 14 2020 at 13:37)</a>:</h4>
<p>See <a href="http://build.fhir.org/http.html#patch" title="http://build.fhir.org/http.html#patch">http://build.fhir.org/http.html#patch</a> , you'll need to PATCH a Parameters resource, see <a href="http://build.fhir.org/fhirpatch.html" title="http://build.fhir.org/fhirpatch.html">http://build.fhir.org/fhirpatch.html</a> for example.</p>



<a name="193923260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/193923260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dimitar Dimitrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#193923260">(Apr 14 2020 at 16:29)</a>:</h4>
<p>Actually  when I make a direct PATCH request everything is OK. In my case I am trying to put a PATCH request in a transaction bundle and execute it along with other request entries in single atomic transaction request. So as far as I saw I can use a PATCH value in the Bundle.request.method, but how I can specify the content of the PATCH request?</p>



<a name="193988397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/193988397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#193988397">(Apr 15 2020 at 06:17)</a>:</h4>
<p>A Parameters resource.</p>



<a name="194017809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194017809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194017809">(Apr 15 2020 at 11:56)</a>:</h4>
<p>If you want to use JSONPatch, you can also use a Binary resource as the container in the bundle:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;Bundle&quot;</span><span class="p">,</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transaction&quot;</span><span class="p">,</span>
  <span class="nt">&quot;entry&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;fullUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;Patient/1&quot;</span><span class="p">,</span>
      <span class="nt">&quot;resource&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;Binary&quot;</span><span class="p">,</span>
        <span class="nt">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json-patch+json&quot;</span><span class="p">,</span>
        <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;WyB7ICJvcCI6InJlcGxhY2UiLCAicGF0aCI6Ii9hY3RpdmUiLCAidmFsdWUiOmZhbHNlIH0gXQ==&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;request&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;Patient/1&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>



<a name="194357517"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194357517" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sreenivas Shenoy <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194357517">(Apr 16 2020 at 19:45)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191319">@James Agnew</span> . Isn't there any other way, I can set the patch body directly in the bundle? Directly as in [ { "op":"replace", "path":"/active", "value":false } ] and not the base 64 encoded format?</p>



<a name="194358164"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194358164" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194358164">(Apr 16 2020 at 19:51)</a>:</h4>
<p>No, you can't put a JSON Patch directly into the Bundle because that wouldn't be valid FHIR. The contents of a FHIR Bundle resource needs to be another resource.</p>



<a name="194358343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194358343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sreenivas Shenoy <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194358343">(Apr 16 2020 at 19:52)</a>:</h4>
<p>Thanks for the clarification.</p>



<a name="194388568"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194388568" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard Wu <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194388568">(Apr 17 2020 at 01:54)</a>:</h4>
<p>The HAPI test server send the request that the content type is json+fhir, and the console will show that "Content type 'application/json+fhir;charset=UTF-8' not supported", how to solvet it? Thank you.</p>



<a name="194389906"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194389906" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194389906">(Apr 17 2020 at 02:23)</a>:</h4>
<p>As per the spec (<a href="https://build.fhir.org/http.html#mime-type" title="https://build.fhir.org/http.html#mime-type">https://build.fhir.org/http.html#mime-type</a>), the required mime type is application/fhir+json.  application/json+fhir is not expected to be supported</p>



<a name="194637718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194637718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard Wu <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194637718">(Apr 20 2020 at 06:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request/near/194389906" title="#narrow/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request/near/194389906">said</a>:</p>
<blockquote>
<p>As per the spec (<a href="https://build.fhir.org/http.html#mime-type" title="https://build.fhir.org/http.html#mime-type">https://build.fhir.org/http.html#mime-type</a>), the required mime type is application/fhir+json.  application/json+fhir is not expected to be supported</p>
</blockquote>
<p>The HAPI test server send the request, and the format of request is application/json+fhir.</p>



<a name="194643500"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194643500" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194643500">(Apr 20 2020 at 08:03)</a>:</h4>
<p>This was the recommended mime type at some time in the past, but has long since modified to be fhir+json. HAPI may still support the old / non-recommended format for backwards compatibility reasons, but it should not be sending that mime type anymore, unless perhaps in responses if one used used json+fhir on ones own Accept: header.</p>



<a name="194645573"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194645573" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard Wu <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194645573">(Apr 20 2020 at 08:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191372">René Spronk</span> <a href="#narrow/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request/near/194643500" title="#narrow/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request/near/194643500">said</a>:</p>
<blockquote>
<p>This was the recommended mime type at some time in the past, but has long since modified to be fhir+json. HAPI may still support the old / non-recommended format for backwards compatibility reasons, but it should not be sending that mime type anymore, unless perhaps in responses if one used used json+fhir on ones own Accept: header.</p>
</blockquote>
<p>I make a subscription resource, when the HAPI test server always send me the application/json+fhir request, and i cannot support the format, and throw a exception in console. How to do the receive the application/json+fhir? And I set the consumes="application/json+fhir", it does not work.</p>



<a name="194655634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194655634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mirjam Baltus <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194655634">(Apr 20 2020 at 10:14)</a>:</h4>
<p><span class="user-mention" data-user-id="285899">@Wizard Wu</span> : Which HAPI server are you using? I'm assuming you send a POST to it with a Subscription resource in the request body. What are the headers you have set on your request?<br>
The public HAPI server will only respond with application/json+fhir when you have set the request Accept or Content-Type header to that value.</p>



<a name="194680936"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/194680936" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#194680936">(Apr 20 2020 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="201258599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201258599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> haex <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201258599">(Jun 18 2020 at 12:08)</a>:</h4>
<p>Hi,<br>
I'm using the smilecdr server and got the error response for my PATCH request: "Invalid Content-Type for PATCH operation: application/fhir+json" The content type application/json+fhir doesn't work neither.<br>
Does anyone has an idea what the problem could be?</p>



<a name="201260368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201260368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201260368">(Jun 18 2020 at 12:27)</a>:</h4>
<p>are you trying to use fhirpath patch?  i don't think hapi supports that yet</p>



<a name="201261006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201261006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> haex <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201261006">(Jun 18 2020 at 12:34)</a>:</h4>
<p>Don't think so. I just try to add some demo data from <a href="https://synthetichealth.github.io/synthea/">https://synthetichealth.github.io/synthea/</a> via postman to our smileserver.</p>



<a name="201261167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201261167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201261167">(Jun 18 2020 at 12:35)</a>:</h4>
<p>OK, then you probably shouldn't be using PATCH.  Sounds like you want POST (create) or PUT (create-on-update) as defined at <a href="https://www.hl7.org/fhir/http.html">https://www.hl7.org/fhir/http.html</a> ?</p>



<a name="201261360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201261360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> haex <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201261360">(Jun 18 2020 at 12:37)</a>:</h4>
<p>I tried this at first, but there I get the message "Unable to store a Bundle resource on this server with a Bundle.type value of: transaction"</p>



<a name="201261925"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201261925" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201261925">(Jun 18 2020 at 12:43)</a>:</h4>
<p>see <a href="https://www.hl7.org/fhir/http.html#transaction">https://www.hl7.org/fhir/http.html#transaction</a></p>



<a name="201262290"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201262290" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> haex <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201262290">(Jun 18 2020 at 12:46)</a>:</h4>
<p>Yeah, I already read this. Guess the smileserver doesn't support this kind of operation.<br>
Thank you for your help!</p>



<a name="201274702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201274702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201274702">(Jun 18 2020 at 14:23)</a>:</h4>
<p>Transactions need to be sent to the root endpoint, not the Bundle endpoint</p>



<a name="201362188"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/201362188" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> haex <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#201362188">(Jun 19 2020 at 08:05)</a>:</h4>
<p>Your are great! Thank you! That was the problem :)</p>



<a name="204580908"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/204580908" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramesh jarabana <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#204580908">(Jul 21 2020 at 17:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191319">James Agnew</span> <a href="#narrow/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request/near/194017809">said</a>:</p>
<blockquote>
<p>If you want to use JSONPatch, you can also use a Binary resource as the container in the bundle:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;Bundle&quot;</span><span class="p">,</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transaction&quot;</span><span class="p">,</span>
  <span class="nt">&quot;entry&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;fullUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;Patient/1&quot;</span><span class="p">,</span>
      <span class="nt">&quot;resource&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;resourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;Binary&quot;</span><span class="p">,</span>
        <span class="nt">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json-patch+json&quot;</span><span class="p">,</span>
        <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;WyB7ICJvcCI6InJlcGxhY2UiLCAicGF0aCI6Ii9hY3RpdmUiLCAidmFsdWUiOmZhbHNlIH0gXQ==&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;request&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PATCH&quot;</span><span class="p">,</span>
        <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;Patient/1&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>


</blockquote>
<p>Hi James,</p>
<p>Binary Patch is working without conditional check but it's throwing error, whenever I want to validate before patching the resource like set-IF</p>
<p>any help will be appreciated..<br>
Thanks<br>
Ramesh</p>



<a name="234276419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/234276419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyndon Howie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#234276419">(Apr 13 2021 at 06:49)</a>:</h4>
<p>I'm looking at implementing transaction bundles using FHIRPath patch and have a use case where we would add or replace an entire resource in the patched resources "contained" array/list. With jsonpatch this can be done in a single add/replace operation as the value can be an object/map. This doesn't seem to be possible with FHIRPath patch, which would require an operation for every field in the resource as there is no "open type" that can be used with the value to specify the value is a resource, or other complex type other than the few that are specifically listed. <br>
Am I correct in my above understanding that replacing a resource in the contained array would require multiple operations using fhirpath patch?</p>



<a name="234894373"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/234894373" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#234894373">(Apr 16 2021 at 17:46)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="235106256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/235106256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#235106256">(Apr 18 2021 at 22:17)</a>:</h4>
<p>yes that's a limitation that we can't easily address</p>



<a name="255768499"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/255768499" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#255768499">(Oct 01 2021 at 16:10)</a>:</h4>
<p>I’m currently searching in the spec for an answer under which circumstances a PATCH operation within a transaction counts as “failed” and therefore causes the whole transaction to fail. Is it expected to fail the transaction in case the PATCH operation returns a 404 response code (due to the target not being found)?</p>



<a name="255770443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/255770443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#255770443">(Oct 01 2021 at 16:24)</a>:</h4>
<p>The description of <a href="http://hl7.org/fhir/http.html#patch">patch</a> includes some hints on when to consider it a failure.  The description of <a href="http://hl7.org/fhir/http.html#transaction">transaction</a> indicates that "the entire set of changes succeed or fail as a single entity".</p>
<p>Edit: fixed from re-reading the question: I would assume any attempt at a PATCH that doesn't result in a success normally on the server (yes, that is pretty unsatisfying).</p>



<a name="255771778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/255771778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#255771778">(Oct 01 2021 at 16:34)</a>:</h4>
<p>Agreed, that it’s not the happy path. But given that it’s a conditional Patch, there is maybe some room for interpretation here, e.g. as a client I want to specify that if the resource is present then please PATCH it. Otherwise just inform me about the result.</p>



<a name="255771886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/255771886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#255771886">(Oct 01 2021 at 16:34)</a>:</h4>
<p>I just would be in favor of handling it in a common way :)</p>



<a name="255773136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/255773136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#255773136">(Oct 01 2021 at 16:44)</a>:</h4>
<p>Yeah - it is tough because a conditional update can serve as a create, but a conditional patch can't be executed.  The note in patch specifies that a conditional patch with no matches fails with a 404, but if you have an idea and want to propose changing it, I'd be curious to see what would work.. it is difficult to distinguish 'worked' from 'not found' in success states.</p>



<a name="255774659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/255774659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#255774659">(Oct 01 2021 at 16:55)</a>:</h4>
<p>Our current implementation returns a transaction response bundle where the status is simply 404 but the overall status code is 200. I guess it’s uncommon for a client to check the response code from every entry. That said, if the resource is not referenced anywhere else in the transaction the whole transaction would not need to fail.</p>



<a name="255774739"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Transaction%20with%20PATCH%20request/near/255774739" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Transaction.20with.20PATCH.20request.html#255774739">(Oct 01 2021 at 16:55)</a>:</h4>
<p>But that’s shifting responsibility to the client, so I guess it’s better to let it fail.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
