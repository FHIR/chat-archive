---
layout: page
title: "FHIR Chat  · Oracle ORA-01975 when iterating over large datasets · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html">Oracle ORA-01975 when iterating over large datasets</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="273510366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Oracle%20ORA-01975%20when%20iterating%20over%20large%20datasets/near/273510366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Atterberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html#273510366">(Feb 28 2022 at 15:55)</a>:</h4>
<p>We are iterating over a large dataset, over a million records.  As we go through the links to get the next set of resource we encounter the Oracle message ORA-01975 Maximum number of expressions in a list is 1000.  Has anyone seen this and does it have anything to do with configuration settings?</p>



<a name="273511565"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Oracle%20ORA-01975%20when%20iterating%20over%20large%20datasets/near/273511565" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html#273511565">(Feb 28 2022 at 16:01)</a>:</h4>
<p>There is not quite enough info here for me to be confident in my response (e.g., what FHIR server is doing the access, etc.), but if I had to <em>guess</em>, I would say it is likely that the paging is being done by excluding records in a SQL <code>in</code> clause (e.g., <code>select ... where not in ({ids that have already been sent})</code>).</p>
<p>Oracle has a limit of 1000 elements in a single <code>in</code> expression - you can get around it by having the code limit a single <code>in</code> to 1000 elements, then adding another list with an <code>or</code> joining them.</p>
<p>Again, shooting from the hip without more info though.  Hope this helps!</p>



<a name="273518221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Oracle%20ORA-01975%20when%20iterating%20over%20large%20datasets/near/273518221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Atterberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html#273518221">(Feb 28 2022 at 16:45)</a>:</h4>
<p>Hi Gino.  Can that be done on the server side?  HAPI generates the query so can we affect that somehow?  When we go to the next set of values using something like <a href="http://localhost:1111/my-fhir/v1?_getpages=fc2a0deb-bf8e-4556-ba57-7e7dcf9d6e4c&amp;_getpagesoffset=10&amp;_count=20&amp;_pretty=true&amp;_bundletype=searchset">http://localhost:1111/my-fhir/v1?_getpages=fc2a0deb-bf8e-4556-ba57-7e7dcf9d6e4c&amp;_getpagesoffset=10&amp;_count=20&amp;_pretty=true&amp;_bundletype=searchset</a> can we change the query to add a list as you suggest? <span class="user-mention" data-user-id="191319">@James Agnew</span> <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span></p>



<a name="273519637"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Oracle%20ORA-01975%20when%20iterating%20over%20large%20datasets/near/273519637" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html#273519637">(Feb 28 2022 at 16:55)</a>:</h4>
<p>Hi Joe, if you are using HAPI, you may get a better response on the <a class="stream" data-stream-id="179167" href="/#narrow/stream/179167-hapi">#hapi</a> stream.  I am not familiar enough with HAPI's code to offer more.</p>



<a name="273521334"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Oracle%20ORA-01975%20when%20iterating%20over%20large%20datasets/near/273521334" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html#273521334">(Feb 28 2022 at 17:05)</a>:</h4>
<p>What version of HAPI FHIR are you using? If not 5.7.0, definitely start there. There are a few fixes for this kind of thing in this version.</p>



<a name="273522956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Oracle%20ORA-01975%20when%20iterating%20over%20large%20datasets/near/273522956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html#273522956">(Feb 28 2022 at 17:17)</a>:</h4>
<p>..and if so, do you have a stack trace from the logs?</p>



<a name="273568005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Oracle%20ORA-01975%20when%20iterating%20over%20large%20datasets/near/273568005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Atterberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Oracle.20ORA-01975.20when.20iterating.20over.20large.20datasets.html#273568005">(Feb 28 2022 at 23:10)</a>:</h4>
<p>Yes, thank you.  We stumbled across bug <a href="https://github.com/hapifhir/hapi-fhir/issues/3123">https://github.com/hapifhir/hapi-fhir/issues/3123</a> which was fixed in 5.6.0.  We're at 5.4.2 and accessing going to 5.6.2.  It looks like there are a few database changes we are going to have to make.  Thank you for your timely response.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
