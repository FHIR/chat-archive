---
layout: page
title: "FHIR Chat  · If-None-Exist header and non-ASCI search params · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html">If-None-Exist header and non-ASCI search params</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="208871198"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208871198" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aleksandr Sorokin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208871198">(Sep 02 2020 at 18:58)</a>:</h4>
<p>Аccording to Fhir R4 and earlier versions, for the Conditional Create operation, we shoud use the If-None-Exist header with search parameters. However, non-ASCII characters are prohibited by RFC7230 in header values, see <a href="https://tools.ietf.org/html/rfc7230#section-3.2.4">https://tools.ietf.org/html/rfc7230#section-3.2.4</a> So, conditional create with non-ascii parameters like 'name=Грайм' won't work. We avoid this by using batch/transaction, but it is not convenient for creating single resource. I propose in future versions of standart to abandon the use of the header and use query params in urls as well as conditional delete and update. Another approach is to use base64string encoding in If-None-Exist header.</p>



<a name="208875735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208875735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208875735">(Sep 02 2020 at 19:31)</a>:</h4>
<p>Use a transaction?</p>



<a name="208875984"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208875984" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aleksandr Sorokin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208875984">(Sep 02 2020 at 19:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191912">Michele Mottini</span> <a href="#narrow/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params/near/208875735">said</a>:</p>
<blockquote>
<p>Use a transaction?</p>
</blockquote>
<p><a href="https://www.hl7.org/fhir/http.html#transaction">https://www.hl7.org/fhir/http.html#transaction</a></p>



<a name="208876471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208876471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208876471">(Sep 02 2020 at 19:37)</a>:</h4>
<p>Yes, that. <code>If-None-Exist</code> will be inside the bundle, no longer in the header, so without limitations in the character set I guess</p>



<a name="208877174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208877174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aleksandr Sorokin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208877174">(Sep 02 2020 at 19:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191912">Michele Mottini</span> <a href="#narrow/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params/near/208876471">said</a>:</p>
<blockquote>
<p>Yes, that. <code>If-None-Exist</code> will be inside the bundle, no longer in the header, so without limitations in the character set I guess</p>
</blockquote>
<p>Did you read the full message?<br>
We already avoid this by using transaction, but it is not convenient for creating single resource</p>



<a name="208880697"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208880697" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208880697">(Sep 02 2020 at 20:11)</a>:</h4>
<blockquote>
<p>non-ASCII characters are prohibited in header values</p>
</blockquote>
<p>we certainly overlooked that. :-(</p>



<a name="208880899"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208880899" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208880899">(Sep 02 2020 at 20:12)</a>:</h4>
<p>no we didn't. you can URL encode in the headers, like in the URL</p>



<a name="208881765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208881765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208881765">(Sep 02 2020 at 20:19)</a>:</h4>
<blockquote>
<p>Did you read the full message?</p>
</blockquote>
<p>Clearly I didn't !</p>



<a name="208900680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208900680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aleksandr Sorokin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208900680">(Sep 02 2020 at 23:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params/near/208880899">said</a>:</p>
<blockquote>
<p>no we didn't. you can URL encode in the headers, like in the URL</p>
</blockquote>
<p>ok, but what are the advantages of using custom header for conditional create?<br>
why can't it be done the same everywhere?</p>



<a name="208901197"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208901197" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208901197">(Sep 02 2020 at 23:22)</a>:</h4>
<p>I think the point is that it's not custom; it's a standard header.</p>



<a name="208901231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208901231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208901231">(Sep 02 2020 at 23:22)</a>:</h4>
<p>In practice I don't know how important this is :-)</p>



<a name="208901797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208901797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aleksandr Sorokin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208901797">(Sep 02 2020 at 23:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params/near/208901197">said</a>:</p>
<blockquote>
<p>I think the point is that it's not custom; it's a standard header.</p>
</blockquote>
<p>Really? Of course it's standard header because it's defined by fhir standard :)<br>
Due to docs <a href="https://www.hl7.org/fhir/http.html#ccreate">https://www.hl7.org/fhir/http.html#ccreate</a><br>
 HL7 defined extension header "If-None-Exist"</p>



<a name="208932224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208932224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208932224">(Sep 03 2020 at 07:58)</a>:</h4>
<p>I don't recall whether we discussed using a URL parameter instead</p>



<a name="208965063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/If-None-Exist%20header%20and%20non-ASCI%20search%20params/near/208965063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/If-None-Exist.20header.20and.20non-ASCI.20search.20params.html#208965063">(Sep 03 2020 at 13:19)</a>:</h4>
<p><span class="user-mention" data-user-id="196269">@Aleksandr Sorokin</span>  you're totally right -- I was thinking about If-None-Match, etc, the etag-based conditionals (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Conditional_requests">https://developer.mozilla.org/en-US/docs/Web/HTTP/Conditional_requests</a>).  I do think there's benefit in parallelism here, but you're right then we're still inventing something.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
