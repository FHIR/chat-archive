---
layout: page
title: "FHIR Chat  · nested slices and validation · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html">nested slices and validation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153940043"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940043" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940043">(Feb 23 2018 at 05:05)</a>:</h4>
<p>working on the vitals profile and replacing some invariant with slicing and discovering that the nested slices like in <a href="http://build.fhir.org/bp.html" target="_blank" title="http://build.fhir.org/bp.html">this profile</a></p>
<p>cause the following error when validating instances...<br>
"Error in discriminator at Observation.component:foo2.code.coding: slicing found"</p>
<p>so is this a limitation of slicing or of the validator?</p>
<p>my goal is have at one coding in one component to contain a code.</p>



<a name="153940142"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940142" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940142">(Feb 23 2018 at 17:50)</a>:</h4>
<p>also one category to contain one coding with a fixed code and system  for Obs.category</p>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  or <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  looking at past posts I'm guessing is not prohibited and is a validation issue.</p>



<a name="153940144"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940144" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940144">(Feb 23 2018 at 17:55)</a>:</h4>
<p>Without seeing the spreadsheet, it's hard to know what you're doing.</p>



<a name="153940229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940229">(Feb 24 2018 at 00:32)</a>:</h4>
<p>here you go and thanks  ( this is not the vitals profile , but a simplified version to test it out in ig-pub  - gets same errors)<a href="/user_uploads/10155/UAKA9XhKGlDo8ZO1s-vdBHyh/Screen-Shot-2018-02-23-at-4.30.10-PM.png" target="_blank" title="Screen-Shot-2018-02-23-at-4.30.10-PM.png">Screen-Shot-2018-02-23-at-4.30.10-PM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/UAKA9XhKGlDo8ZO1s-vdBHyh/Screen-Shot-2018-02-23-at-4.30.10-PM.png" target="_blank" title="Screen-Shot-2018-02-23-at-4.30.10-PM.png"><img src="/user_uploads/10155/UAKA9XhKGlDo8ZO1s-vdBHyh/Screen-Shot-2018-02-23-at-4.30.10-PM.png"></a></div>



<a name="153940230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940230">(Feb 24 2018 at 00:33)</a>:</h4>
<p>slice foo1 is nested under slice foo , and slice  foo4 is nested under slicefoo4  (should be slice foo3 and slice foo4 in the image above)</p>



<a name="153940236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940236">(Feb 24 2018 at 01:04)</a>:</h4>
<p>Why not slice by pattern?  Then you can specify a pattern on the coding and be done (and you can include the code system too - slicing by code alone is not safe)</p>



<a name="153940241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940241">(Feb 24 2018 at 01:12)</a>:</h4>
<p>well I simplified it  and did not include system  - my reason for not using pattern is easier to read this way.</p>



<a name="153940242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940242">(Feb 24 2018 at 01:12)</a>:</h4>
<p>and I think easier to reslice</p>



<a name="153940243"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940243" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940243">(Feb 24 2018 at 01:13)</a>:</h4>
<p>but my question really is whether you can nest a slice like this or not.</p>



<a name="153940244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940244">(Feb 24 2018 at 01:15)</a>:</h4>
<p>if yes then whether the validator should handle that  - at least one layer deep</p>
<p>unless I am way off base  I think this is common case:</p>
<ul>
<li>at least one code value pair needs to exist in a coding in a repeating element of type CodeableConcept  - like Obs,category</li>
</ul>



<a name="153940245"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940245" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940245">(Feb 24 2018 at 01:16)</a>:</h4>
<p>I have nested slices like that before.  However, I've had some issues with doing it in spreadsheets.</p>



<a name="153940246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940246">(Feb 24 2018 at 01:16)</a>:</h4>
<p>I don't remember the specifics though.</p>



<a name="153940247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940247">(Feb 24 2018 at 01:16)</a>:</h4>
<p>I went to patterns because it was cleaner.</p>



<a name="153940248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940248">(Feb 24 2018 at 01:17)</a>:</h4>
<p>k</p>
<p>but I have to use the spreadsheet for the build right</p>



<a name="153940249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940249">(Feb 24 2018 at 01:18)</a>:</h4>
<p>and your profile instances  validated using the build or ig validator?</p>



<a name="153940251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940251">(Feb 24 2018 at 01:20)</a>:</h4>
<p>I guess I'll use patterns.  I can pattern a coding but had no success patterning a CodeabeConcept.  Can you send me an example</p>



<a name="153940252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940252">(Feb 24 2018 at 01:20)</a>:</h4>
<p>pattern</p>



<a name="153940254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940254">(Feb 24 2018 at 01:22)</a>:</h4>
<p><a href="/user_uploads/10155/fi3mxiczRobXsMfFLNlcAq9f/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/fi3mxiczRobXsMfFLNlcAq9f/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/fi3mxiczRobXsMfFLNlcAq9f/pasted_image.png"></a></div>



<a name="153940257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940257">(Feb 24 2018 at 01:26)</a>:</h4>
<p>ty</p>



<a name="153940270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940270">(Feb 24 2018 at 02:33)</a>:</h4>
<p>Can you point me to where there is documentation (presuming that there is some) and I can get up to date on the details for slicing by pattern?  I haven't done that, but I believe it's what I'm going to be needing to do.  I appreciate the image from Lloyd, but I don't think that's enough to be comfortable with how it works and how to do it.</p>



<a name="153940274"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940274" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940274">(Feb 24 2018 at 02:37)</a>:</h4>
<p>If you're slicing by pattern, in the slicing path you declare the path to the note that will have a pattern and say "@pattern".  In the slices, for those nodes, you fill in the pattern element with the pattern that needs to be matched by nodes.  The patterns need to be mutually exclusive across all of the declared slices.</p>



<a name="153940276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940276">(Feb 24 2018 at 02:40)</a>:</h4>
<p>OK, that seems to make sense.  And if I look at an example I think that should make it clear.  Thanks.</p>



<a name="153940418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940418">(Feb 25 2018 at 21:33)</a>:</h4>
<p>OK so the patterns didn't validate either and I can't get over how opaque they look.  I don't need to publish as a spreadsheet in the build so that is not the issue - but in XML doesn't work either.  Here is what I want.  One code to be "foo" in one instance of one coding in category.</p>
<p>but still getting the instance vaildation error (in Ig-publisher but assuming will be same in the build.)  "    Error in discriminator at Observation.category:foo.coding: slicing found"</p>
<p>my question is again is this an issue with my slicing or an issue with the validation getting stuck on a nested slice.</p>
<p>here is the xml</p>
<div class="codehilite"><pre><span></span>  &lt;differential&gt;
    &lt;element id=&quot;Observation&quot;&gt;
      &lt;path value=&quot;Observation&quot;/&gt;
      &lt;definition value=&quot;This is a simple example Template.&quot;/&gt;
      &lt;mustSupport value=&quot;false&quot;/&gt;
      &lt;isModifier value=&quot;false&quot;/&gt;
    &lt;/element&gt;
    &lt;element id=&quot;Observation.category&quot;&gt;
      &lt;path value=&quot;Observation.category&quot;/&gt;
      &lt;slicing&gt;
        &lt;discriminator&gt;
          &lt;type value=&quot;value&quot;/&gt;
          &lt;path value=&quot;coding.code&quot;/&gt;
        &lt;/discriminator&gt;
        &lt;rules value=&quot;open&quot;/&gt;
      &lt;/slicing&gt;
      &lt;min value=&quot;1&quot;/&gt;
      &lt;max value=&quot;*&quot;/&gt;
      &lt;type&gt;
        &lt;code value=&quot;CodeableConcept&quot;/&gt;
      &lt;/type&gt;

    &lt;/element&gt;
    &lt;element id=&quot;Observation.category:foo&quot;&gt;
      &lt;path value=&quot;Observation.category&quot;/&gt;
      &lt;sliceName value=&quot;foo&quot;/&gt;
      &lt;min value=&quot;1&quot;/&gt;
      &lt;max value=&quot;1&quot;/&gt;
      &lt;type&gt;
        &lt;code value=&quot;CodeableConcept&quot;/&gt;
      &lt;/type&gt;
    &lt;/element&gt;
    &lt;element id=&quot;Observation.category:foo.coding&quot;&gt;
      &lt;path value=&quot;Observation.category.coding&quot;/&gt;
      &lt;slicing&gt;
        &lt;discriminator&gt;
          &lt;type value=&quot;value&quot;/&gt;
          &lt;path value=&quot;code&quot;/&gt;
        &lt;/discriminator&gt;
        &lt;rules value=&quot;open&quot;/&gt;
      &lt;/slicing
      &lt;type&gt;
        &lt;code value=&quot;Coding&quot;/&gt;
      &lt;/type&gt;
    &lt;/element&gt;
    &lt;element id=&quot;Observation.category:foo.coding:foo1&quot;&gt;
      &lt;path value=&quot;Observation.category.coding&quot;/&gt;
      &lt;sliceName value=&quot;foo1&quot;/&gt;
      &lt;min value=&quot;1&quot;/&gt;
      &lt;max value=&quot;1&quot;/&gt;
      &lt;type&gt;
        &lt;code value=&quot;Coding&quot;/&gt;
      &lt;/type&gt;

    &lt;/element&gt;
    &lt;element id=&quot;Observation.category:foo.coding:foo1.code&quot;&gt;
      &lt;path value=&quot;Observation.category.coding.code&quot;/&gt;
      &lt;min value=&quot;1&quot;/&gt;
      &lt;max value=&quot;1&quot;/&gt;
      &lt;type&gt;
        &lt;code value=&quot;code&quot;/&gt;
      &lt;/type&gt;
      &lt;fixedCode value=&quot;81260-2&quot;/&gt;
    &lt;/element&gt;
  &lt;/differential&gt;
&lt;/StructureDefinition&gt;
</pre></div>



<a name="153940420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940420">(Feb 25 2018 at 22:28)</a>:</h4>
<p>That should work.  Though you really need to include 'system' too.</p>



<a name="153940621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/nested%20slices%20and%20validation/near/153940621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/nested.20slices.20and.20validation.html#153940621">(Feb 26 2018 at 16:36)</a>:</h4>
<p>Well yes if this worked then I would add system to ...  i am trying to debug why is not working.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
