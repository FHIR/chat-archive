---
layout: page
title: "FHIR Chat  · currentAsOf extension? · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html">currentAsOf extension?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="230461048"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230461048" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230461048">(Mar 16 2021 at 05:17)</a>:</h4>
<p>FHIR's Meta.lastUpdated element tells you how long something has been stable (time of last update). But in data aggregation scenarios there's a distinct desire to know when data are <em>stale</em>, e.g. with something like a <code>currentAsOf</code> extension, so even data that hasn't changed could be marked with the time they were last refreshed by the aggregator from primary sources. <a href="https://github.com/smart-on-fhir/smart-scheduling-links/issues/16#issuecomment-799954590">https://github.com/smart-on-fhir/smart-scheduling-links/issues/16#issuecomment-799954590</a> has an example.</p>
<p>But... If an aggregator actually populated this extension it'd be <em>causing</em> an update, and presumably Meta.lastUpdated would tick up because of this. On this evaluation, it seems fine for aggregators to just skip the currentAsOf extension and repopulate lastUpdated as $now each time they refresh content.</p>
<p>Anybody have a different take?</p>



<a name="230470476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230470476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230470476">(Mar 16 2021 at 07:40)</a>:</h4>
<p>AFAIK updates to meta don't cause _lastUpdated to be updated. But whether that's mandated by the spec.. that's the q.</p>



<a name="230503971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230503971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230503971">(Mar 16 2021 at 12:35)</a>:</h4>
<p>yes, unfortunately there is some hints in the spec that say that updates to meta don't update _lastUpdated. I think this is a bad general rule. It is not a bad consideration for policy. That is to say to declare that a server can have a policy that would allow some specific kinds of updates to meta to not be reflected in _lastUpdated.<br>
The big problem I see with any policy that does not update the _lastUpdated, is that it puts provenance in question overall. If there is any rule that allows _lastUpdated to not be changed, then one must question what other rules are around that don't do something.</p>



<a name="230504450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230504450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230504450">(Mar 16 2021 at 12:39)</a>:</h4>
<p>Josh, Your use-case seems reasonable within a closed system. That is that there is a database level solution. But to expose this at the FHIR API brings up many problems. Why does it need to be exposed at the FHIR level?  <br>
Provenance could do what you are asking, but would be very heavy as even a minimally populated Provenance is bigger than a timestamp extension. However, one Provenance record can tag thousands of resources as "all of these are current as of today"</p>



<a name="230516834"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230516834" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230516834">(Mar 16 2021 at 14:04)</a>:</h4>
<p>Thanks for the call out that changes to mets needn't affect lastUpdated. (Is there a reference for this?)</p>



<a name="230518690"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230518690" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230518690">(Mar 16 2021 at 14:14)</a>:</h4>
<p>I think it was in the $meta-add operation, but don't see it there now</p>



<a name="230518749"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230518749" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230518749">(Mar 16 2021 at 14:14)</a>:</h4>
<p>but using the $meta-add was at a time defined as not updating the _lastUpdated</p>



<a name="230519227"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230519227" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230519227">(Mar 16 2021 at 14:17)</a>:</h4>
<p>I think I successfully got the bad fixed policy removed.</p>



<a name="230533661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230533661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230533661">(Mar 16 2021 at 15:32)</a>:</h4>
<p>In my FHIR SPL work, we need to know that exact question - how current is this data - and I came to the same conclusion as you did - any element that I added to track that would just duplicate the Meta.lastUpdated, so we are just using that and are telling users to just send a no-change update to make things current.</p>



<a name="230536395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230536395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230536395">(Mar 16 2021 at 15:47)</a>:</h4>
<p>There are technical operations that don't reflect a 'review' of the data that could change _lastUpdated.   _lastUpdated is also server-specific.  If I receive a record from another system that represents "knowledge as of 5 years ago", the _lastUpdated in my system could be 'today' if I received the record today.  That doesn't mean that that information is 'current' as of today.</p>



<a name="230537266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230537266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230537266">(Mar 16 2021 at 15:52)</a>:</h4>
<p>In the context of this thread, "currentAsOf" represents: "I [the aggregator]  last queries the information source for this data at ____". (Agreed the word "current" could be misleading; don't read too much into that <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>.)</p>



<a name="230537490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230537490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230537490">(Mar 16 2021 at 15:53)</a>:</h4>
<p><span class="user-mention" data-user-id="192166">@Jean Duteau</span> I seem to remember doing a no-change update to a server (HAPI?) and it just ignored it, noticing that there was no change. It didn't update the version number. I am not sure about  lastUpdated but I would assume not.</p>



<a name="230538366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230538366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230538366">(Mar 16 2021 at 15:58)</a>:</h4>
<p>If you go through and update tags or profile declarations or anything else purely locally (without grabbing the data from source of truth) your lastUpdated will still change</p>



<a name="230544466"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230544466" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230544466">(Mar 16 2021 at 16:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191651">Rik Smithies</span> <a href="#narrow/stream/179166-implementers/topic/currentAsOf.20extension.3F/near/230537490">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="192166">Jean Duteau</span> I seem to remember doing a no-change update to a server (HAPI?) and it just ignored it, noticing that there was no change. It didn't update the version number. I am not sure about  lastUpdated but I would assume not.</p>
</blockquote>
<p>Well, that would suck!  We've been assuming that sending a PUT with a complete instance would create a new version even if the data was exactly the same.  Something to note for our testing!</p>



<a name="230550928"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230550928" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230550928">(Mar 16 2021 at 16:59)</a>:</h4>
<p>I presume you meant PUT?  It is up to a server whether it actually creates a new instance.  (It's also up to the server whether it changes what you asked to be changed...)</p>



<a name="230551094"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230551094" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230551094">(Mar 16 2021 at 17:00)</a>:</h4>
<p>Isn't that what I said? :) I changed it as I constantly get POST and PUT backwards.  That's news to me that it's up to the server on whether it actually creates a new instance.  Hmm...</p>



<a name="230551613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230551613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230551613">(Mar 16 2021 at 17:02)</a>:</h4>
<p>Even more fun, on a POST, you might get back the id of a pre-existing resource rather than a new one created :)</p>



<a name="230551734"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230551734" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230551734">(Mar 16 2021 at 17:03)</a>:</h4>
<p>I think you have to look at the response to a POST or PUT to make sure the server did what you expected.</p>



<a name="230551972"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230551972" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230551972">(Mar 16 2021 at 17:04)</a>:</h4>
<p>okay, so this tells me that to ensure that Meta.lastUpdated actually gets updated when I do an update, that I have to add a new field via an extension that is the equivalent of Meta.lastUpdated and that I will update when I do the update so that the update will get done?</p>



<a name="230555127"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230555127" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230555127">(Mar 16 2021 at 17:21)</a>:</h4>
<p>If the server happens to support that extension.  Rather than doing that, I'd probably set some expectations in the IG about updates forcing a new version or maybe define a 'touch' operation rather than adding a useless data element.</p>



<a name="230555481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230555481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230555481">(Mar 16 2021 at 17:23)</a>:</h4>
<p>upon re-reading, I'm presuming this means that if I'm a client, I can't necessarily expect the server to do what I ask.  But if I'm designing the server and using IBM's server or HAPI's server, I'm hoping that I can force an update and/or an update of the lastUpdate.</p>



<a name="230555989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230555989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230555989">(Mar 16 2021 at 17:26)</a>:</h4>
<p>Yes, that should be possible.  Though you'd have to check with the author of the server in question.</p>



<a name="230556087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230556087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230556087">(Mar 16 2021 at 17:26)</a>:</h4>
<p>(And also make sure they don't 'optimize' things in an update and you don't recognize the change...)</p>



<a name="230563443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230563443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230563443">(Mar 16 2021 at 18:07)</a>:</h4>
<p>is this behaviour not standardised? we wouldn't want a solution that would fail if a new server vendor was switched in one day.</p>



<a name="230570775"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230570775" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Duteau <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230570775">(Mar 16 2021 at 18:56)</a>:</h4>
<p>okay, having read the relevant parts of the specification, then the SHOULDs about data in matching data out can become SHALLs for an implementation's specific use-case.  If the concerns about data integration and transactional integrity are not actually concerns, then one can develop one's server appropriately.  As to whether the OTS servers support that is a question that everyone deciding on using one of those would need to ask.</p>



<a name="230791689"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230791689" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Brackett <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230791689">(Mar 18 2021 at 00:30)</a>:</h4>
<p>Hi, I’m the person who posted the GitHub issue <span class="user-mention" data-user-id="191315">@Josh Mandel</span>  referred to in the OP. I’m pretty new to HL7 &amp; FHIR, so apologies if I’m missing the obvious. The <code>currentAsOf</code> extension here is hypothetical right? Am I understanding correctly that we’re talking about something roughly like:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="p">{</span>
  <span class="c1">// some domain resource</span>
  <span class="s2">"extension"</span><span class="o">:</span> <span class="p">[{</span>
    <span class="s2">"url"</span><span class="o">:</span> <span class="s2">"http://hl7.org/fhir/StructureDefinition/currentAsOf"</span><span class="p">,</span>
    <span class="s2">"valueInstant"</span><span class="o">:</span> <span class="s2">"2021-03-17T12:08:36Z"</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div>
<p>?</p>



<a name="230793206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230793206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230793206">(Mar 18 2021 at 00:49)</a>:</h4>
<p>Welcome <span class="user-mention" data-user-id="398591">@Rob Brackett</span>!  Yes hypothetical extension for the moment :) And indeed, the example you're writing out here is precisely what I had in mind.</p>



<a name="230793296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230793296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230793296">(Mar 18 2021 at 00:50)</a>:</h4>
<p>We could suggest this as a new core extension, too. I'll submit a Jira issue for it.</p>



<a name="230793574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/230793574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#230793574">(Mar 18 2021 at 00:54)</a>:</h4>
<p>Added <a href="http://jira.hl7.org/browse/FHIR-31567">FHIR-31567</a></p>



<a name="235238997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/currentAsOf%20extension%3F/near/235238997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Brackett <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/currentAsOf.20extension.3F.html#235238997">(Apr 19 2021 at 19:56)</a>:</h4>
<p>Checking in here… the current status (not finalized, but ready for a vote) is that we’d have this?</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="p">{</span>
  <span class="s2">"resourceType"</span><span class="o">:</span> <span class="s2">"Slot"</span><span class="p">,</span>  <span class="c1">// Or whatever</span>
  <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"extension"</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"url"</span><span class="o">:</span> <span class="s2">"http://hl7.org/fhir/StructureDefinition/lastSourceSync"</span><span class="p">,</span>
        <span class="s2">"valueDateTime"</span><span class="o">:</span> <span class="s2">"2021-03-15T23:00:01Z"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"123"</span><span class="p">,</span>
  <span class="c1">// etc...</span>
<span class="p">}</span>
</code></pre></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
