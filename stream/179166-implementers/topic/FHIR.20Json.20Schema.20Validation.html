---
layout: page
title: "FHIR Chat  · FHIR Json Schema Validation · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html">FHIR Json Schema Validation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="202727158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202727158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Braman <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202727158">(Jul 02 2020 at 18:28)</a>:</h4>
<p>I have validated some example FHIR resources with <a href="https://ajv.js.org">https://ajv.js.org</a> and the HL7 FHIR JSON Schemas .  It seems the validation could produce some better results.  So far, in my testing, AJV never returned valid when I sent it an invalid FHIR resource, so that was good.  It just seemed like the errors were cascading instead of the usual error, warning, info motif with a line number and a description unique for each error.  It very well maybe a tool issue but I don't know I am just getting started with JSON Schema Validation with FHIR.  The first tool I tried failed to function with our FHIR json schemas. Avj was better but not great, so wondering if anyone on the channel has some experiences with JSON schema they would like to share.  I realize that JSON schema is in draft not IETF RFC yet so this is experimental.</p>



<a name="202728453"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202728453" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202728453">(Jul 02 2020 at 18:38)</a>:</h4>
<p>You need discriminator extension for schema - <a href="https://swagger.io/docs/specification/data-models/inheritance-and-polymorphism/">https://swagger.io/docs/specification/data-models/inheritance-and-polymorphism/</a></p>



<a name="202741162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202741162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Braman <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202741162">(Jul 02 2020 at 20:28)</a>:</h4>
<p>How does OpenAPI apply to HL7's FHIR JSON schemas? Can you reference the schema from OpenAPI?  Not sure why I need that.  What I would lI would like to do is instance validation of FHIR resources using the Hl7 FHIR JSON schema on the command line.  Does anyone know of. better tool than AJV?</p>



<a name="202742130"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202742130" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202742130">(Jul 02 2020 at 20:41)</a>:</h4>
<p>Note that JSON schema only gets you so far with validation - it won't test invariants or most vocabulary bindings and has a few other limitations - so you may want to look at the Java or .NET validators if validation is your primary objective.</p>



<a name="202746036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202746036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202746036">(Jul 02 2020 at 21:20)</a>:</h4>
<p>because openAPI deviates from the JSON schema spec, I think we're going to need 2 sets of JSON schema, one for JSON schema compliant tools and one for openAPI</p>



<a name="202746123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202746123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202746123">(Jul 02 2020 at 21:21)</a>:</h4>
<p>but JSON schema won't ever generate simple error messages because of how the Json Schema validation works, and I can't magically fix that. It's because of the way we use the resourceType property - a resource is always invalid against all the schemas all at once</p>



<a name="202901152"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202901152" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Braman <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202901152">(Jul 05 2020 at 02:27)</a>:</h4>
<p>I had much better luck with the GO Json schema validator <a href="https://github.com/xeipuuv/gojsonschema">https://github.com/xeipuuv/gojsonschema</a>.  Its error messages were concise when validating a few real world resources from our server.  I am looking for straight FHIR resource schema validation some other way than HAPI, preferably something standard and fast :).  I tried to convert the Hl7 java validatdaion classes into a webservice last year but could never get it running.  I think that would be a valuable tool for the community.  Are there things we can ask the JSON Schema working group that would help us make our validator better?</p>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> what do you mean by testing "invariants"?  Also what other limitations?</p>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Does HL7 have open api 3 file for FHIR?  IS that something you are working on?</p>



<a name="202903956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202903956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202903956">(Jul 05 2020 at 04:02)</a>:</h4>
<p>Code im using for a service <a href="https://github.com/NHSDigital/fhir-validation-service">https://github.com/NHSDigital/fhir-validation-service</a> <br>
I'm looking at using this instead of schemas which we currently are using</p>



<a name="202922287"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202922287" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202922287">(Jul 05 2020 at 13:44)</a>:</h4>
<p>Invariants are all of the constraints asserted in the 'constraints' section for any resource.  JSON schema also can't handle certain types of slicing or handle checking of declared profiles.  I don't think it supports some of the extensions that constrain things like regular expressions or minimum length, though it could probably be extended to.    <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> would know best.   You can certainly choose to just use JSON schema validation if you wish, but be aware that just because you pass schema validation, that doesn't mean your instances will be valid.  You can tune the FHIR Java validator to be faster - for example bypassing calls to an external terminology service.  That might give you more complete validation with performance that is still acceptable.</p>



<a name="202937065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202937065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202937065">(Jul 05 2020 at 20:31)</a>:</h4>
<p>We don't generate an openAPI file for all of FHIR. We do generate one for any capability statement in an implementation guide - e.g. <a href="https://www.hl7.org/fhir/us/core/CapabilityStatement-us-core-server.html">https://www.hl7.org/fhir/us/core/CapabilityStatement-us-core-server.html</a> has <a href="https://www.hl7.org/fhir/us/core/us-core-server.openapi.json">https://www.hl7.org/fhir/us/core/us-core-server.openapi.json</a></p>



<a name="202937117"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202937117" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202937117">(Jul 05 2020 at 20:32)</a>:</h4>
<p>with regard to slicing, json schema can generally only handle slicing based on fixed values - that's only a portion of slicing.</p>



<a name="202937122"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/202937122" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#202937122">(Jul 05 2020 at 20:32)</a>:</h4>
<p>Lloyd covered the other high points though no doubt there's more.</p>



<a name="203380530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203380530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Braman <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203380530">(Jul 09 2020 at 12:45)</a>:</h4>
<p><span class="user-mention" data-user-id="191687">@Kevin Mayfield</span> Is your service basically a stripped down version of HAPI that just supports $validate for every resource?</p>



<a name="203380696"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203380696" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Braman <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203380696">(Jul 09 2020 at 12:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <span class="user-mention" data-user-id="191319">@James Agnew</span>  has anyone benchmarked the HL7 FHIR Validation classes vs what HAPI provides in terms of speed?</p>



<a name="203392619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203392619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203392619">(Jul 09 2020 at 14:31)</a>:</h4>
<p>Yes stripped down, no JPA and just supports one $validate operation</p>



<a name="203398647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203398647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203398647">(Jul 09 2020 at 15:14)</a>:</h4>
<p>HAPI uses the exact same validator code that the Validator CLI does, so the performance should be comparable. HAPI uses its own built-in terminology services unlike the CLI so there are differences, but TBH I'm not sure how much difference that makes in terms of speed.</p>



<a name="203434796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203434796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203434796">(Jul 09 2020 at 20:18)</a>:</h4>
<p>could make quite a lot - the latency of the network is usually the biggest factor.</p>



<a name="203435762"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203435762" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203435762">(Jul 09 2020 at 20:26)</a>:</h4>
<p>of course the other factor is start up time; the validator has to load, and you can do this in advance if you're using HAPI</p>



<a name="203436765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203436765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203436765">(Jul 09 2020 at 20:34)</a>:</h4>
<p>Time is going to vary significantly by how many profiles need to get validated, how deeply those profiles set requirements.  Validating documents and other Bundles can get relatively time intensive.</p>



<a name="203437319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/203437319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#203437319">(Jul 09 2020 at 20:39)</a>:</h4>
<p>to help, the next release of the validator will support a parameter  -show-times that reports how long various things take</p>



<a name="206532288"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Json%20Schema%20Validation/near/206532288" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Json.20Schema.20Validation.html#206532288">(Aug 11 2020 at 01:29)</a>:</h4>
<p>We have several challenges with JSON schema, and growing interest in this. Should we create a stream specifically for json schema?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
