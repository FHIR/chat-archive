---
layout: page
title: "FHIR Chat  · How to specify a target endpoint via a RELAY · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html">How to specify a target endpoint via a RELAY</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153978363"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978363" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Berezny <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978363">(Jul 26 2018 at 15:26)</a>:</h4>
<p>I need to send FHIR resources to a target endpoint that first travels VIA an intermediary endpoint (which is an integration engine).  In otherwords, the endpoint in my POST message is always the intermediary relay endpoint, and i have to tell it where the final intended destination of the bundle is.</p>
<p>What is the most FHIR-y &amp; universal way to do this? </p>
<p>Some ideas I've had:<br>
1) Include an endpoint in the bundle that specifies the final target destination<br>
2) Include a subscription in the bundle that specifies the final target destination<br>
3) Create an extension for the bundle called .relayTarget that specifies a endpoint or subscription with the final target destination<br>
4) Do something with bundle identifiers where the intermediary endpoint builds in routing rules according to the bundle identifiers.<br>
5) others?</p>



<a name="153978376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978376">(Jul 26 2018 at 15:55)</a>:</h4>
<p>5) Add a 'route-to' query parameter to the POST URL</p>



<a name="153978387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Berezny <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978387">(Jul 26 2018 at 16:13)</a>:</h4>
<p>That's a clever idea, have you tried that before?</p>



<a name="153978390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978390">(Jul 26 2018 at 16:15)</a>:</h4>
<p>No, never had to do routing like that...but it is maybe easier to read (and faster?) and use a URL parameter instead of having to parse the bundle</p>



<a name="153978430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978430">(Jul 26 2018 at 18:40)</a>:</h4>
<p>I'd definitely recommend using either something in the URL (e.g. query parameter) or a custom HTTP header.</p>



<a name="153978446"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978446" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alfred Wong <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978446">(Jul 26 2018 at 19:23)</a>:</h4>
<p>I do like the custom header approach or query param  as I feel that it help extract that relay concept out of the FHIR resource.</p>



<a name="153978473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978473">(Jul 26 2018 at 21:25)</a>:</h4>
<p>This is a messaging routing problem, rather than an endpoint problem.</p>



<a name="153978481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978481">(Jul 26 2018 at 21:28)</a>:</h4>
<p>did make me wonder about messaging...</p>



<a name="153978483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978483">(Jul 26 2018 at 21:29)</a>:</h4>
<p>I don't see any other HTTP take on this problem... not sure why that is, but does it call the framing of the problem into question?</p>



<a name="153978509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978509">(Jul 26 2018 at 22:07)</a>:</h4>
<p>Typically you want the endpoint to either be a black box (you have no clue whether there are multiple systems on the back end, or how functionality is divided/organized) or you have multiple endpoints that all happen to resolve to the same front-end box which services as your access point/security barrier and routes things accordingly.  The approach of single endpoint, but still knowledge of back-end systems is unusual.</p>



<a name="153978660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Berezny <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978660">(Jul 27 2018 at 12:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> yes, the endpoint being a black box is a philosophy we are trying to shoot for. </p>
<p>More specifically, the overall flow we're trying to figure out is a ServiceRequest process where the relay system is the Ontario HIAL:</p>
<p>1. Send ReferralRequest: Requester &gt; HIAL &gt; Provider<br>
2. Send Appointment update back to sender: Provider &gt; HIAL &gt; Requester</p>
<p>In process 1, the requester always sends to the HIAL endpoint, and the HIAL looks up the endpoint of the requested HealthcareService in a registry, so that part is solved.<br>
In process 2, we're trying to figure out how to get updates (like appointments) back to the Requester. The provider always sends to the HIAL endpoint and then we need to figure out how to get the HIAL to route to the correct initial requester.</p>
<p>Having the provider system tell the HIAL where to send the update is one of the methods being discussed. The way that the provider system would know where to send the update to (that we've discussed so far) is either because the requester is registered with the provider system, OR the requester includes the updateEndpoint in the initial ServiceRequest payload. The  HIAL wouldn't be storing where the original ServiceRequest came from, so the receiving system would need to store that endpoint and inform the HIAL.</p>
<p><span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> mentioned that another method is to lookup the endpoint of the requester's organization in a registry for updates. </p>
<p>There are a few scenarios where ReferralRequests could go to different sources than the original request, particularly when updates are to be sent to MULTIPLE destinations, such as the requester + family doctor + referral registry + patient portal. These destinations should for the most part be known by the provider system (as you say "explicitly configured") ... and so the question is how to tell the single relay point (HIAL) to re-route to all of these spots.</p>
<p>It sounds like the options mentioned so far are:<br>
1) put final relay destinations into URL parameter<br>
2) create an extension (in the /bundle resource?) for re-routing<br>
3) lookup the organization of the request (although this doesn't solve when we want to also send to destinations other than the requester via the relay point)<br>
4) Another method we've talked about internally is having the sending system include an identifier in the initial request, which would be returned with any later updates and the HIAL would somehow be able to lookup registered endpoints based on that identifier.</p>



<a name="153978669"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978669" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978669">(Jul 27 2018 at 13:32)</a>:</h4>
<p>If you're doing REST, then you'd have a synchronous session from Requester to HIAL and HIAL to provider, so it should just "happen", no?  The call from HIAL to provider is invoked in the context of the synchronous session the HIAL starts up when responding to the requester.</p>



<a name="153978676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Berezny <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978676">(Jul 27 2018 at 14:08)</a>:</h4>
<p>For immediate responses yes it would by synchronous. However, sending updates such as adding an appointment or setting an outcome might not happen until weeks later, which would not be synchronous.</p>



<a name="153978677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/153978677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#153978677">(Jul 27 2018 at 14:11)</a>:</h4>
<p>But in that case, are you expecting to push the results?  If so, how?  If you're doing polling, that'll still by synchronous.  If you're doing subscriptions, the subscriber will be identifying their endpoint.  If you're doing messaging, you should have the information...</p>



<a name="218866986"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/How%20to%20specify%20a%20target%20endpoint%20via%20a%20RELAY/near/218866986" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/How.20to.20specify.20a.20target.20endpoint.20via.20a.20RELAY.html#218866986">(Dec 04 2020 at 17:47)</a>:</h4>
<p>FHIR Messaging would match your requirements.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
