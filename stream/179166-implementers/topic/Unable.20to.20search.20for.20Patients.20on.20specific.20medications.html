---
layout: page
title: "FHIR Chat  · Unable to search for Patients on specific medications · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html">Unable to search for Patients on specific medications</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="180655430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180655430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180655430">(Nov 13 2019 at 18:17)</a>:</h4>
<p>Hi all!<br>
I'm using the javascript fhirclient library (and currently the public sandbox for SMART on FHIR) to try and search for Patients with particular attributes. I'm currently wrestling with how to craft the search query for MedicationRequests for specific medications. For example, if I wanted to find Patients who were taking a 325 mg oral table of Acetaminophen, I know that has a code of: 313782.  I've tried a couple things:</p>
<p>Doing this search:</p>
<p>client.request(<code>/MedicationRequest?medication.code=313782</code>, {<br>
      pageLimit: 1,<br>
      flat: true<br>
    });</p>
<p>returns an empty list. So, it seems to be correctly crafted but the results are not what I expect. I know there are patients in the sandbox who have taken this pill.</p>
<p>And actually that's not the query I want. I want to use the name of the medication, not the code, so that I get ALL instances of someone taking Acetaminophen, not just the 325mg oral pill.  So, I'd like to do something like this:</p>
<p>client.request(<code>/MedicationRequest?medication.text=acetaminophen</code>, {<br>
      pageLimit: 1,<br>
      flat: true<br>
    })</p>
<p>But that returns an error:   "Invalid parameter chain: medication.text"</p>
<p>So, how do I query for medication requests that involve a particular medication (e.g. acetaminophen)</p>
<p>Many thanks!</p>



<a name="180659020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180659020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180659020">(Nov 13 2019 at 18:54)</a>:</h4>
<p>medication:text should work better.  ('text' is a qualifier that says to search the CodeableConcept.text and Coding.display elements)</p>



<a name="180660839"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180660839" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180660839">(Nov 13 2019 at 19:13)</a>:</h4>
<p>The <code>medication</code> search parameter targets <code>medicationReference</code>. You should use <code>code:text</code> to target <code>medicationCodeableConcept</code> (but it won't work on most servers)</p>



<a name="180661031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180661031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180661031">(Nov 13 2019 at 19:14)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> Thank you for the help! Feels like I'm on the right track, but not quite there.</p>
<p>So, doing this returns an empty list:</p>
<div class="codehilite"><pre><span></span>client.request(`/MedicationRequest?medication:text=Acetaminophen`, {
      pageLimit: 1,
      resolveReferences: [&quot;MedicationReference&quot;],
      flat: true
    })
</pre></div>


<p>But if I were instead to not qualify my search at all, and just get ALL MedicationRequests back, I do see some that look like this:</p>
<div class="codehilite"><pre><span></span>authoredOn: &quot;2017-07-03T05:38:05-04:00&quot;
dosageInstruction: [{…}]
encounter: {reference: &quot;Encounter/5530d672-fb57-4edd-85de-81af6c89930b&quot;}
id: &quot;448595e7-fc3c-4a04-bef1-91483b8a4ea8&quot;
intent: &quot;order&quot;
medicationCodeableConcept:
  coding: Array(1)
    0:
      code: &quot;313782&quot;
      display: &quot;Acetaminophen 325 MG Oral Tablet&quot;
      system: &quot;http://www.nlm.nih.gov/research/umls/rxnorm&quot;
      __proto__: Object
    length: 1
  __proto__: Array(0)
  text: &quot;Acetaminophen 325 MG Oral Tablet&quot;
__proto__: Object
meta: {versionId: &quot;3&quot;, lastUpdated: &quot;2019-06-06T02:59:27.248-04:00&quot;, tag: Array(1)}
requester: {reference: &quot;Practitioner/85aeca59-6261-4704-a2e4-1846ec5831a6&quot;}
resourceType: &quot;MedicationRequest&quot;
status: &quot;stopped&quot;
subject: {reference: &quot;Patient/2c4e4abf-b81d-4791-9046-7cdff816061f&quot;}
</pre></div>


<p><a href="/user_uploads/10155/-Y-8adFUt88bP1vUT6v0F9OA/Screen-Shot-2019-11-13-at-11.10.13-AM.png" target="_blank" title="Screen-Shot-2019-11-13-at-11.10.13-AM.png">Screen-Shot-2019-11-13-at-11.10.13-AM.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/-Y-8adFUt88bP1vUT6v0F9OA/Screen-Shot-2019-11-13-at-11.10.13-AM.png" target="_blank" title="Screen-Shot-2019-11-13-at-11.10.13-AM.png"><img src="/user_uploads/10155/-Y-8adFUt88bP1vUT6v0F9OA/Screen-Shot-2019-11-13-at-11.10.13-AM.png"></a></div><p>Any idea what I'm doing wrong? Thanks again!</p>



<a name="180663865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180663865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180663865">(Nov 13 2019 at 19:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191912">@Michele Mottini</span> Thanks for help! So, I've tried both ways, both this:</p>
<div class="codehilite"><pre><span></span>client.request(`/MedicationRequest?code:text=acetaminophen`, {
      pageLimit: 1,
      resolveReferences: [&quot;MedicationReference&quot;],
      flat: true
    })
</pre></div>


<p>and this</p>
<div class="codehilite"><pre><span></span>    client.request(`/MedicationRequest?medication:text=acetaminophen`, {
      pageLimit: 1,
      resolveReferences: [&quot;MedicationReference&quot;],
      flat: true
    })
</pre></div>


<p>And both just return empty lists. Do you think this type of search is simply not supported? Seems like search for patients taking a specific medication would be a reasonable thing to do.</p>
<p>Thank you!</p>



<a name="180665767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180665767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180665767">(Nov 13 2019 at 20:03)</a>:</h4>
<p>My guess would be that the server does not support <code>:text</code> - can you find the MedicationRequest using the actual medication code instead than its display name? (medication:text is surely wrong - :text does not apply to reference search params)</p>



<a name="180670646"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180670646" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180670646">(Nov 13 2019 at 20:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191912">@Michele Mottini</span>  Ooh, yes I can.  Doing this:</p>
<div class="codehilite"><pre><span></span>client.request(`/MedicationRequest?code=313782`, {
      pageLimit: 1,
      resolveReferences: [&quot;MedicationReference&quot;],
      flat: true
    })
</pre></div>


<p>Returns a page of excellent results. It's just that the exact code is way too specific. I need ALL medication requests with a particular substring in the medication name. </p>
<p>Do you think search is simply not supported?</p>
<p>Many thanks!</p>



<a name="180671165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180671165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180671165">(Nov 13 2019 at 20:52)</a>:</h4>
<p>Yes, <code>:text</code> (that would be the way to do it) appear not t be supported. I do not know of any production server that implements it.</p>



<a name="180672248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180672248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180672248">(Nov 13 2019 at 21:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191912">@Michele Mottini</span> Ok, that's the info I needed.  I'll find another way to get my users their data. Thank you so much!</p>



<a name="180740695"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180740695" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180740695">(Nov 14 2019 at 15:25)</a>:</h4>
<p>We implemented <code>:text</code> in the Google server but testing this example led me to discover a bug where the modifier doesn't trigger at the end of a chained search. So we can do code:text but not medication.code:text. <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span></p>



<a name="180802093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Unable%20to%20search%20for%20Patients%20on%20specific%20medications/near/180802093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Unable.20to.20search.20for.20Patients.20on.20specific.20medications.html#180802093">(Nov 15 2019 at 04:45)</a>:</h4>
<p>Does the server support medication._text (a text search over all text in the Medication resource?) Unlikely, but one never knows..</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
