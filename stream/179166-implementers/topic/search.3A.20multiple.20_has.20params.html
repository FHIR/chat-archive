---
layout: page
title: "FHIR Chat  · search: multiple _has params · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html">search: multiple _has params</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153951262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153951262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153951262">(Apr 06 2018 at 21:05)</a>:</h4>
<p><a href="http://build.fhir.org/search.html#has" target="_blank" title="http://build.fhir.org/search.html#has">http://build.fhir.org/search.html#has</a> says that when there are multiple _has parameters, they are processed independently of other _has parameters. So if I have a model like below:</p>
<p>pat1 &lt;- obs1 (category: abc, code=xyz)<br>
pat2 &lt;- obs2 (category: hhh, code=yyy)</p>
<p>and I do a search like Patient?_has:Observation:subject:category=abc&amp;_has:Observation:subject:code=yyy I should get both pat1 and pat2?</p>



<a name="153951263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153951263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153951263">(Apr 06 2018 at 21:09)</a>:</h4>
<p>If that's the case, then the reference servers I tested do not behave that way. <a href="http://tx.fhir.org/r4" target="_blank" title="http://tx.fhir.org/r4">tx.fhir.org/r4</a> gives me an error right now but HAPI and Vonk both give me zero results instead of 2.</p>
<p>Attached is a transaction bundle for a test case that I ran against Vonk. The last entry in the bundle contains the multiple _has parameters.<a href="/user_uploads/10155/nQTj4hcm5N7PKTeuMLC0DHgG/multiple_has_testcase_tx_bundle.xml" target="_blank" title="multiple_has_testcase_tx_bundle.xml">multiple_has_testcase_tx_bundle.xml</a></p>



<a name="153951264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153951264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153951264">(Apr 06 2018 at 21:15)</a>:</h4>
<p>Sorry ignore the previous attachment because it had an error. Use this instead: <a href="/user_uploads/10155/t4A2TBK8JJsQMDVkLcYmZe1R/multiple_has_testcase_tx_bundle.xml" target="_blank" title="multiple_has_testcase_tx_bundle.xml">multiple_has_testcase_tx_bundle.xml</a></p>



<a name="153951443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153951443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lilian Minne <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153951443">(Apr 09 2018 at 12:34)</a>:</h4>
<p>Hi Michael,</p>
<p>The expected result of your query is that it returns patients that have both an observation with category=abc AND an observation with category=yyy. Which is indeed the case for zero patients in your example. However, if you would add a third observation to patient 2:</p>
<p>pat2 &lt;- obs3 (category:abc, code=xyz)</p>
<p>then your query would return pat2. </p>
<p>The meaning of processing the _has parameters independently is that they do not refer to the same Observation. So if you change the query to: Patient?_has:Observation:subject:category=abc&amp;_has:Observation:subject:code=xyz this would still not return pat1.</p>
<p>I hope this explanation helps!</p>
<p>Lilian</p>



<a name="153951466"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153951466" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153951466">(Apr 09 2018 at 13:58)</a>:</h4>
<p>Hello Lilian - thanks for the explanation.</p>
<p>My confusion stems from the fact that <a href="http://build.fhir.org/search.html#has" target="_blank" title="http://build.fhir.org/search.html#has">http://build.fhir.org/search.html#has</a> mentions that "each _has parameter is processed independently of other _has parameters" but doesn't give an example. So I looked through the rest of the spec and found <a href="http://build.fhir.org/search.html#chaining" target="_blank" title="http://build.fhir.org/search.html#chaining">http://build.fhir.org/search.html#chaining</a>, which gives this example:</p>
<blockquote>
<p>Note that chained parameters are applied independently to the target resource. For example,</p>
<p>GET Patient?general-practitioner.name=Joe&amp;general-practitioner.address-state=MN</p>
<p>may return Patients cared for by Joe from CA and Jane from MN: no one practitioner need satisfy both conditions. E.g. the chains are evaluated separately. For use cases where the joins must be evaluated in groups, there are either Composite search parameters, or the _filter parameter.</p>
</blockquote>
<p>So I inferred that the behavior of 'multiple _has parameter' is the same as the excerpt above, except that it is in reverse. And, my original understanding of the excerpt's example above is:</p>
<p>Example data:<br>
pat1 -&gt; prac1 (name: Joe, address-state: CA)<br>
pat2 -&gt; prac2 (name: Jane, address-state: MN)<br>
pat3 -&gt; prac1 and prac2</p>
<p>My original understanding was the search 'Patient?general-practitioner.name=Joe&amp;general-practitioner.address-state=MN' would return all three (i.e. because of 'may return Patients' phrase). But from your explanation it sounds like it should only return pat3. Is that right?</p>



<a name="153951467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153951467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lilian Minne <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153951467">(Apr 09 2018 at 14:27)</a>:</h4>
<p>Hi Michael, that's correct. I understand the confusion though :) <br>
<span class="user-mention" data-user-id="191328">@Ewout Kramer</span> is this something to add in the explanation in the specs?</p>



<a name="153952241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153952241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153952241">(Apr 13 2018 at 14:53)</a>:</h4>
<blockquote>
<p>Hi Michael, that's correct. I understand the confusion though :) <br>
<span class="user-mention" data-user-id="191328">@Ewout Kramer</span> is this something to add in the explanation in the specs?</p>
</blockquote>
<p>Yes, so the "independently" does not mean OR, indeed.  It's worth creating a gForge ticket item for, so we can discuss it more widely.</p>



<a name="153952264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/search%3A%20multiple%20_has%20params/near/153952264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/search.3A.20multiple.20_has.20params.html#153952264">(Apr 13 2018 at 15:49)</a>:</h4>
<p>Ok thanks. I will get around to creating the ticket sometime today (if no one else has done it).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
