---
layout: page
title: "FHIR Chat  · XML parsing and XXE attacks · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html">XML parsing and XXE attacks</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153822419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822419">(Apr 19 2016 at 05:09)</a>:</h4>
<p>For any server implementers, it's probably worth looking at this issue just opened on HAPI <br>
<a href="https://github.com/jamesagnew/hapi-fhir/issues/339​" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/issues/339​">https://github.com/jamesagnew/hapi-fhir/issues/339​</a> and the associated XXE links about the issue and a mitigation</p>



<a name="153822439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822439">(Apr 19 2016 at 09:06)</a>:</h4>
<p>Thanks Michael, i have added this as a todo on the .NET XML parser as well.</p>



<a name="153822445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822445">(Apr 19 2016 at 09:41)</a>:</h4>
<p>Have you looked into it yet Ewout?</p>



<a name="153822449"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822449" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822449">(Apr 19 2016 at 09:50)</a>:</h4>
<p>Just checked the dotnet XML Serializer<br>
<code>settings.IgnoreProcessingInstructions = true;</code></p>



<a name="153822450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822450">(Apr 19 2016 at 10:40)</a>:</h4>
<p>Seems that msxml is not affected? It's hard to find good information about this!</p>



<a name="153822452"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822452" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822452">(Apr 19 2016 at 11:07)</a>:</h4>
<p>this is in the dotnet System.Xml.XmlReader class that we use.</p>



<a name="153822453"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822453" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822453">(Apr 19 2016 at 11:07)</a>:</h4>
<p>(not necessarily the msxml parser)</p>



<a name="153822459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822459">(Apr 19 2016 at 12:15)</a>:</h4>
<p>See <a href="https://github.com/ewoutkramer/fhir-net-api/issues/190" target="_blank" title="https://github.com/ewoutkramer/fhir-net-api/issues/190">https://github.com/ewoutkramer/fhir-net-api/issues/190</a>.</p>
<p>Verified resilience with a unit-test, .NET parser refuses to parse this DTD</p>



<a name="153822465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822465">(Apr 19 2016 at 13:50)</a>:</h4>
<p>For a test case: POST this to [base]/ValueSet/$expand</p>
<p>&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "file:///etc/"&gt;]&gt; &lt;Parameters xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>" &gt;&lt;parameter&gt; &lt;name value="identifier" /&gt;&lt;valueUri value="<a href="http://snomed.info/sct/32506021000036107/version/20120531?fhir_vs=isa/900000000000455006" target="_blank" title="http://snomed.info/sct/32506021000036107/version/20120531?fhir_vs=isa/900000000000455006">http://snomed.info/sct/32506021000036107/version/20120531?fhir_vs=isa/900000000000455006</a>" /&gt;&amp;xxe; &lt;/parameter&gt;&lt;/Parameters&gt;</p>



<a name="153822507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822507">(Apr 19 2016 at 20:05)</a>:</h4>
<p>so, the maintainers of the reference implementations just discussed this. In order to protect against this, we have to turn off all processing of entities - we can't just turn off some of them</p>



<a name="153822508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822508">(Apr 19 2016 at 20:06)</a>:</h4>
<p>the upshot of this is that we propose to make a new rule: no entity definitions in the xml. Only pre-defined entities allowed. </p>



<a name="153822582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822582">(Apr 20 2016 at 09:03)</a>:</h4>
<p>The "pre-defined ones" including the "normal" character entities. Now to decide which those are, I didn't know there were this much: <a href="https://dev.w3.org/html5/html-author/charref" target="_blank" title="https://dev.w3.org/html5/html-author/charref">https://dev.w3.org/html5/html-author/charref</a></p>



<a name="153822590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822590">(Apr 20 2016 at 10:16)</a>:</h4>
<p>DTDs for XHTML entities: <a href="https://www.w3.org/TR/xhtml1/dtds.html#h-A2" target="_blank" title="https://www.w3.org/TR/xhtml1/dtds.html#h-A2">https://www.w3.org/TR/xhtml1/dtds.html#h-A2</a></p>



<a name="153822592"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822592" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822592">(Apr 20 2016 at 10:55)</a>:</h4>
<p>Y. That's the list I used. The link I sent has many more, like <code>&amp;dopf;</code></p>



<a name="153822594"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822594" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822594">(Apr 20 2016 at 11:07)</a>:</h4>
<p>Aha, apparently HTML5 introduced some new entities.</p>



<a name="153822600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822600">(Apr 20 2016 at 11:53)</a>:</h4>
<p>we're using xhtml, not html. the only entities defined are those in xml, not xhtml </p>



<a name="153822715"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822715" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822715">(Apr 21 2016 at 07:49)</a>:</h4>
<p>Well, there might be some in the narrative too, which is xhtml. It's a different namespace, but I'd think it would be surprising to the user if it's allowed in one place but not in the other.  If I look at this: <a href="https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references" target="_blank" title="https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references">https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references</a>, it seems there are only a few xml entities. I'd really like to support stuff like &amp;ecirc; for common diacritics in (european) languages...</p>



<a name="153822737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822737">(Apr 21 2016 at 13:42)</a>:</h4>
<p>FYI to any HAPI users, a new release is now in the Maven stable repos (1.5) which addresses this issue.</p>



<a name="153822738"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153822738" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153822738">(Apr 21 2016 at 13:45)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span> I'm not thrilled with the notion of supporting things that aren't valid XHTML.  I don't think we can count on support for those in a lot of off-the-shelf tools.  Plus it creates technical issues with the spec.</p>



<a name="153823114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153823114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153823114">(Apr 26 2016 at 14:10)</a>:</h4>
<p>Well, I had to support it (just like the Java implementation I guess), since our examples had those entities in them. But sure, we could discuss removing this support....</p>



<a name="153823115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153823115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153823115">(Apr 26 2016 at 14:13)</a>:</h4>
<p>I don't think you'll find them in any examples any more</p>



<a name="153823116"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153823116" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153823116">(Apr 26 2016 at 14:13)</a>:</h4>
<p>they're not valid, and I don't think anything like this still escapes testing</p>



<a name="153823117"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XML%20parsing%20and%20XXE%20attacks/near/153823117" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XML.20parsing.20and.20XXE.20attacks.html#153823117">(Apr 26 2016 at 14:14)</a>:</h4>
<p>though I eliminated some from the json examples while on the plane</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
