---
layout: page
title: "FHIR Chat  · SMART: Register with multiple EMRs · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html">SMART: Register with multiple EMRs</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153941752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Martin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941752">(Mar 02 2018 at 13:03)</a>:</h4>
<p>In the SMART Simple authorization app here:<br>
<a href="http://docs.smarthealthit.org/tutorials/authorization/" target="_blank" title="http://docs.smarthealthit.org/tutorials/authorization/">http://docs.smarthealthit.org/tutorials/authorization/</a> </p>
<p>And in the Cerner Sandbox tutorial here:<br>
<a href="http://engineering.cerner.com/smart-on-fhir-tutorial/" target="_blank" title="http://engineering.cerner.com/smart-on-fhir-tutorial/">http://engineering.cerner.com/smart-on-fhir-tutorial/</a> </p>
<p>There is a step in the process of making a SMART application that requires the application to be registered with the EHR.  The EHR then provides an application id.  This application id is then hardcoded into the redirect page:</p>
<div class="codehilite"><pre><span></span>&lt;script&gt;
  FHIR.oauth2.authorize({
    &#39;client_id&#39;: &#39;d6b5406a-fb9e-439e-987e-d1afd0c5ee2c&#39;,
    &#39;scope&#39;:  &#39;patient/Patient.read patient/Observation.read launch online_access openid profile&#39;
  });
&lt;/script&gt;
</pre></div>


<p>This seems to limit the application to a single EHR vendor that is hardcoded (or require the SMART application to maintain some sort of map of registered EHRs and client_id values).  </p>
<p>Is there a standard way to allow a SMART application to be registered with multiple EHR endpoints?  Is there a standard way I can add the application I created for the Cerner sandbox to also use the SMART sandbox at <a href="https://sandbox.smarthealthit.org/smartdstu2#/manage-apps" target="_blank" title="https://sandbox.smarthealthit.org/smartdstu2#/manage-apps">https://sandbox.smarthealthit.org/smartdstu2#/manage-apps</a>?  </p>
<p>What have others done in the past?</p>



<a name="153941776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941776">(Mar 02 2018 at 15:06)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span></p>



<a name="153941777"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941777" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941777">(Mar 02 2018 at 15:07)</a>:</h4>
<p>In general you'll need a map of clients IDs, and you'd look up an entry bases on the launch issuer. <span class="user-mention" data-user-id="191355">@Kevin Shekleton</span> <span class="user-mention" data-user-id="191356">@Jenni Syed</span>  do you agree it'd make sense to generalize this example?</p>



<a name="153941789"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941789" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941789">(Mar 02 2018 at 15:44)</a>:</h4>
<p>Sure, generalizing this would be fine. The SMART tutorial we wrote here at Cerner is open source and we would love any PRs to improve it! <span class="emoji emoji-1f604" title="smile">:smile:</span></p>



<a name="153941790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941790">(Mar 02 2018 at 15:51)</a>:</h4>
<p>Also, the tutorial we wrote isn't intended to be used as production code which is why we kept it as simple as possible. With that being said, I realize that most people start from some example code snippet and use that as the basis for their production apps (I see that all the time)</p>



<a name="153941791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941791">(Mar 02 2018 at 15:51)</a>:</h4>
<p>In production, you definitely would need to map client ids to launch issuers</p>



<a name="153941800"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941800" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Berezny <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941800">(Mar 02 2018 at 18:22)</a>:</h4>
<p>I have a similar-ish question, In my SMART app I want to map <br>
a) users from and EMR to their existing accounts in my application<br>
b) patients in an EMR to corresponding information about that patient in my application (i.e.,  Lookup of the status of referrals in a SMART app for a patient that were previously submitted via a SMART app)</p>
<p>What approaches have people taken to do this, my current thought is as follows</p>
<p>For a), look up the in-context user data launching the SMART app, and in conjunction with a registered app ClientID map the user to an existing user in my application?<br>
I thought that perhaps also when the user launches my SMART app for the first time, it could include a step when they open the window to ask for the user's credentials in my application, and then save the in-context user info in conjunction with the Client ID so that they don't need to enter their credentials to my application the second time.</p>
<p>for b), user the EMR supplied patient ID, and in conjunction with the client ID, map to the patient data saved in my application.</p>
<p>Are there others show have experienced similar processes?</p>



<a name="153941804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941804">(Mar 02 2018 at 18:50)</a>:</h4>
<p>The trick is how to assure that the electronic user identity is indeed that which is know as the patient identity. Once you get this confirmed, then it is just a mapping as you have identified (provided stable identity pools).  I have a short article on this <a href="https://healthcaresecprivacy.blogspot.com/2016/02/patient-as-user-becoming-known-to.html" target="_blank" title="https://healthcaresecprivacy.blogspot.com/2016/02/patient-as-user-becoming-known-to.html">https://healthcaresecprivacy.blogspot.com/2016/02/patient-as-user-becoming-known-to.html</a></p>



<a name="153941805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Martin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941805">(Mar 02 2018 at 18:58)</a>:</h4>
<p>Also</p>
<p>On this page:<br>
<a href="http://docs.smarthealthit.org/tutorials/server-quick-start/" target="_blank" title="http://docs.smarthealthit.org/tutorials/server-quick-start/">http://docs.smarthealthit.org/tutorials/server-quick-start/</a> </p>
<p>The link for "SMART on FHIR Authorization protocols" (<a href="http://docs.smarthealthit.org/authorization/public" target="_blank" title="http://docs.smarthealthit.org/authorization/public">http://docs.smarthealthit.org/authorization/public</a>) in the paragraph shown below seems to be broken:</p>
<p>Once you’ve implemented the SMART on FHIR Authorization protocols, you can wire up your “launch” button to launch the app in production mode (with authorization) by completing the following sequence:</p>



<a name="153941811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Martin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941811">(Mar 02 2018 at 19:31)</a>:</h4>
<p>Also...</p>
<p>Does someone have an answer for this question on stackoverflow?<br>
<a href="https://stackoverflow.com/questions/49057210/in-a-smart-fhir-application-can-the-application-authenticate-the-ehr" target="_blank" title="https://stackoverflow.com/questions/49057210/in-a-smart-fhir-application-can-the-application-authenticate-the-ehr">https://stackoverflow.com/questions/49057210/in-a-smart-fhir-application-can-the-application-authenticate-the-ehr</a> </p>
<p>Thanks</p>



<a name="153941861"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941861" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941861">(Mar 02 2018 at 23:30)</a>:</h4>
<p>Responded to the Stackoverflow question.</p>



<a name="153941862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941862">(Mar 02 2018 at 23:30)</a>:</h4>
<p><a href="https://github.com/smart-on-fhir/smart-on-fhir.github.io/commit/49de3d31116328a32c8354e082d574189b2e2a9a#diff-2ed410309a14b83097890c3c6d9fdf74" target="_blank" title="https://github.com/smart-on-fhir/smart-on-fhir.github.io/commit/49de3d31116328a32c8354e082d574189b2e2a9a#diff-2ed410309a14b83097890c3c6d9fdf74">Fixed</a> broken link</p>



<a name="153941872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941872">(Mar 03 2018 at 00:06)</a>:</h4>
<p>Josh - you get a signed openid token too- isn't that a verification point?</p>



<a name="153941907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941907">(Mar 03 2018 at 04:49)</a>:</h4>
<p>The openid token comes after the launch is complete -- yes, that's signed and non-repudiable. But as far as just authenticating: the entire token response comes from the TLS-protected EHR authorization server, so should fit the bill.</p>



<a name="153941908"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMART%3A%20Register%20with%20multiple%20EMRs/near/153941908" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMART.3A.20Register.20with.20multiple.20EMRs.html#153941908">(Mar 03 2018 at 04:51)</a>:</h4>
<p>On <span class="user-mention" data-user-id="193959">@Tim Berezny</span>'s question, there are a few ways to skin this:</p>
<p>1. Pure relying party.  Allow users to sign into your app via OIDC, where the SMART EHR acts as an ID provider.<br>
2. Hybrid. Allow users to create accounts within your app using their own credentials (e.g., username + password) and allow each account to be associated with 0..* EHR-supplied IDs. This requires some setup the first time for each user, but after that point users can sign in with an EHR account or with credentials you supply.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
