---
layout: page
title: "FHIR Chat  · Validator problem with  terminology server · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html">Validator problem with  terminology server</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="182420177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/182420177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eizen Kimura <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#182420177">(Dec 03 2019 at 06:26)</a>:</h4>
<p>Hello,<br>
I tried to validate my custom CodeSystem/Valueset with some resources.<br>
I have setup HAPI server and tried with the following validator parameters.</p>
<p>java -jar org.hl7.fhir.validator.jar -tx <a href="http://localhost:8080/hapi-fhir-jpaserver/fhir/" target="_blank" title="http://localhost:8080/hapi-fhir-jpaserver/fhir/">http://localhost:8080/hapi-fhir-jpaserver/fhir/</a> -txLog term.txt -debug -version 4.0 Sample_CKUP_Observation.json -ig CKUP_Observation.StructureDefinition.xml   </p>
<p>Even if I explicitly specified parameters to use FHIR R4, however, validator seems to access with FHIR R5 Specs.<br>
How to workarounds? And if the source code of validator is hosted in GitHub etc, I may be able to contribute something.</p>
<p>Thank you.</p>
<p>.. FHIR Version 4.0, definitions from hl7.fhir.r4.core#4.0.1<br>
  .. connect to tx server @ <a href="http://localhost:8080/hapi-fhir-jpaserver/fhir/" target="_blank" title="http://localhost:8080/hapi-fhir-jpaserver/fhir/">http://localhost:8080/hapi-fhir-jpaserver/fhir/</a><br>
    (v4.0.1)<br>
+  .. load IG from CKUP_Observation.StructureDefinition.xml</p>
<ul>
<li>load file: CKUP_Observation.StructureDefinition.xml .. success<br>
  .. validate [Sample_CKUP_Observation.json]<br>
Terminology server: Check for supported code systems for <a href="http://loinc.org" target="_blank" title="http://loinc.org">http://loinc.org</a><br>
<em>FAILURE</em> validating Sample_CKUP_Observation.json:  error:1 warn:0 info:0<br>
  Error @ Observation.code.coding[0] (line 6, col8) : Error java.lang.ClassCastException: class org.hl7.fhir.r5.model.CapabilityStatement cannot be cast to class org.hl7.fhir.r5.model.TerminologyCapabilities (org.hl7.fhir.r5.model.CapabilityStatement and org.hl7.fhir.r5.model.TerminologyCapabilities are in unnamed module of loader 'app') validating Coding: org.hl7.fhir.exceptions.TerminologyServiceException: java.lang.ClassCastException: class org.hl7.fhir.r5.model.CapabilityStatement cannot be cast to class org.hl7.fhir.r5.model.TerminologyCapabilities (org.hl7.fhir.r5.model.CapabilityStatement and org.hl7.fhir.r5.model.TerminologyCapabilities are in unnamed module of loader 'app')</li>
</ul>



<a name="182425830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/182425830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#182425830">(Dec 03 2019 at 08:36)</a>:</h4>
<p>the validator uses the R5 code base internally. The problem isn't the version thing, it's that API hasn't implemented the TerminologyCapabilities Resource yet, and so doesn't support the validator</p>



<a name="182502392"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/182502392" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eizen Kimura <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#182502392">(Dec 03 2019 at 22:12)</a>:</h4>
<p>Thank you for your comment. If a Terminology Server that supports R5 comes out, I'll  try again.</p>
<blockquote>
<p>the validator uses the R5 code base internally. The problem isn't the version thing, it's that API hasn't implemented the TerminologyCapabilities Resource yet, and so doesn't support the validator</p>
</blockquote>



<a name="182502418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/182502418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#182502418">(Dec 03 2019 at 22:12)</a>:</h4>
<p><a href="http://tx.fhir.org" target="_blank" title="http://tx.fhir.org">tx.fhir.org</a> and ontoserver support the validator for R4.</p>



<a name="182502435"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/182502435" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#182502435">(Dec 03 2019 at 22:13)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> are you planning to add support for TerminologyCapabilities.</p>



<a name="182502441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/182502441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#182502441">(Dec 03 2019 at 22:13)</a>:</h4>
<p>the issue is not R5</p>



<a name="252191835"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/252191835" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#252191835">(Sep 06 2021 at 15:31)</a>:</h4>
<p>Our team also ran into challenges using HAPI as a TX server with hl7validator...</p>
<p>The <code>metadata?_summary=true</code>, and <code>metadata?mode=terminology</code> calls seem to work fine - but are followed by an exception. Let me collect some more detail, maybe a next layer of the onion...</p>



<a name="252262647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/252262647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#252262647">(Sep 07 2021 at 07:28)</a>:</h4>
<p>With a current hl7-validator it get's the CapabilityStatement from HAPI as TX, but cannot read it:</p>
<p><code>Caused by: java.lang.ClassCastException: class org.hl7.fhir.r5.model.CapabilityStatement cannot be cast to class org.hl7.fhir.r5.model.TerminologyCapabilities (org.hl7.fhir.r5.model.CapabilityStatement and org.hl7.fhir.r5.model.TerminologyCapabilities are in unnamed module of loader 'app')</code><br>
which seems to be the same as <span class="user-mention" data-user-id="211972">@Eizen Kimura</span> got back in 2019.. see above</p>
<p>Looks like hl7-validator expects, when it asks for "metadata?mode=terminology", only the &lt;TerminologyCapabilities&gt; part. HAPI returns that embedded in the overall &lt;CapabilityStatement&gt;, while <a href="http://tx.fhir.org">tx.fhir.org</a> and <a href="http://r4.ontoserver.csiro.au">r4.ontoserver.csiro.au</a> return only the &lt;TerminologyCapabilities&gt; part, which then _is_ accepted by hl7-validator.</p>
<ul>
<li>HAPI FHIR Server - 5.4.2</li>
<li>FHIR Validation tool Version 5.4.9 and  5.5.1 </li>
</ul>
<p>Has anyone been using the hl7validator with HAPI as TX succesfully? <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191319">@James Agnew</span> </p>
<p>Thank you for all your support!</p>
<p>PS: will want to use with both STU3 and R4 - and corresponding hl7validator TerminologyClients.<br>
PS: we're in part forced to look into this - alternative tx - because <a href="http://tx.fhir.org">tx.fhir.org</a> being down so often...</p>



<a name="252362032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/252362032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#252362032">(Sep 07 2021 at 19:49)</a>:</h4>
<p><a href="http://tx.fhir.org">tx.fhir.org</a> is down extremely rarely. So you should investigate why you wrongly think it is</p>



<a name="252365613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/252365613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#252365613">(Sep 07 2021 at 20:14)</a>:</h4>
<p>That wasn't our experience over the summer Grahame.  I agree that it's gotten much better the last month or so, but those issues are recent enough that there's certainly not going to be an impression of "high reliability".</p>



<a name="252366678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/252366678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#252366678">(Sep 07 2021 at 20:22)</a>:</h4>
<p>well, I was absent, and the system went through some major disaster who's source I still haven't figured out, and the patch arrangements put in place while I was gone locked the server into instability. However I've invested deeply in stability in the last few weeks since I got back - my main priority. And it's much more stable now, though I'm still not there yet</p>



<a name="252366863"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/252366863" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#252366863">(Sep 07 2021 at 20:24)</a>:</h4>
<p>and <span class="user-mention" data-user-id="194580">@David Simons</span> issues are extremely recent, and described while the server is actually up</p>



<a name="252441900"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validator%20problem%20with%20%20terminology%20server/near/252441900" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Simons <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validator.20problem.20with.20.20terminology.20server.html#252441900">(Sep 08 2021 at 11:14)</a>:</h4>
<p>Thanks - and sorry to mix up topics. <br>
Let's keep this thread on HL7Validator+HAPI, <br>
and discuss <a href="http://tx.fhir.org">tx.fhir.org</a> availability here: <a href="#narrow/stream/179252-IG-creation/topic/Term.20server.20is.20down.2E.2E.2E">https://chat.fhir.org/#narrow/stream/179252-IG-creation/topic/Term.20server.20is.20down.2E.2E.2E</a> .</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
