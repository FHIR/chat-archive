---
layout: page
title: "FHIR Chat  · Bundle schema · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html">Bundle schema</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153872835"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153872835" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Coates <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153872835">(Feb 20 2017 at 15:18)</a>:</h4>
<p>Hi just spotted the mismatch between how a DSTU2 Bundle is built in JSON vs XML. It would seem that the JSON structure doesn't match the UML or the Structure views? Is this intentional, is there a reason for it?  The key difference I'm struggling with is the difference between /Bundle/entry/resource[array] and /Bundle/entry[array]/resource</p>



<a name="153872849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153872849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153872849">(Feb 20 2017 at 17:17)</a>:</h4>
<p>The difference is the presence in XML of the wrapper element- json follows the logical model more closely</p>



<a name="153872858"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153872858" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153872858">(Feb 20 2017 at 18:59)</a>:</h4>
<p><span class="user-mention" data-user-id="192325">@Tim Coates</span> Can you submit a change proposal?</p>



<a name="153872865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153872865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153872865">(Feb 20 2017 at 21:18)</a>:</h4>
<p>What change?</p>



<a name="153872871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153872871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153872871">(Feb 20 2017 at 23:21)</a>:</h4>
<p>Sorry, wrong thread.</p>



<a name="153873020"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873020" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Coates <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873020">(Feb 22 2017 at 09:08)</a>:</h4>
<p>Really? (Looking at DSTU) The tree view shows in the entry element it has 0..1 resource child elements. XML does this, but JSON has one entry, with an array of resources (and hence IMHO does not follow the logical model). Either serialisation format could implement either approach, the fact they're different is what trips me up.</p>



<a name="153873273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873273">(Feb 24 2017 at 19:02)</a>:</h4>
<p>DomainResource, contained is 0..* resource. </p>
<p>So the json representation is an array of resources. <br>
The xml representation is a repeating element 'contained' that each contains a resource </p>



<a name="153873274"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873274" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873274">(Feb 24 2017 at 19:02)</a>:</h4>
<p>the special thing is that XML has an extra element in there for the resource root element that json doesn't. It's xml that varies from repreesneting the logical model directly</p>



<a name="153873521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Coates <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873521">(Feb 26 2017 at 10:34)</a>:</h4>
<p>It's the json entry having multiple resources that caused us a problem. According to <a href="https://www.hl7.org/fhir/bundle.html" target="_blank" title="https://www.hl7.org/fhir/bundle.html">https://www.hl7.org/fhir/bundle.html</a> Bundle.entry has 0..1 resources, but in the json serialisation that's not the case. We can work with it, just seems an unnecessary variation.</p>



<a name="153873522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873522">(Feb 26 2017 at 10:38)</a>:</h4>
<p>where in the json serialisation is that not the case?</p>



<a name="153873781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Coates <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873781">(Feb 27 2017 at 10:57)</a>:</h4>
<p>So when I retrieve (using HAPI client code) a Bundle from our server in XML, and serialise it as XML, I see a sequence of 'entry' objects each holding one 'resource': </p>
<p>&lt;type value="searchset"/&gt;<br>
&lt;total value="4"/&gt;<br>
&lt;entry&gt;<br>
  &lt;resource&gt;<br>
    &lt;DocumentReference xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
  &lt;/resource&gt;<br>
&lt;/entry&gt;<br>
&lt;entry&gt;<br>
  &lt;resource&gt;<br>
    &lt;DocumentReference xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
  &lt;/resource&gt;<br>
&lt;/entry&gt;<br>
&lt;entry&gt;<br>
  &lt;resource&gt;<br>
    &lt;DocumentReference xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
  &lt;/resource&gt;<br>
&lt;/entry&gt;<br>
&lt;entry&gt;<br>
  &lt;resource&gt;<br>
    &lt;DocumentReference xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
  &lt;/resource&gt;<br>
&lt;/entry&gt;</p>
<p>But when I serialise that same Bundle to JSON it's one 'entry' which has an array of 'resource' elements: <br>
"type": "searchset",<br>
"total": 4,<br>
"entry": [<br>
  {<br>
    "resource": {<br>
      "resourceType": "DocumentReference",<br>
    }<br>
  },<br>
  {<br>
    "resource": {<br>
      "resourceType": "DocumentReference",<br>
    }<br>
  },<br>
  {<br>
    "resource": {<br>
      "resourceType": "DocumentReference",<br>
    }<br>
  },<br>
  {<br>
    "resource": {<br>
      "resourceType": "DocumentReference",<br>
    }<br>
  }<br>
]</p>



<a name="153873783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873783">(Feb 27 2017 at 11:01)</a>:</h4>
<p>Yes, that's expected and that's usually how array serialization between XML and JSON differs. Each <code>&lt;entry&gt;...&lt;/entry&gt;</code> is one entry in XML, and each <code>{...}</code> in "entry" is one entry in JSON. Does this make sense?</p>



<a name="153873785"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873785" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Coates <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873785">(Feb 27 2017 at 11:06)</a>:</h4>
<p>I can follow how it 'is' implemented and we can work around it, but I don't understand 'why' they differ. I'd have thought either serialisation could easily implement either approach, and ideally they'd take the same approach.</p>



<a name="153873786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20schema/near/153873786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20schema.html#153873786">(Feb 27 2017 at 11:07)</a>:</h4>
<p>no. JSON forces there to be a difference from XML. you cannot repeat named properties in json, and you cannot do json arrays in xml</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
