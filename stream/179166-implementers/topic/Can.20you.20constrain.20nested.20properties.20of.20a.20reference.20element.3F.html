---
layout: page
title: "FHIR Chat  · Can you constrain nested properties of a reference element? · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html">Can you constrain nested properties of a reference element?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="161861292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161861292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161861292">(Mar 27 2019 at 13:58)</a>:</h4>
<p>I have a profile on Observation and want to constrain a property of <code>specimen</code> (more specifically, make <code>specimen.type</code> "must support"). To do this, I would have to "unroll" or "drill down into" the <code>Specimen</code> type within the <code>Observation</code> profile. <code>Observation.specimen</code>, however, is a <code>Reference</code>. There is conflicting information on Zulip about whether or not drilling into a reference is valid.</p>



<a name="161861379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161861379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161861379">(Mar 27 2019 at 13:59)</a>:</h4>
<p>For example, <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  says it is not valid:</p>
<blockquote>
<p>A profile can assert a target profile for a reference - which would in turn restrict the referenced artifact. However, a profile can't "drill down" into the content of a referenced resource the way it can drill into the components of a data type.</p>
</blockquote>
<p><a href="#narrow/stream/179166-implementers/topic/Profiling/near/153869408" title="#narrow/stream/179166-implementers/topic/Profiling/near/153869408">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Profiling/near/153869408</a></p>



<a name="161861509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161861509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161861509">(Mar 27 2019 at 14:00)</a>:</h4>
<p>But <span class="user-mention" data-user-id="191336">@Michel Rutten</span> seems to say it is, and that Forge supports it:</p>
<blockquote>
<p>Alternatively, a custom profile can specify inline constraints on referenced external type/resource profiles. For example, your custom profile could further constrain an element with (default) datatype Range by limiting the low/high values.</p>
</blockquote>
<p><a href="#narrow/stream/179166-implementers/topic/constraining.20referenced.20official.20profiles.20in.20custom.20profiles/near/154024068" title="#narrow/stream/179166-implementers/topic/constraining.20referenced.20official.20profiles.20in.20custom.20profiles/near/154024068">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/constraining.20referenced.20official.20profiles.20in.20custom.20profiles/near/154024068</a></p>



<a name="161861810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161861810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161861810">(Mar 27 2019 at 14:03)</a>:</h4>
<p>Nevermind!  Upon reading it again, I see that <span class="user-mention" data-user-id="191336">@Michel Rutten</span> was using the word "referenced" in a more general way -- he was <em>not</em> talking about actual FHIR references (as <code>Range</code> is <em>not</em> a reference in <code>Observation</code>).</p>
<p>So I will assume that it is not valid, as Lloyd clearly indicated in his previous comment.  Thanks!</p>



<a name="161862177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161862177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161862177">(Mar 27 2019 at 14:07)</a>:</h4>
<p>My earlier comments applied to constraints on regular datatypes (such as Range).<br>
A referencing profile can further constrain a ResourceReference and it's child nodes, but not the referenced target profile, as this is not "inlined" in the referencing profile. Alternatively, you can specify FHIR Path constraints on the reference target using the "resolve" operator.</p>



<a name="161862441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161862441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161862441">(Mar 27 2019 at 14:10)</a>:</h4>
<p>Note that not all FHIR servers will implement support for such complex constraints.</p>



<a name="161866364"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161866364" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161866364">(Mar 27 2019 at 14:49)</a>:</h4>
<p>Thanks for the confirmation <span class="user-mention" data-user-id="191336">@Michel Rutten</span> -- and sorry for initially misunderstanding your earlier comment.  Eventually I figured it out! ;-)</p>



<a name="161867748"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161867748" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161867748">(Mar 27 2019 at 15:01)</a>:</h4>
<p>Just reference  a  Specimen profile that requires the code</p>



<a name="161871478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161871478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161871478">(Mar 27 2019 at 15:35)</a>:</h4>
<p>You can assert a targetProfile for the Reference or you can define a constraint that makes use of resolve().  Those are the only ways to influence what a Reference points to.</p>



<a name="161877401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161877401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161877401">(Mar 27 2019 at 16:39)</a>:</h4>
<p>Thanks everyone!  I'm not sure I want to create an entire profile on <code>Specimen</code> just to say that <code>type</code> is <code>must support</code> in this one use case for this one profile on <code>Observation</code>.  And using a FHIRPath invariant to flag something as <code>must support</code> feels weird (and I'm not sure it's even possible since "must support" doesn't come through in instance data).  But at least I know my options!  Thanks again.</p>



<a name="161878885"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161878885" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161878885">(Mar 27 2019 at 16:56)</a>:</h4>
<p>True.  I missed the "mustSupport" bit.  There's no way to do that with a constraint.  Your only choice around "mustSupport" is creating a profile or adding some other textual verbiage in the spec.  (And based on proposed tightening of the rules for IGs, just verbiage in the spec might not cut it.)</p>



<a name="161878913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Can%20you%20constrain%20nested%20properties%20of%20a%20reference%20element%3F/near/161878913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Can.20you.20constrain.20nested.20properties.20of.20a.20reference.20element.3F.html#161878913">(Mar 27 2019 at 16:56)</a>:</h4>
<p>Creating a profile that just flags one element as mustSupport is actually pretty light work though...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
