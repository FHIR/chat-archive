---
layout: page
title: "FHIR Chat  · Trouble w/ Vonk chained/reverse chained, and _include search · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html">Trouble w/ Vonk chained/reverse chained, and _include search</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="180169171"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180169171" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180169171">(Nov 07 2019 at 19:56)</a>:</h4>
<p>Hello,</p>
<p>I'm having trouble getting chained, reverse chained, and _include search to work on Vonk (tried 2.0.0 and 3.0.0-beta2).  I've loaded in 10 Patients, each of which have 2 Specimens. </p>
<p>I tried this chained search: <br>
<a href="/user_uploads/10155/q6k3DjC-ssTwiDAgJAkXvxUk/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/q6k3DjC-ssTwiDAgJAkXvxUk/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/q6k3DjC-ssTwiDAgJAkXvxUk/pasted_image.png"></a></div><p>which I expected to return 6 specimens (3 patients named Natasha x 2 Specimens per patient)</p>
<p>I also tried this reverse chained search which didn't seem to work either:<br>
<a href="/user_uploads/10155/NPXAjvYiPrWMSGNIUrfkHMxI/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/NPXAjvYiPrWMSGNIUrfkHMxI/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/NPXAjvYiPrWMSGNIUrfkHMxI/pasted_image.png"></a></div><p>Similarly, I cannot get the _include parameter to work either. <br>
<a href="/user_uploads/10155/EKma9SWIpcPNpiNfPIf30aC7/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/EKma9SWIpcPNpiNfPIf30aC7/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/EKma9SWIpcPNpiNfPIf30aC7/pasted_image.png"></a></div><p>Could someone please advise if I'm doing something wrong? </p>
<p>cc: <span class="user-mention" data-user-id="191347">@Mirjam Baltus</span> </p>
<p>Thank you!</p>



<a name="180179898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180179898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mirjam Baltus <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180179898">(Nov 07 2019 at 21:48)</a>:</h4>
<p><span class="user-mention" data-user-id="225054">@Natasha Singh</span>  Could you check to see whether your subject reference in the Specimen is correct? I see that your Specimen has a guid as technical id - which is what you'd expect when you POST it to Vonk - but your Specimen.subject uses a custom id ('Patient/PT-00001'). The Patient resource can only have that specific id when you have chosen to PUT it to Vonk with it. If you have also used a POST for the Patient, your links will be broken, and the chained search/include will not work.</p>



<a name="180180669"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180180669" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180180669">(Nov 07 2019 at 21:57)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191347">@Mirjam Baltus</span> , I'm not sure I follow. The custom ids seem to be ok. I tried this and it seems to work:</p>
<p><a href="/user_uploads/10155/am36T_juyL0IEzk7kDC_eJmW/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/am36T_juyL0IEzk7kDC_eJmW/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/am36T_juyL0IEzk7kDC_eJmW/pasted_image.png"></a></div>



<a name="180181296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180181296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mirjam Baltus <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180181296">(Nov 07 2019 at 22:04)</a>:</h4>
<p>Yes, that would work, since the reference in Specimen.subject has the PT-00001 value in it. But, I suspect that there is no Patient/PT-00001 on your server. You can test that by doing a GET &lt;vonk&gt;/Patient/PT-00001. If that is not there, Vonk will not be able to follow the reference from the Specimen.subject to an existing resource. The Specimen.subject field needs to contain a reference to an existing Patient resource on your server in order for the chain/include to work.</p>



<a name="180242367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180242367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180242367">(Nov 08 2019 at 15:53)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191347">@Mirjam Baltus</span> , </p>
<p>Ok I understand what you are saying about the custom id. GET /Patient/PT-00001 returns a 404. Since I used POST to create everything, all created resources got assigned a generated ID, rather than my custom IDs, which means the links are all broken between referenced resources. </p>
<p>So, I'm trying to PUT this time, but I'm running into a seperate issue which I'll just post here. Maybe you can help. </p>
<p>Here's what I did: <br>
- PUT /Patient/PT-00001 <br>
- DELETE /Patient/PT-0001 <br>
- PUT /Patient/PT-00001 - this resulted in the following error that I don't understand:</p>
<div class="codehilite"><pre><span></span>{
  &quot;resourceType&quot;: &quot;OperationOutcome&quot;,
  &quot;id&quot;: &quot;3ad3a264-abcb-4070-a666-195035417f0f&quot;,
  &quot;meta&quot;: {
    &quot;versionId&quot;: &quot;b24aa6e3-2029-473f-9a02-a415ea7561cd&quot;,
    &quot;lastUpdated&quot;: &quot;2019-11-08T15:46:31.189+00:00&quot;
  },
  &quot;issue&quot;: [
    {
      &quot;severity&quot;: &quot;warning&quot;,
      &quot;code&quot;: &quot;business-rule&quot;,
      &quot;details&quot;: {
        &quot;coding&quot;: [
          {
            &quot;system&quot;: &quot;http://hl7.org/fhir/dotnet-api-operation-outcome&quot;,
            &quot;code&quot;: &quot;2007&quot;
          }
        ],
        &quot;text&quot;: &quot;Element definition does not specify a &#39;min&#39; value, which is required. Cardinality has not been validated&quot;
      },
      &quot;location&quot;: [
        &quot;Patient&quot;
      ]
    },
    {
      &quot;severity&quot;: &quot;error&quot;,
      &quot;code&quot;: &quot;exception&quot;,
      &quot;details&quot;: {
        &quot;coding&quot;: [
          {
            &quot;system&quot;: &quot;http://hl7.org/fhir/dotnet-api-operation-outcome&quot;,
            &quot;code&quot;: &quot;5006&quot;
          }
        ],
        &quot;text&quot;: &quot;Existing resource is in a different informationmodel: Fhir3.0.&quot;
      }
    }
  ]
}
</pre></div>


<p>All of my requests have the mimeType parameter fhirVersion=4.0. Is Vonk creating both STU3 and R4 resources and only deleting the R4 ones?</p>



<a name="180252513"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180252513" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180252513">(Nov 08 2019 at 17:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191347">@Mirjam Baltus</span> I'm still having the issue above ^ (can't PUT after DELETE due to existing resources in Fhir3.0 ) BUT after I used PUT to create all my resources for the first time, I am seeing that chaining, rev chaining, and _include is working now. The problem was exactly what you said - links were broken bc resources weren't being referenced by my custom IDs. <br>
So thank you for helping me resolve that!</p>



<a name="180255175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180255175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mirjam Baltus <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180255175">(Nov 08 2019 at 18:02)</a>:</h4>
<p>Great that that works now! You could also create a transaction Bundle to send all of the resources in one go. Vonk will then go through the references and keep the links if the Bundle contains all the referenced resources.<br>
As to your other issue, this is something I cannot reproduce. Vonk does not create the resource for both versions. Could you send an email with your logfile to the vonk mailbox?</p>



<a name="180257379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180257379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180257379">(Nov 08 2019 at 18:28)</a>:</h4>
<p>This happened using the Vonk 3.0.0-beta2 docker image btw. Let me send you the logs too</p>



<a name="180265456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180265456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180265456">(Nov 08 2019 at 19:55)</a>:</h4>
<p><span class="user-mention" data-user-id="191347">@Mirjam Baltus</span>  <a href="/user_uploads/10155/nziOr0KXFyG2TsaskUqmwy0C/vonk-20191108.log" target="_blank" title="vonk-20191108.log">vonk-20191108.log</a></p>



<a name="180272033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180272033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180272033">(Nov 08 2019 at 21:06)</a>:</h4>
<p><span class="user-mention" data-user-id="225054">@Natasha Singh</span> This issue was resolved in the stable Vonk 3.0.0 release. Could you please update and re-test?</p>



<a name="180272263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Trouble%20w/%20Vonk%20chained/reverse%20chained%2C%20and%20_include%20search/near/180272263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Natasha Singh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Trouble.20w.2F.20Vonk.20chained.2Freverse.20chained.2C.20and.20_include.20search.html#180272263">(Nov 08 2019 at 21:09)</a>:</h4>
<p>Ah I see. I had to fall back to using 3.0.0-beta2 only because of this issue: <a href="#narrow/stream/179166-implementers/topic/Does.20Vonk.203.2E0.2E0.20try.20to.20fetch.20things.20at.20canonical.20URLs/near/179850218" title="#narrow/stream/179166-implementers/topic/Does.20Vonk.203.2E0.2E0.20try.20to.20fetch.20things.20at.20canonical.20URLs/near/179850218">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Does.20Vonk.203.2E0.2E0.20try.20to.20fetch.20things.20at.20canonical.20URLs/near/179850218</a>.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
