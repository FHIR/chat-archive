---
layout: page
title: "FHIR Chat  · Json-Schema validation errors · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html">Json-Schema validation errors</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153945237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945237">(Mar 15 2018 at 20:31)</a>:</h4>
<p>Hi, there are some errors in the json-schema schemas. The problem is that basically sometimes a value can be either an array or an object, but the schema only defines the case of an array. For example,  Encounter.reason, the json-schema currently is: </p>
<div class="codehilite"><pre><span></span>&quot;reason&quot;: {
        &quot;description&quot;:
              &quot;Reason the encounter takes place, expressed as a code. For admissions, this can be used for a coded admission diagnosis.&quot;,
            &quot;type&quot;: &quot;array&quot;,
              &quot;items&quot;: {
              &quot;$ref&quot;:
                &quot;CodeableConcept.schema.json#/definitions/CodeableConcept&quot;
            }
          }
</pre></div>


<p>but it should be </p>
<div class="codehilite"><pre><span></span>      &quot;reason&quot;: {
              &quot;oneOf&quot;: [
                {
                  &quot;description&quot;:
                    &quot;Reason the encounter takes place, expressed as a code. For admissions, this can be used for a coded admission diagnosis.&quot;,
                  &quot;type&quot;: &quot;array&quot;,
                  &quot;items&quot;: {
                    &quot;$ref&quot;:
                      &quot;CodeableConcept.schema.json#/definitions/CodeableConcept&quot;
                  }
                },
                {
                  &quot;$ref&quot;:
                    &quot;CodeableConcept.schema.json#/definitions/CodeableConcept&quot;
                }
              ]
            },
</pre></div>


<p>I could use the <code>$validate</code> operation of a public server, but that would be slower and less reliable than doing it in my own server with json-schema</p>



<a name="153945248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945248">(Mar 15 2018 at 21:51)</a>:</h4>
<p><span class="user-mention" data-user-id="191678">@Abigail Watson</span> ?</p>



<a name="153945257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945257">(Mar 15 2018 at 23:22)</a>:</h4>
<p>umm, I don't undertand the base claim here: "sometimes a value can be either an array or an object" - not so</p>



<a name="153945259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945259">(Mar 15 2018 at 23:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Well, I used the <code>$validate</code> endpoint of this server  <code>http://hapi.fhir.org/baseDstu3</code> and it validates an Encounter in both cases,  when <code>reason</code> is an object (codeableConcept), and also when its an array of objects</p>



<a name="153945260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945260">(Mar 15 2018 at 23:45)</a>:</h4>
<p>I discovered this when uploading data to my server from the <a href="https://github.com/synthetichealth/synthea" target="_blank" title="https://github.com/synthetichealth/synthea">Synthea Project</a>. It writes codeableConcepts independently and also inside of arrays.</p>



<a name="153945261"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945261" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945261">(Mar 15 2018 at 23:53)</a>:</h4>
<p>The <code>.org.hl7.fhir.validator.jar</code> also validates both formats without errors.</p>



<a name="153945262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945262">(Mar 15 2018 at 23:58)</a>:</h4>
<p>well, you've found bugs in at least the validators then. and probably in the synthea project. I've already reported some cardinality bugs in the synthea data.</p>



<a name="153945263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945263">(Mar 15 2018 at 23:59)</a>:</h4>
<p>want to post the actual examples here?</p>



<a name="153945265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945265">(Mar 16 2018 at 00:04)</a>:</h4>
<p>I have just been using a simple Encounter resource:</p>
<div class="codehilite"><pre><span></span>{
  &quot;resourceType&quot;: &quot;Encounter&quot;,
  &quot;id&quot;: &quot;f003&quot;,
  &quot;text&quot;: {
    &quot;status&quot;: &quot;generated&quot;,
    &quot;div&quot;:
      &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&lt;p&gt;&lt;b&gt;Generated Narrative with Details&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;&quot;
  },
  &quot;identifier&quot;: [
    {
      &quot;use&quot;: &quot;official&quot;,
      &quot;system&quot;: &quot;http://www.bmc.nl/zorgportal/identifiers/encounters&quot;,
      &quot;value&quot;: &quot;v6751&quot;
    }
  ],
  &quot;status&quot;: &quot;finished&quot;,
  &quot;subject&quot;: {
    &quot;reference&quot;: &quot;Patient/f001&quot;,
    &quot;display&quot;: &quot;P. van de Heuvel&quot;
  },
  &quot;reason&quot;: {
    &quot;extension&quot;: [
      {
        &quot;url&quot;:
          &quot;http://hl7.org/fhir/StructureDefinition/encounter-primaryDiagnosis&quot;,
        &quot;valuePositiveInt&quot;: 1
      }
    ]
  },
  &quot;serviceProvider&quot;: {
    &quot;reference&quot;: &quot;Organization/f001&quot;
  }
}
</pre></div>



<a name="153945266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945266">(Mar 16 2018 at 00:04)</a>:</h4>
<p>That resource gets validated by the <code>.jar</code>.  See how <code>reason</code> is not an array.</p>



<a name="153945267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945267">(Mar 16 2018 at 00:05)</a>:</h4>
<p>I no longer have the exact resource generated by Synthea, but it was something like that</p>



<a name="153945271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945271">(Mar 16 2018 at 00:58)</a>:</h4>
<p>yep sure was a bug in the validator - it will start noting an error if you provide an object in place of an array now</p>



<a name="153945272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945272">(Mar 16 2018 at 01:03)</a>:</h4>
<p>Oh, thanks. I guess we'll have to report the issue to Synthea.<br>
<span class="user-mention" data-user-id="191316">@Grahame Grieve</span> would you mind doing it yourself? I'm not sure about how to redact the issue</p>



<a name="153945275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945275">(Mar 16 2018 at 01:23)</a>:</h4>
<p><span class="user-mention" data-user-id="191381">@Jason Walonoski</span> I think I already reported this...</p>



<a name="153945278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945278">(Mar 16 2018 at 01:35)</a>:</h4>
<p>It may be relevant to note that I didn't use Synthea directly. The bad data came from <a href="https://projectcrucible.org/testdata" target="_blank" title="https://projectcrucible.org/testdata">Crucible</a> which <em>uses</em> Synthea</p>



<a name="153945547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Json-Schema%20validation%20errors/near/153945547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Json-Schema.20validation.20errors.html#153945547">(Mar 16 2018 at 21:45)</a>:</h4>
<p>We've fixed this in Synthea already. <span class="user-mention" data-user-id="192576">@Robert Scanlon</span> The version of Synthea that Crucible uses needs to be updated.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
