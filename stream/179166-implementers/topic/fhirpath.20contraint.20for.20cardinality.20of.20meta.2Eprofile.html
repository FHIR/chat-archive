---
layout: page
title: "FHIR Chat  · fhirpath contraint for cardinality of meta.profile · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/fhirpath.20contraint.20for.20cardinality.20of.20meta.2Eprofile.html">fhirpath contraint for cardinality of meta.profile</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="245015077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/fhirpath%20contraint%20for%20cardinality%20of%20meta.profile/near/245015077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Katarina <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/fhirpath.20contraint.20for.20cardinality.20of.20meta.2Eprofile.html#245015077">(Jul 06 2021 at 09:33)</a>:</h4>
<p>Hi,</p>
<p>I want to write a fhirpath constraint that the meta element should have exactly one profile element. <br>
This should work for every resource that is contained as entry in a Bundle.</p>
<p>This seems to work:</p>
<p>&lt;element id="Bundle"&gt;<br>
&lt;path value="Bundle"/&gt;<br>
      &lt;constraint&gt;<br>
        &lt;key value="exactlyOneMetaProfile" /&gt;<br>
        &lt;severity value="error" /&gt;<br>
        &lt;human value="Exactly one meta.profile" /&gt;<br>
        &lt;expression value="entry.all(resource.meta.profile.count()=1)" /&gt;<br>
      &lt;/constraint&gt;<br>
&lt;/element&gt;</p>
<p>Or is there a better solution?</p>



<a name="245053701"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/fhirpath%20contraint%20for%20cardinality%20of%20meta.profile/near/245053701" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/fhirpath.20contraint.20for.20cardinality.20of.20meta.2Eprofile.html#245053701">(Jul 06 2021 at 15:18)</a>:</h4>
<p>First, forcing there to be exactly one profile is generally a bad thing to do.  Systems should be able to declare as many profiles as they want - and as a recipient you should just ignore any you don't care about/recognize.  It's fine for you to drop any declarations you don't care about/support if you don't have a means to store them.  In fact, it's a bad idea to impose upper cardinality limits on most elements because it interferes with interoperability.  Source systems should be able to send whatever data they have and receivers should extract the data they care about from whatever's sent, ignoring the rest.  Imposing cardinality limits driven by what you can store (as opposed to what's a genuine error to exist at all) means that the system must create and maintain a specific export for your system - which increases costs and complexity.</p>
<p>That said, to constrain cardinality, simply set differential.element.min and max=1 for the path Bundle.meta.profile.  No need for an invariant.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
