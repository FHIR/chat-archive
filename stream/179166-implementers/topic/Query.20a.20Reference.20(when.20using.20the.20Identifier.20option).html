---
layout: page
title: "FHIR Chat  · Query a Reference (when using the Identifier option) · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html">Query a Reference (when using the Identifier option)</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="235482104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235482104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235482104">(Apr 21 2021 at 09:48)</a>:</h4>
<p>We are seeing (for practical reasons) that we can't always reference resources - maybe the resources are not available, or on disperate servers that may not always be accessible. In these cases we use the "identifier" option of the Reference data type. For example, we can end up with resource instances like this<br>
&lt;PractitionerRole xmlns="<a href="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
    &lt;practitioner&gt;<br>
        &lt;identifier&gt;<br>
        &lt;system value="https://fhir.nhs.uk/Id/user-id"/&gt;<br>
        &lt;value value="1234567890"/&gt;     <br>
    &lt;identifier&gt;<br>
    &lt;/practitioner&gt;<br>
etc....<br>
&lt;/PractitionerRole&gt;</p>
<p>The issue we are having is how to query these resources. For example, to get all the PractitionerRole records for practitioner 1234567890. The query parameter PractitionerRole.practitioner is geared towards having a resource references, rather than an identifer. Would the following query string be acceptable (it fails on all the FHIR servers I've tried it on!)<br>
<strong>[FHIRServer]/PractitionerRole?practitioner.identifier=https://fhir.nhs.uk/Id/user-id|1234567890</strong><br>
<em>Note that in this example the FHIR server does not contain the Practitioner resource, so I can't chanin through to a Practitioner resource.</em></p>



<a name="235485814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235485814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235485814">(Apr 21 2021 at 10:21)</a>:</h4>
<p>hi Dave</p>
<p>Are these FHIR resources that are not accessible, or non-FHIR resources? Either way, a FHIR server is not going to be able to reach them.</p>
<p>You can use reference.identifier to point to things that are not FHIR, but in that case a FHIR server would not be able to query for them, unless it had some special knowledge of how to resolve that identifier type, or how to cope with them not being accessible somehow (e.g. a cache).</p>
<p>There has been discussion on here of searching within the FHIR server space by identifier (and I am not sure how possible that is currently), but that won't help you I don't think.</p>



<a name="235487472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235487472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235487472">(Apr 21 2021 at 10:36)</a>:</h4>
<p>The FHIR resources are available but we don't specify which one to use. So for a NHSNumber of 9876543210 (display name = MR J SMITH, reference.identifier of  9876543210) - you could resolve by going to the national PDS server, local PAS or regional MPI. Corollary is you don't need to resolve the reference to get the NHS number (or patient name).</p>
<p>Same would apply to other national identifiers such as GMC, GMP, ODS, etc codes for Practitioner and Organization. It is up to the client to decide where they go to resolve the identifier. <br>
Using GMC, GMP, ODS etc also matches existing HL7v2 and NHS Data Dictionary behaviour in the NHS</p>



<a name="235488976"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235488976" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235488976">(Apr 21 2021 at 10:51)</a>:</h4>
<p>So that is FHIR data but not FHIR REST data - because the server is not specified. </p>
<p>It cannot be searched by FHIR RESTful search, without some special case server logic. </p>
<p>Either an extension to the search code (but that may break existing functionality for identifiers) or by adding a custom operation perhaps.</p>



<a name="235491311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235491311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235491311">(Apr 21 2021 at 11:10)</a>:</h4>
<p>I think from the point of view of a developer its consistent across API's.</p>
<p>So for our main directory server, this is correct and would work (it has Practitioner, Organization and PractitionerRole - it's a FHIR Server)<br>
[FHIRServer]/PractitionerRole?practitioner.identifier=https://fhir.nhs.uk/Id/user-id|1234567890</p>
<p>Other servers which are more like (FHIR) micro services. (it wont have a Practitioner resource locally but understands the query)<br>
Having the same search parameters is easier for the developer and the way the API responds is very similar.</p>



<a name="235504430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235504430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235504430">(Apr 21 2021 at 12:57)</a>:</h4>
<p>Yes it is nice if that query can work, but it needs to do some NHS specific magic to resolve where those identifiers live. If they are on the same server maybe some servers can do it out of the box (there was discussion on here before e.g. <a href="#narrow/stream/179166-implementers/topic/How.20search.20on.20Reference.2Eidentifier.20in.20STU3">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/How.20search.20on.20Reference.2Eidentifier.20in.20STU3</a>), but otherwise not.</p>



<a name="235523189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235523189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235523189">(Apr 21 2021 at 14:51)</a>:</h4>
<p>On the Vonk r3 server (<a href="https://server.fire.ly/r3/">https://server.fire.ly/r3/</a>) I POSTed <br>
&lt;PractitionerRole xmlns=http://hl7.org/fhir&gt;<br>
    &lt;practitioner&gt;<br>
        &lt;identifier&gt;<br>
            &lt;system value=https://fhir.nhs.uk/Id/user-id/&gt;<br>
            &lt;value value="QWERTY"/&gt;     <br>
        &lt;/identifier&gt;<br>
    &lt;/practitioner&gt;<br>
    &lt;code&gt;<br>
        &lt;coding&gt;<br>
            &lt;system value=https://fhir.hl7.org.uk/CodeSystem/UKCore-SDSJobRoleName /&gt;<br>
            &lt;code value="R0260" /&gt;<br>
            &lt;display value="General Medical Practitioner" /&gt;<br>
        &lt;/coding&gt;<br>
    &lt;/code&gt;<br>
&lt;/PractitionerRole&gt;</p>
<p>and then did a GET<br>
<a href="https://server.fire.ly/r3/PractitionerRole?practitioner:identifier=https://fhir.nhs.uk/Id/user-id|QWERTY">https://server.fire.ly/r3/PractitionerRole?practitioner:identifier=https://fhir.nhs.uk/Id/user-id|QWERTY</a><br>
(note :identifier)<br>
and the resource was returned. I repeated the same on a HAPI server &amp; nothing was returned. Given the discussion that Rik has pointed to, I think theintension is that <br>
GET [base]/PractitionerRole?practitioner:identifier=[system]|[value]<br>
is the intended way to retrieve resources where the Reference uses an identifier.</p>



<a name="235525457"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235525457" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235525457">(Apr 21 2021 at 15:01)</a>:</h4>
<p><span class="user-mention" data-user-id="191651">@Rik Smithies</span>  yep its a hot topic at the moment.</p>



<a name="235542498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Query%20a%20Reference%20%28when%20using%20the%20Identifier%20option%29/near/235542498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Query.20a.20Reference.20(when.20using.20the.20Identifier.20option).html#235542498">(Apr 21 2021 at 16:38)</a>:</h4>
<p>practitioner:identifier is the way to search on Reference.identifier.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
