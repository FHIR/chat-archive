---
layout: page
title: "FHIR Chat  · HAPI FHIR client URL query string space character encoding · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20client.20URL.20query.20string.20space.20character.20encoding.html">HAPI FHIR client URL query string space character encoding</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153920741"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20client%20URL%20query%20string%20space%20character%20encoding/near/153920741" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Daily <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20client.20URL.20query.20string.20space.20character.20encoding.html#153920741">(Nov 21 2017 at 16:05)</a>:</h4>
<p>(I hope this is the right place to discuss this? I've also opened Issue 796 <a href="https://github.com/jamesagnew/hapi-fhir/issues/796" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/issues/796">https://github.com/jamesagnew/hapi-fhir/issues/796</a> for consideration)</p>
<p>I'm using the HAPI FHIR Client (Java) to connect to a provider and issue a restful GET request, eg to search for Patient resources.</p>
<p>One of the search parameters has spaces in it: eg, "address" is "123 main street".</p>
<p>HttpGetClientInvocation is converting those spaces into + (plus) signs: <code>example.com/Patient?address=123+main+street</code>using Java's <a href="https://docs.oracle.com/javase/8/docs/api/java/net/URLEncoder.html" target="_blank" title="https://docs.oracle.com/javase/8/docs/api/java/net/URLEncoder.html">URLEncoder</a> class which "Translates a string into application/x-www-form-urlencoded format".</p>
<p>Our provider does not support application/x-www-form-urlencoded URL's, and instead supports RFC3986, which apparently requires spaces in search query values to be encoded as <code>%20</code> rather than + (plus) signs: <code>example.com/Patient?address=123%20main%20street</code>  They treat + (plus) signs as literal + (plus) signs.</p>
<p>It doesn't look like there's any way to intercept and rewrite the URI before the Request is sent. The only interceptors available appear to be for setting headers, none allow for manipulating the URI. </p>
<p>Has anyone worked around this? Best workaround I can come up with so far is to just construct the URI myself, without using the fluent interface of .where.and.and.execute() etc.</p>



<a name="153920772"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20client%20URL%20query%20string%20space%20character%20encoding/near/153920772" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20client.20URL.20query.20string.20space.20character.20encoding.html#153920772">(Nov 21 2017 at 18:37)</a>:</h4>
<p>my interpretation of the spec is that your provider is wrong</p>



<a name="153920799"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20client%20URL%20query%20string%20space%20character%20encoding/near/153920799" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Daily <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20client.20URL.20query.20string.20space.20character.20encoding.html#153920799">(Nov 21 2017 at 21:26)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> </p>
<p>I couldn't find anything specific in <a href="https://www.hl7.org/fhir/search.html#uri" target="_blank" title="https://www.hl7.org/fhir/search.html#uri">https://www.hl7.org/fhir/search.html#uri</a> other than:</p>
<blockquote>
<p>For this RESTful search (see definition in RESTful API), the parameters are a series of name=[value] pairs encoded in the URL or as an application/x-www-form-urlencoded submission for a POST". </p>
</blockquote>
<p>As I read that, it is clear how to encode for POST, but not specific about how to make them "encoded in the URL" for GET.</p>
<p>I think that FHIR servers should accept both + and %20 interchangeably as encoded spaces within search queries, as most web sites do.</p>



<a name="153920838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20client%20URL%20query%20string%20space%20character%20encoding/near/153920838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20client.20URL.20query.20string.20space.20character.20encoding.html#153920838">(Nov 21 2017 at 22:49)</a>:</h4>
<p>"+" is a valid character in a URL, so using it as an escape character would make it ambiguous.  FHIR adheres to the HTTP spec, which says that all escaped characters are escaped using "%" when present as part of the URL.</p>



<a name="153921214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20client%20URL%20query%20string%20space%20character%20encoding/near/153921214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20client.20URL.20query.20string.20space.20character.20encoding.html#153921214">(Nov 23 2017 at 02:16)</a>:</h4>
<p>This definitely seems like HAPI's client's URLEncoder is doing the wrong thing. Will fix per that ticket.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
