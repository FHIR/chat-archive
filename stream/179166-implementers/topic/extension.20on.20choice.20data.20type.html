---
layout: page
title: "FHIR Chat  · extension on choice data type · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html">extension on choice data type</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="243563659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243563659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243563659">(Jun 22 2021 at 19:01)</a>:</h4>
<p>How do I add extension to an element having choice data type. For example: how do I add DAR extension to Condition.onset (in JSON)?</p>



<a name="243606778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243606778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243606778">(Jun 23 2021 at 04:48)</a>:</h4>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"resourceType"</span><span class="p">:</span> <span class="s2">"Condition"</span><span class="p">,</span>
  <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"example"</span><span class="p">,</span>
  <span class="nt">"meta"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"profile"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition"</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="nt">"clinicalStatus"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"coding"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/condition-clinical"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"active"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Active"</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">"text"</span><span class="p">:</span> <span class="s2">"Active"</span>
  <span class="p">},</span>
  <span class="nt">"verificationStatus"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"coding"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/condition-ver-status"</span><span class="p">,</span>
        <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"confirmed"</span><span class="p">,</span>
        <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Confirmed"</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">"text"</span><span class="p">:</span> <span class="s2">"Confirmed"</span>
  <span class="p">},</span>
  <span class="nt">"category"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"coding"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">"system"</span><span class="p">:</span> <span class="s2">"http://terminology.hl7.org/CodeSystem/condition-category"</span><span class="p">,</span>
          <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"problem-list-item"</span><span class="p">,</span>
          <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Problem List Item"</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">"text"</span><span class="p">:</span> <span class="s2">"Problem"</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"code"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"text"</span><span class="p">:</span> <span class="s2">"Single liveborn, born in hospital"</span>
  <span class="p">},</span>
  <span class="nt">"subject"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"display"</span><span class="p">:</span> <span class="s2">"Amy V. Shaw"</span>
  <span class="p">},</span>
  <span class="nt">"_onsetDateTime"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"extension"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"http://hl7.org/fhir/StructureDefinition/data-absent-reason"</span><span class="p">,</span>
        <span class="nt">"valueCode"</span><span class="p">:</span> <span class="s2">"unknown"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>



<a name="243606864"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243606864" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243606864">(Jun 23 2021 at 04:51)</a>:</h4>
<p><a href="http://JSON%20representation%20of%20primitive%20elements">JSON representation of primitive elements</a></p>



<a name="243659859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243659859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243659859">(Jun 23 2021 at 14:28)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> But the interpretation of this is "I don't know the onsetDateTime". How do I say "I don't know any of the onset, no matter it is onsetDatetime, or onsetPeriod, or onsetAge". Do I need to list all the choices like</p>
<div class="codehilite"><pre><span></span><code>  &quot;_onsetDateTime&quot;: {
    &quot;extension&quot;: [
      {
        &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;,
        &quot;valueCode&quot;: &quot;unknown&quot;
      }
    ]
  },
  &quot;_onsetAge&quot;: {
    &quot;extension&quot;: [
      {
        &quot;url&quot;: &quot;http://hl7.org/fhir/StructureDefinition/data-absent-reason&quot;,
        &quot;valueCode&quot;: &quot;unknown&quot;
      }
    ]
  }
...
</code></pre></div>



<a name="243664081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243664081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243664081">(Jun 23 2021 at 14:57)</a>:</h4>
<p>good question, but note that if you knew the time and the Age you would only report one.</p>



<a name="243664385"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243664385" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243664385">(Jun 23 2021 at 14:58)</a>:</h4>
<p>and no you would not list them as above since max=1</p>



<a name="243664776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243664776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243664776">(Jun 23 2021 at 15:01)</a>:</h4>
<p>what you are really asking for is:</p>
<p>"_onset[x]": {<br>
    "extension": [<br>
      {<br>
        "url": "<a href="http://hl7.org/fhir/StructureDefinition/data-absent-reason">http://hl7.org/fhir/StructureDefinition/data-absent-reason</a>",<br>
        "valueCode": "unknown"<br>
      }<br>
    ]<br>
  },</p>
<p>which I think would be really confusing for implementers since onset[x] doesn't exist  over the wire</p>



<a name="243665225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243665225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243665225">(Jun 23 2021 at 15:04)</a>:</h4>
<p>so if the element is min=0 it is omitted.  I assume what you are asking is if the min=1</p>



<a name="243787350"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243787350" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243787350">(Jun 24 2021 at 13:43)</a>:</h4>
<p>Yes. I agree that using _onset[x] is confusing. So I think the current consensus is that I can pick any one of the choice and add DAR there.</p>



<a name="243807197"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243807197" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243807197">(Jun 24 2021 at 15:56)</a>:</h4>
<p>do you think we should document that.</p>



<a name="243925245"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243925245" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243925245">(Jun 25 2021 at 14:42)</a>:</h4>
<p>I think we should document at least in DAR extension. I don't know if other extension could have similar confusion.</p>



<a name="243936068"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243936068" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243936068">(Jun 25 2021 at 16:03)</a>:</h4>
<p>You have to pick a type.  You can't say "I don't know independent of type" because every instance must have a specific type.</p>



<a name="243943576"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243943576" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243943576">(Jun 25 2021 at 17:06)</a>:</h4>
<p>In US Core, the US Core DiagnosticReport Lab profile has a mandatory sliced element DiagnosticReport.effective <a href="/user_uploads/10155/urxlCcCB9I-9Uv1edvbsQGoC/image.png">image.png</a>. So if I want to use DAR on that element, I have to pick one of the concrete type, either effectiveDateTime or effectivePeriod, to apply DAR extension. Is my understanding correct?</p>
<div class="message_inline_image"><a href="/user_uploads/10155/urxlCcCB9I-9Uv1edvbsQGoC/image.png" title="image.png"><img src="/user_uploads/10155/urxlCcCB9I-9Uv1edvbsQGoC/image.png"></a></div>



<a name="243970784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/extension%20on%20choice%20data%20type/near/243970784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/extension.20on.20choice.20data.20type.html#243970784">(Jun 25 2021 at 21:06)</a>:</h4>
<p>Correct</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
