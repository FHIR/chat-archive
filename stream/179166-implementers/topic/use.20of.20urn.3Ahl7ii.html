---
layout: page
title: "FHIR Chat  · use of urn:hl7ii · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html">use of urn:hl7ii</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154024107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024107">(Dec 10 2018 at 17:00)</a>:</h4>
<p>There is a defined way of encoding an HL7 II with root or root+extension. The value is <br>
    urn:hl7ii:{ROOT}[:{EXTENSION}]<br>
Presumably in FHIR the .system value would still be the URI identifier of "urn:ietf:rfc:3986", but I guess it is possible there could be a specific system to indicate a HL7 II identifier as different from simply URI...<br>
the most dominant place where root+extension is used is within CDA, but it is found elsewhere.<br>
I am interested, on behalf of IHE and specifically the MHD profile, of assuring full round-trip of these kinds of identifiers. <br>
So I am interested in community opinion on the use of urn:hl7ii, vs not using this.<br>
If urn:hl7ii is not used, then a II value with just root, will be encoded as rfc3986; where as root+extension must be encoded with root in system, and extension in value.</p>
<p>THIS text from IHE Appendix Z (that I am now updating to FHIR R4)</p>
<p>Z.9.1.1 Identifier and HL7 version 3 "root plus extension"<br>
In HL7 version 3, uniqueId can be expressed as a root, or as a root plus extension. <br>
When converting an HL7 version 3 uniqueId to FHIR, if no extension is provided, the root shall be placed into the Identifier.value, and the Identifier.system shall be set to “urn:ietf:rfc:3986”. For example, the HL7 version 3 value<br>
&lt;identifier root="1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504" /&gt;<br>
would be expressed in FHIR as<br>
 {<br>
 "system": "urn:ietf:rfc:3986",<br>
 "value": "urn:oid:1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504"<br>
 }<br>
When an extension is provided, the extension shall be placed into the Identifier.value, and the Identifier.system shall be set to the root. For example, the HL7 version 3 value<br>
&lt;identifier root="1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504" extension="84566" /&gt;<br>
would be expressed in FHIR as<br>
 {<br>
 "system": "urn:oid:1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504"<br>
 “value”:”84566”<br>
 }</p>
<p>with use of urn:hl7ii, this simplifies to one pattern...</p>



<a name="154024109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024109">(Dec 10 2018 at 17:00)</a>:</h4>
<p>Reference: See Grahame's blog from June 2014  <a href="http://www.healthintersections.com.au/?p=2148" target="_blank" title="http://www.healthintersections.com.au/?p=2148">http://www.healthintersections.com.au/?p=2148</a></p>



<a name="154024207"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024207" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024207">(Dec 10 2018 at 19:39)</a>:</h4>
<p>(sigh) tables aren't as easy to use in zulip as I'd like...</p>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> , just to clarify your examples:</p>
<ul>
<li>
<p>HL7 V3 encoding:</p>
<ul>
<li>No extension: <code>&lt;identifier root="1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504" /&gt;</code></li>
<li>With extension: <code> &lt;identifier root="1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504" extension="84566" /&gt;</code></li>
</ul>
</li>
<li>
<p>Current FHIR practice:</p>
<ul>
<li>
<p>No extension: <code>{ "system": "urn:ietf:rfc:3986", "value": 
 "urn:oid:1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504" }</code></p>
</li>
<li>
<p>With extension: <code>{ "system":  "urn:oid:1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504", "value": "84566" }</code></p>
</li>
</ul>
</li>
<li>
<p><strong>Proposed</strong>  hl7ii encoding:</p>
<ul>
<li>No extension: <code>{ "system": "urn:ietf:rfc:3986", "value": "urn:hl7ii:1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504" }</code></li>
<li>With extension: <code>{ "system": "urn:ietf:rfc:3986",
"value": "urn:hl7ii:1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629.41504:84566" }</code></li>
</ul>
</li>
</ul>
<p>An advantage to this would be the clear ability to round-trip the identifier from V3 to FHIR and back, correct?</p>



<a name="154024221"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024221" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024221">(Dec 10 2018 at 20:17)</a>:</h4>
<p>yes. When encoding an II datatype, this would be the recommended way to encode it in FHIR...   Drawback is that everyone must know about hl7ii origin, and encoding.</p>



<a name="154024223"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024223" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elliot Silver <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024223">(Dec 10 2018 at 20:37)</a>:</h4>
<p>Hmm, also raises issues about identifiers that pass through an II but don't originate there.</p>



<a name="154024228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024228">(Dec 10 2018 at 20:57)</a>:</h4>
<p>yes, that is a problem... even where it is unknown that it did come from an II.  root+extension is a big problem for interoperability. Really wish HL7 had not invented that. root alone can easily be simply treated as a unique identifier. Given HL7 invented root+extension, then HL7 should determine the solution when FHIR is involved.</p>



<a name="154024750"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024750" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024750">(Dec 12 2018 at 10:11)</a>:</h4>
<p>System in FHIR is equivalent to root, value in FHIR is equivalent to extension. If you will the 'odd ' use is when an oid is used without an extension - in your first example: 1.2.826.0.1.3680043.2.1611.1.2.32884.10619.27943.27629 is the namespace (system) for the instance (value) 41504.</p>



<a name="154024796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024796">(Dec 12 2018 at 14:46)</a>:</h4>
<p>yes, that works when one has root and extension... but it does not work when one has only root... Thus the problem, one must encode the two patterns totally differently... where as urn:hl7ii gives us one way to encode both.</p>



<a name="154024814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024814">(Dec 12 2018 at 15:38)</a>:</h4>
<p>Why is it a problem to encode them differently if it's deterministic?</p>



<a name="154024815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024815">(Dec 12 2018 at 15:39)</a>:</h4>
<p>More importantly, when converting an II to Identifier, you're often going to have to translate the OID to a URL - at least you will for any place where a standard URL has been defined.  There's no safe way to algorithmicly do the conversion</p>



<a name="154024828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024828">(Dec 12 2018 at 15:52)</a>:</h4>
<p>It is the rountrip problem... that is looking at the FHIR Identifier and understanding that the value there is an II that is just root, or an II that is root + extension, or someother kind of identifier</p>



<a name="154024832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024832">(Dec 12 2018 at 15:56)</a>:</h4>
<p>If you look at an Identifier instance and see a value that's an OID with the standard URL for a bare OID, then you've got an II with just a root.  If you've got anything else, you've got a root + extension</p>



<a name="154024833"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024833" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024833">(Dec 12 2018 at 15:56)</a>:</h4>
<p>not really.. OIDs are used far wider than HL7...</p>



<a name="154024836"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024836" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024836">(Dec 12 2018 at 15:58)</a>:</h4>
<p>If you're converting to an II, that's still the algorithm you'd need to use</p>



<a name="154024840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024840">(Dec 12 2018 at 16:00)</a>:</h4>
<p>I am converting it to a interface that understands bare OIDs, and also can take II... They are different in the real world</p>



<a name="154024842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024842">(Dec 12 2018 at 16:01)</a>:</h4>
<p>Then add an extension that says "this came from an II"</p>



<a name="154024844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024844">(Dec 12 2018 at 16:02)</a>:</h4>
<p>You won't be able to use your urn:hl7ii with all data that comes from an II, so I don't see the point of introducing it.</p>



<a name="154024845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024845">(Dec 12 2018 at 16:02)</a>:</h4>
<p>I am simply asking the question to HL7 as a body... a body that has invented the root+extension concept... for the best way to handle that in FHIR.. when I think I have uncovered issues.. and for which I see the urn:hl7ii as a solution someone has invented... so I am simply asking for HL7 as a body to rule on the use of urn:hl7ii in the context of FHIR Identifier... I don't care if it is YES or NO or MAYBE...</p>



<a name="154024847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024847">(Dec 12 2018 at 16:05)</a>:</h4>
<p>I have a model, in IHE, for dealing with this without use of urn:hl7ii... I am just faced with comments asking for us to consider urn:hl7ii... so look at me considering it, and asking for community discussion.  I can have IHE forbid it, but I can't have IHE ignore it and thus end up with an interoperabilty problem where some use it and others don't. I am looking to avoid and interop problem.</p>



<a name="154024895"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024895" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024895">(Dec 12 2018 at 17:08)</a>:</h4>
<p>Well I invented hl7ii and you could use it as you suggest, but as Lloyd has said above you could simple check if the value is an OID or if the system is an OID and deal with those two situations.</p>



<a name="154024931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024931">(Dec 12 2018 at 19:54)</a>:</h4>
<p>I'm not seeing the need. The CDA/FHIR project mappings say:</p>



<a name="154024932"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024932" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024932">(Dec 12 2018 at 19:55)</a>:</h4>
<div class="codehilite"><pre><span></span>  source.root as r where source.extension.exists() -&gt; target.system = translate(r, &quot;http://hl7.org/fhir/ConceptMap/special-oid2uri&quot;, &quot;uri&quot;);
  source.root as r where source.extension.empty() -&gt; target.system = &quot;urn:ietf:rfc:3986&quot;, target.value = append(&quot;urn:oid:&quot;, r);
  source.extension as e -&gt; target.value = e;
</pre></div>



<a name="154024933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024933">(Dec 12 2018 at 19:55)</a>:</h4>
<p>that's for II -&gt; Identifier</p>



<a name="154024934"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024934" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024934">(Dec 12 2018 at 19:55)</a>:</h4>
<p>and for other way:</p>



<a name="154024938"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024938" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024938">(Dec 12 2018 at 20:01)</a>:</h4>
<div class="codehilite"><pre><span></span>    value.value as v where system.value = &#39;urn:ietf:rfc:3986&#39; -&gt; target.root = v;
    system.value as v where system.value != &#39;urn:ietf:rfc:3986&#39; -&gt; target.root = v then {
      value.value as v -&gt; target.extension = v;
</pre></div>



<a name="154024939"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/use%20of%20urn%3Ahl7ii/near/154024939" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/use.20of.20urn.3Ahl7ii.html#154024939">(Dec 12 2018 at 20:02)</a>:</h4>
<p>that seems pretty simple to me, and is what Lloyd said</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
