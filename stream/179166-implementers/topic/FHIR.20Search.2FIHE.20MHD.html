---
layout: page
title: "FHIR Chat  · FHIR Search/IHE MHD · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html">FHIR Search/IHE MHD</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="212665225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212665225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212665225">(Oct 08 2020 at 09:24)</a>:</h4>
<p>We increasingly encounter people who take issue with searches based on patient.identifier, because those would get logged in proxies and other places that may or may not have the same privacy protection in place. We actually have GDRP based auditors running around in the country who will tell you, you cannot do that.</p>
<p>In MedMij, the patient oriented network here in NL, we have declared searches based on the national patient identifier forbidden. The way to know who the query is for is deferred to the HTTP Authentication token. </p>
<p>The IHE MHD spec (<span class="user-mention" data-user-id="191404">@John Moehrke</span>) explicitly requires GET requests and explicitly requires patient.identifier as parameter which conflicts with the above. MHD simply bases on FHIR Search. FHIR Search which specifies a second option (POST application/x-www-form-urlencoded which would forego all concerns as https "hides" the body.</p>
<ul>
<li>Are there any other countries (e.g. European because of GDRP) who encounter issues like this?</li>
<li>What solutions have other countries found?</li>
</ul>



<a name="212665280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212665280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212665280">(Oct 08 2020 at 09:25)</a>:</h4>
<p>I'm confused about this. Why is the HTTP Authentication token logged differently to the URL?</p>



<a name="212665379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212665379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212665379">(Oct 08 2020 at 09:26)</a>:</h4>
<p>generally this sounds like the auditors using HIPAA to say that you can't share data</p>



<a name="212674304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212674304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212674304">(Oct 08 2020 at 11:12)</a>:</h4>
<p>It is not logged differently, but the token is a uuid or other meaningless string to any other party than the target endpoint</p>



<a name="212674535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212674535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212674535">(Oct 08 2020 at 11:15)</a>:</h4>
<p>You can share data, but in NL, PHRs cannot use the national patient identifier due to scoping issues in law. Patients negotiate a token that binds into that patient identifier outside the direct PHR context and then the PHR is handed the token by the endpoint for further use.</p>
<p>But long story short: nothing is exchanged based on searches that include subject or patient.identifier and the like.</p>



<a name="212674611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212674611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212674611">(Oct 08 2020 at 11:16)</a>:</h4>
<p>so they negotiate a specific identifier for their context?</p>



<a name="212674693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212674693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212674693">(Oct 08 2020 at 11:17)</a>:</h4>
<p>Token, not identifier. The token is a pointer into endpoint/FHIR server lookup table where the national PID is stored for the time-to-live of the token which currently is 15 minutes</p>



<a name="212674769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212674769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212674769">(Oct 08 2020 at 11:18)</a>:</h4>
<p>So endpoint/FHIR server reads the Bearer token, looks up which patient this is, in its lookup table for tokens, and uses that to answer the query</p>



<a name="212674845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212674845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212674845">(Oct 08 2020 at 11:19)</a>:</h4>
<p>so they only have one access to one patient?</p>



<a name="212674958"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212674958" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212674958">(Oct 08 2020 at 11:20)</a>:</h4>
<p>(deleted)</p>



<a name="212675134"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212675134" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212675134">(Oct 08 2020 at 11:23)</a>:</h4>
<p>(deleted)</p>



<a name="212676119"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212676119" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212676119">(Oct 08 2020 at 11:36)</a>:</h4>
<blockquote>
<p>so they only have one access to one patient?</p>
</blockquote>
<p>I think I misunderstood your question: yes, 1 token grants access to data of 1 patient.</p>



<a name="212678266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212678266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212678266">(Oct 08 2020 at 12:00)</a>:</h4>
<p>so you don't want an identifier at all - <span class="user-mention" data-user-id="191404">@John Moehrke</span> this is a more generic IHE issue - XDS for consumers will typically work this way in any country.</p>



<a name="212680129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212680129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212680129">(Oct 08 2020 at 12:19)</a>:</h4>
<p>Well, the MedMij use case is just that indeed. For Physician/Physician traffic the national patient id is actually allowed and those would follow normal patient id query patterns. However: law still requires the url to clear of that.</p>
<p>You could solve this with a POST of application/x-www-form-urlencoded parameters because they would go into the HTTP Body and are thus obfuscated from intermediary logging.</p>
<p>MHD disallows this. Maybe for good reason?</p>



<a name="212681689"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212681689" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212681689">(Oct 08 2020 at 12:33)</a>:</h4>
<p>mostly (I think) because there's a huge segment of the community out there falsely convinced that the body is more secure than the headers. Though I really shouldn't speak for IHE on that</p>



<a name="212682467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212682467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212682467">(Oct 08 2020 at 12:39)</a>:</h4>
<p>Some of them are called  auditors, architects, productmanagers, or developers. They are too diverse to ignore, so we can either beat them (provide evidence otherwise), or join them (leave patient.identifier out of the url)?</p>
<p>IHE actually chose to only support patient.identifier in url, so I guess they are not in the same group :-)</p>



<a name="212683452"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212683452" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212683452">(Oct 08 2020 at 12:47)</a>:</h4>
<p>Use an IHE <a href="https://wiki.ihe.net/index.php/ITI_Change_Proposals_2020-21">change proposal</a> to request the addition of POST searches.</p>



<a name="212683872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212683872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212683872">(Oct 08 2020 at 12:51)</a>:</h4>
<p>I will, thanks Vassil. That works for MHD</p>



<a name="212685545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212685545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212685545">(Oct 08 2020 at 13:04)</a>:</h4>
<p>Note that in the US PHRs do not use MHD - or any other IHE protocol - to get data, they just use plain SMART-on-FHIR auth and then query data using the patient ID, so no identifiers are sent over.</p>



<a name="212687570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212687570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212687570">(Oct 08 2020 at 13:18)</a>:</h4>
<p>Presumably a patient user can access more information than just their own patient record - parents or others with medical power of attorney would need to be able to access records of children or others.  So merely logging in wouldn't tell you what patient's data to return.  How would the desired patient's information be indicated?</p>



<a name="212690686"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212690686" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212690686">(Oct 08 2020 at 13:40)</a>:</h4>
<blockquote>
<p>query data using the patient ID, so no identifiers are sent over.</p>
</blockquote>
<p>This looks like a contradiction?</p>



<a name="212690887"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212690887" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212690887">(Oct 08 2020 at 13:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> in MedMij is impossible to ask data for any other patient than the one you logged in as.</p>
<p>In 'normal' FHIR context you could do all that using the HTTP POST search.</p>



<a name="212692763"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212692763" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212692763">(Oct 08 2020 at 13:55)</a>:</h4>
<p>The patient ID  is a uuid or a sequential number or some other meaningless string to any other party than the target endpoint</p>



<a name="212692822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212692822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212692822">(Oct 08 2020 at 13:55)</a>:</h4>
<blockquote>
<blockquote>
<p>query data using the patient ID, so no identifiers are sent over.</p>
</blockquote>
<p>This looks like a contradiction?</p>
</blockquote>
<p>It highlights the confusing difference between <a href="http://Patient.id">Patient.id</a> and Patient.identifier</p>



<a name="212695680"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212695680" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212695680">(Oct 08 2020 at 14:14)</a>:</h4>
<p>HTTP POST search isn't any more secure than a GET search.  </p>
<p>Presumably MedMij then relies on the sharing of credentials - as there being no ability for someone with a legal right to access the patient information being unable to do so would presumably be problematic?</p>



<a name="212702684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212702684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212702684">(Oct 08 2020 at 15:00)</a>:</h4>
<p>Let me try to clarify... The concern is that http intermediaries and http endpoint technology will log the GET url, but will not automatically log a POST body.</p>



<a name="212702746"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212702746" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212702746">(Oct 08 2020 at 15:00)</a>:</h4>
<p>so this is all driven by the default behavior of web infrastructure to log GET but not POST body</p>



<a name="212702916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212702916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212702916">(Oct 08 2020 at 15:01)</a>:</h4>
<p>Patient.identifier vs <a href="http://Patient.id">Patient.id</a> --- as <span class="user-mention" data-user-id="192685">@Vassil Peytchev</span> indicates this confusion has driven many bad decisions. If it was pointed out that the .id would tend to be mostly a guid, AND that it is the id that is in the GET parameter... then discussion might be more informed</p>



<a name="212703177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212703177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212703177">(Oct 08 2020 at 15:03)</a>:</h4>
<p>MHD does not require Patient.identifier. Fact is MHD has been clear that it requires the Patient "id". we have been explicitly silent on the very fact that in FHIR today a token could carry the Patient id or the Patient identifier. In fact I have asked questions here on zulip to help me clarify how that actually works, especially in a federated Patient registry environment.</p>



<a name="212703330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212703330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212703330">(Oct 08 2020 at 15:04)</a>:</h4>
<p>So <span class="user-mention" data-user-id="191375">@Alexander Henket</span> , there is nothing wrong with NL providing further clarification to MHD. There is a national extensions explicitly for this kind of specialization.</p>



<a name="212703572"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212703572" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212703572">(Oct 08 2020 at 15:05)</a>:</h4>
<p>Broader.. I like the idea of having the OAuth token be patient specific... which could override the any patient parameter, thus making a patient parameter meaningless and potentially forbidden.  YES, this would require the app get new tokens each time the patient changes. Where a user is handling many patients at the same time, this might get more complex... but it is just software... we should not be afraid of complexity when it is needed.</p>



<a name="212704077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212704077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212704077">(Oct 08 2020 at 15:09)</a>:</h4>
<p>I don't think I hear anything here that is difficult, but it is clearly new and different. These changes would be beyond what a Change Proposal could accomplish.  A new work item would be needed... ITI is accepting new work item proposals right now.</p>



<a name="212704324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212704324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212704324">(Oct 08 2020 at 15:10)</a>:</h4>
<p>here is the request for new work items for ITI  <a href="https://groups.google.com/g/itiplan/c/DFMRAKtDnG4">https://groups.google.com/g/itiplan/c/DFMRAKtDnG4</a></p>



<a name="212704886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212704886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212704886">(Oct 08 2020 at 15:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191316">Grahame Grieve</span> <a href="#narrow/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD/near/212678266">said</a>:</p>
<blockquote>
<p>so you don't want an identifier at all - <span class="user-mention silent" data-user-id="191404">John Moehrke</span> this is a more generic IHE issue - XDS for consumers will typically work this way in any country.</p>
</blockquote>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> I think it is a general purpose security/privacy preserving model... It certainly is not unique to XDS... it is driven by a Privacy preserving approach..... that said, it is fully driven by the fact that web infrastructure "default" logging logs GET parameters but does not log POST body. The problem can also be satisfied by just forbidding intermediaries and endpoints from logging GET parameters, or at least logging them into a log that is not privacy protecting (like AuditEvent schema enables).</p>



<a name="212705654"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212705654" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212705654">(Oct 08 2020 at 15:18)</a>:</h4>
<p>it might also be driven by a fallacy that the GET parameters are visible on the network, when the POST body is not visible on the network. TLS protects everything on the network.</p>



<a name="212706425"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212706425" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212706425">(Oct 08 2020 at 15:23)</a>:</h4>
<p>another factor... s that this is a discussion around where  http REST is used not in a point-to-point way. In point-to-point the two endpoints (client v server) are expected to have patient data exposure and are thus managed... the problem is when an architecture requires (or allows) trusted intermediaries. Hence, they are "trusted but not fully trusted"... when one designs an architecture that enables "trusted but not fully trusted", one creates problems like this.. once one starts with a problem like this, pushing the risks around does not eliminate the risks, it just pushes the risk around. The situation of "trusted but not fully trusted" is the problem.</p>



<a name="212706956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212706956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212706956">(Oct 08 2020 at 15:27)</a>:</h4>
<p>SOAP has mature ways of handling "trusted by not fully trusted"... Thus using SOAP transport, with REST verbs... is likely the best solution... but sure does make REST more complex than "simple http REST"... might we call this "end-to-end securable REST"?  thus just re-inventing asynchronous SOAP...  European Commission has endorsed the SOAP profile "AS4" for these cross-boarder use-cases... this is why IHE XCA added an AS4 transport model.</p>



<a name="212718914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212718914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212718914">(Oct 08 2020 at 16:52)</a>:</h4>
<p>Can you create a national extension that extends what’s been constrained?  FYI: my CP has been submitted to Sarah Bell: see CP-ITI-AHe-Addition-of-POST-based-query-option</p>



<a name="212723950"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212723950" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212723950">(Oct 08 2020 at 17:31)</a>:</h4>
<blockquote>
<p>Patient.identifier vs <a href="http://Patient.id">Patient.id</a> --- as @Vassil Peytchev indicates this confusion has driven many bad decisions. If it was pointed out that the .id would tend to be mostly a guid, AND that it is the id that is in the GET parameter... then discussion might be more informed</p>
</blockquote>
<p>I see... parameter patient exists in FHIR Core and is defined as reference, not token. Reference would indeed be based on <a href="http://Patient.id">Patient.id</a>, hence presumably meaningless. Whether or not you would know what the <a href="http://Patient.id">Patient.id</a> for a patient is on the documents you seek is doubtful. Would an XDS Index have 1 <a href="http://Patient.id">Patient.id</a> across all documents?</p>
<p>MHD in addition to FHIR Core defines patient.identifier as parameter. This seems to be clearly defined as based on the Patient.identifier which would be the national patient identifier we want to avoid.</p>
<p>Finally MHD states "The Document Consumer shall include search parameter <em>patient</em> or <em>patient.identifier</em>, and <em>status</em>." Since <em>patient</em> seems far fetched as it is unlikely I'd have that, I'd say my best bet becomes <em>patient.identifier</em>, but I cannot populate that in the URL (according to said auditors and the MedMij architecture)</p>
<p>We could make this a very big thing, but if you say it is fine to just use the application/x-www-form-urlencoded search defined in FHIR Search for MHD then maybe it is enough to apply the CP to MHD as submitted? I really suspect that treating this as a national extension after MHD explicitly constrained it, is not conformant.</p>



<a name="212724418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212724418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212724418">(Oct 08 2020 at 17:35)</a>:</h4>
<p>Re: OAuth patient tokens</p>
<p>Doing a SMART launch today with a patient context (e.g., <code>launch/patient</code>), is what you are describing, isn't it?  Based on implementations I've seen, that is the behavior enforced.</p>
<p>That said, there are also valid use cases for user level access, such as a provider looking at a list of patients.</p>
<p>I see a role for both, and feel confident that EHR vendors have policies in place to make sure that applications use the appropriate level based on their activity.</p>
<p>Overall, I don't see where the current process is deficient - is there something I'm missing?</p>



<a name="212735634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212735634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212735634">(Oct 08 2020 at 19:06)</a>:</h4>
<p>We don't do SMART on FHIR in MedMij. The architects who designed it, decided against that. Knowingly or unknowingly, I could never establish. In any case: we create IGs within the constraints of the networks they run on. We don't make those rules.</p>



<a name="212735749"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212735749" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212735749">(Oct 08 2020 at 19:07)</a>:</h4>
<p>The PHRs, at least when interacting with MedMij, do OAuth but different from SoF</p>



<a name="212744206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212744206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212744206">(Oct 08 2020 at 20:21)</a>:</h4>
<p>so the parameter defined in MHD for "patient.identifier" was intended to look for the OID defined as the Affinity Domain ID.. but reality is that your national identifier would also be in the Patient.identifier... so it could be used that way without constraint that it can ONLY be used with the affinity domain ID (OID)</p>



<a name="212744468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212744468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212744468">(Oct 08 2020 at 20:24)</a>:</h4>
<p>a realm could certain constrain OUT the Patient.identifier... forcing the use of Patient id only.</p>



<a name="212744550"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212744550" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212744550">(Oct 08 2020 at 20:25)</a>:</h4>
<p>in an XDS affinity domain, a patient would have one and only one Patient id (and one and only one affinity domain identifier)</p>



<a name="212744658"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212744658" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212744658">(Oct 08 2020 at 20:26)</a>:</h4>
<p>a realm could certainly require them be randomly assigned opaque values.</p>



<a name="212745729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212745729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212745729">(Oct 08 2020 at 20:35)</a>:</h4>
<p>We all have to live with various constraints, I understand completely!</p>
<p>However, I would also say that if you have an OAuth layer that needs items defined in SMART, it would be nice to use them (e.g., if you want patient-restricted tokens, using <code>launch/patient</code>, etc.).  Not only does it help in general with alignment, but it's less time for you spent re-inventing things.</p>



<a name="212829533"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212829533" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Venton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212829533">(Oct 09 2020 at 14:02)</a>:</h4>
<p>I suspect the trouble is that when your URL is "<a href="https://fhirserver.com/Patient?identifier=http://ssa.gov|123456677">https://fhirserver.com/Patient?identifier=http://ssa.gov|123456677</a>" (Substitute appropriate values for NL or other.) No matter what you do, no matter the auth token, no matter the certificates involved, the URL will always always be transmitted across the wire as plain text. Every single router/proxy/gateway/ISP/backbone element that handles the message will see and can log that plain text URL. Moving the values into the message, whether as a header element or part of the body (any style) means that the contents are encrypted and even if packet sniffed and logged should be undecipherable. </p>
<p>It would be great if every component between me and you could be trusted but it's public and by definition can't be.</p>
<p>What if the URL was "<a href="https://fhirserver.com/Patient?identifier=http://ssa.gov|123456677&amp;family=test&amp;given=Joe&amp;birthdate=1799-01-01">https://fhirserver.com/Patient?identifier=http://ssa.gov|123456677&amp;family=test&amp;given=Joe&amp;birthdate=1799-01-01</a>"? Any person that had access to any of those logs now can steal Joe test's identity. Perhaps enough that they will then be able to access his chart.</p>
<p>Disclaimer: As I understand internet protocols.</p>



<a name="212831607"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212831607" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212831607">(Oct 09 2020 at 14:18)</a>:</h4>
<p>That is not correct. The https encryption happens before the URL is transmitted.</p>



<a name="212835554"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212835554" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212835554">(Oct 09 2020 at 14:49)</a>:</h4>
<p>SOAP-transport REST AS4 sounds like a personal hell</p>



<a name="212835623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212835623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212835623">(Oct 09 2020 at 14:50)</a>:</h4>
<p>Please no</p>



<a name="212853312"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212853312" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212853312">(Oct 09 2020 at 17:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="192685">Vassil Peytchev</span> <a href="#narrow/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD/near/212831607">said</a>:</p>
<blockquote>
<p>That is not correct. The https encryption happens before the URL is transmitted.</p>
</blockquote>
<p><span class="user-mention" data-user-id="192685">@Vassil Peytchev</span> take a look at my explanation why GET and POST are seen as different. You will note that I fully agree with you. The issue is not on-the-wire encryption, TLS is understood and used. The issue is trusted intermediaries audit logs. ---  at least this is my understanding, right <span class="user-mention" data-user-id="191375">@Alexander Henket</span> ? can you confirm?</p>



<a name="212853391"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212853391" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212853391">(Oct 09 2020 at 17:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="200498">Brendan Keeler</span> <a href="#narrow/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD/near/212835554">said</a>:</p>
<blockquote>
<p>SOAP-transport REST AS4 sounds like a personal hell</p>
</blockquote>
<p>re-inventing it is worse hell.. but I agree SOAP and AS4 and re-invention are to be avoided.</p>



<a name="212853828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212853828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212853828">(Oct 09 2020 at 17:26)</a>:</h4>
<p>Yes, <span class="user-mention" data-user-id="191404">@John Moehrke</span> your explanation makes sense. I was responding to the claim that the URL would be "transmitted across the wire as plain text". That part is incorrect.</p>



<a name="212854564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/212854564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#212854564">(Oct 09 2020 at 17:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="192685">Vassil Peytchev</span> <a href="#narrow/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD/near/212853828">said</a>:</p>
<blockquote>
<p>Yes, <span class="user-mention silent" data-user-id="191404">John Moehrke</span> your explanation makes sense. I was responding to the claim that the URL would be "transmitted across the wire as plain text". That part is incorrect.</p>
</blockquote>
<p>agreed... this is a fallacy that is so hard to kill.</p>



<a name="213163665"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Search/IHE%20MHD/near/213163665" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Search.2FIHE.20MHD.html#213163665">(Oct 13 2020 at 14:34)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> That is what I'm told is the issue at hand yes.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
