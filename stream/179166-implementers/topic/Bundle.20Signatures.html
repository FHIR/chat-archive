---
layout: page
title: "FHIR Chat  · Bundle Signatures · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html">Bundle Signatures</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153927198"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927198" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927198">(Dec 28 2017 at 23:03)</a>:</h4>
<p>The following signed document has a valid signature:</p>



<a name="153927199"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927199" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927199">(Dec 28 2017 at 23:03)</a>:</h4>
<p><a href="/user_uploads/10155/qxfj2nNkAbf3h4yXtGvfvviS/signed.xml" target="_blank" title="signed.xml">signed.xml</a></p>



<a name="153927200"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927200" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927200">(Dec 28 2017 at 23:04)</a>:</h4>
<p>but it's not a valid FHIR instance:</p>



<a name="153927201"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927201" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927201">(Dec 28 2017 at 23:04)</a>:</h4>
<div class="codehilite"><pre><span></span>  <span class="nt">&lt;signature&gt;</span>
    <span class="nt">&lt;type&gt;</span>
      <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">&quot;urn:iso-astm:E1762-95:2013&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;1.2.840.10065.1.12.1.1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;when</span> <span class="na">value=</span><span class="s">&quot;2017-12-28T23:02:41Z&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;whoReference&gt;</span>
      <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">&quot;Practitioner/example&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/whoReference&gt;</span>
    <span class="nt">&lt;targetFormat</span> <span class="na">value=</span><span class="s">&quot;application/fhir+xml&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;sigFormat</span> <span class="na">value=</span><span class="s">&quot;application/signature+xml&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Signature</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span class="nt">&gt;&lt;SignedInfo&gt;&lt;CanonicalizationMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/TR/2001/REC-xml-c14n-20010315&quot;</span><span class="nt">/&gt;&lt;SignatureMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;</span><span class="nt">/&gt;&lt;Reference</span> <span class="na">URI=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;&lt;Transforms&gt;&lt;Transform</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;</span><span class="nt">/&gt;&lt;/Transforms&gt;&lt;DigestMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot;</span><span class="nt">/&gt;&lt;DigestValue&gt;</span>hE70IWsShlfQtc+HaiWAsl+0fkI=<span class="nt">&lt;/DigestValue&gt;&lt;/Reference&gt;&lt;/SignedInfo&gt;&lt;SignatureValue&gt;</span>IQY6hk/xtFKokFfqIKHnZnliCE1FF1bVNKqWkSI3uTYh55AqhjMCkyxaOJBu4vVclemB5TRFUAyEnxrNTYdm7hR6o7PdIJ5EO9ZuO9RSzgNkDOIfMYdPQjnECTJcN7XIuZroeviFstzR/iIECVUmTLJw0m0ddXGey8/DSLIYjgzpcZqIcVlkOs+NjqbeXJWKC260sLPwXMOyiNvfMdhLl7P424P+KHPuVUUOXTJ5jjdummJqxBVMnS/g1R+8tG9KcPG78BTbFm3m3XxBsmzJuOEw8TMiefSDZktmeQkNTGGYiVqJPTWZAlPuJFG7WZkUfWFOx76Fn+tCr9qDtWq/OA==<span class="nt">&lt;/SignatureValue&gt;&lt;KeyInfo&gt;&lt;KeyValue&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;</span>m475SJi0ndOkUWBDK9HeUPJLo5ujSiTaO23N6DrNHMR0wGzbMNTaslVKUKKF+wR1JBwoGvGLwsol0vrctR+tz/z5JbetCjOwFqh1R6ElJL7/T2sPLo1gRxpXmTAJ+kWbenQX9Z8Mr8teijGPwQ0MvQWlesl0S0ZJm4W54XVwFPsvbUaohKyCx6yBT1SyTcMHnDJve9AT/k30Gu/euxMLMQE814rSWnoyVy8p5Dt4AgTWKEgU4y2Efr8yZRlx6Fhttbt6g/lGWretlKuA46MJv3HyssYw7daTHKoHCIcaU/bhJ237pFguQg6v/Zn6U7hTHwW3lWXVXyEZCsaZtflPGw==<span class="nt">&lt;/Modulus&gt;&lt;Exponent&gt;</span>AQAB<span class="nt">&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/KeyInfo&gt;&lt;/Signature&gt;&lt;/signature&gt;</span>
</pre></div>



<a name="153927202"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927202" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927202">(Dec 28 2017 at 23:04)</a>:</h4>
<p>problem is that the signature needs to be put in a blob... but then it's not an enveloped signature... so I'm not sure what it should look like?</p>



<a name="153927203"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927203" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927203">(Dec 28 2017 at 23:04)</a>:</h4>
<p><span class="user-mention" data-user-id="191407">@Rick Geimer</span> <span class="user-mention" data-user-id="191404">@John Moehrke</span></p>



<a name="153927205"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927205" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927205">(Dec 29 2017 at 00:30)</a>:</h4>
<p>Grahame, what are you trying to show?</p>



<a name="153927206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927206">(Dec 29 2017 at 00:31)</a>:</h4>
<p>The blob is the base64 of the xml signature. Not what you have.</p>



<a name="153927207"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927207" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927207">(Dec 29 2017 at 00:31)</a>:</h4>
<p>right. So what should the signature in the blob look like. is reference="" still valid?</p>



<a name="153927208"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927208" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927208">(Dec 29 2017 at 00:32)</a>:</h4>
<p>sorry. i don't understand your question.</p>



<a name="153927209"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927209" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927209">(Dec 29 2017 at 00:33)</a>:</h4>
<p>An enveloped signature is added to an XML document, like above. It has &lt;Reference URI=""&gt; - to indicate that what is signed is the XML document that contains the signature, and it is removed before verifying the signature.</p>



<a name="153927210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927210">(Dec 29 2017 at 00:33)</a>:</h4>
<p>I do not see that it is possible to have an enveloped signature in a Bundle - yet it must be because it is inside the bundle</p>



<a name="153927211"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927211" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927211">(Dec 29 2017 at 00:33)</a>:</h4>
<p>An enveloped signature?</p>



<a name="153927212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927212">(Dec 29 2017 at 00:34)</a>:</h4>
<p>yes. that's what we're talking about</p>



<a name="153927213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927213">(Dec 29 2017 at 00:34)</a>:</h4>
<p>so Bundle.signature</p>



<a name="153927214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927214">(Dec 29 2017 at 00:34)</a>:</h4>
<p>.. yes, that's what I'm asking about.</p>



<a name="153927215"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927215" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927215">(Dec 29 2017 at 00:34)</a>:</h4>
<p>Yes you have indeed happened upon a problem that who ever added signature to Bundle didn't address. I was not aware</p>



<a name="153927216"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927216" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927216">(Dec 29 2017 at 00:35)</a>:</h4>
<p>not aware that Bundle contains a signature..?</p>



<a name="153927217"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927217" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927217">(Dec 29 2017 at 00:35)</a>:</h4>
<p>for encapsulated signatures, typically the xml-signature would have an xpath exception for the place where the signature is going to be stored.</p>



<a name="153927218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927218">(Dec 29 2017 at 00:36)</a>:</h4>
<p>what does that look like?</p>



<a name="153927219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927219">(Dec 29 2017 at 00:36)</a>:</h4>
<p>that is what CDA did with the encapsulated xml-signature</p>



<a name="153927220"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927220" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927220">(Dec 29 2017 at 00:36)</a>:</h4>
<p>encapsulated signatures are trouble... not just because of this. But because of this need to exclude from the signature a region where the signature will go.... bad-guys simply put what they want inside that exception area</p>



<a name="153927222"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927222" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927222">(Dec 29 2017 at 00:40)</a>:</h4>
<p>what's a good reference for the CDA encapsulated signature? I can't find good information about " the xml-signature would have an xpath exception"?</p>



<a name="153927223"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927223" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927223">(Dec 29 2017 at 00:41)</a>:</h4>
<p><a href="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=375" target="_blank" title="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=375">http://www.hl7.org/implement/standards/product_brief.cfm?product_id=375</a></p>



<a name="153927224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927224">(Dec 29 2017 at 00:46)</a>:</h4>
<p>hmmm, I expected that was  a bit more instructive</p>



<a name="153927225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927225">(Dec 29 2017 at 00:53)</a>:</h4>
<p>it doesn't help. For a start, the example is not legal (not even any namespace)</p>



<a name="153927226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927226">(Dec 29 2017 at 00:54)</a>:</h4>
<p>So, all of the actual uses that I have worked with are signatures by reference. Like what we did in Provenance, or IHE DSG. Where the signature is not contained within the hash space. I only know of the theory, don't have a good example. For an encapsulated signature you need to exclude from the hashed space the slot where you are putting the blob.</p>



<a name="153927227"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927227" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927227">(Dec 29 2017 at 00:58)</a>:</h4>
<p>now that I've read the text of that document, I'm getting more unhappy. The examples have "&lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/&gt;" - but this is a lie, because: </p>
<p>A digest is the result of a mathematical algorithm that takes all of the bits of the thing to be signed (in this case, the CDA document excluding the legalAuthenticator and authenticator tags in the CDA header)</p>



<a name="153927228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927228">(Dec 29 2017 at 00:59)</a>:</h4>
<p>It's also hard to believe that the signature ignores the authenticator information - that information that binds between the signature and the thing being signed.... surely that smells badly?</p>



<a name="153927229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927229">(Dec 29 2017 at 00:59)</a>:</h4>
<p>how does IHE DSG work with CDA documents?</p>



<a name="153927230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927230">(Dec 29 2017 at 01:01)</a>:</h4>
<p>yeah, I do remember I put in a bunch of negative comments... That is what resulted</p>



<a name="153927231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927231">(Dec 29 2017 at 01:02)</a>:</h4>
<p>DSG just makes a XML-Signature blob (as a document) of a signed document (by reference)</p>



<a name="153927232"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927232" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927232">(Dec 29 2017 at 01:02)</a>:</h4>
<p>thus there is no need to exclude anything</p>



<a name="153927233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927233">(Dec 29 2017 at 01:02)</a>:</h4>
<p>simple</p>



<a name="153927234"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927234" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927234">(Dec 29 2017 at 01:02)</a>:</h4>
<p>what you need for Bundle is <a href="https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature" target="_blank" title="https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature">https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature</a></p>



<a name="153927235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927235">(Dec 29 2017 at 01:02)</a>:</h4>
<p>where you exclude the Bundle.signature element during signing and validation</p>



<a name="153927236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927236">(Dec 29 2017 at 01:02)</a>:</h4>
<p>but where does the signature go? It just moves the problems around</p>



<a name="153927237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927237">(Dec 29 2017 at 01:03)</a>:</h4>
<p>in IHE-DSG? There are two options... ( a ) Two documents are in the Registry... one is XML-Signature, the other is the signed docment</p>



<a name="153927238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927238">(Dec 29 2017 at 01:03)</a>:</h4>
<p>The other one ( b ) is enveloped... That is the signed document is base64 encoded INTO the XML-Signature.</p>



<a name="153927239"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927239" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927239">(Dec 29 2017 at 01:03)</a>:</h4>
<p>no,... not enveloped... enveloping.</p>



<a name="153927240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927240">(Dec 29 2017 at 01:04)</a>:</h4>
<p>you want envelopedSignature</p>



<a name="153927241"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927241" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927241">(Dec 29 2017 at 01:04)</a>:</h4>
<p>so note that the actual transform for <a href="https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature" target="_blank" title="https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature">https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature</a> is pre-specified - to exclude the dsig:Signature. So we'd have to define our own canonicalization then</p>



<a name="153927242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927242">(Dec 29 2017 at 01:04)</a>:</h4>
<p>that is where you put the signature into the signed-document, in an element excluded from the signature calculation</p>



<a name="153927243"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927243" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927243">(Dec 29 2017 at 01:04)</a>:</h4>
<p>yup</p>



<a name="153927244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927244">(Dec 29 2017 at 01:07)</a>:</h4>
<p>so, I guess that should not be too hard to do for Bundle.signature... right? And we can likely use fhir path?</p>



<a name="153927245"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927245" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927245">(Dec 29 2017 at 01:08)</a>:</h4>
<p>I hadn't noticed that the xpath exclusion is baked into the canonicalization algorithm... and thus we need our own..</p>



<a name="153927246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927246">(Dec 29 2017 at 01:08)</a>:</h4>
<p>so then why is that not in the CDA signature spec.. hmmmm.....</p>



<a name="153927247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927247">(Dec 29 2017 at 01:12)</a>:</h4>
<p>yes CDA spec is broken. I think we don't want to follow.</p>



<a name="153927248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927248">(Dec 29 2017 at 01:13)</a>:</h4>
<p>so I think we need a new method code here: <a href="http://build.fhir.org/xml.html#digsig" target="_blank" title="http://build.fhir.org/xml.html#digsig">http://build.fhir.org/xml.html#digsig</a></p>



<a name="153927249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927249">(Dec 29 2017 at 01:14)</a>:</h4>
<p><a href="http://hl7.org/fhir/canonicalization/xml#bundle" target="_blank" title="http://hl7.org/fhir/canonicalization/xml#bundle">http://hl7.org/fhir/canonicalization/xml#bundle</a> - signs an entire document, with the exception of Bundle.signature.blob</p>



<a name="153927250"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927250" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927250">(Dec 29 2017 at 01:22)</a>:</h4>
<p>sounds like that is heading in the right direction.</p>



<a name="153927251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927251">(Dec 29 2017 at 01:23)</a>:</h4>
<p>The way I defined the signature datatype, it is not intended to be part of the signature. All the elements in the signature datatype are intended to be just easy access for a FHIR app to stuff that formally is part of the xml-signature.</p>



<a name="153927252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927252">(Dec 29 2017 at 01:23)</a>:</h4>
<p>so, exclude the whole signature, not just the signature.blob</p>



<a name="153927253"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927253" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927253">(Dec 29 2017 at 01:23)</a>:</h4>
<p>that is just my logic... it might not be useful logic</p>



<a name="153927254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927254">(Dec 29 2017 at 01:24)</a>:</h4>
<p>that also makes it easier to fixup the elements i Signature without invalidating the digital-signature</p>



<a name="153927255"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927255" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927255">(Dec 29 2017 at 01:30)</a>:</h4>
<p>I don't follow why you'd exclude all the elements that are easy access from the signature - just seems like it creates an obvious attack point - sign, but hack all the easy statements about the signature...</p>



<a name="153927256"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927256" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927256">(Dec 29 2017 at 01:49)</a>:</h4>
<p>I put warnings in the Signature datatype about this</p>



<a name="153927257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927257">(Dec 29 2017 at 01:50)</a>:</h4>
<p>most will use these elements to find things, but they know for legal reliance (like a legal audit) they need to look at the same elements as captured within the signature itself</p>



<a name="153927258"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927258" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927258">(Dec 29 2017 at 01:56)</a>:</h4>
<p>I don't see the language. I don't see why we shouldn't sign them.</p>



<a name="153927259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927259">(Dec 29 2017 at 01:57)</a>:</h4>
<p>I didn't say I put that language in there... I never expected someone to try an enveloped signature</p>



<a name="153927260"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927260" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927260">(Dec 29 2017 at 01:57)</a>:</h4>
<p>"I put warnings in the Signature datatype about this"....?</p>



<a name="153927261"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927261" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927261">(Dec 29 2017 at 01:58)</a>:</h4>
<p>is there any reason it shouldn't be a detached signature in there?</p>



<a name="153927262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927262">(Dec 29 2017 at 01:58)</a>:</h4>
<p>about the fact the elements in the Signature datatype are informative, not part of a signature</p>



<a name="153927263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927263">(Dec 29 2017 at 01:59)</a>:</h4>
<p>I've read it several times and can't see it</p>



<a name="153927264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927264">(Dec 29 2017 at 02:02)</a>:</h4>
<p>hmmm... It must be well written in my head</p>



<a name="153927265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927265">(Dec 29 2017 at 02:02)</a>:</h4>
<p>write a CR?</p>



<a name="153927266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927266">(Dec 29 2017 at 02:02)</a>:</h4>
<p>more evidence that this is a good candidate to stay STU</p>



<a name="153927267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927267">(Dec 29 2017 at 02:03)</a>:</h4>
<p>I start here... but it also doesn't say what I think it shouldhttp://build.fhir.org/secpriv-module.html#signature</p>



<a name="153927268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927268">(Dec 29 2017 at 02:03)</a>:</h4>
<p><a href="http://build.fhir.org/secpriv-module.html#signature" target="_blank" title="http://build.fhir.org/secpriv-module.html#signature">http://build.fhir.org/secpriv-module.html#signature</a></p>



<a name="153927269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927269">(Dec 29 2017 at 02:03)</a>:</h4>
<p>back to detached/enveloped - is there any reason we shouldn't use detached in Bundle.signature.blob?</p>



<a name="153927270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927270">(Dec 29 2017 at 02:05)</a>:</h4>
<p>I am not clear what the use-case for Bundle.signature is</p>



<a name="153927271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927271">(Dec 29 2017 at 02:05)</a>:</h4>
<p>I saw it appear there, but was not involved in it</p>



<a name="153927272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927272">(Dec 29 2017 at 02:06)</a>:</h4>
<p>signing documents exactly similar to the CDA use case</p>



<a name="153927274"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927274" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927274">(Dec 29 2017 at 02:12)</a>:</h4>
<p>As I have indicated... most that go to the extent of actually trying to make this work in real life... use detached, and maintain the signatures independent of the signed object. It is just more robust</p>



<a name="153927275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927275">(Dec 29 2017 at 02:12)</a>:</h4>
<p>Provenance can do this for the whole FHIR-Document</p>



<a name="153927276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927276">(Dec 29 2017 at 02:13)</a>:</h4>
<p>Provenance.target points at the FHIR Document, Provenance.signature holds the signature of that FHIR Document</p>



<a name="153927277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927277">(Dec 29 2017 at 02:13)</a>:</h4>
<p>I'm suspicious of this. It feels like it moves the deckchairs around - how do I know I have the right matching provenance?</p>



<a name="153927278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927278">(Dec 29 2017 at 02:13)</a>:</h4>
<p>enveloped signatures looks cool, and seems like what one would want... but it is a bitch to get right, and cracks easy</p>



<a name="153927279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927279">(Dec 29 2017 at 02:14)</a>:</h4>
<p>why would you not find the right one?</p>



<a name="153927280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927280">(Dec 29 2017 at 02:14)</a>:</h4>
<p>see <a href="http://wiki.hl7.org/index.php?title=201801_FHIR_Documents" target="_blank" title="http://wiki.hl7.org/index.php?title=201801_FHIR_Documents">http://wiki.hl7.org/index.php?title=201801_FHIR_Documents</a> - what would you propose? <span class="user-mention" data-user-id="191918">@Sarah Gaunt</span> <span class="user-mention" data-user-id="191505">@Sean McIlvenna</span> <span class="user-mention" data-user-id="191407">@Rick Geimer</span></p>



<a name="153927281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927281">(Dec 29 2017 at 02:16)</a>:</h4>
<p>should be fun</p>



<a name="153927282"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927282" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927282">(Dec 29 2017 at 02:17)</a>:</h4>
<p>doesn't a FHIR Document exist as a FHIR Resource? Thus a Provenance.target can point at that FHIR Document?</p>



<a name="153927283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927283">(Dec 29 2017 at 02:19)</a>:</h4>
<p>it can. But the implication of what you are saying is that we might as well remove Bundle.signature</p>



<a name="153927284"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927284" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927284">(Dec 29 2017 at 02:21)</a>:</h4>
<p>so if someone just added signature to Bundle expecting magjic would happen... then, yes, we should remove it until we can make it work</p>



<a name="153927285"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927285" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927285">(Dec 29 2017 at 02:21)</a>:</h4>
<p>sure sounds well outside the 80%</p>



<a name="153927286"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927286" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927286">(Dec 29 2017 at 02:41)</a>:</h4>
<p>it's been there a long time. Since the beginning, in fact, since it cam out of Atom</p>



<a name="153927291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927291">(Dec 29 2017 at 07:25)</a>:</h4>
<p>ok, an update, then. Here's a revised signed document, for comment</p>



<a name="153927292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927292">(Dec 29 2017 at 07:26)</a>:</h4>
<p><a href="/user_uploads/10155/-D9iRELtFSFVMu-PaTlGvkd6/signed.xml" target="_blank" title="signed.xml">signed.xml</a></p>



<a name="153927293"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927293" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927293">(Dec 29 2017 at 07:26)</a>:</h4>
<p>for reader convenience, here's the signature directly:</p>



<a name="153927294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927294">(Dec 29 2017 at 07:26)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;Signature</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;SignedInfo&gt;</span>
    <span class="nt">&lt;CanonicalizationMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/TR/2001/REC-xml-c14n-20010315&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;SignatureMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Reference&gt;</span>
      <span class="nt">&lt;Transforms&gt;</span>
        <span class="nt">&lt;Transform</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/Transforms&gt;</span>
      <span class="nt">&lt;DigestMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;DigestValue&gt;</span>Vyn0Z139dlswfTg1Ivx/DNlVJAJoRC+ros1dtAKKHGo=<span class="nt">&lt;/DigestValue&gt;</span>
    <span class="nt">&lt;/Reference&gt;</span>
  <span class="nt">&lt;/SignedInfo&gt;</span>
  <span class="nt">&lt;SignatureValue&gt;</span>RU2N7C/WdTuuk5PCbdBL6/Qk6Tx46qEN1K4t6FbdZJmnDmYmlEn6WA+D1AnfQcfkDGlsSS2oyr/vZNRGyVSiVZkQAcHs2ExUo8YuwyI/SU40Mc9uqpWb18LNVu3+DRBaowUTzcDoafIBVkEe+Qv5B2kgByiqe2MN1V/a/dwjiMdb+SMXah60yHaq0o5vOYerAx/NYt4cpruvLcHUD6zRu+9f3h+Ptj+6hjhaK2P+WpNjANm3QokzZnqhAKqEwlNd1yFPBcL6zMhQKSvijkyNQDnjPGNfDyJDjc4LaZZ6SXu6TCiZICiYemlfypsZ7FiGYqc9OTAbWUqr/hqQQEw+qA==<span class="nt">&lt;/SignatureValue&gt;</span>
  <span class="nt">&lt;KeyInfo&gt;</span>
    <span class="nt">&lt;KeyValue&gt;</span>
      <span class="nt">&lt;RSAKeyValue&gt;</span>
        <span class="nt">&lt;Modulus&gt;</span>m475SJi0ndOkUWBDK9HeUPJLo5ujSiTaO23N6DrNHMR0wGzbMNTaslVKUKKF+wR1JBwoGvGLwsol0vrctR+tz/z5JbetCjOwFqh1R6ElJL7/T2sPLo1gRxpXmTAJ+kWbenQX9Z8Mr8teijGPwQ0MvQWlesl0S0ZJm4W54XVwFPsvbUaohKyCx6yBT1SyTcMHnDJve9AT/k30Gu/euxMLMQE814rSWnoyVy8p5Dt4AgTWKEgU4y2Efr8yZRlx6Fhttbt6g/lGWretlKuA46MJv3HyssYw7daTHKoHCIcaU/bhJ237pFguQg6v/Zn6U7hTHwW3lWXVXyEZCsaZtflPGw==<span class="nt">&lt;/Modulus&gt;</span>
        <span class="nt">&lt;Exponent&gt;</span>AQAB<span class="nt">&lt;/Exponent&gt;</span>
      <span class="nt">&lt;/RSAKeyValue&gt;</span>
    <span class="nt">&lt;/KeyValue&gt;</span>
  <span class="nt">&lt;/KeyInfo&gt;</span>
<span class="nt">&lt;/Signature&gt;</span>
</pre></div>



<a name="153927296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927296">(Dec 29 2017 at 07:27)</a>:</h4>
<p>oh. oops. missed something. I'll try again shorlty</p>



<a name="153927297"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927297" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927297">(Dec 29 2017 at 07:52)</a>:</h4>
<p>ok, this pair:</p>



<a name="153927298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927298">(Dec 29 2017 at 07:53)</a>:</h4>
<p><a href="/user_uploads/10155/-LRZijcZ-ClpIas0QcaYkKQ4/signed.xml" target="_blank" title="signed.xml">signed.xml</a></p>



<a name="153927299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927299">(Dec 29 2017 at 07:53)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;Signature</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;SignedInfo&gt;</span>
    <span class="nt">&lt;CanonicalizationMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://hl7.org/fhir/canonicalization/xml#bundle&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;SignatureMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Reference&gt;</span>
      <span class="nt">&lt;Transforms&gt;</span>
        <span class="nt">&lt;Transform</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/Transforms&gt;</span>
      <span class="nt">&lt;DigestMethod</span> <span class="na">Algorithm=</span><span class="s">&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;DigestValue&gt;</span>H/lLrIGPTNlpf1Xr78AmZ2VVCDeO4XzYZalqxCgJmVQ=<span class="nt">&lt;/DigestValue&gt;</span>
    <span class="nt">&lt;/Reference&gt;</span>
  <span class="nt">&lt;/SignedInfo&gt;</span>
  <span class="nt">&lt;SignatureValue&gt;</span>kwm6FNATYxp4sdHf0noK8Z1JBCyw+XisaRvhjsiIuL6emO7Yityq3CIRWm2WS8aAeq/bzcRrqRQB+TJKuwDGOXqJarkH7VuBreAMMNDotctMPSnb7BInzSpg+ytus1fz7MvtlQBpfyuEwNA4RNJcOLK8BgQe1pWwckNaNt5hN2Rn71E+doGr3g7FeX7kQZ3yWJTV7XWExVZdmDaDRI77N+AsNIPNP4Nc/OiAJJP+DAeHW15AJssQUIykr0ZKTaPLVPdk7N2QwBpkYsbkHh1646ys5MKDYu9+fRb8il5x8Ao1Dxgbeoow8VXDW1RI1cCbT7T5V+cm+T15LCTB9iCRRw==<span class="nt">&lt;/SignatureValue&gt;</span>
  <span class="nt">&lt;KeyInfo&gt;</span>
    <span class="nt">&lt;KeyValue&gt;</span>
      <span class="nt">&lt;RSAKeyValue&gt;</span>
        <span class="nt">&lt;Modulus&gt;</span>m475SJi0ndOkUWBDK9HeUPJLo5ujSiTaO23N6DrNHMR0wGzbMNTaslVKUKKF+wR1JBwoGvGLwsol0vrctR+tz/z5JbetCjOwFqh1R6ElJL7/T2sPLo1gRxpXmTAJ+kWbenQX9Z8Mr8teijGPwQ0MvQWlesl0S0ZJm4W54XVwFPsvbUaohKyCx6yBT1SyTcMHnDJve9AT/k30Gu/euxMLMQE814rSWnoyVy8p5Dt4AgTWKEgU4y2Efr8yZRlx6Fhttbt6g/lGWretlKuA46MJv3HyssYw7daTHKoHCIcaU/bhJ237pFguQg6v/Zn6U7hTHwW3lWXVXyEZCsaZtflPGw==<span class="nt">&lt;/Modulus&gt;</span>
        <span class="nt">&lt;Exponent&gt;</span>AQAB<span class="nt">&lt;/Exponent&gt;</span>
      <span class="nt">&lt;/RSAKeyValue&gt;</span>
    <span class="nt">&lt;/KeyValue&gt;</span>
  <span class="nt">&lt;/KeyInfo&gt;</span>
<span class="nt">&lt;/Signature&gt;</span>
</pre></div>



<a name="153927303"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927303" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927303">(Dec 29 2017 at 08:52)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> turning my attention to a json equivalent now.... we (you!) specify the mime type for json as application/jose. Is the specifically not application/jose+json? I would have thought that application/jose+json was actually the right thing to use in a Signature?</p>



<a name="153927313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927313">(Dec 29 2017 at 13:03)</a>:</h4>
<p>that is what the RFC said to use...</p>



<a name="153927341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927341">(Dec 29 2017 at 18:52)</a>:</h4>
<ul>
<li>application/jose = the compact form (URL safe encoding)</li>
<li>application/jose+json = the full form (json encoding)</li>
</ul>
<p>You've specified the URL safe encoding.....</p>



<a name="153927357"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927357" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927357">(Dec 30 2017 at 23:09)</a>:</h4>
<p>Will this also work for the bulk data transfer json format?<br>
I expect this could be a useful place for it.</p>



<a name="153927365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927365">(Dec 31 2017 at 10:03)</a>:</h4>
<p>I don't think signatures apply there - tough situation for signatures</p>



<a name="153927374"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927374" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927374">(Dec 31 2017 at 20:36)</a>:</h4>
<p>Bulk data transfer, is likely well enough covered by the communications security mechanism (e.g. mutually-authenticated TLS,  https+OAuth, https+SMIME, S/MIME). So there is not really a need for a signature in the bundle.</p>



<a name="153927375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927375">(Dec 31 2017 at 20:40)</a>:</h4>
<p>end-to-end security (made up of multiple point-to-point communications), is more the space where a signature is needed. Biggest use-case is where an object sits-at-rest for a period of time, and one needs an integrity check that the object has not changed while it was resting.  Which is why the topic is natural to come up with a FHIR Document, or any FHIR Resource. the use-case for any FHIR Resource is well covered by Provenance.signature. I would argue that this same solution should be considered for FHIR Document, until someone identifies a specific use-case. We can then assess that specific use-case for best solution.  This said, there is clearly more "Trial" (STU) experience we need with this solution.</p>



<a name="153927484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Geimer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927484">(Jan 03 2018 at 00:40)</a>:</h4>
<p>Just coming up to speed on this after the holidays. <span class="user-mention" data-user-id="191918">@Sarah Gaunt</span> please read the whole thread. </p>
<p>On the FHIR Documents track, we added the digital signature scenario specifically because it needs testing. We actually added it several connectathons ago, but no one did it yet (most people who sign up for the documents track are newbies to docs). </p>
<p>Assuming someone does try it this time around, I think we should test both the detached (using Provenance) and enveloped (using Grahame's sample as an example) methods. </p>
<p>Also, maybe this is a dumb question, but why not follow <a href="https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature" target="_blank" title="https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature">https://www.w3.org/TR/xmldsig-core1/#sec-EnvelopedSignature</a> exactly and use dsig:Signature? Yes it's in another namespace, but is there a reason why we can't do that for XML?</p>



<a name="153927486"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927486" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927486">(Jan 03 2018 at 00:45)</a>:</h4>
<p>we could but it's a lot of work for everyone</p>



<a name="153927487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927487">(Jan 03 2018 at 00:45)</a>:</h4>
<p>what would it look lke for json?</p>



<a name="153927489"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927489" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927489">(Jan 03 2018 at 00:46)</a>:</h4>
<p>a for provenance, what workflow do you want for the connectathon?</p>



<a name="153927490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Geimer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927490">(Jan 03 2018 at 00:46)</a>:</h4>
<p>I'm not much of a JSON guy, better to ask someone who is. I assume there is a preferred method of signing JSON files, yes?</p>



<a name="153927491"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927491" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927491">(Jan 03 2018 at 00:47)</a>:</h4>
<p>I expected to add a sign parameter to the $document operation, but I fall over on passwords/access (personal or system cert?). What would the flow be for a provenance?</p>



<a name="153927492"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927492" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927492">(Jan 03 2018 at 00:48)</a>:</h4>
<p>well, there's a way to, yes, though I haven't got the bottom of jose yet. I haven't found enveloped signatures there yet. <span class="user-mention" data-user-id="191404">@John Moehrke</span>?</p>



<a name="153927493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Geimer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927493">(Jan 03 2018 at 00:50)</a>:</h4>
<p>The flow from the Connectathon perspective? I assume it would be pretty simple:<br>
a) Create a document<br>
b) Calculate the signature for the document<br>
c) Create the Provenance resource and stuff the sig in there. <br>
d) Post both to  your favorite FHIR server</p>



<a name="153927495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927495">(Jan 03 2018 at 00:55)</a>:</h4>
<p>so the client does the signing? ok</p>



<a name="153927496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927496">(Jan 03 2018 at 00:56)</a>:</h4>
<p>can you update the wiki page?</p>



<a name="153927503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Geimer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927503">(Jan 03 2018 at 04:41)</a>:</h4>
<p>Sure</p>



<a name="153927534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927534">(Jan 03 2018 at 16:56)</a>:</h4>
<p>This will be enlightening. The main problems with the client doing the signatures is all of the expected reference fixup that the server will do will cause that signaure to break. This is the main problem we have identified as a problem for all digital signatures <a href="http://wiki.hl7.org/index.php?title=FHIR_Digital_Signature_Working_Page" target="_blank" title="http://wiki.hl7.org/index.php?title=FHIR_Digital_Signature_Working_Page">http://wiki.hl7.org/index.php?title=FHIR_Digital_Signature_Working_Page</a></p>



<a name="153927535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927535">(Jan 03 2018 at 16:57)</a>:</h4>
<p>The text I put in for json signatures was purely done by theory... no actual trial feedback has been received.</p>



<a name="153927567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927567">(Jan 03 2018 at 21:19)</a>:</h4>
<p>this is why an encapsulated signature on a bundle is so much simpler - because there's no external dependencies to intrude on the content. The idea that encapsulated signatures are harder is because of externalised complexity</p>



<a name="153927569"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927569" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927569">(Jan 03 2018 at 21:33)</a>:</h4>
<p>I will implement a client that uses $document on the server, signs the response, and posts it back to the server as a binary, with either an encapsulated signature or a detached provenance</p>



<a name="153927572"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927572" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927572">(Jan 03 2018 at 22:00)</a>:</h4>
<p>If you have already fixedup the references, then that problem goes away. Not sure how encapsulated signature magjically solves the fixup problem.</p>



<a name="153927582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927582">(Jan 04 2018 at 01:28)</a>:</h4>
<p>No need to fiddle with references afterwards. Unlike in other contexts.</p>



<a name="153927583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927583">(Jan 04 2018 at 01:31)</a>:</h4>
<p>On this subject, take this workflow: generate a document, sign it, post it to the server as a binary. <span class="user-mention" data-user-id="191328">@Ewout Kramer</span> <span class="user-mention" data-user-id="191319">@James Agnew</span> <span class="user-mention" data-user-id="191315">@Josh Mandel</span> - the content type will be none other than.. application/fhir+[fmt]... which is ambiguous... isn’t it?</p>



<a name="153927592"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927592" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927592">(Jan 04 2018 at 07:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191407">@Rick Geimer</span> <span class="user-mention" data-user-id="191918">@Sarah Gaunt</span> is there a specified version of FHIR for the document track?</p>



<a name="153927843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927843">(Jan 06 2018 at 02:51)</a>:</h4>
<p>ok. so I have released a new version of the FHIRToolkit that supports the following workflow:<br>
- connect to a server<br>
- find a patient, double click<br>
- see the patient's compositions, double  click  one<br>
- toolkit fetches a document using $document<br>
- allows the user to see the document<br>
- prompts for user to provide certificate details to sign the document<br>
- allows user to choose an embedded signature (Bundle.signature) or a detached signature (Provenance.signature)<br>
- allows the user to save Document/DocumentReference(/Provenance) back to the server, or to a local file</p>
<p><span class="user-mention" data-user-id="191407">@Rick Geimer</span> <span class="user-mention" data-user-id="191918">@Sarah Gaunt</span> <span class="user-mention" data-user-id="191505">@Sean McIlvenna</span></p>



<a name="153927844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Bundle%20Signatures/near/153927844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Bundle.20Signatures.html#153927844">(Jan 06 2018 at 02:52)</a>:</h4>
<p>xml signatures a supported (completely, so far as I can tell). JSON signatures is a work in progress</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
