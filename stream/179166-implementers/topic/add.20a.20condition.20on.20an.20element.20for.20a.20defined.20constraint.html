---
layout: page
title: "FHIR Chat  · add a condition on an element for a defined constraint · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html">add a condition on an element for a defined constraint</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="176072217"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176072217" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176072217">(Sep 19 2019 at 06:22)</a>:</h4>
<p>There are a few FHIRPath invariants, defined on various elements of a profile. <br>
Some of those invariants/constraints restricts the elements present downward in the hierarchy. <br>
e.g. an invariant having the key "inv-1" defined on the Patient  element having expression "name.exists() or identifier.exists()" involves three elements: <strong>Patient</strong>, <strong>name</strong> and <strong>identifier</strong>. <br>
I want the (I) Flag to appear on <strong>each of the three elements above</strong>, in both the <strong>Differential</strong> or <strong>Snapshot</strong> views of the Patient profile.<br>
This page <strong>http://hl7.org/fhir/R4/formats.html#table</strong> states this about the (I) flag ---&gt; I: This element defines or is affected by constraints <br>
I am using Firely Forge and IG Publisher to edit the profile and generate the IG, but the results are mostly inconsistent and incorrect. <br>
In most of the cases the xml fragment added is like this: <strong>&lt;condition value="invariant-key" /&gt;</strong><br>
e.g.<br>
&lt;StructureDefinition xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
.<br>
.<br>
.<br>
 &lt;differential&gt;<br>
    &lt;element id="Patient"&gt;<br>
      &lt;path value="Patient" /&gt;<br>
      &lt;constraint&gt;<br>
<strong>&lt;key value="inv-1" /&gt;</strong><br>
        &lt;severity value="error" /&gt;<br>
        &lt;human value="The patient must have a name or an identifer" /&gt;<br>
        &lt;expression value="name.exists() or identifier.exists" /&gt;<br>
      &lt;/constraint&gt;<br>
    &lt;/element&gt;<br>
.<br>
.<br>
.<br>
    &lt;element id="Patient.identifier"&gt;<br>
      &lt;path value="Patient.identifier" /&gt;<br>
<strong>&lt;condition value="inv-1" /&gt;</strong><br>
    &lt;/element&gt;<br>
    &lt;element id="<a href="http://Patient.name" target="_blank" title="http://Patient.name">Patient.name</a>"&gt;<br>
      &lt;path value="<a href="http://Patient.name" target="_blank" title="http://Patient.name">Patient.name</a>" /&gt;<br>
<strong>&lt;condition value="inv-1" /&gt;</strong><br>
    &lt;/element&gt;<br>
.<br>
.<br>
.<br>
 &lt;/differential&gt;<br>
&lt;/StructureDefinition&gt;</p>
<p>Just wanted to know if anyone has tested doing it before and have they got the intended results?</p>



<a name="176081352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176081352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176081352">(Sep 19 2019 at 09:14)</a>:</h4>
<p>you have an example?</p>



<a name="176170459"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176170459" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176170459">(Sep 20 2019 at 07:18)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  </p>
<p>I have tried to re-create the issue I faced working on the Agency profiles, using the HL7AU (FHIR R4) Practitioner profile.<br>
The link of the profile I have used is -- <a href="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-practitioner.html" target="_blank" title="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-practitioner.html">http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-practitioner.html</a> <br>
GitHub link --- <a href="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml" target="_blank" title="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml">https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml</a> <br>
This is the copy of the profile that currently exists -- <a href="/user_uploads/10155/zTbnZ_SaAnaNfJkaAH1e9OvB/au-practitioner.xml" target="_blank" title="au-practitioner.xml">au-practitioner.xml</a>.</p>
<p>Then I added the following five conditions on the relevant elements using Forge.<br>
      &lt;condition value="inv-hpii-0" /&gt;<br>
      &lt;condition value="inv-hpii-1" /&gt;<br>
      &lt;condition value="inv-hpii-2" /&gt;<br>
      &lt;condition value="inv-caei-0" /&gt;<br>
      &lt;condition value="inv-ahpra-1" /&gt;<br>
A copy of the modified file is here --- <a href="/user_uploads/10155/d3ulqeGRyzm2GjZKeDInvJXn/au-practitioner-conditions-only.xml" target="_blank" title="au-practitioner-conditions-only.xml">au-practitioner-conditions-only.xml</a>  </p>
<p>The "Differential Table" shows the (I) Flag as expected, on the elements the condition is added on. Screenshot here --- <a href="/user_uploads/10155/5vJk33bUzraRlhFvtbhgWdC4/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a><br>
But the "Snapshot Table" does not! Screenshot here --- <a href="/user_uploads/10155/10NgGeavSTAV_d1aKfnV0WbE/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a><br>
Also the "Detailed Descriptions" Tab does not have the text which <br>
- <strong>either</strong> says "This element is affected by the following invariants: &lt;inv-key&gt;" <br>
- <strong>or</strong> probably something similar to this as shown in this screenshot --- <a href="/user_uploads/10155/K2ck71f4hwhiiQJcJbx4gPWw/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<p>Please let me know in case I have missed anything or I am still not very clear. </p>
<p>PS: I have deliberately not added the queries about the au-practitioner profile the Forge Tool generated, when I added the 5 conditions, as that would potentially add to confusion.</p>



<a name="176177280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176177280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176177280">(Sep 20 2019 at 09:20)</a>:</h4>
<p>Seems like a rendering error? I would expect the rendering logic to pick up and display your constraints &amp; conditions.</p>



<a name="176409870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176409870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176409870">(Sep 23 2019 at 21:08)</a>:</h4>
<p>fixed next release</p>



<a name="176428456"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176428456" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176428456">(Sep 24 2019 at 03:02)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="176429066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176429066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176429066">(Sep 24 2019 at 03:21)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191336">@Michel Rutten</span>, just a query in relation to this. (Not sure if this is the right place to raise it. Please advise if you think a separate topic in another stream will be preferable)</p>
<p>As described above I used this <a href="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-practitioner.html" target="_blank" title="http://build.fhir.org/ig/hl7au/au-fhir-base/StructureDefinition-au-practitioner.html">au-practitioner</a> profile to add Invariant Flag conditions, a copy of which is here --- <a href="/user_uploads/10155/zTbnZ_SaAnaNfJkaAH1e9OvB/au-practitioner.xml" target="_blank" title="au-practitioner.xml">au-practitioner.xml</a>  <br>
I opened this file in Forge and added only these five conditions, without changing anything else and then saved it.<br>
&lt;condition value="inv-hpii-0" /&gt;<br>
&lt;condition value="inv-hpii-1" /&gt;<br>
&lt;condition value="inv-hpii-2" /&gt;<br>
&lt;condition value="inv-caei-0" /&gt;<br>
&lt;condition value="inv-ahpra-1" /&gt;</p>
<p>The resultant file I got is this --- <a href="/user_uploads/10155/UhxgtiZDM8dNemgNS37e1mUZ/au-practitioner-forge-default.xml" target="_blank" title="au-practitioner-forge-default.xml">au-practitioner-forge-default.xml</a> </p>
<p>In this file you can see that the Forge tool added &lt;source/&gt; tags and removed some of the xml code! <br>
Just wanted to know is it the correct behaviour from the tool?</p>
<p><strong>An outcome of the Forge tool adding the &lt;source/&gt; element is that the constraint key and the constraint human value "goes missing" from the Differential and Snapshot Tables in the profile generated by IGPublisher!</strong></p>



<a name="176552604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176552604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176552604">(Sep 25 2019 at 10:47)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="192203">@Vikas Mittal</span>, Forge re-generates the <code>StructureDefinition.differential</code> component by excluding all inherited constraints, as specified by the base profile and element type profiles (if any). A decrease in size of the differential component indicates that Forge removed some redundant constraints.<br>
The <code>ElementDefinition.constraint.source</code> field was introduced in FHIR R4. Forge R4 automatically generates this field value in the snapshot component, as specified by the spec:<br>
<a href="http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.constraint.source" target="_blank" title="http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.constraint.source">http://hl7.org/fhir/elementdefinition-definitions.html#ElementDefinition.constraint.source</a></p>



<a name="176552674"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176552674" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176552674">(Sep 25 2019 at 10:48)</a>:</h4>
<p>I don't know why the IG Publisher stumbles on this field. Maybe you discovered a bug in the rendering code?</p>



<a name="176554279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176554279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176554279">(Sep 25 2019 at 11:16)</a>:</h4>
<p>the java snapshot generator was missing ElementDefinition.condition. I fixed that today</p>



<a name="176556391"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176556391" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176556391">(Sep 25 2019 at 11:50)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191336">@Michel Rutten</span> and <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
I will test it with the latest IG Publisher and get back to you in case it's required further.</p>



<a name="176894081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/176894081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#176894081">(Sep 30 2019 at 00:14)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
 I have tested it with FHIR IG Publisher (Version 0.9.82-SNAPSHOT - Built 2019-09-24T07:48:38.927+10:00 - Git 7c7c6916f395) <br>
It has now fixed the rendering issue for the (I) Flag,in both the Snapshot Table and the Detailed Descriptions tabs.<br>
The other rendering issue still remains where, constraint key and the constraint human value goes missing from the Differential and Snapshot Tables in the profile.</p>



<a name="178440412"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/178440412" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#178440412">(Oct 18 2019 at 03:27)</a>:</h4>
<p><span class="user-mention" data-user-id="192203">@Vikas Mittal</span>  is this still a problem? If so, how do I reproduce it?</p>



<a name="178443391"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/178443391" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#178443391">(Oct 18 2019 at 04:51)</a>:</h4>
<p>Yes <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> it is still an issue. </p>
<p>To reproduce you can either <br>
.<br>
clone  <a href="https://github.com/hl7au/au-fhir-base.git" target="_blank" title="https://github.com/hl7au/au-fhir-base.git">https://github.com/hl7au/au-fhir-base.git</a> repository and open this file (<a href="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml" target="_blank" title="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml">https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml</a>) in the Forge R4 tool. Then add a condition (&lt;condition value="inv-hpii-0" /&gt;) and save it. The file generated by the Forge tool now adds this (&lt;source value="Practitioner" /&gt;). If you run the IG Publisher on HL7AU and the resulting page of au-practitioner will have missing constraint keys and constraint human values. <br>
.<br>
OR<br>
.<br>
you can just replace the au-practitioner.xml file in the <a href="https://github.com/hl7au/au-fhir-base.git" target="_blank" title="https://github.com/hl7au/au-fhir-base.git">https://github.com/hl7au/au-fhir-base.git</a> cloned repository with this file (<a href="/user_uploads/10155/4pZGOFkccgiXsBV6jiBXvRnn/au-practitioner.xml" target="_blank" title="au-practitioner.xml">au-practitioner.xml</a>) and then run the IG Publisher setup . </p>
<p>Please let me know if you want me to create and send you the setup as a branch of some repository.</p>



<a name="179010463"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179010463" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179010463">(Oct 25 2019 at 00:07)</a>:</h4>
<p>the file you provided is identical?</p>



<a name="179014229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179014229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179014229">(Oct 25 2019 at 01:15)</a>:</h4>
<p>Yes <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
I took this file (<a href="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml" target="_blank" title="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml">https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml</a>) and edited it using the Forge tool. <br>
The resultant file (<a href="user_uploads/10155/4pZGOFkccgiXsBV6jiBXvRnn/au-practitioner.xml" target="_blank" title="user_uploads/10155/4pZGOFkccgiXsBV6jiBXvRnn/au-practitioner.xml">https://chat.fhir.org/user_uploads/10155/4pZGOFkccgiXsBV6jiBXvRnn/au-practitioner.xml</a>) that the Forge tool generated, is the file that I have provided in my previous comment. <br>
And that is the file that the IG Publisher is having rendering issues with. <br>
.<br>
While the current file on the github (<a href="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml" target="_blank" title="https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml">https://github.com/hl7au/au-fhir-base/blob/master/resources/au-practitioner.xml</a>) does not have those rendering issues.</p>



<a name="179022534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179022534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179022534">(Oct 25 2019 at 05:11)</a>:</h4>
<p>So the problem is that the invariants are not rendered like this:</p>



<a name="179022576"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179022576" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179022576">(Oct 25 2019 at 05:12)</a>:</h4>
<p><a href="/user_uploads/10155/Zt1NtbxiCqAUjA_A-iDYlSv6/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/Zt1NtbxiCqAUjA_A-iDYlSv6/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/Zt1NtbxiCqAUjA_A-iDYlSv6/pasted_image.png"></a></div>



<a name="179022589"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179022589" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179022589">(Oct 25 2019 at 05:13)</a>:</h4>
<p>That results from a decision by the IG creation stream to not render constraints that come from inherited models. So to get your constraints to render, remove the "source" statement on them</p>



<a name="179024626"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179024626" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vikas Mittal <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179024626">(Oct 25 2019 at 06:10)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
<span class="user-mention" data-user-id="191336">@Michel Rutten</span> do you think it is okay for the Forge to add the &lt;source/&gt; tags when I am "editing an existing profile" and not "deriving and creating a new profile"?</p>



<a name="179031725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179031725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179031725">(Oct 25 2019 at 08:39)</a>:</h4>
<p>Forge R4 contains some basic logic to ensure that <code>.constraint.source</code> fields are initialized. The description of the field mentions rendering, but remains a bit vague. I was waiting for some feedback/guidance from the community about this aspect.<br>
<span class="user-mention" data-user-id="191316">@Grahame Grieve</span> I guess that rendering logic could also determine if a constraint is introduced or inherited by inspecting the source; if source points to the containing resource, then the constraint is introduced, not inherited? (similar to <code>ElementDefinition.base.path</code>)</p>



<a name="179088149"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/179088149" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#179088149">(Oct 25 2019 at 20:52)</a>:</h4>
<p>well, that's the intent. What we're doing is leaving it blank when it's defined in this structure definition, and populating it otherwise. but I see that we're not populating it correctly - it should be the canonical URL of the source</p>



<a name="182503968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/182503968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dusica Bojicic <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#182503968">(Dec 03 2019 at 22:30)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span>, is Forge R4 change to stop initializing <code>ElementDefinition.constraint.source</code> in plan?</p>



<a name="183494352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183494352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Russell Buchanan <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183494352">(Dec 15 2019 at 16:20)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span>, we have been testing use of Forge R4 as part of the Canadian Baseline Profiling effort.  As noted by Vikas above, Forge adds <code>.constraint.source</code> whenever we edit and save a profile that introduces constraints.  This causes the constraints to fail to render in the IG Publisher output.  Is there a plan to change this?</p>



<a name="183567458"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183567458" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183567458">(Dec 16 2019 at 16:48)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="192379">@Dusica Bojicic</span> and <span class="user-mention" data-user-id="193891">@Russell Buchanan</span>, thanks for mentioning that! It seems it is valid FHIR to fill that field, but the Publisher doesn't accept it?<br>
<span class="user-mention" data-user-id="191316">@Grahame Grieve</span> would this then be something to fix in the IG Publisher instead?</p>



<a name="183583155"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183583155" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183583155">(Dec 16 2019 at 19:42)</a>:</h4>
<p>I think that Forge is populating it wrongly. the renderer does not publish the constraint if the source indicates it comes from some inherited model (the profiles are littered with inherited constraints). So if the source is empty, or doesn't match the current canonical, then it doesn't get rendered. From memory, forge isn't putting a canonical in there?</p>



<a name="183589447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183589447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dusica Bojicic <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183589447">(Dec 16 2019 at 20:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, Forge does not put the canonical, I think it populates the field with the resource name. IG Publisher does not render constraints either when the source is populated with the current canonical (unless that changed in the last 10 days or so).</p>



<a name="183590189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183590189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183590189">(Dec 16 2019 at 21:02)</a>:</h4>
<p>you're right. I thought I had fixed that. Next release will allow source = self</p>



<a name="183623257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183623257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183623257">(Dec 17 2019 at 06:59)</a>:</h4>
<p>It doesn't work in v 1.0.24 of the igPublisher.</p>



<a name="183632618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183632618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183632618">(Dec 17 2019 at 09:44)</a>:</h4>
<p>OK thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="192379">@Dusica Bojicic</span>. Based on the above I understand Forge is behaving correctly. Please correct me if I'm wrong!</p>



<a name="183632670"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183632670" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183632670">(Dec 17 2019 at 09:45)</a>:</h4>
<p>no. it needs to populate the source with the canonical URL, not the name</p>



<a name="183633694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183633694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183633694">(Dec 17 2019 at 10:00)</a>:</h4>
<p><span class="user-mention" data-user-id="203235">@Ward Weistra</span> <span class="user-mention" data-user-id="191334">@Marten Smits</span> found the same issue independently. Bug report can be found here: <a href="https://github.com/FirelyTeam/fhir-net-api/issues/1188" target="_blank" title="https://github.com/FirelyTeam/fhir-net-api/issues/1188">https://github.com/FirelyTeam/fhir-net-api/issues/1188</a></p>



<a name="183634129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/add%20a%20condition%20on%20an%20element%20for%20a%20defined%20constraint/near/183634129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/add.20a.20condition.20on.20an.20element.20for.20a.20defined.20constraint.html#183634129">(Dec 17 2019 at 10:06)</a>:</h4>
<p>Ah wonderful, and it's already planned for the upcoming API sprint. Once it's included there we'll add it to Forge!<br>
Right now we're planning a January release of Forge, but the API release might not be out yet by then. So probably the next release after that. cc <span class="user-mention" data-user-id="192379">@Dusica Bojicic</span> <span class="user-mention" data-user-id="193891">@Russell Buchanan</span> Sorry for the inconvenience until then.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
