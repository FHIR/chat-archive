---
layout: page
title: "FHIR Chat  · Reference to a &quot;Search&quot; result · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html">Reference to a &quot;Search&quot; result</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153927525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927525">(Jan 03 2018 at 15:51)</a>:</h4>
<p>I recently came across a FHIR server where the <code>Reference.reference</code> values were populated with search strings like <code>Patient?identifier=123</code>. I'm pretty sure this isn't allowed, but there was some confusion. The developer also pointed out the <a href="https://www.hl7.org/fhir/http.html#2.21.0.17.2" target="_blank" title="https://www.hl7.org/fhir/http.html#2.21.0.17.2">following note from http.html</a>:</p>
<blockquote>
<p>in a transaction (and only in a transaction), references to resources may be replaced by a search URI that describes how to find the correct reference:<br>
...             &lt;reference value="Patient?identifier=12345"/&gt;</p>
</blockquote>
<p>Now that we have <code>Reference.identifier</code>, couldn't this special-case rule go away?</p>



<a name="153927530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927530">(Jan 03 2018 at 16:21)</a>:</h4>
<p>Reference.identifier doesn't support the same capabilities for auto-resolution.</p>



<a name="153927537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927537">(Jan 03 2018 at 17:01)</a>:</h4>
<p>why would we forbid search in a Reference.reference? It would be unsual, but I could see how i might be useful when the target is on another system.</p>



<a name="153927540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927540">(Jan 03 2018 at 18:46)</a>:</h4>
<p>We say that a reference "resolves," which I took to mean "Resolves to a resource" -- which is different from "Resolves to a Bundle that may contains resources."</p>



<a name="153927541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927541">(Jan 03 2018 at 18:46)</a>:</h4>
<p>Can you say more about the capabilities that <code>Reference.identifier</code> is missing for the use case above?</p>



<a name="153927542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927542">(Jan 03 2018 at 19:01)</a>:</h4>
<p>If it resolves to a bundle of more than one, that would be an error.  If it resolves to 0, not sure if that's an error or not.</p>



<a name="153927543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927543">(Jan 03 2018 at 19:01)</a>:</h4>
<p>Ah, good point. I kind of thought of that after I hit enter.</p>



<a name="153927544"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927544" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927544">(Jan 03 2018 at 19:02)</a>:</h4>
<p>Reference.identifier works to hold the identifier, but not the location</p>



<a name="153927545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927545">(Jan 03 2018 at 19:02)</a>:</h4>
<p>in your example, they should just do it right... Is there a good reason for us to accept that example?</p>



<a name="153927547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927547">(Jan 03 2018 at 19:21)</a>:</h4>
<p>"Do it right"?  If they don't know what the resource id is going to be, but the expect the query to resolve, what other mechanism can they use?</p>



<a name="153927553"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927553" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927553">(Jan 03 2018 at 19:56)</a>:</h4>
<p>so Lloyd, you are okay with the example Josh found? It seems it is not proper... right? You have indicated yourself that it is an error</p>



<a name="153927554"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927554" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927554">(Jan 03 2018 at 19:57)</a>:</h4>
<p>seems to me if they don't yet know the URL, then they should use Reference.Identifier...right?</p>



<a name="153927555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927555">(Jan 03 2018 at 20:37)</a>:</h4>
<p>I didn't indicate it was an error.  I indicated that it could be an error depending on how it resolves.  It's a feature we've defined in the spec and I don't see a good way to make it go away.  Using Reference.identifier wouldn't accomplish the same thing.</p>



<a name="153927556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927556">(Jan 03 2018 at 20:38)</a>:</h4>
<p>(because there's no expectation on servers to resolve Reference.identifier)</p>



<a name="153927557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl M. Davis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927557">(Jan 03 2018 at 20:40)</a>:</h4>
<p>I'll chime in here as the owner of the server that Josh "recently came across" that was doing this.</p>
<p>Background:</p>
<ul>
<li>This was a holdover from back when we were using HAPI's JPA storage layer, and HAD to submit our bundles to it that way -- we didn't know the logical IDs yet, so we couldn't reference them.</li>
<li>When we switched to our own storage layer, our mapping code didn't get changed to account for the fact that our mapping now happens at query time, when we DO know the logical IDs.</li>
</ul>
<p>My thoughts:</p>
<ul>
<li>I don't think that the spec (<a href="https://www.hl7.org/fhir/references.html" target="_blank" title="https://www.hl7.org/fhir/references.html">https://www.hl7.org/fhir/references.html</a>) is super clear about what relative URL Reference.reference values SHOULD be. All it (sort of) states is that those relative references should be resolvable.</li>
<li>I can't think of any scenarios where a relative reference returned by a server _couldn't_ be a logical ID. Can anyone else?</li>
<li>If not, I'd suggest that the spec be modified to include something like, "Relative Reference.reference values SHOULD be the logical ID, e.g. <code>Patient/abc123</code>, of a resource on the same server, which SHOULD be resolvable (barring authorization issues)." Sound reasonable?</li>
</ul>



<a name="153927595"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927595" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927595">(Jan 04 2018 at 09:47)</a>:</h4>
<p>you are allowed to include anything in the reference that resolves to a single resource. It's not really expected to be a general query - we only specifically document the query use for transactional behaviour, and in those cases, a server is required to resolve them or blow up. I suppose there's some ambiguity then, if you mean for them to be a query and not to be resolved in the transaction. </p>
<p>but out general guidance is simply: it must resolve to a single resource. It <em>may</em> be specified on a FHIR RESTful interface (and veyr often is) but this is not required</p>



<a name="153927637"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927637" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927637">(Jan 04 2018 at 18:17)</a>:</h4>
<p>And when you say "Resolves to a single resource," <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> do you mean that <code>GET $url</code> returns a resource? How about a Bundle containing a resource? How about a PDF file containing a text box containing a serialized resource? (The latter, I would expect, is  _not_ what you mean, but I'd like to be explicit about what "resolve" means, because finding a Bundle when I expect a Patient would be pretty surprising.)</p>



<a name="153927638"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927638" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927638">(Jan 04 2018 at 18:18)</a>:</h4>
<p>Also <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> I still don't get what this special case for transactions is all about. If there's a _special case_, why couldn't we use <code>Reference.identifier</code> to address the special case? Why overload <code>Reference.value</code>?</p>



<a name="153927641"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927641" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927641">(Jan 04 2018 at 18:46)</a>:</h4>
<p>Because you're not always going to search by identifier.  You're going to search by some set of criteria that you expect will resolve to a single resource.</p>



<a name="153927643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927643">(Jan 04 2018 at 19:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191450">@Simone Heckmann</span> can explain more about the use-cases</p>



<a name="153927677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927677">(Jan 04 2018 at 20:52)</a>:</h4>
<p>identifier doesn't have the obligation to resolve.</p>



<a name="153927678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927678">(Jan 04 2018 at 20:53)</a>:</h4>
<p>a bundle containing a resource is a reference to a bundle, not a reference to the resource in the bundle. So that might be legal if you meant to refer to the bundle. but not if you meant to refer to the resource inside the bundle</p>



<a name="153927702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927702">(Jan 04 2018 at 21:57)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  -- and you're saying that populating (say) Observation.subject.reference with <code>Patient?identifier=123</code> (which returns a bundle) is not okay in a "normal" Patient resource, but <em>is</em> okay in a Patient resource that appears in a transaction bundle?</p>



<a name="153927705"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927705" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927705">(Jan 04 2018 at 22:03)</a>:</h4>
<p>yes</p>



<a name="153927731"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927731" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927731">(Jan 05 2018 at 07:42)</a>:</h4>
<p>Conditional reference is the Client saying to the server "please resolve this for me". With logicel reference it's up to the server to decide whether to resolve or not.<br>
It is also important to note that an unresolvable conditional reference will cause the transaction to fail, whereas an unresolvable logical reference would probably just reamin untouched. A typical use case for conditional references is pretty much every HL7 V2 message that reports something about a Patient. When you map this to FHIR you will have Observations, ChargeItems, Procedures etc. that need to be linked with a Patient of which you only know the logical Identifier.</p>



<a name="153927750"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927750" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927750">(Jan 05 2018 at 13:53)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191450">@Simone Heckmann</span>!</p>



<a name="153927752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927752">(Jan 05 2018 at 14:47)</a>:</h4>
<p>That sounds like a fantastic capability. Is it required of all servers? Or do we need to identify a way a server declares support for this? I can see this being very helpful in PUSH style communication, and MHD specifically. Would really save a roundtrip at times.</p>



<a name="153927784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Spencer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927784">(Jan 05 2018 at 17:31)</a>:</h4>
<p>I believe it's required if transactions are supported (personally I think the transaction functionality is a bit monolithic and it'd be easier for implementers if they could specify which parts are supported)</p>



<a name="153927838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Reference%20to%20a%20%22Search%22%20result/near/153927838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Reference.20to.20a.20.22Search.22.20result.html#153927838">(Jan 06 2018 at 01:18)</a>:</h4>
<p>we always only introduce complexity like this if people ask. you're the first</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
