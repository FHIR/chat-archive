---
layout: page
title: "FHIR Chat  · Search reference by id with multiple targets · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20reference.20by.20id.20with.20multiple.20targets.html">Search reference by id with multiple targets</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153913107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20reference%20by%20id%20with%20multiple%20targets/near/153913107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20reference.20by.20id.20with.20multiple.20targets.html#153913107">(Oct 09 2017 at 12:27)</a>:</h4>
<p>I seek clarification to this part of the spec (<a href="http://www.hl7.org/implement/standards/fhir/search.html#reference" target="_blank" title="http://www.hl7.org/implement/standards/fhir/search.html#reference">http://www.hl7.org/implement/standards/fhir/search.html#reference</a>):</p>
<blockquote>
<p>Some references are allowed to point to more than one type of resource; e.g. subject : Reference(Patient|Group|Device|..). In these cases, multiple resources may have the same logical identifier. Servers SHOULD reject a search where the logical id refers to more than one matching resource across different types." </p>
</blockquote>
<p>The search parameter general-practitioner on Patient is such a parameter, it may reference Organization and Practitioner.</p>
<p>Let's assume a FHIR Server with the following data, and a few searches on it.</p>
<ul>
<li>Practitioner/1</li>
<li>Practitioner/2, with no patient linking to it</li>
<li>Organization/1, with no patient linking to it.</li>
<li>Organization/2, with name="SomeCorp"</li>
<li>Patient/pat1, with general-practitioner=Practitioner/1</li>
<li>Patient/pat2, with general-practitioner=Organization/2</li>
</ul>
<p>Search nr1: /Patient?general-practitioner=1<br>
If I read the text, I assume this is valid, since the logical id '1' happens to refer to only 1 resource, being Practitioner/1.</p>
<p>Search nr2: /Patient?general-practitioner=2<br>
I assume this should be rejected, since the logical id '2' refers to both Practitioner/2 and Organization/2. Even though Practioner/2 is never linked to.</p>
<p>Search nr3: /Patient?general-practitioner.name=SomeCorp<br>
This does not involve a logical id, but is - within the above data - equivalent to Search nr2. Is it valid?</p>
<p>Now I have a few problems:<br>
1. The first search is valid, the second is not, but I could not tell the difference beforehand<br>
2. The validity of search nr3 is not clear to me.<br>
3. This is - at least in our implementation of Vonk - not very efficient, since this issue could happen some levels deep inside a chained search, and we do not execute all the subqueries separately.</p>
<p>I would be in favour of a narrowing it further like this:<br>
"Some references are allowed to point to more than one type of resource; e.g. subject : Reference(Patient|Group|Device|..). In these cases, multiple resources may have the same logical identifier and thus Servers SHOULD reject a search if it does not specify the resourcetype (either in the url, or in the type modifier). If a client wished to search for more than one type, it can use the choice construct to do so."</p>



<a name="153913279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20reference%20by%20id%20with%20multiple%20targets/near/153913279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20reference.20by.20id.20with.20multiple.20targets.html#153913279">(Oct 10 2017 at 11:53)</a>:</h4>
<p>My 2 cents... nr2 should be legal. It is a search after all...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
