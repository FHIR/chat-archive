---
layout: page
title: "FHIR Chat  · synchronous in front of asynchronous · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html">synchronous in front of asynchronous</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153824114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824114">(May 02 2016 at 03:52)</a>:</h4>
<p>Suppose you have an architecture where the actual storage is asynchronous (e.g. via a queue) but you want to place a synchronous interface in front. The resource is validated by the synchronous end point and assigned an id before being placed on the queue for storage and returning success to the client. <br>
The obvious problem is that if the client re-reads the resource too quickly – before the async backend has saved the resource - then it won’t be present. <br>
This would certainly be confusing to the client, but is it an absolute prohibition? Ie that the server can only return success to the client after the resource has been persisted and is available for a subsequent read?</p>



<a name="153824115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824115">(May 02 2016 at 03:54)</a>:</h4>
<p>I've been contemplating this one quite a bit and come to a happy medium for my server (not implemented yet though)</p>



<a name="153824117"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824117" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824117">(May 02 2016 at 03:56)</a>:</h4>
<p>I'm going to persist the resource, and id and then indexes will update later.</p>



<a name="153824118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824118">(May 02 2016 at 03:57)</a>:</h4>
<p>Maybe 1 or 2 core indexes might update in real time, but most will be async.</p>



<a name="153824120"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824120" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824120">(May 02 2016 at 04:15)</a>:</h4>
<p>but, if a client were to retrieve the resource directly by the id, the resource would be returned - right?</p>



<a name="153824134"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824134" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824134">(May 02 2016 at 06:50)</a>:</h4>
<p>The same problem occurs in a threaded synchronous architecture too, where someone asks to read the resource before the response to an update has been processed</p>



<a name="153824135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824135">(May 02 2016 at 06:50)</a>:</h4>
<p>this is a classical problem in information systems; Martin Fowler has written books about it</p>



<a name="153824136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824136">(May 02 2016 at 07:06)</a>:</h4>
<p>Does RESTful FHIR  have a position on this? ie does returning 201 (created) mean that the resource is saved and ready for retrieval? The w3 spec states that a 201 response code means <strong>"The request has been fulfilled and resulted in a new resource being created"</strong>  and <strong>"The origin server MUST create the resource before returning the 201 status code. If the action cannot be carried out immediately, the server SHOULD respond with 202 (Accepted) response instead."</strong> - suggesting that when the persistent storage is queue based, either the response should wait until confirmation that the resource has been saved (and therefore ready for query), or immediately return a 202 which we don't currently mention...</p>



<a name="153824137"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824137" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824137">(May 02 2016 at 07:07)</a>:</h4>
<p>we don't support 202, right. Complexity... but w3c don't make rules about parallel requests </p>



<a name="153824138"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824138" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824138">(May 02 2016 at 07:14)</a>:</h4>
<p>No, but they do make rules about the behaviour of HTTP - is there a case for supporting 202? For that matter, does the fact that it is not explicitly mentioned in the spec mean that a queue based system shouldn't use 202 rather than 201? </p>



<a name="153824139"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824139" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824139">(May 02 2016 at 07:49)</a>:</h4>
<p>but that makes sense - how could you know in advance that you were guaranteed to accept something, without actually accepting it? </p>



<a name="153824140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824140">(May 02 2016 at 07:49)</a>:</h4>
<p>so a queue based system has to wait for the internal response before responding to the client, since we don't support 202</p>



<a name="153824141"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824141" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824141">(May 02 2016 at 07:49)</a>:</h4>
<p>202 is only good for dumb content</p>



<a name="153824871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824871">(May 06 2016 at 18:53)</a>:</h4>
<p>Why do you say that? 202 only means the request has been accepted (in this case, successfully added to the queue)  It doesn't imply that it will be successfully processed</p>



<a name="153824874"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824874" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824874">(May 06 2016 at 20:42)</a>:</h4>
<p>what happens if it fails? how does the client find out, and why? </p>



<a name="153824882"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824882" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824882">(May 06 2016 at 21:10)</a>:</h4>
<p>Generally the 202 response includes a link (Location header) to some kind of status resource (following HATEOAS)<br>
This is a handy summary of the approach <a href="http://farazdagi.com/blog/2014/rest-long-running-jobs/" target="_blank" title="http://farazdagi.com/blog/2014/rest-long-running-jobs/">http://farazdagi.com/blog/2014/rest-long-running-jobs/</a></p>



<a name="153824883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824883">(May 06 2016 at 21:12)</a>:</h4>
<p>as usual, HATEOS means badly thought out ad-hocness. </p>



<a name="153824884"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824884" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824884">(May 06 2016 at 21:13)</a>:</h4>
<p>It's possible we could add this, but it's a fair bit of machinery to make it interoperable</p>



<a name="153824885"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824885" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824885">(May 06 2016 at 21:23)</a>:</h4>
<p>Would you need more than a way to represent "in-progress" in an OperationOutcome?  Interop wouldn't need you to standardise the Location URL</p>



<a name="153824886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824886">(May 06 2016 at 21:25)</a>:</h4>
<p>Why does any of this need to be standardized? This sounds like an implementation detail for a specific scenario... </p>



<a name="153824887"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824887" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824887">(May 06 2016 at 21:25)</a>:</h4>
<p>success, failure, reason</p>



<a name="153824888"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824888" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824888">(May 06 2016 at 21:26)</a>:</h4>
<p>well, depends on whether you want it to be interoperable or not</p>



<a name="153824889"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824889" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824889">(May 06 2016 at 21:27)</a>:</h4>
<p>you certainly wouldn't expect any client to understand that a 202 + a location tells you the location a task, not the outcome. And you'd need to inject the location of the outcome into the task response somehow as well. So you could do this, but it would be non-conformant as things stand</p>



<a name="153824890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824890">(May 06 2016 at 21:30)</a>:</h4>
<p>I guess this is like those two phase accept ACKs you could do in HL7v2 (whose name I'm drawing a blank on right now). I always heard that there were people who actually used this, but I have never witnessed it.</p>
<p>Do people actually expect an interoperable solution to this problem? Do other APIs of any kind have one? I just fret a bit that we're layering a lot of infrastructure on top of FHIR these days.</p>



<a name="153824892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824892">(May 06 2016 at 21:36)</a>:</h4>
<p>yes, you'd need to standardise this approach to a 202, but I don't see it as a lot:<br>
202 + task Location which, when resolved, then gives you either:<br>
  a) OperationOutcome indicating that its still in progress<br>
  b) OperationOutcome indicating the failure (or success)<br>
  c) redirect to the success Resource<br>
 d) 404 when the task has been garbage collected</p>



<a name="153824898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824898">(May 06 2016 at 23:29)</a>:</h4>
<p>And how many of those with this need can't do messaging?  (Messaging is designed for asynchronous - REST really isn't.)</p>



<a name="153824920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824920">(May 07 2016 at 05:41)</a>:</h4>
<p>My understanding of Messaging is that the server needs to send the response nack (to MessageHeader.source.endpoint], but in this use-case there is no endpoint to send responses to</p>



<a name="153824949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/synchronous%20in%20front%20of%20asynchronous/near/153824949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/synchronous.20in.20front.20of.20asynchronous.html#153824949">(May 07 2016 at 11:36)</a>:</h4>
<p>Message delivery can be done by putting things in a "mailbox" and having the client poll for new content.  We haven't defined an explicit mechanism for this with FHIR yet, but we had it with v3.  And it might be more appealing than adding complexity to REST.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
