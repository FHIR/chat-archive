---
layout: page
title: "FHIR Chat  · FHIR Cache packages.ini · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html">FHIR Cache packages.ini</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="271624108"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271624108" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271624108">(Feb 11 2022 at 19:17)</a>:</h4>
<p>Hi all, is the <code>packages.ini</code> file used in <code>.fhir/packages</code> documented anywhere?  I want to make sure I am using it correctly when downloading packages.  Thanks! (tagging <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> for best-guess-at-who-knows-what-this-is =)</p>



<a name="271624574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271624574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271624574">(Feb 11 2022 at 19:21)</a>:</h4>
<p>not documented anywhere. I think I'm the only one that uses it. And it's purely decorative - it caches the package size (sum of all the files in bytes) and the date it was downloaded (or first seen, if something else installs it). </p>
<p>The only use of both these fields is if someone brings up my package cache browser, and then they have columns for package size and download date</p>



<a name="271625161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271625161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271625161">(Feb 11 2022 at 19:26)</a>:</h4>
<p>Hmm.. I assume it is preferable to use it for things like code-gen (instead of the separate cache it maintains today).  But, that means I need to be able to download and add to it.</p>
<p>I am trying to reconcile the tagging/structure I used for published/ci/local with what is present.  Overall, it is straightforward, but I was grabbing the <code>version.info</code> from CI builds to figure out if I need to re-download the build or not.  I assume I should switch over to <code>package.json:date</code> for the logic?</p>



<a name="271626086"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271626086" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271626086">(Feb 11 2022 at 19:34)</a>:</h4>
<p>well, here's my logic:</p>



<a name="271626102"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271626102" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271626102">(Feb 11 2022 at 19:34)</a>:</h4>
<div class="codehilite" data-code-language="Java"><pre><span></span><code><span class="kd">private</span> <span class="n">NpmPackage</span> <span class="nf">checkCurrency</span><span class="p">(</span><span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="n">NpmPackage</span> <span class="n">p</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
    <span class="n">checkBuildLoaded</span><span class="p">();</span>
    <span class="c1">// special case: current versions roll over, and we have to check their currency</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">ciList</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
      <span class="n">JsonObject</span> <span class="n">json</span> <span class="o">=</span> <span class="n">JsonTrackingParser</span><span class="p">.</span><span class="na">fetchJson</span><span class="p">(</span><span class="n">Utilities</span><span class="p">.</span><span class="na">pathURL</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">"package.manifest.json"</span><span class="p">));</span>
      <span class="n">String</span> <span class="n">currDate</span> <span class="o">=</span> <span class="n">JSONUtil</span><span class="p">.</span><span class="na">str</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="s">"date"</span><span class="p">);</span>
      <span class="n">String</span> <span class="n">packDate</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="na">date</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">currDate</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">packDate</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// nup, we need a new copy</span>
      <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>



<a name="271626321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271626321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271626321">(Feb 11 2022 at 19:36)</a>:</h4>
<p>in english: I use the date stated in the json at {url}/package.manifest.json where {url} is the source of the package, and I compare that to the date in the package manifest. And if all that fails somehow, then I don't check currency at all</p>



<a name="271626877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271626877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271626877">(Feb 11 2022 at 19:41)</a>:</h4>
<p>Sweet, thanks!  I assume I am correct in:</p>
<ul>
<li><code>#{number}</code> means published,</li>
<li><code>#current</code> means CI-Build, and</li>
<li><code>#dev</code> means local machine build?</li>
</ul>



<a name="271627251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271627251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271627251">(Feb 11 2022 at 19:44)</a>:</h4>
<p>yes. that is documented somewhere. dev falls back to current if there's no local build</p>



<a name="271627653"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIR%20Cache%20packages.ini/near/271627653" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIR.20Cache.20packages.2Eini.html#271627653">(Feb 11 2022 at 19:48)</a>:</h4>
<p>Good stuff. I'll update mine to match, thanks.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
