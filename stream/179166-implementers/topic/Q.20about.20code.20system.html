---
layout: page
title: "FHIR Chat  · Q about code system · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html">Q about code system</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="277158114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277158114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lital Inghel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277158114">(Mar 30 2022 at 14:59)</a>:</h4>
<p>why is there difference between  <a href="http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#immunization">http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#immunization</a> <br>
GET [base]/Immunization?patient=[patient]&amp;status=[status]<br>
and <a href="http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-immunization.html">http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-immunization.html</a><br>
GET [base]/Immunization?patient=[reference]&amp;status={system|}[code]</p>
<p>difference is in the code system:<br>
status={system|}[code] versus status=[status]<br>
why?</p>



<a name="277161921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277161921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277161921">(Mar 30 2022 at 15:25)</a>:</h4>
<p>Likely just typing convention/clarity/copy-paste/etc.</p>
<p>The <code>status</code> search parameter is defined as type <code>token</code>, so including the system is optional.  Given that <code>Immunization.status</code> has a required binding to the <a href="http://hl7.org/fhir/R4/valueset-immunization-status.html">ImmunizationStatusCodes</a> value set, and that the value set only includes codes from a single code system, it is generally not necessary.</p>



<a name="277163218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277163218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lital Inghel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277163218">(Mar 30 2022 at 15:35)</a>:</h4>
<p>this is really confusing and it is all over the IG.</p>
<p>so what about Encounter type token <br>
in <a href="http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#encounter">http://hl7.org/fhir/us/core/STU3.1.1/CapabilityStatement-us-core-server.html#encounter</a><br>
it says:<br>
GET [base]/Encounter?patient=[patient]&amp;type=[system]|[code]</p>
<p>versus<br>
GET [base]/Encounter?patient=[reference]&amp;type={system|}[code]<br>
in<br>
<a href="http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-encounter.html">http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-encounter.html</a></p>
<p>so which query is correct?<br>
type=[system]|[code] or {system|}[code]?</p>



<a name="277164263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277164263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277164263">(Mar 30 2022 at 15:44)</a>:</h4>
<p>They are all token search parameter, they all have the same structure, that is in the base FHIR specs - what is confusing?</p>



<a name="277164360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277164360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lital Inghel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277164360">(Mar 30 2022 at 15:45)</a>:</h4>
<p>what is the correct query:<br>
GET [base]/Encounter?patient=[patient]&amp;type=[system]|[code]  <br>
versus<br>
GET [base]/Encounter?patient=[reference]&amp;type={system|}[code]</p>



<a name="277164440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277164440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277164440">(Mar 30 2022 at 15:45)</a>:</h4>
<p>Technically, the <code>token</code> search parameter is defined (<a href="https://www.hl7.org/fhir/search.html#token">here</a>) so that both are allowed.  The difference is that if you do not include a system, the code could be a value from another system that has the same code.  For example, if you have patients with both <code>http://example.org/codesystem/what_I_want#code</code> and <code>http://example.org/codesystem/bad_system#code</code>, passing in just <code>code</code> will match either, but passing in the system allows you to distinguish between them.</p>
<p>In cases where there is only a single system possible (e.g., a required binding that only has codes from a single system), there is no difference other than syntax.</p>
<p>That said, if you are finding it hard to differentiate in US Core, I would suggest filing a ticket asking for consistency in the examples.</p>



<a name="277164470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277164470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lital Inghel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277164470">(Mar 30 2022 at 15:45)</a>:</h4>
<p>{} vs [] has different meaning</p>



<a name="277164707"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277164707" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277164707">(Mar 30 2022 at 15:47)</a>:</h4>
<p>The curly braces are just showing optionality.  Token always has it <em>defined</em> as optional, but in specific use cases it may be:</p>
<ul>
<li>not useful (e.g., required binding from one system)</li>
<li>optional (e.g., multiple systems, but no code overlaps)</li>
<li>required (e.g., known codes from multiple systems)</li>
</ul>



<a name="277165021"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277165021" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lital Inghel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277165021">(Mar 30 2022 at 15:50)</a>:</h4>
<p>the curly is what i expected to see in the capability statement page of the IG. instead it is [].</p>



<a name="277177577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277177577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lital Inghel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277177577">(Mar 30 2022 at 17:13)</a>:</h4>
<p>also if token means the parameter can be either <br>
code, <br>
code+system, <br>
system alone, <br>
why system is not in curly {} as well?</p>



<a name="277178842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277178842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277178842">(Mar 30 2022 at 17:22)</a>:</h4>
<p>(I assume you mean why is code not in curly braces)<br>
Limitation of syntax - it is difficult to convey that multiple things are optional but at least one segment is required.  The definition of the type has all the details (which is several paragraphs) and inline examples just do the best they can.  Showing every combination on every example is not feasible.</p>



<a name="277468916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277468916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277468916">(Apr 01 2022 at 19:43)</a>:</h4>
<p>This syntax in profile is correct. Those in CapabilityStatement are "examples"</p>
<p>US Core v4.0 remove those examples (because they are confusing) and add a further clarification about that syntax:</p>
<p>When searching using the token type searchparameter (how to search by token), the syntax {system|}[code] means that the system value is optional for the client to supply.:</p>
<ul>
<li>The client SHALL provide at least a code value and MAY provide both the system and code values.</li>
<li>The server SHALL support both.</li>
</ul>



<a name="277469354"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277469354" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277469354">(Apr 01 2022 at 19:48)</a>:</h4>
<p>I am not sure if US core is trying to restrict to that, but that is not generally true for token searches.  All of the following are defined as valid:</p>
<ul>
<li><code>[parameter]=[code]</code> (just code)</li>
<li><code>[parameter]=[system]|[code]</code> (system and code)</li>
<li><code>[parameter]=|[code]</code> (code that explicitly has no system)</li>
<li><code>[parameter]=[system]|</code> (just system).</li>
</ul>
<p>I am not sure of a way to express that in a single line, and asking IGs to express every combination every time does not feel realistic.</p>



<a name="277469698"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Q%20about%20code%20system/near/277469698" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Q.20about.20code.20system.html#277469698">(Apr 01 2022 at 19:51)</a>:</h4>
<p>Yes All four formats are valid. US Core requires server to support token search using the first two formats (ie code and system|code). Server can implement token search with all four formats.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
