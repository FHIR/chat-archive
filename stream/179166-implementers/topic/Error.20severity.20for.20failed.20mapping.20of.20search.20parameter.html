---
layout: page
title: "FHIR Chat  · Error severity for failed mapping of search parameter · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html">Error severity for failed mapping of search parameter</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153968520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968520">(Jun 11 2018 at 20:23)</a>:</h4>
<p>When a client provides a search parameter that the server doesn't recognize, the server can return a fatal OperationOutcome or include a non-fatal one in the Bundle with results.  </p>
<p>In general, I believe a server should be as forgiving as possible in the face of unexpected client behavior.  In this case, returning some results could be misleading.  </p>
<p><strong>Example 1: Failed mapping of a single parameter</strong></p>
<p>The client wants a patient's progress notes.  </p>
<p><code>[base]/DocumentReference?patient=1316024&amp;type=http://loinc.org|11506-3</code></p>
<p>If the server can't map this LOINC code, does it return all DocumentReferences for that patient?  That's certainly not what the client wants.  </p>
<p><strong>Example 2: One OR parameter can be mapped, the other can't</strong></p>
<p>The client wants the patients progress notes and discharge documentation.</p>
<p><code>[base]/DocumentReference?patient=1316024&amp;type=http://loinc.org|11506-3,http://loinc.org|18842-5</code></p>
<p>The server can map 18842-5 but not 11506-3.  Does it return the discharge documentation?  The client gets some of the data it wants, and it can tell from the OperationOutcome that the mapping for progress notes failed.  But . . . what if the client doesn't check for the OperationOutcome?</p>



<a name="153968521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968521">(Jun 11 2018 at 20:25)</a>:</h4>
<p>If the server returns a fatal OperationOutcome in the latter case, the client needs to do a second search to get just the discharge documentation if that's an acceptable compromise.</p>



<a name="153968525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968525">(Jun 11 2018 at 20:27)</a>:</h4>
<p>1. How likely is it that a client will take note of a non-fatal OperationOutcome and take appropriate action?  <br>
2. How dangerous is it if a client fails to do this?<br>
3. How useful are the results if a server ignores the mapping failure and returns results as if the client hadn't passed that parameter in the first place?<br>
4. How inconvenient is it for a client to make a new request if the server doesn't return the compromise results?</p>



<a name="153968541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968541">(Jun 11 2018 at 20:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191936">@Michael Donnelly</span> The query response is required to include a "self" link that includes the portions of the query that it actually executed.  So if it only searched on one of the LOINC codes, that's all that should be in the self link.  Clients are expected to check the self link.</p>



<a name="153968579"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968579" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968579">(Jun 11 2018 at 23:16)</a>:</h4>
<p>we can't really know 'how likely' something is; we encourage clients to do it, and as the safety impact increases, it becomes more likely</p>



<a name="153968580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968580">(Jun 11 2018 at 23:18)</a>:</h4>
<p>in this case, you're second guessing the client - trying to think what they really meant. Actually, what the client said is 'find me anything that has X'. your response is: I didn't find anything, with a note 'I'd never find anything because we don't accept X'. I don't think that should be an error unless you're really sure (somehow) that the client is <em>wrong</em> to ask for X and you won't accept it.</p>



<a name="153968703"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968703" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968703">(Jun 12 2018 at 13:53)</a>:</h4>
<p>Ah, I wasn't clear enough.  If a client asks for X (example 1 above), and we don't know what X is, the question is whether we should return <strong>nothing</strong> or if we should return <strong>everything</strong>.  If we pretended we didn't even <em>receive</em> parameter X, then we'd return results that aren't filtered on that parameter.</p>



<a name="153968704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968704">(Jun 12 2018 at 13:53)</a>:</h4>
<p>To be clear, I'm not suggesting that's a good idea.</p>



<a name="153968706"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968706" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968706">(Jun 12 2018 at 13:53)</a>:</h4>
<p>I was trying to present the two options without including my bias.</p>



<a name="153968708"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968708" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968708">(Jun 12 2018 at 13:56)</a>:</h4>
<p>See <a href="http://build.fhir.org/security.html#AccessDenied" target="_blank" title="http://build.fhir.org/security.html#AccessDenied">http://build.fhir.org/security.html#AccessDenied</a></p>



<a name="153968709"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968709" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968709">(Jun 12 2018 at 13:59)</a>:</h4>
<p>With fully authorized clients, a very rich and expressive response can be given...</p>



<a name="153968712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Donnelly <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968712">(Jun 12 2018 at 14:06)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> was this meant for another thread?</p>



<a name="153968723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968723">(Jun 12 2018 at 14:50)</a>:</h4>
<p>nope, it was intended for you to see that we have already indicated that returning various kinds of responses exist</p>



<a name="153968726"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968726" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968726">(Jun 12 2018 at 15:57)</a>:</h4>
<p>So, it seems "return nothing" is the desired behaviour.  But extending this to how we deal with <em>unknown</em> search parameters, we don't say "I'd never find anything because I don't accept X", we say "Didn't know about search parameter X, so I disregard X".  Isn't that inconsistent?</p>



<a name="153968730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968730">(Jun 12 2018 at 16:06)</a>:</h4>
<p>isn't the guidance on 'unknown' query parameters is to ignore that parameter? Thus returning results based only on the query parameters you know. This behaviour is common, it tends to simply return more results than one would expect, as parameters tend to reduce the results, not add to them (exceptions in FHIR are things like _include)... but I think what is being asked is if there could be a way to return some warning (lesser than a warning actually) that indicates whichquery parameters were ignored, so that the clent can undestand the results might not be as expected</p>



<a name="153968782"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968782" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968782">(Jun 12 2018 at 22:48)</a>:</h4>
<p>so we have a way to do this.</p>



<a name="153968783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968783">(Jun 12 2018 at 22:50)</a>:</h4>
<p><span class="user-mention" data-user-id="191936">@Michael Donnelly</span> thanks for the clearer statement. I think it is more safe to return too much than to return unexpectedly little. Further, given that we already say that you ignore parameters you don't know, and that you confirm back to the client what parameters you did process, I think it would be most expected and safe to ignore parameters you don't support (and possibly return a note to that effect).</p>



<a name="153968784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Error%20severity%20for%20failed%20mapping%20of%20search%20parameter/near/153968784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Error.20severity.20for.20failed.20mapping.20of.20search.20parameter.html#153968784">(Jun 12 2018 at 22:50)</a>:</h4>
<p>It would be good when this subject arises at connectathons to point out to search users that they can and do get search messages back, and they should display them somewhere if they do - they can be very useful to users</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
