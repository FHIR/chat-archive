---
layout: page
title: "FHIR Chat  · hapi fhir + docker + MySQL · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi.20fhir.20.2B.20docker.20.2B.20MySQL.html">hapi fhir + docker + MySQL</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="232117929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi%20fhir%20%2B%20docker%20%2B%20MySQL/near/232117929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Traven <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi.20fhir.20.2B.20docker.20.2B.20MySQL.html#232117929">(Mar 27 2021 at 20:59)</a>:</h4>
<p>Hi everyone</p>
<p>We are trying to set up a HAPI FHIR Server with docker  and  connected to a MySQL Docker and are getting the error <br>
"com.myslql.cj.jdbc.exception.CommunicationException: Communicationlink failure"  <br>
<a href="user_uploads/10155/O2CflqJYWsF6Cy1mH27JmHJj/error.log">error.log</a><br>
Anyone an idea? </p>
<p>Further infos if needed: </p>
<p>---&gt; What is working<br>
-&gt; Start HAPI FHIR without config file  (docker run -p 8080:8080 -e hapi.fhir.default_encoding=xml hapiproject/hapi)<br>
-&gt; Start HAPI FHIR with default config file (<a href="https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/application.yaml">https://github.com/hapifhir/hapi-fhir-jpaserver-starter/blob/master/src/main/resources/application.yaml</a>) <br>
-&gt; Check if mysql database is created <a href="user_uploads/10155/0q4KW2nFNcVxUhzo73BQg2UA/console-output-mysql.txt">console-output-mysql.txt</a></p>
<p>---&gt; What  is NOT working <br>
-&gt; Start HAPI FHIR with following changes in config file <br>
     url: 'jdbc:mysql://localhost:3306/hapi_dstu3' (the database has already been created)<br>
     driverClassName: com.mysql.cj.jdbc.Driver<br>
starting with comand: docker run -p 8080:8080 --name happy2 -v /home/ubuntu/HAPI_FHIR:/configs -e "--spring.config.location=file:///configs/application.yaml" hapiproject/hapi:latest</p>



<a name="232134914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi%20fhir%20%2B%20docker%20%2B%20MySQL/near/232134914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi.20fhir.20.2B.20docker.20.2B.20MySQL.html#232134914">(Mar 28 2021 at 02:30)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="232141147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi%20fhir%20%2B%20docker%20%2B%20MySQL/near/232141147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aditya Kurkure <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi.20fhir.20.2B.20docker.20.2B.20MySQL.html#232141147">(Mar 28 2021 at 04:35)</a>:</h4>
<p><span class="user-mention" data-user-id="394748">@Traven</span> <br>
<code>url: 'jdbc:mysql://localhost:3306/hapi_dstu3'</code> </p>
<p>the localhost here would mean that the SQL server is located in the same container as HAPI FHIR sever. If you are using the same docker compose file for running both MYSQL and HAPI then you'll need to change the <code>localhost</code> to your mysql container name. Otherwise if the mysql container's port is mapped to a port on the host machine you'll need to use the hosts IP address instead of <code>localhost</code></p>



<a name="232146700"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi%20fhir%20%2B%20docker%20%2B%20MySQL/near/232146700" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi.20fhir.20.2B.20docker.20.2B.20MySQL.html#232146700">(Mar 28 2021 at 06:33)</a>:</h4>
<p>This isn't really an error. By design the docker uses H2 defaulting to a file-based database (the in-mem variant is also listed in the config file), which works fine inside docker. It gets you quicly up and running. If you need real persistence like eg. MySQL, then you need to change the defaults, and yes, then you need to point to an adress outside the docker container hosting the hapi-fhir-jpaserver-starter. This is entirely as intended an also very much in line with scoping services in Docker. The configurations listed at <a href="https://github.com/hapifhir/hapi-fhir-jpaserver-starter#mysql-configuration">https://github.com/hapifhir/hapi-fhir-jpaserver-starter#mysql-configuration</a> does not take into account that you are running it in Docker which is a choice of your own.</p>



<a name="232182210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi%20fhir%20%2B%20docker%20%2B%20MySQL/near/232182210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Stanley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi.20fhir.20.2B.20docker.20.2B.20MySQL.html#232182210">(Mar 28 2021 at 17:56)</a>:</h4>
<p>Also note that you can now provide env vars to HAPI to change the config without editing it directly.</p>



<a name="232473339"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi%20fhir%20%2B%20docker%20%2B%20MySQL/near/232473339" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Traven <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi.20fhir.20.2B.20docker.20.2B.20MySQL.html#232473339">(Mar 30 2021 at 18:24)</a>:</h4>
<p>Thanks alot -&gt; this was indeed our problem and after getting the right ip of the mysql docker it all worked. Big shout-out to <span class="user-mention" data-user-id="396904">@Aditya Kurkure</span>  , <span class="user-mention" data-user-id="191427">@Jens Villadsen</span>  and the rest of this  super helpful community!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
