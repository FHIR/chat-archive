---
layout: page
title: "FHIR Chat  · _has parameter proposal · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html">_has parameter proposal</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153826141"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826141" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826141">(May 09 2016 at 20:23)</a>:</h4>
<p>Hi All,</p>
<p>Today in the FHIR-I meeting in Montreal, we discussed a proposal to allow a new search parameter <code>_has</code> which could be used to fulfill searches for resources that are linked to by other resources, without returning the resources that link to them. This could be used, for example:</p>
<ul>
<li>Return a bundle of patients that have a given condition</li>
<li>Return a bundle of observations with a given provenance</li>
<li>etc..</li>
</ul>
<p>The proposal is <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9864" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=9864">here</a>. We have deciced to hold a virtual mini-connectathon, where I will be implementing this on the HAPI public server. We are now soliciting potential testing partners (or even descriptions of scenarios where this would be useful) in order to gauge whether this is worth pursuing or not.</p>



<a name="153826142"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826142" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826142">(May 09 2016 at 20:26)</a>:</h4>
<p>I'm going to implement as well</p>



<a name="153826146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826146">(May 09 2016 at 20:31)</a>:</h4>
<p>As mentioned, I think this is very helpful in making the Provenance resource usable in the context of mapping V2 snapshot style messages to  FHIR. I will give it a try to reimplement the Atlanta V2 Mapping scenario leveraging Provenance &amp; _has and see how that works out. (Specifically: Delete all AllergyIntolerance resources of a Patient submitted by a specific Agent before adding new AllergyIntolerances). So the DELETE Condition will have a _has criteria to fetch all AllergyIntolerances that have a Provenance with Agent X. Does that make sense?</p>



<a name="153826159"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826159" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Bernhardt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826159">(May 09 2016 at 20:58)</a>:</h4>
<p>This syntax is peculiar. _has isn't a query parameter in the gForge examples.</p>



<a name="153826160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826160">(May 09 2016 at 20:59)</a>:</h4>
<p>got any better suggestions?</p>



<a name="153826161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Bernhardt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826161">(May 09 2016 at 20:59)</a>:</h4>
<p>I suppose it could work if you had _has=&lt;url encode rest of it&gt;</p>



<a name="153826162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826162">(May 09 2016 at 21:01)</a>:</h4>
<p>So like the following? <code>Patient?_has=Observation:subject:status:final</code></p>



<a name="153826165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Bernhardt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826165">(May 09 2016 at 21:02)</a>:</h4>
<p>that's better, James</p>



<a name="153826167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Bernhardt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826167">(May 09 2016 at 21:02)</a>:</h4>
<p>or :final could be encoded as =final</p>



<a name="153826168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826168">(May 09 2016 at 21:03)</a>:</h4>
<p>It's less consistent with other things in FHIR, though. We use the pattern of <code>parameter:modifier=value</code> quite a bit in the REST interface.</p>



<a name="153826173"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826173" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Bernhardt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826173">(May 09 2016 at 21:33)</a>:</h4>
<p>ur right about that, James. But those modifiers are strictly defined. I guess my initial reaction was that this type of pattern is unbounded in terms of how _has could be modified. Maybe your mini-connectathon will uncover whether or not this is a valid concern.</p>



<a name="153826181"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826181" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826181">(May 09 2016 at 22:09)</a>:</h4>
<p>well, we use . too</p>



<a name="153826182"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826182" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826182">(May 09 2016 at 22:09)</a>:</h4>
<p>for chaining</p>



<a name="153826230"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826230" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826230">(May 09 2016 at 23:01)</a>:</h4>
<p>Yes, yes and yes. :)</p>



<a name="153826231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826231">(May 09 2016 at 23:03)</a>:</h4>
<p>The HAPI Server fully supports this. Grahame's currently doesn't replace the UUID in the Encounter for the actual reference to the matched patient. Neither does Spark.</p>



<a name="153826283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826283">(May 10 2016 at 12:30)</a>:</h4>
<p>FYI I have started a tracking page here: <a href="http://wiki.hl7.org/index.php?title=FHIR_Has_Parameter_Issue_Page" target="_blank" title="http://wiki.hl7.org/index.php?title=FHIR_Has_Parameter_Issue_Page">http://wiki.hl7.org/index.php?title=FHIR_Has_Parameter_Issue_Page</a></p>



<a name="153826285"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826285" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826285">(May 10 2016 at 12:40)</a>:</h4>
<p>I found the discussion difficult to contribute to mostly because the proposal is in terms of examples rather than a grammar modification, so it's not clear what is intended regarding multiple _has (if any) and the meaning of nested _has sub clauses</p>



<a name="153826288"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826288" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826288">(May 10 2016 at 12:45)</a>:</h4>
<p>I'm not saying this is some silver bullet approach ... I'm just listing how eg. Google does it: <a href="https://developers.google.com/ad-exchange/seller-rest/filters#combiningFilters" target="_blank" title="https://developers.google.com/ad-exchange/seller-rest/filters#combiningFilters">https://developers.google.com/ad-exchange/seller-rest/filters#combiningFilters</a></p>



<a name="153826321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826321">(May 10 2016 at 15:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191343">@Michael Lawley</span> I don't know that we've heard any use cases for either of those scenarios yet that might dictate the right behaviour. I have opinions on what would be most intuitive, but hopefully we'll come up with some real use cases to guide us there.</p>
<p><span class="user-mention" data-user-id="191427">@Jens Villadsen</span> Yeah, that is basically how the FHIR API does AND/OR relations too, which is nice. I'd addume we want to be consistent, but it's not 100% clear what would be most consistent for <code>_has</code></p>



<a name="153826323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826323">(May 10 2016 at 15:10)</a>:</h4>
<p>And to all- I've deployed an update to HAPI's server that implements has. Example: <a href="http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Observation:subject:status=final" target="_blank" title="http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Observation:subject:status=final">http://fhirtest.uhn.ca/baseDstu3/Patient?_has:Observation:subject:status=final</a></p>



<a name="153826382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826382">(May 10 2016 at 16:22)</a>:</h4>
<p>awesome. can you chain _has?</p>



<a name="153826383"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826383" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826383">(May 10 2016 at 16:23)</a>:</h4>
<p>Yup, that should work</p>



<a name="153826447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826447">(May 10 2016 at 19:06)</a>:</h4>
<p>Added my 2 cents to the discussion page....not sure what the etiquette is? I just appended my thoughts.</p>



<a name="153826642"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826642" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826642">(May 11 2016 at 00:19)</a>:</h4>
<p>Ok, so I created this:</p>
<div class="codehilite"><pre><span class="nt">&lt;Provenance</span> <span class="na">xmlns=</span><span class="s">&quot;http://hl7.org/fhir&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">value=</span><span class="s">&quot;68538&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;meta&gt;</span>
        <span class="nt">&lt;versionId</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;lastUpdated</span> <span class="na">value=</span><span class="s">&quot;2016-05-10T20:06:47.402-04:00&quot;</span><span class="nt">/&gt;</span> 
    <span class="nt">&lt;/meta&gt;</span>
    <span class="nt">&lt;target&gt;</span>
        <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">&quot;AllergyIntolerance/68539&quot;</span><span class="nt">/&gt;</span>  
    <span class="nt">&lt;/target&gt;</span>
    <span class="nt">&lt;target&gt;</span>
        <span class="nt">&lt;reference</span> <span class="na">value=</span><span class="s">&quot;AllergyIntolerance/68540&quot;</span><span class="nt">/&gt;</span> 
    <span class="nt">&lt;/target&gt;</span>
    <span class="nt">&lt;recorded</span> <span class="na">value=</span><span class="s">&quot;2016-05-10T20:07:27+01:00&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;agent&gt;</span>
        <span class="nt">&lt;role&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">&quot;http://hl7.org/fhir/provenance-participant-role&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;assembler&quot;</span><span class="nt">/&gt;</span>     
        <span class="nt">&lt;/role&gt;</span>
        <span class="nt">&lt;userId&gt;</span>
            <span class="nt">&lt;system</span> <span class="na">value=</span><span class="s">&quot;http://health-comm.de/Cloverleaf&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;value</span> <span class="na">value=</span><span class="s">&quot;12345&quot;</span><span class="nt">/&gt;</span>    
        <span class="nt">&lt;/userId&gt;</span>  
    <span class="nt">&lt;/agent&gt;</span>
<span class="nt">&lt;/Provenance&gt;</span>
</pre></div>


<p>Now I want a list of all AllergyIntolerances with a Provenance.userID=12345<br>
That would be .../AllergyIntolerance?_has=Provenance:userID=12345 ???</p>



<a name="153826643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826643">(May 11 2016 at 00:21)</a>:</h4>
<p>I posted both Provenance and the AllergyIntolerances on HAPI, so we can test right away. The query abve returns an error...</p>



<a name="153826644"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826644" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826644">(May 11 2016 at 00:22)</a>:</h4>
<p>I believe it should be <a href="http://fhirtest.uhn.ca/baseDstu2/AllergyIntolerance?_has=Provenance:target:userID=12345" target="_blank" title="http://fhirtest.uhn.ca/baseDstu2/AllergyIntolerance?_has=Provenance:target:userID=12345">http://fhirtest.uhn.ca/baseDstu2/AllergyIntolerance?_has=Provenance:target:userID=12345</a></p>
<p>But that is crashing for me... Let me check why.</p>



<a name="153826645"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826645" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826645">(May 11 2016 at 00:23)</a>:</h4>
<p>oh wait..</p>



<a name="153826646"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826646" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826646">(May 11 2016 at 00:23)</a>:</h4>
<p>it's Provenance.agent.userId I guess...</p>



<a name="153826647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826647">(May 11 2016 at 00:24)</a>:</h4>
<p>nope, neither...</p>



<a name="153826648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826648">(May 11 2016 at 00:26)</a>:</h4>
<p>Thinking purely about syntax/naming here, what do people think of something like:</p>
<div class="codehilite"><pre> /AllergyIntolerance?_referencedFrom=Provenance:target where agent.userId=123
</pre></div>


<p>instead of</p>
<div class="codehilite"><pre> /AllergyIntolerance?_has=Provenance:target:agent.userId=123
</pre></div>


<p>I'm trying (maybe still failing) to drive at something more... readable as a sentence.</p>



<a name="153826659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826659">(May 11 2016 at 00:44)</a>:</h4>
<p>Ah <span class="user-mention" data-user-id="191450">@Simone Heckmann</span> , you had a <code>=</code> where a <code>:</code> should be</p>
<p>Try: <a href="http://fhirtest.uhn.ca/baseDstu2/AllergyIntolerance?_has:Provenance:target:userid=12345" target="_blank" title="http://fhirtest.uhn.ca/baseDstu2/AllergyIntolerance?_has:Provenance:target:userid=12345">http://fhirtest.uhn.ca/baseDstu2/AllergyIntolerance?_has:Provenance:target:userid=12345</a></p>



<a name="153826660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826660">(May 11 2016 at 00:46)</a>:</h4>
<p>oh! yes, sorry, I was looking at the wrong exmple above...</p>



<a name="153826661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826661">(May 11 2016 at 00:56)</a>:</h4>
<p>ok, this is working as a plain GET but not as a conditional DELETE.<br>
For the DELETE I get</p>
<div class="codehilite"><pre><span class="nt">&lt;OperationOutcome</span> <span class="na">xmlns=</span><span class="s">&quot;http://hl7.org/fhir&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;text&gt;</span>
      <span class="nt">&lt;status</span> <span class="na">value=</span><span class="s">&quot;generated&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;h1&gt;</span>Operation Outcome<span class="nt">&lt;/h1&gt;</span>
         <span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
               <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">&quot;font-weight: bold;&quot;</span><span class="nt">&gt;</span>error<span class="nt">&lt;/td&gt;</span>
               <span class="nt">&lt;td&gt;</span>[]<span class="nt">&lt;/td&gt;</span>
               <span class="nt">&lt;td&gt;</span>
                  <span class="nt">&lt;pre&gt;</span>Invalid match URL[AllergyIntolerance?_has:Provenance:target:userid=http://health-comm.de/Cloverleaf|12345] - URL has no search parameters<span class="nt">&lt;/pre&gt;</span>
               <span class="nt">&lt;/td&gt;</span> 
            <span class="nt">&lt;/tr&gt;</span> 
         <span class="nt">&lt;/table&gt;</span> 
      <span class="nt">&lt;/div&gt;</span>
   <span class="nt">&lt;/text&gt;</span>
   <span class="nt">&lt;issue&gt;</span>
      <span class="nt">&lt;severity</span> <span class="na">value=</span><span class="s">&quot;error&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">&quot;processing&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;diagnostics</span> <span class="na">value=</span><span class="s">&quot;Invalid match URL[AllergyIntolerance?_has:Provenance:target:userid=http://health-comm.de/Cloverleaf|12345] - URL has no search parameters&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/issue&gt;</span>
<span class="nt">&lt;/OperationOutcome&gt;</span>
</pre></div>



<a name="153826718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826718">(May 11 2016 at 08:00)</a>:</h4>
<p>What <span class="user-mention" data-user-id="191315">@Josh Mandel</span> suggests more resembles SQL/HQL-ish syntax</p>



<a name="153826719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826719">(May 11 2016 at 08:03)</a>:</h4>
<p>Its just an observation</p>



<a name="153826742"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826742" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826742">(May 11 2016 at 10:35)</a>:</h4>
<p>what Josh suggests belongs on the _filter syntax. I was intending to look at how to do this in _filter once we converged on a syntax for the parameter, but don't mind if we do them in parallel. </p>



<a name="153826743"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826743" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826743">(May 11 2016 at 10:36)</a>:</h4>
<p>my 2 cents on this is that we should retain a syntax very like the chaining syntax we have, and that the problem with Chris's syntax is that the logical sequence of joins isn't what it says - at least for me </p>



<a name="153826759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826759">(May 11 2016 at 10:57)</a>:</h4>
<p>I agree with your point <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  that the current syntax seems...  hard to fellow in a logical way (though it is well defined). I tried addressing this problem in my suggestion; do you have something concrete to propose? </p>



<a name="153826760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826760">(May 11 2016 at 11:02)</a>:</h4>
<p>How about:</p>
<div class="codehilite"><pre>/AllergyIntolerance?~target.Provenance.userId=123
</pre></div>



<a name="153826761"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826761" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826761">(May 11 2016 at 11:02)</a>:</h4>
<p>it removes the double = , and assembles the things in a logical order. ~ stands for reverse change and . stands for forwards chain</p>



<a name="153826771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826771">(May 11 2016 at 11:29)</a>:</h4>
<p>Purely as a syntax I think this improves on the <code>_has</code>, but I don't like the fact that it removes all semblance of knowing a well-defined set of valid query parameter names for FHIR search requests. </p>



<a name="153826773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826773">(May 11 2016 at 11:33)</a>:</h4>
<p>It just seems like no matter how we mash them around, forward and reverse chaining together are begging for some more grammar support (as in <code>_filter</code>).</p>



<a name="153826776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826776">(May 11 2016 at 12:05)</a>:</h4>
<p>I was thinking about extending _include with a means to not include the original endpoint type. For example by a modifier like <code>:strict</code>(meaning: include exactly this in the response, and nothing else). So something like</p>
<div class="codehilite"><pre>/Provenance?userId=123&amp;_include:strict=Provenance:target:Patient
</pre></div>


<p>It would eliminate the need for a new parameter and syntax altogether. <br>
Downsides are that it feels a bit inconsistent to query a /Provenance endpoint and get back (only) Patient resources, and you cannot have the equivalent of multiple _has clauses.</p>



<a name="153826778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826778">(May 11 2016 at 12:09)</a>:</h4>
<p>reverse chaining itself removes all semblance of knowing a set of valid search options. I prefer _filter, actually, but the fact remains: no other server maintainers have implemented it. :-(</p>



<a name="153826805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826805">(May 11 2016 at 13:04)</a>:</h4>
<p>I chose the current syntax because it reads how you'd speak - Patient?_has:Encounter:patient:type=SURG reads "a Patient that has Encounters with type SURG" (the reverse reference thrown in I guess).  </p>
<p>When we discussed this in-house, my devs thought it important that the resource name being sub-queried be prominent.</p>



<a name="153826861"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826861" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826861">(May 11 2016 at 14:17)</a>:</h4>
<p>I have to admit- the proposed syntax is difficult and kind of hard to look at, but I would say I like it more than anything else that's been proposed so far. At least it's relatively consistent with the rest of the API.</p>
<p>I do wonder about <code>_has</code> itself though. It makes sense in the context of answering the question <code>find patients who have a condition</code> but it doesn't really describe the actual operation. Josh's proposal to call it <code>_referencedFrom</code> might be an improvement from that perspective. I.e. <code>_referenedFrom:Observation:target:code=123</code></p>



<a name="153826865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826865">(May 11 2016 at 14:20)</a>:</h4>
<p>+1 for <code>_referencedFrom</code></p>



<a name="153826918"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826918" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826918">(May 11 2016 at 16:03)</a>:</h4>
<p>Encounter:patient - it's the :patient that appears out of sequence</p>



<a name="153826923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826923">(May 11 2016 at 16:05)</a>:</h4>
<p>see this: _referenedFrom:Observation:target:code=123</p>



<a name="153826924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826924">(May 11 2016 at 16:06)</a>:</h4>
<p>why not Observation.code - like it usually would be?</p>



<a name="153826931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826931">(May 11 2016 at 16:13)</a>:</h4>
<p>Well, you know why not <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  — because you need to specify <code>target</code> somewhere :p My verbose take was the only way I could find around this.</p>



<a name="153826935"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153826935" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153826935">(May 11 2016 at 16:16)</a>:</h4>
<p>I'm not in love with any format I've seen yet. I'll think about what I think would be best for use in _filter</p>



<a name="153827000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827000">(May 11 2016 at 19:01)</a>:</h4>
<p>+1 on having this functionality somehow.  They'd be immensely helpful in population health applications.</p>
<p>Here's another potential syntax to throw in the ring -- just to keep our minds thinking:</p>
<div class="codehilite"><pre>/Patient?_referencedBy=Observation:subject:O&amp;O.status=final&amp;O.code=http://foo.org/sys|123
</pre></div>


<p>In this case, the <code>_referencedBy</code> establishes an alias that is used in subsequent parameters.  It has a few advantages:</p>
<ul>
<li>It's less verbose when you're using multiple parameters</li>
<li>IMO, it makes it more clear that multiple parameters are intended to be ANDed on the target (e.g., in the example above, both status and code params must match on the _same_ observation)</li>
<li>Indicating the patient must have _any_ matching observation is simple: <code>/Patient?_referencedBy=Observation:subject</code></li>
<li>It allows for some more complex scenarios if we wished to specify them (see below)</li>
</ul>
<p>Regarding that last bullet, I'm not sure if we'd want to specify something like this, but the door is open:</p>
<div class="codehilite"><pre>/Patient?_referencedBy=Observation:subject:O1,Observation:subject:O2&amp;O1.status=final&amp;O1.code=http://foo.org/sys|123&amp;O2.status=final&amp;O2.category=http://hl7.org/fhir/observation-category|therapy
</pre></div>


<p>This reads as "patients referenced by an observation (O1) that is final and has code '123' _or_ referenced by an observation (O2) that is final and has category 'therapy'.  That may be more complex than we want to support, but the syntax allows it and it is consistent with existing syntax.</p>
<p>Anyway... again... just throwing out something to keep us thinking outside the box.</p>



<a name="153827004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827004">(May 11 2016 at 19:04)</a>:</h4>
<p>BTW-- in the above examples, the alias is a letter 'O' (for Observation), not the numeral 0.  The alias doesn't have to be 'O' -- it can be anything the user chooses.  And in the last (complex) example, if you wanted to say that the Patient must have _both_ Observations, you would just have two <code>_referencedBy</code> params instead of the one with the commas (indicating 'or').</p>



<a name="153827035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827035">(May 11 2016 at 19:44)</a>:</h4>
<p>I firmly do not like a single parameter with mutiple =. which one gets escaped?</p>



<a name="153827038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827038">(May 11 2016 at 19:45)</a>:</h4>
<p>+1 to that</p>



<a name="153827044"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827044" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827044">(May 11 2016 at 19:56)</a>:</h4>
<p>I agree that a single param with multiple = is a bad idea.  My example above doesn't have that -- does it?  In my first example, there are three params (_referencedBy, O.status, and O.code).</p>



<a name="153827045"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827045" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827045">(May 11 2016 at 19:58)</a>:</h4>
<p>If you don't like it, that's fine -- but I just wanted to point out that there aren't extra <code>=</code> and there is no extra encoding burden.</p>



<a name="153827046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827046">(May 11 2016 at 19:59)</a>:</h4>
<p>carumba I read it more carefully. variables in the URL parameters? order dependent processing? Oh no please. Much better to just use _filter</p>



<a name="153827047"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827047" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827047">(May 11 2016 at 19:59)</a>:</h4>
<p>so, ironically, i liked it less...</p>



<a name="153827050"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827050" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827050">(May 11 2016 at 20:07)</a>:</h4>
<p>Ha.  OK.  Parameters don't have to be listed in order -- but the implementation would have to look at all _referencedBy params first to pick up the aliases in play.  As I said, just trying to think outside of the box, hoping one of us will stumble onto something good.</p>



<a name="153827051"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827051" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827051">(May 11 2016 at 20:07)</a>:</h4>
<p>get base/Patient?_filter=Observation[patient ref $].status = final<br>
get base/Patient?_filter=Observation[subject ref $ and code = <a href="http://foo.org/sys|123" target="_blank" title="http://foo.org/sys|123">http://foo.org/sys|123</a> and status = final]</p>



<a name="153827052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827052">(May 11 2016 at 20:07)</a>:</h4>
<p>it really looks much nicer in _filter</p>



<a name="153827053"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827053" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827053">(May 11 2016 at 20:08)</a>:</h4>
<p>we should say it's only available in the _filter as encouragement to get people to implement it </p>



<a name="153827054"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827054" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827054">(May 11 2016 at 20:09)</a>:</h4>
<p>one of these days i'm going to have a go at filter... i'm curious how hard it will actually be</p>



<a name="153827080"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827080" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827080">(May 11 2016 at 20:33)</a>:</h4>
<p>Perhaps I will try filter as well.  As I mentioned, it would be extremely helpful in population health applications -- and in particular, an application I'm involved with.</p>



<a name="153827081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827081">(May 11 2016 at 20:33)</a>:</h4>
<p>My company is interested in doing _filter queries, but we are having a challenge understanding how sub-queries are run across resource types. <br>
e.g. give me patients who have had no encounters between date X and date Y with the diagnosis.code of A or diagnosis.code of B.<br>
How can something like this be done?</p>



<a name="153827082"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827082" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827082">(May 11 2016 at 20:34)</a>:</h4>
<p>you were going to set up a data case for that? </p>



<a name="153827083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827083">(May 11 2016 at 20:34)</a>:</h4>
<p>so lets write this forwards:</p>



<a name="153827084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827084">(May 11 2016 at 20:38)</a>:</h4>
<p>What that question directed at me <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ? If so, I can do it. I tried a few example but was only getting errors. I assume my search string is way off.</p>



<a name="153827085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827085">(May 11 2016 at 20:39)</a>:</h4>
<p>get Encounter?patient=234 and not (period sa 2014-09-05 and period eb 2014-09-15) and hospitalization.admittingDiagnosis[code = A or code = B] pr true</p>



<a name="153827086"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827086" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827086">(May 11 2016 at 20:39)</a>:</h4>
<p>I think that's it </p>



<a name="153827092"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827092" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827092">(May 11 2016 at 20:42)</a>:</h4>
<p>OK, Thanks.  I will set it up and give it a try on your server (It will take a little time since I do not have an app to easily set up the resource instances).  But is there a _filter way to do that same thing? While I understand you are saying it can be done with a regular search, seeing it as an _filter would help us understand how we can frame more complex results using _filter.</p>



<a name="153827093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827093">(May 11 2016 at 20:43)</a>:</h4>
<p>sorry that was a typo. I meant to write:</p>



<a name="153827095"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827095" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827095">(May 11 2016 at 20:43)</a>:</h4>
<div class="codehilite"><pre>get Encounter?_filter=patient eq 234 and not (period sa 2014-09-05 and period eb 2014-09-15) and hospitalization.admittingDiagnosis[code = A or code = B] pr true
</pre></div>



<a name="153827096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827096">(May 11 2016 at 20:46)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> , I will give it a try.<br>
After looking at this closer, this query returns encounters. I am looking for a set of patients. Is there a way to do that in one _filter query?</p>



<a name="153827401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Spears <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827401">(May 12 2016 at 17:08)</a>:</h4>
<p>After looking at this closer  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> , this query returns encounters. I am looking for a set of patients. Is there a way to do that in one _filter query?</p>



<a name="153827439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153827439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153827439">(May 12 2016 at 18:19)</a>:</h4>
<p>right yes, in order for that, we have to resolve - and I have to implement - the parameter which is the core issue for this topic</p>



<a name="153828580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153828580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153828580">(May 19 2016 at 10:14)</a>:</h4>
<p>If we would not have _has (because we think _filter is the right place to dit it), it means we are missing out on support of some really common queries, unless servers commpnly implement _filter. And I still believe this is not going to be the case....  Implementing this on top of your existing (non FHIR) database, keeping it performant, maybe even allowing the client too much querying capabilities.... these are the reasons I can imagine many will not implement it.</p>



<a name="153828793"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153828793" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153828793">(May 19 2016 at 21:52)</a>:</h4>
<p>so to be clear about this: _filter only adds the capability to have a more capable grammar around grouping queries and relating conditionality. It doesn't add additional querying capabilities beyond that. </p>



<a name="153828794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153828794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153828794">(May 19 2016 at 21:53)</a>:</h4>
<p>pushing back against supporting it means that we keep adding ever more tricky stuff into the existing search. That's worse</p>



<a name="153828861"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153828861" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153828861">(May 20 2016 at 13:28)</a>:</h4>
<p>Agree - the question isn't _filter or not.  The question is whether this, as with all features, meets the 80% rule.  Do the majority of users need this capability when using the resources that would require it?  I would find it hard to use Provenance in any real sense without this...  Or AuditEvent</p>



<a name="153828862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153828862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Grenz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153828862">(May 20 2016 at 13:28)</a>:</h4>
<p>Or anything else where the reference is inbound (EpisodeOfCare as it stands today)</p>



<a name="153829004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153829004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153829004">(May 22 2016 at 02:20)</a>:</h4>
<p>so where are we with this? Here's my summary<br>
- no one thinks that this functionality shouldn't be added<br>
- none of us really like the syntax proposed, but no one's proposed something obviously better<br>
- in _filter, it looks nicer, but since hardly any servers implement _filter, that doesn't help much </p>



<a name="153831942"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831942" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831942">(Jun 08 2016 at 00:15)</a>:</h4>
<p><a href="https://motorcycleguy.blogspot.com.au/2016/06/selecting-population-cohorts-in-fhir.html" target="_blank" title="https://motorcycleguy.blogspot.com.au/2016/06/selecting-population-cohorts-in-fhir.html">https://motorcycleguy.blogspot.com.au/2016/06/selecting-population-cohorts-in-fhir.html</a></p>



<a name="153831943"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831943" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831943">(Jun 08 2016 at 00:15)</a>:</h4>
<p>perhaps this will help give us impetus to close this out</p>



<a name="153831945"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831945" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831945">(Jun 08 2016 at 00:36)</a>:</h4>
<p>wouldn't chained search parameters have been able to resolve this?<br>
(for this example case that was shown)<br>
(Which I now see Grahame already noted in the comments at the bottom... read to the end next time Brian)</p>



<a name="153831947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831947">(Jun 08 2016 at 01:13)</a>:</h4>
<p>The way I read chaining, its from the referenced item to  its search parameters.  GET Observation?patient.name=Keith would get me an observation for Keith.  But what I want is GET Patient?observation.code=foo where the tie from observation to patient is through Observation,patient = <a href="http://Patient.id" target="_blank" title="http://Patient.id">Patient.id</a>. It's become clear to me that the chaining syntax would note do what I want.  Chain goes from Reference search parameter to the referenced Resource's search parameters.</p>



<a name="153831948"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831948" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831948">(Jun 08 2016 at 01:18)</a>:</h4>
<p>Another challenge to address is Observation A=B OR Observation C=D, where I want all patients who have an observation A of B, or an Observation C of D.  I can punt with extension parameter for now, but I think _join might need to also allow aliases to be provided.  There's more to play with using AND, OR and NOT that I want to look at.</p>



<a name="153831953"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831953" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831953">(Jun 08 2016 at 01:30)</a>:</h4>
<p>Yes sorry, I thought you were after observations, not patients. So yes, not currently possible, and what the _has is hoping to assist resolve.</p>



<a name="153831955"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831955" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831955">(Jun 08 2016 at 01:32)</a>:</h4>
<p>Also, @Keith, you should look at _filter as well: <a href="http://hl7.org/fhir/search.html#filter" target="_blank" title="http://hl7.org/fhir/search.html#filter">http://hl7.org/fhir/search.html#filter</a>. The combination of _filter and reverse chaining would meet your requirements</p>



<a name="153831956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831956">(Jun 08 2016 at 02:25)</a>:</h4>
<p>Yeah, I looked at Filter.  I really don't care for it, for one reason because I don't see any built in support for it in HAPI, for another, because for my use cases, I can probably optimize the queries a little better myself if I work at it a bit.</p>



<a name="153831957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153831957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153831957">(Jun 08 2016 at 02:25)</a>:</h4>
<p>And finally, I just don't like the syntax ;-)</p>



<a name="153873017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153873017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Boone <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153873017">(Feb 22 2017 at 07:57)</a>:</h4>
<p>My proposal for _has syntax is: _has=Resource:search:criteria<br>
Resource is the name of the resource which you are joining with.<br>
Search is the search path on the resource to complete the join<br>
criteria is the search criteria (everything after the ?) on the joined resource.<br>
So,<br>
Patient?_has=Observation:subject:code=HBA1C <br>
means patients for whom there is an HBAC1 observation.<br>
Patient?_has=Observation:subject:code=HBA1C%26value=gt6<br>
means patients for whom there is an observation where code=HBA1C&amp;value=gt6<br>
Note the use of %26 to encode &amp; above in criteria for the joined query.<br>
And <br>
Patient?age=gt50&amp;gender=female&amp;_has:not=Procedure:subject:code:in=mammogram%26date=gt2015-02-22 <br>
means females over 50 where there does not exist a procedure resource where the subject is the patient, and the procedure code is for a mammogram and the date of the procedure is less than two years ago (as of the date of this post).</p>
<p>Does that address syntax concerns?</p>



<a name="153873272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_has%20parameter%20proposal/near/153873272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_has.20parameter.20proposal.html#153873272">(Feb 24 2017 at 19:00)</a>:</h4>
<p>this seems late... we've already written it up and provided examples (and balloted it)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
