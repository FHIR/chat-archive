---
layout: page
title: "FHIR Chat  · example for a profiled composition on section codes? · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html">example for a profiled composition on section codes?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153872966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153872966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153872966">(Feb 21 2017 at 17:08)</a>:</h4>
<p>has anyone an example for a profiled composition on sections (fixing the codes and order for the sections in which they are appearing in the composition) with the latest R3 StructureDefinition format? </p>
<p>I tried it with the following:</p>
<div class="codehilite"><pre>    &lt;element id=&quot;Composition&quot;&gt;
            &lt;path value=&quot;Composition&quot; /&gt;
            &lt;min value=&quot;1&quot; /&gt;
            &lt;max value=&quot;1&quot; /&gt;
        &lt;/element&gt;

        &lt;element id=&quot;Composition.section&quot;&gt;
            &lt;path value=&quot;Composition.section&quot; /&gt;
            &lt;slicing&gt;
                &lt;discriminator&gt;
                    &lt;type value=&quot;value&quot; /&gt;
                    &lt;path value=&quot;code.coding.code&quot; /&gt;
                &lt;/discriminator&gt;
                &lt;ordered value=&quot;true&quot; /&gt;
                &lt;rules value=&quot;closed&quot; /&gt;
            &lt;/slicing&gt;
            &lt;min value=&quot;2&quot; /&gt;
            &lt;max value=&quot;2&quot; /&gt; 
        &lt;/element&gt;

        &lt;!-- first slice --&gt;
        &lt;element id=&quot;Composition.section:sectionmed&quot;&gt;
            &lt;path value=&quot;Composition.section&quot; /&gt;
            &lt;sliceName value=&quot;sectionmed&quot; /&gt;
            &lt;min value=&quot;1&quot; /&gt;
            &lt;max value=&quot;1&quot; /&gt;
        &lt;/element&gt;
... snip ...
</pre></div>


<p>however the validator spits outs the message with two sections in a sample file: </p>
<div class="codehilite"><pre>  Error @ Composition.section[1] (line 35, col11) : Profile ..., Element matches more than one slice
  Error @ Composition.section[2] (line 57, col11) : Profile ..., Element matches more than one slice
  Error @ Composition (line 1, col42) : Profile ...., Element &#39;Composition.section[sectionmed]&#39; minimum required = 1, but only found 0
</pre></div>


<p>I think I did not setup the path value correctly, but I'm not 100% sure, the examples about slicing are not yet following the new syntax as far as I have found. any help greatly appreciated.</p>



<a name="153872973"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153872973" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153872973">(Feb 21 2017 at 17:50)</a>:</h4>
<p>There's currently a bug in how the validator handles slicing in a couple of areas.  I hope to get to it tomorrow.  (So the problem is likely mine, not yours.)</p>



<a name="153873031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153873031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153873031">(Feb 22 2017 at 12:06)</a>:</h4>
<p>We are doing this in DSTU2 using Forge to build the StructureDefinitions. Looking at you definition of your first slice what within it makes it a uniquie slice? Should you now have something that states the "code" of the section that resolves to that slice as that is what your discriminator is based on.</p>



<a name="153877676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153877676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153877676">(Mar 17 2017 at 10:48)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> . I just upgraded today to trunk and retried the validator, however I get still the same error message with my composition.(Element matches more than one slice). Could you already look into the slicing bug of the validator?</p>



<a name="153877891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153877891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153877891">(Mar 17 2017 at 21:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span> On my list for this weekend.  Has kept getting pushed back :(</p>



<a name="153877912"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153877912" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153877912">(Mar 17 2017 at 23:37)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span> Which example/profile? We have had this error a few times and managed to resolve it</p>



<a name="153878501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153878501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153878501">(Mar 20 2017 at 08:56)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> . Thanks for you message. I have problems with slicing/validating  a specific extensions as well as two sections in a Composition: </p>
<p>Example: <a href="https://github.com/ahdis/chmed16af/blob/master/resources/Composition/chmed16af-mp-composition-s01.xml" target="_blank" title="https://github.com/ahdis/chmed16af/blob/master/resources/Composition/chmed16af-mp-composition-s01.xml">https://github.com/ahdis/chmed16af/blob/master/resources/Composition/chmed16af-mp-composition-s01.xml</a><br>
Profile: <a href="https://github.com/ahdis/chmed16af/blob/master/resources/StructureDefinition/chmed16af-mp-composition.xml" target="_blank" title="https://github.com/ahdis/chmed16af/blob/master/resources/StructureDefinition/chmed16af-mp-composition.xml">https://github.com/ahdis/chmed16af/blob/master/resources/StructureDefinition/chmed16af-mp-composition.xml</a></p>
<div class="codehilite"><pre><span></span>  Error @ Composition.extension (line 8, col93) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-mp-composition, Element matches more than one slice
  Error @ Composition.section[1] (line 40, col11) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-mp-composition, Element matches more than one slice
  Error @ Composition.section[2] (line 62, col11) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-mp-composition, Element matches more than one slice
  Error @ Composition.section[3] (line 102, col11) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-mp-composition, Element matches more than one slice
  Error @ Composition (line 1, col42) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-mp-composition, Element &#39;Composition.section[sectionmed]&#39;: minimum required = 1, but only found 0
  Error @ Composition (line 1, col42) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-mp-composition, Element &#39;Composition.section[sectionnote]&#39;: minimum required = 1, but only found 0
</pre></div>


<p>I tried a simliar setup following the BP profile from <a href="http://build.fhir.org/bp.profile.xml.html" target="_blank" title="http://build.fhir.org/bp.profile.xml.html">http://build.fhir.org/bp.profile.xml.html</a> for time of gestation with two coded entries in components:</p>
<p>Example: <a href="https://github.com/ahdis/chmed16af/blob/master/resources/StructureDefinition/chmed16af-obs-timeofgestation.xml" target="_blank" title="https://github.com/ahdis/chmed16af/blob/master/resources/StructureDefinition/chmed16af-obs-timeofgestation.xml">https://github.com/ahdis/chmed16af/blob/master/resources/StructureDefinition/chmed16af-obs-timeofgestation.xml</a><br>
Profile: <a href="https://github.com/ahdis/chmed16af/blob/master/resources/Observation/chmed16af-observation-s01-timeofgestation.xml" target="_blank" title="https://github.com/ahdis/chmed16af/blob/master/resources/Observation/chmed16af-observation-s01-timeofgestation.xml">https://github.com/ahdis/chmed16af/blob/master/resources/Observation/chmed16af-observation-s01-timeofgestation.xml</a></p>
<p>But I get also similar errors:</p>
<div class="codehilite"><pre><span></span>  Error @ Observation.code.coding (line 15, col17) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-obs-timeofgestation, Element matches more than one slice
  Error @ Observation.component[1] (line 24, col16) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-obs-timeofgestation, Element matches more than one slice
  Error @ Observation.component[2] (line 39, col16) : Profile http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-obs-timeofgestation, Element matches more than one slice
</pre></div>


<p>So thats why I first thought its a problem with the validator after <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  message. But if you have any idea why my profiles are not working I would be glad to try alternate approaches.</p>



<a name="153878975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153878975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153878975">(Mar 22 2017 at 04:06)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span> Right now, the issue is with snapshot generation, not the validator.  It's an evil bit of code, so it's taking a while.</p>



<a name="153879461"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153879461" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153879461">(Mar 23 2017 at 08:35)</a>:</h4>
<p>trying to dig deeper into the validation problems:</p>
<ul>
<li>I used the sample observation-example-body-height(body-height).xml from the release, it validates correctly, however the sample references the <a href="http://hl7.org/fhir/StructureDefinition/vitalsigns" target="_blank" title="http://hl7.org/fhir/StructureDefinition/vitalsigns">http://hl7.org/fhir/StructureDefinition/vitalsigns</a></li>
<li>If i change the profile in the sample to <a href="http://hl7.org/fhir/StructureDefinition/bodyheight" target="_blank" title="http://hl7.org/fhir/StructureDefinition/bodyheight">http://hl7.org/fhir/StructureDefinition/bodyheight</a> the validator gives the error message: Profile <a href="http://hl7.org/fhir/StructureDefinition/bodyheight" target="_blank" title="http://hl7.org/fhir/StructureDefinition/bodyheight">http://hl7.org/fhir/StructureDefinition/bodyheight</a>, Element matches more than one slice (error message on the code.coding Element)</li>
<li>if i remove the differential elements from the <a href="http://hl7.org/fhir/StructureDefinition/bodyheight" target="_blank" title="http://hl7.org/fhir/StructureDefinition/bodyheight">http://hl7.org/fhir/StructureDefinition/bodyheight</a> profile (snapshot elements left), the error from the validator stays the same.</li>
</ul>
<p>This raises the questions for me, if the snapshot in the <a href="http://hl7.org/fhir/StructureDefinition/bodyheight" target="_blank" title="http://hl7.org/fhir/StructureDefinition/bodyheight">http://hl7.org/fhir/StructureDefinition/bodyheight</a> profile is not correct or the error message comes from the validator. <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> any idea how i can track down further the problem? </p>



<a name="153879484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153879484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153879484">(Mar 23 2017 at 10:24)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span> seems that in the <a href="http://hl7.org/fhir/StructureDefinition/bodyheight" target="_blank" title="http://hl7.org/fhir/StructureDefinition/bodyheight">http://hl7.org/fhir/StructureDefinition/bodyheight</a> profile, the differential introduces a slicing component on the element with id "Observation:vitalsignsprofile.code.coding" (xml line 2938), but that slicing component is missing from the snapshot...?</p>



<a name="153879516"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153879516" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153879516">(Mar 23 2017 at 15:02)</a>:</h4>
<p>Yes, that's the problem.  Snapshot generation is currently broken when slicing is involved.  There are at least two issues, possibly more.  Grahame is working on it.  We'll plan to release a patch for the main spec next week that fixes this and a few other things.</p>



<a name="153879520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153879520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153879520">(Mar 23 2017 at 15:08)</a>:</h4>
<p>Poor Grahame, snapshots and slicing hurts my brain... ;p</p>



<a name="153879525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153879525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153879525">(Mar 23 2017 at 15:13)</a>:</h4>
<p>As I said,  "evil code" . . .</p>



<a name="153879550"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/example%20for%20a%20profiled%20composition%20on%20section%20codes%3F/near/153879550" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/example.20for.20a.20profiled.20composition.20on.20section.20codes.3F.html#153879550">(Mar 23 2017 at 16:47)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> and <span class="user-mention" data-user-id="191336">@Michel Rutten</span> for your feedback and glad to hear that it is on the agenda, you have my support for testing ...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
