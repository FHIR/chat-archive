---
layout: page
title: "FHIR Chat  · Compartment search · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html">Compartment search</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153924735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153924735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153924735">(Dec 13 2017 at 13:37)</a>:</h4>
<p>CompartmentDefinition.code is restricted to Patient | Encounter | RelatedPerson | Practitioner | Device. Why is it not permitted to create a CompartmentDefinition for e.g. Location?</p>



<a name="153924737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153924737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153924737">(Dec 13 2017 at 13:41)</a>:</h4>
<p>And if the client does a request for /Organization within a Patient compartment, is the client authorized to get:<br>
- all Organizations (since the compartment is not linked to Organization, so it does not restrict it)<br>
- no Organizations (since the compartment is not linked to Organization, and you cannot query outside of it)?</p>
<p>Obviously access to Organization could be restricted in another way (e.g. Smart scopes), but I see this decision apart from that.</p>



<a name="153924756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153924756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153924756">(Dec 13 2017 at 15:57)</a>:</h4>
<p>Compartments tie deeply into how query can work, so we don't want implementers going off and defining their own compartments - and particularly defining them differently.  If there's a use-case for a Location compartment, submit a change request.  I do agree that we should clarify expectations around querying for a resource within a compartment when that resource isn't defined as being part of the compartment.  Personally, I think this should be an error.  I think that's safest for forward compatibility reasons.  In any case, definitely submit a change proposal for us to clarify expectations.</p>



<a name="153925170"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153925170" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153925170">(Dec 14 2017 at 12:19)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <br>
I think it is not so uncommon to go beyond the bounderies of a compartment, e.g. for an _include:</p>
<div class="codehilite"><pre><span></span>[base]/Patient?_include=general-practitioner
</pre></div>


<p>where Practitioner nor Organization is in the patient CompartmentDefinition.<br>
So I agree, I'll make a change proposal for clarification.</p>



<a name="153925175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153925175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153925175">(Dec 14 2017 at 12:31)</a>:</h4>
<p><a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14332&amp;start=75" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14332&amp;start=75">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14332&amp;start=75</a></p>



<a name="153954751"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153954751" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Angus Millar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153954751">(Apr 27 2018 at 09:53)</a>:</h4>
<p>Look out for _revinclude on Compartments. I had to cater for this search on Compartments  to ensure the user did not get all Observations for all the Organizations they can access:  {{ServiceRootUrl}}/Patient/FCC-PAT-00001/Observation?_revinclude=Observation:performer</p>



<a name="153955618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153955618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153955618">(May 03 2018 at 06:30)</a>:</h4>
<p>I don't see the problem: Observation:performer has no Observation type as target, so think this _revInclude will not do anything. Or am I missing the point?</p>



<a name="153955639"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153955639" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Angus Millar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153955639">(May 03 2018 at 10:20)</a>:</h4>
<p>Sorry <span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> i ballsed that query up, I mean this query:<br>
<code>[base]/Patient/[id]/Organization?_revinclude=DiagnosticReport:performer</code><br>
Don't want a patient who can access all Organization to then be able to reinclude all Observations</p>



<a name="153955640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153955640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Angus Millar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153955640">(May 03 2018 at 10:30)</a>:</h4>
<p>Actually, looking at this again, I can see it is not clear what it means to have a Resource listed as in the Compartment yet have no search parameters. Such as Organization in the Patient CompartmentDefinition opposed to a resource type that is not listed at all in the CompartmentDefinition? I had interpreted a Resource listed yet with no search parameters to infer that all instances are in the compartment, much like a general search query with no parameters and then a Resource not listed at all to mean no instances of that type are in the compartment.</p>



<a name="153955675"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Compartment%20search/near/153955675" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Compartment.20search.html#153955675">(May 03 2018 at 12:21)</a>:</h4>
<p>That is indeed not very clear, see <a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14332&amp;start=0" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14332&amp;start=0">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=14332&amp;start=0</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
