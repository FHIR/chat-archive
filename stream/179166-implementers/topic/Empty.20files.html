---
layout: page
title: "FHIR Chat  · Empty files · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html">Empty files</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="228266767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228266767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228266767">(Mar 01 2021 at 17:02)</a>:</h4>
<p>Is it ever valid to send an empty (0-byte) file in FHIR?  Is there a way to base-64 encode a zero-byte file that won't result in a zero-length string (which is prohibited according to FHIR's rules)?</p>



<a name="228267219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228267219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228267219">(Mar 01 2021 at 17:05)</a>:</h4>
<p>I assume every resource which has a 0 min cardinality on its properties has at least some finite size in every representation (XML, JSON, Turtle)</p>



<a name="228267335"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228267335" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228267335">(Mar 01 2021 at 17:06)</a>:</h4>
<p>Are you talking about some non-Resources?</p>



<a name="228267520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228267520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228267520">(Mar 01 2021 at 17:07)</a>:</h4>
<p>I was thinking maybe Lloyd means stuff like <code>Attachment.data</code>?</p>



<a name="228267562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228267562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228267562">(Mar 01 2021 at 17:07)</a>:</h4>
<p>makes sense</p>



<a name="228267682"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228267682" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228267682">(Mar 01 2021 at 17:08)</a>:</h4>
<p>why is a zero-length string prohibited?</p>



<a name="228267785"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228267785" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228267785">(Mar 01 2021 at 17:09)</a>:</h4>
<p>are you just supposed to elide the property rather than provide an empty value (or uses some other null form)?</p>



<a name="228267848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228267848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228267848">(Mar 01 2021 at 17:09)</a>:</h4>
<p>(sort of a meta model rule)</p>



<a name="228268093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228268093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228268093">(Mar 01 2021 at 17:10)</a>:</h4>
<p>Spec <a href="http://hl7.org/fhir/datatypes.html#primitive">says</a>:</p>
<blockquote>
<p>Leading and Trailing whitespace is allowed, but SHOULD be removed when using the XML format. Note: This means that a string that consists only of whitespace could be trimmed to nothing, which would be treated as an invalid element value. Therefore strings SHOULD always contain non-whitespace content</p>
</blockquote>



<a name="228268170"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228268170" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228268170">(Mar 01 2021 at 17:11)</a>:</h4>
<p>And the regex says:</p>
<blockquote>
<p>Regex: [ \r\n\t\S]+</p>
</blockquote>



<a name="228268443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228268443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228268443">(Mar 01 2021 at 17:12)</a>:</h4>
<p>which makes containing a 0-byte attachment illegal</p>



<a name="228268717"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228268717" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228268717">(Mar 01 2021 at 17:14)</a>:</h4>
<p>Well, it makes populating <code>data</code> illegal, but you could omit data and populate <code>Attachment.size</code> as `0 assuming you don't read the <a href="http://hl7.org/fhir/datatypes-definitions.html#Attachment.size">following comment</a> too pedantically:</p>
<blockquote>
<p>The number of bytes is redundant if the data is provided as a base64binary, but is useful if the data is provided as a url reference.</p>
</blockquote>



<a name="228268801"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228268801" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228268801">(Mar 01 2021 at 17:14)</a>:</h4>
<p>right, undermines the "is redundant" assertion</p>



<a name="228268903"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228268903" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228268903">(Mar 01 2021 at 17:15)</a>:</h4>
<p>This is a pretty annoying "special case", but... may be not a huge problem IRL.</p>



<a name="228268970"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228268970" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228268970">(Mar 01 2021 at 17:16)</a>:</h4>
<p>i'm trying to imagine a scenario where i'd want to say that something is "". haven't come up with it yet, but seems pretty reasonable</p>



<a name="228272470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228272470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228272470">(Mar 01 2021 at 17:36)</a>:</h4>
<p>We have use-cases in XDS for this... so it frustrates me that someone added that comment to attachment.size. Specifically we have use-cases where the bits have not yet been assembled. The DocumentReference is a promise to make the described document (metadtata found in the DocumentReference)... Deferred Creation... or On-Demand</p>



<a name="228274156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228274156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228274156">(Mar 01 2021 at 17:46)</a>:</h4>
<p>I raise the issue because I was applying a technical correction previously agreed to that allows for a completely empty Parameters instance.  It dawned on me that zero-byte files are a thing and was wondering whether we needed to make a similar exception for them.  Omitting the content and sending a zero-size seems reasonable to me.   Is that worth noting in the usage notes for the Attachment data type?</p>



<a name="228276421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228276421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228276421">(Mar 01 2021 at 17:58)</a>:</h4>
<p>I think so. What comes up next is what to do with the hash element. In the IHE case we leave hash be blank to explain that we are describing something that will eventually have a size and hash. But if you really have a zero length file,  then the hash value would be "da39a3ee5e6b4b0d3255bfef95601890afd80709".. not an unreasonable distinction between actually zero size,  and currently zero size.</p>



<a name="228281405"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228281405" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228281405">(Mar 01 2021 at 18:26)</a>:</h4>
<p>Can you explain more what IHE does <span class="user-mention" data-user-id="191404">@John Moehrke</span>?  Do you have Attachment.url and no <a href="http://Attachment.data">Attachment.data</a> or do you have neither?  If you just have a URL, I would omit size and hash if you're going to generate it on-the-fly.  Setting size to zero would <em>not</em> communicate that "we're going to generate this on the fly".  (If you want to say that, you'd need an extension.)</p>



<a name="228282799"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228282799" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228282799">(Mar 01 2021 at 18:34)</a>:</h4>
<p>IHE (MHD) always uses .url. and forbids .data. in the case I described above the .url is populated.    The use of size of zero has been used for decades.</p>



<a name="228283065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228283065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228283065">(Mar 01 2021 at 18:36)</a>:</h4>
<p>I don't disagree that some other signal should be provided. The use-case has really not been fully designed in MHD, as the community has not asked that it be used. However there is known use of zero as the signal.</p>



<a name="228316438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228316438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228316438">(Mar 01 2021 at 22:16)</a>:</h4>
<p>It might be a known use, but I'd object to encoding that use into the spec (or even crafting language to allow for it).  If the size says 0, the appropriate interpretation of that is "the file is an empty file", not "the file is going to be generated".</p>



<a name="228316756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228316756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228316756">(Mar 01 2021 at 22:19)</a>:</h4>
<p>understand. just pointing out reality.</p>



<a name="228316883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228316883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228316883">(Mar 01 2021 at 22:20)</a>:</h4>
<p>I would agree that if I saw size of zero, I should not try to pull the content.. but if I did pull it, that should not be seen as a error.</p>



<a name="228317123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228317123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228317123">(Mar 01 2021 at 22:21)</a>:</h4>
<p>we do want that the normal expectation is that if you pull content, and that there is a declared size and hash, that if size or hash are different; that should be seen as an integrity failure.. right?</p>



<a name="228317319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228317319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228317319">(Mar 01 2021 at 22:23)</a>:</h4>
<p>thus I would agree that the right interpretation of size of zero is that getting the URL content or undecoding the .data should result in a zero length file.</p>



<a name="228317390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228317390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228317390">(Mar 01 2021 at 22:23)</a>:</h4>
<p>If hash is populated, then the resulting file better hash to that value.</p>



<a name="228317499"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228317499" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228317499">(Mar 01 2021 at 22:24)</a>:</h4>
<p>thus, i would agree that unpopulated size (and/or hash) is the right way to say indeterminant.</p>



<a name="228317615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228317615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228317615">(Mar 01 2021 at 22:25)</a>:</h4>
<p>consumers choice if they decide to validate size or hash. they are not compelled to validate them (by core spec)</p>



<a name="228319176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Empty%20files/near/228319176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Empty.20files.html#228319176">(Mar 01 2021 at 22:36)</a>:</h4>
<p>Agree.  You're free to pull it.  When the content isn't zero, the default assumption would be that the content has changed since the reference was made.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
