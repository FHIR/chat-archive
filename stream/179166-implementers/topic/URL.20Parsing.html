---
layout: page
title: "FHIR Chat  · URL Parsing · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html">URL Parsing</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153934281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934281">(Jan 31 2018 at 17:38)</a>:</h4>
<p>I mentioned this in a FHIR-I meeting today and several folks expressed interest in this. So, posting this for whomever is interested. :-)</p>
<p>Here are the materials for the talk I saw from Orange Tsai at the DefCon security conference last July 2017. In his talk, Orange Tsai illustrated just how broken URL parsers are in <em>every</em> major language and library. One of the root problems is the complexity of the URL RFC(s!) and how the RFCs have ambiguity resulting in implementation differences/gaps.</p>
<p>Slides:<br>
<a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf" target="_blank" title="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf</a></p>
<p>Blog post where he talks about chaining several URL parsing vulnerabilities to smuggle a remote code exploit to root a <a href="http://Github.com" target="_blank" title="http://Github.com">Github.com</a> backend server:<br>
<a href="http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html" target="_blank" title="http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html">http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html</a></p>
<p>Video of Orange Tsai's talk (including video of his exploit):<br>
<a href="https://www.youtube.com/watch?v=D1S-G8rJrEk" target="_blank" title="https://www.youtube.com/watch?v=D1S-G8rJrEk">https://www.youtube.com/watch?v=D1S-G8rJrEk</a></p>
<div class="youtube-video message_inline_image"><a data-id="D1S-G8rJrEk" href="https://www.youtube.com/watch?v=D1S-G8rJrEk" target="_blank" title="https://www.youtube.com/watch?v=D1S-G8rJrEk"><img src="https://i.ytimg.com/vi/D1S-G8rJrEk/default.jpg"></a></div>



<a name="153934323"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934323" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934323">(Jan 31 2018 at 18:08)</a>:</h4>
<p>We have added specific security considerations to the FHIR spec before... (xml inclusion of script)... should this be similarly pointed to? If so, how would you describe it? I ask you for that description as you best represent our FHIR 'reader', so you might be best able to describe it... Security wg would clearly fix your wording if it isn't good.</p>



<a name="153934328"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934328" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934328">(Jan 31 2018 at 18:12)</a>:</h4>
<p>Very interesting, thank you for sharing this Kevin!</p>



<a name="153934332"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934332" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934332">(Jan 31 2018 at 18:23)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> - While we could post a note about this, I feel the same could be said with lots of other vulnerability categories. Are you thinking this one is an especially important/unique consideration to call out?</p>



<a name="153934333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934333">(Jan 31 2018 at 18:27)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> you should make a task to add a note about this where we talk about XML. <span class="user-mention" data-user-id="191355">@Kevin Shekleton</span> what else should we note?</p>



<a name="153934339"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934339" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934339">(Jan 31 2018 at 19:02)</a>:</h4>
<p>Presumably we should ensure that all of the reference servers address this</p>



<a name="153934365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934365">(Jan 31 2018 at 20:30)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> - The tricky part is that one of the messages of Orange Tsai's work is that the standard, widely used URL parsers are broken in subtle ways...largely due to the inherent complexities in the possibilities in URLs. So, references servers really would be hard pressed to do anything as either a) they are using these potentially vulnerable libraries and b) writing your own URL parser will have the same bugs all of the other libraries have. <span class="emoji emoji-1f61d" title="stuck out tongue">:stuck_out_tongue:</span></p>
<p>We are discussing in the FHIR-I/Sec mtg now about perhaps establishing a rubric or criteria for when a particular security topic or risk should be documented.</p>
<p>Personally, I think we should only address security risks that are directly actionable by implementers or have specific or unique implications to FHIR. I feel like this particular issue is broader. But, I haven't been thinking too deeply about this.</p>



<a name="153934369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934369">(Jan 31 2018 at 20:41)</a>:</h4>
<p>Is there a list of malcrafted url's that could help server builder to at least identify risks, and potentially try to mitigate?</p>



<a name="153934370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934370">(Jan 31 2018 at 20:42)</a>:</h4>
<p><a href="https://www.lookout.net/test/url/" target="_blank" title="https://www.lookout.net/test/url/">https://www.lookout.net/test/url/</a></p>



<a name="153934371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934371">(Jan 31 2018 at 20:44)</a>:</h4>
<p>Cool, thanks</p>



<a name="153934372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934372">(Jan 31 2018 at 20:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> please take note</p>



<a name="153934684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934684">(Feb 01 2018 at 17:15)</a>:</h4>
<p>I've been playing with turning the examples into unit tests.. but really, most of them are not flaws in URL parsing so much as URL processing - much more difficult to unit test</p>



<a name="153934704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/URL%20Parsing/near/153934704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/URL.20Parsing.html#153934704">(Feb 01 2018 at 17:37)</a>:</h4>
<p>Good point. It is a bit of both</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
