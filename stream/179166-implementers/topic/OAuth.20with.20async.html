---
layout: page
title: "FHIR Chat  · OAuth with async · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html">OAuth with async</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="169728898"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169728898" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169728898">(Jul 05 2019 at 18:52)</a>:</h4>
<p>I have a question about the interaction between Oauth and asynchronous requests.  If you have a request from system A to system B  that's being authorized by the Patient, what happens if the OAuth token expires before the asynchronous request is delivered?  Is that a problem or does the authorization token only matter for the initiation of the request, not the retrieval of the response? (FYI <span class="user-mention" data-user-id="192166">@Jean Duteau</span> <span class="user-mention" data-user-id="192609">@Mark Scrimshire</span> )</p>



<a name="169729060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169729060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169729060">(Jul 05 2019 at 18:54)</a>:</h4>
<p>Logically, I would have thought it only matters for the initiation...</p>



<a name="169729902"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169729902" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169729902">(Jul 05 2019 at 19:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> ?</p>



<a name="169730703"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169730703" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169730703">(Jul 05 2019 at 19:23)</a>:</h4>
<p>The user is only needed during the authorization process.  During that process, System B would request an access token from System A, which after approval would be used for communications on behalf of the user.  It is up to System A to determine expiration when granting the access token (and to manage any revocation requests from the user).  System A can also include a Refresh Token, so that access can continue without involving the user.</p>



<a name="169730770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169730770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169730770">(Jul 05 2019 at 19:24)</a>:</h4>
<p>That said, if the token between System A and System B expired and there was no refresh token, the user would need to re-authorize the application.</p>



<a name="169730958"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169730958" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169730958">(Jul 05 2019 at 19:28)</a>:</h4>
<p>Leaving the technical issues to one side for the moment though, doesn't it make more sense from the user's perspective that it success regardless? (in the absence of other failure reasons of course)? As the initiator, it would be irritating for me to have to start again just because it took a bit longer than expected to complete...</p>



<a name="169732228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169732228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169732228">(Jul 05 2019 at 19:54)</a>:</h4>
<p>The asynchronous response I'm looking at might involve human intervention, which can be quite unpredictable in terms of duration.  Would I be better off figuring out a different mechanism (i.e. not using async) if the authorization token should be time-limited, but the time to respond should be open-ended?</p>



<a name="169733066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169733066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mohammad Jafari <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169733066">(Jul 05 2019 at 20:09)</a>:</h4>
<p>I think the principle is that the Client must be, and continue to remain <em>authorized</em>, for the entire length of the transaction. In this case, the client can acquire a new token (e.g. using a refresh token) but if the token expires and the client cannot demonstrate that it is still authorized, it should not be able to continue the transaction. I think a similar case is when a client is authorized for a workflow which involves multiple steps. If the client's authorization expires at some point during the transaction and it fails to reauthorize itself, then it should not be considered authorized.</p>



<a name="169735430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169735430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169735430">(Jul 05 2019 at 20:55)</a>:</h4>
<p>I think it's a policy question, but I think that if a user revoked access, they might find continued access rather surprising</p>



<a name="169836407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169836407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169836407">(Jul 08 2019 at 02:37)</a>:</h4>
<p>I think the explanation here is straightforward and the solution elegant: <a href="https://nordicapis.com/how-to-handle-batch-processing-with-oauth-2-0/" target="_blank" title="https://nordicapis.com/how-to-handle-batch-processing-with-oauth-2-0/">https://nordicapis.com/how-to-handle-batch-processing-with-oauth-2-0/</a></p>



<a name="169864520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169864520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169864520">(Jul 08 2019 at 12:39)</a>:</h4>
<blockquote>
<p>I think the explanation here is straightforward and the solution elegant: <a href="https://nordicapis.com/how-to-handle-batch-processing-with-oauth-2-0/" target="_blank" title="https://nordicapis.com/how-to-handle-batch-processing-with-oauth-2-0/">https://nordicapis.com/how-to-handle-batch-processing-with-oauth-2-0/</a></p>
</blockquote>
<p>That article is exceptional. It shows a very mature and best-practice.  I would highly recommend this.</p>



<a name="169864556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169864556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169864556">(Jul 08 2019 at 12:39)</a>:</h4>
<p>That said, I agree with Grahame, and was about to post my answer "of that is policy" but he got there first.</p>



<a name="169864807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169864807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169864807">(Jul 08 2019 at 12:43)</a>:</h4>
<p>The policy in question needs to consider the risks. In the article Brendan points to, the batch job is making regular payments, so it is making changes. In the case of a FHIR Subscription, it is not making changes, but might be improperly notifying. So there is a different risk profile.   The case where the user decides to NOT authorize this subscription, that should be looked to as a new operation against the Subscription. So the most important risk is that when the subscription is going to notify, to be sure the user and app still exist and have a relationship. (Not good to notify a patient that has died).</p>



<a name="169864947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/169864947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#169864947">(Jul 08 2019 at 12:44)</a>:</h4>
<p>so, it depends on policy and circumstances. Nothing wrong with using the model outlined in the article.  But the whole set of risks must be considered, such as the death of the subscriber (payer)...</p>



<a name="170416691"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/OAuth%20with%20async/near/170416691" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/OAuth.20with.20async.html#170416691">(Jul 09 2019 at 01:35)</a>:</h4>
<p>Catching up here, I think <span class="user-mention" data-user-id="191920">@Mohammad Jafari</span> said it just right. In general <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> if you have an authorized async step, there should still be authorization in place at the end of the process. (In Bulk Data we use SMART Backend Services authorization with asynchronous operations, so a client can always fetch new access tokens as needed; with the SMART App Launch framework for user authorization, you'd probably want a refresh token.)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
