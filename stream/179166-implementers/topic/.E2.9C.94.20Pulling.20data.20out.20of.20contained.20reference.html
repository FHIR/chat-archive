---
layout: page
title: "FHIR Chat  · ✔ Pulling data out of contained reference · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.E2.9C.94.20Pulling.20data.20out.20of.20contained.20reference.html">✔ Pulling data out of contained reference</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="251598944"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%E2%9C%94%20Pulling%20data%20out%20of%20contained%20reference/near/251598944" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Beth Werbaneth <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.E2.9C.94.20Pulling.20data.20out.20of.20contained.20reference.html#251598944">(Sep 01 2021 at 17:36)</a>:</h4>
<p>Hi, I'm new to working with FHIR - I am trying to pull the contained Medication reference off of the MedicationRequest - the reference has an id reference to a resource in the Contained array, but I'm not able to access any of the fields using the Java client. I was able to find examples in the docs of building the xml for Contained resources, but not for accessing that data from deserialized objects</p>
<p>This is the JSON I'm testing with: <a href="https://www.hl7.org/fhir/medicationrequest0302.json.html">https://www.hl7.org/fhir/medicationrequest0302.json.html</a></p>
<p>This is the info I want to extract:</p>
<div class="codehilite"><pre><span></span><code>&quot;contained&quot;: [
    {
      &quot;resourceType&quot;: &quot;Medication&quot;,
      &quot;id&quot;: &quot;med0320&quot;,
      &quot;code&quot;: {
        &quot;coding&quot;: [
          {
            &quot;system&quot;: &quot;http://snomed.info/sct&quot;,
            &quot;code&quot;: &quot;324252006&quot;,
            &quot;display&quot;: &quot;Azithromycin 250mg capsule (product)&quot;
          }
        ]
      }
    }
  ]
</code></pre></div>
<p>Specifically, I need</p>
<div class="codehilite"><pre><span></span><code>            &quot;system&quot;: &quot;http://snomed.info/sct&quot;,
            &quot;code&quot;: &quot;324252006&quot;,
            &quot;display&quot;: &quot;Azithromycin 250mg capsule (product)&quot;
</code></pre></div>
<p>I've tried a couple of different ways but haven't been able to access the contained info from the Java SDK.</p>
<div class="codehilite"><pre><span></span><code>private Optional&lt;Coding&gt; extractCode(MedicationRequest medicationRequest) {
        final CodeableConcept codeableConcept = medicationRequest.getMedicationCodeableConcept();
        return codeableConcept.getCoding().stream().findFirst();
    }
</code></pre></div>
<p>produces exception</p>
<div class="codehilite"><pre><span></span><code>org.jboss.resteasy.spi.UnhandledException: org.hl7.fhir.exceptions.FHIRException: Type mismatch: the type CodeableConcept was expected, but org.hl7.fhir.r4.model.Reference was encountered
</code></pre></div>



<a name="251608130"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%E2%9C%94%20Pulling%20data%20out%20of%20contained%20reference/near/251608130" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Venton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.E2.9C.94.20Pulling.20data.20out.20of.20contained.20reference.html#251608130">(Sep 01 2021 at 18:37)</a>:</h4>
<p>I suspect your medicationRequest contains .medicationReference (not medicationCodeableConcept) which is just that a reference. You have to resolve the reference (the contained Medication resource). At which time you can get the Medication.code. If your medicationRequest contained a medicationCodeableConcept, then your code would probably work.</p>



<a name="251617646"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%E2%9C%94%20Pulling%20data%20out%20of%20contained%20reference/near/251617646" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Beth Werbaneth <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.E2.9C.94.20Pulling.20data.20out.20of.20contained.20reference.html#251617646">(Sep 01 2021 at 19:43)</a>:</h4>
<p>Hi Daniel, I updated the MedicationTest i'm testing with to this:</p>
<div class="codehilite"><pre><span></span><code>{
  &quot;resourceType&quot;: &quot;MedicationRequest&quot;,
  &quot;id&quot;: &quot;medrx002&quot;,
  &quot;text&quot;: {
    &quot;status&quot;: &quot;generated&quot;,
    &quot;div&quot;: &quot;placeholder&quot;
  },
  &quot;medication&quot;: {
    &quot;coding&quot;: [
      {
        &quot;system&quot;: &quot;http://www.nlm.nih.gov/research/umls/rxnorm&quot;,
        &quot;code&quot;: &quot;856907&quot;,
        &quot;display&quot;: &quot;Sulfamethoxazole - Trimethoprim, Tablet, 400mg - 80mg&quot;
      }
    ]
  },
  &quot;identifier&quot;: [
    {
      &quot;use&quot;: &quot;official&quot;,
      &quot;system&quot;: &quot;http://www.bmc.nl/portal/prescriptions&quot;,
      &quot;value&quot;: &quot;12345&quot;
    }
  ],
  &quot;status&quot;: &quot;active&quot;,
  &quot;intent&quot;: &quot;order&quot;,
  &quot;authoredOn&quot;: &quot;2021-07-15&quot;,
  &quot;requester&quot;: {
    &quot;reference&quot;: &quot;Practitioner/f007&quot;,
    &quot;display&quot;: &quot;Patrick Pump&quot;
  },
  &quot;dosageInstruction&quot;: [
    {
      &quot;sequence&quot;: 1,
      &quot;text&quot;: &quot;Take one tablet daily as directed&quot;
    }
  ]
}
</code></pre></div>
<p>I'm no longer getting the type mismatch error and am able to get a CodeableConcept, but the list of coding it returns is null. When I debug, the deserialized medication has all empty fields.</p>



<a name="251619605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%E2%9C%94%20Pulling%20data%20out%20of%20contained%20reference/near/251619605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Venton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.E2.9C.94.20Pulling.20data.20out.20of.20contained.20reference.html#251619605">(Sep 01 2021 at 19:57)</a>:</h4>
<p>Shouldn't "medication" be called medicationCodeableConcept, that's how the [x] works. You add the type of data being provided as part of the name.</p>



<a name="251620429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%E2%9C%94%20Pulling%20data%20out%20of%20contained%20reference/near/251620429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Beth Werbaneth <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.E2.9C.94.20Pulling.20data.20out.20of.20contained.20reference.html#251620429">(Sep 01 2021 at 20:02)</a>:</h4>
<p>Thanks so much Daniel, that fixed it!</p>



<a name="251620486"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%E2%9C%94%20Pulling%20data%20out%20of%20contained%20reference/near/251620486" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.E2.9C.94.20Pulling.20data.20out.20of.20contained.20reference.html#251620486">(Sep 01 2021 at 20:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="437242">Beth Werbaneth</span> has marked this topic as resolved.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
