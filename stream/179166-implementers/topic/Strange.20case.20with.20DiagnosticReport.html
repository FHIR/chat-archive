---
layout: page
title: "FHIR Chat  · Strange case with DiagnosticReport · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html">Strange case with DiagnosticReport</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="158513818"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158513818" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Valeriy Shtanko <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158513818">(Feb 14 2019 at 09:04)</a>:</h4>
<p>Hi!</p>
<p>I am using HAPI and faced strange case with DiagnosticReport.<br>
I add 3 Observation into DiagnosticReport.getContained(), but in output JSON doesn't have 'contained' section at all.</p>
<p>Could you help me with any advise why that can be possible?</p>
<p>Thanks</p>



<a name="158518097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158518097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158518097">(Feb 14 2019 at 10:20)</a>:</h4>
<p>I believe HAPI removes contained resources if they are not being referenced by the containing resource.</p>
<p>This should work.</p>
<p>Patient pat = new Patient();<br>
pat.setActive(true);<br>
// do not set an id for pat; HAPI will automatically assign ids for contained resources<br>
Observation obs = new Observation();<br>
obs.setSubject(new Reference(pat));</p>
<p>In here, patient is being added as a contained resource to observation.</p>



<a name="158521784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158521784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Valeriy Shtanko <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158521784">(Feb 14 2019 at 11:25)</a>:</h4>
<p>Hi Micheal!</p>
<p>Thank you for good advise.<br>
I try to do in that way.<br>
But in my case I want add Observation to DiagnosticReport as contained resource.<br>
It is should be possible, I see examples on test server.</p>
<p>But by some unknown me reason it doesn't work in my case.</p>



<a name="158523335"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158523335" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158523335">(Feb 14 2019 at 11:54)</a>:</h4>
<p>You can't just go and do:</p>
<div class="codehilite"><pre><span></span>mydiagnosticreport.getContained().add(myobs);
</pre></div>


<p>You have to do something like (in your case):</p>
<div class="codehilite"><pre><span></span>Observation obs = new Observation();
// set observation fields; do not set resource id
DiagnosticReport diagRpt = new DiagnosticReport();
diagRpt.addResult(new Reference(obs));
</pre></div>



<a name="158524549"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158524549" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Valeriy Shtanko <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158524549">(Feb 14 2019 at 12:17)</a>:</h4>
<p>Thank you! Thank you a lot!  You saved my life!<br>
It works now as I want.</p>
<p>Could I ask one more question?</p>
<p>I have four STRINGS values which I want put into Observation: </p>
<div class="codehilite"><pre><span></span> name of analysis,  result of analysis, unit of measurement, result interval
</pre></div>


<p>Could you advice me a way which I can do it?<br>
I cannot use Quantity because it accepts only numeric result of analysis and result interval?</p>



<a name="158529167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158529167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158529167">(Feb 14 2019 at 13:35)</a>:</h4>
<p>Are those the actual literal values you want to put into an Observation? Or those are just field names and you are trying to put into an Observation the following example?</p>
<div class="codehilite"><pre><span></span>Systolic BP, 120, mm<span class="k">[Hg]</span>, 100-120
</pre></div>



<a name="158530101"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158530101" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Valeriy Shtanko <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158530101">(Feb 14 2019 at 13:50)</a>:</h4>
<p>I need to put these literal values into observations.<br>
The best way which I found is using Observation.component:<br>
         {<br>
            "resourceType": "Observation",<br>
            "id": "1",<br>
            "component": [<br>
                {<br>
                    "id": "name-of-analysis",<br>
                    "valueString": "a1"<br>
                },<br>
                {<br>
                    "id": "result-of-analysis",<br>
                    "valueString": "a2"<br>
                },<br>
                {<br>
                    "id": "unit-of-measurement",<br>
                    "valueString": "a3"<br>
                },<br>
                {<br>
                    "id": "reference-interval",<br>
                    "valueString": "a4"<br>
                }<br>
            ]<br>
        }</p>
<p>But it does't look good. May be "more FHIR" way exists?</p>



<a name="158530596"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158530596" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158530596">(Feb 14 2019 at 13:58)</a>:</h4>
<p>Not sure what you're trying to model, but in my opinion I would map your:<br>
1. <code>name of analysis</code> to <code>Observation.code</code><br>
2. <code>result of analysis</code> to <code>Observation.valueQuantity.value</code><br>
3. <code>unit of measurement</code> to <code>Observation.valueQuantity.unit</code> or <code>Observation.valueQuantity.code</code><br>
4. <code>reference-interval</code> to <code>Observation.referenceRange</code></p>
<p>See this example: <a href="http://hl7.org/fhir/STU3/observation-example-f001-glucose.json.html" target="_blank" title="http://hl7.org/fhir/STU3/observation-example-f001-glucose.json.html">http://hl7.org/fhir/STU3/observation-example-f001-glucose.json.html</a></p>



<a name="158532052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158532052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Valeriy Shtanko <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158532052">(Feb 14 2019 at 14:21)</a>:</h4>
<p>I cannot use Observation.valueQuantity.value, because in my case result of analysis is string, which not garanteed to be representation of numeric value.</p>
<p>The same about Observation.referenceRange and my referenceinterval.</p>



<a name="158532288"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158532288" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig McClendon <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158532288">(Feb 14 2019 at 14:24)</a>:</h4>
<p>I suggest you spend some time reading the Observation definition. Observation.value[x] is a "choice type" (aka variable type), and will accept values of many different data types.</p>



<a name="158532439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158532439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig McClendon <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158532439">(Feb 14 2019 at 14:27)</a>:</h4>
<p>It might be helpful to understand what you are modeling as well. Having a unit of measure for a string value is not common.</p>



<a name="158537575"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158537575" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Valeriy Shtanko <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158537575">(Feb 14 2019 at 15:25)</a>:</h4>
<p>I am already doing that - reading documentation and sources.<br>
Observation.value[x] can accept restricted set of type and no one can satisfy my crazy uncommon case.</p>
<p>Thank you a lot for your help.</p>



<a name="158539555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158539555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158539555">(Feb 14 2019 at 15:48)</a>:</h4>
<p>Be careful in your use of 'contained'.  It's not a packaging/delivery mechanism.  In general, the Observations within a DiagnosticReport should be able to stand independently, which means they should not be sent as 'contained' resources - they should be independent resources.  If you need to send them alongside the DiagnosticReport, look at the batch or transaction mechanisms.</p>



<a name="158540370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158540370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158540370">(Feb 14 2019 at 15:56)</a>:</h4>
<p><span class="user-mention" data-user-id="201776">@Valeriy Shtanko</span> To keep things in topic, I believe your original question is largely answered. Lloyd also gives a good recommendation that you should think about.</p>
<p>I would suggest creating a new topic thread for your other question so answers and replies for that topic can be focused to that one instead.</p>



<a name="158541966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Strange%20case%20with%20DiagnosticReport/near/158541966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Valeriy Shtanko <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Strange.20case.20with.20DiagnosticReport.html#158541966">(Feb 14 2019 at 16:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> , <span class="user-mention" data-user-id="193952">@Michael Calderero</span> </p>
<p>Thank you.<br>
I agree, It is right to work with Observation as  independent resource and I will try to do it in that way in nearest future.<br>
But at the moment, I have what I have.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
