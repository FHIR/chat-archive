---
layout: page
title: "FHIR Chat  · When an invalid query parameter variable is attempted... · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html">When an invalid query parameter variable is attempted...</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="199525440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199525440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Cox <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199525440">(Jun 02 2020 at 17:26)</a>:</h4>
<p>...why does my R4 Azure API for FHIR return instead a general query for the resource and ignore the invalid query parameter? Should the response not be a rejection for invalid query variable? </p>
<p>My situation in a bit more detail:</p>
<ol>
<li>The mistaken query variable: I was trying to send a GET req for " [Base URL]/QuestionnaireResponse?<strong>reference=####</strong> ", when in actuality I should have been querying for " [Base URL]/QuestionnaireResponse?identifier=#### "</li>
<li>When I sent this incorrect URI to the backend, instead I was returned a 200 but for a general query on the resource (as if I sent a GET to  " [Base URL]/QuestionnaireResponse" which effectively gave me all of the available resources. I understand how this would be a super useful feature in most scenarios, but for mine it would be preferred to only return the query I sent or otherwise a 404/500 response. </li>
</ol>
<p>I guess my main two questions are: Is this standard for Azure API for FHIR? &amp;&amp; Are there additional variables I can add to my query URI to perhaps ensure my desired return flow? </p>
<p>Thanks as always for the great insight all. Look forward to hearing from the community</p>



<a name="199526802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199526802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199526802">(Jun 02 2020 at 17:36)</a>:</h4>
<p>Ignoring unsupported search parameters is the standard (and recommended) server behavior because it's more efficient.  If it failed, the client would have to reformulate the query to exclude the unsupported parameter (and write and test the complex code to handle that), then re-query and filter the data locally.  The default mode of just filter with what you can means the only code the client needs to write is to filter the data locally.  The server always declares what parameters it paid attention to.</p>



<a name="199528246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199528246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199528246">(Jun 02 2020 at 17:48)</a>:</h4>
<p>In my experience most developers have found this behaviour confusing and frustrating, so we added a configuration option to the Google FHIR store to enforce strict handling by default.</p>



<a name="199528531"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199528531" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199528531">(Jun 02 2020 at 17:50)</a>:</h4>
<p>It sort of depends on whether you're developing a client for a single server or for a variety.  The API is optimized for those who are developing for a variety.</p>



<a name="199530721"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199530721" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Cox <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199530721">(Jun 02 2020 at 18:07)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> Thank you for the valuable insight. <br>
<span class="user-mention" data-user-id="197072">@Paul Church</span> thanks for your perspective as well, this discussion was helpful.</p>



<a name="199535688"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199535688" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199535688">(Jun 02 2020 at 18:45)</a>:</h4>
<p><span class="user-mention" data-user-id="308460">@Michael Cox</span>  You can add this to indicate client's preference. Again, depends on if server supports that. <br>
<code>Prefer: handling=strict: Client requests that the server return an error for any unknown or unsupported parameter</code></p>



<a name="199536904"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199536904" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Cox <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199536904">(Jun 02 2020 at 18:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191506">@Yunwei Wang</span> Ah interesting. Sorry, is that a header or something in the param you are describing?</p>



<a name="199538527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199538527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199538527">(Jun 02 2020 at 19:06)</a>:</h4>
<p><span class="user-mention" data-user-id="197072">@Paul Church</span> -- in my opinion, it's not only "confusing and frustrating" for a server to ignore unsupported query parameters; I believe it's dangerous (at least in the healthcare domain).  If a server can't properly provide what a client asked for, it should be very clear about that.  But... I've argued for this before and haven't won yet. ;-)</p>



<a name="199545657"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199545657" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199545657">(Jun 02 2020 at 20:05)</a>:</h4>
<p>R4 added the pref so a client could describe the behavior, as mentioned above. It still gets interesting on if you fail for "known unsupported" vs. others you don't know about (that may be added by network or things between)... Also apps can query the params as described in the conformance statement vs. discovering late/after sending the req</p>



<a name="199545822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199545822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199545822">(Jun 02 2020 at 20:06)</a>:</h4>
<p>could be done at the same time it discovers if the resource/action is supported at all by the server.</p>



<a name="199546380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199546380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199546380">(Jun 02 2020 at 20:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191469">Chris Moesel</span> <a href="#narrow/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E/near/199538527">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="197072">Paul Church</span> -- in my opinion, it's not only "confusing and frustrating" for a server to ignore unsupported query parameters; I believe it's dangerous (at least in the healthcare domain).  If a server can't properly provide what a client asked for, it should be very clear about that.  But... I've argued for this before and haven't won yet. ;-)</p>
</blockquote>
<p>The theory is that a server ignoring a query parameter will ONLY have the affect of returning MORE results than the client is expecting. Meaning that query parameters only constrain the results, not expand the results.</p>



<a name="199549280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199549280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199549280">(Jun 02 2020 at 20:31)</a>:</h4>
<p>Understood.  It's just that more results isn't necessarily safer.  Consider <code>/Condition?verification-status=confirmed</code> for a server that doesn't support searches via <code>verification-status</code> -- you might get some Conditions that are <code>refuted</code> or <code>entered-in-error</code>.  Quite the opposite of what the client wanted!</p>
<p>I do appreciate that there are provisions for clients to pro-actively say they don't want it this way, or to check conformance for what is supported; I just feel like we should have defaulted to the safer approach rather than requiring "opt in" to the safer approach.  Unfortunately, I don't think every developer reads enough of the spec to understand that servers can silently ignore their spec-valid search parameters and that they (the client) need to defend against that.  But... I think that's all normative now, so I'll try to stay quiet. ;-)</p>



<a name="199549655"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199549655" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199549655">(Jun 02 2020 at 20:34)</a>:</h4>
<p>There are lots of situations in RESTful spaces where additional parameters end up in the URL for transport reasons.  Failing based on the presence of those would be quite problematic.</p>



<a name="199549690"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/199549690" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#199549690">(Jun 02 2020 at 20:35)</a>:</h4>
<p>The spec is quite clear that implementers SHALL check the self link of query responses and handle the situation of data not being filtered as much as they might wish.</p>



<a name="202062949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/When%20an%20invalid%20query%20parameter%20variable%20is%20attempted.../near/202062949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/When.20an.20invalid.20query.20parameter.20variable.20is.20attempted.2E.2E.2E.html#202062949">(Jun 26 2020 at 08:13)</a>:</h4>
<p>I have a server that only rejects if you don't have specific search params in specific contexts.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
