---
layout: page
title: "FHIR Chat  · Validation on datatype invariants · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validation.20on.20datatype.20invariants.html">Validation on datatype invariants</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="251226371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validation%20on%20datatype%20invariants/near/251226371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validation.20on.20datatype.20invariants.html#251226371">(Aug 30 2021 at 13:09)</a>:</h4>
<p>Hello,  I wanted to add invariant over Quantity datatype to say system should be(warning) an UCUM system(<a href="http://unitsofmeasure.org">http://unitsofmeasure.org</a>) and created a datatype profile over Quantity, now this profile referenced at MedicationStatement.dosage.doseAndRate.dose[x] for quantity type.</p>
<p>While validating the medication statement instance(updated HL7 medication statement sample to mentioned quantity system other then UCUM )  against medication statement profile using latest Java validator which got success instead of expected warning.</p>
<p>Quantity.system invariant  - <br>
&lt;severity value="warning"/&gt;<br>
&lt;expression value="system.exists() implies system='http://unitsofmeasure.org'"/&gt;</p>
<p>instance snippet - assume all other need data are there including meta {<br>
  "resourceType": "MedicationStatement",<br>
  "dosage": [<br>
    {<br>
      "doseAndRate": [<br>
        {<br>
          "doseQuantity": {<br>
            "value": 1,<br>
            "unit" : "Dosage",<br>
            "system": "<a href="http://snomed.info/sct">http://snomed.info/sct</a>",<br>
            "code": "260911001"<br>
          }<br>
        }<br>
      ]<br>
    }<br>
  ]<br>
} </p>
<p>I think validator should give a warning as per invariant on datatype, but it is not giving any warning.<br>
Let me know if I am missing anything here, thanks</p>



<a name="251252139"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validation%20on%20datatype%20invariants/near/251252139" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validation.20on.20datatype.20invariants.html#251252139">(Aug 30 2021 at 16:04)</a>:</h4>
<p>Can you post both your data type and MedicationStatement profile here as well as your instance and how you're invoking the validator?</p>



<a name="251340520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validation%20on%20datatype%20invariants/near/251340520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validation.20on.20datatype.20invariants.html#251340520">(Aug 31 2021 at 06:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> ,, thanks for reply, please find the attachment. <a href="/user_uploads/10155/nOnVemXzAPvH6bo3GKLuywal/DataTypeInvariantValidation.zip">DataTypeInvariantValidation.zip</a></p>



<a name="251387174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validation%20on%20datatype%20invariants/near/251387174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validation.20on.20datatype.20invariants.html#251387174">(Aug 31 2021 at 13:46)</a>:</h4>
<p>The location of your invariant is incorrect.  It's being declared on 'system', but the invariant is <code>        &lt;expression value="system.exists() implies system='http://unitsofmeasure.org'" /&gt;</code><br>
That means "if system.system exists, then system.system needs to be <a href="http://unitsofmeasure.org">http://unitsofmeasure.org</a>".  Move your extension up to be declared on Quantity and try again</p>



<a name="251528126"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Validation%20on%20datatype%20invariants/near/251528126" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kailash <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Validation.20on.20datatype.20invariants.html#251528126">(Sep 01 2021 at 09:22)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  for finding, on first hand testing its working!!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
