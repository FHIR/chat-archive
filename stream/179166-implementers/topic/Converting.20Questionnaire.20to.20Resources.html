---
layout: page
title: "FHIR Chat  · Converting Questionnaire to Resources · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html">Converting Questionnaire to Resources</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="250594775"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250594775" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250594775">(Aug 25 2021 at 08:58)</a>:</h4>
<p>I'm looking at a use case where a "referrer" can ask for a refferal to a care setting. The Care Setting returns a request for the information they require to complete the referral. I was thinking that the request for information would be a Questionnaire. However, rather than a QuestionnaireResponse, I would prefer a Message Bundle as the response to the Quesionnaire (containing Patient details, Condition details, History detailas &amp; whatever). I see from SDC (Structured Data Capture) spec this all seems possible. Could someone point me to a live public test FHIR server that has implmented the URL: [base]/QuestionnaireResponse/[id]/$extract operation, so I can test this out?</p>



<a name="250595904"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250595904" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250595904">(Aug 25 2021 at 09:12)</a>:</h4>
<ol>
<li>
<p>Placer POSTs the ServiceRequest A (intent = proposal). (Or message 'referral' if that is the payload requirement)<br>
exchange type = message</p>
</li>
<li>
<p>Filler POSTs a 'task/complete-form' message with the SDC content ....  which is either a Task which specifies Questionnaire is to be completed (may contain Questionnaire)<br>
exchange type = message or restful POST /Task</p>
</li>
<li>
<p>Original Placer - POSTs the response is also a message which is 'patient-form' event which contains all your data (focus QuestionnaireResponse)<br>
exchange type = message</p>
</li>
<li>
<p>Filler POSTs back ServiceReques to indicate accepted, rejected, etc</p>
</li>
</ol>



<a name="250599423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250599423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250599423">(Aug 25 2021 at 09:53)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span> has done somethign similar and has a good demonstration of that</p>



<a name="250599753"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250599753" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250599753">(Aug 25 2021 at 09:57)</a>:</h4>
<p>Wondering if this is SDC, more accurately SDC is long term aim. At the moment its just asking for a form to be completed and responding with the completed form.</p>



<a name="250600134"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250600134" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250600134">(Aug 25 2021 at 10:01)</a>:</h4>
<p>I read that instead of a QuestionnaireResponse we want a MessageBundle - that is SDC.</p>



<a name="250600287"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250600287" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250600287">(Aug 25 2021 at 10:02)</a>:</h4>
<p>Oliver's implementation has a working $extract operation</p>



<a name="250600520"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250600520" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250600520">(Aug 25 2021 at 10:05)</a>:</h4>
<p><a href="https://ahdis.github.io/matchbox-formfiller/#/questionnaire/referral-min">https://ahdis.github.io/matchbox-formfiller/#/questionnaire/referral-min</a></p>



<a name="250602385"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250602385" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250602385">(Aug 25 2021 at 10:29)</a>:</h4>
<p>you could ask on <a class="stream" data-stream-id="179255" href="/#narrow/stream/179255-questionnaire">#questionnaire</a></p>



<a name="250604372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250604372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250604372">(Aug 25 2021 at 10:55)</a>:</h4>
<p><span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> - probably just me being a bit dumb. I can fill in the questionnaire, get the QuestionnaireResponse below to update - how do I call the $extract operation &amp; see the created resources?</p>



<a name="250604605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250604605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250604605">(Aug 25 2021 at 10:58)</a>:</h4>
<p>Sorry, this is the link: <a href="https://ahdis.github.io/matchbox-formfiller/#/questionnaire/sdc-extract">https://ahdis.github.io/matchbox-formfiller/#/questionnaire/sdc-extract</a></p>



<a name="250622017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250622017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250622017">(Aug 25 2021 at 13:46)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> - a nice demo of what's possible with $extract</p>



<a name="250637539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/250637539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#250637539">(Aug 25 2021 at 15:40)</a>:</h4>
<p><span class="user-mention" data-user-id="192158">@Dave Barnet</span> the $extract operation is invoked after filling out the questionnaire, if it is specified in the questionnaire according to the SDC profile for <a href="http://build.fhir.org/ig/HL7/sdc/extraction.html#structuremap-based-extraction">StructureMap-based</a> extraction. You can also invoke the $extract directly, however the server needs the questionnaire/structuremap available. we plan to set up a test server for the upcoming fhir connectathon that you can upload your questionnaires and fhir maps and will participate in the FHIR questionnaire track, if you are interested in using it do not hesitate to contact me.</p>



<a name="251856700"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/251856700" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#251856700">(Sep 03 2021 at 10:20)</a>:</h4>
<p><span class="user-mention" data-user-id="191478">@Oliver Egger</span>  - I'd be very interested in having a look at any test server you plan to set up in relation to SDC. I've had a "dabble" creating a couple of resources trying to create a Patient from a Questionnaire: <br>
Questionnaire <a href="http://server.fire.ly/Questionnaire/e5c5e2d9-deab-462f-9581-450f4847fd55">http://server.fire.ly/Questionnaire/e5c5e2d9-deab-462f-9581-450f4847fd55</a> <br>
QuestionnaireResponse <a href="http://server.fire.ly/QuestionnaireResponse/20f5a694-181a-452a-bcf8-a01f1e0f32ac">http://server.fire.ly/QuestionnaireResponse/20f5a694-181a-452a-bcf8-a01f1e0f32ac</a> <br>
StructureMap <a href="http://server.fire.ly/StructureMap/49c4e073-4ee0-4417-b6aa-962d0c81ca8d">http://server.fire.ly/StructureMap/49c4e073-4ee0-4417-b6aa-962d0c81ca8d</a> <br>
I'm sure the StructureMap isn't right, but I can't find anywhere to test it out?</p>



<a name="251918060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/251918060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#251918060">(Sep 03 2021 at 17:48)</a>:</h4>
<p>The FHIR validator allows you to execute StructureMaps</p>



<a name="253484743"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/253484743" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#253484743">(Sep 15 2021 at 20:44)</a>:</h4>
<p><span class="user-mention" data-user-id="192158">@Dave Barnet</span> sorry for delayed response. Were you successful using the FHIR validator? If you want to try to run StructureMap you can post it also on our test server, see info here: <a href="https://github.com/ahdis/matchbox/blob/main/fml.http">https://github.com/ahdis/matchbox/blob/main/fml.http</a></p>



<a name="254060339"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/254060339" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#254060339">(Sep 20 2021 at 14:38)</a>:</h4>
<p>Thanks for your help <span class="user-mention" data-user-id="191478">@Oliver Egger</span>. To be honest, I think I've struggled with the help and guidance on the wiki pages (<a href="https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content">https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content</a>), which leads you to download the validator and set up the transform  along the lines of<br>
Validator [fileToTransform] -transform -output [outputFile] -log [logFile] -map [uriOfMap] -ig [folderOfIG]<br>
... which for me produced either  "Exception: Can only nominate a single -map parameter", or when I juggled the parameters and eventually got the validator to spark into life ""Exception: Can only have one source when doing a transform (found [c:\BaRS\TstQR.xml, <a href="http://fhir.nhs.uk/StructureMap/patientxform]">http://fhir.nhs.uk/StructureMap/patientxform]</a>)" - which are the file names of the QR I want to transform.<br>
The format that I eventually discovered that works (for me at least) is<br>
Validator [fileToTransformFrom] -transform [StructureDefURI] -ig [IGFolder] -output [ResultsFile] -log [LogFile] -version <br>
Which was fine for creating a patient with a gender element - I can even add a birthDate, but anything more complicated involving complex data types seems to be even harder (for example a QR has a text field for a name, how do you load this into Patient.name.text ? - Just my frustration - thanks for your help !</p>



<a name="254069128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/254069128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#254069128">(Sep 20 2021 at 15:34)</a>:</h4>
<p><span class="user-mention" data-user-id="217312">@Joee Garcia</span> Any words of advice?</p>



<a name="254097599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/254097599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#254097599">(Sep 20 2021 at 18:40)</a>:</h4>
<p><span class="user-mention" data-user-id="192158">@Dave Barnet</span> we started the same way as you did,  we moved then to a server side approach that the iteration gets faster. You can fill the patient.name.text with the following rule: </p>
<div class="codehilite"><pre><span></span><code>src.item as item where linkId.value in (&#39;patient.name.text&#39;) -&gt; tgt.name as name, name.text = (item.answer.valueString);
</code></pre></div>



<a name="254097923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/254097923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Egger <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#254097923">(Sep 20 2021 at 18:42)</a>:</h4>
<p>you can try the map here yourself: <a href="https://ahdis.github.io/matchbox-formfiller/#/mappinglanguage">https://ahdis.github.io/matchbox-formfiller/#/mappinglanguage</a><br>
when you load the qr response and map into the editor <a href="/user_uploads/10155/HIqB1SB1puOBS_boG9HMibjB/qrpatienttext.json">qrpatienttext.json</a> <a href="/user_uploads/10155/YTg9doae87kuRGbj99H6flZR/qrpatienttext.map">qrpatienttext.map</a></p>



<a name="254335980"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/254335980" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Barnet <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#254335980">(Sep 22 2021 at 08:59)</a>:</h4>
<p>Thanks for that link <span class="user-mention" data-user-id="191478">@Oliver Egger</span> - that was very useful &amp; I've managed to create most  of a Patient resource from a QR (just using valueString in the QR). I'm not sure how to create a CodeableConcept in the target. For example, I (following your example) I tried to create Patient.maritalStatus. I tried<br>
  src.item as thing where linkId.value in ('patient.maritalStatus') -&gt; tgt.maritalStatus as maritalStatus, maritalStatus=(thing.answer.valueString);<br>
  src.item as thing where linkId.value in ('patient.maritalStatus') -&gt; tgt.maritalStatus as maritalStatus, maritalStatus.code=(thing.answer.valueString);<br>
  src.item as thing where linkId.value in ('patient.maritalStatus') -&gt; tgt.maritalStatus as maritalStatus, maritalStatus.coding.code=(thing.answer.valueString);<br>
  src.item as thing where linkId.value in ('patient.maritalStatus') -&gt; tgt.maritalStatus = cc("SomeSystem", "123");<br>
...but none of these worked. I also had issues creating anything described as element[x] (for example deceasedBoolean). For example none of these worked<br>
src.item as thing where linkId.value in ('patient.deadOrNot') -&gt; tgt.deceasedBoolean as deceasedBoolean, deceasedBoolean= ("true");<br>
src.item as thing where linkId.value in ('patient.deadOrNot') -&gt; tgt.deceasedBoolean = ("true");<br>
src.item as thing where linkId.value in ('patient.deadOrNot') -&gt; tgt.deceasedBoolean as deceasedBoolean, deceasedBoolean.value= ("true");</p>
<p>But overall I feel I'm making progress - Thanks again</p>



<a name="257121504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/257121504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#257121504">(Oct 11 2021 at 21:58)</a>:</h4>
<p>does the FHIR validator execute StructureMaps or FML files?</p>



<a name="257121745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/257121745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#257121745">(Oct 11 2021 at 22:00)</a>:</h4>
<p><span class="user-mention" data-user-id="217312">@Joee Garcia</span></p>



<a name="257129342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Converting%20Questionnaire%20to%20Resources/near/257129342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joee Garcia <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Converting.20Questionnaire.20to.20Resources.html#257129342">(Oct 11 2021 at 23:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191651">@Rik Smithies</span>  I don't think the FHIR Validator supports FML files.  I've only been able to execute StructureMaps with it.  Check-out <a href="https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Mapping+Language#UsingtheFHIRMappingLanguage-ExecutewithaTransform">https://confluence.hl7.org/display/FHIR/Using+the+FHIR+Mapping+Language#UsingtheFHIRMappingLanguage-ExecutewithaTransform</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
