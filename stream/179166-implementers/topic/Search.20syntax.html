---
layout: page
title: "FHIR Chat  · Search syntax · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html">Search syntax</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="216456299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216456299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Jahagirdar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216456299">(Nov 12 2020 at 11:30)</a>:</h4>
<p>Hi All,<br>
I am trying to get syntax for Search API which does following:</p>
<ul>
<li>Select a patient and include additional resources ProcedureRequest and Encounter.</li>
<li>Procedure request with specific code</li>
<li>encounters linked to above selected procedure request</li>
</ul>
<p>is it possible to do it in one single request?<br>
I was thinking of following;</p>
<p>https://&lt;fhirserver/Patient?<br>
rev_include=ProcedureRequest:code=123 &amp;<br>
rev_include=Encounter[ How to select encounter linked to above procedure request ?]</p>
<p>thanks.</p>



<a name="216460663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216460663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Sandberg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216460663">(Nov 12 2020 at 12:26)</a>:</h4>
<p>Probably best to go in from the ProcedureRequest, I don't have an example set up, so I'm doing this blind:<br>
[base]/ProcedureRequest?code=123&amp;subject.identifier=923842&amp;include=ProcedureRequest:subject&amp;include=ProcedureRequest:context</p>
<p>I don't know if the Patient could really be you're in, if you want the parameter for code to be included.</p>



<a name="216476135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216476135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216476135">(Nov 12 2020 at 14:38)</a>:</h4>
<p>Depending on what server you're connecting to, you may find it's better to stick with a couple of simpler calls rather than trying to do everything in a single query. Keep in mind that not all fhir servers support the full breadth of the search syntax. "generic" (aka "native").</p>



<a name="216476350"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216476350" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216476350">(Nov 12 2020 at 14:40)</a>:</h4>
<p>That said, more technically: FHIR reverse inclusion <em>can't be combined</em> with chaining to only include a limited set of incoming references.</p>



<a name="216476571"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216476571" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216476571">(Nov 12 2020 at 14:42)</a>:</h4>
<p>But in your particular example you can actually do something simpler: you can formulate three independent queries that fetch the data you need -- and on servers that support batch operations, you can submit a single batch query including all three requests, so you will get back a batch response including all three results. (You can do this because you already know the patient id up front, so you can write one query for that patient, one query for a limited set of encounters pointing that patient, and a third query for a limited set of procedure requests pointing to that patient.)</p>



<a name="216480421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216480421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Sandberg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216480421">(Nov 12 2020 at 15:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179166-implementers/topic/Search.20syntax/near/216476571">said</a>:</p>
<blockquote>
<p>and on servers that support batch operations, you can submit a single batch query including all three requests, so you will get back a batch response including all three results.</p>
</blockquote>
<p>Funny you should say this, I was talking to someone about this just a few weeks ago, and he was adamant this was not the way to use the batch.</p>



<a name="216492267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216492267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216492267">(Nov 12 2020 at 16:29)</a>:</h4>
<p>re: batch, I believe the documentation on the <a href="http://hl7.org/fhir/http.html#transaction">http</a> page is pretty good about the rules - as long as you don't need to use the results of any of the queries to process the others, this would work well.  If you needed to search for the patient id first, you could not use a batch because the later steps would depend on the results of the first query.</p>



<a name="216680625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216680625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216680625">(Nov 13 2020 at 22:09)</a>:</h4>
<p>For folks interested in the details: I used this question as a jumping off point for this week's "Guided Walk Through FHIR" episode (see <a href="https://youtu.be/W8F4cGmseo0">https://youtu.be/W8F4cGmseo0</a>).</p>
<div class="youtube-video message_inline_image"><a data-id="W8F4cGmseo0" href="https://youtu.be/W8F4cGmseo0"><img src="https://i.ytimg.com/vi/W8F4cGmseo0/default.jpg"></a></div><p>FYI <span class="user-mention" data-user-id="221050">@Anand Jahagirdar</span></p>



<a name="216727963"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216727963" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Jahagirdar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216727963">(Nov 14 2020 at 12:57)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191315">@Josh Mandel</span></p>



<a name="216858447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216858447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216858447">(Nov 16 2020 at 11:19)</a>:</h4>
<p>Hmm - _revinclude=Procedure:patient:code=456 would have worked as well, one can specify a condition on a _revinclude</p>



<a name="216878640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216878640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216878640">(Nov 16 2020 at 14:34)</a>:</h4>
<p>I've missed this -- your example of has two clauses separated by equals signs and no ampersands in between? Can you point me to the specs so I can review?</p>



<a name="216883509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216883509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216883509">(Nov 16 2020 at 15:09)</a>:</h4>
<p>My error - I was confusing _revinclude with _has, which does allow additional conditional expressions expressed as modifiers. _revinclude doesn't.</p>



<a name="216883828"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20syntax/near/216883828" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20syntax.html#216883828">(Nov 16 2020 at 15:12)</a>:</h4>
<p>For this kind of exercise (the one you're tackling in your video) we force the attendees of our training courses to think about what they should use a 'focal' resource, which has a large impact on the remainder of the search URL. There are many ways to arrive at the same result, even more so if one accepts that a result bundle may include resource types other than the ones one is interested in.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
