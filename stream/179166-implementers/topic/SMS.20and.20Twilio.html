---
layout: page
title: "FHIR Chat  · SMS and Twilio · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html">SMS and Twilio</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="242764377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242764377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242764377">(Jun 15 2021 at 16:55)</a>:</h4>
<p>I've been looking through the other threads about SMS messages, and if I just missed the answer to my question, my apologies.<br>
I think my work flow is going to be something like this:</p>
<ol>
<li>Provider orders a survey for a patient (magic happens! - resources created, questionnaire identified, etc)</li>
<li>A Communication resource representing an SMS to the patient is created, the payload is a short message and a link to the survey</li>
<li>When the Communication is first created, its status is 'preparation'</li>
<li>A listener of some sort (FHIR Subscription, pub/sub) alerts a Twilio microservice that there is a new SMS communication</li>
<li>The microservice gets the Communication payload (updates the resource's status to in-progress) and attempts to send the SMS, and updating the Communication resource as appropriate</li>
</ol>
<p>Does that seem like the right approach?</p>



<a name="242766073"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242766073" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242766073">(Jun 15 2021 at 17:07)</a>:</h4>
<p>This seems like a good workflow in general. One question is whether you might want to capture (2) as a <code>CommunicationRequest</code> with status <code>active</code> (meaning: ready to be acted upon), and in (5) create the <code>Communication</code> (with <code>.basedOn</code> referencing the request) to capture the fact that the communiaction has been sent.</p>



<a name="242766441"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242766441" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242766441">(Jun 15 2021 at 17:09)</a>:</h4>
<p>Based on my best reading of these resources, I think the "Request" best captures your intended semantics in (2), which is "this request is ready to be acted upon".</p>



<a name="242766723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242766723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242766723">(Jun 15 2021 at 17:11)</a>:</h4>
<p>(BTW, I really like this idea. I sketched out a design but never started working on something similar a couple of years back. If you have any inclination to build the microservice -- whether polling- or subscription-based -- as an open-source standalone component, I'd certainly cheer you on!)</p>



<a name="242771231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242771231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242771231">(Jun 15 2021 at 17:40)</a>:</h4>
<p>Thanks! I'll look into that. And everything I've done so far is open-source, so I'll see what I can do! (I haven't used Subscriptions much yet, so that may be the main roadblock).</p>



<a name="242780176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242780176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242780176">(Jun 15 2021 at 18:43)</a>:</h4>
<p>Realistically today I'd do it via polling, and leave Subscriptions as an optimization for later (we're in the process of revamping Subscriptions for FHIR R5, along with a back-port to R4B, but this is still work in progress).</p>



<a name="242875522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242875522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242875522">(Jun 16 2021 at 12:54)</a>:</h4>
<p>So I came up with another question as I was tinkering with this. Specifically, how do I represent SMS as a medium? I don't think any of the participation modes do a great job at capturing it (<a href="https://www.hl7.org/fhir/v3/ParticipationMode/vs.html">https://www.hl7.org/fhir/v3/ParticipationMode/vs.html</a>). I guess it's technically typewritten, but I don't feel like that's what we're going for.</p>



<a name="242936808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242936808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242936808">(Jun 16 2021 at 20:16)</a>:</h4>
<p>Agreed! The <code>medium</code> is optional, and that valueset is only an example, so no huge surprise there but I agree we ought to include it. Will you submit a Jira tracker for this?</p>



<a name="242937423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242937423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242937423">(Jun 16 2021 at 20:21)</a>:</h4>
<p>As a stopgap I might just use </p>
<div class="codehilite"><pre><span></span><code>&quot;medium&quot;: [{
  &quot;coding&quot;: [{
    &quot;system&quot;: &quot;http://hl7.org/fhir/contact-point-system&quot;,
    &quot;code&quot;: &quot;sms&quot;
  }]
}]
</code></pre></div>
<p>from <a href="http://build.fhir.org/codesystem-contact-point-system.html#contact-point-system-sms">http://build.fhir.org/codesystem-contact-point-system.html#contact-point-system-sms</a> -- which would make the job of looking up the <em>right</em> ContactPoint in <code>Patient.telecom</code> pretty straightforward.</p>



<a name="242937748"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242937748" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242937748">(Jun 16 2021 at 20:23)</a>:</h4>
<p>^^ Edited to fix <code>Patient.telecom</code>, which I wrote accidentally as ".contact" at first.</p>



<a name="242943421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242943421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242943421">(Jun 16 2021 at 21:07)</a>:</h4>
<p>So it's not ready for production, but it does work: <a href="https://github.com/MayJuun/fhir_twilio">https://github.com/MayJuun/fhir_twilio</a></p>



<a name="242943672"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242943672" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242943672">(Jun 16 2021 at 21:09)</a>:</h4>
<p>I'm watching the files disappear as I browse GH ;-))</p>



<a name="242944026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242944026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242944026">(Jun 16 2021 at 21:12)</a>:</h4>
<p>You do need the Dart SDK though, although I made it specifically to run in a Docker container.</p>



<a name="242944055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242944055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242944055">(Jun 16 2021 at 21:12)</a>:</h4>
<p>Yeah, accidentally uploaded a credentials file the first time</p>



<a name="242944061"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242944061" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242944061">(Jun 16 2021 at 21:13)</a>:</h4>
<p>Should be fixed now</p>



<a name="242944144"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242944144" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242944144">(Jun 16 2021 at 21:13)</a>:</h4>
<p>Right now, as long as you put in your own credentials, you can post a ContactRequest to the PublicHapi server, and this will check it, and text you whatever the payload is, and change the status of the ContactRequest to complete.</p>



<a name="242944303"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242944303" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242944303">(Jun 16 2021 at 21:15)</a>:</h4>
<p>Not fancy, obviously, but its functional. And when I get time I'll make it cleaner, add functionality, etc. But just in case you wanted to take a look.</p>



<a name="242944990"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242944990" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242944990">(Jun 16 2021 at 21:20)</a>:</h4>
<p>Nice! My first experience reading Dart. BTW I'm mulling over the "right" way to "claim a Request from a work queue", e.g. to <a href="https://github.com/MayJuun/fhir_twilio/blob/a8de25f9e8785ec6bda6c3e5e5093e377a0a6825/lib/index.dart#L41">ensure here</a> that somebody else (like, another task runner in your cluster) hasn't already grabbed this one. I've asked a question in <a class="stream-topic" data-stream-id="179196" href="/#narrow/stream/179196-workflow/topic/Claiming.20a.20request.2C.20to.20work.20on.20it">#workflow &gt; Claiming a request, to work on it</a> to see if there's something I'm missing.</p>



<a name="242945077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242945077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242945077">(Jun 16 2021 at 21:21)</a>:</h4>
<p>It's the only language I know pretty well (obviously it looks similar to anything else object oriented, but this is the only one I really work in).</p>



<a name="242945154"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242945154" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242945154">(Jun 16 2021 at 21:22)</a>:</h4>
<p>As a stopgap or a hack, it'd be possible to</p>
<div class="codehilite"><pre><span></span><code>PUT /CommunicationRequest/:id
If-Match: W/&quot;prev-version&quot;

{
              // .copyWith(status: Code(&#39;on-hold&#39;));
}
</code></pre></div>
<p>and only proceeding if this works.</p>



<a name="242945179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242945179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242945179">(Jun 16 2021 at 21:22)</a>:</h4>
<p>And yeah, that's definitely something that would need to be solved. Plus the ensuring that the request is for an SMS, etc.</p>



<a name="242945281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242945281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grey Faulkenberry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242945281">(Jun 16 2021 at 21:23)</a>:</h4>
<p>If you have any interest in Dart/Flutter, I can certainly suggest some useful resources (and/or go on a long monologue about why I've enjoyed using them). <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="242960884"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242960884" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242960884">(Jun 17 2021 at 00:36)</a>:</h4>
<p>Task is the ressource geared towards "claiming". If you replace (or add in addition to) CommunicationRequest with Task, you  can "claim" the Task by becoming the owner.</p>



<a name="242961242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242961242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242961242">(Jun 17 2021 at 00:42)</a>:</h4>
<p>Makes sense, but still: how does the Request status state machine address the "is claimed" state?</p>



<a name="242961411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242961411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242961411">(Jun 17 2021 at 00:46)</a>:</h4>
<p>No Task.owner - no claim. Also, businessStatus (+ statusReason)</p>



<a name="242964162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242964162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242964162">(Jun 17 2021 at 01:41)</a>:</h4>
<p>But you can't know that from the Request status, and you can't know it atomically. Would you agree <span class="user-mention" data-user-id="192685">@Vassil Peytchev</span> that a new Request status like <code>in-progress</code> would help fill a meaningful gap in the current state machine?</p>



<a name="242964206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242964206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242964206">(Jun 17 2021 at 01:42)</a>:</h4>
<p>Or is there really no gap, and I just have mistaken expectation?</p>



<a name="242965618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242965618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242965618">(Jun 17 2021 at 02:18)</a>:</h4>
<p>Sorry for the drive-by posting, I need to expand a little on this. </p>
<p>In the original scenario we start with a provider order. Usually a provider order is a ServiceRequest, but here it is probably more appropriate to be a ComunicationRequest.  In any case, the resource that follows the Request pattern is just a record of the order, and (on purpose) is decoupled from the fulfillment of the request. This is reflected in the Request pattern's state machine, where the order is active or complete. </p>
<p>To get the request fulfilled, you create a Task resource, with Task.focus pointing to the order - in this case the CommunicationRequest. The state machine for Task.status is more involved and includes the capability to "negotiate" with the fulfiller. A very basic use of Task.status is setting it to <code>requested</code> and when the micrtoservice "claims" it, updates it to <code>accepted</code> or even directly to <code>in-progress</code>. </p>
<p>The microservice would be subscribed to/polling on a Task (can be based on Task.focus being a reference to a CommunicationRequest, or Task.code being a specific code, and Task.status being <code>requested</code>) </p>
<p>Once the SMS is sent, Task.output would reference the Communication resource, and the status would be <code>completed</code>.</p>
<p>With this fairly straight-forward workflow, Task.status seems to be sufficient. If there were more complicated workflows, you can add more nuances via task.businessStatus and create any state machine based on the triplet of status, businessStatus, and statusReason. Getting an owner assigned is another way to claim a Task, if there is a reason to distinguish the Task being claimed from being accepted or being in progress.</p>



<a name="242966313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242966313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242966313">(Jun 17 2021 at 02:34)</a>:</h4>
<p>This all makes sense, but Task feels like a big hammer, and also the Request.status *does" have a state machine that gets updated at various points during this workflow -- it's not like the Request represented some immutable "order as initially placed". As such, why <em>not</em> have a status like <code>in-progress</code> on the Request.status state machine?</p>



<a name="242967684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/242967684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#242967684">(Jun 17 2021 at 03:03)</a>:</h4>
<p>You could avoid the request, and have the Task represent both the request and the fulfillment. If the main point of the workflow is how the microservice will know there is something to do, it does it, and leaves a record of the fulfillment, you can start with Task - there is no need for a CommunicationRequest, unless there is a need for the permanent record of an official authorization to also be exposed as a FHIR resource.</p>
<p>As to why the Request pattern does no allow recording of the fulfillment - my guess is that the record of the fulfillment is in many cases on a different server than the record of the request. From the point of view of a pure FHIR client and a single server, that might be overkill, but I think the benefits of not having too many ways to do the same thing outweigh the hammer...</p>



<a name="243017632"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243017632" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243017632">(Jun 17 2021 at 13:33)</a>:</h4>
<p>Thanks again for the feedback here. I'd definitely try to avoid having to touch two resources in this workflow. Either Task alone or CommunicationRequest alone seems okay.</p>
<p>That said, I'll file a jira issue about the Request status state machine, because forcing a request to jump from "ready to be acted on" to "all done" seems a bit coarse grained (to be clear, I think it's fine if that jump is a common pattern in practice, but it seems very strange not to be able to express a state in between).</p>



<a name="243026770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243026770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243026770">(Jun 17 2021 at 14:35)</a>:</h4>
<p>Submitted <a href="http://jira.hl7.org/browse/FHIR-32948">FHIR-32948</a></p>



<a name="243733664"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243733664" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243733664">(Jun 24 2021 at 01:48)</a>:</h4>
<p>In general, asking a Patient to complete a Questionnaire should be a Task, not a CommunicationRequest.  CommunicationRequest allows you to say "please share data".  It's not really intended to be used for "please perform some activity, then send me the result".  The SDC implementation guide defines a profile for what the Task should look like here: <a href="http://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-task.html">http://build.fhir.org/ig/HL7/sdc/StructureDefinition-sdc-task.html</a> (and will soon have some additional guidance that talks about how to use it).</p>



<a name="243733712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243733712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243733712">(Jun 24 2021 at 01:48)</a>:</h4>
<p>So my vote is for Task alone.</p>



<a name="243733818"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243733818" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243733818">(Jun 24 2021 at 01:50)</a>:</h4>
<p>Request resources can't be claimed.  A Task soliciting the fulfillment some or all of a Request can be claimed.  Without a Task, the Request itself isn't actionable.  It's like a paper prescription or lab requisition sitting in the patient's pocket.  No pills are counted and no blood is drawn until/unless the patient gives the piece of paper to a pharmacy/lab and says "please action".  (And even then, for the drug prescription, they only typically action one fill, not the whole order.)</p>



<a name="243737085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243737085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243737085">(Jun 24 2021 at 03:09)</a>:</h4>
<p>The semantics of the communication request are "please send this sms" ; it's not about "a Task to complete a questionnaire" -- or at least, I wouldn't want to limit it to that.</p>



<a name="243737136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243737136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243737136">(Jun 24 2021 at 03:10)</a>:</h4>
<p>I'm struggling to understand what a real life use case for Communication Request would be, otherwise.</p>



<a name="243737233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243737233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243737233">(Jun 24 2021 at 03:12)</a>:</h4>
<p>Reading through the resolution on <a href="http://jira.hl7.org/browse/FHIR-32948">FHIR-32948</a> I'm thoroughly puzzled. Saying, "it makes sense to describe a request as ready for action and done but nothing in between" just seems like a gaping logical hole in the state machine. Logically, something happens in between those states.</p>



<a name="243737402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243737402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243737402">(Jun 24 2021 at 03:17)</a>:</h4>
<p>In any case <span class="user-mention" data-user-id="235060">@Grey Faulkenberry</span> you should certainly take Lloyd's advice on this since he's the expert. On this particular subject I am just a detractor yelling into the wind :-)</p>



<a name="243815023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243815023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243815023">(Jun 24 2021 at 16:57)</a>:</h4>
<div class="message_inline_image"><a href="https://media0.giphy.com/media/ScmA88oVeD78aEpd2O/giphy.gif?cid=c623cb352jsqkivcwmf7pziy70om6m9g3evu00lpcijdbhq9&amp;rid=giphy.gif&amp;ct=g"><img src="https://uploads.zulipusercontent.net/70209a2c73c857d994172825091f96e9cd072a52/68747470733a2f2f6d65646961302e67697068792e636f6d2f6d656469612f53636d4138386f566544373861457064324f2f67697068792e6769663f6369643d6336323363623335326a73716b697663776d6637707a697937306f6d366d39673365767530306c7063696a6462687139267269643d67697068792e6769662663743d67"></a></div>



<a name="243815036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243815036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Keeler <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243815036">(Jun 24 2021 at 16:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>  ^^</p>



<a name="243939005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243939005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243939005">(Jun 25 2021 at 16:27)</a>:</h4>
<p>A Request is just an authorization.  By itself, it doesn't drive action.  It just sits there until the author decides (based on other events in the world) that it's done, expired, or otherwise needs to end.  If you want to know what's happening with a Request, you can look at things that reference the Request, but the Request itself doesn't change.  The base rule is "fillers can't edit the placer Request".</p>
<p>If you think about the real world, if a clinician authors a non-directed prescription or referral, no one comes back and edits the record in the ordering system to subsequently 'assign' that order once it gets sent to a specific pharmacy or a dispatch center assigns the referral to a particular care agency.  To see what Observations have been created against a ServiceRequest, you query the Observations.  The ServiceRequest won't point to them.  That ensures that we don't need to update 2 resources when an Event resource comes into play.  The same principle holds when updating status.  Also "in progress" isn't super-useful because "in-progress for what?"  One order could simultaneously be in progress with 3 different fillers, each satisfying a different part.  Task allows us to manage this because we can have a separate Task for each 'chunk'.  Task is a special resource in that it's actually expected to be editable by both placer and filler systems.</p>



<a name="243951919"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243951919" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243951919">(Jun 25 2021 at 18:19)</a>:</h4>
<p>It doesn't matter whether the "filler" or the "requester" is updating the status; a Request <em>can</em> be actively in progress.</p>



<a name="243952049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243952049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243952049">(Jun 25 2021 at 18:20)</a>:</h4>
<p>Just because you can envision scenarios where you wouldn't want to mark it as such isn't a good reason to <em>prevent anyone</em> from marking it as such.</p>



<a name="243970238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243970238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243970238">(Jun 25 2021 at 21:01)</a>:</h4>
<p>Fundamentally, it's not part of the Request model because it's not a status of the authorization - it's a status of the activity happening that's authorized.  We have a deep history of conflating "authorization" status and "execution" status and that causes grief.  In FHIR, we've tried to clearly delineate them to avoid that confusion/grief.  A Request can't have a status of 'accepted' or 'rejected'.  Because regardless of whether a particular filler agrees to fulfill an order, it remains an active order - and in some workflow processes, an order that was rejected by one filler might later be satisfied by another.  The notion of "in progress" is a similar status in that it deals with decisions and actions of the fulfiller, not with the state of the authorization.</p>



<a name="243971593"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243971593" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243971593">(Jun 25 2021 at 21:14)</a>:</h4>
<p>Does the FHIR Workflow pattern describe this (or describe this adequately enough)?</p>
<p><a href="https://www.hl7.org/fhir/workflow.html">https://www.hl7.org/fhir/workflow.html</a></p>



<a name="243973058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243973058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243973058">(Jun 25 2021 at 21:27)</a>:</h4>
<p>It tries.  Whether it's adequate or not, I don't know.  Change requests suggesting improvement are more than welcome</p>



<a name="243975001"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/SMS%20and%20Twilio/near/243975001" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/SMS.20and.20Twilio.html#243975001">(Jun 25 2021 at 21:48)</a>:</h4>
<p>I'm not sure if it's adequate or not; maybe those who are asking the questions about the Communication workflow can answer better.<br>
I also noticed that this page might be helpful too (referenced by workflow page): <a href="https://www.hl7.org/fhir/workflow-communications.html">https://www.hl7.org/fhir/workflow-communications.html</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
