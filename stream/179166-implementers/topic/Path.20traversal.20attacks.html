---
layout: page
title: "FHIR Chat  · Path traversal attacks · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html">Path traversal attacks</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153953291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153953291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Danielle Friend <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153953291">(Apr 19 2018 at 23:05)</a>:</h4>
<p>Has anyone encountered a FHIR client, parser, API managers, etc. that will error if two sequential periods ".." are found in the FHIR url? </p>
<p>My question comes from someone using some sort of middleware which errors if the FHIR id contains two periods in a row ".." - as it considers it a potential path traversal security attack (even though path traversal attacks are "../")</p>
<p>Example read that causes the failure:<br>
<a href="https://baseurl/Patient/Pdiq..dQID" target="_blank" title="https://baseurl/Patient/Pdiq..dQID">https://baseurl/Patient/Pdiq..dQID</a><br>
Where Pdiq..dQID is a patient FHIR id.</p>
<p>I'm curious if others have come across similar checks or if this is a one off case.</p>



<a name="153953292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153953292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Danielle Friend <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153953292">(Apr 19 2018 at 23:05)</a>:</h4>
<p>Where I read about path traversal attacks: <a href="https://www.owasp.org/index.php/Path_Traversal" target="_blank" title="https://www.owasp.org/index.php/Path_Traversal">https://www.owasp.org/index.php/Path_Traversal</a></p>



<a name="153953306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153953306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153953306">(Apr 20 2018 at 00:28)</a>:</h4>
<p>it would be an error if there is a sequential period outside a search parameter value</p>



<a name="153953399"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153953399" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Danielle Friend <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153953399">(Apr 20 2018 at 14:30)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  can you clarify? You're saying - it is valid for a search parameter to have a sequential period. If there are sequential periods elsewhere, that is not allowed.</p>



<a name="153953400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153953400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Danielle Friend <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153953400">(Apr 20 2018 at 14:30)</a>:</h4>
<p>So a read ID with sequential periods is acceptable</p>



<a name="153953407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153953407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Łukasz Dywicki <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153953407">(Apr 20 2018 at 14:57)</a>:</h4>
<blockquote>
<p>So a read ID with sequential periods is acceptable</p>
</blockquote>
<p><span class="user-mention" data-user-id="191914">@Danielle Friend</span>  Path traversal attack is possible if you traverse something which can be navigated with typical path syntax.  FHIR resources are not organized in hierarchy which have predictable nesting levels, in fact there is fhir server root (<code>https://example.com/dstu3/</code>), resource type (<code>Patient</code>) and its identifier (<code>Pdiq</code>). There is no correlation between identifier and server root so you can not move "up" from identifier value to patient. Specification defines what is proper identifier and what should be accepted, in principle switching paths usualy requires slash which will then be interpted by server to go deeper into resource (ie to fetch its historical representation) but not up.<br>
Such kind of attack is very popular for web applications displaying resources located on the disk and in theory, somewhere out there might be a FHIR server implementation which is relying on static files. If it will not parse properly identifiers (specified after resource type) then it will be vulnerable.<br>
However specification itself can not address such things because how identifiers are handled depends on actual provider implementation.</p>



<a name="153953410"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153953410" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153953410">(Apr 20 2018 at 15:04)</a>:</h4>
<p>I don't think the question was whether there's a real risk in terms of how FHIR is designed.  The issue is that an implementation has decided to mitigate the risk of traversal path attacks in general by banning URLs that contain "..".  So the question is whether that's going to create grief.  The answer seems to be "only if you're doing a search and the value of one of your search parameters contains '..'", which seems like a pretty remote edgecase.</p>



<a name="153954860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153954860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Danielle Friend <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153954860">(Apr 27 2018 at 22:13)</a>:</h4>
<p>Exactly <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  - have you heard of any other implementations having a problem with this?</p>



<a name="153954861"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153954861" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Danielle Friend <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153954861">(Apr 27 2018 at 22:18)</a>:</h4>
<p>Because our FHIR patient IDs can have '..' (just as likely as having any 2 characters in a row), there will be cases where any search by patient has '..' in the search query.</p>



<a name="153954865"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153954865" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153954865">(Apr 27 2018 at 23:03)</a>:</h4>
<p>I haven't, but I don't generally play in circles where I would have...</p>



<a name="153954870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153954870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153954870">(Apr 27 2018 at 23:50)</a>:</h4>
<p>because of the way that I process paths, it will not be a problem for me. but I guess if you have a file based server, you'd need to ensure that your server either stopped checking for .. at the first ? or that you didn't create ids with a .. in them</p>



<a name="153955468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153955468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Shekleton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153955468">(May 02 2018 at 20:07)</a>:</h4>
<p>I would expect any identifier in the URL path to be URL encoded. This includes forward slashes, etc</p>



<a name="153956104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Path%20traversal%20attacks/near/153956104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Path.20traversal.20attacks.html#153956104">(May 05 2018 at 04:45)</a>:</h4>
<p>I suspect that your expectations would often not be met. but '.' would not be escaped by any library I know</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
