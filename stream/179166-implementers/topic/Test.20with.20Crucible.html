---
layout: page
title: "FHIR Chat  · Test with Crucible · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html">Test with Crucible</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153975985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153975985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153975985">(Jul 18 2018 at 06:02)</a>:</h4>
<p>When I was using the Crucible to test the conformance of my FHIR implemantation, it showed a message that'Error: Conformance Statement could not be loaded crucible'. Has anyone ever met this issue? (PS:The  CapabilityStatement seems to be fine). Any suggestions?</p>



<a name="153976017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976017">(Jul 18 2018 at 08:57)</a>:</h4>
<p>Is crucible alive?</p>



<a name="153976210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976210">(Jul 19 2018 at 00:30)</a>:</h4>
<p>Yes.</p>



<a name="153976212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976212">(Jul 19 2018 at 00:32)</a>:</h4>
<p><span class="user-mention" data-user-id="196020">@Adam</span> Can you provide a permalink to the result? Crucible generates those for the tests. If the errors occurs before that, please send the URL directly. Attention <span class="user-mention" data-user-id="192576">@Robert Scanlon</span></p>



<a name="153976235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976235">(Jul 19 2018 at 00:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191381">@Jason Walonoski</span>  Do you have harmonisation plans with TestScripts &amp; TouchStone?</p>



<a name="153976236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976236">(Jul 19 2018 at 00:48)</a>:</h4>
<p>I see, TestScript became a part of FHIR - so i think it should be supported by more then one vendor ?!</p>



<a name="153976296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976296">(Jul 19 2018 at 12:16)</a>:</h4>
<p>Crucible supports TestScript. Hell, I was the one who first proposed TestScript resource and added it to the spec in ages long past (<span class="user-mention" data-user-id="191370">@Richard Ettema</span> has long maintained this resource, more credit to him). Not all of our tests are based on TestScript. In fact, a majority of Crucible tests are custom ruby code, but we do support the TestScripts built into the specification. There is currently no support for users providing their own scripts. We also don't support all of Touchstone's scripts. One reason is that we do not support <code>TestScript.rule</code> (<a href="https://www.hl7.org/fhir/testscript-definitions.html#TestScript.rule" target="_blank" title="https://www.hl7.org/fhir/testscript-definitions.html#TestScript.rule">https://www.hl7.org/fhir/testscript-definitions.html#TestScript.rule</a>) because it is essentially a magical escape hatch to run your own custom (and maybe proprietary) code -- which means the interoperability of TestScript resources that use <code>rule</code> is zero.</p>



<a name="153976298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976298">(Jul 19 2018 at 12:19)</a>:</h4>
<p>do you propose that we should limit the rules more stritly?</p>



<a name="153976305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976305">(Jul 19 2018 at 12:26)</a>:</h4>
<p>I don't have a concrete proposal. I have just identified the potential problem. I have tossed out the idea of using FHIR Path or CQL as a standard language for rule... but then you need a data model for requests and responses... and there may be other problems. I haven't thought deeply enough about it yet.</p>



<a name="153976306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976306">(Jul 19 2018 at 12:26)</a>:</h4>
<p>well,we do have a data model for addressing headers with fhirpath - that's already come up.</p>



<a name="153976307"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976307" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976307">(Jul 19 2018 at 12:26)</a>:</h4>
<p>I'd certainly be comfortable saying that the rules must be either fhirpath or queries</p>



<a name="153976308"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976308" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976308">(Jul 19 2018 at 12:28)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="191370">@Richard Ettema</span> should weigh in here, since he has used <code>TestScript.rule</code> much more than I have and has probably a good idea of the uses/edge-cases around it.</p>



<a name="153976309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976309">(Jul 19 2018 at 12:28)</a>:</h4>
<p>indeed that would be a great idea</p>



<a name="153976390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976390">(Jul 19 2018 at 17:00)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, <span class="user-mention" data-user-id="191381">@Jason Walonoski</span>, a couple responses:</p>
<p><strong>Regarding TestScripts and FHIRPath</strong> – FHIRPath support already exists in the TestScript in the following elements:</p>
<ul>
<li><em>TestScript.variable.expression</em> - the FHIRpath expression to evaluate against the source fixture contents that determines the value of this variable</li>
<li><em>TestScript.setup.action.assert.compareToSourceExpression</em> - the FHIRpath expression to evaluate against the source fixture contents that determines the comparison value</li>
<li><em>TestScript.setup.action.assert.expression</em> - the FHIRPath expression to be evaluated against the operation request or response fixture context either as a standalone boolean expression or path to the comparison value</li>
</ul>
<p><strong>TestScript Rules and Rulesets</strong> - The TestScript.rule and TestScript.ruleset elements were introduced in STU3 as a means to provide access to more complex processing logic than could be provided with the basic assert definition. For Touchstone, this allowed us to introduce a Rules Engine to provide this capability where we implemented support for Groovy, XSLT and Schematron. Our main use cases for Rules and Rulesets are supporting conditional asserts based on the system’s CapabilityStatement and conditional aspects of the FHIR specification. All of AEGIS’s TestScripts, rules, and rulesets are open-source and easily accessible from the Touchstone UI by guest users.</p>
<p>As Jason has explained, the rule and ruleset elements have caused an interoperability issue with Crucible. For quite some time I have been thinking about how to best resolve this and have come up with the following proposal for R4:</p>
<p>1. Remove TestScript.rule, TestScript.ruleset, TestScript.setup.action.assert.rule and TestScript.setup.action.assert.ruleset<br>
2. Add new, optional Touchstone-based TestScript extensions to replace the removed TestScript rule and ruleset elements. Proposed new Touchstone extension canonical urls:</p>
<ul>
<li><a href="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-rule" target="_blank" title="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-rule">http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-rule</a></li>
<li><a href="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-ruleset" target="_blank" title="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-ruleset">http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-ruleset</a></li>
<li><a href="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-assert-rule" target="_blank" title="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-assert-rule">http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-assert-rule</a></li>
<li><a href="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-assert-ruleset" target="_blank" title="http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-assert-ruleset">http://touchstone.aegis.net/touchstone/fhir/StructureDefinition/testscript-assert-ruleset</a><br>
As Touchstone-based extensions, other FHIR test engines could then safely ignore them if present in any TestScript instances.</li>
</ul>
<p>Thanks</p>



<a name="153976397"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976397" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976397">(Jul 19 2018 at 17:41)</a>:</h4>
<p>Rather than have them be touchstone specific extensions, they could be HL7 standard extensions.  The notion of wanting to embed Groovy or XSLT tests would presumably be generic.</p>



<a name="153976398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976398">(Jul 19 2018 at 17:41)</a>:</h4>
<p>(Even if not part of the 80%)</p>



<a name="153976412"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976412" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976412">(Jul 19 2018 at 18:20)</a>:</h4>
<p>Regarding changing to extensions... I need to think about this. Are these assertions absolutely necessary for determining if a test passes or fails? If so, making them extensions... doesn't feel completely correct either. If not, then... maybe that's OK.</p>



<a name="153976413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976413">(Jul 19 2018 at 18:22)</a>:</h4>
<p>Thanks for the thorough and thoughtful response <span class="user-mention" data-user-id="191370">@Richard Ettema</span></p>



<a name="153976415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976415">(Jul 19 2018 at 18:26)</a>:</h4>
<p><span class="user-mention" data-user-id="191381">@Jason Walonoski</span>, the (current) definition of an assert is that if any assert fails then the test fails. I don't believe that logic will change if rules and rulesets move to extensions.  (Your welcome ;)</p>



<a name="153976416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976416">(Jul 19 2018 at 18:29)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>, my thinking on making these extensions touchstone specific was not that they would be touchstone specific but rather part of an implementation guide for touchstone. I'm not sure if that makes a difference to whether or not they are HL7 standard extensions.</p>



<a name="153976428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976428">(Jul 19 2018 at 18:50)</a>:</h4>
<p>If the extensions are general purpose and likely to be used by others, define them in HL7.  In your IG, you can declare which ones you support/require.</p>



<a name="153976445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976445">(Jul 19 2018 at 19:41)</a>:</h4>
<p>My question isn't whether or not the test <em>would</em> pass or fail without the extensions (because you are right only the assert matters)... but whether or not the execution of the extension <em>should</em> cause it to pass or fail.</p>
<p>So, in extension-speak, is the rule an <code>extension</code> or would it really be a <code>modifierExtension</code>? I think the answer is the latter. In which case, we're kind of back to square one...</p>



<a name="153976480"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976480" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976480">(Jul 19 2018 at 20:38)</a>:</h4>
<p>no it wouldn't be a modifier extension; they would be extra tests. <span class="user-mention" data-user-id="191370">@Richard Ettema</span> can you provide examples of what you are using these for?</p>



<a name="153976564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Walonoski <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976564">(Jul 19 2018 at 22:20)</a>:</h4>
<p>Well, I would argue that if the rules are required for the test to pass in spirit... for example, the only meaningful and relevant assertion to a test is the rule... then it absolutely would be required, and then it probably ought to be a modifierExtension. Because without knowing that extension, the meaning of the test is different. I realize that is a theoretical argument, but without a lot of concrete examples of where Touchstone uses it, it is hard to eliminate that as a possibility.</p>



<a name="153976603"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976603" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976603">(Jul 19 2018 at 22:38)</a>:</h4>
<p>the definition of modifier extension is very precise now. It might be a modifier but it would also depend on the exact wording of the elements as well</p>



<a name="153976617"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976617" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976617">(Jul 19 2018 at 23:04)</a>:</h4>
<p>A simple example would be verifying an HTTP Header was present if a system supported versioning on a specific resource type. This requires that the system's CapabilityStatement be parsed to determine their declared support for versioning of, say, the Patient resource type. Based on that evaluation, the actual test for, say, the presence of the ETag header can be done or not done (skipped). To simplify this logic we can first test if the ETag header was not present because if it is, then there is no need to test for versioning support.</p>
<p>So, the resulting rule logic that would perform the above "assert" looks like this:</p>
<div class="codehilite"><pre><span></span>if (response.header(&#39;ETag&#39;).empty()) // only check capStmt if ETag not present
{
    boolean supports = supportsViaFhirPath(
        &quot;rest.where(mode.value=&#39;server&#39;).resource.where(type.value=&#39;Patient&#39;).versioning&quot;,
        &quot;versioned,versioned-update&quot;, &quot;in&quot;, &quot;Patient versioning&quot;, serverCapStmt);

    assert !supports: &quot;ETag header expected but not found when Patient versioning is supported by server capability statement&quot;;
}
</pre></div>



<a name="153976619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976619">(Jul 19 2018 at 23:06)</a>:</h4>
<p>so we could do all that with FHIRPath assertions</p>



<a name="153976620"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976620" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976620">(Jul 19 2018 at 23:08)</a>:</h4>
<p>The FHIRPath expression would need access to both the system's CapabilityStatement and the executed operation context.</p>



<a name="153976622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976622">(Jul 19 2018 at 23:08)</a>:</h4>
<p>yes, but that seems a pretty minimal thing to achieve. %capabilities and %operation, for exaple</p>



<a name="153976624"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976624" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976624">(Jul 19 2018 at 23:11)</a>:</h4>
<p>Ok.  But FHIRPath today does not  have those.</p>



<a name="153976625"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976625" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976625">(Jul 19 2018 at 23:12)</a>:</h4>
<p>those are context variables defined where FHIRPath is used. So you just have to say 'these context variables are defined' in TestScript, and then you can use them</p>



<a name="153976697"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976697" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976697">(Jul 20 2018 at 00:08)</a>:</h4>
<p>Ok. Assuming I get the context variables %capabilities and %operation defined such that our FHIR test engine undertand how to send them to our FHIRPath engine and get our FHIRPath engine to understand them, I can see the equivalent FHIRPath expression as something like this:</p>
<div class="codehilite"><pre><span></span>(%capabilities.rest.where(mode.value=&#39;server&#39;).resource.where(type.value=&#39;Patient&#39;).versioning in &#39;versioned,versioned-update&#39;) and (%operation.response.header(&#39;ETag&#39;).notEmpty())
</pre></div>


<p>Something to keep in mind with this approach is that in order to support interoperability between FHIR test engines the definition and use of these context variables, %capabilities and %operation, will need become part of the specification which forces all FHIR test engines to support them. That make this feel like the current issue we have with rule and ruleset.</p>



<a name="153976700"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976700" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976700">(Jul 20 2018 at 00:18)</a>:</h4>
<p>The issue is a little more problematic regarding the %capabilities context variable. The TestScript allows for multiple actors, both client and server, in the defined tests. We would need to support a %capabilities variable for each actor; e.g. %capablities1, %capabilities2, etc.</p>



<a name="153976705"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153976705" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153976705">(Jul 20 2018 at 00:34)</a>:</h4>
<p>well, more likely it's a collection you can use where with or something. but anyway, passing variables to the FHIR path engine is core FHIR Path functionality, so it should not require an update to the engine</p>



<a name="153977180"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Test%20with%20Crucible/near/153977180" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Test.20with.20Crucible.html#153977180">(Jul 23 2018 at 06:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191381">@Jason Walonoski</span>  I've sent you the url :grin:</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
