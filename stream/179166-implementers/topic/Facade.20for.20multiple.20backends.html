---
layout: page
title: "FHIR Chat  · Facade for multiple backends · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html">Facade for multiple backends</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153921004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921004">(Nov 22 2017 at 12:04)</a>:</h4>
<p>Suppose I have a facade/gateway FHIR server that serves multiple backends. Suppose I sometimes want to get data from "all" systems, and sometimes want to get data from "a specific system".</p>
<p>In our case we would have a facade on our national spine serving FHIR for thousands of systems. The normal current setup for query would be that you ask for e.g. MedicationDispense irrespective of where the data comes from and the national spine would look up where data is and return data from all relevant places. However we also want to support MedicationDispense specifically from systemA.</p>
<p>We see two options:</p>
<ul>
<li>RESTful:                     [base]/systemA/...</li>
<li>Query parameter: [base]/...?_endpoint=systemA</li>
</ul>
<p>Anybody else looked at this and how did you solve that?</p>
<p><span class="user-mention" data-user-id="194863">@reli</span>, <span class="user-mention" data-user-id="191834">@Tom de Jong</span>, <span class="user-mention" data-user-id="191757">@Christiaan Knaap</span></p>



<a name="153921005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921005">(Nov 22 2017 at 12:07)</a>:</h4>
<p>Certainly did not solve it already. Both approaches will require some custom handling as it is not defined in FHIR itself. As for Vonk, Query parameter is a bit better fit to Vonk's programming model.<br>
A thorough approach might be using Provenance for this.</p>



<a name="153921010"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921010" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Theo Stolker <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921010">(Nov 22 2017 at 12:40)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191375">@Alexander Henket</span> ,</p>
<p>One part I do not see addressed in your question, but I believe you have to do for the cross-system query is make sure that every resource returned is decorated with a tag that indicates from which system the resource was returned.</p>
<p>Once you have done that, I think the logical solution would be to query for the system specific tag (or tags) when you want to filter data from a subset of systems.</p>



<a name="153921011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Theo Stolker <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921011">(Nov 22 2017 at 12:44)</a>:</h4>
<p>Oh, and just to be sure, if you define your own query parameters, make sure these do not start with an underscore, that is reserved for system parameters!</p>



<a name="153921015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921015">(Nov 22 2017 at 13:12)</a>:</h4>
<p>I think I quite like the elegance of querying for a tag. Would that be something for Vonk too <span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> ?</p>



<a name="153921031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921031">(Nov 22 2017 at 14:19)</a>:</h4>
<p>this would be another use for Resource.meta.source (which I proposed in a different topic here, which would be a url)</p>



<a name="153921123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921123">(Nov 22 2017 at 21:45)</a>:</h4>
<p>(which is also not in the current builds right?)</p>



<a name="153921124"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921124" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921124">(Nov 22 2017 at 21:46)</a>:</h4>
<p>I'm also considering implementing this, which in my case is a federator.</p>



<a name="153921141"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921141" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921141">(Nov 22 2017 at 23:32)</a>:</h4>
<p>yes not in current build</p>



<a name="153921240"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921240" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921240">(Nov 23 2017 at 09:11)</a>:</h4>
<p>Does that work for push too? I.e. could I POST something to a specific backend the same way?</p>



<a name="153921244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921244">(Nov 23 2017 at 09:23)</a>:</h4>
<p>The standard Vonk server does not behave this way, but I think the architecture makes this very well possible. 'Federation' - on the todo list :-)</p>



<a name="153921248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921248">(Nov 23 2017 at 09:29)</a>:</h4>
<p>you could make it so. Server decision.</p>



<a name="153921249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921249">(Nov 23 2017 at 09:29)</a>:</h4>
<p>I added Resource.meta.source to R4 so people can look see, btw</p>



<a name="153921251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921251">(Nov 23 2017 at 09:57)</a>:</h4>
<p>For push: would you not need Resource.meta.target (too)</p>



<a name="153921252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921252">(Nov 23 2017 at 09:58)</a>:</h4>
<p>How would Resource.meta.source|target stack up against FHIR Messaging? If you do FHIR Messaging: do you still need Resource.meta.source|target?</p>



<a name="153921253"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921253" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921253">(Nov 23 2017 at 09:59)</a>:</h4>
<p>target is wrong. that's a messaging view; set it to source to say what it will be</p>



<a name="153921262"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921262" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921262">(Nov 23 2017 at 11:01)</a>:</h4>
<p>So source behaves as "targetSource" then. I get it now you explained it, but be prepared to explain this over and over again. When I push something to a specific system, then for all sense and purposes that is form of messaging, regardless of it being RESTful or FHIR Messaging. <br>
Normally the endpoint is enough as target system. With a gateway/facade it might not be. Calling that target system "source" feels counter intuitive</p>



<a name="153921263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921263">(Nov 23 2017 at 11:02)</a>:</h4>
<p>well, messaging and rest are not the same, and this is one area of difference. In a message, if you wanted to specify a target, you'd use Bundle.entry.link</p>



<a name="153921266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921266">(Nov 23 2017 at 11:38)</a>:</h4>
<p>That works if it is a Bundle you are sending</p>



<a name="153921267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921267">(Nov 23 2017 at 11:42)</a>:</h4>
<p>But more importantly: some unification in how to handle this would be nice. So if the Resource.meta.source is "the thing", then I would not use Bundle.entry.link anymore, but the Bundle.meta.source or Bundle.entry.Resource.meta.source. (the last one only if I somehow try to upload a Bundle where different entries target different systems, but that sounds really funky)</p>



<a name="153921268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921268">(Nov 23 2017 at 11:46)</a>:</h4>
<p>In looking at <a href="http://build.fhir.org/resource-definitions.html#Meta.source" target="_blank" title="http://build.fhir.org/resource-definitions.html#Meta.source">http://build.fhir.org/resource-definitions.html#Meta.source</a> it currently does not feel suited for use when I want to say "Hey gateway, please hand this resource to system X".</p>
<p>Current wording<br>
<em>Identifies the system that is the source of the information in this resource.</em></p>
<p>When I push something, it feels like the way to tell the other end something about me as sender.</p>



<a name="153921269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921269">(Nov 23 2017 at 12:05)</a>:</h4>
<p>in messaging, you will have a bundle, and you should still use Bundle.entry.link.</p>



<a name="153921270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921270">(Nov 23 2017 at 12:06)</a>:</h4>
<p>in REST, you are telling the server to 'make it so' - and so when it makes the source so, it talks to the system you identify as the source</p>



<a name="153921271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921271">(Nov 23 2017 at 12:07)</a>:</h4>
<p>For the record: we're doing RESTful, not Messaging.</p>



<a name="153921272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921272">(Nov 23 2017 at 12:08)</a>:</h4>
<p>The behavior of POST-ing a Bundle to an endpoint with meta.source, telling the server "make it so" identifying the meta.source as intended target, just is not something I can wrap my head around</p>



<a name="153921273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921273">(Nov 23 2017 at 12:08)</a>:</h4>
<p>Could be my limitation</p>



<a name="153921275"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921275" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921275">(Nov 23 2017 at 12:14)</a>:</h4>
<p>Trying again.</p>
<p><strong>Use case 1</strong>: I want to query a specific endpoint 903 through an intermediary gateway</p>
<div class="codehilite"><pre><span></span>GET [base]/Condition?_tag=http://aorta-zorg.nl/apps|903
</pre></div>


<p><strong>Use case 2</strong>: I want to push contents to a specific endpoint 903 through an intermediary gateway</p>
<div class="codehilite"><pre><span></span>POST [base]/Condition?_tag=http://aorta-zorg.nl/apps|903
</pre></div>


<p>Use case 1 would not have an HTTP body. Use case 2 would have an HTTP body where the *.meta.source would be <em>my system</em>. The reason for that is that my system might also be behind a gateway for multiple systems making it less obvious which system is pushing data.</p>



<a name="153921327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921327">(Nov 23 2017 at 20:38)</a>:</h4>
<p>so the second is not valid following the spec. but as I say, if you were using source:</p>
<div class="codehilite"><pre><span></span>GET [base]/Condition?_source=http://aorta-zorg.nl/apps/903

POST [base]/Condition

&lt;[Resource]&gt;
  &lt;meta&gt;
    &lt;source value=&quot;http://aorta-zorg.nl/apps/903&quot;/&gt;
  &lt;/meta&gt;
&lt;/[Resource]&gt;
</pre></div>



<a name="153921328"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921328" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921328">(Nov 23 2017 at 20:39)</a>:</h4>
<p>the second is saying: set the state of this new resource as if source was <a href="http://aorta-zorg.nl/apps/903" target="_blank" title="http://aorta-zorg.nl/apps/903">http://aorta-zorg.nl/apps/903</a>. The server makes it so - which in this case, means, posting it through to the <a href="http://aorta-zorg.nl/apps/903" target="_blank" title="http://aorta-zorg.nl/apps/903">http://aorta-zorg.nl/apps/903</a> server</p>



<a name="153921333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921333">(Nov 23 2017 at 20:51)</a>:</h4>
<p>How would I then tell the target system that some of my contents came from source A and others from source B if the meta.source cannot be used for that because it is repurposed to mean target?</p>



<a name="153921334"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921334" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921334">(Nov 23 2017 at 20:56)</a>:</h4>
<p>it's not repurposed. If you've moved the goal posts to mean that some of the content of a resource comes from one server, and some from another, and the client needs to know about the derivation, then I don't think there's a solution in RESTful for you. And it sounds like a bad idea</p>



<a name="153921335"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921335" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921335">(Nov 23 2017 at 20:56)</a>:</h4>
<p>Provenance?</p>



<a name="153921336"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921336" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921336">(Nov 23 2017 at 20:57)</a>:</h4>
<p>maybe. for reads. Sounds like a really difficult thing for post. though it's just going to be difficult anyway.</p>



<a name="153921337"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921337" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921337">(Nov 23 2017 at 20:58)</a>:</h4>
<p><strong>Use case 1</strong>: I want to query a specific endpoint 903 through an intermediary gateway</p>
<div class="codehilite"><pre><span></span>GET [base]/Condition?_source=http://aorta-zorg.nl/apps/903
</pre></div>


<p><strong>Use case 2</strong>: I want to push contents to a specific endpoint 903 through an intermediary gateway</p>
<div class="codehilite"><pre><span></span>POST [base]/Condition

&lt;[Resource]&gt;
  &lt;meta&gt;
    &lt;source value=&quot;http://aorta-zorg.nl/apps/903&quot;/&gt;
  &lt;/meta&gt;
&lt;/[Resource]&gt;
</pre></div>


<p><span class="user-mention" data-user-id="192814">@Theo Stolker</span>, <span class="user-mention" data-user-id="194863">@reli</span>, <span class="user-mention" data-user-id="191757">@Christiaan Knaap</span>, <span class="user-mention" data-user-id="191834">@Tom de Jong</span>  Thoughts? Objections? Support? Since we need it in STU3 we probably need a tag for it, but that can be arranged</p>



<a name="153921358"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921358" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921358">(Nov 24 2017 at 00:52)</a>:</h4>
<p>The source to me has nothing to do with messaging, its about where the original content came from (very useful in curated or federated content)<br>
Its not asking it to go somewhere, its a little on its heritage (and the provenance will have the full detail) I'd like to see this as multi-cardinality if there were multiple contributors to the content. Just a thought though.</p>



<a name="153921361"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921361" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921361">(Nov 24 2017 at 01:12)</a>:</h4>
<p>I deliberately made it singular, even though a resource might have multiple sources, because there's real complexity there</p>



<a name="153921363"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921363" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921363">(Nov 24 2017 at 01:18)</a>:</h4>
<p>Great, thanks.</p>



<a name="153921401"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921401" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921401">(Nov 24 2017 at 05:45)</a>:</h4>
<p>How does this tie in with a metadata registry (a record locator) like the Dutch LSP or IHE XDS ? I'd like to see seamless integration with those in case we need to do GET [base]/Bundle/[x]?_source=yyyyyyyyyy or GET [base]/Binary/[x]?_source=yyyyyyy.  Normally I'd expect the record locator to work out where something is (and hide it from me when GETting), but there may be use cases where one wishes to explicitly request a specific application.</p>
<p>And you'd better use Provenance when doing POST in this context (i.e. always post a Bundle inclusive of Provenances), otherwise one will have no clue as to who was responsible for the posted content. Create Graphdefinition that states that each posted resource SHALL have an associated Provenance resource.</p>



<a name="153921462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921462">(Nov 24 2017 at 12:40)</a>:</h4>
<p>René this whole thing is exactly about the LSP/AORTA and the FHIR Facade that will be in front of thousands of systems and potentially all XDS regions too. The usual query on the LSP/AORTA does not have any target system: the LSP figures out where stuff is and queries them all on your behalf and finally Bundles it all up in 1 single Response Bundle to you. The Bundle contains enough information to determine which information came from which system (all in V3). </p>
<p>Translating that to FHIR could amount to a Bundle of Bundles where each sub-Bundle is marked with meta.source and/or Provenance. We could use Provenance too to carry the V3 payload at least for debugging scenarios.</p>
<p>The reason I'm asking is because in the MedMij PHR scenarios we anticipate PHRs will want to target specific systems for a query after receiving a notification for a running subscription. Also PHRs will want to push observations from devices to specific systems. Hence use case 1 and 2</p>
<p>GraphDefinition is something someone once asked us about and I've not looked at that yet. I doubt many people will know what to do with it, but I might be wrong.</p>
<p>Grahame/Brian, if meta.source sometimes is "the source", and sometimes is "the intended future source" (aka "target" in my vocabulary), it is not going to work for me. It should be the one or the other.</p>



<a name="153921467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921467">(Nov 24 2017 at 12:51)</a>:</h4>
<div class="codehilite"><pre><span></span>The source to me has nothing to do with messaging, its about where the original content came from (very useful in curated or federated content)
Its not asking it to go somewhere, its a little on its heritage (and the provenance will have the full detail)
</pre></div>


<p>Fully agree. meta.source is about origin. Grahame however extended that notion to include additional semantics upon posting data. In posting data, now the meta.source means "please make it so that the source is X". This is not what I want to accomplish. I want my data to be routed to a particular system that is behind the facade that is my initial endpoint.</p>
<p>Maybe compare my situation with Aegis Touchstone: unless I send an HTTP header carrying my organizational/personal (API) key, the system will not know what party is testing and will not know how to route the incoming data.</p>



<a name="153921469"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921469" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921469">(Nov 24 2017 at 12:52)</a>:</h4>
<p>I would have never expected the source to be a target. To me this property should be for where the content came from. anything further should be in provenance.</p>



<a name="153921470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921470">(Nov 24 2017 at 12:55)</a>:</h4>
<p>Ok so this</p>
<div class="codehilite"><pre><span></span>GET [base]/Condition?_source=http://aorta-zorg.nl/apps/903
</pre></div>


<p>Only works if the only system serving Conditions from source 903 is in fact system 903 itself. Suppose a second system would be serving data from 903 we would be getting multiple responses. This is not allowed on the LSP/AORTA. Thusfar you may only serve contents that you are owner of</p>



<a name="153921471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921471">(Nov 24 2017 at 12:57)</a>:</h4>
<p>Nonetheless it seems that source is not our thing then and we're better off creating a custom meta.tag for it. All still assuming that using a tag could work for Vonk (<span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> ), HAPI-FHIR (<span class="user-mention" data-user-id="191319">@James Agnew</span>) and other facades as a means to address a system behind the facade.</p>
<p>An alternative is something along the lines of the facade hosting endpoints per backend system, and a public/generic endpoint. So</p>
<div class="codehilite"><pre><span></span>GET https://aorta-zorg.nl/allapps/fhir/3.0.1/
GET https://aorta-zorg.nl/app/903/fhir/3.0.1/
GET https://aorta-zorg.nl/app/904/fhir/3.0.1/
GET https://aorta-zorg.nl/app/904/fhir/4.0.0/
</pre></div>


<p>You would host thousands of endpoints like that.</p>



<a name="153921487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Theo Stolker <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921487">(Nov 24 2017 at 14:24)</a>:</h4>
<p><span class="user-mention" data-user-id="191375">@Alexander Henket</span> , looks great, I'll support this! And I meant that on your earlier post about the use of meta.source :)</p>



<a name="153921497"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921497" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921497">(Nov 24 2017 at 14:34)</a>:</h4>
<p>you're just not doing RESTful stuff when you describe it this way, and so you're finding that the RESTful interface can't do this. I'm not finding that surprising</p>



<a name="153921498"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921498" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921498">(Nov 24 2017 at 14:35)</a>:</h4>
<p>"Grahame/Brian, if meta.source sometimes is "the source", and sometimes is "the intended future source" (aka "target" in my vocabulary), it is not going to work for me. It should be the one or the other." - but no, you're misunderstanding. It's always the source. But when you put the resource to the server, you are asserting that in it's new state, this is now the source.</p>



<a name="153921499"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921499" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921499">(Nov 24 2017 at 14:37)</a>:</h4>
<p>I.e. In the old version of the Patient instance, demographics came from system X, but I've updated the instance so the demographics now come from system Y which I believe to be more authoritative.</p>



<a name="153921578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921578">(Nov 25 2017 at 21:28)</a>:</h4>
<p>I totally get how you intended it Grahame/Lloyd. I just don't agree with the idea. I was not at the point where we had a solution. I was at a point where we were looking for one. Turns out the problem is lesser known territory than I thought I would be.</p>
<p>Being purely RESTful would mean those thousands of endpoints. That way it is as if I'm talking to the system itself even if it is a facade serving for those thousands of systems. Works for both push and pull.</p>
<p>We however thought that would be unpractical. Secondly most queries would probably still go to the generic endpoint targeting <em>all</em> systems and then the response would need markers to indicate source. For that purpose, the meta.source just might be a reasonable thing, but since we might use Provenance for more details anyway, the meta.source then seems redundant. </p>
<p>Still hoping to hear from <span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> about what seems reasonable for Vonk considering I understand Vonk is a likely candidate to <em>be</em> the facade we're discussing.</p>



<a name="153921580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921580">(Nov 25 2017 at 22:33)</a>:</h4>
<p>What about the idea do you disagree with?  Even if we don't have "source", each version of a resource can have a distinct source from a Provenance perspective.  Source can't really disagree with Provenance.</p>



<a name="153921583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921583">(Nov 26 2017 at 09:22)</a>:</h4>
<p>I think source  should be just <em>source</em>, or as Brian put it <em>origin</em>. When you offer data to a server you are telling the server where it came from, not where you want that data to to come from in the future.</p>
<p>I can understand how you would like the result of your upload to be that some receiving system needs to be the new authorative source after processing what you have sent. But that is about the intention of your upload, not about <em>origin</em> at time of upload. The intention of your upload (just store, act on the data, accept you are now the new source of the data) is what messaging is about, the dynamic model if you will. Meta.source does not do for that purpose.</p>
<p>You are right that Provenance and meta.source bear overlap, which is why said that when you have Provenance which carries much more information, the meta.source seems redundant.</p>



<a name="153921610"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921610" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921610">(Nov 26 2017 at 20:45)</a>:</h4>
<p>Ok - that's my understanding of how "source" would work - it mirror's provenance.  It tells the source of a create or update.  It has nothing to do at all with where the data will be stored.  There's no mechanism in FHIR to direct data to a specific storage location beyond the URL you POST/PUT to.</p>



<a name="153921611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921611">(Nov 26 2017 at 20:45)</a>:</h4>
<p>The primary use-case for meta.source is so you don't have to retrieve a copy of the provenance to know where the data came from.</p>



<a name="153921614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921614">(Nov 26 2017 at 22:39)</a>:</h4>
<p>And likely to know that there is a provenance of significance.</p>



<a name="153921615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921615">(Nov 26 2017 at 22:44)</a>:</h4>
<p>well, there's multiple reasons why you could populate source but not create a provenance</p>



<a name="153921622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921622">(Nov 27 2017 at 06:48)</a>:</h4>
<p>I'm looking for a solution to address a system behind a facade in a RESTful way. I'm aware that what I ask has not been done before, but it is not possible that the problem didn't exist yet: Vonk and HAPI are or will be used in front of many systems.</p>
<p>Grahame told me meta.source exists as-of R4, but meta.source does not have the semantics I'm looking for. That doesn't make meta.source the solution, but it doesn't make the problem go away either.</p>
<p>So maybe a step back: do we at least share the idea that the problem as stated is relevant to solve?</p>



<a name="153921623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921623">(Nov 27 2017 at 07:30)</a>:</h4>
<p>you can't ask for a RESTful solution, and then reject a RESTful solution. What are you looking for here? Do you really want a single RESTful facade to a bunch of servers such that the client doesn't need to worry about the bunch of servers in the background?</p>



<a name="153921634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921634">(Nov 27 2017 at 10:28)</a>:</h4>
<p>won't we all :D</p>



<a name="153921649"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153921649" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153921649">(Nov 27 2017 at 14:32)</a>:</h4>
<p>Let me see if I can summarize your issue - you don't really want a "facade" - as the client will know - must know in fact - that there are multiple servers.  But the client won't know the address of any of those servers.  Instead they talk to a single aggregating endpoint and POST to that endpoint but somehow communicate to the endpoint what server they want the result sent to.  Is that accurate <span class="user-mention" data-user-id="191375">@Alexander Henket</span>?</p>



<a name="153922008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922008">(Nov 29 2017 at 08:37)</a>:</h4>
<p>Sorry for the delay. Discussed it a bit with <span class="user-mention" data-user-id="191363">@Vadim Peretokin</span> as well.<br>
The easiest solution in our opinion is to design a custom search parameter for this, probably on Resource (let's say 'fromsource').<br>
After that in the Facade implementation you can handle this parameter by limiting the queries to the backend systems to just that source.<br>
It would then - with a little extra work - even be possible to extract this searchparameter from the path as you suggested above, but it may be easier for clients to just add the searchparameter (&amp;fromsource=903).</p>



<a name="153922062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922062">(Nov 29 2017 at 15:22)</a>:</h4>
<p>Reminds of me of a v3 discussion around messaging, one that we never managed to wrap up because consensus could simply not be reached. Trying to influence the delivery of messages beyond the designated end-point (here: the Facade) leads to lots of issues.</p>
<p>Anyways: I can see the use case for wishing a subset of systems (perhaps only 1) instead of asking the Facade to forward the query to all. But in terms of addressing I would not want to use a system URL, but an organization Id or even a healthcare Practitioner Id. They may move their data from one repository to another one, the author stays the same.  Kind of a GET [base]Condition?_has:Provenance:agent.identifier=903 (that's probably not valid, but you get the idea). The Facade has to be smart enough to resolve that 'agent.identifier' into a URL (or a set of URLs in case that agent uses multiple repositories).</p>



<a name="153922065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922065">(Nov 29 2017 at 15:25)</a>:</h4>
<p>I think it's wrong to claim that it's a 'facade' if the client has to know anything about it</p>



<a name="153922066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922066">(Nov 29 2017 at 15:25)</a>:</h4>
<p>if the client has to know about it, I think 'agent' is the right word</p>



<a name="153922137"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922137" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922137">(Nov 29 2017 at 18:56)</a>:</h4>
<p>Yes that’s accurate Lloyd</p>
<p>After some back n forth we’ll go with a url based solution for the first test drive and decide from there if we need something different. The url will be something like</p>
<p><a href="https://aorta-zorg.nl/fhir/[fhirVersion]/apps/[appId]" target="_blank" title="https://aorta-zorg.nl/fhir/[fhirVersion]/apps/[appId]">https://aorta-zorg.nl/fhir/[fhirVersion]/apps/[appId]</a></p>
<p>This is fully RESTful and is comparable to a 1-to-1 facade/system solution. </p>
<p>Since the URLs are all registered in the national system/endpoint registry the discovery is no biggie.</p>



<a name="153922138"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922138" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922138">(Nov 29 2017 at 19:02)</a>:</h4>
<p>The question to find the right endpoint is “get me endpoints for organization X that support application role Y”. As we have application role based certification in place for systems for them to be recognized on the network that will work. Questions like “what’s the uri for getting the medication from my pharmacy” could be answered with <a href="https://aorta-zorg.nl/fhir/3.0.1/apps/903/" target="_blank" title="https://aorta-zorg.nl/fhir/3.0.1/apps/903/">https://aorta-zorg.nl/fhir/3.0.1/apps/903/</a>.</p>



<a name="153922139"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922139" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922139">(Nov 29 2017 at 19:05)</a>:</h4>
<p>Grahame: maybe the word facade isn’t entirely accurate but it’s close enough I think. It’s a FHIR entrance to a non-FHIR network of servers</p>



<a name="153922140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922140">(Nov 29 2017 at 19:09)</a>:</h4>
<p>René/Vadim/Christiaan: a query param based solution is still on the table, but we had to make an initial decision before December 1 to start trialing with and landed on url. We’ll know within 7 months what the final answer will be during the big test drive of it all</p>



<a name="153922142"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922142" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922142">(Nov 29 2017 at 19:14)</a>:</h4>
<p>Thanks all for your valuable input. I’ll post updates on the experience, good or bad, here for those interested</p>



<a name="153922146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922146">(Nov 29 2017 at 20:03)</a>:</h4>
<p>Intermediary</p>



<a name="153922147"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922147" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922147">(Nov 29 2017 at 20:04)</a>:</h4>
<p>Conductor</p>



<a name="153922379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922379">(Nov 30 2017 at 20:58)</a>:</h4>
<p>Intermediary I'd go for.<br>
For me the facade hides all the details of operation behind it.</p>



<a name="153922995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922995">(Dec 05 2017 at 16:20)</a>:</h4>
<p><span class="user-mention" data-user-id="191375">@Alexander Henket</span> I should add that we're doing pretty much the same thing, IIUC: using a FHIR API as frontend for multiple backing systems. In our case, each system has what we call a facade that sits between the frontend and the non-FHIR system.</p>



<a name="153922996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922996">(Dec 05 2017 at 16:21)</a>:</h4>
<p>Though we envision some future systems will implement the FHIR API directly and can be used without a facade.</p>



<a name="153922997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922997">(Dec 05 2017 at 16:26)</a>:</h4>
<p>Good to know thanks <span class="user-mention" data-user-id="193772">@Mattias Flodin</span><br>
<span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> I would say that the url thing actually gives every backend system its own ‘front door’. So every front door then qualifies as facade while the whole ‘house with all front doors’ or ‘host of facades’ might go by a different name conceptually.</p>



<a name="153922998"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153922998" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153922998">(Dec 05 2017 at 16:30)</a>:</h4>
<p>We call that the service platform. It also contains a messaging system outside of the FHIR scope, that allows systems to broadcast events to other systems.</p>



<a name="153923034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153923034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153923034">(Dec 05 2017 at 19:00)</a>:</h4>
<p>at the Australian connectathon yesterday we were using the term 'federation'</p>



<a name="153923303"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153923303" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153923303">(Dec 07 2017 at 08:35)</a>:</h4>
<p>And I implemented a simple POC to cover some of the issues that may satisfy the needs in the specific context. It's only a partial implementation, but does show some useful stuff<br>
<a href="https://github.com/brianpos/FhirFederation" target="_blank" title="https://github.com/brianpos/FhirFederation">https://github.com/brianpos/FhirFederation</a></p>



<a name="153924746"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153924746" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johan Eltes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153924746">(Dec 13 2017 at 14:46)</a>:</h4>
<blockquote>
<p>René this whole thing is exactly about the LSP/AORTA and the FHIR Facade that will be in front of thousands of systems and potentially all XDS regions too. The usual query on the LSP/AORTA does not have any target system: the LSP figures out where stuff is and queries them all on your behalf and finally Bundles it all up in 1 single Response Bundle to you. The Bundle contains enough information to determine which information came from which system (all in V3). </p>
<p>Translating that to FHIR could amount to a Bundle of Bundles where each sub-Bundle is marked with meta.source and/or Provenance. We could use Provenance too to carry the V3 payload at least for debugging scenarios.</p>
<p>The reason I'm asking is because in the MedMij PHR scenarios we anticipate PHRs will want to target specific systems for a query after receiving a notification for a running subscription. Also PHRs will want to push observations from devices to specific systems. Hence use case 1 and 2</p>
<p>GraphDefinition is something someone once asked us about and I've not looked at that yet. I doubt many people will know what to do with it, but I might be wrong.</p>
<p>Grahame/Brian, if meta.source sometimes is "the source", and sometimes is "the intended future source" (aka "target" in my vocabulary), it is not going to work for me. It should be the one or the other.</p>
</blockquote>
<p>Interesting. It seems we (Sweden) and Netherlands have the same national HIE architecture. We are however - not yet into FHIR, but are shaping up our plans. In management- and professional settings, we sometimes use the term "Virtual EHR" to label our concept of federation. It also reflects that we do not open up for end-to-end coupling by requiring clients to know / create dependencies to the system topology behind the "facade". We also have the exception of using "source system targeting" when responding to record locator event subscriptions. Since the event betrays the source of the event. We don't have XDE in the picture, though. Would be interesting to meet and share thoughts and strategies for national FHIR migration.</p>



<a name="153926364"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153926364" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153926364">(Dec 20 2017 at 00:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> 404 on <a href="https://github.com/brianpos/FhirFederation" target="_blank" title="https://github.com/brianpos/FhirFederation">https://github.com/brianpos/FhirFederation</a> - think you meant <a href="https://github.com/brianpos/FhirFederator" target="_blank" title="https://github.com/brianpos/FhirFederator">https://github.com/brianpos/FhirFederator</a></p>



<a name="153926365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153926365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153926365">(Dec 20 2017 at 00:24)</a>:</h4>
<p>This feature: <em>Aggregated CapabilityStatement</em> seems to me to be particularly tricky; how do you merge them?</p>



<a name="153926366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153926366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153926366">(Dec 20 2017 at 00:35)</a>:</h4>
<p>Yes, that's right, thanks <span class="user-mention" data-user-id="191343">@Michael Lawley</span></p>



<a name="153926411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Facade%20for%20multiple%20backends/near/153926411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Facade.20for.20multiple.20backends.html#153926411">(Dec 20 2017 at 04:35)</a>:</h4>
<p>That aggregated CapabilityStatement is a work in progress.<br>
Its using the first as a template, then grafting in the others with an extension to indicate which services support which bits.<br>
(need to do that for the search params too)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
