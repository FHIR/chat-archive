---
layout: page
title: "FHIR Chat  · xsd not valid · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html">xsd not valid</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="245788267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245788267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> V.Cuvelier <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245788267">(Jul 13 2021 at 07:39)</a>:</h4>
<p>Hi,</p>
<p>I hope you are doing well today.<br>
I must work in data integration on new project. The goal is the validation of all input flows using the FHIR norme v4.0.1.<br>
I work with Websphere Transformation extender (IBM technology) and I am not familiar with the normative FHIR.<br>
I download all xsd (v4.0.1: R4 - Mixed Normative and STU) on the official web page <a href="http://hl7.org/fhir/downloads.html">http://hl7.org/fhir/downloads.html</a>.</p>
<p>1) I have an error while I try to import these xsd because there are not valid. The problem occurs for example on claim.xsd, fhir-base.xsd but lot of xsd are concerned by this problem. Following the error message, there is a problem with a reference of a type or a missing reference. You can find all errors that I encountered in the attachment report.txt. <a href="/user_uploads/10155/7cqub9iLAm9m60fm7ZCpn3Cd/report.txt">report.txt</a></p>
<p>2) Despite this problem, I found also this disclaimer in the xsd file :</p>
<p>Implementers will still need to be familiar with the content of the specification and with any profiles that apply to the resources in order to make a conformant implementation.<br>
So, it means that the validation is a partial validation? I see that a validator exist in Java. This module is mandatory for the validation of the data? </p>
<p>3) I see also in the downloaded zip, some files with extension sch. Do you know what is the usage of these files?</p>
<p>If you have any advice, I'm more than interested.<br>
Thank you very much in advance</p>
<p>Valentin Cuvelier</p>



<a name="245803811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245803811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245803811">(Jul 13 2021 at 10:19)</a>:</h4>
<p>sch files are schematrons, an xml assertion language. They add some extra checks that xsd cannot do.</p>



<a name="245804107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245804107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245804107">(Jul 13 2021 at 10:22)</a>:</h4>
<p>Re 2, yes, and all validation is partial validation ;-) But xsd is mainly for validating the broad structure, and cannot check all your codes and business rules. But that doesn't mean they are not helpful, especially when working with XML by hand.</p>



<a name="245804413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245804413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245804413">(Jul 13 2021 at 10:24)</a>:</h4>
<p>The java validator is an alternative to the xsds, and is more complete. But may be less convenient - it depends what you are trying to do.</p>



<a name="245804672"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245804672" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245804672">(Jul 13 2021 at 10:26)</a>:</h4>
<p>Your #1 is different. Let us know what the error is. The schemas should work ok, whether or not they are what you need. Some code complains about circular references, but it is actually legal.</p>



<a name="245805950"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245805950" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> V.Cuvelier <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245805950">(Jul 13 2021 at 10:40)</a>:</h4>
<p>Hi Rik,</p>
<p>Thanks for your answer. It is more clear for me for point 2 and 3.<br>
For first point, I try to validate the claim.xsd and it include the xsd fhir-base.xsd and I have the error for fhir-base.xsd.</p>
<p>You have all details in the report file (report.txt) which I attached in previous message.<br>
Here, you have the first error that I encountered.</p>
<p>For fhir-base.xsd<br>
This is the first error XML spy is producing.</p>
<p>The schema doesn't appear to be valid by itself (as a part of another schema, it might still be OK).<br>
    Value '(\s<em>([0-9a-zA-Z</em>\/<em>\+\=]){4}\s</em>)+' is not a valid XML regular expression.<br>
        Error location: xs:schema / xs:simpleType / xs:restriction / xs:pattern / @value<br>
        Details</p>
<div class="codehilite"><pre><span></span><code>        invalid-escape: The given character escape is not recognized.
        dt-pattern: Value &#39;(\s*([0-9a-zA-Z*\/*\+\=]){4}\s*)+&#39; is not a valid XML regular expression.
</code></pre></div>

<p>When we correct this problem, there are others errors like 'ResourceType' must refer to an existing simple or complex type.</p>
<p>It is really strange for me that the xsd are not valid. Maybe, there is something missing? The full zip that I downloaded. <a href="/user_uploads/10155/IR8kxk6RZVPleonrl289RKNn/fhir-all-xsd.zip">fhir-all-xsd.zip</a></p>



<a name="245816338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245816338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245816338">(Jul 13 2021 at 12:27)</a>:</h4>
<p>There are some know problems with recent versions of the generated schemas, in the current build. But the R4 package is ok as far as I know.  The date on those files of 28th June suggest these are from the build.</p>



<a name="245941268"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245941268" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> V.Cuvelier <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245941268">(Jul 14 2021 at 10:19)</a>:</h4>
<p>Ok,<br>
Nobody reproduce my problem?<br>
I downloaded the official xsd and I cannot do anything with it. I try to search an older version. I find the specification 3.5a.0 and for older version but I cannot downloaded the xsd package. From this webpage <a href="http://hl7.org/fhir/2018Dec/downloads.html">http://hl7.org/fhir/2018Dec/downloads.html</a>, we can downloaded the xsd version  but we have this error message.</p>
<div class="codehilite"><pre><span></span><code>The file you were looking for was not found. If you arrived at this page from one of your bookmarks, or you believe the location of your file might have changed, you may find it beneficial to try one of the following:

Browse the HL7 Site Map
Search our website for your file.
Visit the HL7.org homepage.
Send an e-mail to webmaster@HL7.org.
</code></pre></div>
<p>So, it means the resource is not available now.<br>
Maybe you have a working version? Where can I find it or can you share it?<br>
Thank you in advance.</p>



<a name="245951487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/245951487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#245951487">(Jul 14 2021 at 12:17)</a>:</h4>
<p>This is the direct link for 4.01 <a href="http://hl7.org/fhir/fhir-all-xsd.zip">http://hl7.org/fhir/fhir-all-xsd.zip</a><br>
I just downloaded this, loaded fhir-all.xsd into Oxygen, and it validated ok.</p>



<a name="253216246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/253216246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shahim Essaid <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#253216246">(Sep 14 2021 at 08:36)</a>:</h4>
<p>I came across this issue in version 4.6.0 and latest build. There are many references to the complex type ResourceType that do not resolve. In 4.01 there is only one reference to this type, the reference is from ExampleScenario.Instance.resourceId, and the ResourceType is defined in  examplescenario.xsd and it also shows up in fhir-single.xsd.   In the newer builds there are many more references, 12 I think, to ResourceType but it is no longer defined in any of the XSD files or in fhir-single.xsd.</p>



<a name="253216415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/253216415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shahim Essaid <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#253216415">(Sep 14 2021 at 08:37)</a>:</h4>
<p>I also get the following error in 4.6.0 for this XSD:</p>
<p>&lt;xs:simpleType name="base64Binary-primitive"&gt;<br>
    &lt;xs:restriction base="xs:base64Binary"&gt;<br>
      &lt;xs:pattern value="(\s<em>([0-9a-zA-Z</em>\/<em>\+\=]){4}\s</em>)+"/&gt;<br>
    &lt;/xs:restriction&gt;<br>
  &lt;/xs:simpleType&gt;</p>
<p>Error (in Visual Studio Code):<br>
InvalidRegex: Pattern value '(\s<em>([0-9a-zA-Z</em>\/<em>\+\=]){4}\s</em>)+' is not a valid regular expression. The reported error was: 'This expression is not supported in the current option setting.'.</p>



<a name="253360195"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/253360195" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#253360195">(Sep 15 2021 at 04:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="253529247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/253529247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shahim Essaid <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#253529247">(Sep 16 2021 at 04:59)</a>:</h4>
<p>A little typo in my earlier post but can't edit to fix. It should be:  ExampleScenario.Instance.resourceType (not .resourceId as I stated above)  that is an example of where there is a reference to ResourceType.</p>
<p>Out of curiosity, I took a quick look at the JSON Schema for 4.0.1.  The same path, ExampleScenario.Instance.resourceType, is not bound to the same enumeration/valueset as the XSD shows. It only says that ExampleScenario.Instance.resourceType  is a code, not an enumeration of the valueset.</p>



<a name="257308496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257308496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257308496">(Oct 13 2021 at 04:16)</a>:</h4>
<p><span class="user-mention" data-user-id="223326">@Shahim Essaid</span> <span class="user-mention" data-user-id="191651">@Rik Smithies</span> this will be fixed in 4.6.0 in a couple of days (when all my changes make their way into <a href="http://build.fhir.org">build.fhir.org</a>. But: oxygen is complaining about this line:</p>



<a name="257308503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257308503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257308503">(Oct 13 2021 at 04:16)</a>:</h4>
<div class="codehilite" data-code-language="XML"><pre><span></span><code> <span class="nt">&lt;xs:simpleType</span> <span class="na">name=</span><span class="s">"base64Binary-primitive"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xs:restriction</span> <span class="na">base=</span><span class="s">"xs:base64Binary"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;xs:pattern</span> <span class="na">value=</span><span class="s">"\s*([0-9a-zA-Z\+\=]{4}\s*)+"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:restriction&gt;</span>
  <span class="nt">&lt;/xs:simpleType&gt;</span>
</code></pre></div>



<a name="257308512"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257308512" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257308512">(Oct 13 2021 at 04:16)</a>:</h4>
<p>I can't see why - that's a valid pattern as far as I'm concerned.</p>



<a name="257312457"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257312457" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shahim Essaid <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257312457">(Oct 13 2021 at 05:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  I don't think the escapes are needed in the character class.</p>



<a name="257314031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257314031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257314031">(Oct 13 2021 at 05:42)</a>:</h4>
<p>since when was that a problem though?</p>



<a name="257351867"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257351867" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257351867">(Oct 13 2021 at 11:55)</a>:</h4>
<p>Its the "\=" I think.</p>
<p>From a recent build I have this:</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>      <span class="nt">&lt;xs:pattern</span> <span class="na">value=</span><span class="s">"(\s*([0-9a-zA-Z*\/*\+\=]){4}\s*)+"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Neither Xerces nor Saxon like that.</p>
<p>But they are ok with this:</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>      <span class="nt">&lt;xs:pattern</span> <span class="na">value=</span><span class="s">"(\s*([0-9a-zA-Z*/*\+=]){4}\s*)+"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Presumably the "/" and "=" don't need escaping. The forward slash isn't there at all in your new version.</p>
<p>These are not mentioned here as special characters, <br>
<a href="https://www.w3.org/XML/2008/03/xsdl-regex/re.xml">https://www.w3.org/XML/2008/03/xsdl-regex/re.xml</a><br>
"A metacharacter is either ., \, ?, *, +, {, } (, ), |, [, or ]. "</p>
<p>Maybe some parsers leniently allow the escape character in places where it isn't meant to be.</p>



<a name="257369160"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257369160" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shahim Essaid <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257369160">(Oct 13 2021 at 13:55)</a>:</h4>
<p>Inside a character class most meta characters are regular characters according to: <a href="https://www.regular-expressions.info/xml.html">https://www.regular-expressions.info/xml.html</a> and the section about metacharacters here <a href="https://www.regular-expressions.info/charclass.html#special">https://www.regular-expressions.info/charclass.html#special</a></p>
<p>Looking at the spec here <a href="https://www.w3.org/TR/xmlschema-2/#cces">https://www.w3.org/TR/xmlschema-2/#cces</a>  only the one before the "=" seems to be the problem. I confirmed that the error goes away in VSC if I only remove the one before the equals sign.</p>



<a name="257377142"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257377142" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257377142">(Oct 13 2021 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="223326">@Shahim Essaid</span> Does this page <a href="https://www.w3.org/TR/xmlschema-2/#cces">https://www.w3.org/TR/xmlschema-2/#cces</a> allow "\/"?  In Oxygen it is not enough to just remove the one before equals.</p>



<a name="257380096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257380096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shahim Essaid <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257380096">(Oct 13 2021 at 14:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191651">@Rik Smithies</span>  I meant only removing the one before the equals from Grahame's example works. "\/" is not a valid escape sequence according to the XSD regex grammar shown at that link/table.</p>



<a name="257380438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257380438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shahim Essaid <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257380438">(Oct 13 2021 at 14:59)</a>:</h4>
<p>The way I'm understanding this is that first the escape sequence has to be legal according to that link. But, inside a character class, less escaping is needed but it's still allowed. Removing the \ from your \/ and \= example fixes the error in VSC.</p>



<a name="257383442"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257383442" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257383442">(Oct 13 2021 at 15:17)</a>:</h4>
<p>yes good point - Grahame has already removed \/ in his new version.</p>



<a name="257426157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/xsd%20not%20valid/near/257426157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/xsd.20not.20valid.html#257426157">(Oct 13 2021 at 19:48)</a>:</h4>
<p><a href="https://jira.hl7.org/browse/FHIR-34126">https://jira.hl7.org/browse/FHIR-34126</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
