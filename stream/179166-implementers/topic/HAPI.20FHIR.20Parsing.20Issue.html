---
layout: page
title: "FHIR Chat  · HAPI FHIR Parsing Issue · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20Parsing.20Issue.html">HAPI FHIR Parsing Issue</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153867988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20Parsing%20Issue/near/153867988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Warren <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20Parsing.20Issue.html#153867988">(Jan 18 2017 at 03:42)</a>:</h4>
<p>Wondering if anyone here can help me with an odd validation error while attempting to use HAPI to create a DSTU2 FHIR ReferralRequest context from a JSON string. Specifically with the HAPI method: FhirContext.forDstu2().newJsonParser().parseResource( &lt;JSON string&gt; ).</p>
<p>The JSON string is well formed and seems to pass validation in the FHIR test server. But in my code I get validation errors for perfectly valid elements.</p>
<p>This is the error log:</p>
<p>INFO: Creating new FHIR context for FHIR version [DSTU2]<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'name' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'telecom' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'telecom' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'telecom' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'gender' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'birthDate' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'address' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'careProvider' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.parser.LenientErrorHandler unknownElement<br>
WARNING: Unknown element 'id' found while parsing<br>
Jan 17, 2017 6:44:37 PM ca.uhn.fhir.context.FhirContext &lt;init&gt;</p>



<a name="153868216"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20Parsing%20Issue/near/153868216" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20Parsing.20Issue.html#153868216">(Jan 18 2017 at 20:15)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="193287">@Dennis Warren</span>, that should work properly for sure.</p>
<p>Would you be able to provide the string you're passing in (or even a subset of it?)</p>



<a name="153868426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20Parsing%20Issue/near/153868426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Warren <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20Parsing.20Issue.html#153868426">(Jan 19 2017 at 18:56)</a>:</h4>
<p>Thank you James;</p>
<p>This is the JSON string being passed: </p>
<p>{<br>
  "resourceType": "ReferralRequest",<br>
  "id": "Ref/4597856131",<br>
  "status": "requested",<br>
  "date": "2017-01-18T15:32:00-05:00",<br>
  "patient": {<br>
    "resourceType": "Patient",<br>
    "name": [<br>
      {<br>
        "given": [<br>
          “Test"<br>
        ],<br>
        "family": [<br>
          “Patient"<br>
        ],<br>
        "text": “Test Patient"<br>
      }<br>
    ],<br>
    "telecom": [<br>
      {<br>
        "system": "phone",<br>
        "value": "604-334-2344",<br>
        "use": "home"<br>
      },<br>
      {<br>
        "system": "phone",<br>
        "value": "778-238-2342",<br>
        "use": "work"<br>
      },<br>
      {<br>
        "system": "email",<br>
        "value": "<a href="mailto:thepatient@patient.com" title="mailto:thepatient@patient.com">thepatient@patient.com</a>",<br>
        "use": "home"<br>
      }<br>
    ],<br>
    "gender": "male",<br>
    "birthDate": "1966-06-17",<br>
    "address": [<br>
      {<br>
        "line": [<br>
          "123 Abc Street"<br>
        ],<br>
        "city": "Vancouver",<br>
        "state": "BC"<br>
      }<br>
    ],<br>
    "careProvider": [<br>
      {<br>
        "resourceType": "Practitioner",<br>
        "name": {<br>
          "given": [<br>
            "Doctor"<br>
          ],<br>
          "family": [<br>
            "Love"<br>
          ],<br>
          "text": "Doctor Love"<br>
        },<br>
        "telecom": [<br>
          {<br>
            "system": "phone",<br>
            "value": "604-498-3456",<br>
            "use": "work"<br>
          }<br>
        ],<br>
        "id": "Practitioner/1"<br>
      }<br>
    ],<br>
    "id": "Patient/1"<br>
  },<br>
  "priority": {<br>
    "text": ""<br>
  }<br>
}</p>



<a name="153868705"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20Parsing%20Issue/near/153868705" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20Parsing.20Issue.html#153868705">(Jan 20 2017 at 23:41)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="193287">@Dennis Warren</span>,</p>
<p>Ahh, you can't nest resources like that in FHIR. The patient element needs to have a reference to the patient, not an actual patient resource. See the example here: <a href="http://hl7.org/fhir/referralrequest-example.json.html" target="_blank" title="http://hl7.org/fhir/referralrequest-example.json.html">http://hl7.org/fhir/referralrequest-example.json.html</a></p>
<p>There is a mechanism called "contained resources" that you can use for nesting one resource inside another, but it's intended as a last resort. You can learn about the syntax here: <a href="http://www.hl7.org/FHIR/references.html" target="_blank" title="http://www.hl7.org/FHIR/references.html">http://www.hl7.org/FHIR/references.html</a></p>



<a name="153868743"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20Parsing%20Issue/near/153868743" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Warren <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20Parsing.20Issue.html#153868743">(Jan 22 2017 at 03:52)</a>:</h4>
<p>Thank you James. Referenced resources makes much more sense and really does demonstrate the power of FHIR.</p>
<p>In this case my goal was to create a complete Referral Request into a single payload because it is not possible for the target server (host) to callback to the origin (client) for resources.  It seemed to me that the Contained Resources approach made the most sense. Is it not possible for the parser to separate each Contained Resource through the unique Resource identifiers?  And, I guess - as a work around - would be too dangerous to pull the resources out of the JSON string prior to parsing them? </p>
<p>BTW: This conclusion was drawn by reading HAPI's resource description here: <a href="http://hapifhir.io/doc_resource_references.html" target="_blank" title="http://hapifhir.io/doc_resource_references.html">http://hapifhir.io/doc_resource_references.html</a> </p>
<p>I see now that the best way to transmit a single payload is as a Bundle of Resources containing relative URL's. Right?  Is it then possible for the HAPI parser to parse each resource in the Bundle automatically?</p>



<a name="153868759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/HAPI%20FHIR%20Parsing%20Issue/near/153868759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/HAPI.20FHIR.20Parsing.20Issue.html#153868759">(Jan 22 2017 at 15:38)</a>:</h4>
<p>If you want to pass multiple resources in a single payload, the preferred solution is to use Bundle.  "contained" is for when resources *cannot* stand alone - i.e. they'll never be referenced by anything else and don't have enough information to exist as independent entities.  The URLs used in the Bundle can be relative, absolute or simple UUIDs, depending on whether the resources are available RESTfully and whether they're all on the same server or not.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
