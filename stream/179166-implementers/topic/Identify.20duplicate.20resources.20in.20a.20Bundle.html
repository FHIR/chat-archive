---
layout: page
title: "FHIR Chat  · Identify duplicate resources in a Bundle · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html">Identify duplicate resources in a Bundle</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="242834975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/242834975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek TK <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#242834975">(Jun 16 2021 at 06:27)</a>:</h4>
<p>Hi,<br>
I have a use case to detect the duplicate resources in a bundle-say Practitioner resource which is same, but  may come twice or n times in the bundle due to the type of the data source used(e.g-conversion from CDA to FHIR). I would like to know if there is a standard practice to identify the duplicate resources. Can we rely on the identifiers for each resource?Will that be the right way to do? Or are there any other approach where we can determine duplicate resources within a Bundle?</p>



<a name="242930026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/242930026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#242930026">(Jun 16 2021 at 19:26)</a>:</h4>
<p>If they have the same <code>id</code>, it is not a valid bundle (unless it is a history bundle with multiple versions of the same resource, but from your description that is not the case).  Details are on the <a href="http://hl7.org/fhir/bundle.html#bundle-unique">Bundle</a> resource page (the formal constraint is <a href="http://hl7.org/fhir/bundle.html#invs">bdl-7</a>).  So, the best solution is to fix the generation so that it doesn't include them.  If that is not an option, you should be able to use the <code>entry.fullUrl</code> element.</p>
<p>If the entries are the same data but different identifiers, then the process for de-duplication will vary depending on what that data is (e.g., for patients are you matching names exact + date of birth, partial names, etc.).</p>



<a name="243104731"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243104731" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek TK <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243104731">(Jun 18 2021 at 00:50)</a>:</h4>
<p>Thanks for the suggestion <span class="user-mention" data-user-id="222054">@Gino Canessa</span> . Will check with the full url option. Also I feel the process of de-duplication will become very complex as there are multiple resources involved and also they use custom profiles.</p>



<a name="243176519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243176519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243176519">(Jun 18 2021 at 15:32)</a>:</h4>
<p>No problem.  But yes, if the resources are coming from different sources they are quite unlikely to have matching URLs or IDs.  You will need to determine what constitutes a duplicate for each resource and remove them.  Note that this also means checking everything else in the bundle for links <em>to</em> that resource (e.g., if you remove a Patient record, any Encounter that points to that patient needs to be changed to point at the new one).</p>
<p>De-duplication like that can be challenging - good luck!</p>



<a name="243177580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243177580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243177580">(Jun 18 2021 at 15:40)</a>:</h4>
<p>just for clarity... the id is only unique within a resource at a root url. so the id value of "1" might show up for both Patient/1, as wells Obsrvation/1, and Practitoner/1. These are not the same, even though the id is all "1".</p>



<a name="243251989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243251989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek TK <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243251989">(Jun 19 2021 at 14:16)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="222054">@Gino Canessa</span>  <span class="user-mention" data-user-id="191404">@John Moehrke</span>  . Also would like to know if you have any thoughts on the updates of these resources when they are stored in a FHIR server. During the first transformation, consider these resources converted from CDA documents are stored to a FHIR server. Now the challenge is to update these FHIR resources in the FHIR server when the CDA document gets updated so that the data in XDS and its transformed copy stored in FHIR server are intact.</p>
<p>For a few resources like Patient, Practitioner etc, we may rely upon the identifier(not the logical id), but I am not sure of the case when the identifiers are not available for other resources that are extracted from CDA sections. Basically, the resources created from CDA sections like Observation, Medication,MedicationStatement etc which does not have any identifiers available in the CDA document(which is the source of transformation).  .. As <span class="user-mention" data-user-id="222054">@Gino Canessa</span>  mentioned before, this makes us depend on the data within each resource to identify the duplicates and they can vary from resource to resource.</p>



<a name="243271671"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243271671" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243271671">(Jun 19 2021 at 22:13)</a>:</h4>
<p>What is the purpose of transforming the contents of CDA documents into FHIR resources in the first place? Is it to make that data available to be used by FHIR clients?</p>



<a name="243286509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243286509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek TK <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243286509">(Jun 20 2021 at 04:59)</a>:</h4>
<p>Right <span class="user-mention" data-user-id="192685">@Vassil Peytchev</span></p>



<a name="243313153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243313153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243313153">(Jun 20 2021 at 17:42)</a>:</h4>
<p>In that case, I think you need an intermediate step: CDA - &gt; normalized data - &gt; mapping the normalized data to FHIR resources. All the things that you are discovering about needing to do still need to be done, but if you separate the CDA processing from providing the data as FHIR resources, I think it will be more manageable.</p>



<a name="243371079"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243371079" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243371079">(Jun 21 2021 at 11:53)</a>:</h4>
<p>Note that what you are describing is what the IHE mobile Cross-Element Data Extraction implementation guide recommends - <a href="https://wiki.ihe.net/index.php/Mobile_Cross-Enterprise_Document_Data_Element_Extraction">https://wiki.ihe.net/index.php/Mobile_Cross-Enterprise_Document_Data_Element_Extraction</a>. <br>
This recommends use of FHIR Provenance to enable linking back to the CDA document(s), and thus you have Provenance details to enable updates as you mention.<br>
As to the problem, this is simply a problem for systems-design to overcome. There is no interoperability specification that is going to help you. It comes down to the tough task of de-duplication on the edge of false-negatives and false-positives.</p>



<a name="243512502"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243512502" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vivek TK <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243512502">(Jun 22 2021 at 13:05)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191404">@John Moehrke</span> . Provenance indeed keeps track of the resources along with their logical ids. I guess that's a good point to start.</p>



<a name="243792802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Identify%20duplicate%20resources%20in%20a%20Bundle/near/243792802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Identify.20duplicate.20resources.20in.20a.20Bundle.html#243792802">(Jun 24 2021 at 14:18)</a>:</h4>
<p>good tutorial <span class="user-mention" data-user-id="191478">@Oliver Egger</span> gave on mapping CDA to FHIR at DevDays is available <a href="https://www.youtube.com/watch?v=d941K8CMWq4">https://www.youtube.com/watch?v=d941K8CMWq4</a></p>
<div class="youtube-video message_inline_image"><a data-id="d941K8CMWq4" href="https://www.youtube.com/watch?v=d941K8CMWq4"><img src="https://uploads.zulipusercontent.net/a64fb1c5276f65bcb8ab033bb029b3ae21ad1149/68747470733a2f2f692e7974696d672e636f6d2f76692f643934314b38434d5771342f64656661756c742e6a7067"></a></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
