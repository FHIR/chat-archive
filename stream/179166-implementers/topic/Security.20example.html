---
layout: page
title: "FHIR Chat  · Security example · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html">Security example</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="181965279"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181965279" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oskari Koskimies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181965279">(Nov 26 2019 at 21:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span><br>
Hi Grahame,<br>
You mentioned during today's presentation in Helsinki that you had an example showing why access control logic cannot sit outside the repository in the GraphQL layer? (leftmost vs. rightmost case on the attached slide)<br>
BR,<br>
     --Oskari</p>
<p><a href="/user_uploads/10155/lrbyZEH3U1Xzt7GhYK8UVnVN/FHIR_security.jpg" target="_blank" title="FHIR_security.jpg">FHIR_security.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/lrbyZEH3U1Xzt7GhYK8UVnVN/FHIR_security.jpg" target="_blank" title="FHIR_security.jpg"><img src="/user_uploads/10155/lrbyZEH3U1Xzt7GhYK8UVnVN/FHIR_security.jpg"></a></div>



<a name="181975077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181975077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181975077">(Nov 26 2019 at 23:33)</a>:</h4>
<p>When elaboration, please differentiate Access Control 'decision' from 'enforcement'. Clearly enforcement is, and will always bee something that is within the FHIR Server. That said, the current SMART scopes are rather blunt to support many authorization decisions.</p>



<a name="181989756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181989756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181989756">(Nov 27 2019 at 04:54)</a>:</h4>
<p>this is a prompt for me to elaborate the use case</p>



<a name="181990948"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181990948" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oskari Koskimies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181990948">(Nov 27 2019 at 05:24)</a>:</h4>
<blockquote>
<p>Clearly enforcement is, and will always bee something that is within the FHIR Server.</p>
</blockquote>
<p>Could you elaborate? I'm new to FHIR, but if I have a simple CRUD REST API service for a given set of resources, I can't think of any reason why you couldn't implement both access control decision and enforcement in the GraphQL layer on top of the REST API (assuming of course that the REST API cannot be accessed directly by users). See e.g. <a href="https://www.apollographql.com/docs/apollo-server/security/authentication/" target="_blank" title="https://www.apollographql.com/docs/apollo-server/security/authentication/">https://www.apollographql.com/docs/apollo-server/security/authentication/</a>. So there is something special to FHIR in this regard?</p>



<a name="181995118"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181995118" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181995118">(Nov 27 2019 at 07:07)</a>:</h4>
<p>in principle, you can enforce security in a layer in front of the engine as long as all the decision are made based on what you can see. So a graphQL based decision maker can see all the request and response resources, and decide, for instance, that a returned resource from the REST Api has a security label on it, and not return it</p>



<a name="181995186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181995186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181995186">(Nov 27 2019 at 07:09)</a>:</h4>
<p>this approach doesn't work if access control decisions are made on resources that don't you don't even see on the graphql layer. This principally occurs with chained search parameters</p>



<a name="181995252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181995252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181995252">(Nov 27 2019 at 07:10)</a>:</h4>
<p>e.g. if I do </p>
<p><code>GET [base]/Observation?code=xxx</code></p>
<p>The graphQL layer can inspect each returned resource, and decide whether it's acceptable according to some security rules</p>



<a name="181995265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181995265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181995265">(Nov 27 2019 at 07:10)</a>:</h4>
<p>but if the I do </p>
<p><code>GET [base]/Observation?code=xxx&amp;encounter.class=yy</code></p>



<a name="181995294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181995294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181995294">(Nov 27 2019 at 07:11)</a>:</h4>
<p>the security rules for whether I can do that join, and which encounters can be seen in that join, cannot be enforced outside the join engine - e.g. in the graphQL engine that consumes that the REST Api. It doesn't know anything about the encounters</p>



<a name="181995375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/181995375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#181995375">(Nov 27 2019 at 07:13)</a>:</h4>
<p>in fact, extending that... a perfectly reasonable rule in the REST Api would be that you can't see observations associated with encounters that you can't see.... that's also pretty difficult to enforce in the graphQL layer, since the encounters aren't naturally visible </p>
<p>Also, this is all terribly slow compared to integrating these security things into you index / joins</p>



<a name="182023007"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/182023007" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#182023007">(Nov 27 2019 at 14:23)</a>:</h4>
<p>that is hard enough in pure FHIR REST... so, yes I could see how it is much harder in graphQL layer.  <br>
Also, similar complexity comes if the access control is "Attribute Based Access Control (ABAC)", that is where rules are leveraging various elements within Resources.  Such as use of security/privacy tags in .meta.security to segment data.</p>



<a name="182023194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/182023194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#182023194">(Nov 27 2019 at 14:25)</a>:</h4>
<p>is it appropriate to consider graphQL in a case where data is so highly segmented based on privacy rules and business rules? It seems to be more appropriate to data that are singularly protected (such as a de-identified research database). In the case of a de-identified research database this would not be such a problem.. right?</p>



<a name="182031033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/182031033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#182031033">(Nov 27 2019 at 15:50)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> this discussion was effectively about our diagram on the security page that shows implementation of a security engine in front the RESTful API. When teaching in Finland this week, I claimed that you could not implement all of the things you need to do for security in front of the API. the specific question nominated graphQL here because of personal relevance, but it's not the point; it's simply: what is it that you need to integrate into the query engine and you can't achieve in front of it</p>



<a name="182031055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/182031055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#182031055">(Nov 27 2019 at 15:50)</a>:</h4>
<p>and you're right that a de-identified database probably doesn't have any such cases</p>



<a name="182031933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/182031933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#182031933">(Nov 27 2019 at 16:00)</a>:</h4>
<p>yup. all models are broken, some are useful</p>



<a name="182909121"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/182909121" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oskari Koskimies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#182909121">(Dec 08 2019 at 21:09)</a>:</h4>
<blockquote>
<p>in principle, you can enforce security in a layer in front of the engine as long as all the decision are made based on what you can see. So a graphQL based decision maker can see all the request and response resources, and decide, for instance, that a returned resource from the REST Api has a security label on it, and not return it</p>
<p>this approach doesn't work if access control decisions are made on resources that don't you don't even see on the graphql layer. This principally occurs with chained search parameters</p>
</blockquote>
<p>Thanks for the explanation! I think the main difficulty I had in understanding the picture on the slide was that it only shows the GraphQL access to the system, and the system <em>looks</em> like a simple data repository. If it were only a database with REST API on top and a GraphQL interface on top of the REST API, I don't think there would be any issue with access control in the GraphQL layer. But in reality it is of course an arbitrarily complex healthcare backend system which has also other interfaces and which might not expose all of its data via the REST API (like you said). Maybe make the "clinical/healthcare repository" icon on the slide look less like a database and more like a backend system?</p>



<a name="182910377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Security%20example/near/182910377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Security.20example.html#182910377">(Dec 08 2019 at 21:47)</a>:</h4>
<p>ok I'll see what I can do in future, thanks</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
