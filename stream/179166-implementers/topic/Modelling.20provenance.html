---
layout: page
title: "FHIR Chat  · Modelling provenance · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html">Modelling provenance</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="243605428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243605428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Berry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243605428">(Jun 23 2021 at 04:13)</a>:</h4>
<p>We’re trying to use FHIR Provenance to record activities against patient-related resources. The target of the Provenance resource is not a patient resource, but we want to search by patient identifier. The obvious modelling is to reference the related Patient resource in a Provenance.entity reference, which is searchable. The entity reference has a mandatory role parameter coded using the ProvenanceEntityRole valueset, which is not extensible (<a href="https://www.hl7.org/fhir/valueset-provenance-entity-role.html">https://www.hl7.org/fhir/valueset-provenance-entity-role.html</a>). None of the role definitions seem to fit. Perhaps ‘source’ but it has a rather convoluted definition that isn’t very deterministic. </p>
<p>My question: can we use ‘source’ in this case? If not, how else could we capture a searchable patient identity in the Provenance resource? </p>
<p>Would appreciate any suggestions. Thanks.</p>



<a name="243648518"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243648518" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Pyke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243648518">(Jun 23 2021 at 13:08)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span></p>



<a name="243648809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243648809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243648809">(Jun 23 2021 at 13:11)</a>:</h4>
<p>Provenance is intended to be used to determine the provenance of a resource. It does not have use-cases for discovering all the Provenance for a given subject.  The Provenance resource design is intended to cover specifically provenance use-cases, and not more.</p>



<a name="243648954"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243648954" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243648954">(Jun 23 2021 at 13:12)</a>:</h4>
<p>It sounds like you are looking for a function that the AuditEvent does cover. And it covers it much like you have expressed. And AuditEvent covers more than just Create/Update events, it covers queries and reads and more.</p>



<a name="243649085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243649085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243649085">(Jun 23 2021 at 13:13)</a>:</h4>
<p>We have added clarifications of this in the R5 build - <a href="http://build.fhir.org/auditevent.html#patient">http://build.fhir.org/auditevent.html#patient</a></p>



<a name="243721432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243721432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Berry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243721432">(Jun 23 2021 at 22:33)</a>:</h4>
<p>Thanks John.</p>
<p><span class="user-mention silent" data-user-id="191404">John Moehrke</span> <a href="#narrow/stream/179166-implementers/topic/Modelling.20provenance/near/243648954">said</a>:</p>
<blockquote>
<p>It sounds like you are looking for a function that the AuditEvent does cover. And it covers it much like you have expressed. And AuditEvent covers more than just Create/Update events, it covers queries and reads and more.</p>
</blockquote>
<p>They’re not AuditEvents because they are intended for clinical review (noting from AuditEvent “This content is not intended to be accessible or used directly by other healthcare users”). That said, re-reading the Provenance definition in light of your comments I can see we are stretching the definition. We could perhaps take a slightly different approach and say that the Patient resource is the target since we are tracking changes to the patient clinical record, but I suspect this is still stretching the definition. </p>
<p>Other thoughts or suggestions?</p>



<a name="243940774"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243940774" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243940774">(Jun 25 2021 at 16:42)</a>:</h4>
<p>You might need to define a custom SearchParameter</p>



<a name="243943393"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243943393" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243943393">(Jun 25 2021 at 17:04)</a>:</h4>
<p>The note on AuditEvent is more to distinguish Provenance from AuditEvent.</p>



<a name="243943792"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243943792" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243943792">(Jun 25 2021 at 17:08)</a>:</h4>
<p>Possibilities:<br>
a. add an extension in Provenance for .patient and search parameter<br>
b. make this extension core in FHIR.. by proving it useful beyond a specific project<br>
c. proving it useful it is recognized as a core element in Provenance.<br>
d. define an operation that works on magic (use of $everything with reverse include on Provenance)<br>
I could be convinced this is core. The Provenance layout is generic, and thus not considering the Healthcare needs.<br>
But we would need more than one person interested.</p>



<a name="243943907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243943907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243943907">(Jun 25 2021 at 17:10)</a>:</h4>
<p>Drawbacks of adding a patient element (extension or core) is that this adds overhead to everywhere Provenance is recorded that there is an evaluation of if a Patient is relevant (not all FHIR resources are patient relevant). and then extraction of the Patient id relevant (which sometimes it is a step away).</p>



<a name="243955700"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243955700" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Venton <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243955700">(Jun 25 2021 at 18:52)</a>:</h4>
<p>What if the Provenance targets resources from multiple patients? A bulk update, insert process.</p>



<a name="243957744"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/243957744" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#243957744">(Jun 25 2021 at 19:10)</a>:</h4>
<p>yup, more issues with this.</p>



<a name="244055004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244055004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Berry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244055004">(Jun 27 2021 at 07:44)</a>:</h4>
<p>Thanks, interesting discussion. Our use case is patient clinical review, patient history and (potentially) clinical audit, so a singular patient resource is reasonable for this use case. </p>
<p>I don’t think it would be adequately covered by history on the Patient resource as other resources are necessarily involved and the specific agent and activity is important (i.e. knowledge of data changed is not necessarily sufficient).  It isn’t really resource provenance because it’s about the patient rather than the resources themselves, but it is about activity involving a patient, the agent responsible, and and other entities involved in the activity. You can perhaps interpret the English language meaning of “provenance” to include this. </p>
<p>Would a clinical “PatientProvenance” or perhaps “ClinicalAuditEvent” resource be appropriate or warranted?</p>



<a name="244071764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244071764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244071764">(Jun 27 2021 at 15:30)</a>:</h4>
<p>I have trouble imagining those being added.  Those sound more like profiles and IGs built on the existing resources.</p>



<a name="244072699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244072699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244072699">(Jun 27 2021 at 15:55)</a>:</h4>
<p>if added they would be huge overhead and thus very unlikely to be filled out. Provenance itself is unlikely to be filled out without some community policy requiring it.</p>



<a name="244072710"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244072710" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244072710">(Jun 27 2021 at 15:56)</a>:</h4>
<p>I am unclear on why a review of the Patient compartment is not sufficient?</p>



<a name="244089768"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244089768" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Berry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244089768">(Jun 27 2021 at 23:10)</a>:</h4>
<p>Regarding Patient, there are a few reasons it doesn’t work for us:</p>
<ul>
<li>activity and agent are important and this is not captured or coded in our case</li>
<li>at present we don’t have access to adequate history for the resources in question</li>
</ul>
<p>In an ideal world we could perhaps access them via Patient history and linked resource history. Our world probably won’t be ideal for a while yet. The limited compliance on resource history and the request pattern captured in history are also likely to make it troublesome to reliably capture activity and agent, especially if multiple repositories are involved.</p>



<a name="244089794"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244089794" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Berry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244089794">(Jun 27 2021 at 23:12)</a>:</h4>
<p>Note that based on this discussion, we will most likely model around existing resources.</p>



<a name="244134725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244134725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244134725">(Jun 28 2021 at 12:11)</a>:</h4>
<p>So for activity and agent consistency it does seem like you need a policy requiring Provenance. I think what I was pushing back on is the modification of Provenance to include a Patient. I was more pointing that there is already the $everything (aka Patient compartment) that is defined to find everything; from which you can get the Provenance for all of that. Wrap this algorithm into an operation -- $provenanceOfEverything</p>



<a name="244233855"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/244233855" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Berry <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#244233855">(Jun 29 2021 at 05:01)</a>:</h4>
<p>That makes sense John. I wasn’t particularly wanting to change the current resource definition. We will likely use Patient as our target resource and explicitly identify relevant subordinate resources in entity references.</p>



<a name="245045958"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Modelling%20provenance/near/245045958" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Modelling.20provenance.html#245045958">(Jul 06 2021 at 14:26)</a>:</h4>
<p>so you are planning on adding to all Provenance records a <a href="http://Provenance.target">Provenance.target</a> of the Patient impacted? Yet the activity that caused the Provenance did not revise the Patient resource... this would be against the definition of the .target element. Far better to add a Provenance.entity of the Patient as a resource that was read (source). This  is not directly the intent, but surely it is true that anything created/updated (<a href="http://Provenance.target">Provenance.target</a>) was created/updated with knowledge of the subject. (This is what I recommend in AuditEvent for similar purpose).   -- I don't think this is the proper solution, prefer the use of AuditEvent as it already does this (and includes read and query).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
