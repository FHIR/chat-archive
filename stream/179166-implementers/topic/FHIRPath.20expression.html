---
layout: page
title: "FHIR Chat  · FHIRPath expression · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html">FHIRPath expression</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="198023999"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198023999" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198023999">(May 19 2020 at 05:40)</a>:</h4>
<p>Hi Everyone,</p>
<p>Needed a clarification regarding the FHIRPath expression defined in SearchParameter for value[x] fields.</p>
<p>The expression for searchparameter to search a value[x] field should have all possible variants allowed for search ?<br>
for example, As of now the FHIRPath expression for the field CarePlan-&gt;activity-&gt;detail-&gt;scheduled  </p>
<p>Which of the below expressions is the correct way of defining the FHIRPath expression ?</p>
<ol>
<li>
<p>"CarePlan.activity.detail.scheduled"</p>
</li>
<li>
<p>"CarePlan.activity.detail.scheduled as Timing | CarePlan.activity.detail.scheduled as Period | CarePlan.activity.detail.scheduled as string"</p>
</li>
</ol>



<a name="198049079"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198049079" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198049079">(May 19 2020 at 10:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  <br>
It will be very helpful if you could help me with this query.</p>



<a name="198082576"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198082576" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198082576">(May 19 2020 at 15:23)</a>:</h4>
<p>What is the search type for your parameter?  I don't think there's a single search type that would work for Timing, Period and string...</p>



<a name="198188333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198188333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198188333">(May 20 2020 at 12:09)</a>:</h4>
<p>This is a standard SearchParameter defined in R5.<br>
I am confused with the usage of FHIRPath expressions defined in SearchParameter. <br>
For example, <br>
Resource : "CarePlan" ,<br>
searchparameter : "activity-date" ,<br>
expression : "CarePlan.activity.detail.scheduled"<br>
xpath : "f:CarePlan/f:activity/f:detail/f:scheduledTiming | f:CarePlan/f:activity/f:detail/f:scheduledPeriod | f:CarePlan/f:activity/f:detail/f:scheduledString"</p>
<p>similarly for another resource which has a searchparameter on value[x] kind of field,<br>
Resource : "Condition" ,<br>
searchparameter : "abatement-date" ,<br>
expression : "Condition.abatement.as(dateTime) | Condition.abatement.as(Period)"<br>
xpath : "f:Condition/f:abatementDateTime | f:Condition/f:abatementPeriod"</p>
<p>The expression for the "activity-date"  searchparamter should have been,<br>
"CarePlan.activity.detail.scheduled.as(Timing) | CarePlan.activity.detail.scheduled.as(Period) | CarePlan.activity.detail.scheduled.as(string)</p>
<p>Is my understanding right ?</p>



<a name="198212429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198212429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198212429">(May 20 2020 at 15:11)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="198299759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198299759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198299759">(May 21 2020 at 09:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
Could you please help me with this query ?</p>



<a name="198390740"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198390740" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198390740">(May 21 2020 at 23:21)</a>:</h4>
<p>Yes, the FHIRPath should be using the <code>as</code> operator or the <code>.as(...)</code> syntax, not the named choice</p>



<a name="198427305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198427305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198427305">(May 22 2020 at 10:39)</a>:</h4>
<p>Should I raise a ticket in Jira for this ?<br>
<span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span></p>



<a name="198448235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198448235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198448235">(May 22 2020 at 14:32)</a>:</h4>
<p>I don't see anything wrong with the SearchParameter as written, FHIRPath allows for expressions that reference choice types, and the date search type allows for searching on the possible types for the scheduled element, so I'm not clear what the actual question is here?</p>



<a name="198452992"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198452992" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198452992">(May 22 2020 at 15:11)</a>:</h4>
<p>I think the questions is specifically, is</p>
<div class="codehilite"><pre><span></span><code>expression : &quot;CarePlan.activity.detail.scheduled&quot;
</code></pre></div>


<p>correct?</p>



<a name="198460304"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198460304" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198460304">(May 22 2020 at 16:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span>, the question is how you can have a single search parameter that searches against timing, period and string</p>



<a name="198462305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198462305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198462305">(May 22 2020 at 16:24)</a>:</h4>
<p>Ah, the string choice, I missed that one. So that should probably explicitly specify the date-valued choices. Which would be a tracker, yes.</p>



<a name="198465746"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198465746" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198465746">(May 22 2020 at 16:52)</a>:</h4>
<p>Is this the same as <a href="https://jira.hl7.org/browse/FHIR-25210">https://jira.hl7.org/browse/FHIR-25210</a> ?</p>



<a name="198465841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198465841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198465841">(May 22 2020 at 16:52)</a>:</h4>
<p>if so, that should have been fixed with <a href="https://github.com/HL7/fhir/pull/775/commits/6947f33720ee371e1b2ab3c29b350831ebaeb547">https://github.com/HL7/fhir/pull/775/commits/6947f33720ee371e1b2ab3c29b350831ebaeb547</a></p>



<a name="198466034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198466034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198466034">(May 22 2020 at 16:54)</a>:</h4>
<p>and I don't see any <code>activity-date</code> at <a href="http://build.fhir.org/careplan.html#search">http://build.fhir.org/careplan.html#search</a></p>



<a name="198466174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198466174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198466174">(May 22 2020 at 16:55)</a>:</h4>
<p><span class="user-mention" data-user-id="270740">@Nikhil</span> where are you seeing this SearchParameter?</p>



<a name="198469125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198469125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198469125">(May 22 2020 at 17:19)</a>:</h4>
<p><span class="user-mention" data-user-id="191676">@Lee Surprenant</span>  It is same as that you mentioned. I remember seeing few more such cases in the R5 searchparameter set.<br>
I saw that here,  <br>
<a href="http://hl7.org/fhir/2020Feb/careplan.html">http://hl7.org/fhir/2020Feb/careplan.html</a>.</p>
<p>Looks like its fixed here <a href="https://github.com/HL7/fhir/pull/775/commits/6947f33720ee371e1b2ab3c29b350831ebaeb547">https://github.com/HL7/fhir/pull/775/commits/6947f33720ee371e1b2ab3c29b350831ebaeb547</a> .</p>



<a name="198470564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/198470564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#198470564">(May 22 2020 at 17:31)</a>:</h4>
<p>Yes, it is fixed in the current build: <a href="http://build.fhir.org/careplan.html">http://build.fhir.org/careplan.html</a></p>



<a name="199458993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199458993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199458993">(Jun 02 2020 at 07:45)</a>:</h4>
<p>Hi everyone,</p>
<p>As mentioned above, i found another searchparameter on "Specimen" resource having similar issue. <br>
current defined expression : "Specimen.collection.collected"<br>
Should it be modified to  Specimen.collection.collected.as(dateTime) | Specimen.collection.collected.as(Period)</p>
<p>Reference:<br>
<a href="http://build.fhir.org/specimen.html">http://build.fhir.org/specimen.html</a></p>



<a name="199486845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199486845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199486845">(Jun 02 2020 at 12:58)</a>:</h4>
<p>Hi Nikhil.  In this particular case, both dateTime and Period will map to the same search parameter type:  date</p>



<a name="199486962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199486962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199486962">(Jun 02 2020 at 12:59)</a>:</h4>
<p>Therefor, the "as" is not strictly required</p>



<a name="199487024"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199487024" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199487024">(Jun 02 2020 at 12:59)</a>:</h4>
<p>its only required when you have an expression that could resolve to a type which cannot be mapped to the given search parameter type</p>



<a name="199487305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199487305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199487305">(Jun 02 2020 at 13:02)</a>:</h4>
<p>see <a href="http://build.fhir.org/search.html#table">http://build.fhir.org/search.html#table</a> for a summary of that and note that both dateTime and Period have a Y in the "date" column.</p>



<a name="199487465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199487465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199487465">(Jun 02 2020 at 13:03)</a>:</h4>
<p>I'm pretty sure I caught all potential mismatches in the base spec in the past and it seems that most of those have now been resolved</p>



<a name="199493955"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199493955" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199493955">(Jun 02 2020 at 13:54)</a>:</h4>
<p>hmm, actually I just went back and I see <a href="http://jira.hl7.org/browse/FHIR-24172">FHIR#24172</a> still needs to get applied and <a href="http://jira.hl7.org/browse/FHIR-25174">FHIR#25174</a> was closed as "Not Persuasive"</p>



<a name="199589420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/199589420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikhil <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#199589420">(Jun 03 2020 at 07:58)</a>:</h4>
<p>This is helpful. Thanks <span class="user-mention" data-user-id="191676">@Lee Surprenant</span></p>



<a name="201674244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/201674244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harrison Tarr <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#201674244">(Jun 22 2020 at 23:42)</a>:</h4>
<p>Hi all, it looks like RiskAssessment-probability is another case of a typechoice missing the "as" preposition at the end of the FHIR path. There are some typechoice search params that are missing the "as" where the underlying types are both subtypes of the search param type (eg, MessageHeader-event can be either code or string, both of which can be token)<br>
however, probability is either a decimal or a Range, which are number and Quantity search types respectively. Should we treat RiskAssessment-probability as a decimal or Range when doing the search?</p>



<a name="201683864"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/201683864" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#201683864">(Jun 23 2020 at 03:04)</a>:</h4>
<p><span class="user-mention" data-user-id="246988">@Harrison Tarr</span> Can you submit a change request?  (Use the 'propose a change' link at the bottom of any page in the spec.)</p>



<a name="201716727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20expression/near/201716727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Surprenant <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20expression.html#201716727">(Jun 23 2020 at 12:10)</a>:</h4>
<p>Thats exactly what <a href="http://jira.hl7.org/browse/FHIR-25174">FHIR#25174</a> was for.  I'm gonna hop on the CDS conference call tomorrow to try convincing them to reopen it, but the fix will not be easy because what they want is a single search parameter that you can use to search either choice type</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
