---
layout: page
title: "FHIR Chat  · near &amp; neardistance modifiers in fhir-client.min-js · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html">near &amp; neardistance modifiers in fhir-client.min-js</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="193311366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193311366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcelo Cabello <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193311366">(Apr 08 2020 at 12:30)</a>:</h4>
<p>Hi, recently we were wondering how to use <em>:contains</em> modifier trough fhir-client.min.js. We made a little change in this local library and all going well.<br>
Now I'm wonder how should I write the syntax to use the modifier <em>near</em> and <em>neardistance</em> to perform the request <code>{{url}}/Location?near=-32.74977:-70.708992&amp;near-distance=110.20||km...</code> Our app is working along with a dstu3 fhir server. We try to avoid a direct request 'cause the structure of the code is ad-hoc to perform request through this library.</p>
<p>Maybe <span class="user-mention" data-user-id="191315">@Josh Mandel</span>, <span class="user-mention" data-user-id="191678">@Abigail Watson</span> , <span class="user-mention" data-user-id="192807">@Daniel Zsebedits</span>   could give us a suggestion?</p>



<a name="193325872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193325872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193325872">(Apr 08 2020 at 14:14)</a>:</h4>
<p>I think your separator for near should be '|', not ':'</p>



<a name="193344601"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193344601" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193344601">(Apr 08 2020 at 16:27)</a>:</h4>
<p>Also, do check the CapabilityStatement and confirm the server supports the <code>near</code> search operator.   A <code>near</code> operator is something of a specialized usecase, and requires either a dedicated geospatial mapping library on the server, or a geospatial index on the database (preferably both).  There's quite a few sandboxes out there in the world that might have Rest enabled for the Location resources, but not have implemented the search operator yet.</p>



<a name="193452525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193452525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcelo Cabello <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193452525">(Apr 09 2020 at 13:50)</a>:</h4>
<p>That's rigth <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> , but the spec of dstu3 shows  ":"<br>
dstu3 -&gt; Location?near=-83.694810:42.256500&amp;near-distance=11.20||km...<br>
r4 -&gt; Location?near=-83.694810|42.256500|11.20|km...<br>
Cheers!</p>
<p>Thanks <span class="user-mention" data-user-id="191678">@Abigail Watson</span> , I always have to check in CapStatement for every new operation that I want to use. Fortunately, 4.2 from Hapi uses these modifiers. <br>
The spec defines modifiers near/neardistance , but I guess algorithms which calculate distance belong to the implementation server. We developed a proof of concept using googlemaps api key, but regarding your advice, do you meant I MUST/SHOULD use another geospatial support ??</p>



<a name="193454142"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193454142" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcelo Cabello <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193454142">(Apr 09 2020 at 14:02)</a>:</h4>
<p>Hmmm... I was thinking: to calculate the distance between my position and Location resources could I use also the google api key or other similar to calculate distance and show that as a response through the near / neardistance modifiers.</p>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> could you tell how works the algorithms in hapi 4.2 to the use case "give me a list of locations near me inside 5 kms?" Can I simply take it and use it or do I need another support as Abigail mentioned?</p>



<a name="193463811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193463811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193463811">(Apr 09 2020 at 15:13)</a>:</h4>
<p>DSTU3 was in error, but given that it's a narrative issue, not something we'll be fixing.</p>



<a name="193468044"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193468044" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193468044">(Apr 09 2020 at 15:42)</a>:</h4>
<p>If HAPI has them listed in the CapabilityStatement, you should be good to go.  Just be aware that other servers might support Location REST endpoints, but not the <code>near</code> search operator.  So you may run into hiccups if you point your app at a different sandbox or production server.  </p>
<p>We use the Mongo API and a specialized client side Minimongo library that supports in-memory <code>$near</code> operations.  So, rather than asking the server to calculate the nearest locations, we like to fetch the entire dataset when possible, and do our own proximity calculations.</p>



<a name="193493065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/near%20%26%20neardistance%20modifiers%20in%20fhir-client.min-js/near/193493065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/near.20.26.20neardistance.20modifiers.20in.20fhir-client.2Emin-js.html#193493065">(Apr 09 2020 at 18:47)</a>:</h4>
<p><span class="user-mention" data-user-id="193556">@Marcelo Cabello</span> near is supported in HAPI as of 4.2.0. We use a pretty naive "box" algorithm that simply draws a rectangular box around the point you gave and finds Locations within it (as opposed to a radius search, which we are also planning on implementing in the future)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
