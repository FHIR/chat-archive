---
layout: page
title: "FHIR Chat  · Observation constraints · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html">Observation constraints</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153959692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153959692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153959692">(May 13 2018 at 13:19)</a>:</h4>
<p>We currently get two warnings when validating Observations on HAPI against core:</p>
<div class="codehilite"><pre><span></span>  &quot;diagnostics&quot;: &quot;All observations should have a performer&quot;,
  &quot;diagnostics&quot;: &quot;All observations should have an effectiveDateTime or an effectivePeriod&quot;,
</pre></div>


<p>but we can't trace them back to any requirement7constraint in the spec. Is there an invariant we're not seeing or is HAPI just making this up?</p>



<a name="153959693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153959693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153959693">(May 13 2018 at 13:22)</a>:</h4>
<p>VONK doesn't show any similar warnings. I'd like to test Grahame's server too, but it's down...</p>



<a name="153959694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153959694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153959694">(May 13 2018 at 13:26)</a>:</h4>
<p>Ok, we found it. It's actually hardcoded into hapi...</p>



<a name="153960629"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153960629" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Mohan Tumuluri <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153960629">(May 14 2018 at 19:49)</a>:</h4>
<p>Its actually hardcoded in the Java RI at <a href="https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.validation/src/org/hl7/fhir/r4/validation/InstanceValidator.java#L3617" target="_blank" title="https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.validation/src/org/hl7/fhir/r4/validation/InstanceValidator.java#L3617">https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.validation/src/org/hl7/fhir/r4/validation/InstanceValidator.java#L3617</a>. It would be great if this can be fixed in Java RI.</p>



<a name="153960710"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153960710" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153960710">(May 14 2018 at 21:07)</a>:</h4>
<p>what's wrong with them?</p>



<a name="153960747"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153960747" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Mohan Tumuluri <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153960747">(May 14 2018 at 22:27)</a>:</h4>
<p>All of Observation.subject, Observation.performer, Observation.effective[x] are optional according to the StructureDefinition and AFAIK  there are no constraints that make them mandatory.</p>



<a name="153960749"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153960749" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Mohan Tumuluri <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153960749">(May 14 2018 at 22:28)</a>:</h4>
<p>So the question is why are they made mandatory in the validator?</p>



<a name="153960754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153960754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Mohan Tumuluri <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153960754">(May 14 2018 at 22:47)</a>:</h4>
<p>Moreover, Observation.performer has a cardinality of 0..*, whereas the code above expects only a single value (it calls getNamedChild from <a href="https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.r4/src/org/hl7/fhir/r4/elementmodel/Element.java#L476" target="_blank" title="https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.r4/src/org/hl7/fhir/r4/elementmodel/Element.java#L476">https://github.com/hl7-fhir/fhir-svn/blob/master/implementations/java/org.hl7.fhir.r4/src/org/hl7/fhir/r4/elementmodel/Element.java#L476</a>) which fails with the error "Attempt to read a single element when there is more than one present" when you send an observation with multiple performers. <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="153960764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153960764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153960764">(May 15 2018 at 03:06)</a>:</h4>
<p>they are not made mandatory. It's a warning. And I think it's a good warning. But I definitely should fix the bug</p>



<a name="153961366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Mohan Tumuluri <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961366">(May 15 2018 at 20:29)</a>:</h4>
<p>I agree that those are good warnings, but such warnings are applicable to other resources as well and are not limited to Observations. I think its best to let profiles define such constraints and have the validator only validate based on base/profiles.</p>



<a name="153961368"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961368" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961368">(May 15 2018 at 20:41)</a>:</h4>
<p>That was dropped a couple of releases ago, but I guess James never changed his rules.  Please submit a change request to get us to add the clarifying wording.</p>



<a name="153961369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961369">(May 15 2018 at 20:41)</a>:</h4>
<p>ok</p>



<a name="153961373"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961373" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961373">(May 15 2018 at 20:46)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="153961388"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961388" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961388">(May 15 2018 at 21:35)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> what do you think was dropped a couple of releases ago? that error looks like it comes from the validator you and I maintain, not HAPI code</p>



<a name="153961392"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961392" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961392">(May 15 2018 at 21:37)</a>:</h4>
<p>I thought we had dropped support for OIDs as temporary ids?</p>



<a name="153961393"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961393" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961393">(May 15 2018 at 21:40)</a>:</h4>
<p>OIDs?</p>



<a name="153961395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961395">(May 15 2018 at 21:44)</a>:</h4>
<p>Sorry, post was made to wrong thread.  Should have gone under "temporary id"</p>



<a name="153961410"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961410" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Mohan Tumuluri <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961410">(May 15 2018 at 23:39)</a>:</h4>
<p>Should I submit a change request for the removal of extra Observation checks? The other not-so-great solution for me is to fork and maintain InstanceValidator which is a pain given the amount of change it goes through.</p>



<a name="153961501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simone Heckmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961501">(May 16 2018 at 08:13)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="191451">@Patrick Werner</span> my have already done that?</p>



<a name="153961524"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961524" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961524">(May 16 2018 at 08:35)</a>:</h4>
<p>Hi Anand, i already reported this unexpected behavior:<br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17147&amp;start=0" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17147&amp;start=0">GF17147</a></p>



<a name="153961525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961525">(May 16 2018 at 08:39)</a>:</h4>
<p>i also reported it to hapi:<br>
<a href="https://github.com/jamesagnew/hapi-fhir/issues/942" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/issues/942">https://github.com/jamesagnew/hapi-fhir/issues/942</a><br>
Where James stated, that these are disabled by default now (which they are not as i can see in the code).<br>
But you can disable them in the jpaserver-base config (e.g. BaseR4Config.java)</p>



<a name="153961938"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153961938" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anand Mohan Tumuluri <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153961938">(May 16 2018 at 14:20)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191451">@Patrick Werner</span> . I can disable the best practice checks using RI too but the issue around Observation having multiple performers can not be fixed without changing InstanceValidator. I am interested in a fix for that.</p>



<a name="153963038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Observation%20constraints/near/153963038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Observation.20constraints.html#153963038">(May 17 2018 at 08:29)</a>:</h4>
<p><span class="user-mention" data-user-id="192218">@Anand Mohan Tumuluri</span> <br>
i fixed it in HAPI, which works for now, until the next RI import of hapi.</p>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <br>
fix: <a href="https://github.com/jamesagnew/hapi-fhir/pull/951/files" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/pull/951/files">https://github.com/jamesagnew/hapi-fhir/pull/951/files</a><br>
<a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17221&amp;start=0" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=17221&amp;start=0">GF17221</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
