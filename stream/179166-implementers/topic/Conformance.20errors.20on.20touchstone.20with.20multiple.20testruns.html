---
layout: page
title: "FHIR Chat  · Conformance errors on touchstone with multiple testruns · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html">Conformance errors on touchstone with multiple testruns</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="160892354"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/160892354" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Apolloner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#160892354">(Mar 15 2019 at 16:52)</a>:</h4>
<p>So I am trying to get a few tests running on <a href="https://touchstone.aegis.net/" target="_blank" title="https://touchstone.aegis.net/">https://touchstone.aegis.net/</a> -- so far so good. What I have noted is that if I select any of the basic XML tests (for instance /FHIR3-0-1-Basic/I-O/Organization/Client Assigned Id/Organization-client-id-xml ) and then later run the same JSON tests against my server (without emptying the database) I get the following errors (during Step4-ResourceHistoryInstance): <a href="/user_uploads/10155/RLzDw3y08_73KVj40VXOBDrR/b18a7528-c317-4e17-9d6c-2927c28cc674.png" target="_blank" title="b18a7528-c317-4e17-9d6c-2927c28cc674.png">b18a7528-c317-4e17-9d6c-2927c28cc674.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/RLzDw3y08_73KVj40VXOBDrR/b18a7528-c317-4e17-9d6c-2927c28cc674.png" target="_blank" title="b18a7528-c317-4e17-9d6c-2927c28cc674.png"><img src="/user_uploads/10155/RLzDw3y08_73KVj40VXOBDrR/b18a7528-c317-4e17-9d6c-2927c28cc674.png"></a></div><p>This somewhat makes sense since touchstone reuses the same Ids between the JSON &amp; XML runs. So while the first run is fine (there are no deletions in the history yet) the next one will fail because the history contains a deleted element for which I have a resource with only an ID.</p>
<p>Now I am wondering if this is an oversight in touchstone or if my implementation misses something crucial. Any pointers would be appreciated :)</p>



<a name="160893810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/160893810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#160893810">(Mar 15 2019 at 17:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191370">@Richard Ettema</span> ?</p>



<a name="161062942"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/161062942" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#161062942">(Mar 18 2019 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="213323">@Florian Apolloner</span>, I have reviewed your test results for the Organization history interaction in the /FHIR3-0-1-Basic/I-O/Organization/Client Assigned Id/Organization-client-id-xml execution. The validation assert is correctly evaluating your history Bundle.</p>
<p>Touchstone incorporates the FHIR validation engine from the FHIR specification Java code. The validation of a Bundle invokes validation for each contained Bundle.entry.resource. So, in this case each individual Organization resource is validated for conformance to the FHIR specification. The validation errors in this test execution from this assert:</p>
<blockquote>
<p>Validation of response body against profile '<a href="http://hl7.org/fhir/StructureDefinition/Bundle" target="_blank" title="http://hl7.org/fhir/StructureDefinition/Bundle">http://hl7.org/fhir/StructureDefinition/Bundle</a>' by FHIR specification's Validation Engine produced the following results:</p>
<p>1. ERROR: The organization SHALL at least have a name or an id, and possibly more than one [(identifier.count() + name.count()) &gt; 0]. Location: Bundle.entry[3].resource (line 1, col3978).<br>
2. ERROR: The organization SHALL at least have a name or an id, and possibly more than one [(identifier.count() + name.count()) &gt; 0]. Location: Bundle.entry[4].resource (line 1, col4469).</p>
</blockquote>
<p>are both produced via the Organization 'org-1' constraint - please see: <a href="http://hl7.org/fhir/STU3/organization.html#invs" target="_blank" title="http://hl7.org/fhir/STU3/organization.html#invs">http://hl7.org/fhir/STU3/organization.html#invs</a></p>



<a name="161063562"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/161063562" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#161063562">(Mar 18 2019 at 14:48)</a>:</h4>
<p>The history interaction states in the specification, <a href="http://hl7.org/fhir/STU3/http.html#history" target="_blank" title="http://hl7.org/fhir/STU3/http.html#history">http://hl7.org/fhir/STU3/http.html#history</a>, the following (snipped):</p>
<blockquote>
<p>If the entry.request.method is a PUT or a POST, the entry SHALL contain a resource</p>
</blockquote>
<p>The DELETE method is expected to follow the delete interaction definition, <a href="http://hl7.org/fhir/STU3/http.html#delete" target="_blank" title="http://hl7.org/fhir/STU3/http.html#delete">http://hl7.org/fhir/STU3/http.html#delete</a>, where it states (snipped):</p>
<blockquote>
<p>For servers that maintain a version history, the delete interaction does not remove a resource's version history. From a version history respect, deleting a resource is the equivalent of creating a special kind of history entry that <strong>has no content</strong> and is marked as deleted. Note that there is no support for deleting past versions - see notes on the history interaction.</p>
</blockquote>
<p>Since the deleted resource <strong>has no content</strong>, the history Bundle.entry.resource for a deleted resource version is expected to not be present.</p>



<a name="161063752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/161063752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#161063752">(Mar 18 2019 at 14:50)</a>:</h4>
<p>For future reference, you may post Touchstone specific questions, comments, issues in the <a class="stream" data-stream-id="179217" href="/#narrow/stream/179217-Touchstone">#Touchstone</a> stream. You may also send any support issues to our Touchstone Support Team at <a href="mailto:Touchstone_Support@aegis.net" title="mailto:Touchstone_Support@aegis.net">Touchstone_Support@aegis.net</a>.</p>



<a name="161100960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/161100960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Apolloner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#161100960">(Mar 18 2019 at 22:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191370">@Richard Ettema</span> Thanks, I've also found this out after a discussion in <a href="#narrow/stream/179166-implementers/topic/Search.20by.20_lastUpdated.20for.20deleted.20resources.3F" title="#narrow/stream/179166-implementers/topic/Search.20by.20_lastUpdated.20for.20deleted.20resources.3F">https://chat.fhir.org/#narrow/stream/179166-implementers/topic/Search.20by.20_lastUpdated.20for.20deleted.20resources.3F</a> -- apparently at least hapi and Google cloud keep an "empty" resource with just an ID even for deleted entries. This led me to believe that this is how the specification should be read, apologies for the mistake.</p>



<a name="161130166"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/161130166" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Apolloner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#161130166">(Mar 19 2019 at 08:24)</a>:</h4>
<p>On a second thought, does this also mean that a history bundle cannot include fullUrl for deleted entries due to the 'bdl-7' constraint? (bdl-7: FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (expression : entry.where(fullUrl).select(fullUrl&amp;resource.meta.versionId).isDistinct()))</p>



<a name="161159611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/161159611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#161159611">(Mar 19 2019 at 15:16)</a>:</h4>
<p>That's a really good question.  It would primarily be an issue where an item had been deleted twice.  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191328">@Ewout Kramer</span> ?</p>



<a name="161182820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Conformance%20errors%20on%20touchstone%20with%20multiple%20testruns/near/161182820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Conformance.20errors.20on.20touchstone.20with.20multiple.20testruns.html#161182820">(Mar 19 2019 at 19:33)</a>:</h4>
<p>we revoked that in R4 for this reason (amongst others)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
