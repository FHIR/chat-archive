---
layout: page
title: "FHIR Chat  · exit code validator · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html">exit code validator</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="202682210"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202682210" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202682210">(Jul 02 2020 at 12:44)</a>:</h4>
<p>I am using the validator(5.0.7) to validate a folder of FHIR profiles as part of our build pipeline. Success of the build depends on the exit code of the validator.  </p>
<p>Validation errors set the exit code to !=0 what means an error this also shows in the output of the validator. This is ok as an error was found and our build fails.<br>
But during validation the validator tries to make snapshots ( I do not use the -snapshot argument). The creation of these snapshots fails in this case due to "is not a valid constraint on the base". But after this failure the validator continues and validation of the same profile succeeds without any error, warning or info. </p>
<p>1)Should the exit code of the validator not indicates an error after snapshot generation fails during validation? Meaning being set to anything !=0.<br>
2)It is strange to me that validation of a profile can succeed even when the snapshot generation for the same profile during the validation fails.</p>
<p>I see the same behavior of the validator for R4 and STU3</p>



<a name="202687166"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202687166" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202687166">(Jul 02 2020 at 13:24)</a>:</h4>
<p>hmm. the trouble is that I may not know whether the snapshot that failed is critical for the outcome.</p>



<a name="202687331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202687331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202687331">(Jul 02 2020 at 13:25)</a>:</h4>
<p>can you give me a nice precise set up that I can add as a test case that reproduces your scenario?</p>



<a name="202708371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202708371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202708371">(Jul 02 2020 at 16:01)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  I have send the profiles and the commands used via mail. It will have the same result as shown below.</p>
<div class="codehilite"><pre><span></span><code>Detected Java version: 13.0.1 from /usr/java/openjdk-13 on amd64 (64bit). 4012MB available
Arguments: SkinQuestionnaireResponse.structuredefinition.xml -version 3.0 -ig /usr/data/npmpackage/package -ig hl7.fhir.uv.sdc#2.0.0 -recurse
Directories: Current = /usr/data/npmpackage/package, Package Cache = /home/tfsagent/.fhir/packages
 .. FHIR Version 3.0, definitions from hl7.fhir.r3.core#3.0.2
 .. connect to tx server @ http://tx.fhir.org
 (v3.0.2)
+ .. load IG from /usr/data/npmpackage/package
+ .. load IG from hl7.fhir.uv.sdc#2.0.0
 .. validate [SkinQuestionnaireResponse.structuredefinition.xml]
Unable to generate snapshot for SkinQuestionnaireResponse from ILS-QuestionnaireResponse because Profile SkinQuestionnaireResponse (https://www.fhir.philips.com/3.0/StructureDefinition/personalHealth/skin/skinIssueQuestionnaire-v1/SkinQuestionnaireResponse), element QuestionnaireResponse.questionnaire. Error generating snapshot: The target profile https://www.fhir.philips.com/3.0/StructureDefinition/common/resource/general/questionnaireResponse-v1/ILS-QuestionnaireResponse is not a valid constraint on the base ([CanonicalType[http://hl7.org/fhir/StructureDefinition/Questionnaire]]) at QuestionnaireResponse.questionnaire
org.hl7.fhir.exceptions.DefinitionException: Profile SkinQuestionnaireResponse (https://www.fhir.philips.com/3.0/StructureDefinition/personalHealth/skin/skinIssueQuestionnaire-v1/SkinQuestionnaireResponse), element QuestionnaireResponse.questionnaire. Error generating snapshot: The target profile https://www.fhir.philips.com/3.0/StructureDefinition/common/resource/general/questionnaireResponse-v1/ILS-QuestionnaireResponse is not a valid constraint on the base ([CanonicalType[http://hl7.org/fhir/StructureDefinition/Questionnaire]]) at QuestionnaireResponse.questionnaire
    at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:675)
    at org.hl7.fhir.r5.context.SimpleWorkerContext.generateSnapshot(SimpleWorkerContext.java:646)
    at org.hl7.fhir.r5.context.SimpleWorkerContext.allStructures(SimpleWorkerContext.java:529)
    at org.hl7.fhir.validation.ValidationEngine.prepare(ValidationEngine.java:1315)
    at org.hl7.fhir.validation.cli.services.ValidationService.validateSources(ValidationService.java:53)
    at org.hl7.fhir.validation.Validator.main(Validator.java:202)
Success...validating SkinQuestionnaireResponse.structuredefinition.xml: error:0 warn:0 info:0```
</code></pre></div>



<a name="202757464"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202757464" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202757464">(Jul 03 2020 at 00:04)</a>:</h4>
<p>yes I thought this one wouldn't be easy to fix. The <code>unable to generate...</code> message is not germane to the outcome of the validation, so it doesn't feature in the exit code</p>



<a name="202782141"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202782141" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202782141">(Jul 03 2020 at 09:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  Thanks for looking into it. Is this something that will be fixed so that I get an error exit code. Or maybe add an additional strictness argument for setting  a strictness level that when set to the max will have all these generation errors and the warnings set an error exit code.</p>



<a name="202784968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202784968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202784968">(Jul 03 2020 at 09:37)</a>:</h4>
<p>well, I worked more on validation of profiles (as opposed to validation by profiles) and you'll get both an error and a exit code from the next release</p>



<a name="202785163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/exit%20code%20validator/near/202785163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans van Amstel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/exit.20code.20validator.html#202785163">(Jul 03 2020 at 09:39)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  Thanks a lot. Looking forward to integrating and using it.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
