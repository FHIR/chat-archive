---
layout: page
title: "FHIR Chat  · hapi-fhir-cli dry-run fails · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi-fhir-cli.20dry-run.20fails.html">hapi-fhir-cli dry-run fails</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="244541578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi-fhir-cli%20dry-run%20fails/near/244541578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jordi Cabré <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi-fhir-cli.20dry-run.20fails.html#244541578">(Jul 01 2021 at 09:47)</a>:</h4>
<p>I'm getting this message:</p>
<div class="codehilite"><pre><span></span><code>2021-07-01 11:34:50.218 [main] ERROR ca.uhn.fhir.cli.App Error during execution:
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [alter table TRM_CONCEPT_DESIG add constraint FK_CONCEPTDESIG_CSV foreign key (CS_VER_PID) references TRM_CODESYSTEM_VER]; nested exception is java.sql.SQLSyntaxErrorException: ORA-00942: table or view does not exist

        at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
        at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1541)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:431)
        at ca.uhn.fhir.jpa.migrate.taskdef.AddTableRawSqlTask.lambda$doExecute$2(AddTableRawSqlTask.java:80)
        at ca.uhn.fhir.jpa.migrate.taskdef.AddTableRawSqlTask$$Lambda$139/0000000038802B70.doInTransaction(Unknown Source)
        at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
        at ca.uhn.fhir.jpa.migrate.taskdef.AddTableRawSqlTask.doExecute(AddTableRawSqlTask.java:76)
        at ca.uhn.fhir.jpa.migrate.taskdef.BaseTask.execute(BaseTask.java:179)
        at ca.uhn.fhir.jpa.migrate.TaskOnlyMigrator.migrate(TaskOnlyMigrator.java:59)
        at ca.uhn.fhir.cli.BaseFlywayMigrateDatabaseCommand.run(BaseFlywayMigrateDatabaseCommand.java:137)
        at ca.uhn.fhir.cli.HapiFlywayMigrateDatabaseCommand.run(HapiFlywayMigrateDatabaseCommand.java:56)
        at ca.uhn.fhir.cli.BaseApp.run(BaseApp.java:269)
        at ca.uhn.fhir.cli.App.main(App.java:43)
Caused by: java.sql.SQLSyntaxErrorException: ORA-00942: table or view does not exist

        at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:494)
        at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:446)
        at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1054)
        at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:623)
        at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:252)
        at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:612)
        at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:213)
        at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:37)
        at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:896)
        at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1119)
        at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1737)
        at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1692)
        at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:300)
        at org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:194)
        at org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:194)
        at org.springframework.jdbc.core.JdbcTemplate$1ExecuteStatementCallback.doInStatement(JdbcTemplate.java:422)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
        ... 11 common frames omitted
Caused by: oracle.jdbc.OracleDatabaseException: ORA-00942: table or view does not exist

        at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)
        ... 27 common frames omitted
2021-07-01 11:34:50.231 [Thread-3] INFO  ca.uhn.fhir.cli.App HAPI FHIR is shutting down...
</code></pre></div>
<p>My database is absolutely empty, and I'm using <code>--dry-run</code> option in order to get sql statements.</p>
<p>My command is:</p>
<div class="codehilite"><pre><span></span><code>java -cp hapi-fhir-cli.jar:/home/jeusdi/projects/workarea/salut/mpi/ojdbc8.jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000 ca.uhn.fhir.cli.App migrate-database -d ORACLE_12C -n HES_MPI_TEST_ADM -p hesmpitestadm4des -u jdbc:oracle:thin:@10.49.160.114:1521:ORCLCDB --dry-run
</code></pre></div>
<p>Any ideas?</p>



<a name="244543450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi-fhir-cli%20dry-run%20fails/near/244543450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jordi Cabré <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi-fhir-cli.20dry-run.20fails.html#244543450">(Jul 01 2021 at 10:06)</a>:</h4>
<p>Currently, I'm getting this other message:</p>
<div class="codehilite"><pre><span></span><code>2021-07-01 12:04:14.345 [main] INFO  c.u.f.j.m.TaskOnlyMigrator Dry run 4_0_0.20190722.29 Rename column CODE to CODEVAL on table TRM_CONCEPT
2021-07-01 12:04:14.440 [main] ERROR ca.uhn.fhir.cli.App Error during execution:
ca.uhn.fhir.rest.server.exceptions.InternalErrorException: Can not rename TRM_CONCEPT.CODE to CODEVAL because neither column exists!
    at ca.uhn.fhir.jpa.migrate.TaskOnlyMigrator.migrate(TaskOnlyMigrator.java:62)
    at ca.uhn.fhir.cli.BaseFlywayMigrateDatabaseCommand.run(BaseFlywayMigrateDatabaseCommand.java:137)
    at ca.uhn.fhir.cli.HapiFlywayMigrateDatabaseCommand.run(HapiFlywayMigrateDatabaseCommand.java:56)
    at ca.uhn.fhir.cli.BaseApp.run(BaseApp.java:269)
    at ca.uhn.fhir.cli.App.main(App.java:43)
Caused by: java.sql.SQLException: Can not rename TRM_CONCEPT.CODE to CODEVAL because neither column exists!
    at ca.uhn.fhir.jpa.migrate.taskdef.RenameColumnTask.doExecute(RenameColumnTask.java:114)
    at ca.uhn.fhir.jpa.migrate.taskdef.BaseTask.execute(BaseTask.java:179)
    at ca.uhn.fhir.jpa.migrate.TaskOnlyMigrator.migrate(TaskOnlyMigrator.java:59)
    ... 4 common frames omitted
</code></pre></div>



<a name="244544208"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi-fhir-cli%20dry-run%20fails/near/244544208" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jordi Cabré <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi-fhir-cli.20dry-run.20fails.html#244544208">(Jul 01 2021 at 10:13)</a>:</h4>
<p>I've just realized that:<br>
 1) <code>--dry-run</code> is creating tables on my database <span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span> <br>
 2) Each time I perform my command I'm getting different messages:</p>
<div class="codehilite"><pre><span></span><code>* `bad SQL grammar [alter table TRM_CONCEPT_MAP add constraint FK_TRMCONCEPTMAP_RES foreign key (RES_ID) references HFJ_RESOURCE]`
</code></pre></div>

<p>* <code>bad SQL grammar [alter table TRM_CONCEPT_PROPERTY add constraint FK_CONCEPTPROP_CSV foreign key (CS_VER_PID) references TRM_CODESYSTEM_VER];</code><br>
  * ...</p>



<a name="244545569"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi-fhir-cli%20dry-run%20fails/near/244545569" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jordi Cabré <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi-fhir-cli.20dry-run.20fails.html#244545569">(Jul 01 2021 at 10:26)</a>:</h4>
<p>My goal is to get sql statements scripts... Any idea?</p>



<a name="244577960"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/hapi-fhir-cli%20dry-run%20fails/near/244577960" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vassil Peytchev <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/hapi-fhir-cli.20dry-run.20fails.html#244577960">(Jul 01 2021 at 14:46)</a>:</h4>
<p>If that is happening on a HAPI server, you can probably get better responses on the <a class="stream" data-stream-id="179167" href="/#narrow/stream/179167-hapi">#hapi</a> channel...</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
