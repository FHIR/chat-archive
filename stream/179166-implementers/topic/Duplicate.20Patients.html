---
layout: page
title: "FHIR Chat  · Duplicate Patients · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html">Duplicate Patients</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="169651271"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169651271" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Quintonn <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169651271">(Jul 04 2019 at 14:10)</a>:</h4>
<p>Hi,<br>
I am using HAPI Fhir Server and I'm testing sending FHIR messages to it.<br>
I've sent the same Patient FHIR Resource to the server and it created 2 different Patient resources.<br>
Should it not have detected they are the same patient?<br>
Or are there some settings I have to set?</p>



<a name="169651790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169651790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169651790">(Jul 04 2019 at 14:18)</a>:</h4>
<p>In REST, the burden is (mostly) upon the client to ensure it doesn't create duplicates. <br>
HAPI doesn't truly support FHIR messaging unless you wrote your own operation (e.g. $process-message) to define how a message should be processed. If you're posting a FHIR message to the root endpont the server will ignore the fact that it's a message and process it like any other bundle, and it will POST all of the resources contained in the message. If you send the same message twice, it will create all resources twice.</p>



<a name="169651856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169651856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Quintonn <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169651856">(Jul 04 2019 at 14:19)</a>:</h4>
<p>thank you for that.<br>
And if I do a search on the identifier i should see the same patient twice?</p>



<a name="169652108"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169652108" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Quintonn <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169652108">(Jul 04 2019 at 14:22)</a>:</h4>
<p>actuall i can confirm that is indeed the case.<br>
So there is no setting or anything that control this?<br>
Or maybe I can add some java code somewhere?</p>



<a name="169652702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169652702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169652702">(Jul 04 2019 at 14:32)</a>:</h4>
<p>I would suggest writing your own code to handle this. You could do as Rene suggested or create a facade on top of the server that implements your business rules and logic. <br>
I've tended to use the facade pattern as I can change the FHIR server behind it without too much hassle.</p>



<a name="169652833"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169652833" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Quintonn <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169652833">(Jul 04 2019 at 14:33)</a>:</h4>
<p>is there any documentation anywhere that can give me some ideas where to start?</p>



<a name="169653414"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169653414" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Quintonn <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169653414">(Jul 04 2019 at 14:41)</a>:</h4>
<p>Using If-None-Exist http header worked. It prevents further duplication</p>



<a name="169654232"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169654232" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169654232">(Jul 04 2019 at 14:53)</a>:</h4>
<p>Prevention of duplicates is a business rule.  The server has to decide what constitutes a duplicate and act to prevent them.  For example, is it prohibited for multiple patient records to exist with the same social insurance number?  In some systems yes, in others no.  Our public test servers don't enforce any business rules so they'll allow duplicates of anything.</p>



<a name="169677083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169677083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Reinhold <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169677083">(Jul 05 2019 at 00:20)</a>:</h4>
<blockquote>
<p>Using If-None-Exist http header worked. It prevents further duplication</p>
</blockquote>
<p><span class="user-mention" data-user-id="229067">@Quintonn</span> I also use the conditional create to prevent data duplication However, that is an expensive transaction for the server. So I create a duplicate detection filter. Since I am only uploading Patient, Device and Observation resources, I can prevent re-uploading the Patient and Device resources by linking the if-none-exist parameter to the logical id in the server's response. When my if-none-exist parameter has a logical id associated with it, I dont re-upload it. For Observations from the same Patient and Device use time stamping to filter. It works quite well and saves bandwidth.</p>



<a name="169735412"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169735412" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169735412">(Jul 05 2019 at 20:54)</a>:</h4>
<p>I'll chime in that for our server implementation of Patient.create, we will always perform a duplicate check before creating.  If we find a single high threshold match, we will return that patient as if it were the one you created (i.e. we will "lie" and say we created a new patient for you, when in fact we didn't).    </p>
<p>Related to René's comment above about the burden being on the client for preventing duplicates, that can sometimes be true for data within a patient context, but often a client is not permitted to see patients beyond the one they are authorized for, so for Patient specifically, often a client cannot determine if the patient they want to create exists already or not.</p>



<a name="169735488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169735488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169735488">(Jul 05 2019 at 20:56)</a>:</h4>
<p>Also, Conditional Create / If-None-Exist may work for some servers, but some servers may want to control the conditions for creating a patient, and not allow clients that control.</p>



<a name="169753478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/169753478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#169753478">(Jul 06 2019 at 05:45)</a>:</h4>
<p>I fully agree that server will need to do some stuff to avoid duplicates, but to me that adds a layer above and beyond "pure REST" (or rather: pure CRUD). You used the wording "the server will 'lie' to you" to indicate that you also consider this behavior (while necessary) not to be entirely in the spirit of REST :-) .. but it'll work just fine.  Question will then be how to expose this server behaviour in a FHIR conformance statement or implementation guide.</p>



<a name="170449911"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/170449911" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kirt Schaper <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#170449911">(Jul 09 2019 at 12:53)</a>:</h4>
<p>Are there any servers which implement the Patient $match operation?</p>



<a name="170468662"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/170468662" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#170468662">(Jul 09 2019 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="191372">@René Spronk</span> I agree - this is beyond "pure REST".  However I think basically every FHIR interaction we have implemented goes beyond pure REST, since for reads we only return the part of the resource that the requester has access to, and for writes (of all sorts) we will always perform some sort of matching / validation.  I think anything other than a toy server has to deviate somewhat from pure REST, otherwise you'd end up with a tangled mess of duplicate data (not just patients, but pretty much any other data type as well).</p>



<a name="170471771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/170471771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Ettema <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#170471771">(Jul 09 2019 at 17:14)</a>:</h4>
<p><span class="user-mention" data-user-id="192901">@Kirt Schaper</span> The AEGIS WildFHIR server supports the Patient $match operation.<br>
FHIR STU3 (v3.0.1): <a href="http://wildfhir3.aegis.net/fhir3-0-1" target="_blank" title="http://wildfhir3.aegis.net/fhir3-0-1">http://wildfhir3.aegis.net/fhir3-0-1</a><br>
FHIR R4 (v4.0.0): <a href="http://wildfhir4.aegis.net/fhir4-0-0" target="_blank" title="http://wildfhir4.aegis.net/fhir4-0-0">http://wildfhir4.aegis.net/fhir4-0-0</a></p>



<a name="170586473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Duplicate%20Patients/near/170586473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Duplicate.20Patients.html#170586473">(Jul 10 2019 at 22:50)</a>:</h4>
<p><a href="http://tx.fhir.org" target="_blank" title="http://tx.fhir.org">tx.fhir.org</a> also supports $match (though the algorithm is not overly intelligent)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
