---
layout: page
title: "FHIR Chat  · FHIRpath test suite · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html">FHIRpath test suite</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153857669"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153857669" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153857669">(Nov 18 2016 at 09:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span>  &amp;  <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  could you share test cases for FHIR path in a format like JSON schema for example <a href="https://github.com/json-schema/json-schema" target="_blank" title="https://github.com/json-schema/json-schema">https://github.com/json-schema/json-schema</a>, o different implementer can test their implementations against it.</p>



<a name="153857674"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153857674" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153857674">(Nov 18 2016 at 10:06)</a>:</h4>
<p>we use xml for test cases because it does comments. See <a href="http://hl7.org/fluentpath/tests.html" target="_blank" title="http://hl7.org/fluentpath/tests.html">http://hl7.org/fluentpath/tests.html</a></p>



<a name="153857702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153857702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153857702">(Nov 18 2016 at 11:08)</a>:</h4>
<p>(and don't really want to maintain multiple formats for it, though you can write a converter for yourself if you like)</p>



<a name="153857704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153857704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153857704">(Nov 18 2016 at 11:14)</a>:</h4>
<p>that should be autoconvertable using standard xml --&gt; json tools</p>



<a name="153864966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864966">(Dec 26 2016 at 18:07)</a>:</h4>
<p>I'm going to implement fhirpath in C for postgresql, clojure &amp; js - could you give me links to existing grammars and we definitely need tests not only in xml, but also in json</p>



<a name="153864968"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864968" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864968">(Dec 26 2016 at 18:22)</a>:</h4>
<p>grammar: <a href="http://hl7.org/fhirpath/grammar.html" target="_blank" title="http://hl7.org/fhirpath/grammar.html">http://hl7.org/fhirpath/grammar.html</a>. We don't have tests in json, but you're welcome to translate them. </p>



<a name="153864969"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864969" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864969">(Dec 26 2016 at 18:57)</a>:</h4>
<p><a href="http://hl7.org/fluentpath/tests.html" target="_blank" title="http://hl7.org/fluentpath/tests.html">http://hl7.org/fluentpath/tests.html</a> - 404 :(</p>



<a name="153864970"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864970" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864970">(Dec 26 2016 at 19:10)</a>:</h4>
<p>Provided grammar is too abstract - so no difference for .name and .count() , where() or .unexistingFn()  :(</p>



<a name="153864971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864971">(Dec 26 2016 at 19:40)</a>:</h4>
<p>Yeah, that's on purpose, we didn't want to put function names in the grammar. The only things in the grammar are operations with syntax.</p>



<a name="153864972"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864972" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864972">(Dec 26 2016 at 19:42)</a>:</h4>
<p>The tests are here, but yes, they're only in XML: </p>



<a name="153864973"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864973" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864973">(Dec 26 2016 at 19:42)</a>:</h4>
<p><a href="https://github.com/FHIR/fluentpath/tree/master/tests" target="_blank" title="https://github.com/FHIR/fluentpath/tree/master/tests">https://github.com/FHIR/fluentpath/tree/master/tests</a></p>



<a name="153864975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864975">(Dec 26 2016 at 20:14)</a>:</h4>
<p>I must have a wrong path on the serer...</p>



<a name="153864976"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864976" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864976">(Dec 26 2016 at 20:14)</a>:</h4>
<p>no. <a href="http://hl7.org/fhirpath/tests.html" target="_blank" title="http://hl7.org/fhirpath/tests.html">http://hl7.org/fhirpath/tests.html</a></p>



<a name="153864977"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864977" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864977">(Dec 26 2016 at 20:49)</a>:</h4>
<p>Here i've started more semantic grammar - <a href="https://gist.github.com/niquola/72f24aeaa3066c9941605adcfd2e0008" target="_blank" title="https://gist.github.com/niquola/72f24aeaa3066c9941605adcfd2e0008">https://gist.github.com/niquola/72f24aeaa3066c9941605adcfd2e0008</a></p>



<a name="153864978"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864978" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864978">(Dec 26 2016 at 22:00)</a>:</h4>
<p>Looks ambiguous:    <code>Patient.name.given = 'Ewout'</code>    could be like  <code>Patient.name.given.concat().some($this = 'Ewout')</code><br>
And again some philosophical note: a lot of features doesn't mean it's great; minimum and sufficient - does!<br>
May be split Fhirpath into <code>minimal-required</code> and <code>fancy-optional</code> parts?</p>



<a name="153864983"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864983" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864983">(Dec 27 2016 at 05:49)</a>:</h4>
<p>all good languages have redundancy. ambiguity is not the same thing</p>



<a name="153864997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864997">(Dec 28 2016 at 13:13)</a>:</h4>
<p>Question: we have [index] syntax in fhirpath, could "index" be fhirpath expression or just integer? Because implicit context it looks like not?!</p>



<a name="153864998"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153864998" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153864998">(Dec 28 2016 at 16:42)</a>:</h4>
<p>Symmetry: why | is operator, but combine (which does almost the same) is function?</p>



<a name="153865000"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865000" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865000">(Dec 28 2016 at 17:02)</a>:</h4>
<p>Could we say that functions like <code>empty</code> or <code>count</code> always should be the last in chain?</p>



<a name="153865013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865013">(Dec 28 2016 at 20:53)</a>:</h4>
<p>I think index could be an expression. I treat it as one</p>



<a name="153865014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865014">(Dec 28 2016 at 20:54)</a>:</h4>
<p>probably combine is a function rather than an operator because we came to it's need later, and adding a function is easier than adding an operator</p>



<a name="153865015"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865015" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865015">(Dec 28 2016 at 20:55)</a>:</h4>
<p>I think empty and count are liekly to be last, but not guaranteed to be</p>



<a name="153865025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Hyland <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865025">(Dec 28 2016 at 23:33)</a>:</h4>
<p>In case those folks on this thread missed it earlier - Richard posted on the testing thread the following:  Everyone,<br>
Just wanted to let you know that a key new feature of Touchstone v3.3.x is the inclusion of support for fhirpath expression evaluation within TestScripts. The following TestScript fhirpath related elements, added for STU3, can now be defined and executed by Touchstone:<br>
variable.expression<br>
assert.expression<br>
assert.compareToSourceExpression</p>



<a name="153865029"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865029" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865029">(Dec 29 2016 at 04:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> oh, operator vs function looks like random choice?  Implicit conversions to collection and back to value also bad idea, which brings indeterminism ;(. It would be nice to have clear deterministic model as foundation for fhirpath. There is well formulated functors, applicative and monads approach to work with collection in a composable way - for example math, string and date operations could be functors <a href="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html#just-what-is-a-functor,-really" target="_blank" title="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html#just-what-is-a-functor,-really">http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html#just-what-is-a-functor,-really</a>. Also take a look at reduce as more generic approach - <a href="http://clojure.com/blog/2012/05/08/reducers-a-library-and-model-for-collection-processing.html" target="_blank" title="http://clojure.com/blog/2012/05/08/reducers-a-library-and-model-for-collection-processing.html">http://clojure.com/blog/2012/05/08/reducers-a-library-and-model-for-collection-processing.html</a> - getting paths in collections, filters, ops like count, empty etc could be expressed as reduce functions. Also we need clearly specify how implicit data context is propagated in functions - here the idea of piping and/or carrying could be used</p>



<a name="153865030"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865030" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865030">(Dec 29 2016 at 04:25)</a>:</h4>
<p>Operators vs functions - in haskell and ocaml all functions of two arguments could be written in infix (operators) notation</p>



<a name="153865031"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865031" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865031">(Dec 29 2016 at 04:27)</a>:</h4>
<p>So grammar quite easily could be written to enable this automatically. </p>



<a name="153865032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865032">(Dec 29 2016 at 04:31)</a>:</h4>
<p>We could treat dot (.) as pipe operation (if we have carrying) or macro (if not)</p>



<a name="153865050"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865050" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865050">(Dec 29 2016 at 19:52)</a>:</h4>
<p>I'm not sure what you mean by implicit conversion to collection and back brings indeterminism?</p>



<a name="153865051"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865051" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865051">(Dec 29 2016 at 19:52)</a>:</h4>
<p>By deterministic, I mean that the expression will give the same result every time it is evaluated.</p>



<a name="153865052"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865052" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865052">(Dec 29 2016 at 19:52)</a>:</h4>
<p>How does implicit conversion to/from a list change that?</p>



<a name="153865056"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865056" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865056">(Dec 29 2016 at 20:25)</a>:</h4>
<p>As far as operator vs function being a random choice, it's not random, it's based on expected usage and traditional expressions. Plus is an infix operator because that's how most people expect to be able to invoke it.</p>



<a name="153865058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865058">(Dec 29 2016 at 20:36)</a>:</h4>
<p>the discussion started with a single case where we might have defined an operator instead of a function, but didn't</p>



<a name="153865059"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865059" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865059">(Dec 29 2016 at 20:41)</a>:</h4>
<p>So I think in that case, (| vs combine), we defined an infix operator because we expected to be doing lots more unioninig than combining.</p>



<a name="153865060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865060">(Dec 29 2016 at 20:49)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> i mean indeterministic by different implementations ( i think <em>unspecified behaviour</em> is better word): for example you have <code>some.expression &gt; 2</code> where some expression evaluated into [1,2,3] and we got  =&gt; <code>[1,2,3] &gt; 2 </code> - what result should we expect?</p>



<a name="153865061"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865061" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865061">(Dec 29 2016 at 20:50)</a>:</h4>
<p>If we always distinct list vs value operations, we could be accurate and  precise:   <code>expression.some( $this &gt; 2)  or expression.all($this &gt; 2)</code></p>



<a name="153865062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865062">(Dec 29 2016 at 20:59)</a>:</h4>
<p>@<strong>nicola (RIO)</strong> in that case we expect a run-time error because the "&gt;" operator expects singleton inputs. The specification indicates that when an operator that expects a singleton input is given a collection with more than one element at runtime, that an error is thrown.</p>



<a name="153865063"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865063" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865063">(Dec 29 2016 at 21:01)</a>:</h4>
<p>If you want to return only elements that are greater than 2, you use a where: <code>expression.some.where($this &gt; 2)</code></p>



<a name="153865064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865064">(Dec 29 2016 at 21:12)</a>:</h4>
<p>No, i mean logical operation</p>



<a name="153865065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865065">(Dec 29 2016 at 21:15)</a>:</h4>
<p>What about    <code>name.given = 'Smith'</code>, should it fail if <code>given.count &gt; 1</code>?</p>



<a name="153865066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865066">(Dec 29 2016 at 21:16)</a>:</h4>
<p>Yes.</p>



<a name="153865067"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865067" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865067">(Dec 29 2016 at 21:18)</a>:</h4>
<p>I mean, if we introduce explicit conversion to/from collection and forbid such type of implicit operations on collection with one item - it will be much less frustrating :)</p>



<a name="153865068"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865068" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865068">(Dec 29 2016 at 21:19)</a>:</h4>
<p><code>name.given.where($this = 'Smith').exists()</code> and <code>name.given[0] = 'Smith'</code></p>



<a name="153865069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865069">(Dec 29 2016 at 21:19)</a>:</h4>
<p>So, in the CQL usage, we have defined an option to indicate whether or not those types of implicit conversions to and from lists are allowed.</p>



<a name="153865070"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865070" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865070">(Dec 29 2016 at 21:20)</a>:</h4>
<p>But FHIRPath itself allows you to make that decision as part of the implementation.</p>



<a name="153865071"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865071" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865071">(Dec 29 2016 at 21:20)</a>:</h4>
<p>The point being that if you as the author know that .given will only have one element, then the compiler shouldn't prevent you from expressing something that you know will work.</p>



<a name="153865072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865072">(Dec 29 2016 at 21:23)</a>:</h4>
<p>Bad parts of javascript is good  evidence, that such decisions are evil. Let say you use such ubiquitous expression as invariant in some national profile?</p>



<a name="153865073"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865073" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865073">(Dec 29 2016 at 21:25)</a>:</h4>
<p>I agree there are cases where you don't want to allow that kind of flexibility, but there are cases where you do want it too, so the specification allows the more general, and implementations can impose the more strict interpretation as necessary.</p>



<a name="153865074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865074">(Dec 29 2016 at 21:26)</a>:</h4>
<p>Hey, we are talking about interop :)</p>



<a name="153865075"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865075" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865075">(Dec 29 2016 at 21:26)</a>:</h4>
<p>So fhirpath is not interoperable?</p>



<a name="153865076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865076">(Dec 29 2016 at 21:27)</a>:</h4>
<p>That's a pretty broad generalization.</p>



<a name="153865077"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865077" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865077">(Dec 29 2016 at 21:27)</a>:</h4>
<p>I'm not even sure what it means. :)</p>



<a name="153865078"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865078" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865078">(Dec 29 2016 at 21:28)</a>:</h4>
<p>Why - if some expressions could be interpreted by different implementations differently - is this interoperability? And this expressions will be in the heart of search, validation etc.</p>



<a name="153865079"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865079" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865079">(Dec 29 2016 at 21:28)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span> what do you think?</p>



<a name="153865080"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865080" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865080">(Dec 29 2016 at 21:29)</a>:</h4>
<p>Part of using an invariant within a given environment would require that you specify the behavior so that different implementations would get the same interpretation.</p>



<a name="153865081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865081">(Dec 29 2016 at 21:30)</a>:</h4>
<p>Within the FHIR specification specifically, invariants are allowed to use the implicit conversions to/from lists, but the implementations are expected to throw when singleton expectations are violated. I don't see how that results in a spec that is not interoperable?</p>



<a name="153865082"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865082" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865082">(Dec 29 2016 at 21:34)</a>:</h4>
<p>It's like runtime and compile time errors. What if this expression is used in indexing function in database :/  </p>



<a name="153865083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865083">(Dec 29 2016 at 21:36)</a>:</h4>
<p>And it's just a matter of one additional operation to be precise!</p>



<a name="153865084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865084">(Dec 29 2016 at 21:36)</a>:</h4>
<p>No, you'd need to support ordering as well, but that's a different issue.</p>



<a name="153865085"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865085" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Hyland <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865085">(Dec 29 2016 at 21:38)</a>:</h4>
<p>Note: it would be good to capture some of these implementations details (in test cases), and leverage testing to both see what works well, but to ensure folks are (where important) implementing this in a way which supports being interoperable :) - our approach is to avoid exclusive "happy path" testing, we would like to throw some of these examples which would be negative test case.  If anyone is able to articulate on this thread a negative (exception) test case, we will evaluate how to test for it - during an FHIR message exchange.</p>



<a name="153865086"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865086" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865086">(Dec 29 2016 at 21:39)</a>:</h4>
<p>And I agree, it's like runtime vs compile-time errors, and some implementations can choose to use compile-time errors, and some can use runtime. FHIRPath allows both. Within FHIR, FHIRPath invariants use runtime because there are lots of cases where the authors know (based on profile information that may or may not be available to the compiler) that a given expression will work, where a strict compiler would force them to use an extra operator.</p>



<a name="153865087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865087">(Dec 29 2016 at 21:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191460">@Mario Hyland</span> There are several negative test cases in the FHIRPath test suite: <a href="https://github.com/FHIR/fluentpath/tree/master/tests" target="_blank" title="https://github.com/FHIR/fluentpath/tree/master/tests">https://github.com/FHIR/fluentpath/tree/master/tests</a></p>



<a name="153865088"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865088" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865088">(Dec 29 2016 at 21:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> fhirpath also missed <code>min</code> and <code>max</code> functions!</p>



<a name="153865089"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865089" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865089">(Dec 29 2016 at 21:43)</a>:</h4>
<p>Haven't needed them so far.</p>



<a name="153865090"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865090" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865090">(Dec 29 2016 at 21:43)</a>:</h4>
<p>The intent of FHIRPath is to be sufficient.</p>



<a name="153865091"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865091" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865091">(Dec 29 2016 at 21:44)</a>:</h4>
<p>The simple place you need it is specify expressions for sorting in search.</p>



<a name="153865092"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865092" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865092">(Dec 29 2016 at 21:45)</a>:</h4>
<p>I think all this mess with collection/value is result of <code>xml</code>ish  thinking :)</p>



<a name="153865093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865093">(Dec 29 2016 at 21:46)</a>:</h4>
<p>Comparison operators can define expressions for sorting in search.</p>



<a name="153865094"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865094" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865094">(Dec 29 2016 at 21:47)</a>:</h4>
<p>I mean, you need expression to extract value by which you will sort - to build index</p>



<a name="153865097"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865097" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865097">(Dec 29 2016 at 22:21)</a>:</h4>
<p>Coming late to this discussion... It seems to me that implicit conversions to/from lists (to satisfy operators that take single input, or to throw an error at runtime if  they're unsatisfied) is a "sharp edge" of the language without a huge benefit. But maybe I'm just missing the benefit...  </p>



<a name="153865103"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865103" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865103">(Dec 30 2016 at 13:59)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span>, <span class="user-mention" data-user-id="191316">@Grahame Grieve</span>   why this expressions - <code>&lt;expression invalid="true"&gt;name.given1&lt;/expression&gt;  or &lt;expression invalid="true"&gt;Encounter.name.given&lt;/expression&gt;</code> are marked as invalid, do you mean we have to verify against fhir structure? This expressions are syntactically valid fhirpath expression, but not valid from fhir resources structure point of view. Should we mix this two things?</p>



<a name="153865104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865104">(Dec 30 2016 at 14:00)</a>:</h4>
<p>or by <code>invalid</code> you just mean empty result?</p>



<a name="153865105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865105">(Dec 30 2016 at 14:34)</a>:</h4>
<p>I could not stop :) In fhirpath we have expressions  like <code>value.is(Quality)</code> - but  in json we have key - <code>valueQuaility</code> in xml - tag <code>valueQuallity</code> -  this require backtracking in implementation or usage of FHIR metadata to evaluate such type of expressions - which is not good. And this is consequences of our polymorphics and serialization design. I think, we should serialize into <code>value: {type: 'Quality,...}  or &lt;value type="Quality" value=""&gt;</code> or do not use such type of expressions in fhirpath, or at least say it like <code>value[x].is(Quality)</code>.</p>



<a name="153865106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865106">(Dec 30 2016 at 15:24)</a>:</h4>
<p>Do we really need <code>as</code>as operator and <code>as</code> as function?</p>



<a name="153865107"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865107" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865107">(Dec 30 2016 at 17:56)</a>:</h4>
<p><a href="https://medium.com/@niquola/query-languages-for-recursive-data-structures-da348036f679#.cc3s55rgt" target="_blank" title="https://medium.com/@niquola/query-languages-for-recursive-data-structures-da348036f679#.cc3s55rgt">https://medium.com/@niquola/query-languages-for-recursive-data-structures-da348036f679#.cc3s55rgt</a> - i've put some thoughts about fhirpath into small post :) </p>



<a name="153865108"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865108" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865108">(Dec 30 2016 at 17:58)</a>:</h4>
<p>Those tests are invalid for is and as, the .is() and .as() functions were removed in favor of the is and as operators.</p>



<a name="153865109"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865109" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865109">(Dec 30 2016 at 17:58)</a>:</h4>
<p>And those were designed as operators so that we can tell in the grammar when we are parsing a type name.</p>



<a name="153865110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865110">(Dec 30 2016 at 18:00)</a>:</h4>
<p>And yes, the tests are marked invalid because they are expected to throw an error (either compile-time or run-time). I don't see a problem with having tests that expect a particular data model, though it would be nice if the tests indicated what model they were expected to be evaluated against.</p>



<a name="153865111"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865111" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865111">(Dec 30 2016 at 18:00)</a>:</h4>
<p>The tests are full evaluation tests, not just syntax tests.</p>



<a name="153865112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865112">(Dec 30 2016 at 18:58)</a>:</h4>
<p>Here's some background posts that I think address the questions you raise in your blog entry:</p>



<a name="153865113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865113">(Dec 30 2016 at 18:58)</a>:</h4>
<p><a href="http://www.healthintersections.com.au/?p=2400" target="_blank" title="http://www.healthintersections.com.au/?p=2400">http://www.healthintersections.com.au/?p=2400</a></p>



<a name="153865114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865114">(Dec 30 2016 at 18:58)</a>:</h4>
<p><a href="https://github.com/cqframework/clinical_quality_language/wiki/FHIRPath:CQL::XPath:XQuery" target="_blank" title="https://github.com/cqframework/clinical_quality_language/wiki/FHIRPath:CQL::XPath:XQuery">https://github.com/cqframework/clinical_quality_language/wiki/FHIRPath:CQL::XPath:XQuery</a></p>



<a name="153865122"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865122" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865122">(Dec 30 2016 at 21:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span> tightly coupling data model and query language is diminish this language  applicability/reuse. <code>name.given1</code> is a worst case  of all - compiletime/runtime - because it should take meta data about types in runtime (there is no tips for compile time - it should be at least Patient.name.given1) . You could live with compile time checks, which require a lot of metadata - but it is very difficult to optimize such checks in runtime. </p>



<a name="153865123"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865123" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865123">(Dec 30 2016 at 21:18)</a>:</h4>
<p>If you want something like type checking, then annotate it with types, if you are dynamic - then this expression is valid and just return nothing.</p>



<a name="153865124"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865124" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865124">(Dec 30 2016 at 21:20)</a>:</h4>
<p>Validation for schema, could be just optional feature on top of schema-agnostic fhirpath (not required).</p>



<a name="153865129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865129">(Dec 30 2016 at 21:51)</a>:</h4>
<p>@<strong>nicola (RIO)</strong> FHIRPath doesn't tightly couple data model and query language. FHIRPath is a generic language that works against any model.</p>



<a name="153865224"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865224" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865224">(Jan 03 2017 at 00:12)</a>:</h4>
<p>The tests were created to test the implementations that we were creating against the fhir specific extensions to the language also, not just the core language.<br>
The format of the test file as XML isn't important, as its just a source for the test engine, and we needed something to be able to share.</p>



<a name="153865247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865247">(Jan 03 2017 at 08:52)</a>:</h4>
<p>We have <code>contains</code> function on strings and <code>contains</code> operator on sets and also in example we have <code>ValueSet.expansion.repeat(contains)</code>?  Fhirpath is like quest game for implementers, it harms my brain :(</p>



<a name="153865280"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865280" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865280">(Jan 03 2017 at 16:56)</a>:</h4>
<p>The <code>contains</code> in <code>ValueSet.expansion.repeat(contains)</code> is resolved as a property name because it doesn't have parentheses. So the repeat recursively invokes the contains property until there are no more results.</p>



<a name="153865281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865281">(Jan 03 2017 at 16:59)</a>:</h4>
<p>As far as similar functions on different types, some of that is inevitable, there are only so many words available, so we tried to go with the most common usages of function names for each domain. Sometimes that results in overlap, not sure how to avoid that.</p>



<a name="153865339"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865339" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865339">(Jan 03 2017 at 20:48)</a>:</h4>
<p>@<strong>nicola (RIO)</strong> can you add a task to add min() and max() functions? Agree thtey are useful for indexing</p>



<a name="153865340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865340">(Jan 03 2017 at 20:49)</a>:</h4>
<p>you should not confuse the details of the test suite with the language details. We  could add test suites for different applications, but a test suite that was application independent would not be very useful, so we didn't define on </p>



<a name="153865341"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865341" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865341">(Jan 03 2017 at 20:50)</a>:</h4>
<p>I do intend to do a v2 test suite at some stage</p>



<a name="153865416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865416">(Jan 04 2017 at 10:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span>  for name clashes we could use <code>namespaces</code>: <code>str/contains</code> <code>coll/contains</code>. Bryn, are you sure we need all this temporal algebra in fhirpath,  as i understand it was ported from CQL?</p>



<a name="153865417"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865417" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865417">(Jan 04 2017 at 10:50)</a>:</h4>
<p>FHIRPath users asked for more than we did</p>



<a name="153865419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865419">(Jan 04 2017 at 10:53)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> i've added issue about min/max to gforge. Yes, that's what i'm talking in my blog post -  general purpose language at the end!</p>



<a name="153865420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865420">(Jan 04 2017 at 10:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> have you seen XPath 3 - <a href="https://www.w3.org/TR/xpath-30/" target="_blank" title="https://www.w3.org/TR/xpath-30/">https://www.w3.org/TR/xpath-30/</a>?</p>



<a name="153865423"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865423" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865423">(Jan 04 2017 at 11:38)</a>:</h4>
<p>a little. I prefer not to look :-)</p>



<a name="153865424"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865424" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865424">(Jan 04 2017 at 11:40)</a>:</h4>
<p>xml... <a href="http://thedailywtf.com/articles/sche-ma" target="_blank" title="http://thedailywtf.com/articles/sche-ma">http://thedailywtf.com/articles/sche-ma</a> ... only look if I really have too... !</p>



<a name="153865425"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865425" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865425">(Jan 04 2017 at 12:28)</a>:</h4>
<p>Let do not make fhirpath like this :)</p>



<a name="153865444"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865444" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865444">(Jan 04 2017 at 15:39)</a>:</h4>
<p>@<strong>nicola (RIO)</strong> FHIRPath doesn't have a temporal algebra, so I'm not sure what you're referring to?</p>



<a name="153865533"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865533" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865533">(Jan 04 2017 at 21:57)</a>:</h4>
<p>If we use <code>+</code> to concatenate strings (like in js), should we define <code>-</code>for strings? :) Most of languages do not use <code>+</code> for strings, this is too javascriptish and source of many bugs.</p>



<a name="153865534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865534">(Jan 04 2017 at 22:00)</a>:</h4>
<blockquote>
<p>This differs from + on two strings, which will result in an empty collection when one of the operands is empty.</p>
</blockquote>



<a name="153865535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865535">(Jan 04 2017 at 22:03)</a>:</h4>
<p>This is a joke of the day :)  - if we use arithmetic operator on strings and some of strings are empty we return empty collection. Even LISP does not go so far. </p>



<a name="153865536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865536">(Jan 04 2017 at 22:04)</a>:</h4>
<p>But every SQL dialect does.</p>



<a name="153865538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865538">(Jan 04 2017 at 22:05)</a>:</h4>
<p>If I ask you to concatenate two strings, but you don't know what one of the strings is, what's the right answer?</p>



<a name="153865539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865539">(Jan 04 2017 at 22:05)</a>:</h4>
<p>You can choose to ignore the thing that you don't know, but that's making an explicit choice about how to handle missing information, and it's not always the right choice.</p>



<a name="153865540"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865540" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865540">(Jan 04 2017 at 22:06)</a>:</h4>
<p>The more conservative response is to say "I don't know what the resulting string would be because I don't know what one of the inputs is". Which is what all SQL dialects do.</p>



<a name="153865541"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865541" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865541">(Jan 04 2017 at 22:07)</a>:</h4>
<p>Please take a look at tons of javascript WTFs produced by such types of  implicit conversions , it's a well known <code>bad parts</code> of js</p>



<a name="153865542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865542">(Jan 04 2017 at 22:07)</a>:</h4>
<p>it sounds like you are talking about different things....</p>



<a name="153865543"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865543" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865543">(Jan 04 2017 at 22:08)</a>:</h4>
<p>We don't define implicit conversions between integers and strings, which is really the source of the gotchas.</p>



<a name="153865545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865545">(Jan 04 2017 at 22:14)</a>:</h4>
<p>why do not use special operation for strings concatenation?  Choice of <code>&amp;</code> for strings also looks strange - it's bitwise operator  in c-like languages. </p>



<a name="153865546"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865546" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865546">(Jan 04 2017 at 22:18)</a>:</h4>
<p>well, at some point, every special operator is used for something somewhere</p>



<a name="153865548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865548">(Jan 04 2017 at 22:22)</a>:</h4>
<p>Yes, that's true :) I've just looked into different languages string concat - there are zoo of all possible combinations: Haskell <code>++</code>, Postgresql <code>||</code>, Ocaml <code>^</code>. I forgot in Java it's really <code>+</code>.</p>



<a name="153865555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865555">(Jan 04 2017 at 22:27)</a>:</h4>
<p>Yeah, + is I think the most common in traditional languages (C, Java, C#, JavaScript, T-SQL). I also really like &amp; for concatenation, it means "and", so it works conceptually, and hopefully we never have bitwise operators in CQL or FHIRPath :)</p>



<a name="153865557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865557">(Jan 04 2017 at 22:28)</a>:</h4>
<p>oh yes, don't we all love bitwise operators...</p>



<a name="153865558"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865558" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865558">(Jan 04 2017 at 22:30)</a>:</h4>
<p>May be redefine <code>-</code> for strings - for symmetry? It's a joke or may be not.  So we'll get algebraic data types.</p>



<a name="153865560"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865560" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865560">(Jan 04 2017 at 22:33)</a>:</h4>
<p>Not opposed to it, but you'd have to define clear semantics. It's interpretable in any number of ways, so it's typically not expressible as a binary operation, needs more input.</p>



<a name="153865567"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865567" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865567">(Jan 04 2017 at 22:43)</a>:</h4>
<p>a-b - remove all character sequences b from a - what else could it mean? </p>



<a name="153865568"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865568" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865568">(Jan 04 2017 at 22:43)</a>:</h4>
<p>I could see myself using that.... but not often]</p>



<a name="153865569"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865569" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865569">(Jan 04 2017 at 22:44)</a>:</h4>
<p>Remove the first appearance of b, remove the last appearance of b, etc...</p>



<a name="153865574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865574">(Jan 04 2017 at 22:45)</a>:</h4>
<p>hat's why it could only mean all of them</p>



<a name="153865580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865580">(Jan 04 2017 at 22:49)</a>:</h4>
<p>What if removing b resulted in a new appearance of b. Should it keep going?</p>



<a name="153865582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865582">(Jan 04 2017 at 22:53)</a>:</h4>
<p>LISPER NOTE:  empty list as NULL = NIL. We wrap all values in collection - yes <code>functor</code> composability is nice feature, simulating <code>maybe</code> monad by collections - also ok, but i still have doubts about  generalising this approach to whole language.</p>



<a name="153865586"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865586" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865586">(Jan 04 2017 at 22:55)</a>:</h4>
<p>sure ;-). But I'm not really arguing for this. </p>



<a name="153865595"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865595" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865595">(Jan 04 2017 at 23:04)</a>:</h4>
<p>For example - should this fail  or return collection of first letters <code>Patient.name.given.substring(0,1)</code> if given.count() &gt; 1? I'm still puzzled with <code>Patient.name.given = 'Nicola'</code> in samples</p>



<a name="153865596"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865596" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865596">(Jan 04 2017 at 23:06)</a>:</h4>
<p>the first is clearly documented. the answer is null if it's a collection. So is the second: Returns true if the left collection is equal to the right collection</p>



<a name="153865598"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865598" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865598">(Jan 04 2017 at 23:08)</a>:</h4>
<p>To return a collection of first letters, you'd use select to invoke the substring on each element of the collection.</p>



<a name="153865601"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865601" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865601">(Jan 04 2017 at 23:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  But right is not a collection, or we assume it's <code>['Nicola']</code>. So <code>select</code> is a  functional <code>map</code>?!</p>



<a name="153865602"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865602" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865602">(Jan 04 2017 at 23:22)</a>:</h4>
<p>everything is a collection. in this case, a collection with a single value</p>



<a name="153865603"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865603" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865603">(Jan 04 2017 at 23:22)</a>:</h4>
<p>['Nicola'] = 'Nicola'</p>



<a name="153865604"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865604" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865604">(Jan 04 2017 at 23:22)</a>:</h4>
<p>.. you're unique ;-0</p>



<a name="153865605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865605">(Jan 04 2017 at 23:22)</a>:</h4>
<p>:)</p>



<a name="153865607"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865607" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865607">(Jan 04 2017 at 23:25)</a>:</h4>
<p>could we somehow get collection of collections, or they are always flatten?</p>



<a name="153865608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865608">(Jan 04 2017 at 23:26)</a>:</h4>
<p>don't know. </p>



<a name="153865609"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865609" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865609">(Jan 04 2017 at 23:26)</a>:</h4>
<p>They are flattened in path traversal, but with a select you could get a list of lists.</p>



<a name="153865611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865611">(Jan 04 2017 at 23:27)</a>:</h4>
<p>I think. That might need clarification :)</p>



<a name="153865612"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865612" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865612">(Jan 04 2017 at 23:27)</a>:</h4>
<p>And my collection constructor is (a | b | c) = [a, b, c]?</p>



<a name="153865613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865613">(Jan 04 2017 at 23:28)</a>:</h4>
<p>Yes.</p>



<a name="153865614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865614">(Jan 04 2017 at 23:28)</a>:</h4>
<p>Nope, clearly documented, select flattens the results.</p>



<a name="153865615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865615">(Jan 04 2017 at 23:30)</a>:</h4>
<p>And fhirpath always returns collection as result of expression?</p>



<a name="153865616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865616">(Jan 04 2017 at 23:31)</a>:</h4>
<p>yes</p>



<a name="153865617"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865617" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865617">(Jan 04 2017 at 23:31)</a>:</h4>
<p>Yes, though for clarity in the documentation, operations and functions that expect singletons are described using the type, rather than the collection type.</p>



<a name="153865618"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865618" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865618">(Jan 04 2017 at 23:32)</a>:</h4>
<p>singleton = collection of one element?</p>



<a name="153865619"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865619" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865619">(Jan 04 2017 at 23:32)</a>:</h4>
<p>Yes.</p>



<a name="153865668"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865668" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865668">(Jan 05 2017 at 09:54)</a>:</h4>
<p>If everything is a collection, what logical expressions should return  - [true], [false]?</p>



<a name="153865669"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865669" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865669">(Jan 05 2017 at 10:07)</a>:</h4>
<p>I still argue against expressions like Observation.value.value - which requires fhirpath engine to know about  FHIR polymorphics and metadata to evaluate. Please , do not mix this. At least add some hint like <code>Observation.value[x].value</code>. Or as i've already asked, let's encode polymorpics like: <code>{value: {type: SomeType , value: .... or valueSomeType}}</code> - as i see most of ref. libraries use Observation.value getter - that's why you think it's natural to write such expressions, but it's not natural for implementations based purely on data formats (json, xml). It's also simplify json schema :)</p>



<a name="153865670"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865670" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865670">(Jan 05 2017 at 10:17)</a>:</h4>
<p>Why in tests  comparison of date and time is not type error ? <code>birthDate != @12:00</code> expected false, not error</p>



<a name="153865671"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865671" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865671">(Jan 05 2017 at 10:19)</a>:</h4>
<p>Oh, i see </p>
<blockquote>
<p>For dateTime and time comparisons with partial values (e.g. dateTimes specified only to the day, or times specified only to the hour), the comparison returns empty ({ }), not false.</p>
</blockquote>
<p>What is motivation not to raise exception?</p>



<a name="153865673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865673">(Jan 05 2017 at 10:21)</a>:</h4>
<p>And what is difference between {} and false (or [false] :)?  - true, false, unknown?</p>



<a name="153865683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865683">(Jan 05 2017 at 11:09)</a>:</h4>
<p>you can create a task for a future version of FHIRPath to use Observation.value[x] not Observation.value, but I don't like your chances. But you pretty much have to know the same information to resolve value[x] as value, so it doesn't make that much difference. </p>



<a name="153865684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865684">(Jan 05 2017 at 11:09)</a>:</h4>
<p>the tools ensure, btw, that there'll never be yyyyXXX and yyyy[x] - that would create potential confusion already, so isn't allowed. </p>



<a name="153865685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865685">(Jan 05 2017 at 11:10)</a>:</h4>
<p>you're also welcome to create a task proposing changing the way polymorphics are serialised, but i can't see it getting up; you're the only one who's bugged by it </p>



<a name="153865707"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865707" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865707">(Jan 05 2017 at 15:58)</a>:</h4>
<p>@<strong>nicola (RIO)</strong> we added a choice type to CQL 1.2, partly to support FHIR, but partly to support QDM-style unions. FHIR isn't the only data model with choice types, so having a language that can deal with them is a good thing. If you feel strongly about not including them, I'd welcome your comments on the CQL 1.2 ballot.</p>



<a name="153865719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRpath%20test%20suite/near/153865719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRpath.20test.20suite.html#153865719">(Jan 05 2017 at 17:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  i will create tickets.  Most of current users just use ref.libraries (which is written by 4 people in the same paradigm of code generation) and do not fill this pain, but think about future users, libraries, databases. Complexity of all implementations are doubled by requirement to keep metadata available for such situations and it's just accidental complexity.  Data is self-valuable - why do you want Observation.value in Spec, Java or C#, but do not want it in the same shape in serialised form? This decision forces to write reference libraries (hardcode versions etc), for all engines which deal with FHIR (even partially like fhirpath), without real need. Data format by itself could keep this aspects of  model semantic without need for additional tools (like ref libraries). I argue, that this data will outlast all libraries - why it should be freaked?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
