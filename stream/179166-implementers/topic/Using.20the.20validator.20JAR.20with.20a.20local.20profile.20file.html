---
layout: page
title: "FHIR Chat  · Using the validator JAR with a local profile file · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html">Using the validator JAR with a local profile file</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153929616"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153929616" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153929616">(Jan 19 2018 at 14:01)</a>:</h4>
<p>I am working on a profile and creating example resources along with it. I was hoping to use the current validator JAR to validate those examples against my local <code>StructureDefinition</code> XML file for the profile. However, despite investing a good deal of time, I have not gotten it to work yet - when passing a path to a file to <code>-profile</code>, I  get errors saying either that it did not complete loading the StructureDefinition or that the StructureDefinition reference could not be resolved.</p>
<p>The documentation I found seems not quite clear on whether validating against a file even possible. In the <em>readme.txt</em> file that comes along with the validator .zip file, the call syntax def seems to leave out the profile parameter</p>
<blockquote>
<p>Usage: java -jar org.hl7.fhir.validator.jar [source] (-defn [definitions]) (-output [output]) where: </p>
</blockquote>
<p>but a few lines down such a parameter (allowing filenames) is documented: </p>
<blockquote>
<ul>
<li>[profile] is an optional filename or URL for a specific profile to validate a resource<br>
    against. In the absence of this parameter, the resource will be checked against the <br>
    base specification using the definitions.</li>
</ul>
</blockquote>
<p>On the other hand, running</p>
<div class="codehilite"><pre><span></span>java -jar org.hl7.fhir.validator.jar help
</pre></div>


<p>outputs documentation stating the the profile parameter must be a URL (and so presumably cannot handle a local file?)</p>
<blockquote>
<p>-profile [url]: a canonical URL to validate against (same as if it was specified in Resource.meta.profile)</p>
</blockquote>
<p>Any input on how one can validate against a local profile file (if possible) would be great.</p>



<a name="153929633"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153929633" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153929633">(Jan 19 2018 at 15:59)</a>:</h4>
<p>The validator expects to load any relevant profiles from an IG Pack.  The "-profile" parameter allows you to assert that "the instance I'm about to validate should be validated against profile xyz even if it hasn't declared that profile".  It's not intended to reference a file that contains the desired profiles.</p>



<a name="153929764"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153929764" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153929764">(Jan 20 2018 at 05:22)</a>:</h4>
<p>-profile is the url to validate against. The url must be loaded somehow - the validator will load from the  url directly, but before doing that, it looks through the cache of loaded files. You can specify the structure definition using -ig - you don't have to specify an OG pack</p>



<a name="153929916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153929916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153929916">(Jan 22 2018 at 09:40)</a>:</h4>
<p>Thanks for the clarification, I'll give -ig a try.</p>



<a name="153936914"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153936914" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Francis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153936914">(Feb 12 2018 at 14:53)</a>:</h4>
<blockquote>
<p>Thanks for the clarification, I'll give -ig a try.</p>
</blockquote>
<p><span class="user-mention" data-user-id="194703">@Morten Ernebjerg</span> , did you manage to successfully use the validator to validate against a local profile? Can you share an example?</p>
<p>Thanks in advance.</p>



<a name="153936973"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153936973" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153936973">(Feb 12 2018 at 21:00)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="193795">@Joel Francis</span> Yes, I did get it to work. Here is what works for me (based on my current understanding &amp; open to corrections):</p>
<p>Suppose you want to validate a <code>Patient</code> resource in the file <em>examplesdir/patient_xyz.xml</em> . You want to validate it against a profile that is stored in the folder <em>profiles/</em>  and has URL <em>http://hl7.org/fhir/StructureDefinition/xyz_profile</em> (i.e. the corresponding <code>StructureDefinition</code> resource file is in that folder and its<code>url</code> field contains that URL). Then you can run</p>
<div class="codehilite"><pre><span></span>java -jar org.hl7.fhir.validator.jar -defn http://hl7.org/fhir -ig profiles/ -profile http://hl7.org/fhir/StructureDefinition/xyz_profile examplesdir/patient_xyz.xml
</pre></div>


<p>The <code>-ig</code> option ensures that the validator preloads the profiles in the <em>profiles/</em> folder so that it recognizes the corresponding URLs. I explicitly used the <code>-defn</code> option to point to the STU3 defs. since the validator otherwise (judging from the output) seems to take the base resource definitions from <em>http://build.fhir.org</em> (current build).</p>
<p>If the profile to validate against is explicitly declared in the <code>meta.profile</code> field of the resource itself, you can leave out the <code>-profile</code> option. You can also pass a whole folder of examples to validate instead of just a single file (e.g. passing <em>examplesdir/</em>* instead of <em>examplesdir/patient_xyz.xml</em>), though then the profiles of course have to be declared in the <code>meta.profile</code> fields of resources (unless they are all the same).</p>
<p>Hope that works for you, too!</p>



<a name="153937106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153937106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Francis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153937106">(Feb 13 2018 at 13:57)</a>:</h4>
<p><span class="user-mention" data-user-id="194703">@Morten Ernebjerg</span> , Thank you very much for the clarity in your example. I will try this out.</p>



<a name="153937471"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153937471" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Francis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153937471">(Feb 14 2018 at 19:33)</a>:</h4>
<p><span class="user-mention" data-user-id="194703">@Morten Ernebjerg</span>  following your example and keeping the folder structure you mentioned just to minimize the differences, I get the attached error. Any thoughts?<br>
<a href="/user_uploads/10155/swtrWogqbQAaVI8Kro7VDIVh/validation_error.png" target="_blank" title="validation_error.png">validation_error.png</a> <a href="/user_uploads/10155/sWt-XnHHMp525t7xnkjCz10H/folder.png" target="_blank" title="folder.png">folder.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/swtrWogqbQAaVI8Kro7VDIVh/validation_error.png" target="_blank" title="validation_error.png"><img src="/user_uploads/10155/swtrWogqbQAaVI8Kro7VDIVh/validation_error.png"></a></div><div class="message_inline_image"><a href="/user_uploads/10155/sWt-XnHHMp525t7xnkjCz10H/folder.png" target="_blank" title="folder.png"><img src="/user_uploads/10155/sWt-XnHHMp525t7xnkjCz10H/folder.png"></a></div>



<a name="153938138"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153938138" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morten Ernebjerg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153938138">(Feb 16 2018 at 08:39)</a>:</h4>
<p><span class="user-mention" data-user-id="193795">@Joel Francis</span> Hm, I never came across an error like that. Based on the <a href="https://github.com/jamesagnew/hapi-fhir/blob/b61887e84133524009a3f64bc35a021d8732353e/hapi-fhir-validation/src/main/java/org/hl7/fhir/r4/validation/InstanceValidator.java#L1568" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/blob/b61887e84133524009a3f64bc35a021d8732353e/hapi-fhir-validation/src/main/java/org/hl7/fhir/r4/validation/InstanceValidator.java#L1568">source code in the HAPI FHIR GitHub repo that throws it</a> (assuming it is HAPI FHIR), it looks like the validator is missing the component that retrieves referenced entities. I don't know the code well enough to say whether this is an internal issue or if it comes from the example/profile . My only hunch would be checking that the references in the example are valid.  Maybe stripping off the <code>-profile</code> parameter to first validate against the base profile could also help pinpoint the source (profile vs. example)?</p>



<a name="153938962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Using%20the%20validator%20JAR%20with%20a%20local%20profile%20file/near/153938962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Francis <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Using.20the.20validator.20JAR.20with.20a.20local.20profile.20file.html#153938962">(Feb 20 2018 at 14:58)</a>:</h4>
<blockquote>
<p><span class="user-mention" data-user-id="193795">@Joel Francis</span> Hm, I never came across an error like that. Based on the <a href="https://github.com/jamesagnew/hapi-fhir/blob/b61887e84133524009a3f64bc35a021d8732353e/hapi-fhir-validation/src/main/java/org/hl7/fhir/r4/validation/InstanceValidator.java#L1568" target="_blank" title="https://github.com/jamesagnew/hapi-fhir/blob/b61887e84133524009a3f64bc35a021d8732353e/hapi-fhir-validation/src/main/java/org/hl7/fhir/r4/validation/InstanceValidator.java#L1568">source code in the HAPI FHIR GitHub repo that throws it</a> (assuming it is HAPI FHIR), it looks like the validator is missing the component that retrieves referenced entities. I don't know the code well enough to say whether this is an internal issue or if it comes from the example/profile . My only hunch would be checking that the references in the example are valid.  Maybe stripping off the <code>-profile</code> parameter to first validate against the base profile could also help pinpoint the source (profile vs. example)?</p>
</blockquote>
<p>Thanks <span class="user-mention" data-user-id="194703">@Morten Ernebjerg</span> . I will try your suggestions.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
