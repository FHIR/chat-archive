---
layout: page
title: "FHIR Chat  · Subtyping of primitive fhir values · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html">Subtyping of primitive fhir values</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="203746923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203746923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Justin Pombrio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203746923">(Jul 13 2020 at 17:51)</a>:</h4>
<p>What are the practical consequences meant to be, of subtyping for primitive values?</p>
<p>For example, one place you'd expect it to be relevant is when setting elements in a map file. <code>canonical</code> and <code>url</code> are both subtypes of <code>uri</code>. Under an ordinary subtyping system, this would mean that if a field has type <code>uri</code> and you set it equal to a <code>url</code>, that would be fine, because <code>url</code> is a subtype of <code>uri</code>. But if the field had type <code>canonical</code> and you set it equal to a <code>url</code>, that would be an error, because <code>url</code> is not a subtype of <code>canonical</code>. Looking at the "datatypes version maps", there is both a "canonical2uri" and "uri2canonical" group, which suggests that <em>without those groups</em>, neither conversion would be allowed? <a href="http://hl7.org/fhir/datatypes-version-maps.html">http://hl7.org/fhir/datatypes-version-maps.html</a></p>
<p>Another place it could come up is the <code>is</code> operator in fhirpath. Should <code>some_canonical.is(uri)</code> be true? How about <code>some_canonical.is(url)</code>? Or <code>some_uri.is(canonical)</code>?</p>
<p>I didn't find any page that talks about this, but if there is one and I missed it feel free to just point me in that direction.</p>



<a name="203747205"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203747205" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203747205">(Jul 13 2020 at 17:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191359">@Bryn Rhodes</span></p>



<a name="203756922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203756922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203756922">(Jul 13 2020 at 19:06)</a>:</h4>
<p>in general, FHIR elements are <em>final</em> - you can't use sub-types in place of the types. It's possible that I overlooked some of the ramifications of sub-typing in the map files because I don't usually think about it for elements.</p>



<a name="203757491"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203757491" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203757491">(Jul 13 2020 at 19:11)</a>:</h4>
<p>for FHIRPath, for FHIR release 4, </p>
<ul>
<li><code>some_canonical.is(uri)</code> = true</li>
<li><code>some_canonical.is(url)</code> = false;</li>
<li><code>some_uri.is(canonical)?</code> = .... that depends, but false if uri refers to the type, or uri refers to a FHIR element type, but maybe true in some other circumstances</li>
</ul>



<a name="203758561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203758561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203758561">(Jul 13 2020 at 19:20)</a>:</h4>
<p>Do we need to clarify any of that behavior in the spec?</p>



<a name="203761701"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203761701" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Justin Pombrio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203761701">(Jul 13 2020 at 19:45)</a>:</h4>
<p>Thanks Grahame, that makes sense. So subtyping in fhirpath but not in fhir.</p>
<blockquote>
<p>Do we need to clarify any of that behavior in the spec?</p>
</blockquote>
<p>I don't think there's anything in the mapping language that talks about when it's legal to map one primitive to another. That would be useful to clarify. The fhirpath spec is pretty clear, though. For <code>is</code> and related operators it says "... or a subclass thereof".</p>
<p>There's a separate question of how fhir types are supposed to map to fhirpath types, which as far as I know is unspecified. For example, fhirpath has no operations on the <code>uri</code> type, only on <code>string</code>s. Presumably those <code>string</code> operations ought to work on <code>uri</code>s, but the way that's supposed to work is unclear.</p>



<a name="203762521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203762521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203762521">(Jul 13 2020 at 19:52)</a>:</h4>
<p>I'll think about it</p>



<a name="203767430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203767430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Justin Pombrio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203767430">(Jul 13 2020 at 20:34)</a>:</h4>
<p>FWIW, our implementation maps fhir types to fhirpath types according to the following table:</p>
<div class="codehilite"><pre><span></span><code>  &quot;boolean&quot; =&gt; boolean
  &quot;string&quot; | &quot;code&quot; | &quot;markdown&quot; | &quot;id&quot; | &quot;uri&quot; | &quot;canonical&quot; | &quot;oid&quot; | &quot;uuid&quot; =&gt; string
  &quot;integer&quot; | &quot;unsignedInt&quot; | &quot;positiveInt&quot; =&gt; integer
  &quot;decimal&quot; =&gt; decimal 
  &quot;date&quot; | &quot;dateTime&quot; =&gt; dateTime
  &quot;time&quot; =&gt; time
</code></pre></div>


<p>Though there are a couple places we do this and they might not be totally consistent.</p>



<a name="203769019"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/203769019" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#203769019">(Jul 13 2020 at 20:47)</a>:</h4>
<p>that table looks correct compared to the table in the spec</p>



<a name="211270687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/211270687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#211270687">(Sep 25 2020 at 15:10)</a>:</h4>
<p>The conversation table can be found here: <a href="https://www.hl7.org/fhir/fhirpath.html#types">https://www.hl7.org/fhir/fhirpath.html#types</a></p>



<a name="211271445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/211271445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#211271445">(Sep 25 2020 at 15:16)</a>:</h4>
<p>So, question...  I see the page with that table is Normative - how do additions get handled?  e.g., in R5 there's a new <a href="http://build.fhir.org/datatypes.html#integer64">integer64</a> datatype, which should probably have a mapping.</p>



<a name="211272179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/211272179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#211272179">(Sep 25 2020 at 15:21)</a>:</h4>
<p>well, needs to be a task, and then we agree to add it, and it gets added. not quite sure what you are asking</p>



<a name="211272467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/211272467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#211272467">(Sep 25 2020 at 15:23)</a>:</h4>
<p>Didn't know if it was the standard 'open a Jira', it was 'covered' by adding the datatype, or anything else.</p>



<a name="211272634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/211272634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#211272634">(Sep 25 2020 at 15:24)</a>:</h4>
<p>open a jira. it will be straight forward because it's not really a big decision, it's something I missed, but still needs approval by committee</p>



<a name="211273265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/211273265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#211273265">(Sep 25 2020 at 15:28)</a>:</h4>
<p>Yep, opening two.. one for the page there (FHIR-I) and one for FHIRpath itself, since it specifies integer as 32-bit and doesn't have a 64-bit one.</p>



<a name="211275005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subtyping%20of%20primitive%20fhir%20values/near/211275005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subtyping.20of.20primitive.20fhir.20values.html#211275005">(Sep 25 2020 at 15:41)</a>:</h4>
<p>Created <a href="http://jira.hl7.org/browse/FHIR-28615">FHIR#28615</a> for FHIRPath (though forgot to set workgroup to ITS - it doesn't appear to allow adding that later) and <a href="http://jira.hl7.org/browse/FHIR-28616">FHIR#28616</a> for FHIR-I FHIRPath info (with a note that it likely depends on resolution of 28615, since there needs to be a name for the FHIRPath type).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
