---
layout: page
title: "FHIR Chat  · $validate?profile not working · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html">$validate?profile not working</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="186700716"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/186700716" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sergej Reiser <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#186700716">(Jan 27 2020 at 16:50)</a>:</h4>
<p>Hi, <br>
the following documentation says, that I am supposed to be able to validate my resource against a specific profile by using the operation <code>$validate?profile=[profile url]</code>:<br>
<a href="https://www.hl7.org/fhir/validation.html#op" target="_blank" title="https://www.hl7.org/fhir/validation.html#op">https://www.hl7.org/fhir/validation.html#op</a></p>
<p>For testing purposes, I posted a custom StructureDefinition (containing a snapshot) to the baseR4 repository at:<br>
<a href="http://hapi.fhir.org/baseR4/StructureDefinition/592726" target="_blank" title="http://hapi.fhir.org/baseR4/StructureDefinition/592726">http://hapi.fhir.org/baseR4/StructureDefinition/592726</a><br>
This StructureDefinition for DocumentReference basically contains a few Extensions and makes attributes like language, identifier and type required.<br>
To my surprise the following POST-Request does not yield any errors. </p>
<div class="codehilite"><pre><span></span>curl --location --request POST &#39;http://hapi.fhir.org/baseR4/StructureDefinition/$validate?profile=http://gev.de/fhir/StructureDefinition/RepoDocumentReference&#39; \
--header &#39;Content-Type: application/json&#39; \
--data-raw &#39;{
    &quot;resourceType&quot;: &quot;DocumentReference&quot;,
    &quot;status&quot;: &quot;current&quot;,
    &quot;content&quot;: [
        {
            &quot;attachment&quot;: {
                &quot;contentType&quot;: &quot;text/plain&quot;,
                &quot;data&quot;: &quot;PDQ+&quot;
            }
        }
    ]
}&#39;
</pre></div>


<p>It seems like the posted resource is being validated against the default profile instead of the desired one.<br>
Only by adding the <code>meta.profile</code> attribute to the resource and removing <code>?profile=http://gev.de/fhir/StructureDefinition/RepoDocumentReference</code> from the request, the repository validates against the desired profile.</p>
<div class="codehilite"><pre><span></span>curl --location --request POST &#39;http://hapi.fhir.org/baseR4/StructureDefinition/$validate&#39; \
--header &#39;Content-Type: application/json&#39; \
--data-raw &#39;{
    &quot;resourceType&quot;: &quot;DocumentReference&quot;,
    &quot;meta&quot;: {
        &quot;profile&quot;: &quot;http://gev.de/fhir/StructureDefinition/RepoDocumentReference&quot;
    },
    &quot;status&quot;: &quot;current&quot;,
    &quot;content&quot;: [
        {
            &quot;attachment&quot;: {
                &quot;contentType&quot;: &quot;text/plain&quot;,
                &quot;data&quot;: &quot;PDQ+&quot;
            }
        }
    ]
}&#39;
</pre></div>


<p>Is this a malfunction of the hapi reference implementation, or just bad documentation?</p>



<a name="186701151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/186701151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#186701151">(Jan 27 2020 at 16:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>



<a name="186733112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/186733112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#186733112">(Jan 27 2020 at 22:29)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> this looks like a bug in a core validator that I fixed a few weeks ago</p>



<a name="188006194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188006194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Briand <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188006194">(Feb 12 2020 at 12:43)</a>:</h4>
<p>Same here !</p>
<p>I've tried to validate a resource creation with <code>$validate?profile=http://hl7.org/fhir/us/core/StructureDefinition/us-core</code> and was totally unable to make a validation working</p>
<p>On most of the example's servers I've found, I've a "Ok" answer ; and on others, I've a "Unable to resolve reference to profile '<a href="http://hl7.org/fhir/us/core/StructureDefinition/us-core" target="_blank" title="http://hl7.org/fhir/us/core/StructureDefinition/us-core">http://hl7.org/fhir/us/core/StructureDefinition/us-core</a>'".</p>
<p>Is the fix deployed on an example server ? Is there something I don't understand ?</p>



<a name="188018135"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188018135" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188018135">(Feb 12 2020 at 15:09)</a>:</h4>
<p>StructureDefinition/us-core isn't a valid profile id - you'd need to point to a specific us-core profile id</p>



<a name="188018214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188018214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Briand <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188018214">(Feb 12 2020 at 15:10)</a>:</h4>
<p>Sorry, bad cc : <code>http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</code></p>



<a name="188018523"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188018523" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188018523">(Feb 12 2020 at 15:13)</a>:</h4>
<p>Are you using a server like <a href="http://test.fhir.org" target="_blank" title="http://test.fhir.org">test.fhir.org</a> that has awareness of the US-core profiles?</p>



<a name="188019340"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188019340" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Briand <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188019340">(Feb 12 2020 at 15:22)</a>:</h4>
<p>I've successfully done a validation on grahame r3 server (the r4 seems buggy) with following request :</p>
<div class="codehilite"><pre><span></span>{
    &quot;resourceType&quot;: &quot;Patient&quot;,
    &quot;meta&quot;: {
        &quot;profile&quot;: [&quot;http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient&quot;]
    },
    &quot;text&quot;: {
        &quot;status&quot;: &quot;generated&quot;,
        &quot;div&quot;: &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;Demo patient&lt;/div&gt;&quot;
    },
    &quot;name&quot;: [
        {
            &quot;family&quot;: &quot;Doe&quot;
        }
    ],
    &quot;gender&quot;: &quot;male&quot;
}
</pre></div>


<p>But still not working with <code>{{uri}}/Patient/$validate?profile=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</code> which give me :</p>
<div class="codehilite"><pre><span></span>            &quot;details&quot;: {
                &quot;text&quot;: &quot;ValueSet http://hl7.org/fhir/ValueSet/narrative-status not found&quot;
            },
            &quot;expression&quot;: [
                &quot;Patient.text.status // line 4 col 7)&quot;
            ]
</pre></div>



<a name="188021631"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188021631" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188021631">(Feb 12 2020 at 15:45)</a>:</h4>
<p>For Vonk, you'll have to make the Administration endpoint aware of the profile, see <a href="http://docs.simplifier.net/vonk/administration_api.html" target="_blank" title="http://docs.simplifier.net/vonk/administration_api.html">http://docs.simplifier.net/vonk/administration_api.html</a></p>



<a name="188022158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188022158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Briand <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188022158">(Feb 12 2020 at 15:50)</a>:</h4>
<p>Ok, so, in the idea, when you validate using the $validate operation against a server, it's only with the profiles "available" for this server ?<br>
I understand better now</p>



<a name="188023649"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188023649" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ward Weistra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188023649">(Feb 12 2020 at 16:02)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="250480">@Florian Briand</span>, I created an set of Postman requests to show how this could work, including posting the FHIR Profile to the administration endpoint of the FHIR server (Vonk in this case) and then validating a profile against it in multiple ways: <a href="http://community.fhir.org/t/how-to-make-resource-json-with-new-profile/1777/5" target="_blank" title="http://community.fhir.org/t/how-to-make-resource-json-with-new-profile/1777/5">http://community.fhir.org/t/how-to-make-resource-json-with-new-profile/1777/5</a></p>



<a name="188025516"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/%24validate%3Fprofile%20not%20working/near/188025516" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Briand <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/.24validate.3Fprofile.20not.20working.html#188025516">(Feb 12 2020 at 16:17)</a>:</h4>
<p><span class="user-mention" data-user-id="203235">@Ward Weistra</span>  Hehe, thanks ;) I've builder almost the same collection, doing the same choices as yours, but I didn't thought to add the SD by myself, it's an idea !</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
