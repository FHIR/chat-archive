---
layout: page
title: "FHIR Chat  · DSTU3 context server fails to initialize · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/DSTU3.20context.20server.20fails.20to.20initialize.html">DSTU3 context server fails to initialize</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153921969"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/DSTU3%20context%20server%20fails%20to%20initialize/near/153921969" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Slava Chabanov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/DSTU3.20context.20server.20fails.20to.20initialize.html#153921969">(Nov 29 2017 at 00:13)</a>:</h4>
<p>I started playing with dstu2 models and then realized we need to be on sdtu3. I switched my Patient Resource to use <code>org.hl7.fhir.dstu3.model.Patient</code> </p>
<p>Here is how my servlet looks: </p>
<div class="codehilite"><pre><span></span>public class FhirApplication extends RestfulServer {

private static final long serialVersionUID = 1L;

/**
 * The initialize method is automatically called when the servlet is
 * starting up, so it can be used to configure the servlet to define
 * resource providers, or set up configuration, interceptors, etc.
 */
@Override
protected void initialize() throws ServletException {
    // Create a context, set the error handler and instruct
      // the server to use it
      FhirContext ctx = FhirContext.forDstu3();
      ctx.setParserErrorHandler(new StrictErrorHandler());
      setFhirContext(ctx);
    /*
     * The servlet defines any number of resource providers, and configures
     * itself to use them by calling setResourceProviders()
     */

    List&lt;IServerInterceptor&gt; interceptors = new ArrayList&lt;IServerInterceptor&gt;();
    BasicSecurityInterceptor bsi = new BasicSecurityInterceptor();
    interceptors.add(bsi);
    setInterceptors(interceptors);
    List&lt;IResourceProvider&gt; resourceProviders = new ArrayList&lt;IResourceProvider&gt;();
    resourceProviders.add(new PatientResourceProvider());
    setResourceProviders(resourceProviders);
}

}
</pre></div>


<p>My <strong><code>PatientResouceProvider.java</code></strong> implements <code>ca.uhn.fhir.rest.server.IResourceProvider</code>. <br>
What confused me a bit is that [here][1] it says that base for all resources is <code>org.hl7.fhir.instance.model.api.IBaseResource</code></p>
<p>And when I try to run the server, I get this error:</p>
<div class="codehilite"><pre><span></span> Nested in javax.servlet.ServletException: Failed to initialize FHIR Restful server:
ca.uhn.fhir.context.ConfigurationException: Field &#39;div&#39; in type &#39;org.hl7.fhir.dstu3.model.Narrative&#39; is not a valid child type: class org.hl7.fhir.utilities.xhtml.XhtmlNode
</pre></div>


<p>Has anyone seen this error beofre? I haven't found anything online.<br>
Thank you!</p>
<p>[1]: <a href="http://hapifhir.io/doc_dstu2.html#Using_the_DSTU3_Structures_in_Your_Application" target="_blank" title="http://hapifhir.io/doc_dstu2.html#Using_the_DSTU3_Structures_in_Your_Application">http://hapifhir.io/doc_dstu2.html#Using_the_DSTU3_Structures_in_Your_Application</a> "here"</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
