---
layout: page
title: "FHIR Chat  · Extension content in Snapshot? · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html">Extension content in Snapshot?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="263823609"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263823609" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263823609">(Dec 06 2021 at 09:11)</a>:</h4>
<p>Should the content of extensions be included in the snapshot of the host profile?</p>



<a name="263828699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263828699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263828699">(Dec 06 2021 at 10:06)</a>:</h4>
<p>I would expect them to contain the extension content.</p>



<a name="263833803"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263833803" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263833803">(Dec 06 2021 at 10:56)</a>:</h4>
<p>It seems that the snapshot generators of JAVA and .NET only include the root concept details into the host profiles snapshot. It leaves out the <code>.value[x]</code> constraints like a binding.  (Checked the JAVA stuff by looking at the snapshots of the US Core IG)</p>
<p>Makes me wonder about this part of the spec:  "a StructureDefinition can also carry a "snapshot" - a fully calculated form of the structure that is <strong>not dependent on any other structure.</strong>" <a href="https://hl7.org/FHIR/profiling.html#snapshot">https://hl7.org/FHIR/profiling.html#snapshot</a></p>



<a name="263835032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263835032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263835032">(Dec 06 2021 at 11:07)</a>:</h4>
<p>where what? Can you give an example?</p>



<a name="263838673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263838673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263838673">(Dec 06 2021 at 11:47)</a>:</h4>
<p><a href="https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-patient.profile.xml.html">us-core-patient profile</a> includes the <a href="https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-birthsex.profile.xml.html">us-core-birthsex extension</a> like this in the diff:</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">"Patient.extension:birthsex"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">"Patient.extension"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">"birthsex"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"Extension"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">"http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">"argonaut-dq-dstu2"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">"Patient.extension"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</code></pre></div>
<p>Resulting in this snapshot:</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code> <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">"Patient.extension:birthsex"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">"Patient.extension"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;sliceName</span> <span class="na">value=</span><span class="s">"birthsex"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;short</span> <span class="na">value=</span><span class="s">"Extension"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;definition</span> <span class="na">value=</span><span class="s">"A code classifying the person&amp;#39;s sex assigned at birth  as specified by the [Office of the National Coordinator for Health IT (ONC)](https://www.healthit.gov/newsroom/about-onc)."</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;comment</span> <span class="na">value=</span><span class="s">"The codes required are intended to present birth sex (i.e., the sex recorded on the patient&amp;#x2019;s birth certificate) and not gender identity or reassigned sex."</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;base&gt;</span>
        <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">"DomainResource.extension"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">"*"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/base&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"Extension"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;profile</span> <span class="na">value=</span><span class="s">"http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;condition</span> <span class="na">value=</span><span class="s">"ele-1"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;constraint&gt;</span>
        <span class="nt">&lt;key</span> <span class="na">value=</span><span class="s">"ele-1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;severity</span> <span class="na">value=</span><span class="s">"error"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;human</span> <span class="na">value=</span><span class="s">"All FHIR elements must have a @value or children"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;expression</span> <span class="na">value=</span><span class="s">"hasValue() or (children().count() &amp;gt; id.count())"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;xpath</span> <span class="na">value=</span><span class="s">"@value|f:*|h:div"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;source</span> <span class="na">value=</span><span class="s">"http://hl7.org/fhir/StructureDefinition/Element"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/constraint&gt;</span>
      <span class="nt">&lt;constraint&gt;</span>
        <span class="nt">&lt;key</span> <span class="na">value=</span><span class="s">"ext-1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;severity</span> <span class="na">value=</span><span class="s">"error"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;human</span> <span class="na">value=</span><span class="s">"Must have either extensions or value[x], not both"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;expression</span> <span class="na">value=</span><span class="s">"extension.exists() != value.exists()"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;xpath</span> <span class="na">value=</span><span class="s">"exists(f:extension)!=exists(f:*[starts-with(local-name(.), &amp;#39;value&amp;#39;)])"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;source</span> <span class="na">value=</span><span class="s">"http://hl7.org/fhir/StructureDefinition/Extension"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/constraint&gt;</span>
      <span class="nt">&lt;mustSupport</span> <span class="na">value=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;isModifier</span> <span class="na">value=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">"rim"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">"player[classCode=PSN|ANM and determinerCode=INSTANCE]/administrativeGender"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">"iso11179"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">".patient.administrativeGenderCode"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
      <span class="nt">&lt;mapping&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">value=</span><span class="s">"argonaut-dq-dstu2"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">value=</span><span class="s">"Patient.extension"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mapping&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</code></pre></div>
<p>I would expect that also the following would be included in the snapshot:</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code>   <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">"Extension.url"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">"Extension.url"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;fixedUri</span> <span class="na">value=</span><span class="s">"http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">id=</span><span class="s">"Extension.valueCode"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;path</span> <span class="na">value=</span><span class="s">"Extension.valueCode"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;min</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;max</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;type&gt;</span>
        <span class="nt">&lt;code</span> <span class="na">value=</span><span class="s">"code"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;binding&gt;</span>
        <span class="nt">&lt;strength</span> <span class="na">value=</span><span class="s">"required"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;description</span> <span class="na">value=</span><span class="s">"Code for sex assigned at birth"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;valueSet</span> <span class="na">value=</span><span class="s">"http://hl7.org/fhir/us/core/ValueSet/birthsex"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/binding&gt;</span>
    <span class="nt">&lt;/element&gt;</span>
</code></pre></div>



<a name="263838791"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263838791" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263838791">(Dec 06 2021 at 11:48)</a>:</h4>
<p>I would like to know why it isn't or why it shouldn't be included.</p>



<a name="263970585"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263970585" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263970585">(Dec 07 2021 at 08:28)</a>:</h4>
<p>Perhaps this question is more suited in the #conformance stream? Shall I move it?</p>



<a name="263978667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/263978667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#263978667">(Dec 07 2021 at 09:54)</a>:</h4>
<p>if you want. It's on my todo list, but it probably belongs in conformance</p>



<a name="264164294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extension%20content%20in%20Snapshot%3F/near/264164294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ardon Toonstra <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extension.20content.20in.20Snapshot.3F.html#264164294">(Dec 08 2021 at 14:43)</a>:</h4>
<p>Moved to <a href="#narrow/stream/179177-conformance/topic/Snapshots.3A.20include.20extensions.20and.20datatype.20profiles.3F">https://chat.fhir.org/#narrow/stream/179177-conformance/topic/Snapshots.3A.20include.20extensions.20and.20datatype.20profiles.3F</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
